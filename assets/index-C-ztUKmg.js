(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function rf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function S_(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var r=e.default;if(typeof r=="function"){var t=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),t}var Oh={exports:{}},vc={},Fh={exports:{}},Et={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ng;function T_(){if(ng)return Et;ng=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.iterator;function k(I){return I===null||typeof I!="object"?null:(I=y&&I[y]||I["@@iterator"],typeof I=="function"?I:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,S={};function A(I,P,F){this.props=I,this.context=P,this.refs=S,this.updater=F||E}A.prototype.isReactComponent={},A.prototype.setState=function(I,P){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,P,"setState")},A.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function R(){}R.prototype=A.prototype;function O(I,P,F){this.props=I,this.context=P,this.refs=S,this.updater=F||E}var N=O.prototype=new R;N.constructor=O,b(N,A.prototype),N.isPureReactComponent=!0;var U=Array.isArray,K=Object.prototype.hasOwnProperty,B={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function te(I,P,F){var M,H={},X=null,fe=null;if(P!=null)for(M in P.ref!==void 0&&(fe=P.ref),P.key!==void 0&&(X=""+P.key),P)K.call(P,M)&&!D.hasOwnProperty(M)&&(H[M]=P[M]);var ge=arguments.length-2;if(ge===1)H.children=F;else if(1<ge){for(var ye=Array(ge),xe=0;xe<ge;xe++)ye[xe]=arguments[xe+2];H.children=ye}if(I&&I.defaultProps)for(M in ge=I.defaultProps,ge)H[M]===void 0&&(H[M]=ge[M]);return{$$typeof:e,type:I,key:X,ref:fe,props:H,_owner:B.current}}function ee(I,P){return{$$typeof:e,type:I.type,key:P,ref:I.ref,props:I.props,_owner:I._owner}}function ve(I){return typeof I=="object"&&I!==null&&I.$$typeof===e}function me(I){var P={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(F){return P[F]})}var J=/\/+/g;function ce(I,P){return typeof I=="object"&&I!==null&&I.key!=null?me(""+I.key):P.toString(36)}function ke(I,P,F,M,H){var X=typeof I;(X==="undefined"||X==="boolean")&&(I=null);var fe=!1;if(I===null)fe=!0;else switch(X){case"string":case"number":fe=!0;break;case"object":switch(I.$$typeof){case e:case r:fe=!0}}if(fe)return fe=I,H=H(fe),I=M===""?"."+ce(fe,0):M,U(H)?(F="",I!=null&&(F=I.replace(J,"$&/")+"/"),ke(H,P,F,"",function(xe){return xe})):H!=null&&(ve(H)&&(H=ee(H,F+(!H.key||fe&&fe.key===H.key?"":(""+H.key).replace(J,"$&/")+"/")+I)),P.push(H)),1;if(fe=0,M=M===""?".":M+":",U(I))for(var ge=0;ge<I.length;ge++){X=I[ge];var ye=M+ce(X,ge);fe+=ke(X,P,F,ye,H)}else if(ye=k(I),typeof ye=="function")for(I=ye.call(I),ge=0;!(X=I.next()).done;)X=X.value,ye=M+ce(X,ge++),fe+=ke(X,P,F,ye,H);else if(X==="object")throw P=String(I),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.");return fe}function se(I,P,F){if(I==null)return I;var M=[],H=0;return ke(I,M,"","",function(X){return P.call(F,X,H++)}),M}function ue(I){if(I._status===-1){var P=I._result;P=P(),P.then(function(F){(I._status===0||I._status===-1)&&(I._status=1,I._result=F)},function(F){(I._status===0||I._status===-1)&&(I._status=2,I._result=F)}),I._status===-1&&(I._status=0,I._result=P)}if(I._status===1)return I._result.default;throw I._result}var j={current:null},G={transition:null},Z={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:G,ReactCurrentOwner:B};function oe(){throw Error("act(...) is not supported in production builds of React.")}return Et.Children={map:se,forEach:function(I,P,F){se(I,function(){P.apply(this,arguments)},F)},count:function(I){var P=0;return se(I,function(){P++}),P},toArray:function(I){return se(I,function(P){return P})||[]},only:function(I){if(!ve(I))throw Error("React.Children.only expected to receive a single React element child.");return I}},Et.Component=A,Et.Fragment=t,Et.Profiler=a,Et.PureComponent=O,Et.StrictMode=n,Et.Suspense=m,Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,Et.act=oe,Et.cloneElement=function(I,P,F){if(I==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+I+".");var M=b({},I.props),H=I.key,X=I.ref,fe=I._owner;if(P!=null){if(P.ref!==void 0&&(X=P.ref,fe=B.current),P.key!==void 0&&(H=""+P.key),I.type&&I.type.defaultProps)var ge=I.type.defaultProps;for(ye in P)K.call(P,ye)&&!D.hasOwnProperty(ye)&&(M[ye]=P[ye]===void 0&&ge!==void 0?ge[ye]:P[ye])}var ye=arguments.length-2;if(ye===1)M.children=F;else if(1<ye){ge=Array(ye);for(var xe=0;xe<ye;xe++)ge[xe]=arguments[xe+2];M.children=ge}return{$$typeof:e,type:I.type,key:H,ref:X,props:M,_owner:fe}},Et.createContext=function(I){return I={$$typeof:c,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},I.Provider={$$typeof:l,_context:I},I.Consumer=I},Et.createElement=te,Et.createFactory=function(I){var P=te.bind(null,I);return P.type=I,P},Et.createRef=function(){return{current:null}},Et.forwardRef=function(I){return{$$typeof:d,render:I}},Et.isValidElement=ve,Et.lazy=function(I){return{$$typeof:x,_payload:{_status:-1,_result:I},_init:ue}},Et.memo=function(I,P){return{$$typeof:v,type:I,compare:P===void 0?null:P}},Et.startTransition=function(I){var P=G.transition;G.transition={};try{I()}finally{G.transition=P}},Et.unstable_act=oe,Et.useCallback=function(I,P){return j.current.useCallback(I,P)},Et.useContext=function(I){return j.current.useContext(I)},Et.useDebugValue=function(){},Et.useDeferredValue=function(I){return j.current.useDeferredValue(I)},Et.useEffect=function(I,P){return j.current.useEffect(I,P)},Et.useId=function(){return j.current.useId()},Et.useImperativeHandle=function(I,P,F){return j.current.useImperativeHandle(I,P,F)},Et.useInsertionEffect=function(I,P){return j.current.useInsertionEffect(I,P)},Et.useLayoutEffect=function(I,P){return j.current.useLayoutEffect(I,P)},Et.useMemo=function(I,P){return j.current.useMemo(I,P)},Et.useReducer=function(I,P,F){return j.current.useReducer(I,P,F)},Et.useRef=function(I){return j.current.useRef(I)},Et.useState=function(I){return j.current.useState(I)},Et.useSyncExternalStore=function(I,P,F){return j.current.useSyncExternalStore(I,P,F)},Et.useTransition=function(){return j.current.useTransition()},Et.version="18.3.1",Et}var ag;function j0(){return ag||(ag=1,Fh.exports=T_()),Fh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ig;function E_(){if(ig)return vc;ig=1;var e=j0(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(d,m,v){var x,y={},k=null,E=null;v!==void 0&&(k=""+v),m.key!==void 0&&(k=""+m.key),m.ref!==void 0&&(E=m.ref);for(x in m)n.call(m,x)&&!l.hasOwnProperty(x)&&(y[x]=m[x]);if(d&&d.defaultProps)for(x in m=d.defaultProps,m)y[x]===void 0&&(y[x]=m[x]);return{$$typeof:r,type:d,key:k,ref:E,props:y,_owner:a.current}}return vc.Fragment=t,vc.jsx=c,vc.jsxs=c,vc}var sg;function C_(){return sg||(sg=1,Oh.exports=E_()),Oh.exports}var f=C_(),fd={},Lh={exports:{}},Fn={},Rh={exports:{}},jh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var og;function A_(){return og||(og=1,(function(e){function r(G,Z){var oe=G.length;G.push(Z);e:for(;0<oe;){var I=oe-1>>>1,P=G[I];if(0<a(P,Z))G[I]=Z,G[oe]=P,oe=I;else break e}}function t(G){return G.length===0?null:G[0]}function n(G){if(G.length===0)return null;var Z=G[0],oe=G.pop();if(oe!==Z){G[0]=oe;e:for(var I=0,P=G.length,F=P>>>1;I<F;){var M=2*(I+1)-1,H=G[M],X=M+1,fe=G[X];if(0>a(H,oe))X<P&&0>a(fe,H)?(G[I]=fe,G[X]=oe,I=X):(G[I]=H,G[M]=oe,I=M);else if(X<P&&0>a(fe,oe))G[I]=fe,G[X]=oe,I=X;else break e}}return Z}function a(G,Z){var oe=G.sortIndex-Z.sortIndex;return oe!==0?oe:G.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();e.unstable_now=function(){return c.now()-d}}var m=[],v=[],x=1,y=null,k=3,E=!1,b=!1,S=!1,A=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(G){for(var Z=t(v);Z!==null;){if(Z.callback===null)n(v);else if(Z.startTime<=G)n(v),Z.sortIndex=Z.expirationTime,r(m,Z);else break;Z=t(v)}}function U(G){if(S=!1,N(G),!b)if(t(m)!==null)b=!0,ue(K);else{var Z=t(v);Z!==null&&j(U,Z.startTime-G)}}function K(G,Z){b=!1,S&&(S=!1,R(te),te=-1),E=!0;var oe=k;try{for(N(Z),y=t(m);y!==null&&(!(y.expirationTime>Z)||G&&!me());){var I=y.callback;if(typeof I=="function"){y.callback=null,k=y.priorityLevel;var P=I(y.expirationTime<=Z);Z=e.unstable_now(),typeof P=="function"?y.callback=P:y===t(m)&&n(m),N(Z)}else n(m);y=t(m)}if(y!==null)var F=!0;else{var M=t(v);M!==null&&j(U,M.startTime-Z),F=!1}return F}finally{y=null,k=oe,E=!1}}var B=!1,D=null,te=-1,ee=5,ve=-1;function me(){return!(e.unstable_now()-ve<ee)}function J(){if(D!==null){var G=e.unstable_now();ve=G;var Z=!0;try{Z=D(!0,G)}finally{Z?ce():(B=!1,D=null)}}else B=!1}var ce;if(typeof O=="function")ce=function(){O(J)};else if(typeof MessageChannel<"u"){var ke=new MessageChannel,se=ke.port2;ke.port1.onmessage=J,ce=function(){se.postMessage(null)}}else ce=function(){A(J,0)};function ue(G){D=G,B||(B=!0,ce())}function j(G,Z){te=A(function(){G(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(G){G.callback=null},e.unstable_continueExecution=function(){b||E||(b=!0,ue(K))},e.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<G?Math.floor(1e3/G):5},e.unstable_getCurrentPriorityLevel=function(){return k},e.unstable_getFirstCallbackNode=function(){return t(m)},e.unstable_next=function(G){switch(k){case 1:case 2:case 3:var Z=3;break;default:Z=k}var oe=k;k=Z;try{return G()}finally{k=oe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(G,Z){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var oe=k;k=G;try{return Z()}finally{k=oe}},e.unstable_scheduleCallback=function(G,Z,oe){var I=e.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?I+oe:I):oe=I,G){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=oe+P,G={id:x++,callback:Z,priorityLevel:G,startTime:oe,expirationTime:P,sortIndex:-1},oe>I?(G.sortIndex=oe,r(v,G),t(m)===null&&G===t(v)&&(S?(R(te),te=-1):S=!0,j(U,oe-I))):(G.sortIndex=P,r(m,G),b||E||(b=!0,ue(K))),G},e.unstable_shouldYield=me,e.unstable_wrapCallback=function(G){var Z=k;return function(){var oe=k;k=Z;try{return G.apply(this,arguments)}finally{k=oe}}}})(jh)),jh}var lg;function P_(){return lg||(lg=1,Rh.exports=A_()),Rh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cg;function N_(){if(cg)return Fn;cg=1;var e=j0(),r=P_();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function l(i,o){c(i,o),c(i+"Capture",o)}function c(i,o){for(a[i]=o,i=0;i<o.length;i++)n.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,v=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},y={};function k(i){return m.call(y,i)?!0:m.call(x,i)?!1:v.test(i)?y[i]=!0:(x[i]=!0,!1)}function E(i,o,h,g){if(h!==null&&h.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return g?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function b(i,o,h,g){if(o===null||typeof o>"u"||E(i,o,h,g))return!0;if(g)return!1;if(h!==null)switch(h.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function S(i,o,h,g,w,T,z){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=g,this.attributeNamespace=w,this.mustUseProperty=h,this.propertyName=i,this.type=o,this.sanitizeURL=T,this.removeEmptyString=z}var A={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){A[i]=new S(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];A[o]=new S(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){A[i]=new S(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){A[i]=new S(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){A[i]=new S(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){A[i]=new S(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){A[i]=new S(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){A[i]=new S(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){A[i]=new S(i,5,!1,i.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function O(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(R,O);A[o]=new S(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(R,O);A[o]=new S(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(R,O);A[o]=new S(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){A[i]=new S(i,1,!1,i.toLowerCase(),null,!1,!1)}),A.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){A[i]=new S(i,1,!1,i.toLowerCase(),null,!0,!0)});function N(i,o,h,g){var w=A.hasOwnProperty(o)?A[o]:null;(w!==null?w.type!==0:g||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(b(o,h,w,g)&&(h=null),g||w===null?k(o)&&(h===null?i.removeAttribute(o):i.setAttribute(o,""+h)):w.mustUseProperty?i[w.propertyName]=h===null?w.type===3?!1:"":h:(o=w.attributeName,g=w.attributeNamespace,h===null?i.removeAttribute(o):(w=w.type,h=w===3||w===4&&h===!0?"":""+h,g?i.setAttributeNS(g,o,h):i.setAttribute(o,h))))}var U=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,K=Symbol.for("react.element"),B=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),te=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),ve=Symbol.for("react.provider"),me=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),ce=Symbol.for("react.suspense"),ke=Symbol.for("react.suspense_list"),se=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),j=Symbol.for("react.offscreen"),G=Symbol.iterator;function Z(i){return i===null||typeof i!="object"?null:(i=G&&i[G]||i["@@iterator"],typeof i=="function"?i:null)}var oe=Object.assign,I;function P(i){if(I===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);I=o&&o[1]||""}return`
`+I+i}var F=!1;function M(i,o){if(!i||F)return"";F=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Ne){var g=Ne}Reflect.construct(i,[],o)}else{try{o.call()}catch(Ne){g=Ne}i.call(o.prototype)}else{try{throw Error()}catch(Ne){g=Ne}i()}}catch(Ne){if(Ne&&g&&typeof Ne.stack=="string"){for(var w=Ne.stack.split(`
`),T=g.stack.split(`
`),z=w.length-1,le=T.length-1;1<=z&&0<=le&&w[z]!==T[le];)le--;for(;1<=z&&0<=le;z--,le--)if(w[z]!==T[le]){if(z!==1||le!==1)do if(z--,le--,0>le||w[z]!==T[le]){var he=`
`+w[z].replace(" at new "," at ");return i.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",i.displayName)),he}while(1<=z&&0<=le);break}}}finally{F=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?P(i):""}function H(i){switch(i.tag){case 5:return P(i.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return i=M(i.type,!1),i;case 11:return i=M(i.type.render,!1),i;case 1:return i=M(i.type,!0),i;default:return""}}function X(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case D:return"Fragment";case B:return"Portal";case ee:return"Profiler";case te:return"StrictMode";case ce:return"Suspense";case ke:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case me:return(i.displayName||"Context")+".Consumer";case ve:return(i._context.displayName||"Context")+".Provider";case J:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case se:return o=i.displayName||null,o!==null?o:X(i.type)||"Memo";case ue:o=i._payload,i=i._init;try{return X(i(o))}catch{}}return null}function fe(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return X(o);case 8:return o===te?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ge(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ye(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function xe(i){var o=ye(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),g=""+i[o];if(!i.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,T=h.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return w.call(this)},set:function(z){g=""+z,T.call(this,z)}}),Object.defineProperty(i,o,{enumerable:h.enumerable}),{getValue:function(){return g},setValue:function(z){g=""+z},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function ze(i){i._valueTracker||(i._valueTracker=xe(i))}function ne(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var h=o.getValue(),g="";return i&&(g=ye(i)?i.checked?"true":"false":i.value),i=g,i!==h?(o.setValue(i),!0):!1}function xt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function st(i,o){var h=o.checked;return oe({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function wt(i,o){var h=o.defaultValue==null?"":o.defaultValue,g=o.checked!=null?o.checked:o.defaultChecked;h=ge(o.value!=null?o.value:h),i._wrapperState={initialChecked:g,initialValue:h,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function _t(i,o){o=o.checked,o!=null&&N(i,"checked",o,!1)}function $e(i,o){_t(i,o);var h=ge(o.value),g=o.type;if(h!=null)g==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(g==="submit"||g==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?ur(i,o.type,h):o.hasOwnProperty("defaultValue")&&ur(i,o.type,ge(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function It(i,o,h){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var g=o.type;if(!(g!=="submit"&&g!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,h||o===i.value||(i.value=o),i.defaultValue=o}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function ur(i,o,h){(o!=="number"||xt(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var rr=Array.isArray;function Zt(i,o,h,g){if(i=i.options,o){o={};for(var w=0;w<h.length;w++)o["$"+h[w]]=!0;for(h=0;h<i.length;h++)w=o.hasOwnProperty("$"+i[h].value),i[h].selected!==w&&(i[h].selected=w),w&&g&&(i[h].defaultSelected=!0)}else{for(h=""+ge(h),o=null,w=0;w<i.length;w++){if(i[w].value===h){i[w].selected=!0,g&&(i[w].defaultSelected=!0);return}o!==null||i[w].disabled||(o=i[w])}o!==null&&(o.selected=!0)}}function Kt(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return oe({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function yr(i,o){var h=o.value;if(h==null){if(h=o.children,o=o.defaultValue,h!=null){if(o!=null)throw Error(t(92));if(rr(h)){if(1<h.length)throw Error(t(93));h=h[0]}o=h}o==null&&(o=""),h=o}i._wrapperState={initialValue:ge(h)}}function or(i,o){var h=ge(o.value),g=ge(o.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),o.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),g!=null&&(i.defaultValue=""+g)}function nt(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function Mr(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sn(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?Mr(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var nr,Bt=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,h,g,w){MSApp.execUnsafeLocalFunction(function(){return i(o,h,g,w)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(nr=nr||document.createElement("div"),nr.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=nr.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function ft(i,o){if(o){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=o;return}}i.textContent=o}var Dt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Br=["Webkit","ms","Moz","O"];Object.keys(Dt).forEach(function(i){Br.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Dt[o]=Dt[i]})});function qt(i,o,h){return o==null||typeof o=="boolean"||o===""?"":h||typeof o!="number"||o===0||Dt.hasOwnProperty(i)&&Dt[i]?(""+o).trim():o+"px"}function Xr(i,o){i=i.style;for(var h in o)if(o.hasOwnProperty(h)){var g=h.indexOf("--")===0,w=qt(h,o[h],g);h==="float"&&(h="cssFloat"),g?i.setProperty(h,w):i[h]=w}}var ii=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function si(i,o){if(o){if(ii[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function Rn(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ja=null;function Ma(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ba=null,Tn=null,De=null;function Ke(i){if(i=vi(i)){if(typeof Ba!="function")throw Error(t(280));var o=i.stateNode;o&&(o=$o(o),Ba(i.stateNode,i.type,o))}}function Ye(i){Tn?De?De.push(i):De=[i]:Tn=i}function He(){if(Tn){var i=Tn,o=De;if(De=Tn=null,Ke(i),o)for(i=0;i<o.length;i++)Ke(o[i])}}function Qe(i,o){return i(o)}function at(){}var pt=!1;function Xe(i,o,h){if(pt)return i(o,h);pt=!0;try{return Qe(i,o,h)}finally{pt=!1,(Tn!==null||De!==null)&&(at(),He())}}function Ot(i,o){var h=i.stateNode;if(h===null)return null;var g=$o(h);if(g===null)return null;h=g[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(i=i.type,g=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!g;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(t(231,o,typeof h));return h}var ar=!1;if(d)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){ar=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch{ar=!1}function Yt(i,o,h,g,w,T,z,le,he){var Ne=Array.prototype.slice.call(arguments,3);try{o.apply(h,Ne)}catch(Le){this.onError(Le)}}var ct=!1,Je=null,W=!1,re=null,q={onError:function(i){ct=!0,Je=i}};function Q(i,o,h,g,w,T,z,le,he){ct=!1,Je=null,Yt.apply(q,arguments)}function ae(i,o,h,g,w,T,z,le,he){if(Q.apply(this,arguments),ct){if(ct){var Ne=Je;ct=!1,Je=null}else throw Error(t(198));W||(W=!0,re=Ne)}}function ie(i){var o=i,h=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(h=o.return),i=o.return;while(i)}return o.tag===3?h:null}function Se(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Ie(i){if(ie(i)!==i)throw Error(t(188))}function Te(i){var o=i.alternate;if(!o){if(o=ie(i),o===null)throw Error(t(188));return o!==i?null:i}for(var h=i,g=o;;){var w=h.return;if(w===null)break;var T=w.alternate;if(T===null){if(g=w.return,g!==null){h=g;continue}break}if(w.child===T.child){for(T=w.child;T;){if(T===h)return Ie(w),i;if(T===g)return Ie(w),o;T=T.sibling}throw Error(t(188))}if(h.return!==g.return)h=w,g=T;else{for(var z=!1,le=w.child;le;){if(le===h){z=!0,h=w,g=T;break}if(le===g){z=!0,g=w,h=T;break}le=le.sibling}if(!z){for(le=T.child;le;){if(le===h){z=!0,h=T,g=w;break}if(le===g){z=!0,g=T,h=w;break}le=le.sibling}if(!z)throw Error(t(189))}}if(h.alternate!==g)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?i:o}function Ce(i){return i=Te(i),i!==null?Ae(i):null}function Ae(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=Ae(i);if(o!==null)return o;i=i.sibling}return null}var Re=r.unstable_scheduleCallback,Ve=r.unstable_cancelCallback,Ze=r.unstable_shouldYield,Be=r.unstable_requestPaint,Me=r.unstable_now,gt=r.unstable_getCurrentPriorityLevel,$t=r.unstable_ImmediatePriority,Vt=r.unstable_UserBlockingPriority,dr=r.unstable_NormalPriority,pa=r.unstable_LowPriority,En=r.unstable_IdlePriority,jn=null,_r=null;function ga(i){if(_r&&typeof _r.onCommitFiberRoot=="function")try{_r.onCommitFiberRoot(jn,i,void 0,(i.current.flags&128)===128)}catch{}}var ot=Math.clz32?Math.clz32:Fi,ir=Math.log,_o=Math.LN2;function Fi(i){return i>>>=0,i===0?32:31-(ir(i)/_o|0)|0}var va=64,Li=4194304;function yt(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Jt(i,o){var h=i.pendingLanes;if(h===0)return 0;var g=0,w=i.suspendedLanes,T=i.pingedLanes,z=h&268435455;if(z!==0){var le=z&~w;le!==0?g=yt(le):(T&=z,T!==0&&(g=yt(T)))}else z=h&~w,z!==0?g=yt(z):T!==0&&(g=yt(T));if(g===0)return 0;if(o!==0&&o!==g&&(o&w)===0&&(w=g&-g,T=o&-o,w>=T||w===16&&(T&4194240)!==0))return o;if((g&4)!==0&&(g|=h&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=g;0<o;)h=31-ot(o),w=1<<h,g|=i[h],o&=~w;return g}function Ol(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wo(i,o){for(var h=i.suspendedLanes,g=i.pingedLanes,w=i.expirationTimes,T=i.pendingLanes;0<T;){var z=31-ot(T),le=1<<z,he=w[z];he===-1?((le&h)===0||(le&g)!==0)&&(w[z]=Ol(le,o)):he<=o&&(i.expiredLanes|=le),T&=~le}}function Jr(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function iu(){var i=va;return va<<=1,(va&4194240)===0&&(va=64),i}function Ri(i){for(var o=[],h=0;31>h;h++)o.push(i);return o}function Mn(i,o,h){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-ot(o),i[o]=h}function pr(i,o){var h=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var g=i.eventTimes;for(i=i.expirationTimes;0<h;){var w=31-ot(h),T=1<<w;o[w]=0,g[w]=-1,i[w]=-1,h&=~T}}function xa(i,o){var h=i.entangledLanes|=o;for(i=i.entanglements;h;){var g=31-ot(h),w=1<<g;w&o|i[g]&o&&(i[g]|=o),h&=~w}}var Pt=0;function ji(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var ko,oi,bo,So,As,Ps=!1,Mi=[],Bn=null,ya=null,Xn=null,Ns=new Map,ht=new Map,Pr=[],Ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fl(i,o){switch(i){case"focusin":case"focusout":Bn=null;break;case"dragenter":case"dragleave":ya=null;break;case"mouseover":case"mouseout":Xn=null;break;case"pointerover":case"pointerout":Ns.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ht.delete(o.pointerId)}}function li(i,o,h,g,w,T){return i===null||i.nativeEvent!==T?(i={blockedOn:o,domEventName:h,eventSystemFlags:g,nativeEvent:T,targetContainers:[w]},o!==null&&(o=vi(o),o!==null&&oi(o)),i):(i.eventSystemFlags|=g,o=i.targetContainers,w!==null&&o.indexOf(w)===-1&&o.push(w),i)}function Ll(i,o,h,g,w){switch(o){case"focusin":return Bn=li(Bn,i,o,h,g,w),!0;case"dragenter":return ya=li(ya,i,o,h,g,w),!0;case"mouseover":return Xn=li(Xn,i,o,h,g,w),!0;case"pointerover":var T=w.pointerId;return Ns.set(T,li(Ns.get(T)||null,i,o,h,g,w)),!0;case"gotpointercapture":return T=w.pointerId,ht.set(T,li(ht.get(T)||null,i,o,h,g,w)),!0}return!1}function To(i){var o=gi(i.target);if(o!==null){var h=ie(o);if(h!==null){if(o=h.tag,o===13){if(o=Se(h),o!==null){i.blockedOn=o,As(i.priority,function(){bo(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Jn(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var h=Ao(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var g=new h.constructor(h.type,h);ja=g,h.target.dispatchEvent(g),ja=null}else return o=vi(h),o!==null&&oi(o),i.blockedOn=h,!1;o.shift()}return!0}function Eo(i,o,h){Jn(i)&&h.delete(o)}function Is(){Ps=!1,Bn!==null&&Jn(Bn)&&(Bn=null),ya!==null&&Jn(ya)&&(ya=null),Xn!==null&&Jn(Xn)&&(Xn=null),Ns.forEach(Eo),ht.forEach(Eo)}function fr(i,o){i.blockedOn===o&&(i.blockedOn=null,Ps||(Ps=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Is)))}function zn(i){function o(w){return fr(w,i)}if(0<Mi.length){fr(Mi[0],i);for(var h=1;h<Mi.length;h++){var g=Mi[h];g.blockedOn===i&&(g.blockedOn=null)}}for(Bn!==null&&fr(Bn,i),ya!==null&&fr(ya,i),Xn!==null&&fr(Xn,i),Ns.forEach(o),ht.forEach(o),h=0;h<Pr.length;h++)g=Pr[h],g.blockedOn===i&&(g.blockedOn=null);for(;0<Pr.length&&(h=Pr[0],h.blockedOn===null);)To(h),h.blockedOn===null&&Pr.shift()}var ci=U.ReactCurrentBatchConfig,Ds=!0;function mf(i,o,h,g){var w=Pt,T=ci.transition;ci.transition=null;try{Pt=1,Os(i,o,h,g)}finally{Pt=w,ci.transition=T}}function su(i,o,h,g){var w=Pt,T=ci.transition;ci.transition=null;try{Pt=4,Os(i,o,h,g)}finally{Pt=w,ci.transition=T}}function Os(i,o,h,g){if(Ds){var w=Ao(i,o,h,g);if(w===null)s(i,o,g,Co,h),Fl(i,g);else if(Ll(w,i,o,h,g))g.stopPropagation();else if(Fl(i,g),o&4&&-1<Ht.indexOf(i)){for(;w!==null;){var T=vi(w);if(T!==null&&ko(T),T=Ao(i,o,h,g),T===null&&s(i,o,g,Co,h),T===w)break;w=T}w!==null&&g.stopPropagation()}else s(i,o,g,null,h)}}var Co=null;function Ao(i,o,h,g){if(Co=null,i=Ma(g),i=gi(i),i!==null)if(o=ie(i),o===null)i=null;else if(h=o.tag,h===13){if(i=Se(o),i!==null)return i;i=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Co=i,null}function Ct(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gt()){case $t:return 1;case Vt:return 4;case dr:case pa:return 16;case En:return 536870912;default:return 16}default:return 16}}var za=null,hn=null,Ua=null;function Rl(){if(Ua)return Ua;var i,o=hn,h=o.length,g,w="value"in za?za.value:za.textContent,T=w.length;for(i=0;i<h&&o[i]===w[i];i++);var z=h-i;for(g=1;g<=z&&o[h-g]===w[T-g];g++);return Ua=w.slice(i,1<g?1-g:void 0)}function Po(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Bi(){return!0}function ou(){return!1}function Qr(i){function o(h,g,w,T,z){this._reactName=h,this._targetInst=w,this.type=g,this.nativeEvent=T,this.target=z,this.currentTarget=null;for(var le in i)i.hasOwnProperty(le)&&(h=i[le],this[le]=h?h(T):T[le]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Bi:ou,this.isPropagationStopped=ou,this}return oe(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Bi)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Bi)},persist:function(){},isPersistent:Bi}),o}var zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jl=Qr(zi),ui=oe({},zi,{view:0,detail:0}),pf=Qr(ui),Cn,Ml,Ui,Un=oe({},ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fi,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ui&&(Ui&&i.type==="mousemove"?(Cn=i.screenX-Ui.screenX,Ml=i.screenY-Ui.screenY):Ml=Cn=0,Ui=i),Cn)},movementY:function(i){return"movementY"in i?i.movementY:Ml}}),Bl=Qr(Un),lu=oe({},Un,{dataTransfer:0}),zl=Qr(lu),gf=oe({},ui,{relatedTarget:0}),No=Qr(gf),cu=oe({},zi,{animationName:0,elapsedTime:0,pseudoElement:0}),vf=Qr(cu),xf=oe({},zi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ul=Qr(xf),yf=oe({},zi,{data:0}),$l=Qr(yf),uu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Io={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},di={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _f(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=di[i])?!!o[i]:!1}function fi(){return _f}var An=oe({},ui,{key:function(i){if(i.key){var o=uu[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Po(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Io[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fi,charCode:function(i){return i.type==="keypress"?Po(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Po(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),du=Qr(An),fu=oe({},Un,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hu=Qr(fu),Wl=oe({},ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fi}),Vl=Qr(Wl),wf=oe({},zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),kf=Qr(wf),mu=oe({},Un,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),bf=Qr(mu),$n=[9,13,27,32],$a=d&&"CompositionEvent"in window,Fs=null;d&&"documentMode"in document&&(Fs=document.documentMode);var _a=d&&"TextEvent"in window&&!Fs,pu=d&&(!$a||Fs&&8<Fs&&11>=Fs),hi=" ",gu=!1;function $i(i,o){switch(i){case"keyup":return $n.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hl(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var wa=!1;function Sf(i,o){switch(i){case"compositionend":return Hl(o);case"keypress":return o.which!==32?null:(gu=!0,hi);case"textInput":return i=o.data,i===hi&&gu?null:i;default:return null}}function Wa(i,o){if(wa)return i==="compositionend"||!$a&&$i(i,o)?(i=Rl(),Ua=hn=za=null,wa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return pu&&o.locale!=="ko"?null:o.data;default:return null}}var Do={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vu(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Do[i.type]:o==="textarea"}function Oo(i,o,h,g){Ye(g),o=p(o,"onChange"),0<o.length&&(h=new jl("onChange","change",null,h,g),i.push({event:h,listeners:o}))}var Ls=null,mn=null;function Tf(i){ec(i,0)}function ka(i){var o=xi(i);if(ne(o))return i}function Ef(i,o){if(i==="change")return o}var Qn=!1;if(d){var Wi;if(d){var Fo="oninput"in document;if(!Fo){var Lo=document.createElement("div");Lo.setAttribute("oninput","return;"),Fo=typeof Lo.oninput=="function"}Wi=Fo}else Wi=!1;Qn=Wi&&(!document.documentMode||9<document.documentMode)}function Rs(){Ls&&(Ls.detachEvent("onpropertychange",Ro),mn=Ls=null)}function Ro(i){if(i.propertyName==="value"&&ka(mn)){var o=[];Oo(o,mn,i,Ma(i)),Xe(Tf,o)}}function jo(i,o,h){i==="focusin"?(Rs(),Ls=o,mn=h,Ls.attachEvent("onpropertychange",Ro)):i==="focusout"&&Rs()}function Vi(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ka(mn)}function Mo(i,o){if(i==="click")return ka(o)}function Gl(i,o){if(i==="input"||i==="change")return ka(o)}function xu(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Wn=typeof Object.is=="function"?Object.is:xu;function Va(i,o){if(Wn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var h=Object.keys(i),g=Object.keys(o);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var w=h[g];if(!m.call(o,w)||!Wn(i[w],o[w]))return!1}return!0}function yu(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Zl(i,o){var h=yu(i);i=0;for(var g;h;){if(h.nodeType===3){if(g=i+h.textContent.length,i<=o&&g>=o)return{node:h,offset:o-i};i=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=yu(h)}}function _u(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?_u(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Kl(){for(var i=window,o=xt();o instanceof i.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)i=o.contentWindow;else break;o=xt(i.document)}return o}function ql(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function ea(i){var o=Kl(),h=i.focusedElem,g=i.selectionRange;if(o!==h&&h&&h.ownerDocument&&_u(h.ownerDocument.documentElement,h)){if(g!==null&&ql(h)){if(o=g.start,i=g.end,i===void 0&&(i=o),"selectionStart"in h)h.selectionStart=o,h.selectionEnd=Math.min(i,h.value.length);else if(i=(o=h.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var w=h.textContent.length,T=Math.min(g.start,w);g=g.end===void 0?T:Math.min(g.end,w),!i.extend&&T>g&&(w=g,g=T,T=w),w=Zl(h,T);var z=Zl(h,g);w&&z&&(i.rangeCount!==1||i.anchorNode!==w.node||i.anchorOffset!==w.offset||i.focusNode!==z.node||i.focusOffset!==z.offset)&&(o=o.createRange(),o.setStart(w.node,w.offset),i.removeAllRanges(),T>g?(i.addRange(o),i.extend(z.node,z.offset)):(o.setEnd(z.node,z.offset),i.addRange(o)))}}for(o=[],i=h;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<o.length;h++)i=o[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Bo=d&&"documentMode"in document&&11>=document.documentMode,Hi=null,Gi=null,js=null,zo=!1;function wu(i,o,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;zo||Hi==null||Hi!==xt(g)||(g=Hi,"selectionStart"in g&&ql(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),js&&Va(js,g)||(js=g,g=p(Gi,"onSelect"),0<g.length&&(o=new jl("onSelect","select",null,o,h),i.push({event:o,listeners:g}),o.target=Hi)))}function Ha(i,o){var h={};return h[i.toLowerCase()]=o.toLowerCase(),h["Webkit"+i]="webkit"+o,h["Moz"+i]="moz"+o,h}var Zi={animationend:Ha("Animation","AnimationEnd"),animationiteration:Ha("Animation","AnimationIteration"),animationstart:Ha("Animation","AnimationStart"),transitionend:Ha("Transition","TransitionEnd")},Ga={},Yl={};d&&(Yl=document.createElement("div").style,"AnimationEvent"in window||(delete Zi.animationend.animation,delete Zi.animationiteration.animation,delete Zi.animationstart.animation),"TransitionEvent"in window||delete Zi.transitionend.transition);function Ms(i){if(Ga[i])return Ga[i];if(!Zi[i])return i;var o=Zi[i],h;for(h in o)if(o.hasOwnProperty(h)&&h in Yl)return Ga[i]=o[h];return i}var ku=Ms("animationend"),ta=Ms("animationiteration"),Xl=Ms("animationstart"),Jl=Ms("transitionend"),Ki=new Map,bu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vn(i,o){Ki.set(i,o),l(o,[i])}for(var mi=0;mi<bu.length;mi++){var Uo=bu[mi],Su=Uo.toLowerCase(),Cf=Uo[0].toUpperCase()+Uo.slice(1);Vn(Su,"on"+Cf)}Vn(ku,"onAnimationEnd"),Vn(ta,"onAnimationIteration"),Vn(Xl,"onAnimationStart"),Vn("dblclick","onDoubleClick"),Vn("focusin","onFocus"),Vn("focusout","onBlur"),Vn(Jl,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tu=new Set("cancel close invalid load scroll toggle".split(" ").concat(qi));function Ql(i,o,h){var g=i.type||"unknown-event";i.currentTarget=h,ae(g,o,void 0,i),i.currentTarget=null}function ec(i,o){o=(o&4)!==0;for(var h=0;h<i.length;h++){var g=i[h],w=g.event;g=g.listeners;e:{var T=void 0;if(o)for(var z=g.length-1;0<=z;z--){var le=g[z],he=le.instance,Ne=le.currentTarget;if(le=le.listener,he!==T&&w.isPropagationStopped())break e;Ql(w,le,Ne),T=he}else for(z=0;z<g.length;z++){if(le=g[z],he=le.instance,Ne=le.currentTarget,le=le.listener,he!==T&&w.isPropagationStopped())break e;Ql(w,le,Ne),T=he}}}if(W)throw i=re,W=!1,re=null,i}function Gt(i,o){var h=o[Qi];h===void 0&&(h=o[Qi]=new Set);var g=i+"__bubble";h.has(g)||(Eu(o,i,2,!1),h.add(g))}function tc(i,o,h){var g=0;o&&(g|=4),Eu(h,i,g,o)}var Bs="_reactListening"+Math.random().toString(36).slice(2);function Yi(i){if(!i[Bs]){i[Bs]=!0,n.forEach(function(h){h!=="selectionchange"&&(Tu.has(h)||tc(h,!1,i),tc(h,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Bs]||(o[Bs]=!0,tc("selectionchange",!1,o))}}function Eu(i,o,h,g){switch(Ct(o)){case 1:var w=mf;break;case 4:w=su;break;default:w=Os}h=w.bind(null,o,h,i),w=void 0,!ar||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(w=!0),g?w!==void 0?i.addEventListener(o,h,{capture:!0,passive:w}):i.addEventListener(o,h,!0):w!==void 0?i.addEventListener(o,h,{passive:w}):i.addEventListener(o,h,!1)}function s(i,o,h,g,w){var T=g;if((o&1)===0&&(o&2)===0&&g!==null)e:for(;;){if(g===null)return;var z=g.tag;if(z===3||z===4){var le=g.stateNode.containerInfo;if(le===w||le.nodeType===8&&le.parentNode===w)break;if(z===4)for(z=g.return;z!==null;){var he=z.tag;if((he===3||he===4)&&(he=z.stateNode.containerInfo,he===w||he.nodeType===8&&he.parentNode===w))return;z=z.return}for(;le!==null;){if(z=gi(le),z===null)return;if(he=z.tag,he===5||he===6){g=T=z;continue e}le=le.parentNode}}g=g.return}Xe(function(){var Ne=T,Le=Ma(h),je=[];e:{var Fe=Ki.get(i);if(Fe!==void 0){var qe=jl,tt=i;switch(i){case"keypress":if(Po(h)===0)break e;case"keydown":case"keyup":qe=du;break;case"focusin":tt="focus",qe=No;break;case"focusout":tt="blur",qe=No;break;case"beforeblur":case"afterblur":qe=No;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=Bl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=zl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=Vl;break;case ku:case ta:case Xl:qe=vf;break;case Jl:qe=kf;break;case"scroll":qe=pf;break;case"wheel":qe=bf;break;case"copy":case"cut":case"paste":qe=Ul;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=hu}var rt=(o&4)!==0,wr=!rt&&i==="scroll",be=rt?Fe!==null?Fe+"Capture":null:Fe;rt=[];for(var pe=Ne,Ee;pe!==null;){Ee=pe;var Ue=Ee.stateNode;if(Ee.tag===5&&Ue!==null&&(Ee=Ue,be!==null&&(Ue=Ot(pe,be),Ue!=null&&rt.push(u(pe,Ue,Ee)))),wr)break;pe=pe.return}0<rt.length&&(Fe=new qe(Fe,tt,null,h,Le),je.push({event:Fe,listeners:rt}))}}if((o&7)===0){e:{if(Fe=i==="mouseover"||i==="pointerover",qe=i==="mouseout"||i==="pointerout",Fe&&h!==ja&&(tt=h.relatedTarget||h.fromElement)&&(gi(tt)||tt[zt]))break e;if((qe||Fe)&&(Fe=Le.window===Le?Le:(Fe=Le.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,qe?(tt=h.relatedTarget||h.toElement,qe=Ne,tt=tt?gi(tt):null,tt!==null&&(wr=ie(tt),tt!==wr||tt.tag!==5&&tt.tag!==6)&&(tt=null)):(qe=null,tt=Ne),qe!==tt)){if(rt=Bl,Ue="onMouseLeave",be="onMouseEnter",pe="mouse",(i==="pointerout"||i==="pointerover")&&(rt=hu,Ue="onPointerLeave",be="onPointerEnter",pe="pointer"),wr=qe==null?Fe:xi(qe),Ee=tt==null?Fe:xi(tt),Fe=new rt(Ue,pe+"leave",qe,h,Le),Fe.target=wr,Fe.relatedTarget=Ee,Ue=null,gi(Le)===Ne&&(rt=new rt(be,pe+"enter",tt,h,Le),rt.target=Ee,rt.relatedTarget=wr,Ue=rt),wr=Ue,qe&&tt)t:{for(rt=qe,be=tt,pe=0,Ee=rt;Ee;Ee=_(Ee))pe++;for(Ee=0,Ue=be;Ue;Ue=_(Ue))Ee++;for(;0<pe-Ee;)rt=_(rt),pe--;for(;0<Ee-pe;)be=_(be),Ee--;for(;pe--;){if(rt===be||be!==null&&rt===be.alternate)break t;rt=_(rt),be=_(be)}rt=null}else rt=null;qe!==null&&C(je,Fe,qe,rt,!1),tt!==null&&wr!==null&&C(je,wr,tt,rt,!0)}}e:{if(Fe=Ne?xi(Ne):window,qe=Fe.nodeName&&Fe.nodeName.toLowerCase(),qe==="select"||qe==="input"&&Fe.type==="file")var it=Ef;else if(vu(Fe))if(Qn)it=Gl;else{it=Vi;var ut=jo}else(qe=Fe.nodeName)&&qe.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(it=Mo);if(it&&(it=it(i,Ne))){Oo(je,it,h,Le);break e}ut&&ut(i,Fe,Ne),i==="focusout"&&(ut=Fe._wrapperState)&&ut.controlled&&Fe.type==="number"&&ur(Fe,"number",Fe.value)}switch(ut=Ne?xi(Ne):window,i){case"focusin":(vu(ut)||ut.contentEditable==="true")&&(Hi=ut,Gi=Ne,js=null);break;case"focusout":js=Gi=Hi=null;break;case"mousedown":zo=!0;break;case"contextmenu":case"mouseup":case"dragend":zo=!1,wu(je,h,Le);break;case"selectionchange":if(Bo)break;case"keydown":case"keyup":wu(je,h,Le)}var dt;if($a)e:{switch(i){case"compositionstart":var vt="onCompositionStart";break e;case"compositionend":vt="onCompositionEnd";break e;case"compositionupdate":vt="onCompositionUpdate";break e}vt=void 0}else wa?$i(i,h)&&(vt="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(vt="onCompositionStart");vt&&(pu&&h.locale!=="ko"&&(wa||vt!=="onCompositionStart"?vt==="onCompositionEnd"&&wa&&(dt=Rl()):(za=Le,hn="value"in za?za.value:za.textContent,wa=!0)),ut=p(Ne,vt),0<ut.length&&(vt=new $l(vt,i,null,h,Le),je.push({event:vt,listeners:ut}),dt?vt.data=dt:(dt=Hl(h),dt!==null&&(vt.data=dt)))),(dt=_a?Sf(i,h):Wa(i,h))&&(Ne=p(Ne,"onBeforeInput"),0<Ne.length&&(Le=new $l("onBeforeInput","beforeinput",null,h,Le),je.push({event:Le,listeners:Ne}),Le.data=dt))}ec(je,o)})}function u(i,o,h){return{instance:i,listener:o,currentTarget:h}}function p(i,o){for(var h=o+"Capture",g=[];i!==null;){var w=i,T=w.stateNode;w.tag===5&&T!==null&&(w=T,T=Ot(i,h),T!=null&&g.unshift(u(i,T,w)),T=Ot(i,o),T!=null&&g.push(u(i,T,w))),i=i.return}return g}function _(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function C(i,o,h,g,w){for(var T=o._reactName,z=[];h!==null&&h!==g;){var le=h,he=le.alternate,Ne=le.stateNode;if(he!==null&&he===g)break;le.tag===5&&Ne!==null&&(le=Ne,w?(he=Ot(h,T),he!=null&&z.unshift(u(h,he,le))):w||(he=Ot(h,T),he!=null&&z.push(u(h,he,le)))),h=h.return}z.length!==0&&i.push({event:o,listeners:z})}var V=/\r\n?/g,de=/\u0000|\uFFFD/g;function we(i){return(typeof i=="string"?i:""+i).replace(V,`
`).replace(de,"")}function Pe(i,o,h){if(o=we(o),we(i)!==o&&h)throw Error(t(425))}function Oe(){}var Ge=null,lt=null;function bt(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Nr=typeof setTimeout=="function"?setTimeout:void 0,br=typeof clearTimeout=="function"?clearTimeout:void 0,pn=typeof Promise=="function"?Promise:void 0,en=typeof queueMicrotask=="function"?queueMicrotask:typeof pn<"u"?function(i){return pn.resolve(null).then(i).catch(Xi)}:Nr;function Xi(i){setTimeout(function(){throw i})}function rc(i,o){var h=o,g=0;do{var w=h.nextSibling;if(i.removeChild(h),w&&w.nodeType===8)if(h=w.data,h==="/$"){if(g===0){i.removeChild(w),zn(o);return}g--}else h!=="$"&&h!=="$?"&&h!=="$!"||g++;h=w}while(h);zn(o)}function Za(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Cu(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(o===0)return i;o--}else h==="/$"&&o++}i=i.previousSibling}return null}var pi=Math.random().toString(36).slice(2),ra="__reactFiber$"+pi,Ji="__reactProps$"+pi,zt="__reactContainer$"+pi,Qi="__reactEvents$"+pi,Af="__reactListeners$"+pi,Pf="__reactHandles$"+pi;function gi(i){var o=i[ra];if(o)return o;for(var h=i.parentNode;h;){if(o=h[zt]||h[ra]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(i=Cu(i);i!==null;){if(h=i[ra])return h;i=Cu(i)}return o}i=h,h=i.parentNode}return null}function vi(i){return i=i[ra]||i[zt],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function xi(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function $o(i){return i[Ji]||null}var Nf=[],Wo=-1;function es(i){return{current:i}}function sr(i){0>Wo||(i.current=Nf[Wo],Nf[Wo]=null,Wo--)}function Qt(i,o){Wo++,Nf[Wo]=i.current,i.current=o}var ts={},tn=es(ts),Pn=es(!1),zs=ts;function Vo(i,o){var h=i.type.contextTypes;if(!h)return ts;var g=i.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===o)return g.__reactInternalMemoizedMaskedChildContext;var w={},T;for(T in h)w[T]=o[T];return g&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=w),w}function Nn(i){return i=i.childContextTypes,i!=null}function Au(){sr(Pn),sr(tn)}function Tm(i,o,h){if(tn.current!==ts)throw Error(t(168));Qt(tn,o),Qt(Pn,h)}function Em(i,o,h){var g=i.stateNode;if(o=o.childContextTypes,typeof g.getChildContext!="function")return h;g=g.getChildContext();for(var w in g)if(!(w in o))throw Error(t(108,fe(i)||"Unknown",w));return oe({},h,g)}function Pu(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ts,zs=tn.current,Qt(tn,i),Qt(Pn,Pn.current),!0}function Cm(i,o,h){var g=i.stateNode;if(!g)throw Error(t(169));h?(i=Em(i,o,zs),g.__reactInternalMemoizedMergedChildContext=i,sr(Pn),sr(tn),Qt(tn,i)):sr(Pn),Qt(Pn,h)}var yi=null,Nu=!1,If=!1;function Am(i){yi===null?yi=[i]:yi.push(i)}function Wy(i){Nu=!0,Am(i)}function rs(){if(!If&&yi!==null){If=!0;var i=0,o=Pt;try{var h=yi;for(Pt=1;i<h.length;i++){var g=h[i];do g=g(!0);while(g!==null)}yi=null,Nu=!1}catch(w){throw yi!==null&&(yi=yi.slice(i+1)),Re($t,rs),w}finally{Pt=o,If=!1}}return null}var Ho=[],Go=0,Iu=null,Du=0,na=[],aa=0,Us=null,_i=1,wi="";function $s(i,o){Ho[Go++]=Du,Ho[Go++]=Iu,Iu=i,Du=o}function Pm(i,o,h){na[aa++]=_i,na[aa++]=wi,na[aa++]=Us,Us=i;var g=_i;i=wi;var w=32-ot(g)-1;g&=~(1<<w),h+=1;var T=32-ot(o)+w;if(30<T){var z=w-w%5;T=(g&(1<<z)-1).toString(32),g>>=z,w-=z,_i=1<<32-ot(o)+w|h<<w|g,wi=T+i}else _i=1<<T|h<<w|g,wi=i}function Df(i){i.return!==null&&($s(i,1),Pm(i,1,0))}function Of(i){for(;i===Iu;)Iu=Ho[--Go],Ho[Go]=null,Du=Ho[--Go],Ho[Go]=null;for(;i===Us;)Us=na[--aa],na[aa]=null,wi=na[--aa],na[aa]=null,_i=na[--aa],na[aa]=null}var Hn=null,Gn=null,lr=!1,ba=null;function Nm(i,o){var h=la(5,null,null,0);h.elementType="DELETED",h.stateNode=o,h.return=i,o=i.deletions,o===null?(i.deletions=[h],i.flags|=16):o.push(h)}function Im(i,o){switch(i.tag){case 5:var h=i.type;return o=o.nodeType!==1||h.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Hn=i,Gn=Za(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Hn=i,Gn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(h=Us!==null?{id:_i,overflow:wi}:null,i.memoizedState={dehydrated:o,treeContext:h,retryLane:1073741824},h=la(18,null,null,0),h.stateNode=o,h.return=i,i.child=h,Hn=i,Gn=null,!0):!1;default:return!1}}function Ff(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Lf(i){if(lr){var o=Gn;if(o){var h=o;if(!Im(i,o)){if(Ff(i))throw Error(t(418));o=Za(h.nextSibling);var g=Hn;o&&Im(i,o)?Nm(g,h):(i.flags=i.flags&-4097|2,lr=!1,Hn=i)}}else{if(Ff(i))throw Error(t(418));i.flags=i.flags&-4097|2,lr=!1,Hn=i}}}function Dm(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Hn=i}function Ou(i){if(i!==Hn)return!1;if(!lr)return Dm(i),lr=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!bt(i.type,i.memoizedProps)),o&&(o=Gn)){if(Ff(i))throw Om(),Error(t(418));for(;o;)Nm(i,o),o=Za(o.nextSibling)}if(Dm(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(o===0){Gn=Za(i.nextSibling);break e}o--}else h!=="$"&&h!=="$!"&&h!=="$?"||o++}i=i.nextSibling}Gn=null}}else Gn=Hn?Za(i.stateNode.nextSibling):null;return!0}function Om(){for(var i=Gn;i;)i=Za(i.nextSibling)}function Zo(){Gn=Hn=null,lr=!1}function Rf(i){ba===null?ba=[i]:ba.push(i)}var Vy=U.ReactCurrentBatchConfig;function nc(i,o,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var g=h.stateNode}if(!g)throw Error(t(147,i));var w=g,T=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===T?o.ref:(o=function(z){var le=w.refs;z===null?delete le[T]:le[T]=z},o._stringRef=T,o)}if(typeof i!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,i))}return i}function Fu(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Fm(i){var o=i._init;return o(i._payload)}function Lm(i){function o(be,pe){if(i){var Ee=be.deletions;Ee===null?(be.deletions=[pe],be.flags|=16):Ee.push(pe)}}function h(be,pe){if(!i)return null;for(;pe!==null;)o(be,pe),pe=pe.sibling;return null}function g(be,pe){for(be=new Map;pe!==null;)pe.key!==null?be.set(pe.key,pe):be.set(pe.index,pe),pe=pe.sibling;return be}function w(be,pe){return be=us(be,pe),be.index=0,be.sibling=null,be}function T(be,pe,Ee){return be.index=Ee,i?(Ee=be.alternate,Ee!==null?(Ee=Ee.index,Ee<pe?(be.flags|=2,pe):Ee):(be.flags|=2,pe)):(be.flags|=1048576,pe)}function z(be){return i&&be.alternate===null&&(be.flags|=2),be}function le(be,pe,Ee,Ue){return pe===null||pe.tag!==6?(pe=Ch(Ee,be.mode,Ue),pe.return=be,pe):(pe=w(pe,Ee),pe.return=be,pe)}function he(be,pe,Ee,Ue){var it=Ee.type;return it===D?Le(be,pe,Ee.props.children,Ue,Ee.key):pe!==null&&(pe.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===ue&&Fm(it)===pe.type)?(Ue=w(pe,Ee.props),Ue.ref=nc(be,pe,Ee),Ue.return=be,Ue):(Ue=ad(Ee.type,Ee.key,Ee.props,null,be.mode,Ue),Ue.ref=nc(be,pe,Ee),Ue.return=be,Ue)}function Ne(be,pe,Ee,Ue){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==Ee.containerInfo||pe.stateNode.implementation!==Ee.implementation?(pe=Ah(Ee,be.mode,Ue),pe.return=be,pe):(pe=w(pe,Ee.children||[]),pe.return=be,pe)}function Le(be,pe,Ee,Ue,it){return pe===null||pe.tag!==7?(pe=Ys(Ee,be.mode,Ue,it),pe.return=be,pe):(pe=w(pe,Ee),pe.return=be,pe)}function je(be,pe,Ee){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return pe=Ch(""+pe,be.mode,Ee),pe.return=be,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case K:return Ee=ad(pe.type,pe.key,pe.props,null,be.mode,Ee),Ee.ref=nc(be,null,pe),Ee.return=be,Ee;case B:return pe=Ah(pe,be.mode,Ee),pe.return=be,pe;case ue:var Ue=pe._init;return je(be,Ue(pe._payload),Ee)}if(rr(pe)||Z(pe))return pe=Ys(pe,be.mode,Ee,null),pe.return=be,pe;Fu(be,pe)}return null}function Fe(be,pe,Ee,Ue){var it=pe!==null?pe.key:null;if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return it!==null?null:le(be,pe,""+Ee,Ue);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case K:return Ee.key===it?he(be,pe,Ee,Ue):null;case B:return Ee.key===it?Ne(be,pe,Ee,Ue):null;case ue:return it=Ee._init,Fe(be,pe,it(Ee._payload),Ue)}if(rr(Ee)||Z(Ee))return it!==null?null:Le(be,pe,Ee,Ue,null);Fu(be,Ee)}return null}function qe(be,pe,Ee,Ue,it){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return be=be.get(Ee)||null,le(pe,be,""+Ue,it);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case K:return be=be.get(Ue.key===null?Ee:Ue.key)||null,he(pe,be,Ue,it);case B:return be=be.get(Ue.key===null?Ee:Ue.key)||null,Ne(pe,be,Ue,it);case ue:var ut=Ue._init;return qe(be,pe,Ee,ut(Ue._payload),it)}if(rr(Ue)||Z(Ue))return be=be.get(Ee)||null,Le(pe,be,Ue,it,null);Fu(pe,Ue)}return null}function tt(be,pe,Ee,Ue){for(var it=null,ut=null,dt=pe,vt=pe=0,$r=null;dt!==null&&vt<Ee.length;vt++){dt.index>vt?($r=dt,dt=null):$r=dt.sibling;var Mt=Fe(be,dt,Ee[vt],Ue);if(Mt===null){dt===null&&(dt=$r);break}i&&dt&&Mt.alternate===null&&o(be,dt),pe=T(Mt,pe,vt),ut===null?it=Mt:ut.sibling=Mt,ut=Mt,dt=$r}if(vt===Ee.length)return h(be,dt),lr&&$s(be,vt),it;if(dt===null){for(;vt<Ee.length;vt++)dt=je(be,Ee[vt],Ue),dt!==null&&(pe=T(dt,pe,vt),ut===null?it=dt:ut.sibling=dt,ut=dt);return lr&&$s(be,vt),it}for(dt=g(be,dt);vt<Ee.length;vt++)$r=qe(dt,be,vt,Ee[vt],Ue),$r!==null&&(i&&$r.alternate!==null&&dt.delete($r.key===null?vt:$r.key),pe=T($r,pe,vt),ut===null?it=$r:ut.sibling=$r,ut=$r);return i&&dt.forEach(function(ds){return o(be,ds)}),lr&&$s(be,vt),it}function rt(be,pe,Ee,Ue){var it=Z(Ee);if(typeof it!="function")throw Error(t(150));if(Ee=it.call(Ee),Ee==null)throw Error(t(151));for(var ut=it=null,dt=pe,vt=pe=0,$r=null,Mt=Ee.next();dt!==null&&!Mt.done;vt++,Mt=Ee.next()){dt.index>vt?($r=dt,dt=null):$r=dt.sibling;var ds=Fe(be,dt,Mt.value,Ue);if(ds===null){dt===null&&(dt=$r);break}i&&dt&&ds.alternate===null&&o(be,dt),pe=T(ds,pe,vt),ut===null?it=ds:ut.sibling=ds,ut=ds,dt=$r}if(Mt.done)return h(be,dt),lr&&$s(be,vt),it;if(dt===null){for(;!Mt.done;vt++,Mt=Ee.next())Mt=je(be,Mt.value,Ue),Mt!==null&&(pe=T(Mt,pe,vt),ut===null?it=Mt:ut.sibling=Mt,ut=Mt);return lr&&$s(be,vt),it}for(dt=g(be,dt);!Mt.done;vt++,Mt=Ee.next())Mt=qe(dt,be,vt,Mt.value,Ue),Mt!==null&&(i&&Mt.alternate!==null&&dt.delete(Mt.key===null?vt:Mt.key),pe=T(Mt,pe,vt),ut===null?it=Mt:ut.sibling=Mt,ut=Mt);return i&&dt.forEach(function(b_){return o(be,b_)}),lr&&$s(be,vt),it}function wr(be,pe,Ee,Ue){if(typeof Ee=="object"&&Ee!==null&&Ee.type===D&&Ee.key===null&&(Ee=Ee.props.children),typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case K:e:{for(var it=Ee.key,ut=pe;ut!==null;){if(ut.key===it){if(it=Ee.type,it===D){if(ut.tag===7){h(be,ut.sibling),pe=w(ut,Ee.props.children),pe.return=be,be=pe;break e}}else if(ut.elementType===it||typeof it=="object"&&it!==null&&it.$$typeof===ue&&Fm(it)===ut.type){h(be,ut.sibling),pe=w(ut,Ee.props),pe.ref=nc(be,ut,Ee),pe.return=be,be=pe;break e}h(be,ut);break}else o(be,ut);ut=ut.sibling}Ee.type===D?(pe=Ys(Ee.props.children,be.mode,Ue,Ee.key),pe.return=be,be=pe):(Ue=ad(Ee.type,Ee.key,Ee.props,null,be.mode,Ue),Ue.ref=nc(be,pe,Ee),Ue.return=be,be=Ue)}return z(be);case B:e:{for(ut=Ee.key;pe!==null;){if(pe.key===ut)if(pe.tag===4&&pe.stateNode.containerInfo===Ee.containerInfo&&pe.stateNode.implementation===Ee.implementation){h(be,pe.sibling),pe=w(pe,Ee.children||[]),pe.return=be,be=pe;break e}else{h(be,pe);break}else o(be,pe);pe=pe.sibling}pe=Ah(Ee,be.mode,Ue),pe.return=be,be=pe}return z(be);case ue:return ut=Ee._init,wr(be,pe,ut(Ee._payload),Ue)}if(rr(Ee))return tt(be,pe,Ee,Ue);if(Z(Ee))return rt(be,pe,Ee,Ue);Fu(be,Ee)}return typeof Ee=="string"&&Ee!==""||typeof Ee=="number"?(Ee=""+Ee,pe!==null&&pe.tag===6?(h(be,pe.sibling),pe=w(pe,Ee),pe.return=be,be=pe):(h(be,pe),pe=Ch(Ee,be.mode,Ue),pe.return=be,be=pe),z(be)):h(be,pe)}return wr}var Ko=Lm(!0),Rm=Lm(!1),Lu=es(null),Ru=null,qo=null,jf=null;function Mf(){jf=qo=Ru=null}function Bf(i){var o=Lu.current;sr(Lu),i._currentValue=o}function zf(i,o,h){for(;i!==null;){var g=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),i===h)break;i=i.return}}function Yo(i,o){Ru=i,jf=qo=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(In=!0),i.firstContext=null)}function ia(i){var o=i._currentValue;if(jf!==i)if(i={context:i,memoizedValue:o,next:null},qo===null){if(Ru===null)throw Error(t(308));qo=i,Ru.dependencies={lanes:0,firstContext:i}}else qo=qo.next=i;return o}var Ws=null;function Uf(i){Ws===null?Ws=[i]:Ws.push(i)}function jm(i,o,h,g){var w=o.interleaved;return w===null?(h.next=h,Uf(o)):(h.next=w.next,w.next=h),o.interleaved=h,ki(i,g)}function ki(i,o){i.lanes|=o;var h=i.alternate;for(h!==null&&(h.lanes|=o),h=i,i=i.return;i!==null;)i.childLanes|=o,h=i.alternate,h!==null&&(h.childLanes|=o),h=i,i=i.return;return h.tag===3?h.stateNode:null}var ns=!1;function $f(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mm(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function bi(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function as(i,o,h){var g=i.updateQueue;if(g===null)return null;if(g=g.shared,(Rt&2)!==0){var w=g.pending;return w===null?o.next=o:(o.next=w.next,w.next=o),g.pending=o,ki(i,h)}return w=g.interleaved,w===null?(o.next=o,Uf(g)):(o.next=w.next,w.next=o),g.interleaved=o,ki(i,h)}function ju(i,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194240)!==0)){var g=o.lanes;g&=i.pendingLanes,h|=g,o.lanes=h,xa(i,h)}}function Bm(i,o){var h=i.updateQueue,g=i.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var w=null,T=null;if(h=h.firstBaseUpdate,h!==null){do{var z={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};T===null?w=T=z:T=T.next=z,h=h.next}while(h!==null);T===null?w=T=o:T=T.next=o}else w=T=o;h={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:T,shared:g.shared,effects:g.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=o:i.next=o,h.lastBaseUpdate=o}function Mu(i,o,h,g){var w=i.updateQueue;ns=!1;var T=w.firstBaseUpdate,z=w.lastBaseUpdate,le=w.shared.pending;if(le!==null){w.shared.pending=null;var he=le,Ne=he.next;he.next=null,z===null?T=Ne:z.next=Ne,z=he;var Le=i.alternate;Le!==null&&(Le=Le.updateQueue,le=Le.lastBaseUpdate,le!==z&&(le===null?Le.firstBaseUpdate=Ne:le.next=Ne,Le.lastBaseUpdate=he))}if(T!==null){var je=w.baseState;z=0,Le=Ne=he=null,le=T;do{var Fe=le.lane,qe=le.eventTime;if((g&Fe)===Fe){Le!==null&&(Le=Le.next={eventTime:qe,lane:0,tag:le.tag,payload:le.payload,callback:le.callback,next:null});e:{var tt=i,rt=le;switch(Fe=o,qe=h,rt.tag){case 1:if(tt=rt.payload,typeof tt=="function"){je=tt.call(qe,je,Fe);break e}je=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=rt.payload,Fe=typeof tt=="function"?tt.call(qe,je,Fe):tt,Fe==null)break e;je=oe({},je,Fe);break e;case 2:ns=!0}}le.callback!==null&&le.lane!==0&&(i.flags|=64,Fe=w.effects,Fe===null?w.effects=[le]:Fe.push(le))}else qe={eventTime:qe,lane:Fe,tag:le.tag,payload:le.payload,callback:le.callback,next:null},Le===null?(Ne=Le=qe,he=je):Le=Le.next=qe,z|=Fe;if(le=le.next,le===null){if(le=w.shared.pending,le===null)break;Fe=le,le=Fe.next,Fe.next=null,w.lastBaseUpdate=Fe,w.shared.pending=null}}while(!0);if(Le===null&&(he=je),w.baseState=he,w.firstBaseUpdate=Ne,w.lastBaseUpdate=Le,o=w.shared.interleaved,o!==null){w=o;do z|=w.lane,w=w.next;while(w!==o)}else T===null&&(w.shared.lanes=0);Gs|=z,i.lanes=z,i.memoizedState=je}}function zm(i,o,h){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var g=i[o],w=g.callback;if(w!==null){if(g.callback=null,g=h,typeof w!="function")throw Error(t(191,w));w.call(g)}}}var ac={},Ka=es(ac),ic=es(ac),sc=es(ac);function Vs(i){if(i===ac)throw Error(t(174));return i}function Wf(i,o){switch(Qt(sc,o),Qt(ic,i),Qt(Ka,ac),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Sn(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Sn(o,i)}sr(Ka),Qt(Ka,o)}function Xo(){sr(Ka),sr(ic),sr(sc)}function Um(i){Vs(sc.current);var o=Vs(Ka.current),h=Sn(o,i.type);o!==h&&(Qt(ic,i),Qt(Ka,h))}function Vf(i){ic.current===i&&(sr(Ka),sr(ic))}var hr=es(0);function Bu(i){for(var o=i;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Hf=[];function Gf(){for(var i=0;i<Hf.length;i++)Hf[i]._workInProgressVersionPrimary=null;Hf.length=0}var zu=U.ReactCurrentDispatcher,Zf=U.ReactCurrentBatchConfig,Hs=0,mr=null,Ir=null,zr=null,Uu=!1,oc=!1,lc=0,Hy=0;function rn(){throw Error(t(321))}function Kf(i,o){if(o===null)return!1;for(var h=0;h<o.length&&h<i.length;h++)if(!Wn(i[h],o[h]))return!1;return!0}function qf(i,o,h,g,w,T){if(Hs=T,mr=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,zu.current=i===null||i.memoizedState===null?qy:Yy,i=h(g,w),oc){T=0;do{if(oc=!1,lc=0,25<=T)throw Error(t(301));T+=1,zr=Ir=null,o.updateQueue=null,zu.current=Xy,i=h(g,w)}while(oc)}if(zu.current=Vu,o=Ir!==null&&Ir.next!==null,Hs=0,zr=Ir=mr=null,Uu=!1,o)throw Error(t(300));return i}function Yf(){var i=lc!==0;return lc=0,i}function qa(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zr===null?mr.memoizedState=zr=i:zr=zr.next=i,zr}function sa(){if(Ir===null){var i=mr.alternate;i=i!==null?i.memoizedState:null}else i=Ir.next;var o=zr===null?mr.memoizedState:zr.next;if(o!==null)zr=o,Ir=i;else{if(i===null)throw Error(t(310));Ir=i,i={memoizedState:Ir.memoizedState,baseState:Ir.baseState,baseQueue:Ir.baseQueue,queue:Ir.queue,next:null},zr===null?mr.memoizedState=zr=i:zr=zr.next=i}return zr}function cc(i,o){return typeof o=="function"?o(i):o}function Xf(i){var o=sa(),h=o.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=i;var g=Ir,w=g.baseQueue,T=h.pending;if(T!==null){if(w!==null){var z=w.next;w.next=T.next,T.next=z}g.baseQueue=w=T,h.pending=null}if(w!==null){T=w.next,g=g.baseState;var le=z=null,he=null,Ne=T;do{var Le=Ne.lane;if((Hs&Le)===Le)he!==null&&(he=he.next={lane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),g=Ne.hasEagerState?Ne.eagerState:i(g,Ne.action);else{var je={lane:Le,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null};he===null?(le=he=je,z=g):he=he.next=je,mr.lanes|=Le,Gs|=Le}Ne=Ne.next}while(Ne!==null&&Ne!==T);he===null?z=g:he.next=le,Wn(g,o.memoizedState)||(In=!0),o.memoizedState=g,o.baseState=z,o.baseQueue=he,h.lastRenderedState=g}if(i=h.interleaved,i!==null){w=i;do T=w.lane,mr.lanes|=T,Gs|=T,w=w.next;while(w!==i)}else w===null&&(h.lanes=0);return[o.memoizedState,h.dispatch]}function Jf(i){var o=sa(),h=o.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=i;var g=h.dispatch,w=h.pending,T=o.memoizedState;if(w!==null){h.pending=null;var z=w=w.next;do T=i(T,z.action),z=z.next;while(z!==w);Wn(T,o.memoizedState)||(In=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),h.lastRenderedState=T}return[T,g]}function $m(){}function Wm(i,o){var h=mr,g=sa(),w=o(),T=!Wn(g.memoizedState,w);if(T&&(g.memoizedState=w,In=!0),g=g.queue,Qf(Gm.bind(null,h,g,i),[i]),g.getSnapshot!==o||T||zr!==null&&zr.memoizedState.tag&1){if(h.flags|=2048,uc(9,Hm.bind(null,h,g,w,o),void 0,null),Ur===null)throw Error(t(349));(Hs&30)!==0||Vm(h,o,w)}return w}function Vm(i,o,h){i.flags|=16384,i={getSnapshot:o,value:h},o=mr.updateQueue,o===null?(o={lastEffect:null,stores:null},mr.updateQueue=o,o.stores=[i]):(h=o.stores,h===null?o.stores=[i]:h.push(i))}function Hm(i,o,h,g){o.value=h,o.getSnapshot=g,Zm(o)&&Km(i)}function Gm(i,o,h){return h(function(){Zm(o)&&Km(i)})}function Zm(i){var o=i.getSnapshot;i=i.value;try{var h=o();return!Wn(i,h)}catch{return!0}}function Km(i){var o=ki(i,1);o!==null&&Ca(o,i,1,-1)}function qm(i){var o=qa();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cc,lastRenderedState:i},o.queue=i,i=i.dispatch=Ky.bind(null,mr,i),[o.memoizedState,i]}function uc(i,o,h,g){return i={tag:i,create:o,destroy:h,deps:g,next:null},o=mr.updateQueue,o===null?(o={lastEffect:null,stores:null},mr.updateQueue=o,o.lastEffect=i.next=i):(h=o.lastEffect,h===null?o.lastEffect=i.next=i:(g=h.next,h.next=i,i.next=g,o.lastEffect=i)),i}function Ym(){return sa().memoizedState}function $u(i,o,h,g){var w=qa();mr.flags|=i,w.memoizedState=uc(1|o,h,void 0,g===void 0?null:g)}function Wu(i,o,h,g){var w=sa();g=g===void 0?null:g;var T=void 0;if(Ir!==null){var z=Ir.memoizedState;if(T=z.destroy,g!==null&&Kf(g,z.deps)){w.memoizedState=uc(o,h,T,g);return}}mr.flags|=i,w.memoizedState=uc(1|o,h,T,g)}function Xm(i,o){return $u(8390656,8,i,o)}function Qf(i,o){return Wu(2048,8,i,o)}function Jm(i,o){return Wu(4,2,i,o)}function Qm(i,o){return Wu(4,4,i,o)}function ep(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function tp(i,o,h){return h=h!=null?h.concat([i]):null,Wu(4,4,ep.bind(null,o,i),h)}function eh(){}function rp(i,o){var h=sa();o=o===void 0?null:o;var g=h.memoizedState;return g!==null&&o!==null&&Kf(o,g[1])?g[0]:(h.memoizedState=[i,o],i)}function np(i,o){var h=sa();o=o===void 0?null:o;var g=h.memoizedState;return g!==null&&o!==null&&Kf(o,g[1])?g[0]:(i=i(),h.memoizedState=[i,o],i)}function ap(i,o,h){return(Hs&21)===0?(i.baseState&&(i.baseState=!1,In=!0),i.memoizedState=h):(Wn(h,o)||(h=iu(),mr.lanes|=h,Gs|=h,i.baseState=!0),o)}function Gy(i,o){var h=Pt;Pt=h!==0&&4>h?h:4,i(!0);var g=Zf.transition;Zf.transition={};try{i(!1),o()}finally{Pt=h,Zf.transition=g}}function ip(){return sa().memoizedState}function Zy(i,o,h){var g=ls(i);if(h={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null},sp(i))op(o,h);else if(h=jm(i,o,h,g),h!==null){var w=vn();Ca(h,i,g,w),lp(h,o,g)}}function Ky(i,o,h){var g=ls(i),w={lane:g,action:h,hasEagerState:!1,eagerState:null,next:null};if(sp(i))op(o,w);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=o.lastRenderedReducer,T!==null))try{var z=o.lastRenderedState,le=T(z,h);if(w.hasEagerState=!0,w.eagerState=le,Wn(le,z)){var he=o.interleaved;he===null?(w.next=w,Uf(o)):(w.next=he.next,he.next=w),o.interleaved=w;return}}catch{}finally{}h=jm(i,o,w,g),h!==null&&(w=vn(),Ca(h,i,g,w),lp(h,o,g))}}function sp(i){var o=i.alternate;return i===mr||o!==null&&o===mr}function op(i,o){oc=Uu=!0;var h=i.pending;h===null?o.next=o:(o.next=h.next,h.next=o),i.pending=o}function lp(i,o,h){if((h&4194240)!==0){var g=o.lanes;g&=i.pendingLanes,h|=g,o.lanes=h,xa(i,h)}}var Vu={readContext:ia,useCallback:rn,useContext:rn,useEffect:rn,useImperativeHandle:rn,useInsertionEffect:rn,useLayoutEffect:rn,useMemo:rn,useReducer:rn,useRef:rn,useState:rn,useDebugValue:rn,useDeferredValue:rn,useTransition:rn,useMutableSource:rn,useSyncExternalStore:rn,useId:rn,unstable_isNewReconciler:!1},qy={readContext:ia,useCallback:function(i,o){return qa().memoizedState=[i,o===void 0?null:o],i},useContext:ia,useEffect:Xm,useImperativeHandle:function(i,o,h){return h=h!=null?h.concat([i]):null,$u(4194308,4,ep.bind(null,o,i),h)},useLayoutEffect:function(i,o){return $u(4194308,4,i,o)},useInsertionEffect:function(i,o){return $u(4,2,i,o)},useMemo:function(i,o){var h=qa();return o=o===void 0?null:o,i=i(),h.memoizedState=[i,o],i},useReducer:function(i,o,h){var g=qa();return o=h!==void 0?h(o):o,g.memoizedState=g.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},g.queue=i,i=i.dispatch=Zy.bind(null,mr,i),[g.memoizedState,i]},useRef:function(i){var o=qa();return i={current:i},o.memoizedState=i},useState:qm,useDebugValue:eh,useDeferredValue:function(i){return qa().memoizedState=i},useTransition:function(){var i=qm(!1),o=i[0];return i=Gy.bind(null,i[1]),qa().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,h){var g=mr,w=qa();if(lr){if(h===void 0)throw Error(t(407));h=h()}else{if(h=o(),Ur===null)throw Error(t(349));(Hs&30)!==0||Vm(g,o,h)}w.memoizedState=h;var T={value:h,getSnapshot:o};return w.queue=T,Xm(Gm.bind(null,g,T,i),[i]),g.flags|=2048,uc(9,Hm.bind(null,g,T,h,o),void 0,null),h},useId:function(){var i=qa(),o=Ur.identifierPrefix;if(lr){var h=wi,g=_i;h=(g&~(1<<32-ot(g)-1)).toString(32)+h,o=":"+o+"R"+h,h=lc++,0<h&&(o+="H"+h.toString(32)),o+=":"}else h=Hy++,o=":"+o+"r"+h.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},Yy={readContext:ia,useCallback:rp,useContext:ia,useEffect:Qf,useImperativeHandle:tp,useInsertionEffect:Jm,useLayoutEffect:Qm,useMemo:np,useReducer:Xf,useRef:Ym,useState:function(){return Xf(cc)},useDebugValue:eh,useDeferredValue:function(i){var o=sa();return ap(o,Ir.memoizedState,i)},useTransition:function(){var i=Xf(cc)[0],o=sa().memoizedState;return[i,o]},useMutableSource:$m,useSyncExternalStore:Wm,useId:ip,unstable_isNewReconciler:!1},Xy={readContext:ia,useCallback:rp,useContext:ia,useEffect:Qf,useImperativeHandle:tp,useInsertionEffect:Jm,useLayoutEffect:Qm,useMemo:np,useReducer:Jf,useRef:Ym,useState:function(){return Jf(cc)},useDebugValue:eh,useDeferredValue:function(i){var o=sa();return Ir===null?o.memoizedState=i:ap(o,Ir.memoizedState,i)},useTransition:function(){var i=Jf(cc)[0],o=sa().memoizedState;return[i,o]},useMutableSource:$m,useSyncExternalStore:Wm,useId:ip,unstable_isNewReconciler:!1};function Sa(i,o){if(i&&i.defaultProps){o=oe({},o),i=i.defaultProps;for(var h in i)o[h]===void 0&&(o[h]=i[h]);return o}return o}function th(i,o,h,g){o=i.memoizedState,h=h(g,o),h=h==null?o:oe({},o,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var Hu={isMounted:function(i){return(i=i._reactInternals)?ie(i)===i:!1},enqueueSetState:function(i,o,h){i=i._reactInternals;var g=vn(),w=ls(i),T=bi(g,w);T.payload=o,h!=null&&(T.callback=h),o=as(i,T,w),o!==null&&(Ca(o,i,w,g),ju(o,i,w))},enqueueReplaceState:function(i,o,h){i=i._reactInternals;var g=vn(),w=ls(i),T=bi(g,w);T.tag=1,T.payload=o,h!=null&&(T.callback=h),o=as(i,T,w),o!==null&&(Ca(o,i,w,g),ju(o,i,w))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var h=vn(),g=ls(i),w=bi(h,g);w.tag=2,o!=null&&(w.callback=o),o=as(i,w,g),o!==null&&(Ca(o,i,g,h),ju(o,i,g))}};function cp(i,o,h,g,w,T,z){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(g,T,z):o.prototype&&o.prototype.isPureReactComponent?!Va(h,g)||!Va(w,T):!0}function up(i,o,h){var g=!1,w=ts,T=o.contextType;return typeof T=="object"&&T!==null?T=ia(T):(w=Nn(o)?zs:tn.current,g=o.contextTypes,T=(g=g!=null)?Vo(i,w):ts),o=new o(h,T),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Hu,i.stateNode=o,o._reactInternals=i,g&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=w,i.__reactInternalMemoizedMaskedChildContext=T),o}function dp(i,o,h,g){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,g),o.state!==i&&Hu.enqueueReplaceState(o,o.state,null)}function rh(i,o,h,g){var w=i.stateNode;w.props=h,w.state=i.memoizedState,w.refs={},$f(i);var T=o.contextType;typeof T=="object"&&T!==null?w.context=ia(T):(T=Nn(o)?zs:tn.current,w.context=Vo(i,T)),w.state=i.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(th(i,o,T,h),w.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(o=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),o!==w.state&&Hu.enqueueReplaceState(w,w.state,null),Mu(i,h,w,g),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308)}function Jo(i,o){try{var h="",g=o;do h+=H(g),g=g.return;while(g);var w=h}catch(T){w=`
Error generating stack: `+T.message+`
`+T.stack}return{value:i,source:o,stack:w,digest:null}}function nh(i,o,h){return{value:i,source:null,stack:h??null,digest:o??null}}function ah(i,o){try{console.error(o.value)}catch(h){setTimeout(function(){throw h})}}var Jy=typeof WeakMap=="function"?WeakMap:Map;function fp(i,o,h){h=bi(-1,h),h.tag=3,h.payload={element:null};var g=o.value;return h.callback=function(){Ju||(Ju=!0,yh=g),ah(i,o)},h}function hp(i,o,h){h=bi(-1,h),h.tag=3;var g=i.type.getDerivedStateFromError;if(typeof g=="function"){var w=o.value;h.payload=function(){return g(w)},h.callback=function(){ah(i,o)}}var T=i.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(h.callback=function(){ah(i,o),typeof g!="function"&&(ss===null?ss=new Set([this]):ss.add(this));var z=o.stack;this.componentDidCatch(o.value,{componentStack:z!==null?z:""})}),h}function mp(i,o,h){var g=i.pingCache;if(g===null){g=i.pingCache=new Jy;var w=new Set;g.set(o,w)}else w=g.get(o),w===void 0&&(w=new Set,g.set(o,w));w.has(h)||(w.add(h),i=f_.bind(null,i,o,h),o.then(i,i))}function pp(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function gp(i,o,h,g,w){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(o=bi(-1,1),o.tag=2,as(h,o,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=w,i)}var Qy=U.ReactCurrentOwner,In=!1;function gn(i,o,h,g){o.child=i===null?Rm(o,null,h,g):Ko(o,i.child,h,g)}function vp(i,o,h,g,w){h=h.render;var T=o.ref;return Yo(o,w),g=qf(i,o,h,g,T,w),h=Yf(),i!==null&&!In?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~w,Si(i,o,w)):(lr&&h&&Df(o),o.flags|=1,gn(i,o,g,w),o.child)}function xp(i,o,h,g,w){if(i===null){var T=h.type;return typeof T=="function"&&!Eh(T)&&T.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(o.tag=15,o.type=T,yp(i,o,T,g,w)):(i=ad(h.type,null,g,o,o.mode,w),i.ref=o.ref,i.return=o,o.child=i)}if(T=i.child,(i.lanes&w)===0){var z=T.memoizedProps;if(h=h.compare,h=h!==null?h:Va,h(z,g)&&i.ref===o.ref)return Si(i,o,w)}return o.flags|=1,i=us(T,g),i.ref=o.ref,i.return=o,o.child=i}function yp(i,o,h,g,w){if(i!==null){var T=i.memoizedProps;if(Va(T,g)&&i.ref===o.ref)if(In=!1,o.pendingProps=g=T,(i.lanes&w)!==0)(i.flags&131072)!==0&&(In=!0);else return o.lanes=i.lanes,Si(i,o,w)}return ih(i,o,h,g,w)}function _p(i,o,h){var g=o.pendingProps,w=g.children,T=i!==null?i.memoizedState:null;if(g.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(el,Zn),Zn|=h;else{if((h&1073741824)===0)return i=T!==null?T.baseLanes|h:h,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Qt(el,Zn),Zn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=T!==null?T.baseLanes:h,Qt(el,Zn),Zn|=g}else T!==null?(g=T.baseLanes|h,o.memoizedState=null):g=h,Qt(el,Zn),Zn|=g;return gn(i,o,w,h),o.child}function wp(i,o){var h=o.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(o.flags|=512,o.flags|=2097152)}function ih(i,o,h,g,w){var T=Nn(h)?zs:tn.current;return T=Vo(o,T),Yo(o,w),h=qf(i,o,h,g,T,w),g=Yf(),i!==null&&!In?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~w,Si(i,o,w)):(lr&&g&&Df(o),o.flags|=1,gn(i,o,h,w),o.child)}function kp(i,o,h,g,w){if(Nn(h)){var T=!0;Pu(o)}else T=!1;if(Yo(o,w),o.stateNode===null)Zu(i,o),up(o,h,g),rh(o,h,g,w),g=!0;else if(i===null){var z=o.stateNode,le=o.memoizedProps;z.props=le;var he=z.context,Ne=h.contextType;typeof Ne=="object"&&Ne!==null?Ne=ia(Ne):(Ne=Nn(h)?zs:tn.current,Ne=Vo(o,Ne));var Le=h.getDerivedStateFromProps,je=typeof Le=="function"||typeof z.getSnapshotBeforeUpdate=="function";je||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(le!==g||he!==Ne)&&dp(o,z,g,Ne),ns=!1;var Fe=o.memoizedState;z.state=Fe,Mu(o,g,z,w),he=o.memoizedState,le!==g||Fe!==he||Pn.current||ns?(typeof Le=="function"&&(th(o,h,Le,g),he=o.memoizedState),(le=ns||cp(o,h,le,g,Fe,he,Ne))?(je||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(o.flags|=4194308)):(typeof z.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=he),z.props=g,z.state=he,z.context=Ne,g=le):(typeof z.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{z=o.stateNode,Mm(i,o),le=o.memoizedProps,Ne=o.type===o.elementType?le:Sa(o.type,le),z.props=Ne,je=o.pendingProps,Fe=z.context,he=h.contextType,typeof he=="object"&&he!==null?he=ia(he):(he=Nn(h)?zs:tn.current,he=Vo(o,he));var qe=h.getDerivedStateFromProps;(Le=typeof qe=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(le!==je||Fe!==he)&&dp(o,z,g,he),ns=!1,Fe=o.memoizedState,z.state=Fe,Mu(o,g,z,w);var tt=o.memoizedState;le!==je||Fe!==tt||Pn.current||ns?(typeof qe=="function"&&(th(o,h,qe,g),tt=o.memoizedState),(Ne=ns||cp(o,h,Ne,g,Fe,tt,he)||!1)?(Le||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(g,tt,he),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(g,tt,he)),typeof z.componentDidUpdate=="function"&&(o.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof z.componentDidUpdate!="function"||le===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||le===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=tt),z.props=g,z.state=tt,z.context=he,g=Ne):(typeof z.componentDidUpdate!="function"||le===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||le===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=1024),g=!1)}return sh(i,o,h,g,T,w)}function sh(i,o,h,g,w,T){wp(i,o);var z=(o.flags&128)!==0;if(!g&&!z)return w&&Cm(o,h,!1),Si(i,o,T);g=o.stateNode,Qy.current=o;var le=z&&typeof h.getDerivedStateFromError!="function"?null:g.render();return o.flags|=1,i!==null&&z?(o.child=Ko(o,i.child,null,T),o.child=Ko(o,null,le,T)):gn(i,o,le,T),o.memoizedState=g.state,w&&Cm(o,h,!0),o.child}function bp(i){var o=i.stateNode;o.pendingContext?Tm(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Tm(i,o.context,!1),Wf(i,o.containerInfo)}function Sp(i,o,h,g,w){return Zo(),Rf(w),o.flags|=256,gn(i,o,h,g),o.child}var oh={dehydrated:null,treeContext:null,retryLane:0};function lh(i){return{baseLanes:i,cachePool:null,transitions:null}}function Tp(i,o,h){var g=o.pendingProps,w=hr.current,T=!1,z=(o.flags&128)!==0,le;if((le=z)||(le=i!==null&&i.memoizedState===null?!1:(w&2)!==0),le?(T=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(w|=1),Qt(hr,w&1),i===null)return Lf(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(z=g.children,i=g.fallback,T?(g=o.mode,T=o.child,z={mode:"hidden",children:z},(g&1)===0&&T!==null?(T.childLanes=0,T.pendingProps=z):T=id(z,g,0,null),i=Ys(i,g,h,null),T.return=o,i.return=o,T.sibling=i,o.child=T,o.child.memoizedState=lh(h),o.memoizedState=oh,i):ch(o,z));if(w=i.memoizedState,w!==null&&(le=w.dehydrated,le!==null))return e_(i,o,z,g,le,w,h);if(T){T=g.fallback,z=o.mode,w=i.child,le=w.sibling;var he={mode:"hidden",children:g.children};return(z&1)===0&&o.child!==w?(g=o.child,g.childLanes=0,g.pendingProps=he,o.deletions=null):(g=us(w,he),g.subtreeFlags=w.subtreeFlags&14680064),le!==null?T=us(le,T):(T=Ys(T,z,h,null),T.flags|=2),T.return=o,g.return=o,g.sibling=T,o.child=g,g=T,T=o.child,z=i.child.memoizedState,z=z===null?lh(h):{baseLanes:z.baseLanes|h,cachePool:null,transitions:z.transitions},T.memoizedState=z,T.childLanes=i.childLanes&~h,o.memoizedState=oh,g}return T=i.child,i=T.sibling,g=us(T,{mode:"visible",children:g.children}),(o.mode&1)===0&&(g.lanes=h),g.return=o,g.sibling=null,i!==null&&(h=o.deletions,h===null?(o.deletions=[i],o.flags|=16):h.push(i)),o.child=g,o.memoizedState=null,g}function ch(i,o){return o=id({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Gu(i,o,h,g){return g!==null&&Rf(g),Ko(o,i.child,null,h),i=ch(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function e_(i,o,h,g,w,T,z){if(h)return o.flags&256?(o.flags&=-257,g=nh(Error(t(422))),Gu(i,o,z,g)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(T=g.fallback,w=o.mode,g=id({mode:"visible",children:g.children},w,0,null),T=Ys(T,w,z,null),T.flags|=2,g.return=o,T.return=o,g.sibling=T,o.child=g,(o.mode&1)!==0&&Ko(o,i.child,null,z),o.child.memoizedState=lh(z),o.memoizedState=oh,T);if((o.mode&1)===0)return Gu(i,o,z,null);if(w.data==="$!"){if(g=w.nextSibling&&w.nextSibling.dataset,g)var le=g.dgst;return g=le,T=Error(t(419)),g=nh(T,g,void 0),Gu(i,o,z,g)}if(le=(z&i.childLanes)!==0,In||le){if(g=Ur,g!==null){switch(z&-z){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(g.suspendedLanes|z))!==0?0:w,w!==0&&w!==T.retryLane&&(T.retryLane=w,ki(i,w),Ca(g,i,w,-1))}return Th(),g=nh(Error(t(421))),Gu(i,o,z,g)}return w.data==="$?"?(o.flags|=128,o.child=i.child,o=h_.bind(null,i),w._reactRetry=o,null):(i=T.treeContext,Gn=Za(w.nextSibling),Hn=o,lr=!0,ba=null,i!==null&&(na[aa++]=_i,na[aa++]=wi,na[aa++]=Us,_i=i.id,wi=i.overflow,Us=o),o=ch(o,g.children),o.flags|=4096,o)}function Ep(i,o,h){i.lanes|=o;var g=i.alternate;g!==null&&(g.lanes|=o),zf(i.return,o,h)}function uh(i,o,h,g,w){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:w}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=g,T.tail=h,T.tailMode=w)}function Cp(i,o,h){var g=o.pendingProps,w=g.revealOrder,T=g.tail;if(gn(i,o,g.children,h),g=hr.current,(g&2)!==0)g=g&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Ep(i,h,o);else if(i.tag===19)Ep(i,h,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}g&=1}if(Qt(hr,g),(o.mode&1)===0)o.memoizedState=null;else switch(w){case"forwards":for(h=o.child,w=null;h!==null;)i=h.alternate,i!==null&&Bu(i)===null&&(w=h),h=h.sibling;h=w,h===null?(w=o.child,o.child=null):(w=h.sibling,h.sibling=null),uh(o,!1,w,h,T);break;case"backwards":for(h=null,w=o.child,o.child=null;w!==null;){if(i=w.alternate,i!==null&&Bu(i)===null){o.child=w;break}i=w.sibling,w.sibling=h,h=w,w=i}uh(o,!0,h,null,T);break;case"together":uh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Zu(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Si(i,o,h){if(i!==null&&(o.dependencies=i.dependencies),Gs|=o.lanes,(h&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,h=us(i,i.pendingProps),o.child=h,h.return=o;i.sibling!==null;)i=i.sibling,h=h.sibling=us(i,i.pendingProps),h.return=o;h.sibling=null}return o.child}function t_(i,o,h){switch(o.tag){case 3:bp(o),Zo();break;case 5:Um(o);break;case 1:Nn(o.type)&&Pu(o);break;case 4:Wf(o,o.stateNode.containerInfo);break;case 10:var g=o.type._context,w=o.memoizedProps.value;Qt(Lu,g._currentValue),g._currentValue=w;break;case 13:if(g=o.memoizedState,g!==null)return g.dehydrated!==null?(Qt(hr,hr.current&1),o.flags|=128,null):(h&o.child.childLanes)!==0?Tp(i,o,h):(Qt(hr,hr.current&1),i=Si(i,o,h),i!==null?i.sibling:null);Qt(hr,hr.current&1);break;case 19:if(g=(h&o.childLanes)!==0,(i.flags&128)!==0){if(g)return Cp(i,o,h);o.flags|=128}if(w=o.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Qt(hr,hr.current),g)break;return null;case 22:case 23:return o.lanes=0,_p(i,o,h)}return Si(i,o,h)}var Ap,dh,Pp,Np;Ap=function(i,o){for(var h=o.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},dh=function(){},Pp=function(i,o,h,g){var w=i.memoizedProps;if(w!==g){i=o.stateNode,Vs(Ka.current);var T=null;switch(h){case"input":w=st(i,w),g=st(i,g),T=[];break;case"select":w=oe({},w,{value:void 0}),g=oe({},g,{value:void 0}),T=[];break;case"textarea":w=Kt(i,w),g=Kt(i,g),T=[];break;default:typeof w.onClick!="function"&&typeof g.onClick=="function"&&(i.onclick=Oe)}si(h,g);var z;h=null;for(Ne in w)if(!g.hasOwnProperty(Ne)&&w.hasOwnProperty(Ne)&&w[Ne]!=null)if(Ne==="style"){var le=w[Ne];for(z in le)le.hasOwnProperty(z)&&(h||(h={}),h[z]="")}else Ne!=="dangerouslySetInnerHTML"&&Ne!=="children"&&Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&Ne!=="autoFocus"&&(a.hasOwnProperty(Ne)?T||(T=[]):(T=T||[]).push(Ne,null));for(Ne in g){var he=g[Ne];if(le=w?.[Ne],g.hasOwnProperty(Ne)&&he!==le&&(he!=null||le!=null))if(Ne==="style")if(le){for(z in le)!le.hasOwnProperty(z)||he&&he.hasOwnProperty(z)||(h||(h={}),h[z]="");for(z in he)he.hasOwnProperty(z)&&le[z]!==he[z]&&(h||(h={}),h[z]=he[z])}else h||(T||(T=[]),T.push(Ne,h)),h=he;else Ne==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,le=le?le.__html:void 0,he!=null&&le!==he&&(T=T||[]).push(Ne,he)):Ne==="children"?typeof he!="string"&&typeof he!="number"||(T=T||[]).push(Ne,""+he):Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ne)?(he!=null&&Ne==="onScroll"&&Gt("scroll",i),T||le===he||(T=[])):(T=T||[]).push(Ne,he))}h&&(T=T||[]).push("style",h);var Ne=T;(o.updateQueue=Ne)&&(o.flags|=4)}},Np=function(i,o,h,g){h!==g&&(o.flags|=4)};function dc(i,o){if(!lr)switch(i.tailMode){case"hidden":o=i.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:g.sibling=null}}function nn(i){var o=i.alternate!==null&&i.alternate.child===i.child,h=0,g=0;if(o)for(var w=i.child;w!==null;)h|=w.lanes|w.childLanes,g|=w.subtreeFlags&14680064,g|=w.flags&14680064,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)h|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=g,i.childLanes=h,o}function r_(i,o,h){var g=o.pendingProps;switch(Of(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(o),null;case 1:return Nn(o.type)&&Au(),nn(o),null;case 3:return g=o.stateNode,Xo(),sr(Pn),sr(tn),Gf(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(i===null||i.child===null)&&(Ou(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,ba!==null&&(kh(ba),ba=null))),dh(i,o),nn(o),null;case 5:Vf(o);var w=Vs(sc.current);if(h=o.type,i!==null&&o.stateNode!=null)Pp(i,o,h,g,w),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!g){if(o.stateNode===null)throw Error(t(166));return nn(o),null}if(i=Vs(Ka.current),Ou(o)){g=o.stateNode,h=o.type;var T=o.memoizedProps;switch(g[ra]=o,g[Ji]=T,i=(o.mode&1)!==0,h){case"dialog":Gt("cancel",g),Gt("close",g);break;case"iframe":case"object":case"embed":Gt("load",g);break;case"video":case"audio":for(w=0;w<qi.length;w++)Gt(qi[w],g);break;case"source":Gt("error",g);break;case"img":case"image":case"link":Gt("error",g),Gt("load",g);break;case"details":Gt("toggle",g);break;case"input":wt(g,T),Gt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!T.multiple},Gt("invalid",g);break;case"textarea":yr(g,T),Gt("invalid",g)}si(h,T),w=null;for(var z in T)if(T.hasOwnProperty(z)){var le=T[z];z==="children"?typeof le=="string"?g.textContent!==le&&(T.suppressHydrationWarning!==!0&&Pe(g.textContent,le,i),w=["children",le]):typeof le=="number"&&g.textContent!==""+le&&(T.suppressHydrationWarning!==!0&&Pe(g.textContent,le,i),w=["children",""+le]):a.hasOwnProperty(z)&&le!=null&&z==="onScroll"&&Gt("scroll",g)}switch(h){case"input":ze(g),It(g,T,!0);break;case"textarea":ze(g),nt(g);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(g.onclick=Oe)}g=w,o.updateQueue=g,g!==null&&(o.flags|=4)}else{z=w.nodeType===9?w:w.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Mr(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=z.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof g.is=="string"?i=z.createElement(h,{is:g.is}):(i=z.createElement(h),h==="select"&&(z=i,g.multiple?z.multiple=!0:g.size&&(z.size=g.size))):i=z.createElementNS(i,h),i[ra]=o,i[Ji]=g,Ap(i,o,!1,!1),o.stateNode=i;e:{switch(z=Rn(h,g),h){case"dialog":Gt("cancel",i),Gt("close",i),w=g;break;case"iframe":case"object":case"embed":Gt("load",i),w=g;break;case"video":case"audio":for(w=0;w<qi.length;w++)Gt(qi[w],i);w=g;break;case"source":Gt("error",i),w=g;break;case"img":case"image":case"link":Gt("error",i),Gt("load",i),w=g;break;case"details":Gt("toggle",i),w=g;break;case"input":wt(i,g),w=st(i,g),Gt("invalid",i);break;case"option":w=g;break;case"select":i._wrapperState={wasMultiple:!!g.multiple},w=oe({},g,{value:void 0}),Gt("invalid",i);break;case"textarea":yr(i,g),w=Kt(i,g),Gt("invalid",i);break;default:w=g}si(h,w),le=w;for(T in le)if(le.hasOwnProperty(T)){var he=le[T];T==="style"?Xr(i,he):T==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&Bt(i,he)):T==="children"?typeof he=="string"?(h!=="textarea"||he!=="")&&ft(i,he):typeof he=="number"&&ft(i,""+he):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(a.hasOwnProperty(T)?he!=null&&T==="onScroll"&&Gt("scroll",i):he!=null&&N(i,T,he,z))}switch(h){case"input":ze(i),It(i,g,!1);break;case"textarea":ze(i),nt(i);break;case"option":g.value!=null&&i.setAttribute("value",""+ge(g.value));break;case"select":i.multiple=!!g.multiple,T=g.value,T!=null?Zt(i,!!g.multiple,T,!1):g.defaultValue!=null&&Zt(i,!!g.multiple,g.defaultValue,!0);break;default:typeof w.onClick=="function"&&(i.onclick=Oe)}switch(h){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return nn(o),null;case 6:if(i&&o.stateNode!=null)Np(i,o,i.memoizedProps,g);else{if(typeof g!="string"&&o.stateNode===null)throw Error(t(166));if(h=Vs(sc.current),Vs(Ka.current),Ou(o)){if(g=o.stateNode,h=o.memoizedProps,g[ra]=o,(T=g.nodeValue!==h)&&(i=Hn,i!==null))switch(i.tag){case 3:Pe(g.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Pe(g.nodeValue,h,(i.mode&1)!==0)}T&&(o.flags|=4)}else g=(h.nodeType===9?h:h.ownerDocument).createTextNode(g),g[ra]=o,o.stateNode=g}return nn(o),null;case 13:if(sr(hr),g=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(lr&&Gn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Om(),Zo(),o.flags|=98560,T=!1;else if(T=Ou(o),g!==null&&g.dehydrated!==null){if(i===null){if(!T)throw Error(t(318));if(T=o.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(t(317));T[ra]=o}else Zo(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;nn(o),T=!1}else ba!==null&&(kh(ba),ba=null),T=!0;if(!T)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=h,o):(g=g!==null,g!==(i!==null&&i.memoizedState!==null)&&g&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(hr.current&1)!==0?Dr===0&&(Dr=3):Th())),o.updateQueue!==null&&(o.flags|=4),nn(o),null);case 4:return Xo(),dh(i,o),i===null&&Yi(o.stateNode.containerInfo),nn(o),null;case 10:return Bf(o.type._context),nn(o),null;case 17:return Nn(o.type)&&Au(),nn(o),null;case 19:if(sr(hr),T=o.memoizedState,T===null)return nn(o),null;if(g=(o.flags&128)!==0,z=T.rendering,z===null)if(g)dc(T,!1);else{if(Dr!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(z=Bu(i),z!==null){for(o.flags|=128,dc(T,!1),g=z.updateQueue,g!==null&&(o.updateQueue=g,o.flags|=4),o.subtreeFlags=0,g=h,h=o.child;h!==null;)T=h,i=g,T.flags&=14680066,z=T.alternate,z===null?(T.childLanes=0,T.lanes=i,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=z.childLanes,T.lanes=z.lanes,T.child=z.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=z.memoizedProps,T.memoizedState=z.memoizedState,T.updateQueue=z.updateQueue,T.type=z.type,i=z.dependencies,T.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return Qt(hr,hr.current&1|2),o.child}i=i.sibling}T.tail!==null&&Me()>tl&&(o.flags|=128,g=!0,dc(T,!1),o.lanes=4194304)}else{if(!g)if(i=Bu(z),i!==null){if(o.flags|=128,g=!0,h=i.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),dc(T,!0),T.tail===null&&T.tailMode==="hidden"&&!z.alternate&&!lr)return nn(o),null}else 2*Me()-T.renderingStartTime>tl&&h!==1073741824&&(o.flags|=128,g=!0,dc(T,!1),o.lanes=4194304);T.isBackwards?(z.sibling=o.child,o.child=z):(h=T.last,h!==null?h.sibling=z:o.child=z,T.last=z)}return T.tail!==null?(o=T.tail,T.rendering=o,T.tail=o.sibling,T.renderingStartTime=Me(),o.sibling=null,h=hr.current,Qt(hr,g?h&1|2:h&1),o):(nn(o),null);case 22:case 23:return Sh(),g=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==g&&(o.flags|=8192),g&&(o.mode&1)!==0?(Zn&1073741824)!==0&&(nn(o),o.subtreeFlags&6&&(o.flags|=8192)):nn(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function n_(i,o){switch(Of(o),o.tag){case 1:return Nn(o.type)&&Au(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Xo(),sr(Pn),sr(tn),Gf(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Vf(o),null;case 13:if(sr(hr),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));Zo()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return sr(hr),null;case 4:return Xo(),null;case 10:return Bf(o.type._context),null;case 22:case 23:return Sh(),null;case 24:return null;default:return null}}var Ku=!1,an=!1,a_=typeof WeakSet=="function"?WeakSet:Set,et=null;function Qo(i,o){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(g){gr(i,o,g)}else h.current=null}function fh(i,o,h){try{h()}catch(g){gr(i,o,g)}}var Ip=!1;function i_(i,o){if(Ge=Ds,i=Kl(),ql(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var w=g.anchorOffset,T=g.focusNode;g=g.focusOffset;try{h.nodeType,T.nodeType}catch{h=null;break e}var z=0,le=-1,he=-1,Ne=0,Le=0,je=i,Fe=null;t:for(;;){for(var qe;je!==h||w!==0&&je.nodeType!==3||(le=z+w),je!==T||g!==0&&je.nodeType!==3||(he=z+g),je.nodeType===3&&(z+=je.nodeValue.length),(qe=je.firstChild)!==null;)Fe=je,je=qe;for(;;){if(je===i)break t;if(Fe===h&&++Ne===w&&(le=z),Fe===T&&++Le===g&&(he=z),(qe=je.nextSibling)!==null)break;je=Fe,Fe=je.parentNode}je=qe}h=le===-1||he===-1?null:{start:le,end:he}}else h=null}h=h||{start:0,end:0}}else h=null;for(lt={focusedElem:i,selectionRange:h},Ds=!1,et=o;et!==null;)if(o=et,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,et=i;else for(;et!==null;){o=et;try{var tt=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(tt!==null){var rt=tt.memoizedProps,wr=tt.memoizedState,be=o.stateNode,pe=be.getSnapshotBeforeUpdate(o.elementType===o.type?rt:Sa(o.type,rt),wr);be.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:var Ee=o.stateNode.containerInfo;Ee.nodeType===1?Ee.textContent="":Ee.nodeType===9&&Ee.documentElement&&Ee.removeChild(Ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ue){gr(o,o.return,Ue)}if(i=o.sibling,i!==null){i.return=o.return,et=i;break}et=o.return}return tt=Ip,Ip=!1,tt}function fc(i,o,h){var g=o.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var w=g=g.next;do{if((w.tag&i)===i){var T=w.destroy;w.destroy=void 0,T!==void 0&&fh(o,h,T)}w=w.next}while(w!==g)}}function qu(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var h=o=o.next;do{if((h.tag&i)===i){var g=h.create;h.destroy=g()}h=h.next}while(h!==o)}}function hh(i){var o=i.ref;if(o!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof o=="function"?o(i):o.current=i}}function Dp(i){var o=i.alternate;o!==null&&(i.alternate=null,Dp(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[ra],delete o[Ji],delete o[Qi],delete o[Af],delete o[Pf])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Op(i){return i.tag===5||i.tag===3||i.tag===4}function Fp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Op(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function mh(i,o,h){var g=i.tag;if(g===5||g===6)i=i.stateNode,o?h.nodeType===8?h.parentNode.insertBefore(i,o):h.insertBefore(i,o):(h.nodeType===8?(o=h.parentNode,o.insertBefore(i,h)):(o=h,o.appendChild(i)),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=Oe));else if(g!==4&&(i=i.child,i!==null))for(mh(i,o,h),i=i.sibling;i!==null;)mh(i,o,h),i=i.sibling}function ph(i,o,h){var g=i.tag;if(g===5||g===6)i=i.stateNode,o?h.insertBefore(i,o):h.appendChild(i);else if(g!==4&&(i=i.child,i!==null))for(ph(i,o,h),i=i.sibling;i!==null;)ph(i,o,h),i=i.sibling}var Gr=null,Ta=!1;function is(i,o,h){for(h=h.child;h!==null;)Lp(i,o,h),h=h.sibling}function Lp(i,o,h){if(_r&&typeof _r.onCommitFiberUnmount=="function")try{_r.onCommitFiberUnmount(jn,h)}catch{}switch(h.tag){case 5:an||Qo(h,o);case 6:var g=Gr,w=Ta;Gr=null,is(i,o,h),Gr=g,Ta=w,Gr!==null&&(Ta?(i=Gr,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):Gr.removeChild(h.stateNode));break;case 18:Gr!==null&&(Ta?(i=Gr,h=h.stateNode,i.nodeType===8?rc(i.parentNode,h):i.nodeType===1&&rc(i,h),zn(i)):rc(Gr,h.stateNode));break;case 4:g=Gr,w=Ta,Gr=h.stateNode.containerInfo,Ta=!0,is(i,o,h),Gr=g,Ta=w;break;case 0:case 11:case 14:case 15:if(!an&&(g=h.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){w=g=g.next;do{var T=w,z=T.destroy;T=T.tag,z!==void 0&&((T&2)!==0||(T&4)!==0)&&fh(h,o,z),w=w.next}while(w!==g)}is(i,o,h);break;case 1:if(!an&&(Qo(h,o),g=h.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=h.memoizedProps,g.state=h.memoizedState,g.componentWillUnmount()}catch(le){gr(h,o,le)}is(i,o,h);break;case 21:is(i,o,h);break;case 22:h.mode&1?(an=(g=an)||h.memoizedState!==null,is(i,o,h),an=g):is(i,o,h);break;default:is(i,o,h)}}function Rp(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new a_),o.forEach(function(g){var w=m_.bind(null,i,g);h.has(g)||(h.add(g),g.then(w,w))})}}function Ea(i,o){var h=o.deletions;if(h!==null)for(var g=0;g<h.length;g++){var w=h[g];try{var T=i,z=o,le=z;e:for(;le!==null;){switch(le.tag){case 5:Gr=le.stateNode,Ta=!1;break e;case 3:Gr=le.stateNode.containerInfo,Ta=!0;break e;case 4:Gr=le.stateNode.containerInfo,Ta=!0;break e}le=le.return}if(Gr===null)throw Error(t(160));Lp(T,z,w),Gr=null,Ta=!1;var he=w.alternate;he!==null&&(he.return=null),w.return=null}catch(Ne){gr(w,o,Ne)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)jp(o,i),o=o.sibling}function jp(i,o){var h=i.alternate,g=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Ea(o,i),Ya(i),g&4){try{fc(3,i,i.return),qu(3,i)}catch(rt){gr(i,i.return,rt)}try{fc(5,i,i.return)}catch(rt){gr(i,i.return,rt)}}break;case 1:Ea(o,i),Ya(i),g&512&&h!==null&&Qo(h,h.return);break;case 5:if(Ea(o,i),Ya(i),g&512&&h!==null&&Qo(h,h.return),i.flags&32){var w=i.stateNode;try{ft(w,"")}catch(rt){gr(i,i.return,rt)}}if(g&4&&(w=i.stateNode,w!=null)){var T=i.memoizedProps,z=h!==null?h.memoizedProps:T,le=i.type,he=i.updateQueue;if(i.updateQueue=null,he!==null)try{le==="input"&&T.type==="radio"&&T.name!=null&&_t(w,T),Rn(le,z);var Ne=Rn(le,T);for(z=0;z<he.length;z+=2){var Le=he[z],je=he[z+1];Le==="style"?Xr(w,je):Le==="dangerouslySetInnerHTML"?Bt(w,je):Le==="children"?ft(w,je):N(w,Le,je,Ne)}switch(le){case"input":$e(w,T);break;case"textarea":or(w,T);break;case"select":var Fe=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!T.multiple;var qe=T.value;qe!=null?Zt(w,!!T.multiple,qe,!1):Fe!==!!T.multiple&&(T.defaultValue!=null?Zt(w,!!T.multiple,T.defaultValue,!0):Zt(w,!!T.multiple,T.multiple?[]:"",!1))}w[Ji]=T}catch(rt){gr(i,i.return,rt)}}break;case 6:if(Ea(o,i),Ya(i),g&4){if(i.stateNode===null)throw Error(t(162));w=i.stateNode,T=i.memoizedProps;try{w.nodeValue=T}catch(rt){gr(i,i.return,rt)}}break;case 3:if(Ea(o,i),Ya(i),g&4&&h!==null&&h.memoizedState.isDehydrated)try{zn(o.containerInfo)}catch(rt){gr(i,i.return,rt)}break;case 4:Ea(o,i),Ya(i);break;case 13:Ea(o,i),Ya(i),w=i.child,w.flags&8192&&(T=w.memoizedState!==null,w.stateNode.isHidden=T,!T||w.alternate!==null&&w.alternate.memoizedState!==null||(xh=Me())),g&4&&Rp(i);break;case 22:if(Le=h!==null&&h.memoizedState!==null,i.mode&1?(an=(Ne=an)||Le,Ea(o,i),an=Ne):Ea(o,i),Ya(i),g&8192){if(Ne=i.memoizedState!==null,(i.stateNode.isHidden=Ne)&&!Le&&(i.mode&1)!==0)for(et=i,Le=i.child;Le!==null;){for(je=et=Le;et!==null;){switch(Fe=et,qe=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:fc(4,Fe,Fe.return);break;case 1:Qo(Fe,Fe.return);var tt=Fe.stateNode;if(typeof tt.componentWillUnmount=="function"){g=Fe,h=Fe.return;try{o=g,tt.props=o.memoizedProps,tt.state=o.memoizedState,tt.componentWillUnmount()}catch(rt){gr(g,h,rt)}}break;case 5:Qo(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){zp(je);continue}}qe!==null?(qe.return=Fe,et=qe):zp(je)}Le=Le.sibling}e:for(Le=null,je=i;;){if(je.tag===5){if(Le===null){Le=je;try{w=je.stateNode,Ne?(T=w.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(le=je.stateNode,he=je.memoizedProps.style,z=he!=null&&he.hasOwnProperty("display")?he.display:null,le.style.display=qt("display",z))}catch(rt){gr(i,i.return,rt)}}}else if(je.tag===6){if(Le===null)try{je.stateNode.nodeValue=Ne?"":je.memoizedProps}catch(rt){gr(i,i.return,rt)}}else if((je.tag!==22&&je.tag!==23||je.memoizedState===null||je===i)&&je.child!==null){je.child.return=je,je=je.child;continue}if(je===i)break e;for(;je.sibling===null;){if(je.return===null||je.return===i)break e;Le===je&&(Le=null),je=je.return}Le===je&&(Le=null),je.sibling.return=je.return,je=je.sibling}}break;case 19:Ea(o,i),Ya(i),g&4&&Rp(i);break;case 21:break;default:Ea(o,i),Ya(i)}}function Ya(i){var o=i.flags;if(o&2){try{e:{for(var h=i.return;h!==null;){if(Op(h)){var g=h;break e}h=h.return}throw Error(t(160))}switch(g.tag){case 5:var w=g.stateNode;g.flags&32&&(ft(w,""),g.flags&=-33);var T=Fp(i);ph(i,T,w);break;case 3:case 4:var z=g.stateNode.containerInfo,le=Fp(i);mh(i,le,z);break;default:throw Error(t(161))}}catch(he){gr(i,i.return,he)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function s_(i,o,h){et=i,Mp(i)}function Mp(i,o,h){for(var g=(i.mode&1)!==0;et!==null;){var w=et,T=w.child;if(w.tag===22&&g){var z=w.memoizedState!==null||Ku;if(!z){var le=w.alternate,he=le!==null&&le.memoizedState!==null||an;le=Ku;var Ne=an;if(Ku=z,(an=he)&&!Ne)for(et=w;et!==null;)z=et,he=z.child,z.tag===22&&z.memoizedState!==null?Up(w):he!==null?(he.return=z,et=he):Up(w);for(;T!==null;)et=T,Mp(T),T=T.sibling;et=w,Ku=le,an=Ne}Bp(i)}else(w.subtreeFlags&8772)!==0&&T!==null?(T.return=w,et=T):Bp(i)}}function Bp(i){for(;et!==null;){var o=et;if((o.flags&8772)!==0){var h=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:an||qu(5,o);break;case 1:var g=o.stateNode;if(o.flags&4&&!an)if(h===null)g.componentDidMount();else{var w=o.elementType===o.type?h.memoizedProps:Sa(o.type,h.memoizedProps);g.componentDidUpdate(w,h.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var T=o.updateQueue;T!==null&&zm(o,T,g);break;case 3:var z=o.updateQueue;if(z!==null){if(h=null,o.child!==null)switch(o.child.tag){case 5:h=o.child.stateNode;break;case 1:h=o.child.stateNode}zm(o,z,h)}break;case 5:var le=o.stateNode;if(h===null&&o.flags&4){h=le;var he=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&h.focus();break;case"img":he.src&&(h.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Ne=o.alternate;if(Ne!==null){var Le=Ne.memoizedState;if(Le!==null){var je=Le.dehydrated;je!==null&&zn(je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}an||o.flags&512&&hh(o)}catch(Fe){gr(o,o.return,Fe)}}if(o===i){et=null;break}if(h=o.sibling,h!==null){h.return=o.return,et=h;break}et=o.return}}function zp(i){for(;et!==null;){var o=et;if(o===i){et=null;break}var h=o.sibling;if(h!==null){h.return=o.return,et=h;break}et=o.return}}function Up(i){for(;et!==null;){var o=et;try{switch(o.tag){case 0:case 11:case 15:var h=o.return;try{qu(4,o)}catch(he){gr(o,h,he)}break;case 1:var g=o.stateNode;if(typeof g.componentDidMount=="function"){var w=o.return;try{g.componentDidMount()}catch(he){gr(o,w,he)}}var T=o.return;try{hh(o)}catch(he){gr(o,T,he)}break;case 5:var z=o.return;try{hh(o)}catch(he){gr(o,z,he)}}}catch(he){gr(o,o.return,he)}if(o===i){et=null;break}var le=o.sibling;if(le!==null){le.return=o.return,et=le;break}et=o.return}}var o_=Math.ceil,Yu=U.ReactCurrentDispatcher,gh=U.ReactCurrentOwner,oa=U.ReactCurrentBatchConfig,Rt=0,Ur=null,Sr=null,Zr=0,Zn=0,el=es(0),Dr=0,hc=null,Gs=0,Xu=0,vh=0,mc=null,Dn=null,xh=0,tl=1/0,Ti=null,Ju=!1,yh=null,ss=null,Qu=!1,os=null,ed=0,pc=0,_h=null,td=-1,rd=0;function vn(){return(Rt&6)!==0?Me():td!==-1?td:td=Me()}function ls(i){return(i.mode&1)===0?1:(Rt&2)!==0&&Zr!==0?Zr&-Zr:Vy.transition!==null?(rd===0&&(rd=iu()),rd):(i=Pt,i!==0||(i=window.event,i=i===void 0?16:Ct(i.type)),i)}function Ca(i,o,h,g){if(50<pc)throw pc=0,_h=null,Error(t(185));Mn(i,h,g),((Rt&2)===0||i!==Ur)&&(i===Ur&&((Rt&2)===0&&(Xu|=h),Dr===4&&cs(i,Zr)),On(i,g),h===1&&Rt===0&&(o.mode&1)===0&&(tl=Me()+500,Nu&&rs()))}function On(i,o){var h=i.callbackNode;wo(i,o);var g=Jt(i,i===Ur?Zr:0);if(g===0)h!==null&&Ve(h),i.callbackNode=null,i.callbackPriority=0;else if(o=g&-g,i.callbackPriority!==o){if(h!=null&&Ve(h),o===1)i.tag===0?Wy(Wp.bind(null,i)):Am(Wp.bind(null,i)),en(function(){(Rt&6)===0&&rs()}),h=null;else{switch(ji(g)){case 1:h=$t;break;case 4:h=Vt;break;case 16:h=dr;break;case 536870912:h=En;break;default:h=dr}h=Xp(h,$p.bind(null,i))}i.callbackPriority=o,i.callbackNode=h}}function $p(i,o){if(td=-1,rd=0,(Rt&6)!==0)throw Error(t(327));var h=i.callbackNode;if(rl()&&i.callbackNode!==h)return null;var g=Jt(i,i===Ur?Zr:0);if(g===0)return null;if((g&30)!==0||(g&i.expiredLanes)!==0||o)o=nd(i,g);else{o=g;var w=Rt;Rt|=2;var T=Hp();(Ur!==i||Zr!==o)&&(Ti=null,tl=Me()+500,Ks(i,o));do try{u_();break}catch(le){Vp(i,le)}while(!0);Mf(),Yu.current=T,Rt=w,Sr!==null?o=0:(Ur=null,Zr=0,o=Dr)}if(o!==0){if(o===2&&(w=Jr(i),w!==0&&(g=w,o=wh(i,w))),o===1)throw h=hc,Ks(i,0),cs(i,g),On(i,Me()),h;if(o===6)cs(i,g);else{if(w=i.current.alternate,(g&30)===0&&!l_(w)&&(o=nd(i,g),o===2&&(T=Jr(i),T!==0&&(g=T,o=wh(i,T))),o===1))throw h=hc,Ks(i,0),cs(i,g),On(i,Me()),h;switch(i.finishedWork=w,i.finishedLanes=g,o){case 0:case 1:throw Error(t(345));case 2:qs(i,Dn,Ti);break;case 3:if(cs(i,g),(g&130023424)===g&&(o=xh+500-Me(),10<o)){if(Jt(i,0)!==0)break;if(w=i.suspendedLanes,(w&g)!==g){vn(),i.pingedLanes|=i.suspendedLanes&w;break}i.timeoutHandle=Nr(qs.bind(null,i,Dn,Ti),o);break}qs(i,Dn,Ti);break;case 4:if(cs(i,g),(g&4194240)===g)break;for(o=i.eventTimes,w=-1;0<g;){var z=31-ot(g);T=1<<z,z=o[z],z>w&&(w=z),g&=~T}if(g=w,g=Me()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*o_(g/1960))-g,10<g){i.timeoutHandle=Nr(qs.bind(null,i,Dn,Ti),g);break}qs(i,Dn,Ti);break;case 5:qs(i,Dn,Ti);break;default:throw Error(t(329))}}}return On(i,Me()),i.callbackNode===h?$p.bind(null,i):null}function wh(i,o){var h=mc;return i.current.memoizedState.isDehydrated&&(Ks(i,o).flags|=256),i=nd(i,o),i!==2&&(o=Dn,Dn=h,o!==null&&kh(o)),i}function kh(i){Dn===null?Dn=i:Dn.push.apply(Dn,i)}function l_(i){for(var o=i;;){if(o.flags&16384){var h=o.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var g=0;g<h.length;g++){var w=h[g],T=w.getSnapshot;w=w.value;try{if(!Wn(T(),w))return!1}catch{return!1}}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function cs(i,o){for(o&=~vh,o&=~Xu,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var h=31-ot(o),g=1<<h;i[h]=-1,o&=~g}}function Wp(i){if((Rt&6)!==0)throw Error(t(327));rl();var o=Jt(i,0);if((o&1)===0)return On(i,Me()),null;var h=nd(i,o);if(i.tag!==0&&h===2){var g=Jr(i);g!==0&&(o=g,h=wh(i,g))}if(h===1)throw h=hc,Ks(i,0),cs(i,o),On(i,Me()),h;if(h===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,qs(i,Dn,Ti),On(i,Me()),null}function bh(i,o){var h=Rt;Rt|=1;try{return i(o)}finally{Rt=h,Rt===0&&(tl=Me()+500,Nu&&rs())}}function Zs(i){os!==null&&os.tag===0&&(Rt&6)===0&&rl();var o=Rt;Rt|=1;var h=oa.transition,g=Pt;try{if(oa.transition=null,Pt=1,i)return i()}finally{Pt=g,oa.transition=h,Rt=o,(Rt&6)===0&&rs()}}function Sh(){Zn=el.current,sr(el)}function Ks(i,o){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,br(h)),Sr!==null)for(h=Sr.return;h!==null;){var g=h;switch(Of(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Au();break;case 3:Xo(),sr(Pn),sr(tn),Gf();break;case 5:Vf(g);break;case 4:Xo();break;case 13:sr(hr);break;case 19:sr(hr);break;case 10:Bf(g.type._context);break;case 22:case 23:Sh()}h=h.return}if(Ur=i,Sr=i=us(i.current,null),Zr=Zn=o,Dr=0,hc=null,vh=Xu=Gs=0,Dn=mc=null,Ws!==null){for(o=0;o<Ws.length;o++)if(h=Ws[o],g=h.interleaved,g!==null){h.interleaved=null;var w=g.next,T=h.pending;if(T!==null){var z=T.next;T.next=w,g.next=z}h.pending=g}Ws=null}return i}function Vp(i,o){do{var h=Sr;try{if(Mf(),zu.current=Vu,Uu){for(var g=mr.memoizedState;g!==null;){var w=g.queue;w!==null&&(w.pending=null),g=g.next}Uu=!1}if(Hs=0,zr=Ir=mr=null,oc=!1,lc=0,gh.current=null,h===null||h.return===null){Dr=1,hc=o,Sr=null;break}e:{var T=i,z=h.return,le=h,he=o;if(o=Zr,le.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var Ne=he,Le=le,je=Le.tag;if((Le.mode&1)===0&&(je===0||je===11||je===15)){var Fe=Le.alternate;Fe?(Le.updateQueue=Fe.updateQueue,Le.memoizedState=Fe.memoizedState,Le.lanes=Fe.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var qe=pp(z);if(qe!==null){qe.flags&=-257,gp(qe,z,le,T,o),qe.mode&1&&mp(T,Ne,o),o=qe,he=Ne;var tt=o.updateQueue;if(tt===null){var rt=new Set;rt.add(he),o.updateQueue=rt}else tt.add(he);break e}else{if((o&1)===0){mp(T,Ne,o),Th();break e}he=Error(t(426))}}else if(lr&&le.mode&1){var wr=pp(z);if(wr!==null){(wr.flags&65536)===0&&(wr.flags|=256),gp(wr,z,le,T,o),Rf(Jo(he,le));break e}}T=he=Jo(he,le),Dr!==4&&(Dr=2),mc===null?mc=[T]:mc.push(T),T=z;do{switch(T.tag){case 3:T.flags|=65536,o&=-o,T.lanes|=o;var be=fp(T,he,o);Bm(T,be);break e;case 1:le=he;var pe=T.type,Ee=T.stateNode;if((T.flags&128)===0&&(typeof pe.getDerivedStateFromError=="function"||Ee!==null&&typeof Ee.componentDidCatch=="function"&&(ss===null||!ss.has(Ee)))){T.flags|=65536,o&=-o,T.lanes|=o;var Ue=hp(T,le,o);Bm(T,Ue);break e}}T=T.return}while(T!==null)}Zp(h)}catch(it){o=it,Sr===h&&h!==null&&(Sr=h=h.return);continue}break}while(!0)}function Hp(){var i=Yu.current;return Yu.current=Vu,i===null?Vu:i}function Th(){(Dr===0||Dr===3||Dr===2)&&(Dr=4),Ur===null||(Gs&268435455)===0&&(Xu&268435455)===0||cs(Ur,Zr)}function nd(i,o){var h=Rt;Rt|=2;var g=Hp();(Ur!==i||Zr!==o)&&(Ti=null,Ks(i,o));do try{c_();break}catch(w){Vp(i,w)}while(!0);if(Mf(),Rt=h,Yu.current=g,Sr!==null)throw Error(t(261));return Ur=null,Zr=0,Dr}function c_(){for(;Sr!==null;)Gp(Sr)}function u_(){for(;Sr!==null&&!Ze();)Gp(Sr)}function Gp(i){var o=Yp(i.alternate,i,Zn);i.memoizedProps=i.pendingProps,o===null?Zp(i):Sr=o,gh.current=null}function Zp(i){var o=i;do{var h=o.alternate;if(i=o.return,(o.flags&32768)===0){if(h=r_(h,o,Zn),h!==null){Sr=h;return}}else{if(h=n_(h,o),h!==null){h.flags&=32767,Sr=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Dr=6,Sr=null;return}}if(o=o.sibling,o!==null){Sr=o;return}Sr=o=i}while(o!==null);Dr===0&&(Dr=5)}function qs(i,o,h){var g=Pt,w=oa.transition;try{oa.transition=null,Pt=1,d_(i,o,h,g)}finally{oa.transition=w,Pt=g}return null}function d_(i,o,h,g){do rl();while(os!==null);if((Rt&6)!==0)throw Error(t(327));h=i.finishedWork;var w=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var T=h.lanes|h.childLanes;if(pr(i,T),i===Ur&&(Sr=Ur=null,Zr=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||Qu||(Qu=!0,Xp(dr,function(){return rl(),null})),T=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||T){T=oa.transition,oa.transition=null;var z=Pt;Pt=1;var le=Rt;Rt|=4,gh.current=null,i_(i,h),jp(h,i),ea(lt),Ds=!!Ge,lt=Ge=null,i.current=h,s_(h),Be(),Rt=le,Pt=z,oa.transition=T}else i.current=h;if(Qu&&(Qu=!1,os=i,ed=w),T=i.pendingLanes,T===0&&(ss=null),ga(h.stateNode),On(i,Me()),o!==null)for(g=i.onRecoverableError,h=0;h<o.length;h++)w=o[h],g(w.value,{componentStack:w.stack,digest:w.digest});if(Ju)throw Ju=!1,i=yh,yh=null,i;return(ed&1)!==0&&i.tag!==0&&rl(),T=i.pendingLanes,(T&1)!==0?i===_h?pc++:(pc=0,_h=i):pc=0,rs(),null}function rl(){if(os!==null){var i=ji(ed),o=oa.transition,h=Pt;try{if(oa.transition=null,Pt=16>i?16:i,os===null)var g=!1;else{if(i=os,os=null,ed=0,(Rt&6)!==0)throw Error(t(331));var w=Rt;for(Rt|=4,et=i.current;et!==null;){var T=et,z=T.child;if((et.flags&16)!==0){var le=T.deletions;if(le!==null){for(var he=0;he<le.length;he++){var Ne=le[he];for(et=Ne;et!==null;){var Le=et;switch(Le.tag){case 0:case 11:case 15:fc(8,Le,T)}var je=Le.child;if(je!==null)je.return=Le,et=je;else for(;et!==null;){Le=et;var Fe=Le.sibling,qe=Le.return;if(Dp(Le),Le===Ne){et=null;break}if(Fe!==null){Fe.return=qe,et=Fe;break}et=qe}}}var tt=T.alternate;if(tt!==null){var rt=tt.child;if(rt!==null){tt.child=null;do{var wr=rt.sibling;rt.sibling=null,rt=wr}while(rt!==null)}}et=T}}if((T.subtreeFlags&2064)!==0&&z!==null)z.return=T,et=z;else e:for(;et!==null;){if(T=et,(T.flags&2048)!==0)switch(T.tag){case 0:case 11:case 15:fc(9,T,T.return)}var be=T.sibling;if(be!==null){be.return=T.return,et=be;break e}et=T.return}}var pe=i.current;for(et=pe;et!==null;){z=et;var Ee=z.child;if((z.subtreeFlags&2064)!==0&&Ee!==null)Ee.return=z,et=Ee;else e:for(z=pe;et!==null;){if(le=et,(le.flags&2048)!==0)try{switch(le.tag){case 0:case 11:case 15:qu(9,le)}}catch(it){gr(le,le.return,it)}if(le===z){et=null;break e}var Ue=le.sibling;if(Ue!==null){Ue.return=le.return,et=Ue;break e}et=le.return}}if(Rt=w,rs(),_r&&typeof _r.onPostCommitFiberRoot=="function")try{_r.onPostCommitFiberRoot(jn,i)}catch{}g=!0}return g}finally{Pt=h,oa.transition=o}}return!1}function Kp(i,o,h){o=Jo(h,o),o=fp(i,o,1),i=as(i,o,1),o=vn(),i!==null&&(Mn(i,1,o),On(i,o))}function gr(i,o,h){if(i.tag===3)Kp(i,i,h);else for(;o!==null;){if(o.tag===3){Kp(o,i,h);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(ss===null||!ss.has(g))){i=Jo(h,i),i=hp(o,i,1),o=as(o,i,1),i=vn(),o!==null&&(Mn(o,1,i),On(o,i));break}}o=o.return}}function f_(i,o,h){var g=i.pingCache;g!==null&&g.delete(o),o=vn(),i.pingedLanes|=i.suspendedLanes&h,Ur===i&&(Zr&h)===h&&(Dr===4||Dr===3&&(Zr&130023424)===Zr&&500>Me()-xh?Ks(i,0):vh|=h),On(i,o)}function qp(i,o){o===0&&((i.mode&1)===0?o=1:(o=Li,Li<<=1,(Li&130023424)===0&&(Li=4194304)));var h=vn();i=ki(i,o),i!==null&&(Mn(i,o,h),On(i,h))}function h_(i){var o=i.memoizedState,h=0;o!==null&&(h=o.retryLane),qp(i,h)}function m_(i,o){var h=0;switch(i.tag){case 13:var g=i.stateNode,w=i.memoizedState;w!==null&&(h=w.retryLane);break;case 19:g=i.stateNode;break;default:throw Error(t(314))}g!==null&&g.delete(o),qp(i,h)}var Yp;Yp=function(i,o,h){if(i!==null)if(i.memoizedProps!==o.pendingProps||Pn.current)In=!0;else{if((i.lanes&h)===0&&(o.flags&128)===0)return In=!1,t_(i,o,h);In=(i.flags&131072)!==0}else In=!1,lr&&(o.flags&1048576)!==0&&Pm(o,Du,o.index);switch(o.lanes=0,o.tag){case 2:var g=o.type;Zu(i,o),i=o.pendingProps;var w=Vo(o,tn.current);Yo(o,h),w=qf(null,o,g,i,w,h);var T=Yf();return o.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Nn(g)?(T=!0,Pu(o)):T=!1,o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,$f(o),w.updater=Hu,o.stateNode=w,w._reactInternals=o,rh(o,g,i,h),o=sh(null,o,g,!0,T,h)):(o.tag=0,lr&&T&&Df(o),gn(null,o,w,h),o=o.child),o;case 16:g=o.elementType;e:{switch(Zu(i,o),i=o.pendingProps,w=g._init,g=w(g._payload),o.type=g,w=o.tag=g_(g),i=Sa(g,i),w){case 0:o=ih(null,o,g,i,h);break e;case 1:o=kp(null,o,g,i,h);break e;case 11:o=vp(null,o,g,i,h);break e;case 14:o=xp(null,o,g,Sa(g.type,i),h);break e}throw Error(t(306,g,""))}return o;case 0:return g=o.type,w=o.pendingProps,w=o.elementType===g?w:Sa(g,w),ih(i,o,g,w,h);case 1:return g=o.type,w=o.pendingProps,w=o.elementType===g?w:Sa(g,w),kp(i,o,g,w,h);case 3:e:{if(bp(o),i===null)throw Error(t(387));g=o.pendingProps,T=o.memoizedState,w=T.element,Mm(i,o),Mu(o,g,null,h);var z=o.memoizedState;if(g=z.element,T.isDehydrated)if(T={element:g,isDehydrated:!1,cache:z.cache,pendingSuspenseBoundaries:z.pendingSuspenseBoundaries,transitions:z.transitions},o.updateQueue.baseState=T,o.memoizedState=T,o.flags&256){w=Jo(Error(t(423)),o),o=Sp(i,o,g,h,w);break e}else if(g!==w){w=Jo(Error(t(424)),o),o=Sp(i,o,g,h,w);break e}else for(Gn=Za(o.stateNode.containerInfo.firstChild),Hn=o,lr=!0,ba=null,h=Rm(o,null,g,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Zo(),g===w){o=Si(i,o,h);break e}gn(i,o,g,h)}o=o.child}return o;case 5:return Um(o),i===null&&Lf(o),g=o.type,w=o.pendingProps,T=i!==null?i.memoizedProps:null,z=w.children,bt(g,w)?z=null:T!==null&&bt(g,T)&&(o.flags|=32),wp(i,o),gn(i,o,z,h),o.child;case 6:return i===null&&Lf(o),null;case 13:return Tp(i,o,h);case 4:return Wf(o,o.stateNode.containerInfo),g=o.pendingProps,i===null?o.child=Ko(o,null,g,h):gn(i,o,g,h),o.child;case 11:return g=o.type,w=o.pendingProps,w=o.elementType===g?w:Sa(g,w),vp(i,o,g,w,h);case 7:return gn(i,o,o.pendingProps,h),o.child;case 8:return gn(i,o,o.pendingProps.children,h),o.child;case 12:return gn(i,o,o.pendingProps.children,h),o.child;case 10:e:{if(g=o.type._context,w=o.pendingProps,T=o.memoizedProps,z=w.value,Qt(Lu,g._currentValue),g._currentValue=z,T!==null)if(Wn(T.value,z)){if(T.children===w.children&&!Pn.current){o=Si(i,o,h);break e}}else for(T=o.child,T!==null&&(T.return=o);T!==null;){var le=T.dependencies;if(le!==null){z=T.child;for(var he=le.firstContext;he!==null;){if(he.context===g){if(T.tag===1){he=bi(-1,h&-h),he.tag=2;var Ne=T.updateQueue;if(Ne!==null){Ne=Ne.shared;var Le=Ne.pending;Le===null?he.next=he:(he.next=Le.next,Le.next=he),Ne.pending=he}}T.lanes|=h,he=T.alternate,he!==null&&(he.lanes|=h),zf(T.return,h,o),le.lanes|=h;break}he=he.next}}else if(T.tag===10)z=T.type===o.type?null:T.child;else if(T.tag===18){if(z=T.return,z===null)throw Error(t(341));z.lanes|=h,le=z.alternate,le!==null&&(le.lanes|=h),zf(z,h,o),z=T.sibling}else z=T.child;if(z!==null)z.return=T;else for(z=T;z!==null;){if(z===o){z=null;break}if(T=z.sibling,T!==null){T.return=z.return,z=T;break}z=z.return}T=z}gn(i,o,w.children,h),o=o.child}return o;case 9:return w=o.type,g=o.pendingProps.children,Yo(o,h),w=ia(w),g=g(w),o.flags|=1,gn(i,o,g,h),o.child;case 14:return g=o.type,w=Sa(g,o.pendingProps),w=Sa(g.type,w),xp(i,o,g,w,h);case 15:return yp(i,o,o.type,o.pendingProps,h);case 17:return g=o.type,w=o.pendingProps,w=o.elementType===g?w:Sa(g,w),Zu(i,o),o.tag=1,Nn(g)?(i=!0,Pu(o)):i=!1,Yo(o,h),up(o,g,w),rh(o,g,w,h),sh(null,o,g,!0,i,h);case 19:return Cp(i,o,h);case 22:return _p(i,o,h)}throw Error(t(156,o.tag))};function Xp(i,o){return Re(i,o)}function p_(i,o,h,g){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(i,o,h,g){return new p_(i,o,h,g)}function Eh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function g_(i){if(typeof i=="function")return Eh(i)?1:0;if(i!=null){if(i=i.$$typeof,i===J)return 11;if(i===se)return 14}return 2}function us(i,o){var h=i.alternate;return h===null?(h=la(i.tag,o,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=o,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,o=i.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function ad(i,o,h,g,w,T){var z=2;if(g=i,typeof i=="function")Eh(i)&&(z=1);else if(typeof i=="string")z=5;else e:switch(i){case D:return Ys(h.children,w,T,o);case te:z=8,w|=8;break;case ee:return i=la(12,h,o,w|2),i.elementType=ee,i.lanes=T,i;case ce:return i=la(13,h,o,w),i.elementType=ce,i.lanes=T,i;case ke:return i=la(19,h,o,w),i.elementType=ke,i.lanes=T,i;case j:return id(h,w,T,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ve:z=10;break e;case me:z=9;break e;case J:z=11;break e;case se:z=14;break e;case ue:z=16,g=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=la(z,h,o,w),o.elementType=i,o.type=g,o.lanes=T,o}function Ys(i,o,h,g){return i=la(7,i,g,o),i.lanes=h,i}function id(i,o,h,g){return i=la(22,i,g,o),i.elementType=j,i.lanes=h,i.stateNode={isHidden:!1},i}function Ch(i,o,h){return i=la(6,i,null,o),i.lanes=h,i}function Ah(i,o,h){return o=la(4,i.children!==null?i.children:[],i.key,o),o.lanes=h,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function v_(i,o,h,g,w){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ri(0),this.expirationTimes=Ri(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ri(0),this.identifierPrefix=g,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function Ph(i,o,h,g,w,T,z,le,he){return i=new v_(i,o,h,le,he),o===1?(o=1,T===!0&&(o|=8)):o=0,T=la(3,null,null,o),i.current=T,T.stateNode=i,T.memoizedState={element:g,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},$f(T),i}function x_(i,o,h){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:g==null?null:""+g,children:i,containerInfo:o,implementation:h}}function Jp(i){if(!i)return ts;i=i._reactInternals;e:{if(ie(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Nn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var h=i.type;if(Nn(h))return Em(i,h,o)}return o}function Qp(i,o,h,g,w,T,z,le,he){return i=Ph(h,g,!0,i,w,T,z,le,he),i.context=Jp(null),h=i.current,g=vn(),w=ls(h),T=bi(g,w),T.callback=o??null,as(h,T,w),i.current.lanes=w,Mn(i,w,g),On(i,g),i}function sd(i,o,h,g){var w=o.current,T=vn(),z=ls(w);return h=Jp(h),o.context===null?o.context=h:o.pendingContext=h,o=bi(T,z),o.payload={element:i},g=g===void 0?null:g,g!==null&&(o.callback=g),i=as(w,o,z),i!==null&&(Ca(i,w,z,T),ju(i,w,z)),z}function od(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function eg(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<o?h:o}}function Nh(i,o){eg(i,o),(i=i.alternate)&&eg(i,o)}function y_(){return null}var tg=typeof reportError=="function"?reportError:function(i){console.error(i)};function Ih(i){this._internalRoot=i}ld.prototype.render=Ih.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));sd(i,o,null,null)},ld.prototype.unmount=Ih.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Zs(function(){sd(null,i,null,null)}),o[zt]=null}};function ld(i){this._internalRoot=i}ld.prototype.unstable_scheduleHydration=function(i){if(i){var o=So();i={blockedOn:null,target:i,priority:o};for(var h=0;h<Pr.length&&o!==0&&o<Pr[h].priority;h++);Pr.splice(h,0,i),h===0&&To(i)}};function Dh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function cd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function rg(){}function __(i,o,h,g,w){if(w){if(typeof g=="function"){var T=g;g=function(){var Ne=od(z);T.call(Ne)}}var z=Qp(o,g,i,0,null,!1,!1,"",rg);return i._reactRootContainer=z,i[zt]=z.current,Yi(i.nodeType===8?i.parentNode:i),Zs(),z}for(;w=i.lastChild;)i.removeChild(w);if(typeof g=="function"){var le=g;g=function(){var Ne=od(he);le.call(Ne)}}var he=Ph(i,0,!1,null,null,!1,!1,"",rg);return i._reactRootContainer=he,i[zt]=he.current,Yi(i.nodeType===8?i.parentNode:i),Zs(function(){sd(o,he,h,g)}),he}function ud(i,o,h,g,w){var T=h._reactRootContainer;if(T){var z=T;if(typeof w=="function"){var le=w;w=function(){var he=od(z);le.call(he)}}sd(o,z,i,w)}else z=__(h,o,i,w,g);return od(z)}ko=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var h=yt(o.pendingLanes);h!==0&&(xa(o,h|1),On(o,Me()),(Rt&6)===0&&(tl=Me()+500,rs()))}break;case 13:Zs(function(){var g=ki(i,1);if(g!==null){var w=vn();Ca(g,i,1,w)}}),Nh(i,1)}},oi=function(i){if(i.tag===13){var o=ki(i,134217728);if(o!==null){var h=vn();Ca(o,i,134217728,h)}Nh(i,134217728)}},bo=function(i){if(i.tag===13){var o=ls(i),h=ki(i,o);if(h!==null){var g=vn();Ca(h,i,o,g)}Nh(i,o)}},So=function(){return Pt},As=function(i,o){var h=Pt;try{return Pt=i,o()}finally{Pt=h}},Ba=function(i,o,h){switch(o){case"input":if($e(i,h),o=h.name,h.type==="radio"&&o!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<h.length;o++){var g=h[o];if(g!==i&&g.form===i.form){var w=$o(g);if(!w)throw Error(t(90));ne(g),$e(g,w)}}}break;case"textarea":or(i,h);break;case"select":o=h.value,o!=null&&Zt(i,!!h.multiple,o,!1)}},Qe=bh,at=Zs;var w_={usingClientEntryPoint:!1,Events:[vi,xi,$o,Ye,He,bh]},gc={findFiberByHostInstance:gi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},k_={bundleType:gc.bundleType,version:gc.version,rendererPackageName:gc.rendererPackageName,rendererConfig:gc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:U.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Ce(i),i===null?null:i.stateNode},findFiberByHostInstance:gc.findFiberByHostInstance||y_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dd.isDisabled&&dd.supportsFiber)try{jn=dd.inject(k_),_r=dd}catch{}}return Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w_,Fn.createPortal=function(i,o){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dh(o))throw Error(t(200));return x_(i,o,null,h)},Fn.createRoot=function(i,o){if(!Dh(i))throw Error(t(299));var h=!1,g="",w=tg;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onRecoverableError!==void 0&&(w=o.onRecoverableError)),o=Ph(i,1,!1,null,null,h,!1,g,w),i[zt]=o.current,Yi(i.nodeType===8?i.parentNode:i),new Ih(o)},Fn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Ce(o),i=i===null?null:i.stateNode,i},Fn.flushSync=function(i){return Zs(i)},Fn.hydrate=function(i,o,h){if(!cd(o))throw Error(t(200));return ud(null,i,o,!0,h)},Fn.hydrateRoot=function(i,o,h){if(!Dh(i))throw Error(t(405));var g=h!=null&&h.hydratedSources||null,w=!1,T="",z=tg;if(h!=null&&(h.unstable_strictMode===!0&&(w=!0),h.identifierPrefix!==void 0&&(T=h.identifierPrefix),h.onRecoverableError!==void 0&&(z=h.onRecoverableError)),o=Qp(o,null,i,1,h??null,w,!1,T,z),i[zt]=o.current,Yi(i),g)for(i=0;i<g.length;i++)h=g[i],w=h._getVersion,w=w(h._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[h,w]:o.mutableSourceEagerHydrationData.push(h,w);return new ld(o)},Fn.render=function(i,o,h){if(!cd(o))throw Error(t(200));return ud(null,i,o,!1,h)},Fn.unmountComponentAtNode=function(i){if(!cd(i))throw Error(t(40));return i._reactRootContainer?(Zs(function(){ud(null,null,i,!1,function(){i._reactRootContainer=null,i[zt]=null})}),!0):!1},Fn.unstable_batchedUpdates=bh,Fn.unstable_renderSubtreeIntoContainer=function(i,o,h,g){if(!cd(h))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return ud(i,o,h,!1,g)},Fn.version="18.3.1-next-f1338f8080-20240426",Fn}var ug;function lx(){if(ug)return Lh.exports;ug=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),Lh.exports=N_(),Lh.exports}var dg;function I_(){if(dg)return fd;dg=1;var e=lx();return fd.createRoot=e.createRoot,fd.hydrateRoot=e.hydrateRoot,fd}var D_=I_();const O_=rf(D_);var Y=j0();const Xt=rf(Y);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var cx=1252,F_=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],M0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},B0=function(e){F_.indexOf(e)!=-1&&(cx=M0[0]=e)};function L_(){B0(1252)}var Fa=function(e){B0(e)};function ux(){Fa(1200),L_()}function fg(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function R_(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function dx(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var wc=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?R_(e.slice(2)):r==254&&t==255?dx(e.slice(2)):r==65279?e.slice(1):e},hd=function(r){return String.fromCharCode(r)},hg=function(r){return String.fromCharCode(r)},Bc,ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function mg(e){for(var r="",t=0,n=0,a=0,l=0,c=0,d=0,m=0,v=0;v<e.length;)t=e.charCodeAt(v++),l=t>>2,n=e.charCodeAt(v++),c=(t&3)<<4|n>>4,a=e.charCodeAt(v++),d=(n&15)<<2|a>>6,m=a&63,isNaN(n)?d=m=64:isNaN(a)&&(m=64),r+=ws.charAt(l)+ws.charAt(c)+ws.charAt(d)+ws.charAt(m);return r}function Yn(e){var r="",t=0,n=0,a=0,l=0,c=0,d=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var v=0;v<e.length;)l=ws.indexOf(e.charAt(v++)),c=ws.indexOf(e.charAt(v++)),t=l<<2|c>>4,r+=String.fromCharCode(t),d=ws.indexOf(e.charAt(v++)),n=(c&15)<<4|d>>2,d!==64&&(r+=String.fromCharCode(n)),m=ws.indexOf(e.charAt(v++)),a=(d&3)<<6|m,m!==64&&(r+=String.fromCharCode(a));return r}var Nt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ho=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Ss(e){return Nt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function pg(e){return Nt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Oa=function(r){return Nt?ho(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function mo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function z0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return z0(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var ys=Nt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:ho(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function j_(e){for(var r=[],t=0,n=e.length+250,a=Ss(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)a[t++]=c;else if(c<2048)a[t++]=192|c>>6&31,a[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var d=e.charCodeAt(++l)&1023;a[t++]=240|c>>8&7,a[t++]=128|c>>2&63,a[t++]=128|d>>6&15|(c&3)<<4,a[t++]=128|d&63}else a[t++]=224|c>>12&15,a[t++]=128|c>>6&63,a[t++]=128|c&63;t>n&&(r.push(a.slice(0,t)),t=0,a=Ss(65535),n=65530)}return r.push(a.slice(0,t)),ys(r)}var kn=/\u0000/g,kc=/[\u0001-\u0006]/g;function _l(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function La(e,r){var t=""+e;return t.length>=r?t:vr("0",r-t.length)+t}function U0(e,r){var t=""+e;return t.length>=r?t:vr(" ",r-t.length)+t}function zd(e,r){var t=""+e;return t.length>=r?t:t+vr(" ",r-t.length)}function M_(e,r){var t=""+Math.round(e);return t.length>=r?t:vr("0",r-t.length)+t}function B_(e,r){var t=""+e;return t.length>=r?t:vr("0",r-t.length)+t}var gg=Math.pow(2,32);function nl(e,r){if(e>gg||e<-gg)return M_(e,r);var t=Math.round(e);return B_(t,r)}function Ud(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var vg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Mh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function z_(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Tt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},xg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},U_={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $d(e,r,t){for(var n=e<0?-1:1,a=e*n,l=0,c=1,d=0,m=1,v=0,x=0,y=Math.floor(a);v<r&&(y=Math.floor(a),d=y*c+l,x=y*v+m,!(a-y<5e-8));)a=1/(a-y),l=c,c=d,m=v,v=x;if(x>r&&(v>r?(x=m,d=l):(x=v,d=c)),!t)return[0,n*d,x];var k=Math.floor(n*d/x);return[k,n*d-k*x,x]}function ao(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),l=0,c=[],d={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(n+=1462),d.u>.9999&&(d.u=0,++a==86400&&(d.T=a=0,++n,++d.D)),n===60)c=t?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=t?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),c=[m.getFullYear(),m.getMonth()+1,m.getDate()],l=m.getDay(),n<60&&(l=(l+6)%7),t&&(l=Z_(m,c))}return d.y=c[0],d.m=c[1],d.d=c[2],d.S=a%60,a=Math.floor(a/60),d.M=a%60,a=Math.floor(a/60),d.H=a,d.q=l,d}var fx=new Date(1899,11,31,0,0,0),$_=fx.getTime(),W_=new Date(1900,2,1,0,0,0);function hx(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=W_&&(t+=1440*60*1e3),(t-($_+(e.getTimezoneOffset()-fx.getTimezoneOffset())*6e4))/(1440*60*1e3)}function $0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function V_(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function H_(e){var r=e<0?12:11,t=$0(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function G_(e){var r=$0(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function zc(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=H_(e):r===10?t=e.toFixed(10).substr(0,12):t=G_(e),$0(V_(t.toUpperCase()))}function co(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ha(14,hx(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function Z_(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function K_(e,r,t,n){var a="",l=0,c=0,d=t.y,m,v=0;switch(e){case 98:d=t.y+543;case 121:switch(r.length){case 1:case 2:m=d%100,v=2;break;default:m=d%1e4,v=4;break}break;case 109:switch(r.length){case 1:case 2:m=t.m,v=r.length;break;case 3:return Mh[t.m-1][1];case 5:return Mh[t.m-1][0];default:return Mh[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:m=t.d,v=r.length;break;case 3:return vg[t.q][0];default:return vg[t.q][1]}break;case 104:switch(r.length){case 1:case 2:m=1+(t.H+11)%12,v=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:m=t.H,v=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:m=t.M,v=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?La(t.S,r.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(t.S+t.u)),l>=60*c&&(l=0),r==="s"?l===0?"0":""+l/c:(a=La(l,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":m=t.D*24+t.H;break;case"[m]":case"[mm]":m=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":m=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}v=r.length===3?1:2;break;case 101:m=d,v=1;break}var x=v>0?La(m,v):"";return x}function ks(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var mx=/%/g;function q_(e,r,t){var n=r.replace(mx,""),a=r.length-n.length;return Ni(e,n,t*Math.pow(10,2*a))+vr("%",a)}function Y_(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Ni(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function px(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+px(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%a;if(l<0&&(l+=a),t=(r/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),t.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,v,x){return m+v+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var gx=/# (\?+)( ?)\/( ?)(\d+)/;function X_(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),l=Math.floor(a/n),c=a-l*n,d=n;return t+(l===0?"":""+l)+" "+(c===0?vr(" ",e[1].length+1+e[4].length):U0(c,e[1].length)+e[2]+"/"+e[3]+La(d,e[4].length))}function J_(e,r,t){return t+(r===0?"":""+r)+vr(" ",e[1].length+2+e[4].length)}var vx=/^#*0*\.([0#]+)/,xx=/\).*[0#]/,yx=/\(###\) ###\\?-####/;function yn(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function yg(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function _g(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function Q_(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function ew(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ua(e,r,t){if(e.charCodeAt(0)===40&&!r.match(xx)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ua("n",n,t):"("+ua("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Y_(e,r,t);if(r.indexOf("%")!==-1)return q_(e,r,t);if(r.indexOf("E")!==-1)return px(r,t);if(r.charCodeAt(0)===36)return"$"+ua(e,r.substr(r.charAt(1)==" "?2:1),t);var a,l,c,d,m=Math.abs(t),v=t<0?"-":"";if(r.match(/^00+$/))return v+nl(m,r.length);if(r.match(/^[#?]+$/))return a=nl(t,0),a==="0"&&(a=""),a.length>r.length?a:yn(r.substr(0,r.length-a.length))+a;if(l=r.match(gx))return X_(l,m,v);if(r.match(/^#+0+$/))return v+nl(m,r.length-r.indexOf("0"));if(l=r.match(vx))return a=yg(t,l[1].length).replace(/^([^\.]+)$/,"$1."+yn(l[1])).replace(/\.$/,"."+yn(l[1])).replace(/\.(\d*)$/,function(b,S){return"."+S+vr("0",yn(l[1]).length-S.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return v+yg(m,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return v+ks(nl(m,0));if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ua(e,r,-t):ks(""+(Math.floor(t)+Q_(t,l[1].length)))+"."+La(_g(t,l[1].length),l[1].length);if(l=r.match(/^#,#*,#0/))return ua(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_l(ua(e,r.replace(/[\\-]/g,""),t)),c=0,_l(_l(r.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<a.length?a.charAt(c++):b==="0"?"0":""}));if(r.match(yx))return a=ua(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),d=$d(m,Math.pow(10,c)-1,!1),a=""+v,x=Ni("n",l[1],d[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=zd(d[2],c),x.length<l[4].length&&(x=yn(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),d=$d(m,Math.pow(10,c)-1,!0),v+(d[0]||(d[1]?"":"0"))+" "+(d[1]?U0(d[1],c)+l[2]+"/"+l[3]+zd(d[2],c):vr(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return a=nl(t,0),r.length<=a.length?a:yn(r.substr(0,r.length-a.length))+a;if(l=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=r.indexOf(".")-c,k=r.length-a.length-y;return yn(r.substr(0,y)+a+r.substr(r.length-k))}if(l=r.match(/^00,000\.([#0]*0)$/))return c=_g(t,l[1].length),t<0?"-"+ua(e,r,-t):ks(ew(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?La(0,3-b.length):"")+b})+"."+La(c,l[1].length);switch(r){case"###,##0.00":return ua(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var E=ks(nl(m,0));return E!=="0"?v+E:"";case"###,###.00":return ua(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ua(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function tw(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Ni(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function rw(e,r,t){var n=r.replace(mx,""),a=r.length-n.length;return Ni(e,n,t*Math.pow(10,2*a))+vr("%",a)}function _x(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+_x(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%a;if(l<0&&(l+=a),t=(r/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),!t.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,v,x){return m+v+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ja(e,r,t){if(e.charCodeAt(0)===40&&!r.match(xx)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ja("n",n,t):"("+Ja("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return tw(e,r,t);if(r.indexOf("%")!==-1)return rw(e,r,t);if(r.indexOf("E")!==-1)return _x(r,t);if(r.charCodeAt(0)===36)return"$"+Ja(e,r.substr(r.charAt(1)==" "?2:1),t);var a,l,c,d,m=Math.abs(t),v=t<0?"-":"";if(r.match(/^00+$/))return v+La(m,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:yn(r.substr(0,r.length-a.length))+a;if(l=r.match(gx))return J_(l,m,v);if(r.match(/^#+0+$/))return v+La(m,r.length-r.indexOf("0"));if(l=r.match(vx))return a=(""+t).replace(/^([^\.]+)$/,"$1."+yn(l[1])).replace(/\.$/,"."+yn(l[1])),a=a.replace(/\.(\d*)$/,function(b,S){return"."+S+vr("0",yn(l[1]).length-S.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return v+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return v+ks(""+m);if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ja(e,r,-t):ks(""+t)+"."+vr("0",l[1].length);if(l=r.match(/^#,#*,#0/))return Ja(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=_l(Ja(e,r.replace(/[\\-]/g,""),t)),c=0,_l(_l(r.replace(/\\/g,"")).replace(/[0#]/g,function(b){return c<a.length?a.charAt(c++):b==="0"?"0":""}));if(r.match(yx))return a=Ja(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),d=$d(m,Math.pow(10,c)-1,!1),a=""+v,x=Ni("n",l[1],d[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=zd(d[2],c),x.length<l[4].length&&(x=yn(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),d=$d(m,Math.pow(10,c)-1,!0),v+(d[0]||(d[1]?"":"0"))+" "+(d[1]?U0(d[1],c)+l[2]+"/"+l[3]+zd(d[2],c):vr(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:yn(r.substr(0,r.length-a.length))+a;if(l=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=r.indexOf(".")-c,k=r.length-a.length-y;return yn(r.substr(0,y)+a+r.substr(r.length-k))}if(l=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ja(e,r,-t):ks(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?La(0,3-b.length):"")+b})+"."+La(0,l[1].length);switch(r){case"###,###":case"##,###":case"#,###":var E=ks(""+m);return E!=="0"?v+E:"";default:if(r.match(/\.[0#?]*$/))return Ja(e,r.slice(0,r.lastIndexOf(".")),t)+yn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Ni(e,r,t){return(t|0)===t?Ja(e,r,t):ua(e,r,t)}function nw(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var wx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Cl(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Ud(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(wx))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function aw(e,r,t,n){for(var a=[],l="",c=0,d="",m="t",v,x,y,k="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Ud(e,c))throw new Error("unrecognized character "+d+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(y=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(y);a[a.length]={t:"t",v:l},++c;break;case"\\":var E=e.charAt(++c),b=E==="("||E===")"?E:"t";a[a.length]={t:b,v:E},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(v==null&&(v=ao(r,t,e.charAt(c+1)==="2"),v==null))return"";a[a.length]={t:"X",v:e.substr(c,2)},m=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||v==null&&(v=ao(r,t),v==null))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;d==="m"&&m.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=k),a[a.length]={t:d,v:l},m=d;break;case"A":case"a":case"上":var S={t:d,v:d};if(v==null&&(v=ao(r,t)),e.substr(c,3).toUpperCase()==="A/P"?(v!=null&&(S.v=v.H>=12?"P":"A"),S.t="T",k="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(v!=null&&(S.v=v.H>=12?"PM":"AM"),S.t="T",c+=5,k="h"):e.substr(c,5).toUpperCase()==="上午/下午"?(v!=null&&(S.v=v.H>=12?"下午":"上午"),S.t="T",c+=5,k="h"):(S.t="t",++c),v==null&&S.t==="T")return"";a[a.length]=S,m=d;break;case"[":for(l=d;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(wx)){if(v==null&&(v=ao(r,t),v==null))return"";a[a.length]={t:"Z",v:l.toLowerCase()},m=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Cl(e)||(a[a.length]={t:"t",v:l}));break;case".":if(v!=null){for(l=d;++c<e.length&&(d=e.charAt(c))==="0";)l+=d;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;a[a.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;a[a.length]={t:d,v:l},m=d;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:n===1?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:d,v:d},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);a[a.length]={t:"t",v:d},++c;break}var A=0,R=0,O;for(c=a.length-1,m="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=k,m="h",A<1&&(A=1);break;case"s":(O=a[c].v.match(/\.0+$/))&&(R=Math.max(R,O[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":m=a[c].t;break;case"m":m==="s"&&(a[c].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&a[c].v.match(/[Hh]/)&&(A=1),A<2&&a[c].v.match(/[Mm]/)&&(A=2),A<3&&a[c].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:v.u>=.5&&(v.u=0,++v.S),v.S>=60&&(v.S=0,++v.M),v.M>=60&&(v.M=0,++v.H);break;case 2:v.u>=.5&&(v.u=0,++v.S),v.S>=60&&(v.S=0,++v.M);break}var N="",U;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=K_(a[c].t.charCodeAt(0),a[c].v,v,R),a[c].t="t";break;case"n":case"?":for(U=c+1;a[U]!=null&&((d=a[U].t)==="?"||d==="D"||(d===" "||d==="t")&&a[U+1]!=null&&(a[U+1].t==="?"||a[U+1].t==="t"&&a[U+1].v==="/")||a[c].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(a[U].v==="/"||a[U].v===" "&&a[U+1]!=null&&a[U+1].t=="?"));)a[c].v+=a[U].v,a[U]={v:"",t:";"},++U;N+=a[c].v,c=U-1;break;case"G":a[c].t="t",a[c].v=co(r,t);break}var K="",B,D;if(N.length>0){N.charCodeAt(0)==40?(B=r<0&&N.charCodeAt(0)===45?-r:r,D=Ni("n",N,B)):(B=r<0&&n>1?-r:r,D=Ni("n",N,B),B<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),U=D.length-1;var te=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){te=c;break}var ee=a.length;if(te===a.length&&D.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(U>=a[c].v.length-1?(U-=a[c].v.length,a[c].v=D.substr(U+1,a[c].v.length)):U<0?a[c].v="":(a[c].v=D.substr(0,U+1),U=-1),a[c].t="t",ee=c);U>=0&&ee<a.length&&(a[ee].v=D.substr(0,U+1)+a[ee].v)}else if(te!==a.length&&D.indexOf("E")===-1){for(U=D.indexOf(".")-1,c=te;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(x=a[c].v.indexOf(".")>-1&&c===te?a[c].v.indexOf(".")-1:a[c].v.length-1,K=a[c].v.substr(x+1);x>=0;--x)U>=0&&(a[c].v.charAt(x)==="0"||a[c].v.charAt(x)==="#")&&(K=D.charAt(U--)+K);a[c].v=K,a[c].t="t",ee=c}for(U>=0&&ee<a.length&&(a[ee].v=D.substr(0,U+1)+a[ee].v),U=D.indexOf(".")+1,c=te;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==te)){for(x=a[c].v.indexOf(".")>-1&&c===te?a[c].v.indexOf(".")+1:0,K=a[c].v.substr(0,x);x<a[c].v.length;++x)U<D.length&&(K+=D.charAt(U++));a[c].v=K,a[c].t="t",ee=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(B=n>1&&r<0&&c>0&&a[c-1].v==="-"?-r:r,a[c].v=Ni(a[c].t,a[c].v,B),a[c].t="t");var ve="";for(c=0;c!==a.length;++c)a[c]!=null&&(ve+=a[c].v);return ve}var wg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function kg(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function iw(e,r){var t=nw(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(wg),d=t[1].match(wg);return kg(r,c)?[n,t[0]]:kg(r,d)?[n,t[1]]:[n,t[c!=null&&d!=null?2:1]]}return[n,l]}function ha(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:Tt)[e],n==null&&(n=t.table&&t.table[xg[e]]||Tt[xg[e]]),n==null&&(n=U_[e]||"General");break}if(Ud(n,0))return co(r,t);r instanceof Date&&(r=hx(r,t.date1904));var a=iw(n,r);if(Ud(a[1]))return co(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return aw(a[1],r,t,a[0])}function io(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(Tt[t]==null){r<0&&(r=t);continue}if(Tt[t]==e){r=t;break}}r<0&&(r=391)}return Tt[r]=e,r}function kx(){Tt=z_()}var sw={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},bx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ow(e){var r=typeof e=="number"?Tt[e]:e;return r=r.replace(bx,"(\\d+)"),new RegExp("^"+r+"$")}function lw(e,r,t){var n=-1,a=-1,l=-1,c=-1,d=-1,m=-1;(r.match(bx)||[]).forEach(function(y,k){var E=parseInt(t[k+1],10);switch(y.toLowerCase().charAt(0)){case"y":n=E;break;case"d":l=E;break;case"h":c=E;break;case"s":m=E;break;case"m":c>=0?d=E:a=E;break}}),m>=0&&d==-1&&a>=0&&(d=a,a=-1);var v=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);v.length==7&&(v="0"+v),v.length==8&&(v="20"+v);var x=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return c==-1&&d==-1&&m==-1?v:n==-1&&a==-1&&l==-1?x:v+"T"+x}var cw=(function(){var e={};e.version="1.2.0";function r(){for(var D=0,te=new Array(256),ee=0;ee!=256;++ee)D=ee,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,te[ee]=D;return typeof Int32Array<"u"?new Int32Array(te):te}var t=r();function n(D){var te=0,ee=0,ve=0,me=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ve=0;ve!=256;++ve)me[ve]=D[ve];for(ve=0;ve!=256;++ve)for(ee=D[ve],te=256+ve;te<4096;te+=256)ee=me[te]=ee>>>8^D[ee&255];var J=[];for(ve=1;ve!=16;++ve)J[ve-1]=typeof Int32Array<"u"?me.subarray(ve*256,ve*256+256):me.slice(ve*256,ve*256+256);return J}var a=n(t),l=a[0],c=a[1],d=a[2],m=a[3],v=a[4],x=a[5],y=a[6],k=a[7],E=a[8],b=a[9],S=a[10],A=a[11],R=a[12],O=a[13],N=a[14];function U(D,te){for(var ee=te^-1,ve=0,me=D.length;ve<me;)ee=ee>>>8^t[(ee^D.charCodeAt(ve++))&255];return~ee}function K(D,te){for(var ee=te^-1,ve=D.length-15,me=0;me<ve;)ee=N[D[me++]^ee&255]^O[D[me++]^ee>>8&255]^R[D[me++]^ee>>16&255]^A[D[me++]^ee>>>24]^S[D[me++]]^b[D[me++]]^E[D[me++]]^k[D[me++]]^y[D[me++]]^x[D[me++]]^v[D[me++]]^m[D[me++]]^d[D[me++]]^c[D[me++]]^l[D[me++]]^t[D[me++]];for(ve+=15;me<ve;)ee=ee>>>8^t[(ee^D[me++])&255];return~ee}function B(D,te){for(var ee=te^-1,ve=0,me=D.length,J=0,ce=0;ve<me;)J=D.charCodeAt(ve++),J<128?ee=ee>>>8^t[(ee^J)&255]:J<2048?(ee=ee>>>8^t[(ee^(192|J>>6&31))&255],ee=ee>>>8^t[(ee^(128|J&63))&255]):J>=55296&&J<57344?(J=(J&1023)+64,ce=D.charCodeAt(ve++)&1023,ee=ee>>>8^t[(ee^(240|J>>8&7))&255],ee=ee>>>8^t[(ee^(128|J>>2&63))&255],ee=ee>>>8^t[(ee^(128|ce>>6&15|(J&3)<<4))&255],ee=ee>>>8^t[(ee^(128|ce&63))&255]):(ee=ee>>>8^t[(ee^(224|J>>12&15))&255],ee=ee>>>8^t[(ee^(128|J>>6&63))&255],ee=ee>>>8^t[(ee^(128|J&63))&255]);return~ee}return e.table=t,e.bstr=U,e.buf=K,e.str=B,e})(),Ft=(function(){var r={};r.version="1.2.1";function t(W,re){for(var q=W.split("/"),Q=re.split("/"),ae=0,ie=0,Se=Math.min(q.length,Q.length);ae<Se;++ae){if(ie=q[ae].length-Q[ae].length)return ie;if(q[ae]!=Q[ae])return q[ae]<Q[ae]?-1:1}return q.length-Q.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var re=W.lastIndexOf("/");return re===-1?W:W.slice(0,re+1)}function a(W){if(W.charAt(W.length-1)=="/")return a(W.slice(0,-1));var re=W.lastIndexOf("/");return re===-1?W:W.slice(re+1)}function l(W,re){typeof re=="string"&&(re=new Date(re));var q=re.getHours();q=q<<6|re.getMinutes(),q=q<<5|re.getSeconds()>>>1,W.write_shift(2,q);var Q=re.getFullYear()-1980;Q=Q<<4|re.getMonth()+1,Q=Q<<5|re.getDate(),W.write_shift(2,Q)}function c(W){var re=W.read_shift(2)&65535,q=W.read_shift(2)&65535,Q=new Date,ae=q&31;q>>>=5;var ie=q&15;q>>>=4,Q.setMilliseconds(0),Q.setFullYear(q+1980),Q.setMonth(ie-1),Q.setDate(ae);var Se=re&31;re>>>=5;var Ie=re&63;return re>>>=6,Q.setHours(re),Q.setMinutes(Ie),Q.setSeconds(Se<<1),Q}function d(W){Kr(W,0);for(var re={},q=0;W.l<=W.length-4;){var Q=W.read_shift(2),ae=W.read_shift(2),ie=W.l+ae,Se={};switch(Q){case 21589:q=W.read_shift(1),q&1&&(Se.mtime=W.read_shift(4)),ae>5&&(q&2&&(Se.atime=W.read_shift(4)),q&4&&(Se.ctime=W.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}W.l=ie,re[Q]=Se}return re}var m;function v(){return m||(m={})}function x(W,re){if(W[0]==80&&W[1]==75)return Ba(W,re);if((W[0]|32)==109&&(W[1]|32)==105)return Xe(W,re);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var q=3,Q=512,ae=0,ie=0,Se=0,Ie=0,Te=0,Ce=[],Ae=W.slice(0,512);Kr(Ae,0);var Re=y(Ae);switch(q=Re[0],q){case 3:Q=512;break;case 4:Q=4096;break;case 0:if(Re[1]==0)return Ba(W,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}Q!==512&&(Ae=W.slice(0,Q),Kr(Ae,28));var Ve=W.slice(0,Q);k(Ae,q);var Ze=Ae.read_shift(4,"i");if(q===3&&Ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ze);Ae.l+=4,Se=Ae.read_shift(4,"i"),Ae.l+=4,Ae.chk("00100000","Mini Stream Cutoff Size: "),Ie=Ae.read_shift(4,"i"),ae=Ae.read_shift(4,"i"),Te=Ae.read_shift(4,"i"),ie=Ae.read_shift(4,"i");for(var Be=-1,Me=0;Me<109&&(Be=Ae.read_shift(4,"i"),!(Be<0));++Me)Ce[Me]=Be;var gt=E(W,Q);A(Te,ie,gt,Q,Ce);var $t=O(gt,Se,Ce,Q);$t[Se].name="!Directory",ae>0&&Ie!==ce&&($t[Ie].name="!MiniFAT"),$t[Ce[0]].name="!FAT",$t.fat_addrs=Ce,$t.ssz=Q;var Vt={},dr=[],pa=[],En=[];N(Se,$t,gt,dr,ae,Vt,pa,Ie),b(pa,En,dr),dr.shift();var jn={FileIndex:pa,FullPaths:En};return re&&re.raw&&(jn.raw={header:Ve,sectors:gt}),jn}function y(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(ke,"Header Signature: "),W.l+=16;var re=W.read_shift(2,"u");return[W.read_shift(2,"u"),re]}function k(W,re){var q=9;switch(W.l+=2,q=W.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function E(W,re){for(var q=Math.ceil(W.length/re)-1,Q=[],ae=1;ae<q;++ae)Q[ae-1]=W.slice(ae*re,(ae+1)*re);return Q[q-1]=W.slice(q*re),Q}function b(W,re,q){for(var Q=0,ae=0,ie=0,Se=0,Ie=0,Te=q.length,Ce=[],Ae=[];Q<Te;++Q)Ce[Q]=Ae[Q]=Q,re[Q]=q[Q];for(;Ie<Ae.length;++Ie)Q=Ae[Ie],ae=W[Q].L,ie=W[Q].R,Se=W[Q].C,Ce[Q]===Q&&(ae!==-1&&Ce[ae]!==ae&&(Ce[Q]=Ce[ae]),ie!==-1&&Ce[ie]!==ie&&(Ce[Q]=Ce[ie])),Se!==-1&&(Ce[Se]=Q),ae!==-1&&Q!=Ce[Q]&&(Ce[ae]=Ce[Q],Ae.lastIndexOf(ae)<Ie&&Ae.push(ae)),ie!==-1&&Q!=Ce[Q]&&(Ce[ie]=Ce[Q],Ae.lastIndexOf(ie)<Ie&&Ae.push(ie));for(Q=1;Q<Te;++Q)Ce[Q]===Q&&(ie!==-1&&Ce[ie]!==ie?Ce[Q]=Ce[ie]:ae!==-1&&Ce[ae]!==ae&&(Ce[Q]=Ce[ae]));for(Q=1;Q<Te;++Q)if(W[Q].type!==0){if(Ie=Q,Ie!=Ce[Ie])do Ie=Ce[Ie],re[Q]=re[Ie]+"/"+re[Q];while(Ie!==0&&Ce[Ie]!==-1&&Ie!=Ce[Ie]);Ce[Q]=-1}for(re[0]+="/",Q=1;Q<Te;++Q)W[Q].type!==2&&(re[Q]+="/")}function S(W,re,q){for(var Q=W.start,ae=W.size,ie=[],Se=Q;q&&ae>0&&Se>=0;)ie.push(re.slice(Se*J,Se*J+J)),ae-=J,Se=ro(q,Se*4);return ie.length===0?Lr(0):ys(ie).slice(0,W.size)}function A(W,re,q,Q,ae){var ie=ce;if(W===ce){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var Se=q[W],Ie=(Q>>>2)-1;if(!Se)return;for(var Te=0;Te<Ie&&(ie=ro(Se,Te*4))!==ce;++Te)ae.push(ie);A(ro(Se,Q-4),re-1,q,Q,ae)}}function R(W,re,q,Q,ae){var ie=[],Se=[];ae||(ae=[]);var Ie=Q-1,Te=0,Ce=0;for(Te=re;Te>=0;){ae[Te]=!0,ie[ie.length]=Te,Se.push(W[Te]);var Ae=q[Math.floor(Te*4/Q)];if(Ce=Te*4&Ie,Q<4+Ce)throw new Error("FAT boundary crossed: "+Te+" 4 "+Q);if(!W[Ae])break;Te=ro(W[Ae],Ce)}return{nodes:ie,data:Dg([Se])}}function O(W,re,q,Q){var ae=W.length,ie=[],Se=[],Ie=[],Te=[],Ce=Q-1,Ae=0,Re=0,Ve=0,Ze=0;for(Ae=0;Ae<ae;++Ae)if(Ie=[],Ve=Ae+re,Ve>=ae&&(Ve-=ae),!Se[Ve]){Te=[];var Be=[];for(Re=Ve;Re>=0;){Be[Re]=!0,Se[Re]=!0,Ie[Ie.length]=Re,Te.push(W[Re]);var Me=q[Math.floor(Re*4/Q)];if(Ze=Re*4&Ce,Q<4+Ze)throw new Error("FAT boundary crossed: "+Re+" 4 "+Q);if(!W[Me]||(Re=ro(W[Me],Ze),Be[Re]))break}ie[Ve]={nodes:Ie,data:Dg([Te])}}return ie}function N(W,re,q,Q,ae,ie,Se,Ie){for(var Te=0,Ce=Q.length?2:0,Ae=re[W].data,Re=0,Ve=0,Ze;Re<Ae.length;Re+=128){var Be=Ae.slice(Re,Re+128);Kr(Be,64),Ve=Be.read_shift(2),Ze=Z0(Be,0,Ve-Ce),Q.push(Ze);var Me={name:Ze,type:Be.read_shift(1),color:Be.read_shift(1),L:Be.read_shift(4,"i"),R:Be.read_shift(4,"i"),C:Be.read_shift(4,"i"),clsid:Be.read_shift(16),state:Be.read_shift(4,"i"),start:0,size:0},gt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);gt!==0&&(Me.ct=U(Be,Be.l-8));var $t=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);$t!==0&&(Me.mt=U(Be,Be.l-8)),Me.start=Be.read_shift(4,"i"),Me.size=Be.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=ce,Me.name=""),Me.type===5?(Te=Me.start,ae>0&&Te!==ce&&(re[Te].name="!StreamData")):Me.size>=4096?(Me.storage="fat",re[Me.start]===void 0&&(re[Me.start]=R(q,Me.start,re.fat_addrs,re.ssz)),re[Me.start].name=Me.name,Me.content=re[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:Te!==ce&&Me.start!==ce&&re[Te]&&(Me.content=S(Me,re[Te].data,(re[Ie]||{}).data))),Me.content&&Kr(Me.content,0),ie[Ze]=Me,Se.push(Me)}}function U(W,re){return new Date((Kn(W,re+4)/1e7*Math.pow(2,32)+Kn(W,re)/1e7-11644473600)*1e3)}function K(W,re){return v(),x(m.readFileSync(W),re)}function B(W,re){var q=re&&re.type;switch(q||Nt&&Buffer.isBuffer(W)&&(q="buffer"),q||"base64"){case"file":return K(W,re);case"base64":return x(Oa(Yn(W)),re);case"binary":return x(Oa(W),re)}return x(W,re)}function D(W,re){var q=re||{},Q=q.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=Q+"/",W.FileIndex[0]={name:Q,type:5}),q.CLSID&&(W.FileIndex[0].clsid=q.CLSID),te(W)}function te(W){var re="Sh33tJ5";if(!Ft.find(W,"/"+re)){var q=Lr(4);q[0]=55,q[1]=q[3]=50,q[2]=54,W.FileIndex.push({name:re,type:2,content:q,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+re),ee(W)}}function ee(W,re){D(W);for(var q=!1,Q=!1,ae=W.FullPaths.length-1;ae>=0;--ae){var ie=W.FileIndex[ae];switch(ie.type){case 0:Q?q=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:Q=!0,isNaN(ie.R*ie.L*ie.C)&&(q=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!re)){var Se=new Date(1987,1,19),Ie=0,Te=Object.create?Object.create(null):{},Ce=[];for(ae=0;ae<W.FullPaths.length;++ae)Te[W.FullPaths[ae]]=!0,W.FileIndex[ae].type!==0&&Ce.push([W.FullPaths[ae],W.FileIndex[ae]]);for(ae=0;ae<Ce.length;++ae){var Ae=n(Ce[ae][0]);Q=Te[Ae],Q||(Ce.push([Ae,{name:a(Ae).replace("/",""),type:1,clsid:ue,ct:Se,mt:Se,content:null}]),Te[Ae]=!0)}for(Ce.sort(function(Ze,Be){return t(Ze[0],Be[0])}),W.FullPaths=[],W.FileIndex=[],ae=0;ae<Ce.length;++ae)W.FullPaths[ae]=Ce[ae][0],W.FileIndex[ae]=Ce[ae][1];for(ae=0;ae<Ce.length;++ae){var Re=W.FileIndex[ae],Ve=W.FullPaths[ae];if(Re.name=a(Ve).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||ue,ae===0)Re.C=Ce.length>1?1:-1,Re.size=0,Re.type=5;else if(Ve.slice(-1)=="/"){for(Ie=ae+1;Ie<Ce.length&&n(W.FullPaths[Ie])!=Ve;++Ie);for(Re.C=Ie>=Ce.length?-1:Ie,Ie=ae+1;Ie<Ce.length&&n(W.FullPaths[Ie])!=n(Ve);++Ie);Re.R=Ie>=Ce.length?-1:Ie,Re.type=1}else n(W.FullPaths[ae+1]||"")==n(Ve)&&(Re.R=ae+1),Re.type=2}}}function ve(W,re){var q=re||{};if(q.fileType=="mad")return Ot(W,q);switch(ee(W),q.fileType){case"zip":return De(W,q)}var Q=(function(Ze){for(var Be=0,Me=0,gt=0;gt<Ze.FileIndex.length;++gt){var $t=Ze.FileIndex[gt];if($t.content){var Vt=$t.content.length;Vt>0&&(Vt<4096?Be+=Vt+63>>6:Me+=Vt+511>>9)}}for(var dr=Ze.FullPaths.length+3>>2,pa=Be+7>>3,En=Be+127>>7,jn=pa+Me+dr+En,_r=jn+127>>7,ga=_r<=109?0:Math.ceil((_r-109)/127);jn+_r+ga+127>>7>_r;)ga=++_r<=109?0:Math.ceil((_r-109)/127);var ot=[1,ga,_r,En,dr,Me,Be,0];return Ze.FileIndex[0].size=Be<<6,ot[7]=(Ze.FileIndex[0].start=ot[0]+ot[1]+ot[2]+ot[3]+ot[4]+ot[5])+(ot[6]+7>>3),ot})(W),ae=Lr(Q[7]<<9),ie=0,Se=0;{for(ie=0;ie<8;++ie)ae.write_shift(1,se[ie]);for(ie=0;ie<8;++ie)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),ie=0;ie<3;++ie)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,Q[2]),ae.write_shift(4,Q[0]+Q[1]+Q[2]+Q[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,Q[3]?Q[0]+Q[1]+Q[2]-1:ce),ae.write_shift(4,Q[3]),ae.write_shift(-4,Q[1]?Q[0]-1:ce),ae.write_shift(4,Q[1]),ie=0;ie<109;++ie)ae.write_shift(-4,ie<Q[2]?Q[1]+ie:-1)}if(Q[1])for(Se=0;Se<Q[1];++Se){for(;ie<236+Se*127;++ie)ae.write_shift(-4,ie<Q[2]?Q[1]+ie:-1);ae.write_shift(-4,Se===Q[1]-1?ce:Se+1)}var Ie=function(Ze){for(Se+=Ze;ie<Se-1;++ie)ae.write_shift(-4,ie+1);Ze&&(++ie,ae.write_shift(-4,ce))};for(Se=ie=0,Se+=Q[1];ie<Se;++ie)ae.write_shift(-4,j.DIFSECT);for(Se+=Q[2];ie<Se;++ie)ae.write_shift(-4,j.FATSECT);Ie(Q[3]),Ie(Q[4]);for(var Te=0,Ce=0,Ae=W.FileIndex[0];Te<W.FileIndex.length;++Te)Ae=W.FileIndex[Te],Ae.content&&(Ce=Ae.content.length,!(Ce<4096)&&(Ae.start=Se,Ie(Ce+511>>9)));for(Ie(Q[6]+7>>3);ae.l&511;)ae.write_shift(-4,j.ENDOFCHAIN);for(Se=ie=0,Te=0;Te<W.FileIndex.length;++Te)Ae=W.FileIndex[Te],Ae.content&&(Ce=Ae.content.length,!(!Ce||Ce>=4096)&&(Ae.start=Se,Ie(Ce+63>>6)));for(;ae.l&511;)ae.write_shift(-4,j.ENDOFCHAIN);for(ie=0;ie<Q[4]<<2;++ie){var Re=W.FullPaths[ie];if(!Re||Re.length===0){for(Te=0;Te<17;++Te)ae.write_shift(4,0);for(Te=0;Te<3;++Te)ae.write_shift(4,-1);for(Te=0;Te<12;++Te)ae.write_shift(4,0);continue}Ae=W.FileIndex[ie],ie===0&&(Ae.start=Ae.size?Ae.start-1:ce);var Ve=ie===0&&q.root||Ae.name;if(Ce=2*(Ve.length+1),ae.write_shift(64,Ve,"utf16le"),ae.write_shift(2,Ce),ae.write_shift(1,Ae.type),ae.write_shift(1,Ae.color),ae.write_shift(-4,Ae.L),ae.write_shift(-4,Ae.R),ae.write_shift(-4,Ae.C),Ae.clsid)ae.write_shift(16,Ae.clsid,"hex");else for(Te=0;Te<4;++Te)ae.write_shift(4,0);ae.write_shift(4,Ae.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,Ae.start),ae.write_shift(4,Ae.size),ae.write_shift(4,0)}for(ie=1;ie<W.FileIndex.length;++ie)if(Ae=W.FileIndex[ie],Ae.size>=4096)if(ae.l=Ae.start+1<<9,Nt&&Buffer.isBuffer(Ae.content))Ae.content.copy(ae,ae.l,0,Ae.size),ae.l+=Ae.size+511&-512;else{for(Te=0;Te<Ae.size;++Te)ae.write_shift(1,Ae.content[Te]);for(;Te&511;++Te)ae.write_shift(1,0)}for(ie=1;ie<W.FileIndex.length;++ie)if(Ae=W.FileIndex[ie],Ae.size>0&&Ae.size<4096)if(Nt&&Buffer.isBuffer(Ae.content))Ae.content.copy(ae,ae.l,0,Ae.size),ae.l+=Ae.size+63&-64;else{for(Te=0;Te<Ae.size;++Te)ae.write_shift(1,Ae.content[Te]);for(;Te&63;++Te)ae.write_shift(1,0)}if(Nt)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function me(W,re){var q=W.FullPaths.map(function(Te){return Te.toUpperCase()}),Q=q.map(function(Te){var Ce=Te.split("/");return Ce[Ce.length-(Te.slice(-1)=="/"?2:1)]}),ae=!1;re.charCodeAt(0)===47?(ae=!0,re=q[0].slice(0,-1)+re):ae=re.indexOf("/")!==-1;var ie=re.toUpperCase(),Se=ae===!0?q.indexOf(ie):Q.indexOf(ie);if(Se!==-1)return W.FileIndex[Se];var Ie=!ie.match(kc);for(ie=ie.replace(kn,""),Ie&&(ie=ie.replace(kc,"!")),Se=0;Se<q.length;++Se)if((Ie?q[Se].replace(kc,"!"):q[Se]).replace(kn,"")==ie||(Ie?Q[Se].replace(kc,"!"):Q[Se]).replace(kn,"")==ie)return W.FileIndex[Se];return null}var J=64,ce=-2,ke="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",j={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ce,FREESECT:-1,HEADER_SIGNATURE:ke,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function G(W,re,q){v();var Q=ve(W,q);m.writeFileSync(re,Q)}function Z(W){for(var re=new Array(W.length),q=0;q<W.length;++q)re[q]=String.fromCharCode(W[q]);return re.join("")}function oe(W,re){var q=ve(W,re);switch(re&&re.type||"buffer"){case"file":return v(),m.writeFileSync(re.filename,q),q;case"binary":return typeof q=="string"?q:Z(q);case"base64":return mg(typeof q=="string"?q:Z(q));case"buffer":if(Nt)return Buffer.isBuffer(q)?q:ho(q);case"array":return typeof q=="string"?Oa(q):q}return q}var I;function P(W){try{var re=W.InflateRaw,q=new re;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)I=W;else throw new Error("zlib does not expose bytesRead")}catch(Q){console.error("cannot use native zlib: "+(Q.message||Q))}}function F(W,re){if(!I)return ja(W,re);var q=I.InflateRaw,Q=new q,ae=Q._processChunk(W.slice(W.l),Q._finishFlushFlag);return W.l+=Q.bytesRead,ae}function M(W){return I?I.deflateRawSync(W):ft(W)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(W){var re=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(re>>16|re>>8|re)&255}for(var ye=typeof Uint8Array<"u",xe=ye?new Uint8Array(256):[],ze=0;ze<256;++ze)xe[ze]=ge(ze);function ne(W,re){var q=xe[W&255];return re<=8?q>>>8-re:(q=q<<8|xe[W>>8&255],re<=16?q>>>16-re:(q=q<<8|xe[W>>16&255],q>>>24-re))}function xt(W,re){var q=re&7,Q=re>>>3;return(W[Q]|(q<=6?0:W[Q+1]<<8))>>>q&3}function st(W,re){var q=re&7,Q=re>>>3;return(W[Q]|(q<=5?0:W[Q+1]<<8))>>>q&7}function wt(W,re){var q=re&7,Q=re>>>3;return(W[Q]|(q<=4?0:W[Q+1]<<8))>>>q&15}function _t(W,re){var q=re&7,Q=re>>>3;return(W[Q]|(q<=3?0:W[Q+1]<<8))>>>q&31}function $e(W,re){var q=re&7,Q=re>>>3;return(W[Q]|(q<=1?0:W[Q+1]<<8))>>>q&127}function It(W,re,q){var Q=re&7,ae=re>>>3,ie=(1<<q)-1,Se=W[ae]>>>Q;return q<8-Q||(Se|=W[ae+1]<<8-Q,q<16-Q)||(Se|=W[ae+2]<<16-Q,q<24-Q)||(Se|=W[ae+3]<<24-Q),Se&ie}function ur(W,re,q){var Q=re&7,ae=re>>>3;return Q<=5?W[ae]|=(q&7)<<Q:(W[ae]|=q<<Q&255,W[ae+1]=(q&7)>>8-Q),re+3}function rr(W,re,q){var Q=re&7,ae=re>>>3;return q=(q&1)<<Q,W[ae]|=q,re+1}function Zt(W,re,q){var Q=re&7,ae=re>>>3;return q<<=Q,W[ae]|=q&255,q>>>=8,W[ae+1]=q,re+8}function Kt(W,re,q){var Q=re&7,ae=re>>>3;return q<<=Q,W[ae]|=q&255,q>>>=8,W[ae+1]=q&255,W[ae+2]=q>>>8,re+16}function yr(W,re){var q=W.length,Q=2*q>re?2*q:re+5,ae=0;if(q>=re)return W;if(Nt){var ie=pg(Q);if(W.copy)W.copy(ie);else for(;ae<W.length;++ae)ie[ae]=W[ae];return ie}else if(ye){var Se=new Uint8Array(Q);if(Se.set)Se.set(W);else for(;ae<q;++ae)Se[ae]=W[ae];return Se}return W.length=Q,W}function or(W){for(var re=new Array(W),q=0;q<W;++q)re[q]=0;return re}function nt(W,re,q){var Q=1,ae=0,ie=0,Se=0,Ie=0,Te=W.length,Ce=ye?new Uint16Array(32):or(32);for(ie=0;ie<32;++ie)Ce[ie]=0;for(ie=Te;ie<q;++ie)W[ie]=0;Te=W.length;var Ae=ye?new Uint16Array(Te):or(Te);for(ie=0;ie<Te;++ie)Ce[ae=W[ie]]++,Q<ae&&(Q=ae),Ae[ie]=0;for(Ce[0]=0,ie=1;ie<=Q;++ie)Ce[ie+16]=Ie=Ie+Ce[ie-1]<<1;for(ie=0;ie<Te;++ie)Ie=W[ie],Ie!=0&&(Ae[ie]=Ce[Ie+16]++);var Re=0;for(ie=0;ie<Te;++ie)if(Re=W[ie],Re!=0)for(Ie=ne(Ae[ie],Q)>>Q-Re,Se=(1<<Q+4-Re)-1;Se>=0;--Se)re[Ie|Se<<Re]=Re&15|ie<<4;return Q}var Mr=ye?new Uint16Array(512):or(512),Sn=ye?new Uint16Array(32):or(32);if(!ye){for(var nr=0;nr<512;++nr)Mr[nr]=0;for(nr=0;nr<32;++nr)Sn[nr]=0}(function(){for(var W=[],re=0;re<32;re++)W.push(5);nt(W,Sn,32);var q=[];for(re=0;re<=143;re++)q.push(8);for(;re<=255;re++)q.push(9);for(;re<=279;re++)q.push(7);for(;re<=287;re++)q.push(8);nt(q,Mr,288)})();var Bt=(function(){for(var re=ye?new Uint8Array(32768):[],q=0,Q=0;q<fe.length-1;++q)for(;Q<fe[q+1];++Q)re[Q]=q;for(;Q<32768;++Q)re[Q]=29;var ae=ye?new Uint8Array(259):[];for(q=0,Q=0;q<X.length-1;++q)for(;Q<X[q+1];++Q)ae[Q]=q;function ie(Ie,Te){for(var Ce=0;Ce<Ie.length;){var Ae=Math.min(65535,Ie.length-Ce),Re=Ce+Ae==Ie.length;for(Te.write_shift(1,+Re),Te.write_shift(2,Ae),Te.write_shift(2,~Ae&65535);Ae-- >0;)Te[Te.l++]=Ie[Ce++]}return Te.l}function Se(Ie,Te){for(var Ce=0,Ae=0,Re=ye?new Uint16Array(32768):[];Ae<Ie.length;){var Ve=Math.min(65535,Ie.length-Ae);if(Ve<10){for(Ce=ur(Te,Ce,+(Ae+Ve==Ie.length)),Ce&7&&(Ce+=8-(Ce&7)),Te.l=Ce/8|0,Te.write_shift(2,Ve),Te.write_shift(2,~Ve&65535);Ve-- >0;)Te[Te.l++]=Ie[Ae++];Ce=Te.l*8;continue}Ce=ur(Te,Ce,+(Ae+Ve==Ie.length)+2);for(var Ze=0;Ve-- >0;){var Be=Ie[Ae];Ze=(Ze<<5^Be)&32767;var Me=-1,gt=0;if((Me=Re[Ze])&&(Me|=Ae&-32768,Me>Ae&&(Me-=32768),Me<Ae))for(;Ie[Me+gt]==Ie[Ae+gt]&&gt<250;)++gt;if(gt>2){Be=ae[gt],Be<=22?Ce=Zt(Te,Ce,xe[Be+1]>>1)-1:(Zt(Te,Ce,3),Ce+=5,Zt(Te,Ce,xe[Be-23]>>5),Ce+=3);var $t=Be<8?0:Be-4>>2;$t>0&&(Kt(Te,Ce,gt-X[Be]),Ce+=$t),Be=re[Ae-Me],Ce=Zt(Te,Ce,xe[Be]>>3),Ce-=3;var Vt=Be<4?0:Be-2>>1;Vt>0&&(Kt(Te,Ce,Ae-Me-fe[Be]),Ce+=Vt);for(var dr=0;dr<gt;++dr)Re[Ze]=Ae&32767,Ze=(Ze<<5^Ie[Ae])&32767,++Ae;Ve-=gt-1}else Be<=143?Be=Be+48:Ce=rr(Te,Ce,1),Ce=Zt(Te,Ce,xe[Be]),Re[Ze]=Ae&32767,++Ae}Ce=Zt(Te,Ce,0)-1}return Te.l=(Ce+7)/8|0,Te.l}return function(Te,Ce){return Te.length<8?ie(Te,Ce):Se(Te,Ce)}})();function ft(W){var re=Lr(50+Math.floor(W.length*1.1)),q=Bt(W,re);return re.slice(0,q)}var Dt=ye?new Uint16Array(32768):or(32768),Br=ye?new Uint16Array(32768):or(32768),qt=ye?new Uint16Array(128):or(128),Xr=1,ii=1;function si(W,re){var q=_t(W,re)+257;re+=5;var Q=_t(W,re)+1;re+=5;var ae=wt(W,re)+4;re+=4;for(var ie=0,Se=ye?new Uint8Array(19):or(19),Ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Te=1,Ce=ye?new Uint8Array(8):or(8),Ae=ye?new Uint8Array(8):or(8),Re=Se.length,Ve=0;Ve<ae;++Ve)Se[H[Ve]]=ie=st(W,re),Te<ie&&(Te=ie),Ce[ie]++,re+=3;var Ze=0;for(Ce[0]=0,Ve=1;Ve<=Te;++Ve)Ae[Ve]=Ze=Ze+Ce[Ve-1]<<1;for(Ve=0;Ve<Re;++Ve)(Ze=Se[Ve])!=0&&(Ie[Ve]=Ae[Ze]++);var Be=0;for(Ve=0;Ve<Re;++Ve)if(Be=Se[Ve],Be!=0){Ze=xe[Ie[Ve]]>>8-Be;for(var Me=(1<<7-Be)-1;Me>=0;--Me)qt[Ze|Me<<Be]=Be&7|Ve<<3}var gt=[];for(Te=1;gt.length<q+Q;)switch(Ze=qt[$e(W,re)],re+=Ze&7,Ze>>>=3){case 16:for(ie=3+xt(W,re),re+=2,Ze=gt[gt.length-1];ie-- >0;)gt.push(Ze);break;case 17:for(ie=3+st(W,re),re+=3;ie-- >0;)gt.push(0);break;case 18:for(ie=11+$e(W,re),re+=7;ie-- >0;)gt.push(0);break;default:gt.push(Ze),Te<Ze&&(Te=Ze);break}var $t=gt.slice(0,q),Vt=gt.slice(q);for(Ve=q;Ve<286;++Ve)$t[Ve]=0;for(Ve=Q;Ve<30;++Ve)Vt[Ve]=0;return Xr=nt($t,Dt,286),ii=nt(Vt,Br,30),re}function Rn(W,re){if(W[0]==3&&!(W[1]&3))return[Ss(re),2];for(var q=0,Q=0,ae=pg(re||1<<18),ie=0,Se=ae.length>>>0,Ie=0,Te=0;(Q&1)==0;){if(Q=st(W,q),q+=3,Q>>>1)Q>>1==1?(Ie=9,Te=5):(q=si(W,q),Ie=Xr,Te=ii);else{q&7&&(q+=8-(q&7));var Ce=W[q>>>3]|W[(q>>>3)+1]<<8;if(q+=32,Ce>0)for(!re&&Se<ie+Ce&&(ae=yr(ae,ie+Ce),Se=ae.length);Ce-- >0;)ae[ie++]=W[q>>>3],q+=8;continue}for(;;){!re&&Se<ie+32767&&(ae=yr(ae,ie+32767),Se=ae.length);var Ae=It(W,q,Ie),Re=Q>>>1==1?Mr[Ae]:Dt[Ae];if(q+=Re&15,Re>>>=4,(Re>>>8&255)===0)ae[ie++]=Re;else{if(Re==256)break;Re-=257;var Ve=Re<8?0:Re-4>>2;Ve>5&&(Ve=0);var Ze=ie+X[Re];Ve>0&&(Ze+=It(W,q,Ve),q+=Ve),Ae=It(W,q,Te),Re=Q>>>1==1?Sn[Ae]:Br[Ae],q+=Re&15,Re>>>=4;var Be=Re<4?0:Re-2>>1,Me=fe[Re];for(Be>0&&(Me+=It(W,q,Be),q+=Be),!re&&Se<Ze&&(ae=yr(ae,Ze+100),Se=ae.length);ie<Ze;)ae[ie]=ae[ie-Me],++ie}}}return re?[ae,q+7>>>3]:[ae.slice(0,ie),q+7>>>3]}function ja(W,re){var q=W.slice(W.l||0),Q=Rn(q,re);return W.l+=Q[1],Q[0]}function Ma(W,re){if(W)typeof console<"u"&&console.error(re);else throw new Error(re)}function Ba(W,re){var q=W;Kr(q,0);var Q=[],ae=[],ie={FileIndex:Q,FullPaths:ae};D(ie,{root:re.root});for(var Se=q.length-4;(q[Se]!=80||q[Se+1]!=75||q[Se+2]!=5||q[Se+3]!=6)&&Se>=0;)--Se;q.l=Se+4,q.l+=4;var Ie=q.read_shift(2);q.l+=6;var Te=q.read_shift(4);for(q.l=Te,Se=0;Se<Ie;++Se){q.l+=20;var Ce=q.read_shift(4),Ae=q.read_shift(4),Re=q.read_shift(2),Ve=q.read_shift(2),Ze=q.read_shift(2);q.l+=8;var Be=q.read_shift(4),Me=d(q.slice(q.l+Re,q.l+Re+Ve));q.l+=Re+Ve+Ze;var gt=q.l;q.l=Be+4,Tn(q,Ce,Ae,ie,Me),q.l=gt}return ie}function Tn(W,re,q,Q,ae){W.l+=2;var ie=W.read_shift(2),Se=W.read_shift(2),Ie=c(W);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var Te=W.read_shift(4),Ce=W.read_shift(4),Ae=W.read_shift(4),Re=W.read_shift(2),Ve=W.read_shift(2),Ze="",Be=0;Be<Re;++Be)Ze+=String.fromCharCode(W[W.l++]);if(Ve){var Me=d(W.slice(W.l,W.l+Ve));(Me[21589]||{}).mt&&(Ie=Me[21589].mt),((ae||{})[21589]||{}).mt&&(Ie=ae[21589].mt)}W.l+=Ve;var gt=W.slice(W.l,W.l+Ce);switch(Se){case 8:gt=F(W,Ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var $t=!1;ie&8&&(Te=W.read_shift(4),Te==134695760&&(Te=W.read_shift(4),$t=!0),Ce=W.read_shift(4),Ae=W.read_shift(4)),Ce!=re&&Ma($t,"Bad compressed size: "+re+" != "+Ce),Ae!=q&&Ma($t,"Bad uncompressed size: "+q+" != "+Ae),Ut(Q,Ze,gt,{unsafe:!0,mt:Ie})}function De(W,re){var q=re||{},Q=[],ae=[],ie=Lr(1),Se=q.compression?8:0,Ie=0,Te=0,Ce=0,Ae=0,Re=0,Ve=W.FullPaths[0],Ze=Ve,Be=W.FileIndex[0],Me=[],gt=0;for(Te=1;Te<W.FullPaths.length;++Te)if(Ze=W.FullPaths[Te].slice(Ve.length),Be=W.FileIndex[Te],!(!Be.size||!Be.content||Ze=="Sh33tJ5")){var $t=Ae,Vt=Lr(Ze.length);for(Ce=0;Ce<Ze.length;++Ce)Vt.write_shift(1,Ze.charCodeAt(Ce)&127);Vt=Vt.slice(0,Vt.l),Me[Re]=cw.buf(Be.content,0);var dr=Be.content;Se==8&&(dr=M(dr)),ie=Lr(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,Ie),ie.write_shift(2,Se),Be.mt?l(ie,Be.mt):ie.write_shift(4,0),ie.write_shift(-4,Me[Re]),ie.write_shift(4,dr.length),ie.write_shift(4,Be.content.length),ie.write_shift(2,Vt.length),ie.write_shift(2,0),Ae+=ie.length,Q.push(ie),Ae+=Vt.length,Q.push(Vt),Ae+=dr.length,Q.push(dr),ie=Lr(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,Ie),ie.write_shift(2,Se),ie.write_shift(4,0),ie.write_shift(-4,Me[Re]),ie.write_shift(4,dr.length),ie.write_shift(4,Be.content.length),ie.write_shift(2,Vt.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,$t),gt+=ie.l,ae.push(ie),gt+=Vt.length,ae.push(Vt),++Re}return ie=Lr(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,Re),ie.write_shift(2,Re),ie.write_shift(4,gt),ie.write_shift(4,Ae),ie.write_shift(2,0),ys([ys(Q),ys(ae),ie])}var Ke={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ye(W,re){if(W.ctype)return W.ctype;var q=W.name||"",Q=q.match(/\.([^\.]+)$/);return Q&&Ke[Q[1]]||re&&(Q=(q=re).match(/[\.\\]([^\.\\])+$/),Q&&Ke[Q[1]])?Ke[Q[1]]:"application/octet-stream"}function He(W){for(var re=mg(W),q=[],Q=0;Q<re.length;Q+=76)q.push(re.slice(Q,Q+76));return q.join(`\r
`)+`\r
`}function Qe(W){var re=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ce){var Ae=Ce.charCodeAt(0).toString(16).toUpperCase();return"="+(Ae.length==1?"0"+Ae:Ae)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],Q=re.split(`\r
`),ae=0;ae<Q.length;++ae){var ie=Q[ae];if(ie.length==0){q.push("");continue}for(var Se=0;Se<ie.length;){var Ie=76,Te=ie.slice(Se,Se+Ie);Te.charAt(Ie-1)=="="?Ie--:Te.charAt(Ie-2)=="="?Ie-=2:Te.charAt(Ie-3)=="="&&(Ie-=3),Te=ie.slice(Se,Se+Ie),Se+=Ie,Se<ie.length&&(Te+="="),q.push(Te)}}return q.join(`\r
`)}function at(W){for(var re=[],q=0;q<W.length;++q){for(var Q=W[q];q<=W.length&&Q.charAt(Q.length-1)=="=";)Q=Q.slice(0,Q.length-1)+W[++q];re.push(Q)}for(var ae=0;ae<re.length;++ae)re[ae]=re[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return Oa(re.join(`\r
`))}function pt(W,re,q){for(var Q="",ae="",ie="",Se,Ie=0;Ie<10;++Ie){var Te=re[Ie];if(!Te||Te.match(/^\s*$/))break;var Ce=Te.match(/^(.*?):\s*([^\s].*)$/);if(Ce)switch(Ce[1].toLowerCase()){case"content-location":Q=Ce[2].trim();break;case"content-type":ie=Ce[2].trim();break;case"content-transfer-encoding":ae=Ce[2].trim();break}}switch(++Ie,ae.toLowerCase()){case"base64":Se=Oa(Yn(re.slice(Ie).join("")));break;case"quoted-printable":Se=at(re.slice(Ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var Ae=Ut(W,Q.slice(q.length),Se,{unsafe:!0});ie&&(Ae.ctype=ie)}function Xe(W,re){if(Z(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=re&&re.root||"",Q=(Nt&&Buffer.isBuffer(W)?W.toString("binary"):Z(W)).split(`\r
`),ae=0,ie="";for(ae=0;ae<Q.length;++ae)if(ie=Q[ae],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),q||(q=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),ie.slice(0,q.length)!=q););var Se=(Q[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Ie="--"+(Se[1]||""),Te=[],Ce=[],Ae={FileIndex:Te,FullPaths:Ce};D(Ae);var Re,Ve=0;for(ae=0;ae<Q.length;++ae){var Ze=Q[ae];Ze!==Ie&&Ze!==Ie+"--"||(Ve++&&pt(Ae,Q.slice(Re,ae),q),Re=ae)}return Ae}function Ot(W,re){var q=re||{},Q=q.boundary||"SheetJS";Q="------="+Q;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Q.slice(2)+'"',"","",""],ie=W.FullPaths[0],Se=ie,Ie=W.FileIndex[0],Te=1;Te<W.FullPaths.length;++Te)if(Se=W.FullPaths[Te].slice(ie.length),Ie=W.FileIndex[Te],!(!Ie.size||!Ie.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(gt){return"_x"+gt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(gt){return"_u"+gt.charCodeAt(0).toString(16)+"_"});for(var Ce=Ie.content,Ae=Nt&&Buffer.isBuffer(Ce)?Ce.toString("binary"):Z(Ce),Re=0,Ve=Math.min(1024,Ae.length),Ze=0,Be=0;Be<=Ve;++Be)(Ze=Ae.charCodeAt(Be))>=32&&Ze<128&&++Re;var Me=Re>=Ve*4/5;ae.push(Q),ae.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+Se),ae.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),ae.push("Content-Type: "+Ye(Ie,Se)),ae.push(""),ae.push(Me?Qe(Ae):He(Ae))}return ae.push(Q+`--\r
`),ae.join(`\r
`)}function ar(W){var re={};return D(re,W),re}function Ut(W,re,q,Q){var ae=Q&&Q.unsafe;ae||D(W);var ie=!ae&&Ft.find(W,re);if(!ie){var Se=W.FullPaths[0];re.slice(0,Se.length)==Se?Se=re:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+re).replace("//","/")),ie={name:a(re),type:2},W.FileIndex.push(ie),W.FullPaths.push(Se),ae||Ft.utils.cfb_gc(W)}return ie.content=q,ie.size=q?q.length:0,Q&&(Q.CLSID&&(ie.clsid=Q.CLSID),Q.mt&&(ie.mt=Q.mt),Q.ct&&(ie.ct=Q.ct)),ie}function Yt(W,re){D(W);var q=Ft.find(W,re);if(q){for(var Q=0;Q<W.FileIndex.length;++Q)if(W.FileIndex[Q]==q)return W.FileIndex.splice(Q,1),W.FullPaths.splice(Q,1),!0}return!1}function ct(W,re,q){D(W);var Q=Ft.find(W,re);if(Q){for(var ae=0;ae<W.FileIndex.length;++ae)if(W.FileIndex[ae]==Q)return W.FileIndex[ae].name=a(q),W.FullPaths[ae]=q,!0}return!1}function Je(W){ee(W,!0)}return r.find=me,r.read=B,r.parse=x,r.write=oe,r.writeFile=G,r.utils={cfb_new:ar,cfb_add:Ut,cfb_del:Yt,cfb_mov:ct,cfb_gc:Je,ReadShift:Cc,CheckField:Hx,prep_blob:Kr,bconcat:ys,use_zlib:P,_deflateRaw:ft,_inflateRaw:ja,consts:j},r})();function uw(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ei(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function W0(e){for(var r=[],t=ei(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var Wd=new Date(1899,11,30,0,0,0);function bn(e,r){var t=e.getTime(),n=Wd.getTime()+(e.getTimezoneOffset()-Wd.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var Sx=new Date,dw=Wd.getTime()+(Sx.getTimezoneOffset()-Wd.getTimezoneOffset())*6e4,bg=Sx.getTimezoneOffset();function nf(e){var r=new Date;return r.setTime(e*24*60*60*1e3+dw),r.getTimezoneOffset()!==bg&&r.setTime(r.getTime()+(r.getTimezoneOffset()-bg)*6e4),r}function fw(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=a.length;++l)if(a[l]){switch(t=1,l>3&&(n=!0),a[l].slice(a[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[l].slice(a[l].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[l],10)}return r}var Sg=new Date("2017-02-19T19:06:09.000Z"),Tx=isNaN(Sg.getFullYear())?new Date("2/19/17"):Sg,hw=Tx.getFullYear()==2017;function Hr(e,r){var t=new Date(e);if(hw)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Tx.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function uo(e,r){if(Nt&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Sc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Sc(dx(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Sc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Sc(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(l){return t[l]||l})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function qr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=qr(e[t]));return r}function vr(e,r){for(var t="";t.length<r;)t+=e;return t}function Ra(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,l){return t=-t,l}),!isNaN(r=Number(n)))?r/t:r}var mw=["january","february","march","april","may","june","july","august","september","october","november","december"];function bl(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),l=r.getDate();if(isNaN(l))return t;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&mw.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||l>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var pw=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var l=t.split(n),c=[l[0]],d=1;d<l.length;++d)c.push(a),c.push(l[d]);return c}})();function Ex(e){return e?e.content&&e.type?uo(e.content,!0):e.data?wc(e.data):e.asNodeBuffer&&Nt?wc(e.asNodeBuffer().toString("binary")):e.asBinary?wc(e.asBinary()):e._data&&e._data.getContent?wc(uo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Cx(e){if(!e)return null;if(e.data)return fg(e.data);if(e.asNodeBuffer&&Nt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?fg(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function gw(e){return e&&e.name.slice(-4)===".bin"?Cx(e):Ex(e)}function da(e,r){for(var t=e.FullPaths||ei(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),l=0;l<t.length;++l){var c=t[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||a==c)return e.files?e.files[t[l]]:e.FileIndex[l]}return null}function V0(e,r){var t=da(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function Er(e,r,t){if(!t)return gw(V0(e,r));if(!r)return null;try{return Er(e,r)}catch{return null}}function qn(e,r,t){if(!t)return Ex(V0(e,r));if(!r)return null;try{return qn(e,r)}catch{return null}}function vw(e,r,t){return Cx(V0(e,r))}function Tg(e){for(var r=e.FullPaths||ei(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function xw(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Nt?n=ho(t):n=j_(t),Ft.utils.cfb_add(e,r,n)}Ft.utils.cfb_add(e,r,t)}else e.file(r,t)}function Ax(e,r){switch(r.type){case"base64":return Ft.read(e,{type:"base64"});case"binary":return Ft.read(e,{type:"binary"});case"buffer":case"array":return Ft.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function bc(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var Px=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yw=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Eg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_w=/<[^>]*>/g,fn=Px.match(Eg)?Eg:_w,ww=/<\w*:/,kw=/<(\/?)\w+:/;function mt(e,r,t){for(var n={},a=0,l=0;a!==e.length&&!((l=e.charCodeAt(a))===32||l===10||l===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var c=e.match(yw),d=0,m="",v=0,x="",y="",k=1;if(c)for(v=0;v!=c.length;++v){for(y=c[v],l=0;l!=y.length&&y.charCodeAt(l)!==61;++l);for(x=y.slice(0,l).trim();y.charCodeAt(l+1)==32;)++l;for(k=(a=y.charCodeAt(l+1))==34||a==39?1:0,m=y.slice(l+1+k,y.length-k),d=0;d!=x.length&&x.charCodeAt(d)!==58;++d);if(d===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),n[x]=m,n[x.toLowerCase()]=m;else{var E=(d===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(d+1);if(n[E]&&x.slice(d-3,d)=="ext")continue;n[E]=m,n[E.toLowerCase()]=m}}return n}function ni(e){return e.replace(kw,"<$1")}var Nx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},bw=W0(Nx),jt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",l=a.indexOf("<![CDATA[");if(l==-1)return a.replace(e,function(d,m){return Nx[d]||String.fromCharCode(parseInt(m,d.indexOf("x")>-1?16:10))||d}).replace(r,function(d,m){return String.fromCharCode(parseInt(m,16))});var c=a.indexOf("]]>");return t(a.slice(0,l))+a.slice(l+9,c)+t(a.slice(c+3))}})(),Sw=/[&<>'"]/g,Tw=/[\u0000-\u001f]/g;function H0(e){var r=e+"";return r.replace(Sw,function(t){return bw[t]}).replace(/\n/g,"<br/>").replace(Tw,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Cg=(function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}})();function cr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bh(e){for(var r="",t=0,n=0,a=0,l=0,c=0,d=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){c=(n&31)<<6,c|=a&63,r+=String.fromCharCode(c);continue}if(l=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|l&63);continue}c=e.charCodeAt(t++),d=((n&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(d>>>10&1023)),r+=String.fromCharCode(56320+(d&1023))}return r}function Ag(e){var r=Ss(2*e.length),t,n,a=1,l=0,c=0,d;for(n=0;n<e.length;n+=a)a=1,(d=e.charCodeAt(n))<128?t=d:d<224?(t=(d&31)*64+(e.charCodeAt(n+1)&63),a=2):d<240?(t=(d&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(d&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(r[l++]=c&255,r[l++]=c>>>8,c=0),r[l++]=t%256,r[l++]=t>>>8;return r.slice(0,l).toString("ucs2")}function Pg(e){return ho(e,"binary").toString("utf8")}var md="foo bar bazâð£",tr=Nt&&(Pg(md)==Bh(md)&&Pg||Ag(md)==Bh(md)&&Ag)||Bh,Sc=Nt?function(e){return ho(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Uc=(function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),Ix=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),Ew=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),Cw=/<\/?(?:vt:)?variant>/g,Aw=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ng(e,r){var t=mt(e),n=e.match(Ew(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(l){var c=l.replace(Cw,"").match(Aw);c&&a.push({v:tr(c[2]),t:c[1]})}),a}var Pw=/(^\s|\s$|\n)/;function Nw(e){return ei(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Iw(e,r,t){return"<"+e+(t!=null?Nw(t):"")+(r!=null?(r.match(Pw)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function G0(e){if(Nt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return tr(mo(z0(e)));throw new Error("Bad input format: expected Buffer or string")}var $c=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Dw={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Ow=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Fw(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,l=5;l>=0;--l)a=a*256+e[r+l];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function Lw(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,l=0,c=n?-r:r;isFinite(c)?c==0?a=l=0:(a=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?a=-1022:(l-=Math.pow(2,52),a+=1023)):(a=2047,l=isNaN(r)?26985:0);for(var d=0;d<=5;++d,l/=256)e[t+d]=l&255;e[t+6]=(a&15)<<4|l&15,e[t+7]=a>>4|n}var Ig=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,l=e[0][n].length;a<l;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},Dg=Nt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:ho(r)})):Ig(e)}:Ig,Og=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(Pi(e,a)));return n.join("").replace(kn,"")},Z0=Nt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(kn,""):Og(e,r,t)}:Og,Fg=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Dx=Nt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Fg(e,r,t)}:Fg,Lg=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(gl(e,a)));return n.join("")},Xc=Nt?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Lg(r,t,n)}:Lg,Ox=function(e,r){var t=Kn(e,r);return t>0?Xc(e,r+4,r+4+t-1):""},Fx=Ox,Lx=function(e,r){var t=Kn(e,r);return t>0?Xc(e,r+4,r+4+t-1):""},Rx=Lx,jx=function(e,r){var t=2*Kn(e,r);return t>0?Xc(e,r+4,r+4+t-1):""},Mx=jx,Bx=function(r,t){var n=Kn(r,t);return n>0?Z0(r,t+4,t+4+n):""},zx=Bx,Ux=function(e,r){var t=Kn(e,r);return t>0?Xc(e,r+4,r+4+t):""},$x=Ux,Wx=function(e,r){return Fw(e,r)},Vd=Wx,Vx=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Nt&&(Fx=function(r,t){if(!Buffer.isBuffer(r))return Ox(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Rx=function(r,t){if(!Buffer.isBuffer(r))return Lx(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Mx=function(r,t){if(!Buffer.isBuffer(r))return jx(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},zx=function(r,t){if(!Buffer.isBuffer(r))return Bx(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},$x=function(r,t){if(!Buffer.isBuffer(r))return Ux(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Vd=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):Wx(r,t)},Vx=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var gl=function(e,r){return e[r]},Pi=function(e,r){return e[r+1]*256+e[r]},Rw=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Kn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},ro=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},jw=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Cc(e,r){var t="",n,a,l=[],c,d,m,v;switch(r){case"dbcs":if(v=this.l,Nt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)t+=String.fromCharCode(Pi(this,v)),v+=2;e*=2;break;case"utf8":t=Xc(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Z0(this,this.l,this.l+e);break;case"wstr":return Cc.call(this,e,"dbcs");case"lpstr-ansi":t=Fx(this,this.l),e=4+Kn(this,this.l);break;case"lpstr-cp":t=Rx(this,this.l),e=4+Kn(this,this.l);break;case"lpwstr":t=Mx(this,this.l),e=4+2*Kn(this,this.l);break;case"lpp4":e=4+Kn(this,this.l),t=zx(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Kn(this,this.l),t=$x(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(c=gl(this,this.l+e++))!==0;)l.push(hd(c));t=l.join("");break;case"_wstr":for(e=0,t="";(c=Pi(this,this.l+e))!==0;)l.push(hd(c)),e+=2;e+=2,t=l.join("");break;case"dbcs-cont":for(t="",v=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(v)!==-1)return c=gl(this,v),this.l=v+1,d=Cc.call(this,e-m,c?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(hd(Pi(this,v))),v+=2}t=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",v=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(v)!==-1)return c=gl(this,v),this.l=v+1,d=Cc.call(this,e-m,c?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(hd(gl(this,v))),v+=1}t=l.join("");break;default:switch(e){case 1:return n=gl(this,this.l),this.l++,n;case 2:return n=(r==="i"?Rw:Pi)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?ro:jw)(this,this.l),this.l+=4,n):(a=Kn(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Vd(this,this.l):a=Vd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=Dx(this,this.l,e);break}}return this.l+=e,t}var Mw=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Bw=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},zw=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function Uw(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)zw(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var c=r.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,Mw(this,r,this.l);break;case 8:if(n=8,t==="f"){Lw(this,r,this.l);break}case 16:break;case-4:n=4,Bw(this,r,this.l);break}return this.l+=n,this}function Hx(e,r){var t=Dx(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Kr(e,r){e.l=r,e.read_shift=Cc,e.chk=Hx,e.write_shift=Uw}function dn(e,r){e.l+=r}function Lr(e){var r=Ss(e);return Kr(r,0),r}function Oi(e,r,t){if(e){var n,a,l;Kr(e,e.l||0);for(var c=e.length,d=0,m=0;e.l<c;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var v=Yd[d]||Yd[65535];for(n=e.read_shift(1),l=n&127,a=1;a<4&&n&128;++a)l+=((n=e.read_shift(1))&127)<<7*a;m=e.l+l;var x=v.f&&v.f(e,l,t);if(e.l=m,r(x,v,d))return}}}function d0(){var e=[],r=Nt?256:2048,t=function(v){var x=Lr(v);return Kr(x,0),x},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(v){return n&&v<n.length-n.l?n:(a(),n=t(Math.max(v+1,r)))},c=function(){return a(),ys(e)},d=function(v){a(),n=v,n.l==null&&(n.l=n.length),l(r)};return{next:l,push:d,end:c,_bufs:e}}function Ac(e,r,t){var n=qr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Rg(e,r,t){var n=qr(e);return n.s=Ac(n.s,r.s,t),n.e=Ac(n.e,r.s,t),n}function Pc(e,r){if(e.cRel&&e.c<0)for(e=qr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=qr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=kt(e);return!e.cRel&&e.cRel!=null&&(t=Vw(t)),!e.rRel&&e.rRel!=null&&(t=$w(t)),t}function zh(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Rr(e.s.c)+":"+(e.e.cRel?"":"$")+Rr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Yr(e.s.r)+":"+(e.e.rRel?"":"$")+Yr(e.e.r):Pc(e.s,r.biff)+":"+Pc(e.e,r.biff)}function K0(e){return parseInt(Ww(e),10)-1}function Yr(e){return""+(e+1)}function $w(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ww(e){return e.replace(/\$(\d+)$/,"$1")}function q0(e){for(var r=Hw(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Rr(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Vw(e){return e.replace(/^([A-Z])/,"$$$1")}function Hw(e){return e.replace(/^\$([A-Z])/,"$1")}function Gw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function wn(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function kt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Al(e){var r=e.indexOf(":");return r==-1?{s:wn(e),e:wn(e)}:{s:wn(e.slice(0,r)),e:wn(e.slice(r+1))}}function Lt(e,r){return typeof r>"u"||typeof r=="number"?Lt(e.s,e.e):(typeof e!="string"&&(e=kt(e)),typeof r!="string"&&(r=kt(r)),e==r?e:e+":"+r)}function xr(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,l=e.length;for(t=0;n<l&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<l&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===l||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=l&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=l&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function jg(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=ha(e.z,t?bn(r):r)}catch{}try{return e.w=ha((e.XF||{}).numFmtId||(t?14:0),t?bn(r):r)}catch{return""+r}}function Di(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?vo[e.v]||e.v:r==null?jg(e,e.v):jg(e,r))}function Es(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function Gx(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,l=e||(a?[]:{}),c=0,d=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var m=typeof n.origin=="string"?wn(n.origin):n.origin;c=m.r,d=m.c}l["!ref"]||(l["!ref"]="A1:A1")}var v={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var x=xr(l["!ref"]);v.s.c=x.s.c,v.s.r=x.s.r,v.e.c=Math.max(v.e.c,x.e.c),v.e.r=Math.max(v.e.r,x.e.r),c==-1&&(v.e.r=c=x.e.r+1)}for(var y=0;y!=r.length;++y)if(r[y]){if(!Array.isArray(r[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var k=0;k!=r[y].length;++k)if(!(typeof r[y][k]>"u")){var E={v:r[y][k]},b=c+y,S=d+k;if(v.s.r>b&&(v.s.r=b),v.s.c>S&&(v.s.c=S),v.e.r<b&&(v.e.r=b),v.e.c<S&&(v.e.c=S),r[y][k]&&typeof r[y][k]=="object"&&!Array.isArray(r[y][k])&&!(r[y][k]instanceof Date))E=r[y][k];else if(Array.isArray(E.v)&&(E.f=r[y][k][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(n.nullError)E.t="e",E.v=0;else if(n.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=n.dateNF||Tt[14],n.cellDates?(E.t="d",E.w=ha(E.z,bn(E.v))):(E.t="n",E.v=bn(E.v),E.w=ha(E.z,E.v))):E.t="s";if(a)l[b]||(l[b]=[]),l[b][S]&&l[b][S].z&&(E.z=l[b][S].z),l[b][S]=E;else{var A=kt({c:S,r:b});l[A]&&l[A].z&&(E.z=l[A].z),l[A]=E}}}return v.s.c<1e7&&(l["!ref"]=Lt(v)),l}function Pl(e,r){return Gx(null,e,r)}function Zw(e){return e.read_shift(4,"i")}function un(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Kw(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Y0(e,r){var t=e.l,n=e.read_shift(1),a=un(e),l=[],c={t:a,h:a};if((n&1)!==0){for(var d=e.read_shift(4),m=0;m!=d;++m)l.push(Kw(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=t+r,c}var qw=Y0;function ma(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function po(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var Yw=un;function X0(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var Xw=un,f0=X0;function J0(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?Vd([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):ro(r,0)>>2;return t?a/100:a}function Zx(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var go=Zx;function ln(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Jw(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),d=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var v=so[a];v&&(r.rgb=Vc(v));break;case 2:r.rgb=Vc([c,d,m]);break;case 3:r.theme=a;break}return l!=0&&(r.tint=l>0?l/32767:l/32768),r}function Qw(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Kx(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function ek(e){return Kx(e,1)}function tk(e){return Kx(e,2)}var Q0=2,Ln=3,pd=11,Mg=12,Hd=19,gd=64,rk=65,nk=71,ak=4108,ik=4126,Vr=80,qx=81,sk=[Vr,qx],ok={1:{n:"CodePage",t:Q0},2:{n:"Category",t:Vr},3:{n:"PresentationFormat",t:Vr},4:{n:"ByteCount",t:Ln},5:{n:"LineCount",t:Ln},6:{n:"ParagraphCount",t:Ln},7:{n:"SlideCount",t:Ln},8:{n:"NoteCount",t:Ln},9:{n:"HiddenCount",t:Ln},10:{n:"MultimediaClipCount",t:Ln},11:{n:"ScaleCrop",t:pd},12:{n:"HeadingPairs",t:ak},13:{n:"TitlesOfParts",t:ik},14:{n:"Manager",t:Vr},15:{n:"Company",t:Vr},16:{n:"LinksUpToDate",t:pd},17:{n:"CharacterCount",t:Ln},19:{n:"SharedDoc",t:pd},22:{n:"HyperlinksChanged",t:pd},23:{n:"AppVersion",t:Ln,p:"version"},24:{n:"DigSig",t:rk},26:{n:"ContentType",t:Vr},27:{n:"ContentStatus",t:Vr},28:{n:"Language",t:Vr},29:{n:"Version",t:Vr},255:{},2147483648:{n:"Locale",t:Hd},2147483651:{n:"Behavior",t:Hd},1919054434:{}},lk={1:{n:"CodePage",t:Q0},2:{n:"Title",t:Vr},3:{n:"Subject",t:Vr},4:{n:"Author",t:Vr},5:{n:"Keywords",t:Vr},6:{n:"Comments",t:Vr},7:{n:"Template",t:Vr},8:{n:"LastAuthor",t:Vr},9:{n:"RevNumber",t:Vr},10:{n:"EditTime",t:gd},11:{n:"LastPrinted",t:gd},12:{n:"CreatedDate",t:gd},13:{n:"ModifiedDate",t:gd},14:{n:"PageCount",t:Ln},15:{n:"WordCount",t:Ln},16:{n:"CharCount",t:Ln},17:{n:"Thumbnail",t:nk},18:{n:"Application",t:Vr},19:{n:"DocSecurity",t:Ln},255:{},2147483648:{n:"Locale",t:Hd},2147483651:{n:"Behavior",t:Hd},1919054434:{}},Bg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ck=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function uk(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var dk=uk([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),so=qr(dk),vo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Yx={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},zg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function fk(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function hk(e){var r=fk();if(!e||!e.match)return r;var t={};if((e.match(fn)||[]).forEach(function(n){var a=mt(n);switch(a[0].replace(ww,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[zg[a.ContentType]]!==void 0&&r[zg[a.ContentType]].push(a.PartName);break}}),r.xmlns!==Dw.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var yl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function h0(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Nc(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(fn)||[]).forEach(function(a){var l=mt(a);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var d=l.TargetMode==="External"?l.Target:bc(l.Target,r);t[d]=c,n[l.Id]=c}}),t["!id"]=n,t}var mk="application/vnd.oasis.opendocument.spreadsheet";function pk(e,r){for(var t=G0(e),n,a;n=$c.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=mt(n[0],!1),a.path=="/"&&a.type!==mk)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var Ic=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],gk=(function(){for(var e=new Array(Ic.length),r=0;r<Ic.length;++r){var t=Ic[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function Xx(e){var r={};e=tr(e);for(var t=0;t<Ic.length;++t){var n=Ic[t],a=e.match(gk[t]);a!=null&&a.length>0&&(r[n[1]]=jt(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Hr(r[n[1]]))}return r}var vk=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Jx(e,r,t,n){var a=[];if(typeof e=="string")a=Ng(e,n);else for(var l=0;l<e.length;++l)a=a.concat(e[l].map(function(x){return{v:x}}));var c=typeof r=="string"?Ng(r,n).map(function(x){return x.v}):r,d=0,m=0;if(c.length>0)for(var v=0;v!==a.length;v+=2){switch(m=+a[v+1].v,a[v].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=m,t.SheetNames=c.slice(d,d+m);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=m,t.DefinedNames=c.slice(d,d+m);break;case"Charts":case"Diagramme":t.Chartsheets=m,t.ChartNames=c.slice(d,d+m);break}d+=m}}function xk(e,r,t){var n={};return r||(r={}),e=tr(e),vk.forEach(function(a){var l=(e.match(Uc(a[0]))||[])[1];switch(a[2]){case"string":l&&(r[a[1]]=jt(l));break;case"bool":r[a[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(n[a[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Jx(n.HeadingPairs,n.TitlesOfParts,r,t),r}var yk=/<[^>]+>[^<]*/g;function _k(e,r){var t={},n="",a=e.match(yk);if(a)for(var l=0;l!=a.length;++l){var c=a[l],d=mt(c);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":n=jt(d.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var m=c.split(">"),v=m[0].slice(4),x=m[1];switch(v){case"lpstr":case"bstr":case"lpwstr":t[n]=jt(x);break;case"bool":t[n]=cr(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(x,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(x);break;case"filetime":case"date":t[n]=Hr(x);break;case"cy":case"error":t[n]=jt(x);break;default:if(v.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",c,v,m)}}else if(c.slice(0,2)!=="</"){if(r.WTF)throw new Error(c)}}}return t}var wk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Uh;function kk(e,r,t){Uh||(Uh=W0(wk)),r=Uh[r]||r,e[r]=t}function em(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Qx(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function e1(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function t1(e,r,t){return r===31?e1(e):Qx(e,r,t)}function m0(e,r,t){return t1(e,r,t===!1?0:4)}function bk(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return t1(e,r,0)}function Sk(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(kn,""),e.l-a&2&&(e.l+=2)}return t}function Tk(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(kn,"");return t}function Ek(e){var r=e.l,t=Gd(e,qx);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Gd(e,Ln);return[t,n]}function Ck(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(Ek(e));return t}function Ug(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var l=e.read_shift(4),c=e.read_shift(4);n[l]=e.read_shift(c,r===1200?"utf16le":"utf8").replace(kn,"").replace(kc,"!"),r===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function r1(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function Ak(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Gd(e,r,t){var n=e.read_shift(2),a,l=t||{};if(e.l+=2,r!==Mg&&n!==r&&sk.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Mg?n:r){case 2:return a=e.read_shift(2,"i"),l.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Qx(e,n,4).replace(kn,"");case 31:return e1(e);case 64:return em(e);case 65:return r1(e);case 71:return Ak(e);case 80:return m0(e,n,!l.raw).replace(kn,"");case 81:return bk(e,n).replace(kn,"");case 4108:return Ck(e);case 4126:case 4127:return n==4127?Sk(e):Tk(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function $g(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),l=[],c=0,d=0,m=-1,v={};for(c=0;c!=a;++c){var x=e.read_shift(4),y=e.read_shift(4);l[c]=[x,y+t]}l.sort(function(O,N){return O[1]-N[1]});var k={};for(c=0;c!=a;++c){if(e.l!==l[c][1]){var E=!0;if(c>0&&r)switch(r[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,E=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break}if((!r||c==0)&&e.l<=l[c][1]&&(E=!1,e.l=l[c][1]),E)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(r){var b=r[l[c][0]];if(k[b.n]=Gd(e,b.t,{raw:!0}),b.p==="version"&&(k[b.n]=String(k[b.n]>>16)+"."+("0000"+String(k[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(k[b.n]){case 0:k[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Fa(d=k[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+k[b.n])}}else if(l[c][0]===1){if(d=k.CodePage=Gd(e,Q0),Fa(d),m!==-1){var S=e.l;e.l=l[m][1],v=Ug(e,d),e.l=S}}else if(l[c][0]===0){if(d===0){m=c,e.l=l[c+1][1];continue}v=Ug(e,d)}else{var A=v[l[c][0]],R;switch(e[e.l]){case 65:e.l+=4,R=r1(e);break;case 30:e.l+=4,R=m0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,R=m0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,R=e.read_shift(4,"i");break;case 19:e.l+=4,R=e.read_shift(4);break;case 5:e.l+=4,R=e.read_shift(8,"f");break;case 11:e.l+=4,R=kr(e,4);break;case 64:e.l+=4,R=Hr(em(e));break;default:throw new Error("unparsed value: "+e[e.l])}k[A]=R}}return e.l=t+n,k}function Wg(e,r,t){var n=e.content;if(!n)return{};Kr(n,0);var a,l,c,d,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var v=n.read_shift(4),x=n.read_shift(16);if(x!==Ft.utils.consts.HEADER_CLSID&&x!==t)throw new Error("Bad PropertySet CLSID "+x);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(l=n.read_shift(16),d=n.read_shift(4),a===1&&d!==n.l)throw new Error("Length mismatch: "+d+" !== "+n.l);a===2&&(c=n.read_shift(16),m=n.read_shift(4));var y=$g(n,r),k={SystemIdentifier:v};for(var E in y)k[E]=y[E];if(k.FMTID=l,a===1)return k;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var b;try{b=$g(n,null)}catch{}for(E in b)k[E]=b[E];return k.FMTID=[l,c],k}function fs(e,r){return e.read_shift(r),null}function Pk(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function kr(e,r){return e.read_shift(r)===1}function Cr(e){return e.read_shift(2,"u")}function n1(e,r){return Pk(e,r,Cr)}function Nk(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Jc(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=e.read_shift(1);l&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var c=n?e.read_shift(n,a):"";return c}function Ik(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,l=1+(t&1),c=0,d,m={};a&&(c=e.read_shift(2)),n&&(d=e.read_shift(4));var v=l==2?"dbcs-cont":"sbcs-cont",x=r===0?"":e.read_shift(r,v);return a&&(e.l+=4*c),n&&(e.l+=d),m.t=x,a||(m.raw="<t>"+m.t+"</t>",m.r=m.t),m}function fo(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Qc(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):fo(e,n,t)}function xo(e,r,t){if(t.biff>5)return Qc(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Dk(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function Ok(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(kn,"");return n&&(e.l+=24),a}function Fk(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(kn,"");return t+c}function Lk(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Ok(e);case"0303000000000000c000000000000046":return Fk(e);default:throw new Error("Unsupported Moniker "+t)}}function vd(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(kn,""):"";return t}function Rk(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var l,c,d,m,v="",x,y;a&16&&(l=vd(e,t-e.l)),a&128&&(c=vd(e,t-e.l)),(a&257)===257&&(d=vd(e,t-e.l)),(a&257)===1&&(m=Lk(e,t-e.l)),a&8&&(v=vd(e,t-e.l)),a&32&&(x=e.read_shift(16)),a&64&&(y=em(e)),e.l=t;var k=c||d||m||"";k&&v&&(k+="#"+v),k||(k="#"+v),a&2&&k.charAt(0)=="/"&&k.charAt(1)!="/"&&(k="file://"+k);var E={Target:k};return x&&(E.guid=x),y&&(E.time=y),l&&(E.Tooltip=l),E}function a1(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function i1(e,r){var t=a1(e);return t[3]=0,t}function ai(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function jk(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Mk(e,r,t){return r===0?"":xo(e,r,t)}function Bk(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),l=e.read_shift(n,"i"),c=e.read_shift(n,"i");return[a,l,c]}function s1(e){var r=e.read_shift(2),t=J0(e);return[r,t]}function zk(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=Jc(e,r,t),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,a}function af(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function o1(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var Uk=o1;function l1(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function $k(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Wk(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function sn(e){e.l+=2,e.l+=e.read_shift(2)}var Vk={0:sn,4:sn,5:sn,6:sn,7:Wk,8:sn,9:sn,10:sn,11:sn,12:sn,13:$k,14:sn,15:sn,16:sn,17:sn,18:sn,19:sn,20:sn,21:l1};function Hk(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(Vk[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function xd(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Gk(e,r){return r===0||e.read_shift(2),1200}function Zk(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=xo(e,0,t);return e.read_shift(r+n-e.l),a}function Kk(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function qk(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=Jc(e,0,t);return c.length===0&&(c="Sheet1"),{pos:n,hs:a,dt:l,name:c}}function Yk(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),l=[],c=0;c!=a&&e.l<t;++c)l.push(Ik(e));return l.Count=n,l.Unique=a,l}function Xk(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function Jk(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function Qk(e){var r=jk(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function eb(e){return e.read_shift(2),e.read_shift(4)}function Vg(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,a]}function tb(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2),m=e.read_shift(2),v=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:l,CurTab:c,FirstTab:d,Selected:m,TabRatio:v}}function rb(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function nb(){}function ab(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Jc(e,0,t),n}function ib(e){var r=ai(e);return r.isst=e.read_shift(4),r}function sb(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=ai(e);t.biff==2&&e.l++;var l=Qc(e,n-e.l,t);return a.val=l,a}function ob(e,r,t){var n=e.read_shift(2),a=xo(e,0,t);return[n,a]}var lb=xo;function Hg(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,l=e.read_shift(a),c=e.read_shift(a),d=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:l,c:d},e:{r:c,c:m}}}function cb(e){var r=e.read_shift(2),t=e.read_shift(2),n=s1(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function ub(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),l=[];e.l<t;)l.push(s1(e));if(e.l!==t)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:c,rkrec:l}}function db(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),l=[];e.l<t;)l.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:c,ixfe:l}}function fb(e,r,t,n){var a={},l=e.read_shift(4),c=e.read_shift(4),d=e.read_shift(4),m=e.read_shift(2);return a.patternType=ck[d>>26],n.cellStyles&&(a.alc=l&7,a.fWrap=l>>3&1,a.alcV=l>>4&7,a.fJustLast=l>>7&1,a.trot=l>>8&255,a.cIndent=l>>16&15,a.fShrinkToFit=l>>20&1,a.iReadOrder=l>>22&2,a.fAtrNum=l>>26&1,a.fAtrFnt=l>>27&1,a.fAtrAlc=l>>28&1,a.fAtrBdr=l>>29&1,a.fAtrPat=l>>30&1,a.fAtrProt=l>>31&1,a.dgLeft=c&15,a.dgRight=c>>4&15,a.dgTop=c>>8&15,a.dgBottom=c>>12&15,a.icvLeft=c>>16&127,a.icvRight=c>>23&127,a.grbitDiag=c>>30&3,a.icvTop=d&127,a.icvBottom=d>>7&127,a.icvDiag=d>>14&127,a.dgDiag=d>>21&15,a.icvFore=m&127,a.icvBack=m>>7&127,a.fsxButton=m>>14&1),a}function hb(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=fb(e,r,n.fStyle,t),n}function mb(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Gg(e,r,t){var n=ai(e);(t.biff==2||r==9)&&++e.l;var a=Nk(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function pb(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=ai(e),a=ln(e);return n.val=a,n}var Zg=Mk;function gb(e,r,t){var n=e.l+r,a=e.read_shift(2),l=e.read_shift(2);if(t.sbcch=l,l==1025||l==14849)return[l,a];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=fo(e,l),d=[];n>e.l;)d.push(Qc(e));return[l,a,c,d]}function Kg(e,r,t){var n=e.read_shift(2),a,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=zk(e,r-2,t)),l.body=a||e.read_shift(r-2),typeof a=="string"&&(l.Name=a),l}var vb=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qg(e,r,t){var n=e.l+r,a=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),d=e.read_shift(t&&t.biff==2?1:2),m=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),m=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var v=fo(e,c,t);a&32&&(v=vb[v.charCodeAt(0)]);var x=n-e.l;t&&t.biff==2&&--x;var y=n==e.l||d===0||!(x>0)?[]:JT(e,x,t,d);return{chKey:l,Name:v,itab:m,rgce:y}}function c1(e,r,t){if(t.biff<8)return xb(e,r,t);for(var n=[],a=e.l+r,l=e.read_shift(t.biff>8?4:2);l--!==0;)n.push(Bk(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function xb(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Jc(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function yb(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),l=fo(e,n,t),c=fo(e,a,t);return[l,c]}function _b(e,r,t){var n=o1(e);e.l++;var a=e.read_shift(1);return r-=8,[QT(e,r,t),a,n]}function Yg(e,r,t){var n=Uk(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,YT(e,r,t)]}function wb(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function kb(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=xo(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},d,c,l]}}function bb(e,r,t){return kb(e,r,t)}function Sb(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(af(e));return t}function Tb(e,r,t){if(t&&t.biff<8)return Cb(e,r,t);var n=l1(e),a=Hk(e,r-22,n[1]);return{cmo:n,ft:a}}var Eb={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function Cb(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var c=[];return c.push((Eb[n]||dn)(e,r,t)),{cmo:[a,n,l],ft:c}}function Ab(e,r,t){var n=e.l,a="";try{e.l+=4;var l=(t.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=Dk(e,6,t);var d=e.read_shift(2);e.read_shift(2),Cr(e,2);var m=e.read_shift(2);e.l+=m;for(var v=1;v<e.lens.length-1;++v){if(e.l-n!=e.lens[v])throw new Error("TxO: bad continue record");var x=e[e.l],y=fo(e,e.lens[v+1]-e.lens[v]-1);if(a+=y,a.length>=(x?d:2*d))break}if(a.length!==d&&a.length!==d*2)throw new Error("cchText: "+d+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function Pb(e,r){var t=af(e);e.l+=16;var n=Rk(e,r-24);return[t,n]}function Nb(e,r){e.read_shift(2);var t=af(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(kn,""),[t,n]}function Ib(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Bg[t]||t,t=e.read_shift(2),r[1]=Bg[t]||t,r}function Db(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(i1(e));return t}function Ob(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(i1(e));return t}function Fb(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function u1(e,r,t){if(!t.cellStyles)return dn(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),d=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var v={s:a,e:l,w:c,ixfe:d,flags:m};return(t.biff>=5||!t.biff)&&(v.level=m>>8&7),v}function Lb(e,r){var t={};return r<32||(e.l+=16,t.header=ln(e),t.footer=ln(e),e.l+=2),t}function Rb(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var jb=ai,Mb=n1,Bb=Qc;function zb(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function Ub(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=ai(e);++e.l;var a=xo(e,r-7,t);return n.t="str",n.val=a,n}function $b(e){var r=ai(e);++e.l;var t=ln(e);return r.t="n",r.val=t,r}function Wb(e){var r=ai(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function Vb(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function Hb(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function Gb(e,r,t){var n=e.l+r,a=ai(e),l=e.read_shift(2),c=fo(e,l,t);return e.l=n,a.t="str",a.val=c,a}var Zb=[2,3,48,49,131,139,140,245],Xg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=W0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(d,m){var v=[],x=Ss(1);switch(m.type){case"base64":x=Oa(Yn(d));break;case"binary":x=Oa(d);break;case"buffer":case"array":x=d;break}Kr(x,0);var y=x.read_shift(1),k=!!(y&136),E=!1,b=!1;switch(y){case 2:break;case 3:break;case 48:E=!0,k=!0;break;case 49:E=!0,k=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var S=0,A=521;y==2&&(S=x.read_shift(2)),x.l+=3,y!=2&&(S=x.read_shift(4)),S>1048576&&(S=1e6),y!=2&&(A=x.read_shift(2));var R=x.read_shift(2),O=m.codepage||1252;y!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(O=e[x[x.l]]),x.l+=1,x.l+=2),b&&(x.l+=36);for(var N=[],U={},K=Math.min(x.length,y==2?521:A-10-(E?264:0)),B=b?32:11;x.l<K&&x[x.l]!=13;)switch(U={},U.name=Bc.utils.decode(O,x.slice(x.l,x.l+B)).replace(/[\u0000\r\n].*$/g,""),x.l+=B,U.type=String.fromCharCode(x.read_shift(1)),y!=2&&!b&&(U.offset=x.read_shift(4)),U.len=x.read_shift(1),y==2&&(U.offset=x.read_shift(2)),U.dec=x.read_shift(1),U.name.length&&N.push(U),y!=2&&(x.l+=b?13:14),U.type){case"B":(!E||U.len!=8)&&m.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+U.name+":"+U.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+U.type)}if(x[x.l]!==13&&(x.l=A-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=A;var D=0,te=0;for(v[0]=[],te=0;te!=N.length;++te)v[0][te]=N[te].name;for(;S-- >0;){if(x[x.l]===42){x.l+=R;continue}for(++x.l,v[++D]=[],te=0,te=0;te!=N.length;++te){var ee=x.slice(x.l,x.l+N[te].len);x.l+=N[te].len,Kr(ee,0);var ve=Bc.utils.decode(O,ee);switch(N[te].type){case"C":ve.trim().length&&(v[D][te]=ve.replace(/\s+$/,""));break;case"D":ve.length===8?v[D][te]=new Date(+ve.slice(0,4),+ve.slice(4,6)-1,+ve.slice(6,8)):v[D][te]=ve;break;case"F":v[D][te]=parseFloat(ve.trim());break;case"+":case"I":v[D][te]=b?ee.read_shift(-4,"i")^2147483648:ee.read_shift(4,"i");break;case"L":switch(ve.trim().toUpperCase()){case"Y":case"T":v[D][te]=!0;break;case"N":case"F":v[D][te]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ve+"|")}break;case"M":if(!k)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));v[D][te]="##MEMO##"+(b?parseInt(ve.trim(),10):ee.read_shift(4));break;case"N":ve=ve.replace(/\u0000/g,"").trim(),ve&&ve!="."&&(v[D][te]=+ve||0);break;case"@":v[D][te]=new Date(ee.read_shift(-8,"f")-621356832e5);break;case"T":v[D][te]=new Date((ee.read_shift(4)-2440588)*864e5+ee.read_shift(4));break;case"Y":v[D][te]=ee.read_shift(4,"i")/1e4+ee.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":v[D][te]=-ee.read_shift(-8,"f");break;case"B":if(E&&N[te].len==8){v[D][te]=ee.read_shift(8,"f");break}case"G":case"P":ee.l+=N[te].len;break;case"0":if(N[te].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[te].type)}}}if(y!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),m.DBF=N,v}function n(d,m){var v=m||{};v.dateNF||(v.dateNF="yyyymmdd");var x=Pl(t(d,v),v);return x["!cols"]=v.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete v.DBF,x}function a(d,m){try{return Es(n(d,m),m)}catch(v){if(m&&m.WTF)throw v}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(d,m){var v=m||{};if(+v.codepage>=0&&Fa(+v.codepage),v.type=="string")throw new Error("Cannot write DBF to JS string");var x=d0(),y=w0(d,{header:1,raw:!0,cellDates:!0}),k=y[0],E=y.slice(1),b=d["!cols"]||[],S=0,A=0,R=0,O=1;for(S=0;S<k.length;++S){if(((b[S]||{}).DBF||{}).name){k[S]=b[S].DBF.name,++R;continue}if(k[S]!=null){if(++R,typeof k[S]=="number"&&(k[S]=k[S].toString(10)),typeof k[S]!="string")throw new Error("DBF Invalid column name "+k[S]+" |"+typeof k[S]+"|");if(k.indexOf(k[S])!==S){for(A=0;A<1024;++A)if(k.indexOf(k[S]+"_"+A)==-1){k[S]+="_"+A;break}}}}var N=xr(d["!ref"]),U=[],K=[],B=[];for(S=0;S<=N.e.c-N.s.c;++S){var D="",te="",ee=0,ve=[];for(A=0;A<E.length;++A)E[A][S]!=null&&ve.push(E[A][S]);if(ve.length==0||k[S]==null){U[S]="?";continue}for(A=0;A<ve.length;++A){switch(typeof ve[A]){case"number":te="B";break;case"string":te="C";break;case"boolean":te="L";break;case"object":te=ve[A]instanceof Date?"D":"C";break;default:te="C"}ee=Math.max(ee,String(ve[A]).length),D=D&&D!=te?"C":te}ee>250&&(ee=250),te=((b[S]||{}).DBF||{}).type,te=="C"&&b[S].DBF.len>ee&&(ee=b[S].DBF.len),D=="B"&&te=="N"&&(D="N",B[S]=b[S].DBF.dec,ee=b[S].DBF.len),K[S]=D=="C"||te=="N"?ee:l[D]||0,O+=K[S],U[S]=D}var me=x.next(32);for(me.write_shift(4,318902576),me.write_shift(4,E.length),me.write_shift(2,296+32*R),me.write_shift(2,O),S=0;S<4;++S)me.write_shift(4,0);for(me.write_shift(4,0|(+r[cx]||3)<<8),S=0,A=0;S<k.length;++S)if(k[S]!=null){var J=x.next(32),ce=(k[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);J.write_shift(1,ce,"sbcs"),J.write_shift(1,U[S]=="?"?"C":U[S],"sbcs"),J.write_shift(4,A),J.write_shift(1,K[S]||l[U[S]]||0),J.write_shift(1,B[S]||0),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(4,0),A+=K[S]||l[U[S]]||0}var ke=x.next(264);for(ke.write_shift(4,13),S=0;S<65;++S)ke.write_shift(4,0);for(S=0;S<E.length;++S){var se=x.next(O);for(se.write_shift(1,0),A=0;A<k.length;++A)if(k[A]!=null)switch(U[A]){case"L":se.write_shift(1,E[S][A]==null?63:E[S][A]?84:70);break;case"B":se.write_shift(8,E[S][A]||0,"f");break;case"N":var ue="0";for(typeof E[S][A]=="number"&&(ue=E[S][A].toFixed(B[A]||0)),R=0;R<K[A]-ue.length;++R)se.write_shift(1,32);se.write_shift(1,ue,"sbcs");break;case"D":E[S][A]?(se.write_shift(4,("0000"+E[S][A].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(E[S][A].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+E[S][A].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var j=String(E[S][A]!=null?E[S][A]:"").slice(0,K[A]);for(se.write_shift(1,j,"sbcs"),R=0;R<K[A]-j.length;++R)se.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:a,to_sheet:n,from_sheet:c}})(),Kb=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+ei(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(k,E){var b=e[E];return typeof b=="number"?hg(b):b},n=function(k,E,b){var S=E.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return S==59?k:hg(S)};e["|"]=254;function a(k,E){switch(E.type){case"base64":return l(Yn(k),E);case"binary":return l(k,E);case"buffer":return l(Nt&&Buffer.isBuffer(k)?k.toString("binary"):mo(k),E);case"array":return l(uo(k),E)}throw new Error("Unrecognized type "+E.type)}function l(k,E){var b=k.split(/[\n\r]+/),S=-1,A=-1,R=0,O=0,N=[],U=[],K=null,B={},D=[],te=[],ee=[],ve=0,me;for(+E.codepage>=0&&Fa(+E.codepage);R!==b.length;++R){ve=0;var J=b[R].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),ce=J.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),ke=ce[0],se;if(J.length>0)switch(ke){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ce[1].charAt(0)=="P"&&U.push(J.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,j=!1,G=!1,Z=!1,oe=-1,I=-1;for(O=1;O<ce.length;++O)switch(ce[O].charAt(0)){case"A":break;case"X":A=parseInt(ce[O].slice(1))-1,j=!0;break;case"Y":for(S=parseInt(ce[O].slice(1))-1,j||(A=0),me=N.length;me<=S;++me)N[me]=[];break;case"K":se=ce[O].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(Ra(se))?isNaN(bl(se).getDate())||(se=Hr(se)):(se=Ra(se),K!==null&&Cl(K)&&(se=nf(se))),ue=!0;break;case"E":Z=!0;var P=wl(ce[O].slice(1),{r:S,c:A});N[S][A]=[N[S][A],P];break;case"S":G=!0,N[S][A]=[N[S][A],"S5S"];break;case"G":break;case"R":oe=parseInt(ce[O].slice(1))-1;break;case"C":I=parseInt(ce[O].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+J)}if(ue&&(N[S][A]&&N[S][A].length==2?N[S][A][0]=se:N[S][A]=se,K=null),G){if(Z)throw new Error("SYLK shared formula cannot have own formula");var F=oe>-1&&N[oe][I];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");N[S][A][1]=_1(F[1],{r:S-oe,c:A-I})}break;case"F":var M=0;for(O=1;O<ce.length;++O)switch(ce[O].charAt(0)){case"X":A=parseInt(ce[O].slice(1))-1,++M;break;case"Y":for(S=parseInt(ce[O].slice(1))-1,me=N.length;me<=S;++me)N[me]=[];break;case"M":ve=parseInt(ce[O].slice(1))/20;break;case"F":break;case"G":break;case"P":K=U[parseInt(ce[O].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(ee=ce[O].slice(1).split(" "),me=parseInt(ee[0],10);me<=parseInt(ee[1],10);++me)ve=parseInt(ee[2],10),te[me-1]=ve===0?{hidden:!0}:{wch:ve},Sl(te[me-1]);break;case"C":A=parseInt(ce[O].slice(1))-1,te[A]||(te[A]={});break;case"R":S=parseInt(ce[O].slice(1))-1,D[S]||(D[S]={}),ve>0?(D[S].hpt=ve,D[S].hpx=Hc(ve)):ve===0&&(D[S].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+J)}M<1&&(K=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+J)}}return D.length>0&&(B["!rows"]=D),te.length>0&&(B["!cols"]=te),E&&E.sheetRows&&(N=N.slice(0,E.sheetRows)),[N,B]}function c(k,E){var b=a(k,E),S=b[0],A=b[1],R=Pl(S,E);return ei(A).forEach(function(O){R[O]=A[O]}),R}function d(k,E){return Es(c(k,E),E)}function m(k,E,b,S){var A="C;Y"+(b+1)+";X"+(S+1)+";K";switch(k.t){case"n":A+=k.v||0,k.f&&!k.F&&(A+=";E"+F2(k.f,{r:b,c:S}));break;case"b":A+=k.v?"TRUE":"FALSE";break;case"e":A+=k.w||k.v;break;case"d":A+='"'+(k.w||k.v)+'"';break;case"s":A+='"'+k.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function v(k,E){E.forEach(function(b,S){var A="F;W"+(S+1)+" "+(S+1)+" ";b.hidden?A+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=Kd(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=qd(b.wpx)),typeof b.wch=="number"&&(A+=Math.round(b.wch))),A.charAt(A.length-1)!=" "&&k.push(A)})}function x(k,E){E.forEach(function(b,S){var A="F;";b.hidden?A+="M0;":b.hpt?A+="M"+20*b.hpt+";":b.hpx&&(A+="M"+20*v1(b.hpx)+";"),A.length>2&&k.push(A+"R"+(S+1))})}function y(k,E){var b=["ID;PWXL;N;E"],S=[],A=xr(k["!ref"]),R,O=Array.isArray(k),N=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),k["!cols"]&&v(b,k["!cols"]),k["!rows"]&&x(b,k["!rows"]),b.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var U=A.s.r;U<=A.e.r;++U)for(var K=A.s.c;K<=A.e.c;++K){var B=kt({r:U,c:K});R=O?(k[U]||[])[K]:k[B],!(!R||R.v==null&&(!R.f||R.F))&&S.push(m(R,k,U,K))}return b.join(N)+N+S.join(N)+N+"E"+N}return{to_workbook:d,to_sheet:c,from_sheet:y}})(),qb=(function(){function e(l,c){switch(c.type){case"base64":return r(Yn(l),c);case"binary":return r(l,c);case"buffer":return r(Nt&&Buffer.isBuffer(l)?l.toString("binary"):mo(l),c);case"array":return r(uo(l),c)}throw new Error("Unrecognized type "+c.type)}function r(l,c){for(var d=l.split(`
`),m=-1,v=-1,x=0,y=[];x!==d.length;++x){if(d[x].trim()==="BOT"){y[++m]=[],v=0;continue}if(!(m<0)){var k=d[x].trim().split(","),E=k[0],b=k[1];++x;for(var S=d[x]||"";(S.match(/["]/g)||[]).length&1&&x<d.length-1;)S+=`
`+d[++x];switch(S=S.trim(),+E){case-1:if(S==="BOT"){y[++m]=[],v=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?y[m][v]=!0:S==="FALSE"?y[m][v]=!1:isNaN(Ra(b))?isNaN(bl(b).getDate())?y[m][v]=b:y[m][v]=Hr(b):y[m][v]=Ra(b),++v;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),y[m][v++]=S!==""?S:null;break}if(S==="EOD")break}}return c&&c.sheetRows&&(y=y.slice(0,c.sheetRows)),y}function t(l,c){return Pl(e(l,c),c)}function n(l,c){return Es(t(l,c),c)}var a=(function(){var l=function(m,v,x,y,k){m.push(v),m.push(x+","+y),m.push('"'+k.replace(/"/g,'""')+'"')},c=function(m,v,x,y){m.push(v+","+x),m.push(v==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(m){var v=[],x=xr(m["!ref"]),y,k=Array.isArray(m);l(v,"TABLE",0,1,"sheetjs"),l(v,"VECTORS",0,x.e.r-x.s.r+1,""),l(v,"TUPLES",0,x.e.c-x.s.c+1,""),l(v,"DATA",0,0,"");for(var E=x.s.r;E<=x.e.r;++E){c(v,-1,0,"BOT");for(var b=x.s.c;b<=x.e.c;++b){var S=kt({r:E,c:b});if(y=k?(m[E]||[])[b]:m[S],!y){c(v,1,0,"");continue}switch(y.t){case"n":var A=y.w;!A&&y.v!=null&&(A=y.v),A==null?y.f&&!y.F?c(v,1,0,"="+y.f):c(v,1,0,""):c(v,0,A,"V");break;case"b":c(v,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":c(v,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=ha(y.z||Tt[14],bn(Hr(y.v)))),c(v,0,y.w,"V");break;default:c(v,1,0,"")}}}c(v,-1,0,"EOD");var R=`\r
`,O=v.join(R);return O}})();return{to_workbook:n,to_sheet:t,from_sheet:a}})(),Yb=(function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(y,k){for(var E=y.split(`
`),b=-1,S=-1,A=0,R=[];A!==E.length;++A){var O=E[A].trim().split(":");if(O[0]==="cell"){var N=wn(O[1]);if(R.length<=N.r)for(b=R.length;b<=N.r;++b)R[b]||(R[b]=[]);switch(b=N.r,S=N.c,O[2]){case"t":R[b][S]=e(O[3]);break;case"v":R[b][S]=+O[3];break;case"vtf":var U=O[O.length-1];case"vtc":switch(O[3]){case"nl":R[b][S]=!!+O[4];break;default:R[b][S]=+O[4];break}O[2]=="vtf"&&(R[b][S]=[R[b][S],U])}}}return k&&k.sheetRows&&(R=R.slice(0,k.sheetRows)),R}function n(y,k){return Pl(t(y,k),k)}function a(y,k){return Es(n(y,k),k)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function v(y){if(!y||!y["!ref"])return"";for(var k=[],E=[],b,S="",A=Al(y["!ref"]),R=Array.isArray(y),O=A.s.r;O<=A.e.r;++O)for(var N=A.s.c;N<=A.e.c;++N)if(S=kt({r:O,c:N}),b=R?(y[O]||[])[N]:y[S],!(!b||b.v==null||b.t==="z")){switch(E=["cell",S,"t"],b.t){case"s":case"str":E.push(r(b.v));break;case"n":b.f?(E[2]="vtf",E[3]="n",E[4]=b.v,E[5]=r(b.f)):(E[2]="v",E[3]=b.v);break;case"b":E[2]="vt"+(b.f?"f":"c"),E[3]="nl",E[4]=b.v?"1":"0",E[5]=r(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var U=bn(Hr(b.v));E[2]="vtc",E[3]="nd",E[4]=""+U,E[5]=b.w||ha(b.z||Tt[14],U);break;case"e":continue}k.push(E.join(":"))}return k.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),k.push("valueformat:1:text-wiki"),k.join(`
`)}function x(y){return[l,c,d,c,v(y),m].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:x}})(),Wc=(function(){function e(x,y,k,E,b){b.raw?y[k][E]=x:x===""||(x==="TRUE"?y[k][E]=!0:x==="FALSE"?y[k][E]=!1:isNaN(Ra(x))?isNaN(bl(x).getDate())?y[k][E]=x:y[k][E]=Hr(x):y[k][E]=Ra(x))}function r(x,y){var k=y||{},E=[];if(!x||x.length===0)return E;for(var b=x.split(/[\r\n]/),S=b.length-1;S>=0&&b[S].length===0;)--S;for(var A=10,R=0,O=0;O<=S;++O)R=b[O].indexOf(" "),R==-1?R=b[O].length:R++,A=Math.max(A,R);for(O=0;O<=S;++O){E[O]=[];var N=0;for(e(b[O].slice(0,A).trim(),E,O,N,k),N=1;N<=(b[O].length-A)/10+1;++N)e(b[O].slice(A+(N-1)*10,A+N*10).trim(),E,O,N,k)}return k.sheetRows&&(E=E.slice(0,k.sheetRows)),E}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(x){for(var y={},k=!1,E=0,b=0;E<x.length;++E)(b=x.charCodeAt(E))==34?k=!k:!k&&b in t&&(y[b]=(y[b]||0)+1);b=[];for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&b.push([y[E],E]);if(!b.length){y=n;for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&b.push([y[E],E])}return b.sort(function(S,A){return S[0]-A[0]||n[S[1]]-n[A[1]]}),t[b.pop()[1]]||44}function l(x,y){var k=y||{},E="",b=k.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(E=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(E=x.charAt(4),x=x.slice(6)):E=a(x.slice(0,1024)):k&&k.FS?E=k.FS:E=a(x.slice(0,1024));var A=0,R=0,O=0,N=0,U=0,K=E.charCodeAt(0),B=!1,D=0,te=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var ee=k.dateNF!=null?ow(k.dateNF):null;function ve(){var me=x.slice(N,U),J={};if(me.charAt(0)=='"'&&me.charAt(me.length-1)=='"'&&(me=me.slice(1,-1).replace(/""/g,'"')),me.length===0)J.t="z";else if(k.raw)J.t="s",J.v=me;else if(me.trim().length===0)J.t="s",J.v=me;else if(me.charCodeAt(0)==61)me.charCodeAt(1)==34&&me.charCodeAt(me.length-1)==34?(J.t="s",J.v=me.slice(2,-1).replace(/""/g,'"')):R2(me)?(J.t="n",J.f=me.slice(1)):(J.t="s",J.v=me);else if(me=="TRUE")J.t="b",J.v=!0;else if(me=="FALSE")J.t="b",J.v=!1;else if(!isNaN(O=Ra(me)))J.t="n",k.cellText!==!1&&(J.w=me),J.v=O;else if(!isNaN(bl(me).getDate())||ee&&me.match(ee)){J.z=k.dateNF||Tt[14];var ce=0;ee&&me.match(ee)&&(me=lw(me,k.dateNF,me.match(ee)||[]),ce=1),k.cellDates?(J.t="d",J.v=Hr(me,ce)):(J.t="n",J.v=bn(Hr(me,ce))),k.cellText!==!1&&(J.w=ha(J.z,J.v instanceof Date?bn(J.v):J.v)),k.cellNF||delete J.z}else J.t="s",J.v=me;if(J.t=="z"||(k.dense?(b[A]||(b[A]=[]),b[A][R]=J):b[kt({c:R,r:A})]=J),N=U+1,te=x.charCodeAt(N),S.e.c<R&&(S.e.c=R),S.e.r<A&&(S.e.r=A),D==K)++R;else if(R=0,++A,k.sheetRows&&k.sheetRows<=A)return!0}e:for(;U<x.length;++U)switch(D=x.charCodeAt(U)){case 34:te===34&&(B=!B);break;case K:case 10:case 13:if(!B&&ve())break e;break}return U-N>0&&ve(),b["!ref"]=Lt(S),b}function c(x,y){return!(y&&y.PRN)||y.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?l(x,y):Pl(r(x,y),y)}function d(x,y){var k="",E=y.type=="string"?[0,0,0,0]:lm(x,y);switch(y.type){case"base64":k=Yn(x);break;case"binary":k=x;break;case"buffer":y.codepage==65001?k=x.toString("utf8"):y.codepage&&typeof Bc<"u"||(k=Nt&&Buffer.isBuffer(x)?x.toString("binary"):mo(x));break;case"array":k=uo(x);break;case"string":k=x;break;default:throw new Error("Unrecognized type "+y.type)}return E[0]==239&&E[1]==187&&E[2]==191?k=tr(k.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?k=tr(k):y.type=="binary"&&typeof Bc<"u",k.slice(0,19)=="socialcalc:version:"?Yb.to_sheet(y.type=="string"?k:tr(k),y):c(k,y)}function m(x,y){return Es(d(x,y),y)}function v(x){for(var y=[],k=xr(x["!ref"]),E,b=Array.isArray(x),S=k.s.r;S<=k.e.r;++S){for(var A=[],R=k.s.c;R<=k.e.c;++R){var O=kt({r:S,c:R});if(E=b?(x[S]||[])[R]:x[O],!E||E.v==null){A.push("          ");continue}for(var N=(E.w||(Di(E),E.w)||"").slice(0,10);N.length<10;)N+=" ";A.push(N+(R===0?" ":""))}y.push(A.join(""))}return y.join(`
`)}return{to_workbook:m,to_sheet:d,from_sheet:v}})();function Xb(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=Kb.to_workbook(e,t);return t.WTF=n,a}catch(l){if(t.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return Wc.to_workbook(e,r)}}var Dc=(function(){function e(P,F,M){if(P){Kr(P,P.l||0);for(var H=M.Enum||oe;P.l<P.length;){var X=P.read_shift(2),fe=H[X]||H[65535],ge=P.read_shift(2),ye=P.l+ge,xe=fe.f&&fe.f(P,ge,M);if(P.l=ye,F(xe,fe,X))return}}}function r(P,F){switch(F.type){case"base64":return t(Oa(Yn(P)),F);case"binary":return t(Oa(P),F);case"buffer":case"array":return t(P,F)}throw"Unsupported type "+F.type}function t(P,F){if(!P)return P;var M=F||{},H=M.dense?[]:{},X="Sheet1",fe="",ge=0,ye={},xe=[],ze=[],ne={s:{r:0,c:0},e:{r:0,c:0}},xt=M.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)M.Enum=oe,e(P,function($e,It,ur){switch(ur){case 0:M.vers=$e,$e>=4096&&(M.qpro=!0);break;case 6:ne=$e;break;case 204:$e&&(fe=$e);break;case 222:fe=$e;break;case 15:case 51:M.qpro||($e[1].v=$e[1].v.slice(1));case 13:case 14:case 16:ur==14&&($e[2]&112)==112&&($e[2]&15)>1&&($e[2]&15)<15&&($e[1].z=M.dateNF||Tt[14],M.cellDates&&($e[1].t="d",$e[1].v=nf($e[1].v))),M.qpro&&$e[3]>ge&&(H["!ref"]=Lt(ne),ye[X]=H,xe.push(X),H=M.dense?[]:{},ne={s:{r:0,c:0},e:{r:0,c:0}},ge=$e[3],X=fe||"Sheet"+(ge+1),fe="");var rr=M.dense?(H[$e[0].r]||[])[$e[0].c]:H[kt($e[0])];if(rr){rr.t=$e[1].t,rr.v=$e[1].v,$e[1].z!=null&&(rr.z=$e[1].z),$e[1].f!=null&&(rr.f=$e[1].f);break}M.dense?(H[$e[0].r]||(H[$e[0].r]=[]),H[$e[0].r][$e[0].c]=$e[1]):H[kt($e[0])]=$e[1];break}},M);else if(P[2]==26||P[2]==14)M.Enum=I,P[2]==14&&(M.qpro=!0,P.l=0),e(P,function($e,It,ur){switch(ur){case 204:X=$e;break;case 22:$e[1].v=$e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if($e[3]>ge&&(H["!ref"]=Lt(ne),ye[X]=H,xe.push(X),H=M.dense?[]:{},ne={s:{r:0,c:0},e:{r:0,c:0}},ge=$e[3],X="Sheet"+(ge+1)),xt>0&&$e[0].r>=xt)break;M.dense?(H[$e[0].r]||(H[$e[0].r]=[]),H[$e[0].r][$e[0].c]=$e[1]):H[kt($e[0])]=$e[1],ne.e.c<$e[0].c&&(ne.e.c=$e[0].c),ne.e.r<$e[0].r&&(ne.e.r=$e[0].r);break;case 27:$e[14e3]&&(ze[$e[14e3][0]]=$e[14e3][1]);break;case 1537:ze[$e[0]]=$e[1],$e[0]==ge&&(X=$e[1]);break}},M);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(H["!ref"]=Lt(ne),ye[fe||X]=H,xe.push(fe||X),!ze.length)return{SheetNames:xe,Sheets:ye};for(var st={},wt=[],_t=0;_t<ze.length;++_t)ye[xe[_t]]?(wt.push(ze[_t]||xe[_t]),st[ze[_t]]=ye[ze[_t]]||ye[xe[_t]]):(wt.push(ze[_t]),st[ze[_t]]={"!ref":"A1"});return{SheetNames:wt,Sheets:st}}function n(P,F){var M=F||{};if(+M.codepage>=0&&Fa(+M.codepage),M.type=="string")throw new Error("Cannot write WK1 to JS string");var H=d0(),X=xr(P["!ref"]),fe=Array.isArray(P),ge=[];Pa(H,0,l(1030)),Pa(H,6,m(X));for(var ye=Math.min(X.e.r,8191),xe=X.s.r;xe<=ye;++xe)for(var ze=Yr(xe),ne=X.s.c;ne<=X.e.c;++ne){xe===X.s.r&&(ge[ne]=Rr(ne));var xt=ge[ne]+ze,st=fe?(P[xe]||[])[ne]:P[xt];if(!(!st||st.t=="z"))if(st.t=="n")(st.v|0)==st.v&&st.v>=-32768&&st.v<=32767?Pa(H,13,E(xe,ne,st.v)):Pa(H,14,S(xe,ne,st.v));else{var wt=Di(st);Pa(H,15,y(xe,ne,wt.slice(0,239)))}}return Pa(H,1),H.end()}function a(P,F){var M=F||{};if(+M.codepage>=0&&Fa(+M.codepage),M.type=="string")throw new Error("Cannot write WK3 to JS string");var H=d0();Pa(H,0,c(P));for(var X=0,fe=0;X<P.SheetNames.length;++X)(P.Sheets[P.SheetNames[X]]||{})["!ref"]&&Pa(H,27,Z(P.SheetNames[X],fe++));var ge=0;for(X=0;X<P.SheetNames.length;++X){var ye=P.Sheets[P.SheetNames[X]];if(!(!ye||!ye["!ref"])){for(var xe=xr(ye["!ref"]),ze=Array.isArray(ye),ne=[],xt=Math.min(xe.e.r,8191),st=xe.s.r;st<=xt;++st)for(var wt=Yr(st),_t=xe.s.c;_t<=xe.e.c;++_t){st===xe.s.r&&(ne[_t]=Rr(_t));var $e=ne[_t]+wt,It=ze?(ye[st]||[])[_t]:ye[$e];if(!(!It||It.t=="z"))if(It.t=="n")Pa(H,23,ve(st,_t,ge,It.v));else{var ur=Di(It);Pa(H,22,D(st,_t,ge,ur.slice(0,239)))}}++ge}}return Pa(H,1),H.end()}function l(P){var F=Lr(2);return F.write_shift(2,P),F}function c(P){var F=Lr(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var M=0,H=0,X=0,fe=0;fe<P.SheetNames.length;++fe){var ge=P.SheetNames[fe],ye=P.Sheets[ge];if(!(!ye||!ye["!ref"])){++X;var xe=Al(ye["!ref"]);M<xe.e.r&&(M=xe.e.r),H<xe.e.c&&(H=xe.e.c)}}return M>8191&&(M=8191),F.write_shift(2,M),F.write_shift(1,X),F.write_shift(1,H),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function d(P,F,M){var H={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&M.qpro?(H.s.c=P.read_shift(1),P.l++,H.s.r=P.read_shift(2),H.e.c=P.read_shift(1),P.l++,H.e.r=P.read_shift(2),H):(H.s.c=P.read_shift(2),H.s.r=P.read_shift(2),F==12&&M.qpro&&(P.l+=2),H.e.c=P.read_shift(2),H.e.r=P.read_shift(2),F==12&&M.qpro&&(P.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function m(P){var F=Lr(8);return F.write_shift(2,P.s.c),F.write_shift(2,P.s.r),F.write_shift(2,P.e.c),F.write_shift(2,P.e.r),F}function v(P,F,M){var H=[{c:0,r:0},{t:"n",v:0},0,0];return M.qpro&&M.vers!=20768?(H[0].c=P.read_shift(1),H[3]=P.read_shift(1),H[0].r=P.read_shift(2),P.l+=2):(H[2]=P.read_shift(1),H[0].c=P.read_shift(2),H[0].r=P.read_shift(2)),H}function x(P,F,M){var H=P.l+F,X=v(P,F,M);if(X[1].t="s",M.vers==20768){P.l++;var fe=P.read_shift(1);return X[1].v=P.read_shift(fe,"utf8"),X}return M.qpro&&P.l++,X[1].v=P.read_shift(H-P.l,"cstr"),X}function y(P,F,M){var H=Lr(7+M.length);H.write_shift(1,255),H.write_shift(2,F),H.write_shift(2,P),H.write_shift(1,39);for(var X=0;X<H.length;++X){var fe=M.charCodeAt(X);H.write_shift(1,fe>=128?95:fe)}return H.write_shift(1,0),H}function k(P,F,M){var H=v(P,F,M);return H[1].v=P.read_shift(2,"i"),H}function E(P,F,M){var H=Lr(7);return H.write_shift(1,255),H.write_shift(2,F),H.write_shift(2,P),H.write_shift(2,M,"i"),H}function b(P,F,M){var H=v(P,F,M);return H[1].v=P.read_shift(8,"f"),H}function S(P,F,M){var H=Lr(13);return H.write_shift(1,255),H.write_shift(2,F),H.write_shift(2,P),H.write_shift(8,M,"f"),H}function A(P,F,M){var H=P.l+F,X=v(P,F,M);if(X[1].v=P.read_shift(8,"f"),M.qpro)P.l=H;else{var fe=P.read_shift(2);U(P.slice(P.l,P.l+fe),X),P.l+=fe}return X}function R(P,F,M){var H=F&32768;return F&=-32769,F=(H?P:0)+(F>=8192?F-16384:F),(H?"":"$")+(M?Rr(F):Yr(F))}var O={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function U(P,F){Kr(P,0);for(var M=[],H=0,X="",fe="",ge="",ye="";P.l<P.length;){var xe=P[P.l++];switch(xe){case 0:M.push(P.read_shift(8,"f"));break;case 1:fe=R(F[0].c,P.read_shift(2),!0),X=R(F[0].r,P.read_shift(2),!1),M.push(fe+X);break;case 2:{var ze=R(F[0].c,P.read_shift(2),!0),ne=R(F[0].r,P.read_shift(2),!1);fe=R(F[0].c,P.read_shift(2),!0),X=R(F[0].r,P.read_shift(2),!1),M.push(ze+ne+":"+fe+X)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:M.push("("+M.pop()+")");break;case 5:M.push(P.read_shift(2));break;case 6:{for(var xt="";xe=P[P.l++];)xt+=String.fromCharCode(xe);M.push('"'+xt.replace(/"/g,'""')+'"')}break;case 8:M.push("-"+M.pop());break;case 23:M.push("+"+M.pop());break;case 22:M.push("NOT("+M.pop()+")");break;case 20:case 21:ye=M.pop(),ge=M.pop(),M.push(["AND","OR"][xe-20]+"("+ge+","+ye+")");break;default:if(xe<32&&N[xe])ye=M.pop(),ge=M.pop(),M.push(ge+N[xe]+ye);else if(O[xe]){if(H=O[xe][1],H==69&&(H=P[P.l++]),H>M.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+M.join("|")+"|");return}var st=M.slice(-H);M.length-=H,M.push(O[xe][0]+"("+st.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}M.length==1?F[1].f=""+M[0]:console.error("WK1 bad formula parse |"+M.join("|")+"|")}function K(P){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=P.read_shift(2),F[3]=P[P.l++],F[0].c=P[P.l++],F}function B(P,F){var M=K(P);return M[1].t="s",M[1].v=P.read_shift(F-4,"cstr"),M}function D(P,F,M,H){var X=Lr(6+H.length);X.write_shift(2,P),X.write_shift(1,M),X.write_shift(1,F),X.write_shift(1,39);for(var fe=0;fe<H.length;++fe){var ge=H.charCodeAt(fe);X.write_shift(1,ge>=128?95:ge)}return X.write_shift(1,0),X}function te(P,F){var M=K(P);M[1].v=P.read_shift(2);var H=M[1].v>>1;if(M[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return M[1].v=H,M}function ee(P,F){var M=K(P),H=P.read_shift(4),X=P.read_shift(4),fe=P.read_shift(2);if(fe==65535)return H===0&&X===3221225472?(M[1].t="e",M[1].v=15):H===0&&X===3489660928?(M[1].t="e",M[1].v=42):M[1].v=0,M;var ge=fe&32768;return fe=(fe&32767)-16446,M[1].v=(1-ge*2)*(X*Math.pow(2,fe+32)+H*Math.pow(2,fe)),M}function ve(P,F,M,H){var X=Lr(14);if(X.write_shift(2,P),X.write_shift(1,M),X.write_shift(1,F),H==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var fe=0,ge=0,ye=0,xe=0;return H<0&&(fe=1,H=-H),ge=Math.log2(H)|0,H/=Math.pow(2,ge-31),xe=H>>>0,(xe&2147483648)==0&&(H/=2,++ge,xe=H>>>0),H-=xe,xe|=2147483648,xe>>>=0,H*=Math.pow(2,32),ye=H>>>0,X.write_shift(4,ye),X.write_shift(4,xe),ge+=16383+(fe?32768:0),X.write_shift(2,ge),X}function me(P,F){var M=ee(P);return P.l+=F-14,M}function J(P,F){var M=K(P),H=P.read_shift(4);return M[1].v=H>>6,M}function ce(P,F){var M=K(P),H=P.read_shift(8,"f");return M[1].v=H,M}function ke(P,F){var M=ce(P);return P.l+=F-10,M}function se(P,F){return P[P.l+F-1]==0?P.read_shift(F,"cstr"):""}function ue(P,F){var M=P[P.l++];M>F-1&&(M=F-1);for(var H="";H.length<M;)H+=String.fromCharCode(P[P.l++]);return H}function j(P,F,M){if(!(!M.qpro||F<21)){var H=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var X=P.read_shift(F-21,"cstr");return[H,X]}}function G(P,F){for(var M={},H=P.l+F;P.l<H;){var X=P.read_shift(2);if(X==14e3){for(M[X]=[0,""],M[X][0]=P.read_shift(2);P[P.l];)M[X][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return M}function Z(P,F){var M=Lr(5+P.length);M.write_shift(2,14e3),M.write_shift(2,F);for(var H=0;H<P.length;++H){var X=P.charCodeAt(H);M[M.l++]=X>127?95:X}return M[M.l++]=0,M}var oe={0:{n:"BOF",f:Cr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:k},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},I={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:ee},24:{n:"NUMBER18",f:te},25:{n:"FORMULA19",f:me},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:G},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:J},38:{n:"??"},39:{n:"NUMBER27",f:ce},40:{n:"FORMULA28",f:ke},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:j},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}})();function Jb(e){var r={},t=e.match(fn),n=0,a=!1;if(t)for(;n!=t.length;++n){var l=mt(t[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;r.cp=M0[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=l.val;break;case"<sz":r.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":l.rgb&&(r.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(l[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+l[0])}}return r}var Qb=(function(){var e=Uc("t"),r=Uc("rPr");function t(l){var c=l.match(e);if(!c)return{t:"s",v:""};var d={t:"s",v:jt(c[1])},m=l.match(r);return m&&(d.s=Jb(m[1])),d}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(a).map(t).filter(function(d){return d.v})}})(),eS=(function(){var r=/(\r\n|\n)/g;function t(a,l,c){var d=[];a.u&&d.push("text-decoration: underline;"),a.uval&&d.push("text-underline-style:"+a.uval+";"),a.sz&&d.push("font-size:"+a.sz+"pt;"),a.outline&&d.push("text-effect: outline;"),a.shadow&&d.push("text-shadow: auto;"),l.push('<span style="'+d.join("")+'">'),a.b&&(l.push("<b>"),c.push("</b>")),a.i&&(l.push("<i>"),c.push("</i>")),a.strike&&(l.push("<s>"),c.push("</s>"));var m=a.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(l.push("<"+m+">"),c.push("</"+m+">")),c.push("</span>"),a}function n(a){var l=[[],a.v,[]];return a.v?(a.s&&t(a.s,l[0],l[2]),l[0].join("")+l[1].replace(r,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),tS=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,rS=/<(?:\w+:)?r>/,nS=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tm(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=jt(tr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=tr(e),t&&(n.h=H0(n.t))):e.match(rS)&&(n.r=tr(e),n.t=jt(tr((e.replace(nS,"").match(tS)||[]).join("").replace(fn,""))),t&&(n.h=eS(Qb(n.r)))),n):{t:""}}var aS=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,iS=/<(?:\w+:)?(?:si|sstItem)>/g,sS=/<\/(?:\w+:)?(?:si|sstItem)>/;function oS(e,r){var t=[],n="";if(!e)return t;var a=e.match(aS);if(a){n=a[2].replace(iS,"").split(sS);for(var l=0;l!=n.length;++l){var c=tm(n[l].trim(),r);c!=null&&(t[t.length]=c)}a=mt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function lS(e){return[e.read_shift(4),e.read_shift(4)]}function cS(e,r){var t=[],n=!1;return Oi(e,function(l,c,d){switch(d){case 159:t.Count=l[0],t.Unique=l[1];break;case 19:t.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),t}function d1(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Ii(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function uS(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Ii(e,4),r.U=Ii(e,4),r.W=Ii(e,4),r}function dS(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),l=[];a-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function fS(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(dS(e));return r}function hS(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function mS(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Ii(e,4),r.U=Ii(e,4),r.W=Ii(e,4),r}function pS(e){var r=mS(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function f1(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function h1(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function gS(e){var r=Ii(e);switch(r.Minor){case 2:return[r.Minor,vS(e)];case 3:return[r.Minor,xS()];case 4:return[r.Minor,yS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function vS(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=f1(e,t),a=h1(e,e.length-e.l);return{t:"Std",h:n,v:a}}function xS(){throw new Error("File is password-protected: ECMA-376 Extensible")}function yS(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(fn,function(l){var c=mt(l);switch(ni(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(d){n[d]=c[d]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function _S(e,r){var t={},n=t.EncryptionVersionInfo=Ii(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=f1(e,a),r-=a,t.EncryptionVerifier=h1(e,r),t}function wS(e){var r={},t=r.EncryptionVersionInfo=Ii(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function kS(e){var r=0,t,n=d1(e),a=n.length+1,l,c,d,m,v;for(t=Ss(a),t[0]=n.length,l=1;l!=a;++l)t[l]=n[l-1];for(l=a-1;l>=0;--l)c=t[l],d=(r&16384)===0?0:1,m=r<<1&32767,v=d|m,r=v^c;return r^52811}var m1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},a=function(c,d){return n(c^d)},l=function(c){for(var d=r[c.length-1],m=104,v=c.length-1;v>=0;--v)for(var x=c[v],y=0;y!=7;++y)x&64&&(d^=t[m]),x*=2,--m;return d};return function(c){for(var d=d1(c),m=l(d),v=d.length,x=Ss(16),y=0;y!=16;++y)x[y]=0;var k,E,b;for((v&1)===1&&(k=m>>8,x[v]=a(e[0],k),--v,k=m&255,E=d[d.length-1],x[v]=a(E,k));v>0;)--v,k=m>>8,x[v]=a(d[v],k),--v,k=m&255,x[v]=a(d[v],k);for(v=15,b=15-d.length;b>0;)k=m>>8,x[v]=a(e[b],k),--v,--b,k=m&255,x[v]=a(d[v],k),--v,--b;return x}})(),bS=function(e,r,t,n,a){a||(a=r),n||(n=m1(e));var l,c;for(l=0;l!=r.length;++l)c=r[l],c^=n[t],c=(c>>5|c<<3)&255,a[l]=c,++t;return[a,t,n]},SS=function(e){var r=0,t=m1(e);return function(n){var a=bS("",n,r,t);return r=a[1],a[0]}};function TS(e,r,t,n){var a={key:Cr(e),verificationBytes:Cr(e)};return t.password&&(a.verifier=kS(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=SS(t.password)),a}function ES(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=wS(e):n.Data=_S(e,r),n}function CS(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?ES(e,r-2,n):TS(e,t.biff>=8?r:r-2,t,n),n}var AS=(function(){function e(a,l){switch(l.type){case"base64":return r(Yn(a),l);case"binary":return r(a,l);case"buffer":return r(Nt&&Buffer.isBuffer(a)?a.toString("binary"):mo(a),l);case"array":return r(uo(a),l)}throw new Error("Unrecognized type "+l.type)}function r(a,l){var c=l||{},d=c.dense?[]:{},m=a.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var v={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(x,y){Array.isArray(d)&&(d[y]=[]);for(var k=/\\\w+\b/g,E=0,b,S=-1;b=k.exec(x);){switch(b[0]){case"\\cell":var A=x.slice(E,k.lastIndex-b[0].length);if(A[0]==" "&&(A=A.slice(1)),++S,A.length){var R={v:A,t:"s"};Array.isArray(d)?d[y][S]=R:d[kt({r:y,c:S})]=R}break}E=k.lastIndex}S>v.e.c&&(v.e.c=S)}),d["!ref"]=Lt(v),d}function t(a,l){return Es(e(a,l),l)}function n(a){for(var l=["{\\rtf1\\ansi"],c=xr(a["!ref"]),d,m=Array.isArray(a),v=c.s.r;v<=c.e.r;++v){l.push("\\trowd\\trautofit1");for(var x=c.s.c;x<=c.e.c;++x)l.push("\\cellx"+(x+1));for(l.push("\\pard\\intbl"),x=c.s.c;x<=c.e.c;++x){var y=kt({r:v,c:x});d=m?(a[v]||[])[x]:a[y],!(!d||d.v==null&&(!d.f||d.F))&&(l.push(" "+(d.w||(Di(d),d.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}})();function PS(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Vc(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function NS(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),l=Math.min(r,t,n),c=a-l;if(c===0)return[0,0,r];var d=0,m=0,v=a+l;switch(m=c/(v>1?2-v:v),a){case r:d=((t-n)/c+6)%6;break;case t:d=(n-r)/c+2;break;case n:d=(r-t)/c+4;break}return[d/6,m,v/2]}function IS(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),l=n-a/2,c=[l,l,l],d=6*r,m;if(t!==0)switch(d|0){case 0:case 6:m=a*d,c[0]+=a,c[1]+=m;break;case 1:m=a*(2-d),c[0]+=m,c[1]+=a;break;case 2:m=a*(d-2),c[1]+=a,c[2]+=m;break;case 3:m=a*(4-d),c[1]+=m,c[2]+=a;break;case 4:m=a*(d-4),c[2]+=a,c[0]+=m;break;case 5:m=a*(6-d),c[2]+=m,c[0]+=a;break}for(var v=0;v!=3;++v)c[v]=Math.round(c[v]*255);return c}function Zd(e,r){if(r===0)return e;var t=NS(PS(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Vc(IS(t))}var p1=6,DS=15,OS=1,_n=p1;function Kd(e){return Math.floor((e+Math.round(128/_n)/256)*_n)}function qd(e){return Math.floor((e-5)/_n*100+.5)/100}function p0(e){return Math.round((e*_n+5)/_n*256)/256}function $h(e){return p0(qd(Kd(e)))}function rm(e){var r=Math.abs(e-$h(e)),t=_n;if(r>.005)for(_n=OS;_n<DS;++_n)Math.abs(e-$h(e))<=r&&(r=Math.abs(e-$h(e)),t=_n);_n=t}function Sl(e){e.width?(e.wpx=Kd(e.width),e.wch=qd(e.wpx),e.MDW=_n):e.wpx?(e.wch=qd(e.wpx),e.width=p0(e.wch),e.MDW=_n):typeof e.wch=="number"&&(e.width=p0(e.wch),e.wpx=Kd(e.width),e.MDW=_n),e.customWidth&&delete e.customWidth}var FS=96,g1=FS;function v1(e){return e*96/g1}function Hc(e){return e*g1/96}var LS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function RS(e,r,t,n){r.Borders=[];var a={},l=!1;(e[0].match(fn)||[]).forEach(function(c){var d=mt(c);switch(ni(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},d.diagonalUp&&(a.diagonalUp=cr(d.diagonalUp)),d.diagonalDown&&(a.diagonalDown=cr(d.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+d[0]+" in borders")}})}function jS(e,r,t,n){r.Fills=[];var a={},l=!1;(e[0].match(fn)||[]).forEach(function(c){var d=mt(c);switch(ni(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":d.patternType&&(a.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),d.indexed&&(a.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(a.bgColor.theme=parseInt(d.theme,10)),d.tint&&(a.bgColor.tint=parseFloat(d.tint)),d.rgb&&(a.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),d.theme&&(a.fgColor.theme=parseInt(d.theme,10)),d.tint&&(a.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(a.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fills")}})}function MS(e,r,t,n){r.Fonts=[];var a={},l=!1;(e[0].match(fn)||[]).forEach(function(c){var d=mt(c);switch(ni(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":d.val&&(a.name=tr(d.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=d.val?cr(d.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=d.val?cr(d.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(d.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=d.val?cr(d.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=d.val?cr(d.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=d.val?cr(d.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=d.val?cr(d.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=d.val?cr(d.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":d.val&&(a.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(a.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(a.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(a.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=M0[parseInt(d.val,10)];break;case"<color":if(a.color||(a.color={}),d.auto&&(a.color.auto=cr(d.auto)),d.rgb)a.color.rgb=d.rgb.slice(-6);else if(d.indexed){a.color.index=parseInt(d.indexed,10);var m=so[a.color.index];a.color.index==81&&(m=so[1]),m||(m=so[1]),a.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else d.theme&&(a.color.theme=parseInt(d.theme,10),d.tint&&(a.color.tint=parseFloat(d.tint)),d.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Zd(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fonts")}})}function BS(e,r,t){r.NumberFmt=[];for(var n=ei(Tt),a=0;a<n.length;++a)r.NumberFmt[n[a]]=Tt[n[a]];var l=e[0].match(fn);if(l)for(a=0;a<l.length;++a){var c=mt(l[a]);switch(ni(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=jt(tr(c.formatCode)),m=parseInt(c.numFmtId,10);if(r.NumberFmt[m]=d,m>0){if(m>392){for(m=392;m>60&&r.NumberFmt[m]!=null;--m);r.NumberFmt[m]=d}io(d,m)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var yd=["numFmtId","fillId","fontId","borderId","xfId"],_d=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zS(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(fn)||[]).forEach(function(l){var c=mt(l),d=0;switch(ni(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],d=0;d<yd.length;++d)n[yd[d]]&&(n[yd[d]]=parseInt(n[yd[d]],10));for(d=0;d<_d.length;++d)n[_d[d]]&&(n[_d[d]]=cr(n[_d[d]]));if(r.NumberFmt&&n.numFmtId>392){for(d=392;d>60;--d)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[d]){n.numFmtId=d;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};c.vertical&&(m.vertical=c.vertical),c.horizontal&&(m.horizontal=c.horizontal),c.textRotation!=null&&(m.textRotation=c.textRotation),c.indent&&(m.indent=c.indent),c.wrapText&&(m.wrapText=cr(c.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var US=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,m,v){var x={};if(!d)return x;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=d.match(r))&&BS(y,x,v),(y=d.match(a))&&MS(y,x,m,v),(y=d.match(n))&&jS(y,x,m,v),(y=d.match(l))&&RS(y,x,m,v),(y=d.match(t))&&zS(y,x,v),x}})();function $S(e,r){var t=e.read_shift(2),n=un(e);return[t,n]}function WS(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=Qw(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(n.underline=c);var d=e.read_shift(1);d>0&&(n.family=d);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=Jw(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=un(e),n}var VS=dn;function HS(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var GS=dn;function ZS(e,r,t){var n={};n.NumberFmt=[];for(var a in Tt)n.NumberFmt[a]=Tt[a];n.CellXf=[],n.Fonts=[];var l=[],c=!1;return Oi(e,function(m,v,x){switch(x){case 44:n.NumberFmt[m[0]]=m[1],io(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(m.color.rgb=Zd(r.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(x),c=!0;break;case 38:l.pop(),c=!1;break;default:if(v.T>0)l.push(x);else if(v.T<0)l.pop();else if(!c||t.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),n}var KS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function qS(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(fn)||[]).forEach(function(a){var l=mt(a);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(r.themeElements.clrScheme[KS.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function YS(){}function XS(){}var JS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,QS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,e2=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function t2(e,r,t){r.themeElements={};var n;[["clrScheme",JS,qS],["fontScheme",QS,YS],["fmtScheme",e2,XS]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var r2=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function x1(e,r){(!e||e.length===0)&&(e=n2());var t,n={};if(!(t=e.match(r2)))throw new Error("themeElements not found in theme");return t2(t[0],n,r),n.raw=e,n}function n2(e,r){var t=[Px];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function a2(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var c;try{c=Ax(l,{type:"array"})}catch{return}var d=qn(c,"theme/theme/theme1.xml",!0);if(d)return x1(d,t)}}function i2(e){return e.read_shift(4)}function s2(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=o2(e,4);break;case 2:r.xclrValue=a1(e);break;case 3:r.xclrValue=i2(e);break;case 4:e.l+=4;break}return e.l+=8,r}function o2(e,r){return dn(e,r)}function l2(e,r){return dn(e,r)}function c2(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=s2(e);break;case 6:n[1]=l2(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function u2(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),l=[];a-- >0;)l.push(c2(e,t-e.l));return{ixfe:n,ext:l}}function d2(e,r){r.forEach(function(t){t[0]})}function f2(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:un(e)}}function h2(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function m2(e){return e.l+=4,e.read_shift(4)!=0}function p2(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},l=[],c=!1,d=2;return Oi(e,function(m,v,x){switch(x){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(y){d==1?n.Cell.push({type:n.Types[y[0]-1].name,index:y[1]}):d==0&&n.Value.push({type:n.Types[y[0]-1].name,index:y[1]})});break;case 337:d=m?1:0;break;case 338:d=2;break;case 35:l.push(x),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!v.T){if(!c||a.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),n}function g2(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,l=2,c;return e.replace(fn,function(d){var m=mt(d);switch(ni(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var v=0;v<n.Types.length;++v)n.Types[v].name==m.name&&(c=n.Types[v]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):l==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+m.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return d}),n}function v2(e){var r=[];if(!e)return r;var t=1;return(e.match(fn)||[]).forEach(function(n){var a=mt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function x2(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=kt(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function y2(e,r,t){var n=[];return Oi(e,function(l,c,d){switch(d){case 63:n.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function _2(e,r,t,n){if(!e)return e;var a=n||{},l=!1;Oi(e,function(d,m,v){switch(v){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!m.T){if(!l||a.WTF)throw new Error("Unexpected record 0x"+v.toString(16))}}},a)}function w2(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function Jg(e,r,t,n){var a=Array.isArray(e),l;r.forEach(function(c){var d=wn(c.ref);if(a?(e[d.r]||(e[d.r]=[]),l=e[d.r][d.c]):l=e[c.ref],!l){l={t:"z"},a?e[d.r][d.c]=l:e[c.ref]=l;var m=xr(e["!ref"]||"BDWGO1000001:A1");m.s.r>d.r&&(m.s.r=d.r),m.e.r<d.r&&(m.e.r=d.r),m.s.c>d.c&&(m.s.c=d.c),m.e.c<d.c&&(m.e.c=d.c);var v=Lt(m);v!==e["!ref"]&&(e["!ref"]=v)}l.c||(l.c=[]);var x={a:c.author,t:c.t,r:c.r,T:t};c.h&&(x.h=c.h);for(var y=l.c.length-1;y>=0;--y){if(!t&&l.c[y].T)return;t&&!l.c[y].T&&l.c.splice(y,1)}if(t&&n){for(y=0;y<n.length;++y)if(x.a==n[y].id){x.a=n[y].name||x.a;break}}l.c.push(x)})}function k2(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var d=c.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&t.push(d[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var d=c.match(/<(?:\w+:)?comment[^>]*>/);if(d){var m=mt(d[0]),v={author:m.authorId&&t[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},x=wn(m.ref);if(!(r.sheetRows&&r.sheetRows<=x.r)){var y=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),k=!!y&&!!y[1]&&tm(y[1])||{r:"",t:"",h:""};v.r=k.r,k.r=="<t></t>"&&(k.t=k.h=""),v.t=(k.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(v.h=k.h),n.push(v)}}}}),n}function b2(e,r){var t=[],n=!1,a={},l=0;return e.replace(fn,function(d,m){var v=mt(d);switch(ni(v[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:v.personId,guid:v.id,ref:v.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":l=m+d.length;break;case"</text>":a.t=e.slice(l,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+v[0]+" in threaded comments")}return d}),t}function S2(e,r){var t=[],n=!1;return e.replace(fn,function(l){var c=mt(l);switch(ni(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),t}function T2(e){var r={};r.iauthor=e.read_shift(4);var t=go(e);return r.rfx=t.s,r.ref=kt(t.s),e.l+=16,r}var E2=un;function C2(e,r){var t=[],n=[],a={},l=!1;return Oi(e,function(d,m,v){switch(v){case 632:n.push(d);break;case 635:a=d;break;case 637:a.t=d.t,a.h=d.h,a.r=d.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!l||r.WTF)throw new Error("Unexpected record 0x"+v.toString(16))}}}),t}var A2="application/vnd.ms-office.vbaProject";function P2(e){var r=Ft.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ft.utils.cfb_add(r,a,e.FileIndex[n].content)}}),Ft.write(r)}function N2(){return{"!type":"dialog"}}function I2(){return{"!type":"dialog"}}function D2(){return{"!type":"macro"}}function O2(){return{"!type":"macro"}}var wl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,l,c){var d=!1,m=!1;l.length==0?m=!0:l.charAt(0)=="["&&(m=!0,l=l.slice(1,-1)),c.length==0?d=!0:c.charAt(0)=="["&&(d=!0,c=c.slice(1,-1));var v=l.length>0?parseInt(l,10)|0:0,x=c.length>0?parseInt(c,10)|0:0;return d?x+=r.c:--x,m?v+=r.r:--v,a+(d?"":"$")+Rr(x)+(m?"":"$")+Yr(v)}return function(a,l){return r=l,a.replace(e,t)}})(),y1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,F2=(function(){return function(r,t){return r.replace(y1,function(n,a,l,c,d,m){var v=q0(c)-(l?0:t.c),x=K0(m)-(d?0:t.r),y=x==0?"":d?x+1:"["+x+"]",k=v==0?"":l?v+1:"["+v+"]";return a+"R"+y+"C"+k})}})();function _1(e,r){return e.replace(y1,function(t,n,a,l,c,d){return n+(a=="$"?a+l:Rr(q0(l)+r.c))+(c=="$"?c+d:Yr(K0(d)+r.r))})}function L2(e,r,t){var n=Al(r),a=n.s,l=wn(t),c={r:l.r-a.r,c:l.c-a.c};return _1(e,c)}function R2(e){return e.length!=1}function Qg(e){return e.replace(/_xlfn\./g,"")}function Tr(e){e.l+=1}function Ts(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function w1(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return k1(e);t.biff==12&&(n=4)}var a=e.read_shift(n),l=e.read_shift(n),c=Ts(e),d=Ts(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:d[0],cRel:d[1],rRel:d[2]}}}function k1(e){var r=Ts(e),t=Ts(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function j2(e,r,t){if(t.biff<8)return k1(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),l=Ts(e),c=Ts(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function b1(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return M2(e);var n=e.read_shift(t&&t.biff==12?4:2),a=Ts(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function M2(e){var r=Ts(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function B2(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function z2(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return U2(e);var a=e.read_shift(n>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,d=(l&32768)>>15;if(l&=16383,d==1)for(;a>524287;)a-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:a,c:l,cRel:c,rRel:d}}function U2(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function $2(e,r,t){var n=(e[e.l++]&96)>>5,a=w1(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function W2(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=w1(e,l,t);return[n,a,c]}function V2(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function H2(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,a]}function G2(e,r,t){var n=(e[e.l++]&96)>>5,a=j2(e,r-1,t);return[n,a]}function Z2(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function ev(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function K2(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],l=0;l<=n;++l)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function q2(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function Y2(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function X2(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function J2(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function S1(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function Q2(e){return e.read_shift(2),S1(e)}function eT(e){return e.read_shift(2),S1(e)}function tT(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=b1(e,0,t);return[n,a]}function rT(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=z2(e,0,t);return[n,a]}function nT(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var l=b1(e,0,t);return[n,a,l]}function aT(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[iE[a],C1[a],n]}function iT(e,r,t){var n=e[e.l++],a=e.read_shift(1),l=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:sT(e);return[a,(l[0]===0?C1:aE)[l[1]]]}function sT(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function oT(e,r,t){e.l+=t&&t.biff==2?3:4}function lT(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function cT(e){return e.l++,vo[e.read_shift(1)]}function uT(e){return e.l++,e.read_shift(2)}function dT(e){return e.l++,e.read_shift(1)!==0}function fT(e){return e.l++,ln(e)}function hT(e,r,t){return e.l++,Jc(e,r-1,t)}function mT(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=kr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=vo[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=ln(e);break;case 2:t[1]=xo(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function pT(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],l=0;l!=n;++l)a.push((t.biff==12?go:af)(e));return a}function gT(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var d=0;d!=a;++d)c[l][d]=mT(e,t.biff);return c}function vT(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,l=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function xT(e,r,t){if(t.biff==5)return yT(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),l=e.read_shift(4);return[n,a,l]}function yT(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function _T(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function wT(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function kT(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function bT(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,a]}var ST=dn,TT=dn,ET=dn;function eu(e,r,t){return e.l+=2,[B2(e)]}function nm(e){return e.l+=6,[]}var CT=eu,AT=nm,PT=nm,NT=eu;function T1(e){return e.l+=2,[Cr(e),e.read_shift(2)&1]}var IT=eu,DT=T1,OT=nm,FT=eu,LT=eu,RT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jT(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),l=e.read_shift(2),c=RT[t>>2&31];return{ixti:r,coltype:t&3,rt:c,idx:n,c:a,C:l}}function MT(e){return e.l+=2,[e.read_shift(4)]}function BT(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function zT(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function UT(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function $T(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function WT(e){return e.l+=4,[0,0]}var tv={1:{n:"PtgExp",f:lT},2:{n:"PtgTbl",f:ET},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:hT},26:{n:"PtgSheet",f:BT},27:{n:"PtgEndSheet",f:zT},28:{n:"PtgErr",f:cT},29:{n:"PtgBool",f:dT},30:{n:"PtgInt",f:uT},31:{n:"PtgNum",f:fT},32:{n:"PtgArray",f:Z2},33:{n:"PtgFunc",f:aT},34:{n:"PtgFuncVar",f:iT},35:{n:"PtgName",f:vT},36:{n:"PtgRef",f:tT},37:{n:"PtgArea",f:$2},38:{n:"PtgMemArea",f:_T},39:{n:"PtgMemErr",f:ST},40:{n:"PtgMemNoMem",f:TT},41:{n:"PtgMemFunc",f:wT},42:{n:"PtgRefErr",f:kT},43:{n:"PtgAreaErr",f:V2},44:{n:"PtgRefN",f:rT},45:{n:"PtgAreaN",f:G2},46:{n:"PtgMemAreaN",f:UT},47:{n:"PtgMemNoMemN",f:$T},57:{n:"PtgNameX",f:xT},58:{n:"PtgRef3d",f:nT},59:{n:"PtgArea3d",f:W2},60:{n:"PtgRefErr3d",f:bT},61:{n:"PtgAreaErr3d",f:H2},255:{}},VT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},HT={1:{n:"PtgElfLel",f:T1},2:{n:"PtgElfRw",f:FT},3:{n:"PtgElfCol",f:CT},6:{n:"PtgElfRwV",f:LT},7:{n:"PtgElfColV",f:NT},10:{n:"PtgElfRadical",f:IT},11:{n:"PtgElfRadicalS",f:OT},13:{n:"PtgElfColS",f:AT},15:{n:"PtgElfColSV",f:PT},16:{n:"PtgElfRadicalLel",f:DT},25:{n:"PtgList",f:jT},29:{n:"PtgSxName",f:MT},255:{}},GT={0:{n:"PtgAttrNoop",f:WT},1:{n:"PtgAttrSemi",f:J2},2:{n:"PtgAttrIf",f:Y2},4:{n:"PtgAttrChoose",f:K2},8:{n:"PtgAttrGoto",f:q2},16:{n:"PtgAttrSum",f:oT},32:{n:"PtgAttrBaxcel",f:ev},33:{n:"PtgAttrBaxcel",f:ev},64:{n:"PtgAttrSpace",f:Q2},65:{n:"PtgAttrSpaceSemi",f:eT},128:{n:"PtgAttrIfError",f:X2},255:{}};function tu(e,r,t,n){if(n.biff<8)return dn(e,r);for(var a=e.l+r,l=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=gT(e,0,n),l.push(t[c][1]);break;case"PtgMemArea":t[c][2]=pT(e,t[c][1],n),l.push(t[c][2]);break;case"PtgExp":n&&n.biff==12&&(t[c][1][1]=e.read_shift(4),l.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return r=a-e.l,r!==0&&l.push(dn(e,r)),l}function ru(e,r,t){for(var n=e.l+r,a,l,c=[];n!=e.l;)r=n-e.l,l=e[e.l],a=tv[l]||tv[VT[l]],(l===24||l===25)&&(a=(l===24?HT:GT)[e[e.l+1]]),!a||!a.f?dn(e,r):c.push([a.n,a.f(e,r,t)]);return c}function ZT(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var KT={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function qT(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function E1(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function rv(e,r,t){var n=E1(e,r,t);return n=="#REF"?n:qT(n,t)}function on(e,r,t,n,a){var l=a&&a.biff||8,c={s:{c:0,r:0}},d=[],m,v,x,y=0,k=0,E,b="";if(!e[0]||!e[0][0])return"";for(var S=-1,A="",R=0,O=e[0].length;R<O;++R){var N=e[0][R];switch(N[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=d.pop(),v=d.pop(),S>=0){switch(e[0][S][1][0]){case 0:A=vr(" ",e[0][S][1][1]);break;case 1:A=vr("\r",e[0][S][1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}v=v+A,S=-1}d.push(v+KT[N[0]]+m);break;case"PtgIsect":m=d.pop(),v=d.pop(),d.push(v+" "+m);break;case"PtgUnion":m=d.pop(),v=d.pop(),d.push(v+","+m);break;case"PtgRange":m=d.pop(),v=d.pop(),d.push(v+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Ac(N[1][1],c,a),d.push(Pc(x,l));break;case"PtgRefN":x=t?Ac(N[1][1],t,a):N[1][1],d.push(Pc(x,l));break;case"PtgRef3d":y=N[1][1],x=Ac(N[1][2],c,a),b=rv(n,y,a),d.push(b+"!"+Pc(x,l));break;case"PtgFunc":case"PtgFuncVar":var U=N[1][0],K=N[1][1];U||(U=0),U&=127;var B=U==0?[]:d.slice(-U);d.length-=U,K==="User"&&(K=B.shift()),d.push(K+"("+B.join(",")+")");break;case"PtgBool":d.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(N[1]);break;case"PtgNum":d.push(String(N[1]));break;case"PtgStr":d.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(N[1]);break;case"PtgAreaN":E=Rg(N[1][1],t?{s:t}:c,a),d.push(zh(E,a));break;case"PtgArea":E=Rg(N[1][1],c,a),d.push(zh(E,a));break;case"PtgArea3d":y=N[1][1],E=N[1][2],b=rv(n,y,a),d.push(b+"!"+zh(E,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":k=N[1][2];var D=(n.names||[])[k-1]||(n[0]||[])[k],te=D?D.Name:"SH33TJSNAME"+String(k);te&&te.slice(0,6)=="_xlfn."&&!a.xlfn&&(te=te.slice(6)),d.push(te);break;case"PtgNameX":var ee=N[1][1];k=N[1][2];var ve;if(a.biff<=5)ee<0&&(ee=-ee),n[ee]&&(ve=n[ee][k]);else{var me="";if(((n[ee]||[])[0]||[])[0]==14849||(((n[ee]||[])[0]||[])[0]==1025?n[ee][k]&&n[ee][k].itab>0&&(me=n.SheetNames[n[ee][k].itab-1]+"!"):me=n.SheetNames[k-1]+"!"),n[ee]&&n[ee][k])me+=n[ee][k].Name;else if(n[0]&&n[0][k])me+=n[0][k].Name;else{var J=(E1(n,ee,a)||"").split(";;");J[k-1]?me=J[k-1]:me+="SH33TJSERRX"}d.push(me);break}ve||(ve={Name:"SH33TJSERRY"}),d.push(ve.Name);break;case"PtgParen":var ce="(",ke=")";if(S>=0){switch(A="",e[0][S][1][0]){case 2:ce=vr(" ",e[0][S][1][1])+ce;break;case 3:ce=vr("\r",e[0][S][1][1])+ce;break;case 4:ke=vr(" ",e[0][S][1][1])+ke;break;case 5:ke=vr("\r",e[0][S][1][1])+ke;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][S][1][0])}S=-1}d.push(ce+d.pop()+ke);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":x={c:N[1][1],r:N[1][0]};var se={c:t.c,r:t.r};if(n.sharedf[kt(x)]){var ue=n.sharedf[kt(x)];d.push(on(ue,c,se,n,a))}else{var j=!1;for(m=0;m!=n.arrayf.length;++m)if(v=n.arrayf[m],!(x.c<v[0].s.c||x.c>v[0].e.c)&&!(x.r<v[0].s.r||x.r>v[0].e.r)){d.push(on(v[1],c,se,n,a)),j=!0;break}j||d.push(N[1])}break;case"PtgArray":d.push("{"+ZT(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=R;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var G=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&S>=0&&G.indexOf(e[0][R][0])==-1){N=e[0][S];var Z=!0;switch(N[1][0]){case 4:Z=!1;case 0:A=vr(" ",N[1][1]);break;case 5:Z=!1;case 1:A=vr("\r",N[1][1]);break;default:if(A="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}d.push((Z?A:"")+d.pop()+(Z?"":A)),S=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return d[0]}function YT(e,r,t){var n=e.l+r,a=t.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],dn(e,r-2)];var d=ru(e,c,t);return r!==c+a&&(l=tu(e,r-c-a,d,t)),e.l=n,[d,l]}function XT(e,r,t){var n=e.l+r,a=t.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],dn(e,r-2)];var d=ru(e,c,t);return r!==c+a&&(l=tu(e,r-c-a,d,t)),e.l=n,[d,l]}function JT(e,r,t,n){var a=e.l+r,l=ru(e,n,t),c;return a!==e.l&&(c=tu(e,a-e.l,l,t)),[l,c]}function QT(e,r,t){var n=e.l+r,a,l=e.read_shift(2),c=ru(e,l,t);return l==65535?[[],dn(e,r-2)]:(r!==l+2&&(a=tu(e,n-l-2,c,t)),[c,a])}function eE(e){var r;if(Pi(e,e.l+6)!==65535)return[ln(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Wh(e,r,t){var n=e.l+r,a=ai(e);t.biff==2&&++e.l;var l=eE(e),c=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var d=XT(e,n-e.l,t);return{cell:a,val:l[0],formula:d,shared:c>>3&1,tt:l[1]}}function sf(e,r,t){var n=e.read_shift(4),a=ru(e,n,t),l=e.read_shift(4),c=l>0?tu(e,l,a,t):null;return[a,c]}var tE=sf,of=sf,rE=sf,nE=sf,aE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},C1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},iE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function nv(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Vh(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Oc={},kl={};function Fc(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function A1(e,r,t,n,a,l){try{n.cellNF&&(e.z=Tt[r])}catch(d){if(n.WTF)throw d}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Hr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Tt[r]==null&&io(sw[r]||"General",r),e.t==="e")e.w=e.w||vo[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zc(e.v);else if(e.t==="d"){var c=bn(e.v);(c|0)===c?e.w=c.toString(10):e.w=zc(c)}else{if(e.v===void 0)return"";e.w=co(e.v,kl)}else e.t==="d"?e.w=ha(r,bn(e.v),kl):e.w=ha(r,e.v,kl)}catch(d){if(n.WTF)throw d}if(n.cellStyles&&t!=null)try{e.s=l.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Zd(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Zd(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(n.WTF&&l.Fills)throw d}}}function sE(e,r){var t=xr(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Lt(t))}var oE=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,lE=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,cE=/<(?:\w:)?hyperlink [^>]*>/mg,uE=/"(\w*:\w*)"/,dE=/<(?:\w:)?col\b[^>]*[\/]?>/g,fE=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,hE=/<(?:\w:)?pageMargins[^>]*\/>/g,P1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,mE=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,pE=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function gE(e,r,t,n,a,l,c){if(!e)return e;n||(n={"!id":{}});var d=r.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},v="",x="",y=e.match(lE);y?(v=e.slice(0,y.index),x=e.slice(y.index+y[0].length)):v=x=e;var k=v.match(P1);k?am(k[0],d,a,t):(k=v.match(mE))&&vE(k[0],k[1]||"",d,a,t);var E=(v.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var b=v.slice(E,E+50).match(uE);b&&sE(d,b[1])}var S=v.match(pE);S&&S[1]&&bE(S[1],a);var A=[];if(r.cellStyles){var R=v.match(dE);R&&_E(A,R)}y&&SE(y[1],d,r,m,l,c);var O=x.match(fE);O&&(d["!autofilter"]=wE(O[0]));var N=[],U=x.match(oE);if(U)for(E=0;E!=U.length;++E)N[E]=xr(U[E].slice(U[E].indexOf('"')+1));var K=x.match(cE);K&&xE(d,K,n);var B=x.match(hE);if(B&&(d["!margins"]=yE(mt(B[0]))),!d["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(d["!ref"]=Lt(m)),r.sheetRows>0&&d["!ref"]){var D=xr(d["!ref"]);r.sheetRows<=+D.e.r&&(D.e.r=r.sheetRows-1,D.e.r>m.e.r&&(D.e.r=m.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>m.e.c&&(D.e.c=m.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Lt(D))}return A.length>0&&(d["!cols"]=A),N.length>0&&(d["!merges"]=N),d}function am(e,r,t,n){var a=mt(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=jt(tr(a.codeName)))}function vE(e,r,t,n,a){am(e.slice(0,e.indexOf(">")),t,n,a)}function xE(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var l=mt(tr(r[a]),!0);if(!l.ref)return;var c=((t||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+jt(l.location))):(l.Target="#"+jt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var d=xr(l.ref),m=d.s.r;m<=d.e.r;++m)for(var v=d.s.c;v<=d.e.c;++v){var x=kt({c:v,r:m});n?(e[m]||(e[m]=[]),e[m][v]||(e[m][v]={t:"z",v:void 0}),e[m][v].l=l):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=l)}}}function yE(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function _E(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=mt(r[n],!0);a.hidden&&(a.hidden=cr(a.hidden));var l=parseInt(a.min,10)-1,c=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,rm(a.width)),Sl(a);l<=c;)e[l++]=qr(a)}}function wE(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var kE=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bE(e,r){r.Views||(r.Views=[{}]),(e.match(kE)||[]).forEach(function(t,n){var a=mt(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),cr(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var SE=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,l=Uc("v"),c=Uc("f");return function(m,v,x,y,k,E){for(var b=0,S="",A=[],R=[],O=0,N=0,U=0,K="",B,D,te=0,ee=0,ve,me,J=0,ce=0,ke=Array.isArray(E.CellXf),se,ue=[],j=[],G=Array.isArray(v),Z=[],oe={},I=!1,P=!!x.sheetStubs,F=m.split(r),M=0,H=F.length;M!=H;++M){S=F[M].trim();var X=S.length;if(X!==0){var fe=0;e:for(b=0;b<X;++b)switch(S[b]){case">":if(S[b-1]!="/"){++b;break e}if(x&&x.cellStyles){if(D=mt(S.slice(fe,b),!0),te=D.r!=null?parseInt(D.r,10):te+1,ee=-1,x.sheetRows&&x.sheetRows<te)continue;oe={},I=!1,D.ht&&(I=!0,oe.hpt=parseFloat(D.ht),oe.hpx=Hc(oe.hpt)),D.hidden=="1"&&(I=!0,oe.hidden=!0),D.outlineLevel!=null&&(I=!0,oe.level=+D.outlineLevel),I&&(Z[te-1]=oe)}break;case"<":fe=b;break}if(fe>=b)break;if(D=mt(S.slice(fe,b),!0),te=D.r!=null?parseInt(D.r,10):te+1,ee=-1,!(x.sheetRows&&x.sheetRows<te)){y.s.r>te-1&&(y.s.r=te-1),y.e.r<te-1&&(y.e.r=te-1),x&&x.cellStyles&&(oe={},I=!1,D.ht&&(I=!0,oe.hpt=parseFloat(D.ht),oe.hpx=Hc(oe.hpt)),D.hidden=="1"&&(I=!0,oe.hidden=!0),D.outlineLevel!=null&&(I=!0,oe.level=+D.outlineLevel),I&&(Z[te-1]=oe)),A=S.slice(b).split(e);for(var ge=0;ge!=A.length&&A[ge].trim().charAt(0)=="<";++ge);for(A=A.slice(ge),b=0;b!=A.length;++b)if(S=A[b].trim(),S.length!==0){if(R=S.match(t),O=b,N=0,U=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,R!=null&&R.length===2){for(O=0,K=R[1],N=0;N!=K.length&&!((U=K.charCodeAt(N)-64)<1||U>26);++N)O=26*O+U;--O,ee=O}else++ee;for(N=0;N!=S.length&&S.charCodeAt(N)!==62;++N);if(++N,D=mt(S.slice(0,N),!0),D.r||(D.r=kt({r:te-1,c:ee})),K=S.slice(N),B={t:""},(R=K.match(l))!=null&&R[1]!==""&&(B.v=jt(R[1])),x.cellFormula){if((R=K.match(c))!=null&&R[1]!==""){if(B.f=jt(tr(R[1])).replace(/\r\n/g,`
`),x.xlfn||(B.f=Qg(B.f)),R[0].indexOf('t="array"')>-1)B.F=(K.match(a)||[])[1],B.F.indexOf(":")>-1&&ue.push([xr(B.F),B.F]);else if(R[0].indexOf('t="shared"')>-1){me=mt(R[0]);var ye=jt(tr(R[1]));x.xlfn||(ye=Qg(ye)),j[parseInt(me.si,10)]=[me,ye,D.r]}}else(R=K.match(/<f[^>]*\/>/))&&(me=mt(R[0]),j[me.si]&&(B.f=L2(j[me.si][1],j[me.si][2],D.r)));var xe=wn(D.r);for(N=0;N<ue.length;++N)xe.r>=ue[N][0].s.r&&xe.r<=ue[N][0].e.r&&xe.c>=ue[N][0].s.c&&xe.c<=ue[N][0].e.c&&(B.F=ue[N][1])}if(D.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(P)B.t="z";else continue;else B.t=D.t||"n";switch(y.s.c>ee&&(y.s.c=ee),y.e.c<ee&&(y.e.c=ee),B.t){case"n":if(B.v==""||B.v==null){if(!P)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!P)continue;B.t="z"}else ve=Oc[parseInt(B.v,10)],B.v=ve.t,B.r=ve.r,x.cellHTML&&(B.h=ve.h);break;case"str":B.t="s",B.v=B.v!=null?tr(B.v):"",x.cellHTML&&(B.h=H0(B.v));break;case"inlineStr":R=K.match(n),B.t="s",R!=null&&(ve=tm(R[1]))?(B.v=ve.t,x.cellHTML&&(B.h=ve.h)):B.v="";break;case"b":B.v=cr(B.v);break;case"d":x.cellDates?B.v=Hr(B.v,1):(B.v=bn(Hr(B.v,1)),B.t="n");break;case"e":(!x||x.cellText!==!1)&&(B.w=B.v),B.v=Yx[B.v];break}if(J=ce=0,se=null,ke&&D.s!==void 0&&(se=E.CellXf[D.s],se!=null&&(se.numFmtId!=null&&(J=se.numFmtId),x.cellStyles&&se.fillId!=null&&(ce=se.fillId))),A1(B,J,ce,x,k,E),x.cellDates&&ke&&B.t=="n"&&Cl(Tt[J])&&(B.t="d",B.v=nf(B.v)),D.cm&&x.xlmeta){var ze=(x.xlmeta.Cell||[])[+D.cm-1];ze&&ze.type=="XLDAPR"&&(B.D=!0)}if(G){var ne=wn(D.r);v[ne.r]||(v[ne.r]=[]),v[ne.r][ne.c]=B}else v[D.r]=B}}}}Z.length>0&&(v["!rows"]=Z)}})();function TE(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=a/20),t}var EE=go;function CE(){}function AE(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=Yw(e),t}function PE(e){var r=ma(e);return[r]}function NE(e){var r=po(e);return[r]}function IE(e){var r=ma(e),t=e.read_shift(1);return[r,t,"b"]}function DE(e){var r=po(e),t=e.read_shift(1);return[r,t,"b"]}function OE(e){var r=ma(e),t=e.read_shift(1);return[r,t,"e"]}function FE(e){var r=po(e),t=e.read_shift(1);return[r,t,"e"]}function LE(e){var r=ma(e),t=e.read_shift(4);return[r,t,"s"]}function RE(e){var r=po(e),t=e.read_shift(4);return[r,t,"s"]}function jE(e){var r=ma(e),t=ln(e);return[r,t,"n"]}function N1(e){var r=po(e),t=ln(e);return[r,t,"n"]}function ME(e){var r=ma(e),t=J0(e);return[r,t,"n"]}function BE(e){var r=po(e),t=J0(e);return[r,t,"n"]}function zE(e){var r=ma(e),t=Y0(e);return[r,t,"is"]}function UE(e){var r=ma(e),t=un(e);return[r,t,"str"]}function $E(e){var r=po(e),t=un(e);return[r,t,"str"]}function WE(e,r,t){var n=e.l+r,a=ma(e);a.r=t["!row"];var l=e.read_shift(1),c=[a,l,"b"];if(t.cellFormula){e.l+=2;var d=of(e,n-e.l,t);c[3]=on(d,null,a,t.supbooks,t)}else e.l=n;return c}function VE(e,r,t){var n=e.l+r,a=ma(e);a.r=t["!row"];var l=e.read_shift(1),c=[a,l,"e"];if(t.cellFormula){e.l+=2;var d=of(e,n-e.l,t);c[3]=on(d,null,a,t.supbooks,t)}else e.l=n;return c}function HE(e,r,t){var n=e.l+r,a=ma(e);a.r=t["!row"];var l=ln(e),c=[a,l,"n"];if(t.cellFormula){e.l+=2;var d=of(e,n-e.l,t);c[3]=on(d,null,a,t.supbooks,t)}else e.l=n;return c}function GE(e,r,t){var n=e.l+r,a=ma(e);a.r=t["!row"];var l=un(e),c=[a,l,"str"];if(t.cellFormula){e.l+=2;var d=of(e,n-e.l,t);c[3]=on(d,null,a,t.supbooks,t)}else e.l=n;return c}var ZE=go;function KE(e,r){var t=e.l+r,n=go(e),a=X0(e),l=un(e),c=un(e),d=un(e);e.l=t;var m={rfx:n,relId:a,loc:l,display:d};return c&&(m.Tooltip=c),m}function qE(){}function YE(e,r,t){var n=e.l+r,a=Zx(e),l=e.read_shift(1),c=[a];if(c[2]=l,t.cellFormula){var d=tE(e,n-e.l,t);c[1]=d}else e.l=n;return c}function XE(e,r,t){var n=e.l+r,a=go(e),l=[a];if(t.cellFormula){var c=nE(e,n-e.l,t);l[1]=c,e.l=n}else e.l=n;return l}var JE=["left","right","top","bottom","header","footer"];function QE(e){var r={};return JE.forEach(function(t){r[t]=ln(e)}),r}function eC(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function tC(){}function rC(){}function nC(e,r,t,n,a,l,c){if(!e)return e;var d=r||{};n||(n={"!id":{}});var m=d.dense?[]:{},v,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,k=!1,E,b,S,A,R,O,N,U,K,B=[];d.biff=12,d["!row"]=0;var D=0,te=!1,ee=[],ve={},me=d.supbooks||a.supbooks||[[]];if(me.sharedf=ve,me.arrayf=ee,me.SheetNames=a.SheetNames||a.Sheets.map(function(G){return G.name}),!d.supbooks&&(d.supbooks=me,a.Names))for(var J=0;J<a.Names.length;++J)me[0][J+1]=a.Names[J];var ce=[],ke=[],se=!1;Yd[16]={n:"BrtShortReal",f:N1};var ue;if(Oi(e,function(Z,oe,I){if(!k)switch(I){case 148:v=Z;break;case 0:E=Z,d.sheetRows&&d.sheetRows<=E.r&&(k=!0),U=Yr(A=E.r),d["!row"]=E.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=Hc(Z.hpt)),ke[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:Z[2]},Z[2]){case"n":b.v=Z[1];break;case"s":N=Oc[Z[1]],b.v=N.t,b.r=N.r;break;case"b":b.v=!!Z[1];break;case"e":b.v=Z[1],d.cellText!==!1&&(b.w=vo[b.v]);break;case"str":b.t="s",b.v=Z[1];break;case"is":b.t="s",b.v=Z[1].t;break}if((S=c.CellXf[Z[0].iStyleRef])&&A1(b,S.numFmtId,null,d,l,c),R=Z[0].c==-1?R+1:Z[0].c,d.dense?(m[A]||(m[A]=[]),m[A][R]=b):m[Rr(R)+U]=b,d.cellFormula){for(te=!1,D=0;D<ee.length;++D){var P=ee[D];E.r>=P[0].s.r&&E.r<=P[0].e.r&&R>=P[0].s.c&&R<=P[0].e.c&&(b.F=Lt(P[0]),te=!0)}!te&&Z.length>3&&(b.f=Z[3])}if(x.s.r>E.r&&(x.s.r=E.r),x.s.c>R&&(x.s.c=R),x.e.r<E.r&&(x.e.r=E.r),x.e.c<R&&(x.e.c=R),d.cellDates&&S&&b.t=="n"&&Cl(Tt[S.numFmtId])){var F=ao(b.v);F&&(b.t="d",b.v=new Date(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u))}ue&&(ue.type=="XLDAPR"&&(b.D=!0),ue=void 0);break;case 1:case 12:if(!d.sheetStubs||y)break;b={t:"z",v:void 0},R=Z[0].c==-1?R+1:Z[0].c,d.dense?(m[A]||(m[A]=[]),m[A][R]=b):m[Rr(R)+U]=b,x.s.r>E.r&&(x.s.r=E.r),x.s.c>R&&(x.s.c=R),x.e.r<E.r&&(x.e.r=E.r),x.e.c<R&&(x.e.c=R),ue&&(ue.type=="XLDAPR"&&(b.D=!0),ue=void 0);break;case 176:B.push(Z);break;case 49:ue=((d.xlmeta||{}).Cell||[])[Z-1];break;case 494:var M=n["!id"][Z.relId];for(M?(Z.Target=M.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=M):Z.relId==""&&(Z.Target="#"+Z.loc),A=Z.rfx.s.r;A<=Z.rfx.e.r;++A)for(R=Z.rfx.s.c;R<=Z.rfx.e.c;++R)d.dense?(m[A]||(m[A]=[]),m[A][R]||(m[A][R]={t:"z",v:void 0}),m[A][R].l=Z):(O=kt({c:R,r:A}),m[O]||(m[O]={t:"z",v:void 0}),m[O].l=Z);break;case 426:if(!d.cellFormula)break;ee.push(Z),K=d.dense?m[A][R]:m[Rr(R)+U],K.f=on(Z[1],x,{r:E.r,c:R},me,d),K.F=Lt(Z[0]);break;case 427:if(!d.cellFormula)break;ve[kt(Z[0].s)]=Z[1],K=d.dense?m[A][R]:m[Rr(R)+U],K.f=on(Z[1],x,{r:E.r,c:R},me,d);break;case 60:if(!d.cellStyles)break;for(;Z.e>=Z.s;)ce[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},se||(se=!0,rm(Z.w/256)),Sl(ce[Z.e+1]);break;case 161:m["!autofilter"]={ref:Lt(Z)};break;case 476:m["!margins"]=Z;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),Z.name&&(a.Sheets[t].CodeName=Z.name),(Z.above||Z.left)&&(m["!outline"]={above:Z.above,left:Z.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Z.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!oe.T){if(!y||d.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}},d),delete d.supbooks,delete d["!row"],!m["!ref"]&&(x.s.r<2e6||v&&(v.e.r>0||v.e.c>0||v.s.r>0||v.s.c>0))&&(m["!ref"]=Lt(v||x)),d.sheetRows&&m["!ref"]){var j=xr(m["!ref"]);d.sheetRows<=+j.e.r&&(j.e.r=d.sheetRows-1,j.e.r>x.e.r&&(j.e.r=x.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>x.e.c&&(j.e.c=x.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),m["!fullref"]=m["!ref"],m["!ref"]=Lt(j))}return B.length>0&&(m["!merges"]=B),ce.length>0&&(m["!cols"]=ce),ke.length>0&&(m["!rows"]=ke),m}function aC(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(r[+c[1]]=t?+c[2]:c[2])});var a=jt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[r,a,n]}function iC(e,r,t,n,a,l){var c=l||{"!type":"chart"};if(!e)return l;var d=0,m=0,v="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var k=aC(y);x.s.r=x.s.c=0,x.e.c=d,v=Rr(d),k[0].forEach(function(E,b){c[v+Yr(b)]={t:"n",v:E,z:k[1]},m=b}),x.e.r<m&&(x.e.r=m),++d}),d>0&&(c["!ref"]=Lt(x)),c}function sC(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,d=e.match(P1);return d&&am(d[0],l,a,t),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function oC(e,r){e.l+=10;var t=un(e);return{name:t}}function lC(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Oi(e,function(m,v,x){switch(x){case 550:l["!rel"]=m;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),m.name&&(a.Sheets[t].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(v.T>0)){if(!(v.T<0)){if(!c||r.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},r),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var I1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],cC=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],uC=[],dC=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function av(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var l=r[a];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=cr(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function iv(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=cr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function D1(e){iv(e.WBProps,I1),iv(e.CalcPr,dC),av(e.WBView,cC),av(e.Sheets,uC),kl.date1904=cr(e.WBProps.date1904)}var fC="][*?/\\".split("");function hC(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return fC.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var mC=/<\w+:workbook/;function pC(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",l={},c=0;if(e.replace(fn,function(m,v){var x=mt(m);switch(ni(x[0])){case"<?xml":break;case"<workbook":m.match(mC)&&(a="xmlns"+m.match(/<(\w+):/)[1]),t.xmlns=x[a];break;case"</workbook>":break;case"<fileVersion":delete x[0],t.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":I1.forEach(function(y){if(x[y[0]]!=null)switch(y[2]){case"bool":t.WBProps[y[0]]=cr(x[y[0]]);break;case"int":t.WBProps[y[0]]=parseInt(x[y[0]],10);break;default:t.WBProps[y[0]]=x[y[0]]}}),x.codeName&&(t.WBProps.CodeName=tr(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],t.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=jt(tr(x.name)),delete x[0],t.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=tr(x.name),x.comment&&(l.Comment=x.comment),x.localSheetId&&(l.Sheet=+x.localSheetId),cr(x.hidden||"0")&&(l.Hidden=!0),c=v+m.length;break;case"</definedName>":l.Ref=jt(tr(e.slice(c,v))),t.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete x[0],t.CalcPr=x;break;case"<calcPr/>":delete x[0],t.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return m}),Ow.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return D1(t),t}function gC(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=f0(e),t.name=un(e),t}function vC(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?un(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function xC(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function yC(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),l=Xw(e),c=rE(e,0,t),d=X0(e);e.l=n;var m={Name:l,Ptg:c};return a<268435455&&(m.Sheet=a),d&&(m.Comment=d),m}function _C(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],Yd[16]={n:"BrtFRTArchID$",f:xC},Oi(e,function(m,v,x){switch(x){case 156:c.SheetNames.push(m.name),t.Sheets.push(m);break;case 153:t.WBProps=m;break;case 39:m.Sheet!=null&&(r.SID=m.Sheet),m.Ref=on(m.Ptg,null,null,c,r),delete r.SID,delete m.Ptg,l.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([x,m]):c[0]=[x,m],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(m),c.XTI=c.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(x),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(x),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!v.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},r),D1(t),t.Names=l,t.supbooks=c,t}function wC(e,r,t){return r.slice(-4)===".bin"?_C(e,t):pC(e,t)}function kC(e,r,t,n,a,l,c,d){return r.slice(-4)===".bin"?nC(e,n,t,a,l,c,d):gE(e,n,t,a,l,c,d)}function bC(e,r,t,n,a,l,c,d){return r.slice(-4)===".bin"?lC(e,n,t,a,l):sC(e,n,t,a,l)}function SC(e,r,t,n,a,l,c,d){return r.slice(-4)===".bin"?D2():O2()}function TC(e,r,t,n,a,l,c,d){return r.slice(-4)===".bin"?N2():I2()}function EC(e,r,t,n){return r.slice(-4)===".bin"?ZS(e,t,n):US(e,t,n)}function CC(e,r,t){return x1(e,t)}function AC(e,r,t){return r.slice(-4)===".bin"?cS(e,t):oS(e,t)}function PC(e,r,t){return r.slice(-4)===".bin"?C2(e,t):k2(e,t)}function NC(e,r,t){return r.slice(-4)===".bin"?y2(e):v2(e)}function IC(e,r,t,n){return t.slice(-4)===".bin"?_2(e,r,t,n):void 0}function DC(e,r,t){return r.slice(-4)===".bin"?p2(e,r,t):g2(e,r,t)}var O1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,F1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Aa(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(O1),l,c,d,m;if(a)for(m=0;m!=a.length;++m)l=a[m].match(F1),(c=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?d="xmlns"+l[1].slice(6):d=l[1].slice(c+1),n[d]=l[2].slice(1,l[2].length-1));return n}function OC(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(O1),a,l,c,d;if(n)for(d=0;d!=n.length;++d)a=n[d].match(F1),(l=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(l+1),t[c]=a[2].slice(1,a[2].length-1));return t}var Lc;function FC(e,r){var t=Lc[e]||jt(e);return t==="General"?co(r):ha(t,r)}function LC(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=cr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[jt(r)]=a}function RC(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zc(e.v):e.w=co(e.v):e.w=FC(r||"General",e.v)}catch(l){if(t.WTF)throw l}try{var n=Lc[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Cl(n)){var a=ao(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(l){if(t.WTF)throw l}}}function jC(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=LS[n.Pattern]||n.Pattern)}e[r.ID]=r}function MC(e,r,t,n,a,l,c,d,m,v){var x="General",y=n.StyleID,k={};v=v||{};var E=[],b=0;for(y===void 0&&d&&(y=d.StyleID),y===void 0&&c&&(y=c.StyleID);l[y]!==void 0&&(l[y].nf&&(x=l[y].nf),l[y].Interior&&E.push(l[y].Interior),!!l[y].Parent);)y=l[y].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=cr(e);break;case"String":n.t="s",n.r=Cg(jt(e)),n.v=e.indexOf("<")>-1?jt(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Hr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=jt(e):n.v<60&&(n.v=n.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Yx[e],v.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=Cg(r||e));break}if(RC(n,x,v),v.cellFormula!==!1)if(n.Formula){var S=jt(n.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),n.f=wl(S,a),delete n.Formula,n.ArrayRange=="RC"?n.F=wl("RC:RC",a):n.ArrayRange&&(n.F=wl(n.ArrayRange,a),m.push([xr(n.F),n.F]))}else for(b=0;b<m.length;++b)a.r>=m[b][0].s.r&&a.r<=m[b][0].e.r&&a.c>=m[b][0].s.c&&a.c<=m[b][0].e.c&&(n.F=m[b][1]);v.cellStyles&&(E.forEach(function(A){!k.patternType&&A.patternType&&(k.patternType=A.patternType)}),n.s=k),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function BC(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Hh(e,r){var t=r||{};kx();var n=wc(G0(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=tr(n));var a=n.slice(0,1024).toLowerCase(),l=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var c=qr(t);return c.type="string",Wc.to_workbook(n,c)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(It){a.indexOf("<"+It)>=0&&(l=!0)}),l)return KC(n,t);Lc={"General Number":"General","General Date":Tt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Tt[15],"Short Date":Tt[14],"Long Time":Tt[19],"Medium Time":Tt[18],"Short Time":Tt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Tt[2],Standard:Tt[4],Percent:Tt[10],Scientific:Tt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,m=[],v,x={},y=[],k=t.dense?[]:{},E="",b={},S={},A=Aa('<Data ss:Type="String">'),R=0,O=0,N=0,U={s:{r:2e6,c:2e6},e:{r:0,c:0}},K={},B={},D="",te=0,ee=[],ve={},me={},J=0,ce=[],ke=[],se={},ue=[],j,G=!1,Z=[],oe=[],I={},P=0,F=0,M={Sheets:[],WBProps:{date1904:!1}},H={};$c.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";d=$c.exec(n);)switch(d[3]=(X=d[3]).toLowerCase()){case"data":if(X=="data"){if(d[1]==="/"){if((v=m.pop())[0]!==d[3])throw new Error("Bad state: "+v.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break}if(m[m.length-1][1])break;d[1]==="/"?MC(n.slice(R,d.index),D,A,m[m.length-1][0]=="comment"?se:b,{c:O,r:N},K,ue[O],S,Z,t):(D="",A=Aa(d[0]),R=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(ke.length>0&&(b.c=ke),(!t.sheetRows||t.sheetRows>N)&&b.v!==void 0&&(t.dense?(k[N]||(k[N]=[]),k[N][O]=b):k[Rr(O)+Yr(N)]=b),b.HRef&&(b.l={Target:jt(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(P=O+(parseInt(b.MergeAcross,10)|0),F=N+(parseInt(b.MergeDown,10)|0),ee.push({s:{c:O,r:N},e:{c:P,r:F}})),!t.sheetStubs)b.MergeAcross?O=P+1:++O;else if(b.MergeAcross||b.MergeDown){for(var fe=O;fe<=P;++fe)for(var ge=N;ge<=F;++ge)(fe>O||ge>N)&&(t.dense?(k[ge]||(k[ge]=[]),k[ge][fe]={t:"z"}):k[Rr(fe)+Yr(ge)]={t:"z"});O=P+1}else++O;else b=OC(d[0]),b.Index&&(O=+b.Index-1),O<U.s.c&&(U.s.c=O),O>U.e.c&&(U.e.c=O),d[0].slice(-2)==="/>"&&++O,ke=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(N<U.s.r&&(U.s.r=N),N>U.e.r&&(U.e.r=N),d[0].slice(-2)==="/>"&&(S=Aa(d[0]),S.Index&&(N=+S.Index-1)),O=0,++N):(S=Aa(d[0]),S.Index&&(N=+S.Index-1),I={},(S.AutoFitHeight=="0"||S.Height)&&(I.hpx=parseInt(S.Height,10),I.hpt=v1(I.hpx),oe[N]=I),S.Hidden=="1"&&(I.hidden=!0,oe[N]=I));break;case"worksheet":if(d[1]==="/"){if((v=m.pop())[0]!==d[3])throw new Error("Bad state: "+v.join("|"));y.push(E),U.s.r<=U.e.r&&U.s.c<=U.e.c&&(k["!ref"]=Lt(U),t.sheetRows&&t.sheetRows<=U.e.r&&(k["!fullref"]=k["!ref"],U.e.r=t.sheetRows-1,k["!ref"]=Lt(U))),ee.length&&(k["!merges"]=ee),ue.length>0&&(k["!cols"]=ue),oe.length>0&&(k["!rows"]=oe),x[E]=k}else U={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=O=0,m.push([d[3],!1]),v=Aa(d[0]),E=jt(v.Name),k=t.dense?[]:{},ee=[],Z=[],oe=[],H={name:E,Hidden:0},M.Sheets.push(H);break;case"table":if(d[1]==="/"){if((v=m.pop())[0]!==d[3])throw new Error("Bad state: "+v.join("|"))}else{if(d[0].slice(-2)=="/>")break;m.push([d[3],!1]),ue=[],G=!1}break;case"style":d[1]==="/"?jC(K,B,t):B=Aa(d[0]);break;case"numberformat":B.nf=jt(Aa(d[0]).Format||"General"),Lc[B.nf]&&(B.nf=Lc[B.nf]);for(var ye=0;ye!=392&&Tt[ye]!=B.nf;++ye);if(ye==392){for(ye=57;ye!=392;++ye)if(Tt[ye]==null){io(B.nf,ye);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(j=Aa(d[0]),j.Hidden&&(j.hidden=!0,delete j.Hidden),j.Width&&(j.wpx=parseInt(j.Width,10)),!G&&j.wpx>10){G=!0,_n=p1;for(var xe=0;xe<ue.length;++xe)ue[xe]&&Sl(ue[xe])}G&&Sl(j),ue[j.Index-1||ue.length]=j;for(var ze=0;ze<+j.Span;++ze)ue[ue.length]=qr(j);break;case"namedrange":if(d[1]==="/")break;M.Names||(M.Names=[]);var ne=mt(d[0]),xt={Name:ne.Name,Ref:wl(ne.RefersTo.slice(1),{r:0,c:0})};M.Sheets.length>0&&(xt.Sheet=M.Sheets.length-1),M.Names.push(xt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?D+=n.slice(te,d.index):te=d.index+d[0].length;break;case"interior":if(!t.cellStyles)break;B.Interior=Aa(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?kk(ve,X,n.slice(J,d.index)):J=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((v=m.pop())[0]!==d[3])throw new Error("Bad state: "+v.join("|"))}else m.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((v=m.pop())[0]!==d[3])throw new Error("Bad state: "+v.join("|"));BC(se),ke.push(se)}else m.push([d[3],!1]),v=Aa(d[0]),se={a:v.Author};break;case"autofilter":if(d[1]==="/"){if((v=m.pop())[0]!==d[3])throw new Error("Bad state: "+v.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var st=Aa(d[0]);k["!autofilter"]={ref:wl(st.Range).replace(/\$/g,"")},m.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((v=m.pop())[0]!==d[3])throw new Error("Bad state: "+v.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((v=m.pop())[0]!==d[3])throw new Error("Bad state: "+v.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"null":break;default:if(m.length==0&&d[3]=="document"||m.length==0&&d[3]=="uof")return dv(n,t);var wt=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:wt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:wt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":M.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:wt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:wt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(n.slice(J,d.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else J=d.index+d[0].length;break;case"header":k["!margins"]||Fc(k["!margins"]={},"xlml"),isNaN(+mt(d[0]).Margin)||(k["!margins"].header=+mt(d[0]).Margin);break;case"footer":k["!margins"]||Fc(k["!margins"]={},"xlml"),isNaN(+mt(d[0]).Margin)||(k["!margins"].footer=+mt(d[0]).Margin);break;case"pagemargins":var _t=mt(d[0]);k["!margins"]||Fc(k["!margins"]={},"xlml"),isNaN(+_t.Top)||(k["!margins"].top=+_t.Top),isNaN(+_t.Left)||(k["!margins"].left=+_t.Left),isNaN(+_t.Right)||(k["!margins"].right=+_t.Right),isNaN(+_t.Bottom)||(k["!margins"].bottom=+_t.Bottom);break;case"displayrighttoleft":M.Views||(M.Views=[]),M.Views[0]||(M.Views[0]={}),M.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":k["!outline"]||(k["!outline"]={}),k["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":k["!outline"]||(k["!outline"]={}),k["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:wt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:wt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:wt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:wt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:wt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:wt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:wt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:wt=!1}break;case"smarttags":break;default:wt=!1;break}if(wt||d[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?LC(me,X,ce,n.slice(J,d.index)):(ce=d,J=d.index+d[0].length);break}if(t.WTF)throw"Unrecognized tag: "+d[3]+"|"+m.join("|")}var $e={};return!t.bookSheets&&!t.bookProps&&($e.Sheets=x),$e.SheetNames=y,$e.Workbook=M,$e.SSF=qr(Tt),$e.Props=ve,$e.Custprops=me,$e}function g0(e,r){switch(om(r=r||{}),r.type||"base64"){case"base64":return Hh(Yn(e),r);case"binary":case"buffer":case"file":return Hh(e,r);case"array":return Hh(mo(e),r)}}function zC(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=ek(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=tk(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var UC=[60,1084,2066,2165,2175];function $C(e,r,t,n,a){var l=n,c=[],d=t.slice(t.l,t.l+l);if(a&&a.enc&&a.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(d)}c.push(d),t.l+=l;for(var m=Pi(t,t.l),v=v0[m],x=0;v!=null&&UC.indexOf(m)>-1;)l=Pi(t,t.l+2),x=t.l+4,m==2066?x+=4:(m==2165||m==2175)&&(x+=12),d=t.slice(x,t.l+4+l),c.push(d),t.l+=4+l,v=v0[m=Pi(t,t.l)];var y=ys(c);Kr(y,0);var k=0;y.lens=[];for(var E=0;E<c.length;++E)y.lens.push(k),k+=c[E].length;if(y.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+y.length+" < "+n;return r.f(y,y.length,a)}function Xa(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=Tt[n])}catch(l){if(r.WTF)throw l}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||vo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zc(e.v):e.w=co(e.v):e.w=ha(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(l){if(r.WTF)throw l}if(r.cellDates&&n&&e.t=="n"&&Cl(Tt[n]||String(n))){var a=ao(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function wd(e,r,t){return{v:e,ixfe:r,t}}function WC(e,r){var t={opts:{}},n={},a=r.dense?[]:{},l={},c={},d=null,m=[],v="",x={},y,k="",E,b,S,A,R={},O=[],N,U,K=[],B=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},te={},ee=function(ft){return ft<8?so[ft]:ft<64&&B[ft-8]||so[ft]},ve=function(ft,Dt,Br){var qt=Dt.XF.data;if(!(!qt||!qt.patternType||!Br||!Br.cellStyles)){Dt.s={},Dt.s.patternType=qt.patternType;var Xr;(Xr=Vc(ee(qt.icvFore)))&&(Dt.s.fgColor={rgb:Xr}),(Xr=Vc(ee(qt.icvBack)))&&(Dt.s.bgColor={rgb:Xr})}},me=function(ft,Dt,Br){if(!(I>1)&&!(Br.sheetRows&&ft.r>=Br.sheetRows)){if(Br.cellStyles&&Dt.XF&&Dt.XF.data&&ve(ft,Dt,Br),delete Dt.ixfe,delete Dt.XF,y=ft,k=kt(ft),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),ft.r<c.s.r&&(c.s.r=ft.r),ft.c<c.s.c&&(c.s.c=ft.c),ft.r+1>c.e.r&&(c.e.r=ft.r+1),ft.c+1>c.e.c&&(c.e.c=ft.c+1),Br.cellFormula&&Dt.f){for(var qt=0;qt<O.length;++qt)if(!(O[qt][0].s.c>ft.c||O[qt][0].s.r>ft.r)&&!(O[qt][0].e.c<ft.c||O[qt][0].e.r<ft.r)){Dt.F=Lt(O[qt][0]),(O[qt][0].s.c!=ft.c||O[qt][0].s.r!=ft.r)&&delete Dt.f,Dt.f&&(Dt.f=""+on(O[qt][1],c,ft,Z,J));break}}Br.dense?(a[ft.r]||(a[ft.r]=[]),a[ft.r][ft.c]=Dt):a[k]=Dt}},J={enc:!1,sbcch:0,snames:[],sharedf:R,arrayf:O,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(J.password=r.password);var ce,ke=[],se=[],ue=[],j=[],G=!1,Z=[];Z.SheetNames=J.snames,Z.sharedf=J.sharedf,Z.arrayf=J.arrayf,Z.names=[],Z.XTI=[];var oe=0,I=0,P=0,F=[],M=[],H;J.codepage=1200,Fa(1200);for(var X=!1;e.l<e.length-1;){var fe=e.l,ge=e.read_shift(2);if(ge===0&&oe===10)break;var ye=e.l===e.length?0:e.read_shift(2),xe=v0[ge];if(xe&&xe.f){if(r.bookSheets&&oe===133&&ge!==133)break;if(oe=ge,xe.r===2||xe.r==12){var ze=e.read_shift(2);if(ye-=2,!J.enc&&ze!==ge&&((ze&255)<<8|ze>>8)!==ge)throw new Error("rt mismatch: "+ze+"!="+ge);xe.r==12&&(e.l+=10,ye-=10)}var ne={};if(ge===10?ne=xe.f(e,ye,J):ne=$C(ge,xe,e,ye,J),I==0&&[9,521,1033,2057].indexOf(oe)===-1)continue;switch(ge){case 34:t.opts.Date1904=D.WBProps.date1904=ne;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(J.enc||(e.l=0),J.enc=ne,!r.password)throw new Error("File is password-protected");if(ne.valid==null)throw new Error("Encryption scheme unsupported");if(!ne.valid)throw new Error("Password is incorrect");break;case 92:J.lastuser=ne;break;case 66:var xt=Number(ne);switch(xt){case 21010:xt=1200;break;case 32768:xt=1e4;break;case 32769:xt=1252;break}Fa(J.codepage=xt),X=!0;break;case 317:J.rrtabid=ne;break;case 25:J.winlocked=ne;break;case 439:t.opts.RefreshAll=ne;break;case 12:t.opts.CalcCount=ne;break;case 16:t.opts.CalcDelta=ne;break;case 17:t.opts.CalcIter=ne;break;case 13:t.opts.CalcMode=ne;break;case 14:t.opts.CalcPrecision=ne;break;case 95:t.opts.CalcSaveRecalc=ne;break;case 15:J.CalcRefMode=ne;break;case 2211:t.opts.FullCalc=ne;break;case 129:ne.fDialog&&(a["!type"]="dialog"),ne.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),ne.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:K.push(ne);break;case 430:Z.push([ne]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(ne);break;case 24:case 536:H={Name:ne.Name,Ref:on(ne.rgce,c,null,Z,J)},ne.itab>0&&(H.Sheet=ne.itab-1),Z.names.push(H),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(ne),ne.Name=="_xlnm._FilterDatabase"&&ne.itab>0&&ne.rgce&&ne.rgce[0]&&ne.rgce[0][0]&&ne.rgce[0][0][0]=="PtgArea3d"&&(M[ne.itab-1]={ref:Lt(ne.rgce[0][0][1][2])});break;case 22:J.ExternCount=ne;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(ne),Z.XTI=Z.XTI.concat(ne);break;case 2196:if(J.biff<8)break;H!=null&&(H.Comment=ne[1]);break;case 18:a["!protect"]=ne;break;case 19:ne!==0&&J.WTF&&console.error("Password verifier: "+ne);break;case 133:l[ne.pos]=ne,J.snames.push(ne.name);break;case 10:{if(--I)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,a["!ref"]=Lt(c),r.sheetRows&&r.sheetRows<=c.e.r){var st=c.e.r;c.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Lt(c),c.e.r=st}c.e.r++,c.e.c++}ke.length>0&&(a["!merges"]=ke),se.length>0&&(a["!objects"]=se),ue.length>0&&(a["!cols"]=ue),j.length>0&&(a["!rows"]=j),D.Sheets.push(te)}v===""?x=a:n[v]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(J.biff===8&&(J.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ne.BIFFVer]||8),J.biffguess=ne.BIFFVer==0,ne.BIFFVer==0&&ne.dt==4096&&(J.biff=5,X=!0,Fa(J.codepage=28591)),J.biff==8&&ne.BIFFVer==0&&ne.dt==16&&(J.biff=2),I++)break;if(a=r.dense?[]:{},J.biff<8&&!X&&(X=!0,Fa(J.codepage=r.codepage||1252)),J.biff<5||ne.BIFFVer==0&&ne.dt==4096){v===""&&(v="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var wt={pos:e.l-ye,name:v};l[wt.pos]=wt,J.snames.push(v)}else v=(l[fe]||{name:""}).name;ne.dt==32&&(a["!type"]="chart"),ne.dt==64&&(a["!type"]="macro"),ke=[],se=[],J.arrayf=O=[],ue=[],j=[],G=!1,te={Hidden:(l[fe]||{hs:0}).hs,name:v}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[ne.r]||[])[ne.c]:a[kt({c:ne.c,r:ne.r})])&&++ne.c,N={ixfe:ne.ixfe,XF:K[ne.ixfe]||{},v:ne.val,t:"n"},P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me({c:ne.c,r:ne.r},N,r);break;case 5:case 517:N={ixfe:ne.ixfe,XF:K[ne.ixfe],v:ne.val,t:ne.t},P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me({c:ne.c,r:ne.r},N,r);break;case 638:N={ixfe:ne.ixfe,XF:K[ne.ixfe],v:ne.rknum,t:"n"},P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me({c:ne.c,r:ne.r},N,r);break;case 189:for(var _t=ne.c;_t<=ne.C;++_t){var $e=ne.rkrec[_t-ne.c][0];N={ixfe:$e,XF:K[$e],v:ne.rkrec[_t-ne.c][1],t:"n"},P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me({c:_t,r:ne.r},N,r)}break;case 6:case 518:case 1030:{if(ne.val=="String"){d=ne;break}if(N=wd(ne.val,ne.cell.ixfe,ne.tt),N.XF=K[N.ixfe],r.cellFormula){var It=ne.formula;if(It&&It[0]&&It[0][0]&&It[0][0][0]=="PtgExp"){var ur=It[0][0][1][0],rr=It[0][0][1][1],Zt=kt({r:ur,c:rr});R[Zt]?N.f=""+on(ne.formula,c,ne.cell,Z,J):N.F=((r.dense?(a[ur]||[])[rr]:a[Zt])||{}).F}else N.f=""+on(ne.formula,c,ne.cell,Z,J)}P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me(ne.cell,N,r),d=ne}break;case 7:case 519:if(d)d.val=ne,N=wd(ne,d.cell.ixfe,"s"),N.XF=K[N.ixfe],r.cellFormula&&(N.f=""+on(d.formula,c,d.cell,Z,J)),P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me(d.cell,N,r),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{O.push(ne);var Kt=kt(ne[0].s);if(E=r.dense?(a[ne[0].s.r]||[])[ne[0].s.c]:a[Kt],r.cellFormula&&E){if(!d||!Kt||!E)break;E.f=""+on(ne[1],c,ne[0],Z,J),E.F=Lt(ne[0])}}break;case 1212:{if(!r.cellFormula)break;if(k){if(!d)break;R[kt(d.cell)]=ne[0],E=r.dense?(a[d.cell.r]||[])[d.cell.c]:a[kt(d.cell)],(E||{}).f=""+on(ne[0],c,y,Z,J)}}break;case 253:N=wd(m[ne.isst].t,ne.ixfe,"s"),m[ne.isst].h&&(N.h=m[ne.isst].h),N.XF=K[N.ixfe],P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me({c:ne.c,r:ne.r},N,r);break;case 513:r.sheetStubs&&(N={ixfe:ne.ixfe,XF:K[ne.ixfe],t:"z"},P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me({c:ne.c,r:ne.r},N,r));break;case 190:if(r.sheetStubs)for(var yr=ne.c;yr<=ne.C;++yr){var or=ne.ixfe[yr-ne.c];N={ixfe:or,XF:K[or],t:"z"},P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me({c:yr,r:ne.r},N,r)}break;case 214:case 516:case 4:N=wd(ne.val,ne.ixfe,"s"),N.XF=K[N.ixfe],P>0&&(N.z=F[N.ixfe>>8&63]),Xa(N,r,t.opts.Date1904),me({c:ne.c,r:ne.r},N,r);break;case 0:case 512:I===1&&(c=ne);break;case 252:m=ne;break;case 1054:if(J.biff==4){F[P++]=ne[1];for(var nt=0;nt<P+163&&Tt[nt]!=ne[1];++nt);nt>=163&&io(ne[1],P+163)}else io(ne[1],ne[0]);break;case 30:{F[P++]=ne;for(var Mr=0;Mr<P+163&&Tt[Mr]!=ne;++Mr);Mr>=163&&io(ne,P+163)}break;case 229:ke=ke.concat(ne);break;case 93:se[ne.cmo[0]]=J.lastobj=ne;break;case 438:J.lastobj.TxO=ne;break;case 127:J.lastobj.ImData=ne;break;case 440:for(A=ne[0].s.r;A<=ne[0].e.r;++A)for(S=ne[0].s.c;S<=ne[0].e.c;++S)E=r.dense?(a[A]||[])[S]:a[kt({c:S,r:A})],E&&(E.l=ne[1]);break;case 2048:for(A=ne[0].s.r;A<=ne[0].e.r;++A)for(S=ne[0].s.c;S<=ne[0].e.c;++S)E=r.dense?(a[A]||[])[S]:a[kt({c:S,r:A})],E&&E.l&&(E.l.Tooltip=ne[1]);break;case 28:{if(J.biff<=5&&J.biff>=2)break;E=r.dense?(a[ne[0].r]||[])[ne[0].c]:a[kt(ne[0])];var Sn=se[ne[2]];E||(r.dense?(a[ne[0].r]||(a[ne[0].r]=[]),E=a[ne[0].r][ne[0].c]={t:"z"}):E=a[kt(ne[0])]={t:"z"},c.e.r=Math.max(c.e.r,ne[0].r),c.s.r=Math.min(c.s.r,ne[0].r),c.e.c=Math.max(c.e.c,ne[0].c),c.s.c=Math.min(c.s.c,ne[0].c)),E.c||(E.c=[]),b={a:ne[1],t:Sn.TxO.t},E.c.push(b)}break;case 2173:d2(K[ne.ixfe],ne.ext);break;case 125:{if(!J.cellStyles)break;for(;ne.e>=ne.s;)ue[ne.e--]={width:ne.w/256,level:ne.level||0,hidden:!!(ne.flags&1)},G||(G=!0,rm(ne.w/256)),Sl(ue[ne.e+1])}break;case 520:{var nr={};ne.level!=null&&(j[ne.r]=nr,nr.level=ne.level),ne.hidden&&(j[ne.r]=nr,nr.hidden=!0),ne.hpt&&(j[ne.r]=nr,nr.hpt=ne.hpt,nr.hpx=Hc(ne.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Fc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=ne;break;case 161:a["!margins"]||Fc(a["!margins"]={}),a["!margins"].header=ne.header,a["!margins"].footer=ne.footer;break;case 574:ne.RTL&&(D.Views[0].RTL=!0);break;case 146:B=ne;break;case 2198:ce=ne;break;case 140:U=ne;break;case 442:v?te.CodeName=ne||te.name:D.WBProps.CodeName=ne||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),e.l+=ye}return t.SheetNames=ei(l).sort(function(Bt,ft){return Number(Bt)-Number(ft)}).map(function(Bt){return l[Bt].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&x["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=x)):t.Preamble=x,t.Sheets&&M.forEach(function(Bt,ft){t.Sheets[t.SheetNames[ft]]["!autofilter"]=Bt}),t.Strings=m,t.SSF=qr(Tt),J.enc&&(t.Encryption=J.enc),ce&&(t.Themes=ce),t.Metadata={},U!==void 0&&(t.Metadata.Country=U),Z.names.length>0&&(D.Names=Z.names),t.Workbook=D,t}var sv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function VC(e,r,t){var n=Ft.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Wg(n,ok,sv.DSI);for(var l in a)r[l]=a[l]}catch(v){if(t.WTF)throw v}var c=Ft.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var d=Wg(c,lk,sv.SI);for(var m in d)r[m]==null&&(r[m]=d[m])}catch(v){if(t.WTF)throw v}r.HeadingPairs&&r.TitlesOfParts&&(Jx(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function L1(e,r){r||(r={}),om(r),ux(),r.codepage&&B0(r.codepage);var t,n;if(e.FullPaths){if(Ft.find(e,"/encryption"))throw new Error("File is password-protected");t=Ft.find(e,"!CompObj"),n=Ft.find(e,"/Workbook")||Ft.find(e,"/Book")}else{switch(r.type){case"base64":e=Oa(Yn(e));break;case"binary":e=Oa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Kr(e,0),n={content:e}}var a,l;if(t&&zC(t),r.bookProps&&!r.bookSheets)a={};else{var c=Nt?"buffer":"array";if(n&&n.content)a=WC(n.content,r);else if((l=Ft.find(e,"PerfectOffice_MAIN"))&&l.content)a=Dc.to_workbook(l.content,(r.type=c,r));else if((l=Ft.find(e,"NativeContent_MAIN"))&&l.content)a=Dc.to_workbook(l.content,(r.type=c,r));else throw(l=Ft.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Ft.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=P2(e))}var d={};return e.FullPaths&&VC(e,d,r),a.Props=a.Custprops=d,r.bookFiles&&(a.cfb=e),a}var Yd={0:{f:TE},1:{f:PE},2:{f:ME},3:{f:OE},4:{f:IE},5:{f:jE},6:{f:UE},7:{f:LE},8:{f:GE},9:{f:HE},10:{f:WE},11:{f:VE},12:{f:NE},13:{f:BE},14:{f:FE},15:{f:DE},16:{f:N1},17:{f:$E},18:{f:RE},19:{f:Y0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yC},40:{},42:{},43:{f:WS},44:{f:$S},45:{f:VS},46:{f:GS},47:{f:HS},48:{},49:{f:Zw},50:{},51:{f:h2},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:u1},62:{f:zE},63:{f:x2},64:{f:tC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:dn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:eC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:AE},148:{f:EE,p:16},151:{f:qE},152:{},153:{f:vC},154:{},155:{},156:{f:gC},157:{},158:{},159:{T:1,f:lS},160:{T:-1},161:{T:1,f:go},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ZE},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:f2},336:{T:-1},337:{f:m2,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:f0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:c1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:YE},427:{f:XE},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:QE},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:CE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KE},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:f0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:E2},633:{T:1},634:{T:-1},635:{T:1,f:T2},636:{T:-1},637:{f:qw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:oC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rC},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},v0={6:{f:Wh},10:{f:fs},12:{f:Cr},13:{f:Cr},14:{f:kr},15:{f:kr},16:{f:ln},17:{f:kr},18:{f:kr},19:{f:Cr},20:{f:Zg},21:{f:Zg},23:{f:c1},24:{f:qg},25:{f:kr},26:{},27:{},28:{f:bb},29:{},34:{f:kr},35:{f:Kg},38:{f:ln},39:{f:ln},40:{f:ln},41:{f:ln},42:{f:kr},43:{f:kr},47:{f:CS},49:{f:ab},51:{f:Cr},60:{},61:{f:tb},64:{f:kr},65:{f:nb},66:{f:Cr},77:{},80:{},81:{},82:{},85:{f:Cr},89:{},90:{},91:{},92:{f:Zk},93:{f:Tb},94:{},95:{f:kr},96:{},97:{},99:{f:kr},125:{f:u1},128:{f:mb},129:{f:Kk},130:{f:Cr},131:{f:kr},132:{f:kr},133:{f:qk},134:{},140:{f:Ib},141:{f:Cr},144:{},146:{f:Ob},151:{},152:{},153:{},154:{},155:{},156:{f:Cr},157:{},158:{},160:{f:Mb},161:{f:Lb},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ub},190:{f:db},193:{f:fs},197:{},198:{},199:{},200:{},201:{},202:{f:kr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cr},220:{},221:{f:kr},222:{},224:{f:hb},225:{f:Gk},226:{f:fs},227:{},229:{f:Sb},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Yk},253:{f:ib},255:{f:Xk},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:n1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:kr},353:{f:fs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:gb},431:{f:kr},432:{},433:{},434:{},437:{},438:{f:Ab},439:{f:kr},440:{f:Pb},441:{},442:{f:Qc},443:{},444:{f:Cr},445:{},446:{},448:{f:fs},449:{f:eb,r:2},450:{f:fs},512:{f:Hg},513:{f:jb},515:{f:pb},516:{f:sb},517:{f:Gg},519:{f:Bb},520:{f:Jk},523:{},545:{f:Yg},549:{f:Vg},566:{},574:{f:rb},638:{f:cb},659:{},1048:{},1054:{f:ob},1084:{},1212:{f:_b},2048:{f:Nb},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:xd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:fs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Fb,r:12},2173:{f:u2,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:kr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yb,r:12},2197:{},2198:{f:a2,r:12},2199:{},2200:{},2201:{},2202:{f:wb,r:12},2203:{f:fs},2204:{},2205:{},2206:{},2207:{},2211:{f:Qk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Rb},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Db},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Hg},1:{},2:{f:Wb},3:{f:$b},4:{f:Ub},5:{f:Gg},7:{f:Vb},8:{},9:{f:xd},11:{},22:{f:Cr},30:{f:lb},31:{},32:{},33:{f:Yg},36:{},37:{f:Vg},50:{f:Hb},62:{},52:{},67:{},68:{f:Cr},69:{},86:{},126:{},127:{f:zb},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Gb},223:{},234:{},354:{},421:{},518:{f:Wh},521:{f:xd},536:{f:qg},547:{f:Kg},561:{},579:{},1030:{f:Wh},1033:{f:xd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Pa(e,r,t,n){var a=r;if(!isNaN(a)){var l=(t||[]).length||0,c=e.next(4);c.write_shift(2,a),c.write_shift(2,l),l>0&&Vx(t)&&e.push(t)}}function ov(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=a.index,d=l&&l.index||e.length,m=pw(e.slice(c,d),/(:?<tr[^>]*>)/i,"<tr>"),v=-1,x=0,y=0,k=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(c=0;c<m.length;++c){var S=m[c].trim(),A=S.slice(0,3).toLowerCase();if(A=="<tr"){if(++v,t.sheetRows&&t.sheetRows<=v){--v;break}x=0;continue}if(!(A!="<td"&&A!="<th")){var R=S.split(/<\/t[dh]>/i);for(d=0;d<R.length;++d){var O=R[d].trim();if(O.match(/<t[dh]/i)){for(var N=O,U=0;N.charAt(0)=="<"&&(U=N.indexOf(">"))>-1;)N=N.slice(U+1);for(var K=0;K<b.length;++K){var B=b[K];B.s.c==x&&B.s.r<v&&v<=B.e.r&&(x=B.e.c+1,K=-1)}var D=mt(O.slice(0,O.indexOf(">")));k=D.colspan?+D.colspan:1,((y=+D.rowspan)>1||k>1)&&b.push({s:{r:v,c:x},e:{r:v+(y||1)-1,c:x+k-1}});var te=D.t||D["data-t"]||"";if(!N.length){x+=k;continue}if(N=Ix(N),E.s.r>v&&(E.s.r=v),E.e.r<v&&(E.e.r=v),E.s.c>x&&(E.s.c=x),E.e.c<x&&(E.e.c=x),!N.length){x+=k;continue}var ee={t:"s",v:N};t.raw||!N.trim().length||te=="s"||(N==="TRUE"?ee={t:"b",v:!0}:N==="FALSE"?ee={t:"b",v:!1}:isNaN(Ra(N))?isNaN(bl(N).getDate())||(ee={t:"d",v:Hr(N)},t.cellDates||(ee={t:"n",v:bn(ee.v)}),ee.z=t.dateNF||Tt[14]):ee={t:"n",v:Ra(N)}),t.dense?(n[v]||(n[v]=[]),n[v][x]=ee):n[kt({r:v,c:x})]=ee,x+=k}}}}return n["!ref"]=Lt(E),b.length&&(n["!merges"]=b),n}function HC(e,r,t,n){for(var a=e["!merges"]||[],l=[],c=r.s.c;c<=r.e.c;++c){for(var d=0,m=0,v=0;v<a.length;++v)if(!(a[v].s.r>t||a[v].s.c>c)&&!(a[v].e.r<t||a[v].e.c<c)){if(a[v].s.r<t||a[v].s.c<c){d=-1;break}d=a[v].e.r-a[v].s.r+1,m=a[v].e.c-a[v].s.c+1;break}if(!(d<0)){var x=kt({r:t,c}),y=n.dense?(e[t]||[])[c]:e[x],k=y&&y.v!=null&&(y.h||H0(y.w||(Di(y),y.w)||""))||"",E={};d>1&&(E.rowspan=d),m>1&&(E.colspan=m),n.editable?k='<span contenteditable="true">'+k+"</span>":y&&(E["data-t"]=y&&y.t||"z",y.v!=null&&(E["data-v"]=y.v),y.z!=null&&(E["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(k='<a href="'+y.l.Target+'">'+k+"</a>")),E.id=(n.id||"sjs")+"-"+x,l.push(Iw("td",k,E))}}var b="<tr>";return b+l.join("")+"</tr>"}var GC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',ZC="</body></html>";function KC(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Es(ov(t[0],r),r);var n=cm();return t.forEach(function(a,l){um(n,ov(a,r),"Sheet"+(l+1))}),n}function qC(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function YC(e,r){var t=r||{},n=t.header!=null?t.header:GC,a=t.footer!=null?t.footer:ZC,l=[n],c=Al(e["!ref"]);t.dense=Array.isArray(e),l.push(qC(e,c,t));for(var d=c.s.r;d<=c.e.r;++d)l.push(HC(e,c,d,t));return l.push("</table>"+a),l.join("")}function R1(e,r,t){var n=t||{},a=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?wn(n.origin):n.origin;a=c.r,l=c.c}var d=r.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,d.length),v={s:{r:0,c:0},e:{r:a,c:l}};if(e["!ref"]){var x=Al(e["!ref"]);v.s.r=Math.min(v.s.r,x.s.r),v.s.c=Math.min(v.s.c,x.s.c),v.e.r=Math.max(v.e.r,x.e.r),v.e.c=Math.max(v.e.c,x.e.c),a==-1&&(v.e.r=a=x.e.r+1)}var y=[],k=0,E=e["!rows"]||(e["!rows"]=[]),b=0,S=0,A=0,R=0,O=0,N=0;for(e["!cols"]||(e["!cols"]=[]);b<d.length&&S<m;++b){var U=d[b];if(lv(U)){if(n.display)continue;E[S]={hidden:!0}}var K=U.children;for(A=R=0;A<K.length;++A){var B=K[A];if(!(n.display&&lv(B))){var D=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):Ix(B.innerHTML),te=B.getAttribute("data-z")||B.getAttribute("z");for(k=0;k<y.length;++k){var ee=y[k];ee.s.c==R+l&&ee.s.r<S+a&&S+a<=ee.e.r&&(R=ee.e.c+1-l,k=-1)}N=+B.getAttribute("colspan")||1,((O=+B.getAttribute("rowspan")||1)>1||N>1)&&y.push({s:{r:S+a,c:R+l},e:{r:S+a+(O||1)-1,c:R+l+(N||1)-1}});var ve={t:"s",v:D},me=B.getAttribute("data-t")||B.getAttribute("t")||"";D!=null&&(D.length==0?ve.t=me||"z":n.raw||D.trim().length==0||me=="s"||(D==="TRUE"?ve={t:"b",v:!0}:D==="FALSE"?ve={t:"b",v:!1}:isNaN(Ra(D))?isNaN(bl(D).getDate())||(ve={t:"d",v:Hr(D)},n.cellDates||(ve={t:"n",v:bn(ve.v)}),ve.z=n.dateNF||Tt[14]):ve={t:"n",v:Ra(D)})),ve.z===void 0&&te!=null&&(ve.z=te);var J="",ce=B.getElementsByTagName("A");if(ce&&ce.length)for(var ke=0;ke<ce.length&&!(ce[ke].hasAttribute("href")&&(J=ce[ke].getAttribute("href"),J.charAt(0)!="#"));++ke);J&&J.charAt(0)!="#"&&(ve.l={Target:J}),n.dense?(e[S+a]||(e[S+a]=[]),e[S+a][R+l]=ve):e[kt({c:R+l,r:S+a})]=ve,v.e.c<R+l&&(v.e.c=R+l),R+=N}}++S}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),v.e.r=Math.max(v.e.r,S-1+a),e["!ref"]=Lt(v),S>=m&&(e["!fullref"]=Lt((v.e.r=d.length-b+S-1+a,v))),e}function j1(e,r){var t=r||{},n=t.dense?[]:{};return R1(n,e,r)}function XC(e,r){return Es(j1(e,r),r)}function lv(e){var r="",t=JC(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function JC(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function QC(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=jt(r.replace(/<[^>]*>/g,""));return[t]}var cv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function M1(e,r){var t=r||{},n=G0(e),a=[],l,c,d={name:""},m="",v=0,x,y,k={},E=[],b=t.dense?[]:{},S,A,R={value:""},O="",N=0,U=[],K=-1,B=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},te=0,ee={},ve=[],me={},J=0,ce=0,ke=[],se=1,ue=1,j=[],G={Names:[]},Z={},oe=["",""],I=[],P={},F="",M=0,H=!1,X=!1,fe=0;for($c.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=$c.exec(n);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"工作表":S[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?b["!ref"]=Lt(D):b["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=D.e.r&&(b["!fullref"]=b["!ref"],D.e.r=t.sheetRows-1,b["!ref"]=Lt(D)),ve.length&&(b["!merges"]=ve),ke.length&&(b["!rows"]=ke),x.name=x.名称||x.name,typeof JSON<"u"&&JSON.stringify(x),E.push(x.name),k[x.name]=b,X=!1):S[0].charAt(S[0].length-2)!=="/"&&(x=mt(S[0],!1),K=B=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,b=t.dense?[]:{},ve=[],ke=[],X=!0);break;case"table-row-group":S[1]==="/"?--te:++te;break;case"table-row":case"行":if(S[1]==="/"){K+=se,se=1;break}if(y=mt(S[0],!1),y.行号?K=y.行号-1:K==-1&&(K=0),se=+y["number-rows-repeated"]||1,se<10)for(fe=0;fe<se;++fe)te>0&&(ke[K+fe]={level:te});B=-1;break;case"covered-table-cell":S[1]!=="/"&&++B,t.sheetStubs&&(t.dense?(b[K]||(b[K]=[]),b[K][B]={t:"z"}):b[kt({r:K,c:B})]={t:"z"}),O="",U=[];break;case"table-cell":case"数据":if(S[0].charAt(S[0].length-2)==="/")++B,R=mt(S[0],!1),ue=parseInt(R["number-columns-repeated"]||"1",10),A={t:"z",v:null},R.formula&&t.cellFormula!=!1&&(A.f=nv(jt(R.formula))),(R.数据类型||R["value-type"])=="string"&&(A.t="s",A.v=jt(R["string-value"]||""),t.dense?(b[K]||(b[K]=[]),b[K][B]=A):b[kt({r:K,c:B})]=A),B+=ue-1;else if(S[1]!=="/"){++B,O="",N=0,U=[],ue=1;var ge=se?K+se-1:K;if(B>D.e.c&&(D.e.c=B),B<D.s.c&&(D.s.c=B),K<D.s.r&&(D.s.r=K),ge>D.e.r&&(D.e.r=ge),R=mt(S[0],!1),I=[],P={},A={t:R.数据类型||R["value-type"],v:null},t.cellFormula)if(R.formula&&(R.formula=jt(R.formula)),R["number-matrix-columns-spanned"]&&R["number-matrix-rows-spanned"]&&(J=parseInt(R["number-matrix-rows-spanned"],10)||0,ce=parseInt(R["number-matrix-columns-spanned"],10)||0,me={s:{r:K,c:B},e:{r:K+J-1,c:B+ce-1}},A.F=Lt(me),j.push([me,A.F])),R.formula)A.f=nv(R.formula);else for(fe=0;fe<j.length;++fe)K>=j[fe][0].s.r&&K<=j[fe][0].e.r&&B>=j[fe][0].s.c&&B<=j[fe][0].e.c&&(A.F=j[fe][1]);switch((R["number-columns-spanned"]||R["number-rows-spanned"])&&(J=parseInt(R["number-rows-spanned"],10)||0,ce=parseInt(R["number-columns-spanned"],10)||0,me={s:{r:K,c:B},e:{r:K+J-1,c:B+ce-1}},ve.push(me)),R["number-columns-repeated"]&&(ue=parseInt(R["number-columns-repeated"],10)),A.t){case"boolean":A.t="b",A.v=cr(R["boolean-value"]);break;case"float":A.t="n",A.v=parseFloat(R.value);break;case"percentage":A.t="n",A.v=parseFloat(R.value);break;case"currency":A.t="n",A.v=parseFloat(R.value);break;case"date":A.t="d",A.v=Hr(R["date-value"]),t.cellDates||(A.t="n",A.v=bn(A.v)),A.z="m/d/yy";break;case"time":A.t="n",A.v=fw(R["time-value"])/86400,t.cellDates&&(A.t="d",A.v=nf(A.v)),A.z="HH:MM:SS";break;case"number":A.t="n",A.v=parseFloat(R.数据数值);break;default:if(A.t==="string"||A.t==="text"||!A.t)A.t="s",R["string-value"]!=null&&(O=jt(R["string-value"]),U=[]);else throw new Error("Unsupported value type "+A.t)}}else{if(H=!1,A.t==="s"&&(A.v=O||"",U.length&&(A.R=U),H=N==0),Z.Target&&(A.l=Z),I.length>0&&(A.c=I,I=[]),O&&t.cellText!==!1&&(A.w=O),H&&(A.t="z",delete A.v),(!H||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=K))for(var ye=0;ye<se;++ye){if(ue=parseInt(R["number-columns-repeated"]||"1",10),t.dense)for(b[K+ye]||(b[K+ye]=[]),b[K+ye][B]=ye==0?A:qr(A);--ue>0;)b[K+ye][B+ue]=qr(A);else for(b[kt({r:K+ye,c:B})]=A;--ue>0;)b[kt({r:K+ye,c:B+ue})]=qr(A);D.e.c<=B&&(D.e.c=B)}ue=parseInt(R["number-columns-repeated"]||"1",10),B+=ue-1,ue=0,A={},O="",U=[]}Z={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((l=a.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((l=a.pop())[0]!==S[3])throw"Bad state: "+l;P.t=O,U.length&&(P.R=U),P.a=F,I.push(P)}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);F="",M=0,O="",N=0,U=[];break;case"creator":S[1]==="/"?F=n.slice(M,S.index):M=S.index+S[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((l=a.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&a.push([S[3],!1]);O="",N=0,U=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(ee[d.name]=m,(l=a.pop())[0]!==S[3])throw"Bad state: "+l}else S[0].charAt(S[0].length-2)!=="/"&&(m="",d=mt(S[0],!1),a.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":c=mt(S[0],!1),m+=cv[S[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":c=mt(S[0],!1),m+=cv[S[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(v,S.index);break}else v=S.index+S[0].length;break;case"named-range":c=mt(S[0],!1),oe=Vh(c["cell-range-address"]);var xe={Name:c.name,Ref:oe[0]+"!"+oe[1]};X&&(xe.Sheet=E.length),G.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(S[1]==="/"&&(!R||!R["string-value"])){var ze=QC(n.slice(N,S.index));O=(O.length>0?O+`
`:"")+ze[0]}else mt(S[0],!1),N=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{oe=Vh(mt(S[0])["target-range-address"]),k[oe[0]]["!autofilter"]={ref:oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(Z=mt(S[0],!1),!Z.href)break;Z.Target=jt(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(oe=Vh(Z.Target.slice(1)),Z.Target="#"+oe[0]+"!"+oe[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(t.WTF)throw new Error(S)}}var ne={Sheets:k,SheetNames:E,Workbook:G};return t.bookSheets&&delete ne.Sheets,ne}function uv(e,r){r=r||{},da(e,"META-INF/manifest.xml")&&pk(Er(e,"META-INF/manifest.xml"),r);var t=qn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=M1(tr(t),r);return da(e,"meta.xml")&&(n.Props=Xx(Er(e,"meta.xml"))),n}function dv(e,r){return M1(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function im(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function x0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):tr(mo(e))}function y0(e){var r=e.reduce(function(a,l){return a+l.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function fv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function eA(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Gc(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function jr(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function cn(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Gc(e,t),l=a&7;a=Math.floor(a/8);var c=0,d;if(a==0)break;switch(l){case 0:{for(var m=t[0];e[t[0]++]>=128;);d=e.slice(m,t[0])}break;case 5:c=4,d=e.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,d=e.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=Gc(e,t),d=e.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(a," at offset ").concat(n))}var v={data:d,type:l};r[a]==null?r[a]=[v]:r[a].push(v)}return r}function sm(e,r){return e?.map(function(t){return r(t.data)})||[]}function tA(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Gc(e,n),l=cn(e.slice(n[0],n[0]+a));n[0]+=a;var c={id:jr(l[1][0].data),messages:[]};l[2].forEach(function(d){var m=cn(d.data),v=jr(m[3][0].data);c.messages.push({meta:m,data:e.slice(n[0],n[0]+v)}),n[0]+=v}),(r=l[3])!=null&&r[0]&&(c.merge=jr(l[3][0].data)>>>0>0),t.push(c)}return t}function rA(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Gc(r,t),a=[];t[0]<r.length;){var l=r[t[0]]&3;if(l==0){var c=r[t[0]++]>>2;if(c<60)++c;else{var d=c-59;c=r[t[0]],d>1&&(c|=r[t[0]+1]<<8),d>2&&(c|=r[t[0]+2]<<16),d>3&&(c|=r[t[0]+3]<<24),c>>>=0,c++,t[0]+=d}a.push(r.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var m=0,v=0;if(l==1?(v=(r[t[0]]>>2&7)+4,m=(r[t[0]++]&224)<<3,m|=r[t[0]++]):(v=(r[t[0]++]>>2)+1,l==2?(m=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(m=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[y0(a)],m==0)throw new Error("Invalid offset 0");if(m>a[0].length)throw new Error("Invalid offset beyond length");if(v>=m)for(a.push(a[0].slice(-m)),v-=m;v>=a[a.length-1].length;)a.push(a[a.length-1]),v-=a[a.length-1].length;a.push(a[0].slice(-m,-m+v))}}var x=y0(a);if(x.length!=n)throw new Error("Unexpected length: ".concat(x.length," != ").concat(n));return x}function nA(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(rA(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return y0(r)}function aA(e,r,t,n){var a=im(e),l=a.getUint32(4,!0),c=(n>1?12:8)+fv(l&(n>1?3470:398))*4,d=-1,m=-1,v=NaN,x=new Date(2001,0,1);l&512&&(d=a.getUint32(c,!0),c+=4),c+=fv(l&(n>1?12288:4096))*4,l&16&&(m=a.getUint32(c,!0),c+=4),l&32&&(v=a.getFloat64(c,!0),c+=8),l&64&&(x.setTime(x.getTime()+a.getFloat64(c,!0)*1e3),c+=8);var y;switch(e[2]){case 0:break;case 2:y={t:"n",v};break;case 3:y={t:"s",v:r[m]};break;case 5:y={t:"d",v:x};break;case 6:y={t:"b",v:v>0};break;case 7:y={t:"n",v:v/86400};break;case 8:y={t:"e",v:0};break;case 9:if(d>-1)y={t:"s",v:t[d]};else if(m>-1)y={t:"s",v:r[m]};else if(!isNaN(v))y={t:"n",v};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return y}function iA(e,r,t){var n=im(e),a=n.getUint32(8,!0),l=12,c=-1,d=-1,m=NaN,v=NaN,x=new Date(2001,0,1);a&1&&(m=eA(e,l),l+=16),a&2&&(v=n.getFloat64(l,!0),l+=8),a&4&&(x.setTime(x.getTime()+n.getFloat64(l,!0)*1e3),l+=8),a&8&&(d=n.getUint32(l,!0),l+=4),a&16&&(c=n.getUint32(l,!0),l+=4);var y;switch(e[1]){case 0:break;case 2:y={t:"n",v:m};break;case 3:y={t:"s",v:r[d]};break;case 5:y={t:"d",v:x};break;case 6:y={t:"b",v:v>0};break;case 7:y={t:"n",v:v/86400};break;case 8:y={t:"e",v:0};break;case 9:if(c>-1)y={t:"s",v:t[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:y={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return y}function sA(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return aA(e,r,t,e[0]);case 5:return iA(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function bs(e){var r=cn(e);return Gc(r[1][0].data)}function hv(e,r){var t=cn(r.data),n=jr(t[1][0].data),a=t[3],l=[];return(a||[]).forEach(function(c){var d=cn(c.data),m=jr(d[1][0].data)>>>0;switch(n){case 1:l[m]=x0(d[3][0].data);break;case 8:{var v=e[bs(d[9][0].data)][0],x=cn(v.data),y=e[bs(x[1][0].data)][0],k=jr(y.meta[1][0].data);if(k!=2001)throw new Error("2000 unexpected reference to ".concat(k));var E=cn(y.data);l[m]=E[3].map(function(b){return x0(b.data)}).join("")}break}}),l}function oA(e,r){var t,n,a,l,c,d,m,v,x,y,k,E,b,S,A=cn(e),R=jr(A[1][0].data)>>>0,O=jr(A[2][0].data)>>>0,N=((n=(t=A[8])==null?void 0:t[0])==null?void 0:n.data)&&jr(A[8][0].data)>0||!1,U,K;if((l=(a=A[7])==null?void 0:a[0])!=null&&l.data&&r!=0)U=(d=(c=A[7])==null?void 0:c[0])==null?void 0:d.data,K=(v=(m=A[6])==null?void 0:m[0])==null?void 0:v.data;else if((y=(x=A[4])==null?void 0:x[0])!=null&&y.data&&r!=1)U=(E=(k=A[4])==null?void 0:k[0])==null?void 0:E.data,K=(S=(b=A[3])==null?void 0:b[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var B=N?4:1,D=im(U),te=[],ee=0;ee<U.length/2;++ee){var ve=D.getUint16(ee*2,!0);ve<65535&&te.push([ee,ve])}if(te.length!=O)throw"Expected ".concat(O," cells, found ").concat(te.length);var me=[];for(ee=0;ee<te.length-1;++ee)me[te[ee][0]]=K.subarray(te[ee][1]*B,te[ee+1][1]*B);return te.length>=1&&(me[te[te.length-1][0]]=K.subarray(te[te.length-1][1]*B)),{R,cells:me}}function lA(e,r){var t,n=cn(r.data),a=(t=n?.[7])!=null&&t[0]?jr(n[7][0].data)>>>0>0?1:0:-1,l=sm(n[5],function(c){return oA(c,a)});return{nrows:jr(n[4][0].data)>>>0,data:l.reduce(function(c,d){return c[d.R]||(c[d.R]=[]),d.cells.forEach(function(m,v){if(c[d.R][v])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(v));c[d.R][v]=m}),c},[])}}function cA(e,r,t){var n,a=cn(r.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(jr(a[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(l.e.c=(jr(a[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=Lt(l);var c=cn(a[4][0].data),d=hv(e,e[bs(c[4][0].data)][0]),m=(n=c[17])!=null&&n[0]?hv(e,e[bs(c[17][0].data)][0]):[],v=cn(c[3][0].data),x=0;v[1].forEach(function(y){var k=cn(y.data),E=e[bs(k[2][0].data)][0],b=jr(E.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var S=lA(e,E);S.data.forEach(function(A,R){A.forEach(function(O,N){var U=kt({r:x+R,c:N}),K=sA(O,d,m);K&&(t[U]=K)})}),x+=S.nrows})}function uA(e,r){var t=cn(r.data),n={"!ref":"A1"},a=e[bs(t[2][0].data)],l=jr(a[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return cA(e,a[0],n),n}function dA(e,r){var t,n=cn(r.data),a={name:(t=n[1])!=null&&t[0]?x0(n[1][0].data):"",sheets:[]},l=sm(n[2],bs);return l.forEach(function(c){e[c].forEach(function(d){var m=jr(d.meta[1][0].data);m==6e3&&a.sheets.push(uA(e,d))})}),a}function fA(e,r){var t=cm(),n=cn(r.data),a=sm(n[1],bs);if(a.forEach(function(l){e[l].forEach(function(c){var d=jr(c.meta[1][0].data);if(d==2){var m=dA(e,c);m.sheets.forEach(function(v,x){um(t,v,x==0?m.name:m.name+"_"+x,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Gh(e){var r,t,n,a,l={},c=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var v;try{v=nA(m.content)}catch(y){return console.log("?? "+m.content.length+" "+(y.message||y))}var x;try{x=tA(v)}catch(y){return console.log("## "+(y.message||y))}x.forEach(function(y){l[y.id]=y.messages,c.push(y.id)})}}),!c.length)throw new Error("File has no messages");var d=((a=(n=(t=(r=l?.[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&jr(l[1][0].meta[1][0].data)==1&&l[1][0];if(d||c.forEach(function(m){l[m].forEach(function(v){var x=jr(v.meta[1][0].data)>>>0;if(x==1)if(!d)d=v;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return fA(l,d)}function hA(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function om(e){hA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function mA(e){return yl.WS.indexOf(e)>-1?"sheet":e==yl.CS?"chart":e==yl.DS?"dialog":e==yl.MS?"macro":e&&e.length?e:"sheet"}function pA(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,mA(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function gA(e,r,t,n,a,l,c,d,m,v,x,y){try{l[n]=Nc(qn(e,t,!0),r);var k=Er(e,r),E;switch(d){case"sheet":E=kC(k,r,a,m,l[n],v,x,y);break;case"chart":if(E=bC(k,r,a,m,l[n],v,x,y),!E||!E["!drawel"])break;var b=bc(E["!drawel"].Target,r),S=h0(b),A=w2(qn(e,b,!0),Nc(qn(e,S,!0),b)),R=bc(A,b),O=h0(R);E=iC(qn(e,R,!0),R,m,Nc(qn(e,O,!0),R),v,E);break;case"macro":E=SC(k,r,a,m,l[n],v,x,y);break;case"dialog":E=TC(k,r,a,m,l[n],v,x,y);break;default:throw new Error("Unrecognized sheet type "+d)}c[n]=E;var N=[];l&&l[n]&&ei(l[n]).forEach(function(U){var K="";if(l[n][U].Type==yl.CMNT){K=bc(l[n][U].Target,r);var B=PC(Er(e,K,!0),K,m);if(!B||!B.length)return;Jg(E,B,!1)}l[n][U].Type==yl.TCMNT&&(K=bc(l[n][U].Target,r),N=N.concat(b2(Er(e,K,!0),m)))}),N&&N.length&&Jg(E,N,!0,m.people||[])}catch(U){if(m.WTF)throw U}}function ca(e){return e.charAt(0)=="/"?e.slice(1):e}function vA(e,r){if(kx(),r=r||{},om(r),da(e,"META-INF/manifest.xml")||da(e,"objectdata.xml"))return uv(e,r);if(da(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Gh<"u"){if(e.FileIndex)return Gh(e);var t=Ft.utils.cfb_new();return Tg(e).forEach(function(ke){xw(t,ke,vw(e,ke))}),Gh(t)}throw new Error("Unsupported NUMBERS file")}if(!da(e,"[Content_Types].xml"))throw da(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):da(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Tg(e),a=hk(qn(e,"[Content_Types].xml")),l=!1,c,d;if(a.workbooks.length===0&&(d="xl/workbook.xml",Er(e,d,!0)&&a.workbooks.push(d)),a.workbooks.length===0){if(d="xl/workbook.bin",!Er(e,d,!0))throw new Error("Could not find workbook");a.workbooks.push(d),l=!0}a.workbooks[0].slice(-3)=="bin"&&(l=!0);var m={},v={};if(!r.bookSheets&&!r.bookProps){if(Oc=[],a.sst)try{Oc=AC(Er(e,ca(a.sst)),a.sst,r)}catch(ke){if(r.WTF)throw ke}r.cellStyles&&a.themes.length&&(m=CC(qn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(v=EC(Er(e,ca(a.style)),a.style,m,r))}a.links.map(function(ke){try{var se=Nc(qn(e,h0(ca(ke))),ke);return IC(Er(e,ca(ke)),se,ke,r)}catch{}});var x=wC(Er(e,ca(a.workbooks[0])),a.workbooks[0],r),y={},k="";a.coreprops.length&&(k=Er(e,ca(a.coreprops[0]),!0),k&&(y=Xx(k)),a.extprops.length!==0&&(k=Er(e,ca(a.extprops[0]),!0),k&&xk(k,y,r)));var E={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(k=qn(e,ca(a.custprops[0]),!0),k&&(E=_k(k,r)));var b={};if((r.bookSheets||r.bookProps)&&(x.Sheets?c=x.Sheets.map(function(se){return se.name}):y.Worksheets&&y.SheetNames.length>0&&(c=y.SheetNames),r.bookProps&&(b.Props=y,b.Custprops=E),r.bookSheets&&typeof c<"u"&&(b.SheetNames=c),r.bookSheets?b.SheetNames:r.bookProps))return b;c={};var S={};r.bookDeps&&a.calcchain&&(S=NC(Er(e,ca(a.calcchain)),a.calcchain));var A=0,R={},O,N;{var U=x.Sheets;y.Worksheets=U.length,y.SheetNames=[];for(var K=0;K!=U.length;++K)y.SheetNames[K]=U[K].name}var B=l?"bin":"xml",D=a.workbooks[0].lastIndexOf("/"),te=(a.workbooks[0].slice(0,D+1)+"_rels/"+a.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");da(e,te)||(te="xl/_rels/workbook."+B+".rels");var ee=Nc(qn(e,te,!0),te.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=DC(Er(e,ca(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=S2(Er(e,ca(a.people[0])),r)),ee&&(ee=pA(ee,x.Sheets));var ve=Er(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(A=0;A!=y.Worksheets;++A){var me="sheet";if(ee&&ee[A]?(O="xl/"+ee[A][1].replace(/[\/]?xl\//,""),da(e,O)||(O=ee[A][1]),da(e,O)||(O=te.replace(/_rels\/.*$/,"")+ee[A][1]),me=ee[A][2]):(O="xl/worksheets/sheet"+(A+1-ve)+"."+B,O=O.replace(/sheet0\./,"sheet.")),N=O.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(A!=r.sheets)continue e;break;case"string":if(y.SheetNames[A].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var J=!1,ce=0;ce!=r.sheets.length;++ce)typeof r.sheets[ce]=="number"&&r.sheets[ce]==A&&(J=1),typeof r.sheets[ce]=="string"&&r.sheets[ce].toLowerCase()==y.SheetNames[A].toLowerCase()&&(J=1);if(!J)continue e}}gA(e,O,N,y.SheetNames[A],A,R,c,me,r,x,m,v)}return b={Directory:a,Workbook:x,Props:y,Custprops:E,Deps:S,Sheets:c,SheetNames:y.SheetNames,Strings:Oc,Styles:v,Themes:m,SSF:qr(Tt)},r&&r.bookFiles&&(e.files?(b.keys=n,b.files=e.files):(b.keys=[],b.files={},e.FullPaths.forEach(function(ke,se){ke=ke.replace(/^Root Entry[\/]/,""),b.keys.push(ke),b.files[ke]=e.FileIndex[se]}))),r&&r.bookVBA&&(a.vba.length>0?b.vbaraw=Er(e,ca(a.vba[0]),!0):a.defaults&&a.defaults.bin===A2&&(b.vbaraw=Er(e,"xl/vbaProject.bin",!0))),b}function xA(e,r){var t=r||{},n="Workbook",a=Ft.find(e,n);try{if(n="/!DataSpaces/Version",a=Ft.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(uS(a.content),n="/!DataSpaces/DataSpaceMap",a=Ft.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=fS(a.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ft.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=hS(a.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ft.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);pS(a.content)}catch{}if(n="/EncryptionInfo",a=Ft.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var d=gS(a.content);if(n="/EncryptedPackage",a=Ft.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],a.content,t.password||"",t);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function lm(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Yn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function yA(e,r){return Ft.find(e,"EncryptedPackage")?xA(e,r):L1(e,r)}function _A(e,r){var t,n=e,a=r||{};return a.type||(a.type=Nt&&Buffer.isBuffer(e)?"buffer":"base64"),t=Ax(n,a),vA(t,a)}function B1(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return g0(e.slice(t),r);default:break e}return Wc.to_workbook(e,r)}function wA(e,r){var t="",n=lm(e,r);switch(r.type){case"base64":t=Yn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=uo(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=tr(t)),r.type="binary",B1(t,r)}function kA(e,r){var t=e;return r.type=="base64"&&(t=Yn(t)),t=Bc.utils.decode(1200,t.slice(2),"str"),r.type="binary",B1(t,r)}function bA(e){return e.match(/[^\x00-\x7F]/)?Sc(e):e}function Zh(e,r,t,n){return n?(t.type="string",Wc.to_workbook(e,t)):Wc.to_workbook(r,t)}function _0(e,r){ux();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return _0(new Uint8Array(e),(t=qr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],l=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),kl={},t.dateNF&&(kl.dateNF=t.dateNF),t.type||(t.type=Nt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Nt?"buffer":"binary",n=uw(e),typeof Uint8Array<"u"&&!Nt&&(t.type="array")),t.type=="string"&&(l=!0,t.type="binary",t.codepage=65001,n=bA(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),d=new Uint8Array(c);if(d.foo="bar",!d.foo)return t=qr(t),t.type="array",_0(z0(n),t)}switch((a=lm(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return yA(Ft.read(n,t),t);break;case 9:if(a[1]<=8)return L1(n,t);break;case 60:return g0(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Xb(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return qb.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?_A(n,t):Zh(e,n,t,l);case 239:return a[3]===60?g0(n,t):Zh(e,n,t,l);case 255:if(a[1]===254)return kA(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Dc.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Dc.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Xg.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return AS.to_workbook(n,t);break;case 10:case 13:case 32:return wA(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Zb.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Xg.to_workbook(n,t):Zh(e,n,t,l)}function SA(e,r,t,n,a,l,c,d){var m=Yr(t),v=d.defval,x=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),y=!0,k=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(k,"__rowNum__",{value:t,enumerable:!1})}catch{k.__rowNum__=t}else k.__rowNum__=t;if(!c||e[t])for(var E=r.s.c;E<=r.e.c;++E){var b=c?e[t][E]:e[n[E]+m];if(b===void 0||b.t===void 0){if(v===void 0)continue;l[E]!=null&&(k[l[E]]=v);continue}var S=b.v;switch(b.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(l[E]!=null){if(S==null)if(b.t=="e"&&S===null)k[l[E]]=null;else if(v!==void 0)k[l[E]]=v;else if(x&&S===null)k[l[E]]=null;else continue;else k[l[E]]=x&&(b.t!=="n"||b.t==="n"&&d.rawNumbers!==!1)?S:Di(b,S,d);S!=null&&(y=!1)}}return{row:k,isempty:y}}function w0(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,l=[],c=0,d="",m={s:{r:0,c:0},e:{r:0,c:0}},v=r||{},x=v.range!=null?v.range:e["!ref"];switch(v.header===1?n=1:v.header==="A"?n=2:Array.isArray(v.header)?n=3:v.header==null&&(n=0),typeof x){case"string":m=xr(x);break;case"number":m=xr(e["!ref"]),m.s.r=x;break;default:m=x}n>0&&(a=0);var y=Yr(m.s.r),k=[],E=[],b=0,S=0,A=Array.isArray(e),R=m.s.r,O=0,N={};A&&!e[R]&&(e[R]=[]);var U=v.skipHidden&&e["!cols"]||[],K=v.skipHidden&&e["!rows"]||[];for(O=m.s.c;O<=m.e.c;++O)if(!(U[O]||{}).hidden)switch(k[O]=Rr(O),t=A?e[R][O]:e[k[O]+y],n){case 1:l[O]=O-m.s.c;break;case 2:l[O]=k[O];break;case 3:l[O]=v.header[O-m.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),d=c=Di(t,null,v),S=N[c]||0,!S)N[c]=1;else{do d=c+"_"+S++;while(N[d]);N[c]=S,N[d]=1}l[O]=d}for(R=m.s.r+a;R<=m.e.r;++R)if(!(K[R]||{}).hidden){var B=SA(e,m,R,k,n,l,A,v);(B.isempty===!1||(n===1?v.blankrows!==!1:v.blankrows))&&(E[b++]=B.row)}return E.length=b,E}var mv=/"/g;function TA(e,r,t,n,a,l,c,d){for(var m=!0,v=[],x="",y=Yr(t),k=r.s.c;k<=r.e.c;++k)if(n[k]){var E=d.dense?(e[t]||[])[k]:e[n[k]+y];if(E==null)x="";else if(E.v!=null){m=!1,x=""+(d.rawNumbers&&E.t=="n"?E.v:Di(E,null,d));for(var b=0,S=0;b!==x.length;++b)if((S=x.charCodeAt(b))===a||S===l||S===34||d.forceQuotes){x='"'+x.replace(mv,'""')+'"';break}x=="ID"&&(x='"ID"')}else E.f!=null&&!E.F?(m=!1,x="="+E.f,x.indexOf(",")>=0&&(x='"'+x.replace(mv,'""')+'"')):x="";v.push(x)}return d.blankrows===!1&&m?null:v.join(c)}function z1(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=xr(e["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),d=n.RS!==void 0?n.RS:`
`,m=d.charCodeAt(0),v=new RegExp((l=="|"?"\\|":l)+"+$"),x="",y=[];n.dense=Array.isArray(e);for(var k=n.skipHidden&&e["!cols"]||[],E=n.skipHidden&&e["!rows"]||[],b=a.s.c;b<=a.e.c;++b)(k[b]||{}).hidden||(y[b]=Rr(b));for(var S=0,A=a.s.r;A<=a.e.r;++A)(E[A]||{}).hidden||(x=TA(e,a,A,y,c,m,l,n),x!=null&&(n.strip&&(x=x.replace(v,"")),(x||n.blankrows!==!1)&&t.push((S++?d:"")+x)));return delete n.dense,t.join("")}function EA(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=z1(e,r);return t}function CA(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=xr(e["!ref"]),l="",c=[],d,m=[],v=Array.isArray(e);for(d=a.s.c;d<=a.e.c;++d)c[d]=Rr(d);for(var x=a.s.r;x<=a.e.r;++x)for(l=Yr(x),d=a.s.c;d<=a.e.c;++d)if(r=c[d]+l,t=v?(e[x]||[])[d]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}m[m.length]=r+"="+n}return m}function U1(e,r,t){var n=t||{},a=+!n.skipHeader,l=e||{},c=0,d=0;if(l&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var m=typeof n.origin=="string"?wn(n.origin):n.origin;c=m.r,d=m.c}var v,x={s:{c:0,r:0},e:{c:d,r:c+r.length-1+a}};if(l["!ref"]){var y=xr(l["!ref"]);x.e.c=Math.max(x.e.c,y.e.c),x.e.r=Math.max(x.e.r,y.e.r),c==-1&&(c=y.e.r+1,x.e.r=c+r.length-1+a)}else c==-1&&(c=0,x.e.r=r.length-1+a);var k=n.header||[],E=0;r.forEach(function(S,A){ei(S).forEach(function(R){(E=k.indexOf(R))==-1&&(k[E=k.length]=R);var O=S[R],N="z",U="",K=kt({c:d+E,r:c+A+a});v=Zc(l,K),O&&typeof O=="object"&&!(O instanceof Date)?l[K]=O:(typeof O=="number"?N="n":typeof O=="boolean"?N="b":typeof O=="string"?N="s":O instanceof Date?(N="d",n.cellDates||(N="n",O=bn(O)),U=n.dateNF||Tt[14]):O===null&&n.nullError&&(N="e",O=0),v?(v.t=N,v.v=O,delete v.w,delete v.R,U&&(v.z=U)):l[K]=v={t:N,v:O},U&&(v.z=U))})}),x.e.c=Math.max(x.e.c,d+k.length-1);var b=Yr(c);if(a)for(E=0;E<k.length;++E)l[Rr(E+d)+b]={t:"s",v:k[E]};return l["!ref"]=Lt(x),l}function AA(e,r){return U1(null,e,r)}function Zc(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=wn(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Zc(e,kt(r)):Zc(e,kt({r,c:t||0}))}function PA(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function cm(){return{SheetNames:[],Sheets:{}}}function um(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);a=l&&+l[2]||0;var c=l&&l[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=c+a)!=-1;++a);}if(hC(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function NA(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=PA(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function IA(e,r){return e.z=r,e}function $1(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function DA(e,r,t){return $1(e,"#"+r,t)}function OA(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function FA(e,r,t,n){for(var a=typeof r!="string"?r:xr(r),l=typeof r=="string"?r:Lt(r),c=a.s.r;c<=a.e.r;++c)for(var d=a.s.c;d<=a.e.c;++d){var m=Zc(e,c,d);m.t="n",m.F=l,delete m.v,c==a.s.r&&d==a.s.c&&(m.f=t,n&&(m.D=!0))}return e}var LA={encode_col:Rr,encode_row:Yr,encode_cell:kt,encode_range:Lt,decode_col:q0,decode_row:K0,split_cell:Gw,decode_cell:wn,decode_range:Al,format_cell:Di,sheet_add_aoa:Gx,sheet_add_json:U1,sheet_add_dom:R1,aoa_to_sheet:Pl,json_to_sheet:AA,table_to_sheet:j1,table_to_book:XC,sheet_to_csv:z1,sheet_to_txt:EA,sheet_to_json:w0,sheet_to_html:YC,sheet_to_formulae:CA,sheet_to_row_object_array:w0,sheet_get_cell:Zc,book_new:cm,book_append_sheet:um,book_set_sheet_visibility:NA,cell_set_number_format:IA,cell_set_hyperlink:$1,cell_set_internal_link:DA,cell_add_comment:OA,sheet_set_array_formula:FA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Ai({isLoading:e=!1,loadingText:r="Loading...",children:t,disabled:n,...a}){return f.jsxs("button",{...a,disabled:n||e,className:`${a.className||""} ${e?"btn-loading":""}`.trim(),children:[e&&f.jsx("span",{className:"loading-spinner","aria-hidden":"true",children:f.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"spinner-icon",children:f.jsx("circle",{cx:"8",cy:"8",r:"6",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"37.7",strokeDashoffset:"37.7"})})}),f.jsx("span",{className:e?"loading-text":"",children:e?r:t})]})}function RA({size:e="md",text:r,className:t=""}){const a={sm:"16",md:"24",lg:"32"}[e];return f.jsxs("div",{className:`loading-spinner-container ${t}`,children:[f.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",className:"loading-spinner-icon",children:f.jsx("circle",{cx:"12",cy:"12",r:"9",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"56.5",strokeDashoffset:"56.5"})}),r&&f.jsx("span",{className:"loading-text",children:r})]})}function W1({onImported:e}){const[r,t]=Y.useState(!1),[n,a]=Y.useState(!1),l=Y.useRef(null),c=Y.useRef(!1),d=async y=>{if(!(!y||c.current)){c.current=!0,t(!0);try{const k=await y.arrayBuffer(),E=_0(k,{type:"array"}),b=E.Sheets[E.SheetNames[0]],S=LA.sheet_to_json(b,{header:1});if(!S.length){alert("📄 File appears to be empty. Please check your Excel file.");return}const A=(S[0]||[]).map(ee=>String(ee??"").trim().toLowerCase());let R=A.findIndex(ee=>ee.includes("address"));R===-1&&(R=0);const O=A.findIndex(ee=>ee==="lat"||ee.includes("latitude")),N=A.findIndex(ee=>ee==="lng"||ee==="lon"||ee.includes("longitude")),U=O===-1?void 0:O,K=N===-1?void 0:N,B=[];for(let ee=1;ee<S.length;ee++){const ve=S[ee]||[],me=String(ve[R]??"").trim();if(!me)continue;const J=U!==void 0&&ve[U]!=null&&ve[U]!==""?pv(ve[U]):void 0,ce=K!==void 0&&ve[K]!=null&&ve[K]!==""?pv(ve[K]):void 0;B.push({address:me,lat:J,lng:ce})}if(B.length===0){alert("🚫 No valid addresses found in the file. Please check the format.");return}e(B);const D=B.some(ee=>ee.lat!=null&&ee.lng!=null),te=`✅ Successfully imported ${B.length} address${B.length===1?"":"es"}${D?" with GPS coordinates":""}!`;console.log(te)}catch(k){console.error(k),alert("❌ Failed to read Excel file. Please ensure it's a valid .xlsx or .xls file.")}finally{c.current=!1,t(!1),l.current&&(l.current.value="")}}},m=async y=>{if(c.current)return;const k=y.target.files?.[0];k&&await d(k)},v=y=>{y.preventDefault(),y.stopPropagation(),y.type==="dragenter"||y.type==="dragover"?a(!0):y.type==="dragleave"&&a(!1)},x=async y=>{if(y.preventDefault(),y.stopPropagation(),c.current)return;a(!1);const E=Array.from(y.dataTransfer.files).find(b=>b.name.endsWith(".xlsx")||b.name.endsWith(".xls")||b.type.includes("spreadsheet"));E?await d(E):alert("📋 Please drop an Excel file (.xlsx or .xls)")};return f.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:"0.75rem",flex:1},children:[f.jsx("input",{ref:l,type:"file",accept:".xlsx,.xls",onChange:m,className:"file-input",id:"excel-input",disabled:r,style:{display:"none"}}),f.jsx(Ai,{className:"btn btn-primary",onClick:()=>l.current?.click(),isLoading:r,loadingText:"Processing...",disabled:r,style:{whiteSpace:"nowrap"},children:"📊 Import Excel"}),f.jsx("div",{onDragEnter:v,onDragLeave:v,onDragOver:v,onDrop:x,className:"btn btn-ghost",style:{border:`2px dashed ${n?"var(--primary)":"var(--border-light)"}`,background:n?"var(--primary-light)":"transparent",color:n?"var(--primary-dark)":"var(--text-muted)",fontSize:"0.875rem",textAlign:"center",cursor:"pointer",transition:"all var(--transition-fast)",userSelect:"none",minWidth:"140px",flex:1,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>l.current?.click(),children:n?f.jsx("span",{children:"📥 Drop Excel file here"}):f.jsx("span",{children:"🖱️ Or drag & drop Excel"})})]})}function pv(e){const r=Number(e);return Number.isFinite(r)?r:void 0}function nu(e){return new Promise((r,t)=>{e.oncomplete=e.onsuccess=()=>r(e.result),e.onabort=e.onerror=()=>t(e.error)})}function V1(e,r){let t;const n=()=>{if(t)return t;const a=indexedDB.open(e);return a.onupgradeneeded=()=>a.result.createObjectStore(r),t=nu(a),t.then(l=>{l.onclose=()=>t=void 0},()=>{}),t};return(a,l)=>n().then(c=>l(c.transaction(r,a).objectStore(r)))}let Kh;function dm(){return Kh||(Kh=V1("keyval-store","keyval")),Kh}function fm(e,r=dm()){return r("readonly",t=>nu(t.get(e)))}function hm(e,r,t=dm()){return t("readwrite",n=>(n.put(r,e),nu(n.transaction)))}function jA(e=dm()){return e("readwrite",r=>(r.clear(),nu(r.transaction)))}const MA=Object.freeze(Object.defineProperty({__proto__:null,clear:jA,createStore:V1,get:fm,promisifyRequest:nu,set:hm},Symbol.toStringTag,{value:"Module"})),_e={debug:(e,...r)=>{},info:(e,...r)=>{},warn:(e,...r)=>{console.warn(`[WARN] ${e}`,...r)},error:(e,...r)=>{console.error(`[ERROR] ${e}`,...r)},success:(e,...r)=>{},sync:(e,...r)=>{},time:e=>{},timeEnd:e=>{},group:e=>{},groupEnd:()=>{}};class BA{queue=[];processing=!1;persistenceGranted=!1;constructor(){this.initializePersistence()}async initializePersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const r=await navigator.storage.persist();if(this.persistenceGranted=r,r?_e.info("✅ Persistent storage granted - data protected from eviction"):_e.warn("⚠️ Persistent storage denied - data may be evicted by browser"),"estimate"in navigator.storage){const t=await navigator.storage.estimate(),n=Math.round((t.usage||0)/1024/1024),a=Math.round((t.quota||0)/1024/1024);_e.info(`📊 Storage: ${n}MB used / ${a}MB quota`),t.usage&&t.quota&&t.usage>t.quota*.8&&_e.warn("⚠️ Storage quota 80% full - may cause data loss")}}else _e.warn("🚫 Storage persistence API not available")}catch(r){_e.error("Failed to initialize storage persistence:",r)}}async queuedSet(r,t){return new Promise((n,a)=>{this.queue.push({key:r,data:t,resolve:n,reject:a}),this.processQueue()})}async processQueue(){if(!(this.processing||this.queue.length===0)){for(this.processing=!0;this.queue.length>0;){const r=this.queue.shift();try{let t=3,n;for(;t>0;)try{await hm(r.key,r.data),r.resolve(void 0);break}catch(a){n=a,t--,t>0&&(_e.warn(`IndexedDB write failed, retrying... (${3-t}/3)`,a),await new Promise(l=>setTimeout(l,100*(4-t))))}t===0&&(_e.error("IndexedDB write failed after 3 retries:",n),r.reject(n))}catch(t){_e.error("Storage queue operation failed:",t),r.reject(t)}}this.processing=!1}}async queuedGet(r){try{return await this.checkStorageHealth(),await fm(r)}catch(t){throw _e.error("IndexedDB read failed:",t),t}}async checkStorageHealth(){try{if("storage"in navigator&&"estimate"in navigator.storage){const r=await navigator.storage.estimate();if(r.usage&&r.quota&&r.usage>r.quota*.95)throw _e.error("🚨 CRITICAL: Storage quota 95% full - immediate data loss risk"),new Error("Storage quota exhausted")}}catch(r){_e.warn("Storage health check failed:",r)}}async requestPersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const r=await navigator.storage.persist();return this.persistenceGranted=r,r}}catch(r){_e.error("Failed to request storage persistence:",r)}return!1}get isPersistent(){return this.persistenceGranted}}const kd=new BA;class zA{toasts=[];listeners=[];timeouts=new Map;show(r,t="info",n=4e3){const a={id:`toast_${Date.now()}_${Math.random().toString(36).slice(2)}`,message:r,type:t,timestamp:Date.now(),duration:n};if(this.toasts.push(a),this.notifyListeners(),n>0){const l=setTimeout(()=>{this.remove(a.id)},n);this.timeouts.set(a.id,l)}return a.id}remove(r){const t=this.timeouts.get(r);t&&(clearTimeout(t),this.timeouts.delete(r)),this.toasts=this.toasts.filter(n=>n.id!==r),this.notifyListeners()}clear(){this.timeouts.forEach(r=>clearTimeout(r)),this.timeouts.clear(),this.toasts=[],this.notifyListeners()}getToasts(){return[...this.toasts]}subscribe(r){return this.listeners.push(r),()=>{this.listeners=this.listeners.filter(t=>t!==r)}}notifyListeners(){this.listeners.forEach(r=>r([...this.toasts]))}}const Xd=new zA,qh=(e,r)=>Xd.show(e,"warning",r),UA=(e,r)=>Xd.show(e,"info",r);function Ar(e){const r=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&r==="[object Date]"?new e.constructor(+e):typeof e=="number"||r==="[object Number]"||typeof e=="string"||r==="[object String]"?new Date(e):new Date(NaN)}function ti(e,r){return e instanceof Date?new e.constructor(r):new Date(r)}function mm(e,r){const t=Ar(e);return isNaN(r)?ti(e,NaN):(r&&t.setDate(t.getDate()+r),t)}function $A(e,r){const t=Ar(e);if(isNaN(r))return ti(e,NaN);if(!r)return t;const n=t.getDate(),a=ti(e,t.getTime());a.setMonth(t.getMonth()+r+1,0);const l=a.getDate();return n>=l?a:(t.setFullYear(a.getFullYear(),a.getMonth(),n),t)}const H1=6048e5,WA=864e5,G1=6e4,Z1=36e5;let VA={};function lf(){return VA}function Tl(e,r){const t=lf(),n=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=Ar(e),l=a.getDay(),c=(l<n?7:0)+l-n;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function Jd(e){return Tl(e,{weekStartsOn:1})}function K1(e){const r=Ar(e),t=r.getFullYear(),n=ti(e,0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);const a=Jd(n),l=ti(e,0);l.setFullYear(t,0,4),l.setHours(0,0,0,0);const c=Jd(l);return r.getTime()>=a.getTime()?t+1:r.getTime()>=c.getTime()?t:t-1}function oo(e){const r=Ar(e);return r.setHours(0,0,0,0),r}function gv(e){const r=Ar(e),t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return t.setUTCFullYear(r.getFullYear()),+e-+t}function HA(e,r){const t=oo(e),n=oo(r),a=+t-gv(t),l=+n-gv(n);return Math.round((a-l)/WA)}function GA(e){const r=K1(e),t=ti(e,0);return t.setFullYear(r,0,4),t.setHours(0,0,0,0),Jd(t)}function vv(e,r){const t=r*7;return mm(e,t)}function xv(e,r){const t=oo(e),n=oo(r);return+t==+n}function ZA(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function KA(e){if(!ZA(e)&&typeof e!="number")return!1;const r=Ar(e);return!isNaN(Number(r))}function qA(e){const r=Ar(e),t=ti(e,0);return t.setFullYear(r.getFullYear(),0,1),t.setHours(0,0,0,0),t}function YA(e,r){const t=r?.weekStartsOn,n=Ar(e),a=n.getDay(),l=(a<t?-7:0)+6-(a-t);return n.setDate(n.getDate()+l),n.setHours(23,59,59,999),n}const XA={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},JA=(e,r,t)=>{let n;const a=XA[e];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function Yh(e){return(r={})=>{const t=r.width?String(r.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const QA={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},eP={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},tP={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},rP={date:Yh({formats:QA,defaultWidth:"full"}),time:Yh({formats:eP,defaultWidth:"full"}),dateTime:Yh({formats:tP,defaultWidth:"full"})},nP={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},aP=(e,r,t,n)=>nP[e];function xc(e){return(r,t)=>{const n=t?.context?String(t.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const c=e.defaultFormattingWidth||e.defaultWidth,d=t?.width?String(t.width):c;a=e.formattingValues[d]||e.formattingValues[c]}else{const c=e.defaultWidth,d=t?.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[c]}const l=e.argumentCallback?e.argumentCallback(r):r;return a[l]}}const iP={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},sP={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},oP={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},lP={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},cP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},uP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},dP=(e,r)=>{const t=Number(e),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},fP={ordinalNumber:dP,era:xc({values:iP,defaultWidth:"wide"}),quarter:xc({values:sP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xc({values:oP,defaultWidth:"wide"}),day:xc({values:lP,defaultWidth:"wide"}),dayPeriod:xc({values:cP,defaultWidth:"wide",formattingValues:uP,defaultFormattingWidth:"wide"})};function yc(e){return(r,t={})=>{const n=t.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],l=r.match(a);if(!l)return null;const c=l[0],d=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],m=Array.isArray(d)?mP(d,y=>y.test(c)):hP(d,y=>y.test(c));let v;v=e.valueCallback?e.valueCallback(m):m,v=t.valueCallback?t.valueCallback(v):v;const x=r.slice(c.length);return{value:v,rest:x}}}function hP(e,r){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&r(e[t]))return t}function mP(e,r){for(let t=0;t<e.length;t++)if(r(e[t]))return t}function pP(e){return(r,t={})=>{const n=r.match(e.matchPattern);if(!n)return null;const a=n[0],l=r.match(e.parsePattern);if(!l)return null;let c=e.valueCallback?e.valueCallback(l[0]):l[0];c=t.valueCallback?t.valueCallback(c):c;const d=r.slice(a.length);return{value:c,rest:d}}}const gP=/^(\d+)(th|st|nd|rd)?/i,vP=/\d+/i,xP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},yP={any:[/^b/i,/^(a|c)/i]},_P={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},wP={any:[/1/i,/2/i,/3/i,/4/i]},kP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},bP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},SP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},TP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},EP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},CP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},AP={ordinalNumber:pP({matchPattern:gP,parsePattern:vP,valueCallback:e=>parseInt(e,10)}),era:yc({matchPatterns:xP,defaultMatchWidth:"wide",parsePatterns:yP,defaultParseWidth:"any"}),quarter:yc({matchPatterns:_P,defaultMatchWidth:"wide",parsePatterns:wP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:yc({matchPatterns:kP,defaultMatchWidth:"wide",parsePatterns:bP,defaultParseWidth:"any"}),day:yc({matchPatterns:SP,defaultMatchWidth:"wide",parsePatterns:TP,defaultParseWidth:"any"}),dayPeriod:yc({matchPatterns:EP,defaultMatchWidth:"any",parsePatterns:CP,defaultParseWidth:"any"})},PP={code:"en-US",formatDistance:JA,formatLong:rP,formatRelative:aP,localize:fP,match:AP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function NP(e){const r=Ar(e);return HA(r,qA(r))+1}function IP(e){const r=Ar(e),t=+Jd(r)-+GA(r);return Math.round(t/H1)+1}function q1(e,r){const t=Ar(e),n=t.getFullYear(),a=lf(),l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,c=ti(e,0);c.setFullYear(n+1,0,l),c.setHours(0,0,0,0);const d=Tl(c,r),m=ti(e,0);m.setFullYear(n,0,l),m.setHours(0,0,0,0);const v=Tl(m,r);return t.getTime()>=d.getTime()?n+1:t.getTime()>=v.getTime()?n:n-1}function DP(e,r){const t=lf(),n=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=q1(e,r),l=ti(e,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),Tl(l,r)}function OP(e,r){const t=Ar(e),n=+Tl(t,r)-+DP(t,r);return Math.round(n/H1)+1}function Wt(e,r){const t=e<0?"-":"",n=Math.abs(e).toString().padStart(r,"0");return t+n}const hs={y(e,r){const t=e.getFullYear(),n=t>0?t:1-t;return Wt(r==="yy"?n%100:n,r.length)},M(e,r){const t=e.getMonth();return r==="M"?String(t+1):Wt(t+1,2)},d(e,r){return Wt(e.getDate(),r.length)},a(e,r){const t=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,r){return Wt(e.getHours()%12||12,r.length)},H(e,r){return Wt(e.getHours(),r.length)},m(e,r){return Wt(e.getMinutes(),r.length)},s(e,r){return Wt(e.getSeconds(),r.length)},S(e,r){const t=r.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,t-3));return Wt(a,r.length)}},al={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},yv={G:function(e,r,t){const n=e.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(e,r,t){if(r==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return t.ordinalNumber(a,{unit:"year"})}return hs.y(e,r)},Y:function(e,r,t,n){const a=q1(e,n),l=a>0?a:1-a;if(r==="YY"){const c=l%100;return Wt(c,2)}return r==="Yo"?t.ordinalNumber(l,{unit:"year"}):Wt(l,r.length)},R:function(e,r){const t=K1(e);return Wt(t,r.length)},u:function(e,r){const t=e.getFullYear();return Wt(t,r.length)},Q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return Wt(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return Wt(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,r,t){const n=e.getMonth();switch(r){case"M":case"MM":return hs.M(e,r);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(e,r,t){const n=e.getMonth();switch(r){case"L":return String(n+1);case"LL":return Wt(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(e,r,t,n){const a=OP(e,n);return r==="wo"?t.ordinalNumber(a,{unit:"week"}):Wt(a,r.length)},I:function(e,r,t){const n=IP(e);return r==="Io"?t.ordinalNumber(n,{unit:"week"}):Wt(n,r.length)},d:function(e,r,t){return r==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):hs.d(e,r)},D:function(e,r,t){const n=NP(e);return r==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):Wt(n,r.length)},E:function(e,r,t){const n=e.getDay();switch(r){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(e,r,t,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(l);case"ee":return Wt(l,2);case"eo":return t.ordinalNumber(l,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,t,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(l);case"cc":return Wt(l,r.length);case"co":return t.ordinalNumber(l,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,t){const n=e.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return Wt(a,r.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(e,r,t){const a=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,t){const n=e.getHours();let a;switch(n===12?a=al.noon:n===0?a=al.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,t){const n=e.getHours();let a;switch(n>=17?a=al.evening:n>=12?a=al.afternoon:n>=4?a=al.morning:a=al.night,r){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,t){if(r==="ho"){let n=e.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return hs.h(e,r)},H:function(e,r,t){return r==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):hs.H(e,r)},K:function(e,r,t){const n=e.getHours()%12;return r==="Ko"?t.ordinalNumber(n,{unit:"hour"}):Wt(n,r.length)},k:function(e,r,t){let n=e.getHours();return n===0&&(n=24),r==="ko"?t.ordinalNumber(n,{unit:"hour"}):Wt(n,r.length)},m:function(e,r,t){return r==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):hs.m(e,r)},s:function(e,r,t){return r==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):hs.s(e,r)},S:function(e,r){return hs.S(e,r)},X:function(e,r,t){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return wv(n);case"XXXX":case"XX":return Qs(n);case"XXXXX":case"XXX":default:return Qs(n,":")}},x:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"x":return wv(n);case"xxxx":case"xx":return Qs(n);case"xxxxx":case"xxx":default:return Qs(n,":")}},O:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+_v(n,":");case"OOOO":default:return"GMT"+Qs(n,":")}},z:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+_v(n,":");case"zzzz":default:return"GMT"+Qs(n,":")}},t:function(e,r,t){const n=Math.trunc(e.getTime()/1e3);return Wt(n,r.length)},T:function(e,r,t){const n=e.getTime();return Wt(n,r.length)}};function _v(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),l=n%60;return l===0?t+String(a):t+String(a)+r+Wt(l,2)}function wv(e,r){return e%60===0?(e>0?"-":"+")+Wt(Math.abs(e)/60,2):Qs(e,r)}function Qs(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Wt(Math.trunc(n/60),2),l=Wt(n%60,2);return t+a+r+l}const kv=(e,r)=>{switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},Y1=(e,r)=>{switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},FP=(e,r)=>{const t=e.match(/(P+)(p+)?/)||[],n=t[1],a=t[2];if(!a)return kv(e,r);let l;switch(n){case"P":l=r.dateTime({width:"short"});break;case"PP":l=r.dateTime({width:"medium"});break;case"PPP":l=r.dateTime({width:"long"});break;case"PPPP":default:l=r.dateTime({width:"full"});break}return l.replace("{{date}}",kv(n,r)).replace("{{time}}",Y1(a,r))},LP={p:Y1,P:FP},RP=/^D+$/,jP=/^Y+$/,MP=["D","DD","YY","YYYY"];function BP(e){return RP.test(e)}function zP(e){return jP.test(e)}function UP(e,r,t){const n=$P(e,r,t);if(console.warn(n),MP.includes(e))throw new RangeError(n)}function $P(e,r,t){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${r}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const WP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,VP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,HP=/^'([^]*?)'?$/,GP=/''/g,ZP=/[a-zA-Z]/;function Qd(e,r,t){const n=lf(),a=n.locale??PP,l=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,c=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,d=Ar(e);if(!KA(d))throw new RangeError("Invalid time value");let m=r.match(VP).map(x=>{const y=x[0];if(y==="p"||y==="P"){const k=LP[y];return k(x,a.formatLong)}return x}).join("").match(WP).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const y=x[0];if(y==="'")return{isToken:!1,value:KP(x)};if(yv[y])return{isToken:!0,value:x};if(y.match(ZP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(m=a.localize.preprocessor(d,m));const v={firstWeekContainsDate:l,weekStartsOn:c,locale:a};return m.map(x=>{if(!x.isToken)return x.value;const y=x.value;(zP(y)||BP(y))&&UP(y,r,String(e));const k=yv[y[0]];return k(d,y,a.localize,v)}).join("")}function KP(e){const r=e.match(HP);return r?r[1].replace(GP,"'"):e}function qP(e,r){const t=Ar(e),n=Ar(r);return t.getTime()>n.getTime()}function YP(e){return+Ar(e)<Date.now()}function XP(e,r){const t=+Ar(e),[n,a]=[+Ar(r.start),+Ar(r.end)].sort((l,c)=>l-c);return t>=n&&t<=a}function JP(e,r){return mm(e,-r)}function fa(e,r){const n=rN(e);let a;if(n.date){const m=nN(n.date,2);a=aN(m.restDateString,m.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const l=a.getTime();let c=0,d;if(n.time&&(c=iN(n.time),isNaN(c)))return new Date(NaN);if(n.timezone){if(d=sN(n.timezone),isNaN(d))return new Date(NaN)}else{const m=new Date(l+c),v=new Date(0);return v.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),v.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),v}return new Date(l+c+d)}const bd={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},QP=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,eN=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,tN=/^([+-])(\d{2})(?::?(\d{2}))?$/;function rN(e){const r={},t=e.split(bd.dateTimeDelimiter);let n;if(t.length>2)return r;if(/:/.test(t[0])?n=t[0]:(r.date=t[0],n=t[1],bd.timeZoneDelimiter.test(r.date)&&(r.date=e.split(bd.timeZoneDelimiter)[0],n=e.substr(r.date.length,e.length))),n){const a=bd.timezone.exec(n);a?(r.time=n.replace(a[1],""),r.timezone=a[1]):r.time=n}return r}function nN(e,r){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=e.match(t);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,l=n[2]?parseInt(n[2]):null;return{year:l===null?a:l*100,restDateString:e.slice((n[1]||n[2]).length)}}function aN(e,r){if(r===null)return new Date(NaN);const t=e.match(QP);if(!t)return new Date(NaN);const n=!!t[4],a=_c(t[1]),l=_c(t[2])-1,c=_c(t[3]),d=_c(t[4]),m=_c(t[5])-1;if(n)return dN(r,d,m)?oN(r,d,m):new Date(NaN);{const v=new Date(0);return!cN(r,l,c)||!uN(r,a)?new Date(NaN):(v.setUTCFullYear(r,l,Math.max(a,c)),v)}}function _c(e){return e?parseInt(e):1}function iN(e){const r=e.match(eN);if(!r)return NaN;const t=Xh(r[1]),n=Xh(r[2]),a=Xh(r[3]);return fN(t,n,a)?t*Z1+n*G1+a*1e3:NaN}function Xh(e){return e&&parseFloat(e.replace(",","."))||0}function sN(e){if(e==="Z")return 0;const r=e.match(tN);if(!r)return 0;const t=r[1]==="+"?-1:1,n=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return hN(n,a)?t*(n*Z1+a*G1):NaN}function oN(e,r,t){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,l=(r-1)*7+t+1-a;return n.setUTCDate(n.getUTCDate()+l),n}const lN=[31,null,31,30,31,30,31,31,30,31,30,31];function X1(e){return e%400===0||e%4===0&&e%100!==0}function cN(e,r,t){return r>=0&&r<=11&&t>=1&&t<=(lN[r]||(X1(e)?29:28))}function uN(e,r){return r>=1&&r<=(X1(e)?366:365)}function dN(e,r,t){return r>=1&&r<=53&&t>=0&&t<=6}function fN(e,r,t){return e===24?r===0&&t===0:t>=0&&t<60&&r>=0&&r<60&&e>=0&&e<25}function hN(e,r){return r>=0&&r<=59}const mN={name:"[Agent Name]",title:"Enforcement Agent",signature:"Enforcement Agent [Agent Name]",contactInfo:void 0},J1=[{id:"professional_standard",name:"Professional Standard",template:`{greeting}PAYMENT REMINDER

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: £{amount}

Payment must be made as agreed. Failure to comply may result in further enforcement action.

Contact immediately if unable to pay as arranged.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"friendly_reminder",name:"Friendly Reminder",template:`{greeting}Payment Reminder

{refLine}This is a friendly reminder that your payment arrangement is due {date}{time}.

Amount: £{amount}

Please ensure payment is made as agreed. If you need to discuss this arrangement, please contact us immediately.

Thank you,
{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"urgent_notice",name:"Urgent Notice",template:`{greeting}URGENT: PAYMENT DUE

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: £{amount}

IMPORTANT: Payment must be made TODAY as agreed. Failure to comply will result in immediate further enforcement action.

Contact us NOW if unable to pay.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"payment_plan_reminder",name:"Payment Plan Reminder",template:`{greeting}Payment Plan Reminder

{refLine}Your next payment is due {date}{time}.

Payment Amount: £{amount}

This is part of your agreed payment plan. Please ensure this payment is made on time to keep your arrangement active.

If you have any questions about your payment plan, please contact us.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"custom",name:"Custom Template",template:`{greeting}Payment Reminder

{refLine}Your payment is due {date}{time}.

Amount: £{amount}

[Customize this message]

{signature}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]}],pN={daysBeforePayment:[3,1,0],enabled:!0,autoSend:!1},Nl={defaultSchedule:pN,globalEnabled:!0,smsEnabled:!0,agentProfile:mN,messageTemplates:J1,activeTemplateId:"professional_standard",customizableSchedule:{threeDayReminder:!0,oneDayReminder:!0,dayOfReminder:!0,customDays:[]}};function gN(e,r=Nl){const t=e.reminderSchedule||r.defaultSchedule;if(!t.enabled||!r.globalEnabled)return[];const n=fa(e.scheduledDate);let a=[];return t.daysBeforePayment&&t.daysBeforePayment.length>0?a=[...t.daysBeforePayment]:(r.customizableSchedule.threeDayReminder&&a.push(3),r.customizableSchedule.oneDayReminder&&a.push(1),r.customizableSchedule.dayOfReminder&&a.push(0),a.push(...r.customizableSchedule.customDays)),[...new Set(a)].sort((c,d)=>d-c).map(c=>JP(n,c).toISOString())}function vN(e,r=Nl){const t=gN(e,r),n=new Date().toISOString();return t.map((a,l)=>({id:`${e.id}_reminder_${l}`,arrangementId:e.id,type:xN(e,a),scheduledDate:a,status:"pending",createdAt:n,updatedAt:n}))}function xN(e,r){const t=oo(fa(e.scheduledDate)),n=oo(fa(r)),a=oo(new Date);return n.getTime()===t.getTime()?"payment_due":qP(a,t)?"overdue":"custom"}function yN(e){const r=e.reminderSettings||Nl;if(!r.globalEnabled)return e.reminderNotifications||[];const t=e.reminderNotifications||[],n=[];return e.arrangements.filter(a=>a.status!=="Completed"&&a.status!=="Cancelled").forEach(a=>{if(!t.some(c=>c.arrangementId===a.id)){const c=vN(a,r);n.push(...c)}}),[...t,...n]}function _N(e,r,t,n){return e.map(a=>a.id===r?{...a,status:t,message:n||a.message,updatedAt:new Date().toISOString()}:a)}function wN(e,r){const t=new Set(r.filter(n=>n.status!=="Completed"&&n.status!=="Cancelled").map(n=>n.id));return e.filter(n=>t.has(n.arrangementId))}function Q1(e,r,t=Nl){const n=t.messageTemplates.find(S=>S.id===t.activeTemplateId)||t.messageTemplates[0],a=e.customerName||"",l=e.amount||"the arranged amount",c=fa(e.scheduledDate);let d="",m="";if(a){const S=a.trim().split(/\s+/);S.length>=2?(m=S[0],d=`Mr/Mrs ${S.slice(1).join(" ")}, `):d=`${a}, `}const v=m?`Reference: ${m}

`:"",x=e.scheduledTime?` at ${e.scheduledTime}`:"",y=c.toLocaleDateString("en-GB");let k=n.template;const E=t.agentProfile.contactInfo?`
${t.agentProfile.contactInfo}`:"",b={greeting:d,refLine:v,date:y,time:x,amount:l,signature:t.agentProfile.signature,customerName:a,referenceNumber:m||"",agentName:t.agentProfile.name,agentTitle:t.agentProfile.title,contactInfo:E};return Object.entries(b).forEach(([S,A])=>{const R=new RegExp(`\\{${S}\\}`,"g");k=k.replace(R,A)}),k}const Sd="navigator_state_v5",il=5,Td={addresses:[],activeIndex:null,activeStartTime:null,completions:[],daySessions:[],arrangements:[],currentListVersion:1,subscription:null,reminderSettings:Nl,reminderNotifications:[],lastReminderProcessed:void 0};function kN(e){try{if(typeof structuredClone<"u")return structuredClone(e);const r=JSON.stringify(e),t=JSON.parse(r);if(typeof e=="object"&&e!==null&&"addresses"in e){const n=e,a=t;Array.isArray(n.addresses)&&!Array.isArray(a.addresses)&&(_e.error("Deep copy corrupted addresses array, falling back to original"),a.addresses=n.addresses),Array.isArray(n.completions)&&!Array.isArray(a.completions)&&(_e.error("Deep copy corrupted completions array, falling back to original"),a.completions=n.completions)}return t}catch(r){return _e.error("Deep copy failed, returning original object:",r),e}}function bN(e){return e&&typeof e.index=="number"&&typeof e.address=="string"&&typeof e.outcome=="string"&&["PIF","DA","Done","ARR"].includes(e.outcome)&&typeof e.timestamp=="string"&&!isNaN(new Date(e.timestamp).getTime())}function Jh(e){return e&&typeof e.address=="string"&&e.address.trim().length>0}function SN(e){return e&&Array.isArray(e.addresses)&&Array.isArray(e.completions)&&Array.isArray(e.daySessions)&&Array.isArray(e.arrangements)&&(e.activeIndex===null||typeof e.activeIndex=="number")&&typeof e.currentListVersion=="number"}function bv(e,r){return(Array.isArray(e)?e:[]).filter(bN).map(n=>({...n,listVersion:typeof n?.listVersion=="number"?n.listVersion:r}))}function ms(e,r,t){const n=`${e}_${r}_${JSON.stringify(t).slice(0,50)}_${Date.now()}`,a=encodeURIComponent(n);return btoa(a).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}function ey(e,r){const t={...e,end:r.toISOString()},n=Date.parse(e.start),a=r.getTime();if(!Number.isNaN(n)&&!Number.isNaN(a)){const l=a-n;t.durationSeconds=l>=0?Math.floor(l/1e3):void 0}else t.durationSeconds=void 0;return t}function TN(e,r){const t=r.getTime(),n=Date.parse(e.start);let a=Date.parse(`${e.date}T23:59:59.999Z`);return Number.isNaN(a)&&(a=t),!Number.isNaN(n)&&a<n&&(a=n),a>t&&(a=t),Number.isNaN(a)&&(a=Number.isNaN(n)?t:n),ey(e,new Date(a))}function EN(e,r,t){const n=[],a=[];for(const l of e)if(!l.end&&l.date<r){const c=TN(l,t);n.push(c),a.push(c)}else n.push(l);return{sanitizedSessions:n,closedSessions:a}}function CN(e,r){for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(n.date===r&&!n.end)return t}return-1}function AN(e,r,t){const{sanitizedSessions:n,closedSessions:a}=EN(e,r,t),l=CN(n,r);if(l===-1)return{updatedSessions:n,closedSessions:a};const c=n.slice(),d=ey(c[l],t);return c[l]=d,{updatedSessions:c,closedSessions:a,endedSession:d}}const Sv="navigator_device_id";function PN(){try{const e=localStorage.getItem(Sv);if(e)return e;const r=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():"dev_"+Math.random().toString(36).slice(2);return localStorage.setItem(Sv,r),r}catch{return"dev_"+Math.random().toString(36).slice(2)}}function NN(e,r){if(r.size===0)return e;try{let t=kN(e);if(!t.addresses||!Array.isArray(t.addresses))return _e.error("State copy failed - addresses corrupted, using base state"),e;const n=Array.from(r.values()).sort((c,d)=>new Date(c.timestamp).getTime()-new Date(d.timestamp).getTime());let a=!1,l=!1;for(const c of n)if(c.type!=="reverted")try{switch(c.entity){case"completion":if(l=!0,c.operation==="create"){if(!c.data||typeof c.data.index!="number"||!c.data.outcome){_e.warn("Invalid completion data in optimistic update:",c.data);continue}t.completions.some(m=>m.index===c.data.index&&m.outcome===c.data.outcome&&Math.abs(new Date(m.timestamp).getTime()-new Date(c.data.timestamp).getTime())<1e3)||(t.completions=[c.data,...t.completions])}else c.operation==="update"?t.completions=t.completions.map(d=>d.timestamp===c.data.originalTimestamp?{...d,...c.data}:d):c.operation==="delete"&&(t.completions=t.completions.filter(d=>d.timestamp!==c.data.timestamp));break;case"arrangement":c.operation==="create"?t.arrangements=[...t.arrangements,c.data]:c.operation==="update"?t.arrangements=t.arrangements.map(d=>d.id===c.data.id?{...d,...c.data,updatedAt:c.timestamp}:d):c.operation==="delete"&&(t.arrangements=t.arrangements.filter(d=>d.id!==c.data.id));break;case"address":if(a=!0,c.operation==="create")t.addresses=[...t.addresses,c.data];else if(c.operation==="update"&&c.data?.addresses&&(t.addresses=Array.isArray(c.data.addresses)?c.data.addresses:t.addresses,c.data.bumpVersion)){const d=typeof t.currentListVersion=="number"?t.currentListVersion:1;t.currentListVersion=d+1,c.data.preserveCompletions||(t.completions=[]),t.activeIndex=null}break;case"session":c.operation==="create"?c.data&&c.data.date&&c.data.start?t.daySessions=[...t.daySessions,c.data]:_e.warn("Invalid session data in optimistic update:",c.data):c.operation==="update"&&(t.daySessions=t.daySessions.map(d=>d.date===c.data.date?{...d,...c.data}:d));break;default:_e.warn(`Unknown entity type in optimistic update: ${c.entity}`,c);break}}catch(d){_e.error(`Failed to apply optimistic update for ${c.entity}:`,d)}return a&&(!t.addresses||!Array.isArray(t.addresses))?(_e.error("Optimistic updates corrupted addresses, reverting to base state"),e):l&&(!t.completions||!Array.isArray(t.completions))?(_e.error("Optimistic updates corrupted completions, reverting to base state"),e):t}catch(t){return _e.error("Failed to apply optimistic updates, returning base state:",t),e}}function IN(){const[e,r]=Y.useState(Td),[t,n]=Y.useState({updates:new Map,pendingOperations:new Set}),[a,l]=Y.useState(!0),c=Y.useMemo(()=>PN(),[]),d=Y.useMemo(()=>NN(e,t.updates),[e,t.updates]),[m,v]=Y.useState(new Map);Y.useEffect(()=>{let I=!0;return(async()=>{try{const P=await kd.queuedGet(Sd);if(!I)return;if(P){if(!SN(P)){_e.warn("Loaded data failed validation, using initial state"),r({...Td,_schemaVersion:il});return}const F=typeof P.currentListVersion=="number"?P.currentListVersion:1,M={addresses:P.addresses.filter(Jh),activeIndex:typeof P.activeIndex=="number"?P.activeIndex:null,completions:bv(P.completions,F),daySessions:Array.isArray(P.daySessions)?P.daySessions:[],arrangements:Array.isArray(P.arrangements)?P.arrangements:[],currentListVersion:F,subscription:P.subscription||null,_schemaVersion:il};r(M)}else r({...Td,_schemaVersion:il})}catch(P){_e.error("Failed to load state from IndexedDB:",P),r({...Td,_schemaVersion:il})}finally{I&&l(!1)}})(),()=>{I=!1}},[]),Y.useEffect(()=>{if(a)return;const I=setTimeout(async()=>{try{const P={...e,_schemaVersion:il};await kd.queuedSet(Sd,P)}catch(P){_e.error("Failed to persist state to IndexedDB:",P)}},150);return()=>clearTimeout(I)},[e,a]);const x=Y.useCallback((I,P,F,M)=>{const H=M||ms(I,P,F),X=new Date().toISOString(),fe={id:H,timestamp:X,type:"optimistic",operation:I,entity:P,data:F};return n(ge=>{const ye=new Map(ge.updates);return ye.set(H,fe),{updates:ye,pendingOperations:new Set([...ge.pendingOperations,H])}}),H},[]),y=Y.useCallback((I,P)=>{n(F=>{const M=new Map(F.updates),H=new Set(F.pendingOperations),X=M.get(I);return X&&M.set(I,{...X,type:"confirmed",data:P||X.data}),H.delete(I),{updates:M,pendingOperations:H}}),setTimeout(()=>{n(F=>{const M=new Map(F.updates);return M.delete(I),{...F,updates:M}})},5e3)},[]),k=Y.useCallback((I,P)=>{_e.debug(`Reverting optimistic update ${I}:`,P),n(F=>{const M=new Map(F.updates),H=new Set(F.pendingOperations),X=M.get(I);return X&&M.set(I,{...X,type:"reverted"}),H.delete(I),{updates:M,pendingOperations:H}}),setTimeout(()=>{n(F=>{const M=new Map(F.updates);return M.delete(I),{...F,updates:M}})},1e3)},[]),E=Y.useCallback(()=>{n({updates:new Map,pendingOperations:new Set})},[]),b=Y.useCallback((I,P=!0)=>{_e.info(`🔄 IMPORT START: Importing ${I.length} addresses, preserveCompletions=${P}`);const F=Date.now();localStorage.setItem("navigator_import_in_progress",F.toString()),_e.info("🛡️ IMPORT PROTECTION ACTIVATED:",new Date(F).toISOString());const M=ms("update","address",{type:"bulk_import",count:I.length,preserve:P}),H=Array.isArray(I)?I.filter(Jh):[];if(_e.info(`🔄 IMPORT VALIDATION: ${H.length} valid out of ${I.length} total`),H.length===0){_e.warn("No valid addresses to import");return}x("update","address",{addresses:H,bumpVersion:!0,preserveCompletions:P},M),r(X=>{const fe=(typeof X.currentListVersion=="number"?X.currentListVersion:1)+1;_e.info(`🔄 IMPORT BASE STATE UPDATE: addresses=${H.length}, preserveCompletions=${P}, oldCompletions=${X.completions.length}, newListVersion=${fe}`);const ge={...X,addresses:H,activeIndex:null,currentListVersion:fe,completions:P?X.completions:[]};return _e.info(`🔄 IMPORT RESULT STATE: addresses=${ge.addresses.length}, completions=${ge.completions.length}, listVersion=${ge.currentListVersion}`),ge}),y(M),setTimeout(()=>{localStorage.removeItem("navigator_import_in_progress"),_e.info("🛡️ IMPORT PROTECTION CLEARED after import completion")},2e3)},[x,y]),S=Y.useCallback(I=>new Promise(P=>{if(!Jh(I)){P(-1);return}const F=ms("create","address",I);x("create","address",I,F),r(M=>{const H=[...M.addresses,I],X=H.length-1;return y(F),P(X),{...M,addresses:H}})}),[x,y]),A=Y.useCallback(I=>{localStorage.setItem("navigator_active_protection","true"),r(P=>{const F=P.addresses[I];if(P.activeIndex!==null&&P.activeIndex!==I){const H=P.addresses[P.activeIndex];return _e.warn(`Cannot start address #${I} - address #${P.activeIndex} "${H?.address}" is already active`),qh("Please complete or cancel the current active address first"),localStorage.removeItem("navigator_active_protection"),P}if(F&&P.completions.some(X=>X.index===I&&(X.listVersion||P.currentListVersion)===P.currentListVersion))return _e.warn(`Cannot set active - address at index ${I} is already completed`),qh("This address is already completed"),localStorage.removeItem("navigator_active_protection"),P;const M=new Date().toISOString();return _e.info(`📍 STARTING CASE: Address #${I} "${F?.address}" at ${M} - SYNC BLOCKED until Complete/Cancel`),{...P,activeIndex:I,activeStartTime:M}})},[]),R=Y.useCallback(()=>{localStorage.removeItem("navigator_active_protection"),r(I=>(_e.info("📍 CANCELING ACTIVE: Clearing active state - SYNC RESUMED"),{...I,activeIndex:null,activeStartTime:null}))},[]),[,O]=Y.useState(new Set),N=Y.useRef(new Set),U=Y.useRef(new Map),K=Y.useCallback(async(I,P,F,M,H)=>{if(N.current.has(I))throw new Error(`Completion already pending for index ${I}`);const X=e,fe=X.addresses[I];if(!fe)throw new Error(`Address at index ${I} not found`);const ge=X.completions.find(xt=>xt.address===fe.address&&xt.listVersion===X.currentListVersion);if(ge){const xt=new Date(ge.timestamp).getTime(),wt=Date.now()-xt;if(wt<3e4)return qh(`Address "${fe.address}" was already completed ${Math.round(wt/1e3)} seconds ago`),Promise.reject();console.log(`🔄 RE-COMPLETING: Address "${fe.address}" was previously completed ${new Date(ge.timestamp).toLocaleString()}, allowing new completion`)}const ye=new Date().toISOString();let xe;if(X.activeIndex===I&&X.activeStartTime){const xt=new Date(X.activeStartTime).getTime(),st=new Date(ye).getTime();xe=Math.floor((st-xt)/1e3),_e.info(`⏱️ CASE TIME TRACKED: ${Math.floor(xe/60)}m ${xe%60}s on "${fe.address}"`)}const ze={index:I,address:fe.address,lat:fe.lat??null,lng:fe.lng??null,outcome:P,amount:F,timestamp:ye,listVersion:X.currentListVersion,arrangementId:M,caseReference:H,timeSpentSeconds:xe},ne=ms("create","completion",ze);try{N.current.add(I),O(new Set(N.current));const xt=`${I}_${P}_${X.currentListVersion}`;return U.current.set(xt,{timestamp:Date.now(),completion:ze}),x("create","completion",ze,ne),r(st=>(st.activeIndex===I&&(localStorage.removeItem("navigator_active_protection"),_e.info("📍 COMPLETED ACTIVE ADDRESS: Clearing active state - SYNC RESUMED")),{...st,completions:[ze,...st.completions],activeIndex:st.activeIndex===I?null:st.activeIndex,activeStartTime:st.activeIndex===I?null:st.activeStartTime})),ne}finally{N.current.delete(I),O(new Set(N.current))}},[e,x]),B=Y.useCallback(I=>{r(P=>{const F=P.completions.slice();let M=-1,H=0;for(let X=0;X<F.length;X++){const fe=F[X];if(Number(fe.index)===Number(I)&&fe.listVersion===P.currentListVersion){const ge=new Date(fe.timestamp).getTime();ge>H&&(H=ge,M=X)}}if(M>=0){const X=F[M],fe=ms("delete","completion",X);x("delete","completion",X,fe),F.splice(M,1),setTimeout(()=>y(fe),0)}return{...P,completions:F}})},[x,y]),D=Y.useCallback(()=>{const I=new Date,P=I.toISOString().slice(0,10);r(F=>{if(F.daySessions.find(fe=>fe.date===P&&!fe.end))return _e.info("Day already active for today, skipping start"),F;const H=F.daySessions.map(fe=>fe.date<P&&!fe.end?(_e.info("Auto-closing stale session from previous day:",fe),{...fe,end:new Date(fe.date+"T23:59:59.999Z").toISOString(),durationSeconds:Math.floor((new Date(fe.date+"T23:59:59.999Z").getTime()-new Date(fe.start).getTime())/1e3)}):fe),X={date:P,start:I.toISOString()};return _e.info("Starting new day session:",X),{...F,daySessions:[...H,X]}})},[]),te=Y.useCallback(()=>{const I=new Date,P=I.toISOString().slice(0,10);r(F=>{const{updatedSessions:M,closedSessions:H,endedSession:X}=AN(F.daySessions,P,I);return H.forEach(fe=>_e.info("Auto-closing stale day session before ending today",fe)),X?(_e.info("Ending day session:",X),{...F,daySessions:M}):(_e.info("No active session to end for today"),H.length>0?{...F,daySessions:M}:F)})},[]),ee=Y.useCallback(I=>new Promise(P=>{const F=new Date().toISOString(),M=`arr_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,H={...I,id:M,createdAt:F,updatedAt:F},X=ms("create","arrangement",H);x("create","arrangement",H,X),r(fe=>(setTimeout(()=>{y(X),P(M)},0),{...fe,arrangements:[...fe.arrangements,H]}))}),[x,y]),ve=Y.useCallback((I,P)=>new Promise(F=>{const M=ms("update","arrangement",{id:I,...P});r(H=>{const X={...P,id:I,updatedAt:new Date().toISOString()};x("update","arrangement",X,M);const fe=H.arrangements.map(ge=>ge.id===I?{...ge,...P,updatedAt:new Date().toISOString()}:ge);return setTimeout(()=>{y(M),F()},0),{...H,arrangements:fe}})}),[x,y]),me=Y.useCallback(I=>new Promise(P=>{r(F=>{const M=F.arrangements.find(fe=>fe.id===I);if(!M)return P(),F;const H=ms("delete","arrangement",M);x("delete","arrangement",{id:I},H);const X=F.arrangements.filter(fe=>fe.id!==I);return setTimeout(()=>{y(H),P()},0),{...F,arrangements:X}})}),[x,y]),J=Y.useCallback(I=>{r(P=>({...P,subscription:I}))},[]),ce=Y.useCallback(I=>{r(P=>({...P,reminderSettings:I}))},[]),ke=Y.useCallback((I,P,F)=>{r(M=>({...M,reminderNotifications:_N(M.reminderNotifications||[],I,P,F)}))},[]),se=Y.useCallback(()=>{r(I=>{const P=yN(I),F=wN(P,I.arrangements);return{...I,reminderNotifications:F,lastReminderProcessed:new Date().toISOString()}})},[]);Y.useEffect(()=>{const I=setInterval(()=>{a||se()},6e4);return()=>clearInterval(I)},[a,se]);function ue(I){return I&&typeof I=="object"&&Array.isArray(I.addresses)&&Array.isArray(I.completions)&&"activeIndex"in I&&Array.isArray(I.daySessions)}const j=Y.useCallback(()=>({addresses:e.addresses,completions:e.completions,activeIndex:e.activeIndex,daySessions:e.daySessions,arrangements:e.arrangements,currentListVersion:e.currentListVersion}),[e]),G=Y.useCallback(async(I,P="replace")=>{if(!ue(I))throw console.error("🚨 RESTORE VALIDATION FAILED:",{hasObj:!!I,type:typeof I,hasAddresses:I&&Array.isArray(I.addresses),hasCompletions:I&&Array.isArray(I.completions),hasActiveIndex:I&&"activeIndex"in I,hasDaySessions:I&&Array.isArray(I.daySessions),objKeys:I?Object.keys(I):null}),new Error("Invalid backup file format");const F=typeof I.currentListVersion=="number"?I.currentListVersion:1,M=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),H="ontouchstart"in window||navigator.maxTouchPoints>0;console.log("📁 RESTORE DATA ANALYSIS:",{addressCount:I.addresses.length,completionCount:I.completions.length,arrangementCount:I.arrangements?.length||0,daySessionCount:I.daySessions?.length||0,activeIndex:I.activeIndex,listVersion:F,mergeStrategy:P,isMobile:M,isTouch:H,userAgent:navigator.userAgent.substring(0,50)});const X={addresses:I.addresses,completions:bv(I.completions,F),activeIndex:I.activeIndex??null,daySessions:I.daySessions??[],arrangements:I.arrangements??[],currentListVersion:F};console.log("📁 RESTORED STATE PREPARED:",{addressCount:X.addresses.length,completionCount:X.completions.length,arrangementCount:X.arrangements.length,daySessionCount:X.daySessions.length,activeIndex:X.activeIndex,listVersion:X.currentListVersion}),r(P==="merge"?fe=>({addresses:X.currentListVersion>=fe.currentListVersion?X.addresses:fe.addresses,currentListVersion:Math.max(X.currentListVersion,fe.currentListVersion),completions:[...fe.completions,...X.completions.filter(ye=>!fe.completions.some(xe=>xe.timestamp===ye.timestamp&&xe.index===ye.index&&xe.outcome===ye.outcome))].sort((ye,xe)=>new Date(xe.timestamp).getTime()-new Date(ye.timestamp).getTime()),arrangements:Array.from(new Map([...fe.arrangements.map(ye=>[ye.id,ye]),...X.arrangements.map(ye=>[ye.id,ye])].sort(([,ye],[,xe])=>new Date(xe.updatedAt).getTime()-new Date(ye.updatedAt).getTime())).values()),daySessions:Array.from(new Map([...fe.daySessions.map(ye=>[ye.date,ye]),...X.daySessions.map(ye=>[ye.date,ye])]).values()),activeIndex:X.activeIndex??fe.activeIndex}):X),E();try{const fe={...X,_schemaVersion:il};if(console.log("💾 PERSISTING RESTORED STATE:",{addressCount:fe.addresses.length,completionCount:fe.completions.length,arrangementCount:fe.arrangements.length,daySessionCount:fe.daySessions.length,activeIndex:fe.activeIndex,listVersion:fe.currentListVersion,schemaVersion:fe._schemaVersion}),"storage"in navigator&&"persist"in navigator.storage)try{const xe=await navigator.storage.persist();console.log("📱 PERSISTENT STORAGE:",xe?"GRANTED":"DENIED")}catch(xe){console.warn("📱 PERSISTENT STORAGE REQUEST FAILED:",xe)}if(await kd.queuedSet(Sd,fe),console.log("✅ RESTORED STATE PERSISTED TO INDEXEDDB"),"storage"in navigator&&"estimate"in navigator.storage)try{const xe=await navigator.storage.estimate(),ze=xe.usage&&xe.quota?Math.round(xe.usage/xe.quota*100):"unknown";console.log("📊 STORAGE QUOTA:",{used:xe.usage?`${Math.round(xe.usage/1024/1024)}MB`:"unknown",total:xe.quota?`${Math.round(xe.quota/1024/1024)}MB`:"unknown",percentUsed:`${ze}%`})}catch(xe){console.warn("📊 STORAGE QUOTA CHECK FAILED:",xe)}const ge=await kd.queuedGet(Sd);console.log("🔍 VERIFICATION READ FROM INDEXEDDB:",{success:!!ge,addressCount:ge?.addresses?.length||0,completionCount:ge?.completions?.length||0,arrangementCount:ge?.arrangements?.length||0});const ye=Date.now();localStorage.setItem("navigator_restore_in_progress",ye.toString()),console.log("🛡️ RESTORE PROTECTION ACTIVATED:",new Date(ye).toISOString()),localStorage.setItem("navigator_last_restore",ye.toString())}catch(fe){throw _e.error("Failed to persist restored state:",fe),new Error("Restore failed: Could not save data")}},[E]),Z=Y.useCallback(I=>{const P=localStorage.getItem("navigator_last_restore");if(P){const F=Date.now()-parseInt(P);F<36e5&&console.log("⚠️ STATE CHANGE AFTER RESTORE:",{timeSinceRestore:`${Math.round(F/1e3)}s`,newStateType:typeof I,isFunction:typeof I=="function",timestamp:new Date().toISOString()})}r(F=>{const M=typeof I=="function"?I(F):I,H=[...M.completions];let X=!1;const fe=Date.now()-3e4;for(const[xe,ze]of U.current.entries())ze.timestamp<fe&&U.current.delete(xe);for(const[xe,ze]of U.current.entries()){const{completion:ne,timestamp:xt}=ze;Date.now()-xt<3e4&&(H.some(wt=>wt.index===ne.index&&wt.outcome===ne.outcome&&wt.listVersion===ne.listVersion&&Math.abs(new Date(wt.timestamp).getTime()-new Date(ne.timestamp).getTime())<1e3)||(_e.info(`🛡️ PROTECTING RECENT COMPLETION: index=${ne.index}, outcome=${ne.outcome}`),H.unshift(ne),X=!0))}let ge=X?{...M,completions:H.sort((xe,ze)=>new Date(ze.timestamp).getTime()-new Date(xe.timestamp).getTime())}:M;if(ge.activeIndex!==null&&typeof ge.activeIndex=="number"){const xe=ge.addresses[ge.activeIndex];xe?ge.completions.some(ne=>ne.address===xe.address&&(ne.listVersion||ge.currentListVersion)===ge.currentListVersion)&&(_e.info(`🔄 CLEARING ACTIVE INDEX: Address "${xe.address}" was completed on another device`),UA(`Address "${xe.address}" was completed on another device`),ge={...ge,activeIndex:null,activeStartTime:null}):(_e.warn(`🔄 CLEARING INVALID activeIndex: Index ${ge.activeIndex} is out of bounds (max: ${ge.addresses.length-1})`),ge={...ge,activeIndex:null,activeStartTime:null})}const ye=new Map;return ge.completions.forEach(xe=>{const ze=F.completions.find(ne=>ne.index===xe.index&&ne.outcome===xe.outcome&&Math.abs(new Date(ne.timestamp).getTime()-new Date(xe.timestamp).getTime())<5e3);ze&&ze.timestamp!==xe.timestamp&&ye.set(`completion_${xe.timestamp}`,{type:"completion",incoming:xe,existing:ze,resolution:"prefer_incoming"})}),ge.arrangements.forEach(xe=>{const ze=F.arrangements.find(ne=>ne.id===xe.id);if(ze&&ze.updatedAt!==xe.updatedAt){const ne=new Date(xe.updatedAt).getTime(),xt=new Date(ze.updatedAt).getTime();ye.set(`arrangement_${xe.id}`,{type:"arrangement",incoming:xe,existing:ze,resolution:ne>xt?"prefer_incoming":"prefer_existing"})}}),ye.size>0&&(_e.debug("Detected state conflicts:",ye.size),v(ye)),ge}),E()},[E]),oe=Y.useCallback((I,P,F,M)=>x(P,I,F,M),[x]);return{state:d,baseState:e,loading:a,setState:Z,setBaseState:r,deviceId:c,enqueueOp:oe,optimisticUpdates:t.updates,pendingOperations:t.pendingOperations,confirmOptimisticUpdate:y,revertOptimisticUpdate:k,clearOptimisticUpdates:E,conflicts:m,resolveConflict:(I,P)=>{v(F=>{const M=new Map(F);return M.delete(I),M})},setAddresses:b,addAddress:S,setActive:A,cancelActive:R,complete:K,undo:B,startDay:D,endDay:te,addArrangement:ee,updateArrangement:ve,deleteArrangement:me,setSubscription:J,backupState:j,restoreState:G,updateReminderSettings:ce,updateReminderNotification:ke,processReminders:se}}function jd(e){const r=e??{},t=typeof r.currentListVersion=="number"?r.currentListVersion:1;return{...r,addresses:Array.isArray(r.addresses)?r.addresses:[],completions:Array.isArray(r.completions)?r.completions:[],arrangements:Array.isArray(r.arrangements)?r.arrangements:[],daySessions:Array.isArray(r.daySessions)?r.daySessions:[],activeIndex:typeof r.activeIndex=="number"?r.activeIndex:null,currentListVersion:t}}function Qh(e){const r=e??{};return{addresses:Array.isArray(r.addresses)?r.addresses:[],completions:Array.isArray(r.completions)?r.completions:[],arrangements:Array.isArray(r.arrangements)?r.arrangements:[],activeIndex:typeof r.activeIndex=="number"?r.activeIndex:null,currentListVersion:typeof r.currentListVersion=="number"?r.currentListVersion:1}}function lo(e){const r=a=>{if(!a||typeof a!="object"||Array.isArray(a))return!1;const l=Object.getPrototypeOf(a);return l===Object.prototype||l===null},t=JSON.stringify(e,(a,l)=>{if(!l||typeof l!="object")return l;if(l instanceof Date)return l.toISOString();if(typeof l.toJSON=="function"&&!r(l))return l.toJSON(a);if(r(l)){const c={};return Object.keys(l).sort().forEach(d=>{c[d]=l[d]}),c}return l});let n=0;for(let a=0;a<t.length;a++){const l=t.charCodeAt(a);n=(n<<5)-n+l,n=n&n}return n.toString()}class gs{static generateDeviceFingerprint(){try{const r=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.hardwareConcurrency||"unknown"];return`device_${btoa(r.join("|")).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}_${Date.now()}`}catch{return`device_fallback_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}}static analyzeDataOwnership(r,t,n){const a={hasLocalData:this.hasSignificantLocalData(r),hasCloudData:n?this.hasSignificantLocalData(n):!1,localDataAge:this.estimateDataAge(r),userInLocalData:this.findUserSignalsInData(r,t),cloudUserMatch:n?this.findUserSignalsInData(n,t):null};return _e.info("User detection signals:",a),a.hasCloudData&&a.cloudUserMatch?a.hasLocalData?a.userInLocalData?{isOwner:!0,confidence:"high",reason:"Both local and cloud data belong to user",action:"sync"}:{isOwner:!0,confidence:"medium",reason:"Cloud data belongs to user, local data unclear",action:"preserve_and_ask"}:{isOwner:!0,confidence:"high",reason:"Cloud data exists for user, no local conflict",action:"sync"}:a.hasLocalData&&a.userInLocalData?{isOwner:!0,confidence:"medium",reason:"Local data appears to belong to current user",action:"sync"}:a.hasLocalData&&!a.userInLocalData&&!a.hasCloudData?{isOwner:!1,confidence:"low",reason:"Local data has no user identification",action:"preserve_and_ask"}:{isOwner:!0,confidence:"low",reason:"Unclear ownership - preserving data for safety",action:"preserve_and_ask"}}static hasSignificantLocalData(r){const t=Array.isArray(r.addresses)?r.addresses.length:0,n=Array.isArray(r.completions)?r.completions.length:0,a=Array.isArray(r.arrangements)?r.arrangements.length:0;return t>5||n>0||a>0}static estimateDataAge(r){try{const t=Array.isArray(r.completions)?r.completions:[],n=Array.isArray(r.arrangements)?r.arrangements:[],a=[...t.map(d=>d.timestamp),...n.map(d=>d.updatedAt||d.createdAt)].filter(Boolean);if(a.length===0)return"unknown";const l=Math.max(...a.map(d=>new Date(d).getTime())),c=(Date.now()-l)/(1e3*60*60);return c<24?"recent":(c<168,"old")}catch{return"unknown"}}static findUserSignalsInData(r,t){try{const n=Array.isArray(r.arrangements)?r.arrangements:[],a=t.email?.toLowerCase();return a&&n.some(m=>m.customerName?.toLowerCase().includes(a)||m.notes?.toLowerCase().includes(a))?!0:(Array.isArray(r.completions)?r.completions:[]).filter(d=>(Date.now()-new Date(d.timestamp).getTime())/36e5<24).length>0}catch{return!1}}static storeDeviceContext(r){try{const t={userId:r.id,email:r.email||void 0,deviceId:this.generateDeviceFingerprint(),sessionStart:new Date().toISOString()};localStorage.setItem("navigator_device_context",JSON.stringify(t));const n=lo(t);localStorage.setItem("navigator_device_context_checksum",n),_e.info("Device context stored:",{userId:t.userId,deviceId:t.deviceId})}catch(t){_e.error("Failed to store device context:",t)}}static getDeviceContext(){try{const r=localStorage.getItem("navigator_device_context"),t=localStorage.getItem("navigator_device_context_checksum");if(!r)return null;const n=JSON.parse(r);return t&&lo(n)!==t?(_e.warn("Device context checksum mismatch - data may be corrupted"),null):n}catch(r){return _e.error("Failed to get device context:",r),null}}static clearDeviceContext(){try{localStorage.removeItem("navigator_device_context"),localStorage.removeItem("navigator_device_context_checksum")}catch(r){_e.error("Failed to clear device context:",r)}}}const DN=Object.freeze(Object.defineProperty({__proto__:null,SmartUserDetection:gs},Symbol.toStringTag,{value:"Module"})),ON="modulepreload",FN=function(e){return"/navigator-web/"+e},Tv={},ri=function(r,t,n){let a=Promise.resolve();if(t&&t.length>0){let v=function(x){return Promise.all(x.map(y=>Promise.resolve(y).then(k=>({status:"fulfilled",value:k}),k=>({status:"rejected",reason:k}))))};var c=v;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),m=d?.nonce||d?.getAttribute("nonce");a=v(t.map(x=>{if(x=FN(x),x in Tv)return;Tv[x]=!0;const y=x.endsWith(".css"),k=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${k}`))return;const E=document.createElement("link");if(E.rel=y?"stylesheet":ON,y||(E.as="script"),E.crossOrigin="",E.href=x,m&&E.setAttribute("nonce",m),document.head.appendChild(E),y)return new Promise((b,S)=>{E.addEventListener("load",b),E.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${x}`)))})}))}function l(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return a.then(d=>{for(const m of d||[])m.status==="rejected"&&l(m.reason);return r().catch(l)})},LN=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>ri(async()=>{const{default:n}=await Promise.resolve().then(()=>Il);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)};class pm extends Error{constructor(r,t="FunctionsError",n){super(r),this.name=t,this.context=n}}class RN extends pm{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class Ev extends pm{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class Cv extends pm{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var k0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(k0||(k0={}));var jN=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{v(n.next(x))}catch(y){c(y)}}function m(x){try{v(n.throw(x))}catch(y){c(y)}}function v(x){x.done?l(x.value):a(x.value).then(d,m)}v((n=n.apply(e,r||[])).next())})};class MN{constructor(r,{headers:t={},customFetch:n,region:a=k0.Any}={}){this.url=r,this.headers=t,this.region=a,this.fetch=LN(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,t={}){var n;return jN(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:c}=t;let d={},{region:m}=t;m||(m=this.region);const v=new URL(`${this.url}/${r}`);m&&m!=="any"&&(d["x-region"]=m,v.searchParams.set("forceFunctionRegion",m));let x;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",x=c):typeof c=="string"?(d["Content-Type"]="text/plain",x=c):typeof FormData<"u"&&c instanceof FormData?x=c:(d["Content-Type"]="application/json",x=JSON.stringify(c)));const y=yield this.fetch(v.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),a),body:x}).catch(S=>{throw new RN(S)}),k=y.headers.get("x-relay-error");if(k&&k==="true")throw new Ev(y);if(!y.ok)throw new Cv(y);let E=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),b;return E==="application/json"?b=yield y.json():E==="application/octet-stream"?b=yield y.blob():E==="text/event-stream"?b=y:E==="multipart/form-data"?b=yield y.formData():b=yield y.text(),{data:b,error:null,response:y}}catch(a){return{data:null,error:a,response:a instanceof Cv||a instanceof Ev?a.context:void 0}}})}}var Wr={},sl={},ol={},ll={},cl={},ul={},BN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},El=BN();const zN=El.fetch,ty=El.fetch.bind(El),ry=El.Headers,UN=El.Request,$N=El.Response,Il=Object.freeze(Object.defineProperty({__proto__:null,Headers:ry,Request:UN,Response:$N,default:ty,fetch:zN},Symbol.toStringTag,{value:"Module"})),WN=S_(Il);var Ed={},Av;function ny(){if(Av)return Ed;Av=1,Object.defineProperty(Ed,"__esModule",{value:!0});class e extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Ed.default=e,Ed}var Pv;function ay(){if(Pv)return ul;Pv=1;var e=ul&&ul.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ul,"__esModule",{value:!0});const r=e(WN),t=e(ny());class n{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let m=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async v=>{var x,y,k,E;let b=null,S=null,A=null,R=v.status,O=v.statusText;if(v.ok){if(this.method!=="HEAD"){const B=await v.text();B===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((x=this.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?S=B:S=JSON.parse(B))}const U=(y=this.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),K=(k=v.headers.get("content-range"))===null||k===void 0?void 0:k.split("/");U&&K&&K.length>1&&(A=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(S)&&(S.length>1?(b={code:"PGRST116",details:`Results contain ${S.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},S=null,A=null,R=406,O="Not Acceptable"):S.length===1?S=S[0]:S=null)}else{const U=await v.text();try{b=JSON.parse(U),Array.isArray(b)&&v.status===404&&(S=[],b=null,R=200,O="OK")}catch{v.status===404&&U===""?(R=204,O="No Content"):b={message:U}}if(b&&this.isMaybeSingle&&(!((E=b?.details)===null||E===void 0)&&E.includes("0 rows"))&&(b=null,R=200,O="OK"),b&&this.shouldThrowOnError)throw new t.default(b)}return{error:b,data:S,count:A,status:R,statusText:O}});return this.shouldThrowOnError||(m=m.catch(v=>{var x,y,k;return{error:{message:`${(x=v?.name)!==null&&x!==void 0?x:"FetchError"}: ${v?.message}`,details:`${(y=v?.stack)!==null&&y!==void 0?y:""}`,hint:"",code:`${(k=v?.code)!==null&&k!==void 0?k:""}`},data:null,count:null,status:0,statusText:""}})),m.then(l,c)}returns(){return this}overrideTypes(){return this}}return ul.default=n,ul}var Nv;function iy(){if(Nv)return cl;Nv=1;var e=cl&&cl.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cl,"__esModule",{value:!0});const r=e(ay());class t extends r.default{select(a){let l=!1;const c=(a??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:m=d}={}){const v=m?`${m}.order`:"order",x=this.url.searchParams.get(v);return this.url.searchParams.set(v,`${x?`${x},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:d=c}={}){const m=typeof d>"u"?"offset":`${d}.offset`,v=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(m,`${a}`),this.url.searchParams.set(v,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:m=!1,format:v="text"}={}){var x;const y=[a?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,m?"wal":null].filter(Boolean).join("|"),k=(x=this.headers.get("Accept"))!==null&&x!==void 0?x:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${v}; for="${k}"; options=${y};`),v==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return cl.default=t,cl}var Iv;function gm(){if(Iv)return ll;Iv=1;var e=ll&&ll.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ll,"__esModule",{value:!0});const r=e(iy());class t extends r.default{eq(a,l){return this.url.searchParams.append(a,`eq.${l}`),this}neq(a,l){return this.url.searchParams.append(a,`neq.${l}`),this}gt(a,l){return this.url.searchParams.append(a,`gt.${l}`),this}gte(a,l){return this.url.searchParams.append(a,`gte.${l}`),this}lt(a,l){return this.url.searchParams.append(a,`lt.${l}`),this}lte(a,l){return this.url.searchParams.append(a,`lte.${l}`),this}like(a,l){return this.url.searchParams.append(a,`like.${l}`),this}likeAllOf(a,l){return this.url.searchParams.append(a,`like(all).{${l.join(",")}}`),this}likeAnyOf(a,l){return this.url.searchParams.append(a,`like(any).{${l.join(",")}}`),this}ilike(a,l){return this.url.searchParams.append(a,`ilike.${l}`),this}ilikeAllOf(a,l){return this.url.searchParams.append(a,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(a,l){return this.url.searchParams.append(a,`ilike(any).{${l.join(",")}}`),this}is(a,l){return this.url.searchParams.append(a,`is.${l}`),this}in(a,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}contains(a,l){return typeof l=="string"?this.url.searchParams.append(a,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(a,`cs.{${l.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(l)}`),this}containedBy(a,l){return typeof l=="string"?this.url.searchParams.append(a,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(a,`cd.{${l.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(l)}`),this}rangeGt(a,l){return this.url.searchParams.append(a,`sr.${l}`),this}rangeGte(a,l){return this.url.searchParams.append(a,`nxl.${l}`),this}rangeLt(a,l){return this.url.searchParams.append(a,`sl.${l}`),this}rangeLte(a,l){return this.url.searchParams.append(a,`nxr.${l}`),this}rangeAdjacent(a,l){return this.url.searchParams.append(a,`adj.${l}`),this}overlaps(a,l){return typeof l=="string"?this.url.searchParams.append(a,`ov.${l}`):this.url.searchParams.append(a,`ov.{${l.join(",")}}`),this}textSearch(a,l,{config:c,type:d}={}){let m="";d==="plain"?m="pl":d==="phrase"?m="ph":d==="websearch"&&(m="w");const v=c===void 0?"":`(${c})`;return this.url.searchParams.append(a,`${m}fts${v}.${l}`),this}match(a){return Object.entries(a).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(a,l,c){return this.url.searchParams.append(a,`not.${l}.${c}`),this}or(a,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,l,c){return this.url.searchParams.append(a,`${l}.${c}`),this}}return ll.default=t,ll}var Dv;function sy(){if(Dv)return ol;Dv=1;var e=ol&&ol.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ol,"__esModule",{value:!0});const r=e(gm());class t{constructor(a,{headers:l={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(a,{head:l=!1,count:c}={}){const d=l?"HEAD":"GET";let m=!1;const v=(a??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",v),c&&this.headers.append("Prefer",`count=${c}`),new r.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var d;const m="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const v=a.reduce((x,y)=>x.concat(Object.keys(y)),[]);if(v.length>0){const x=[...new Set(v)].map(y=>`"${y}"`);this.url.searchParams.set("columns",x.join(","))}}return new r.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:m=!0}={}){var v;const x="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),m||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const y=a.reduce((k,E)=>k.concat(Object.keys(E)),[]);if(y.length>0){const k=[...new Set(y)].map(E=>`"${E}"`);this.url.searchParams.set("columns",k.join(","))}}return new r.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(v=this.fetch)!==null&&v!==void 0?v:fetch})}update(a,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new r.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new r.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return ol.default=t,ol}var Ov;function VN(){if(Ov)return sl;Ov=1;var e=sl&&sl.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(sl,"__esModule",{value:!0});const r=e(sy()),t=e(gm());class n{constructor(l,{headers:c={},schema:d,fetch:m}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=m}from(l){const c=new URL(`${this.url}/${l}`);return new r.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new n(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:m=!1,count:v}={}){var x;let y;const k=new URL(`${this.url}/rpc/${l}`);let E;d||m?(y=d?"HEAD":"GET",Object.entries(c).filter(([S,A])=>A!==void 0).map(([S,A])=>[S,Array.isArray(A)?`{${A.join(",")}}`:`${A}`]).forEach(([S,A])=>{k.searchParams.append(S,A)})):(y="POST",E=c);const b=new Headers(this.headers);return v&&b.set("Prefer",`count=${v}`),new t.default({method:y,url:k,headers:b,schema:this.schemaName,body:E,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}}return sl.default=n,sl}var Fv;function HN(){if(Fv)return Wr;Fv=1;var e=Wr&&Wr.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.PostgrestError=Wr.PostgrestBuilder=Wr.PostgrestTransformBuilder=Wr.PostgrestFilterBuilder=Wr.PostgrestQueryBuilder=Wr.PostgrestClient=void 0;const r=e(VN());Wr.PostgrestClient=r.default;const t=e(sy());Wr.PostgrestQueryBuilder=t.default;const n=e(gm());Wr.PostgrestFilterBuilder=n.default;const a=e(iy());Wr.PostgrestTransformBuilder=a.default;const l=e(ay());Wr.PostgrestBuilder=l.default;const c=e(ny());return Wr.PostgrestError=c.default,Wr.default={PostgrestClient:r.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},Wr}var GN=HN();const ZN=rf(GN),{PostgrestClient:KN,PostgrestQueryBuilder:hD,PostgrestFilterBuilder:mD,PostgrestTransformBuilder:pD,PostgrestBuilder:gD,PostgrestError:vD}=ZN;class qN{static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let t=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(t+=`

Suggested solution: ${r.workaround}`),new Error(t)}static createWebSocket(r,t){const n=this.getWebSocketConstructor();return new n(r,t)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const YN="2.15.1",XN=`realtime-js/${YN}`,JN="1.0.0",b0=1e4,QN=1e3,e4=100;var Rc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Rc||(Rc={}));var Or;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Or||(Or={}));var Ia;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Ia||(Ia={}));var S0;(function(e){e.websocket="websocket"})(S0||(S0={}));var no;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(no||(no={}));class t4{constructor(){this.HEADER_LENGTH=1}decode(r,t){return r.constructor===ArrayBuffer?t(this._binaryDecode(r)):t(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const t=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,t,n)}_decodeBroadcast(r,t,n){const a=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const d=n.decode(r.slice(c,c+a));c=c+a;const m=n.decode(r.slice(c,c+l));c=c+l;const v=JSON.parse(n.decode(r.slice(c,r.byteLength)));return{ref:null,topic:d,event:m,payload:v}}}class oy{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var er;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(er||(er={}));const Lv=(e,r,t={})=>{var n;const a=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((l,c)=>(l[c]=r4(c,e,r,a),l),{})},r4=(e,r,t,n)=>{const a=r.find(d=>d.name===e),l=a?.type,c=t[e];return l&&!n.includes(l)?ly(l,c):T0(c)},ly=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return s4(r,t)}switch(e){case er.bool:return n4(r);case er.float4:case er.float8:case er.int2:case er.int4:case er.int8:case er.numeric:case er.oid:return a4(r);case er.json:case er.jsonb:return i4(r);case er.timestamp:return o4(r);case er.abstime:case er.date:case er.daterange:case er.int4range:case er.int8range:case er.money:case er.reltime:case er.text:case er.time:case er.timestamptz:case er.timetz:case er.tsrange:case er.tstzrange:return T0(r);default:return T0(r)}},T0=e=>e,n4=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},a4=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},i4=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(r){return console.log(`JSON parse error: ${r}`),e}return e},s4=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,n=e[t];if(e[0]==="{"&&n==="}"){let l;const c=e.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>ly(r,d))}return e},o4=e=>typeof e=="string"?e.replace(" ","T"):e,cy=e=>{let r=e;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")+"/api/broadcast"};class e0{constructor(r,t,n={},a=b0){this.channel=r,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var n;return this._hasReceived(r)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Rv;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Rv||(Rv={}));class jc{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jc.syncState(this.state,a,l,c),this.pendingDiffs.forEach(m=>{this.state=jc.syncDiff(this.state,m,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(n.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=jc.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,n,a){const l=this.cloneDeep(r),c=this.transformState(t),d={},m={};return this.map(l,(v,x)=>{c[v]||(m[v]=x)}),this.map(c,(v,x)=>{const y=l[v];if(y){const k=x.map(A=>A.presence_ref),E=y.map(A=>A.presence_ref),b=x.filter(A=>E.indexOf(A.presence_ref)<0),S=y.filter(A=>k.indexOf(A.presence_ref)<0);b.length>0&&(d[v]=b),S.length>0&&(m[v]=S)}else d[v]=x}),this.syncDiff(l,{joins:d,leaves:m},n,a)}static syncDiff(r,t,n,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(l,(d,m)=>{var v;const x=(v=r[d])!==null&&v!==void 0?v:[];if(r[d]=this.cloneDeep(m),x.length>0){const y=r[d].map(E=>E.presence_ref),k=x.filter(E=>y.indexOf(E.presence_ref)<0);r[d].unshift(...k)}n(d,x,m)}),this.map(c,(d,m)=>{let v=r[d];if(!v)return;const x=m.map(y=>y.presence_ref);v=v.filter(y=>x.indexOf(y.presence_ref)<0),r[d]=v,a(d,v,m),v.length===0&&delete r[d]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(n=>t(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,n)=>{const a=r[n];return"metas"in a?t[n]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[n]=a,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var jv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(jv||(jv={}));var Mc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Mc||(Mc={}));var Ci;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ci||(Ci={}));class vm{constructor(r,t={config:{}},n){this.topic=r,this.params=t,this.socket=n,this.bindings={},this.state=Or.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new e0(this,Ia.join,this.params,this.timeout),this.rejoinTimer=new oy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Or.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Or.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Or.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Or.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Or.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ia.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new jc(this),this.broadcastEndpointURL=cy(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(r,t=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Or.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,m=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(k=>k.filter))!==null&&a!==void 0?a:[],v=!!this.bindings[Mc.PRESENCE]&&this.bindings[Mc.PRESENCE].length>0,x={},y={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:v}),postgres_changes:m,private:d};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(k=>r?.(Ci.CHANNEL_ERROR,k)),this._onClose(()=>r?.(Ci.CLOSED)),this.updateJoinPayload(Object.assign({config:y},x)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:k})=>{var E;if(this.socket.setAuth(),k===void 0){r?.(Ci.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,S=(E=b?.length)!==null&&E!==void 0?E:0,A=[];for(let R=0;R<S;R++){const O=b[R],{filter:{event:N,schema:U,table:K,filter:B}}=O,D=k&&k[R];if(D&&D.event===N&&D.schema===U&&D.table===K&&D.filter===B)A.push(Object.assign(Object.assign({},O),{id:D.id}));else{this.unsubscribe(),this.state=Or.errored,r?.(Ci.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=A,r&&r(Ci.SUBSCRIBED);return}}).receive("error",k=>{this.state=Or.errored,r?.(Ci.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(k).join(", ")||"error")))}).receive("timeout",()=>{r?.(Ci.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,n){return this.state===Or.joined&&r===Mc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(r,t,n)}async send(r,t={}){var n,a;if(!this._canPush()&&r.type==="broadcast"){const{event:l,payload:c}=r,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const v=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=v.body)===null||a===void 0?void 0:a.cancel()),v.ok?"ok":"error"}catch(v){return v.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,m;const v=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((m=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||m===void 0)&&m.ack)&&l("ok"),v.receive("ok",()=>l("ok")),v.receive("error",()=>l("error")),v.receive("timeout",()=>l("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Or.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ia.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new e0(this,Ia.leave,{},r),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Or.closed,this.bindings={}}async _fetchWithTimeout(r,t,n){const a=new AbortController,l=setTimeout(()=>a.abort(),n),c=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(r,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new e0(this,r,t,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>e4){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(r,t,n){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,n){var a,l;const c=r.toLocaleLowerCase(),{close:d,error:m,leave:v,join:x}=Ia;if(n&&[d,m,v,x].indexOf(c)>=0&&n!==this._joinRef())return;let k=this._onMessage(c,t,n);if(t&&!k)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(E=>{var b,S,A;return((b=E.filter)===null||b===void 0?void 0:b.event)==="*"||((A=(S=E.filter)===null||S===void 0?void 0:S.event)===null||A===void 0?void 0:A.toLocaleLowerCase())===c}).map(E=>E.callback(k,n)):(l=this.bindings[c])===null||l===void 0||l.filter(E=>{var b,S,A,R,O,N;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in E){const U=E.id,K=(b=E.filter)===null||b===void 0?void 0:b.event;return U&&((S=t.ids)===null||S===void 0?void 0:S.includes(U))&&(K==="*"||K?.toLocaleLowerCase()===((A=t.data)===null||A===void 0?void 0:A.type.toLocaleLowerCase()))}else{const U=(O=(R=E?.filter)===null||R===void 0?void 0:R.event)===null||O===void 0?void 0:O.toLocaleLowerCase();return U==="*"||U===((N=t?.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return E.type.toLocaleLowerCase()===c}).map(E=>{if(typeof k=="object"&&"ids"in k){const b=k.data,{schema:S,table:A,commit_timestamp:R,type:O,errors:N}=b;k=Object.assign(Object.assign({},{schema:S,table:A,commit_timestamp:R,eventType:O,new:{},old:{},errors:N}),this._getPayloadRecords(b))}E.callback(k,n)})}_isClosed(){return this.state===Or.closed}_isJoined(){return this.state===Or.joined}_isJoining(){return this.state===Or.joining}_isLeaving(){return this.state===Or.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,n){const a=r.toLocaleLowerCase(),l={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(r,t){const n=r.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&vm.isEqual(a.filter,t))})),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(r[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Ia.close,{},r)}_onError(r){this._on(Ia.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Or.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=Lv(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=Lv(r.columns,r.old_record)),t}}const Mv=()=>{},Cd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},l4=[1e3,2e3,5e3,1e4],c4=1e4,u4=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class d4{constructor(r,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=b0,this.transport=null,this.heartbeatIntervalMs=Cd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Mv,this.ref=0,this.reconnectTimer=null,this.logger=Mv,this.conn=null,this.sendBuffer=[],this.serializer=new t4,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let l;return a?l=a:typeof fetch>"u"?l=(...c)=>ri(async()=>{const{default:d}=await Promise.resolve().then(()=>Il);return{default:d}},void 0).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${r}/${S0.websocket}`,this.httpEndpoint=cy(r),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=qN.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const t=r.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:JN}))}disconnect(r,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},r?this.conn.close(r,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,t,n){this.logger(r,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Rc.connecting:return no.Connecting;case Rc.open:return no.Open;case Rc.closing:return no.Closing;default:return no.Closed}}isConnected(){return this.connectionState()===no.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,t={config:{}}){const n=`realtime:${r}`,a=this.getChannels().find(l=>l.topic===n);if(a)return a;{const l=new vm(`realtime:${r}`,t,this);return this.channels.push(l),l}}push(r){const{topic:t,event:n,payload:a,ref:l}=r,c=()=>{this.encode(r,d=>{var m;(m=this.conn)===null||m===void 0||m.send(d)})};this.log("push",`${t} ${n} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var r;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(QN,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Cd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:l,ref:c}=t,d=c?`(${c})`:"",m=l.status||"";this.log("receive",`${m} ${n} ${a} ${d}`.trim(),l),this.channels.filter(v=>v._isMember(n)).forEach(v=>v._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(r){var t;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){var t;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(Ia.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const n=r.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${r}${n}${a}`}_workerObjectUrl(r){let t;if(r)t=r;else{const n=new Blob([u4],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(r,t=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(r=null){let t;r?t=r:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const a={access_token:t,version:XN};t&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Ia.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${r}`,t)})}_triggerStateCallbacks(r,t){try{this.stateChangeCallbacks[r].forEach(n=>{try{n(t)}catch(a){this.log("error",`error in ${r} callback`,a)}})}catch(n){this.log("error",`error triggering ${r} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new oy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Cd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var t,n,a,l,c,d,m,v;if(this.transport=(t=r?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=r?.timeout)!==null&&n!==void 0?n:b0,this.heartbeatIntervalMs=(a=r?.heartbeatIntervalMs)!==null&&a!==void 0?a:Cd.HEARTBEAT_INTERVAL,this.worker=(l=r?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=r?.accessToken)!==null&&c!==void 0?c:null,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=r?.reconnectAfterMs)!==null&&d!==void 0?d:(x=>l4[x-1]||c4),this.encode=(m=r?.encode)!==null&&m!==void 0?m:((x,y)=>y(JSON.stringify(x))),this.decode=(v=r?.decode)!==null&&v!==void 0?v:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}class xm extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function Fr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class f4 extends xm{constructor(r,t,n){super(r),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class E0 extends xm{constructor(r,t){super(r),this.name="StorageUnknownError",this.originalError=t}}var h4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{v(n.next(x))}catch(y){c(y)}}function m(x){try{v(n.throw(x))}catch(y){c(y)}}function v(x){x.done?l(x.value):a(x.value).then(d,m)}v((n=n.apply(e,r||[])).next())})};const uy=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>ri(async()=>{const{default:n}=await Promise.resolve().then(()=>Il);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},m4=()=>h4(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ri(()=>Promise.resolve().then(()=>Il),void 0)).Response:Response}),C0=e=>{if(Array.isArray(e))return e.map(t=>C0(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,n])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));r[a]=C0(n)}),r},p4=e=>{if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var yo=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{v(n.next(x))}catch(y){c(y)}}function m(x){try{v(n.throw(x))}catch(y){c(y)}}function v(x){x.done?l(x.value):a(x.value).then(d,m)}v((n=n.apply(e,r||[])).next())})};const t0=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),g4=(e,r,t)=>yo(void 0,void 0,void 0,function*(){const n=yield m4();e instanceof n&&!t?.noResolveJson?e.json().then(a=>{const l=e.status||500,c=a?.statusCode||l+"";r(new f4(t0(a),l,c))}).catch(a=>{r(new E0(t0(a),a))}):r(new E0(t0(e),e))}),v4=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return e==="GET"||!n?a:(p4(n)?(a.headers=Object.assign({"Content-Type":"application/json"},r?.headers),a.body=JSON.stringify(n)):a.body=n,r?.duplex&&(a.duplex=r.duplex),Object.assign(Object.assign({},a),t))};function au(e,r,t,n,a,l){return yo(this,void 0,void 0,function*(){return new Promise((c,d)=>{e(t,v4(r,n,a,l)).then(m=>{if(!m.ok)throw m;return n?.noResolveJson?m:m.json()}).then(m=>c(m)).catch(m=>g4(m,d,n))})})}function ef(e,r,t,n){return yo(this,void 0,void 0,function*(){return au(e,"GET",r,t,n)})}function Qa(e,r,t,n,a){return yo(this,void 0,void 0,function*(){return au(e,"POST",r,n,a,t)})}function A0(e,r,t,n,a){return yo(this,void 0,void 0,function*(){return au(e,"PUT",r,n,a,t)})}function x4(e,r,t,n){return yo(this,void 0,void 0,function*(){return au(e,"HEAD",r,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function dy(e,r,t,n,a){return yo(this,void 0,void 0,function*(){return au(e,"DELETE",r,n,a,t)})}var xn=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{v(n.next(x))}catch(y){c(y)}}function m(x){try{v(n.throw(x))}catch(y){c(y)}}function v(x){x.done?l(x.value):a(x.value).then(d,m)}v((n=n.apply(e,r||[])).next())})};const y4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Bv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class _4{constructor(r,t={},n,a){this.url=r,this.headers=t,this.bucketId=n,this.fetch=uy(a)}uploadOrUpdate(r,t,n,a){return xn(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Bv),a);let d=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(c.upsert)});const m=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m))):(l=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,m&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),a?.headers&&(d=Object.assign(Object.assign({},d),a.headers));const v=this._removeEmptyFolders(t),x=this._getFinalPath(v),y=yield(r=="PUT"?A0:Qa)(this.fetch,`${this.url}/object/${x}`,l,Object.assign({headers:d},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:v,id:y.Id,fullPath:y.Key},error:null}}catch(l){if(Fr(l))return{data:null,error:l};throw l}})}upload(r,t,n){return xn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,t,n)})}uploadToSignedUrl(r,t,n,a){return xn(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(r),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",t);try{let m;const v=Object.assign({upsert:Bv.upsert},a),x=Object.assign(Object.assign({},this.headers),{"x-upsert":String(v.upsert)});typeof Blob<"u"&&n instanceof Blob?(m=new FormData,m.append("cacheControl",v.cacheControl),m.append("",n)):typeof FormData<"u"&&n instanceof FormData?(m=n,m.append("cacheControl",v.cacheControl)):(m=n,x["cache-control"]=`max-age=${v.cacheControl}`,x["content-type"]=v.contentType);const y=yield A0(this.fetch,d.toString(),m,{headers:x});return{data:{path:l,fullPath:y.Key},error:null}}catch(m){if(Fr(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(r,t){return xn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const a=Object.assign({},this.headers);t?.upsert&&(a["x-upsert"]="true");const l=yield Qa(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new xm("No token returned by API");return{data:{signedUrl:c.toString(),path:r,token:d},error:null}}catch(n){if(Fr(n))return{data:null,error:n};throw n}})}update(r,t,n){return xn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,t,n)})}move(r,t,n){return xn(this,void 0,void 0,function*(){try{return{data:yield Qa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Fr(a))return{data:null,error:a};throw a}})}copy(r,t,n){return xn(this,void 0,void 0,function*(){try{return{data:{path:(yield Qa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Fr(a))return{data:null,error:a};throw a}})}createSignedUrl(r,t,n){return xn(this,void 0,void 0,function*(){try{let a=this._getFinalPath(r),l=yield Qa(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n?.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(Fr(a))return{data:null,error:a};throw a}})}createSignedUrls(r,t,n){return xn(this,void 0,void 0,function*(){try{const a=yield Qa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:r},{headers:this.headers}),l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(Fr(a))return{data:null,error:a};throw a}})}download(r,t){return xn(this,void 0,void 0,function*(){const a=typeof t?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(t?.transform||{}),c=l?`?${l}`:"";try{const d=this._getFinalPath(r);return{data:yield(yield ef(this.fetch,`${this.url}/${a}/${d}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(Fr(d))return{data:null,error:d};throw d}})}info(r){return xn(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{const n=yield ef(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:C0(n),error:null}}catch(n){if(Fr(n))return{data:null,error:n};throw n}})}exists(r){return xn(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{return yield x4(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Fr(n)&&n instanceof E0){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,t){const n=this._getFinalPath(r),a=[],l=t?.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&a.push(l);const d=typeof t?.transform<"u"?"render/image":"object",m=this.transformOptsToQueryString(t?.transform||{});m!==""&&a.push(m);let v=a.join("&");return v!==""&&(v=`?${v}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${n}${v}`)}}}remove(r){return xn(this,void 0,void 0,function*(){try{return{data:yield dy(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(t){if(Fr(t))return{data:null,error:t};throw t}})}list(r,t,n){return xn(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},y4),t),{prefix:r||""});return{data:yield Qa(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Fr(a))return{data:null,error:a};throw a}})}listV2(r,t){return xn(this,void 0,void 0,function*(){try{const n=Object.assign({},r);return{data:yield Qa(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(Fr(n))return{data:null,error:n};throw n}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const t=[];return r.width&&t.push(`width=${r.width}`),r.height&&t.push(`height=${r.height}`),r.resize&&t.push(`resize=${r.resize}`),r.format&&t.push(`format=${r.format}`),r.quality&&t.push(`quality=${r.quality}`),t.join("&")}}const w4="2.11.0",k4={"X-Client-Info":`storage-js/${w4}`};var dl=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{v(n.next(x))}catch(y){c(y)}}function m(x){try{v(n.throw(x))}catch(y){c(y)}}function v(x){x.done?l(x.value):a(x.value).then(d,m)}v((n=n.apply(e,r||[])).next())})};class b4{constructor(r,t={},n,a){const l=new URL(r);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},k4),t),this.fetch=uy(n)}listBuckets(){return dl(this,void 0,void 0,function*(){try{return{data:yield ef(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(Fr(r))return{data:null,error:r};throw r}})}getBucket(r){return dl(this,void 0,void 0,function*(){try{return{data:yield ef(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(t){if(Fr(t))return{data:null,error:t};throw t}})}createBucket(r,t={public:!1}){return dl(this,void 0,void 0,function*(){try{return{data:yield Qa(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Fr(n))return{data:null,error:n};throw n}})}updateBucket(r,t){return dl(this,void 0,void 0,function*(){try{return{data:yield A0(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Fr(n))return{data:null,error:n};throw n}})}emptyBucket(r){return dl(this,void 0,void 0,function*(){try{return{data:yield Qa(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Fr(t))return{data:null,error:t};throw t}})}deleteBucket(r){return dl(this,void 0,void 0,function*(){try{return{data:yield dy(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(t){if(Fr(t))return{data:null,error:t};throw t}})}}class S4 extends b4{constructor(r,t={},n,a){super(r,t,n,a)}from(r){return new _4(this.url,this.headers,r,this.fetch)}}const T4="2.56.0";let Tc="";typeof Deno<"u"?Tc="deno":typeof document<"u"?Tc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Tc="react-native":Tc="node";const E4={"X-Client-Info":`supabase-js-${Tc}/${T4}`},C4={headers:E4},A4={schema:"public"},P4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},N4={};var I4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{v(n.next(x))}catch(y){c(y)}}function m(x){try{v(n.throw(x))}catch(y){c(y)}}function v(x){x.done?l(x.value):a(x.value).then(d,m)}v((n=n.apply(e,r||[])).next())})};const D4=e=>{let r;return e?r=e:typeof fetch>"u"?r=ty:r=fetch,(...t)=>r(...t)},O4=()=>typeof Headers>"u"?ry:Headers,F4=(e,r,t)=>{const n=D4(t),a=O4();return(l,c)=>I4(void 0,void 0,void 0,function*(){var d;const m=(d=yield r())!==null&&d!==void 0?d:e;let v=new a(c?.headers);return v.has("apikey")||v.set("apikey",e),v.has("Authorization")||v.set("Authorization",`Bearer ${m}`),n(l,Object.assign(Object.assign({},c),{headers:v}))})};var L4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{v(n.next(x))}catch(y){c(y)}}function m(x){try{v(n.throw(x))}catch(y){c(y)}}function v(x){x.done?l(x.value):a(x.value).then(d,m)}v((n=n.apply(e,r||[])).next())})};function R4(e){return e.endsWith("/")?e:e+"/"}function j4(e,r){var t,n;const{db:a,auth:l,realtime:c,global:d}=e,{db:m,auth:v,realtime:x,global:y}=r,k={db:Object.assign(Object.assign({},m),a),auth:Object.assign(Object.assign({},v),l),realtime:Object.assign(Object.assign({},x),c),storage:{},global:Object.assign(Object.assign(Object.assign({},y),d),{headers:Object.assign(Object.assign({},(t=y?.headers)!==null&&t!==void 0?t:{}),(n=d?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>L4(this,void 0,void 0,function*(){return""})};return e.accessToken?k.accessToken=e.accessToken:delete k.accessToken,k}const fy="2.71.1",vl=30*1e3,P0=3,r0=P0*vl,M4="http://localhost:9999",B4="supabase.auth.token",z4={"X-Client-Info":`gotrue-js/${fy}`},N0="X-Supabase-Api-Version",hy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},U4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,$4=600*1e3;class ym extends Error{constructor(r,t,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function St(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class W4 extends ym{constructor(r,t,n){super(r,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function V4(e){return St(e)&&e.name==="AuthApiError"}class my extends ym{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class Cs extends ym{constructor(r,t,n,a){super(r,n,a),this.name=t,this.status=n}}class vs extends Cs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function H4(e){return St(e)&&e.name==="AuthSessionMissingError"}class Ad extends Cs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pd extends Cs{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class Nd extends Cs{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function G4(e){return St(e)&&e.name==="AuthImplicitGrantRedirectError"}class zv extends Cs{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class I0 extends Cs{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function n0(e){return St(e)&&e.name==="AuthRetryableFetchError"}class Uv extends Cs{constructor(r,t,n){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class D0 extends Cs{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const tf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),$v=` 	
\r=`.split(""),Z4=(()=>{const e=new Array(128);for(let r=0;r<e.length;r+=1)e[r]=-1;for(let r=0;r<$v.length;r+=1)e[$v[r].charCodeAt(0)]=-2;for(let r=0;r<tf.length;r+=1)e[tf[r].charCodeAt(0)]=r;return e})();function Wv(e,r,t){if(e!==null)for(r.queue=r.queue<<8|e,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(tf[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(tf[n]),r.queuedBits-=6}}function py(e,r,t){const n=Z4[e];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)t(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Vv(e){const r=[],t=c=>{r.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{Y4(c,n,t)};for(let c=0;c<e.length;c+=1)py(e.charCodeAt(c),a,l);return r.join("")}function K4(e,r){if(e<=127){r(e);return}else if(e<=2047){r(192|e>>6),r(128|e&63);return}else if(e<=65535){r(224|e>>12),r(128|e>>6&63),r(128|e&63);return}else if(e<=1114111){r(240|e>>18),r(128|e>>12&63),r(128|e>>6&63),r(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function q4(e,r){for(let t=0;t<e.length;t+=1){let n=e.charCodeAt(t);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}K4(n,r)}}function Y4(e,r,t){if(r.utf8seq===0){if(e<=127){t(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=e&31;else if(r.utf8seq===3)r.codepoint=e&15;else if(r.utf8seq===4)r.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|e&63,r.utf8seq-=1,r.utf8seq===0&&t(r.codepoint)}}function X4(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};for(let a=0;a<e.length;a+=1)py(e.charCodeAt(a),t,n);return new Uint8Array(r)}function J4(e){const r=[];return q4(e,t=>r.push(t)),new Uint8Array(r)}function Q4(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};return e.forEach(a=>Wv(a,t,n)),Wv(null,t,n),r.join("")}function e3(e){return Math.round(Date.now()/1e3)+e}function t3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e=="x"?r:r&3|8).toString(16)})}const Na=()=>typeof window<"u"&&typeof document<"u",Xs={tested:!1,writable:!1},gy=()=>{if(!Na())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Xs.tested)return Xs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Xs.tested=!0,Xs.writable=!0}catch{Xs.tested=!0,Xs.writable=!1}return Xs.writable};function r3(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{r[l]=a})}catch{}return t.searchParams.forEach((n,a)=>{r[a]=n}),r}const vy=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>ri(async()=>{const{default:n}=await Promise.resolve().then(()=>Il);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},n3=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",xl=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},Js=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ps=async(e,r)=>{await e.removeItem(r)};class cf{constructor(){this.promise=new cf.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}cf.promiseConstructor=Promise;function a0(e){const r=e.split(".");if(r.length!==3)throw new D0("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!U4.test(r[n]))throw new D0("JWT not in base64url format");return{header:JSON.parse(Vv(r[0])),payload:JSON.parse(Vv(r[1])),signature:X4(r[2]),raw:{header:r[0],payload:r[1]}}}async function a3(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function i3(e,r){return new Promise((n,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!r(l,null,c)){n(c);return}}catch(c){if(!r(l,c)){a(c);return}}})()})}function s3(e){return("0"+e.toString(16)).substr(-2)}function o3(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(r),Array.from(r,s3).join("")}async function l3(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function c3(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await l3(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function fl(e,r,t=!1){const n=o3();let a=n;t&&(a+="/PASSWORD_RECOVERY"),await xl(e,`${r}-code-verifier`,a);const l=await c3(n);return[l,n===l?"plain":"s256"]}const u3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function d3(e){const r=e.headers.get(N0);if(!r||!r.match(u3))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function f3(e){if(!e)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(e<=r)throw new Error("JWT has expired")}function h3(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const m3=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function hl(e){if(!m3.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function i0(){const e={};return new Proxy(e,{get:(r,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Hv(e){return JSON.parse(JSON.stringify(e))}var p3=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};const eo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),g3=[502,503,504];async function Gv(e){var r;if(!n3(e))throw new I0(eo(e),0);if(g3.includes(e.status))throw new I0(eo(e),e.status);let t;try{t=await e.json()}catch(l){throw new my(eo(l),l)}let n;const a=d3(e);if(a&&a.getTime()>=hy["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new Uv(eo(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new vs}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Uv(eo(t),e.status,t.weak_password.reasons);throw new W4(eo(t),e.status||500,n)}const v3=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),t))};async function At(e,r,t,n){var a;const l=Object.assign({},n?.headers);l[N0]||(l[N0]=hy["2024-01-01"].name),n?.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(c.redirect_to=n.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",m=await x3(e,r,t+d,{headers:l,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(m):{data:Object.assign({},m),error:null}}async function x3(e,r,t,n,a,l){const c=v3(r,n,a,l);let d;try{d=await e(t,Object.assign({},c))}catch(m){throw console.error(m),new I0(eo(m),0)}if(d.ok||await Gv(d),n?.noResolveJson)return d;try{return await d.json()}catch(m){await Gv(m)}}function Ei(e){var r;let t=null;k3(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=e3(e.expires_in)));const n=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:n},error:null}}function Zv(e){const r=Ei(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(r.data.weak_password=e.weak_password),r}function _s(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function y3(e){return{data:e,error:null}}function _3(e){const{action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:l}=e,c=p3(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:l},m=Object.assign({},c);return{data:{properties:d,user:m},error:null}}function w3(e){return e}function k3(e){return e.access_token&&e.refresh_token&&e.expires_in}const s0=["global","local","others"];var b3=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};class S3{constructor({url:r="",headers:t={},fetch:n}){this.url=r,this.headers=t,this.fetch=vy(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,t=s0[0]){if(s0.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${s0.join(", ")}`);try{return await At(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(St(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,t={}){try{return await At(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:_s})}catch(n){if(St(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:t}=r,n=b3(r,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await At(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:_3,redirectTo:t?.redirectTo})}catch(t){if(St(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await At(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:_s})}catch(t){if(St(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,n,a,l,c,d,m;try{const v={nextPage:null,lastPage:0,total:0},x=await At(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=r?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=r?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:w3});if(x.error)throw x.error;const y=await x.json(),k=(c=x.headers.get("x-total-count"))!==null&&c!==void 0?c:0,E=(m=(d=x.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&m!==void 0?m:[];return E.length>0&&(E.forEach(b=>{const S=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),A=JSON.parse(b.split(";")[1].split("=")[1]);v[`${A}Page`]=S}),v.total=parseInt(k)),{data:Object.assign(Object.assign({},y),v),error:null}}catch(v){if(St(v))return{data:{users:[]},error:v};throw v}}async getUserById(r){hl(r);try{return await At(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:_s})}catch(t){if(St(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){hl(r);try{return await At(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:_s})}catch(n){if(St(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,t=!1){hl(r);try{return await At(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:_s})}catch(n){if(St(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){hl(r.userId);try{const{data:t,error:n}=await At(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:n}}catch(t){if(St(t))return{data:null,error:t};throw t}}async _deleteFactor(r){hl(r.userId),hl(r.id);try{return{data:await At(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(St(t))return{data:null,error:t};throw t}}}function Kv(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}function T3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ml={debug:!!(globalThis&&gy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class xy extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class E3 extends xy{}async function C3(e,r,t){ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),ml.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await t()}finally{ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(r===0)throw ml.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new E3(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ml.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}T3();const A3={url:M4,storageKey:B4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:z4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function qv(e,r,t){return await t()}const pl={};class Kc{constructor(r){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Kc.nextInstanceID,Kc.nextInstanceID+=1,this.instanceID>0&&Na()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},A3),r);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new S3({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=vy(a.fetch),this.lock=a.lock||qv,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Na()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=C3:this.lock=qv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:gy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Kv(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Kv(this.memoryStorage)),Na()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var r,t;return(t=(r=pl[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(r){pl[this.storageKey]=Object.assign(Object.assign({},pl[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,t;return(t=(r=pl[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){pl[this.storageKey]=Object.assign(Object.assign({},pl[this.storageKey]),{cachedAt:r})}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${fy}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const t=r3(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Na()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),G4(l)){const m=(r=l.details)===null||r===void 0?void 0:r.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return St(t)?{error:t}:{error:new my("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,n,a;try{const l=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=r?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=r?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ei}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const m=c.session,v=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:v,session:m},error:null}}catch(l){if(St(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(r){var t,n,a;try{let l;if("email"in r){const{email:x,password:y,options:k}=r;let E=null,b=null;this.flowType==="pkce"&&([E,b]=await fl(this.storage,this.storageKey)),l=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:k?.emailRedirectTo,body:{email:x,password:y,data:(t=k?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:k?.captchaToken},code_challenge:E,code_challenge_method:b},xform:Ei})}else if("phone"in r){const{phone:x,password:y,options:k}=r;l=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:y,data:(n=k?.data)!==null&&n!==void 0?n:{},channel:(a=k?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:k?.captchaToken}},xform:Ei})}else throw new Pd("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const m=c.session,v=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:v,session:m},error:null}}catch(l){if(St(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(r){try{let t;if("email"in r){const{email:l,password:c,options:d}=r;t=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Zv})}else if("phone"in r){const{phone:l,password:c,options:d}=r;t=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Zv})}else throw new Pd("You must provide either an email or phone number and a password");const{data:n,error:a}=t;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ad}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(St(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(r){var t,n,a,l;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=r.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=r.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:t}=r;if(t==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(r){var t,n,a,l,c,d,m,v,x,y,k,E;let b,S;if("message"in r)b=r.message,S=r.signature;else{const{chain:A,wallet:R,statement:O,options:N}=r;let U;if(Na())if(typeof R=="object")U=R;else{const B=window;if("solana"in B&&typeof B.solana=="object"&&("signIn"in B.solana&&typeof B.solana.signIn=="function"||"signMessage"in B.solana&&typeof B.solana.signMessage=="function"))U=B.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");U=R}const K=new URL((t=N?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in U&&U.signIn){const B=await U.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N?.signInWithSolana),{version:"1",domain:K.host,uri:K.href}),O?{statement:O}:null));let D;if(Array.isArray(B)&&B[0]&&typeof B[0]=="object")D=B[0];else if(B&&typeof B=="object"&&"signedMessage"in B&&"signature"in B)D=B;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)b=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),S=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in U)||typeof U.signMessage!="function"||!("publicKey"in U)||typeof U!="object"||!U.publicKey||!("toBase58"in U.publicKey)||typeof U.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${K.host} wants you to sign in with your Solana account:`,U.publicKey.toBase58(),...O?["",O,""]:[""],"Version: 1",`URI: ${K.href}`,`Issued At: ${(a=(n=N?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=N?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((c=N?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((d=N?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((m=N?.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((v=N?.signInWithSolana)===null||v===void 0)&&v.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((y=(x=N?.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||y===void 0)&&y.length?["Resources",...N.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const B=await U.signMessage(new TextEncoder().encode(b),"utf8");if(!B||!(B instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");S=B}}try{const{data:A,error:R}=await At(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Q4(S)},!((k=r.options)===null||k===void 0)&&k.captchaToken?{gotrue_meta_security:{captcha_token:(E=r.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:Ei});if(R)throw R;return!A||!A.session||!A.user?{data:{user:null,session:null},error:new Ad}:(A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),{data:Object.assign({},A),error:R})}catch(A){if(St(A))return{data:{user:null,session:null},error:A};throw A}}async _exchangeCodeForSession(r){const t=await Js(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(t??"").split("/");try{const{data:l,error:c}=await At(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:Ei});if(await ps(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Ad}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(St(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(r){try{const{options:t,provider:n,token:a,access_token:l,nonce:c}=r,d=await At(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Ei}),{data:m,error:v}=d;return v?{data:{user:null,session:null},error:v}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Ad}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:v})}catch(t){if(St(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(r){var t,n,a,l,c;try{if("email"in r){const{email:d,options:m}=r;let v=null,x=null;this.flowType==="pkce"&&([v,x]=await fl(this.storage,this.storageKey));const{error:y}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(t=m?.data)!==null&&t!==void 0?t:{},create_user:(n=m?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:v,code_challenge_method:x},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in r){const{phone:d,options:m}=r,{data:v,error:x}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=m?.data)!==null&&a!==void 0?a:{},create_user:(l=m?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},channel:(c=m?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:v?.message_id},error:x}}throw new Pd("You must provide either an email or phone number.")}catch(d){if(St(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(r){var t,n;try{let a,l;"options"in r&&(a=(t=r.options)===null||t===void 0?void 0:t.redirectTo,l=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:d}=await At(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Ei});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const m=c.session,v=c.user;return m?.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:v,session:m},error:null}}catch(a){if(St(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(r){var t,n,a;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await fl(this.storage,this.storageKey)),await At(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=r?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:y3})}catch(l){if(St(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:n}=r;if(n)throw n;if(!t)throw new vs;const{error:a}=await At(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(r){if(St(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:n,type:a,options:l}=r,{error:c}=await At(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in r){const{phone:n,type:a,options:l}=r,{data:c,error:d}=await At(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:d}}throw new Pd("You must provide either an email or phone number and a type")}catch(t){if(St(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await Js(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<r0:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.userStorage){const c=await Js(this.userStorage,this.storageKey+"-user");c?.user?r.user=c.user:r.user=i0()}if(this.storage.isServer&&r.user){let c=this.suppressGetSessionWarning;r=new Proxy(r,{get:(m,v,x)=>(!c&&v==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,v,x))})}return{data:{session:r},error:null}}const{session:a,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:_s}):await this._useSession(async t=>{var n,a,l;const{data:c,error:d}=t;if(d)throw d;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new vs}:await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:_s})})}catch(t){if(St(t))return H4(t)&&(await this._removeSession(),await ps(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async n=>{const{data:a,error:l}=n;if(l)throw l;if(!a.session)throw new vs;const c=a.session;let d=null,m=null;this.flowType==="pkce"&&r.email!=null&&([d,m]=await fl(this.storage,this.storageKey));const{data:v,error:x}=await At(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:d,code_challenge_method:m}),jwt:c.access_token,xform:_s});if(x)throw x;return c.user=v.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(St(n))return{data:{user:null},error:n};throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new vs;const t=Date.now()/1e3;let n=t,a=!0,l=null;const{payload:c}=a0(r.access_token);if(c.exp&&(n=c.exp,a=n<=t),a){const{session:d,error:m}=await this._callRefreshToken(r.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:m}=await this._getUser(r.access_token);if(m)throw m;l={access_token:r.access_token,refresh_token:r.refresh_token,user:d.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(St(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var n;if(!r){const{data:c,error:d}=t;if(d)throw d;r=(n=c.session)!==null&&n!==void 0?n:void 0}if(!r?.refresh_token)throw new vs;const{session:a,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(St(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(r,t){try{if(!Na())throw new Nd("No browser detected.");if(r.error||r.error_description||r.error_code)throw new Nd(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new zv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Nd("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new zv("No code detected.");const{data:O,error:N}=await this._exchangeCodeForSession(r.code);if(N)throw N;const U=new URL(window.location.href);return U.searchParams.delete("code"),window.history.replaceState(window.history.state,"",U.toString()),{data:{session:O.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:m,token_type:v}=r;if(!l||!d||!c||!v)throw new Nd("No session defined in URL");const x=Math.round(Date.now()/1e3),y=parseInt(d);let k=x+y;m&&(k=parseInt(m));const E=k-x;E*1e3<=vl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${E}s, should have been closer to ${y}s`);const b=k-y;x-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,k,x):x-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,k,x);const{data:S,error:A}=await this._getUser(l);if(A)throw A;const R={provider_token:n,provider_refresh_token:a,access_token:l,expires_in:y,expires_at:k,refresh_token:c,token_type:v,user:S.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:R,redirectType:r.type},error:null}}catch(n){if(St(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await Js(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return{error:l};const c=(n=a.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:d}=await this.admin.signOut(c,r);if(d&&!(V4(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return r!=="others"&&(await this._removeSession(),await ps(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const t=t3(),n={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async t=>{var n,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",r,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",l),console.error(l)}})}async resetPasswordForEmail(r,t={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await fl(this.storage,this.storageKey,!0));try{return await At(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(St(l))return{data:null,error:l};throw l}}async getUserIdentities(){var r;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(t){if(St(t))return{data:null,error:t};throw t}}async linkIdentity(r){var t;try{const{data:n,error:a}=await this._useSession(async l=>{var c,d,m,v,x;const{data:y,error:k}=l;if(k)throw k;const E=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(c=r.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=r.options)===null||d===void 0?void 0:d.scopes,queryParams:(m=r.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await At(this.fetch,"GET",E,{headers:this.headers,jwt:(x=(v=y.session)===null||v===void 0?void 0:v.access_token)!==null&&x!==void 0?x:void 0})});if(a)throw a;return Na()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:r.provider,url:n?.url},error:null}}catch(n){if(St(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async t=>{var n,a;const{data:l,error:c}=t;if(c)throw c;return await At(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(St(t))return{data:null,error:t};throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await i3(async a=>(a>0&&await a3(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await At(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:Ei})),(a,l)=>{const c=200*Math.pow(2,a);return l&&n0(l)&&Date.now()+c-n<vl})}catch(n){if(this._debug(t,"error",n),St(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",n),Na()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Js(this.storage,this.storageKey);if(a&&this.userStorage){let c=await Js(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await xl(this.userStorage,this.storageKey+"-user",c)),a.user=(r=c?.user)!==null&&r!==void 0?r:i0()}else if(a&&!a.user&&!a.user){const c=await Js(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await ps(this.storage,this.storageKey+"-user"),await xl(this.storage,this.storageKey,a)):a.user=i0()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<r0;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${r0}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),n0(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(r){var t,n;if(!r)throw new vs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new cf;const{data:l,error:c}=await this._refreshAccessToken(r);if(c)throw c;if(!l.session)throw new vs;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={session:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),St(l)){const c={session:null,error:l};return n0(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(r,t,n=!0){const a=`#_notifyAllSubscribers(${r})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(r,t)}catch(m){l.push(m)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const t=Object.assign({},r),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await xl(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=Hv(a);await xl(this.storage,this.storageKey,l)}else{const a=Hv(t);await xl(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ps(this.storage,this.storageKey),await ps(this.storage,this.storageKey+"-code-verifier"),await ps(this.storage,this.storageKey+"-user"),this.userStorage&&await ps(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Na()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),vl);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-r)/vl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${vl}ms, refresh threshold is ${P0} ticks`),a<=P0&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof xy)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Na()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,n){const a=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await fl(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(n?.queryParams){const l=new URLSearchParams(n.queryParams);a.push(l.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${a.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;return l?{data:null,error:l}:await At(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(St(t))return{data:null,error:t};throw t}}async _enroll(r){try{return await this._useSession(async t=>{var n,a;const{data:l,error:c}=t;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:m,error:v}=await At(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(n=l?.session)===null||n===void 0?void 0:n.access_token});return v?{data:null,error:v}:(r.factorType==="totp"&&(!((a=m?.totp)===null||a===void 0)&&a.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(t){if(St(t))return{data:null,error:t};throw t}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:d}=await At(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:d})})}catch(t){if(St(t))return{data:null,error:t};throw t}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;return l?{data:null,error:l}:await At(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(St(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(r){const{data:t,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){const{data:{user:r},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=r?.factors||[],a=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var t,n;const{data:{session:a},error:l}=r;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=a0(a.access_token);let d=null;c.aal&&(d=c.aal);let m=d;((n=(t=a.user.factors)===null||t===void 0?void 0:t.filter(y=>y.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const x=c.amr||[];return{data:{currentLevel:d,nextLevel:m,currentAuthenticationMethods:x},error:null}}))}async fetchJwk(r,t={keys:[]}){let n=t.keys.find(d=>d.kid===r);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(d=>d.kid===r),n&&this.jwks_cached_at+$4>a)return n;const{data:l,error:c}=await At(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,n=l.keys.find(d=>d.kid===r),!n)?null:n}async getClaims(r,t={}){try{let n=r;if(!n){const{data:E,error:b}=await this.getSession();if(b||!E.session)return{data:null,error:b};n=E.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:m}}=a0(n);t?.allowExpired||f3(l.exp);const v=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!v){const{error:E}=await this.getUser(n);if(E)throw E;return{data:{claims:l,header:a,signature:c},error:null}}const x=h3(a.alg),y=await crypto.subtle.importKey("jwk",v,x,!0,["verify"]);if(!await crypto.subtle.verify(x,y,c,J4(`${d}.${m}`)))throw new D0("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(n){if(St(n))return{data:null,error:n};throw n}}}Kc.nextInstanceID=0;const P3=Kc;class N3 extends P3{constructor(r){super(r)}}var I3=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{v(n.next(x))}catch(y){c(y)}}function m(x){try{v(n.throw(x))}catch(y){c(y)}}function v(x){x.done?l(x.value):a(x.value).then(d,m)}v((n=n.apply(e,r||[])).next())})};class D3{constructor(r,t,n){var a,l,c;if(this.supabaseUrl=r,this.supabaseKey=t,!r)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const d=R4(r),m=new URL(d);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const v=`sb-${m.hostname.split(".")[0]}-auth-token`,x={db:A4,realtime:N4,auth:Object.assign(Object.assign({},P4),{storageKey:v}),global:C4},y=j4(n??{},x);this.storageKey=(a=y.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=y.global.headers)!==null&&l!==void 0?l:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(k,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=y.auth)!==null&&c!==void 0?c:{},this.headers,y.global.fetch),this.fetch=F4(t,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new KN(new URL("rest/v1",m).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new S4(this.storageUrl.href,this.headers,this.fetch,n?.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new MN(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,t={},n={}){return this.rest.rpc(r,t,n)}channel(r,t={config:{}}){return this.realtime.channel(r,t)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,t;return I3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:a,storageKey:l,flowType:c,lock:d,debug:m},v,x){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new N3({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),v),storageKey:l,autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:a,flowType:c,lock:d,debug:m,fetch:x,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new d4(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(r,t,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const yy=(e,r,t)=>new D3(e,r,t);function O3(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}O3()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const F3="https://eevfxrgemrtthxbcxtvq.supabase.co",L3="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",We=yy(F3,L3,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"navigator-supabase-auth-token",debug:!1},realtime:{params:{eventsPerSecond:5}}});async function R3(e){if(!We)throw new Error("Supabase not configured");const{data:r,error:t}=await We.rpc("create_trial_subscription",{target_user_id:e});if(t)throw console.error("Failed to create trial subscription:",t),t;if(r&&!r.success)throw console.error("Trial subscription creation failed:",r.message),new Error(r.message)}function Yv(){let e=localStorage.getItem("navigator_device_id");return e||(e=`device_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,localStorage.setItem("navigator_device_id",e)),e}function _y(e,r){const t=typeof e.currentListVersion=="number"?e.currentListVersion:1,n=typeof r.currentListVersion=="number"?r.currentListVersion:1,a=R=>typeof R=="number"?R:Math.max(t,n),l=new Map,c=R=>{if(!R||typeof R.index!="number"||typeof R.timestamp!="string"||!R.outcome)return;const O={...R,listVersion:a(R.listVersion)},N=`${O.timestamp}_${O.index}_${O.outcome}`,U=l.get(N);if(!U){l.set(N,O);return}const K=new Date(U.timestamp).getTime();if(new Date(O.timestamp).getTime()>K){l.set(N,{...U,...O});return}l.set(N,{...O,...U})};r.completions?.forEach(c),e.completions?.forEach(c);const d=Array.from(l.values()).sort((R,O)=>new Date(O.timestamp).getTime()-new Date(R.timestamp).getTime()),m=()=>{const R=Array.isArray(e.addresses)?e.addresses:[],O=Array.isArray(r.addresses)?r.addresses:[],N=D=>D.some(te=>te.address?.trim()),U=N(O),K=N(R);return n>t?!U&&K?{addresses:R,listVersion:t}:{addresses:O,listVersion:n}:t>n?!K&&U?{addresses:O,listVersion:t}:{addresses:R,listVersion:t}:U&&!K?{addresses:O,listVersion:n}:!U&&K?{addresses:R,listVersion:t}:{addresses:O.length>=R.length?O:R,listVersion:n}},{addresses:v,listVersion:x}=m(),y=new Map,k=R=>{if(!R?.id)return;const O=y.get(R.id);if(!O){y.set(R.id,R);return}const N=new Date(O.updatedAt).getTime();new Date(R.updatedAt).getTime()>N&&y.set(R.id,R)};e.arrangements?.forEach(k),r.arrangements?.forEach(k);const E=new Map,b=R=>{if(!R?.date)return;const O=E.get(R.date);if(!O){E.set(R.date,R);return}const N=!!O.end,U=!!R.end;if(!N&&U){E.set(R.date,R);return}if(N&&U){const K=new Date(O.end??O.start).getTime();new Date(R.end??R.start).getTime()>K&&E.set(R.date,R)}};e.daySessions?.forEach(b),r.daySessions?.forEach(b);const S=Array.from(E.values()),A=Array.from(y.values());return{...r,addresses:v,completions:d,arrangements:A,daySessions:S,currentListVersion:x,activeIndex:r.activeIndex??e.activeIndex??null}}function wy(){const[e,r]=Y.useState(null),[t,n]=Y.useState(!0),[a,l]=Y.useState(!1),[c,d]=Y.useState(typeof navigator<"u"?navigator.onLine:!0),[m,v]=Y.useState(null),[x,y]=Y.useState(null),k=Y.useRef({lastSyncAt:"",deviceId:Yv(),version:0,checksum:""}),E=Y.useRef([]),b=Y.useRef(!1),S=Y.useRef(null),A=Y.useRef(""),R=Y.useRef(null),O=Y.useCallback(()=>v(null),[]),N=Y.useCallback(async()=>{if(!e||!We||!c||b.current||E.current.length===0)return;b.current=!0,l(!0);const J=E.current.slice(0,10),ce=new Set;try{for(const ke of J)try{const{operation:se}=ke,{error:ue}=await We.from("navigator_operations").insert({user_id:e.id,operation_id:se.id,type:se.type,entity:se.entity,entity_id:se.entityId,data:se.data,device_id:k.current.deviceId,timestamp:se.timestamp,local_timestamp:se.localTimestamp});if(ue&&ue.code!=="23505")throw ue;ce.add(ke.operation.id),ke.resolve(se)}catch(se){ke.operation.retries+=1,ke.operation.retries<3||(console.warn(`Operation ${ke.operation.id} failed after max retries:`,se),ce.add(ke.operation.id),ke.reject(se))}E.current=E.current.filter(ke=>!ce.has(ke.operation.id))}catch(ke){console.error("Sync batch error:",ke),v(ke?.message||"Sync batch failed")}finally{b.current=!1,l(E.current.length>0),E.current.length>0&&(S.current=setTimeout(N,1e3))}},[e,c]),U=Y.useCallback(async J=>new Promise((ce,ke)=>{const se=JSON.stringify(J.data),ue=`${J.type}_${J.entity}_${J.entityId}_${se}`;if(E.current.some(I=>{const P=JSON.stringify(I.operation.data);return`${I.operation.type}_${I.operation.entity}_${I.operation.entityId}_${P}`===ue&&I.operation.retries<3})){ce();return}const G=new Date().toISOString(),oe={operation:{...J,id:`op_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,timestamp:G,localTimestamp:G,retries:0},resolve:ce,reject:ke};E.current.push(oe),E.current.length>1e3&&(console.warn("Sync queue size limit reached, removing oldest entries"),E.current.splice(0,100).forEach(P=>{P.reject(new Error("Queue overflow - operation cancelled"))})),c&&N()}),[c,N]);Y.useEffect(()=>{let J=!0;if((async()=>{try{if(!We){J&&(v("Supabase not configured"),n(!1));return}const{data:ke,error:se}=await We.auth.getUser();if(se)throw se;J&&r(ke.user??null)}catch(ke){J&&v(ke?.message||String(ke))}finally{J&&n(!1)}})(),!We)return()=>{J=!1};const{data:ce}=We.auth.onAuthStateChange((ke,se)=>{J&&r(se?.user??null)});return()=>{J=!1,ce.subscription.unsubscribe()}},[]),Y.useEffect(()=>{if(typeof window>"u")return;const J=()=>{d(!0),S.current=setTimeout(N,100),setTimeout(async()=>{const ke=Object.keys(localStorage).filter(se=>se.startsWith("navigator_offline_state_"));if(ke.length>0)for(const se of ke)try{const ue=JSON.parse(localStorage.getItem(se)||"{}");ue.state&&(await te(ue.state),localStorage.removeItem(se))}catch(ue){console.error(`🔌 OFFLINE PROTECTION: Failed to sync queued state ${se}:`,ue)}},2e3)},ce=()=>{d(!1)};return window.addEventListener("online",J),window.addEventListener("offline",ce),()=>{window.removeEventListener("online",J),window.removeEventListener("offline",ce)}},[N]);const K=Y.useCallback(async(J,ce)=>{if(O(),!We)throw new Error("Supabase not configured");const{data:ke,error:se}=await We.auth.signInWithPassword({email:J,password:ce});if(se)throw v(se.message),se;localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id");const{SmartUserDetection:ue}=await ri(async()=>{const{SmartUserDetection:j}=await Promise.resolve().then(()=>DN);return{SmartUserDetection:j}},void 0);return ue.storeDeviceContext(ke.user),r(ke.user),{user:ke.user}},[O]),B=Y.useCallback(async(J,ce)=>{if(O(),!We)throw new Error("Supabase not configured");try{localStorage.removeItem("navigator-supabase-auth-token"),localStorage.removeItem("supabase.auth.token"),sessionStorage.clear(),await We.auth.signOut(),r(null),await new Promise(j=>setTimeout(j,1e3));const{data:ue}=await We.auth.getSession();ue.session&&(console.warn("Session still exists after cleanup, forcing removal..."),await We.auth.signOut(),await new Promise(j=>setTimeout(j,500)))}catch(ue){console.warn("Error during pre-signup signout:",ue)}const{data:ke,error:se}=await We.auth.signUp({email:J,password:ce,options:{data:{signup_source:"navigator_web"},emailRedirectTo:void 0}});if(se)throw v(se.message),se;if(ke.user){try{await R3(ke.user.id),localStorage.setItem("navigator_trial_created",Date.now().toString()),localStorage.setItem("navigator_trial_user_id",ke.user.id)}catch(ue){console.error("Failed to initialize new user:",ue)}if(!ke.session)try{const{data:ue,error:j}=await We.auth.signInWithPassword({email:J,password:ce});if(j)console.warn("Immediate signin failed:",j);else return r(ue.user),{user:ue.user}}catch(ue){console.warn("Immediate signin error:",ue)}r(ke.user)}return{user:ke.user}},[O]),D=Y.useCallback(async()=>{if(O(),R.current&&(R.current(),R.current=null),!We)return;const{error:J}=await We.auth.signOut();if(J)throw v(J.message),J;try{const{clear:ce}=await ri(async()=>{const{clear:se}=await Promise.resolve().then(()=>MA);return{clear:se}},void 0);await ce(),["navigator_trial_created","navigator_trial_user_id","navigator_last_user_id","navigator_device_context","navigator_device_context_checksum","navigator_supabase_url","navigator_supabase_key","navigator_supabase_skipped","navigator_data_counts","last_backup_time"].forEach(se=>localStorage.removeItem(se)),sessionStorage.clear()}catch(ce){console.warn("Error clearing local data:",ce)}r(null),y(null),k.current={lastSyncAt:"",deviceId:Yv(),version:0,checksum:""},E.current=[],b.current=!1,A.current="",S.current&&(clearTimeout(S.current),S.current=null)},[O]),te=Y.useCallback(async J=>{if(!e||!We){v(e?"Supabase not configured":"Not authenticated");return}if(JSON.stringify(J)!==A.current)try{O(),l(!0);const ke=new Date().toISOString(),{data:se,error:ue}=await We.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle();if(ue)throw ue;let j=J,G=k.current.version+1;if(se&&se.updated_at>k.current.lastSyncAt){const M=se.data;j=await ee(J,M),G=(se.version||0)+1}const Z=lo(j),{error:oe}=await We.from("navigator_state").upsert({user_id:e.id,data:j,updated_at:ke,version:G,checksum:Z,device_id:k.current.deviceId},{onConflict:"user_id"}).select("updated_at, version, checksum").single();if(oe)throw console.error("Cloud sync database error:",oe),oe.code==="23505"||oe.message?.includes("conflict")?(k.current.lastSyncAt="",k.current.version=0,new Error("Sync conflict detected - will retry with fresh data")):oe;const{data:I,error:P}=await We.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).single();if(P)throw console.error("Sync verification failed:",P),new Error(`Sync verification failed: ${P.message}`);if(!I)throw new Error("Sync verification failed: No data found after upsert");const F=lo(I.data);F!==Z&&console.warn("Checksum mismatch (likely harmless serialization difference)",{expectedChecksum:Z,actualChecksum:F,expectedCompletions:j.completions?.length||0,actualCompletions:I.data?.completions?.length||0}),k.current={lastSyncAt:I.updated_at??ke,deviceId:k.current.deviceId,version:I.version??G,checksum:Z},A.current=JSON.stringify(j),y(new Date(I.updated_at??ke))}catch(ke){if(v(ke?.message||String(ke)),console.error("Sync failed:",ke),!c||ke?.message?.includes("fetch")){const se=`navigator_offline_state_${Date.now()}`,ue={state:J,timestamp:new Date().toISOString(),reason:"network_failure",error:ke?.message||String(ke)};try{localStorage.setItem(se,JSON.stringify(ue))}catch(j){console.error("Failed to queue offline state:",j)}}}finally{l(!1)}},[e,O]),ee=Y.useCallback(async(J,ce)=>{const ke=localStorage.getItem("navigator_restore_in_progress");if(ke){const H=parseInt(ke),X=Date.now()-H;if(X<3e4){console.log("🛡️ RESTORE PROTECTION: Preferring local state to prevent data loss",{timeSinceRestore:`${Math.round(X/1e3)}s`,restoreTime:new Date(H).toISOString()});const fe=typeof J.currentListVersion=="number"?J.currentListVersion:1,ge=typeof ce.currentListVersion=="number"?ce.currentListVersion:1;return{...J,currentListVersion:Math.max(fe,ge)}}else localStorage.removeItem("navigator_restore_in_progress")}const se=localStorage.getItem("navigator_import_in_progress");if(se){const H=parseInt(se),X=Date.now()-H;if(X<2e3){console.log("🛡️ IMPORT PROTECTION: Preferring local state to prevent import override",{timeSinceImport:`${Math.round(X/1e3)}s`,importTime:new Date(H).toISOString()});const fe=typeof J.currentListVersion=="number"?J.currentListVersion:1,ge=typeof ce.currentListVersion=="number"?ce.currentListVersion:1;return{...J,currentListVersion:Math.max(fe,ge)}}else localStorage.removeItem("navigator_import_in_progress")}const ue=new Date(Date.now()-360*60*1e3);if(J.completions.some(H=>H.timestamp&&new Date(H.timestamp)>ue)){const H=J.completions.length,X=ce.completions.length;if(H>X)return{...J,arrangements:ce.arrangements.length>J.arrangements.length?ce.arrangements:J.arrangements,daySessions:[...J.daySessions,...ce.daySessions.filter(fe=>!J.daySessions.some(ge=>ge.date===fe.date))]}}const G={...J},Z=[...J.completions,...ce.completions],oe=new Map;Z.forEach(H=>{if(!H.address||!H.timestamp)return;const X=`${H.address}_v${H.listVersion||1}`,fe=oe.get(X);if(!fe){oe.set(X,H);return}const ge=new Date(fe.timestamp).getTime(),ye=new Date(H.timestamp).getTime();!isNaN(ye)&&(isNaN(ge)||ye>ge)&&oe.set(X,H)}),G.completions=Array.from(oe.values()).sort((H,X)=>new Date(X.timestamp).getTime()-new Date(H.timestamp).getTime());const I=[...J.arrangements,...ce.arrangements],P=new Map;I.forEach(H=>{const X=P.get(H.id);(!X||new Date(H.updatedAt)>new Date(X.updatedAt))&&P.set(H.id,H)}),G.arrangements=Array.from(P.values());const F=[...J.daySessions,...ce.daySessions],M=new Map;if(F.forEach(H=>{const X=M.get(H.date);(!X||H.end&&!X.end)&&M.set(H.date,H)}),G.daySessions=Array.from(M.values()),ce.addresses.length>J.addresses.length){G.addresses=ce.addresses;const H=typeof J.currentListVersion=="number"?J.currentListVersion:1,X=typeof ce.currentListVersion=="number"?ce.currentListVersion:1;G.currentListVersion=Math.max(H,X)}else{const H=typeof J.currentListVersion=="number"?J.currentListVersion:1;G.currentListVersion=H}return G.activeIndex=J.activeIndex??ce.activeIndex??null,G},[]),ve=Y.useCallback(async()=>{if(A.current="",k.current.lastSyncAt="",k.current.version=0,e&&We)try{const{data:J,error:ce}=await We.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle()}catch(J){console.warn("Force sync failed:",J)}},[e]),me=Y.useCallback(J=>{if(!e||!We)return()=>{};O();const ce=We,ke=ce.channel("navigator_state_"+e.id);ke.on("postgres_changes",{event:"*",schema:"public",table:"navigator_state",filter:`user_id=eq.${e.id}`},async ue=>{try{const j=ue?.new??ue?.old??null;if(!j)return;const G=j.updated_at,Z=j.data,oe=j.version||0,I=j.checksum||"";if(j.device_id===k.current.deviceId||oe<=k.current.version)return;const P=lo(Z);if(I&&I!==P){const X="navigator_checksum_mismatch_count",fe="navigator_last_checksum_mismatch",ge=parseInt(localStorage.getItem(X)||"0"),ye=parseInt(localStorage.getItem(fe)||"0"),ze=Date.now()-ye>3e5?1:ge+1;localStorage.setItem(X,ze.toString()),localStorage.setItem(fe,Date.now().toString()),console.warn(`⚠️ CHECKSUM MISMATCH (${ze}) - Data integrity issue detected`,{expected:P.substring(0,16)+"...",actual:I.substring(0,16)+"...",serverVersion:oe,updatedAt:G,consecutiveMismatches:ze}),ze>=3&&(console.error("❌ PERSISTENT CHECKSUM MISMATCH - Forcing full sync (silent recovery)"),localStorage.removeItem(X),localStorage.removeItem(fe),k.current.lastSyncAt="",k.current.version=0,k.current.checksum="");return}if(localStorage.removeItem("navigator_checksum_mismatch_count"),localStorage.removeItem("navigator_last_checksum_mismatch"),localStorage.getItem("navigator_active_protection"))return;k.current.lastSyncAt=G,k.current.version=oe,k.current.checksum=I;const M=localStorage.getItem("navigator_restore_in_progress");if(M){const X=parseInt(M);if(Date.now()-X<3e4)return;localStorage.removeItem("navigator_restore_in_progress")}const H=localStorage.getItem("navigator_import_in_progress");if(H){const X=parseInt(H);if(Date.now()-X<2e3)return;localStorage.removeItem("navigator_import_in_progress")}typeof J=="function"?J(X=>{const fe=_y(X,Z);return fe.completions.filter(ye=>!X.completions.some(xe=>xe.timestamp===ye.timestamp&&xe.address===ye.address)).length>0,A.current=JSON.stringify(fe),fe}):A.current=JSON.stringify(Z),y(new Date(G))}catch(j){console.warn("subscribeToData handler error:",j?.message||j),v("Sync error: "+(j?.message||j))}}),ke.subscribe();const se=()=>{try{ce.removeChannel(ke)}catch{}};return R.current=se,se},[e,O]);return Y.useMemo(()=>({user:e,isLoading:t,isOnline:c,isSyncing:a,error:m,lastSyncTime:x,clearError:O,signIn:K,signUp:B,signOut:D,syncData:te,subscribeToData:me,queueOperation:U,forceFullSync:ve}),[e,t,c,a,m,x,O,K,B,D,te,me,U,ve])}function _m({isOpen:e,onClose:r,title:t,children:n,size:a="md",showCloseButton:l=!0}){Y.useEffect(()=>{const m=v=>{v.key==="Escape"&&r()};return e&&(document.addEventListener("keydown",m),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",m),document.body.style.overflow=""}},[e,r]);const c=Y.useRef(null);if(Y.useEffect(()=>{if(e&&c.current){const v=c.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];v&&v.focus()}},[e]),!e)return null;const d={sm:"modal-sm",md:"modal-md",lg:"modal-lg"};return f.jsx("div",{className:"modal-overlay",onClick:r,children:f.jsxs("div",{ref:c,className:`modal-content ${d[a]}`,onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[t&&f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{id:"modal-title",className:"modal-title",children:t}),l&&f.jsx("button",{className:"modal-close-btn",onClick:r,"aria-label":"Close modal",children:"✕"})]}),f.jsx("div",{className:"modal-body",children:n})]})})}function j3({isOpen:e,onClose:r,title:t,message:n,type:a="info"}){const c={info:{icon:"ℹ️",className:"alert-info"},success:{icon:"✅",className:"alert-success"},warning:{icon:"⚠️",className:"alert-warning"},error:{icon:"❌",className:"alert-error"}}[a];return Y.useEffect(()=>{const d=m=>{m.key==="Escape"&&r()};return e&&(document.addEventListener("keydown",d),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",d),document.body.style.overflow=""}},[e,r]),e?f.jsx("div",{className:"modal-overlay",onClick:r,children:f.jsxs("div",{className:`modal-content modal-sm alert-modal ${c.className}`,onClick:d=>d.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[t&&f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{id:"modal-title",className:"modal-title",children:t}),f.jsx("button",{className:"modal-close-btn",onClick:r,"aria-label":"Close modal",children:"✕"})]}),f.jsxs("div",{className:"modal-body",children:[f.jsxs("div",{className:"alert-content",children:[f.jsx("div",{className:"alert-icon",children:c.icon}),f.jsx("div",{className:"alert-message",children:n})]}),f.jsx("div",{className:"modal-actions",children:f.jsx("button",{className:"btn btn-primary",onClick:r,children:"OK"})})]})]})}):null}function M3({isOpen:e,onConfirm:r,onCancel:t,title:n,message:a,confirmText:l="Confirm",cancelText:c="Cancel",type:d="info"}){const v={danger:{icon:"🗑️",confirmClass:"btn-danger"},warning:{icon:"⚠️",confirmClass:"btn-warning"},info:{icon:"ℹ️",confirmClass:"btn-primary"}}[d],x=()=>{r(),t()};return f.jsx(_m,{isOpen:e,onClose:t,title:n,size:"sm",children:f.jsxs("div",{className:"confirm-modal",children:[f.jsxs("div",{className:"confirm-content",children:[f.jsx("div",{className:"confirm-icon",children:v.icon}),f.jsx("div",{className:"confirm-message",children:a})]}),f.jsxs("div",{className:"modal-actions",children:[f.jsx("button",{className:"btn btn-ghost",onClick:t,children:c}),f.jsx("button",{className:`btn ${v.confirmClass}`,onClick:x,children:l})]})]})})}function B3({isOpen:e,onSubmit:r,onCancel:t,title:n,message:a,placeholder:l,defaultValue:c="",inputType:d="text",submitText:m="Submit",cancelText:v="Cancel"}){const[x,y]=Y.useState(c);Y.useEffect(()=>{e&&y(c)},[e,c]);const k=E=>{E.preventDefault(),x.trim()&&(r(x.trim()),t())};return f.jsx(_m,{isOpen:e,onClose:t,title:n,size:"sm",children:f.jsx("form",{onSubmit:k,children:f.jsxs("div",{className:"prompt-modal",children:[f.jsx("div",{className:"prompt-message",children:a}),f.jsx("input",{name:"modalInput",type:d,value:x,onChange:E=>y(E.target.value),placeholder:l,className:"input",autoFocus:!0,required:!0}),f.jsxs("div",{className:"modal-actions",children:[f.jsx("button",{type:"button",className:"btn btn-ghost",onClick:t,children:v}),f.jsx("button",{type:"submit",className:"btn btn-primary",children:m})]})]})})})}const Id={alert:{isOpen:!1,options:{message:""}},confirm:{isOpen:!1,options:{message:""}},prompt:{isOpen:!1,options:{message:""}}};function z3(){const[e,r]=Y.useState(Id),t=Y.useCallback(m=>new Promise(v=>{r(x=>({...x,alert:{isOpen:!0,options:m,resolve:v}}))}),[]),n=Y.useCallback(m=>new Promise(v=>{r(x=>({...x,confirm:{isOpen:!0,options:m,resolve:v}}))}),[]),a=Y.useCallback(m=>new Promise(v=>{r(x=>({...x,prompt:{isOpen:!0,options:m,resolve:v}}))}),[]),l=Y.useCallback(()=>{r(m=>(m.alert.resolve&&m.alert.resolve(),{...m,alert:{...Id.alert}}))},[]),c=Y.useCallback((m=!1)=>{r(v=>(v.confirm.resolve&&v.confirm.resolve(m),{...v,confirm:{...Id.confirm}}))},[]),d=Y.useCallback((m=null)=>{r(v=>(v.prompt.resolve&&v.prompt.resolve(m),{...v,prompt:{...Id.prompt}}))},[]);return{alertModal:e.alert,confirmModal:e.confirm,promptModal:e.prompt,alert:t,confirm:n,prompt:a,closeAlert:l,closeConfirm:c,closePrompt:d}}const ky=Y.createContext(null);function U3({children:e}){const r=z3();return f.jsxs(ky.Provider,{value:r,children:[e,f.jsx(j3,{isOpen:r.alertModal.isOpen,onClose:r.closeAlert,title:r.alertModal.options.title,message:r.alertModal.options.message,type:r.alertModal.options.type}),f.jsx(M3,{isOpen:r.confirmModal.isOpen,onConfirm:()=>r.closeConfirm(!0),onCancel:()=>r.closeConfirm(!1),title:r.confirmModal.options.title,message:r.confirmModal.options.message,confirmText:r.confirmModal.options.confirmText,cancelText:r.confirmModal.options.cancelText,type:r.confirmModal.options.type}),f.jsx(B3,{isOpen:r.promptModal.isOpen,onSubmit:t=>r.closePrompt(t),onCancel:()=>r.closePrompt(null),title:r.promptModal.options.title,message:r.promptModal.options.message,placeholder:r.promptModal.options.placeholder,defaultValue:r.promptModal.options.defaultValue,inputType:r.promptModal.options.inputType,submitText:r.promptModal.options.submitText,cancelText:r.promptModal.options.cancelText})]})}function $3(){const e=Y.useContext(ky);if(!e)throw new Error("useModalContext must be used within a ModalProvider");return e}function W3({onSignIn:e,onSignUp:r,onForceSignOut:t,isLoading:n,error:a,onClearError:l}){const[c,d]=Y.useState("signin"),[m,v]=Y.useState(""),[x,y]=Y.useState(""),[k,E]=Y.useState(""),b=async S=>{if(S.preventDefault(),!n){if(!m||!x){alert("Please enter email and password");return}if(c==="signup"&&x!==k){alert("Passwords do not match");return}try{c==="signin"?await e(m,x):await r(m,x)}catch{}}};return Y.useEffect(()=>{if(a){const S=setTimeout(()=>{l()},5e3);return()=>clearTimeout(S)}},[a,l]),f.jsx("div",{className:"container",children:f.jsxs("div",{style:{maxWidth:"400px",margin:"2rem auto",padding:"2rem",background:"var(--surface)",borderRadius:"var(--radius-lg)",border:"1px solid var(--border-light)",boxShadow:"var(--shadow-lg)"},children:[f.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[f.jsx("h1",{style:{margin:"0 0 0.5rem 0",fontSize:"1.75rem",background:"linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"📍 Address Navigator"}),f.jsx("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"0.875rem"},children:c==="signin"?"Sign in to sync across devices":"Create account to get started"})]}),a&&f.jsxs("div",{style:{padding:"0.75rem",marginBottom:"1rem",background:"var(--danger-light)",border:"1px solid var(--danger)",borderRadius:"var(--radius)",color:"var(--danger)",fontSize:"0.875rem"},children:["⚠️ ",a]}),f.jsxs("div",{style:{padding:"0.75rem",marginBottom:"1.5rem",background:"var(--primary-light)",border:"1px solid var(--primary)",borderRadius:"var(--radius)",color:"var(--primary-dark)",fontSize:"0.8125rem",textAlign:"center"},children:["🧪 ",f.jsx("strong",{children:"Demo Mode:"})," Use any email/password (6+ chars). Data syncs across browser tabs."]}),f.jsx("div",{style:{marginBottom:"1rem",textAlign:"center"},children:f.jsx("button",{type:"button",onClick:async()=>{try{await t(),l(),v(""),y(""),E("")}catch(S){console.error("Force signout error:",S)}},style:{background:"none",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"0.5rem 1rem",fontSize:"0.75rem",color:"var(--text-secondary)",cursor:"pointer"},children:"🔄 Clear Session"})}),f.jsx("form",{onSubmit:b,children:f.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)"},children:"📧 Email"}),f.jsx("input",{id:"email",name:"email",type:"email",value:m,onChange:S=>v(S.target.value),className:"input",placeholder:"your@email.com",disabled:n,required:!0,autoComplete:"email"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)"},children:"🔒 Password"}),f.jsx("input",{id:"password",name:"password",type:"password",value:x,onChange:S=>y(S.target.value),className:"input",placeholder:"Password (6+ characters)",disabled:n,minLength:6,required:!0,autoComplete:c==="signup"?"new-password":"current-password"})]}),c==="signup"&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"confirmPassword",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)"},children:"🔒 Confirm Password"}),f.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:k,onChange:S=>E(S.target.value),className:"input",placeholder:"Confirm password",disabled:n,minLength:6,required:!0,autoComplete:"new-password"})]}),f.jsx("button",{type:"submit",className:`btn btn-primary ${n?"pulse":""}`,disabled:n,style:{marginTop:"0.5rem"},children:n?f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"spinner"}),c==="signin"?"Signing in...":"Creating account..."]}):f.jsx(f.Fragment,{children:c==="signin"?"🚀 Sign In":"✨ Create Account"})})]})}),f.jsxs("div",{style:{textAlign:"center",marginTop:"1.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:[c==="signin"?"Don't have an account?":"Already have an account?"," ",f.jsx("button",{type:"button",onClick:()=>{d(c==="signin"?"signup":"signin"),l()},style:{background:"none",border:"none",color:"var(--primary)",textDecoration:"underline",cursor:"pointer",fontSize:"inherit"},children:c==="signin"?"Sign up":"Sign in"})]}),f.jsxs("div",{style:{marginTop:"1.5rem",padding:"0.75rem",background:"var(--bg-tertiary)",borderRadius:"var(--radius)",fontSize:"0.8125rem",color:"var(--text-muted)",textAlign:"center"},children:["💡 ",f.jsx("strong",{children:"Tip:"})," The app works offline. Data will sync when you're back online."]})]})})}function wm({state:e,arrangement:r,preSelectedAddressIndex:t,onAddAddress:n,onSave:a,onCancel:l,isLoading:c=!1,onComplete:d,fullscreen:m=!1}){const v=Xt.useRef(null),[x,y]=Xt.useState(!1),[k,E]=Xt.useState((t!=null,"existing")),[b,S]=Xt.useState({addressIndex:r?.addressIndex??t??0,manualAddress:"",customerName:r?.customerName??"",phoneNumber:r?.phoneNumber??"",totalAmount:r?.amount??"",scheduledDate:r?.scheduledDate??new Date().toISOString().slice(0,10),scheduledTime:r?.scheduledTime??"",notes:r?.notes??"",status:r?.status??"Scheduled",previousPayments:[],isRecurring:!1,recurrenceType:"weekly",recurrenceInterval:1,totalPayments:4}),[A,R]=Xt.useState({}),[O,N]=Xt.useState(()=>{try{const F=localStorage.getItem("uaf-collapsed-sections");return F?JSON.parse(F):{previousPayments:!1,recurringPayments:!0}}catch{return{previousPayments:!1,recurringPayments:!0}}}),[U,K]=Xt.useState(!1);Xt.useEffect(()=>{try{localStorage.setItem("uaf-collapsed-sections",JSON.stringify(O))}catch(F){console.error("Failed to save collapse preferences:",F)}},[O]);const B=F=>{N(M=>({...M,[F]:!M[F]}))},D=b.previousPayments.reduce((F,M)=>F+parseFloat(M.amount||"0"),0),te=parseFloat(b.totalAmount||"0"),ee=te-D,ve=b.previousPayments.length>0,me=Xt.useMemo(()=>[...b.previousPayments].sort((F,M)=>new Date(F.date).getTime()-new Date(M.date).getTime()),[b.previousPayments]),J=Xt.useMemo(()=>{if(!b.isRecurring||b.totalPayments<2)return[];const F=[],M=fa(b.scheduledDate);for(let H=0;H<b.totalPayments;H++){let X=M;b.recurrenceType==="weekly"?X=vv(M,H*b.recurrenceInterval):b.recurrenceType==="biweekly"?X=vv(M,H*2):b.recurrenceType==="monthly"&&(X=$A(M,H*b.recurrenceInterval)),F.push(Qd(X,"MMM d, yyyy"))}return F},[b.isRecurring,b.scheduledDate,b.recurrenceType,b.recurrenceInterval,b.totalPayments]),ce=Xt.useMemo(()=>{if(!r||!r.recurrenceType||r.recurrenceType==="none")return 0;const F=r.paymentsMade||0,M=r.totalPayments||1;return Math.round(F/M*100)},[r]);Xt.useEffect(()=>{if(r){const F=r.addressIndex>=0&&r.addressIndex<e.addresses.length,M=F?e.addresses[r.addressIndex]?.address:null,H=r.address;!F||!(M===H)?(E("manual"),S(fe=>({...fe,addressIndex:0,manualAddress:H,customerName:r.customerName??"",phoneNumber:r.phoneNumber??"",totalAmount:r.amount??"",scheduledDate:r.scheduledDate,scheduledTime:r.scheduledTime??"",notes:r.notes??"",status:r.status}))):(E("existing"),S(fe=>({...fe,addressIndex:r.addressIndex,manualAddress:"",customerName:r.customerName??"",phoneNumber:r.phoneNumber??"",totalAmount:r.amount??"",scheduledDate:r.scheduledDate,scheduledTime:r.scheduledTime??"",notes:r.notes??"",status:r.status}))),r.recurrenceType&&r.recurrenceType!=="none"&&S(fe=>({...fe,isRecurring:!0}))}},[r,e.addresses]);const ke=F=>{const M=parseFloat(F||"0");return!F||Number.isNaN(M)||M<=0?(R(H=>({...H,amount:"Please enter a valid total amount"})),!1):(R(H=>({...H,amount:void 0})),!0)},se=()=>{let F=!0;return ke(b.totalAmount)||(F=!1),ee<0&&(R(M=>({...M,amount:"Previous payments exceed total amount"})),F=!1),k==="existing"&&e.addresses.length===0&&(R(M=>({...M,address:"No addresses available"})),F=!1),k==="manual"&&!b.manualAddress.trim()&&(R(M=>({...M,address:"Please enter an address"})),F=!1),F},ue=()=>{const F={id:`previous_${Date.now()}`,amount:"",date:new Date().toISOString().slice(0,10),notes:""};S(M=>({...M,previousPayments:[...M.previousPayments,F]}))},j=(F,M)=>{S(H=>({...H,previousPayments:H.previousPayments.map(X=>X.id===F?{...X,...M}:X)}))},G=F=>{S(M=>({...M,previousPayments:M.previousPayments.filter(H=>H.id!==F)}))},Z=async F=>{F&&F.preventDefault(),!(x||c)&&se()&&K(!0)},oe=async()=>{K(!1),y(!0);try{let F=b.addressIndex,M="";if(k==="existing"){const ge=e.addresses[b.addressIndex];if(!ge)throw new Error("Selected address is not valid");if(b.addressIndex<0||b.addressIndex>=e.addresses.length){const ye=e.addresses.findIndex(xe=>xe.address.toLowerCase().trim()===ge.address.toLowerCase().trim());if(ye>=0)F=ye,M=e.addresses[ye].address;else throw new Error("Selected address is no longer available")}else M=ge.address}else{const ge=e.addresses.findIndex(ye=>ye.address.toLowerCase().trim()===b.manualAddress.toLowerCase().trim());if(ge>=0)F=ge,M=e.addresses[ge].address;else{if(!n)throw new Error("Cannot add new addresses");const ye={address:b.manualAddress.trim(),lat:null,lng:null};F=await n(ye),M=ye.address}}const H=ee>0?ee:te;let X=H;b.isRecurring&&b.totalPayments>1&&(X=H/b.totalPayments);const fe={addressIndex:F,address:M,customerName:b.customerName,phoneNumber:b.phoneNumber,scheduledDate:b.scheduledDate,scheduledTime:b.scheduledTime,amount:X.toFixed(2),notes:b.notes,status:b.status,recurrenceType:b.isRecurring?b.recurrenceType:"none",recurrenceInterval:b.isRecurring?b.recurrenceInterval:void 0,totalPayments:b.isRecurring?b.totalPayments:1,paymentsMade:r?.paymentsMade??0};await a(fe);for(const ge of b.previousPayments)if(parseFloat(ge.amount)>0)try{d(F,"PIF",ge.amount)}catch(ye){console.error("Error recording previous payment:",ye)}}catch(F){console.error("Error saving arrangement:",F),alert(`Failed to save arrangement: ${F instanceof Error?F.message:"Please try again."}`)}finally{y(!1)}};Xt.useEffect(()=>{if(!m)return;const F=M=>{M.key==="Escape"&&l()};return document.addEventListener("keydown",F),()=>document.removeEventListener("keydown",F)},[m,l]);const I=f.jsxs("form",{onSubmit:Z,className:"uaf-form",children:[f.jsxs("div",{className:"uaf-header",children:[f.jsx("h3",{className:"uaf-title",children:r?"✏️ Edit Payment Arrangement":"➕ Create Payment Arrangement"}),m&&f.jsx("button",{type:"button",className:"uaf-close",onClick:l,"aria-label":"Close",children:"✕"})]}),f.jsxs("div",{className:"uaf-section",children:[f.jsx("h4",{className:"uaf-section-title",children:"📍 Address & Customer"}),!r&&f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Address Source"}),f.jsxs("div",{className:"uaf-radio-group",children:[f.jsxs("label",{className:"uaf-radio-option",children:[f.jsx("input",{type:"radio",checked:k==="existing",onChange:()=>E("existing")}),f.jsx("span",{children:"📋 From List"})]}),f.jsxs("label",{className:"uaf-radio-option",children:[f.jsx("input",{type:"radio",checked:k==="manual",onChange:()=>E("manual")}),f.jsx("span",{children:"✏️ Enter Manually"})]})]})]}),k==="existing"?f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Address *"}),e.addresses.length===0?f.jsx("div",{className:"uaf-warning",children:'⚠️ No addresses in your list. Switch to "Enter Manually" to add a new address.'}):f.jsx("select",{value:b.addressIndex,onChange:F=>S(M=>({...M,addressIndex:parseInt(F.target.value)})),className:"uaf-input",required:!0,children:e.addresses.map((F,M)=>f.jsxs("option",{value:M,children:["#",M+1," - ",F.address]},M))})]}):f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Address *"}),f.jsx("input",{type:"text",value:b.manualAddress,onChange:F=>S(M=>({...M,manualAddress:F.target.value})),className:"uaf-input",placeholder:"Enter full address",required:!0}),f.jsx("div",{className:"uaf-hint",children:"💡 If this address doesn't exist in your list, it will be automatically added."})]}),f.jsxs("div",{className:"uaf-row",children:[f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Customer Name"}),f.jsx("input",{type:"text",value:b.customerName,onChange:F=>S(M=>({...M,customerName:F.target.value})),className:"uaf-input",placeholder:"Customer name"})]}),f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Phone Number"}),f.jsx("input",{type:"tel",value:b.phoneNumber,onChange:F=>S(M=>({...M,phoneNumber:F.target.value})),className:"uaf-input",placeholder:"Phone number"})]})]})]}),f.jsxs("div",{className:"uaf-section",children:[f.jsx("h4",{className:"uaf-section-title",children:"💰 Payment Details"}),f.jsxs("div",{className:"uaf-row",children:[f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Total Amount Owed *"}),f.jsxs("div",{className:"uaf-amount-input-wrapper",children:[f.jsx("span",{className:"uaf-amount-symbol",children:"£"}),f.jsx("input",{type:"number",step:"0.01",min:"0",value:b.totalAmount,onChange:F=>{S(M=>({...M,totalAmount:F.target.value})),ke(F.target.value)},className:`uaf-input uaf-amount-input ${A.amount?"uaf-input-error":""}`,placeholder:"0.00",required:!0})]}),A.amount&&f.jsx("div",{className:"uaf-error",children:A.amount})]}),f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Due Date *"}),f.jsx("input",{type:"date",value:b.scheduledDate,onChange:F=>S(M=>({...M,scheduledDate:F.target.value})),className:"uaf-input",required:!0})]})]}),f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Time (Optional)"}),f.jsx("input",{type:"time",value:b.scheduledTime,onChange:F=>S(M=>({...M,scheduledTime:F.target.value})),className:"uaf-input"})]})]}),f.jsxs("div",{className:"uaf-section",children:[f.jsxs("div",{className:"uaf-section-header uaf-section-header-collapsible",onClick:()=>B("previousPayments"),children:[f.jsxs("h4",{className:"uaf-section-title",children:[f.jsx("span",{className:"uaf-collapse-icon",children:O.previousPayments?"▶":"▼"}),"💳 Payments Already Made ",ve&&`(${b.previousPayments.length})`]}),f.jsx("button",{type:"button",onClick:F=>{F.stopPropagation(),ue()},className:"uaf-btn uaf-btn-sm uaf-btn-outline",children:"+ Add Payment"})]}),!O.previousPayments&&f.jsxs(f.Fragment,{children:[b.previousPayments.length===0?f.jsx("div",{className:"uaf-empty",children:"No previous payments recorded yet."}):f.jsx("div",{className:"uaf-payments-list",children:me.map(F=>f.jsxs("div",{className:"uaf-payment-item",children:[f.jsxs("div",{className:"uaf-row",children:[f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Amount"}),f.jsx("input",{type:"number",step:"0.01",min:"0",value:F.amount,onChange:M=>j(F.id,{amount:M.target.value}),className:"uaf-input",placeholder:"0.00"})]}),f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Date Paid"}),f.jsx("input",{type:"date",value:F.date,onChange:M=>j(F.id,{date:M.target.value}),className:"uaf-input"})]}),f.jsx("div",{className:"uaf-field uaf-field-actions",children:f.jsx("button",{type:"button",onClick:()=>G(F.id),className:"uaf-btn uaf-btn-sm uaf-btn-danger",title:"Remove payment",children:"🗑️"})})]}),f.jsx("div",{className:"uaf-field",children:f.jsx("input",{type:"text",value:F.notes||"",onChange:M=>j(F.id,{notes:M.target.value}),className:"uaf-input",placeholder:"Payment notes (optional)"})})]},F.id))}),ve&&f.jsxs("div",{className:"uaf-payment-summary",children:[f.jsxs("div",{className:"uaf-summary-row",children:[f.jsx("span",{children:"Total Amount Owed:"}),f.jsxs("span",{children:["£",parseFloat(b.totalAmount||"0").toFixed(2)]})]}),f.jsxs("div",{className:"uaf-summary-row",children:[f.jsx("span",{children:"Already Paid:"}),f.jsxs("span",{children:["-£",D.toFixed(2)]})]}),f.jsxs("div",{className:"uaf-summary-row uaf-summary-total",children:[f.jsx("span",{children:"Still Owed:"}),f.jsxs("span",{children:["£",Math.max(0,ee).toFixed(2)]})]})]})]})]}),ee>0&&f.jsxs("div",{className:"uaf-section",children:[f.jsx("div",{className:"uaf-section-header uaf-section-header-collapsible",onClick:()=>B("recurringPayments"),children:f.jsxs("h4",{className:"uaf-section-title",children:[f.jsx("span",{className:"uaf-collapse-icon",children:O.recurringPayments?"▶":"▼"}),"🔄 Optional: Split Remaining Balance"]})}),!O.recurringPayments&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"uaf-field",children:f.jsxs("label",{className:"uaf-radio-option",children:[f.jsx("input",{type:"checkbox",checked:b.isRecurring,onChange:F=>S(M=>({...M,isRecurring:F.target.checked}))}),f.jsxs("span",{children:["Split £",ee.toFixed(2)," into multiple payments"]})]})}),b.isRecurring&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"uaf-row",children:[f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Frequency"}),f.jsxs("select",{value:b.recurrenceType,onChange:F=>S(M=>({...M,recurrenceType:F.target.value})),className:"uaf-input",children:[f.jsx("option",{value:"weekly",children:"Weekly"}),f.jsx("option",{value:"biweekly",children:"Bi-weekly (Every 2 weeks)"}),f.jsx("option",{value:"monthly",children:"Monthly"})]})]}),f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Number of Payments"}),f.jsx("input",{type:"number",min:"2",max:"12",value:b.totalPayments,onChange:F=>S(M=>({...M,totalPayments:parseInt(F.target.value)||2})),className:"uaf-input"})]})]}),f.jsxs("div",{className:"uaf-payment-preview",children:["💡 ",b.totalPayments," payments of £",(ee/b.totalPayments).toFixed(2)," each"]}),J.length>0&&f.jsxs("div",{className:"uaf-timeline",children:[f.jsx("div",{className:"uaf-timeline-title",children:"📅 Payment Schedule:"}),f.jsx("div",{className:"uaf-timeline-dates",children:J.map((F,M)=>f.jsxs("div",{className:"uaf-timeline-item",children:[f.jsx("span",{className:"uaf-timeline-number",children:M+1}),f.jsx("span",{className:"uaf-timeline-date",children:F}),f.jsxs("span",{className:"uaf-timeline-amount",children:["£",(ee/b.totalPayments).toFixed(2)]})]},M))})]}),r&&r.recurrenceType&&r.recurrenceType!=="none"&&f.jsxs("div",{className:"uaf-completion-progress",children:[f.jsxs("div",{className:"uaf-completion-header",children:[f.jsx("span",{children:"Payment Progress"}),f.jsxs("span",{className:"uaf-completion-text",children:[r.paymentsMade||0," of ",r.totalPayments||1," (",ce,"%)"]})]}),f.jsx("div",{className:"uaf-completion-bar",children:f.jsx("div",{className:"uaf-completion-fill",style:{width:`${ce}%`}})})]})]})]})]}),f.jsx("div",{className:"uaf-section",children:f.jsxs("div",{className:"uaf-field",children:[f.jsx("label",{className:"uaf-label",children:"Notes"}),f.jsx("textarea",{value:b.notes,onChange:F=>S(M=>({...M,notes:F.target.value})),className:"uaf-input uaf-textarea",rows:3,placeholder:"Payment terms, special instructions, etc..."})]})}),f.jsxs("div",{className:"uaf-actions",children:[f.jsx("button",{type:"button",className:"uaf-btn uaf-btn-ghost",onClick:l,children:"Cancel"}),f.jsxs(Ai,{type:"submit",className:"uaf-btn uaf-btn-primary",isLoading:c||x,loadingText:r?"Updating...":"Creating...",disabled:k==="existing"&&e.addresses.length===0,children:[r?"💾 Update":"📅 Review & Create"," Arrangement"]})]}),U&&f.jsx("div",{className:"uaf-confirmation-overlay",onClick:()=>K(!1),children:f.jsxs("div",{className:"uaf-confirmation-modal",onClick:F=>F.stopPropagation(),children:[f.jsx("div",{className:"uaf-confirmation-header",children:f.jsx("h3",{children:"✅ Confirm Arrangement Details"})}),f.jsxs("div",{className:"uaf-confirmation-body",children:[f.jsxs("div",{className:"uaf-confirmation-section",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"📍 Address"}),f.jsx("div",{className:"uaf-confirmation-value",children:k==="existing"?e.addresses[b.addressIndex]?.address:b.manualAddress})]}),b.customerName&&f.jsxs("div",{className:"uaf-confirmation-section",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"👤 Customer"}),f.jsx("div",{className:"uaf-confirmation-value",children:b.customerName})]}),f.jsxs("div",{className:"uaf-confirmation-section",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"💰 Total Amount"}),f.jsxs("div",{className:"uaf-confirmation-value uaf-confirmation-amount",children:["£",parseFloat(b.totalAmount||"0").toFixed(2)]})]}),ve&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"uaf-confirmation-section",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"💳 Previous Payments"}),f.jsxs("div",{className:"uaf-confirmation-value",children:["£",D.toFixed(2)," (",b.previousPayments.length," payment",b.previousPayments.length>1?"s":"",")"]})]}),f.jsxs("div",{className:"uaf-confirmation-section",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"📊 Remaining Balance"}),f.jsxs("div",{className:"uaf-confirmation-value uaf-confirmation-highlight",children:["£",ee.toFixed(2)]})]})]}),f.jsxs("div",{className:"uaf-confirmation-section",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"📅 Payment Due"}),f.jsxs("div",{className:"uaf-confirmation-value",children:[Qd(fa(b.scheduledDate),"MMMM d, yyyy"),b.scheduledTime&&` at ${b.scheduledTime}`]})]}),b.isRecurring&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"uaf-confirmation-section",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"🔄 Payment Plan"}),f.jsxs("div",{className:"uaf-confirmation-value",children:[b.totalPayments," ",b.recurrenceType," payments of £",(ee/b.totalPayments).toFixed(2)]})]}),f.jsxs("div",{className:"uaf-confirmation-timeline",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"📅 Schedule:"}),f.jsxs("div",{className:"uaf-confirmation-dates",children:[J.slice(0,3).map((F,M)=>f.jsx("span",{children:F},M)),J.length>3&&f.jsxs("span",{children:["+ ",J.length-3," more..."]})]})]})]}),b.notes&&f.jsxs("div",{className:"uaf-confirmation-section",children:[f.jsx("div",{className:"uaf-confirmation-label",children:"📝 Notes"}),f.jsx("div",{className:"uaf-confirmation-value",children:b.notes})]})]}),f.jsxs("div",{className:"uaf-confirmation-actions",children:[f.jsx("button",{type:"button",className:"uaf-btn uaf-btn-ghost",onClick:()=>K(!1),children:"← Back to Edit"}),f.jsx(Ai,{type:"button",className:"uaf-btn uaf-btn-success",isLoading:x,loadingText:"Creating...",onClick:oe,children:"✅ Confirm & Create"})]})]})})]}),P=f.jsx("style",{children:`
        /* Unified Arrangement Form Styles */
        .uaf-container {
          background: var(--card-bg, white);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 12px;
          overflow: hidden;
        }

        .uaf-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 4000;
          display: flex;
          align-items: flex-start;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          overflow-y: auto;
          padding-top: 2rem;
        }

        .uaf-modal {
          background: var(--card-bg, white);
          border-radius: 16px;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
          width: 100%;
          max-width: 700px;
          max-height: 90vh;
          overflow-y: auto;
          margin: 0 auto;
        }

        .uaf-form {
          padding: 1.5rem;
          color: var(--text-primary);
        }

        .uaf-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 2rem;
          padding-bottom: 1rem;
          border-bottom: 1px solid var(--border, #e2e8f0);
        }

        .uaf-title {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          padding: 0.5rem;
          border-radius: 8px;
          cursor: pointer;
          color: var(--text-muted);
          line-height: 1;
        }

        .uaf-close:hover {
          background: var(--gray-100);
        }

        .uaf-section {
          margin-bottom: 1.5rem;
          padding: 0;
          background: transparent;
          border-radius: 0;
          border: none;
          border-bottom: 1px solid var(--border, #e2e8f0);
          padding-bottom: 1.5rem;
        }

        .uaf-section:last-of-type {
          border-bottom: none;
          padding-bottom: 0;
        }

        .uaf-section-title {
          margin: 0 0 1rem 0;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-section-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .uaf-field {
          margin-bottom: 1rem;
        }

        .uaf-field-actions {
          display: flex;
          align-items: flex-end;
        }

        .uaf-label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          margin-bottom: 0.5rem;
        }

        .uaf-input {
          width: 100%;
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
          padding: 0.75rem;
          font-size: 14px;
          background: var(--input-bg, white);
          color: var(--text-primary);
          transition: border-color 0.15s ease;
        }

        .uaf-input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14,165,233,0.1);
        }

        .uaf-input-error {
          border-color: var(--danger, #dc2626);
        }

        .uaf-textarea {
          resize: vertical;
          min-height: 80px;
        }

        .uaf-error {
          color: var(--danger, #dc2626);
          font-size: 0.8125rem;
          margin-top: 0.25rem;
        }

        .uaf-warning {
          padding: 0.75rem;
          background: var(--warning-light, #fef3c7);
          border: 1px solid var(--warning, #f59e0b);
          border-radius: 6px;
          color: var(--warning-dark, #92400e);
          font-size: 0.875rem;
        }

        .uaf-hint {
          font-size: 0.8125rem;
          color: var(--text-muted);
          margin-top: 0.25rem;
        }

        .uaf-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
          align-items: start;
        }

        .uaf-radio-group {
          display: flex;
          gap: 1rem;
          flex-wrap: wrap;
        }

        .uaf-radio-option {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          cursor: pointer;
          padding: 0.5rem 1rem;
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
          background: var(--input-bg, white);
          transition: all 0.15s ease;
        }

        .uaf-radio-option:hover {
          border-color: var(--primary, #0ea5e9);
        }

        .uaf-radio-option input[type="radio"] {
          margin: 0;
        }

        .uaf-radio-option input[type="radio"]:checked + span {
          font-weight: 600;
          color: var(--primary, #0ea5e9);
        }

        .uaf-payment-preview {
          padding: 0.75rem;
          background: var(--blue-50, #eff6ff);
          border: 1px solid var(--blue-200, #bfdbfe);
          border-radius: 6px;
          color: var(--blue-700, #1d4ed8);
          font-size: 0.875rem;
          font-weight: 500;
        }

        .uaf-empty {
          text-align: center;
          padding: 2rem;
          color: var(--text-muted);
          font-style: italic;
        }

        .uaf-payments-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .uaf-payment-item {
          padding: 1rem;
          background: var(--input-bg, white);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-payment-summary {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-summary-row {
          display: flex;
          justify-content: space-between;
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .uaf-summary-total {
          border-top: 1px solid var(--border, #e2e8f0);
          padding-top: 0.5rem;
          margin-top: 0.5rem;
          font-weight: 600;
          font-size: 1rem;
          color: var(--success-dark, #059669);
        }

        .uaf-actions {
          display: flex;
          gap: 0.75rem;
          justify-content: flex-end;
          padding-top: 1rem;
          border-top: 1px solid var(--border, #e2e8f0);
        }

        .uaf-btn {
          border-radius: 6px;
          padding: 0.75rem 1.5rem;
          font-weight: 500;
          border: 1px solid transparent;
          cursor: pointer;
          transition: all 0.15s ease;
          font-size: 14px;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
        }

        .uaf-btn-sm {
          padding: 0.5rem 1rem;
          font-size: 0.875rem;
        }

        .uaf-btn-ghost {
          background: var(--card-bg, white);
          border-color: var(--border, #e2e8f0);
          color: var(--text-primary);
        }

        .uaf-btn-ghost:hover {
          background: var(--gray-100, #f3f4f6);
        }

        .uaf-btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
          border-color: var(--primary, #0ea5e9);
        }

        .uaf-btn-primary:hover {
          background: var(--primary-dark, #0284c7);
        }

        .uaf-btn-outline {
          background: transparent;
          border-color: var(--primary, #0ea5e9);
          color: var(--primary, #0ea5e9);
        }

        .uaf-btn-outline:hover {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .uaf-btn-danger {
          background: var(--danger, #dc2626);
          color: white;
          border-color: var(--danger, #dc2626);
        }

        .uaf-btn-danger:hover {
          background: var(--danger-dark, #b91c1c);
        }

        .uaf-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .uaf-btn-success {
          background: var(--success, #10b981);
          color: white;
          border-color: var(--success, #10b981);
        }

        .uaf-btn-success:hover {
          background: var(--success-dark, #059669);
        }

        /* Collapsible Section Styles */
        .uaf-section-header-collapsible {
          cursor: pointer;
          user-select: none;
        }

        .uaf-section-header-collapsible:hover {
          background: var(--gray-50, #f9fafb);
          border-radius: 6px;
          margin: -0.5rem;
          padding: 0.5rem;
        }

        .uaf-collapse-icon {
          display: inline-block;
          margin-right: 0.5rem;
          font-size: 0.75rem;
          transition: transform 0.2s ease;
        }

        /* Amount Input with £ Symbol */
        .uaf-amount-input-wrapper {
          position: relative;
          display: flex;
          align-items: center;
        }

        .uaf-amount-symbol {
          position: absolute;
          left: 0.75rem;
          font-size: 1.1rem;
          font-weight: 600;
          color: var(--success, #10b981);
          z-index: 1;
          pointer-events: none;
        }

        .uaf-amount-input {
          padding-left: 2rem !important;
          font-weight: 600;
          color: var(--success-dark, #059669);
          border-color: var(--success-light, #a7f3d0) !important;
          background: var(--success-lighter, #f0fdf4) !important;
        }

        .uaf-amount-input:focus {
          border-color: var(--success, #10b981) !important;
          box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1) !important;
        }

        /* Timeline Styles */
        .uaf-timeline {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-timeline-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-secondary);
          margin-bottom: 0.75rem;
        }

        .uaf-timeline-dates {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .uaf-timeline-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: 4px;
          border-left: 3px solid var(--primary, #0ea5e9);
        }

        .uaf-timeline-number {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 1.5rem;
          height: 1.5rem;
          background: var(--primary, #0ea5e9);
          color: white;
          border-radius: 50%;
          font-size: 0.75rem;
          font-weight: 600;
          flex-shrink: 0;
        }

        .uaf-timeline-date {
          flex: 1;
          font-size: 0.875rem;
          color: var(--text-primary);
        }

        .uaf-timeline-amount {
          font-weight: 600;
          color: var(--success-dark, #059669);
          font-size: 0.875rem;
        }

        /* Completion Progress Bar */
        .uaf-completion-progress {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--blue-50, #eff6ff);
          border: 1px solid var(--blue-200, #bfdbfe);
          border-radius: 6px;
        }

        .uaf-completion-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--blue-700, #1d4ed8);
        }

        .uaf-completion-text {
          font-size: 0.8125rem;
        }

        .uaf-completion-bar {
          width: 100%;
          height: 0.5rem;
          background: var(--blue-100, #dbeafe);
          border-radius: 1rem;
          overflow: hidden;
        }

        .uaf-completion-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--success, #10b981), var(--primary, #0ea5e9));
          transition: width 0.3s ease;
          border-radius: 1rem;
        }

        /* Confirmation Modal Styles */
        .uaf-confirmation-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.6);
          z-index: 5000;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        .uaf-confirmation-modal {
          background: var(--card-bg, white);
          border-radius: 16px;
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          width: 100%;
          max-width: 550px;
          max-height: 85vh;
          overflow-y: auto;
          animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .uaf-confirmation-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--border, #e2e8f0);
          background: var(--gray-50, #f9fafb);
        }

        .uaf-confirmation-header h3 {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-confirmation-body {
          padding: 1.5rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .uaf-confirmation-section {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .uaf-confirmation-label {
          font-size: 0.8125rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .uaf-confirmation-value {
          font-size: 1rem;
          color: var(--text-primary);
          font-weight: 500;
        }

        .uaf-confirmation-amount {
          font-size: 1.5rem;
          font-weight: 700;
          color: var(--success-dark, #059669);
        }

        .uaf-confirmation-highlight {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--primary, #0ea5e9);
        }

        .uaf-confirmation-timeline {
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border-radius: 6px;
          border: 1px solid var(--border, #e2e8f0);
        }

        .uaf-confirmation-dates {
          display: flex;
          flex-wrap: wrap;
          gap: 0.5rem;
          margin-top: 0.5rem;
        }

        .uaf-confirmation-dates span {
          padding: 0.25rem 0.75rem;
          background: var(--primary-light, #e0f2fe);
          color: var(--primary-dark, #0369a1);
          border-radius: 4px;
          font-size: 0.8125rem;
          font-weight: 500;
        }

        .uaf-confirmation-actions {
          display: flex;
          gap: 0.75rem;
          padding: 1.5rem;
          border-top: 1px solid var(--border, #e2e8f0);
          background: var(--gray-50, #f9fafb);
        }

        .uaf-confirmation-actions .uaf-btn {
          flex: 1;
        }

        /* Dark mode styles */
        .dark-mode .uaf-container,
        .dark-mode .uaf-modal {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-section {
          background: transparent;
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-summary {
          background: var(--gray-300);
          border-color: var(--gray-400);
        }

        .dark-mode .uaf-input {
          background: var(--gray-100);
          border-color: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .uaf-radio-option {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-preview {
          background: var(--blue-100);
          border-color: var(--blue-300);
          color: var(--blue-800);
        }

        .dark-mode .uaf-warning {
          background: var(--yellow-100);
          border-color: var(--yellow-400);
          color: var(--yellow-800);
        }

        /* Dark mode for new components */
        .dark-mode .uaf-amount-input {
          background: var(--success-lighter, #ecfdf5) !important;
          color: var(--success-dark, #065f46);
        }

        .dark-mode .uaf-amount-symbol {
          color: var(--success-dark, #065f46);
        }

        .dark-mode .uaf-timeline {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-timeline-item {
          background: var(--gray-100);
        }

        .dark-mode .uaf-completion-progress {
          background: var(--blue-100);
          border-color: var(--blue-300);
        }

        .dark-mode .uaf-confirmation-overlay {
          background: rgba(0, 0, 0, 0.75);
        }

        .dark-mode .uaf-confirmation-modal {
          background: var(--gray-100);
        }

        .dark-mode .uaf-confirmation-header {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-confirmation-header h3 {
          color: var(--gray-800);
        }

        .dark-mode .uaf-confirmation-label {
          color: var(--gray-600);
        }

        .dark-mode .uaf-confirmation-value {
          color: var(--gray-800);
        }

        .dark-mode .uaf-confirmation-timeline {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-confirmation-actions {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .uaf-modal {
            margin: 0.5rem;
            max-width: none;
          }

          .uaf-row {
            grid-template-columns: 1fr;
          }

          .uaf-radio-group {
            flex-direction: column;
          }

          .uaf-actions {
            flex-direction: column-reverse;
          }

          .uaf-btn {
            width: 100%;
          }
        }
      `});return m?f.jsxs(f.Fragment,{children:[f.jsx("div",{ref:v,className:"uaf-overlay",onClick:F=>{F.target===F.currentTarget&&l()},children:f.jsx("div",{className:"uaf-modal",children:I})}),P]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"uaf-container",children:I}),P]})}function by(e,r){const t=Y.useRef(r);Y.useEffect(function(){r!==t.current&&e.attributionControl!=null&&(t.current!=null&&e.attributionControl.removeAttribution(t.current),r!=null&&e.attributionControl.addAttribution(r)),t.current=r},[e,r])}var Sy=lx();const V3=1;function H3(e){return Object.freeze({__version:V3,map:e})}function Ty(e,r){return Object.freeze({...e,...r})}const Ey=Y.createContext(null),Cy=Ey.Provider;function uf(){const e=Y.useContext(Ey);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Ay(e){function r(t,n){const{instance:a,context:l}=e(t).current;return Y.useImperativeHandle(n,()=>a),t.children==null?null:Xt.createElement(Cy,{value:l},t.children)}return Y.forwardRef(r)}function G3(e){function r(t,n){const[a,l]=Y.useState(!1),{instance:c}=e(t,l).current;Y.useImperativeHandle(n,()=>c),Y.useEffect(function(){a&&c.update()},[c,a,t.children]);const d=c._contentNode;return d?Sy.createPortal(t.children,d):null}return Y.forwardRef(r)}function Z3(e){function r(t,n){const{instance:a}=e(t).current;return Y.useImperativeHandle(n,()=>a),null}return Y.forwardRef(r)}function km(e,r){const t=Y.useRef();Y.useEffect(function(){return r!=null&&e.instance.on(r),t.current=r,function(){t.current!=null&&e.instance.off(t.current),t.current=null}},[e,r])}function df(e,r){const t=e.pane??r.pane;return t?{...e,pane:t}:e}function K3(e,r){return function(n,a){const l=uf(),c=e(df(n,l),l);return by(l.map,n.attribution),km(c.current,n.eventHandlers),r(c.current,l,n,a),c}}var Ec={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var q3=Ec.exports,Xv;function Y3(){return Xv||(Xv=1,(function(e,r){(function(t,n){n(r)})(q3,(function(t){var n="1.9.4";function a(s){var u,p,_,C;for(p=1,_=arguments.length;p<_;p++){C=arguments[p];for(u in C)s[u]=C[u]}return s}var l=Object.create||(function(){function s(){}return function(u){return s.prototype=u,new s}})();function c(s,u){var p=Array.prototype.slice;if(s.bind)return s.bind.apply(s,p.call(arguments,1));var _=p.call(arguments,2);return function(){return s.apply(u,_.length?_.concat(p.call(arguments)):arguments)}}var d=0;function m(s){return"_leaflet_id"in s||(s._leaflet_id=++d),s._leaflet_id}function v(s,u,p){var _,C,V,de;return de=function(){_=!1,C&&(V.apply(p,C),C=!1)},V=function(){_?C=arguments:(s.apply(p,arguments),setTimeout(de,u),_=!0)},V}function x(s,u,p){var _=u[1],C=u[0],V=_-C;return s===_&&p?s:((s-C)%V+V)%V+C}function y(){return!1}function k(s,u){if(u===!1)return s;var p=Math.pow(10,u===void 0?6:u);return Math.round(s*p)/p}function E(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function b(s){return E(s).split(/\s+/)}function S(s,u){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?l(s.options):{});for(var p in u)s.options[p]=u[p];return s.options}function A(s,u,p){var _=[];for(var C in s)_.push(encodeURIComponent(p?C.toUpperCase():C)+"="+encodeURIComponent(s[C]));return(!u||u.indexOf("?")===-1?"?":"&")+_.join("&")}var R=/\{ *([\w_ -]+) *\}/g;function O(s,u){return s.replace(R,function(p,_){var C=u[_];if(C===void 0)throw new Error("No value provided for variable "+p);return typeof C=="function"&&(C=C(u)),C})}var N=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function U(s,u){for(var p=0;p<s.length;p++)if(s[p]===u)return p;return-1}var K="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function B(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var D=0;function te(s){var u=+new Date,p=Math.max(0,16-(u-D));return D=u+p,window.setTimeout(s,p)}var ee=window.requestAnimationFrame||B("RequestAnimationFrame")||te,ve=window.cancelAnimationFrame||B("CancelAnimationFrame")||B("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function me(s,u,p){if(p&&ee===te)s.call(u);else return ee.call(window,c(s,u))}function J(s){s&&ve.call(window,s)}var ce={__proto__:null,extend:a,create:l,bind:c,get lastId(){return d},stamp:m,throttle:v,wrapNum:x,falseFn:y,formatNum:k,trim:E,splitWords:b,setOptions:S,getParamString:A,template:O,isArray:N,indexOf:U,emptyImageUrl:K,requestFn:ee,cancelFn:ve,requestAnimFrame:me,cancelAnimFrame:J};function ke(){}ke.extend=function(s){var u=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=u.__super__=this.prototype,_=l(p);_.constructor=u,u.prototype=_;for(var C in this)Object.prototype.hasOwnProperty.call(this,C)&&C!=="prototype"&&C!=="__super__"&&(u[C]=this[C]);return s.statics&&a(u,s.statics),s.includes&&(se(s.includes),a.apply(null,[_].concat(s.includes))),a(_,s),delete _.statics,delete _.includes,_.options&&(_.options=p.options?l(p.options):{},a(_.options,s.options)),_._initHooks=[],_.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var V=0,de=_._initHooks.length;V<de;V++)_._initHooks[V].call(this)}},u},ke.include=function(s){var u=this.prototype.options;return a(this.prototype,s),s.options&&(this.prototype.options=u,this.mergeOptions(s.options)),this},ke.mergeOptions=function(s){return a(this.prototype.options,s),this},ke.addInitHook=function(s){var u=Array.prototype.slice.call(arguments,1),p=typeof s=="function"?s:function(){this[s].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function se(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=N(s)?s:[s];for(var u=0;u<s.length;u++)s[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ue={on:function(s,u,p){if(typeof s=="object")for(var _ in s)this._on(_,s[_],u);else{s=b(s);for(var C=0,V=s.length;C<V;C++)this._on(s[C],u,p)}return this},off:function(s,u,p){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var _ in s)this._off(_,s[_],u);else{s=b(s);for(var C=arguments.length===1,V=0,de=s.length;V<de;V++)C?this._off(s[V]):this._off(s[V],u,p)}return this},_on:function(s,u,p,_){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(s,u,p)===!1){p===this&&(p=void 0);var C={fn:u,ctx:p};_&&(C.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(C)}},_off:function(s,u,p){var _,C,V;if(this._events&&(_=this._events[s],!!_)){if(arguments.length===1){if(this._firingCount)for(C=0,V=_.length;C<V;C++)_[C].fn=y;delete this._events[s];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var de=this._listens(s,u,p);if(de!==!1){var we=_[de];this._firingCount&&(we.fn=y,this._events[s]=_=_.slice()),_.splice(de,1)}}},fire:function(s,u,p){if(!this.listens(s,p))return this;var _=a({},u,{type:s,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var C=this._events[s];if(C){this._firingCount=this._firingCount+1||1;for(var V=0,de=C.length;V<de;V++){var we=C[V],Pe=we.fn;we.once&&this.off(s,Pe,we.ctx),Pe.call(we.ctx||this,_)}this._firingCount--}}return p&&this._propagateEvent(_),this},listens:function(s,u,p,_){typeof s!="string"&&console.warn('"string" type argument expected');var C=u;typeof u!="function"&&(_=!!u,C=void 0,p=void 0);var V=this._events&&this._events[s];if(V&&V.length&&this._listens(s,C,p)!==!1)return!0;if(_){for(var de in this._eventParents)if(this._eventParents[de].listens(s,u,p,_))return!0}return!1},_listens:function(s,u,p){if(!this._events)return!1;var _=this._events[s]||[];if(!u)return!!_.length;p===this&&(p=void 0);for(var C=0,V=_.length;C<V;C++)if(_[C].fn===u&&_[C].ctx===p)return C;return!1},once:function(s,u,p){if(typeof s=="object")for(var _ in s)this._on(_,s[_],u,!0);else{s=b(s);for(var C=0,V=s.length;C<V;C++)this._on(s[C],u,p,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[m(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[m(s)],this},_propagateEvent:function(s){for(var u in this._eventParents)this._eventParents[u].fire(s.type,a({layer:s.target,propagatedFrom:s.target},s),!0)}};ue.addEventListener=ue.on,ue.removeEventListener=ue.clearAllEventListeners=ue.off,ue.addOneTimeEventListener=ue.once,ue.fireEvent=ue.fire,ue.hasEventListeners=ue.listens;var j=ke.extend(ue);function G(s,u,p){this.x=p?Math.round(s):s,this.y=p?Math.round(u):u}var Z=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};G.prototype={clone:function(){return new G(this.x,this.y)},add:function(s){return this.clone()._add(oe(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(oe(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new G(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new G(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Z(this.x),this.y=Z(this.y),this},distanceTo:function(s){s=oe(s);var u=s.x-this.x,p=s.y-this.y;return Math.sqrt(u*u+p*p)},equals:function(s){return s=oe(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=oe(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};function oe(s,u,p){return s instanceof G?s:N(s)?new G(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new G(s.x,s.y):new G(s,u,p)}function I(s,u){if(s)for(var p=u?[s,u]:s,_=0,C=p.length;_<C;_++)this.extend(p[_])}I.prototype={extend:function(s){var u,p;if(!s)return this;if(s instanceof G||typeof s[0]=="number"||"x"in s)u=p=oe(s);else if(s=P(s),u=s.min,p=s.max,!u||!p)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=p.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(s){return oe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return oe(this.min.x,this.max.y)},getTopRight:function(){return oe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var u,p;return typeof s[0]=="number"||s instanceof G?s=oe(s):s=P(s),s instanceof I?(u=s.min,p=s.max):u=p=s,u.x>=this.min.x&&p.x<=this.max.x&&u.y>=this.min.y&&p.y<=this.max.y},intersects:function(s){s=P(s);var u=this.min,p=this.max,_=s.min,C=s.max,V=C.x>=u.x&&_.x<=p.x,de=C.y>=u.y&&_.y<=p.y;return V&&de},overlaps:function(s){s=P(s);var u=this.min,p=this.max,_=s.min,C=s.max,V=C.x>u.x&&_.x<p.x,de=C.y>u.y&&_.y<p.y;return V&&de},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var u=this.min,p=this.max,_=Math.abs(u.x-p.x)*s,C=Math.abs(u.y-p.y)*s;return P(oe(u.x-_,u.y-C),oe(p.x+_,p.y+C))},equals:function(s){return s?(s=P(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function P(s,u){return!s||s instanceof I?s:new I(s,u)}function F(s,u){if(s)for(var p=u?[s,u]:s,_=0,C=p.length;_<C;_++)this.extend(p[_])}F.prototype={extend:function(s){var u=this._southWest,p=this._northEast,_,C;if(s instanceof H)_=s,C=s;else if(s instanceof F){if(_=s._southWest,C=s._northEast,!_||!C)return this}else return s?this.extend(X(s)||M(s)):this;return!u&&!p?(this._southWest=new H(_.lat,_.lng),this._northEast=new H(C.lat,C.lng)):(u.lat=Math.min(_.lat,u.lat),u.lng=Math.min(_.lng,u.lng),p.lat=Math.max(C.lat,p.lat),p.lng=Math.max(C.lng,p.lng)),this},pad:function(s){var u=this._southWest,p=this._northEast,_=Math.abs(u.lat-p.lat)*s,C=Math.abs(u.lng-p.lng)*s;return new F(new H(u.lat-_,u.lng-C),new H(p.lat+_,p.lng+C))},getCenter:function(){return new H((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new H(this.getNorth(),this.getWest())},getSouthEast:function(){return new H(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof H||"lat"in s?s=X(s):s=M(s);var u=this._southWest,p=this._northEast,_,C;return s instanceof F?(_=s.getSouthWest(),C=s.getNorthEast()):_=C=s,_.lat>=u.lat&&C.lat<=p.lat&&_.lng>=u.lng&&C.lng<=p.lng},intersects:function(s){s=M(s);var u=this._southWest,p=this._northEast,_=s.getSouthWest(),C=s.getNorthEast(),V=C.lat>=u.lat&&_.lat<=p.lat,de=C.lng>=u.lng&&_.lng<=p.lng;return V&&de},overlaps:function(s){s=M(s);var u=this._southWest,p=this._northEast,_=s.getSouthWest(),C=s.getNorthEast(),V=C.lat>u.lat&&_.lat<p.lat,de=C.lng>u.lng&&_.lng<p.lng;return V&&de},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,u){return s?(s=M(s),this._southWest.equals(s.getSouthWest(),u)&&this._northEast.equals(s.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function M(s,u){return s instanceof F?s:new F(s,u)}function H(s,u,p){if(isNaN(s)||isNaN(u))throw new Error("Invalid LatLng object: ("+s+", "+u+")");this.lat=+s,this.lng=+u,p!==void 0&&(this.alt=+p)}H.prototype={equals:function(s,u){if(!s)return!1;s=X(s);var p=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return p<=(u===void 0?1e-9:u)},toString:function(s){return"LatLng("+k(this.lat,s)+", "+k(this.lng,s)+")"},distanceTo:function(s){return ge.distance(this,X(s))},wrap:function(){return ge.wrapLatLng(this)},toBounds:function(s){var u=180*s/40075017,p=u/Math.cos(Math.PI/180*this.lat);return M([this.lat-u,this.lng-p],[this.lat+u,this.lng+p])},clone:function(){return new H(this.lat,this.lng,this.alt)}};function X(s,u,p){return s instanceof H?s:N(s)&&typeof s[0]!="object"?s.length===3?new H(s[0],s[1],s[2]):s.length===2?new H(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new H(s.lat,"lng"in s?s.lng:s.lon,s.alt):u===void 0?null:new H(s,u,p)}var fe={latLngToPoint:function(s,u){var p=this.projection.project(s),_=this.scale(u);return this.transformation._transform(p,_)},pointToLatLng:function(s,u){var p=this.scale(u),_=this.transformation.untransform(s,p);return this.projection.unproject(_)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var u=this.projection.bounds,p=this.scale(s),_=this.transformation.transform(u.min,p),C=this.transformation.transform(u.max,p);return new I(_,C)},infinite:!1,wrapLatLng:function(s){var u=this.wrapLng?x(s.lng,this.wrapLng,!0):s.lng,p=this.wrapLat?x(s.lat,this.wrapLat,!0):s.lat,_=s.alt;return new H(p,u,_)},wrapLatLngBounds:function(s){var u=s.getCenter(),p=this.wrapLatLng(u),_=u.lat-p.lat,C=u.lng-p.lng;if(_===0&&C===0)return s;var V=s.getSouthWest(),de=s.getNorthEast(),we=new H(V.lat-_,V.lng-C),Pe=new H(de.lat-_,de.lng-C);return new F(we,Pe)}},ge=a({},fe,{wrapLng:[-180,180],R:6371e3,distance:function(s,u){var p=Math.PI/180,_=s.lat*p,C=u.lat*p,V=Math.sin((u.lat-s.lat)*p/2),de=Math.sin((u.lng-s.lng)*p/2),we=V*V+Math.cos(_)*Math.cos(C)*de*de,Pe=2*Math.atan2(Math.sqrt(we),Math.sqrt(1-we));return this.R*Pe}}),ye=6378137,xe={R:ye,MAX_LATITUDE:85.0511287798,project:function(s){var u=Math.PI/180,p=this.MAX_LATITUDE,_=Math.max(Math.min(p,s.lat),-p),C=Math.sin(_*u);return new G(this.R*s.lng*u,this.R*Math.log((1+C)/(1-C))/2)},unproject:function(s){var u=180/Math.PI;return new H((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*u,s.x*u/this.R)},bounds:(function(){var s=ye*Math.PI;return new I([-s,-s],[s,s])})()};function ze(s,u,p,_){if(N(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=u,this._c=p,this._d=_}ze.prototype={transform:function(s,u){return this._transform(s.clone(),u)},_transform:function(s,u){return u=u||1,s.x=u*(this._a*s.x+this._b),s.y=u*(this._c*s.y+this._d),s},untransform:function(s,u){return u=u||1,new G((s.x/u-this._b)/this._a,(s.y/u-this._d)/this._c)}};function ne(s,u,p,_){return new ze(s,u,p,_)}var xt=a({},ge,{code:"EPSG:3857",projection:xe,transformation:(function(){var s=.5/(Math.PI*xe.R);return ne(s,.5,-s,.5)})()}),st=a({},xt,{code:"EPSG:900913"});function wt(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function _t(s,u){var p="",_,C,V,de,we,Pe;for(_=0,V=s.length;_<V;_++){for(we=s[_],C=0,de=we.length;C<de;C++)Pe=we[C],p+=(C?"L":"M")+Pe.x+" "+Pe.y;p+=u?Je.svg?"z":"x":""}return p||"M0 0"}var $e=document.documentElement.style,It="ActiveXObject"in window,ur=It&&!document.addEventListener,rr="msLaunchUri"in navigator&&!("documentMode"in document),Zt=ct("webkit"),Kt=ct("android"),yr=ct("android 2")||ct("android 3"),or=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),nt=Kt&&ct("Google")&&or<537&&!("AudioNode"in window),Mr=!!window.opera,Sn=!rr&&ct("chrome"),nr=ct("gecko")&&!Zt&&!Mr&&!It,Bt=!Sn&&ct("safari"),ft=ct("phantom"),Dt="OTransition"in $e,Br=navigator.platform.indexOf("Win")===0,qt=It&&"transition"in $e,Xr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!yr,ii="MozPerspective"in $e,si=!window.L_DISABLE_3D&&(qt||Xr||ii)&&!Dt&&!ft,Rn=typeof orientation<"u"||ct("mobile"),ja=Rn&&Zt,Ma=Rn&&Xr,Ba=!window.PointerEvent&&window.MSPointerEvent,Tn=!!(window.PointerEvent||Ba),De="ontouchstart"in window||!!window.TouchEvent,Ke=!window.L_NO_TOUCH&&(De||Tn),Ye=Rn&&Mr,He=Rn&&nr,Qe=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,at=(function(){var s=!1;try{var u=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",y,u),window.removeEventListener("testPassiveEventSupport",y,u)}catch{}return s})(),pt=(function(){return!!document.createElement("canvas").getContext})(),Xe=!!(document.createElementNS&&wt("svg").createSVGRect),Ot=!!Xe&&(function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),ar=!Xe&&(function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var u=s.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}})(),Ut=navigator.platform.indexOf("Mac")===0,Yt=navigator.platform.indexOf("Linux")===0;function ct(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Je={ie:It,ielt9:ur,edge:rr,webkit:Zt,android:Kt,android23:yr,androidStock:nt,opera:Mr,chrome:Sn,gecko:nr,safari:Bt,phantom:ft,opera12:Dt,win:Br,ie3d:qt,webkit3d:Xr,gecko3d:ii,any3d:si,mobile:Rn,mobileWebkit:ja,mobileWebkit3d:Ma,msPointer:Ba,pointer:Tn,touch:Ke,touchNative:De,mobileOpera:Ye,mobileGecko:He,retina:Qe,passiveEvents:at,canvas:pt,svg:Xe,vml:ar,inlineSvg:Ot,mac:Ut,linux:Yt},W=Je.msPointer?"MSPointerDown":"pointerdown",re=Je.msPointer?"MSPointerMove":"pointermove",q=Je.msPointer?"MSPointerUp":"pointerup",Q=Je.msPointer?"MSPointerCancel":"pointercancel",ae={touchstart:W,touchmove:re,touchend:q,touchcancel:Q},ie={touchstart:Me,touchmove:Be,touchend:Be,touchcancel:Be},Se={},Ie=!1;function Te(s,u,p){return u==="touchstart"&&Ze(),ie[u]?(p=ie[u].bind(this,p),s.addEventListener(ae[u],p,!1),p):(console.warn("wrong event specified:",u),y)}function Ce(s,u,p){if(!ae[u]){console.warn("wrong event specified:",u);return}s.removeEventListener(ae[u],p,!1)}function Ae(s){Se[s.pointerId]=s}function Re(s){Se[s.pointerId]&&(Se[s.pointerId]=s)}function Ve(s){delete Se[s.pointerId]}function Ze(){Ie||(document.addEventListener(W,Ae,!0),document.addEventListener(re,Re,!0),document.addEventListener(q,Ve,!0),document.addEventListener(Q,Ve,!0),Ie=!0)}function Be(s,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var p in Se)u.touches.push(Se[p]);u.changedTouches=[u],s(u)}}function Me(s,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&fr(u),Be(s,u)}function gt(s){var u={},p,_;for(_ in s)p=s[_],u[_]=p&&p.bind?p.bind(s):p;return s=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var $t=200;function Vt(s,u){s.addEventListener("dblclick",u);var p=0,_;function C(V){if(V.detail!==1){_=V.detail;return}if(!(V.pointerType==="mouse"||V.sourceCapabilities&&!V.sourceCapabilities.firesTouchEvents)){var de=ci(V);if(!(de.some(function(Pe){return Pe instanceof HTMLLabelElement&&Pe.attributes.for})&&!de.some(function(Pe){return Pe instanceof HTMLInputElement||Pe instanceof HTMLSelectElement}))){var we=Date.now();we-p<=$t?(_++,_===2&&u(gt(V))):_=1,p=we}}}return s.addEventListener("click",C),{dblclick:u,simDblclick:C}}function dr(s,u){s.removeEventListener("dblclick",u.dblclick),s.removeEventListener("click",u.simDblclick)}var pa=Ri(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),En=Ri(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),jn=En==="webkitTransition"||En==="OTransition"?En+"End":"transitionend";function _r(s){return typeof s=="string"?document.getElementById(s):s}function ga(s,u){var p=s.style[u]||s.currentStyle&&s.currentStyle[u];if((!p||p==="auto")&&document.defaultView){var _=document.defaultView.getComputedStyle(s,null);p=_?_[u]:null}return p==="auto"?null:p}function ot(s,u,p){var _=document.createElement(s);return _.className=u||"",p&&p.appendChild(_),_}function ir(s){var u=s.parentNode;u&&u.removeChild(s)}function _o(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Fi(s){var u=s.parentNode;u&&u.lastChild!==s&&u.appendChild(s)}function va(s){var u=s.parentNode;u&&u.firstChild!==s&&u.insertBefore(s,u.firstChild)}function Li(s,u){if(s.classList!==void 0)return s.classList.contains(u);var p=wo(s);return p.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(p)}function yt(s,u){if(s.classList!==void 0)for(var p=b(u),_=0,C=p.length;_<C;_++)s.classList.add(p[_]);else if(!Li(s,u)){var V=wo(s);Ol(s,(V?V+" ":"")+u)}}function Jt(s,u){s.classList!==void 0?s.classList.remove(u):Ol(s,E((" "+wo(s)+" ").replace(" "+u+" "," ")))}function Ol(s,u){s.className.baseVal===void 0?s.className=u:s.className.baseVal=u}function wo(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Jr(s,u){"opacity"in s.style?s.style.opacity=u:"filter"in s.style&&iu(s,u)}function iu(s,u){var p=!1,_="DXImageTransform.Microsoft.Alpha";try{p=s.filters.item(_)}catch{if(u===1)return}u=Math.round(u*100),p?(p.Enabled=u!==100,p.Opacity=u):s.style.filter+=" progid:"+_+"(opacity="+u+")"}function Ri(s){for(var u=document.documentElement.style,p=0;p<s.length;p++)if(s[p]in u)return s[p];return!1}function Mn(s,u,p){var _=u||new G(0,0);s.style[pa]=(Je.ie3d?"translate("+_.x+"px,"+_.y+"px)":"translate3d("+_.x+"px,"+_.y+"px,0)")+(p?" scale("+p+")":"")}function pr(s,u){s._leaflet_pos=u,Je.any3d?Mn(s,u):(s.style.left=u.x+"px",s.style.top=u.y+"px")}function xa(s){return s._leaflet_pos||new G(0,0)}var Pt,ji,ko;if("onselectstart"in document)Pt=function(){ht(window,"selectstart",fr)},ji=function(){Ht(window,"selectstart",fr)};else{var oi=Ri(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Pt=function(){if(oi){var s=document.documentElement.style;ko=s[oi],s[oi]="none"}},ji=function(){oi&&(document.documentElement.style[oi]=ko,ko=void 0)}}function bo(){ht(window,"dragstart",fr)}function So(){Ht(window,"dragstart",fr)}var As,Ps;function Mi(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Bn(),As=s,Ps=s.style.outlineStyle,s.style.outlineStyle="none",ht(window,"keydown",Bn))}function Bn(){As&&(As.style.outlineStyle=Ps,As=void 0,Ps=void 0,Ht(window,"keydown",Bn))}function ya(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Xn(s){var u=s.getBoundingClientRect();return{x:u.width/s.offsetWidth||1,y:u.height/s.offsetHeight||1,boundingClientRect:u}}var Ns={__proto__:null,TRANSFORM:pa,TRANSITION:En,TRANSITION_END:jn,get:_r,getStyle:ga,create:ot,remove:ir,empty:_o,toFront:Fi,toBack:va,hasClass:Li,addClass:yt,removeClass:Jt,setClass:Ol,getClass:wo,setOpacity:Jr,testProp:Ri,setTransform:Mn,setPosition:pr,getPosition:xa,get disableTextSelection(){return Pt},get enableTextSelection(){return ji},disableImageDrag:bo,enableImageDrag:So,preventOutline:Mi,restoreOutline:Bn,getSizedParentNode:ya,getScale:Xn};function ht(s,u,p,_){if(u&&typeof u=="object")for(var C in u)Ll(s,C,u[C],p);else{u=b(u);for(var V=0,de=u.length;V<de;V++)Ll(s,u[V],p,_)}return this}var Pr="_leaflet_events";function Ht(s,u,p,_){if(arguments.length===1)Fl(s),delete s[Pr];else if(u&&typeof u=="object")for(var C in u)To(s,C,u[C],p);else if(u=b(u),arguments.length===2)Fl(s,function(we){return U(u,we)!==-1});else for(var V=0,de=u.length;V<de;V++)To(s,u[V],p,_);return this}function Fl(s,u){for(var p in s[Pr]){var _=p.split(/\d/)[0];(!u||u(_))&&To(s,_,null,null,p)}}var li={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ll(s,u,p,_){var C=u+m(p)+(_?"_"+m(_):"");if(s[Pr]&&s[Pr][C])return this;var V=function(we){return p.call(_||s,we||window.event)},de=V;!Je.touchNative&&Je.pointer&&u.indexOf("touch")===0?V=Te(s,u,V):Je.touch&&u==="dblclick"?V=Vt(s,V):"addEventListener"in s?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?s.addEventListener(li[u]||u,V,Je.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(V=function(we){we=we||window.event,Os(s,we)&&de(we)},s.addEventListener(li[u],V,!1)):s.addEventListener(u,de,!1):s.attachEvent("on"+u,V),s[Pr]=s[Pr]||{},s[Pr][C]=V}function To(s,u,p,_,C){C=C||u+m(p)+(_?"_"+m(_):"");var V=s[Pr]&&s[Pr][C];if(!V)return this;!Je.touchNative&&Je.pointer&&u.indexOf("touch")===0?Ce(s,u,V):Je.touch&&u==="dblclick"?dr(s,V):"removeEventListener"in s?s.removeEventListener(li[u]||u,V,!1):s.detachEvent("on"+u,V),s[Pr][C]=null}function Jn(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Eo(s){return Ll(s,"wheel",Jn),this}function Is(s){return ht(s,"mousedown touchstart dblclick contextmenu",Jn),s._leaflet_disable_click=!0,this}function fr(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function zn(s){return fr(s),Jn(s),this}function ci(s){if(s.composedPath)return s.composedPath();for(var u=[],p=s.target;p;)u.push(p),p=p.parentNode;return u}function Ds(s,u){if(!u)return new G(s.clientX,s.clientY);var p=Xn(u),_=p.boundingClientRect;return new G((s.clientX-_.left)/p.x-u.clientLeft,(s.clientY-_.top)/p.y-u.clientTop)}var mf=Je.linux&&Je.chrome?window.devicePixelRatio:Je.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function su(s){return Je.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/mf:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Os(s,u){var p=u.relatedTarget;if(!p)return!0;try{for(;p&&p!==s;)p=p.parentNode}catch{return!1}return p!==s}var Co={__proto__:null,on:ht,off:Ht,stopPropagation:Jn,disableScrollPropagation:Eo,disableClickPropagation:Is,preventDefault:fr,stop:zn,getPropagationPath:ci,getMousePosition:Ds,getWheelDelta:su,isExternalTarget:Os,addListener:ht,removeListener:Ht},Ao=j.extend({run:function(s,u,p,_){this.stop(),this._el=s,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(_||.5,.2),this._startPos=xa(s),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=me(this._animate,this),this._step()},_step:function(s){var u=+new Date-this._startTime,p=this._duration*1e3;u<p?this._runFrame(this._easeOut(u/p),s):(this._runFrame(1),this._complete())},_runFrame:function(s,u){var p=this._startPos.add(this._offset.multiplyBy(s));u&&p._round(),pr(this._el,p),this.fire("step")},_complete:function(){J(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Ct=j.extend({options:{crs:xt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,u){u=S(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(X(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=En&&Je.any3d&&!Je.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ht(this._proxy,jn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,u,p){if(u=u===void 0?this._zoom:this._limitZoom(u),s=this._limitCenter(X(s),u,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=a({animate:p.animate},p.zoom),p.pan=a({animate:p.animate,duration:p.duration},p.pan));var _=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,u,p.zoom):this._tryAnimatedPan(s,p.pan);if(_)return clearTimeout(this._sizeTimer),this}return this._resetView(s,u,p.pan&&p.pan.noMoveStart),this},setZoom:function(s,u){return this._loaded?this.setView(this.getCenter(),s,{zoom:u}):(this._zoom=s,this)},zoomIn:function(s,u){return s=s||(Je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,u)},zoomOut:function(s,u){return s=s||(Je.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,u)},setZoomAround:function(s,u,p){var _=this.getZoomScale(u),C=this.getSize().divideBy(2),V=s instanceof G?s:this.latLngToContainerPoint(s),de=V.subtract(C).multiplyBy(1-1/_),we=this.containerPointToLatLng(C.add(de));return this.setView(we,u,{zoom:p})},_getBoundsCenterZoom:function(s,u){u=u||{},s=s.getBounds?s.getBounds():M(s);var p=oe(u.paddingTopLeft||u.padding||[0,0]),_=oe(u.paddingBottomRight||u.padding||[0,0]),C=this.getBoundsZoom(s,!1,p.add(_));if(C=typeof u.maxZoom=="number"?Math.min(u.maxZoom,C):C,C===1/0)return{center:s.getCenter(),zoom:C};var V=_.subtract(p).divideBy(2),de=this.project(s.getSouthWest(),C),we=this.project(s.getNorthEast(),C),Pe=this.unproject(de.add(we).divideBy(2).add(V),C);return{center:Pe,zoom:C}},fitBounds:function(s,u){if(s=M(s),!s.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(s,u);return this.setView(p.center,p.zoom,u)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,u){return this.setView(s,this._zoom,{pan:u})},panBy:function(s,u){if(s=oe(s).round(),u=u||{},!s.x&&!s.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ao,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){yt(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,p,u.duration||.25,u.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,u,p){if(p=p||{},p.animate===!1||!Je.any3d)return this.setView(s,u,p);this._stop();var _=this.project(this.getCenter()),C=this.project(s),V=this.getSize(),de=this._zoom;s=X(s),u=u===void 0?de:u;var we=Math.max(V.x,V.y),Pe=we*this.getZoomScale(de,u),Oe=C.distanceTo(_)||1,Ge=1.42,lt=Ge*Ge;function bt(zt){var Qi=zt?-1:1,Af=zt?Pe:we,Pf=Pe*Pe-we*we+Qi*lt*lt*Oe*Oe,gi=2*Af*lt*Oe,vi=Pf/gi,xi=Math.sqrt(vi*vi+1)-vi,$o=xi<1e-9?-18:Math.log(xi);return $o}function Nr(zt){return(Math.exp(zt)-Math.exp(-zt))/2}function br(zt){return(Math.exp(zt)+Math.exp(-zt))/2}function pn(zt){return Nr(zt)/br(zt)}var en=bt(0);function Xi(zt){return we*(br(en)/br(en+Ge*zt))}function rc(zt){return we*(br(en)*pn(en+Ge*zt)-Nr(en))/lt}function Za(zt){return 1-Math.pow(1-zt,1.5)}var Cu=Date.now(),pi=(bt(1)-en)/Ge,ra=p.duration?1e3*p.duration:1e3*pi*.8;function Ji(){var zt=(Date.now()-Cu)/ra,Qi=Za(zt)*pi;zt<=1?(this._flyToFrame=me(Ji,this),this._move(this.unproject(_.add(C.subtract(_).multiplyBy(rc(Qi)/Oe)),de),this.getScaleZoom(we/Xi(Qi),de),{flyTo:!0})):this._move(s,u)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),Ji.call(this),this},flyToBounds:function(s,u){var p=this._getBoundsCenterZoom(s,u);return this.flyTo(p.center,p.zoom,u)},setMaxBounds:function(s){return s=M(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var u=this.options.minZoom;return this.options.minZoom=s,this._loaded&&u!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var u=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&u!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,u){this._enforcingBounds=!0;var p=this.getCenter(),_=this._limitCenter(p,this._zoom,M(s));return p.equals(_)||this.panTo(_,u),this._enforcingBounds=!1,this},panInside:function(s,u){u=u||{};var p=oe(u.paddingTopLeft||u.padding||[0,0]),_=oe(u.paddingBottomRight||u.padding||[0,0]),C=this.project(this.getCenter()),V=this.project(s),de=this.getPixelBounds(),we=P([de.min.add(p),de.max.subtract(_)]),Pe=we.getSize();if(!we.contains(V)){this._enforcingBounds=!0;var Oe=V.subtract(we.getCenter()),Ge=we.extend(V).getSize().subtract(Pe);C.x+=Oe.x<0?-Ge.x:Ge.x,C.y+=Oe.y<0?-Ge.y:Ge.y,this.panTo(this.unproject(C),u),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=a({animate:!1,pan:!0},s===!0?{animate:!0}:s);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),_=u.divideBy(2).round(),C=p.divideBy(2).round(),V=_.subtract(C);return!V.x&&!V.y?this:(s.animate&&s.pan?this.panBy(V):(s.pan&&this._rawPanBy(V),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=a({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=c(this._handleGeolocationResponse,this),p=c(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,p,s):navigator.geolocation.getCurrentPosition(u,p,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var u=s.code,p=s.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var u=s.coords.latitude,p=s.coords.longitude,_=new H(u,p),C=_.toBounds(s.coords.accuracy*2),V=this._locateOptions;if(V.setView){var de=this.getBoundsZoom(C);this.setView(_,V.maxZoom?Math.min(de,V.maxZoom):de)}var we={latlng:_,bounds:C,timestamp:s.timestamp};for(var Pe in s.coords)typeof s.coords[Pe]=="number"&&(we[Pe]=s.coords[Pe]);this.fire("locationfound",we)}},addHandler:function(s,u){if(!u)return this;var p=this[s]=new u(this);return this._handlers.push(p),this.options[s]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ir(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(J(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)ir(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,u){var p="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),_=ot("div",p,u||this._mapPane);return s&&(this._panes[s]=_),_},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),u=this.unproject(s.getBottomLeft()),p=this.unproject(s.getTopRight());return new F(u,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,u,p){s=M(s),p=oe(p||[0,0]);var _=this.getZoom()||0,C=this.getMinZoom(),V=this.getMaxZoom(),de=s.getNorthWest(),we=s.getSouthEast(),Pe=this.getSize().subtract(p),Oe=P(this.project(we,_),this.project(de,_)).getSize(),Ge=Je.any3d?this.options.zoomSnap:1,lt=Pe.x/Oe.x,bt=Pe.y/Oe.y,Nr=u?Math.max(lt,bt):Math.min(lt,bt);return _=this.getScaleZoom(Nr,_),Ge&&(_=Math.round(_/(Ge/100))*(Ge/100),_=u?Math.ceil(_/Ge)*Ge:Math.floor(_/Ge)*Ge),Math.max(C,Math.min(V,_))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new G(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,u){var p=this._getTopLeftPoint(s,u);return new I(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,u){var p=this.options.crs;return u=u===void 0?this._zoom:u,p.scale(s)/p.scale(u)},getScaleZoom:function(s,u){var p=this.options.crs;u=u===void 0?this._zoom:u;var _=p.zoom(s*p.scale(u));return isNaN(_)?1/0:_},project:function(s,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(X(s),u)},unproject:function(s,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(oe(s),u)},layerPointToLatLng:function(s){var u=oe(s).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(s){var u=this.project(X(s))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(X(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(M(s))},distance:function(s,u){return this.options.crs.distance(X(s),X(u))},containerPointToLayerPoint:function(s){return oe(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return oe(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var u=this.containerPointToLayerPoint(oe(s));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(X(s)))},mouseEventToContainerPoint:function(s){return Ds(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var u=this._container=_r(s);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ht(u,"scroll",this._onScroll,this),this._containerId=m(u)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Je.any3d,yt(s,"leaflet-container"+(Je.touch?" leaflet-touch":"")+(Je.retina?" leaflet-retina":"")+(Je.ielt9?" leaflet-oldie":"")+(Je.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=ga(s,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),pr(this._mapPane,new G(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yt(s.markerPane,"leaflet-zoom-hide"),yt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,u,p){pr(this._mapPane,new G(0,0));var _=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var C=this._zoom!==u;this._moveStart(C,p)._move(s,u)._moveEnd(C),this.fire("viewreset"),_&&this.fire("load")},_moveStart:function(s,u){return s&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(s,u,p,_){u===void 0&&(u=this._zoom);var C=this._zoom!==u;return this._zoom=u,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),_?p&&p.pinch&&this.fire("zoom",p):((C||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return J(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){pr(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[m(this._container)]=this;var u=s?Ht:ht;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),Je.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){J(this._resizeRequest),this._resizeRequest=me(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,u){for(var p=[],_,C=u==="mouseout"||u==="mouseover",V=s.target||s.srcElement,de=!1;V;){if(_=this._targets[m(V)],_&&(u==="click"||u==="preclick")&&this._draggableMoved(_)){de=!0;break}if(_&&_.listens(u,!0)&&(C&&!Os(V,s)||(p.push(_),C))||V===this._container)break;V=V.parentNode}return!p.length&&!de&&!C&&this.listens(u,!0)&&(p=[this]),p},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var u=s.target||s.srcElement;if(!(!this._loaded||u._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(u))){var p=s.type;p==="mousedown"&&Mi(u),this._fireDOMEvent(s,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,u,p){if(s.type==="click"){var _=a({},s);_.type="preclick",this._fireDOMEvent(_,_.type,p)}var C=this._findEventTargets(s,u);if(p){for(var V=[],de=0;de<p.length;de++)p[de].listens(u,!0)&&V.push(p[de]);C=V.concat(C)}if(C.length){u==="contextmenu"&&fr(s);var we=C[0],Pe={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Oe=we.getLatLng&&(!we._radius||we._radius<=10);Pe.containerPoint=Oe?this.latLngToContainerPoint(we.getLatLng()):this.mouseEventToContainerPoint(s),Pe.layerPoint=this.containerPointToLayerPoint(Pe.containerPoint),Pe.latlng=Oe?we.getLatLng():this.layerPointToLatLng(Pe.layerPoint)}for(de=0;de<C.length;de++)if(C[de].fire(u,Pe,!0),Pe.originalEvent._stopped||C[de].options.bubblingMouseEvents===!1&&U(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,u=this._handlers.length;s<u;s++)this._handlers[s].disable()},whenReady:function(s,u){return this._loaded?s.call(u||this,{target:this}):this.on("load",s,u),this},_getMapPanePos:function(){return xa(this._mapPane)||new G(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,u){var p=s&&u!==void 0?this._getNewPixelOrigin(s,u):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,u){var p=this.getSize()._divideBy(2);return this.project(s,u)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,u,p){var _=this._getNewPixelOrigin(p,u);return this.project(s,u)._subtract(_)},_latLngBoundsToNewLayerBounds:function(s,u,p){var _=this._getNewPixelOrigin(p,u);return P([this.project(s.getSouthWest(),u)._subtract(_),this.project(s.getNorthWest(),u)._subtract(_),this.project(s.getSouthEast(),u)._subtract(_),this.project(s.getNorthEast(),u)._subtract(_)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,u,p){if(!p)return s;var _=this.project(s,u),C=this.getSize().divideBy(2),V=new I(_.subtract(C),_.add(C)),de=this._getBoundsOffset(V,p,u);return Math.abs(de.x)<=1&&Math.abs(de.y)<=1?s:this.unproject(_.add(de),u)},_limitOffset:function(s,u){if(!u)return s;var p=this.getPixelBounds(),_=new I(p.min.add(s),p.max.add(s));return s.add(this._getBoundsOffset(_,u))},_getBoundsOffset:function(s,u,p){var _=P(this.project(u.getNorthEast(),p),this.project(u.getSouthWest(),p)),C=_.min.subtract(s.min),V=_.max.subtract(s.max),de=this._rebound(C.x,-V.x),we=this._rebound(C.y,-V.y);return new G(de,we)},_rebound:function(s,u){return s+u>0?Math.round(s-u)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(u))},_limitZoom:function(s){var u=this.getMinZoom(),p=this.getMaxZoom(),_=Je.any3d?this.options.zoomSnap:1;return _&&(s=Math.round(s/_)*_),Math.max(u,Math.min(p,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Jt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,u){var p=this._getCenterOffset(s)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,u),!0)},_createAnimProxy:function(){var s=this._proxy=ot("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(u){var p=pa,_=this._proxy.style[p];Mn(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),_===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ir(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),u=this.getZoom();Mn(this._proxy,this.project(s,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,u,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var _=this.getZoomScale(u),C=this._getCenterOffset(s)._divideBy(1-1/_);return p.animate!==!0&&!this.getSize().contains(C)?!1:(me(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(s,u,!0)},this),!0)},_animateZoom:function(s,u,p,_){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=u,yt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:u,noUpdate:_}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Jt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function za(s,u){return new Ct(s,u)}var hn=ke.extend({options:{position:"topright"},initialize:function(s){S(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var u=this._map;return u&&u.removeControl(this),this.options.position=s,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var u=this._container=this.onAdd(s),p=this.getPosition(),_=s._controlCorners[p];return yt(u,"leaflet-control"),p.indexOf("bottom")!==-1?_.insertBefore(u,_.firstChild):_.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ir(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Ua=function(s){return new hn(s)};Ct.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},u="leaflet-",p=this._controlContainer=ot("div",u+"control-container",this._container);function _(C,V){var de=u+C+" "+u+V;s[C+V]=ot("div",de,p)}_("top","left"),_("top","right"),_("bottom","left"),_("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)ir(this._controlCorners[s]);ir(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Rl=hn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,u,p,_){return p<_?-1:_<p?1:0}},initialize:function(s,u,p){S(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var _ in s)this._addLayer(s[_],_);for(_ in u)this._addLayer(u[_],_,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return hn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,u){return this._addLayer(s,u),this._map?this._update():this},addOverlay:function(s,u){return this._addLayer(s,u,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var u=this._getLayer(m(s));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){yt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(yt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Jt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Jt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",u=this._container=ot("div",s),p=this.options.collapsed;u.setAttribute("aria-haspopup",!0),Is(u),Eo(u);var _=this._section=ot("section",s+"-list");p&&(this._map.on("click",this.collapse,this),ht(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var C=this._layersLink=ot("a",s+"-toggle",u);C.href="#",C.title="Layers",C.setAttribute("role","button"),ht(C,{keydown:function(V){V.keyCode===13&&this._expandSafely()},click:function(V){fr(V),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=ot("div",s+"-base",_),this._separator=ot("div",s+"-separator",_),this._overlaysList=ot("div",s+"-overlays",_),u.appendChild(_)},_getLayer:function(s){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&m(this._layers[u].layer)===s)return this._layers[u]},_addLayer:function(s,u,p){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:u,overlay:p}),this.options.sortLayers&&this._layers.sort(c(function(_,C){return this.options.sortFunction(_.layer,C.layer,_.name,C.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;_o(this._baseLayersList),_o(this._overlaysList),this._layerControlInputs=[];var s,u,p,_,C=0;for(p=0;p<this._layers.length;p++)_=this._layers[p],this._addItem(_),u=u||_.overlay,s=s||!_.overlay,C+=_.overlay?0:1;return this.options.hideSingleBase&&(s=s&&C>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=u&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var u=this._getLayer(m(s.target)),p=u.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;p&&this._map.fire(p,u)},_createRadioElement:function(s,u){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(u?' checked="checked"':"")+"/>",_=document.createElement("div");return _.innerHTML=p,_.firstChild},_addItem:function(s){var u=document.createElement("label"),p=this._map.hasLayer(s.layer),_;s.overlay?(_=document.createElement("input"),_.type="checkbox",_.className="leaflet-control-layers-selector",_.defaultChecked=p):_=this._createRadioElement("leaflet-base-layers_"+m(this),p),this._layerControlInputs.push(_),_.layerId=m(s.layer),ht(_,"click",this._onInputClick,this);var C=document.createElement("span");C.innerHTML=" "+s.name;var V=document.createElement("span");u.appendChild(V),V.appendChild(_),V.appendChild(C);var de=s.overlay?this._overlaysList:this._baseLayersList;return de.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,u,p,_=[],C=[];this._handlingClick=!0;for(var V=s.length-1;V>=0;V--)u=s[V],p=this._getLayer(u.layerId).layer,u.checked?_.push(p):u.checked||C.push(p);for(V=0;V<C.length;V++)this._map.hasLayer(C[V])&&this._map.removeLayer(C[V]);for(V=0;V<_.length;V++)this._map.hasLayer(_[V])||this._map.addLayer(_[V]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,u,p,_=this._map.getZoom(),C=s.length-1;C>=0;C--)u=s[C],p=this._getLayer(u.layerId).layer,u.disabled=p.options.minZoom!==void 0&&_<p.options.minZoom||p.options.maxZoom!==void 0&&_>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,ht(s,"click",fr),this.expand();var u=this;setTimeout(function(){Ht(s,"click",fr),u._preventClick=!1})}}),Po=function(s,u,p){return new Rl(s,u,p)},Bi=hn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var u="leaflet-control-zoom",p=ot("div",u+" leaflet-bar"),_=this.options;return this._zoomInButton=this._createButton(_.zoomInText,_.zoomInTitle,u+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(_.zoomOutText,_.zoomOutTitle,u+"-out",p,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,u,p,_,C){var V=ot("a",p,_);return V.innerHTML=s,V.href="#",V.title=u,V.setAttribute("role","button"),V.setAttribute("aria-label",u),Is(V),ht(V,"click",zn),ht(V,"click",C,this),ht(V,"click",this._refocusOnMap,this),V},_updateDisabled:function(){var s=this._map,u="leaflet-disabled";Jt(this._zoomInButton,u),Jt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(yt(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(yt(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ct.mergeOptions({zoomControl:!0}),Ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Bi,this.addControl(this.zoomControl))});var ou=function(s){return new Bi(s)},Qr=hn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var u="leaflet-control-scale",p=ot("div",u),_=this.options;return this._addScales(_,u+"-line",p),s.on(_.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),p},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,u,p){s.metric&&(this._mScale=ot("div",u,p)),s.imperial&&(this._iScale=ot("div",u,p))},_update:function(){var s=this._map,u=s.getSize().y/2,p=s.distance(s.containerPointToLatLng([0,u]),s.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(p)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var u=this._getRoundNum(s),p=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,p,u/s)},_updateImperial:function(s){var u=s*3.2808399,p,_,C;u>5280?(p=u/5280,_=this._getRoundNum(p),this._updateScale(this._iScale,_+" mi",_/p)):(C=this._getRoundNum(u),this._updateScale(this._iScale,C+" ft",C/u))},_updateScale:function(s,u,p){s.style.width=Math.round(this.options.maxWidth*p)+"px",s.innerHTML=u},_getRoundNum:function(s){var u=Math.pow(10,(Math.floor(s)+"").length-1),p=s/u;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,u*p}}),zi=function(s){return new Qr(s)},jl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ui=hn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Je.inlineSvg?jl+" ":"")+"Leaflet</a>"},initialize:function(s){S(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=ot("div","leaflet-control-attribution"),Is(this._container);for(var u in s._layers)s._layers[u].getAttribution&&this.addAttribution(s._layers[u].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var u in this._attributions)this._attributions[u]&&s.push(u);var p=[];this.options.prefix&&p.push(this.options.prefix),s.length&&p.push(s.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});Ct.mergeOptions({attributionControl:!0}),Ct.addInitHook(function(){this.options.attributionControl&&new ui().addTo(this)});var pf=function(s){return new ui(s)};hn.Layers=Rl,hn.Zoom=Bi,hn.Scale=Qr,hn.Attribution=ui,Ua.layers=Po,Ua.zoom=ou,Ua.scale=zi,Ua.attribution=pf;var Cn=ke.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Cn.addTo=function(s,u){return s.addHandler(u,this),this};var Ml={Events:ue},Ui=Je.touch?"touchstart mousedown":"mousedown",Un=j.extend({options:{clickTolerance:3},initialize:function(s,u,p,_){S(this,_),this._element=s,this._dragStartTarget=u||s,this._preventOutline=p},enable:function(){this._enabled||(ht(this._dragStartTarget,Ui,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Un._dragging===this&&this.finishDrag(!0),Ht(this._dragStartTarget,Ui,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!Li(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Un._dragging===this&&this.finishDrag();return}if(!(Un._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Un._dragging=this,this._preventOutline&&Mi(this._element),bo(),Pt(),!this._moving)){this.fire("down");var u=s.touches?s.touches[0]:s,p=ya(this._element);this._startPoint=new G(u.clientX,u.clientY),this._startPos=xa(this._element),this._parentScale=Xn(p);var _=s.type==="mousedown";ht(document,_?"mousemove":"touchmove",this._onMove,this),ht(document,_?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var u=s.touches&&s.touches.length===1?s.touches[0]:s,p=new G(u.clientX,u.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,fr(s),this._moved||(this.fire("dragstart"),this._moved=!0,yt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),pr(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Jt(document.body,"leaflet-dragging"),this._lastTarget&&(Jt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ht(document,"mousemove touchmove",this._onMove,this),Ht(document,"mouseup touchend touchcancel",this._onUp,this),So(),ji();var u=this._moved&&this._moving;this._moving=!1,Un._dragging=!1,u&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Bl(s,u,p){var _,C=[1,4,2,8],V,de,we,Pe,Oe,Ge,lt,bt;for(V=0,Ge=s.length;V<Ge;V++)s[V]._code=di(s[V],u);for(we=0;we<4;we++){for(lt=C[we],_=[],V=0,Ge=s.length,de=Ge-1;V<Ge;de=V++)Pe=s[V],Oe=s[de],Pe._code&lt?Oe._code&lt||(bt=Io(Oe,Pe,lt,u,p),bt._code=di(bt,u),_.push(bt)):(Oe._code&lt&&(bt=Io(Oe,Pe,lt,u,p),bt._code=di(bt,u),_.push(bt)),_.push(Pe));s=_}return s}function lu(s,u){var p,_,C,V,de,we,Pe,Oe,Ge;if(!s||s.length===0)throw new Error("latlngs not passed");An(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var lt=X([0,0]),bt=M(s),Nr=bt.getNorthWest().distanceTo(bt.getSouthWest())*bt.getNorthEast().distanceTo(bt.getNorthWest());Nr<1700&&(lt=zl(s));var br=s.length,pn=[];for(p=0;p<br;p++){var en=X(s[p]);pn.push(u.project(X([en.lat-lt.lat,en.lng-lt.lng])))}for(we=Pe=Oe=0,p=0,_=br-1;p<br;_=p++)C=pn[p],V=pn[_],de=C.y*V.x-V.y*C.x,Pe+=(C.x+V.x)*de,Oe+=(C.y+V.y)*de,we+=de*3;we===0?Ge=pn[0]:Ge=[Pe/we,Oe/we];var Xi=u.unproject(oe(Ge));return X([Xi.lat+lt.lat,Xi.lng+lt.lng])}function zl(s){for(var u=0,p=0,_=0,C=0;C<s.length;C++){var V=X(s[C]);u+=V.lat,p+=V.lng,_++}return X([u/_,p/_])}var gf={__proto__:null,clipPolygon:Bl,polygonCenter:lu,centroid:zl};function No(s,u){if(!u||!s.length)return s.slice();var p=u*u;return s=yf(s,p),s=xf(s,p),s}function cu(s,u,p){return Math.sqrt(fi(s,u,p,!0))}function vf(s,u,p){return fi(s,u,p)}function xf(s,u){var p=s.length,_=typeof Uint8Array<"u"?Uint8Array:Array,C=new _(p);C[0]=C[p-1]=1,Ul(s,C,u,0,p-1);var V,de=[];for(V=0;V<p;V++)C[V]&&de.push(s[V]);return de}function Ul(s,u,p,_,C){var V=0,de,we,Pe;for(we=_+1;we<=C-1;we++)Pe=fi(s[we],s[_],s[C],!0),Pe>V&&(de=we,V=Pe);V>p&&(u[de]=1,Ul(s,u,p,_,de),Ul(s,u,p,de,C))}function yf(s,u){for(var p=[s[0]],_=1,C=0,V=s.length;_<V;_++)_f(s[_],s[C])>u&&(p.push(s[_]),C=_);return C<V-1&&p.push(s[V-1]),p}var $l;function uu(s,u,p,_,C){var V=_?$l:di(s,p),de=di(u,p),we,Pe,Oe;for($l=de;;){if(!(V|de))return[s,u];if(V&de)return!1;we=V||de,Pe=Io(s,u,we,p,C),Oe=di(Pe,p),we===V?(s=Pe,V=Oe):(u=Pe,de=Oe)}}function Io(s,u,p,_,C){var V=u.x-s.x,de=u.y-s.y,we=_.min,Pe=_.max,Oe,Ge;return p&8?(Oe=s.x+V*(Pe.y-s.y)/de,Ge=Pe.y):p&4?(Oe=s.x+V*(we.y-s.y)/de,Ge=we.y):p&2?(Oe=Pe.x,Ge=s.y+de*(Pe.x-s.x)/V):p&1&&(Oe=we.x,Ge=s.y+de*(we.x-s.x)/V),new G(Oe,Ge,C)}function di(s,u){var p=0;return s.x<u.min.x?p|=1:s.x>u.max.x&&(p|=2),s.y<u.min.y?p|=4:s.y>u.max.y&&(p|=8),p}function _f(s,u){var p=u.x-s.x,_=u.y-s.y;return p*p+_*_}function fi(s,u,p,_){var C=u.x,V=u.y,de=p.x-C,we=p.y-V,Pe=de*de+we*we,Oe;return Pe>0&&(Oe=((s.x-C)*de+(s.y-V)*we)/Pe,Oe>1?(C=p.x,V=p.y):Oe>0&&(C+=de*Oe,V+=we*Oe)),de=s.x-C,we=s.y-V,_?de*de+we*we:new G(C,V)}function An(s){return!N(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function du(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),An(s)}function fu(s,u){var p,_,C,V,de,we,Pe,Oe;if(!s||s.length===0)throw new Error("latlngs not passed");An(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Ge=X([0,0]),lt=M(s),bt=lt.getNorthWest().distanceTo(lt.getSouthWest())*lt.getNorthEast().distanceTo(lt.getNorthWest());bt<1700&&(Ge=zl(s));var Nr=s.length,br=[];for(p=0;p<Nr;p++){var pn=X(s[p]);br.push(u.project(X([pn.lat-Ge.lat,pn.lng-Ge.lng])))}for(p=0,_=0;p<Nr-1;p++)_+=br[p].distanceTo(br[p+1])/2;if(_===0)Oe=br[0];else for(p=0,V=0;p<Nr-1;p++)if(de=br[p],we=br[p+1],C=de.distanceTo(we),V+=C,V>_){Pe=(V-_)/C,Oe=[we.x-Pe*(we.x-de.x),we.y-Pe*(we.y-de.y)];break}var en=u.unproject(oe(Oe));return X([en.lat+Ge.lat,en.lng+Ge.lng])}var hu={__proto__:null,simplify:No,pointToSegmentDistance:cu,closestPointOnSegment:vf,clipSegment:uu,_getEdgeIntersection:Io,_getBitCode:di,_sqClosestPointOnSegment:fi,isFlat:An,_flat:du,polylineCenter:fu},Wl={project:function(s){return new G(s.lng,s.lat)},unproject:function(s){return new H(s.y,s.x)},bounds:new I([-180,-90],[180,90])},Vl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new I([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var u=Math.PI/180,p=this.R,_=s.lat*u,C=this.R_MINOR/p,V=Math.sqrt(1-C*C),de=V*Math.sin(_),we=Math.tan(Math.PI/4-_/2)/Math.pow((1-de)/(1+de),V/2);return _=-p*Math.log(Math.max(we,1e-10)),new G(s.lng*u*p,_)},unproject:function(s){for(var u=180/Math.PI,p=this.R,_=this.R_MINOR/p,C=Math.sqrt(1-_*_),V=Math.exp(-s.y/p),de=Math.PI/2-2*Math.atan(V),we=0,Pe=.1,Oe;we<15&&Math.abs(Pe)>1e-7;we++)Oe=C*Math.sin(de),Oe=Math.pow((1-Oe)/(1+Oe),C/2),Pe=Math.PI/2-2*Math.atan(V*Oe)-de,de+=Pe;return new H(de*u,s.x*u/p)}},wf={__proto__:null,LonLat:Wl,Mercator:Vl,SphericalMercator:xe},kf=a({},ge,{code:"EPSG:3395",projection:Vl,transformation:(function(){var s=.5/(Math.PI*Vl.R);return ne(s,.5,-s,.5)})()}),mu=a({},ge,{code:"EPSG:4326",projection:Wl,transformation:ne(1/180,1,-1/180,.5)}),bf=a({},fe,{projection:Wl,transformation:ne(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,u){var p=u.lng-s.lng,_=u.lat-s.lat;return Math.sqrt(p*p+_*_)},infinite:!0});fe.Earth=ge,fe.EPSG3395=kf,fe.EPSG3857=xt,fe.EPSG900913=st,fe.EPSG4326=mu,fe.Simple=bf;var $n=j.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[m(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[m(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var u=s.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var p=this.getEvents();u.on(p,this),this.once("remove",function(){u.off(p,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});Ct.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var u=m(s);return this._layers[u]?this:(this._layers[u]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var u=m(s);return this._layers[u]?(this._loaded&&s.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return m(s)in this._layers},eachLayer:function(s,u){for(var p in this._layers)s.call(u,this._layers[p]);return this},_addLayers:function(s){s=s?N(s)?s:[s]:[];for(var u=0,p=s.length;u<p;u++)this.addLayer(s[u])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[m(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var u=m(s);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,u=-1/0,p=this._getZoomSpan();for(var _ in this._zoomBoundLayers){var C=this._zoomBoundLayers[_].options;s=C.minZoom===void 0?s:Math.min(s,C.minZoom),u=C.maxZoom===void 0?u:Math.max(u,C.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=s===1/0?void 0:s,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var $a=$n.extend({initialize:function(s,u){S(this,u),this._layers={};var p,_;if(s)for(p=0,_=s.length;p<_;p++)this.addLayer(s[p])},addLayer:function(s){var u=this.getLayerId(s);return this._layers[u]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var u=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(s){var u=typeof s=="number"?s:this.getLayerId(s);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var u=Array.prototype.slice.call(arguments,1),p,_;for(p in this._layers)_=this._layers[p],_[s]&&_[s].apply(_,u);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,u){for(var p in this._layers)s.call(u,this._layers[p]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return m(s)}}),Fs=function(s,u){return new $a(s,u)},_a=$a.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),$a.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),$a.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new F;for(var u in this._layers){var p=this._layers[u];s.extend(p.getBounds?p.getBounds():p.getLatLng())}return s}}),pu=function(s,u){return new _a(s,u)},hi=ke.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){S(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,u){var p=this._getIconUrl(s);if(!p){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var _=this._createImg(p,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(_,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),_},_setIconStyles:function(s,u){var p=this.options,_=p[u+"Size"];typeof _=="number"&&(_=[_,_]);var C=oe(_),V=oe(u==="shadow"&&p.shadowAnchor||p.iconAnchor||C&&C.divideBy(2,!0));s.className="leaflet-marker-"+u+" "+(p.className||""),V&&(s.style.marginLeft=-V.x+"px",s.style.marginTop=-V.y+"px"),C&&(s.style.width=C.x+"px",s.style.height=C.y+"px")},_createImg:function(s,u){return u=u||document.createElement("img"),u.src=s,u},_getIconUrl:function(s){return Je.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function gu(s){return new hi(s)}var $i=hi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof $i.imagePath!="string"&&($i.imagePath=this._detectIconPath()),(this.options.imagePath||$i.imagePath)+hi.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var u=function(p,_,C){var V=_.exec(p);return V&&V[C]};return s=u(s,/^url\((['"])?(.+)\1\)$/,2),s&&u(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=ot("div","leaflet-default-icon-path",document.body),u=ga(s,"background-image")||ga(s,"backgroundImage");if(document.body.removeChild(s),u=this._stripUrl(u),u)return u;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Hl=Cn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Un(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Jt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var u=this._marker,p=u._map,_=this._marker.options.autoPanSpeed,C=this._marker.options.autoPanPadding,V=xa(u._icon),de=p.getPixelBounds(),we=p.getPixelOrigin(),Pe=P(de.min._subtract(we).add(C),de.max._subtract(we).subtract(C));if(!Pe.contains(V)){var Oe=oe((Math.max(Pe.max.x,V.x)-Pe.max.x)/(de.max.x-Pe.max.x)-(Math.min(Pe.min.x,V.x)-Pe.min.x)/(de.min.x-Pe.min.x),(Math.max(Pe.max.y,V.y)-Pe.max.y)/(de.max.y-Pe.max.y)-(Math.min(Pe.min.y,V.y)-Pe.min.y)/(de.min.y-Pe.min.y)).multiplyBy(_);p.panBy(Oe,{animate:!1}),this._draggable._newPos._add(Oe),this._draggable._startPos._add(Oe),pr(u._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=me(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(J(this._panRequest),this._panRequest=me(this._adjustPan.bind(this,s)))},_onDrag:function(s){var u=this._marker,p=u._shadow,_=xa(u._icon),C=u._map.layerPointToLatLng(_);p&&pr(p,_),u._latlng=C,s.latlng=C,s.oldLatLng=this._oldLatLng,u.fire("move",s).fire("drag",s)},_onDragEnd:function(s){J(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),wa=$n.extend({options:{icon:new $i,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,u){S(this,u),this._latlng=X(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var u=this._latlng;return this._latlng=X(s),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=s.icon.createIcon(this._icon),_=!1;p!==this._icon&&(this._icon&&this._removeIcon(),_=!0,s.title&&(p.title=s.title),p.tagName==="IMG"&&(p.alt=s.alt||"")),yt(p,u),s.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ht(p,"focus",this._panOnFocus,this);var C=s.icon.createShadow(this._shadow),V=!1;C!==this._shadow&&(this._removeShadow(),V=!0),C&&(yt(C,u),C.alt=""),this._shadow=C,s.opacity<1&&this._updateOpacity(),_&&this.getPane().appendChild(this._icon),this._initInteraction(),C&&V&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ht(this._icon,"focus",this._panOnFocus,this),ir(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ir(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&pr(this._icon,s),this._shadow&&pr(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(yt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Hl)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Hl(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Jr(this._icon,s),this._shadow&&Jr(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var u=this.options.icon.options,p=u.iconSize?oe(u.iconSize):oe(0,0),_=u.iconAnchor?oe(u.iconAnchor):oe(0,0);s.panInside(this._latlng,{paddingTopLeft:_,paddingBottomRight:p.subtract(_)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Sf(s,u){return new wa(s,u)}var Wa=$n.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return S(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Do=Wa.extend({options:{fill:!0,radius:10},initialize:function(s,u){S(this,u),this._latlng=X(s),this._radius=this.options.radius},setLatLng:function(s){var u=this._latlng;return this._latlng=X(s),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var u=s&&s.radius||this._radius;return Wa.prototype.setStyle.call(this,s),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,u=this._radiusY||s,p=this._clickTolerance(),_=[s+p,u+p];this._pxBounds=new I(this._point.subtract(_),this._point.add(_))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function vu(s,u){return new Do(s,u)}var Oo=Do.extend({initialize:function(s,u,p){if(typeof u=="number"&&(u=a({},p,{radius:u})),S(this,u),this._latlng=X(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new F(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:Wa.prototype.setStyle,_project:function(){var s=this._latlng.lng,u=this._latlng.lat,p=this._map,_=p.options.crs;if(_.distance===ge.distance){var C=Math.PI/180,V=this._mRadius/ge.R/C,de=p.project([u+V,s]),we=p.project([u-V,s]),Pe=de.add(we).divideBy(2),Oe=p.unproject(Pe).lat,Ge=Math.acos((Math.cos(V*C)-Math.sin(u*C)*Math.sin(Oe*C))/(Math.cos(u*C)*Math.cos(Oe*C)))/C;(isNaN(Ge)||Ge===0)&&(Ge=V/Math.cos(Math.PI/180*u)),this._point=Pe.subtract(p.getPixelOrigin()),this._radius=isNaN(Ge)?0:Pe.x-p.project([Oe,s-Ge]).x,this._radiusY=Pe.y-de.y}else{var lt=_.unproject(_.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(lt).x}this._updateBounds()}});function Ls(s,u,p){return new Oo(s,u,p)}var mn=Wa.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,u){S(this,u),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var u=1/0,p=null,_=fi,C,V,de=0,we=this._parts.length;de<we;de++)for(var Pe=this._parts[de],Oe=1,Ge=Pe.length;Oe<Ge;Oe++){C=Pe[Oe-1],V=Pe[Oe];var lt=_(s,C,V,!0);lt<u&&(u=lt,p=_(s,C,V))}return p&&(p.distance=Math.sqrt(u)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return fu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,u){return u=u||this._defaultShape(),s=X(s),u.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new F,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return An(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var u=[],p=An(s),_=0,C=s.length;_<C;_++)p?(u[_]=X(s[_]),this._bounds.extend(u[_])):u[_]=this._convertLatLngs(s[_]);return u},_project:function(){var s=new I;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),u=new G(s,s);this._rawPxBounds&&(this._pxBounds=new I([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(s,u,p){var _=s[0]instanceof H,C=s.length,V,de;if(_){for(de=[],V=0;V<C;V++)de[V]=this._map.latLngToLayerPoint(s[V]),p.extend(de[V]);u.push(de)}else for(V=0;V<C;V++)this._projectLatlngs(s[V],u,p)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,p,_,C,V,de,we,Pe;for(p=0,C=0,V=this._rings.length;p<V;p++)for(Pe=this._rings[p],_=0,de=Pe.length;_<de-1;_++)we=uu(Pe[_],Pe[_+1],s,_,!0),we&&(u[C]=u[C]||[],u[C].push(we[0]),(we[1]!==Pe[_+1]||_===de-2)&&(u[C].push(we[1]),C++))}},_simplifyPoints:function(){for(var s=this._parts,u=this.options.smoothFactor,p=0,_=s.length;p<_;p++)s[p]=No(s[p],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,u){var p,_,C,V,de,we,Pe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(p=0,V=this._parts.length;p<V;p++)for(we=this._parts[p],_=0,de=we.length,C=de-1;_<de;C=_++)if(!(!u&&_===0)&&cu(s,we[C],we[_])<=Pe)return!0;return!1}});function Tf(s,u){return new mn(s,u)}mn._flat=du;var ka=mn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return lu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var u=mn.prototype._convertLatLngs.call(this,s),p=u.length;return p>=2&&u[0]instanceof H&&u[0].equals(u[p-1])&&u.pop(),u},_setLatLngs:function(s){mn.prototype._setLatLngs.call(this,s),An(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return An(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,u=this.options.weight,p=new G(u,u);if(s=new I(s.min.subtract(p),s.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var _=0,C=this._rings.length,V;_<C;_++)V=Bl(this._rings[_],s,!0),V.length&&this._parts.push(V)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var u=!1,p,_,C,V,de,we,Pe,Oe;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(V=0,Pe=this._parts.length;V<Pe;V++)for(p=this._parts[V],de=0,Oe=p.length,we=Oe-1;de<Oe;we=de++)_=p[de],C=p[we],_.y>s.y!=C.y>s.y&&s.x<(C.x-_.x)*(s.y-_.y)/(C.y-_.y)+_.x&&(u=!u);return u||mn.prototype._containsPoint.call(this,s,!0)}});function Ef(s,u){return new ka(s,u)}var Qn=_a.extend({initialize:function(s,u){S(this,u),this._layers={},s&&this.addData(s)},addData:function(s){var u=N(s)?s:s.features,p,_,C;if(u){for(p=0,_=u.length;p<_;p++)C=u[p],(C.geometries||C.geometry||C.features||C.coordinates)&&this.addData(C);return this}var V=this.options;if(V.filter&&!V.filter(s))return this;var de=Wi(s,V);return de?(de.feature=Mo(s),de.defaultOptions=de.options,this.resetStyle(de),V.onEachFeature&&V.onEachFeature(s,de),this.addLayer(de)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=a({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(u){this._setLayerStyle(u,s)},this)},_setLayerStyle:function(s,u){s.setStyle&&(typeof u=="function"&&(u=u(s.feature)),s.setStyle(u))}});function Wi(s,u){var p=s.type==="Feature"?s.geometry:s,_=p?p.coordinates:null,C=[],V=u&&u.pointToLayer,de=u&&u.coordsToLatLng||Lo,we,Pe,Oe,Ge;if(!_&&!p)return null;switch(p.type){case"Point":return we=de(_),Fo(V,s,we,u);case"MultiPoint":for(Oe=0,Ge=_.length;Oe<Ge;Oe++)we=de(_[Oe]),C.push(Fo(V,s,we,u));return new _a(C);case"LineString":case"MultiLineString":return Pe=Rs(_,p.type==="LineString"?0:1,de),new mn(Pe,u);case"Polygon":case"MultiPolygon":return Pe=Rs(_,p.type==="Polygon"?1:2,de),new ka(Pe,u);case"GeometryCollection":for(Oe=0,Ge=p.geometries.length;Oe<Ge;Oe++){var lt=Wi({geometry:p.geometries[Oe],type:"Feature",properties:s.properties},u);lt&&C.push(lt)}return new _a(C);case"FeatureCollection":for(Oe=0,Ge=p.features.length;Oe<Ge;Oe++){var bt=Wi(p.features[Oe],u);bt&&C.push(bt)}return new _a(C);default:throw new Error("Invalid GeoJSON object.")}}function Fo(s,u,p,_){return s?s(u,p):new wa(p,_&&_.markersInheritOptions&&_)}function Lo(s){return new H(s[1],s[0],s[2])}function Rs(s,u,p){for(var _=[],C=0,V=s.length,de;C<V;C++)de=u?Rs(s[C],u-1,p):(p||Lo)(s[C]),_.push(de);return _}function Ro(s,u){return s=X(s),s.alt!==void 0?[k(s.lng,u),k(s.lat,u),k(s.alt,u)]:[k(s.lng,u),k(s.lat,u)]}function jo(s,u,p,_){for(var C=[],V=0,de=s.length;V<de;V++)C.push(u?jo(s[V],An(s[V])?0:u-1,p,_):Ro(s[V],_));return!u&&p&&C.length>0&&C.push(C[0].slice()),C}function Vi(s,u){return s.feature?a({},s.feature,{geometry:u}):Mo(u)}function Mo(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Gl={toGeoJSON:function(s){return Vi(this,{type:"Point",coordinates:Ro(this.getLatLng(),s)})}};wa.include(Gl),Oo.include(Gl),Do.include(Gl),mn.include({toGeoJSON:function(s){var u=!An(this._latlngs),p=jo(this._latlngs,u?1:0,!1,s);return Vi(this,{type:(u?"Multi":"")+"LineString",coordinates:p})}}),ka.include({toGeoJSON:function(s){var u=!An(this._latlngs),p=u&&!An(this._latlngs[0]),_=jo(this._latlngs,p?2:u?1:0,!0,s);return u||(_=[_]),Vi(this,{type:(p?"Multi":"")+"Polygon",coordinates:_})}}),$a.include({toMultiPoint:function(s){var u=[];return this.eachLayer(function(p){u.push(p.toGeoJSON(s).geometry.coordinates)}),Vi(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(s){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(s);var p=u==="GeometryCollection",_=[];return this.eachLayer(function(C){if(C.toGeoJSON){var V=C.toGeoJSON(s);if(p)_.push(V.geometry);else{var de=Mo(V);de.type==="FeatureCollection"?_.push.apply(_,de.features):_.push(de)}}}),p?Vi(this,{geometries:_,type:"GeometryCollection"}):{type:"FeatureCollection",features:_}}});function xu(s,u){return new Qn(s,u)}var Wn=xu,Va=$n.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,u,p){this._url=s,this._bounds=M(u),S(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ir(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Fi(this._image),this},bringToBack:function(){return this._map&&va(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=M(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",u=this._image=s?this._url:ot("img");if(yt(u,"leaflet-image-layer"),this._zoomAnimated&&yt(u,"leaflet-zoom-animated"),this.options.className&&yt(u,this.options.className),u.onselectstart=y,u.onmousemove=y,u.onload=c(this.fire,this,"load"),u.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(s){var u=this._map.getZoomScale(s.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;Mn(this._image,p,u)},_reset:function(){var s=this._image,u=new I(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=u.getSize();pr(s,u.min),s.style.width=p.x+"px",s.style.height=p.y+"px"},_updateOpacity:function(){Jr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),yu=function(s,u,p){return new Va(s,u,p)},Zl=Va.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",u=this._image=s?this._url:ot("video");if(yt(u,"leaflet-image-layer"),this._zoomAnimated&&yt(u,"leaflet-zoom-animated"),this.options.className&&yt(u,this.options.className),u.onselectstart=y,u.onmousemove=y,u.onloadeddata=c(this.fire,this,"load"),s){for(var p=u.getElementsByTagName("source"),_=[],C=0;C<p.length;C++)_.push(p[C].src);this._url=p.length>0?_:[u.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var V=0;V<this._url.length;V++){var de=ot("source");de.src=this._url[V],u.appendChild(de)}}});function _u(s,u,p){return new Zl(s,u,p)}var Kl=Va.extend({_initImage:function(){var s=this._image=this._url;yt(s,"leaflet-image-layer"),this._zoomAnimated&&yt(s,"leaflet-zoom-animated"),this.options.className&&yt(s,this.options.className),s.onselectstart=y,s.onmousemove=y}});function ql(s,u,p){return new Kl(s,u,p)}var ea=$n.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,u){s&&(s instanceof H||N(s))?(this._latlng=X(s),S(this,u)):(S(this,s),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Jr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Jr(this._container,1),this.bringToFront(),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Jr(this._container,0),this._removeTimeout=setTimeout(c(ir,void 0,this._container),200)):ir(this._container),this.options.interactive&&(Jt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=X(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Fi(this._container),this},bringToBack:function(){return this._map&&va(this._container),this},_prepareOpen:function(s){var u=this._source;if(!u._map)return!1;if(u instanceof _a){u=null;var p=this._source._layers;for(var _ in p)if(p[_]._map){u=p[_];break}if(!u)return!1;this._source=u}if(!s)if(u.getCenter)s=u.getCenter();else if(u.getLatLng)s=u.getLatLng();else if(u.getBounds)s=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")s.innerHTML=u;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),u=oe(this.options.offset),p=this._getAnchor();this._zoomAnimated?pr(this._container,s.add(p)):u=u.add(s).add(p);var _=this._containerBottom=-u.y,C=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=_+"px",this._container.style.left=C+"px"}},_getAnchor:function(){return[0,0]}});Ct.include({_initOverlay:function(s,u,p,_){var C=u;return C instanceof s||(C=new s(_).setContent(u)),p&&C.setLatLng(p),C}}),$n.include({_initOverlay:function(s,u,p,_){var C=p;return C instanceof s?(S(C,_),C._source=this):(C=u&&!_?u:new s(_,this),C.setContent(p)),C}});var Bo=ea.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,ea.prototype.openOn.call(this,s)},onAdd:function(s){ea.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Wa||this._source.on("preclick",Jn))},onRemove:function(s){ea.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Wa||this._source.off("preclick",Jn))},getEvents:function(){var s=ea.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",u=this._container=ot("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=ot("div",s+"-content-wrapper",u);if(this._contentNode=ot("div",s+"-content",p),Is(u),Eo(this._contentNode),ht(u,"contextmenu",Jn),this._tipContainer=ot("div",s+"-tip-container",u),this._tip=ot("div",s+"-tip",this._tipContainer),this.options.closeButton){var _=this._closeButton=ot("a",s+"-close-button",u);_.setAttribute("role","button"),_.setAttribute("aria-label","Close popup"),_.href="#close",_.innerHTML='<span aria-hidden="true">&#215;</span>',ht(_,"click",function(C){fr(C),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,u=s.style;u.width="",u.whiteSpace="nowrap";var p=s.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),u.width=p+1+"px",u.whiteSpace="",u.height="";var _=s.offsetHeight,C=this.options.maxHeight,V="leaflet-popup-scrolled";C&&_>C?(u.height=C+"px",yt(s,V)):Jt(s,V),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),p=this._getAnchor();pr(this._container,u.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,u=parseInt(ga(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+u,_=this._containerWidth,C=new G(this._containerLeft,-p-this._containerBottom);C._add(xa(this._container));var V=s.layerPointToContainerPoint(C),de=oe(this.options.autoPanPadding),we=oe(this.options.autoPanPaddingTopLeft||de),Pe=oe(this.options.autoPanPaddingBottomRight||de),Oe=s.getSize(),Ge=0,lt=0;V.x+_+Pe.x>Oe.x&&(Ge=V.x+_-Oe.x+Pe.x),V.x-Ge-we.x<0&&(Ge=V.x-we.x),V.y+p+Pe.y>Oe.y&&(lt=V.y+p-Oe.y+Pe.y),V.y-lt-we.y<0&&(lt=V.y-we.y),(Ge||lt)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Ge,lt]))}},_getAnchor:function(){return oe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Hi=function(s,u){return new Bo(s,u)};Ct.mergeOptions({closePopupOnClick:!0}),Ct.include({openPopup:function(s,u,p){return this._initOverlay(Bo,s,u,p).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),$n.include({bindPopup:function(s,u){return this._popup=this._initOverlay(Bo,this._popup,s,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof _a||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){zn(s);var u=s.layer||s.target;if(this._popup._source===u&&!(u instanceof Wa)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=u,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Gi=ea.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){ea.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){ea.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=ea.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",u=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ot("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+m(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var u,p,_=this._map,C=this._container,V=_.latLngToContainerPoint(_.getCenter()),de=_.layerPointToContainerPoint(s),we=this.options.direction,Pe=C.offsetWidth,Oe=C.offsetHeight,Ge=oe(this.options.offset),lt=this._getAnchor();we==="top"?(u=Pe/2,p=Oe):we==="bottom"?(u=Pe/2,p=0):we==="center"?(u=Pe/2,p=Oe/2):we==="right"?(u=0,p=Oe/2):we==="left"?(u=Pe,p=Oe/2):de.x<V.x?(we="right",u=0,p=Oe/2):(we="left",u=Pe+(Ge.x+lt.x)*2,p=Oe/2),s=s.subtract(oe(u,p,!0)).add(Ge).add(lt),Jt(C,"leaflet-tooltip-right"),Jt(C,"leaflet-tooltip-left"),Jt(C,"leaflet-tooltip-top"),Jt(C,"leaflet-tooltip-bottom"),yt(C,"leaflet-tooltip-"+we),pr(C,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Jr(this._container,s)},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(u)},_getAnchor:function(){return oe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),js=function(s,u){return new Gi(s,u)};Ct.include({openTooltip:function(s,u,p){return this._initOverlay(Gi,s,u,p).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),$n.include({bindTooltip:function(s,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Gi,this._tooltip,s,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var u=s?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[u](p),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof _a||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var u=typeof s.getElement=="function"&&s.getElement();u&&(ht(u,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),ht(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var u=typeof s.getElement=="function"&&s.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var u=s.latlng,p,_;this._tooltip.options.sticky&&s.originalEvent&&(p=this._map.mouseEventToContainerPoint(s.originalEvent),_=this._map.containerPointToLayerPoint(p),u=this._map.layerPointToLatLng(_)),this._tooltip.setLatLng(u)}});var zo=hi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var u=s&&s.tagName==="DIV"?s:document.createElement("div"),p=this.options;if(p.html instanceof Element?(_o(u),u.appendChild(p.html)):u.innerHTML=p.html!==!1?p.html:"",p.bgPos){var _=oe(p.bgPos);u.style.backgroundPosition=-_.x+"px "+-_.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function wu(s){return new zo(s)}hi.Default=$i;var Ha=$n.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Je.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){S(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),ir(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Fi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(va(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=v(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof G?s:new G(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var u=this.getPane().children,p=-s(-1/0,1/0),_=0,C=u.length,V;_<C;_++)V=u[_].style.zIndex,u[_]!==this._container&&V&&(p=s(p,+V));isFinite(p)&&(this.options.zIndex=p+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Je.ielt9){Jr(this._container,this.options.opacity);var s=+new Date,u=!1,p=!1;for(var _ in this._tiles){var C=this._tiles[_];if(!(!C.current||!C.loaded)){var V=Math.min(1,(s-C.loaded)/200);Jr(C.el,V),V<1?u=!0:(C.active?p=!0:this._onOpaqueTile(C),C.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),u&&(J(this._fadeFrame),this._fadeFrame=me(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=ot("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,u=this.options.maxZoom;if(s!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===s?(this._levels[p].el.style.zIndex=u-Math.abs(s-p),this._onUpdateLevel(p)):(ir(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var _=this._levels[s],C=this._map;return _||(_=this._levels[s]={},_.el=ot("div","leaflet-tile-container leaflet-zoom-animated",this._container),_.el.style.zIndex=u,_.origin=C.project(C.unproject(C.getPixelOrigin()),s).round(),_.zoom=s,this._setZoomTransform(_,C.getCenter(),C.getZoom()),y(_.el.offsetWidth),this._onCreateLevel(_)),this._level=_,_}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var s,u,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)u=this._tiles[s],u.retain=u.current;for(s in this._tiles)if(u=this._tiles[s],u.current&&!u.active){var _=u.coords;this._retainParent(_.x,_.y,_.z,_.z-5)||this._retainChildren(_.x,_.y,_.z,_.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var u in this._tiles)this._tiles[u].coords.z===s&&this._removeTile(u)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)ir(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,u,p,_){var C=Math.floor(s/2),V=Math.floor(u/2),de=p-1,we=new G(+C,+V);we.z=+de;var Pe=this._tileCoordsToKey(we),Oe=this._tiles[Pe];return Oe&&Oe.active?(Oe.retain=!0,!0):(Oe&&Oe.loaded&&(Oe.retain=!0),de>_?this._retainParent(C,V,de,_):!1)},_retainChildren:function(s,u,p,_){for(var C=2*s;C<2*s+2;C++)for(var V=2*u;V<2*u+2;V++){var de=new G(C,V);de.z=p+1;var we=this._tileCoordsToKey(de),Pe=this._tiles[we];if(Pe&&Pe.active){Pe.retain=!0;continue}else Pe&&Pe.loaded&&(Pe.retain=!0);p+1<_&&this._retainChildren(C,V,p+1,_)}},_resetView:function(s){var u=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var u=this.options;return u.minNativeZoom!==void 0&&s<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<s?u.maxNativeZoom:s},_setView:function(s,u,p,_){var C=Math.round(u);this.options.maxZoom!==void 0&&C>this.options.maxZoom||this.options.minZoom!==void 0&&C<this.options.minZoom?C=void 0:C=this._clampZoom(C);var V=this.options.updateWhenZooming&&C!==this._tileZoom;(!_||V)&&(this._tileZoom=C,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),C!==void 0&&this._update(s),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(s,u)},_setZoomTransforms:function(s,u){for(var p in this._levels)this._setZoomTransform(this._levels[p],s,u)},_setZoomTransform:function(s,u,p){var _=this._map.getZoomScale(p,s.zoom),C=s.origin.multiplyBy(_).subtract(this._map._getNewPixelOrigin(u,p)).round();Je.any3d?Mn(s.el,C,_):pr(s.el,C)},_resetGrid:function(){var s=this._map,u=s.options.crs,p=this._tileSize=this.getTileSize(),_=this._tileZoom,C=this._map.getPixelWorldBounds(this._tileZoom);C&&(this._globalTileRange=this._pxBoundsToTileRange(C)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,u.wrapLng[0]],_).x/p.x),Math.ceil(s.project([0,u.wrapLng[1]],_).x/p.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([u.wrapLat[0],0],_).y/p.x),Math.ceil(s.project([u.wrapLat[1],0],_).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var u=this._map,p=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),_=u.getZoomScale(p,this._tileZoom),C=u.project(s,this._tileZoom).floor(),V=u.getSize().divideBy(_*2);return new I(C.subtract(V),C.add(V))},_update:function(s){var u=this._map;if(u){var p=this._clampZoom(u.getZoom());if(s===void 0&&(s=u.getCenter()),this._tileZoom!==void 0){var _=this._getTiledPixelBounds(s),C=this._pxBoundsToTileRange(_),V=C.getCenter(),de=[],we=this.options.keepBuffer,Pe=new I(C.getBottomLeft().subtract([we,-we]),C.getTopRight().add([we,-we]));if(!(isFinite(C.min.x)&&isFinite(C.min.y)&&isFinite(C.max.x)&&isFinite(C.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Oe in this._tiles){var Ge=this._tiles[Oe].coords;(Ge.z!==this._tileZoom||!Pe.contains(new G(Ge.x,Ge.y)))&&(this._tiles[Oe].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(s,p);return}for(var lt=C.min.y;lt<=C.max.y;lt++)for(var bt=C.min.x;bt<=C.max.x;bt++){var Nr=new G(bt,lt);if(Nr.z=this._tileZoom,!!this._isValidTile(Nr)){var br=this._tiles[this._tileCoordsToKey(Nr)];br?br.current=!0:de.push(Nr)}}if(de.sort(function(en,Xi){return en.distanceTo(V)-Xi.distanceTo(V)}),de.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var pn=document.createDocumentFragment();for(bt=0;bt<de.length;bt++)this._addTile(de[bt],pn);this._level.el.appendChild(pn)}}}},_isValidTile:function(s){var u=this._map.options.crs;if(!u.infinite){var p=this._globalTileRange;if(!u.wrapLng&&(s.x<p.min.x||s.x>p.max.x)||!u.wrapLat&&(s.y<p.min.y||s.y>p.max.y))return!1}if(!this.options.bounds)return!0;var _=this._tileCoordsToBounds(s);return M(this.options.bounds).overlaps(_)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var u=this._map,p=this.getTileSize(),_=s.scaleBy(p),C=_.add(p),V=u.unproject(_,s.z),de=u.unproject(C,s.z);return[V,de]},_tileCoordsToBounds:function(s){var u=this._tileCoordsToNwSe(s),p=new F(u[0],u[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var u=s.split(":"),p=new G(+u[0],+u[1]);return p.z=+u[2],p},_removeTile:function(s){var u=this._tiles[s];u&&(ir(u.el),delete this._tiles[s],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){yt(s,"leaflet-tile");var u=this.getTileSize();s.style.width=u.x+"px",s.style.height=u.y+"px",s.onselectstart=y,s.onmousemove=y,Je.ielt9&&this.options.opacity<1&&Jr(s,this.options.opacity)},_addTile:function(s,u){var p=this._getTilePos(s),_=this._tileCoordsToKey(s),C=this.createTile(this._wrapCoords(s),c(this._tileReady,this,s));this._initTile(C),this.createTile.length<2&&me(c(this._tileReady,this,s,null,C)),pr(C,p),this._tiles[_]={el:C,coords:s,current:!0},u.appendChild(C),this.fire("tileloadstart",{tile:C,coords:s})},_tileReady:function(s,u,p){u&&this.fire("tileerror",{error:u,tile:p,coords:s});var _=this._tileCoordsToKey(s);p=this._tiles[_],p&&(p.loaded=+new Date,this._map._fadeAnimated?(Jr(p.el,0),J(this._fadeFrame),this._fadeFrame=me(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),u||(yt(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Je.ielt9||!this._map._fadeAnimated?me(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var u=new G(this._wrapX?x(s.x,this._wrapX):s.x,this._wrapY?x(s.y,this._wrapY):s.y);return u.z=s.z,u},_pxBoundsToTileRange:function(s){var u=this.getTileSize();return new I(s.min.unscaleBy(u).floor(),s.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function Zi(s){return new Ha(s)}var Ga=Ha.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,u){this._url=s,u=S(this,u),u.detectRetina&&Je.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,u){return this._url===s&&u===void 0&&(u=!0),this._url=s,u||this.redraw(),this},createTile:function(s,u){var p=document.createElement("img");return ht(p,"load",c(this._tileOnLoad,this,u,p)),ht(p,"error",c(this._tileOnError,this,u,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(s),p},getTileUrl:function(s){var u={r:Je.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-s.y;this.options.tms&&(u.y=p),u["-y"]=p}return O(this._url,a(u,this.options))},_tileOnLoad:function(s,u){Je.ielt9?setTimeout(c(s,this,null,u),0):s(null,u)},_tileOnError:function(s,u,p){var _=this.options.errorTileUrl;_&&u.getAttribute("src")!==_&&(u.src=_),s(p,u)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,u=this.options.maxZoom,p=this.options.zoomReverse,_=this.options.zoomOffset;return p&&(s=u-s),s+_},_getSubdomain:function(s){var u=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var s,u;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(u=this._tiles[s].el,u.onload=y,u.onerror=y,!u.complete)){u.src=K;var p=this._tiles[s].coords;ir(u),delete this._tiles[s],this.fire("tileabort",{tile:u,coords:p})}},_removeTile:function(s){var u=this._tiles[s];if(u)return u.el.setAttribute("src",K),Ha.prototype._removeTile.call(this,s)},_tileReady:function(s,u,p){if(!(!this._map||p&&p.getAttribute("src")===K))return Ha.prototype._tileReady.call(this,s,u,p)}});function Yl(s,u){return new Ga(s,u)}var Ms=Ga.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,u){this._url=s;var p=a({},this.defaultWmsParams);for(var _ in u)_ in this.options||(p[_]=u[_]);u=S(this,u);var C=u.detectRetina&&Je.retina?2:1,V=this.getTileSize();p.width=V.x*C,p.height=V.y*C,this.wmsParams=p},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,Ga.prototype.onAdd.call(this,s)},getTileUrl:function(s){var u=this._tileCoordsToNwSe(s),p=this._crs,_=P(p.project(u[0]),p.project(u[1])),C=_.min,V=_.max,de=(this._wmsVersion>=1.3&&this._crs===mu?[C.y,C.x,V.y,V.x]:[C.x,C.y,V.x,V.y]).join(","),we=Ga.prototype.getTileUrl.call(this,s);return we+A(this.wmsParams,we,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+de},setParams:function(s,u){return a(this.wmsParams,s),u||this.redraw(),this}});function ku(s,u){return new Ms(s,u)}Ga.WMS=Ms,Yl.wms=ku;var ta=$n.extend({options:{padding:.1},initialize:function(s){S(this,s),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,u){var p=this._map.getZoomScale(u,this._zoom),_=this._map.getSize().multiplyBy(.5+this.options.padding),C=this._map.project(this._center,u),V=_.multiplyBy(-p).add(C).subtract(this._map._getNewPixelOrigin(s,u));Je.any3d?Mn(this._container,V,p):pr(this._container,V)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,u=this._map.getSize(),p=this._map.containerPointToLayerPoint(u.multiplyBy(-s)).round();this._bounds=new I(p,p.add(u.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Xl=ta.extend({options:{tolerance:0},getEvents:function(){var s=ta.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ta.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");ht(s,"mousemove",this._onMouseMove,this),ht(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ht(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){J(this._redrawRequest),delete this._ctx,ir(this._container),Ht(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var u in this._layers)s=this._layers[u],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ta.prototype._update.call(this);var s=this._bounds,u=this._container,p=s.getSize(),_=Je.retina?2:1;pr(u,s.min),u.width=_*p.x,u.height=_*p.y,u.style.width=p.x+"px",u.style.height=p.y+"px",Je.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){ta.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[m(s)]=s;var u=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var u=s._order,p=u.next,_=u.prev;p?p.prev=_:this._drawLast=_,_?_.next=p:this._drawFirst=p,delete s._order,delete this._layers[m(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var u=s.options.dashArray.split(/[, ]+/),p=[],_,C;for(C=0;C<u.length;C++){if(_=Number(u[C]),isNaN(_))return;p.push(_)}s.options._dashArray=p}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||me(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var u=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new I,this._redrawBounds.extend(s._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(s._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var u=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,u=this._redrawBounds;if(this._ctx.save(),u){var p=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var _=this._drawFirst;_;_=_.next)s=_.layer,(!u||s._pxBounds&&s._pxBounds.intersects(u))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,u){if(this._drawing){var p,_,C,V,de=s._parts,we=de.length,Pe=this._ctx;if(we){for(Pe.beginPath(),p=0;p<we;p++){for(_=0,C=de[p].length;_<C;_++)V=de[p][_],Pe[_?"lineTo":"moveTo"](V.x,V.y);u&&Pe.closePath()}this._fillStroke(Pe,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var u=s._point,p=this._ctx,_=Math.max(Math.round(s._radius),1),C=(Math.max(Math.round(s._radiusY),1)||_)/_;C!==1&&(p.save(),p.scale(1,C)),p.beginPath(),p.arc(u.x,u.y/C,_,0,Math.PI*2,!1),C!==1&&p.restore(),this._fillStroke(p,s)}},_fillStroke:function(s,u){var p=u.options;p.fill&&(s.globalAlpha=p.fillOpacity,s.fillStyle=p.fillColor||p.color,s.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(s.setLineDash&&s.setLineDash(u.options&&u.options._dashArray||[]),s.globalAlpha=p.opacity,s.lineWidth=p.weight,s.strokeStyle=p.color,s.lineCap=p.lineCap,s.lineJoin=p.lineJoin,s.stroke())},_onClick:function(s){for(var u=this._map.mouseEventToLayerPoint(s),p,_,C=this._drawFirst;C;C=C.next)p=C.layer,p.options.interactive&&p._containsPoint(u)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(p))&&(_=p);this._fireEvent(_?[_]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,u)}},_handleMouseOut:function(s){var u=this._hoveredLayer;u&&(Jt(this._container,"leaflet-interactive"),this._fireEvent([u],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,u){if(!this._mouseHoverThrottled){for(var p,_,C=this._drawFirst;C;C=C.next)p=C.layer,p.options.interactive&&p._containsPoint(u)&&(_=p);_!==this._hoveredLayer&&(this._handleMouseOut(s),_&&(yt(this._container,"leaflet-interactive"),this._fireEvent([_],s,"mouseover"),this._hoveredLayer=_)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,u,p){this._map._fireDOMEvent(u,p||u.type,s)},_bringToFront:function(s){var u=s._order;if(u){var p=u.next,_=u.prev;if(p)p.prev=_;else return;_?_.next=p:p&&(this._drawFirst=p),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(s)}},_bringToBack:function(s){var u=s._order;if(u){var p=u.next,_=u.prev;if(_)_.next=p;else return;p?p.prev=_:_&&(this._drawLast=_),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(s)}}});function Jl(s){return Je.canvas?new Xl(s):null}var Ki=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),bu={_initContainer:function(){this._container=ot("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ta.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var u=s._container=Ki("shape");yt(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",s._path=Ki("path"),u.appendChild(s._path),this._updateStyle(s),this._layers[m(s)]=s},_addPath:function(s){var u=s._container;this._container.appendChild(u),s.options.interactive&&s.addInteractiveTarget(u)},_removePath:function(s){var u=s._container;ir(u),s.removeInteractiveTarget(u),delete this._layers[m(s)]},_updateStyle:function(s){var u=s._stroke,p=s._fill,_=s.options,C=s._container;C.stroked=!!_.stroke,C.filled=!!_.fill,_.stroke?(u||(u=s._stroke=Ki("stroke")),C.appendChild(u),u.weight=_.weight+"px",u.color=_.color,u.opacity=_.opacity,_.dashArray?u.dashStyle=N(_.dashArray)?_.dashArray.join(" "):_.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=_.lineCap.replace("butt","flat"),u.joinstyle=_.lineJoin):u&&(C.removeChild(u),s._stroke=null),_.fill?(p||(p=s._fill=Ki("fill")),C.appendChild(p),p.color=_.fillColor||_.color,p.opacity=_.fillOpacity):p&&(C.removeChild(p),s._fill=null)},_updateCircle:function(s){var u=s._point.round(),p=Math.round(s._radius),_=Math.round(s._radiusY||p);this._setPath(s,s._empty()?"M0 0":"AL "+u.x+","+u.y+" "+p+","+_+" 0,"+65535*360)},_setPath:function(s,u){s._path.v=u},_bringToFront:function(s){Fi(s._container)},_bringToBack:function(s){va(s._container)}},Vn=Je.vml?Ki:wt,mi=ta.extend({_initContainer:function(){this._container=Vn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Vn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ir(this._container),Ht(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ta.prototype._update.call(this);var s=this._bounds,u=s.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,p.setAttribute("width",u.x),p.setAttribute("height",u.y)),pr(p,s.min),p.setAttribute("viewBox",[s.min.x,s.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(s){var u=s._path=Vn("path");s.options.className&&yt(u,s.options.className),s.options.interactive&&yt(u,"leaflet-interactive"),this._updateStyle(s),this._layers[m(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){ir(s._path),s.removeInteractiveTarget(s._path),delete this._layers[m(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var u=s._path,p=s.options;u&&(p.stroke?(u.setAttribute("stroke",p.color),u.setAttribute("stroke-opacity",p.opacity),u.setAttribute("stroke-width",p.weight),u.setAttribute("stroke-linecap",p.lineCap),u.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?u.setAttribute("stroke-dasharray",p.dashArray):u.removeAttribute("stroke-dasharray"),p.dashOffset?u.setAttribute("stroke-dashoffset",p.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),p.fill?(u.setAttribute("fill",p.fillColor||p.color),u.setAttribute("fill-opacity",p.fillOpacity),u.setAttribute("fill-rule",p.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(s,u){this._setPath(s,_t(s._parts,u))},_updateCircle:function(s){var u=s._point,p=Math.max(Math.round(s._radius),1),_=Math.max(Math.round(s._radiusY),1)||p,C="a"+p+","+_+" 0 1,0 ",V=s._empty()?"M0 0":"M"+(u.x-p)+","+u.y+C+p*2+",0 "+C+-p*2+",0 ";this._setPath(s,V)},_setPath:function(s,u){s._path.setAttribute("d",u)},_bringToFront:function(s){Fi(s._path)},_bringToBack:function(s){va(s._path)}});Je.vml&&mi.include(bu);function Uo(s){return Je.svg||Je.vml?new mi(s):null}Ct.include({getRenderer:function(s){var u=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var u=this._paneRenderers[s];return u===void 0&&(u=this._createRenderer({pane:s}),this._paneRenderers[s]=u),u},_createRenderer:function(s){return this.options.preferCanvas&&Jl(s)||Uo(s)}});var Su=ka.extend({initialize:function(s,u){ka.prototype.initialize.call(this,this._boundsToLatLngs(s),u)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=M(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Cf(s,u){return new Su(s,u)}mi.create=Vn,mi.pointsToPath=_t,Qn.geometryToLayer=Wi,Qn.coordsToLatLng=Lo,Qn.coordsToLatLngs=Rs,Qn.latLngToCoords=Ro,Qn.latLngsToCoords=jo,Qn.getFeature=Vi,Qn.asFeature=Mo,Ct.mergeOptions({boxZoom:!0});var qi=Cn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){ht(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ht(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ir(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Pt(),bo(),this._startPoint=this._map.mouseEventToContainerPoint(s),ht(document,{contextmenu:zn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=ot("div","leaflet-zoom-box",this._container),yt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var u=new I(this._point,this._startPoint),p=u.getSize();pr(this._box,u.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(ir(this._box),Jt(this._container,"leaflet-crosshair")),ji(),So(),Ht(document,{contextmenu:zn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var u=new F(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ct.addInitHook("addHandler","boxZoom",qi),Ct.mergeOptions({doubleClickZoom:!0});var Tu=Cn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var u=this._map,p=u.getZoom(),_=u.options.zoomDelta,C=s.originalEvent.shiftKey?p-_:p+_;u.options.doubleClickZoom==="center"?u.setZoom(C):u.setZoomAround(s.containerPoint,C)}});Ct.addInitHook("addHandler","doubleClickZoom",Tu),Ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ql=Cn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Un(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}yt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Jt(this._map._container,"leaflet-grab"),Jt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=M(this._map.options.maxBounds);this._offsetLimit=P(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var u=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(u),this._prunePositions(u)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,u){return s-(s-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;s.x<u.min.x&&(s.x=this._viscousLimit(s.x,u.min.x)),s.y<u.min.y&&(s.y=this._viscousLimit(s.y,u.min.y)),s.x>u.max.x&&(s.x=this._viscousLimit(s.x,u.max.x)),s.y>u.max.y&&(s.y=this._viscousLimit(s.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,u=Math.round(s/2),p=this._initialWorldOffset,_=this._draggable._newPos.x,C=(_-u+p)%s+u-p,V=(_+u+p)%s-u-p,de=Math.abs(C+p)<Math.abs(V+p)?C:V;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=de},_onDragEnd:function(s){var u=this._map,p=u.options,_=!p.inertia||s.noInertia||this._times.length<2;if(u.fire("dragend",s),_)u.fire("moveend");else{this._prunePositions(+new Date);var C=this._lastPos.subtract(this._positions[0]),V=(this._lastTime-this._times[0])/1e3,de=p.easeLinearity,we=C.multiplyBy(de/V),Pe=we.distanceTo([0,0]),Oe=Math.min(p.inertiaMaxSpeed,Pe),Ge=we.multiplyBy(Oe/Pe),lt=Oe/(p.inertiaDeceleration*de),bt=Ge.multiplyBy(-lt/2).round();!bt.x&&!bt.y?u.fire("moveend"):(bt=u._limitOffset(bt,u.options.maxBounds),me(function(){u.panBy(bt,{duration:lt,easeLinearity:de,noMoveStart:!0,animate:!0})}))}}});Ct.addInitHook("addHandler","dragging",Ql),Ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ec=Cn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),ht(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ht(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,u=document.documentElement,p=s.scrollTop||u.scrollTop,_=s.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(_,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var u=this._panKeys={},p=this.keyCodes,_,C;for(_=0,C=p.left.length;_<C;_++)u[p.left[_]]=[-1*s,0];for(_=0,C=p.right.length;_<C;_++)u[p.right[_]]=[s,0];for(_=0,C=p.down.length;_<C;_++)u[p.down[_]]=[0,s];for(_=0,C=p.up.length;_<C;_++)u[p.up[_]]=[0,-1*s]},_setZoomDelta:function(s){var u=this._zoomKeys={},p=this.keyCodes,_,C;for(_=0,C=p.zoomIn.length;_<C;_++)u[p.zoomIn[_]]=s;for(_=0,C=p.zoomOut.length;_<C;_++)u[p.zoomOut[_]]=-s},_addHooks:function(){ht(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ht(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var u=s.keyCode,p=this._map,_;if(u in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(_=this._panKeys[u],s.shiftKey&&(_=oe(_).multiplyBy(3)),p.options.maxBounds&&(_=p._limitOffset(oe(_),p.options.maxBounds)),p.options.worldCopyJump){var C=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(_)));p.panTo(C)}else p.panBy(_)}else if(u in this._zoomKeys)p.setZoom(p.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;zn(s)}}});Ct.addInitHook("addHandler","keyboard",ec),Ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Gt=Cn.extend({addHooks:function(){ht(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ht(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var u=su(s),p=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var _=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),_),zn(s)},_performZoom:function(){var s=this._map,u=s.getZoom(),p=this._map.options.zoomSnap||0;s._stop();var _=this._delta/(this._map.options.wheelPxPerZoomLevel*4),C=4*Math.log(2/(1+Math.exp(-Math.abs(_))))/Math.LN2,V=p?Math.ceil(C/p)*p:C,de=s._limitZoom(u+(this._delta>0?V:-V))-u;this._delta=0,this._startTime=null,de&&(s.options.scrollWheelZoom==="center"?s.setZoom(u+de):s.setZoomAround(this._lastMousePos,u+de))}});Ct.addInitHook("addHandler","scrollWheelZoom",Gt);var tc=600;Ct.mergeOptions({tapHold:Je.touchNative&&Je.safari&&Je.mobile,tapTolerance:15});var Bs=Cn.extend({addHooks:function(){ht(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ht(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var u=s.touches[0];this._startPos=this._newPos=new G(u.clientX,u.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(ht(document,"touchend",fr),ht(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),tc),ht(document,"touchend touchcancel contextmenu",this._cancel,this),ht(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Ht(document,"touchend",fr),Ht(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Ht(document,"touchend touchcancel contextmenu",this._cancel,this),Ht(document,"touchmove",this._onMove,this)},_onMove:function(s){var u=s.touches[0];this._newPos=new G(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,u){var p=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});p._simulated=!0,u.target.dispatchEvent(p)}});Ct.addInitHook("addHandler","tapHold",Bs),Ct.mergeOptions({touchZoom:Je.touch,bounceAtZoomLimits:!0});var Yi=Cn.extend({addHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),ht(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Jt(this._map._container,"leaflet-touch-zoom"),Ht(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var u=this._map;if(!(!s.touches||s.touches.length!==2||u._animatingZoom||this._zooming)){var p=u.mouseEventToContainerPoint(s.touches[0]),_=u.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(p.add(_)._divideBy(2))),this._startDist=p.distanceTo(_),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),ht(document,"touchmove",this._onTouchMove,this),ht(document,"touchend touchcancel",this._onTouchEnd,this),fr(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var u=this._map,p=u.mouseEventToContainerPoint(s.touches[0]),_=u.mouseEventToContainerPoint(s.touches[1]),C=p.distanceTo(_)/this._startDist;if(this._zoom=u.getScaleZoom(C,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&C<1||this._zoom>u.getMaxZoom()&&C>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,C===1)return}else{var V=p._add(_)._divideBy(2)._subtract(this._centerPoint);if(C===1&&V.x===0&&V.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(V),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),J(this._animRequest);var de=c(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=me(de,this,!0),fr(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,J(this._animRequest),Ht(document,"touchmove",this._onTouchMove,this),Ht(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ct.addInitHook("addHandler","touchZoom",Yi),Ct.BoxZoom=qi,Ct.DoubleClickZoom=Tu,Ct.Drag=Ql,Ct.Keyboard=ec,Ct.ScrollWheelZoom=Gt,Ct.TapHold=Bs,Ct.TouchZoom=Yi,t.Bounds=I,t.Browser=Je,t.CRS=fe,t.Canvas=Xl,t.Circle=Oo,t.CircleMarker=Do,t.Class=ke,t.Control=hn,t.DivIcon=zo,t.DivOverlay=ea,t.DomEvent=Co,t.DomUtil=Ns,t.Draggable=Un,t.Evented=j,t.FeatureGroup=_a,t.GeoJSON=Qn,t.GridLayer=Ha,t.Handler=Cn,t.Icon=hi,t.ImageOverlay=Va,t.LatLng=H,t.LatLngBounds=F,t.Layer=$n,t.LayerGroup=$a,t.LineUtil=hu,t.Map=Ct,t.Marker=wa,t.Mixin=Ml,t.Path=Wa,t.Point=G,t.PolyUtil=gf,t.Polygon=ka,t.Polyline=mn,t.Popup=Bo,t.PosAnimation=Ao,t.Projection=wf,t.Rectangle=Su,t.Renderer=ta,t.SVG=mi,t.SVGOverlay=Kl,t.TileLayer=Ga,t.Tooltip=Gi,t.Transformation=ze,t.Util=ce,t.VideoOverlay=Zl,t.bind=c,t.bounds=P,t.canvas=Jl,t.circle=Ls,t.circleMarker=vu,t.control=Ua,t.divIcon=wu,t.extend=a,t.featureGroup=pu,t.geoJSON=xu,t.geoJson=Wn,t.gridLayer=Zi,t.icon=gu,t.imageOverlay=yu,t.latLng=X,t.latLngBounds=M,t.layerGroup=Fs,t.map=za,t.marker=Sf,t.point=oe,t.polygon=Ef,t.polyline=Tf,t.popup=Hi,t.rectangle=Cf,t.setOptions=S,t.stamp=m,t.svg=Uo,t.svgOverlay=ql,t.tileLayer=Yl,t.tooltip=js,t.transformation=ne,t.version=n,t.videoOverlay=_u;var Eu=window.L;t.noConflict=function(){return window.L=Eu,this},window.L=t}))})(Ec,Ec.exports)),Ec.exports}var Dl=Y3();const qc=rf(Dl);function ff(e,r,t){return Object.freeze({instance:e,context:r,container:t})}function hf(e,r){return r==null?function(n,a){const l=Y.useRef();return l.current||(l.current=e(n,a)),l}:function(n,a){const l=Y.useRef();l.current||(l.current=e(n,a));const c=Y.useRef(n),{instance:d}=l.current;return Y.useEffect(function(){c.current!==n&&(r(d,n,c.current),c.current=n)},[d,n,a]),l}}function Py(e,r){Y.useEffect(function(){return(r.layerContainer??r.map).addLayer(e.instance),function(){r.layerContainer?.removeLayer(e.instance),r.map.removeLayer(e.instance)}},[r,e])}function Ny(e){return function(t){const n=uf(),a=e(df(t,n),n);return by(n.map,t.attribution),km(a.current,t.eventHandlers),Py(a.current,n),a}}function X3(e,r){const t=Y.useRef();Y.useEffect(function(){if(r.pathOptions!==t.current){const a=r.pathOptions??{};e.instance.setStyle(a),t.current=a}},[e,r])}function J3(e){return function(t){const n=uf(),a=e(df(t,n),n);return km(a.current,t.eventHandlers),Py(a.current,n),X3(a.current,t),a}}function Q3(e,r){const t=hf(e,r),n=Ny(t);return Ay(n)}function eI(e,r){const t=hf(e),n=K3(t,r);return G3(n)}function tI(e,r){const t=hf(e,r),n=J3(t);return Ay(n)}function rI(e,r){const t=hf(e,r),n=Ny(t);return Z3(n)}function nI(e,r,t){const{opacity:n,zIndex:a}=r;n!=null&&n!==t.opacity&&e.setOpacity(n),a!=null&&a!==t.zIndex&&e.setZIndex(a)}function Iy(){return uf().map}function O0(){return O0=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},O0.apply(this,arguments)}function aI({bounds:e,boundsOptions:r,center:t,children:n,className:a,id:l,placeholder:c,style:d,whenReady:m,zoom:v,...x},y){const[k]=Y.useState({className:a,id:l,style:d}),[E,b]=Y.useState(null);Y.useImperativeHandle(y,()=>E?.map??null,[E]);const S=Y.useCallback(R=>{if(R!==null&&E===null){const O=new Dl.Map(R,x);t!=null&&v!=null?O.setView(t,v):e!=null&&O.fitBounds(e,r),m!=null&&O.whenReady(m),b(H3(O))}},[]);Y.useEffect(()=>()=>{E?.map.remove()},[E]);const A=E?Xt.createElement(Cy,{value:E},n):c??null;return Xt.createElement("div",O0({},k,{ref:S}),A)}const Dy=Y.forwardRef(aI),Oy=Q3(function({position:r,...t},n){const a=new Dl.Marker(r,t);return ff(a,Ty(n,{overlayContainer:a}))},function(r,t,n){t.position!==n.position&&r.setLatLng(t.position),t.icon!=null&&t.icon!==n.icon&&r.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==n.zIndexOffset&&r.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==n.opacity&&r.setOpacity(t.opacity),r.dragging!=null&&t.draggable!==n.draggable&&(t.draggable===!0?r.dragging.enable():r.dragging.disable())}),iI=tI(function({positions:r,...t},n){const a=new Dl.Polyline(r,t);return ff(a,Ty(n,{overlayContainer:a}))},function(r,t,n){t.positions!==n.positions&&r.setLatLngs(t.positions)}),F0=eI(function(r,t){const n=new Dl.Popup(r,t.overlayContainer);return ff(n,t)},function(r,t,{position:n},a){Y.useEffect(function(){const{instance:c}=r;function d(v){v.popup===c&&(c.update(),a(!0))}function m(v){v.popup===c&&a(!1)}return t.map.on({popupopen:d,popupclose:m}),t.overlayContainer==null?(n!=null&&c.setLatLng(n),c.openOn(t.map)):t.overlayContainer.bindPopup(c),function(){t.map.off({popupopen:d,popupclose:m}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(c)}},[r,t,a,n])}),Fy=rI(function({url:r,...t},n){const a=new Dl.TileLayer(r,df(t,n));return ff(a,n)},function(r,t,n){nI(r,t,n);const{url:a}=t;a!=null&&a!==n.url&&r.setUrl(a)});function Jv({startTime:e}){const[r,t]=Y.useState(0);if(Y.useEffect(()=>{if(!e)return;const l=()=>{const d=new Date(e).getTime(),m=Date.now();t(Math.floor((m-d)/1e3))};l();const c=setInterval(l,1e3);return()=>clearInterval(c)},[e]),!e)return null;const n=Math.floor(r/60),a=r%60;return f.jsxs("div",{className:"elapsed-timer",children:[f.jsx("span",{className:"timer-icon",children:"⏱️"}),f.jsxs("span",{className:"timer-value",children:[n,":",a.toString().padStart(2,"0")]})]})}function sI({positions:e,resetTrigger:r}){const t=Iy(),n=Y.useRef(!1),a=Y.useRef(0);return Y.useEffect(()=>{if(!(e.length===0||!(!n.current||r&&r!==a.current)))if(n.current=!0,r&&(a.current=r),e.length===1)t.setView(e[0],15);else{const c=qc.latLngBounds(e);t.fitBounds(c.pad(.1))}},[t,e,r]),null}function oI(e,r){return qc.divIcon({className:"custom-numbered-marker",html:`<div class="marker-pin ${r?"marker-active":""}">
      <div class="marker-number">${e}</div>
    </div>`,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]})}function lI(e){return typeof e.lat=="number"&&typeof e.lng=="number"&&!Number.isNaN(e.lat)&&!Number.isNaN(e.lng)?`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(`${e.lat},${e.lng}`)}`:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e?.address??"")}`}const cI=function({state:r,setActive:t,cancelActive:n,onComplete:a,onAddArrangement:l,filterText:c}){const d=Array.isArray(r.addresses)?r.addresses:[],m=Array.isArray(r.completions)?r.completions:[],v=r.activeIndex,[x,y]=Y.useState(()=>{const G=localStorage.getItem("navigator_address_view_mode");return G==="map"||G==="list"?G:"list"}),[k,E]=Y.useState(0);Y.useEffect(()=>{localStorage.setItem("navigator_address_view_mode",x)},[x]);const b=Y.useMemo(()=>{const G=new Set;return d.forEach((Z,oe)=>{if(!Z.address)return;m.some(P=>P.index===oe&&(P.listVersion||r.currentListVersion)===r.currentListVersion)&&G.add(oe)}),G},[m,d,r.currentListVersion]),S=(c??"").trim().toLowerCase(),A=Y.useMemo(()=>d.map((G,Z)=>({a:G,i:Z})).filter(({a:G})=>!S||(G.address??"").toLowerCase().includes(S)).filter(({i:G})=>!b.has(G)),[d,S,b]),[R,O]=Y.useState(null),[N,U]=Y.useState(""),[K,B]=Y.useState(""),[D,te]=Y.useState(null),[ee,ve]=Y.useState(null),me=Y.useRef(null),[J,ce]=Y.useState(null),[ke,se]=Y.useState(null);Y.useEffect(()=>{v===null&&(O(null),U(""),B(""),te(null),se(null),ve(null))},[v]);const ue=Y.useCallback(async(G,Z,oe,I,P)=>{if(me.current===G)return;const F=Date.now();if(!(J&&J.index===G&&J.outcome===Z&&F-J.timestamp<2e3))try{me.current=G,ve(G),ce({index:G,outcome:Z,timestamp:F}),await a(G,Z,oe,I,P),O(null)}catch(M){console.error("Completion failed:",M)}finally{me.current=null,ve(null)}},[J,a]),j=Y.useMemo(()=>A.filter(({a:G})=>G.lat&&G.lng),[A]);return A.length===0?f.jsxs("div",{className:"empty-state",children:[f.jsx("div",{className:"empty-icon",children:"📍"}),f.jsx("div",{className:"empty-title",children:"No Pending Addresses"}),f.jsx("div",{className:"empty-message",children:"Import an Excel file or add addresses manually to get started"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"view-toggle-container",children:[f.jsxs("button",{className:`view-toggle-btn ${x==="list"?"active":""}`,onClick:()=>y("list"),children:[f.jsx("span",{children:"📋"}),f.jsx("span",{children:"List"})]}),f.jsxs("button",{className:`view-toggle-btn ${x==="map"?"active":""}`,onClick:()=>y("map"),disabled:j.length===0,children:[f.jsx("span",{children:"🗺️"}),f.jsx("span",{children:"Map"}),j.length===0&&f.jsx("span",{className:"badge-warning",children:"(No coordinates)"})]})]}),x==="map"&&j.length>0&&f.jsxs("div",{className:"map-view-container",children:[f.jsx("button",{className:"map-reset-btn",onClick:()=>E(Date.now()),title:"Reset map view to show all addresses",children:"🎯 Reset View"}),f.jsxs(Dy,{center:[51.5074,-.1278],zoom:10,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[f.jsx(Fy,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),f.jsx(sI,{positions:j.map(({a:G})=>[G.lat,G.lng]),resetTrigger:k}),j.map(({a:G,i:Z},oe)=>{const I=v===Z;return f.jsx(Oy,{position:[G.lat,G.lng],icon:oI(oe+1,I),children:f.jsx(F0,{children:f.jsxs("div",{className:"map-popup",children:[f.jsxs("div",{className:"popup-header",children:[f.jsxs("span",{className:"popup-number",children:["#",oe+1]}),f.jsx("span",{className:`popup-status ${I?"status-active":"status-pending"}`,children:I?"Active":"Pending"})]}),f.jsx("div",{className:"popup-address",children:G.address}),!I&&f.jsx("button",{className:"popup-btn-start",onClick:()=>t(Z),children:"▶️ Start"}),I&&f.jsxs("div",{className:"popup-active-info",children:[f.jsx(Jv,{startTime:r.activeStartTime}),f.jsx("button",{className:"popup-btn-complete",onClick:()=>{y("list")},children:"✅ Complete"})]})]})})},Z)})]})]}),x==="list"&&f.jsx("div",{className:"address-list-modern",children:A.map(({a:G,i:Z},oe)=>{const I=v===Z,P=lI(G);return f.jsxs("div",{className:`address-card-modern ${I?"active":""}`,children:[f.jsxs("div",{className:"address-header-modern",children:[f.jsxs("div",{className:"address-content",children:[f.jsx("div",{className:"address-number",children:oe+1}),f.jsxs("div",{className:"address-info",children:[f.jsx("div",{className:"address-title",title:G.address,children:G.address}),f.jsxs("div",{className:"address-meta",children:[f.jsxs("div",{className:"address-meta-item",children:[f.jsx("span",{children:"📍"}),f.jsxs("span",{children:["Index #",Z+1]})]}),G.lat&&G.lng&&f.jsxs("div",{className:"address-meta-item",children:[f.jsx("span",{children:"🌍"}),f.jsx("span",{children:"Coordinates ready"})]}),I&&r.activeStartTime&&f.jsx("div",{className:"address-meta-item",children:f.jsx(Jv,{startTime:r.activeStartTime})})]})]})]}),f.jsxs("div",{className:`address-status-badge ${I?"status-active":"status-pending"}`,children:[I&&f.jsx("span",{children:"●"}),I?"Active":"Pending"]})]}),f.jsxs("div",{className:"address-actions-modern",children:[f.jsxs("a",{className:"action-btn-modern btn-navigate",href:P,target:"_blank",rel:"noreferrer",title:"Open in Google Maps",onClick:()=>{},children:[f.jsx("span",{children:"🧭"}),f.jsx("span",{children:"Navigate"})]}),I?f.jsxs(f.Fragment,{children:[f.jsxs("button",{className:"action-btn-modern btn-complete",onClick:()=>{O(R!==Z?Z:null),U(""),B(""),te(null)},children:[f.jsx("span",{children:"✅"}),f.jsx("span",{children:"Complete"})]}),f.jsxs("button",{className:"action-btn-modern",style:{background:"var(--gray-100)",color:"var(--gray-600)"},onClick:()=>{window.confirm("Are you sure you want to cancel? Any tracked time will be lost.")&&n()},children:[f.jsx("span",{children:"❎"}),f.jsx("span",{children:"Cancel"})]})]}):f.jsxs("button",{className:"action-btn-modern btn-set-active",onClick:()=>t(Z),children:[f.jsx("span",{children:"▶️"}),f.jsx("span",{children:"Start"})]})]}),I&&R===Z&&f.jsxs("div",{className:"outcome-panel-modern",children:[f.jsx("div",{className:"outcome-header",children:f.jsx("span",{className:"outcome-title",children:"Select Outcome"})}),f.jsxs("div",{className:"outcome-buttons",children:[f.jsxs("button",{className:"outcome-btn outcome-done",disabled:ee===Z,onClick:()=>ue(Z,"Done"),title:"Mark as Done",children:[f.jsx("span",{className:"outcome-icon",children:"✅"}),f.jsx("span",{className:"outcome-label",children:"Done"})]}),f.jsxs("button",{className:"outcome-btn outcome-da",disabled:ee===Z,onClick:()=>ue(Z,"DA"),title:"Mark as DA",children:[f.jsx("span",{className:"outcome-icon",children:"🚫"}),f.jsx("span",{className:"outcome-label",children:"DA"})]}),f.jsxs("button",{className:"outcome-btn outcome-arr",onClick:()=>{O(null),se(Z)},title:"Create arrangement",children:[f.jsx("span",{className:"outcome-icon",children:"📅"}),f.jsx("span",{className:"outcome-label",children:"Arrangement"})]})]}),f.jsx("div",{className:"pif-section",children:f.jsxs("div",{className:"pif-input-group",children:[f.jsx("span",{className:"pif-label",children:"💰 PIF Amount:"}),f.jsx("input",{id:`pif-amount-${Z}`,name:`pifAmount-${Z}`,type:"number",step:"0.01",min:"0",inputMode:"decimal",className:"pif-input",placeholder:"£0.00",value:N,onChange:F=>U(F.target.value),autoComplete:"off",onKeyDown:F=>{if(F.key==="Enter"){const M=Number(N);if(!Number.isFinite(M)||M<=0){alert("Enter a valid PIF amount (e.g. 50)");return}te(Z)}}}),f.jsxs("button",{className:"outcome-btn outcome-pif",disabled:ee===Z,onClick:()=>{const F=Number(N);if(!Number.isFinite(F)||F<=0){alert("Enter a valid PIF amount (e.g. 50)");return}te(Z)},children:[f.jsx("span",{className:"outcome-icon",children:"💷"}),f.jsx("span",{className:"outcome-label",children:"Next"})]})]})}),ee===Z&&f.jsxs("div",{className:"outcome-loading",children:[f.jsx("span",{className:"spinner-small"}),f.jsx("span",{children:"Processing..."})]})]})]},Z)})}),ke!==null&&l&&d[ke]&&f.jsx(wm,{state:r,preSelectedAddressIndex:ke,onSave:async G=>{await l(G),ue(ke,"ARR"),se(null)},onCancel:()=>se(null),onComplete:ue,fullscreen:!0}),D!==null&&f.jsx("div",{className:"case-ref-modal-overlay",onClick:()=>te(null),children:f.jsxs("div",{className:"case-ref-modal",onClick:G=>G.stopPropagation(),children:[f.jsxs("div",{className:"case-ref-modal-header",children:[f.jsx("h3",{children:"📋 Enter Case Reference"}),f.jsx("button",{className:"close-btn",onClick:()=>te(null),children:"✕"})]}),f.jsxs("div",{className:"case-ref-modal-body",children:[f.jsxs("p",{children:["PIF Amount: ",f.jsxs("strong",{children:["£",Number(N).toFixed(2)]})]}),f.jsxs("div",{className:"case-ref-input-wrapper",children:[f.jsx("label",{htmlFor:"case-ref-input",children:"Case Reference Number"}),f.jsx("input",{id:"case-ref-input",type:"number",inputMode:"numeric",className:"case-ref-input",placeholder:"e.g. 123456",value:K,onChange:G=>B(G.target.value),autoComplete:"off",autoFocus:!0,onKeyDown:G=>{if(G.key==="Enter"){const Z=Number(K);if(!K||!K.trim()){alert("Please enter a case reference number");return}if(!Number.isFinite(Z)||Z<=0||!Number.isInteger(Z)){alert("Case reference must be a valid whole number");return}ue(D,"PIF",Number(N).toFixed(2),void 0,K.trim()),te(null),B(""),U("")}}})]})]}),f.jsxs("div",{className:"case-ref-modal-footer",children:[f.jsx("button",{className:"modal-btn modal-btn-cancel",onClick:()=>{te(null),B("")},children:"Cancel"}),f.jsx("button",{className:"modal-btn modal-btn-save",disabled:ee===D,onClick:()=>{const G=Number(K);if(!K||!K.trim()){alert("Please enter a case reference number");return}if(!Number.isFinite(G)||G<=0||!Number.isInteger(G)){alert("Case reference must be a valid whole number");return}ue(D,"PIF",Number(N).toFixed(2),void 0,K.trim()),te(null),B(""),U("")},children:ee===D?"Saving...":"Save PIF"})]})]})}),f.jsx("style",{children:`
        /* Elapsed Timer Styles */
        .elapsed-timer {
          display: inline-flex;
          align-items: center;
          gap: 0.25rem;
          padding: 0.25rem 0.5rem;
          background: var(--primary);
          color: white;
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.875rem;
          animation: pulse 2s ease-in-out infinite;
        }

        .timer-icon {
          font-size: 1rem;
        }

        .timer-value {
          font-variant-numeric: tabular-nums;
          min-width: 3rem;
          text-align: center;
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.85;
          }
        }

        /* View Toggle Styles */
        .view-toggle-container {
          display: flex;
          gap: 0.5rem;
          padding: 0.75rem;
          margin-bottom: 1rem;
          background: var(--surface);
          border: 1px solid var(--border);
          border-radius: var(--radius-lg);
        }

        .view-toggle-btn {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem 1rem;
          border: 2px solid var(--border);
          border-radius: var(--radius-md);
          background: var(--surface);
          color: var(--text-secondary);
          font-weight: 600;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .view-toggle-btn:hover:not(:disabled) {
          background: var(--gray-50);
          border-color: var(--primary);
        }

        .view-toggle-btn.active {
          background: var(--primary);
          border-color: var(--primary);
          color: white;
        }

        .view-toggle-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .badge-warning {
          font-size: 0.65rem;
          color: var(--warning);
          font-weight: normal;
        }

        /* Map View Styles */
        .map-view-container {
          height: 600px;
          max-height: calc(100vh - 300px);
          position: relative;
          border-radius: var(--radius-lg);
          overflow: hidden;
          border: 1px solid var(--border);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* Ensure Leaflet map respects container */
        .map-view-container .leaflet-container {
          border-radius: var(--radius-lg);
        }

        /* Map Reset Button */
        .map-reset-btn {
          position: absolute;
          top: 10px;
          right: 10px;
          z-index: 1000;
          padding: 0.5rem 1rem;
          background: var(--surface);
          color: var(--text-primary);
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.875rem;
          cursor: pointer;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
          transition: all 0.2s ease;
        }

        .map-reset-btn:hover {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
          transform: translateY(-1px);
          box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        }

        .map-reset-btn:active {
          transform: translateY(0);
        }

        /* Custom Numbered Markers */
        .custom-numbered-marker {
          background: transparent;
          border: none;
        }

        .marker-pin {
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .marker-pin::before {
          content: '';
          position: absolute;
          width: 36px;
          height: 36px;
          background: var(--primary);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          border: 3px solid white;
        }

        .marker-pin.marker-active::before {
          background: var(--success);
          animation: markerPulse 2s ease-in-out infinite;
        }

        @keyframes markerPulse {
          0%, 100% {
            transform: rotate(-45deg) scale(1);
          }
          50% {
            transform: rotate(-45deg) scale(1.1);
          }
        }

        .marker-number {
          position: relative;
          z-index: 1;
          color: white;
          font-weight: bold;
          font-size: 0.875rem;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
          transform: translateY(-2px);
        }

        /* Leaflet Popup Override for Dark Mode */
        .leaflet-popup-content-wrapper {
          background: var(--surface) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--border) !important;
          box-shadow: 0 3px 14px rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-tip {
          background: var(--surface) !important;
          border: 1px solid var(--border) !important;
        }

        .leaflet-popup-close-button {
          color: var(--text-primary) !important;
        }

        .leaflet-popup-close-button:hover {
          color: var(--primary) !important;
        }

        /* Map Popup Styles */
        .map-popup {
          min-width: 200px;
          padding: 0.5rem;
        }

        .popup-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid var(--border);
        }

        .popup-number {
          font-weight: bold;
          color: var(--primary);
          font-size: 1rem;
        }

        .popup-status {
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          font-size: 0.75rem;
          font-weight: 600;
        }

        .popup-status.status-active {
          background: var(--success);
          color: white;
        }

        .popup-status.status-pending {
          background: var(--gray-700);
          color: var(--gray-100);
        }

        .popup-address {
          margin-bottom: 0.75rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .popup-btn-start,
        .popup-btn-complete {
          width: 100%;
          padding: 0.5rem 1rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .popup-btn-start {
          background: var(--primary);
          color: white;
        }

        .popup-btn-start:hover {
          background: var(--primary-dark);
        }

        .popup-btn-complete {
          background: var(--success);
          color: white;
          margin-top: 0.5rem;
        }

        .popup-btn-complete:hover {
          background: var(--success-dark);
        }

        .popup-active-info {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .popup-active-info .elapsed-timer {
          justify-content: center;
          margin-bottom: 0.25rem;
        }

        /* Modern Outcome Panel Styles */
        .outcome-panel-modern {
          background: var(--gray-50);
          border: 2px solid var(--primary);
          border-radius: var(--radius-lg);
          padding: 1rem;
          margin-top: 1rem;
          animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .outcome-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .outcome-title {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-buttons {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .outcome-btn {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 0.25rem;
          padding: 0.75rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: var(--transition-normal);
          position: relative;
          overflow: hidden;
        }

        .outcome-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(100%);
          transition: transform 0.3s ease;
        }

        .outcome-btn:hover::before {
          transform: translateY(0);
        }

        .outcome-btn:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .outcome-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .outcome-icon {
          font-size: 1.25rem;
        }

        .outcome-label {
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-done {
          background: var(--success);
          color: white;
        }

        .outcome-da {
          background: var(--danger);
          color: white;
        }

        .outcome-arr {
          background: var(--warning);
          color: white;
        }

        .outcome-pif {
          background: var(--primary);
          color: white;
        }

        .pif-section {
          padding-top: 1rem;
          border-top: 1px solid var(--gray-200);
        }

        .pif-input-group {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .pif-label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .pif-input {
          flex: 1;
          padding: 0.625rem 0.75rem;
          border: 2px solid var(--gray-200);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
          font-weight: 600;
          text-align: right;
          transition: var(--transition-normal);
        }

        .pif-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        .outcome-loading {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem;
          color: var(--gray-600);
          font-size: 0.875rem;
        }

        .spinner-small {
          width: 16px;
          height: 16px;
          border: 2px solid var(--gray-300);
          border-top-color: var(--primary);
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .outcome-buttons {
            grid-template-columns: 1fr;
          }

          .pif-input-group {
            flex-direction: column;
            align-items: stretch;
          }

          .outcome-btn {
            flex-direction: row;
            justify-content: center;
            gap: 0.5rem;
          }
        }

        /* Case Reference Modal Styles */
        .case-ref-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        .case-ref-modal {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
          width: 90%;
          max-width: 450px;
          animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .case-ref-modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
        }

        .case-ref-modal-header h3 {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--gray-800);
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: var(--gray-500);
          cursor: pointer;
          padding: 0.25rem;
          line-height: 1;
          transition: var(--transition-normal);
        }

        .close-btn:hover {
          color: var(--gray-700);
          transform: scale(1.1);
        }

        .case-ref-modal-body {
          padding: 1.5rem;
        }

        .case-ref-modal-body p {
          margin: 0 0 1.5rem 0;
          font-size: 1rem;
          color: var(--gray-600);
        }

        .case-ref-modal-body strong {
          color: var(--primary);
          font-size: 1.125rem;
        }

        .case-ref-input-wrapper {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .case-ref-input-wrapper label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .case-ref-input {
          padding: 0.875rem 1rem;
          border: 2px solid var(--gray-300);
          border-radius: var(--radius-md);
          font-size: 1rem;
          font-weight: 600;
          transition: var(--transition-normal);
        }

        .case-ref-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 4px var(--primary-light);
        }

        .case-ref-modal-footer {
          display: flex;
          gap: 0.75rem;
          padding: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .modal-btn {
          flex: 1;
          padding: 0.875rem 1.5rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.938rem;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .modal-btn-cancel {
          background: var(--gray-100);
          color: var(--gray-700);
        }

        .modal-btn-cancel:hover {
          background: var(--gray-200);
        }

        .modal-btn-save {
          background: var(--primary);
          color: white;
        }

        .modal-btn-save:hover:not(:disabled) {
          background: var(--primary-dark);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .modal-btn-save:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        @media (max-width: 768px) {
          .case-ref-modal {
            width: 95%;
            margin: 1rem;
          }

          .case-ref-modal-header,
          .case-ref-modal-body,
          .case-ref-modal-footer {
            padding: 1rem;
          }
        }
      `})]})},uI=Y.memo(cI),dI="Europe/London";function xs(e,r=dI){const t=e.toLocaleDateString("en-GB",{timeZone:r,year:"numeric"}),n=e.toLocaleDateString("en-GB",{timeZone:r,month:"2-digit"}),a=e.toLocaleDateString("en-GB",{timeZone:r,day:"2-digit"});return t+"-"+n+"-"+a}function L0(e){const r=e.split("-");return new Date(Number(r[0]),Number(r[1])-1,Number(r[2]))}function Md(e,r){const t=new Date(e.getTime());return t.setDate(t.getDate()+r),t}function Dd(e){return new Date(e.getFullYear(),e.getMonth(),1)}function o0(e,r){return e===r}function fI(e,r,t){return e>=r&&e<=t}function Qv(e){return(e/3600).toFixed(2)}function hI(e){const r=e;if(typeof r.durationSeconds=="number")return Math.max(0,r.durationSeconds);if(e.start&&e.end)try{const t=new Date(e.start).getTime(),n=new Date(e.end).getTime();if(isFinite(t)&&isFinite(n)&&n>t)return Math.floor((n-t)/1e3)}catch(t){console.warn("Failed to calculate duration:",t)}return 0}function mI(e,r){if(!e||!r)return[];const t=L0(e),n=L0(r);if(!(t<=n))return[e];const a=[];let l=new Date(t.getTime());for(;l<=n;)a.push(xs(l)),l=Md(l,1);return a}function pI({startKey:e,endKey:r,onChange:t}){const n=L0(r||e||xs(new Date)),[a,l]=Y.useState(Dd(n)),[c,d]=Y.useState(!1);function m(R){const O=Dd(R),U=(O.getDay()+6)%7,K=Md(O,-U),B=[];for(let D=0;D<42;D++){const te=Md(K,D);B.push({key:xs(te),inMonth:te.getMonth()===R.getMonth(),date:te})}return B}const v=m(a),x=a.toLocaleDateString("en-GB",{month:"long"})+" "+String(a.getFullYear()),y=e<=r?e:r,k=e<=r?r:e,E=xs(new Date);function b(){l(new Date(a.getFullYear(),a.getMonth()-1,1))}function S(){l(new Date(a.getFullYear(),a.getMonth()+1,1))}function A(R){if(!c){t(R,R),d(!0);return}let O=e||R,N=R;if(N<O){const U=O;O=N,N=U}t(O,N),d(!1)}return f.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[f.jsx("button",{className:"btn btn-ghost",onClick:b,"aria-label":"Previous month",children:"Prev"}),f.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:x}),f.jsx("button",{className:"btn btn-ghost",onClick:S,"aria-label":"Next month",children:"Next"})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,fontSize:12,color:"var(--text-secondary)",textAlign:"center",marginBottom:4},children:[f.jsx("div",{children:"Mon"}),f.jsx("div",{children:"Tue"}),f.jsx("div",{children:"Wed"}),f.jsx("div",{children:"Thu"}),f.jsx("div",{children:"Fri"}),f.jsx("div",{children:"Sat"}),f.jsx("div",{children:"Sun"})]}),f.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:v.map(R=>{const O=fI(R.key,y,k),N=o0(R.key,e),U=o0(R.key,r),K=o0(R.key,E),B={padding:"0.5rem 0",borderRadius:8,border:"1px solid var(--border-light)",background:O?"var(--surface-strong)":"var(--surface)",textAlign:"center",cursor:"pointer",opacity:R.inMonth?1:.45,position:"relative",userSelect:"none"},D={position:"absolute",top:6,right:6,width:6,height:6,borderRadius:6,background:K?"currentColor":"transparent",opacity:K?.7:0},te={position:"absolute",inset:0,borderRadius:8,border:N||U?"2px solid var(--primary, #4f46e5)":"2px solid transparent",pointerEvents:"none"};return f.jsxs("div",{style:B,title:R.key,onClick:()=>A(R.key),children:[f.jsx("div",{style:{fontWeight:N||U?700:500,color:"var(--text-primary)"},children:String(R.date.getDate())}),f.jsx("div",{style:D}),f.jsx("div",{style:te})]},R.key)})}),f.jsxs("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:[f.jsx("button",{className:"btn btn-ghost",onClick:()=>{const R=xs(new Date);t(R,R),l(Dd(new Date)),d(!1)},children:"Today"}),f.jsx("button",{className:"btn btn-ghost",onClick:()=>{const R=new Date,O=Md(new Date,-6);t(xs(O),xs(R)),l(Dd(R)),d(!1)},children:"Last 7 days"})]})]})}function gI(e,r){const t=e,n=[t.date,t.day,t.at,t.timestamp,t.completedAt,t.created_at];for(const l of n){if(!l)continue;const c=new Date(l);if(!Number.isNaN(c.getTime()))return c.toISOString().slice(0,10)}const a=new Set(r.map(l=>l.date));return a.size===1&&Array.from(a)[0]||null}function vI({state:e,onChangeOutcome:r,onAddArrangement:t,onComplete:n}){const{addresses:a,completions:l,daySessions:c,arrangements:d}=e,[m,v]=Y.useState(null),[x,y]=Y.useState(""),[k,E]=Y.useState(null),b=c.length>0?c[c.length-1].date:xs(new Date),[S,A]=Y.useState(b),[R,O]=Y.useState(b),[N,U]=Y.useState(!1),K=Y.useMemo(()=>{const se=new Map;for(const ue of c){const j=ue.date;if(!j)continue;const G=se.get(j)||0;se.set(j,G+hI(ue))}return se},[c]),B=Y.useMemo(()=>{const se=new Map;return l.forEach((ue,j)=>{const G=gI(ue,c);if(!G)return;const Z=se.get(G);Z?Z.push(j):se.set(G,[j])}),se},[l,c]),D=mI(S,R);let te=0,ee=0,ve=0,me=0;D.forEach(se=>{te+=K.get(se)||0;const ue=B.get(se)||[];ee+=ue.length,ve+=ue.map(j=>l[j]).filter(j=>j.outcome==="PIF").length,me+=ue.map(j=>l[j]).filter(j=>j.outcome==="DA").length});const[J,ce]=Y.useState({});function ke(se){ce(ue=>({...ue,[se]:!ue[se]}))}return f.jsxs("div",{children:[f.jsx("div",{style:{marginBottom:"0.9rem"},children:f.jsx(pI,{startKey:S,endKey:R,onChange:(se,ue)=>{A(se),O(ue)}})}),f.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"12px",padding:"1rem",boxShadow:"var(--shadow-sm)",marginBottom:"1rem"},children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",marginBottom:8,flexWrap:"wrap"},children:[f.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:"Summary "+(S===R?"("+S+")":"("+S+" -> "+R+")")}),f.jsx("button",{className:"btn btn-ghost",onClick:()=>U(se=>!se),children:N?"Hide details":"View details"})]}),f.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[f.jsxs("span",{className:"pill",children:["Hours ",Qv(te)]}),f.jsxs("span",{className:"pill pill-done",children:["Completed ",ee]}),f.jsxs("span",{className:"pill pill-pif",children:["PIF ",ve]}),f.jsxs("span",{className:"pill pill-da",children:["DA ",me]})]})]}),N&&f.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:D.map(se=>{const ue=K.get(se)||0,j=B.get(se)||[],G=j.map(P=>l[P]).filter(P=>P.outcome==="PIF").length,Z=j.map(P=>l[P]).filter(P=>P.outcome==="DA").length,oe=j.map(P=>l[P]).filter(P=>P.outcome==="ARR").length,I=j.length;return f.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[f.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},children:[f.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",flexWrap:"wrap"},children:[f.jsx("strong",{children:se}),f.jsxs("span",{className:"pill",children:["Hours ",Qv(ue)]}),f.jsxs("span",{className:"pill pill-done",children:["Completed ",I]}),f.jsxs("span",{className:"pill pill-pif",children:["PIF ",G]}),f.jsxs("span",{className:"pill pill-da",children:["DA ",Z]}),oe>0&&f.jsxs("span",{className:"pill pill-arr",children:["ARR ",oe]})]}),f.jsx("button",{className:"btn btn-ghost",onClick:()=>ke(se),children:J[se]?"Hide":"View"})]}),J[se]&&f.jsx("div",{style:{marginTop:"0.75rem"},children:j.length===0?f.jsx("div",{style:{fontSize:14,color:"var(--text-secondary)"},children:"No entries for this day."}):f.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:j.map(P=>{const F=l[P],M=a[F.index],H=M&&M.address||M&&M.name||(typeof F.index=="number"?"Address #"+F.index:"Address"),X=F.outcome,fe=F.arrangementId?d.find(ge=>ge.id===F.arrangementId):null;return f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",alignItems:"center",border:"1px dashed var(--border-light)",borderRadius:10,padding:"0.5rem 0.75rem"},children:[f.jsxs("div",{style:{minWidth:0},children:[f.jsx("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-primary)"},children:H}),f.jsxs("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:["Index "+String(F.index),F.outcome==="PIF"&&f.jsx("span",{style:{marginLeft:8,display:"inline-flex",alignItems:"center",gap:4},children:m===P?f.jsxs(f.Fragment,{children:[f.jsx("span",{children:"· £"}),f.jsx("label",{htmlFor:`pif-amount-${P}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"PIF Amount"}),f.jsx("input",{id:`pif-amount-${P}`,name:"pifAmount",type:"number",step:"0.01",min:"0",inputMode:"decimal",style:{width:70,padding:"2px 4px",fontSize:12,border:"1px solid var(--border)",borderRadius:3,background:"var(--surface)"},value:x,onChange:ge=>y(ge.target.value),onKeyDown:ge=>{if(ge.key==="Enter"){const ye=parseFloat(x);isFinite(ye)&&ye>=0&&(r(P,"PIF",ye.toFixed(2)),v(null),y(""))}else ge.key==="Escape"&&(v(null),y(""))},autoFocus:!0}),f.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--success)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{const ge=parseFloat(x);isFinite(ge)&&ge>=0&&(r(P,"PIF",ge.toFixed(2)),v(null),y(""))},children:"✓"}),f.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--danger)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{v(null),y("")},children:"✕"})]}):f.jsxs(f.Fragment,{children:[f.jsxs("span",{children:["· £",F.amount||"0.00"]}),f.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--primary)",color:"white",border:"none",borderRadius:3,cursor:"pointer",marginLeft:4},onClick:()=>{v(P),y(F.amount||"")},title:"Edit PIF amount",children:"✏️"}),F.caseReference&&f.jsxs("span",{style:{marginLeft:8},children:["· Ref: ",F.caseReference]})]})}),fe&&f.jsxs(f.Fragment,{children:[f.jsx("br",{}),f.jsxs("span",{style:{color:"var(--primary)",fontSize:"0.75rem"},children:["📅 From arrangement",fe.customerName&&` (${fe.customerName})`,F.outcome==="Done"&&" • Defaulted",F.outcome==="PIF"&&fe.recurrenceType&&fe.recurrenceType!=="none"&&` • ${fe.recurrenceType==="weekly"?"Weekly":"Monthly"} payment`]})]}),F.timeSpentSeconds!==void 0&&F.timeSpentSeconds>0&&f.jsxs(f.Fragment,{children:[!fe&&f.jsx("br",{}),f.jsxs("span",{style:{color:"var(--gray-600)",fontSize:"0.75rem",marginLeft:fe?8:0},children:[fe&&" • ","⏱️ ",Math.floor(F.timeSpentSeconds/60),"m ",F.timeSpentSeconds%60,"s"]})]})]})]}),f.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[f.jsx("label",{htmlFor:`outcome-${P}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"Outcome"}),f.jsxs("select",{id:`outcome-${P}`,name:`outcome-${P}`,value:X||"",onChange:ge=>{const ye=ge.target.value;ye==="ARR"&&t?E({completionIndex:P,addressIndex:F.index}):r(P,ye,F.amount)},className:"input",style:{padding:"0.25rem 0.5rem",height:32},children:[f.jsx("option",{value:"",children:"-"}),f.jsx("option",{value:"Done",children:fe?"Done (Defaulted)":"Done"}),f.jsx("option",{value:"PIF",children:fe?"PIF (Arrangement)":"PIF"}),f.jsx("option",{value:"DA",children:"DA"}),f.jsx("option",{value:"ARR",children:"ARR"})]})]})]},P)})})})]},se)})}),k&&t&&n&&f.jsx(wm,{state:e,preSelectedAddressIndex:k.addressIndex,onSave:async se=>{await t(se),r(k.completionIndex,"ARR"),E(null)},onCancel:()=>E(null),onComplete:n,fullscreen:!0})]})}const xI=()=>{const[e,r]=Y.useState(!1),t=Y.useRef(null);return{isLoading:e,executeBackup:async l=>{if(e){console.warn("Backup already in progress, ignoring duplicate request");return}r(!0),t.current=setTimeout(()=>{console.error("Backup timeout reached - forcing reset"),r(!1)},6e4);try{await l(),console.log("Backup completed successfully")}catch(c){throw console.error("Backup failed:",c),c}finally{t.current&&(clearTimeout(t.current),t.current=null),r(!1)}},forceReset:()=>{console.warn("Force resetting backup loading state"),t.current&&(clearTimeout(t.current),t.current=null),r(!1)}}},Ly=["Reminder: Please arrange payment by end of day to avoid further action.","Friendly reminder: Your arrangement is due. Contact us to confirm.","Action required: Settle outstanding balance today for compliance.","Update: Payment arrangement needed. Reply to reschedule if required."],Od={backupOnEndOfDay:!1,reminderText:Ly[0],darkMode:!1,pushNotifications:!0,autoSyncOnStart:!0},ex="navigator-web:settings",Ry=()=>{const[e,r]=Y.useState(()=>{if(typeof window<"u")try{const m=localStorage.getItem(ex);return m?{...Od,...JSON.parse(m)}:Od}catch{return Od}return Od});Y.useEffect(()=>{typeof window<"u"&&localStorage.setItem(ex,JSON.stringify(e))},[e]),Y.useEffect(()=>{e.darkMode?(document.documentElement.classList.add("dark-mode"),document.body.style.background="linear-gradient(135deg, #1f2937 0%, #111827 100%)"):(document.documentElement.classList.remove("dark-mode"),document.body.style.background="linear-gradient(135deg, #667eea 0%, #764ba2 100%)")},[e.darkMode]);const t=m=>{r(v=>({...v,...m}))};return{settings:e,updateSettings:t,toggleBackup:()=>t({backupOnEndOfDay:!e.backupOnEndOfDay}),toggleDarkMode:()=>t({darkMode:!e.darkMode}),togglePushNotifications:()=>t({pushNotifications:!e.pushNotifications}),toggleAutoSync:()=>t({autoSyncOnStart:!e.autoSyncOnStart}),updateReminderText:m=>t({reminderText:m}),predefinedReminders:Ly}};function tx(e,r){const[t,n,a]=e.split("-").map(Number),[l,c]=r.split(":").map(Number);try{return new Date(t,(n||1)-1,a||1,l||0,c||0).toISOString()}catch{return""}}function rx(e){if(!e)return"—";try{return new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Europe/London"})}catch{return"—"}}function Fd(e){if(!e)return"";try{const r=new Date(e),t=String(r.getHours()).padStart(2,"0"),n=String(r.getMinutes()).padStart(2,"0");return`${t}:${n}`}catch{return""}}function nx(e){if(!e)return"";try{const r=new Date(e),t=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${t}-${n}-${a}`}catch{return""}}function yI({sessions:e,completions:r,startDay:t,endDay:n,onEditStart:a,onEditEnd:l,onBackup:c}){const{settings:d}=Ry(),{isLoading:m,executeBackup:v,forceReset:x}=xI(),y=new Date().toISOString().slice(0,10),k=e.filter(j=>j.date===y),E=k.find(j=>!j.end)||null,b=E||k.slice().sort((j,G)=>{const Z=new Date(j.start||j.date+"T00:00:00.000Z").getTime();return new Date(G.start||G.date+"T00:00:00.000Z").getTime()-Z})[0],S=!!E,A=async()=>{try{d.backupOnEndOfDay&&c&&await v(c),n()}catch(j){console.error("Failed to complete backup during end day:",j),n()}},O=r.filter(j=>(j.timestamp||"").slice(0,10)===y).reduce((j,G)=>((G.outcome==="PIF"||G.outcome==="DA"||G.outcome==="Done"||G.outcome==="ARR")&&(j[G.outcome]+=1),j),{PIF:0,DA:0,Done:0,ARR:0}),[N,U]=Y.useState(!1),[K,B]=Y.useState(y),[D,te]=Y.useState(()=>{if(b?.start)return Fd(b.start);const j=new Date;return`${String(j.getHours()).padStart(2,"0")}:${String(j.getMinutes()).padStart(2,"0")}`});Y.useEffect(()=>{if(b?.start)B(nx(b.start)||b.date),te(Fd(b.start));else{B(y);const j=new Date;te(`${String(j.getHours()).padStart(2,"0")}:${String(j.getMinutes()).padStart(2,"0")}`)}},[b?.start,b?.date,y]);const ee=Y.useCallback(()=>{const j=tx(K,D);j&&a(j),U(!1)},[K,D,a]),[ve,me]=Y.useState(!1),[J,ce]=Y.useState(y),[ke,se]=Y.useState(()=>{if(b?.end)return Fd(b.end);const j=new Date;return`${String(j.getHours()).padStart(2,"0")}:${String(j.getMinutes()).padStart(2,"0")}`});Y.useEffect(()=>{if(b?.end)ce(nx(b.end)||b.date),se(Fd(b.end));else{ce(y);const j=new Date;se(`${String(j.getHours()).padStart(2,"0")}:${String(j.getMinutes()).padStart(2,"0")}`)}},[b?.end,b?.date,y]);const ue=Y.useCallback(()=>{const j=tx(J,ke);j&&l(j),me(!1)},[J,ke,l]);return f.jsxs("div",{className:`day-panel-modern ${S?"day-panel-active":""}`,children:[f.jsxs("div",{className:"day-panel-header",children:[f.jsxs("div",{className:"day-status",children:[f.jsx("div",{className:"day-status-icon",children:S?"🟢":b?"🔴":"⚫"}),f.jsxs("div",{className:"day-status-text",children:[f.jsx("div",{className:"day-status-title",children:S?"Day Running":b?"Day Completed":"No Session Today"}),f.jsx("div",{className:"day-status-subtitle",children:b?.start?f.jsxs(f.Fragment,{children:[rx(b.start),b?.end&&f.jsxs(f.Fragment,{children:[" → ",rx(b.end)]}),S&&!b?.end&&f.jsxs(f.Fragment,{children:[" • ",f.jsx("span",{style:{color:"var(--success)"},children:"Active"})]})]}):"Click 'Start Day' to begin tracking"})]})]}),f.jsxs("div",{className:"day-stats-modern",children:[f.jsxs("div",{className:"stat-pill stat-pill-pif",children:[f.jsx("span",{className:"stat-number",children:O.PIF}),f.jsx("span",{className:"stat-label",children:"PIF"})]}),f.jsxs("div",{className:"stat-pill stat-pill-done",children:[f.jsx("span",{className:"stat-number",children:O.Done}),f.jsx("span",{className:"stat-label",children:"Done"})]}),f.jsxs("div",{className:"stat-pill stat-pill-da",children:[f.jsx("span",{className:"stat-number",children:O.DA}),f.jsx("span",{className:"stat-label",children:"DA"})]}),f.jsxs("div",{className:"stat-pill stat-pill-arr",children:[f.jsx("span",{className:"stat-number",children:O.ARR}),f.jsx("span",{className:"stat-label",children:"ARR"})]})]})]}),f.jsxs("div",{className:"day-panel-actions",children:[f.jsx("div",{className:"primary-actions",children:S?f.jsxs("button",{className:"btn btn-danger btn-modern",onClick:A,disabled:m,children:[f.jsx("span",{className:"btn-icon",children:m?"⏳":"⏹️"}),m?"Ending Day...":"End Day"]}):f.jsxs("button",{className:"btn btn-primary btn-modern",onClick:t,children:[f.jsx("span",{className:"btn-icon",children:"▶️"}),"Start Day"]})}),f.jsxs("div",{className:"edit-actions",children:[N?f.jsxs("div",{className:"day-edit-group",children:[f.jsx("input",{id:"start-date",name:"startDate",type:"date",className:"input input-sm",value:K,onChange:j=>B(j.target.value),autoComplete:"off"}),f.jsx("input",{id:"start-time",name:"startTime",type:"time",className:"input input-sm",value:D,onChange:j=>te(j.target.value),autoComplete:"off"}),f.jsx("button",{className:"btn btn-primary btn-sm",onClick:ee,children:"💾"}),f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>U(!1),children:"✕"})]}):f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>U(!0),title:"Edit today's start time",children:"✏️ Edit start"}),ve?f.jsxs("div",{className:"day-edit-group",children:[f.jsx("input",{id:"end-date",name:"endDate",type:"date",className:"input input-sm",value:J,onChange:j=>ce(j.target.value),autoComplete:"off"}),f.jsx("input",{id:"end-time",name:"endTime",type:"time",className:"input input-sm",value:ke,onChange:j=>se(j.target.value),autoComplete:"off"}),f.jsx("button",{className:"btn btn-primary btn-sm",onClick:ue,children:"💾"}),f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>me(!1),children:"✕"})]}):f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>me(!0),title:"Edit today's finish time",children:"✏️ Edit finish"})]})]}),f.jsx(_m,{isOpen:m,onClose:()=>{console.warn("Emergency backup escape triggered by user"),x()},title:"Backing up data",showCloseButton:!0,size:"sm",children:f.jsx("div",{className:"backup-loading-modal",children:f.jsxs("div",{className:"backup-loading-content",children:[f.jsx(RA,{size:"lg"}),f.jsx("h3",{className:"backup-loading-title",children:"Backing up data, please wait..."}),f.jsx("p",{className:"backup-loading-message",children:"This usually takes 5-15 seconds. If stuck for more than 20 seconds, you can close this dialog to continue."}),f.jsx("div",{className:"backup-loading-warning",style:{marginTop:"1rem",fontSize:"0.9rem",color:"var(--warning)",textAlign:"center"},children:"⚠️ If backup appears stuck, click the ✕ button to escape"})]})})})]})}const _I=function({state:r,onAddArrangement:t,onUpdateArrangement:n,onDeleteArrangement:a,onAddAddress:l,onComplete:c,autoCreateForAddress:d,onAutoCreateHandled:m}){const[v,x]=Y.useState("thisWeek"),[y,k]=Y.useState(!1),[E,b]=Y.useState(null),[S,A]=Y.useState({saving:!1,updating:!1,deleting:new Set,markingPaid:new Set,markingDefaulted:new Set,sendingReminder:new Set}),[R,O]=Y.useState(new Set),N=se=>{if(!se)return"";let ue=se.replace(/[^\d+]/g,"");return ue.startsWith("0")||ue.startsWith("+44")||ue.startsWith("44")?ue:ue.length===10&&ue.startsWith("7")?"0"+ue:ue},U=async se=>{if(!se.phoneNumber){alert("No phone number available for this arrangement.");return}A(ue=>({...ue,sendingReminder:new Set([...ue.sendingReminder,se.id])}));try{const ue={id:"temp",arrangementId:se.id,type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},j=Q1(se,ue,r.reminderSettings),Z=`sms:${N(se.phoneNumber)}?body=${encodeURIComponent(j)}`;window.location.href=Z;const oe=new Date().toISOString();await n(se.id,{lastReminderSent:oe,reminderCount:(se.reminderCount||0)+1,updatedAt:oe}),O(I=>new Set([...I,se.id])),setTimeout(()=>{O(I=>{const P=new Set(I);return P.delete(se.id),P})},3e3)}catch(ue){console.error("Failed to send reminder:",ue),alert("Failed to update reminder information. Please try again.")}finally{A(ue=>({...ue,sendingReminder:new Set([...ue.sendingReminder].filter(j=>j!==se.id))}))}};Y.useEffect(()=>{d!=null&&(k(!0),m?.())},[d,m]);const K=Y.useMemo(()=>{const se=new Date,ue=Tl(se,{weekStartsOn:1}),j=YA(se,{weekStartsOn:1});let G=r.arrangements;return v==="thisWeek"?G=r.arrangements.filter(Z=>{const oe=fa(Z.scheduledDate);return XP(oe,{start:ue,end:j})&&Z.status!=="Completed"&&Z.status!=="Cancelled"}):G=r.arrangements.filter(Z=>Z.status!=="Completed"&&Z.status!=="Cancelled"),G.sort((Z,oe)=>{const I=fa(Z.scheduledDate).getTime(),P=fa(oe.scheduledDate).getTime();if(I!==P)return I-P;const F=Z.scheduledTime||"00:00",M=oe.scheduledTime||"00:00";return F.localeCompare(M)})},[r.arrangements,v]),B=Y.useMemo(()=>{const se=new Map;return K.forEach(ue=>{const j=ue.scheduledDate;se.has(j)||se.set(j,[]),se.get(j).push(ue)}),Array.from(se.entries()).sort((ue,j)=>ue[0].localeCompare(j[0]))},[K]),D=Y.useMemo(()=>{const se=K.length,ue=new Date().toISOString().slice(0,10),j=K.filter(oe=>oe.scheduledDate===ue).length,G=K.filter(oe=>{const I=fa(oe.scheduledDate);return YP(I)&&oe.status==="Scheduled"}).length,Z=K.reduce((oe,I)=>{if(I.amount&&I.status!=="Completed"){const P=parseFloat(I.amount);return oe+(isNaN(P)?0:P)}return oe},0);return{total:se,todayCount:j,overdue:G,totalAmountDue:Z}},[K]),te=se=>{switch(se){case"Scheduled":return"📅";case"Confirmed":return"✅";case"Completed":return"🎉";case"Cancelled":return"❌";case"Missed":return"⚠️"}},ee=se=>{const ue=fa(se),j=new Date,G=mm(j,1);return xv(ue,j)?"Today":xv(ue,G)?"Tomorrow":Qd(ue,"EEEE, d MMM yyyy")},ve=(se,ue,j=1)=>{const G=new Date(se);switch(ue){case"weekly":G.setDate(G.getDate()+7*j);break;case"biweekly":G.setDate(G.getDate()+14);break;case"monthly":G.setMonth(G.getMonth()+j);break;default:return se}return G.toISOString().slice(0,10)},me=async se=>{const ue=r.arrangements.find(j=>j.id===se);ue&&(n(se,{status:"Completed",updatedAt:new Date().toISOString()}),c(ue.addressIndex,"Done",void 0,ue.id))},J=async(se,ue)=>{const j=r.arrangements.find(I=>I.id===se);if(!j)return;const G=(j.paymentsMade||0)+1,Z=G>=(j.totalPayments||1),oe=j.recurrenceType&&j.recurrenceType!=="none";if(n(se,{status:"Completed",amount:ue,paymentsMade:G,updatedAt:new Date().toISOString()}),c(j.addressIndex,"PIF",ue,j.id),oe&&!Z){const I=ve(j.scheduledDate,j.recurrenceType,j.recurrenceInterval||1),P=G+1,F={addressIndex:j.addressIndex,address:j.address,customerName:j.customerName,phoneNumber:j.phoneNumber,scheduledDate:I,scheduledTime:j.scheduledTime,status:"Scheduled",notes:j.notes?`${j.notes} (Payment ${P}/${j.totalPayments})`:`Payment ${P}/${j.totalPayments}`,amount:j.amount,recurrenceType:j.recurrenceType,recurrenceInterval:j.recurrenceInterval,totalPayments:j.totalPayments,paymentsMade:G,parentArrangementId:j.parentArrangementId||j.id};await t(F)}},ce=async se=>{A(ue=>({...ue,saving:!0}));try{if(se.addressIndex<0||se.addressIndex>=r.addresses.length)throw new Error("Selected address is no longer valid. Please refresh and try again.");if(se.initialPaymentAmount&&parseFloat(se.initialPaymentAmount)>0){const j=await t(se);if(await new Promise(Z=>setTimeout(Z,100)),!r.arrangements.find(Z=>Z.id===j))throw new Error("Arrangement was created but not yet available. Please refresh and mark the payment manually.");await J(j,se.initialPaymentAmount)}else{await t(se);try{c(se.addressIndex,"ARR")}catch(j){console.error("Error recording ARR completion:",j),alert("Arrangement created successfully, but there was an issue recording the completion. You may need to manually mark this address as ARR.")}}k(!1),b(null)}catch(ue){console.error("Error saving arrangement:",ue),alert(`Failed to save arrangement: ${ue instanceof Error?ue.message:"Please try again."}`)}finally{A(ue=>({...ue,saving:!1}))}},ke=async(se,ue)=>{A(j=>({...j,updating:!0}));try{await n(se,ue),b(null)}catch(j){console.error("Error updating arrangement:",j),alert("Failed to update arrangement. Please try again.")}finally{A(j=>({...j,updating:!1}))}};return f.jsxs("div",{className:"arrangements-wrap",children:[f.jsxs("div",{className:"top-row",children:[f.jsxs("div",{className:"stat-item",children:[f.jsx("div",{className:"stat-label",children:"📋 Due"}),f.jsx("div",{className:"stat-value",children:D.total})]}),f.jsxs("div",{className:"stat-item",children:[f.jsx("div",{className:"stat-label",children:"📅 Today"}),f.jsx("div",{className:"stat-value",style:{color:D.todayCount>0?"var(--warning)":"var(--text-primary)"},children:D.todayCount})]}),D.overdue>0&&f.jsxs("div",{className:"stat-item",children:[f.jsx("div",{className:"stat-label",children:"⚠️ Overdue"}),f.jsx("div",{className:"stat-value",style:{color:"var(--danger)"},children:D.overdue})]}),D.totalAmountDue>0&&f.jsxs("div",{className:"stat-item",children:[f.jsx("div",{className:"stat-label",children:"💰 Total Due"}),f.jsxs("div",{className:"stat-value",style:{color:"var(--success)"},children:["£",D.totalAmountDue.toFixed(2)]})]}),f.jsx("div",{className:"stat-actions",children:f.jsxs("div",{className:"btn-group",children:[f.jsx("button",{className:`btn ${v==="thisWeek"?"btn-primary":"btn-ghost"}`,onClick:()=>x("thisWeek"),children:"📅 This Week"}),f.jsx("button",{className:`btn ${v==="all"?"btn-primary":"btn-ghost"}`,onClick:()=>x("all"),children:"📋 All Pending"}),f.jsx("button",{className:"btn btn-success",onClick:()=>k(!0),children:"➕ Add Arrangement"})]})})]}),(y||E)&&f.jsx(wm,{state:r,arrangement:E?r.arrangements.find(se=>se.id===E):void 0,preSelectedAddressIndex:d,onAddAddress:l,onSave:E?se=>ke(E,se):ce,onCancel:()=>{k(!1),b(null)},isLoading:S.saving||S.updating,onComplete:c,fullscreen:!0}),f.jsx("div",{className:"days-list",children:B.length===0?f.jsxs("div",{className:"empty-box",children:[f.jsxs("div",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:["📅 No payment arrangements ",v==="thisWeek"?"due this week":"pending"]}),f.jsx("div",{style:{fontSize:"0.875rem",opacity:.75},children:v==="thisWeek"?"No payment arrangements are scheduled for this week":"No pending payment arrangements found"})]}):B.map(([se,ue])=>f.jsxs("div",{className:"day-card fade-in-up",children:[f.jsx("div",{className:"day-header",children:f.jsxs("div",{children:[f.jsx("div",{className:"day-title",children:ee(se)}),f.jsxs("div",{className:"muted",children:[ue.length," payment",ue.length===1?"":"s"," due",ue.some(j=>j.amount)&&f.jsxs(f.Fragment,{children:[" • £",ue.reduce((j,G)=>{const Z=parseFloat(G.amount||"0");return j+(isNaN(Z)?0:Z)},0).toFixed(2)," total"]})]})]})}),f.jsx("div",{className:"arrangements-list",children:ue.map(j=>f.jsxs("div",{className:"arrangement-card-modern",children:[f.jsxs("div",{className:"arrangement-card-header",children:[f.jsxs("div",{className:"arrangement-primary-info",children:[f.jsxs("div",{className:"arrangement-address-modern",children:[f.jsxs("span",{className:"address-index",children:["#",j.addressIndex+1]}),f.jsx("span",{className:"address-text",children:j.address})]}),j.customerName&&f.jsxs("div",{className:"arrangement-customer-modern",children:[f.jsx("span",{className:"customer-icon",children:"👤"}),f.jsx("span",{className:"customer-name",children:j.customerName})]})]}),f.jsx("div",{className:"arrangement-status-modern",children:f.jsxs("span",{className:`status-badge-modern status-${j.status.toLowerCase()}`,children:[f.jsx("span",{className:"status-icon",children:te(j.status)}),f.jsx("span",{className:"status-text",children:j.status})]})})]}),f.jsx("div",{className:"arrangement-card-body",children:f.jsxs("div",{className:"arrangement-details-grid",children:[f.jsxs("div",{className:"detail-item",children:[f.jsx("span",{className:"detail-icon",children:"📅"}),f.jsxs("div",{className:"detail-content",children:[f.jsx("span",{className:"detail-label",children:"Date"}),f.jsx("span",{className:"detail-value",children:j.scheduledDate})]})]}),j.scheduledTime&&f.jsxs("div",{className:"detail-item",children:[f.jsx("span",{className:"detail-icon",children:"🕐"}),f.jsxs("div",{className:"detail-content",children:[f.jsx("span",{className:"detail-label",children:"Time"}),f.jsx("span",{className:"detail-value",children:j.scheduledTime})]})]}),j.amount&&f.jsxs("div",{className:"detail-item",children:[f.jsx("span",{className:"detail-icon",children:"💰"}),f.jsxs("div",{className:"detail-content",children:[f.jsx("span",{className:"detail-label",children:"Amount"}),f.jsxs("span",{className:"detail-value amount-value",children:["£",j.amount]})]})]}),j.phoneNumber&&f.jsxs("div",{className:"detail-item",children:[f.jsx("span",{className:"detail-icon",children:"📞"}),f.jsxs("div",{className:"detail-content",children:[f.jsx("span",{className:"detail-label",children:"Phone"}),f.jsx("a",{href:`tel:${j.phoneNumber}`,className:"detail-value phone-link",children:j.phoneNumber})]})]}),j.notes&&f.jsxs("div",{className:"detail-item detail-notes",children:[f.jsx("span",{className:"detail-icon",children:"📝"}),f.jsxs("div",{className:"detail-content",children:[f.jsx("span",{className:"detail-label",children:"Notes"}),f.jsx("span",{className:"detail-value",children:j.notes})]})]}),j.recurrenceType&&j.recurrenceType!=="none"&&f.jsxs("div",{className:"detail-item",children:[f.jsx("span",{className:"detail-icon",children:"🔄"}),f.jsxs("div",{className:"detail-content",children:[f.jsx("span",{className:"detail-label",children:"Recurrence"}),f.jsxs("span",{className:"detail-value",children:[j.recurrenceType==="weekly"?"Weekly":j.recurrenceType==="biweekly"?"Bi-weekly":j.recurrenceType==="monthly"?"Monthly":j.recurrenceType,j.recurrenceInterval&&j.recurrenceInterval>1&&j.recurrenceType!=="biweekly"&&` (every ${j.recurrenceInterval})`,f.jsxs("div",{className:"recurrence-progress",children:["Payment ",(j.paymentsMade||0)+1," of ",j.totalPayments||1]})]})]})]})]})}),f.jsxs("div",{className:"arrangement-actions",children:[j.status==="Scheduled"&&(!j.recurrenceType||j.recurrenceType==="none"||j.paymentsMade&&j.totalPayments&&j.paymentsMade>=j.totalPayments-1)&&f.jsx(Ai,{className:"btn btn-sm btn-success",isLoading:S.markingPaid.has(j.id),loadingText:"Processing...",onClick:async()=>{const G=window.prompt(`Payment received:

Expected: £${j.amount||"0.00"}
Enter actual amount received:`,j.amount||"");if(G!==null&&G.trim()){A(Z=>({...Z,markingPaid:new Set([...Z.markingPaid,j.id])}));try{await J(j.id,G.trim())}finally{A(Z=>({...Z,markingPaid:new Set([...Z.markingPaid].filter(oe=>oe!==j.id))}))}}},children:"✅ Confirm Payment"}),(j.status==="Scheduled"||j.status==="Confirmed")&&f.jsxs(f.Fragment,{children:[j.phoneNumber&&f.jsxs("div",{style:{position:"relative"},children:[f.jsx(Ai,{className:"btn btn-sm btn-primary",isLoading:S.sendingReminder.has(j.id),loadingText:"Opening...",onClick:()=>U(j),title:`Send SMS reminder to ${j.phoneNumber}`,children:"📱 Send SMS"}),R.has(j.id)&&f.jsx("div",{className:"reminder-confirmation",style:{position:"absolute",top:"-35px",left:"0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"nowrap",zIndex:1e3,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"✅ SMS opened!"}),j.reminderCount&&j.reminderCount>0&&f.jsxs("div",{className:"reminder-history",children:[j.reminderCount," SMS reminder",j.reminderCount>1?"s":""," sent",j.lastReminderSent&&f.jsxs("span",{children:[" • Last: ",Qd(fa(j.lastReminderSent),"MMM d, HH:mm")]})]})]}),j.recurrenceType&&j.recurrenceType!=="none"&&(!j.paymentsMade||!j.totalPayments||j.paymentsMade<j.totalPayments-1)&&f.jsx(Ai,{className:"btn btn-sm btn-success",isLoading:S.markingPaid.has(j.id),loadingText:"Processing...",onClick:async()=>{const G=window.prompt(`Continue with payment plan:

Expected: £${j.amount||"0.00"}
Enter actual amount received:`,j.amount||"");if(G!==null&&G.trim()){A(Z=>({...Z,markingPaid:new Set([...Z.markingPaid,j.id])}));try{await J(j.id,G.trim())}finally{A(Z=>({...Z,markingPaid:new Set([...Z.markingPaid].filter(oe=>oe!==j.id))}))}}},children:"✅ Continue Plan"}),f.jsx(Ai,{className:"btn btn-sm btn-warning",isLoading:S.markingDefaulted.has(j.id),loadingText:"Processing...",onClick:async()=>{if(confirm("Mark this arrangement as defaulted? This will complete the case as 'Done (Defaulted Arrangement)'.")){A(G=>({...G,markingDefaulted:new Set([...G.markingDefaulted,j.id])}));try{await me(j.id)}finally{A(G=>({...G,markingDefaulted:new Set([...G.markingDefaulted].filter(Z=>Z!==j.id))}))}}},children:"❌ Defaulted"})]}),f.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>b(j.id),disabled:S.updating||S.saving,children:"✏️ Edit"}),f.jsx(Ai,{className:"btn btn-sm btn-danger",isLoading:S.deleting.has(j.id),loadingText:"Deleting...",onClick:async()=>{if(confirm("Are you sure you want to delete this arrangement?")){A(G=>({...G,deleting:new Set([...G.deleting,j.id])}));try{await a(j.id)}finally{A(G=>({...G,deleting:new Set([...G.deleting].filter(Z=>Z!==j.id))}))}}},children:"🗑️ Delete"})]})]},j.id))})]},se))}),f.jsx("style",{children:`
        .arrangement-card-modern {
          background: linear-gradient(135deg, white 0%, var(--gray-50) 100%);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          padding: 1.5rem;
          margin-bottom: 1rem;
          box-shadow: var(--shadow-sm);
          transition: all 0.2s ease;
          position: relative;
          overflow: hidden;
        }

        .arrangement-card-modern:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
          border-color: var(--primary-light);
        }

        .arrangement-card-modern::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 3px;
          background: linear-gradient(90deg, var(--primary) 0%, var(--success) 100%);
        }

        .arrangement-card-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1.25rem;
          gap: 1rem;
        }

        .arrangement-primary-info {
          flex: 1;
        }

        .arrangement-address-modern {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          margin-bottom: 0.5rem;
        }

        .address-index {
          background: var(--primary);
          color: white;
          font-size: 0.75rem;
          font-weight: 600;
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          min-width: 2rem;
          text-align: center;
        }

        .address-text {
          font-weight: 600;
          font-size: 1.1rem;
          color: var(--text-primary);
          line-height: 1.2;
        }

        .arrangement-customer-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.9rem;
          color: var(--text-secondary);
        }

        .customer-icon {
          font-size: 1rem;
        }

        .customer-name {
          font-weight: 500;
        }

        .arrangement-status-modern {
          flex-shrink: 0;
        }

        .status-badge-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          border-radius: var(--radius-full);
          font-size: 0.875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          transition: all 0.2s ease;
        }

        .status-badge-modern.status-scheduled {
          background: linear-gradient(135deg, var(--blue-50) 0%, var(--blue-25) 100%);
          color: var(--blue-700);
          border: 1px solid var(--blue-200);
        }

        .status-badge-modern.status-confirmed {
          background: linear-gradient(135deg, var(--success-light) 0%, var(--success-lighter) 100%);
          color: var(--success-dark);
          border: 1px solid var(--success-border);
        }

        .status-badge-modern.status-completed {
          background: linear-gradient(135deg, var(--green-50) 0%, var(--green-25) 100%);
          color: var(--green-700);
          border: 1px solid var(--green-200);
        }

        .status-badge-modern.status-cancelled {
          background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-25) 100%);
          color: var(--gray-700);
          border: 1px solid var(--gray-200);
        }

        .status-badge-modern.status-missed {
          background: linear-gradient(135deg, var(--danger-light) 0%, var(--danger-lighter) 100%);
          color: var(--danger-dark);
          border: 1px solid var(--danger-border);
        }

        .status-icon {
          font-size: 0.875rem;
        }

        .arrangement-card-body {
          margin-bottom: 1.25rem;
        }

        .arrangement-details-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          padding: 0.75rem;
          background: var(--gray-25);
          border-radius: var(--radius-md);
          transition: all 0.2s ease;
        }

        .detail-item:hover {
          background: var(--gray-50);
        }

        .detail-notes {
          grid-column: 1 / -1;
        }

        /* Dark mode styles for arrangements */
        .dark-mode .arrangement-card-modern {
          background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-card-modern:hover {
          border-color: var(--primary);
          background: linear-gradient(135deg, var(--gray-200) 0%, var(--gray-300) 100%);
        }

        .dark-mode .address-text {
          color: var(--gray-800);
        }

        .dark-mode .customer-name {
          color: var(--gray-600);
        }

        .dark-mode .detail-item {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .detail-item:hover {
          background: var(--gray-300);
        }

        .dark-mode .detail-label {
          color: var(--gray-500);
        }

        .dark-mode .detail-value {
          color: var(--gray-800);
        }

        .dark-mode .phone-link {
          color: var(--primary) !important;
        }

        .dark-mode .recurrence-progress {
          color: var(--gray-500);
        }

        .dark-mode .reminder-confirmation {
          background: var(--gray-200) !important;
          color: var(--gray-800) !important;
        }

        .dark-mode .reminder-history {
          color: var(--gray-600) !important;
        }

        /* Basic card and form styles */
        .card {
          background: white;
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          overflow: hidden;
        }

        .card-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
          background: var(--gray-50);
        }

        .card-body {
          padding: 1.5rem;
        }

        .form-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 1rem;
        }

        .form-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .form-group-full {
          grid-column: 1 / -1;
        }

        .form-group label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .btn-row {
          display: flex;
          gap: 0.75rem;
          align-items: center;
          flex-wrap: wrap;
        }

        .btn-row-end {
          justify-content: flex-end;
        }

        .arrangements-wrap {
          max-width: none;
          width: 100%;
        }

        .top-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          margin-bottom: 2rem;
          flex-wrap: wrap;
        }

        .stat-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 0.75rem 1rem;
          background: white;
          border-radius: var(--radius-md);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          min-width: 80px;
        }

        .stat-label {
          font-size: 0.75rem;
          color: var(--gray-600);
          margin-bottom: 0.25rem;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--gray-800);
        }

        .stat-actions {
          display: flex;
          gap: 1rem;
          align-items: center;
        }

        .days-list {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .day-card {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          overflow: hidden;
        }

        .day-header {
          padding: 1.5rem;
          background: var(--gray-50);
          border-bottom: 1px solid var(--gray-200);
        }

        .day-title {
          font-size: 1.125rem;
          font-weight: 700;
          color: var(--gray-800);
          margin-bottom: 0.25rem;
        }

        .muted {
          font-size: 0.875rem;
          color: var(--gray-500);
        }

        .arrangements-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          padding: 1.5rem;
        }

        .empty-box {
          padding: 3rem;
          text-align: center;
          background: white;
          border-radius: var(--radius-lg);
          border: 2px dashed var(--gray-300);
          color: var(--gray-500);
        }

        .fade-in-up {
          animation: fadeInUp 0.3s ease-out;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        /* Dark mode for basic elements */
        .dark-mode .card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .card-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .form-group label {
          color: var(--gray-700);
        }

        .dark-mode .stat-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .stat-label {
          color: var(--gray-500);
        }

        .dark-mode .stat-value {
          color: var(--gray-800);
        }

        .dark-mode .day-card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .day-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .day-title {
          color: var(--gray-800);
        }

        .dark-mode .muted {
          color: var(--gray-500);
        }

        .dark-mode .empty-box {
          background: var(--gray-100);
          border-color: var(--gray-400);
          color: var(--gray-500);
        }

        /* Dark mode button styles */
        .dark-mode .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        /* Dark mode arrangement actions */
        .dark-mode .arrangement-actions .btn {
          background: var(--gray-200);
          color: var(--gray-700);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-actions .btn:hover {
          background: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .arrangement-actions .btn-success {
          background: var(--success);
          color: white;
          border-color: var(--success);
        }

        .dark-mode .arrangement-actions .btn-success:hover {
          background: var(--success-dark);
          border-color: var(--success-dark);
        }

        .dark-mode .arrangement-actions .btn-primary {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }

        .dark-mode .arrangement-actions .btn-primary:hover {
          background: var(--primary-hover);
          border-color: var(--primary-hover);
        }

        .dark-mode .arrangement-actions .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .arrangement-actions .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .arrangement-actions .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .arrangement-actions .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        .dark-mode .arrangement-actions .btn-ghost {
          background: transparent;
          color: var(--gray-600);
          border-color: var(--gray-400);
        }

        .dark-mode .arrangement-actions .btn-ghost:hover {
          background: var(--gray-200);
          color: var(--gray-800);
        }

        .detail-icon {
          font-size: 1.1rem;
          flex-shrink: 0;
          margin-top: 0.125rem;
        }

        .detail-content {
          flex: 1;
          min-width: 0;
        }

        .detail-label {
          display: block;
          font-size: 0.75rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
          margin-bottom: 0.25rem;
        }

        .detail-value {
          display: block;
          font-size: 0.9rem;
          color: var(--text-primary);
          font-weight: 500;
          word-break: break-word;
        }

        .amount-value {
          color: var(--success-dark);
          font-weight: 700;
          font-size: 1rem;
        }

        .phone-link {
          color: var(--primary) !important;
          text-decoration: none;
          transition: color 0.2s ease;
        }

        .phone-link:hover {
          color: var(--primary-dark) !important;
          text-decoration: underline;
        }

        .recurrence-progress {
          font-size: 0.8rem;
          color: var(--text-secondary);
          margin-top: 0.25rem;
          font-weight: 400;
        }

        .arrangement-actions {
          display: flex;
          gap: 0.75rem;
          flex-wrap: wrap;
          align-items: center;
          margin-top: 1.5rem;
          padding-top: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .dark-mode .arrangement-actions {
          border-top-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .arrangement-card-header {
            flex-direction: column;
            align-items: stretch;
          }

          .arrangement-details-grid {
            grid-template-columns: 1fr;
          }

          .detail-notes {
            grid-column: 1;
          }
        }
      `})]})},wI=Y.memo(_I);async function kI(e){const r=await e.text();return JSON.parse(r)}function bI({onAdd:e,inline:r}){const[t,n]=Y.useState(!1),[a,l]=Y.useState(""),[c,d]=Y.useState(""),[m,v]=Y.useState(""),[x,y]=Y.useState(!1),k=Y.useRef(!1),[E,b]=Y.useState(null),S=()=>{l(""),d(""),v(""),b(null)},A=async O=>{if(O?.preventDefault(),k.current)return;b(null);const N=a.trim();if(!N)return b("Address is required.");let U=null,K=null;if(c.trim()){const B=Number(c);if(Number.isNaN(B))return b("Latitude must be a number.");U=B}if(m.trim()){const B=Number(m);if(Number.isNaN(B))return b("Longitude must be a number.");K=B}k.current=!0,y(!0);try{await e({address:N,lat:U,lng:K}),S(),n(!1)}catch(B){b(B?.message||String(B))}finally{k.current=!1,y(!1)}},R=r?f.jsx("button",{type:"button",className:"btn",onClick:()=>n(!0),children:"+ Add address"}):f.jsx("button",{type:"button",onClick:()=>n(!0),"aria-label":"Add address",style:SI,className:"fab-add-address",children:"+"});return f.jsxs(f.Fragment,{children:[R,t&&Sy.createPortal(f.jsx("div",{style:TI,role:"dialog","aria-modal":"true",children:f.jsxs("div",{style:EI,children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("h3",{style:{margin:0},children:"Add Address"}),f.jsx("button",{className:"btn btn-ghost",onClick:()=>{S(),n(!1)},disabled:x,"aria-label":"Close",children:"✕"})]}),f.jsxs("form",{onSubmit:A,style:{marginTop:"0.5rem"},children:[f.jsx("label",{className:"label",htmlFor:"manual-address",children:"Address *"}),f.jsx("textarea",{id:"manual-address",value:a,onChange:O=>l(O.target.value),className:"input",rows:3,placeholder:"e.g. 10 Example St, City, POSTCODE",required:!0}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[f.jsxs("div",{style:{flex:1},children:[f.jsx("label",{className:"label",htmlFor:"manual-lat",children:"Lat (optional)"}),f.jsx("input",{id:"manual-lat",type:"text",inputMode:"decimal",value:c,onChange:O=>d(O.target.value),className:"input",placeholder:"51.5034"})]}),f.jsxs("div",{style:{flex:1},children:[f.jsx("label",{className:"label",htmlFor:"manual-lng",children:"Lng (optional)"}),f.jsx("input",{id:"manual-lng",type:"text",inputMode:"decimal",value:m,onChange:O=>v(O.target.value),className:"input",placeholder:"-0.1276"})]})]}),E&&f.jsx("div",{style:{color:"var(--danger)",fontSize:"0.875rem",marginTop:"0.5rem"},children:E}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem",justifyContent:"flex-end"},children:[f.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>{S(),n(!1)},disabled:x,children:"Cancel"}),f.jsx("button",{type:"submit",className:"btn",disabled:x,children:x?"Adding...":"Add"})]})]})]})}),document.body)]})}const SI={position:"fixed",right:16,bottom:"calc(16px + env(safe-area-inset-bottom, 0))",width:56,height:56,borderRadius:"50%",border:"none",background:"var(--primary)",color:"#fff",fontSize:28,lineHeight:"56px",textAlign:"center",boxShadow:"0 6px 18px rgba(0,0,0,0.18)",cursor:"pointer",zIndex:4e3},TI={position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:12,zIndex:4100},EI={width:"100%",maxWidth:520,background:"var(--surface)",borderRadius:14,padding:14,border:"1px solid var(--border-light)",boxShadow:"var(--shadow-lg)"},CI=[{id:"enforcement_pro",name:"Enforcement Pro",price:2500,currency:"GBP",features:["Route optimization for 30+ addresses","Commission tracking & reporting","Payment arrangements with SMS reminders","Daily/weekly earnings reports","Unlimited cloud sync & backup","Priority customer support"],trialDays:14}];function AI(e){const r=new Date(e),t=new Date,n=r.getTime()-t.getTime();return Math.ceil(n/(1e3*60*60*24))}function PI(e){if(!e)return!1;const r=new Date,t=new Date(e.currentPeriodEnd);return(e.status==="active"||e.status==="trial")&&t>r}function NI(e){return e?e.status==="trial":!1}function II(e){if(!e)return!0;const r=new Date,t=new Date(e.currentPeriodEnd);return e.status==="expired"||e.status==="cancelled"||t<=r}function bm(e){const[r,t]=Y.useState(null),[n]=Y.useState(CI),[a,l]=Y.useState(!0),[c,d]=Y.useState(null),[m,v]=Y.useState(!1),[x,y]=Y.useState(!1),k=Y.useCallback(()=>d(null),[]);Y.useEffect(()=>{(async()=>{if(!e||!We){v(!1);return}try{const{data:te}=await We.rpc("is_owner",{user_uuid:e.id});v(te||!1)}catch{v(!1)}})()},[e]);const E=PI(r),b=NI(r),S=II(r),A=r?AI(r.currentPeriodEnd):0,R=m||E&&!S||x,O=Y.useCallback(async()=>{if(!e||!We){t(null),l(!1);return}try{l(!0),k();const{data:D,error:te}=await We.from("user_subscriptions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).maybeSingle();if(te)throw te;const ee=D?{id:D.id,userId:D.user_id,planId:D.plan_id,status:D.status,currentPeriodStart:D.current_period_start,currentPeriodEnd:D.current_period_end,trialStart:D.trial_start||void 0,trialEnd:D.trial_end||void 0,cancelledAt:D.cancelled_at||void 0,createdAt:D.created_at,updatedAt:D.updated_at,lastPaymentAt:D.last_payment_at||void 0,nextPaymentDue:D.next_payment_due||void 0}:null;t(ee)}catch(D){_e.error("Failed to load subscription:",D),d(D?.message||"Failed to load subscription"),t(null)}finally{l(!1)}},[e,k]),N=Y.useCallback(async()=>{if(!We){y(!1);return}try{const D=localStorage.getItem("navigator_trial_created"),te=localStorage.getItem("navigator_trial_user_id");if(!D||!te){y(!1);return}const ee=parseInt(D);if((Date.now()-ee)/(1e3*60*60)>25){console.log("Trial too old, clearing localStorage"),localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"),y(!1);return}const{data:me,error:J}=await We.rpc("check_trial_access",{target_user_id:te});if(J){console.warn("Server trial access check failed:",J),y(!1);return}console.log("Server trial access result:",me),y(me?.hasAccess||!1),me?.hasAccess||(localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"))}catch(D){console.warn("Server trial access check error:",D),y(!1)}},[]);Y.useEffect(()=>{e?O():(t(null),l(!1)),N()},[e,O,N]);const U=Y.useCallback(async()=>{if(!e||!We)throw new Error("User not authenticated");if(r)throw new Error("User already has a subscription");try{k(),l(!0);const D=n[0],te=new Date,ee=new Date(te);ee.setDate(ee.getDate()+D.trialDays);const ve={user_id:e.id,plan_id:D.id,status:"trial",current_period_start:te.toISOString(),current_period_end:ee.toISOString(),trial_start:te.toISOString(),trial_end:ee.toISOString(),created_at:te.toISOString(),updated_at:te.toISOString()},{error:me}=await We.from("user_subscriptions").insert(ve);if(me)throw me;await O(),_e.info("Trial started successfully")}catch(D){throw _e.error("Failed to start trial:",D),d(D?.message||"Failed to start trial"),D}finally{l(!1)}},[e,r,n,k,O]),K=Y.useCallback(async D=>{if(!e||!We)throw new Error("User not authenticated");if(!n.find(ee=>ee.id===D))throw new Error("Invalid plan selected");try{k(),l(!0);const ee=new Date,ve=new Date(ee);ve.setMonth(ve.getMonth()+1);const me=r?{status:"active",plan_id:D,current_period_start:ee.toISOString(),current_period_end:ve.toISOString(),last_payment_at:ee.toISOString(),next_payment_due:ve.toISOString(),updated_at:ee.toISOString()}:{user_id:e.id,plan_id:D,status:"active",current_period_start:ee.toISOString(),current_period_end:ve.toISOString(),last_payment_at:ee.toISOString(),next_payment_due:ve.toISOString(),created_at:ee.toISOString(),updated_at:ee.toISOString()};if(r){const{error:J}=await We.from("user_subscriptions").update(me).eq("id",r.id);if(J)throw J}else{const{error:J}=await We.from("user_subscriptions").insert(me);if(J)throw J}await O(),_e.info("Subscription activated successfully")}catch(ee){throw _e.error("Failed to subscribe:",ee),d(ee?.message||"Failed to subscribe"),ee}finally{l(!1)}},[e,r,n,k,O]),B=Y.useCallback(async()=>{if(!e||!We||!r)throw new Error("No active subscription to cancel");try{k(),l(!0);const D=new Date,te={status:"cancelled",cancelled_at:D.toISOString(),updated_at:D.toISOString()},{error:ee}=await We.from("user_subscriptions").update(te).eq("id",r.id);if(ee)throw ee;await O(),_e.info("Subscription cancelled successfully")}catch(D){throw _e.error("Failed to cancel subscription:",D),d(D?.message||"Failed to cancel subscription"),D}finally{l(!1)}},[e,r,k,O]);return{subscription:r,availablePlans:n,isLoading:a,error:c,isActive:E,isTrial:b,isExpired:S,daysRemaining:A,hasAccess:R,startTrial:U,subscribe:K,cancelSubscription:B,refreshSubscription:O,clearError:k}}function jy(e){const[r,t]=Y.useState(!1),[n,a]=Y.useState(!1),[l,c]=Y.useState(null),[d,m]=Y.useState(!0),[v,x]=Y.useState(null),y=Y.useCallback(()=>x(null),[]),k=Y.useCallback(async()=>{if(!e||!We){t(!1),a(!1),c(null),m(!1);return}try{m(!0),y();const{data:E,error:b}=await We.rpc("is_admin",{user_uuid:e.id});if(b){t(!1),a(!1),c(null),m(!1);return}if(t(E||!1),E){const{data:S,error:A}=await We.rpc("is_owner",{user_uuid:e.id});A?console.warn("Failed to check owner status:",A):a(S||!1);const{data:R,error:O}=await We.from("admin_users").select("*").eq("user_id",e.id).single();O?console.warn("Failed to fetch admin user details:",O):c(R)}else a(!1),c(null)}catch(E){console.log("Admin check failed:",E.message),t(!1),a(!1),c(null)}finally{m(!1)}},[e,y]);return Y.useEffect(()=>{k()},[k]),{isAdmin:r,isOwner:n,adminUser:l,isLoading:d,error:v,refreshAdmin:k,clearError:y}}function DI(e,r){const t=e/100;return new Intl.NumberFormat("en-GB",{style:"currency",currency:r,minimumFractionDigits:0,maximumFractionDigits:2}).format(t)}function Ld(e){return new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})}function OI({user:e,onClose:r}){const{subscription:t,availablePlans:n,isLoading:a,error:l,isActive:c,isTrial:d,isExpired:m,daysRemaining:v,hasAccess:x,startTrial:y,subscribe:k,cancelSubscription:E,clearError:b}=bm(e),{isOwner:S}=jy(e),[A,R]=Y.useState(null),O=async()=>{try{R("trial"),await y()}catch{}finally{R(null)}},N=async K=>{try{R(`subscribe-${K}`),await k(K)}catch{}finally{R(null)}},U=async()=>{if(confirm("Are you sure you want to cancel your subscription? You will lose access at the end of your current billing period."))try{R("cancel"),await E()}catch{}finally{R(null)}};return a?f.jsx("div",{className:"subscription-manager",children:f.jsxs("div",{className:"subscription-loading",children:[f.jsx("div",{className:"spinner"}),f.jsx("p",{children:"Loading subscription..."})]})}):S?f.jsxs("div",{className:"subscription-manager",children:[f.jsxs("div",{className:"subscription-header",children:[f.jsx("h2",{children:"Owner Access"}),r&&f.jsx("button",{className:"close-button",onClick:r,"aria-label":"Close",children:"✕"})]}),f.jsx("div",{className:"owner-status",children:f.jsxs("div",{className:"owner-card",children:[f.jsx("div",{className:"owner-badge",children:"🔑 OWNER"}),f.jsx("h3",{children:"Unlimited Access"}),f.jsx("p",{children:"As the owner, you have unrestricted access to all premium features:"}),f.jsx("div",{className:"owner-features",children:f.jsxs("ul",{children:[f.jsx("li",{children:"✓ Route optimization for unlimited addresses"}),f.jsx("li",{children:"✓ Commission tracking & reporting"}),f.jsx("li",{children:"✓ Payment arrangements with SMS reminders"}),f.jsx("li",{children:"✓ Daily/weekly earnings reports"}),f.jsx("li",{children:"✓ Unlimited cloud sync & backup"}),f.jsx("li",{children:"✓ Admin dashboard and user management"}),f.jsx("li",{children:"✓ Priority customer support tools"})]})}),f.jsxs("div",{className:"owner-info",children:[f.jsx("h4",{children:"Business Status"}),f.jsxs("p",{children:[f.jsx("strong",{children:"Plan:"})," Owner Access (No subscription required)"]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Status:"})," ",f.jsx("span",{className:"status-active",children:"Active"})]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Billing:"})," N/A - Owner account"]})]}),f.jsxs("div",{className:"owner-actions",children:[f.jsx("p",{children:f.jsx("strong",{children:"Need to manage customer subscriptions?"})}),f.jsx("button",{className:"btn-secondary",onClick:r,style:{marginRight:"8px"},children:"Close"}),f.jsx("button",{className:"btn-primary",onClick:()=>{console.log("Redirect to admin dashboard"),r&&r()},children:"Go to Admin Dashboard"})]})]})})]}):f.jsxs("div",{className:"subscription-manager",children:[f.jsxs("div",{className:"subscription-header",children:[f.jsx("h2",{children:"Subscription Management"}),r&&f.jsx("button",{className:"close-button",onClick:r,"aria-label":"Close",children:"✕"})]}),l&&f.jsxs("div",{className:"error-banner",children:[f.jsx("p",{children:l}),f.jsx("button",{onClick:b,children:"Dismiss"})]}),t?f.jsxs("div",{className:"current-subscription",children:[f.jsx("h3",{children:"Current Subscription"}),f.jsxs("div",{className:"subscription-card",children:[f.jsxs("div",{className:"subscription-info",children:[f.jsx("div",{className:"plan-name",children:n.find(K=>K.id===t.planId)?.name||"Unknown Plan"}),f.jsxs("div",{className:"subscription-status",children:[f.jsx("span",{className:`status-badge ${t.status}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),d&&f.jsx("span",{className:"trial-badge",children:v>0?`${v} days remaining`:"Trial expired"})]})]}),f.jsxs("div",{className:"subscription-details",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Current Period:"})," ",Ld(t.currentPeriodStart)," - ",Ld(t.currentPeriodEnd)]}),t.nextPaymentDue&&c&&!d&&f.jsxs("p",{children:[f.jsx("strong",{children:"Next Payment:"})," ",Ld(t.nextPaymentDue)]}),t.cancelledAt&&f.jsxs("p",{children:[f.jsx("strong",{children:"Cancelled:"})," ",Ld(t.cancelledAt)]})]}),x&&f.jsxs("div",{className:"subscription-features",children:[f.jsx("h4",{children:"Your Features:"}),f.jsx("ul",{children:n.find(K=>K.id===t.planId)?.features.map((K,B)=>f.jsxs("li",{children:["✓ ",K]},B))})]}),f.jsxs("div",{className:"subscription-actions",children:[d&&v>0&&f.jsx("button",{className:"btn-primary",onClick:()=>N(t.planId),disabled:A!==null,children:A===`subscribe-${t.planId}`?"Processing...":"Upgrade to Paid"}),c&&!d&&f.jsx("button",{className:"btn-secondary",onClick:U,disabled:A!==null,children:A==="cancel"?"Processing...":"Cancel Subscription"})]})]})]}):f.jsxs("div",{className:"available-plans",children:[f.jsx("h3",{children:"Choose Your Plan"}),f.jsx("p",{className:"plans-intro",children:"Transform your enforcement work with our unified platform. Replace multiple expensive apps with one powerful solution."}),n.map(K=>f.jsxs("div",{className:"plan-card featured",children:[f.jsxs("div",{className:"plan-header",children:[f.jsx("h4",{children:K.name}),f.jsxs("div",{className:"plan-price",children:[f.jsx("span",{className:"price",children:DI(K.price,K.currency)}),f.jsx("span",{className:"period",children:"/month"})]})]}),f.jsx("div",{className:"plan-features",children:f.jsx("ul",{children:K.features.map((B,D)=>f.jsxs("li",{children:["✓ ",B]},D))})}),f.jsxs("div",{className:"plan-actions",children:[f.jsx("button",{className:"btn-primary full-width",onClick:O,disabled:A!==null,children:A==="trial"?"Starting Trial...":`Start ${K.trialDays}-Day Free Trial`}),f.jsx("p",{className:"trial-note",children:"No payment required • Cancel anytime • Full access during trial"})]})]},K.id)),f.jsxs("div",{className:"value-proposition",children:[f.jsx("h4",{children:"Why Enforcement Pro?"}),f.jsxs("div",{className:"comparison",children:[f.jsxs("div",{className:"comparison-item",children:[f.jsx("span",{className:"old-cost",children:"Route Planning App: £20-30/month"}),f.jsx("span",{className:"new-cost",children:"✓ Included"})]}),f.jsxs("div",{className:"comparison-item",children:[f.jsx("span",{className:"old-cost",children:"SMS Service: £10-15/month"}),f.jsx("span",{className:"new-cost",children:"✓ Included"})]}),f.jsxs("div",{className:"comparison-item",children:[f.jsx("span",{className:"old-cost",children:"Basic Tracking: £10-20/month"}),f.jsx("span",{className:"new-cost",children:"✓ Included"})]}),f.jsx("div",{className:"total-savings",children:f.jsx("strong",{children:"Total Monthly Savings: £15-40"})})]})]})]}),m&&f.jsxs("div",{className:"access-warning",children:[f.jsx("h4",{children:"⚠️ Subscription Expired"}),f.jsx("p",{children:"Your subscription has expired. Please renew to continue using premium features."}),f.jsx("button",{className:"btn-primary",onClick:()=>n[0]&&N(n[0].id),disabled:A!==null,children:"Renew Subscription"})]})]})}const FI=`
.subscription-manager {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  color: var(--text-color, #000);
}

.subscription-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  border-bottom: 1px solid var(--border-color, #e1e5e9);
  padding-bottom: 16px;
}

.subscription-header h2 {
  color: var(--text-color, #000);
  margin: 0;
}

.close-button {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  color: var(--text-color, #000);
}

.close-button:hover {
  background-color: var(--hover-bg, #f5f5f5);
}

.dark-mode .close-button:hover {
  background-color: var(--dark-hover-bg, #333);
}

.subscription-loading {
  text-align: center;
  padding: 40px;
  color: var(--text-color, #000);
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid var(--border-color, #f3f3f3);
  border-top: 4px solid #007bff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.error-banner {
  background-color: var(--error-bg, #fee);
  border: 1px solid var(--error-border, #fcc);
  border-radius: 4px;
  padding: 12px;
  margin-bottom: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: var(--error-text, #721c24);
}

.dark-mode .error-banner {
  background-color: var(--dark-error-bg, #4a1a1a);
  border-color: var(--dark-error-border, #8b2635);
  color: var(--dark-error-text, #ff6b6b);
}

.current-subscription, .available-plans {
  margin-bottom: 24px;
}

.current-subscription h3, .available-plans h3 {
  color: var(--text-color, #000);
  margin-bottom: 16px;
}

.subscription-card, .plan-card {
  border: 1px solid var(--border-color, #e1e5e9);
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 16px;
  background-color: var(--card-bg, #fff);
  color: var(--text-color, #000);
}

.dark-mode .subscription-card,
.dark-mode .plan-card {
  background-color: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.plan-card.featured {
  border-color: #007bff;
  position: relative;
  margin-top: 16px;
}

.plan-card.featured::before {
  content: 'Most Popular';
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  background: #007bff;
  color: white;
  padding: 6px 16px;
  font-size: 12px;
  font-weight: 600;
  border-radius: 16px;
  white-space: nowrap;
}

.status-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  text-transform: uppercase;
}

.status-badge.active { background: #d4edda; color: #155724; }
.status-badge.trial { background: #fff3cd; color: #856404; }
.status-badge.expired { background: #f8d7da; color: #721c24; }
.status-badge.cancelled { background: #e2e3e5; color: #6c757d; }

.trial-badge {
  margin-left: 8px;
  padding: 4px 8px;
  background: #e3f2fd;
  color: #1976d2;
  border-radius: 4px;
  font-size: 12px;
}

.dark-mode .trial-badge {
  background: var(--dark-secondary-bg, #2a4a5c);
  color: var(--dark-secondary-text, #87ceeb);
  border: 1px solid var(--dark-border-color, #444);
}

.plan-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 16px;
}

.plan-header h4 {
  color: var(--text-color, #000);
  margin: 0;
}

.plan-price .price {
  font-size: 24px;
  font-weight: bold;
  color: #007bff;
}

.plan-price .period {
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
}

.dark-mode .plan-price .period {
  color: var(--dark-secondary-text, #aaa);
}

.plan-features ul {
  list-style: none;
  padding: 0;
  margin: 16px 0;
}

.plan-features li {
  padding: 4px 0;
  color: #28a745;
}

.subscription-info .plan-name {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-color, #000);
  margin-bottom: 8px;
}

.subscription-details {
  margin: 16px 0;
  color: var(--text-color, #000);
}

.subscription-details p {
  margin: 8px 0;
  color: var(--text-color, #000);
}

.subscription-details strong {
  color: var(--text-color, #000);
}

.subscription-features h4 {
  color: var(--text-color, #000);
  margin: 16px 0 8px 0;
}

.subscription-actions, .plan-actions {
  margin-top: 20px;
}

.btn-primary, .btn-secondary {
  padding: 10px 20px;
  border-radius: 6px;
  border: none;
  font-weight: 500;
  cursor: pointer;
  margin-right: 8px;
  transition: background-color 0.2s;
}

.btn-primary {
  background: #007bff;
  color: white;
}

.btn-primary:hover:not(:disabled) {
  background: #0056b3;
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover:not(:disabled) {
  background: #545b62;
}

.btn-primary:disabled, .btn-secondary:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.full-width {
  width: 100%;
  margin-right: 0;
}

.trial-note {
  text-align: center;
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
  margin-top: 8px;
}

.dark-mode .trial-note {
  color: var(--dark-secondary-text, #aaa);
}

.comparison {
  background: var(--secondary-bg, #f8f9fa);
  padding: 16px;
  border-radius: 6px;
  margin-top: 12px;
  color: var(--text-color, #000);
}

.dark-mode .comparison {
  background: var(--dark-secondary-bg, #333);
}

.comparison-item {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
}

.old-cost {
  color: var(--secondary-text, #6c757d);
  text-decoration: line-through;
}

.dark-mode .old-cost {
  color: var(--dark-secondary-text, #aaa);
}

.new-cost {
  color: #28a745;
  font-weight: 500;
}

.total-savings {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--border-color, #dee2e6);
  text-align: center;
  color: #007bff;
}

.dark-mode .total-savings {
  border-top-color: var(--dark-border-color, #555);
}

.access-warning {
  background: var(--warning-bg, #fff3cd);
  border: 1px solid var(--warning-border, #ffeaa7);
  border-radius: 6px;
  padding: 16px;
  text-align: center;
  color: var(--warning-text, #856404);
}

.dark-mode .access-warning {
  background: var(--dark-warning-bg, #4a3c1a);
  border-color: var(--dark-warning-border, #8b7355);
  color: var(--dark-warning-text, #ffc107);
}

.access-warning h4 {
  color: var(--warning-text, #856404);
  margin: 0 0 8px 0;
}

.dark-mode .access-warning h4 {
  color: var(--dark-warning-text, #ffc107);
}

.value-proposition h4 {
  color: var(--text-color, #000);
  margin: 16px 0 12px 0;
}

.plans-intro {
  color: var(--text-color, #000);
  margin-bottom: 20px;
}

.owner-status {
  margin-bottom: 24px;
}

.owner-card {
  border: 2px solid #28a745;
  border-radius: 12px;
  padding: 24px;
  background: linear-gradient(135deg, #f8fff9 0%, #e8f5e8 100%);
  text-align: center;
}

.owner-badge {
  display: inline-block;
  background: #28a745;
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 16px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.owner-features {
  margin: 20px 0;
  text-align: left;
}

.owner-features ul {
  list-style: none;
  padding: 0;
  max-width: 400px;
  margin: 0 auto;
}

.owner-features li {
  padding: 6px 0;
  color: #28a745;
  font-weight: 500;
}

.owner-info {
  background: var(--card-bg, white);
  border-radius: 8px;
  padding: 16px;
  margin: 20px 0;
  border: 1px solid #d4edda;
  color: var(--text-color, #000);
}

.dark-mode .owner-info {
  background: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.owner-info h4 {
  margin: 0 0 12px 0;
  color: #28a745;
}

.owner-info p {
  margin: 8px 0;
  text-align: left;
  color: var(--text-color, #000);
}

.status-active {
  color: #28a745;
  font-weight: 600;
}

.owner-actions {
  margin-top: 24px;
}

.owner-actions p {
  margin-bottom: 16px;
  font-weight: 500;
  color: var(--text-color, #000);
}

.owner-card h3 {
  color: var(--text-color, #000);
  margin: 0 0 16px 0;
}

.owner-card p {
  color: var(--text-color, #000);
}

.dark-mode .owner-card {
  background: linear-gradient(135deg, #2a4a2a 0%, #1a3a1a 100%);
}
`;if(typeof document<"u"){const e=document.createElement("style");e.textContent=FI,document.head.appendChild(e)}function LI({user:e,onClose:r}){const[t,n]=Y.useState(null),[a,l]=Y.useState([]),[c,d]=Y.useState([]),[m,v]=Y.useState(!0),[x,y]=Y.useState(null),[k,E]=Y.useState("subscriptions"),[b,S]=Y.useState(""),[A,R]=Y.useState(1),[O,N]=Y.useState(7),[U,K]=Y.useState(""),[B,D]=Y.useState(null);Y.useEffect(()=>{te()},[e]);const te=async()=>{if(!(!e||!We))try{v(!0),y(null);const{data:ce,error:ke}=await We.rpc("is_admin",{user_uuid:e.id});if(ke)throw console.error("Admin check error:",ke),ke;if(!ce)throw new Error("Access denied: Admin privileges required");const{data:se,error:ue}=await We.from("admin_users").select("*").eq("user_id",e.id).single();if(ue)throw ue;n(se);const{data:j,error:G}=await We.rpc("get_admin_subscription_overview");if(G)throw console.error("Subscription overview error:",G),G;l(j||[]);let Z=[];try{const{data:I,error:P}=await We.from("admin_actions").select(`
            id,
            action_type,
            target_user_id,
            performed_at,
            details,
            admin_users!inner(email)
          `).order("performed_at",{ascending:!1}).limit(20);P?(console.warn("Admin actions table not found or error:",P),Z=[]):Z=I||[]}catch(I){console.warn("Failed to load admin actions:",I),Z=[]}const oe=(Z||[]).map(I=>({...I,admin_email:I.admin_users?.email||(Array.isArray(I.admin_users)?I.admin_users[0]?.email:null)}));d(oe)}catch(ce){y(ce.message||"Failed to load admin data")}finally{v(!1)}},ee=async()=>{if(!(!b||!We))try{D("grant");const{error:ce}=await We.rpc("admin_grant_subscription",{target_user_id:b,plan_id:"enforcement_pro",duration_months:A,admin_notes:U||`Granted ${A} month(s) by admin`});if(ce)throw ce;await te(),S(""),R(1),K(""),alert("Subscription granted successfully!")}catch(ce){alert("Failed to grant subscription: "+ce.message)}finally{D(null)}},ve=async()=>{if(!(!b||!We))try{D("extend");const{error:ce}=await We.rpc("admin_extend_trial",{target_user_id:b,additional_days:O,admin_notes:U||`Extended trial by ${O} days`});if(ce)throw ce;await te(),S(""),N(7),K(""),alert("Trial extended successfully!")}catch(ce){alert("Failed to extend trial: "+ce.message)}finally{D(null)}},me=ce=>ce?new Date(ce).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",J=ce=>{const se={active_trial:{color:"#fff3cd",label:"Active Trial"},active_paid:{color:"#d4edda",label:"Active Paid"},expired:{color:"#f8d7da",label:"Expired"},cancelled:{color:"#e2e3e5",label:"Cancelled"}}[ce]||{color:"#f8f9fa",label:ce};return f.jsx("span",{style:{backgroundColor:se.color,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500"},children:se.label})};return m?f.jsx("div",{className:"admin-dashboard",children:f.jsx("div",{className:"loading",children:"Loading admin dashboard..."})}):x?f.jsx("div",{className:"admin-dashboard",children:f.jsxs("div",{className:"error",children:[f.jsx("h3",{children:"Access Denied"}),f.jsx("p",{children:x}),r&&f.jsx("button",{onClick:r,children:"Close"})]})}):f.jsxs("div",{className:"admin-dashboard",children:[f.jsxs("div",{className:"admin-header",children:[f.jsx("h2",{children:"Admin Dashboard"}),f.jsxs("div",{className:"admin-info",children:[f.jsxs("span",{children:["Role: ",f.jsx("strong",{children:t?.role})]}),r&&f.jsx("button",{className:"close-button",onClick:r,children:"✕"})]})]}),f.jsxs("div",{className:"admin-tabs",children:[f.jsxs("button",{className:k==="subscriptions"?"active":"",onClick:()=>E("subscriptions"),children:["Subscriptions (",a.length,")"]}),f.jsxs("button",{className:k==="actions"?"active":"",onClick:()=>E("actions"),children:["Recent Actions (",c.length,")"]}),f.jsx("button",{className:k==="settings"?"active":"",onClick:()=>E("settings"),children:"Settings"})]}),k==="subscriptions"&&f.jsxs("div",{className:"subscriptions-tab",children:[f.jsxs("div",{className:"stats-bar",children:[f.jsxs("div",{className:"stat",children:[f.jsx("strong",{children:a.filter(ce=>ce.subscription_status==="trial").length}),f.jsx("span",{children:"Active Trials"})]}),f.jsxs("div",{className:"stat",children:[f.jsx("strong",{children:a.filter(ce=>ce.subscription_status==="active").length}),f.jsx("span",{children:"Paid Subscriptions"})]}),f.jsxs("div",{className:"stat",children:[f.jsx("strong",{children:a.filter(ce=>ce.subscription_status==="expired").length}),f.jsx("span",{children:"Expired"})]}),f.jsxs("div",{className:"stat",children:[f.jsxs("strong",{children:["£",a.filter(ce=>ce.subscription_status==="active").length*25]}),f.jsx("span",{children:"Monthly Revenue"})]})]}),f.jsxs("div",{className:"admin-actions-panel",children:[f.jsx("h3",{children:"Admin Actions"}),f.jsxs("div",{className:"admin-form",children:[f.jsxs("div",{className:"form-row",children:[f.jsx("label",{htmlFor:"selected-user-id",children:"Select User"}),f.jsxs("select",{id:"selected-user-id",name:"selectedUserId",value:b,onChange:ce=>S(ce.target.value),children:[f.jsx("option",{value:"",children:"Select User..."}),a.map(ce=>f.jsxs("option",{value:ce.user_email,children:[ce.user_email," - ",J(ce.subscription_status).props.children]},ce.user_email))]})]}),f.jsxs("div",{className:"form-row",children:[f.jsx("div",{className:"action-group",children:f.jsxs("div",{className:"input-group",children:[f.jsx("label",{htmlFor:"grant-months",children:"Grant Subscription (months):"}),f.jsx("input",{id:"grant-months",name:"grantMonths",type:"number",min:"1",max:"12",value:A,onChange:ce=>R(parseInt(ce.target.value)||1)}),f.jsx("button",{onClick:ee,disabled:!b||B!==null,children:B==="grant"?"Granting...":"Grant"})]})}),f.jsx("div",{className:"action-group",children:f.jsxs("div",{className:"input-group",children:[f.jsx("label",{htmlFor:"extend-days",children:"Extend Trial (days):"}),f.jsx("input",{id:"extend-days",name:"extendDays",type:"number",min:"1",max:"90",value:O,onChange:ce=>N(parseInt(ce.target.value)||7)}),f.jsx("button",{onClick:ve,disabled:!b||B!==null,children:B==="extend"?"Extending...":"Extend"})]})})]}),f.jsxs("div",{className:"form-row",children:[f.jsx("label",{htmlFor:"admin-notes",children:"Admin notes (optional)"}),f.jsx("textarea",{id:"admin-notes",name:"adminNotes",placeholder:"Admin notes (optional)",value:U,onChange:ce=>K(ce.target.value),rows:2})]})]})]}),f.jsxs("div",{className:"subscriptions-table",children:[f.jsx("h3",{children:"All Subscriptions"}),f.jsxs("table",{children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"User Email"}),f.jsx("th",{children:"Status"}),f.jsx("th",{children:"Plan"}),f.jsx("th",{children:"API Requests"}),f.jsx("th",{children:"Created"}),f.jsx("th",{children:"Period End"})]})}),f.jsx("tbody",{children:a.map(ce=>f.jsxs("tr",{children:[f.jsx("td",{children:ce.user_email}),f.jsx("td",{children:J(ce.subscription_status)}),f.jsx("td",{children:ce.subscription_plan||"No Plan"}),f.jsx("td",{children:ce.total_api_requests||0}),f.jsx("td",{children:me(ce.subscription_created_at)}),f.jsx("td",{children:me(ce.current_period_end)})]},ce.user_email))})]})]})]}),k==="actions"&&f.jsxs("div",{className:"actions-tab",children:[f.jsx("h3",{children:"Recent Admin Actions"}),f.jsx("div",{className:"actions-list",children:c.map(ce=>f.jsxs("div",{className:"action-item",children:[f.jsxs("div",{className:"action-header",children:[f.jsx("strong",{children:ce.action_type.replace("_"," ").toUpperCase()}),f.jsx("span",{className:"action-date",children:me(ce.performed_at)})]}),f.jsxs("div",{className:"action-details",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Admin:"})," ",ce.admin_email]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Target User:"})," ",ce.target_user_id]}),ce.details&&f.jsxs("div",{className:"action-notes",children:[f.jsx("strong",{children:"Details:"}),f.jsx("pre",{children:JSON.stringify(ce.details,null,2)})]})]})]},ce.id))})]}),k==="settings"&&f.jsxs("div",{className:"settings-tab",children:[f.jsx("h3",{children:"Admin Settings"}),f.jsxs("div",{className:"settings-info",children:[f.jsxs("p",{children:[f.jsx("strong",{children:"Your Role:"})," ",t?.role]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Permissions:"})," ",t?.permissions.join(", ")]}),f.jsxs("p",{children:[f.jsx("strong",{children:"Account Created:"})," ",me(t?.created_at||"")]})]}),f.jsxs("div",{className:"quick-stats",children:[f.jsx("h4",{children:"Quick Stats"}),f.jsxs("ul",{children:[f.jsxs("li",{children:["Total Users: ",a.length]}),f.jsxs("li",{children:["Active Trials: ",a.filter(ce=>ce.subscription_status==="trial").length]}),f.jsxs("li",{children:["Paid Customers: ",a.filter(ce=>ce.subscription_status==="active").length]}),f.jsxs("li",{children:["Monthly Revenue: £",a.filter(ce=>ce.subscription_status==="active").length*25]}),f.jsxs("li",{children:["Total Actions Performed: ",c.length]})]})]})]})]})}const RI=`
/* ==== Admin Dashboard Modern Styles ==== */
.admin-dashboard {
  max-width: 1200px;
  margin: 0 auto;
  padding: 1rem;
  background: var(--background);
  min-height: 100vh;
  overflow-x: hidden;
  box-sizing: border-box;
}

.admin-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  background: var(--surface);
  padding: 1rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
}

.admin-header h2 {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--text);
  margin: 0;
}

.admin-info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--text-muted);
  font-size: 0.75rem;
}

.close-button {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-muted);
}

.close-button:hover {
  background: var(--background);
  color: var(--text);
}

.admin-tabs {
  display: flex;
  gap: 0.25rem;
  margin-bottom: 1rem;
  background: var(--surface);
  padding: 0.25rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
}

.admin-tabs button {
  flex: 1;
  padding: 0.5rem 0.75rem;
  border: none;
  background: transparent;
  cursor: pointer;
  border-radius: var(--radius);
  font-weight: 500;
  color: var(--text-muted);
  transition: all 0.2s ease;
  position: relative;
  font-size: 0.75rem;
  text-align: center;
}

.admin-tabs button:hover {
  background: var(--background);
  color: var(--text);
}

.admin-tabs button.active {
  background: var(--primary);
  color: white;
}

.stats-bar {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.stat {
  background: var(--surface);
  padding: 0.75rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
  text-align: center;
  transition: all 0.2s ease;
}

.stat:hover {
  transform: translateY(-1px);
}

.stat strong {
  display: block;
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 0.25rem;
}

.stat span {
  font-size: 0.625rem;
  color: var(--text-muted);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  line-height: 1.2;
}

.admin-actions-panel {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  padding: 1rem;
  margin-bottom: 1rem;
}

.admin-actions-panel h3 {
  margin: 0 0 1rem 0;
  font-size: 1rem;
  font-weight: 600;
  color: var(--text);
}

.admin-form .form-row {
  margin-bottom: 1rem;
}

.admin-form label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 500;
  color: var(--text);
  font-size: 0.75rem;
}

.admin-form select,
.admin-form input,
.admin-form textarea {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  font-size: 0.75rem;
  transition: all 0.2s ease;
  background: var(--background);
  color: var(--text);
  box-sizing: border-box;
}

.admin-form select:focus,
.admin-form input:focus,
.admin-form textarea:focus {
  outline: none;
  border-color: var(--primary);
}

.form-row .action-group {
  display: flex;
  gap: 0.5rem;
  align-items: end;
  flex-wrap: wrap;
}

.input-group {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  flex: 1;
  min-width: 0;
}

.input-group label {
  margin: 0;
  font-size: 0.625rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
}

.input-group input {
  width: 80px;
  min-width: 60px;
}

.input-group button {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: var(--radius);
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s ease;
  font-size: 0.75rem;
  white-space: nowrap;
}

.input-group button:hover {
  background: var(--primary-hover);
  transform: translateY(-1px);
}

.input-group button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.subscriptions-table {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  overflow: hidden;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

.subscriptions-table h3 {
  margin: 0;
  padding: 0.75rem 1rem;
  background: var(--background);
  border-bottom: 1px solid var(--border-light);
  font-size: 1rem;
  font-weight: 600;
  color: var(--text);
}

.subscriptions-table table {
  width: 100%;
  border-collapse: collapse;
  min-width: 600px;
}

.subscriptions-table th,
.subscriptions-table td {
  padding: 0.5rem 0.75rem;
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.subscriptions-table th {
  background: var(--background);
  font-weight: 600;
  font-size: 0.625rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  white-space: nowrap;
}

.subscriptions-table td {
  font-size: 0.75rem;
  color: var(--text);
  white-space: nowrap;
}

.actions-list {
  max-height: 400px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.action-item {
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  margin-bottom: 0.5rem;
  padding: 1rem;
  background: var(--surface);
  transition: all 0.2s ease;
}

.action-item:hover {
  transform: translateY(-1px);
}

.action-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0.75rem;
  gap: 0.5rem;
}

.action-header strong {
  color: var(--primary);
  font-weight: 600;
  font-size: 0.75rem;
  flex: 1;
}

.action-date {
  color: var(--text-muted);
  font-size: 0.625rem;
  font-weight: 500;
  white-space: nowrap;
}

.action-details p {
  margin: 0.25rem 0;
  font-size: 0.75rem;
  color: var(--text);
}

.action-notes {
  margin-top: 0.75rem;
}

.action-notes pre {
  background: var(--background);
  padding: 0.75rem;
  border-radius: var(--radius);
  font-size: 0.625rem;
  overflow-x: auto;
  border: 1px solid var(--border-light);
  color: var(--text);
  white-space: pre-wrap;
  word-break: break-word;
}

.settings-info,
.quick-stats {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  padding: 1rem;
  margin-bottom: 1rem;
}

.settings-info h4,
.quick-stats h4 {
  margin: 0 0 0.75rem 0;
  color: var(--text);
  font-weight: 600;
  font-size: 1rem;
}

.settings-info p {
  margin: 0.5rem 0;
  color: var(--text);
  font-size: 0.75rem;
}

.quick-stats ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.quick-stats li {
  padding: 0.5rem 0;
  border-bottom: 1px solid var(--border-light);
  color: var(--text);
  display: flex;
  justify-content: space-between;
  font-size: 0.75rem;
  gap: 1rem;
}

.quick-stats li:last-child {
  border-bottom: none;
}

.loading,
.error {
  text-align: center;
  padding: 2rem 1rem;
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  margin: 1rem;
}

.error h3 {
  color: var(--danger);
  margin-bottom: 1rem;
  font-size: 1rem;
}

.loading {
  color: var(--text-muted);
  font-size: 0.875rem;
}

/* CSS Variables handle dark mode automatically through the app's theme system */

/* ==== Responsive Design - Mobile First ==== */
@media (max-width: 480px) {
  .admin-dashboard {
    padding: 0.5rem;
    margin: 0;
  }

  .admin-header {
    flex-direction: column;
    gap: 0.5rem;
    text-align: center;
    padding: 0.75rem;
  }

  .admin-header h2 {
    font-size: 1.125rem;
  }

  .admin-info {
    flex-direction: column;
    gap: 0.25rem;
    font-size: 0.625rem;
  }

  .admin-tabs {
    flex-direction: column;
    gap: 0.125rem;
  }

  .admin-tabs button {
    padding: 0.5rem;
    font-size: 0.75rem;
  }

  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.25rem;
  }

  .stat {
    padding: 0.5rem;
  }

  .stat strong {
    font-size: 1rem;
    margin-bottom: 0.125rem;
  }

  .stat span {
    font-size: 0.5rem;
  }

  .admin-actions-panel {
    padding: 0.75rem;
  }

  .form-row .action-group {
    flex-direction: column;
    gap: 0.5rem;
    align-items: stretch;
  }

  .input-group {
    flex-direction: row;
    align-items: center;
    gap: 0.5rem;
  }

  .input-group label {
    margin: 0;
    min-width: 60px;
    text-align: left;
    font-size: 0.5rem;
  }

  .input-group input {
    width: 60px;
    min-width: 60px;
  }

  .input-group button {
    padding: 0.5rem 0.75rem;
    font-size: 0.625rem;
  }

  .subscriptions-table h3 {
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
  }

  .subscriptions-table th,
  .subscriptions-table td {
    padding: 0.375rem 0.5rem;
    font-size: 0.625rem;
  }

  .action-item {
    padding: 0.75rem;
  }

  .action-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.25rem;
  }

  .action-header strong {
    font-size: 0.625rem;
  }

  .action-date {
    font-size: 0.5rem;
  }

  .action-details p {
    font-size: 0.625rem;
    margin: 0.125rem 0;
  }

  .action-notes pre {
    padding: 0.5rem;
    font-size: 0.5rem;
  }

  .settings-info,
  .quick-stats {
    padding: 0.75rem;
  }

  .settings-info h4,
  .quick-stats h4 {
    font-size: 0.875rem;
  }

  .settings-info p,
  .quick-stats li {
    font-size: 0.625rem;
  }
}

@media (max-width: 360px) {
  .admin-dashboard {
    padding: 0.25rem;
  }

  .stats-bar {
    grid-template-columns: 1fr;
    gap: 0.25rem;
  }

  .stat strong {
    font-size: 0.875rem;
  }

  .stat span {
    font-size: 0.5rem;
  }

  .admin-tabs button {
    padding: 0.375rem;
    font-size: 0.625rem;
  }
}

/* Tablet optimizations */
@media (min-width: 481px) and (max-width: 768px) {
  .admin-dashboard {
    padding: 0.75rem;
  }

  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
  }

  .form-row .action-group {
    flex-wrap: wrap;
    gap: 0.75rem;
  }
}
`;if(typeof document<"u"&&!document.getElementById("admin-dashboard-styles")){const r=document.createElement("style");r.id="admin-dashboard-styles",r.textContent=RI,document.head.appendChild(r)}function jI({featureName:e,onUpgrade:r}){return f.jsxs("div",{className:"feature-locked",children:[f.jsx("div",{className:"lock-icon",children:"🔒"}),f.jsx("h3",{children:e}),f.jsx("p",{children:"This premium feature requires an active subscription."}),f.jsx("button",{className:"upgrade-button",onClick:r,children:"Upgrade to Enforcement Pro"})]})}function My({user:e,fallback:r,children:t}){const{hasAccess:n,isLoading:a}=bm(e);return a?f.jsxs("div",{className:"subscription-loading",children:[f.jsx("div",{className:"spinner-small"}),f.jsx("span",{children:"Checking access..."})]}):n?f.jsx(f.Fragment,{children:t}):r?f.jsx(f.Fragment,{children:r}):f.jsx(jI,{featureName:"Premium Feature",onUpgrade:()=>{console.log("Upgrade clicked - implement subscription flow")}})}function MI({state:e,user:r}){const[t,n]=Y.useState(()=>{const v=new Date;return v.setDate(1),v.toISOString().slice(0,10)}),[a,l]=Y.useState(()=>new Date().toISOString().slice(0,10)),c=Y.useMemo(()=>{const x=(e.completions||[]).filter(K=>{const B=K.timestamp.slice(0,10);return B>=t&&B<=a}),y=x.filter(K=>K.outcome==="PIF"),k=y.reduce((K,B)=>{const D=parseFloat(B.amount||"0");return K+(isNaN(D)?0:D)},0),E=x.length,b=y.length,S=x.filter(K=>K.outcome==="Done").length,A=x.filter(K=>K.outcome==="DA").length,R=x.filter(K=>K.outcome==="ARR").length,O=x.reduce((K,B)=>{const D=B.timestamp.slice(0,10);if(K[D]||(K[D]={date:D,pifs:0,total:0,fees:0}),K[D].total++,B.outcome==="PIF"){K[D].pifs++;const te=parseFloat(B.amount||"0");isNaN(te)||(K[D].fees+=te)}return K},{}),N=Object.values(O).map(K=>({...K,bonus:Math.max(0,K.pifs*100-100)})),U=N.reduce((K,B)=>K+B.bonus,0);return{totalPifFees:k,totalAddresses:E,pifCount:b,doneCount:S,daCount:A,arrCount:R,totalBonus:U,dailyStats:N.sort((K,B)=>B.date.localeCompare(K.date))}},[e.completions,t,a]),d=v=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2}).format(v),m=()=>{const v=new Date(t).toLocaleDateString("en-GB"),x=new Date(a).toLocaleDateString("en-GB");return`${v} - ${x}`};return f.jsx(My,{user:r,fallback:f.jsx(BI,{}),children:f.jsxs("div",{className:"earnings-calendar",style:{padding:"1rem"},children:[f.jsx("h2",{children:"Earnings Overview"}),f.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",alignItems:"center",flexWrap:"wrap"},children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"start-date",style:{display:"block",marginBottom:"0.5rem"},children:"From:"}),f.jsx("input",{id:"start-date",type:"date",value:t,onChange:v=>n(v.target.value),className:"input"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"end-date",style:{display:"block",marginBottom:"0.5rem"},children:"To:"}),f.jsx("input",{id:"end-date",type:"date",value:a,onChange:v=>l(v.target.value),className:"input"})]})]}),f.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[f.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[f.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--success)"},children:"Total PIF Fees"}),f.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:d(c.totalPifFees)}),f.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[c.pifCount," PIF completions"]})]}),f.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[f.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Total Addresses"}),f.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:c.totalAddresses}),f.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:m()})]}),f.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[f.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--primary)"},children:"Potential Bonus"}),f.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:d(c.totalBonus)}),f.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"£100/PIF - £100/day"})]}),f.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[f.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Breakdown"}),f.jsxs("div",{style:{fontSize:"0.875rem"},children:[f.jsxs("div",{children:["PIF: ",c.pifCount]}),f.jsxs("div",{children:["Done: ",c.doneCount]}),f.jsxs("div",{children:["DA: ",c.daCount]}),f.jsxs("div",{children:["ARR: ",c.arrCount]})]})]})]}),f.jsxs("div",{children:[f.jsx("h3",{children:"Daily Breakdown"}),c.dailyStats.length===0?f.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No completions found in selected date range"}):f.jsx("div",{style:{overflowX:"auto"},children:f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)"},children:[f.jsx("thead",{children:f.jsxs("tr",{style:{background:"var(--background)"},children:[f.jsx("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid var(--border-light)"},children:"Date"}),f.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIFs"}),f.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Total Addresses"}),f.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIF Fees"}),f.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Bonus"})]})}),f.jsx("tbody",{children:c.dailyStats.map(v=>f.jsxs("tr",{children:[f.jsx("td",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border-light)"},children:new Date(v.date).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})}),f.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:v.pifs}),f.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:v.total}),f.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold"},children:d(v.fees)}),f.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold",color:v.bonus>0?"var(--primary)":"var(--text-muted)"},children:d(v.bonus)})]},v.date))})]})})]})]})})}function BI(){return f.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",margin:"1rem"},children:[f.jsx("h2",{children:"Earnings Tracking"}),f.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--text-muted)"},children:"Track your PIF fees and completion statistics with detailed date range analysis."}),f.jsx("div",{style:{marginBottom:"1rem"},children:f.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",fontSize:"0.875rem"},children:"Premium Feature"})}),f.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Start your free trial to access earnings tracking and reporting."})]})}class zI{currentToken=null;generateToken(){return this.currentToken="session_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36),this.currentToken}getToken(){return this.currentToken}clearToken(){this.currentToken=null}}const Yc=new zI;async function UI(e,r={}){const t="your-new-google-maps-api-key-here";if(!e.trim()||e.length<3)return[];try{const n=r.sessionToken||Yc.generateToken(),a={input:e,sessionToken:n,...r.componentRestrictions&&{regionCode:r.componentRestrictions.country.toUpperCase()},...r.types&&r.types.length>0&&{includedPrimaryTypes:r.types}};console.log("Making Places API (New) autocomplete request:",a);const l=await fetch("https://places.googleapis.com/v1/places:autocomplete",{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":t,"X-Goog-FieldMask":"suggestions.placePrediction.place,suggestions.placePrediction.placeId,suggestions.placePrediction.text"},body:JSON.stringify(a)});if(!l.ok){const d=await l.text();throw console.error("Places API error:",l.status,d),new Error(`Places API error: ${l.status} - ${d}`)}const c=await l.json();return console.log("Places API response:",c),c.suggestions?c.suggestions.filter(d=>d.placePrediction).map(d=>({place_id:d.placePrediction.placeId,description:d.placePrediction.text?.text||"",structured_formatting:{main_text:d.placePrediction.structuredFormat?.mainText?.text||"",secondary_text:d.placePrediction.structuredFormat?.secondaryText?.text||""},types:d.placePrediction.types||[]})):[]}catch(n){throw console.error("Places API autocomplete failed:",n),n}}async function $I(e,r){const t="your-new-google-maps-api-key-here";try{console.log("Getting place details for:",e);const n=`https://places.googleapis.com/v1/places/${e}`,a=await fetch(n,{method:"GET",headers:{"X-Goog-Api-Key":t,"X-Goog-FieldMask":"id,displayName,formattedAddress,location,types"}});if(!a.ok){const c=await a.text();throw console.error("Place details API error:",a.status,c),new Error(`Place details API error: ${a.status} - ${c}`)}const l=await a.json();return console.log("Place details response:",l),r&&Yc.clearToken(),l.id&&l.location?{place_id:l.id,name:l.displayName?.text||"",formatted_address:l.formattedAddress||"",geometry:{location:{lat:l.location.latitude,lng:l.location.longitude}},types:l.types||[]}:null}catch(n){throw console.error("Place details failed:",n),r&&Yc.clearToken(),n}}function WI(){return Yc.getToken()}function ax(){Yc.clearToken()}function By(e){if(e<60)return`${Math.round(e)}s`;const r=Math.floor(e/60);if(r<60)return`${r}m`;const t=Math.floor(r/60),n=r%60;return n>0?`${t}h ${n}m`:`${t}h`}function zy(e){if(e<1e3)return`${Math.round(e)}m`;const r=e/1e3;return r<10?`${r.toFixed(1)}km`:`${Math.round(r)}km`}function Uy(e){return`${Math.round(e*100)}%`}const ix="geocode-cache",l0=720*60*60*1e3;class VI{cache={};isLoadingCache=!1;cacheLoadPromise=null;apiKey;constructor(r){this.apiKey=r,this.cacheLoadPromise=this.loadCache()}async loadCache(){if(this.isLoadingCache)return this.cacheLoadPromise||Promise.resolve();this.isLoadingCache=!0;try{const r=await fm(ix);r&&(this.cache={...r,...this.cache},this.cleanExpiredEntries())}catch(r){console.warn("Failed to load geocoding cache:",r)}finally{this.isLoadingCache=!1,this.cacheLoadPromise=null}}async saveCache(){try{await hm(ix,this.cache)}catch(r){console.warn("Failed to save geocoding cache:",r)}}cleanExpiredEntries(){const r=Date.now(),t=[];for(const[n,a]of Object.entries(this.cache))r-a.timestamp>l0&&t.push(n);for(const n of t)delete this.cache[n];t.length>0&&this.saveCache()}normalizeAddress(r){return r.trim().toLowerCase().replace(/\s+/g," ")}async geocodeAddressInternal(r){if(this.cacheLoadPromise&&await this.cacheLoadPromise,!this.apiKey)return{success:!1,address:r,originalAddress:r,error:"Google Maps API key not configured"};if(!r?.trim())return{success:!1,address:r,originalAddress:r,error:"Empty address provided"};const t=this.normalizeAddress(r),n=this.cache[t];if(n&&Date.now()-n.timestamp<l0)return n.result;try{console.log(`Geocoding with Google Maps SDK: "${r}"`);const{geocodeAddressSDK:a,isGoogleMapsSDKAvailable:l}=await ri(async()=>{const{geocodeAddressSDK:c,isGoogleMapsSDKAvailable:d}=await import("./googleMapsSDK-CCdvlH9E.js");return{geocodeAddressSDK:c,isGoogleMapsSDKAvailable:d}},[]);if(l()){const c=await a(r);if(c.success)return this.cache[t]={result:c,timestamp:Date.now()},this.saveCache().catch(console.warn),c;this.cache[t]={result:c,timestamp:Date.now()},this.saveCache().catch(console.warn)}}catch(a){console.warn("JavaScript SDK geocoding failed, falling back to Supabase Edge Function:",a)}return{success:!1,address:r,originalAddress:r,error:"Google Maps direct geocoding not available"}}getCacheStats(){const r=Date.now();let t=0,n=0;for(const a of Object.values(this.cache))r-a.timestamp<l0?t++:n++;return{totalEntries:Object.keys(this.cache).length,validEntries:t,expiredEntries:n}}async clearCache(){this.cache={},await this.saveCache()}}let c0=null;function Sm(){if(!c0){const e="your-new-google-maps-api-key-here";c0=new VI(e)}return c0}async function HI(e,r,t){const n=Sm(),a=[],l=5;for(let d=0;d<e.length;d+=l){const m=e.slice(d,d+l),v=m.map(y=>n.geocodeAddressInternal(y)),x=await Promise.all(v);a.push(...x),t&&t(a.length,e.length,m[m.length-1]),d+l<e.length&&await new Promise(y=>setTimeout(y,200))}const c=a.filter(d=>!d.success).length;if(c>e.length*.5){console.warn(`${c}/${e.length} addresses failed with direct API, trying Supabase Edge Function...`);try{const{geocodeAddresses:d}=await ri(async()=>{const{geocodeAddresses:v}=await Promise.resolve().then(()=>$y);return{geocodeAddresses:v}},void 0),m=await d(e,t);return a.map((v,x)=>v.success?v:m[x])}catch(d){console.warn("Centralized batch geocoding also failed:",d)}}return a}async function GI(e,r,t="GB",n=5){if(!e.trim()||e.length<3)return[];try{console.log(`Searching addresses with Google Places API: "${e}"`);const l=await UI(e,{componentRestrictions:{country:t.toLowerCase()},types:["street_address","route","premise"]});if(l.length>0)return l.slice(0,n).map(c=>({label:c.description,coordinates:[0,0],confidence:.9,placeId:c.place_id}))}catch(l){console.warn("Google Places API search failed, trying Supabase Edge Function:",l)}try{const{searchAddresses:l}=await ri(async()=>{const{searchAddresses:d}=await Promise.resolve().then(()=>$y);return{searchAddresses:d}},void 0),c=await l(e,t,n);if(c.length>0)return c}catch(l){console.warn("Centralized address search also failed:",l)}const a=Sm();if(a.apiKey)try{const l=await a.geocodeAddressInternal(e);if(l.success&&l.lat&&l.lng)return[{label:l.formattedAddress||l.address,coordinates:[l.lng,l.lat],confidence:l.confidence||.7}]}catch(l){console.warn("Direct geocoding fallback also failed:",l)}return[]}async function ZI(e){if(!e)return null;try{const t=WI()||void 0,n=await $I(e,t);if(ax(),n?.geometry?.location)return{lat:n.geometry.location.lat,lng:n.geometry.location.lng,formattedAddress:n.formatted_address||n.name||""}}catch(t){ax(),console.error("Failed to resolve place details with new API:",t)}const r=Sm();if(r.apiKey)try{const t=await r.geocodeAddressInternal(e);if(t.success&&t.lat&&t.lng)return{lat:t.lat,lng:t.lng,formattedAddress:t.formattedAddress||t.address}}catch(t){console.warn("Geocoding fallback for place resolution failed:",t)}return null}async function KI(e,r){if(!We)throw new Error("Supabase client not available");try{console.log(`Geocoding ${e.length} addresses via centralized service`);const t=[],n=10;for(let a=0;a<e.length;a+=n){const l=e.slice(a,a+n),{data:c,error:d}=await We.functions.invoke("geocode",{body:{addresses:l,countryCode:"GB"}});if(d){console.error("Geocoding batch error:",d);const m=l.map(v=>({success:!1,address:v,originalAddress:v,error:d.message||"Geocoding service error"}));t.push(...m)}else if(c?.results)t.push(...c.results);else{console.error("Unexpected geocoding response:",c);const m=l.map(v=>({success:!1,address:v,originalAddress:v,error:"Unexpected service response"}));t.push(...m)}r&&r(t.length,e.length,l[l.length-1])}return console.log(`Geocoding completed: ${t.filter(a=>a.success).length}/${t.length} successful`),t}catch(t){return console.error("Geocoding service failed:",t),e.map(n=>({success:!1,address:n,originalAddress:n,error:t instanceof Error?t.message:"Service unavailable"}))}}async function qI(e,r="GB",t=5,n,a){if(!We)return console.error("Supabase client not available for address search"),[];try{if(!e.trim()||e.length<3)return[];const{data:l,error:c}=await We.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:r,limit:Math.min(t,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return c?(console.error("Address search error:",c),[]):l?.results||[]}catch(l){return console.error("Address search failed:",l),[]}}function R0(e){const r=e.lat!==null&&e.lat!==void 0&&e.lng!==null&&e.lng!==void 0&&!isNaN(e.lat)&&!isNaN(e.lng);return{success:r,address:e.address,originalAddress:e.address,lat:r&&e.lat!==null?e.lat:void 0,lng:r&&e.lng!==null?e.lng:void 0,confidence:r?1:void 0,error:r?void 0:"No coordinates available"}}function Bd(e){return{address:e.address,lat:e.success&&e.lat!==void 0?e.lat:null,lng:e.success&&e.lng!==void 0?e.lng:null}}const $y=Object.freeze(Object.defineProperty({__proto__:null,addressRowToGeocodingResult:R0,formatConfidence:Uy,formatDistance:zy,formatDuration:By,geocodeAddresses:KI,geocodingResultToAddressRow:Bd,searchAddresses:qI},Symbol.toStringTag,{value:"Module"}));async function sx(e,r){console.log(`Geocoding ${e.length} addresses via Google Maps (hybrid service)`);try{const t=await HI(e,void 0,r);return console.log(`Google Maps geocoding completed: ${t.filter(n=>n.success).length}/${t.length} successful`),t}catch(t){return console.error("Google Maps geocoding service failed:",t),e.map(n=>({success:!1,address:n,originalAddress:n,error:t instanceof Error?t.message:"Google Maps service unavailable"}))}}async function YI(e,r="GB",t=5,n,a){try{const l=await GI(e);if(l.length>0)return l.slice(0,t)}catch(l){console.warn("Google Maps search failed, falling back to centralized service:",l)}if(!We)return console.error("No search services available"),[];try{if(!e.trim()||e.length<3)return[];const{data:l,error:c}=await We.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:r,limit:Math.min(t,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return c?(console.error("Address search error:",c),[]):l?.results||[]}catch(l){return console.error("Address search failed:",l),[]}}async function XI(e,r,t){if(!We)throw new Error("Supabase client not available");try{const n=e.map((d,m)=>({...d,originalIndex:m})).filter(({lat:d,lng:m})=>d!=null&&m!==null&&m!==void 0&&!isNaN(d)&&!isNaN(m));if(n.length===0)return{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((d,m)=>m),error:"No addresses have valid coordinates for route optimization"};if(n.length===1)return{success:!0,optimizedOrder:[n[0].originalIndex],totalDistance:0,totalDuration:0,unassigned:[]};console.log(`Optimizing route for ${n.length} addresses via OpenRouteService (hybrid service)`);const a={addresses:n.map(d=>({address:d.address,lat:d.lat,lng:d.lng})),startLocation:r,endLocation:t};console.log("Route optimization request:",{addressCount:a.addresses.length,hasStartLocation:!!r,hasEndLocation:!!t,firstAddress:a.addresses[0]});let l=null,c=null;try{const d="https://eevfxrgemrtthxbcxtvq.supabase.co",m="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",v=`${d}/functions/v1/optimize-route`,x=(await We.auth.getSession()).data.session?.access_token;console.log("Making direct request to Edge Function:",{url:v,hasAuthToken:!!x,requestBodySize:JSON.stringify(a).length});const y={"Content-Type":"application/json",apikey:m};x&&(y.Authorization=`Bearer ${x}`);const k=await fetch(v,{method:"POST",headers:y,body:JSON.stringify(a)});if(console.log("Edge Function response status:",{status:k.status,statusText:k.statusText,ok:k.ok,headers:Object.fromEntries(k.headers.entries())}),k.ok)l=await k.json();else{const E=await k.text();console.error("Edge Function error response:",{status:k.status,statusText:k.statusText,body:E});try{const b=JSON.parse(E);c=new Error(`Edge Function error (${k.status}): ${b.error||E}`)}catch{c=new Error(`Edge Function error (${k.status}): ${E}`)}}}catch(d){console.error("Failed to make direct request to Edge Function:",d);const m=await We.functions.invoke("optimize-route",{body:a});l=m.data,c=m.error}if(c){console.error("Route optimization error details:",{error:c,errorMessage:c.message,errorName:c.name,errorStack:c.stack,data:l});let d=`Route optimization service error: ${c.message||"Unknown error"}`;return c.message?.includes("OpenRouteService API key")?d="Route optimization service not configured. Please contact support.":c.message?.includes("non-2xx status code")?d="Route optimization service is temporarily unavailable. Please try again later.":c.message?.includes("Unauthorized")?d="Authentication required. Please log in again.":c.message?.includes("Subscription required")?d="Route optimization requires an active subscription.":c.message?.includes("OpenRouteService API error")?d=`OpenRouteService API error: ${c.message.split("OpenRouteService API error: ")[1]||c.message}`:c.message?.includes("Maximum 100 addresses")?d="Too many addresses. Maximum 100 addresses allowed per optimization.":c.message?.includes("No addresses have valid coordinates")&&(d="No addresses have valid coordinates for route optimization."),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((m,v)=>v),error:d}}return console.log("Route optimization response received:",{hasData:!!l,dataKeys:l?Object.keys(l):null,success:l?.success}),l?(console.log(`Route optimization completed: ${l.optimizedOrder?.length||0} addresses optimized`),l):(console.error("Route optimization: No data received from Edge Function"),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((d,m)=>m),error:"No response from optimization service"})}catch(n){return console.error("Route optimization failed:",n),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((a,l)=>l),error:n instanceof Error?n.message:"Unknown error occurred"}}}async function JI(e,r,t){if(!We)return{success:!1,routeSegments:[],error:"Supabase client not available"};try{const n=[];t&&n.push(t);for(const c of r){const d=e[c];d.lat&&d.lng&&n.push([d.lng,d.lat])}if(n.length<2)return{success:!1,routeSegments:[],error:"Need at least 2 waypoints to generate route"};const{data:a,error:l}=await We.functions.invoke("get-route-directions",{body:{coordinates:n,profile:"driving-car"}});return l?(console.error("Route directions error:",l),{success:!1,routeSegments:[],error:l.message||"Failed to get route directions"}):{success:!0,routeSegments:a?.segments||[],error:void 0}}catch(n){return console.error("Failed to get route directions:",n),{success:!1,routeSegments:[],error:n instanceof Error?n.message:"Unknown error occurred"}}}function QI({id:e,value:r,onChange:t,onSelect:n,placeholder:a="Start typing an address...",disabled:l=!1,className:c="input"}){const[d,m]=Y.useState([]),[v,x]=Y.useState(!1),[y,k]=Y.useState(!1),[E,b]=Y.useState(-1),S=Y.useRef(null),A=Y.useRef(null),R=Y.useRef(),O=Y.useCallback(async D=>{if(!D.trim()||D.length<3){Y.startTransition(()=>{m([]),k(!1)});return}x(!0);try{const te=await YI(D);Y.startTransition(()=>{m(te),k(te.length>0),b(-1)})}catch(te){console.error("Address search failed:",te),Y.startTransition(()=>{m([]),k(!1)})}finally{x(!1)}},[]),N=D=>{const te=D.target.value;t(te),R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{O(te)},300)},U=async D=>{if(D.placeId){x(!0);try{const te=await ZI(D.placeId);te?(t(D.label),n(D.label,te.lat,te.lng)):(t(D.label),n(D.label,0,0))}catch(te){console.error("Failed to resolve place details:",te),t(D.label),n(D.label,0,0)}finally{x(!1)}}else{const[te,ee]=D.coordinates;t(D.label),n(D.label,ee,te)}Y.startTransition(()=>{k(!1),b(-1),m([])}),setTimeout(()=>{S.current?.blur()},0)},K=D=>{if(!(!y||d.length===0))switch(D.key){case"ArrowDown":D.preventDefault(),b(te=>te<d.length-1?te+1:te);break;case"ArrowUp":D.preventDefault(),b(te=>te>0?te-1:-1);break;case"Enter":D.preventDefault(),E>=0&&E<d.length&&U(d[E]);break;case"Escape":Y.startTransition(()=>{k(!1),b(-1)}),setTimeout(()=>{S.current?.blur()},0);break}};Y.useEffect(()=>{const D=te=>{try{S.current&&!S.current.contains(te.target)&&A.current&&!A.current.contains(te.target)&&Y.startTransition(()=>{k(!1),b(-1)})}catch(ee){console.debug("Click outside detection error (ignoring):",ee)}};return document.addEventListener("mousedown",D),()=>{try{document.removeEventListener("mousedown",D)}catch(te){console.debug("Event listener cleanup error (ignoring):",te)}}},[]),Y.useEffect(()=>()=>{R.current&&clearTimeout(R.current)},[]);const B=D=>D>=.8?"var(--success)":D>=.5?"var(--warning)":"var(--danger)";return f.jsxs("div",{style:{position:"relative",width:"100%"},children:[f.jsxs("div",{style:{position:"relative"},children:[f.jsx("input",{id:e,ref:S,name:"address",type:"text",value:r,onChange:N,onKeyDown:K,onFocus:()=>{d.length>0&&k(!0)},placeholder:a,disabled:l,className:c,style:{width:"100%",paddingRight:v?"2.5rem":"1rem"},autoComplete:"off"}),v&&f.jsx("div",{style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem"},children:f.jsx("div",{className:"spinner",style:{width:"100%",height:"100%"}})})]}),y&&d.length>0&&f.jsx("div",{ref:A,style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",maxHeight:"300px",overflowY:"auto",marginTop:"0.25rem"},children:d.map((D,te)=>f.jsxs("button",{onClick:()=>{setTimeout(()=>U(D),0)},style:{width:"100%",padding:"0.75rem 1rem",border:"none",background:E===te?"var(--primary-light)":"transparent",color:E===te?"var(--primary)":"var(--text-primary)",textAlign:"left",cursor:"pointer",borderBottom:te<d.length-1?"1px solid var(--border-light)":"none",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem",lineHeight:"1.4"},onMouseEnter:()=>b(te),children:[f.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis"},children:D.label}),f.jsxs("span",{style:{fontSize:"0.75rem",color:B(D.confidence),marginLeft:"0.5rem",flexShrink:0},title:`Confidence: ${Math.round(D.confidence*100)}%`,children:[Math.round(D.confidence*100),"%"]})]},`${D.label}-${te}`))}),y&&d.length===0&&!v&&r.length>=3&&f.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",padding:"1rem",marginTop:"0.25rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.875rem"},children:/[A-Z]{1,2}[0-9]{1,2}\s?[0-9][A-Z]{2}/i.test(r)?"Address not found. Try removing the house number or use just the postcode.":'No addresses found. Try including the postcode (e.g., "High Street SW1A 1AA").'})]})}function eD(e,r,t,n){let a="marker-pin";return r?a+=" marker-start":t?n!==void 0&&(n<.5?a+=" marker-low-confidence":n<.8&&(a+=" marker-medium-confidence")):a+=" marker-not-geocoded",qc.divIcon({className:"custom-numbered-marker",html:`<div class="${a}">
      <div class="marker-number">${r?"🏠":e}</div>
    </div>`,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]})}function tD({pins:e}){const r=Iy();return Y.useEffect(()=>{if(e.length!==0)if(e.length===1){const t=e[0];r.setView([t.lat,t.lng],15)}else{const t=new qc.FeatureGroup(e.map(n=>qc.marker([n.lat,n.lng])));r.fitBounds(t.getBounds().pad(.1))}},[r,e.length]),null}function rD({addresses:e,startingPointIndex:r,onStartingPointChange:t,optimizedOrder:n,showRouteLines:a=!1,confidences:l}){const[c,d]=Y.useState([]),[m,v]=Y.useState(!1),k=e.map((O,N)=>({id:`pin-${N}`,address:O.address,lat:O.lat||0,lng:O.lng||0,isStart:N===r,isGeocoded:!!(O.lat&&O.lng),confidence:l?.[N]})).filter(O=>O.isGeocoded),E=Y.useRef("");Y.useEffect(()=>{async function O(){if(!a||!n||n.length<2){d([]),E.current="";return}const N=n.filter(K=>K<0||K>=e.length);if(N.length>0){console.error("Invalid optimizedOrder indices:",N),d([]);return}const U=`${n.join(",")}-${r}`;if(E.current!==U){v(!0);try{const K=r!==void 0&&e[r]?[e[r].lng,e[r].lat]:void 0,B=await JI(e,n,K);B.success?(d(B.routeSegments),E.current=U):(console.error("Route directions failed:",B.error),d([]))}catch(K){console.error("Route directions error:",K),d([])}finally{v(!1)}}}O()},[a,n,e.length,r]);const b=O=>{t(r===O?null:O)},S=(O,N)=>N<=1?"#3388ff":`hsl(${(1-O/(N-1))*120}, 70%, 50%)`,A=[54.5,-2];return f.jsxs("div",{style:{height:"100%",width:"100%"},children:[f.jsxs(Dy,{center:A,zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[f.jsx(Fy,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),f.jsx(tD,{pins:k}),k.map((O,N)=>{const U=e.findIndex(K=>K.lat===O.lat&&K.lng===O.lng&&K.address===O.address);return f.jsx(Oy,{position:[O.lat,O.lng],icon:eD(N+1,O.isStart,O.isGeocoded,O.confidence),children:f.jsx(F0,{children:f.jsxs("div",{style:{minWidth:"200px"},children:[f.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:O.address}),f.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.5rem"},children:["Lat: ",O.lat.toFixed(6),", Lng: ",O.lng.toFixed(6)]}),O.confidence&&f.jsxs("div",{style:{fontSize:"0.875rem",marginBottom:"0.5rem",color:O.confidence>=.8?"var(--success)":O.confidence>=.5?"var(--warning)":"var(--danger)"},children:["Confidence: ",Math.round(O.confidence*100),"%"]}),f.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:f.jsx("button",{onClick:()=>b(U),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:O.isStart?"var(--success)":"var(--primary)",color:"white",border:"none",borderRadius:"var(--radius)",cursor:"pointer"},children:O.isStart?"🏁 Starting Point":"📍 Set as Start"})})]})})},O.id)}),a&&c.map((O,N)=>{const U=O.geometry.map(K=>[K[1],K[0]]);return f.jsx(iI,{positions:U,color:S(N,c.length),weight:4,opacity:.8,dashArray:N===0?void 0:"5, 5",children:f.jsx(F0,{children:f.jsxs("div",{children:[f.jsxs("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:["Route Segment ",N+1]}),f.jsxs("div",{style:{fontSize:"0.875rem"},children:["Distance: ",(O.distance/1e3).toFixed(1)," km",f.jsx("br",{}),"Duration: ",Math.round(O.duration/60)," min"]})]})})},`route-segment-${N}`)})]}),m&&f.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",background:"var(--surface)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",boxShadow:"var(--shadow)",fontSize:"0.875rem",zIndex:1e3},children:"🗺️ Loading route directions..."}),f.jsx("style",{children:`
        /* Custom Numbered Markers */
        .custom-numbered-marker {
          background: transparent;
          border: none;
        }

        .marker-pin {
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .marker-pin::before {
          content: '';
          position: absolute;
          width: 36px;
          height: 36px;
          background: var(--primary);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          border: 3px solid white;
        }

        .marker-pin.marker-start::before {
          background: var(--success);
          animation: markerPulse 2s ease-in-out infinite;
        }

        .marker-pin.marker-not-geocoded::before {
          background: var(--gray-400);
        }

        .marker-pin.marker-low-confidence::before {
          background: var(--danger);
        }

        .marker-pin.marker-medium-confidence::before {
          background: var(--warning);
        }

        @keyframes markerPulse {
          0%, 100% {
            transform: rotate(-45deg) scale(1);
          }
          50% {
            transform: rotate(-45deg) scale(1.1);
          }
        }

        .marker-number {
          position: relative;
          z-index: 1;
          color: white;
          font-weight: bold;
          font-size: 0.875rem;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
          transform: translateY(-2px);
        }

        /* Leaflet Popup Override for Dark Mode */
        .leaflet-popup-content-wrapper {
          background: var(--surface) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--border) !important;
          box-shadow: 0 3px 14px rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-tip {
          background: var(--surface) !important;
          border: 1px solid var(--border) !important;
        }

        .leaflet-popup-close-button {
          color: var(--text-primary) !important;
        }

        .leaflet-popup-close-button:hover {
          color: var(--primary) !important;
        }
      `})]})}function nD({user:e,onAddressesReady:r}){const[t,n]=Y.useState([]),[a,l]=Y.useState(""),[c,d]=Y.useState(!1),[m,v]=Y.useState(!1),[x,y]=Y.useState(null),[k,E]=Y.useState(!0),[b,S]=Y.useState(!1),[A,R]=Y.useState(null),[O,N]=Y.useState(null),U=Y.useCallback(j=>{const G=j.map(R0);n(G),N(null),y(null)},[]),K=()=>{if(!a.trim())return;const j={success:!1,address:a.trim(),originalAddress:a.trim(),error:"Not geocoded yet"};Y.startTransition(()=>{n(G=>[...G,j]),l(""),N(null)})},B=(j,G,Z)=>{const oe={success:!0,address:j,originalAddress:j,lat:G,lng:Z,confidence:1,formattedAddress:j};Y.startTransition(()=>{n(I=>[...I,oe]),l(""),N(null)})},D=j=>{Y.startTransition(()=>{n(G=>G.filter((Z,oe)=>oe!==j)),N(null),x===j?y(null):x!==null&&x>j&&y(x-1)})},te=(j,G)=>{Y.startTransition(()=>{n(Z=>Z.map((oe,I)=>I===j?{...oe,address:G,success:!1,error:"Modified - needs geocoding"}:oe)),N(null)})},ee=async j=>{const G=t[j];if(!G.success)try{const Z=await sx([G.address]),oe=[...t];oe[j]=Z[0],n(oe),N(null)}catch(Z){console.error("Single geocoding failed:",Z),alert("Geocoding failed. Please check your connection and subscription.")}},ve=(j,G,Z)=>{const oe=[...t];oe[j]={...oe[j],lat:G,lng:Z,success:G!==void 0&&Z!==void 0,formattedAddress:oe[j].formattedAddress||oe[j].address,error:G!==void 0&&Z!==void 0?void 0:"Manual coordinates incomplete"},n(oe),N(null)},me=async()=>{const j=t.map((G,Z)=>({addr:G,index:Z})).filter(({addr:G})=>!G.success);if(j.length===0){alert("All addresses are already geocoded!");return}v(!0),R({completed:0,total:j.length,current:""});try{const G=j.map(({addr:I})=>I.address),Z=await sx(G,(I,P,F)=>{R({completed:I,total:P,current:F})}),oe=[...t];j.forEach(({index:I},P)=>{oe[I]=Z[P]}),n(oe),N(null)}catch(G){console.error("Batch geocoding failed:",G),alert("Geocoding failed. Please check your connection and subscription.")}finally{v(!1),R(null)}},J=async()=>{const j=t.filter(G=>G.success&&G.lat&&G.lng);if(j.length===0){alert("No addresses with valid coordinates available for optimization");return}if(j.length<t.length){const G=t.length-j.length;if(!confirm(`${G} addresses don't have coordinates and will be excluded from optimization. Continue?`))return}d(!0),N(null);try{const G=t.map(Bd);let Z;if(x!==null&&x>=0){const I=t[x];I.success&&I.lat&&I.lng&&(Z=[I.lng,I.lat])}const oe=await XI(G,Z);if(N({optimizedOrder:oe.optimizedOrder,totalDistance:oe.totalDistance,totalDuration:oe.totalDuration,unassigned:oe.unassigned,error:oe.error}),oe.success&&oe.optimizedOrder.length>0){const I=oe.optimizedOrder.map(P=>t[P]);if(n(I),N({optimizedOrder:I.map((P,F)=>F),totalDistance:oe.totalDistance,totalDuration:oe.totalDuration,unassigned:oe.unassigned,error:oe.error}),x!==null){const P=oe.optimizedOrder.indexOf(x);y(P>=0?P:null)}}}catch(G){console.error("Route optimization failed:",G),N({optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:[],error:G instanceof Error?G.message:"Optimization failed"})}finally{d(!1)}},ce=()=>{const j=t.map(Bd);r(j),alert(`Exported ${j.length} addresses to your main address list!`)},ke=()=>{confirm("Are you sure you want to clear all addresses?")&&(n([]),N(null),y(null))},se=j=>{const G=j.map(R0);n(G),N(null)},ue={total:t.length,geocoded:t.filter(j=>j.success).length,needsGeocoding:t.filter(j=>!j.success).length,highConfidence:t.filter(j=>j.success&&(j.confidence||0)>=.8).length,lowConfidence:t.filter(j=>j.success&&(j.confidence||0)<.5).length};return f.jsx(My,{user:e,fallback:f.jsx(aD,{}),children:f.jsxs("div",{className:"route-planning",style:{maxWidth:"100%",padding:"0"},children:[!1,t.length===0&&f.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)",overflow:"hidden"},children:[f.jsxs("button",{onClick:()=>S(!b),style:{width:"100%",padding:"1rem 1.5rem",background:"transparent",border:"none",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",color:"var(--text-primary)",fontSize:"1rem",fontWeight:"600"},children:[f.jsx("span",{children:"📁 Import Excel File"}),f.jsx("span",{style:{fontSize:"1.25rem"},children:b?"▼":"▶"})]}),b&&f.jsx("div",{style:{padding:"0 1.5rem 1.5rem 1.5rem"},children:f.jsx(W1,{onImported:U})})]}),t.length>0&&f.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[f.jsx("h3",{style:{margin:0,fontSize:"1.125rem",color:"var(--text-primary)"},children:"🗺️ Map View"}),f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>E(!k),children:k?"Hide":"Show"})]}),k&&f.jsx("div",{style:{height:"400px",borderRadius:"var(--radius-md)",overflow:"hidden",border:"1px solid var(--border)"},children:f.jsx(rD,{addresses:t.map(Bd),onAddressesUpdate:se,startingPointIndex:x??void 0,onStartingPointChange:y,optimizedOrder:O?.optimizedOrder,showRouteLines:!!O&&!O.error,confidences:t.map(j=>j.confidence)})})]}),f.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[f.jsxs("div",{style:{marginBottom:"1rem"},children:[f.jsx(QI,{id:"manual-address-input",value:a,onChange:l,onSelect:B,placeholder:"Type an address to add...",disabled:!1}),f.jsx("button",{className:"btn btn-primary",onClick:K,disabled:!a.trim(),style:{width:"100%",marginTop:"0.5rem",padding:"0.75rem",fontSize:"0.9375rem",fontWeight:"600"},children:"+ Add Address"})]}),O&&f.jsx("div",{style:{marginBottom:"1rem",padding:"1rem",background:"var(--surface)",border:O.error?"2px solid var(--danger)":"2px solid var(--success)",borderRadius:"var(--radius-md)",color:O.error?"var(--danger)":"var(--success)"},children:O.error?f.jsxs(f.Fragment,{children:[f.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.25rem",fontSize:"0.9375rem"},children:"❌ Optimization Failed"}),f.jsx("div",{style:{fontSize:"0.8125rem"},children:O.error})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem",fontSize:"0.9375rem"},children:"✓ Route Optimized"}),f.jsxs("div",{style:{fontSize:"0.8125rem",lineHeight:"1.5"},children:[f.jsxs("div",{children:["📍 ",O.optimizedOrder.length," stops"]}),f.jsxs("div",{children:["🚗 ",By(O.totalDuration)]}),f.jsxs("div",{children:["📏 ",zy(O.totalDistance)]})]})]})}),t.length>0&&ue.geocoded>=2&&f.jsx("button",{className:"btn btn-primary",onClick:J,disabled:c,style:{width:"100%",padding:"0.875rem",fontSize:"1rem",fontWeight:"600"},children:c?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"spinner",style:{display:"inline-block",width:"1rem",height:"1rem",marginRight:"0.5rem"}}),"Optimizing..."]}):`🗺️ Optimize ${ue.geocoded} Address${ue.geocoded>1?"es":""}`})]}),t.length>0&&f.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[f.jsxs("div",{style:{marginBottom:"1rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",gap:"0.5rem",flexWrap:"wrap"},children:[f.jsx("h3",{style:{margin:0,fontSize:"1.125rem",color:"var(--text-primary)"},children:O&&!O.error&&O.optimizedOrder.length>0?"📍 Optimized Route":`Addresses (${t.length})`}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[ue.needsGeocoding>0&&f.jsx("button",{className:"btn btn-primary btn-sm",onClick:me,disabled:m,style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem",whiteSpace:"nowrap"},children:m?f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"spinner",style:{display:"inline-block",width:"0.875rem",height:"0.875rem",marginRight:"0.25rem"}}),"Geocoding..."]}):`🌍 Geocode ${ue.needsGeocoding}`}),x!==null&&f.jsxs("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-md)",fontSize:"0.75rem",fontWeight:"600"},children:["Start: #",x+1]})]})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"space-around",gap:"0.5rem",padding:"0.75rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)",fontSize:"0.75rem"},children:[f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--primary)"},children:ue.total}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Total"})]}),f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--success)"},children:ue.geocoded}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Ready"})]}),f.jsxs("div",{style:{textAlign:"center"},children:[f.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--warning)"},children:ue.needsGeocoding}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Pending"})]})]})]}),A&&f.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--primary-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--primary)"},children:[f.jsxs("div",{style:{marginBottom:"0.5rem",fontWeight:"600",color:"var(--primary)",fontSize:"0.875rem"},children:["Geocoding ",A.completed," of ",A.total]}),f.jsx("div",{style:{background:"var(--gray-200)",borderRadius:"999px",height:"0.375rem",overflow:"hidden"},children:f.jsx("div",{style:{background:"var(--primary)",height:"100%",width:`${A.completed/A.total*100}%`,transition:"width 0.3s ease",borderRadius:"999px"}})})]}),f.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",margin:"0 -1.5rem",padding:"0 1.5rem"},children:[...t].sort((j,G)=>!j.success&&G.success?-1:j.success&&!G.success?1:0).map(j=>{const G=t.indexOf(j);return f.jsxs("div",{style:{padding:"1rem",borderBottom:G<t.length-1?"1px solid var(--border-light)":"none",display:"flex",alignItems:"flex-start",gap:"0.75rem",background:G===x?"var(--primary-light)":"transparent",borderRadius:"var(--radius-md)",marginBottom:G<t.length-1?"0.5rem":"0"},children:[f.jsx("div",{style:{minWidth:"2rem",height:"2rem",borderRadius:"50%",background:G===x?"var(--primary)":j.success?"var(--success)":"var(--warning)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0,cursor:"pointer"},onClick:()=>y(G===x?null:G),title:G===x?"Remove as starting point":"Set as starting point",children:G===x?"🏠":G+1}),f.jsxs("div",{style:{flex:1,minWidth:0},children:[f.jsx("input",{name:`address-${G}`,type:"text",value:j.address,onChange:Z=>te(G,Z.target.value),className:"input",style:{width:"100%",marginBottom:"0.5rem",fontSize:"0.9375rem",padding:"0.5rem",border:"1px solid var(--border)"}}),f.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",lineHeight:"1.4"},children:j.success?f.jsxs(f.Fragment,{children:[f.jsx("span",{style:{color:"var(--success)"},children:"✓"})," ",j.formattedAddress||j.address,j.confidence&&f.jsx("span",{style:{display:"inline-block",marginLeft:"0.5rem",padding:"0.125rem 0.5rem",borderRadius:"999px",background:j.confidence>=.8?"var(--success-light)":j.confidence>=.5?"var(--warning-light)":"var(--danger-light)",color:j.confidence>=.8?"var(--success-dark)":j.confidence>=.5?"var(--warning-dark)":"var(--danger-dark)",fontSize:"0.75rem",fontWeight:"600"},children:Uy(j.confidence)})]}):f.jsxs("span",{style:{color:"var(--warning)"},children:["⚠️ ",j.error]})}),!j.success&&f.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem",alignItems:"center"},children:[f.jsx("input",{type:"number",step:"any",placeholder:"Latitude",value:j.lat??"",onChange:Z=>{const oe=Z.target.value?parseFloat(Z.target.value):void 0;ve(G,oe,j.lng)},className:"input",style:{flex:1,fontSize:"0.75rem",padding:"0.375rem 0.5rem",border:"1px solid var(--border)"}}),f.jsx("input",{type:"number",step:"any",placeholder:"Longitude",value:j.lng??"",onChange:Z=>{const oe=Z.target.value?parseFloat(Z.target.value):void 0;ve(G,j.lat,oe)},className:"input",style:{flex:1,fontSize:"0.75rem",padding:"0.375rem 0.5rem",border:"1px solid var(--border)"}})]})]}),f.jsxs("div",{style:{display:"flex",gap:"0.25rem",flexShrink:0},children:[!j.success&&f.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>ee(G),title:"Geocode this address",style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem",minWidth:"auto"},children:"🌍"}),f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>D(G),title:"Remove",style:{padding:"0.5rem",minWidth:"auto",fontSize:"1.125rem"},children:"✕"})]})]},G)})})]}),t.length>0&&f.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginBottom:"1rem"},children:[f.jsx("button",{className:"btn btn-success",onClick:ce,style:{flex:1,padding:"0.875rem",fontSize:"1rem",fontWeight:"600"},children:"📤 Export to Main List"}),f.jsx("button",{className:"btn btn-ghost",onClick:ke,style:{padding:"0.875rem",fontSize:"1rem"},children:"🗑️"})]}),t.length===0&&f.jsxs("div",{style:{textAlign:"center",padding:"3rem 1.5rem",background:"var(--surface)",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[f.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"🗺️"}),f.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--text-primary)"},children:"Start Planning Your Route"}),f.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem",fontSize:"0.9375rem"},children:"Import addresses from Excel or add them manually"})]})]})})}function aD(){return f.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--gray-100)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",boxShadow:"var(--shadow-sm)",color:"var(--gray-800)"},children:[f.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"🗺️"}),f.jsx("h2",{children:"Route Planning"}),f.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--gray-500)"},children:"Plan your daily routes with intelligent address geocoding and route optimization."}),f.jsx("div",{style:{marginBottom:"1.5rem"},children:f.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius-md)",fontSize:"0.875rem"},children:"Premium Feature"})}),f.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--gray-500)",textAlign:"left",maxWidth:"400px",margin:"0 auto"},children:[f.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Import addresses from Excel"}),f.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Google-style address autocomplete"}),f.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Automatic geocoding with confidence scores"}),f.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Intelligent route optimization"}),f.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Manual address correction"}),f.jsx("div",{children:"✅ Export to main address list"})]})]})}function iD({onSetupComplete:e,onSkip:r,isOpen:t}){const[n,a]=Xt.useState(""),[l,c]=Xt.useState(""),[d,m]=Xt.useState(!1),[v,x]=Xt.useState("idle"),[y,k]=Xt.useState("");if(!t)return null;const E=async()=>{if(!n||!l){k("Please enter both URL and key");return}m(!0),x("idle"),k("");try{if(!new URL(n).hostname.includes("supabase"))throw new Error("URL should be a Supabase project URL (e.g., https://your-project.supabase.co)");const A=yy(n,l),{data:R,error:O}=await A.auth.getSession();if(O&&O.message!=="Auth session missing!")throw O;x("success"),_e.info("Supabase connection test successful")}catch(S){x("error"),k(S.message||"Connection failed"),_e.error("Supabase connection test failed:",S)}finally{m(!1)}},b=()=>{v==="success"&&e(n,l)};return f.jsxs("div",{className:"modal-overlay",children:[f.jsxs("div",{className:"modal-content",style:{maxWidth:"600px"},children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{children:"📁 Optional: Connect Your Own Cloud Storage"}),f.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem"},children:"Set up your own Supabase project for cloud backup and sync (completely optional)"})]}),f.jsxs("div",{className:"modal-body",children:[f.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--blue-50)",borderRadius:"var(--radius-md)",border:"1px solid var(--blue-200)"},children:[f.jsx("h4",{style:{margin:"0 0 0.5rem",color:"var(--blue-700)"},children:"📋 Quick Setup Instructions"}),f.jsxs("ol",{style:{margin:0,paddingLeft:"1.2rem",color:"var(--blue-600)",fontSize:"0.9rem"},children:[f.jsxs("li",{children:["Go to ",f.jsx("a",{href:"https://supabase.com",target:"_blank",rel:"noopener",children:"supabase.com"})," and create a free account"]}),f.jsx("li",{children:"Create a new project (choose any name/region)"}),f.jsx("li",{children:"Go to Settings → API in your project dashboard"}),f.jsx("li",{children:"Copy your Project URL and anon/public key below"})]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{htmlFor:"supabase-url",children:"Project URL *"}),f.jsx("input",{id:"supabase-url",type:"url",value:n,onChange:S=>a(S.target.value),placeholder:"https://your-project-id.supabase.co",style:{fontFamily:"monospace"}})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{htmlFor:"supabase-key",children:"Anonymous/Public Key *"}),f.jsx("textarea",{id:"supabase-key",value:l,onChange:S=>c(S.target.value),placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",rows:3,style:{fontFamily:"monospace",fontSize:"0.85rem"}})]}),v==="success"&&f.jsx("div",{style:{padding:"0.75rem",background:"var(--green-50)",border:"1px solid var(--green-200)",borderRadius:"var(--radius-md)",color:"var(--green-700)"},children:"✅ Connection successful! Your Supabase project is ready."}),v==="error"&&f.jsxs("div",{style:{padding:"0.75rem",background:"var(--red-50)",border:"1px solid var(--red-200)",borderRadius:"var(--radius-md)",color:"var(--red-700)"},children:["❌ ",y]}),f.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[f.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem"},children:"🔒 Privacy & Security"}),f.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--gray-600)"},children:[f.jsx("li",{children:"Your credentials are stored locally in your browser only"}),f.jsx("li",{children:"All data goes directly to YOUR Supabase project"}),f.jsx("li",{children:"We never see or access your data"}),f.jsx("li",{children:"You can disconnect at any time"})]})]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Skip (Use Offline Only)"}),f.jsx("button",{className:"btn btn-primary",onClick:E,disabled:!n||!l||d,children:d?"🔄 Testing...":"🧪 Test Connection"}),f.jsx("button",{className:"btn btn-success",onClick:b,disabled:v!=="success",children:"✅ Save & Connect"})]})]}),f.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: white;
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
          flex-wrap: wrap;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .form-group input,
        .form-group textarea {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-size: 0.9rem;
        }

        .form-group input:focus,
        .form-group textarea:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        @media (max-width: 640px) {
          .modal-footer {
            flex-direction: column;
          }

          .modal-footer button {
            width: 100%;
          }
        }
      `})]})}class Da{static BACKUP_KEY="navigator_local_backups";static MAX_BACKUPS=10;static downloadBackup(r,t){try{const n=new Date().toISOString().replace(/[:.]/g,"-"),a=t||`navigator-backup-${n}.json`,l=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),c=URL.createObjectURL(l),d=document.createElement("a");d.href=c,d.download=a,document.body.appendChild(d),d.click();try{d.parentNode===document.body&&document.body.removeChild(d)}catch(m){_e.warn("Non-critical DOM cleanup error during backup download:",m)}URL.revokeObjectURL(c),_e.info(`Backup downloaded: ${a} (${l.size} bytes)`)}catch(n){throw _e.error("Failed to download backup:",n),n}}static storeLocalBackup(r){try{const t=this.getLocalBackups(),a={timestamp:new Date().toISOString(),data:r,size:JSON.stringify(r).length,version:r._schemaVersion||1};t.unshift(a);const l=t.slice(0,this.MAX_BACKUPS);localStorage.setItem(this.BACKUP_KEY,JSON.stringify(l)),_e.info(`Local backup stored (${l.length}/${this.MAX_BACKUPS})`)}catch(t){_e.error("Failed to store local backup:",t)}}static getLocalBackups(){try{const r=localStorage.getItem(this.BACKUP_KEY);return r?JSON.parse(r):[]}catch(r){return _e.error("Failed to get local backups:",r),[]}}static restoreFromLocalBackup(r){const t=this.getLocalBackups();if(r<0||r>=t.length)throw new Error("Invalid backup index");return t[r].data}static async getStorageUsage(){if("storage"in navigator&&"estimate"in navigator.storage)try{const r=await navigator.storage.estimate(),t=r.usage||0,n=r.quota||0,a=n>0?t/n*100:0;return{used:t,quota:n,percentage:a}}catch(r){_e.warn("Failed to get storage estimate:",r)}return{used:0,quota:0,percentage:0}}static async isStorageLow(){const{percentage:r}=await this.getStorageUsage();return r>80}static createComprehensiveBackup(r){return{version:"1.0",created:new Date().toISOString(),platform:navigator.platform,userAgent:navigator.userAgent.substring(0,100),app:{name:"Navigator Web",version:"1.0.0"},data:r,checksum:lo(r)}}static verifyBackup(r){try{return!r.data||!r.checksum?!1:lo(r.data)===r.checksum}catch(t){return _e.error("Backup verification failed:",t),!1}}static async performCriticalBackup(r,t){try{if(_e.info(`Performing critical backup: ${t}`),this.storeLocalBackup(r),this.shouldDownloadBackup(t)){const l=this.createComprehensiveBackup(r);this.downloadBackup(l,`navigator-critical-${t}-${Date.now()}.json`),_e.info(`Backup file downloaded for critical event: ${t}`)}await this.isStorageLow()&&_e.warn("Browser storage is running low!")}catch(n){throw _e.error("Critical backup failed:",n),n}}static shouldDownloadBackup(r){return["manual","import","day-end","restore","data-loss-risk"].includes(r)}static cleanupOldBackups(){try{const r=this.getLocalBackups(),t=new Date;t.setDate(t.getDate()-30);const n=r.filter(a=>new Date(a.timestamp)>t);n.length!==r.length&&(localStorage.setItem(this.BACKUP_KEY,JSON.stringify(n)),_e.info(`Cleaned up ${r.length-n.length} old backups`))}catch(r){_e.error("Failed to cleanup old backups:",r)}}static getBackupStats(){const r=this.getLocalBackups(),t=r.reduce((l,c)=>l+(c.size||0),0),n=r.length>0?r[r.length-1].timestamp:null,a=r.length>0?r[0].timestamp:null;return{count:r.length,totalSize:t,oldestDate:n,newestDate:a}}}function sD({currentData:e,onRestore:r,isOpen:t,onClose:n}){const[a,l]=Xt.useState([]),[c,d]=Xt.useState({used:0,quota:0,percentage:0}),[m,v]=Xt.useState(!1);Xt.useEffect(()=>{t&&(x(),y())},[t]);const x=()=>{try{const O=Da.getLocalBackups();l(O)}catch(O){_e.error("Failed to load backups:",O)}},y=async()=>{try{const O=await Da.getStorageUsage();d(O)}catch(O){_e.error("Failed to load storage usage:",O)}},k=async()=>{v(!0);try{await Da.performCriticalBackup(e,"manual"),x(),_e.info("Manual backup created successfully")}catch(O){_e.error("Failed to create manual backup:",O)}finally{v(!1)}},E=O=>{try{const N=Da.restoreFromLocalBackup(O);r(N),n()}catch(N){_e.error("Failed to restore from backup:",N)}},b=(O,N)=>{try{const U=new Date(O.timestamp).toISOString().replace(/[:.]/g,"-");Da.downloadBackup(O.data,`navigator-backup-${U}.json`)}catch(U){_e.error("Failed to download backup:",U)}},S=O=>{if(O===0)return"0 B";const N=1024,U=["B","KB","MB","GB"],K=Math.floor(Math.log(O)/Math.log(N));return parseFloat((O/Math.pow(N,K)).toFixed(1))+" "+U[K]},A=O=>new Date(O).toLocaleString(),R=O=>O>80?"var(--danger)":O>60?"var(--warning)":"var(--success)";return t?f.jsxs("div",{className:"modal-overlay",children:[f.jsxs("div",{className:"modal-content",style:{maxWidth:"800px"},children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{children:"💾 Backup Manager"}),f.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem",color:"var(--text-primary)"},children:"Local backups are automatically created and downloaded to prevent data loss"})]}),f.jsxs("div",{className:"modal-body",children:[f.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius-md)"},children:[f.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:"📊 Storage Usage"}),f.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[f.jsx("div",{style:{flex:1,height:"8px",background:"var(--gray-200)",borderRadius:"4px",overflow:"hidden"},children:f.jsx("div",{style:{height:"100%",background:R(c.percentage),width:`${Math.min(c.percentage,100)}%`,transition:"width 0.3s ease"}})}),f.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",minWidth:"60px"},children:[c.percentage.toFixed(1),"%"]})]}),f.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:[S(c.used)," of ",S(c.quota)," used",c.percentage>80&&f.jsx("span",{style:{color:"var(--danger)",fontWeight:500,marginLeft:"0.5rem"},children:"⚠️ Storage running low!"})]})]}),f.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--info-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--info)"},children:[f.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--info-dark)"},children:"📁 Create Manual Backup"}),f.jsx("p",{style:{margin:"0 0 1rem",fontSize:"0.85rem",color:"var(--info-dark)"},children:"Create an immediate backup and download it to your computer for safekeeping."}),f.jsx("button",{className:"btn btn-primary",onClick:k,disabled:m,children:m?"📦 Creating...":"📦 Create & Download Backup"})]}),f.jsxs("div",{children:[f.jsxs("h4",{style:{margin:"0 0 1rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:["📚 Local Backups (",a.length,")"]}),a.length===0?f.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"No local backups found. Create your first backup above!"}):f.jsx("div",{style:{maxHeight:"300px",overflow:"auto"},children:a.map((O,N)=>f.jsx("div",{style:{padding:"1rem",border:"1px solid var(--border-light)",borderRadius:"var(--radius-md)",marginBottom:"0.5rem",background:"var(--surface)"},children:f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[f.jsxs("div",{children:[f.jsx("div",{style:{fontWeight:500,fontSize:"0.9rem",color:"var(--text-primary)"},children:A(O.timestamp)}),f.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:["Size: ",S(O.size||0)," • Version: ",O.version||1]})]}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[f.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>b(O),title:"Download backup file",children:"📥"}),f.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>E(N),title:"Restore from this backup",children:"🔄 Restore"})]})]})},N))})]}),f.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"var(--success-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--success)"},children:[f.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem",color:"var(--success-dark)"},children:"✅ Data Protection Features"}),f.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--success-dark)"},children:[f.jsx("li",{children:"Automatic backups every 5 minutes when data changes"}),f.jsx("li",{children:"Critical backups downloaded after completions"}),f.jsx("li",{children:"Local browser storage with 10 backup rotation"}),f.jsx("li",{children:"Storage monitoring and cleanup"}),f.jsx("li",{children:"Data integrity verification"})]})]})]}),f.jsx("div",{className:"modal-footer",children:f.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Close"})})]}),f.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: var(--surface);
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border-light);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
        }

        .btn-sm {
          padding: 0.375rem 0.75rem;
          font-size: 0.8rem;
        }
      `})]}):null}function oD({settings:e,onUpdateSettings:r,onClose:t}){const[n,a]=Y.useState(e),[l,c]=Y.useState("templates"),[d,m]=Y.useState(null),[v,x]=Y.useState(""),[y,k]=Y.useState(!1),[E,b]=Y.useState(!1),S=async()=>{b(!0);try{if(!n.agentProfile.name.trim()){alert("Agent name is required");return}if(!n.agentProfile.signature.trim()){alert("Agent signature is required");return}if(n.messageTemplates.length===0){a(B=>({...B,messageTemplates:J1,activeTemplateId:"professional_standard"}));return}await r(n),t()}catch(B){console.error("Failed to save settings:",B),alert("Failed to save settings. Please try again.")}finally{b(!1)}},A=B=>{a(D=>({...D,agentProfile:{...D.agentProfile,...B}}))},R=(B,D)=>{a(te=>({...te,messageTemplates:te.messageTemplates.map(ee=>ee.id===B?{...ee,...D}:ee)}))},O=()=>{const B={id:`custom_${Date.now()}`,name:"New Custom Template",template:"{greeting}Payment Reminder\\n\\n{refLine}Your payment is due {date}{time}.\\n\\nAmount: £{amount}\\n\\n[Your custom message here]\\n\\n{signature}{contactInfo}",variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]};a(D=>({...D,messageTemplates:[...D.messageTemplates,B]})),m(B.id)},N=B=>{if(n.messageTemplates.length<=1){alert("You must have at least one message template");return}a(D=>{const te=D.messageTemplates.filter(ve=>ve.id!==B),ee=D.activeTemplateId===B?te[0]?.id||"professional_standard":D.activeTemplateId;return{...D,messageTemplates:te,activeTemplateId:ee}})},U=()=>{try{const B={id:"preview",addressIndex:0,address:"123 Sample Street, London",customerName:"123456789 Smith",phoneNumber:"07123456789",scheduledDate:new Date(Date.now()+864e5).toISOString().slice(0,10),scheduledTime:"14:00",status:"Scheduled",amount:"125.00",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},D={id:"preview",arrangementId:"preview",type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},te=Q1(B,D,n);x(te),k(!0)}catch(B){console.error("Preview failed:",B),alert("Failed to generate preview. Please check your template.")}},K=(B,D)=>{a(te=>({...te,customizableSchedule:{...te.customizableSchedule,[B]:D}}))};return f.jsxs("div",{className:"modal-backdrop",onClick:B=>B.target===B.currentTarget&&t(),children:[f.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90vw",maxHeight:"90vh",overflow:"auto"},children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h2",{style:{margin:0},children:"⚙️ Reminder Settings"}),f.jsx("button",{className:"btn btn-ghost",onClick:t,children:"✕"})]}),f.jsxs("div",{className:"modal-body",children:[f.jsxs("div",{className:"btn-group",style:{marginBottom:"1.5rem"},children:[f.jsx("button",{className:`btn ${l==="profile"?"btn-primary":"btn-ghost"}`,onClick:()=>c("profile"),children:"👤 Agent Profile"}),f.jsx("button",{className:`btn ${l==="templates"?"btn-primary":"btn-ghost"}`,onClick:()=>c("templates"),children:"📝 Message Templates"}),f.jsx("button",{className:`btn ${l==="schedule"?"btn-primary":"btn-ghost"}`,onClick:()=>c("schedule"),children:"📅 Schedule Settings"})]}),l==="profile"&&f.jsxs("div",{className:"settings-tab",children:[f.jsx("h3",{children:"Agent Profile Information"}),f.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"This information will be used in your reminder messages and signature."}),f.jsxs("div",{className:"form-grid",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{htmlFor:"agent-name",children:"👤 Agent Name *"}),f.jsx("input",{id:"agent-name",name:"agentName",type:"text",value:n.agentProfile.name,onChange:B=>A({name:B.target.value}),className:"input",placeholder:"Enter your full name",required:!0})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{htmlFor:"agent-title",children:"🏷️ Job Title *"}),f.jsxs("select",{id:"agent-title",name:"agentTitle",value:n.agentProfile.title,onChange:B=>A({title:B.target.value}),className:"input",children:[f.jsx("option",{value:"Enforcement Agent",children:"Enforcement Agent"}),f.jsx("option",{value:"Bailiff",children:"Bailiff"}),f.jsx("option",{value:"Recovery Officer",children:"Recovery Officer"}),f.jsx("option",{value:"Collection Agent",children:"Collection Agent"}),f.jsx("option",{value:"Senior Enforcement Agent",children:"Senior Enforcement Agent"}),f.jsx("option",{value:"Lead Bailiff",children:"Lead Bailiff"})]})]}),f.jsxs("div",{className:"form-group form-group-full",children:[f.jsx("label",{htmlFor:"agent-signature",children:"✍️ Message Signature *"}),f.jsx("input",{id:"agent-signature",name:"agentSignature",type:"text",value:n.agentProfile.signature,onChange:B=>A({signature:B.target.value}),className:"input",placeholder:"e.g., Enforcement Agent J. Smith",required:!0}),f.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"This will appear at the end of your reminder messages"})]}),f.jsxs("div",{className:"form-group form-group-full",children:[f.jsx("label",{htmlFor:"agent-contact-info",children:"📞 Contact Information (Optional)"}),f.jsx("input",{id:"agent-contact-info",name:"agentContactInfo",type:"text",value:n.agentProfile.contactInfo||"",onChange:B=>A({contactInfo:B.target.value}),className:"input",placeholder:"e.g., Tel: 01234 567890"}),f.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Additional contact information to include in messages"})]})]})]}),l==="templates"&&f.jsxs("div",{className:"settings-tab",children:[f.jsxs("div",{style:{marginBottom:"1.5rem"},children:[f.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[f.jsx("h3",{children:"Message Templates"}),f.jsxs("div",{children:[f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:U,children:"👁️ Preview"}),f.jsx("button",{className:"btn btn-success btn-sm",onClick:O,children:"➕ Add Template"})]})]}),f.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:["Create and customize SMS reminder messages. Use variables to automatically insert customer and payment details.",f.jsx("br",{}),f.jsx("strong",{children:"💡 Click the ✏️ Edit button next to any template to see the enhanced editor with variable reference panel."})]})]}),f.jsxs("div",{className:"form-group",children:[f.jsx("label",{htmlFor:"active-template",children:"Active Template"}),f.jsx("select",{id:"active-template",name:"activeTemplate",value:n.activeTemplateId,onChange:B=>a(D=>({...D,activeTemplateId:B.target.value})),className:"input",children:n.messageTemplates.map(B=>f.jsx("option",{value:B.id,children:B.name},B.id))})]}),f.jsx("div",{className:"templates-list",children:n.messageTemplates.map(B=>f.jsxs("div",{className:"template-item",children:[f.jsxs("div",{className:"template-header",children:[f.jsxs("div",{children:[f.jsx("strong",{children:B.name}),B.id===n.activeTemplateId&&f.jsx("span",{className:"pill",style:{backgroundColor:"var(--success)15",color:"var(--success)",marginLeft:"0.5rem"},children:"Active"})]}),f.jsxs("div",{children:[f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>m(d===B.id?null:B.id),children:d===B.id?"👁️":"✏️"}),B.id.startsWith("custom_")&&f.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>N(B.id),children:"🗑️"})]})]}),d===B.id&&f.jsxs("div",{className:"template-editor",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{htmlFor:`template-name-${B.id}`,children:"Template Name"}),f.jsx("input",{id:`template-name-${B.id}`,name:`templateName-${B.id}`,type:"text",value:B.name,onChange:D=>R(B.id,{name:D.target.value}),className:"input"})]}),f.jsxs("div",{className:"template-editor-layout",children:[f.jsxs("div",{className:"form-group",children:[f.jsx("label",{htmlFor:`template-content-${B.id}`,children:"Message Template"}),f.jsx("textarea",{id:`template-content-${B.id}`,name:`templateContent-${B.id}`,value:B.template,onChange:D=>R(B.id,{template:D.target.value}),className:"input",rows:12,style:{fontFamily:"monospace",fontSize:"0.875rem"}}),f.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Use variables like ","{greeting}"," and ","{amount}"," - see reference panel →"]})]}),f.jsxs("div",{className:"variable-reference-panel",children:[f.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.875rem",color:"var(--text-primary)"},children:"📋 Available Variables"}),f.jsxs("div",{className:"variable-group",children:[f.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Customer Info"}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{greeting}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Smart greeting: "Mr/Mrs Smith, "'})]}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{refLine}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Reference line: "Reference: 123456789\\\\n\\\\n"'})]}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{customerName}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full name: "123456789 Smith"'})]})]}),f.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[f.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Payment Details"}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{amount}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Payment amount: "125.00"'})]}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{date}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Due date: "15/01/2025"'})]}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{time}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Time (if set): " at 14:00"'})]})]}),f.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[f.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Agent Info"}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{signature}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full signature: "Enforcement Agent J. Smith"'})]}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentName}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Name only: "J. Smith"'})]}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentTitle}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Job title: "Enforcement Agent"'})]}),f.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[f.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{contactInfo}"}),f.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Contact: "Tel: 01234 567890"'})]})]}),f.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"var(--blue-50)",borderRadius:"var(--radius-sm)",border:"1px solid var(--blue-200)"},children:[f.jsx("div",{style:{fontSize:"0.75rem",color:"var(--blue-700)",fontWeight:600,marginBottom:"0.25rem"},children:"💡 Tips:"}),f.jsxs("ul",{style:{margin:0,paddingLeft:"1rem",fontSize:"0.75rem",color:"var(--blue-600)"},children:[f.jsx("li",{children:"Use \\\\n for line breaks"}),f.jsx("li",{children:"Variables are case-sensitive"}),f.jsx("li",{children:"Preview to test your template"}),f.jsx("li",{children:"Empty variables won't show"})]})]})]})]})]})]},B.id))})]}),l==="schedule"&&f.jsxs("div",{className:"settings-tab",children:[f.jsx("h3",{children:"Reminder Schedule"}),f.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Choose when reminder notifications should be sent before payment due dates."}),f.jsx("div",{className:"form-group",children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("input",{name:"globalEnabled",type:"checkbox",checked:n.globalEnabled,onChange:B=>a(D=>({...D,globalEnabled:B.target.checked}))}),"Enable automatic reminders"]})}),f.jsx("div",{className:"form-group",children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("input",{name:"smsEnabled",type:"checkbox",checked:n.smsEnabled,onChange:B=>a(D=>({...D,smsEnabled:B.target.checked})),disabled:!n.globalEnabled}),"Enable SMS reminders"]})}),f.jsx("hr",{style:{margin:"1.5rem 0"}}),f.jsx("h4",{children:"Reminder Timing"}),f.jsxs("div",{className:"schedule-options",children:[f.jsx("div",{className:"form-group",children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("input",{name:"threeDayReminder",type:"checkbox",checked:n.customizableSchedule.threeDayReminder,onChange:B=>K("threeDayReminder",B.target.checked),disabled:!n.globalEnabled}),"Send reminder 3 days before payment due"]})}),f.jsx("div",{className:"form-group",children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("input",{name:"oneDayReminder",type:"checkbox",checked:n.customizableSchedule.oneDayReminder,onChange:B=>K("oneDayReminder",B.target.checked),disabled:!n.globalEnabled}),"Send reminder 1 day before payment due"]})}),f.jsx("div",{className:"form-group",children:f.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[f.jsx("input",{name:"dayOfReminder",type:"checkbox",checked:n.customizableSchedule.dayOfReminder,onChange:B=>K("dayOfReminder",B.target.checked),disabled:!n.globalEnabled}),"Send reminder on payment due date"]})})]}),f.jsxs("div",{className:"custom-days-section",children:[f.jsx("h4",{children:"Custom Reminder Days"}),f.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1rem"},children:"Add additional reminder days (e.g., 7 for weekly, 14 for bi-weekly)"}),f.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem"},children:n.customizableSchedule.customDays.map((B,D)=>f.jsxs("span",{className:"pill",style:{backgroundColor:"var(--primary)15",color:"var(--primary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[B," days before",f.jsx("button",{onClick:()=>{const te=[...n.customizableSchedule.customDays];te.splice(D,1),K("customDays",te)},style:{background:"none",border:"none",color:"inherit",cursor:"pointer",padding:"0 0.25rem"},children:"✕"})]},D))}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[f.jsx("input",{name:"customDayInput",type:"number",min:"1",max:"365",placeholder:"Days before",className:"input",style:{width:"120px"},onKeyPress:B=>{if(B.key==="Enter"){const D=B.target,te=parseInt(D.value);te&&te>0&&!n.customizableSchedule.customDays.includes(te)&&(K("customDays",[...n.customizableSchedule.customDays,te]),D.value="")}}}),f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:B=>{const D=B.target.parentElement?.querySelector("input"),te=parseInt(D.value);te&&te>0&&!n.customizableSchedule.customDays.includes(te)&&(K("customDays",[...n.customizableSchedule.customDays,te]),D.value="")},children:"➕ Add"})]})]})]})]}),f.jsxs("div",{className:"modal-footer",children:[f.jsx("button",{className:"btn btn-ghost",onClick:t,children:"Cancel"}),f.jsx(Ai,{className:"btn btn-primary",onClick:S,isLoading:E,loadingText:"Saving...",children:"💾 Save Settings"})]})]}),y&&f.jsx("div",{className:"modal-backdrop",onClick:()=>k(!1),children:f.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[f.jsxs("div",{className:"modal-header",children:[f.jsx("h3",{style:{margin:0},children:"📱 Message Preview"}),f.jsx("button",{className:"btn btn-ghost",onClick:()=>k(!1),children:"✕"})]}),f.jsxs("div",{className:"modal-body",children:[f.jsx("div",{style:{padding:"1rem",backgroundColor:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:"pre-wrap",lineHeight:1.5},children:v}),f.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"This is how your message will appear when sent to customers."})]}),f.jsx("div",{className:"modal-footer",children:f.jsx("button",{className:"btn btn-primary",onClick:()=>k(!1),children:"Close Preview"})})]})}),f.jsx("style",{children:`
        /* Modal Backdrop */
        .modal-backdrop {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        /* Modal Content */
        .modal-content {
          background: white;
          border-radius: var(--radius-lg, 12px);
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          max-width: 900px;
          width: 95vw;
          max-height: 95vh;
          overflow: hidden;
          display: flex;
          flex-direction: column;
        }

        @media (max-width: 480px) {
          .modal-content {
            width: 98vw;
            max-height: 98vh;
            border-radius: var(--radius-md, 8px);
            margin: 0 0.5rem;
          }
        }

        /* Modal Header */
        .modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem 2rem;
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-header {
            padding: 1rem 1.5rem;
          }

          .modal-header h2 {
            font-size: 1.25rem;
          }
        }

        .modal-header h2 {
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--gray-900, #111827);
          margin: 0;
        }

        .modal-header .btn {
          padding: 0.5rem;
          min-width: auto;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          font-size: 1rem;
        }

        /* Modal Body */
        .modal-body {
          padding: 2rem;
          overflow-y: auto;
          flex: 1;
        }

        /* Modal Footer */
        .modal-footer {
          padding: 1.5rem 2rem;
          border-top: 1px solid var(--gray-200, #e5e7eb);
          display: flex;
          justify-content: flex-end;
          gap: 1rem;
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-body {
            padding: 1.5rem;
          }

          .modal-footer {
            padding: 1rem 1.5rem;
            flex-direction: column-reverse;
            gap: 0.75rem;
          }

          .modal-footer .btn {
            width: 100%;
            justify-content: center;
          }
        }

        /* Template Editor Layout */
        .template-editor-layout {
          display: grid;
          grid-template-columns: 1fr 320px;
          gap: 1.5rem;
          min-height: 500px;
        }

        @media (max-width: 1024px) {
          .template-editor-layout {
            grid-template-columns: 1fr;
            gap: 1rem;
          }

          .variable-reference-panel {
            order: -1;
            max-height: 300px !important;
          }
        }

        /* Variable Reference Panel */
        .variable-reference-panel {
          background: var(--gray-50, #f8f9fa);
          border: 1px solid var(--gray-200, #e9ecef);
          border-radius: var(--radius-md, 8px);
          padding: 1.25rem;
          font-size: 0.875rem;
          max-height: 500px;
          overflow-y: auto;
          position: sticky;
          top: 0;
        }

        .variable-group {
          margin-bottom: 1.5rem;
        }

        .variable-group:last-child {
          margin-bottom: 0;
        }

        .variable-group h5 {
          margin: 0 0 0.75rem;
          font-size: 0.875rem;
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.025em;
        }

        .variable-item {
          margin-bottom: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: var(--radius-sm, 6px);
          border: 1px solid var(--gray-100, #f3f4f6);
        }

        .variable-item:last-child {
          margin-bottom: 0;
        }

        .variable-item code {
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          background: var(--primary-light, #e0f2fe);
          padding: 0.25rem 0.5rem;
          border-radius: 0.25rem;
          font-size: 0.8125rem;
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .variable-item div {
          color: var(--text-muted, #6b7280);
          font-size: 0.8125rem;
          margin-top: 0.375rem;
          line-height: 1.4;
        }

        /* Form Improvements */
        .form-group {
          margin-bottom: 1.5rem;
        }

        .form-group label {
          display: block;
          font-weight: 500;
          color: var(--gray-700, #374151);
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .form-group .input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--gray-300, #d1d5db);
          border-radius: var(--radius-md, 8px);
          font-size: 0.875rem;
          transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .form-group .input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }

        .form-group textarea.input {
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
          line-height: 1.5;
        }

        /* Button Group */
        .btn-group {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 2rem;
        }

        .btn-group .btn {
          flex: 1;
          text-align: center;
          font-size: 0.875rem;
          padding: 0.75rem 0.5rem;
        }

        /* Mobile-specific tab optimizations */
        @media (max-width: 480px) {
          .btn-group {
            gap: 0.25rem;
            margin-bottom: 1.5rem;
          }

          .btn-group .btn {
            font-size: 0.75rem;
            padding: 0.625rem 0.375rem;
            line-height: 1.2;
          }
        }

        @media (max-width: 360px) {
          .btn-group {
            flex-direction: column;
            gap: 0.5rem;
          }

          .btn-group .btn {
            flex: none;
            font-size: 0.875rem;
            padding: 0.75rem 1rem;
          }
        }

        /* Templates List */
        .templates-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .template-item {
          border: 1px solid var(--gray-200, #e5e7eb);
          border-radius: var(--radius-lg, 12px);
          overflow: hidden;
        }

        .template-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          background: var(--gray-50, #f9fafb);
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
        }

        .template-editor {
          padding: 1.5rem;
          background: white;
        }

        /* Dark Mode Support */
        .dark-mode .modal-content {
          background: var(--gray-800, #1f2937);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-header {
          border-bottom-color: var(--gray-700, #374151);
        }

        .dark-mode .modal-header h2 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-footer {
          border-top-color: var(--gray-700, #374151);
        }

        /* Form Elements Dark Mode */
        .dark-mode .form-group label {
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .form-group .input {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .form-group .input:focus {
          border-color: var(--primary, #0ea5e9);
          background: var(--gray-700, #374151);
        }

        .dark-mode .form-group .input::placeholder {
          color: var(--gray-400, #9ca3af);
        }

        /* Variable Reference Panel Dark Mode */
        .dark-mode .variable-reference-panel {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .variable-group h5 {
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item {
          background: var(--gray-800, #1f2937);
          border-color: var(--gray-600, #4b5563);
        }

        .dark-mode .variable-item code {
          background: var(--primary-dark, #0c4a6e);
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item div {
          color: var(--gray-300, #d1d5db);
        }

        /* Template Items Dark Mode */
        .dark-mode .template-item {
          border-color: var(--gray-600, #4b5563);
          background: var(--gray-800, #1f2937);
        }

        .dark-mode .template-header {
          background: var(--gray-700, #374151);
          border-bottom-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .template-editor {
          background: var(--gray-800, #1f2937);
        }

        /* Button Group Dark Mode */
        .dark-mode .btn-group .btn {
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .btn-group .btn.btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .dark-mode .btn-group .btn.btn-ghost {
          background: var(--gray-700, #374151);
        }

        .dark-mode .btn-group .btn.btn-ghost:hover {
          background: var(--gray-600, #4b5563);
        }

        /* Additional Text Elements */
        .dark-mode .settings-tab h3 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .settings-tab p {
          color: var(--gray-300, #d1d5db);
        }

        .dark-mode .setting-description {
          color: var(--gray-400, #9ca3af);
        }

        /* Tips Box Dark Mode */
        .dark-mode .variable-reference-panel div[style*="background: var(--blue-50)"] {
          background: var(--gray-600, #4b5563) !important;
          border-color: var(--gray-500, #6b7280) !important;
        }

        .dark-mode .variable-reference-panel div[style*="color: var(--blue-700)"] {
          color: var(--blue-300, #93c5fd) !important;
        }

        .dark-mode .variable-reference-panel ul {
          color: var(--gray-300, #d1d5db) !important;
        }

        /* Template List Dark Mode */
        .dark-mode .template-item strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .pill {
          background: var(--success-dark, #166534) !important;
          color: var(--success-light, #86efac) !important;
        }

        .dark-mode .template-header strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .template-header {
          color: var(--gray-100, #f3f4f6) !important;
        }
      `})]})}const lD=({trigger:e,reminderSettings:r,onUpdateReminderSettings:t})=>{const[n,a]=Y.useState(!1),[l,c]=Y.useState(!1),d=Y.useRef(null),{settings:m,toggleBackup:v,toggleDarkMode:x,togglePushNotifications:y,toggleAutoSync:k}=Ry();Y.useEffect(()=>{const b=S=>{d.current&&!d.current.contains(S.target)&&a(!1)};return n&&document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[n]),Y.useEffect(()=>{const b=S=>{S.key==="Escape"&&a(!1)};return n&&document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[n]);const E=({checked:b,onChange:S,id:A})=>f.jsxs("div",{className:"toggle-switch",onClick:S,children:[f.jsx("input",{type:"checkbox",id:A,checked:b,onChange:S,className:"toggle-input"}),f.jsx("div",{className:`toggle-slider ${b?"checked":""}`,children:f.jsx("div",{className:"toggle-thumb"})})]});return f.jsxs("div",{className:"settings-dropdown",ref:d,children:[f.jsx("button",{className:"settings-trigger",onClick:()=>a(!n),"aria-expanded":n,"aria-haspopup":"true",children:e||f.jsxs(f.Fragment,{children:[f.jsx("span",{className:"settings-icon",children:"⚙️"}),f.jsx("span",{className:"settings-text",children:"Settings"})]})}),n&&f.jsxs("div",{className:"settings-dropdown-content",children:[f.jsxs("div",{className:"settings-header",children:[f.jsx("h3",{className:"settings-title",children:"App Settings"}),f.jsx("p",{className:"settings-subtitle",children:"Customize your experience"})]}),f.jsx("div",{className:"settings-section",children:f.jsxs("div",{className:"setting-item",children:[f.jsxs("div",{className:"setting-info",children:[f.jsx("label",{htmlFor:"backup-toggle",className:"setting-label",children:"Auto-download backup on end of day"}),f.jsx("p",{className:"setting-description",children:"Automatically download backup file when finishing the day."})]}),f.jsx(E,{id:"backup-toggle",checked:m.backupOnEndOfDay,onChange:v})]})}),f.jsx("div",{className:"settings-separator"}),f.jsx("div",{className:"settings-section",children:f.jsxs("button",{className:"sms-settings-button",onClick:()=>{c(!0),a(!1)},children:[f.jsx("span",{className:"sms-settings-icon",children:"🔔"}),f.jsxs("div",{className:"sms-settings-info",children:[f.jsx("div",{className:"sms-settings-title",children:"Reminder & SMS Settings"}),f.jsx("div",{className:"sms-settings-desc",children:"Message templates, scheduling, agent profile, and reminder preferences"})]}),f.jsx("span",{className:"sms-settings-arrow",children:"→"})]})}),f.jsx("div",{className:"settings-separator"}),f.jsxs("div",{className:"settings-section",children:[f.jsxs("div",{className:"setting-item",children:[f.jsx("div",{className:"setting-info",children:f.jsx("label",{htmlFor:"dark-mode",className:"setting-label",children:"Dark Mode"})}),f.jsx(E,{id:"dark-mode",checked:m.darkMode,onChange:x})]}),f.jsxs("div",{className:"setting-item",children:[f.jsx("div",{className:"setting-info",children:f.jsx("label",{htmlFor:"push-notifs",className:"setting-label",children:"Push Notifications"})}),f.jsx(E,{id:"push-notifs",checked:m.pushNotifications,onChange:y})]}),f.jsxs("div",{className:"setting-item",children:[f.jsx("div",{className:"setting-info",children:f.jsx("label",{htmlFor:"auto-sync",className:"setting-label",children:"Auto-sync on app start"})}),f.jsx(E,{id:"auto-sync",checked:m.autoSyncOnStart,onChange:k})]})]}),f.jsx("div",{className:"settings-footer",children:"Settings are saved locally and synced to cloud if configured."})]}),l&&f.jsx(oD,{settings:r||Nl,onUpdateSettings:b=>{t&&t(b),c(!1)},onClose:()=>c(!1)}),f.jsx("style",{children:`
        .settings-dropdown {
          position: relative;
          display: inline-block;
        }

        .settings-trigger {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          background: var(--gray-100);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-md);
          color: var(--gray-700);
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .settings-trigger:hover {
          background: var(--gray-200);
          color: var(--gray-800);
        }

        .settings-icon {
          font-size: 1rem;
        }

        .settings-dropdown-content {
          position: absolute;
          top: 100%;
          right: 0;
          z-index: 1000;
          min-width: 320px;
          max-width: 400px;
          background: white;
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-xl);
          padding: 1.5rem;
          margin-top: 0.5rem;
          animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .settings-header {
          margin-bottom: 1.5rem;
        }

        .settings-title {
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--gray-800);
          margin: 0 0 0.25rem 0;
        }

        .settings-subtitle {
          font-size: 0.875rem;
          color: var(--gray-500);
          margin: 0;
        }

        .settings-section {
          margin-bottom: 1rem;
        }

        .settings-separator {
          height: 1px;
          background: var(--gray-200);
          margin: 1rem 0;
        }

        .setting-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          margin-bottom: 1rem;
        }

        .setting-item:last-child {
          margin-bottom: 0;
        }

        .setting-info {
          flex: 1;
        }

        .setting-label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--gray-700);
          margin-bottom: 0.25rem;
          cursor: pointer;
        }

        .setting-description {
          font-size: 0.75rem;
          color: var(--gray-500);
          margin: 0.25rem 0 0 0;
          line-height: 1.4;
        }

        .settings-select,
        .settings-input {
          width: 100%;
          padding: 0.5rem 0.75rem;
          border: 1px solid var(--gray-300);
          border-radius: var(--radius-sm);
          font-size: 0.875rem;
          background: white;
          transition: var(--transition-normal);
        }

        .settings-select:focus,
        .settings-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        .settings-input {
          margin-top: 0.5rem;
        }

        .toggle-switch {
          position: relative;
          display: inline-block;
          width: 44px;
          height: 24px;
          cursor: pointer;
        }

        .toggle-input {
          opacity: 0;
          width: 0;
          height: 0;
        }

        .toggle-slider {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: var(--gray-300);
          border-radius: 24px;
          transition: var(--transition-normal);
        }

        .toggle-slider.checked {
          background: var(--primary);
        }

        .toggle-thumb {
          position: absolute;
          content: "";
          height: 20px;
          width: 20px;
          left: 2px;
          bottom: 2px;
          background: white;
          border-radius: 50%;
          transition: var(--transition-normal);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-slider.checked .toggle-thumb {
          transform: translateX(20px);
        }

        .settings-footer {
          margin-top: 1.5rem;
          padding-top: 1rem;
          border-top: 1px solid var(--gray-200);
          font-size: 0.75rem;
          color: var(--gray-500);
          text-align: center;
        }

        /* Dark mode styles */
        .dark-mode .settings-dropdown-content {
          background: var(--gray-800);
          border-color: var(--gray-700);
          color: var(--gray-100);
        }

        .dark-mode .settings-title {
          color: var(--gray-100);
        }

        .dark-mode .settings-subtitle,
        .dark-mode .setting-description,
        .dark-mode .settings-footer {
          color: var(--gray-400);
        }

        .dark-mode .setting-label {
          color: var(--gray-200);
        }

        .dark-mode .settings-separator {
          background: var(--gray-700);
        }

        .dark-mode .settings-select,
        .dark-mode .settings-input {
          background: var(--gray-700);
          border-color: var(--gray-600);
          color: var(--gray-100);
        }

        .dark-mode .settings-select:focus,
        .dark-mode .settings-input:focus {
          border-color: var(--primary);
        }

        /* SMS Settings Button Styles */
        .sms-settings-button {
          width: 100%;
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.75rem;
          background: var(--gray-50);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-md);
          color: var(--gray-700);
          text-align: left;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .sms-settings-button:hover {
          background: var(--gray-100);
          border-color: var(--primary);
          color: var(--gray-800);
        }

        .sms-settings-icon {
          font-size: 1.25rem;
          flex-shrink: 0;
        }

        .sms-settings-info {
          flex: 1;
        }

        .sms-settings-title {
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--gray-800);
          margin-bottom: 0.125rem;
        }

        .sms-settings-desc {
          font-size: 0.75rem;
          color: var(--gray-500);
          line-height: 1.3;
        }

        .sms-settings-arrow {
          font-size: 0.875rem;
          color: var(--gray-400);
          flex-shrink: 0;
        }

        .dark-mode .sms-settings-button {
          background: var(--gray-700);
          border-color: var(--gray-600);
          color: var(--gray-200);
        }

        .dark-mode .sms-settings-button:hover {
          background: var(--gray-600);
          border-color: var(--primary);
          color: var(--gray-100);
        }

        .dark-mode .sms-settings-title {
          color: var(--gray-100);
        }

        .dark-mode .sms-settings-desc {
          color: var(--gray-400);
        }

        .dark-mode .sms-settings-arrow {
          color: var(--gray-500);
        }

        @media (max-width: 768px) {
          .settings-dropdown-content {
            position: fixed;
            top: 50%;
            left: 50%;
            right: auto;
            transform: translate(-50%, -50%);
            min-width: 280px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
          }
        }
      `})]})},cD=()=>{const[e,r]=Xt.useState([]);return Xt.useEffect(()=>Xd.subscribe(r),[]),e.length===0?null:f.jsxs("div",{className:"toast-container",children:[e.map(t=>f.jsx("div",{className:`toast toast-${t.type}`,onClick:()=>Xd.remove(t.id),children:f.jsxs("div",{className:"toast-content",children:[f.jsxs("span",{className:"toast-icon",children:[t.type==="success"&&"✅",t.type==="error"&&"❌",t.type==="warning"&&"⚠️",t.type==="info"&&"ℹ️"]}),f.jsx("span",{className:"toast-message",children:t.message})]})},t.id)),f.jsx("style",{children:`
        .toast-container {
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 9999;
          display: flex;
          flex-direction: column;
          gap: 8px;
          pointer-events: none;
        }

        .toast {
          pointer-events: auto;
          background: var(--card-bg, white);
          color: var(--text-primary, #374151);
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          border-left: 4px solid;
          min-width: 300px;
          max-width: 400px;
          padding: 12px 16px;
          cursor: pointer;
          transition: all 0.3s ease;
          animation: slideIn 0.3s ease-out;
        }

        .toast:hover {
          transform: translateY(-2px);
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .toast-success {
          border-left-color: #22c55e;
          background: #f0fdf4;
        }

        .toast-error {
          border-left-color: #ef4444;
          background: #fef2f2;
        }

        .toast-warning {
          border-left-color: #f59e0b;
          background: #fffbeb;
        }

        .toast-info {
          border-left-color: #3b82f6;
          background: #eff6ff;
        }

        .toast-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .toast-icon {
          font-size: 16px;
        }

        .toast-message {
          color: inherit;
          font-weight: 500;
          flex: 1;
          line-height: 1.4;
        }

        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateX(100%);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }

        @media (max-width: 768px) {
          .toast-container {
            top: 10px;
            right: 10px;
            left: 10px;
          }

          .toast {
            min-width: auto;
            max-width: none;
          }
        }
      `})]})};async function u0(e,r,t){if(!e.user||!t)return;const n=localStorage.getItem("navigator_restore_in_progress");if(n){const a=parseInt(n),l=Date.now()-a;if(l<3e4){_e.info("🛡️ RESTORE PROTECTION: Skipping session reconciliation to prevent data loss",{timeSinceRestore:`${Math.round(l/1e3)}s`,restoreTime:new Date(a).toISOString()});return}else _e.info("🛡️ RESTORE PROTECTION: Session reconciliation timeout reached, clearing flag"),localStorage.removeItem("navigator_restore_in_progress")}try{_e.info("Post-restore: Reconciling session state with cloud...");const{data:a,error:l}=await t.from("navigator_state").select("data").eq("user_id",e.user.id).maybeSingle();if(l||!a?.data){_e.warn("No cloud state found for session reconciliation");return}const d=jd(a.data).daySessions||[];r(m=>({...m,daySessions:d})),_e.info("Session state reconciled with cloud successfully")}catch(a){_e.error("Failed to reconcile session state:",a)}}class ox extends Y.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,msg:String(r)}}render(){return this.state.hasError?f.jsxs("div",{className:"container",style:{paddingTop:"4rem"},children:[f.jsx("h2",{children:"Something went wrong"}),f.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:this.state.msg})]}):this.props.children}}async function to(e,r="manual",t=0){if(!We)throw _e.error("Supabase not configured for backup"),new Error("Supabase not configured");const n=await We.auth.getUser(),a=n&&n.data&&n.data.user?n.data.user.id:void 0;if(!a)throw _e.error("User not authenticated for backup"),new Error("User not authenticated");const l="Europe/London",c=new Date,d=c.toLocaleDateString("en-GB",{timeZone:l,year:"numeric"}),m=c.toLocaleDateString("en-GB",{timeZone:l,month:"2-digit"}),v=c.toLocaleDateString("en-GB",{timeZone:l,day:"2-digit"}),x=`${d}-${m}-${v}`,y=c.toLocaleTimeString("en-GB",{timeZone:l,hour12:!1}).replace(/:/g,""),k="navigator-backups",E=`backup_${x}_${y}_${r}_retry${t}.json`,b=`${a}/${x}/${E}`;try{const S=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});_e.info(`Uploading backup to ${b}, size: ${S.size} bytes`);const A=await We.storage.from(k).upload(b,S,{upsert:!0,contentType:"application/json"});if(A.error)throw _e.error("Backup upload failed:",A.error),new Error(A.error.message);_e.info("Backup upload successful:",b);try{await We.from("backups").insert({user_id:a,day_key:x,object_path:b,size_bytes:S.size}),_e.info("Backup database record created")}catch(R){_e.warn("Backups table insert failed (non-critical):",R instanceof Error?R.message:R)}return{objectPath:b,size:S.size}}catch(S){if(_e.error(`Backup attempt ${t+1} failed:`,S),t<2){const A=Math.pow(2,t)*1e3;return _e.info(`Retrying backup in ${A}ms...`),await new Promise(R=>setTimeout(R,A)),to(e,r,t+1)}throw new Error(`Backup failed after ${t+1} attempts: ${S.message}`)}}function Rd({title:e,value:r,change:t,changeType:n,icon:a,iconType:l}){return f.jsxs("div",{className:"stat-card-modern",children:[f.jsxs("div",{className:"stat-header",children:[f.jsx("div",{className:"stat-title",children:e}),f.jsx("div",{className:`stat-icon ${l}`,children:a})]}),f.jsx("div",{className:"stat-value",children:r}),t&&f.jsxs("div",{className:`stat-change ${n||"neutral"}`,children:[n==="positive"&&f.jsx("span",{children:"↑"}),n==="negative"&&f.jsx("span",{children:"↓"}),f.jsx("span",{children:t})]})]})}function uD(){const e=wy();return e.isLoading?f.jsx("div",{className:"app-wrapper",children:f.jsx("div",{className:"main-area",children:f.jsx("div",{className:"content-area",children:f.jsxs("div",{className:"loading",children:[f.jsx("div",{className:"spinner"}),"Analyzing session data..."]})})})}):e.user?f.jsx(ox,{children:f.jsx(U3,{children:f.jsx(dD,{})})}):f.jsx(ox,{children:f.jsx(W3,{onSignIn:async(r,t)=>{await e.signIn(r,t)},onSignUp:async(r,t)=>{await e.signUp(r,t)},onForceSignOut:async()=>{await e.signOut()},isLoading:e.isLoading,error:e.error,onClearError:e.clearError})})}function dD(){const{state:e,loading:r,setAddresses:t,addAddress:n,setActive:a,cancelActive:l,complete:c,undo:d,startDay:m,endDay:v,backupState:x,restoreState:y,addArrangement:k,updateArrangement:E,deleteArrangement:b,setState:S,setBaseState:A,deviceId:R,enqueueOp:O,updateReminderSettings:N}=IN(),U=wy(),{confirm:K,alert:B}=$3(),{hasAccess:D}=bm(U.user),{isAdmin:te,isOwner:ee}=jy(U.user),[ve,me]=Y.useState(!1),[J,ce]=Y.useState(!1),[ke,se]=Y.useState(!1),[ue,j]=Y.useState(!1),[G,Z]=Y.useState(!1),[oe,I]=Y.useState(!1),P=()=>{const De=window.location.hash.slice(1);return["list","completed","arrangements","earnings","planning"].includes(De)?De:"list"},[F,M]=Y.useState(P),[H,X]=Y.useState(""),[fe,ge]=Y.useState(null),[ye,xe]=Y.useState(!1),ze=Y.useRef(null);Y.useEffect(()=>{const De=()=>{const Ke=P();M(Ke)};return window.addEventListener("popstate",De),()=>window.removeEventListener("popstate",De)},[]);const ne=Y.useCallback(De=>{De!==F&&(M(De),window.history.pushState({tab:De},"",`#${De}`))},[F]),[xt,st]=Y.useState(!1),[wt,_t]=Y.useState([]),[$e,It]=Y.useState(!1),[ur,rr]=Y.useState(null),Zt=Array.isArray(e.addresses)?e.addresses:[],Kt=Array.isArray(e.completions)?e.completions:[],yr=Array.isArray(e.arrangements)?e.arrangements:[],or=Array.isArray(e.daySessions)?e.daySessions:[],nt=Y.useMemo(()=>({...e,addresses:Zt,completions:Kt,arrangements:yr,daySessions:or}),[e,Zt,Kt,yr,or]);function Mr(De,Ke="Europe/London"){const Ye=De.toLocaleDateString("en-GB",{timeZone:Ke,year:"numeric"}),He=De.toLocaleDateString("en-GB",{timeZone:Ke,month:"2-digit"}),Qe=De.toLocaleDateString("en-GB",{timeZone:Ke,day:"2-digit"});return`${Ye}-${He}-${Qe}`}const Sn=Y.useCallback(async()=>{if(!We){rr("Supabase not configured");return}It(!0),rr(null);try{const Ke=(await We.auth.getUser())?.data?.user?.id;if(!Ke)throw new Error("Not authenticated");const Ye=new Date,He=new Date;He.setDate(He.getDate()-6);const Qe=Mr(He),at=Mr(Ye),pt=await We.from("backups").select("object_path,size_bytes,created_at,day_key").eq("user_id",Ke).gte("day_key",Qe).lte("day_key",at).order("day_key",{ascending:!1}).order("created_at",{ascending:!1});if(pt.error)throw pt.error;const Xe=pt.data??[];_t(Xe)}catch(De){rr(De?.message||String(De))}finally{It(!1)}},[]),nr=Y.useCallback(async De=>{if(!We){await B({title:"Configuration Error",message:"Supabase is not configured.",type:"error"});return}const Ke=De.split("/").pop()||De;if(await K({title:"Restore from Cloud",message:`Restore "${Ke}" from cloud?

This will overwrite your current data.`,confirmText:"Restore",cancelText:"Cancel",type:"warning"})){It(!0),rr(null);try{const Qe=await We.storage.from("navigator-backups").download(De);if(Qe.error)throw Qe.error;const pt=await Qe.data.text(),Xe=JSON.parse(pt),Ot=Qh(Xe),ar=nt.daySessions,Ut={...Ot,daySessions:ar};y(Ut),setTimeout(async()=>{await U.syncData(Ut),ze.current=JSON.stringify(Ut)},31e3),await u0(U,S,We),xe(!0),await B({title:"Success",message:"Successfully restored from cloud",type:"success"}),st(!1)}catch(He){rr(He?.message||String(He))}finally{It(!1)}}},[U,y,B,K]);Y.useEffect(()=>{if(!U.user||r)return;if(!We){xe(!0);return}let De=!1,Ke;return(async()=>{try{const He=(await We.from("navigator_state").select("data, updated_at, version").eq("user_id",U.user.id).maybeSingle()).data;if(He&&He.data){const Qe=jd(He.data);if(!De){if(Zt.length>0||Kt.length>0||yr.length>0||or.length>0){const pt=Kt.length,Xe=Qe.completions?.length||0,Ot=He.updated_at?new Date(He.updated_at):new Date(0),ar=new Date(Date.now()-7200*1e3),Ut=Kt.some(Yt=>Yt.timestamp&&new Date(Yt.timestamp)>ar);if(_e.sync("🔍 SESSION RESTORATION ANALYSIS:",{localCompletions:pt,cloudCompletions:Xe,cloudLastUpdated:Ot.toISOString(),hasRecentLocalActivity:Ut,willMerge:pt>0||Ut}),pt>Xe||Ut){_e.sync("🛡️ DATA PROTECTION: Local data appears newer, merging states to prevent loss");const ct=_y(nt,Qe);S(ct),ze.current=JSON.stringify(ct),setTimeout(async()=>{try{await U.syncData(ct),_e.sync("✅ Synced merged state back to cloud")}catch(Je){_e.error("Failed to sync merged state:",Je)}},1e3)}else _e.sync("☁️ Using cloud state (appears more complete)"),S(Qe),ze.current=JSON.stringify(Qe)}else _e.sync("☁️ No local data, using cloud state"),S(Qe),ze.current=JSON.stringify(Qe);xe(!0),_e.sync("Session restored, version:",He?.version)}}else if(Zt.length>0||Kt.length>0||yr.length>0||or.length>0){_e.info("Analyzing data ownership for current user...");try{let at=null;try{const{data:Xe}=await We.from("navigator_state").select("data").eq("user_id",U.user.id).maybeSingle();at=Xe?.data}catch(Xe){_e.warn("Could not fetch cloud data for analysis:",Xe)}const pt=gs.analyzeDataOwnership(nt,U.user,at);switch(_e.info("Data ownership analysis:",pt),pt.action){case"sync":_e.sync("Syncing local data to cloud (ownership confirmed)"),await U.syncData(nt),gs.storeDeviceContext(U.user),De||(ze.current=JSON.stringify(nt),xe(!0));break;case"backup_and_clear":_e.warn("Creating safety backup before clearing (different user detected)");try{const Xe=`navigator_safety_backup_${Date.now()}_user_switch`,Ot={...nt,_backup_timestamp:new Date().toISOString(),_backup_reason:"user_switch",_ownership_analysis:pt};localStorage.setItem(Xe,JSON.stringify(Ot)),_e.info(`Safety backup created: ${Xe}`),S({addresses:[],completions:[],arrangements:[],daySessions:[],activeIndex:null,currentListVersion:1}),gs.storeDeviceContext(U.user),De||xe(!0)}catch(Xe){_e.error("Backup failed - preserving data for safety:",Xe),await U.syncData(nt),gs.storeDeviceContext(U.user),De||(ze.current=JSON.stringify(nt),xe(!0))}break;case"preserve_and_ask":default:_e.info("Preserving local data (uncertain ownership) - user can decide later"),await U.syncData(nt),gs.storeDeviceContext(U.user),De||(ze.current=JSON.stringify(nt),xe(!0));break}}catch(at){_e.error("User detection analysis failed - preserving data for safety:",at),await U.syncData(nt),gs.storeDeviceContext(U.user),De||(ze.current=JSON.stringify(nt),xe(!0))}}else gs.storeDeviceContext(U.user),De||xe(!0);Ke=U.subscribeToData(Qe=>{if(!Qe)return;const at=localStorage.getItem("navigator_restore_in_progress");if(at){const Xe=parseInt(at),Ot=Date.now()-Xe;if(Ot<3e4){_e.sync("🛡️ RESTORE PROTECTION: App.tsx subscription skipping cloud state update to prevent data loss",{timeSinceRestore:`${Math.round(Ot/1e3)}s`,restoreTime:new Date(Xe).toISOString()});return}else _e.sync("🛡️ RESTORE PROTECTION: App.tsx subscription timeout reached, clearing flag"),localStorage.removeItem("navigator_restore_in_progress")}const pt=localStorage.getItem("navigator_import_in_progress");if(pt){const Xe=parseInt(pt),Ot=Date.now()-Xe;if(Ot<2e3){_e.sync("🛡️ IMPORT PROTECTION: App.tsx subscription skipping cloud state update to prevent import override",{timeSinceImport:`${Math.round(Ot/1e3)}s`,importTime:new Date(Xe).toISOString()});return}else _e.sync("🛡️ IMPORT PROTECTION: App.tsx subscription timeout reached, clearing flag"),localStorage.removeItem("navigator_import_in_progress")}if(typeof Qe=="function")_e.sync("Received cloud update (React updater)"),S(Xe=>{const Ot=Qe(Xe),ar=jd(Ot),Ut=JSON.stringify(ar);return ze.current=Ut,ar}),xe(!0);else{const Xe=JSON.stringify(Qe);if(Xe===ze.current)return;const Ot=jd(Qe);_e.sync("Received cloud update (direct state)"),S(Ot),ze.current=Xe,xe(!0)}})}catch(Ye){_e.error("Bootstrap sync failed:",Ye),De||xe(!0)}})(),()=>{De=!0,Ke&&Ke()}},[U.user,r]),Y.useEffect(()=>{if(!U.user||r||!ye)return;const De=JSON.stringify(nt);if(De===ze.current)return;const Ke=setTimeout(async()=>{try{const Ye=localStorage.getItem("navigator_restore_in_progress");if(Ye){const Qe=parseInt(Ye),at=Date.now()-Qe;if(at<3e4){_e.sync("🛡️ RESTORE PROTECTION: Debounced sync skipping to prevent data loss",{timeSinceRestore:`${Math.round(at/1e3)}s`,restoreTime:new Date(Qe).toISOString()});return}else _e.sync("🛡️ RESTORE PROTECTION: Debounced sync timeout reached, clearing flag"),localStorage.removeItem("navigator_restore_in_progress")}const He=localStorage.getItem("navigator_import_in_progress");if(He){const Qe=parseInt(He),at=Date.now()-Qe;if(at<300){_e.sync("🛡️ IMPORT PROTECTION: Waiting 300ms for import state to settle before sync",{timeSinceImport:`${Math.round(at)}ms`});return}_e.sync("🚀 IMPORT SYNC: Import settled, pushing to cloud")}_e.sync("Syncing changes to cloud..."),ze.current=De,await U.syncData(nt),_e.sync("Sync completed successfully")}catch(Ye){_e.error("Sync failed:",Ye),ze.current="";const He=5e3;_e.sync(`🔄 Scheduling sync retry in ${He/1e3}s...`),setTimeout(async()=>{try{_e.sync("🔄 Attempting sync retry..."),await U.syncData(nt),_e.sync("✅ Sync retry successful"),ze.current=JSON.stringify(nt)}catch(Qe){_e.error("Sync retry also failed:",Qe)}},He)}},150);return()=>clearTimeout(Ke)},[nt,U,ye,r]),Y.useEffect(()=>{if(!U.user||r||!ye)return;let De=JSON.stringify(nt);const Ke=async()=>{const at=JSON.stringify(nt);if(at!==De&&(nt.completions.length>0||nt.addresses.length>0))try{_e.info("Performing periodic safety backup..."),await to(nt,"manual"),De=at,_e.info("Periodic backup successful")}catch(pt){_e.error("Periodic backup failed:",pt)}},Ye=setInterval(Ke,3600*1e3),He=localStorage.getItem("last_backup_time"),Qe=Date.now();return(!He||Qe-parseInt(He)>3600*1e3)&&setTimeout(async()=>{await Ke(),localStorage.setItem("last_backup_time",Qe.toString())},5e3),()=>clearInterval(Ye)},[nt,U.user,ye,r]),Y.useEffect(()=>{if(!U.user||r||!ye)return;const De=()=>{const Ye=nt.completions.length,He=nt.addresses.length,Qe=localStorage.getItem("navigator_data_counts");if(Qe){const{completions:at,addresses:pt}=JSON.parse(Qe);if(U.isSyncing){_e.info("Skipping data integrity check - cloud sync in progress");return}const Xe=120*1e3,ar=(U.lastSyncTime?Date.now()-U.lastSyncTime.getTime():1/0)<Xe,Ut=ar?50:10,Yt=ar?200:50;Ye<at-Ut&&(_e.error(`POTENTIAL DATA LOSS DETECTED: Completions dropped from ${at} to ${Ye}`),ar?_e.warn(`Large completion count change during recent sync (${at} → ${Ye}) - monitoring`):B({title:"⚠️ POTENTIAL DATA LOSS",message:`Completions count dropped significantly (${at} → ${Ye}). Check cloud backups immediately!`,type:"error"})),He<pt-Yt&&(_e.error(`POTENTIAL DATA LOSS DETECTED: Addresses dropped from ${pt} to ${He}`),ar?_e.warn(`Large address count change during recent sync (${pt} → ${He}) - monitoring`):B({title:"⚠️ POTENTIAL DATA LOSS",message:`Address count dropped significantly (${pt} → ${He}). Check cloud backups immediately!`,type:"error"}))}localStorage.setItem("navigator_data_counts",JSON.stringify({completions:Ye,addresses:He,timestamp:new Date().toISOString()}))},Ke=setInterval(De,30*1e3);return setTimeout(De,3e3),()=>clearInterval(Ke)},[nt,U.user,U.isSyncing,U.lastSyncTime,ye,r]);const Bt=Y.useMemo(()=>{const De=e.currentListVersion,Ke=new Set(Kt.filter(ct=>ct.listVersion===De).map(ct=>ct.index)),Ye=Zt.length,He=Ye-Ke.size,Qe=Kt.filter(ct=>ct.listVersion===De&&ct.outcome==="PIF").length,at=Kt.filter(ct=>ct.listVersion===De&&ct.outcome==="Done").length,pt=Kt.filter(ct=>ct.listVersion===De&&ct.outcome==="DA").length,Xe=Kt.filter(ct=>ct.listVersion===De&&ct.outcome==="ARR").length,Ot=Ke.size,ar=yr.filter(ct=>ct.status!=="Completed"&&ct.status!=="Cancelled").length,Ut=new Date().toISOString().slice(0,10),Yt=Kt.filter(ct=>ct.outcome==="PIF"&&(ct.timestamp||"").slice(0,10)===Ut).reduce((ct,Je)=>ct+parseFloat(Je.amount||"0"),0);return{total:Ye,pending:He,completed:Ot,pifCount:Qe,doneCount:at,daCount:pt,arrCount:Xe,pendingArrangements:ar,todaysPIF:Yt}},[Zt,Kt,yr,e.currentListVersion]),ft=Y.useCallback(De=>{_e.info(`Importing ${De.length} addresses...`),t(De,!0)},[t]),Dt=Y.useCallback(async(De,Ke,Ye,He,Qe)=>{try{await c(De,Ke,Ye,He,Qe);try{const at=x();We&&(await to(at,"manual"),_e.info("Cloud backup after completion successful")),Da.storeLocalBackup(at),_e.info("Local storage backup after completion successful")}catch(at){_e.error("Backup failed after completion:",at)}}catch(at){_e.error("Failed to complete address:",at)}},[c,x]),Br=Y.useCallback(De=>{const Ke=typeof De=="string"?new Date(De):De;if(Number.isNaN(Ke.getTime())){_e.error("Invalid start date:",De);return}const Ye=Ke.toISOString(),He=Ye.slice(0,10);A(Qe=>{const at=Qe.daySessions.slice();let pt=at.findIndex(Yt=>Yt.date===He),Xe;if(pt>=0?Xe={...at[pt],start:Ye}:Xe={date:He,start:Ye},Xe.end)try{const Yt=new Date(Ye).getTime(),ct=new Date(Xe.end).getTime();ct>=Yt?Xe.durationSeconds=Math.floor((ct-Yt)/1e3):(delete Xe.end,delete Xe.durationSeconds)}catch(Yt){_e.error("Error calculating duration:",Yt)}const Ot=new Date().toISOString();Xe.updatedAt=Ot,Xe.updatedBy=R;const ar=`edit_start_${He}_${Date.now()}`,Ut={...Xe,id:He,updatedAt:Ot,updatedBy:R};return O("session",pt>=0?"update":"create",Ut,ar),pt>=0?at[pt]=Xe:at.push(Xe),{...Qe,daySessions:at}})},[A,R,O]),qt=Y.useCallback(De=>{const Ke=typeof De=="string"?new Date(De):De;if(Number.isNaN(Ke.getTime())){_e.error("Invalid end date:",De);return}const Ye=Ke.toISOString(),He=Ye.slice(0,10);A(Qe=>{const at=Qe.daySessions.slice();let pt=at.findIndex(Yt=>Yt.date===He),Xe;if(pt>=0?Xe={...at[pt]}:Xe={date:He,start:Ye},Xe.end=Ye,Xe.start)try{const Yt=new Date(Xe.start).getTime(),ct=new Date(Ye).getTime();ct>=Yt?Xe.durationSeconds=Math.floor((ct-Yt)/1e3):(Xe.start=Ye,Xe.durationSeconds=0)}catch(Yt){_e.error("Error calculating duration:",Yt),Xe.durationSeconds=0}const Ot=new Date().toISOString();Xe.updatedAt=Ot,Xe.updatedBy=R;const ar=`edit_end_${He}_${Date.now()}`,Ut={...Xe,id:He,updatedAt:Ot,updatedBy:R};return O("session",pt>=0?"update":"create",Ut,ar),pt>=0?at[pt]=Xe:at.push(Xe),{...Qe,daySessions:at}})},[A,R,O]),Xr=async De=>{const Ke=De.target.files?.[0];if(Ke)try{const Ye=await kI(Ke),He=Qh(Ye),Qe=nt.daySessions,at={...He,daySessions:Qe};y(at),setTimeout(async()=>{await U.syncData(at),ze.current=JSON.stringify(at)},31e3),await u0(U,S,We),xe(!0),await B({title:"Success",message:"Restore completed successfully!",type:"success"})}catch(Ye){_e.error("Restore failed:",Ye),await B({title:"Error",message:"Restore failed: "+(Ye?.message||Ye),type:"error"})}finally{De.target.value=""}},ii=Y.useCallback(async(De,Ke,Ye)=>{S(He=>{if(!Number.isInteger(De)||De<0||De>=He.completions.length)return He;const Qe=He.completions.slice();return Qe[De]={...Qe[De],outcome:Ke,amount:Ye},{...He,completions:Qe}});try{await new Promise(Qe=>setTimeout(Qe,100));const He=x();We&&(await to(He,"manual"),_e.info("Cloud backup after outcome change successful")),Da.storeLocalBackup(He),_e.info("Local storage backup after outcome change successful")}catch(He){_e.error("Backup failed after outcome change:",He)}},[S,x]),si=Y.useCallback(async()=>{try{_e.sync("Manual sync initiated...");const De=JSON.stringify(nt),Ke=localStorage.getItem("navigator_restore_in_progress");if(Ke){const Ye=parseInt(Ke),He=Date.now()-Ye;if(He<3e4){_e.sync("🛡️ RESTORE PROTECTION: Manual sync blocked to prevent data loss",{timeSinceRestore:`${Math.round(He/1e3)}s`,restoreTime:new Date(Ye).toISOString()}),await B({title:"Restore in Progress",message:"Please wait 30 seconds before manual sync to prevent data loss"});return}else localStorage.removeItem("navigator_restore_in_progress")}ze.current=De,await U.syncData(nt),_e.sync("Manual sync completed successfully");try{await to(nt,"manual"),_e.info("Safety backup after manual sync completed")}catch(Ye){_e.warn("Safety backup after sync failed:",Ye)}}catch(De){_e.error("Manual sync failed:",De),ze.current=""}},[U,nt]),Rn=(De,Ke)=>{localStorage.setItem("navigator_supabase_url",De),localStorage.setItem("navigator_supabase_key",Ke),window.location.reload()},ja=()=>{localStorage.setItem("navigator_supabase_skipped","true"),Z(!1)};Y.useEffect(()=>{if(!U.user||r)return;const De=!!We,Ke=localStorage.getItem("navigator_supabase_skipped");!De&&!Ke&&Z(!0)},[U.user,r]),Y.useEffect(()=>{if(!ye)return;let De=JSON.stringify(nt);const Ke=async()=>{const at=JSON.stringify(nt);if(at!==De&&(nt.completions.length>0||nt.addresses.length>0))try{_e.info("Performing periodic safety backup..."),U.user&&We&&await to(nt,"periodic"),Da.storeLocalBackup(nt),De=at,_e.info("Periodic backup successful")}catch(pt){_e.error("Periodic backup failed:",pt)}},Ye=setInterval(Ke,3600*1e3),He=setInterval(()=>{Da.cleanupOldBackups()},10080*60*1e3),Qe=Da.getBackupStats();return(Qe.count===0||nt.completions.length>0&&Qe.count<3)&&setTimeout(async()=>{await Ke()},5e3),()=>{clearInterval(Ye),clearInterval(He)}},[nt,U.user,ye]);const Ma=()=>{const De=U.user?.email||"",Ke=De.split("@")[0].split(".");return Ke.length>=2?(Ke[0][0]+Ke[1][0]).toUpperCase():De.slice(0,2).toUpperCase()},Tn=U.isSyncing?{text:"Syncing",color:"var(--warning)"}:U.isOnline?U.error?{text:"Sync Error",color:"var(--danger)"}:{text:"Online",color:"var(--success)"}:{text:"Offline",color:"var(--danger)"};return r?f.jsx("div",{className:"app-wrapper",children:f.jsx("div",{className:"main-area",children:f.jsx("div",{className:"content-area",children:f.jsxs("div",{className:"loading",children:[f.jsx("div",{className:"spinner"}),"Preparing your workspace..."]})})})}):f.jsxs("div",{className:"app-wrapper",children:[f.jsx(iD,{isOpen:G,onSetupComplete:Rn,onSkip:ja}),f.jsx(sD,{isOpen:oe,onClose:()=>I(!1),currentData:nt,onRestore:De=>{const Ke=Qh(De),Ye=nt.daySessions,He={...Ke,daySessions:Ye};y(He),U.user&&We&&(setTimeout(async()=>{await U.syncData(He)},31e3),u0(U,S,We))}}),J&&te&&f.jsx(LI,{user:U.user,onClose:()=>ce(!1)}),ve&&f.jsx(OI,{user:U.user,onClose:()=>me(!1)}),f.jsxs("main",{className:"main-area",children:[f.jsxs("header",{className:"app-header-modern",children:[f.jsxs("div",{className:"header-left",children:[f.jsxs("div",{className:"logo-section",children:[f.jsx("div",{className:"logo-icon",children:"📍"}),f.jsxs("div",{className:"logo-text",children:[f.jsx("div",{className:"logo-title",children:"Navigator"}),f.jsx("div",{className:"logo-subtitle",children:"Enforcement Pro"})]})]}),F==="list"&&f.jsxs("div",{className:"search-container-modern",children:[f.jsx("span",{className:"search-icon",children:"🔍"}),f.jsx("input",{id:"search-addresses",name:"searchAddresses",type:"search",className:"search-input-modern",placeholder:"Search addresses...",value:H,onChange:De=>X(De.target.value)})]})]}),f.jsxs("div",{className:"header-center",children:[f.jsxs("div",{className:"sync-status",children:[f.jsx("div",{className:"sync-indicator",style:{background:Tn.color}}),f.jsx("span",{children:Tn.text}),U.lastSyncTime&&f.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:U.lastSyncTime.toLocaleTimeString()})]}),f.jsx(lD,{reminderSettings:e.reminderSettings,onUpdateReminderSettings:N})]}),f.jsx("button",{className:"menu-toggle",onClick:()=>se(!ke),children:"☰"})]}),f.jsxs("div",{className:"content-area",children:[ue&&F==="list"&&f.jsx("div",{style:{background:"var(--surface)",padding:"1rem",borderRadius:"var(--radius-lg)",marginBottom:"1.5rem",border:"1px solid var(--border-light)",boxShadow:"var(--shadow-sm)"},children:f.jsxs("div",{className:"btn-row",style:{gap:"0.75rem",flexWrap:"wrap",alignItems:"stretch"},children:[f.jsx(W1,{onImported:ft}),f.jsx("input",{type:"file",accept:"application/json",onChange:Xr,className:"file-input",id:"restore-input",style:{display:"none"}}),f.jsx("button",{className:"btn btn-ghost",onClick:()=>document.getElementById("restore-input")?.click(),style:{whiteSpace:"nowrap"},children:"📂 Restore Backup"}),f.jsx("button",{className:"btn btn-ghost",onClick:si,disabled:U.isSyncing,style:{whiteSpace:"nowrap"},children:U.isSyncing?"⟳ Syncing...":"🔄 Sync Now"})]})}),F==="list"&&f.jsxs(f.Fragment,{children:[f.jsx(yI,{sessions:or,completions:Kt,startDay:m,endDay:v,onEditStart:Br,onEditEnd:qt,onBackup:async()=>{const De=x(),Ke=Ye=>new Promise((He,Qe)=>setTimeout(()=>Qe(new Error("Backup timeout")),Ye));try{We&&(await Promise.race([to(De,"finish"),Ke(3e4)]),_e.info("Cloud backup at day end successful")),await Promise.race([Da.performCriticalBackup(De,"day-end"),Ke(15e3)]),_e.info("Local backup at day end successful")}catch(Ye){throw _e.error("Backup failed or timed out:",Ye),Ye}}}),f.jsxs("div",{className:"stats-grid",children:[f.jsx(Rd,{title:"Pending Addresses",value:Bt.pending,change:`${Bt.completed} completed today`,changeType:"positive",icon:"📍",iconType:"info"}),f.jsx(Rd,{title:"Today's Earnings",value:`£${Bt.todaysPIF.toFixed(0)}`,change:`${Bt.pifCount} PIF today`,changeType:"positive",icon:"💰",iconType:"success"}),f.jsx(Rd,{title:"Arrangements Due",value:Bt.pendingArrangements,change:"Check arrangements tab",changeType:"neutral",icon:"📅",iconType:"warning"}),f.jsx(Rd,{title:"Completion Rate",value:`${Math.round(Bt.completed/Math.max(Bt.total,1)*100)}%`,change:"Good performance",changeType:"positive",icon:"📊",iconType:"success"})]}),f.jsx(uI,{state:nt,setActive:a,cancelActive:l,onComplete:Dt,onAddArrangement:k,filterText:H}),f.jsxs("div",{style:{display:"flex",gap:"0.5rem",margin:"1.25rem 0 3rem",flexWrap:"wrap",alignItems:"center"},children:[f.jsx("button",{className:"btn btn-ghost",onClick:()=>d(-1),title:"Undo last completion",children:"↶ Undo Last"}),f.jsxs("span",{className:"pill pill-pif",children:["PIF ",Bt.pifCount]}),f.jsxs("span",{className:"pill pill-done",children:["Done ",Bt.doneCount]}),f.jsxs("span",{className:"pill pill-da",children:["DA ",Bt.daCount]}),f.jsxs("span",{className:"pill pill-active",children:["ARR ",Bt.arrCount]})]})]}),F==="completed"&&f.jsx(vI,{state:nt,onChangeOutcome:ii,onAddArrangement:k,onComplete:Dt}),F==="arrangements"&&f.jsx(wI,{state:nt,onAddArrangement:k,onUpdateArrangement:E,onDeleteArrangement:b,onAddAddress:async De=>n(De),onComplete:Dt,autoCreateForAddress:fe,onAutoCreateHandled:()=>ge(null)}),F==="earnings"&&f.jsx(MI,{state:nt,user:U.user}),F==="planning"&&f.jsx(nD,{user:U.user,onAddressesReady:De=>{t(De,!1)}})]}),f.jsx(bI,{onAdd:n})]}),f.jsxs("aside",{className:`sidebar-right ${ke?"open":""}`,children:[f.jsx("div",{className:"sidebar-header",children:f.jsxs("div",{className:"user-profile-section",children:[f.jsx("div",{className:"user-avatar",children:Ma()}),f.jsxs("div",{className:"user-info",children:[f.jsx("div",{className:"user-name",children:U.user?.email?.split("@")[0]}),f.jsx("div",{className:"user-plan",children:ee?"Owner Access":D?"Premium Plan":"Free Trial"})]})]})}),f.jsxs("nav",{className:"nav-menu",children:[f.jsxs("div",{className:"nav-section",children:[f.jsx("div",{className:"nav-section-title",children:"Main"}),f.jsxs("div",{className:`nav-item ${F==="list"?"active":""}`,onClick:()=>{ne("list"),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"📋"}),f.jsx("span",{children:"Address List"}),f.jsx("span",{className:"nav-badge",children:Bt.pending})]}),f.jsxs("div",{className:`nav-item ${F==="completed"?"active":""}`,onClick:()=>{ne("completed"),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"✅"}),f.jsx("span",{children:"Completed"}),f.jsx("span",{className:"nav-badge",children:Bt.completed})]}),f.jsxs("div",{className:`nav-item ${F==="arrangements"?"active":""}`,onClick:()=>{ne("arrangements"),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"📅"}),f.jsx("span",{children:"Arrangements"}),f.jsx("span",{className:"nav-badge",children:Bt.pendingArrangements})]})]}),f.jsxs("div",{className:"nav-section",children:[f.jsx("div",{className:"nav-section-title",children:"Analytics"}),f.jsxs("div",{className:`nav-item ${F==="earnings"?"active":""}`,onClick:()=>{ne("earnings"),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"💰"}),f.jsx("span",{children:"Earnings"})]}),f.jsxs("div",{className:`nav-item ${F==="planning"?"active":""}`,onClick:()=>{ne("planning"),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"🗺️"}),f.jsx("span",{children:"Route Planning"})]})]}),f.jsxs("div",{className:"nav-section",children:[f.jsx("div",{className:"nav-section-title",children:"Tools"}),f.jsxs("div",{className:"nav-item",onClick:()=>{j(!ue),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"🛠️"}),f.jsx("span",{children:"Import/Export"})]}),f.jsxs("div",{className:"nav-item",onClick:()=>{I(!0),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"💾"}),f.jsx("span",{children:"Backup Manager"})]}),We&&f.jsxs("div",{className:"nav-item",onClick:async()=>{st(!0),await Sn(),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"☁️"}),f.jsx("span",{children:"Cloud Backups"})]}),!We&&f.jsxs("div",{className:"nav-item",onClick:()=>{Z(!0),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"🔗"}),f.jsx("span",{children:"Connect Cloud Storage"})]})]}),f.jsxs("div",{className:"nav-section",children:[f.jsx("div",{className:"nav-section-title",children:"Account"}),f.jsxs("div",{className:"nav-item",onClick:()=>{me(!0),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"⭐"}),f.jsx("span",{children:"Subscription"})]}),te&&f.jsxs("div",{className:"nav-item",onClick:()=>{ce(!0),se(!1)},children:[f.jsx("span",{className:"nav-icon",children:"👑"}),f.jsx("span",{children:"Admin Panel"})]}),f.jsxs("div",{className:"nav-item",onClick:U.signOut,children:[f.jsx("span",{className:"nav-icon",children:"🚪"}),f.jsx("span",{children:"Sign Out"})]})]})]})]}),f.jsx("div",{className:`sidebar-overlay ${ke?"active":""}`,onClick:()=>se(!1)}),xt&&f.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3,minWidth:320,maxWidth:500,maxHeight:"70vh",background:"white",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-2xl)",overflow:"hidden",display:"flex",flexDirection:"column"},children:[f.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--gray-200)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[f.jsx("h3",{style:{margin:0},children:"Cloud Backups (Last 7 Days)"}),f.jsx("button",{className:"btn btn-ghost",style:{padding:"0.5rem"},onClick:()=>st(!1),children:"✕"})]}),f.jsxs("div",{style:{flex:1,overflow:"auto",padding:"1rem"},children:[$e&&f.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[f.jsx("div",{className:"spinner"}),f.jsx("p",{children:"Loading backups..."})]}),!$e&&ur&&f.jsx("div",{style:{padding:"1rem",color:"var(--danger)"},children:ur}),!$e&&!ur&&wt.length===0&&f.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--gray-500)"},children:"No backups found"}),!$e&&!ur&&wt.map(De=>{const Ke=De.object_path.split("/"),Ye=Ke[Ke.length-1]||De.object_path,He=De.day_key||"",Qe=De.size_bytes?Math.round(De.size_bytes/1024)+" KB":"";return f.jsxs("button",{className:"btn btn-ghost",style:{width:"100%",justifyContent:"space-between",marginBottom:"0.5rem",padding:"1rem"},onClick:()=>nr(De.object_path),children:[f.jsx("span",{style:{fontWeight:500},children:Ye}),f.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--gray-500)"},children:[He," · ",Qe]})]},De.object_path)})]})]}),xt&&f.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1999},onClick:()=>st(!1)}),U.error&&f.jsxs("div",{style:{position:"fixed",bottom:"1rem",left:"50%",transform:"translateX(-50%)",background:"var(--danger-light)",border:"1px solid var(--danger)",borderRadius:"var(--radius-lg)",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",boxShadow:"var(--shadow-lg)",zIndex:1e3},children:[f.jsxs("span",{style:{color:"var(--danger)"},children:["⚠️ ",U.error]}),f.jsx("button",{className:"btn btn-ghost btn-sm",onClick:U.clearError,children:"Dismiss"})]}),f.jsx(cD,{})]})}const fD="https://eevfxrgemrtthxbcxtvq.supabase.co";try{const e=new URL(fD).origin;["preconnect","dns-prefetch"].forEach(r=>{const t=document.createElement("link");t.rel=r,t.href=e,r==="preconnect"&&(t.crossOrigin=""),document.head.appendChild(t)})}catch{}O_.createRoot(document.getElementById("root")).render(f.jsx(uD,{}));
