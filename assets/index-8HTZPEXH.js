(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function hh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function ok(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var X0={exports:{}},fu={},J0={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kv;function lk(){if(Kv)return Ft;Kv=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function _(Y){return Y===null||typeof Y!="object"?null:(Y=y&&Y[y]||Y["@@iterator"],typeof Y=="function"?Y:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function E(Y,F,U){this.props=Y,this.context=F,this.refs=w,this.updater=U||T}E.prototype.isReactComponent={},E.prototype.setState=function(Y,F){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,F,"setState")},E.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function P(){}P.prototype=E.prototype;function I(Y,F,U){this.props=Y,this.context=F,this.refs=w,this.updater=U||T}var A=I.prototype=new P;A.constructor=I,S(A,E.prototype),A.isPureReactComponent=!0;var R=Array.isArray,K=Object.prototype.hasOwnProperty,W={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function ee(Y,F,U){var z,q={},M=null,oe=null;if(F!=null)for(z in F.ref!==void 0&&(oe=F.ref),F.key!==void 0&&(M=""+F.key),F)K.call(F,z)&&!D.hasOwnProperty(z)&&(q[z]=F[z]);var se=arguments.length-2;if(se===1)q.children=U;else if(1<se){for(var fe=Array(se),xe=0;xe<se;xe++)fe[xe]=arguments[xe+2];q.children=fe}if(Y&&Y.defaultProps)for(z in se=Y.defaultProps,se)q[z]===void 0&&(q[z]=se[z]);return{$$typeof:e,type:Y,key:M,ref:oe,props:q,_owner:W.current}}function re(Y,F){return{$$typeof:e,type:Y.type,key:F,ref:Y.ref,props:Y.props,_owner:Y._owner}}function pe(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===e}function ue(Y){var F={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(U){return F[U]})}var ce=/\/+/g;function Ce(Y,F){return typeof Y=="object"&&Y!==null&&Y.key!=null?ue(""+Y.key):F.toString(36)}function ye(Y,F,U,z,q){var M=typeof Y;(M==="undefined"||M==="boolean")&&(Y=null);var oe=!1;if(Y===null)oe=!0;else switch(M){case"string":case"number":oe=!0;break;case"object":switch(Y.$$typeof){case e:case t:oe=!0}}if(oe)return oe=Y,q=q(oe),Y=z===""?"."+Ce(oe,0):z,R(q)?(U="",Y!=null&&(U=Y.replace(ce,"$&/")+"/"),ye(q,F,U,"",function(xe){return xe})):q!=null&&(pe(q)&&(q=re(q,U+(!q.key||oe&&oe.key===q.key?"":(""+q.key).replace(ce,"$&/")+"/")+Y)),F.push(q)),1;if(oe=0,z=z===""?".":z+":",R(Y))for(var se=0;se<Y.length;se++){M=Y[se];var fe=z+Ce(M,se);oe+=ye(M,F,U,fe,q)}else if(fe=_(Y),typeof fe=="function")for(Y=fe.call(Y),se=0;!(M=Y.next()).done;)M=M.value,fe=z+Ce(M,se++),oe+=ye(M,F,U,fe,q);else if(M==="object")throw F=String(Y),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.");return oe}function he(Y,F,U){if(Y==null)return Y;var z=[],q=0;return ye(Y,z,"","",function(M){return F.call(U,M,q++)}),z}function le(Y){if(Y._status===-1){var F=Y._result;F=F(),F.then(function(U){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=U)},function(U){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=U)}),Y._status===-1&&(Y._status=0,Y._result=F)}if(Y._status===1)return Y._result.default;throw Y._result}var j={current:null},H={transition:null},O={ReactCurrentDispatcher:j,ReactCurrentBatchConfig:H,ReactCurrentOwner:W};function ne(){throw Error("act(...) is not supported in production builds of React.")}return Ft.Children={map:he,forEach:function(Y,F,U){he(Y,function(){F.apply(this,arguments)},U)},count:function(Y){var F=0;return he(Y,function(){F++}),F},toArray:function(Y){return he(Y,function(F){return F})||[]},only:function(Y){if(!pe(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},Ft.Component=E,Ft.Fragment=r,Ft.Profiler=a,Ft.PureComponent=I,Ft.StrictMode=n,Ft.Suspense=m,Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,Ft.act=ne,Ft.cloneElement=function(Y,F,U){if(Y==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Y+".");var z=S({},Y.props),q=Y.key,M=Y.ref,oe=Y._owner;if(F!=null){if(F.ref!==void 0&&(M=F.ref,oe=W.current),F.key!==void 0&&(q=""+F.key),Y.type&&Y.type.defaultProps)var se=Y.type.defaultProps;for(fe in F)K.call(F,fe)&&!D.hasOwnProperty(fe)&&(z[fe]=F[fe]===void 0&&se!==void 0?se[fe]:F[fe])}var fe=arguments.length-2;if(fe===1)z.children=U;else if(1<fe){se=Array(fe);for(var xe=0;xe<fe;xe++)se[xe]=arguments[xe+2];z.children=se}return{$$typeof:e,type:Y.type,key:q,ref:M,props:z,_owner:oe}},Ft.createContext=function(Y){return Y={$$typeof:l,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Y.Provider={$$typeof:s,_context:Y},Y.Consumer=Y},Ft.createElement=ee,Ft.createFactory=function(Y){var F=ee.bind(null,Y);return F.type=Y,F},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function(Y){return{$$typeof:u,render:Y}},Ft.isValidElement=pe,Ft.lazy=function(Y){return{$$typeof:g,_payload:{_status:-1,_result:Y},_init:le}},Ft.memo=function(Y,F){return{$$typeof:p,type:Y,compare:F===void 0?null:F}},Ft.startTransition=function(Y){var F=H.transition;H.transition={};try{Y()}finally{H.transition=F}},Ft.unstable_act=ne,Ft.useCallback=function(Y,F){return j.current.useCallback(Y,F)},Ft.useContext=function(Y){return j.current.useContext(Y)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function(Y){return j.current.useDeferredValue(Y)},Ft.useEffect=function(Y,F){return j.current.useEffect(Y,F)},Ft.useId=function(){return j.current.useId()},Ft.useImperativeHandle=function(Y,F,U){return j.current.useImperativeHandle(Y,F,U)},Ft.useInsertionEffect=function(Y,F){return j.current.useInsertionEffect(Y,F)},Ft.useLayoutEffect=function(Y,F){return j.current.useLayoutEffect(Y,F)},Ft.useMemo=function(Y,F){return j.current.useMemo(Y,F)},Ft.useReducer=function(Y,F,U){return j.current.useReducer(Y,F,U)},Ft.useRef=function(Y){return j.current.useRef(Y)},Ft.useState=function(Y){return j.current.useState(Y)},Ft.useSyncExternalStore=function(Y,F,U){return j.current.useSyncExternalStore(Y,F,U)},Ft.useTransition=function(){return j.current.useTransition()},Ft.version="18.3.1",Ft}var Yv;function lp(){return Yv||(Yv=1,J0.exports=lk()),J0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qv;function ck(){if(qv)return fu;qv=1;var e=lp(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(u,m,p){var g,y={},_=null,T=null;p!==void 0&&(_=""+p),m.key!==void 0&&(_=""+m.key),m.ref!==void 0&&(T=m.ref);for(g in m)n.call(m,g)&&!s.hasOwnProperty(g)&&(y[g]=m[g]);if(u&&u.defaultProps)for(g in m=u.defaultProps,m)y[g]===void 0&&(y[g]=m[g]);return{$$typeof:t,type:u,key:_,ref:T,props:y,_owner:a.current}}return fu.Fragment=r,fu.jsx=l,fu.jsxs=l,fu}var Xv;function uk(){return Xv||(Xv=1,X0.exports=ck()),X0.exports}var d=uk(),bf={},Q0={exports:{}},Gn={},em={exports:{}},tm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jv;function dk(){return Jv||(Jv=1,(function(e){function t(H,O){var ne=H.length;H.push(O);e:for(;0<ne;){var Y=ne-1>>>1,F=H[Y];if(0<a(F,O))H[Y]=O,H[ne]=F,ne=Y;else break e}}function r(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var O=H[0],ne=H.pop();if(ne!==O){H[0]=ne;e:for(var Y=0,F=H.length,U=F>>>1;Y<U;){var z=2*(Y+1)-1,q=H[z],M=z+1,oe=H[M];if(0>a(q,ne))M<F&&0>a(oe,q)?(H[Y]=oe,H[M]=ne,Y=M):(H[Y]=q,H[z]=ne,Y=z);else if(M<F&&0>a(oe,ne))H[Y]=oe,H[M]=ne,Y=M;else break e}}return O}function a(H,O){var ne=H.sortIndex-O.sortIndex;return ne!==0?ne:H.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var m=[],p=[],g=1,y=null,_=3,T=!1,S=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(H){for(var O=r(p);O!==null;){if(O.callback===null)n(p);else if(O.startTime<=H)n(p),O.sortIndex=O.expirationTime,t(m,O);else break;O=r(p)}}function R(H){if(w=!1,A(H),!S)if(r(m)!==null)S=!0,le(K);else{var O=r(p);O!==null&&j(R,O.startTime-H)}}function K(H,O){S=!1,w&&(w=!1,P(ee),ee=-1),T=!0;var ne=_;try{for(A(O),y=r(m);y!==null&&(!(y.expirationTime>O)||H&&!ue());){var Y=y.callback;if(typeof Y=="function"){y.callback=null,_=y.priorityLevel;var F=Y(y.expirationTime<=O);O=e.unstable_now(),typeof F=="function"?y.callback=F:y===r(m)&&n(m),A(O)}else n(m);y=r(m)}if(y!==null)var U=!0;else{var z=r(p);z!==null&&j(R,z.startTime-O),U=!1}return U}finally{y=null,_=ne,T=!1}}var W=!1,D=null,ee=-1,re=5,pe=-1;function ue(){return!(e.unstable_now()-pe<re)}function ce(){if(D!==null){var H=e.unstable_now();pe=H;var O=!0;try{O=D(!0,H)}finally{O?Ce():(W=!1,D=null)}}else W=!1}var Ce;if(typeof I=="function")Ce=function(){I(ce)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,he=ye.port2;ye.port1.onmessage=ce,Ce=function(){he.postMessage(null)}}else Ce=function(){E(ce,0)};function le(H){D=H,W||(W=!0,Ce())}function j(H,O){ee=E(function(){H(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(H){H.callback=null},e.unstable_continueExecution=function(){S||T||(S=!0,le(K))},e.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<H?Math.floor(1e3/H):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return r(m)},e.unstable_next=function(H){switch(_){case 1:case 2:case 3:var O=3;break;default:O=_}var ne=_;_=O;try{return H()}finally{_=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(H,O){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ne=_;_=H;try{return O()}finally{_=ne}},e.unstable_scheduleCallback=function(H,O,ne){var Y=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Y+ne:Y):ne=Y,H){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ne+F,H={id:g++,callback:O,priorityLevel:H,startTime:ne,expirationTime:F,sortIndex:-1},ne>Y?(H.sortIndex=ne,t(p,H),r(m)===null&&H===r(p)&&(w?(P(ee),ee=-1):w=!0,j(R,ne-Y))):(H.sortIndex=F,t(m,H),S||T||(S=!0,le(K))),H},e.unstable_shouldYield=ue,e.unstable_wrapCallback=function(H){var O=_;return function(){var ne=_;_=O;try{return H.apply(this,arguments)}finally{_=ne}}}})(tm)),tm}var Qv;function fk(){return Qv||(Qv=1,em.exports=dk()),em.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ex;function hk(){if(ex)return Gn;ex=1;var e=lp(),t=fk();function r(i){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function s(i,c){l(i,c),l(i+"Capture",c)}function l(i,c){for(a[i]=c,i=0;i<c.length;i++)n.add(c[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},y={};function _(i){return m.call(y,i)?!0:m.call(g,i)?!1:p.test(i)?y[i]=!0:(g[i]=!0,!1)}function T(i,c,h,x){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return x?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function S(i,c,h,x){if(c===null||typeof c>"u"||T(i,c,h,x))return!0;if(x)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function w(i,c,h,x,k,C,V){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=x,this.attributeNamespace=k,this.mustUseProperty=h,this.propertyName=i,this.type=c,this.sanitizeURL=C,this.removeEmptyString=V}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){E[i]=new w(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var c=i[0];E[c]=new w(c,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){E[i]=new w(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){E[i]=new w(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){E[i]=new w(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){E[i]=new w(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){E[i]=new w(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){E[i]=new w(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){E[i]=new w(i,5,!1,i.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function I(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var c=i.replace(P,I);E[c]=new w(c,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var c=i.replace(P,I);E[c]=new w(c,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var c=i.replace(P,I);E[c]=new w(c,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){E[i]=new w(i,1,!1,i.toLowerCase(),null,!1,!1)}),E.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){E[i]=new w(i,1,!1,i.toLowerCase(),null,!0,!0)});function A(i,c,h,x){var k=E.hasOwnProperty(c)?E[c]:null;(k!==null?k.type!==0:x||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(S(c,h,k,x)&&(h=null),x||k===null?_(c)&&(h===null?i.removeAttribute(c):i.setAttribute(c,""+h)):k.mustUseProperty?i[k.propertyName]=h===null?k.type===3?!1:"":h:(c=k.attributeName,x=k.attributeNamespace,h===null?i.removeAttribute(c):(k=k.type,h=k===3||k===4&&h===!0?"":""+h,x?i.setAttributeNS(x,c,h):i.setAttribute(c,h))))}var R=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,K=Symbol.for("react.element"),W=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),re=Symbol.for("react.profiler"),pe=Symbol.for("react.provider"),ue=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),Ce=Symbol.for("react.suspense"),ye=Symbol.for("react.suspense_list"),he=Symbol.for("react.memo"),le=Symbol.for("react.lazy"),j=Symbol.for("react.offscreen"),H=Symbol.iterator;function O(i){return i===null||typeof i!="object"?null:(i=H&&i[H]||i["@@iterator"],typeof i=="function"?i:null)}var ne=Object.assign,Y;function F(i){if(Y===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);Y=c&&c[1]||""}return`
`+Y+i}var U=!1;function z(i,c){if(!i||U)return"";U=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Ie){var x=Ie}Reflect.construct(i,[],c)}else{try{c.call()}catch(Ie){x=Ie}i.call(c.prototype)}else{try{throw Error()}catch(Ie){x=Ie}i()}}catch(Ie){if(Ie&&x&&typeof Ie.stack=="string"){for(var k=Ie.stack.split(`
`),C=x.stack.split(`
`),V=k.length-1,de=C.length-1;1<=V&&0<=de&&k[V]!==C[de];)de--;for(;1<=V&&0<=de;V--,de--)if(k[V]!==C[de]){if(V!==1||de!==1)do if(V--,de--,0>de||k[V]!==C[de]){var ge=`
`+k[V].replace(" at new "," at ");return i.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",i.displayName)),ge}while(1<=V&&0<=de);break}}}finally{U=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?F(i):""}function q(i){switch(i.tag){case 5:return F(i.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return i=z(i.type,!1),i;case 11:return i=z(i.type.render,!1),i;case 1:return i=z(i.type,!0),i;default:return""}}function M(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case D:return"Fragment";case W:return"Portal";case re:return"Profiler";case ee:return"StrictMode";case Ce:return"Suspense";case ye:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case ue:return(i.displayName||"Context")+".Consumer";case pe:return(i._context.displayName||"Context")+".Provider";case ce:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case he:return c=i.displayName||null,c!==null?c:M(i.type)||"Memo";case le:c=i._payload,i=i._init;try{return M(i(c))}catch{}}return null}function oe(i){var c=i.type;switch(i.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=c.render,i=i.displayName||i.name||"",c.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return M(c);case 8:return c===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function se(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function fe(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function xe(i){var c=fe(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,c),x=""+i[c];if(!i.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var k=h.get,C=h.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return k.call(this)},set:function(V){x=""+V,C.call(this,V)}}),Object.defineProperty(i,c,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(V){x=""+V},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function je(i){i._valueTracker||(i._valueTracker=xe(i))}function X(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return i&&(x=fe(i)?i.checked?"true":"false":i.value),i=x,i!==h?(c.setValue(i),!0):!1}function Ke(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Xe(i,c){var h=c.checked;return ne({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function Qe(i,c){var h=c.defaultValue==null?"":c.defaultValue,x=c.checked!=null?c.checked:c.defaultChecked;h=se(c.value!=null?c.value:h),i._wrapperState={initialChecked:x,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function it(i,c){c=c.checked,c!=null&&A(i,"checked",c,!1)}function Le(i,c){it(i,c);var h=se(c.value),x=c.type;if(h!=null)x==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(x==="submit"||x==="reset"){i.removeAttribute("value");return}c.hasOwnProperty("value")?ft(i,c.type,h):c.hasOwnProperty("defaultValue")&&ft(i,c.type,se(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(i.defaultChecked=!!c.defaultChecked)}function kt(i,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var x=c.type;if(!(x!=="submit"&&x!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+i._wrapperState.initialValue,h||c===i.value||(i.value=c),i.defaultValue=c}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function ft(i,c,h){(c!=="number"||Ke(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var pt=Array.isArray;function Gt(i,c,h,x){if(i=i.options,c){c={};for(var k=0;k<h.length;k++)c["$"+h[k]]=!0;for(h=0;h<i.length;h++)k=c.hasOwnProperty("$"+i[h].value),i[h].selected!==k&&(i[h].selected=k),k&&x&&(i[h].defaultSelected=!0)}else{for(h=""+se(h),c=null,k=0;k<i.length;k++){if(i[k].value===h){i[k].selected=!0,x&&(i[k].defaultSelected=!0);return}c!==null||i[k].disabled||(c=i[k])}c!==null&&(c.selected=!0)}}function Cn(i,c){if(c.dangerouslySetInnerHTML!=null)throw Error(r(91));return ne({},c,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function zr(i,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(r(92));if(pt(h)){if(1<h.length)throw Error(r(93));h=h[0]}c=h}c==null&&(c=""),h=c}i._wrapperState={initialValue:se(h)}}function Cr(i,c){var h=se(c.value),x=se(c.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),c.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),x!=null&&(i.defaultValue=""+x)}function un(i){var c=i.textContent;c===i._wrapperState.initialValue&&c!==""&&c!==null&&(i.value=c)}function Fr(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nn(i,c){return i==null||i==="http://www.w3.org/1999/xhtml"?Fr(c):i==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Jt,Ar=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,x,k){MSApp.execUnsafeLocalFunction(function(){return i(c,h,x,k)})}:i})(function(i,c){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=c;else{for(Jt=Jt||document.createElement("div"),Jt.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Jt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;c.firstChild;)i.appendChild(c.firstChild)}});function ht(i,c){if(c){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=c;return}}i.textContent=c}var Ct={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pr=["Webkit","ms","Moz","O"];Object.keys(Ct).forEach(function(i){pr.forEach(function(c){c=c+i.charAt(0).toUpperCase()+i.substring(1),Ct[c]=Ct[i]})});function Ht(i,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||Ct.hasOwnProperty(i)&&Ct[i]?(""+c).trim():c+"px"}function ct(i,c){i=i.style;for(var h in c)if(c.hasOwnProperty(h)){var x=h.indexOf("--")===0,k=Ht(h,c[h],x);h==="float"&&(h="cssFloat"),x?i.setProperty(h,k):i[h]=k}}var oi=ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ii(i,c){if(c){if(oi[i]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(r(137,i));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(r(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(r(61))}if(c.style!=null&&typeof c.style!="object")throw Error(r(62))}}function Yn(i,c){if(i.indexOf("-")===-1)return typeof c.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var La=null;function qn(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var hr=null,Xn=null,An=null;function Ma(i){if(i=$i(i)){if(typeof hr!="function")throw Error(r(280));var c=i.stateNode;c&&(c=Dl(c),hr(i.stateNode,i.type,c))}}function ls(i){Xn?An?An.push(i):An=[i]:Xn=i}function cs(){if(Xn){var i=Xn,c=An;if(An=Xn=null,Ma(i),c)for(i=0;i<c.length;i++)Ma(c[i])}}function us(i,c){return i(c)}function ds(){}var Di=!1;function li(i,c,h){if(Di)return i(c,h);Di=!0;try{return us(i,c,h)}finally{Di=!1,(Xn!==null||An!==null)&&(ds(),cs())}}function Ba(i,c){var h=i.stateNode;if(h===null)return null;var x=Dl(h);if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(i=i.type,x=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!x;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(r(231,c,typeof h));return h}var De=!1;if(u)try{var He={};Object.defineProperty(He,"passive",{get:function(){De=!0}}),window.addEventListener("test",He,He),window.removeEventListener("test",He,He)}catch{De=!1}function tt(i,c,h,x,k,C,V,de,ge){var Ie=Array.prototype.slice.call(arguments,3);try{c.apply(h,Ie)}catch(Ue){this.onError(Ue)}}var Ge=!1,Oe=null,B=!1,Q=null,Z={onError:function(i){Ge=!0,Oe=i}};function te(i,c,h,x,k,C,V,de,ge){Ge=!1,Oe=null,tt.apply(Z,arguments)}function ie(i,c,h,x,k,C,V,de,ge){if(te.apply(this,arguments),Ge){if(Ge){var Ie=Oe;Ge=!1,Oe=null}else throw Error(r(198));B||(B=!0,Q=Ie)}}function ae(i){var c=i,h=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(h=c.return),i=c.return;while(i)}return c.tag===3?h:null}function we(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function Te(i){if(ae(i)!==i)throw Error(r(188))}function be(i){var c=i.alternate;if(!c){if(c=ae(i),c===null)throw Error(r(188));return c!==i?null:i}for(var h=i,x=c;;){var k=h.return;if(k===null)break;var C=k.alternate;if(C===null){if(x=k.return,x!==null){h=x;continue}break}if(k.child===C.child){for(C=k.child;C;){if(C===h)return Te(k),i;if(C===x)return Te(k),c;C=C.sibling}throw Error(r(188))}if(h.return!==x.return)h=k,x=C;else{for(var V=!1,de=k.child;de;){if(de===h){V=!0,h=k,x=C;break}if(de===x){V=!0,x=k,h=C;break}de=de.sibling}if(!V){for(de=C.child;de;){if(de===h){V=!0,h=C,x=k;break}if(de===x){V=!0,x=C,h=k;break}de=de.sibling}if(!V)throw Error(r(189))}}if(h.alternate!==x)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?i:c}function ke(i){return i=be(i),i!==null?Ae(i):null}function Ae(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var c=Ae(i);if(c!==null)return c;i=i.sibling}return null}var ze=t.unstable_scheduleCallback,qe=t.unstable_cancelCallback,nt=t.unstable_shouldYield,Ze=t.unstable_requestPaint,Ve=t.unstable_now,St=t.unstable_getCurrentPriorityLevel,Zt=t.unstable_ImmediatePriority,Qt=t.unstable_UserBlockingPriority,gr=t.unstable_NormalPriority,za=t.unstable_LowPriority,Mn=t.unstable_IdlePriority,Jn=null,Nr=null;function Ua(i){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Jn,i,void 0,(i.current.flags&128)===128)}catch{}}var mt=Math.clz32?Math.clz32:fs,lr=Math.log,ul=Math.LN2;function fs(i){return i>>>=0,i===0?32:31-(lr(i)/ul|0)|0}var Wa=64,hs=4194304;function Et(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function ir(i,c){var h=i.pendingLanes;if(h===0)return 0;var x=0,k=i.suspendedLanes,C=i.pingedLanes,V=h&268435455;if(V!==0){var de=V&~k;de!==0?x=Et(de):(C&=V,C!==0&&(x=Et(C)))}else V=h&~k,V!==0?x=Et(V):C!==0&&(x=Et(C));if(x===0)return 0;if(c!==0&&c!==x&&(c&k)===0&&(k=x&-x,C=c&-c,k>=C||k===16&&(C&4194240)!==0))return c;if((x&4)!==0&&(x|=h&16),c=i.entangledLanes,c!==0)for(i=i.entanglements,c&=x;0<c;)h=31-mt(c),k=1<<h,x|=i[h],c&=~k;return x}function Ac(i,c){switch(i){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dl(i,c){for(var h=i.suspendedLanes,x=i.pingedLanes,k=i.expirationTimes,C=i.pendingLanes;0<C;){var V=31-mt(C),de=1<<V,ge=k[V];ge===-1?((de&h)===0||(de&x)!==0)&&(k[V]=Ac(de,c)):ge<=c&&(i.expiredLanes|=de),C&=~de}}function dn(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function md(){var i=Wa;return Wa<<=1,(Wa&4194240)===0&&(Wa=64),i}function ms(i){for(var c=[],h=0;31>h;h++)c.push(i);return c}function Qn(i,c,h){i.pendingLanes|=c,c!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,c=31-mt(c),i[c]=h}function wr(i,c){var h=i.pendingLanes&~c;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=c,i.mutableReadLanes&=c,i.entangledLanes&=c,c=i.entanglements;var x=i.eventTimes;for(i=i.expirationTimes;0<h;){var k=31-mt(h),C=1<<k;c[k]=0,x[k]=-1,i[k]=-1,h&=~C}}function $a(i,c){var h=i.entangledLanes|=c;for(i=i.entanglements;h;){var x=31-mt(h),k=1<<x;k&c|i[x]&c&&(i[x]|=c),h&=~k}}var Mt=0;function ps(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var fl,Fi,hl,ml,uo,fo=!1,gs=[],ea=null,Ha=null,pa=null,ho=new Map,wt=new Map,Ur=[],er="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nc(i,c){switch(i){case"focusin":case"focusout":ea=null;break;case"dragenter":case"dragleave":Ha=null;break;case"mouseover":case"mouseout":pa=null;break;case"pointerover":case"pointerout":ho.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":wt.delete(c.pointerId)}}function ji(i,c,h,x,k,C){return i===null||i.nativeEvent!==C?(i={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:C,targetContainers:[k]},c!==null&&(c=$i(c),c!==null&&Fi(c)),i):(i.eventSystemFlags|=x,c=i.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),i)}function Pc(i,c,h,x,k){switch(c){case"focusin":return ea=ji(ea,i,c,h,x,k),!0;case"dragenter":return Ha=ji(Ha,i,c,h,x,k),!0;case"mouseover":return pa=ji(pa,i,c,h,x,k),!0;case"pointerover":var C=k.pointerId;return ho.set(C,ji(ho.get(C)||null,i,c,h,x,k)),!0;case"gotpointercapture":return C=k.pointerId,wt.set(C,ji(wt.get(C)||null,i,c,h,x,k)),!0}return!1}function pl(i){var c=Wi(i.target);if(c!==null){var h=ae(c);if(h!==null){if(c=h.tag,c===13){if(c=we(h),c!==null){i.blockedOn=c,uo(i.priority,function(){hl(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ga(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var h=xl(i.domEventName,i.eventSystemFlags,c[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var x=new h.constructor(h.type,h);La=x,h.target.dispatchEvent(x),La=null}else return c=$i(h),c!==null&&Fi(c),i.blockedOn=h,!1;c.shift()}return!0}function gl(i,c,h){ga(i)&&h.delete(c)}function mo(){fo=!1,ea!==null&&ga(ea)&&(ea=null),Ha!==null&&ga(Ha)&&(Ha=null),pa!==null&&ga(pa)&&(pa=null),ho.forEach(gl),wt.forEach(gl)}function vr(i,c){i.blockedOn===c&&(i.blockedOn=null,fo||(fo=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,mo)))}function ta(i){function c(k){return vr(k,i)}if(0<gs.length){vr(gs[0],i);for(var h=1;h<gs.length;h++){var x=gs[h];x.blockedOn===i&&(x.blockedOn=null)}}for(ea!==null&&vr(ea,i),Ha!==null&&vr(Ha,i),pa!==null&&vr(pa,i),ho.forEach(c),wt.forEach(c),h=0;h<Ur.length;h++)x=Ur[h],x.blockedOn===i&&(x.blockedOn=null);for(;0<Ur.length&&(h=Ur[0],h.blockedOn===null);)pl(h),h.blockedOn===null&&Ur.shift()}var Oi=R.ReactCurrentBatchConfig,po=!0;function Dh(i,c,h,x){var k=Mt,C=Oi.transition;Oi.transition=null;try{Mt=1,go(i,c,h,x)}finally{Mt=k,Oi.transition=C}}function pd(i,c,h,x){var k=Mt,C=Oi.transition;Oi.transition=null;try{Mt=4,go(i,c,h,x)}finally{Mt=k,Oi.transition=C}}function go(i,c,h,x){if(po){var k=xl(i,c,h,x);if(k===null)o(i,c,x,vl,h),Nc(i,x);else if(Pc(k,i,c,h,x))x.stopPropagation();else if(Nc(i,x),c&4&&-1<er.indexOf(i)){for(;k!==null;){var C=$i(k);if(C!==null&&fl(C),C=xl(i,c,h,x),C===null&&o(i,c,x,vl,h),C===k)break;k=C}k!==null&&x.stopPropagation()}else o(i,c,x,null,h)}}var vl=null;function xl(i,c,h,x){if(vl=null,i=qn(x),i=Wi(i),i!==null)if(c=ae(i),c===null)i=null;else if(h=c.tag,h===13){if(i=we(c),i!==null)return i;i=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null);return vl=i,null}function Ot(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(St()){case Zt:return 1;case Qt:return 4;case gr:case za:return 16;case Mn:return 536870912;default:return 16}default:return 16}}var ci=null,Nn=null,ui=null;function Ic(){if(ui)return ui;var i,c=Nn,h=c.length,x,k="value"in ci?ci.value:ci.textContent,C=k.length;for(i=0;i<h&&c[i]===k[i];i++);var V=h-i;for(x=1;x<=V&&c[h-x]===k[C-x];x++);return ui=k.slice(i,1<x?1-x:void 0)}function yl(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function vs(){return!0}function gd(){return!1}function fn(i){function c(h,x,k,C,V){this._reactName=h,this._targetInst=k,this.type=x,this.nativeEvent=C,this.target=V,this.currentTarget=null;for(var de in i)i.hasOwnProperty(de)&&(h=i[de],this[de]=h?h(C):C[de]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?vs:gd,this.isPropagationStopped=gd,this}return ne(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=vs)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=vs)},persist:function(){},isPersistent:vs}),c}var xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Dc=fn(xs),Ri=ne({},xs,{view:0,detail:0}),Fh=fn(Ri),Bn,Fc,ys,ra=ne({},Ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mi,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ys&&(ys&&i.type==="mousemove"?(Bn=i.screenX-ys.screenX,Fc=i.screenY-ys.screenY):Fc=Bn=0,ys=i),Bn)},movementY:function(i){return"movementY"in i?i.movementY:Fc}}),jc=fn(ra),vd=ne({},ra,{dataTransfer:0}),Oc=fn(vd),jh=ne({},Ri,{relatedTarget:0}),_l=fn(jh),xd=ne({},xs,{animationName:0,elapsedTime:0,pseudoElement:0}),Oh=fn(xd),Rh=ne({},xs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Rc=fn(Rh),Lh=ne({},xs,{data:0}),Lc=fn(Lh),yd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Li={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mh(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=Li[i])?!!c[i]:!1}function Mi(){return Mh}var zn=ne({},Ri,{key:function(i){if(i.key){var c=yd[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=yl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?wl[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mi,charCode:function(i){return i.type==="keypress"?yl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?yl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),_d=fn(zn),wd=ne({},ra,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bd=fn(wd),Mc=ne({},Ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mi}),Bc=fn(Mc),Bh=ne({},xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),zh=fn(Bh),kd=ne({},ra,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Uh=fn(kd),na=[9,13,27,32],di=u&&"CompositionEvent"in window,vo=null;u&&"documentMode"in document&&(vo=document.documentMode);var Va=u&&"TextEvent"in window&&!vo,Sd=u&&(!di||vo&&8<vo&&11>=vo),Bi=" ",Td=!1;function _s(i,c){switch(i){case"keyup":return na.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ga=!1;function Wh(i,c){switch(i){case"compositionend":return zc(c);case"keypress":return c.which!==32?null:(Td=!0,Bi);case"textInput":return i=c.data,i===Bi&&Td?null:i;default:return null}}function fi(i,c){if(Ga)return i==="compositionend"||!di&&_s(i,c)?(i=Ic(),ui=Nn=ci=null,Ga=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Sd&&c.locale!=="ko"?null:c.data;default:return null}}var bl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ed(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!bl[i.type]:c==="textarea"}function kl(i,c,h,x){ls(x),c=v(c,"onChange"),0<c.length&&(h=new Dc("onChange","change",null,h,x),i.push({event:h,listeners:c}))}var xo=null,Pn=null;function $h(i){Yc(i,0)}function Za(i){var c=Hi(i);if(X(c))return i}function Hh(i,c){if(i==="change")return c}var va=!1;if(u){var ws;if(u){var Sl="oninput"in document;if(!Sl){var Tl=document.createElement("div");Tl.setAttribute("oninput","return;"),Sl=typeof Tl.oninput=="function"}ws=Sl}else ws=!1;va=ws&&(!document.documentMode||9<document.documentMode)}function yo(){xo&&(xo.detachEvent("onpropertychange",El),Pn=xo=null)}function El(i){if(i.propertyName==="value"&&Za(Pn)){var c=[];kl(c,Pn,i,qn(i)),li($h,c)}}function Cl(i,c,h){i==="focusin"?(yo(),xo=c,Pn=h,xo.attachEvent("onpropertychange",El)):i==="focusout"&&yo()}function bs(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Za(Pn)}function Al(i,c){if(i==="click")return Za(c)}function Uc(i,c){if(i==="input"||i==="change")return Za(c)}function Cd(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var aa=typeof Object.is=="function"?Object.is:Cd;function hi(i,c){if(aa(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var h=Object.keys(i),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var k=h[x];if(!m.call(c,k)||!aa(i[k],c[k]))return!1}return!0}function Ad(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Wc(i,c){var h=Ad(i);i=0;for(var x;h;){if(h.nodeType===3){if(x=i+h.textContent.length,i<=c&&x>=c)return{node:h,offset:c-i};i=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=Ad(h)}}function Nd(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?Nd(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function $c(){for(var i=window,c=Ke();c instanceof i.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)i=c.contentWindow;else break;c=Ke(i.document)}return c}function Hc(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}function xa(i){var c=$c(),h=i.focusedElem,x=i.selectionRange;if(c!==h&&h&&h.ownerDocument&&Nd(h.ownerDocument.documentElement,h)){if(x!==null&&Hc(h)){if(c=x.start,i=x.end,i===void 0&&(i=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(i,h.value.length);else if(i=(c=h.ownerDocument||document)&&c.defaultView||window,i.getSelection){i=i.getSelection();var k=h.textContent.length,C=Math.min(x.start,k);x=x.end===void 0?C:Math.min(x.end,k),!i.extend&&C>x&&(k=x,x=C,C=k),k=Wc(h,C);var V=Wc(h,x);k&&V&&(i.rangeCount!==1||i.anchorNode!==k.node||i.anchorOffset!==k.offset||i.focusNode!==V.node||i.focusOffset!==V.offset)&&(c=c.createRange(),c.setStart(k.node,k.offset),i.removeAllRanges(),C>x?(i.addRange(c),i.extend(V.node,V.offset)):(c.setEnd(V.node,V.offset),i.addRange(c)))}}for(c=[],i=h;i=i.parentNode;)i.nodeType===1&&c.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)i=c[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Nl=u&&"documentMode"in document&&11>=document.documentMode,ks=null,Ss=null,_o=null,Pl=!1;function Pd(i,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Pl||ks==null||ks!==Ke(x)||(x=ks,"selectionStart"in x&&Hc(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),_o&&hi(_o,x)||(_o=x,x=v(Ss,"onSelect"),0<x.length&&(c=new Dc("onSelect","select",null,c,h),i.push({event:c,listeners:x}),c.target=ks)))}function mi(i,c){var h={};return h[i.toLowerCase()]=c.toLowerCase(),h["Webkit"+i]="webkit"+c,h["Moz"+i]="moz"+c,h}var Ts={animationend:mi("Animation","AnimationEnd"),animationiteration:mi("Animation","AnimationIteration"),animationstart:mi("Animation","AnimationStart"),transitionend:mi("Transition","TransitionEnd")},pi={},Vc={};u&&(Vc=document.createElement("div").style,"AnimationEvent"in window||(delete Ts.animationend.animation,delete Ts.animationiteration.animation,delete Ts.animationstart.animation),"TransitionEvent"in window||delete Ts.transitionend.transition);function wo(i){if(pi[i])return pi[i];if(!Ts[i])return i;var c=Ts[i],h;for(h in c)if(c.hasOwnProperty(h)&&h in Vc)return pi[i]=c[h];return i}var Id=wo("animationend"),ya=wo("animationiteration"),Gc=wo("animationstart"),Zc=wo("transitionend"),Es=new Map,Dd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ia(i,c){Es.set(i,c),s(c,[i])}for(var zi=0;zi<Dd.length;zi++){var Il=Dd[zi],Fd=Il.toLowerCase(),Vh=Il[0].toUpperCase()+Il.slice(1);ia(Fd,"on"+Vh)}ia(Id,"onAnimationEnd"),ia(ya,"onAnimationIteration"),ia(Gc,"onAnimationStart"),ia("dblclick","onDoubleClick"),ia("focusin","onFocus"),ia("focusout","onBlur"),ia(Zc,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jd=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cs));function Kc(i,c,h){var x=i.type||"unknown-event";i.currentTarget=h,ie(x,c,void 0,i),i.currentTarget=null}function Yc(i,c){c=(c&4)!==0;for(var h=0;h<i.length;h++){var x=i[h],k=x.event;x=x.listeners;e:{var C=void 0;if(c)for(var V=x.length-1;0<=V;V--){var de=x[V],ge=de.instance,Ie=de.currentTarget;if(de=de.listener,ge!==C&&k.isPropagationStopped())break e;Kc(k,de,Ie),C=ge}else for(V=0;V<x.length;V++){if(de=x[V],ge=de.instance,Ie=de.currentTarget,de=de.listener,ge!==C&&k.isPropagationStopped())break e;Kc(k,de,Ie),C=ge}}}if(B)throw i=Q,B=!1,Q=null,i}function tr(i,c){var h=c[Is];h===void 0&&(h=c[Is]=new Set);var x=i+"__bubble";h.has(x)||(Od(c,i,2,!1),h.add(x))}function qc(i,c,h){var x=0;c&&(x|=4),Od(h,i,x,c)}var bo="_reactListening"+Math.random().toString(36).slice(2);function As(i){if(!i[bo]){i[bo]=!0,n.forEach(function(h){h!=="selectionchange"&&(jd.has(h)||qc(h,!1,i),qc(h,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[bo]||(c[bo]=!0,qc("selectionchange",!1,c))}}function Od(i,c,h,x){switch(Ot(c)){case 1:var k=Dh;break;case 4:k=pd;break;default:k=go}h=k.bind(null,c,h,i),k=void 0,!De||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),x?k!==void 0?i.addEventListener(c,h,{capture:!0,passive:k}):i.addEventListener(c,h,!0):k!==void 0?i.addEventListener(c,h,{passive:k}):i.addEventListener(c,h,!1)}function o(i,c,h,x,k){var C=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var V=x.tag;if(V===3||V===4){var de=x.stateNode.containerInfo;if(de===k||de.nodeType===8&&de.parentNode===k)break;if(V===4)for(V=x.return;V!==null;){var ge=V.tag;if((ge===3||ge===4)&&(ge=V.stateNode.containerInfo,ge===k||ge.nodeType===8&&ge.parentNode===k))return;V=V.return}for(;de!==null;){if(V=Wi(de),V===null)return;if(ge=V.tag,ge===5||ge===6){x=C=V;continue e}de=de.parentNode}}x=x.return}li(function(){var Ie=C,Ue=qn(h),$e=[];e:{var Be=Es.get(i);if(Be!==void 0){var at=Dc,ot=i;switch(i){case"keypress":if(yl(h)===0)break e;case"keydown":case"keyup":at=_d;break;case"focusin":ot="focus",at=_l;break;case"focusout":ot="blur",at=_l;break;case"beforeblur":case"afterblur":at=_l;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=jc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=Oc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=Bc;break;case Id:case ya:case Gc:at=Oh;break;case Zc:at=zh;break;case"scroll":at=Fh;break;case"wheel":at=Uh;break;case"copy":case"cut":case"paste":at=Rc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=bd}var lt=(c&4)!==0,Pr=!lt&&i==="scroll",Ee=lt?Be!==null?Be+"Capture":null:Be;lt=[];for(var _e=Ie,Ne;_e!==null;){Ne=_e;var Ye=Ne.stateNode;if(Ne.tag===5&&Ye!==null&&(Ne=Ye,Ee!==null&&(Ye=Ba(_e,Ee),Ye!=null&&lt.push(f(_e,Ye,Ne)))),Pr)break;_e=_e.return}0<lt.length&&(Be=new at(Be,ot,null,h,Ue),$e.push({event:Be,listeners:lt}))}}if((c&7)===0){e:{if(Be=i==="mouseover"||i==="pointerover",at=i==="mouseout"||i==="pointerout",Be&&h!==La&&(ot=h.relatedTarget||h.fromElement)&&(Wi(ot)||ot[Vt]))break e;if((at||Be)&&(Be=Ue.window===Ue?Ue:(Be=Ue.ownerDocument)?Be.defaultView||Be.parentWindow:window,at?(ot=h.relatedTarget||h.toElement,at=Ie,ot=ot?Wi(ot):null,ot!==null&&(Pr=ae(ot),ot!==Pr||ot.tag!==5&&ot.tag!==6)&&(ot=null)):(at=null,ot=Ie),at!==ot)){if(lt=jc,Ye="onMouseLeave",Ee="onMouseEnter",_e="mouse",(i==="pointerout"||i==="pointerover")&&(lt=bd,Ye="onPointerLeave",Ee="onPointerEnter",_e="pointer"),Pr=at==null?Be:Hi(at),Ne=ot==null?Be:Hi(ot),Be=new lt(Ye,_e+"leave",at,h,Ue),Be.target=Pr,Be.relatedTarget=Ne,Ye=null,Wi(Ue)===Ie&&(lt=new lt(Ee,_e+"enter",ot,h,Ue),lt.target=Ne,lt.relatedTarget=Pr,Ye=lt),Pr=Ye,at&&ot)t:{for(lt=at,Ee=ot,_e=0,Ne=lt;Ne;Ne=b(Ne))_e++;for(Ne=0,Ye=Ee;Ye;Ye=b(Ye))Ne++;for(;0<_e-Ne;)lt=b(lt),_e--;for(;0<Ne-_e;)Ee=b(Ee),Ne--;for(;_e--;){if(lt===Ee||Ee!==null&&lt===Ee.alternate)break t;lt=b(lt),Ee=b(Ee)}lt=null}else lt=null;at!==null&&N($e,Be,at,lt,!1),ot!==null&&Pr!==null&&N($e,Pr,ot,lt,!0)}}e:{if(Be=Ie?Hi(Ie):window,at=Be.nodeName&&Be.nodeName.toLowerCase(),at==="select"||at==="input"&&Be.type==="file")var ut=Hh;else if(Ed(Be))if(va)ut=Uc;else{ut=bs;var vt=Cl}else(at=Be.nodeName)&&at.toLowerCase()==="input"&&(Be.type==="checkbox"||Be.type==="radio")&&(ut=Al);if(ut&&(ut=ut(i,Ie))){kl($e,ut,h,Ue);break e}vt&&vt(i,Be,Ie),i==="focusout"&&(vt=Be._wrapperState)&&vt.controlled&&Be.type==="number"&&ft(Be,"number",Be.value)}switch(vt=Ie?Hi(Ie):window,i){case"focusin":(Ed(vt)||vt.contentEditable==="true")&&(ks=vt,Ss=Ie,_o=null);break;case"focusout":_o=Ss=ks=null;break;case"mousedown":Pl=!0;break;case"contextmenu":case"mouseup":case"dragend":Pl=!1,Pd($e,h,Ue);break;case"selectionchange":if(Nl)break;case"keydown":case"keyup":Pd($e,h,Ue)}var xt;if(di)e:{switch(i){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else Ga?_s(i,h)&&(Tt="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(Tt="onCompositionStart");Tt&&(Sd&&h.locale!=="ko"&&(Ga||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&Ga&&(xt=Ic()):(ci=Ue,Nn="value"in ci?ci.value:ci.textContent,Ga=!0)),vt=v(Ie,Tt),0<vt.length&&(Tt=new Lc(Tt,i,null,h,Ue),$e.push({event:Tt,listeners:vt}),xt?Tt.data=xt:(xt=zc(h),xt!==null&&(Tt.data=xt)))),(xt=Va?Wh(i,h):fi(i,h))&&(Ie=v(Ie,"onBeforeInput"),0<Ie.length&&(Ue=new Lc("onBeforeInput","beforeinput",null,h,Ue),$e.push({event:Ue,listeners:Ie}),Ue.data=xt))}Yc($e,c)})}function f(i,c,h){return{instance:i,listener:c,currentTarget:h}}function v(i,c){for(var h=c+"Capture",x=[];i!==null;){var k=i,C=k.stateNode;k.tag===5&&C!==null&&(k=C,C=Ba(i,h),C!=null&&x.unshift(f(i,C,k)),C=Ba(i,c),C!=null&&x.push(f(i,C,k))),i=i.return}return x}function b(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function N(i,c,h,x,k){for(var C=c._reactName,V=[];h!==null&&h!==x;){var de=h,ge=de.alternate,Ie=de.stateNode;if(ge!==null&&ge===x)break;de.tag===5&&Ie!==null&&(de=Ie,k?(ge=Ba(h,C),ge!=null&&V.unshift(f(h,ge,de))):k||(ge=Ba(h,C),ge!=null&&V.push(f(h,ge,de)))),h=h.return}V.length!==0&&i.push({event:c,listeners:V})}var G=/\r\n?/g,me=/\u0000|\uFFFD/g;function Se(i){return(typeof i=="string"?i:""+i).replace(G,`
`).replace(me,"")}function Pe(i,c,h){if(c=Se(c),Se(i)!==c&&h)throw Error(r(425))}function Re(){}var rt=null,gt=null;function At(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var Wr=typeof setTimeout=="function"?setTimeout:void 0,jr=typeof clearTimeout=="function"?clearTimeout:void 0,In=typeof Promise=="function"?Promise:void 0,hn=typeof queueMicrotask=="function"?queueMicrotask:typeof In<"u"?function(i){return In.resolve(null).then(i).catch(Ns)}:Wr;function Ns(i){setTimeout(function(){throw i})}function Xc(i,c){var h=c,x=0;do{var k=h.nextSibling;if(i.removeChild(h),k&&k.nodeType===8)if(h=k.data,h==="/$"){if(x===0){i.removeChild(k),ta(c);return}x--}else h!=="$"&&h!=="$?"&&h!=="$!"||x++;h=k}while(h);ta(c)}function gi(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return i}function Rd(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return i;c--}else h==="/$"&&c++}i=i.previousSibling}return null}var Ui=Math.random().toString(36).slice(2),_a="__reactFiber$"+Ui,Ps="__reactProps$"+Ui,Vt="__reactContainer$"+Ui,Is="__reactEvents$"+Ui,Gh="__reactListeners$"+Ui,Zh="__reactHandles$"+Ui;function Wi(i){var c=i[_a];if(c)return c;for(var h=i.parentNode;h;){if(c=h[Vt]||h[_a]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(i=Rd(i);i!==null;){if(h=i[_a])return h;i=Rd(i)}return c}i=h,h=i.parentNode}return null}function $i(i){return i=i[_a]||i[Vt],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Hi(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(r(33))}function Dl(i){return i[Ps]||null}var Kh=[],Fl=-1;function Ds(i){return{current:i}}function cr(i){0>Fl||(i.current=Kh[Fl],Kh[Fl]=null,Fl--)}function sr(i,c){Fl++,Kh[Fl]=i.current,i.current=c}var Fs={},mn=Ds(Fs),Un=Ds(!1),ko=Fs;function jl(i,c){var h=i.type.contextTypes;if(!h)return Fs;var x=i.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===c)return x.__reactInternalMemoizedMaskedChildContext;var k={},C;for(C in h)k[C]=c[C];return x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=c,i.__reactInternalMemoizedMaskedChildContext=k),k}function Wn(i){return i=i.childContextTypes,i!=null}function Ld(){cr(Un),cr(mn)}function gg(i,c,h){if(mn.current!==Fs)throw Error(r(168));sr(mn,c),sr(Un,h)}function vg(i,c,h){var x=i.stateNode;if(c=c.childContextTypes,typeof x.getChildContext!="function")return h;x=x.getChildContext();for(var k in x)if(!(k in c))throw Error(r(108,oe(i)||"Unknown",k));return ne({},h,x)}function Md(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Fs,ko=mn.current,sr(mn,i),sr(Un,Un.current),!0}function xg(i,c,h){var x=i.stateNode;if(!x)throw Error(r(169));h?(i=vg(i,c,ko),x.__reactInternalMemoizedMergedChildContext=i,cr(Un),cr(mn),sr(mn,i)):cr(Un),sr(Un,h)}var Vi=null,Bd=!1,Yh=!1;function yg(i){Vi===null?Vi=[i]:Vi.push(i)}function Eb(i){Bd=!0,yg(i)}function js(){if(!Yh&&Vi!==null){Yh=!0;var i=0,c=Mt;try{var h=Vi;for(Mt=1;i<h.length;i++){var x=h[i];do x=x(!0);while(x!==null)}Vi=null,Bd=!1}catch(k){throw Vi!==null&&(Vi=Vi.slice(i+1)),ze(Zt,js),k}finally{Mt=c,Yh=!1}}return null}var Ol=[],Rl=0,zd=null,Ud=0,wa=[],ba=0,So=null,Gi=1,Zi="";function To(i,c){Ol[Rl++]=Ud,Ol[Rl++]=zd,zd=i,Ud=c}function _g(i,c,h){wa[ba++]=Gi,wa[ba++]=Zi,wa[ba++]=So,So=i;var x=Gi;i=Zi;var k=32-mt(x)-1;x&=~(1<<k),h+=1;var C=32-mt(c)+k;if(30<C){var V=k-k%5;C=(x&(1<<V)-1).toString(32),x>>=V,k-=V,Gi=1<<32-mt(c)+k|h<<k|x,Zi=C+i}else Gi=1<<C|h<<k|x,Zi=i}function qh(i){i.return!==null&&(To(i,1),_g(i,1,0))}function Xh(i){for(;i===zd;)zd=Ol[--Rl],Ol[Rl]=null,Ud=Ol[--Rl],Ol[Rl]=null;for(;i===So;)So=wa[--ba],wa[ba]=null,Zi=wa[--ba],wa[ba]=null,Gi=wa[--ba],wa[ba]=null}var sa=null,oa=null,mr=!1,Ka=null;function wg(i,c){var h=Ea(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=i,c=i.deletions,c===null?(i.deletions=[h],i.flags|=16):c.push(h)}function bg(i,c){switch(i.tag){case 5:var h=i.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(i.stateNode=c,sa=i,oa=gi(c.firstChild),!0):!1;case 6:return c=i.pendingProps===""||c.nodeType!==3?null:c,c!==null?(i.stateNode=c,sa=i,oa=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=So!==null?{id:Gi,overflow:Zi}:null,i.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=Ea(18,null,null,0),h.stateNode=c,h.return=i,i.child=h,sa=i,oa=null,!0):!1;default:return!1}}function Jh(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Qh(i){if(mr){var c=oa;if(c){var h=c;if(!bg(i,c)){if(Jh(i))throw Error(r(418));c=gi(h.nextSibling);var x=sa;c&&bg(i,c)?wg(x,h):(i.flags=i.flags&-4097|2,mr=!1,sa=i)}}else{if(Jh(i))throw Error(r(418));i.flags=i.flags&-4097|2,mr=!1,sa=i}}}function kg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;sa=i}function Wd(i){if(i!==sa)return!1;if(!mr)return kg(i),mr=!0,!1;var c;if((c=i.tag!==3)&&!(c=i.tag!==5)&&(c=i.type,c=c!=="head"&&c!=="body"&&!At(i.type,i.memoizedProps)),c&&(c=oa)){if(Jh(i))throw Sg(),Error(r(418));for(;c;)wg(i,c),c=gi(c.nextSibling)}if(kg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(c===0){oa=gi(i.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}i=i.nextSibling}oa=null}}else oa=sa?gi(i.stateNode.nextSibling):null;return!0}function Sg(){for(var i=oa;i;)i=gi(i.nextSibling)}function Ll(){oa=sa=null,mr=!1}function e0(i){Ka===null?Ka=[i]:Ka.push(i)}var Cb=R.ReactCurrentBatchConfig;function Jc(i,c,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(r(309));var x=h.stateNode}if(!x)throw Error(r(147,i));var k=x,C=""+i;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===C?c.ref:(c=function(V){var de=k.refs;V===null?delete de[C]:de[C]=V},c._stringRef=C,c)}if(typeof i!="string")throw Error(r(284));if(!h._owner)throw Error(r(290,i))}return i}function $d(i,c){throw i=Object.prototype.toString.call(c),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i))}function Tg(i){var c=i._init;return c(i._payload)}function Eg(i){function c(Ee,_e){if(i){var Ne=Ee.deletions;Ne===null?(Ee.deletions=[_e],Ee.flags|=16):Ne.push(_e)}}function h(Ee,_e){if(!i)return null;for(;_e!==null;)c(Ee,_e),_e=_e.sibling;return null}function x(Ee,_e){for(Ee=new Map;_e!==null;)_e.key!==null?Ee.set(_e.key,_e):Ee.set(_e.index,_e),_e=_e.sibling;return Ee}function k(Ee,_e){return Ee=Ws(Ee,_e),Ee.index=0,Ee.sibling=null,Ee}function C(Ee,_e,Ne){return Ee.index=Ne,i?(Ne=Ee.alternate,Ne!==null?(Ne=Ne.index,Ne<_e?(Ee.flags|=2,_e):Ne):(Ee.flags|=2,_e)):(Ee.flags|=1048576,_e)}function V(Ee){return i&&Ee.alternate===null&&(Ee.flags|=2),Ee}function de(Ee,_e,Ne,Ye){return _e===null||_e.tag!==6?(_e=V0(Ne,Ee.mode,Ye),_e.return=Ee,_e):(_e=k(_e,Ne),_e.return=Ee,_e)}function ge(Ee,_e,Ne,Ye){var ut=Ne.type;return ut===D?Ue(Ee,_e,Ne.props.children,Ye,Ne.key):_e!==null&&(_e.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===le&&Tg(ut)===_e.type)?(Ye=k(_e,Ne.props),Ye.ref=Jc(Ee,_e,Ne),Ye.return=Ee,Ye):(Ye=mf(Ne.type,Ne.key,Ne.props,null,Ee.mode,Ye),Ye.ref=Jc(Ee,_e,Ne),Ye.return=Ee,Ye)}function Ie(Ee,_e,Ne,Ye){return _e===null||_e.tag!==4||_e.stateNode.containerInfo!==Ne.containerInfo||_e.stateNode.implementation!==Ne.implementation?(_e=G0(Ne,Ee.mode,Ye),_e.return=Ee,_e):(_e=k(_e,Ne.children||[]),_e.return=Ee,_e)}function Ue(Ee,_e,Ne,Ye,ut){return _e===null||_e.tag!==7?(_e=Fo(Ne,Ee.mode,Ye,ut),_e.return=Ee,_e):(_e=k(_e,Ne),_e.return=Ee,_e)}function $e(Ee,_e,Ne){if(typeof _e=="string"&&_e!==""||typeof _e=="number")return _e=V0(""+_e,Ee.mode,Ne),_e.return=Ee,_e;if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case K:return Ne=mf(_e.type,_e.key,_e.props,null,Ee.mode,Ne),Ne.ref=Jc(Ee,null,_e),Ne.return=Ee,Ne;case W:return _e=G0(_e,Ee.mode,Ne),_e.return=Ee,_e;case le:var Ye=_e._init;return $e(Ee,Ye(_e._payload),Ne)}if(pt(_e)||O(_e))return _e=Fo(_e,Ee.mode,Ne,null),_e.return=Ee,_e;$d(Ee,_e)}return null}function Be(Ee,_e,Ne,Ye){var ut=_e!==null?_e.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number")return ut!==null?null:de(Ee,_e,""+Ne,Ye);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case K:return Ne.key===ut?ge(Ee,_e,Ne,Ye):null;case W:return Ne.key===ut?Ie(Ee,_e,Ne,Ye):null;case le:return ut=Ne._init,Be(Ee,_e,ut(Ne._payload),Ye)}if(pt(Ne)||O(Ne))return ut!==null?null:Ue(Ee,_e,Ne,Ye,null);$d(Ee,Ne)}return null}function at(Ee,_e,Ne,Ye,ut){if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number")return Ee=Ee.get(Ne)||null,de(_e,Ee,""+Ye,ut);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case K:return Ee=Ee.get(Ye.key===null?Ne:Ye.key)||null,ge(_e,Ee,Ye,ut);case W:return Ee=Ee.get(Ye.key===null?Ne:Ye.key)||null,Ie(_e,Ee,Ye,ut);case le:var vt=Ye._init;return at(Ee,_e,Ne,vt(Ye._payload),ut)}if(pt(Ye)||O(Ye))return Ee=Ee.get(Ne)||null,Ue(_e,Ee,Ye,ut,null);$d(_e,Ye)}return null}function ot(Ee,_e,Ne,Ye){for(var ut=null,vt=null,xt=_e,Tt=_e=0,Xr=null;xt!==null&&Tt<Ne.length;Tt++){xt.index>Tt?(Xr=xt,xt=null):Xr=xt.sibling;var Wt=Be(Ee,xt,Ne[Tt],Ye);if(Wt===null){xt===null&&(xt=Xr);break}i&&xt&&Wt.alternate===null&&c(Ee,xt),_e=C(Wt,_e,Tt),vt===null?ut=Wt:vt.sibling=Wt,vt=Wt,xt=Xr}if(Tt===Ne.length)return h(Ee,xt),mr&&To(Ee,Tt),ut;if(xt===null){for(;Tt<Ne.length;Tt++)xt=$e(Ee,Ne[Tt],Ye),xt!==null&&(_e=C(xt,_e,Tt),vt===null?ut=xt:vt.sibling=xt,vt=xt);return mr&&To(Ee,Tt),ut}for(xt=x(Ee,xt);Tt<Ne.length;Tt++)Xr=at(xt,Ee,Tt,Ne[Tt],Ye),Xr!==null&&(i&&Xr.alternate!==null&&xt.delete(Xr.key===null?Tt:Xr.key),_e=C(Xr,_e,Tt),vt===null?ut=Xr:vt.sibling=Xr,vt=Xr);return i&&xt.forEach(function($s){return c(Ee,$s)}),mr&&To(Ee,Tt),ut}function lt(Ee,_e,Ne,Ye){var ut=O(Ne);if(typeof ut!="function")throw Error(r(150));if(Ne=ut.call(Ne),Ne==null)throw Error(r(151));for(var vt=ut=null,xt=_e,Tt=_e=0,Xr=null,Wt=Ne.next();xt!==null&&!Wt.done;Tt++,Wt=Ne.next()){xt.index>Tt?(Xr=xt,xt=null):Xr=xt.sibling;var $s=Be(Ee,xt,Wt.value,Ye);if($s===null){xt===null&&(xt=Xr);break}i&&xt&&$s.alternate===null&&c(Ee,xt),_e=C($s,_e,Tt),vt===null?ut=$s:vt.sibling=$s,vt=$s,xt=Xr}if(Wt.done)return h(Ee,xt),mr&&To(Ee,Tt),ut;if(xt===null){for(;!Wt.done;Tt++,Wt=Ne.next())Wt=$e(Ee,Wt.value,Ye),Wt!==null&&(_e=C(Wt,_e,Tt),vt===null?ut=Wt:vt.sibling=Wt,vt=Wt);return mr&&To(Ee,Tt),ut}for(xt=x(Ee,xt);!Wt.done;Tt++,Wt=Ne.next())Wt=at(xt,Ee,Tt,Wt.value,Ye),Wt!==null&&(i&&Wt.alternate!==null&&xt.delete(Wt.key===null?Tt:Wt.key),_e=C(Wt,_e,Tt),vt===null?ut=Wt:vt.sibling=Wt,vt=Wt);return i&&xt.forEach(function(sk){return c(Ee,sk)}),mr&&To(Ee,Tt),ut}function Pr(Ee,_e,Ne,Ye){if(typeof Ne=="object"&&Ne!==null&&Ne.type===D&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case K:e:{for(var ut=Ne.key,vt=_e;vt!==null;){if(vt.key===ut){if(ut=Ne.type,ut===D){if(vt.tag===7){h(Ee,vt.sibling),_e=k(vt,Ne.props.children),_e.return=Ee,Ee=_e;break e}}else if(vt.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===le&&Tg(ut)===vt.type){h(Ee,vt.sibling),_e=k(vt,Ne.props),_e.ref=Jc(Ee,vt,Ne),_e.return=Ee,Ee=_e;break e}h(Ee,vt);break}else c(Ee,vt);vt=vt.sibling}Ne.type===D?(_e=Fo(Ne.props.children,Ee.mode,Ye,Ne.key),_e.return=Ee,Ee=_e):(Ye=mf(Ne.type,Ne.key,Ne.props,null,Ee.mode,Ye),Ye.ref=Jc(Ee,_e,Ne),Ye.return=Ee,Ee=Ye)}return V(Ee);case W:e:{for(vt=Ne.key;_e!==null;){if(_e.key===vt)if(_e.tag===4&&_e.stateNode.containerInfo===Ne.containerInfo&&_e.stateNode.implementation===Ne.implementation){h(Ee,_e.sibling),_e=k(_e,Ne.children||[]),_e.return=Ee,Ee=_e;break e}else{h(Ee,_e);break}else c(Ee,_e);_e=_e.sibling}_e=G0(Ne,Ee.mode,Ye),_e.return=Ee,Ee=_e}return V(Ee);case le:return vt=Ne._init,Pr(Ee,_e,vt(Ne._payload),Ye)}if(pt(Ne))return ot(Ee,_e,Ne,Ye);if(O(Ne))return lt(Ee,_e,Ne,Ye);$d(Ee,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"?(Ne=""+Ne,_e!==null&&_e.tag===6?(h(Ee,_e.sibling),_e=k(_e,Ne),_e.return=Ee,Ee=_e):(h(Ee,_e),_e=V0(Ne,Ee.mode,Ye),_e.return=Ee,Ee=_e),V(Ee)):h(Ee,_e)}return Pr}var Ml=Eg(!0),Cg=Eg(!1),Hd=Ds(null),Vd=null,Bl=null,t0=null;function r0(){t0=Bl=Vd=null}function n0(i){var c=Hd.current;cr(Hd),i._currentValue=c}function a0(i,c,h){for(;i!==null;){var x=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),i===h)break;i=i.return}}function zl(i,c){Vd=i,t0=Bl=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&c)!==0&&($n=!0),i.firstContext=null)}function ka(i){var c=i._currentValue;if(t0!==i)if(i={context:i,memoizedValue:c,next:null},Bl===null){if(Vd===null)throw Error(r(308));Bl=i,Vd.dependencies={lanes:0,firstContext:i}}else Bl=Bl.next=i;return c}var Eo=null;function i0(i){Eo===null?Eo=[i]:Eo.push(i)}function Ag(i,c,h,x){var k=c.interleaved;return k===null?(h.next=h,i0(c)):(h.next=k.next,k.next=h),c.interleaved=h,Ki(i,x)}function Ki(i,c){i.lanes|=c;var h=i.alternate;for(h!==null&&(h.lanes|=c),h=i,i=i.return;i!==null;)i.childLanes|=c,h=i.alternate,h!==null&&(h.childLanes|=c),h=i,i=i.return;return h.tag===3?h.stateNode:null}var Os=!1;function s0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ng(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Yi(i,c){return{eventTime:i,lane:c,tag:0,payload:null,callback:null,next:null}}function Rs(i,c,h){var x=i.updateQueue;if(x===null)return null;if(x=x.shared,(zt&2)!==0){var k=x.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),x.pending=c,Ki(i,h)}return k=x.interleaved,k===null?(c.next=c,i0(x)):(c.next=k.next,k.next=c),x.interleaved=c,Ki(i,h)}function Gd(i,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var x=c.lanes;x&=i.pendingLanes,h|=x,c.lanes=h,$a(i,h)}}function Pg(i,c){var h=i.updateQueue,x=i.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var k=null,C=null;if(h=h.firstBaseUpdate,h!==null){do{var V={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};C===null?k=C=V:C=C.next=V,h=h.next}while(h!==null);C===null?k=C=c:C=C.next=c}else k=C=c;h={baseState:x.baseState,firstBaseUpdate:k,lastBaseUpdate:C,shared:x.shared,effects:x.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=c:i.next=c,h.lastBaseUpdate=c}function Zd(i,c,h,x){var k=i.updateQueue;Os=!1;var C=k.firstBaseUpdate,V=k.lastBaseUpdate,de=k.shared.pending;if(de!==null){k.shared.pending=null;var ge=de,Ie=ge.next;ge.next=null,V===null?C=Ie:V.next=Ie,V=ge;var Ue=i.alternate;Ue!==null&&(Ue=Ue.updateQueue,de=Ue.lastBaseUpdate,de!==V&&(de===null?Ue.firstBaseUpdate=Ie:de.next=Ie,Ue.lastBaseUpdate=ge))}if(C!==null){var $e=k.baseState;V=0,Ue=Ie=ge=null,de=C;do{var Be=de.lane,at=de.eventTime;if((x&Be)===Be){Ue!==null&&(Ue=Ue.next={eventTime:at,lane:0,tag:de.tag,payload:de.payload,callback:de.callback,next:null});e:{var ot=i,lt=de;switch(Be=c,at=h,lt.tag){case 1:if(ot=lt.payload,typeof ot=="function"){$e=ot.call(at,$e,Be);break e}$e=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=lt.payload,Be=typeof ot=="function"?ot.call(at,$e,Be):ot,Be==null)break e;$e=ne({},$e,Be);break e;case 2:Os=!0}}de.callback!==null&&de.lane!==0&&(i.flags|=64,Be=k.effects,Be===null?k.effects=[de]:Be.push(de))}else at={eventTime:at,lane:Be,tag:de.tag,payload:de.payload,callback:de.callback,next:null},Ue===null?(Ie=Ue=at,ge=$e):Ue=Ue.next=at,V|=Be;if(de=de.next,de===null){if(de=k.shared.pending,de===null)break;Be=de,de=Be.next,Be.next=null,k.lastBaseUpdate=Be,k.shared.pending=null}}while(!0);if(Ue===null&&(ge=$e),k.baseState=ge,k.firstBaseUpdate=Ie,k.lastBaseUpdate=Ue,c=k.shared.interleaved,c!==null){k=c;do V|=k.lane,k=k.next;while(k!==c)}else C===null&&(k.shared.lanes=0);No|=V,i.lanes=V,i.memoizedState=$e}}function Ig(i,c,h){if(i=c.effects,c.effects=null,i!==null)for(c=0;c<i.length;c++){var x=i[c],k=x.callback;if(k!==null){if(x.callback=null,x=h,typeof k!="function")throw Error(r(191,k));k.call(x)}}}var Qc={},vi=Ds(Qc),eu=Ds(Qc),tu=Ds(Qc);function Co(i){if(i===Qc)throw Error(r(174));return i}function o0(i,c){switch(sr(tu,c),sr(eu,i),sr(vi,Qc),i=c.nodeType,i){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:nn(null,"");break;default:i=i===8?c.parentNode:c,c=i.namespaceURI||null,i=i.tagName,c=nn(c,i)}cr(vi),sr(vi,c)}function Ul(){cr(vi),cr(eu),cr(tu)}function Dg(i){Co(tu.current);var c=Co(vi.current),h=nn(c,i.type);c!==h&&(sr(eu,i),sr(vi,h))}function l0(i){eu.current===i&&(cr(vi),cr(eu))}var xr=Ds(0);function Kd(i){for(var c=i;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var c0=[];function u0(){for(var i=0;i<c0.length;i++)c0[i]._workInProgressVersionPrimary=null;c0.length=0}var Yd=R.ReactCurrentDispatcher,d0=R.ReactCurrentBatchConfig,Ao=0,yr=null,$r=null,Yr=null,qd=!1,ru=!1,nu=0,Ab=0;function pn(){throw Error(r(321))}function f0(i,c){if(c===null)return!1;for(var h=0;h<c.length&&h<i.length;h++)if(!aa(i[h],c[h]))return!1;return!0}function h0(i,c,h,x,k,C){if(Ao=C,yr=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,Yd.current=i===null||i.memoizedState===null?Db:Fb,i=h(x,k),ru){C=0;do{if(ru=!1,nu=0,25<=C)throw Error(r(301));C+=1,Yr=$r=null,c.updateQueue=null,Yd.current=jb,i=h(x,k)}while(ru)}if(Yd.current=Qd,c=$r!==null&&$r.next!==null,Ao=0,Yr=$r=yr=null,qd=!1,c)throw Error(r(300));return i}function m0(){var i=nu!==0;return nu=0,i}function xi(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yr===null?yr.memoizedState=Yr=i:Yr=Yr.next=i,Yr}function Sa(){if($r===null){var i=yr.alternate;i=i!==null?i.memoizedState:null}else i=$r.next;var c=Yr===null?yr.memoizedState:Yr.next;if(c!==null)Yr=c,$r=i;else{if(i===null)throw Error(r(310));$r=i,i={memoizedState:$r.memoizedState,baseState:$r.baseState,baseQueue:$r.baseQueue,queue:$r.queue,next:null},Yr===null?yr.memoizedState=Yr=i:Yr=Yr.next=i}return Yr}function au(i,c){return typeof c=="function"?c(i):c}function p0(i){var c=Sa(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var x=$r,k=x.baseQueue,C=h.pending;if(C!==null){if(k!==null){var V=k.next;k.next=C.next,C.next=V}x.baseQueue=k=C,h.pending=null}if(k!==null){C=k.next,x=x.baseState;var de=V=null,ge=null,Ie=C;do{var Ue=Ie.lane;if((Ao&Ue)===Ue)ge!==null&&(ge=ge.next={lane:0,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null}),x=Ie.hasEagerState?Ie.eagerState:i(x,Ie.action);else{var $e={lane:Ue,action:Ie.action,hasEagerState:Ie.hasEagerState,eagerState:Ie.eagerState,next:null};ge===null?(de=ge=$e,V=x):ge=ge.next=$e,yr.lanes|=Ue,No|=Ue}Ie=Ie.next}while(Ie!==null&&Ie!==C);ge===null?V=x:ge.next=de,aa(x,c.memoizedState)||($n=!0),c.memoizedState=x,c.baseState=V,c.baseQueue=ge,h.lastRenderedState=x}if(i=h.interleaved,i!==null){k=i;do C=k.lane,yr.lanes|=C,No|=C,k=k.next;while(k!==i)}else k===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function g0(i){var c=Sa(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var x=h.dispatch,k=h.pending,C=c.memoizedState;if(k!==null){h.pending=null;var V=k=k.next;do C=i(C,V.action),V=V.next;while(V!==k);aa(C,c.memoizedState)||($n=!0),c.memoizedState=C,c.baseQueue===null&&(c.baseState=C),h.lastRenderedState=C}return[C,x]}function Fg(){}function jg(i,c){var h=yr,x=Sa(),k=c(),C=!aa(x.memoizedState,k);if(C&&(x.memoizedState=k,$n=!0),x=x.queue,v0(Lg.bind(null,h,x,i),[i]),x.getSnapshot!==c||C||Yr!==null&&Yr.memoizedState.tag&1){if(h.flags|=2048,iu(9,Rg.bind(null,h,x,k,c),void 0,null),qr===null)throw Error(r(349));(Ao&30)!==0||Og(h,c,k)}return k}function Og(i,c,h){i.flags|=16384,i={getSnapshot:c,value:h},c=yr.updateQueue,c===null?(c={lastEffect:null,stores:null},yr.updateQueue=c,c.stores=[i]):(h=c.stores,h===null?c.stores=[i]:h.push(i))}function Rg(i,c,h,x){c.value=h,c.getSnapshot=x,Mg(c)&&Bg(i)}function Lg(i,c,h){return h(function(){Mg(c)&&Bg(i)})}function Mg(i){var c=i.getSnapshot;i=i.value;try{var h=c();return!aa(i,h)}catch{return!0}}function Bg(i){var c=Ki(i,1);c!==null&&Ja(c,i,1,-1)}function zg(i){var c=xi();return typeof i=="function"&&(i=i()),c.memoizedState=c.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:au,lastRenderedState:i},c.queue=i,i=i.dispatch=Ib.bind(null,yr,i),[c.memoizedState,i]}function iu(i,c,h,x){return i={tag:i,create:c,destroy:h,deps:x,next:null},c=yr.updateQueue,c===null?(c={lastEffect:null,stores:null},yr.updateQueue=c,c.lastEffect=i.next=i):(h=c.lastEffect,h===null?c.lastEffect=i.next=i:(x=h.next,h.next=i,i.next=x,c.lastEffect=i)),i}function Ug(){return Sa().memoizedState}function Xd(i,c,h,x){var k=xi();yr.flags|=i,k.memoizedState=iu(1|c,h,void 0,x===void 0?null:x)}function Jd(i,c,h,x){var k=Sa();x=x===void 0?null:x;var C=void 0;if($r!==null){var V=$r.memoizedState;if(C=V.destroy,x!==null&&f0(x,V.deps)){k.memoizedState=iu(c,h,C,x);return}}yr.flags|=i,k.memoizedState=iu(1|c,h,C,x)}function Wg(i,c){return Xd(8390656,8,i,c)}function v0(i,c){return Jd(2048,8,i,c)}function $g(i,c){return Jd(4,2,i,c)}function Hg(i,c){return Jd(4,4,i,c)}function Vg(i,c){if(typeof c=="function")return i=i(),c(i),function(){c(null)};if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function Gg(i,c,h){return h=h!=null?h.concat([i]):null,Jd(4,4,Vg.bind(null,c,i),h)}function x0(){}function Zg(i,c){var h=Sa();c=c===void 0?null:c;var x=h.memoizedState;return x!==null&&c!==null&&f0(c,x[1])?x[0]:(h.memoizedState=[i,c],i)}function Kg(i,c){var h=Sa();c=c===void 0?null:c;var x=h.memoizedState;return x!==null&&c!==null&&f0(c,x[1])?x[0]:(i=i(),h.memoizedState=[i,c],i)}function Yg(i,c,h){return(Ao&21)===0?(i.baseState&&(i.baseState=!1,$n=!0),i.memoizedState=h):(aa(h,c)||(h=md(),yr.lanes|=h,No|=h,i.baseState=!0),c)}function Nb(i,c){var h=Mt;Mt=h!==0&&4>h?h:4,i(!0);var x=d0.transition;d0.transition={};try{i(!1),c()}finally{Mt=h,d0.transition=x}}function qg(){return Sa().memoizedState}function Pb(i,c,h){var x=zs(i);if(h={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null},Xg(i))Jg(c,h);else if(h=Ag(i,c,h,x),h!==null){var k=Fn();Ja(h,i,x,k),Qg(h,c,x)}}function Ib(i,c,h){var x=zs(i),k={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null};if(Xg(i))Jg(c,k);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=c.lastRenderedReducer,C!==null))try{var V=c.lastRenderedState,de=C(V,h);if(k.hasEagerState=!0,k.eagerState=de,aa(de,V)){var ge=c.interleaved;ge===null?(k.next=k,i0(c)):(k.next=ge.next,ge.next=k),c.interleaved=k;return}}catch{}finally{}h=Ag(i,c,k,x),h!==null&&(k=Fn(),Ja(h,i,x,k),Qg(h,c,x))}}function Xg(i){var c=i.alternate;return i===yr||c!==null&&c===yr}function Jg(i,c){ru=qd=!0;var h=i.pending;h===null?c.next=c:(c.next=h.next,h.next=c),i.pending=c}function Qg(i,c,h){if((h&4194240)!==0){var x=c.lanes;x&=i.pendingLanes,h|=x,c.lanes=h,$a(i,h)}}var Qd={readContext:ka,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useInsertionEffect:pn,useLayoutEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useMutableSource:pn,useSyncExternalStore:pn,useId:pn,unstable_isNewReconciler:!1},Db={readContext:ka,useCallback:function(i,c){return xi().memoizedState=[i,c===void 0?null:c],i},useContext:ka,useEffect:Wg,useImperativeHandle:function(i,c,h){return h=h!=null?h.concat([i]):null,Xd(4194308,4,Vg.bind(null,c,i),h)},useLayoutEffect:function(i,c){return Xd(4194308,4,i,c)},useInsertionEffect:function(i,c){return Xd(4,2,i,c)},useMemo:function(i,c){var h=xi();return c=c===void 0?null:c,i=i(),h.memoizedState=[i,c],i},useReducer:function(i,c,h){var x=xi();return c=h!==void 0?h(c):c,x.memoizedState=x.baseState=c,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:c},x.queue=i,i=i.dispatch=Pb.bind(null,yr,i),[x.memoizedState,i]},useRef:function(i){var c=xi();return i={current:i},c.memoizedState=i},useState:zg,useDebugValue:x0,useDeferredValue:function(i){return xi().memoizedState=i},useTransition:function(){var i=zg(!1),c=i[0];return i=Nb.bind(null,i[1]),xi().memoizedState=i,[c,i]},useMutableSource:function(){},useSyncExternalStore:function(i,c,h){var x=yr,k=xi();if(mr){if(h===void 0)throw Error(r(407));h=h()}else{if(h=c(),qr===null)throw Error(r(349));(Ao&30)!==0||Og(x,c,h)}k.memoizedState=h;var C={value:h,getSnapshot:c};return k.queue=C,Wg(Lg.bind(null,x,C,i),[i]),x.flags|=2048,iu(9,Rg.bind(null,x,C,h,c),void 0,null),h},useId:function(){var i=xi(),c=qr.identifierPrefix;if(mr){var h=Zi,x=Gi;h=(x&~(1<<32-mt(x)-1)).toString(32)+h,c=":"+c+"R"+h,h=nu++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=Ab++,c=":"+c+"r"+h.toString(32)+":";return i.memoizedState=c},unstable_isNewReconciler:!1},Fb={readContext:ka,useCallback:Zg,useContext:ka,useEffect:v0,useImperativeHandle:Gg,useInsertionEffect:$g,useLayoutEffect:Hg,useMemo:Kg,useReducer:p0,useRef:Ug,useState:function(){return p0(au)},useDebugValue:x0,useDeferredValue:function(i){var c=Sa();return Yg(c,$r.memoizedState,i)},useTransition:function(){var i=p0(au)[0],c=Sa().memoizedState;return[i,c]},useMutableSource:Fg,useSyncExternalStore:jg,useId:qg,unstable_isNewReconciler:!1},jb={readContext:ka,useCallback:Zg,useContext:ka,useEffect:v0,useImperativeHandle:Gg,useInsertionEffect:$g,useLayoutEffect:Hg,useMemo:Kg,useReducer:g0,useRef:Ug,useState:function(){return g0(au)},useDebugValue:x0,useDeferredValue:function(i){var c=Sa();return $r===null?c.memoizedState=i:Yg(c,$r.memoizedState,i)},useTransition:function(){var i=g0(au)[0],c=Sa().memoizedState;return[i,c]},useMutableSource:Fg,useSyncExternalStore:jg,useId:qg,unstable_isNewReconciler:!1};function Ya(i,c){if(i&&i.defaultProps){c=ne({},c),i=i.defaultProps;for(var h in i)c[h]===void 0&&(c[h]=i[h]);return c}return c}function y0(i,c,h,x){c=i.memoizedState,h=h(x,c),h=h==null?c:ne({},c,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var ef={isMounted:function(i){return(i=i._reactInternals)?ae(i)===i:!1},enqueueSetState:function(i,c,h){i=i._reactInternals;var x=Fn(),k=zs(i),C=Yi(x,k);C.payload=c,h!=null&&(C.callback=h),c=Rs(i,C,k),c!==null&&(Ja(c,i,k,x),Gd(c,i,k))},enqueueReplaceState:function(i,c,h){i=i._reactInternals;var x=Fn(),k=zs(i),C=Yi(x,k);C.tag=1,C.payload=c,h!=null&&(C.callback=h),c=Rs(i,C,k),c!==null&&(Ja(c,i,k,x),Gd(c,i,k))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var h=Fn(),x=zs(i),k=Yi(h,x);k.tag=2,c!=null&&(k.callback=c),c=Rs(i,k,x),c!==null&&(Ja(c,i,x,h),Gd(c,i,x))}};function ev(i,c,h,x,k,C,V){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(x,C,V):c.prototype&&c.prototype.isPureReactComponent?!hi(h,x)||!hi(k,C):!0}function tv(i,c,h){var x=!1,k=Fs,C=c.contextType;return typeof C=="object"&&C!==null?C=ka(C):(k=Wn(c)?ko:mn.current,x=c.contextTypes,C=(x=x!=null)?jl(i,k):Fs),c=new c(h,C),i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=ef,i.stateNode=c,c._reactInternals=i,x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=k,i.__reactInternalMemoizedMaskedChildContext=C),c}function rv(i,c,h,x){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==i&&ef.enqueueReplaceState(c,c.state,null)}function _0(i,c,h,x){var k=i.stateNode;k.props=h,k.state=i.memoizedState,k.refs={},s0(i);var C=c.contextType;typeof C=="object"&&C!==null?k.context=ka(C):(C=Wn(c)?ko:mn.current,k.context=jl(i,C)),k.state=i.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(y0(i,c,C,h),k.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(c=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),c!==k.state&&ef.enqueueReplaceState(k,k.state,null),Zd(i,h,k,x),k.state=i.memoizedState),typeof k.componentDidMount=="function"&&(i.flags|=4194308)}function Wl(i,c){try{var h="",x=c;do h+=q(x),x=x.return;while(x);var k=h}catch(C){k=`
Error generating stack: `+C.message+`
`+C.stack}return{value:i,source:c,stack:k,digest:null}}function w0(i,c,h){return{value:i,source:null,stack:h??null,digest:c??null}}function b0(i,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var Ob=typeof WeakMap=="function"?WeakMap:Map;function nv(i,c,h){h=Yi(-1,h),h.tag=3,h.payload={element:null};var x=c.value;return h.callback=function(){lf||(lf=!0,L0=x),b0(i,c)},h}function av(i,c,h){h=Yi(-1,h),h.tag=3;var x=i.type.getDerivedStateFromError;if(typeof x=="function"){var k=c.value;h.payload=function(){return x(k)},h.callback=function(){b0(i,c)}}var C=i.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(h.callback=function(){b0(i,c),typeof x!="function"&&(Ms===null?Ms=new Set([this]):Ms.add(this));var V=c.stack;this.componentDidCatch(c.value,{componentStack:V!==null?V:""})}),h}function iv(i,c,h){var x=i.pingCache;if(x===null){x=i.pingCache=new Ob;var k=new Set;x.set(c,k)}else k=x.get(c),k===void 0&&(k=new Set,x.set(c,k));k.has(h)||(k.add(h),i=Yb.bind(null,i,c,h),c.then(i,i))}function sv(i){do{var c;if((c=i.tag===13)&&(c=i.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return i;i=i.return}while(i!==null);return null}function ov(i,c,h,x,k){return(i.mode&1)===0?(i===c?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=Yi(-1,1),c.tag=2,Rs(h,c,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=k,i)}var Rb=R.ReactCurrentOwner,$n=!1;function Dn(i,c,h,x){c.child=i===null?Cg(c,null,h,x):Ml(c,i.child,h,x)}function lv(i,c,h,x,k){h=h.render;var C=c.ref;return zl(c,k),x=h0(i,c,h,x,C,k),h=m0(),i!==null&&!$n?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~k,qi(i,c,k)):(mr&&h&&qh(c),c.flags|=1,Dn(i,c,x,k),c.child)}function cv(i,c,h,x,k){if(i===null){var C=h.type;return typeof C=="function"&&!H0(C)&&C.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=C,uv(i,c,C,x,k)):(i=mf(h.type,null,x,c,c.mode,k),i.ref=c.ref,i.return=c,c.child=i)}if(C=i.child,(i.lanes&k)===0){var V=C.memoizedProps;if(h=h.compare,h=h!==null?h:hi,h(V,x)&&i.ref===c.ref)return qi(i,c,k)}return c.flags|=1,i=Ws(C,x),i.ref=c.ref,i.return=c,c.child=i}function uv(i,c,h,x,k){if(i!==null){var C=i.memoizedProps;if(hi(C,x)&&i.ref===c.ref)if($n=!1,c.pendingProps=x=C,(i.lanes&k)!==0)(i.flags&131072)!==0&&($n=!0);else return c.lanes=i.lanes,qi(i,c,k)}return k0(i,c,h,x,k)}function dv(i,c,h){var x=c.pendingProps,k=x.children,C=i!==null?i.memoizedState:null;if(x.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},sr(Hl,la),la|=h;else{if((h&1073741824)===0)return i=C!==null?C.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:i,cachePool:null,transitions:null},c.updateQueue=null,sr(Hl,la),la|=i,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=C!==null?C.baseLanes:h,sr(Hl,la),la|=x}else C!==null?(x=C.baseLanes|h,c.memoizedState=null):x=h,sr(Hl,la),la|=x;return Dn(i,c,k,h),c.child}function fv(i,c){var h=c.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function k0(i,c,h,x,k){var C=Wn(h)?ko:mn.current;return C=jl(c,C),zl(c,k),h=h0(i,c,h,x,C,k),x=m0(),i!==null&&!$n?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~k,qi(i,c,k)):(mr&&x&&qh(c),c.flags|=1,Dn(i,c,h,k),c.child)}function hv(i,c,h,x,k){if(Wn(h)){var C=!0;Md(c)}else C=!1;if(zl(c,k),c.stateNode===null)rf(i,c),tv(c,h,x),_0(c,h,x,k),x=!0;else if(i===null){var V=c.stateNode,de=c.memoizedProps;V.props=de;var ge=V.context,Ie=h.contextType;typeof Ie=="object"&&Ie!==null?Ie=ka(Ie):(Ie=Wn(h)?ko:mn.current,Ie=jl(c,Ie));var Ue=h.getDerivedStateFromProps,$e=typeof Ue=="function"||typeof V.getSnapshotBeforeUpdate=="function";$e||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(de!==x||ge!==Ie)&&rv(c,V,x,Ie),Os=!1;var Be=c.memoizedState;V.state=Be,Zd(c,x,V,k),ge=c.memoizedState,de!==x||Be!==ge||Un.current||Os?(typeof Ue=="function"&&(y0(c,h,Ue,x),ge=c.memoizedState),(de=Os||ev(c,h,de,x,Be,ge,Ie))?($e||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount()),typeof V.componentDidMount=="function"&&(c.flags|=4194308)):(typeof V.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=ge),V.props=x,V.state=ge,V.context=Ie,x=de):(typeof V.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{V=c.stateNode,Ng(i,c),de=c.memoizedProps,Ie=c.type===c.elementType?de:Ya(c.type,de),V.props=Ie,$e=c.pendingProps,Be=V.context,ge=h.contextType,typeof ge=="object"&&ge!==null?ge=ka(ge):(ge=Wn(h)?ko:mn.current,ge=jl(c,ge));var at=h.getDerivedStateFromProps;(Ue=typeof at=="function"||typeof V.getSnapshotBeforeUpdate=="function")||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(de!==$e||Be!==ge)&&rv(c,V,x,ge),Os=!1,Be=c.memoizedState,V.state=Be,Zd(c,x,V,k);var ot=c.memoizedState;de!==$e||Be!==ot||Un.current||Os?(typeof at=="function"&&(y0(c,h,at,x),ot=c.memoizedState),(Ie=Os||ev(c,h,Ie,x,Be,ot,ge)||!1)?(Ue||typeof V.UNSAFE_componentWillUpdate!="function"&&typeof V.componentWillUpdate!="function"||(typeof V.componentWillUpdate=="function"&&V.componentWillUpdate(x,ot,ge),typeof V.UNSAFE_componentWillUpdate=="function"&&V.UNSAFE_componentWillUpdate(x,ot,ge)),typeof V.componentDidUpdate=="function"&&(c.flags|=4),typeof V.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof V.componentDidUpdate!="function"||de===i.memoizedProps&&Be===i.memoizedState||(c.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||de===i.memoizedProps&&Be===i.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=ot),V.props=x,V.state=ot,V.context=ge,x=Ie):(typeof V.componentDidUpdate!="function"||de===i.memoizedProps&&Be===i.memoizedState||(c.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||de===i.memoizedProps&&Be===i.memoizedState||(c.flags|=1024),x=!1)}return S0(i,c,h,x,C,k)}function S0(i,c,h,x,k,C){fv(i,c);var V=(c.flags&128)!==0;if(!x&&!V)return k&&xg(c,h,!1),qi(i,c,C);x=c.stateNode,Rb.current=c;var de=V&&typeof h.getDerivedStateFromError!="function"?null:x.render();return c.flags|=1,i!==null&&V?(c.child=Ml(c,i.child,null,C),c.child=Ml(c,null,de,C)):Dn(i,c,de,C),c.memoizedState=x.state,k&&xg(c,h,!0),c.child}function mv(i){var c=i.stateNode;c.pendingContext?gg(i,c.pendingContext,c.pendingContext!==c.context):c.context&&gg(i,c.context,!1),o0(i,c.containerInfo)}function pv(i,c,h,x,k){return Ll(),e0(k),c.flags|=256,Dn(i,c,h,x),c.child}var T0={dehydrated:null,treeContext:null,retryLane:0};function E0(i){return{baseLanes:i,cachePool:null,transitions:null}}function gv(i,c,h){var x=c.pendingProps,k=xr.current,C=!1,V=(c.flags&128)!==0,de;if((de=V)||(de=i!==null&&i.memoizedState===null?!1:(k&2)!==0),de?(C=!0,c.flags&=-129):(i===null||i.memoizedState!==null)&&(k|=1),sr(xr,k&1),i===null)return Qh(c),i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((c.mode&1)===0?c.lanes=1:i.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(V=x.children,i=x.fallback,C?(x=c.mode,C=c.child,V={mode:"hidden",children:V},(x&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=V):C=pf(V,x,0,null),i=Fo(i,x,h,null),C.return=c,i.return=c,C.sibling=i,c.child=C,c.child.memoizedState=E0(h),c.memoizedState=T0,i):C0(c,V));if(k=i.memoizedState,k!==null&&(de=k.dehydrated,de!==null))return Lb(i,c,V,x,de,k,h);if(C){C=x.fallback,V=c.mode,k=i.child,de=k.sibling;var ge={mode:"hidden",children:x.children};return(V&1)===0&&c.child!==k?(x=c.child,x.childLanes=0,x.pendingProps=ge,c.deletions=null):(x=Ws(k,ge),x.subtreeFlags=k.subtreeFlags&14680064),de!==null?C=Ws(de,C):(C=Fo(C,V,h,null),C.flags|=2),C.return=c,x.return=c,x.sibling=C,c.child=x,x=C,C=c.child,V=i.child.memoizedState,V=V===null?E0(h):{baseLanes:V.baseLanes|h,cachePool:null,transitions:V.transitions},C.memoizedState=V,C.childLanes=i.childLanes&~h,c.memoizedState=T0,x}return C=i.child,i=C.sibling,x=Ws(C,{mode:"visible",children:x.children}),(c.mode&1)===0&&(x.lanes=h),x.return=c,x.sibling=null,i!==null&&(h=c.deletions,h===null?(c.deletions=[i],c.flags|=16):h.push(i)),c.child=x,c.memoizedState=null,x}function C0(i,c){return c=pf({mode:"visible",children:c},i.mode,0,null),c.return=i,i.child=c}function tf(i,c,h,x){return x!==null&&e0(x),Ml(c,i.child,null,h),i=C0(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function Lb(i,c,h,x,k,C,V){if(h)return c.flags&256?(c.flags&=-257,x=w0(Error(r(422))),tf(i,c,V,x)):c.memoizedState!==null?(c.child=i.child,c.flags|=128,null):(C=x.fallback,k=c.mode,x=pf({mode:"visible",children:x.children},k,0,null),C=Fo(C,k,V,null),C.flags|=2,x.return=c,C.return=c,x.sibling=C,c.child=x,(c.mode&1)!==0&&Ml(c,i.child,null,V),c.child.memoizedState=E0(V),c.memoizedState=T0,C);if((c.mode&1)===0)return tf(i,c,V,null);if(k.data==="$!"){if(x=k.nextSibling&&k.nextSibling.dataset,x)var de=x.dgst;return x=de,C=Error(r(419)),x=w0(C,x,void 0),tf(i,c,V,x)}if(de=(V&i.childLanes)!==0,$n||de){if(x=qr,x!==null){switch(V&-V){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(x.suspendedLanes|V))!==0?0:k,k!==0&&k!==C.retryLane&&(C.retryLane=k,Ki(i,k),Ja(x,i,k,-1))}return $0(),x=w0(Error(r(421))),tf(i,c,V,x)}return k.data==="$?"?(c.flags|=128,c.child=i.child,c=qb.bind(null,i),k._reactRetry=c,null):(i=C.treeContext,oa=gi(k.nextSibling),sa=c,mr=!0,Ka=null,i!==null&&(wa[ba++]=Gi,wa[ba++]=Zi,wa[ba++]=So,Gi=i.id,Zi=i.overflow,So=c),c=C0(c,x.children),c.flags|=4096,c)}function vv(i,c,h){i.lanes|=c;var x=i.alternate;x!==null&&(x.lanes|=c),a0(i.return,c,h)}function A0(i,c,h,x,k){var C=i.memoizedState;C===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:k}:(C.isBackwards=c,C.rendering=null,C.renderingStartTime=0,C.last=x,C.tail=h,C.tailMode=k)}function xv(i,c,h){var x=c.pendingProps,k=x.revealOrder,C=x.tail;if(Dn(i,c,x.children,h),x=xr.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&vv(i,h,c);else if(i.tag===19)vv(i,h,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}x&=1}if(sr(xr,x),(c.mode&1)===0)c.memoizedState=null;else switch(k){case"forwards":for(h=c.child,k=null;h!==null;)i=h.alternate,i!==null&&Kd(i)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),A0(c,!1,k,h,C);break;case"backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(i=k.alternate,i!==null&&Kd(i)===null){c.child=k;break}i=k.sibling,k.sibling=h,h=k,k=i}A0(c,!0,h,null,C);break;case"together":A0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function rf(i,c){(c.mode&1)===0&&i!==null&&(i.alternate=null,c.alternate=null,c.flags|=2)}function qi(i,c,h){if(i!==null&&(c.dependencies=i.dependencies),No|=c.lanes,(h&c.childLanes)===0)return null;if(i!==null&&c.child!==i.child)throw Error(r(153));if(c.child!==null){for(i=c.child,h=Ws(i,i.pendingProps),c.child=h,h.return=c;i.sibling!==null;)i=i.sibling,h=h.sibling=Ws(i,i.pendingProps),h.return=c;h.sibling=null}return c.child}function Mb(i,c,h){switch(c.tag){case 3:mv(c),Ll();break;case 5:Dg(c);break;case 1:Wn(c.type)&&Md(c);break;case 4:o0(c,c.stateNode.containerInfo);break;case 10:var x=c.type._context,k=c.memoizedProps.value;sr(Hd,x._currentValue),x._currentValue=k;break;case 13:if(x=c.memoizedState,x!==null)return x.dehydrated!==null?(sr(xr,xr.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?gv(i,c,h):(sr(xr,xr.current&1),i=qi(i,c,h),i!==null?i.sibling:null);sr(xr,xr.current&1);break;case 19:if(x=(h&c.childLanes)!==0,(i.flags&128)!==0){if(x)return xv(i,c,h);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),sr(xr,xr.current),x)break;return null;case 22:case 23:return c.lanes=0,dv(i,c,h)}return qi(i,c,h)}var yv,N0,_v,wv;yv=function(i,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},N0=function(){},_v=function(i,c,h,x){var k=i.memoizedProps;if(k!==x){i=c.stateNode,Co(vi.current);var C=null;switch(h){case"input":k=Xe(i,k),x=Xe(i,x),C=[];break;case"select":k=ne({},k,{value:void 0}),x=ne({},x,{value:void 0}),C=[];break;case"textarea":k=Cn(i,k),x=Cn(i,x),C=[];break;default:typeof k.onClick!="function"&&typeof x.onClick=="function"&&(i.onclick=Re)}Ii(h,x);var V;h=null;for(Ie in k)if(!x.hasOwnProperty(Ie)&&k.hasOwnProperty(Ie)&&k[Ie]!=null)if(Ie==="style"){var de=k[Ie];for(V in de)de.hasOwnProperty(V)&&(h||(h={}),h[V]="")}else Ie!=="dangerouslySetInnerHTML"&&Ie!=="children"&&Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&Ie!=="autoFocus"&&(a.hasOwnProperty(Ie)?C||(C=[]):(C=C||[]).push(Ie,null));for(Ie in x){var ge=x[Ie];if(de=k?.[Ie],x.hasOwnProperty(Ie)&&ge!==de&&(ge!=null||de!=null))if(Ie==="style")if(de){for(V in de)!de.hasOwnProperty(V)||ge&&ge.hasOwnProperty(V)||(h||(h={}),h[V]="");for(V in ge)ge.hasOwnProperty(V)&&de[V]!==ge[V]&&(h||(h={}),h[V]=ge[V])}else h||(C||(C=[]),C.push(Ie,h)),h=ge;else Ie==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,de=de?de.__html:void 0,ge!=null&&de!==ge&&(C=C||[]).push(Ie,ge)):Ie==="children"?typeof ge!="string"&&typeof ge!="number"||(C=C||[]).push(Ie,""+ge):Ie!=="suppressContentEditableWarning"&&Ie!=="suppressHydrationWarning"&&(a.hasOwnProperty(Ie)?(ge!=null&&Ie==="onScroll"&&tr("scroll",i),C||de===ge||(C=[])):(C=C||[]).push(Ie,ge))}h&&(C=C||[]).push("style",h);var Ie=C;(c.updateQueue=Ie)&&(c.flags|=4)}},wv=function(i,c,h,x){h!==x&&(c.flags|=4)};function su(i,c){if(!mr)switch(i.tailMode){case"hidden":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:x.sibling=null}}function gn(i){var c=i.alternate!==null&&i.alternate.child===i.child,h=0,x=0;if(c)for(var k=i.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags&14680064,x|=k.flags&14680064,k.return=i,k=k.sibling;else for(k=i.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags,x|=k.flags,k.return=i,k=k.sibling;return i.subtreeFlags|=x,i.childLanes=h,c}function Bb(i,c,h){var x=c.pendingProps;switch(Xh(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gn(c),null;case 1:return Wn(c.type)&&Ld(),gn(c),null;case 3:return x=c.stateNode,Ul(),cr(Un),cr(mn),u0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(i===null||i.child===null)&&(Wd(c)?c.flags|=4:i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ka!==null&&(z0(Ka),Ka=null))),N0(i,c),gn(c),null;case 5:l0(c);var k=Co(tu.current);if(h=c.type,i!==null&&c.stateNode!=null)_v(i,c,h,x,k),i.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!x){if(c.stateNode===null)throw Error(r(166));return gn(c),null}if(i=Co(vi.current),Wd(c)){x=c.stateNode,h=c.type;var C=c.memoizedProps;switch(x[_a]=c,x[Ps]=C,i=(c.mode&1)!==0,h){case"dialog":tr("cancel",x),tr("close",x);break;case"iframe":case"object":case"embed":tr("load",x);break;case"video":case"audio":for(k=0;k<Cs.length;k++)tr(Cs[k],x);break;case"source":tr("error",x);break;case"img":case"image":case"link":tr("error",x),tr("load",x);break;case"details":tr("toggle",x);break;case"input":Qe(x,C),tr("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!C.multiple},tr("invalid",x);break;case"textarea":zr(x,C),tr("invalid",x)}Ii(h,C),k=null;for(var V in C)if(C.hasOwnProperty(V)){var de=C[V];V==="children"?typeof de=="string"?x.textContent!==de&&(C.suppressHydrationWarning!==!0&&Pe(x.textContent,de,i),k=["children",de]):typeof de=="number"&&x.textContent!==""+de&&(C.suppressHydrationWarning!==!0&&Pe(x.textContent,de,i),k=["children",""+de]):a.hasOwnProperty(V)&&de!=null&&V==="onScroll"&&tr("scroll",x)}switch(h){case"input":je(x),kt(x,C,!0);break;case"textarea":je(x),un(x);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(x.onclick=Re)}x=k,c.updateQueue=x,x!==null&&(c.flags|=4)}else{V=k.nodeType===9?k:k.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Fr(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=V.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof x.is=="string"?i=V.createElement(h,{is:x.is}):(i=V.createElement(h),h==="select"&&(V=i,x.multiple?V.multiple=!0:x.size&&(V.size=x.size))):i=V.createElementNS(i,h),i[_a]=c,i[Ps]=x,yv(i,c,!1,!1),c.stateNode=i;e:{switch(V=Yn(h,x),h){case"dialog":tr("cancel",i),tr("close",i),k=x;break;case"iframe":case"object":case"embed":tr("load",i),k=x;break;case"video":case"audio":for(k=0;k<Cs.length;k++)tr(Cs[k],i);k=x;break;case"source":tr("error",i),k=x;break;case"img":case"image":case"link":tr("error",i),tr("load",i),k=x;break;case"details":tr("toggle",i),k=x;break;case"input":Qe(i,x),k=Xe(i,x),tr("invalid",i);break;case"option":k=x;break;case"select":i._wrapperState={wasMultiple:!!x.multiple},k=ne({},x,{value:void 0}),tr("invalid",i);break;case"textarea":zr(i,x),k=Cn(i,x),tr("invalid",i);break;default:k=x}Ii(h,k),de=k;for(C in de)if(de.hasOwnProperty(C)){var ge=de[C];C==="style"?ct(i,ge):C==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,ge!=null&&Ar(i,ge)):C==="children"?typeof ge=="string"?(h!=="textarea"||ge!=="")&&ht(i,ge):typeof ge=="number"&&ht(i,""+ge):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(a.hasOwnProperty(C)?ge!=null&&C==="onScroll"&&tr("scroll",i):ge!=null&&A(i,C,ge,V))}switch(h){case"input":je(i),kt(i,x,!1);break;case"textarea":je(i),un(i);break;case"option":x.value!=null&&i.setAttribute("value",""+se(x.value));break;case"select":i.multiple=!!x.multiple,C=x.value,C!=null?Gt(i,!!x.multiple,C,!1):x.defaultValue!=null&&Gt(i,!!x.multiple,x.defaultValue,!0);break;default:typeof k.onClick=="function"&&(i.onclick=Re)}switch(h){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return gn(c),null;case 6:if(i&&c.stateNode!=null)wv(i,c,i.memoizedProps,x);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(h=Co(tu.current),Co(vi.current),Wd(c)){if(x=c.stateNode,h=c.memoizedProps,x[_a]=c,(C=x.nodeValue!==h)&&(i=sa,i!==null))switch(i.tag){case 3:Pe(x.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Pe(x.nodeValue,h,(i.mode&1)!==0)}C&&(c.flags|=4)}else x=(h.nodeType===9?h:h.ownerDocument).createTextNode(x),x[_a]=c,c.stateNode=x}return gn(c),null;case 13:if(cr(xr),x=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(mr&&oa!==null&&(c.mode&1)!==0&&(c.flags&128)===0)Sg(),Ll(),c.flags|=98560,C=!1;else if(C=Wd(c),x!==null&&x.dehydrated!==null){if(i===null){if(!C)throw Error(r(318));if(C=c.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(r(317));C[_a]=c}else Ll(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;gn(c),C=!1}else Ka!==null&&(z0(Ka),Ka=null),C=!0;if(!C)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(x=x!==null,x!==(i!==null&&i.memoizedState!==null)&&x&&(c.child.flags|=8192,(c.mode&1)!==0&&(i===null||(xr.current&1)!==0?Hr===0&&(Hr=3):$0())),c.updateQueue!==null&&(c.flags|=4),gn(c),null);case 4:return Ul(),N0(i,c),i===null&&As(c.stateNode.containerInfo),gn(c),null;case 10:return n0(c.type._context),gn(c),null;case 17:return Wn(c.type)&&Ld(),gn(c),null;case 19:if(cr(xr),C=c.memoizedState,C===null)return gn(c),null;if(x=(c.flags&128)!==0,V=C.rendering,V===null)if(x)su(C,!1);else{if(Hr!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(V=Kd(i),V!==null){for(c.flags|=128,su(C,!1),x=V.updateQueue,x!==null&&(c.updateQueue=x,c.flags|=4),c.subtreeFlags=0,x=h,h=c.child;h!==null;)C=h,i=x,C.flags&=14680066,V=C.alternate,V===null?(C.childLanes=0,C.lanes=i,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=V.childLanes,C.lanes=V.lanes,C.child=V.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=V.memoizedProps,C.memoizedState=V.memoizedState,C.updateQueue=V.updateQueue,C.type=V.type,i=V.dependencies,C.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return sr(xr,xr.current&1|2),c.child}i=i.sibling}C.tail!==null&&Ve()>Vl&&(c.flags|=128,x=!0,su(C,!1),c.lanes=4194304)}else{if(!x)if(i=Kd(V),i!==null){if(c.flags|=128,x=!0,h=i.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),su(C,!0),C.tail===null&&C.tailMode==="hidden"&&!V.alternate&&!mr)return gn(c),null}else 2*Ve()-C.renderingStartTime>Vl&&h!==1073741824&&(c.flags|=128,x=!0,su(C,!1),c.lanes=4194304);C.isBackwards?(V.sibling=c.child,c.child=V):(h=C.last,h!==null?h.sibling=V:c.child=V,C.last=V)}return C.tail!==null?(c=C.tail,C.rendering=c,C.tail=c.sibling,C.renderingStartTime=Ve(),c.sibling=null,h=xr.current,sr(xr,x?h&1|2:h&1),c):(gn(c),null);case 22:case 23:return W0(),x=c.memoizedState!==null,i!==null&&i.memoizedState!==null!==x&&(c.flags|=8192),x&&(c.mode&1)!==0?(la&1073741824)!==0&&(gn(c),c.subtreeFlags&6&&(c.flags|=8192)):gn(c),null;case 24:return null;case 25:return null}throw Error(r(156,c.tag))}function zb(i,c){switch(Xh(c),c.tag){case 1:return Wn(c.type)&&Ld(),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return Ul(),cr(Un),cr(mn),u0(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 5:return l0(c),null;case 13:if(cr(xr),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Ll()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return cr(xr),null;case 4:return Ul(),null;case 10:return n0(c.type._context),null;case 22:case 23:return W0(),null;case 24:return null;default:return null}}var nf=!1,vn=!1,Ub=typeof WeakSet=="function"?WeakSet:Set,st=null;function $l(i,c){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(x){br(i,c,x)}else h.current=null}function P0(i,c,h){try{h()}catch(x){br(i,c,x)}}var bv=!1;function Wb(i,c){if(rt=po,i=$c(),Hc(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var k=x.anchorOffset,C=x.focusNode;x=x.focusOffset;try{h.nodeType,C.nodeType}catch{h=null;break e}var V=0,de=-1,ge=-1,Ie=0,Ue=0,$e=i,Be=null;t:for(;;){for(var at;$e!==h||k!==0&&$e.nodeType!==3||(de=V+k),$e!==C||x!==0&&$e.nodeType!==3||(ge=V+x),$e.nodeType===3&&(V+=$e.nodeValue.length),(at=$e.firstChild)!==null;)Be=$e,$e=at;for(;;){if($e===i)break t;if(Be===h&&++Ie===k&&(de=V),Be===C&&++Ue===x&&(ge=V),(at=$e.nextSibling)!==null)break;$e=Be,Be=$e.parentNode}$e=at}h=de===-1||ge===-1?null:{start:de,end:ge}}else h=null}h=h||{start:0,end:0}}else h=null;for(gt={focusedElem:i,selectionRange:h},po=!1,st=c;st!==null;)if(c=st,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,st=i;else for(;st!==null;){c=st;try{var ot=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(ot!==null){var lt=ot.memoizedProps,Pr=ot.memoizedState,Ee=c.stateNode,_e=Ee.getSnapshotBeforeUpdate(c.elementType===c.type?lt:Ya(c.type,lt),Pr);Ee.__reactInternalSnapshotBeforeUpdate=_e}break;case 3:var Ne=c.stateNode.containerInfo;Ne.nodeType===1?Ne.textContent="":Ne.nodeType===9&&Ne.documentElement&&Ne.removeChild(Ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Ye){br(c,c.return,Ye)}if(i=c.sibling,i!==null){i.return=c.return,st=i;break}st=c.return}return ot=bv,bv=!1,ot}function ou(i,c,h){var x=c.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var k=x=x.next;do{if((k.tag&i)===i){var C=k.destroy;k.destroy=void 0,C!==void 0&&P0(c,h,C)}k=k.next}while(k!==x)}}function af(i,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&i)===i){var x=h.create;h.destroy=x()}h=h.next}while(h!==c)}}function I0(i){var c=i.ref;if(c!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof c=="function"?c(i):c.current=i}}function kv(i){var c=i.alternate;c!==null&&(i.alternate=null,kv(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&(delete c[_a],delete c[Ps],delete c[Is],delete c[Gh],delete c[Zh])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Sv(i){return i.tag===5||i.tag===3||i.tag===4}function Tv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Sv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function D0(i,c,h){var x=i.tag;if(x===5||x===6)i=i.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(i,c):h.insertBefore(i,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(i,h)):(c=h,c.appendChild(i)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Re));else if(x!==4&&(i=i.child,i!==null))for(D0(i,c,h),i=i.sibling;i!==null;)D0(i,c,h),i=i.sibling}function F0(i,c,h){var x=i.tag;if(x===5||x===6)i=i.stateNode,c?h.insertBefore(i,c):h.appendChild(i);else if(x!==4&&(i=i.child,i!==null))for(F0(i,c,h),i=i.sibling;i!==null;)F0(i,c,h),i=i.sibling}var an=null,qa=!1;function Ls(i,c,h){for(h=h.child;h!==null;)Ev(i,c,h),h=h.sibling}function Ev(i,c,h){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Jn,h)}catch{}switch(h.tag){case 5:vn||$l(h,c);case 6:var x=an,k=qa;an=null,Ls(i,c,h),an=x,qa=k,an!==null&&(qa?(i=an,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):an.removeChild(h.stateNode));break;case 18:an!==null&&(qa?(i=an,h=h.stateNode,i.nodeType===8?Xc(i.parentNode,h):i.nodeType===1&&Xc(i,h),ta(i)):Xc(an,h.stateNode));break;case 4:x=an,k=qa,an=h.stateNode.containerInfo,qa=!0,Ls(i,c,h),an=x,qa=k;break;case 0:case 11:case 14:case 15:if(!vn&&(x=h.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){k=x=x.next;do{var C=k,V=C.destroy;C=C.tag,V!==void 0&&((C&2)!==0||(C&4)!==0)&&P0(h,c,V),k=k.next}while(k!==x)}Ls(i,c,h);break;case 1:if(!vn&&($l(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=h.memoizedProps,x.state=h.memoizedState,x.componentWillUnmount()}catch(de){br(h,c,de)}Ls(i,c,h);break;case 21:Ls(i,c,h);break;case 22:h.mode&1?(vn=(x=vn)||h.memoizedState!==null,Ls(i,c,h),vn=x):Ls(i,c,h);break;default:Ls(i,c,h)}}function Cv(i){var c=i.updateQueue;if(c!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new Ub),c.forEach(function(x){var k=Xb.bind(null,i,x);h.has(x)||(h.add(x),x.then(k,k))})}}function Xa(i,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var k=h[x];try{var C=i,V=c,de=V;e:for(;de!==null;){switch(de.tag){case 5:an=de.stateNode,qa=!1;break e;case 3:an=de.stateNode.containerInfo,qa=!0;break e;case 4:an=de.stateNode.containerInfo,qa=!0;break e}de=de.return}if(an===null)throw Error(r(160));Ev(C,V,k),an=null,qa=!1;var ge=k.alternate;ge!==null&&(ge.return=null),k.return=null}catch(Ie){br(k,c,Ie)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Av(c,i),c=c.sibling}function Av(i,c){var h=i.alternate,x=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Xa(c,i),yi(i),x&4){try{ou(3,i,i.return),af(3,i)}catch(lt){br(i,i.return,lt)}try{ou(5,i,i.return)}catch(lt){br(i,i.return,lt)}}break;case 1:Xa(c,i),yi(i),x&512&&h!==null&&$l(h,h.return);break;case 5:if(Xa(c,i),yi(i),x&512&&h!==null&&$l(h,h.return),i.flags&32){var k=i.stateNode;try{ht(k,"")}catch(lt){br(i,i.return,lt)}}if(x&4&&(k=i.stateNode,k!=null)){var C=i.memoizedProps,V=h!==null?h.memoizedProps:C,de=i.type,ge=i.updateQueue;if(i.updateQueue=null,ge!==null)try{de==="input"&&C.type==="radio"&&C.name!=null&&it(k,C),Yn(de,V);var Ie=Yn(de,C);for(V=0;V<ge.length;V+=2){var Ue=ge[V],$e=ge[V+1];Ue==="style"?ct(k,$e):Ue==="dangerouslySetInnerHTML"?Ar(k,$e):Ue==="children"?ht(k,$e):A(k,Ue,$e,Ie)}switch(de){case"input":Le(k,C);break;case"textarea":Cr(k,C);break;case"select":var Be=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!C.multiple;var at=C.value;at!=null?Gt(k,!!C.multiple,at,!1):Be!==!!C.multiple&&(C.defaultValue!=null?Gt(k,!!C.multiple,C.defaultValue,!0):Gt(k,!!C.multiple,C.multiple?[]:"",!1))}k[Ps]=C}catch(lt){br(i,i.return,lt)}}break;case 6:if(Xa(c,i),yi(i),x&4){if(i.stateNode===null)throw Error(r(162));k=i.stateNode,C=i.memoizedProps;try{k.nodeValue=C}catch(lt){br(i,i.return,lt)}}break;case 3:if(Xa(c,i),yi(i),x&4&&h!==null&&h.memoizedState.isDehydrated)try{ta(c.containerInfo)}catch(lt){br(i,i.return,lt)}break;case 4:Xa(c,i),yi(i);break;case 13:Xa(c,i),yi(i),k=i.child,k.flags&8192&&(C=k.memoizedState!==null,k.stateNode.isHidden=C,!C||k.alternate!==null&&k.alternate.memoizedState!==null||(R0=Ve())),x&4&&Cv(i);break;case 22:if(Ue=h!==null&&h.memoizedState!==null,i.mode&1?(vn=(Ie=vn)||Ue,Xa(c,i),vn=Ie):Xa(c,i),yi(i),x&8192){if(Ie=i.memoizedState!==null,(i.stateNode.isHidden=Ie)&&!Ue&&(i.mode&1)!==0)for(st=i,Ue=i.child;Ue!==null;){for($e=st=Ue;st!==null;){switch(Be=st,at=Be.child,Be.tag){case 0:case 11:case 14:case 15:ou(4,Be,Be.return);break;case 1:$l(Be,Be.return);var ot=Be.stateNode;if(typeof ot.componentWillUnmount=="function"){x=Be,h=Be.return;try{c=x,ot.props=c.memoizedProps,ot.state=c.memoizedState,ot.componentWillUnmount()}catch(lt){br(x,h,lt)}}break;case 5:$l(Be,Be.return);break;case 22:if(Be.memoizedState!==null){Iv($e);continue}}at!==null?(at.return=Be,st=at):Iv($e)}Ue=Ue.sibling}e:for(Ue=null,$e=i;;){if($e.tag===5){if(Ue===null){Ue=$e;try{k=$e.stateNode,Ie?(C=k.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(de=$e.stateNode,ge=$e.memoizedProps.style,V=ge!=null&&ge.hasOwnProperty("display")?ge.display:null,de.style.display=Ht("display",V))}catch(lt){br(i,i.return,lt)}}}else if($e.tag===6){if(Ue===null)try{$e.stateNode.nodeValue=Ie?"":$e.memoizedProps}catch(lt){br(i,i.return,lt)}}else if(($e.tag!==22&&$e.tag!==23||$e.memoizedState===null||$e===i)&&$e.child!==null){$e.child.return=$e,$e=$e.child;continue}if($e===i)break e;for(;$e.sibling===null;){if($e.return===null||$e.return===i)break e;Ue===$e&&(Ue=null),$e=$e.return}Ue===$e&&(Ue=null),$e.sibling.return=$e.return,$e=$e.sibling}}break;case 19:Xa(c,i),yi(i),x&4&&Cv(i);break;case 21:break;default:Xa(c,i),yi(i)}}function yi(i){var c=i.flags;if(c&2){try{e:{for(var h=i.return;h!==null;){if(Sv(h)){var x=h;break e}h=h.return}throw Error(r(160))}switch(x.tag){case 5:var k=x.stateNode;x.flags&32&&(ht(k,""),x.flags&=-33);var C=Tv(i);F0(i,C,k);break;case 3:case 4:var V=x.stateNode.containerInfo,de=Tv(i);D0(i,de,V);break;default:throw Error(r(161))}}catch(ge){br(i,i.return,ge)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function $b(i,c,h){st=i,Nv(i)}function Nv(i,c,h){for(var x=(i.mode&1)!==0;st!==null;){var k=st,C=k.child;if(k.tag===22&&x){var V=k.memoizedState!==null||nf;if(!V){var de=k.alternate,ge=de!==null&&de.memoizedState!==null||vn;de=nf;var Ie=vn;if(nf=V,(vn=ge)&&!Ie)for(st=k;st!==null;)V=st,ge=V.child,V.tag===22&&V.memoizedState!==null?Dv(k):ge!==null?(ge.return=V,st=ge):Dv(k);for(;C!==null;)st=C,Nv(C),C=C.sibling;st=k,nf=de,vn=Ie}Pv(i)}else(k.subtreeFlags&8772)!==0&&C!==null?(C.return=k,st=C):Pv(i)}}function Pv(i){for(;st!==null;){var c=st;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:vn||af(5,c);break;case 1:var x=c.stateNode;if(c.flags&4&&!vn)if(h===null)x.componentDidMount();else{var k=c.elementType===c.type?h.memoizedProps:Ya(c.type,h.memoizedProps);x.componentDidUpdate(k,h.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var C=c.updateQueue;C!==null&&Ig(c,C,x);break;case 3:var V=c.updateQueue;if(V!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}Ig(c,V,h)}break;case 5:var de=c.stateNode;if(h===null&&c.flags&4){h=de;var ge=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":ge.autoFocus&&h.focus();break;case"img":ge.src&&(h.src=ge.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Ie=c.alternate;if(Ie!==null){var Ue=Ie.memoizedState;if(Ue!==null){var $e=Ue.dehydrated;$e!==null&&ta($e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}vn||c.flags&512&&I0(c)}catch(Be){br(c,c.return,Be)}}if(c===i){st=null;break}if(h=c.sibling,h!==null){h.return=c.return,st=h;break}st=c.return}}function Iv(i){for(;st!==null;){var c=st;if(c===i){st=null;break}var h=c.sibling;if(h!==null){h.return=c.return,st=h;break}st=c.return}}function Dv(i){for(;st!==null;){var c=st;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{af(4,c)}catch(ge){br(c,h,ge)}break;case 1:var x=c.stateNode;if(typeof x.componentDidMount=="function"){var k=c.return;try{x.componentDidMount()}catch(ge){br(c,k,ge)}}var C=c.return;try{I0(c)}catch(ge){br(c,C,ge)}break;case 5:var V=c.return;try{I0(c)}catch(ge){br(c,V,ge)}}}catch(ge){br(c,c.return,ge)}if(c===i){st=null;break}var de=c.sibling;if(de!==null){de.return=c.return,st=de;break}st=c.return}}var Hb=Math.ceil,sf=R.ReactCurrentDispatcher,j0=R.ReactCurrentOwner,Ta=R.ReactCurrentBatchConfig,zt=0,qr=null,Or=null,sn=0,la=0,Hl=Ds(0),Hr=0,lu=null,No=0,of=0,O0=0,cu=null,Hn=null,R0=0,Vl=1/0,Xi=null,lf=!1,L0=null,Ms=null,cf=!1,Bs=null,uf=0,uu=0,M0=null,df=-1,ff=0;function Fn(){return(zt&6)!==0?Ve():df!==-1?df:df=Ve()}function zs(i){return(i.mode&1)===0?1:(zt&2)!==0&&sn!==0?sn&-sn:Cb.transition!==null?(ff===0&&(ff=md()),ff):(i=Mt,i!==0||(i=window.event,i=i===void 0?16:Ot(i.type)),i)}function Ja(i,c,h,x){if(50<uu)throw uu=0,M0=null,Error(r(185));Qn(i,h,x),((zt&2)===0||i!==qr)&&(i===qr&&((zt&2)===0&&(of|=h),Hr===4&&Us(i,sn)),Vn(i,x),h===1&&zt===0&&(c.mode&1)===0&&(Vl=Ve()+500,Bd&&js()))}function Vn(i,c){var h=i.callbackNode;dl(i,c);var x=ir(i,i===qr?sn:0);if(x===0)h!==null&&qe(h),i.callbackNode=null,i.callbackPriority=0;else if(c=x&-x,i.callbackPriority!==c){if(h!=null&&qe(h),c===1)i.tag===0?Eb(jv.bind(null,i)):yg(jv.bind(null,i)),hn(function(){(zt&6)===0&&js()}),h=null;else{switch(ps(x)){case 1:h=Zt;break;case 4:h=Qt;break;case 16:h=gr;break;case 536870912:h=Mn;break;default:h=gr}h=Wv(h,Fv.bind(null,i))}i.callbackPriority=c,i.callbackNode=h}}function Fv(i,c){if(df=-1,ff=0,(zt&6)!==0)throw Error(r(327));var h=i.callbackNode;if(Gl()&&i.callbackNode!==h)return null;var x=ir(i,i===qr?sn:0);if(x===0)return null;if((x&30)!==0||(x&i.expiredLanes)!==0||c)c=hf(i,x);else{c=x;var k=zt;zt|=2;var C=Rv();(qr!==i||sn!==c)&&(Xi=null,Vl=Ve()+500,Io(i,c));do try{Zb();break}catch(de){Ov(i,de)}while(!0);r0(),sf.current=C,zt=k,Or!==null?c=0:(qr=null,sn=0,c=Hr)}if(c!==0){if(c===2&&(k=dn(i),k!==0&&(x=k,c=B0(i,k))),c===1)throw h=lu,Io(i,0),Us(i,x),Vn(i,Ve()),h;if(c===6)Us(i,x);else{if(k=i.current.alternate,(x&30)===0&&!Vb(k)&&(c=hf(i,x),c===2&&(C=dn(i),C!==0&&(x=C,c=B0(i,C))),c===1))throw h=lu,Io(i,0),Us(i,x),Vn(i,Ve()),h;switch(i.finishedWork=k,i.finishedLanes=x,c){case 0:case 1:throw Error(r(345));case 2:Do(i,Hn,Xi);break;case 3:if(Us(i,x),(x&130023424)===x&&(c=R0+500-Ve(),10<c)){if(ir(i,0)!==0)break;if(k=i.suspendedLanes,(k&x)!==x){Fn(),i.pingedLanes|=i.suspendedLanes&k;break}i.timeoutHandle=Wr(Do.bind(null,i,Hn,Xi),c);break}Do(i,Hn,Xi);break;case 4:if(Us(i,x),(x&4194240)===x)break;for(c=i.eventTimes,k=-1;0<x;){var V=31-mt(x);C=1<<V,V=c[V],V>k&&(k=V),x&=~C}if(x=k,x=Ve()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*Hb(x/1960))-x,10<x){i.timeoutHandle=Wr(Do.bind(null,i,Hn,Xi),x);break}Do(i,Hn,Xi);break;case 5:Do(i,Hn,Xi);break;default:throw Error(r(329))}}}return Vn(i,Ve()),i.callbackNode===h?Fv.bind(null,i):null}function B0(i,c){var h=cu;return i.current.memoizedState.isDehydrated&&(Io(i,c).flags|=256),i=hf(i,c),i!==2&&(c=Hn,Hn=h,c!==null&&z0(c)),i}function z0(i){Hn===null?Hn=i:Hn.push.apply(Hn,i)}function Vb(i){for(var c=i;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var x=0;x<h.length;x++){var k=h[x],C=k.getSnapshot;k=k.value;try{if(!aa(C(),k))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Us(i,c){for(c&=~O0,c&=~of,i.suspendedLanes|=c,i.pingedLanes&=~c,i=i.expirationTimes;0<c;){var h=31-mt(c),x=1<<h;i[h]=-1,c&=~x}}function jv(i){if((zt&6)!==0)throw Error(r(327));Gl();var c=ir(i,0);if((c&1)===0)return Vn(i,Ve()),null;var h=hf(i,c);if(i.tag!==0&&h===2){var x=dn(i);x!==0&&(c=x,h=B0(i,x))}if(h===1)throw h=lu,Io(i,0),Us(i,c),Vn(i,Ve()),h;if(h===6)throw Error(r(345));return i.finishedWork=i.current.alternate,i.finishedLanes=c,Do(i,Hn,Xi),Vn(i,Ve()),null}function U0(i,c){var h=zt;zt|=1;try{return i(c)}finally{zt=h,zt===0&&(Vl=Ve()+500,Bd&&js())}}function Po(i){Bs!==null&&Bs.tag===0&&(zt&6)===0&&Gl();var c=zt;zt|=1;var h=Ta.transition,x=Mt;try{if(Ta.transition=null,Mt=1,i)return i()}finally{Mt=x,Ta.transition=h,zt=c,(zt&6)===0&&js()}}function W0(){la=Hl.current,cr(Hl)}function Io(i,c){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,jr(h)),Or!==null)for(h=Or.return;h!==null;){var x=h;switch(Xh(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&Ld();break;case 3:Ul(),cr(Un),cr(mn),u0();break;case 5:l0(x);break;case 4:Ul();break;case 13:cr(xr);break;case 19:cr(xr);break;case 10:n0(x.type._context);break;case 22:case 23:W0()}h=h.return}if(qr=i,Or=i=Ws(i.current,null),sn=la=c,Hr=0,lu=null,O0=of=No=0,Hn=cu=null,Eo!==null){for(c=0;c<Eo.length;c++)if(h=Eo[c],x=h.interleaved,x!==null){h.interleaved=null;var k=x.next,C=h.pending;if(C!==null){var V=C.next;C.next=k,x.next=V}h.pending=x}Eo=null}return i}function Ov(i,c){do{var h=Or;try{if(r0(),Yd.current=Qd,qd){for(var x=yr.memoizedState;x!==null;){var k=x.queue;k!==null&&(k.pending=null),x=x.next}qd=!1}if(Ao=0,Yr=$r=yr=null,ru=!1,nu=0,j0.current=null,h===null||h.return===null){Hr=1,lu=c,Or=null;break}e:{var C=i,V=h.return,de=h,ge=c;if(c=sn,de.flags|=32768,ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var Ie=ge,Ue=de,$e=Ue.tag;if((Ue.mode&1)===0&&($e===0||$e===11||$e===15)){var Be=Ue.alternate;Be?(Ue.updateQueue=Be.updateQueue,Ue.memoizedState=Be.memoizedState,Ue.lanes=Be.lanes):(Ue.updateQueue=null,Ue.memoizedState=null)}var at=sv(V);if(at!==null){at.flags&=-257,ov(at,V,de,C,c),at.mode&1&&iv(C,Ie,c),c=at,ge=Ie;var ot=c.updateQueue;if(ot===null){var lt=new Set;lt.add(ge),c.updateQueue=lt}else ot.add(ge);break e}else{if((c&1)===0){iv(C,Ie,c),$0();break e}ge=Error(r(426))}}else if(mr&&de.mode&1){var Pr=sv(V);if(Pr!==null){(Pr.flags&65536)===0&&(Pr.flags|=256),ov(Pr,V,de,C,c),e0(Wl(ge,de));break e}}C=ge=Wl(ge,de),Hr!==4&&(Hr=2),cu===null?cu=[C]:cu.push(C),C=V;do{switch(C.tag){case 3:C.flags|=65536,c&=-c,C.lanes|=c;var Ee=nv(C,ge,c);Pg(C,Ee);break e;case 1:de=ge;var _e=C.type,Ne=C.stateNode;if((C.flags&128)===0&&(typeof _e.getDerivedStateFromError=="function"||Ne!==null&&typeof Ne.componentDidCatch=="function"&&(Ms===null||!Ms.has(Ne)))){C.flags|=65536,c&=-c,C.lanes|=c;var Ye=av(C,de,c);Pg(C,Ye);break e}}C=C.return}while(C!==null)}Mv(h)}catch(ut){c=ut,Or===h&&h!==null&&(Or=h=h.return);continue}break}while(!0)}function Rv(){var i=sf.current;return sf.current=Qd,i===null?Qd:i}function $0(){(Hr===0||Hr===3||Hr===2)&&(Hr=4),qr===null||(No&268435455)===0&&(of&268435455)===0||Us(qr,sn)}function hf(i,c){var h=zt;zt|=2;var x=Rv();(qr!==i||sn!==c)&&(Xi=null,Io(i,c));do try{Gb();break}catch(k){Ov(i,k)}while(!0);if(r0(),zt=h,sf.current=x,Or!==null)throw Error(r(261));return qr=null,sn=0,Hr}function Gb(){for(;Or!==null;)Lv(Or)}function Zb(){for(;Or!==null&&!nt();)Lv(Or)}function Lv(i){var c=Uv(i.alternate,i,la);i.memoizedProps=i.pendingProps,c===null?Mv(i):Or=c,j0.current=null}function Mv(i){var c=i;do{var h=c.alternate;if(i=c.return,(c.flags&32768)===0){if(h=Bb(h,c,la),h!==null){Or=h;return}}else{if(h=zb(h,c),h!==null){h.flags&=32767,Or=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Hr=6,Or=null;return}}if(c=c.sibling,c!==null){Or=c;return}Or=c=i}while(c!==null);Hr===0&&(Hr=5)}function Do(i,c,h){var x=Mt,k=Ta.transition;try{Ta.transition=null,Mt=1,Kb(i,c,h,x)}finally{Ta.transition=k,Mt=x}return null}function Kb(i,c,h,x){do Gl();while(Bs!==null);if((zt&6)!==0)throw Error(r(327));h=i.finishedWork;var k=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(r(177));i.callbackNode=null,i.callbackPriority=0;var C=h.lanes|h.childLanes;if(wr(i,C),i===qr&&(Or=qr=null,sn=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||cf||(cf=!0,Wv(gr,function(){return Gl(),null})),C=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||C){C=Ta.transition,Ta.transition=null;var V=Mt;Mt=1;var de=zt;zt|=4,j0.current=null,Wb(i,h),Av(h,i),xa(gt),po=!!rt,gt=rt=null,i.current=h,$b(h),Ze(),zt=de,Mt=V,Ta.transition=C}else i.current=h;if(cf&&(cf=!1,Bs=i,uf=k),C=i.pendingLanes,C===0&&(Ms=null),Ua(h.stateNode),Vn(i,Ve()),c!==null)for(x=i.onRecoverableError,h=0;h<c.length;h++)k=c[h],x(k.value,{componentStack:k.stack,digest:k.digest});if(lf)throw lf=!1,i=L0,L0=null,i;return(uf&1)!==0&&i.tag!==0&&Gl(),C=i.pendingLanes,(C&1)!==0?i===M0?uu++:(uu=0,M0=i):uu=0,js(),null}function Gl(){if(Bs!==null){var i=ps(uf),c=Ta.transition,h=Mt;try{if(Ta.transition=null,Mt=16>i?16:i,Bs===null)var x=!1;else{if(i=Bs,Bs=null,uf=0,(zt&6)!==0)throw Error(r(331));var k=zt;for(zt|=4,st=i.current;st!==null;){var C=st,V=C.child;if((st.flags&16)!==0){var de=C.deletions;if(de!==null){for(var ge=0;ge<de.length;ge++){var Ie=de[ge];for(st=Ie;st!==null;){var Ue=st;switch(Ue.tag){case 0:case 11:case 15:ou(8,Ue,C)}var $e=Ue.child;if($e!==null)$e.return=Ue,st=$e;else for(;st!==null;){Ue=st;var Be=Ue.sibling,at=Ue.return;if(kv(Ue),Ue===Ie){st=null;break}if(Be!==null){Be.return=at,st=Be;break}st=at}}}var ot=C.alternate;if(ot!==null){var lt=ot.child;if(lt!==null){ot.child=null;do{var Pr=lt.sibling;lt.sibling=null,lt=Pr}while(lt!==null)}}st=C}}if((C.subtreeFlags&2064)!==0&&V!==null)V.return=C,st=V;else e:for(;st!==null;){if(C=st,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:ou(9,C,C.return)}var Ee=C.sibling;if(Ee!==null){Ee.return=C.return,st=Ee;break e}st=C.return}}var _e=i.current;for(st=_e;st!==null;){V=st;var Ne=V.child;if((V.subtreeFlags&2064)!==0&&Ne!==null)Ne.return=V,st=Ne;else e:for(V=_e;st!==null;){if(de=st,(de.flags&2048)!==0)try{switch(de.tag){case 0:case 11:case 15:af(9,de)}}catch(ut){br(de,de.return,ut)}if(de===V){st=null;break e}var Ye=de.sibling;if(Ye!==null){Ye.return=de.return,st=Ye;break e}st=de.return}}if(zt=k,js(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Jn,i)}catch{}x=!0}return x}finally{Mt=h,Ta.transition=c}}return!1}function Bv(i,c,h){c=Wl(h,c),c=nv(i,c,1),i=Rs(i,c,1),c=Fn(),i!==null&&(Qn(i,1,c),Vn(i,c))}function br(i,c,h){if(i.tag===3)Bv(i,i,h);else for(;c!==null;){if(c.tag===3){Bv(c,i,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ms===null||!Ms.has(x))){i=Wl(h,i),i=av(c,i,1),c=Rs(c,i,1),i=Fn(),c!==null&&(Qn(c,1,i),Vn(c,i));break}}c=c.return}}function Yb(i,c,h){var x=i.pingCache;x!==null&&x.delete(c),c=Fn(),i.pingedLanes|=i.suspendedLanes&h,qr===i&&(sn&h)===h&&(Hr===4||Hr===3&&(sn&130023424)===sn&&500>Ve()-R0?Io(i,0):O0|=h),Vn(i,c)}function zv(i,c){c===0&&((i.mode&1)===0?c=1:(c=hs,hs<<=1,(hs&130023424)===0&&(hs=4194304)));var h=Fn();i=Ki(i,c),i!==null&&(Qn(i,c,h),Vn(i,h))}function qb(i){var c=i.memoizedState,h=0;c!==null&&(h=c.retryLane),zv(i,h)}function Xb(i,c){var h=0;switch(i.tag){case 13:var x=i.stateNode,k=i.memoizedState;k!==null&&(h=k.retryLane);break;case 19:x=i.stateNode;break;default:throw Error(r(314))}x!==null&&x.delete(c),zv(i,h)}var Uv;Uv=function(i,c,h){if(i!==null)if(i.memoizedProps!==c.pendingProps||Un.current)$n=!0;else{if((i.lanes&h)===0&&(c.flags&128)===0)return $n=!1,Mb(i,c,h);$n=(i.flags&131072)!==0}else $n=!1,mr&&(c.flags&1048576)!==0&&_g(c,Ud,c.index);switch(c.lanes=0,c.tag){case 2:var x=c.type;rf(i,c),i=c.pendingProps;var k=jl(c,mn.current);zl(c,h),k=h0(null,c,x,i,k,h);var C=m0();return c.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Wn(x)?(C=!0,Md(c)):C=!1,c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,s0(c),k.updater=ef,c.stateNode=k,k._reactInternals=c,_0(c,x,i,h),c=S0(null,c,x,!0,C,h)):(c.tag=0,mr&&C&&qh(c),Dn(null,c,k,h),c=c.child),c;case 16:x=c.elementType;e:{switch(rf(i,c),i=c.pendingProps,k=x._init,x=k(x._payload),c.type=x,k=c.tag=Qb(x),i=Ya(x,i),k){case 0:c=k0(null,c,x,i,h);break e;case 1:c=hv(null,c,x,i,h);break e;case 11:c=lv(null,c,x,i,h);break e;case 14:c=cv(null,c,x,Ya(x.type,i),h);break e}throw Error(r(306,x,""))}return c;case 0:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:Ya(x,k),k0(i,c,x,k,h);case 1:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:Ya(x,k),hv(i,c,x,k,h);case 3:e:{if(mv(c),i===null)throw Error(r(387));x=c.pendingProps,C=c.memoizedState,k=C.element,Ng(i,c),Zd(c,x,null,h);var V=c.memoizedState;if(x=V.element,C.isDehydrated)if(C={element:x,isDehydrated:!1,cache:V.cache,pendingSuspenseBoundaries:V.pendingSuspenseBoundaries,transitions:V.transitions},c.updateQueue.baseState=C,c.memoizedState=C,c.flags&256){k=Wl(Error(r(423)),c),c=pv(i,c,x,h,k);break e}else if(x!==k){k=Wl(Error(r(424)),c),c=pv(i,c,x,h,k);break e}else for(oa=gi(c.stateNode.containerInfo.firstChild),sa=c,mr=!0,Ka=null,h=Cg(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Ll(),x===k){c=qi(i,c,h);break e}Dn(i,c,x,h)}c=c.child}return c;case 5:return Dg(c),i===null&&Qh(c),x=c.type,k=c.pendingProps,C=i!==null?i.memoizedProps:null,V=k.children,At(x,k)?V=null:C!==null&&At(x,C)&&(c.flags|=32),fv(i,c),Dn(i,c,V,h),c.child;case 6:return i===null&&Qh(c),null;case 13:return gv(i,c,h);case 4:return o0(c,c.stateNode.containerInfo),x=c.pendingProps,i===null?c.child=Ml(c,null,x,h):Dn(i,c,x,h),c.child;case 11:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:Ya(x,k),lv(i,c,x,k,h);case 7:return Dn(i,c,c.pendingProps,h),c.child;case 8:return Dn(i,c,c.pendingProps.children,h),c.child;case 12:return Dn(i,c,c.pendingProps.children,h),c.child;case 10:e:{if(x=c.type._context,k=c.pendingProps,C=c.memoizedProps,V=k.value,sr(Hd,x._currentValue),x._currentValue=V,C!==null)if(aa(C.value,V)){if(C.children===k.children&&!Un.current){c=qi(i,c,h);break e}}else for(C=c.child,C!==null&&(C.return=c);C!==null;){var de=C.dependencies;if(de!==null){V=C.child;for(var ge=de.firstContext;ge!==null;){if(ge.context===x){if(C.tag===1){ge=Yi(-1,h&-h),ge.tag=2;var Ie=C.updateQueue;if(Ie!==null){Ie=Ie.shared;var Ue=Ie.pending;Ue===null?ge.next=ge:(ge.next=Ue.next,Ue.next=ge),Ie.pending=ge}}C.lanes|=h,ge=C.alternate,ge!==null&&(ge.lanes|=h),a0(C.return,h,c),de.lanes|=h;break}ge=ge.next}}else if(C.tag===10)V=C.type===c.type?null:C.child;else if(C.tag===18){if(V=C.return,V===null)throw Error(r(341));V.lanes|=h,de=V.alternate,de!==null&&(de.lanes|=h),a0(V,h,c),V=C.sibling}else V=C.child;if(V!==null)V.return=C;else for(V=C;V!==null;){if(V===c){V=null;break}if(C=V.sibling,C!==null){C.return=V.return,V=C;break}V=V.return}C=V}Dn(i,c,k.children,h),c=c.child}return c;case 9:return k=c.type,x=c.pendingProps.children,zl(c,h),k=ka(k),x=x(k),c.flags|=1,Dn(i,c,x,h),c.child;case 14:return x=c.type,k=Ya(x,c.pendingProps),k=Ya(x.type,k),cv(i,c,x,k,h);case 15:return uv(i,c,c.type,c.pendingProps,h);case 17:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:Ya(x,k),rf(i,c),c.tag=1,Wn(x)?(i=!0,Md(c)):i=!1,zl(c,h),tv(c,x,k),_0(c,x,k,h),S0(null,c,x,!0,i,h);case 19:return xv(i,c,h);case 22:return dv(i,c,h)}throw Error(r(156,c.tag))};function Wv(i,c){return ze(i,c)}function Jb(i,c,h,x){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ea(i,c,h,x){return new Jb(i,c,h,x)}function H0(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Qb(i){if(typeof i=="function")return H0(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ce)return 11;if(i===he)return 14}return 2}function Ws(i,c){var h=i.alternate;return h===null?(h=Ea(i.tag,c,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=c,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,c=i.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function mf(i,c,h,x,k,C){var V=2;if(x=i,typeof i=="function")H0(i)&&(V=1);else if(typeof i=="string")V=5;else e:switch(i){case D:return Fo(h.children,k,C,c);case ee:V=8,k|=8;break;case re:return i=Ea(12,h,c,k|2),i.elementType=re,i.lanes=C,i;case Ce:return i=Ea(13,h,c,k),i.elementType=Ce,i.lanes=C,i;case ye:return i=Ea(19,h,c,k),i.elementType=ye,i.lanes=C,i;case j:return pf(h,k,C,c);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case pe:V=10;break e;case ue:V=9;break e;case ce:V=11;break e;case he:V=14;break e;case le:V=16,x=null;break e}throw Error(r(130,i==null?i:typeof i,""))}return c=Ea(V,h,c,k),c.elementType=i,c.type=x,c.lanes=C,c}function Fo(i,c,h,x){return i=Ea(7,i,x,c),i.lanes=h,i}function pf(i,c,h,x){return i=Ea(22,i,x,c),i.elementType=j,i.lanes=h,i.stateNode={isHidden:!1},i}function V0(i,c,h){return i=Ea(6,i,null,c),i.lanes=h,i}function G0(i,c,h){return c=Ea(4,i.children!==null?i.children:[],i.key,c),c.lanes=h,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}function ek(i,c,h,x,k){this.tag=c,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ms(0),this.expirationTimes=ms(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ms(0),this.identifierPrefix=x,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function Z0(i,c,h,x,k,C,V,de,ge){return i=new ek(i,c,h,de,ge),c===1?(c=1,C===!0&&(c|=8)):c=0,C=Ea(3,null,null,c),i.current=C,C.stateNode=i,C.memoizedState={element:x,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},s0(C),i}function tk(i,c,h){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:x==null?null:""+x,children:i,containerInfo:c,implementation:h}}function $v(i){if(!i)return Fs;i=i._reactInternals;e:{if(ae(i)!==i||i.tag!==1)throw Error(r(170));var c=i;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Wn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(r(171))}if(i.tag===1){var h=i.type;if(Wn(h))return vg(i,h,c)}return c}function Hv(i,c,h,x,k,C,V,de,ge){return i=Z0(h,x,!0,i,k,C,V,de,ge),i.context=$v(null),h=i.current,x=Fn(),k=zs(h),C=Yi(x,k),C.callback=c??null,Rs(h,C,k),i.current.lanes=k,Qn(i,k,x),Vn(i,x),i}function gf(i,c,h,x){var k=c.current,C=Fn(),V=zs(k);return h=$v(h),c.context===null?c.context=h:c.pendingContext=h,c=Yi(C,V),c.payload={element:i},x=x===void 0?null:x,x!==null&&(c.callback=x),i=Rs(k,c,V),i!==null&&(Ja(i,k,V,C),Gd(i,k,V)),V}function vf(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Vv(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<c?h:c}}function K0(i,c){Vv(i,c),(i=i.alternate)&&Vv(i,c)}function rk(){return null}var Gv=typeof reportError=="function"?reportError:function(i){console.error(i)};function Y0(i){this._internalRoot=i}xf.prototype.render=Y0.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(r(409));gf(i,c,null,null)},xf.prototype.unmount=Y0.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Po(function(){gf(null,i,null,null)}),c[Vt]=null}};function xf(i){this._internalRoot=i}xf.prototype.unstable_scheduleHydration=function(i){if(i){var c=ml();i={blockedOn:null,target:i,priority:c};for(var h=0;h<Ur.length&&c!==0&&c<Ur[h].priority;h++);Ur.splice(h,0,i),h===0&&pl(i)}};function q0(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function yf(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Zv(){}function nk(i,c,h,x,k){if(k){if(typeof x=="function"){var C=x;x=function(){var Ie=vf(V);C.call(Ie)}}var V=Hv(c,x,i,0,null,!1,!1,"",Zv);return i._reactRootContainer=V,i[Vt]=V.current,As(i.nodeType===8?i.parentNode:i),Po(),V}for(;k=i.lastChild;)i.removeChild(k);if(typeof x=="function"){var de=x;x=function(){var Ie=vf(ge);de.call(Ie)}}var ge=Z0(i,0,!1,null,null,!1,!1,"",Zv);return i._reactRootContainer=ge,i[Vt]=ge.current,As(i.nodeType===8?i.parentNode:i),Po(function(){gf(c,ge,h,x)}),ge}function _f(i,c,h,x,k){var C=h._reactRootContainer;if(C){var V=C;if(typeof k=="function"){var de=k;k=function(){var ge=vf(V);de.call(ge)}}gf(c,V,i,k)}else V=nk(h,c,i,k,x);return vf(V)}fl=function(i){switch(i.tag){case 3:var c=i.stateNode;if(c.current.memoizedState.isDehydrated){var h=Et(c.pendingLanes);h!==0&&($a(c,h|1),Vn(c,Ve()),(zt&6)===0&&(Vl=Ve()+500,js()))}break;case 13:Po(function(){var x=Ki(i,1);if(x!==null){var k=Fn();Ja(x,i,1,k)}}),K0(i,1)}},Fi=function(i){if(i.tag===13){var c=Ki(i,134217728);if(c!==null){var h=Fn();Ja(c,i,134217728,h)}K0(i,134217728)}},hl=function(i){if(i.tag===13){var c=zs(i),h=Ki(i,c);if(h!==null){var x=Fn();Ja(h,i,c,x)}K0(i,c)}},ml=function(){return Mt},uo=function(i,c){var h=Mt;try{return Mt=i,c()}finally{Mt=h}},hr=function(i,c,h){switch(c){case"input":if(Le(i,h),c=h.name,h.type==="radio"&&c!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==i&&x.form===i.form){var k=Dl(x);if(!k)throw Error(r(90));X(x),Le(x,k)}}}break;case"textarea":Cr(i,h);break;case"select":c=h.value,c!=null&&Gt(i,!!h.multiple,c,!1)}},us=U0,ds=Po;var ak={usingClientEntryPoint:!1,Events:[$i,Hi,Dl,ls,cs,U0]},du={findFiberByHostInstance:Wi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ik={bundleType:du.bundleType,version:du.version,rendererPackageName:du.rendererPackageName,rendererConfig:du.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=ke(i),i===null?null:i.stateNode},findFiberByHostInstance:du.findFiberByHostInstance||rk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wf.isDisabled&&wf.supportsFiber)try{Jn=wf.inject(ik),Nr=wf}catch{}}return Gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ak,Gn.createPortal=function(i,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!q0(c))throw Error(r(200));return tk(i,c,null,h)},Gn.createRoot=function(i,c){if(!q0(i))throw Error(r(299));var h=!1,x="",k=Gv;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onRecoverableError!==void 0&&(k=c.onRecoverableError)),c=Z0(i,1,!1,null,null,h,!1,x,k),i[Vt]=c.current,As(i.nodeType===8?i.parentNode:i),new Y0(c)},Gn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=ke(c),i=i===null?null:i.stateNode,i},Gn.flushSync=function(i){return Po(i)},Gn.hydrate=function(i,c,h){if(!yf(c))throw Error(r(200));return _f(null,i,c,!0,h)},Gn.hydrateRoot=function(i,c,h){if(!q0(i))throw Error(r(405));var x=h!=null&&h.hydratedSources||null,k=!1,C="",V=Gv;if(h!=null&&(h.unstable_strictMode===!0&&(k=!0),h.identifierPrefix!==void 0&&(C=h.identifierPrefix),h.onRecoverableError!==void 0&&(V=h.onRecoverableError)),c=Hv(c,null,i,1,h??null,k,!1,C,V),i[Vt]=c.current,As(i),x)for(i=0;i<x.length;i++)h=x[i],k=h._getVersion,k=k(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,k]:c.mutableSourceEagerHydrationData.push(h,k);return new xf(c)},Gn.render=function(i,c,h){if(!yf(c))throw Error(r(200));return _f(null,i,c,!1,h)},Gn.unmountComponentAtNode=function(i){if(!yf(i))throw Error(r(40));return i._reactRootContainer?(Po(function(){_f(null,null,i,!1,function(){i._reactRootContainer=null,i[Vt]=null})}),!0):!1},Gn.unstable_batchedUpdates=U0,Gn.unstable_renderSubtreeIntoContainer=function(i,c,h,x){if(!yf(h))throw Error(r(200));if(i==null||i._reactInternals===void 0)throw Error(r(38));return _f(i,c,h,!1,x)},Gn.version="18.3.1-next-f1338f8080-20240426",Gn}var tx;function dy(){if(tx)return Q0.exports;tx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Q0.exports=hk(),Q0.exports}var rx;function mk(){if(rx)return bf;rx=1;var e=dy();return bf.createRoot=e.createRoot,bf.hydrateRoot=e.hydrateRoot,bf}var pk=mk();const gk=hh(pk),vk="modulepreload",xk=function(e){return"/"+e},nx={},si=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let p=function(g){return Promise.all(g.map(y=>Promise.resolve(y).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var l=p;document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),m=u?.nonce||u?.getAttribute("nonce");a=p(r.map(g=>{if(g=xk(g),g in nx)return;nx[g]=!0;const y=g.endsWith(".css"),_=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${_}`))return;const T=document.createElement("link");if(T.rel=y?"stylesheet":vk,y||(T.as="script"),T.crossOrigin="",T.href=g,m&&T.setAttribute("nonce",m),document.head.appendChild(T),y)return new Promise((S,w)=>{T.addEventListener("load",S),T.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${g}`)))})}))}function s(u){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=u,window.dispatchEvent(m),!m.defaultPrevented)throw u}return a.then(u=>{for(const m of u||[])m.status==="rejected"&&s(m.reason);return t().catch(s)})};var J=lp();const rr=hh(J);function nd(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function fy(e,t){let r;const n=()=>{if(r)return r;const a=indexedDB.open(e);return a.onupgradeneeded=()=>a.result.createObjectStore(t),r=nd(a),r.then(s=>{s.onclose=()=>r=void 0},()=>{}),r};return(a,s)=>n().then(l=>s(l.transaction(t,a).objectStore(t)))}let rm;function cp(){return rm||(rm=fy("keyval-store","keyval")),rm}function up(e,t=cp()){return t("readonly",r=>nd(r.get(e)))}function dp(e,t,r=cp()){return r("readwrite",n=>(n.put(t,e),nd(n.transaction)))}function yk(e=cp()){return e("readwrite",t=>(t.clear(),nd(t.transaction)))}const _k=Object.freeze(Object.defineProperty({__proto__:null,clear:yk,createStore:fy,get:up,promisifyRequest:nd,set:dp},Symbol.toStringTag,{value:"Module"})),wk=["password","token","secret","apiKey","api_key","accessToken","refreshToken","sessionId","ssn","creditCard","cvv","pin","privateKey"];function Fm(e){if(e==null||typeof e!="object")return e;if(Array.isArray(e))return e.map(r=>Fm(r));const t={};for(const[r,n]of Object.entries(e)){const a=r.toLowerCase();wk.some(l=>a.includes(l.toLowerCase()))?t[r]="[REDACTED]":typeof n=="object"&&n!==null?t[r]=Fm(n):t[r]=n}return t}function ax(e){return e.map(t=>typeof t=="object"&&t!==null?Fm(t):t)}const ve={debug:(e,...t)=>{},info:(e,...t)=>{},warn:(e,...t)=>{console.warn(`[WARN] ${e}`,...ax(t))},error:(e,...t)=>{console.error(`[ERROR] ${e}`,...ax(t))},success:(e,...t)=>{},sync:(e,...t)=>{},time:e=>{},timeEnd:e=>{},group:e=>{},groupEnd:()=>{}};class bk{toasts=[];listeners=[];timeouts=new Map;show(t,r="info",n=4e3){const a={id:`toast_${Date.now()}_${Math.random().toString(36).slice(2)}`,message:t,type:r,timestamp:Date.now(),duration:n};if(this.toasts.push(a),this.notifyListeners(),n>0){const s=setTimeout(()=>{this.remove(a.id)},n);this.timeouts.set(a.id,s)}return a.id}remove(t){const r=this.timeouts.get(t);r&&(clearTimeout(r),this.timeouts.delete(t)),this.toasts=this.toasts.filter(n=>n.id!==t),this.notifyListeners()}clear(){this.timeouts.forEach(t=>clearTimeout(t)),this.timeouts.clear(),this.toasts=[],this.notifyListeners()}getToasts(){return[...this.toasts]}subscribe(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(r=>r!==t)}}notifyListeners(){this.listeners.forEach(t=>t([...this.toasts]))}}const Mu=new bk,fc=(e,t)=>Mu.show(e,"error",t),Tu=(e,t)=>Mu.show(e,"warning",t),kk=(e,t)=>Mu.show(e,"info",t);class Sk{queue=[];processing=!1;persistenceGranted=!1;constructor(){this.initializePersistence()}async initializePersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const t=await navigator.storage.persist();if(this.persistenceGranted=t,t?ve.info("✅ Persistent storage granted - data protected from eviction"):(ve.warn("⚠️ Persistent storage denied - data may be evicted by browser"),Tu("Storage persistence not granted. Your data may be lost if browser storage is full.",8e3)),"estimate"in navigator.storage){const r=await navigator.storage.estimate(),n=Math.round((r.usage||0)/1024/1024),a=Math.round((r.quota||0)/1024/1024);ve.info(`📊 Storage: ${n}MB used / ${a}MB quota`),r.usage&&r.quota&&r.usage>r.quota*.8&&(ve.warn("⚠️ Storage quota 80% full - may cause data loss"),Tu("Storage is 80% full. Consider clearing old data to prevent loss.",1e4))}}else ve.warn("🚫 Storage persistence API not available")}catch(t){ve.error("Failed to initialize storage persistence:",t)}}async queuedSet(t,r){return new Promise((n,a)=>{this.queue.push({key:t,data:r,resolve:n,reject:a}),this.processQueue()})}async processQueue(){if(!(this.processing||this.queue.length===0)){for(this.processing=!0;this.queue.length>0;){const t=this.queue.shift();try{let r=3,n;for(;r>0;)try{await dp(t.key,t.data),t.resolve(void 0);break}catch(a){n=a,r--,r>0&&(ve.warn(`IndexedDB write failed, retrying... (${3-r}/3)`,a),await new Promise(s=>setTimeout(s,100*(4-r))))}r===0&&(ve.error("IndexedDB write failed after 3 retries:",n),fc("Failed to save data. Please check your browser storage settings.",1e4),t.reject(n))}catch(r){ve.error("Storage queue operation failed:",r),t.reject(r)}}this.processing=!1}}async queuedGet(t){try{return await this.checkStorageHealth(),await up(t)}catch(r){throw ve.error("IndexedDB read failed:",r),fc("Failed to load data from storage. Please refresh the page.",1e4),r}}async checkStorageHealth(){try{if("storage"in navigator&&"estimate"in navigator.storage){const t=await navigator.storage.estimate();if(t.usage&&t.quota&&t.usage>t.quota*.95)throw ve.error("🚨 CRITICAL: Storage quota 95% full - immediate data loss risk"),fc("CRITICAL: Storage almost full! Clear browser data immediately to prevent loss.",15e3),new Error("Storage quota exhausted")}}catch(t){ve.warn("Storage health check failed:",t)}}async requestPersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const t=await navigator.storage.persist();return this.persistenceGranted=t,t}}catch(t){ve.error("Failed to request storage persistence:",t)}return!1}get isPersistent(){return this.persistenceGranted}}const hu=new Sk;function Br(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Ci(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function fp(e,t){const r=Br(e);return isNaN(t)?Ci(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Tk(e,t){const r=Br(e);if(isNaN(t))return Ci(e,NaN);if(!t)return r;const n=r.getDate(),a=Ci(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const s=a.getDate();return n>=s?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const hy=6048e5,Ek=864e5,my=6e4,py=36e5;let Ck={};function mh(){return Ck}function vc(e,t){const r=mh(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=Br(e),s=a.getDay(),l=(s<n?7:0)+s-n;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function Yf(e){return vc(e,{weekStartsOn:1})}function gy(e){const t=Br(e),r=t.getFullYear(),n=Ci(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=Yf(n),s=Ci(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const l=Yf(s);return t.getTime()>=a.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function Wo(e){const t=Br(e);return t.setHours(0,0,0,0),t}function ix(e){const t=Br(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Ak(e,t){const r=Wo(e),n=Wo(t),a=+r-ix(r),s=+n-ix(n);return Math.round((a-s)/Ek)}function Nk(e){const t=gy(e),r=Ci(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Yf(r)}function sx(e,t){const r=t*7;return fp(e,r)}function ox(e,t){const r=Wo(e),n=Wo(t);return+r==+n}function Pk(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Ik(e){if(!Pk(e)&&typeof e!="number")return!1;const t=Br(e);return!isNaN(Number(t))}function Dk(e){const t=Br(e),r=Ci(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function Fk(e,t){const r=t?.weekStartsOn,n=Br(e),a=n.getDay(),s=(a<r?-7:0)+6-(a-r);return n.setDate(n.getDate()+s),n.setHours(23,59,59,999),n}const jk={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ok=(e,t,r)=>{let n;const a=jk[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function nm(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Rk={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Lk={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Mk={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Bk={date:nm({formats:Rk,defaultWidth:"full"}),time:nm({formats:Lk,defaultWidth:"full"}),dateTime:nm({formats:Mk,defaultWidth:"full"})},zk={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Uk=(e,t,r,n)=>zk[e];function mu(e){return(t,r)=>{const n=r?.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,u=r?.width?String(r.width):l;a=e.formattingValues[u]||e.formattingValues[l]}else{const l=e.defaultWidth,u=r?.width?String(r.width):e.defaultWidth;a=e.values[u]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(t):t;return a[s]}}const Wk={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},$k={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Hk={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Vk={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Gk={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Zk={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Kk=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Yk={ordinalNumber:Kk,era:mu({values:Wk,defaultWidth:"wide"}),quarter:mu({values:$k,defaultWidth:"wide",argumentCallback:e=>e-1}),month:mu({values:Hk,defaultWidth:"wide"}),day:mu({values:Vk,defaultWidth:"wide"}),dayPeriod:mu({values:Gk,defaultWidth:"wide",formattingValues:Zk,defaultFormattingWidth:"wide"})};function pu(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const l=s[0],u=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],m=Array.isArray(u)?Xk(u,y=>y.test(l)):qk(u,y=>y.test(l));let p;p=e.valueCallback?e.valueCallback(m):m,p=r.valueCallback?r.valueCallback(p):p;const g=t.slice(l.length);return{value:p,rest:g}}}function qk(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Xk(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function Jk(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],s=t.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=r.valueCallback?r.valueCallback(l):l;const u=t.slice(a.length);return{value:l,rest:u}}}const Qk=/^(\d+)(th|st|nd|rd)?/i,e2=/\d+/i,t2={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},r2={any:[/^b/i,/^(a|c)/i]},n2={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},a2={any:[/1/i,/2/i,/3/i,/4/i]},i2={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},s2={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},o2={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},l2={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},c2={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},u2={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},d2={ordinalNumber:Jk({matchPattern:Qk,parsePattern:e2,valueCallback:e=>parseInt(e,10)}),era:pu({matchPatterns:t2,defaultMatchWidth:"wide",parsePatterns:r2,defaultParseWidth:"any"}),quarter:pu({matchPatterns:n2,defaultMatchWidth:"wide",parsePatterns:a2,defaultParseWidth:"any",valueCallback:e=>e+1}),month:pu({matchPatterns:i2,defaultMatchWidth:"wide",parsePatterns:s2,defaultParseWidth:"any"}),day:pu({matchPatterns:o2,defaultMatchWidth:"wide",parsePatterns:l2,defaultParseWidth:"any"}),dayPeriod:pu({matchPatterns:c2,defaultMatchWidth:"any",parsePatterns:u2,defaultParseWidth:"any"})},f2={code:"en-US",formatDistance:Ok,formatLong:Bk,formatRelative:Uk,localize:Yk,match:d2,options:{weekStartsOn:0,firstWeekContainsDate:1}};function h2(e){const t=Br(e);return Ak(t,Dk(t))+1}function m2(e){const t=Br(e),r=+Yf(t)-+Nk(t);return Math.round(r/hy)+1}function vy(e,t){const r=Br(e),n=r.getFullYear(),a=mh(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Ci(e,0);l.setFullYear(n+1,0,s),l.setHours(0,0,0,0);const u=vc(l,t),m=Ci(e,0);m.setFullYear(n,0,s),m.setHours(0,0,0,0);const p=vc(m,t);return r.getTime()>=u.getTime()?n+1:r.getTime()>=p.getTime()?n:n-1}function p2(e,t){const r=mh(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=vy(e,t),s=Ci(e,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),vc(s,t)}function g2(e,t){const r=Br(e),n=+vc(r,t)-+p2(r,t);return Math.round(n/hy)+1}function Yt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Hs={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Yt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Yt(r+1,2)},d(e,t){return Yt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Yt(e.getHours()%12||12,t.length)},H(e,t){return Yt(e.getHours(),t.length)},m(e,t){return Yt(e.getMinutes(),t.length)},s(e,t){return Yt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return Yt(a,t.length)}},Zl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},lx={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Hs.y(e,t)},Y:function(e,t,r,n){const a=vy(e,n),s=a>0?a:1-a;if(t==="YY"){const l=s%100;return Yt(l,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Yt(s,t.length)},R:function(e,t){const r=gy(e);return Yt(r,t.length)},u:function(e,t){const r=e.getFullYear();return Yt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Yt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Yt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Hs.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Yt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=g2(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Yt(a,t.length)},I:function(e,t,r){const n=m2(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Yt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Hs.d(e,t)},D:function(e,t,r){const n=h2(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Yt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Yt(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Yt(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return Yt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=Zl.noon:n===0?a=Zl.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=Zl.evening:n>=12?a=Zl.afternoon:n>=4?a=Zl.morning:a=Zl.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Hs.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Hs.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Yt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Yt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Hs.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Hs.s(e,t)},S:function(e,t){return Hs.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return ux(n);case"XXXX":case"XX":return Lo(n);case"XXXXX":case"XXX":default:return Lo(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return ux(n);case"xxxx":case"xx":return Lo(n);case"xxxxx":case"xxx":default:return Lo(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+cx(n,":");case"OOOO":default:return"GMT"+Lo(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+cx(n,":");case"zzzz":default:return"GMT"+Lo(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Yt(n,t.length)},T:function(e,t,r){const n=e.getTime();return Yt(n,t.length)}};function cx(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+t+Yt(s,2)}function ux(e,t){return e%60===0?(e>0?"-":"+")+Yt(Math.abs(e)/60,2):Lo(e,t)}function Lo(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Yt(Math.trunc(n/60),2),s=Yt(n%60,2);return r+a+t+s}const dx=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},xy=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},v2=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return dx(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",dx(n,t)).replace("{{time}}",xy(a,t))},x2={p:xy,P:v2},y2=/^D+$/,_2=/^Y+$/,w2=["D","DD","YY","YYYY"];function b2(e){return y2.test(e)}function k2(e){return _2.test(e)}function S2(e,t,r){const n=T2(e,t,r);if(console.warn(n),w2.includes(e))throw new RangeError(n)}function T2(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const E2=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,C2=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,A2=/^'([^]*?)'?$/,N2=/''/g,P2=/[a-zA-Z]/;function qf(e,t,r){const n=mh(),a=n.locale??f2,s=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,l=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,u=Br(e);if(!Ik(u))throw new RangeError("Invalid time value");let m=t.match(C2).map(g=>{const y=g[0];if(y==="p"||y==="P"){const _=x2[y];return _(g,a.formatLong)}return g}).join("").match(E2).map(g=>{if(g==="''")return{isToken:!1,value:"'"};const y=g[0];if(y==="'")return{isToken:!1,value:I2(g)};if(lx[y])return{isToken:!0,value:g};if(y.match(P2))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:g}});a.localize.preprocessor&&(m=a.localize.preprocessor(u,m));const p={firstWeekContainsDate:s,weekStartsOn:l,locale:a};return m.map(g=>{if(!g.isToken)return g.value;const y=g.value;(k2(y)||b2(y))&&S2(y,t,String(e));const _=lx[y[0]];return _(u,y,a.localize,p)}).join("")}function I2(e){const t=e.match(A2);return t?t[1].replace(N2,"'"):e}function D2(e,t){const r=Br(e),n=Br(t);return r.getTime()>n.getTime()}function F2(e){return+Br(e)<Date.now()}function j2(e,t){const r=+Br(e),[n,a]=[+Br(t.start),+Br(t.end)].sort((s,l)=>s-l);return r>=n&&r<=a}function O2(e,t){return fp(e,-t)}function Fa(e,t){const n=B2(e);let a;if(n.date){const m=z2(n.date,2);a=U2(m.restDateString,m.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const s=a.getTime();let l=0,u;if(n.time&&(l=W2(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(u=$2(n.timezone),isNaN(u))return new Date(NaN)}else{const m=new Date(s+l),p=new Date(0);return p.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),p.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),p}return new Date(s+l+u)}const kf={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},R2=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,L2=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,M2=/^([+-])(\d{2})(?::?(\d{2}))?$/;function B2(e){const t={},r=e.split(kf.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],kf.timeZoneDelimiter.test(t.date)&&(t.date=e.split(kf.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=kf.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function z2(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function U2(e,t){if(t===null)return new Date(NaN);const r=e.match(R2);if(!r)return new Date(NaN);const n=!!r[4],a=gu(r[1]),s=gu(r[2])-1,l=gu(r[3]),u=gu(r[4]),m=gu(r[5])-1;if(n)return K2(t,u,m)?H2(t,u,m):new Date(NaN);{const p=new Date(0);return!G2(t,s,l)||!Z2(t,a)?new Date(NaN):(p.setUTCFullYear(t,s,Math.max(a,l)),p)}}function gu(e){return e?parseInt(e):1}function W2(e){const t=e.match(L2);if(!t)return NaN;const r=am(t[1]),n=am(t[2]),a=am(t[3]);return Y2(r,n,a)?r*py+n*my+a*1e3:NaN}function am(e){return e&&parseFloat(e.replace(",","."))||0}function $2(e){if(e==="Z")return 0;const t=e.match(M2);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return q2(n,a)?r*(n*py+a*my):NaN}function H2(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,s=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+s),n}const V2=[31,null,31,30,31,30,31,31,30,31,30,31];function yy(e){return e%400===0||e%4===0&&e%100!==0}function G2(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(V2[t]||(yy(e)?29:28))}function Z2(e,t){return t>=1&&t<=(yy(e)?366:365)}function K2(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Y2(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function q2(e,t){return t>=0&&t<=59}const X2={name:"[Agent Name]",title:"Enforcement Agent",signature:"Enforcement Agent [Agent Name]",contactInfo:void 0},_y=[{id:"professional_standard",name:"Professional Standard",template:`{greeting}PAYMENT REMINDER

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: £{amount}

Payment must be made as agreed. Failure to comply may result in further enforcement action.

Contact immediately if unable to pay as arranged.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"friendly_reminder",name:"Friendly Reminder",template:`{greeting}Payment Reminder

{refLine}This is a friendly reminder that your payment arrangement is due {date}{time}.

Amount: £{amount}

Please ensure payment is made as agreed. If you need to discuss this arrangement, please contact us immediately.

Thank you,
{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"urgent_notice",name:"Urgent Notice",template:`{greeting}URGENT: PAYMENT DUE

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: £{amount}

IMPORTANT: Payment must be made TODAY as agreed. Failure to comply will result in immediate further enforcement action.

Contact us NOW if unable to pay.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"payment_plan_reminder",name:"Payment Plan Reminder",template:`{greeting}Payment Plan Reminder

{refLine}Your next payment is due {date}{time}.

Payment Amount: £{amount}

This is part of your agreed payment plan. Please ensure this payment is made on time to keep your arrangement active.

If you have any questions about your payment plan, please contact us.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"custom",name:"Custom Template",template:`{greeting}Payment Reminder

{refLine}Your payment is due {date}{time}.

Amount: £{amount}

[Customize this message]

{signature}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]}],J2={daysBeforePayment:[3,1,0],enabled:!0,autoSend:!1},tl={defaultSchedule:J2,globalEnabled:!0,smsEnabled:!0,agentProfile:X2,messageTemplates:_y,activeTemplateId:"professional_standard",customizableSchedule:{threeDayReminder:!0,oneDayReminder:!0,dayOfReminder:!0,customDays:[]}};function Q2(e,t=tl){const r=e.reminderSchedule||t.defaultSchedule;if(!r.enabled||!t.globalEnabled)return[];const n=Fa(e.scheduledDate);let a=[];return r.daysBeforePayment&&r.daysBeforePayment.length>0?a=[...r.daysBeforePayment]:(t.customizableSchedule.threeDayReminder&&a.push(3),t.customizableSchedule.oneDayReminder&&a.push(1),t.customizableSchedule.dayOfReminder&&a.push(0),a.push(...t.customizableSchedule.customDays)),[...new Set(a)].sort((l,u)=>u-l).map(l=>O2(n,l).toISOString())}function eS(e,t=tl){const r=Q2(e,t),n=new Date().toISOString();return r.map((a,s)=>({id:`${e.id}_reminder_${s}`,arrangementId:e.id,type:tS(e,a),scheduledDate:a,status:"pending",createdAt:n,updatedAt:n}))}function tS(e,t){const r=Wo(Fa(e.scheduledDate)),n=Wo(Fa(t)),a=Wo(new Date);return n.getTime()===r.getTime()?"payment_due":D2(a,r)?"overdue":"custom"}function rS(e){const t=e.reminderSettings||tl;if(!t.globalEnabled)return e.reminderNotifications||[];const r=e.reminderNotifications||[],n=[];return e.arrangements.filter(a=>a.status!=="Completed"&&a.status!=="Cancelled").forEach(a=>{if(!r.some(l=>l.arrangementId===a.id)){const l=eS(a,t);n.push(...l)}}),[...r,...n]}function nS(e,t,r,n){return e.map(a=>a.id===t?{...a,status:r,message:n||a.message,updatedAt:new Date().toISOString()}:a)}function aS(e,t){const r=new Set(t.filter(n=>n.status!=="Completed"&&n.status!=="Cancelled").map(n=>n.id));return e.filter(n=>r.has(n.arrangementId))}function wy(e,t,r=tl){const n=r.messageTemplates.find(w=>w.id===r.activeTemplateId)||r.messageTemplates[0],a=e.customerName||"",s=e.amount||"the arranged amount",l=Fa(e.scheduledDate);let u="",m="";if(a){const w=a.trim().split(/\s+/);w.length>=2?(m=w[0],u=`Mr/Mrs ${w.slice(1).join(" ")}, `):u=`${a}, `}const p=m?`Reference: ${m}

`:"",g=e.scheduledTime?` at ${e.scheduledTime}`:"",y=l.toLocaleDateString("en-GB");let _=n.template;const T=r.agentProfile.contactInfo?`
${r.agentProfile.contactInfo}`:"",S={greeting:u,refLine:p,date:y,time:g,amount:s,signature:r.agentProfile.signature,customerName:a,referenceNumber:m||"",agentName:r.agentProfile.name,agentTitle:r.agentProfile.title,contactInfo:T};return Object.entries(S).forEach(([w,E])=>{const P=new RegExp(`\\{${w}\\}`,"g");_=_.replace(P,E)}),_}const rs={enabled:!0,calculationType:"complex",simpleSettings:{pifBonus:100,dailyThreshold:100},complexSettings:{baseEnforcementFee:235,basePifBonus:100,largePifThreshold:1500,largePifPercentage:.001875,largePifCap:500,smallPifBonus:30,linkedCaseBonus:10,complianceFeePerCase:75,complianceFeeFixed:122.5,dailyThreshold:100},adjustForWorkingDays:!0};function Xf(e,t=1){const a=(e-(75*t+122.5))/1.075;return Math.max(0,a)}function iS(e,t,r){if(!r.simpleSettings)return 0;const{pifBonus:n,dailyThreshold:a}=r.simpleSettings;let s=0;for(const p of e)p.outcome==="PIF"&&(s+=1);const l=s*n,u=t*a,m=l-u;return Math.max(0,m)}function sS(e,t,r){if(!r.complexSettings)return 0;const{basePifBonus:n,largePifThreshold:a,largePifPercentage:s,largePifCap:l,smallPifBonus:u,linkedCaseBonus:m,dailyThreshold:p}=r.complexSettings;let g=0;for(const T of e){if(T.outcome!=="PIF")continue;const S=parseFloat(T.amount||"0"),w=T.numberOfCases||1;let E=0;if(S===0)E=m;else if(S<100)E=u;else{const P=Xf(S,w);if(P>a){const I=s*(P-a);E=Math.min(n+I,l)}else E=n}g+=E}const y=t*p,_=g-y;return Math.max(0,_)}function by(e,t,r,n){try{const a=Xf(t,r),s=t,l=r,u=n,p=new Function("T","N","D","days",`return ${e}`)(s,l,a,u);return typeof p=="number"&&isFinite(p)?Math.max(0,p):0}catch(a){return console.error("Error evaluating custom bonus formula:",a),0}}function oS(e,t,r){if(!r.customFormula)return 0;let n=0;for(const a of e){if(a.outcome!=="PIF")continue;const s=parseFloat(a.amount||"0"),l=a.numberOfCases||1,u=by(r.customFormula,s,l,t);n+=u}return Math.max(0,n)}function fx(e,t,r=rs){if(!r.enabled)return 0;switch(r.calculationType){case"simple":return iS(e,t,r);case"complex":return sS(e,t,r);case"custom":return oS(e,t,r);default:return 0}}function lS(e,t,r=rs){const n={totalPifs:0,totalCases:0,grossBonus:0,threshold:0,netBonus:0,pifDetails:[]};if(!r.enabled)return n;const a=r.calculationType==="simple"?r.simpleSettings?.dailyThreshold||100:r.complexSettings?.dailyThreshold||100;n.threshold=t*a;for(const s of e){if(s.outcome!=="PIF")continue;const l=parseFloat(s.amount||"0"),u=s.numberOfCases||1;n.totalPifs++,n.totalCases+=u;let m=0,p;if(r.calculationType==="simple"&&r.simpleSettings)m=r.simpleSettings.pifBonus;else if(r.calculationType==="complex"&&r.complexSettings){const{basePifBonus:g,largePifThreshold:y,largePifPercentage:_,largePifCap:T,smallPifBonus:S,linkedCaseBonus:w}=r.complexSettings;if(l===0)m=w;else if(l<100)m=S;else if(p=Xf(l,u),p>y){const E=_*(p-y);m=Math.min(g+E,T)}else m=g}else r.calculationType==="custom"&&r.customFormula&&(p=Xf(l,u),m=by(r.customFormula,l,u,t));n.grossBonus+=m,n.pifDetails.push({amount:l,cases:u,bonusPerCase:m,totalBonus:m,debtAmount:p})}return n.netBonus=Math.max(0,n.grossBonus-n.threshold),n}const vu="navigator_state_v5",jo=5,xu={addresses:[],activeIndex:null,activeStartTime:null,completions:[],daySessions:[],arrangements:[],currentListVersion:1,subscription:null,reminderSettings:tl,reminderNotifications:[],lastReminderProcessed:void 0,bonusSettings:rs};function cS(e){return e&&typeof e.index=="number"&&typeof e.address=="string"&&typeof e.outcome=="string"&&["PIF","DA","Done","ARR"].includes(e.outcome)&&typeof e.timestamp=="string"&&!isNaN(new Date(e.timestamp).getTime())}function im(e){return e&&typeof e.address=="string"&&e.address.trim().length>0}function uS(e){return e&&Array.isArray(e.addresses)&&Array.isArray(e.completions)&&Array.isArray(e.daySessions)&&Array.isArray(e.arrangements)&&(e.activeIndex===null||typeof e.activeIndex=="number")&&typeof e.currentListVersion=="number"}function hx(e,t){return(Array.isArray(e)?e:[]).filter(cS).map(n=>({...n,listVersion:typeof n?.listVersion=="number"?n.listVersion:t}))}function Vs(e,t,r){const n=`${e}_${t}_${JSON.stringify(r).slice(0,50)}_${Date.now()}`,a=encodeURIComponent(n);return btoa(a).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}function ky(e,t){const r={...e,end:t.toISOString()},n=Date.parse(e.start),a=t.getTime();if(!Number.isNaN(n)&&!Number.isNaN(a)){const s=a-n;r.durationSeconds=s>=0?Math.floor(s/1e3):void 0}else r.durationSeconds=void 0;return r}function dS(e,t){const r=t.getTime(),n=Date.parse(e.start);let a=Date.parse(`${e.date}T23:59:59.999Z`);return Number.isNaN(a)&&(a=r),!Number.isNaN(n)&&a<n&&(a=n),a>r&&(a=r),Number.isNaN(a)&&(a=Number.isNaN(n)?r:n),ky(e,new Date(a))}function fS(e,t,r){const n=[],a=[];for(const s of e)if(!s.end&&s.date<t){const l=dS(s,r);n.push(l),a.push(l)}else n.push(s);return{sanitizedSessions:n,closedSessions:a}}function hS(e,t){for(let r=e.length-1;r>=0;r-=1){const n=e[r];if(n.date===t&&!n.end)return r}return-1}function mS(e,t,r){const{sanitizedSessions:n,closedSessions:a}=fS(e,t,r),s=hS(n,t);if(s===-1)return{updatedSessions:n,closedSessions:a};const l=n.slice(),u=ky(l[s],r);return l[s]=u,{updatedSessions:l,closedSessions:a,endedSession:u}}const mx="navigator_device_id";function pS(){try{const e=localStorage.getItem(mx);if(e)return e;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():"dev_"+Math.random().toString(36).slice(2);return localStorage.setItem(mx,t),t}catch{return"dev_"+Math.random().toString(36).slice(2)}}function gS(e,t){if(t.size===0)return e;try{let r={...e,addresses:[...e.addresses],completions:[...e.completions],arrangements:[...e.arrangements],daySessions:[...e.daySessions]};const n=Array.from(t.values()).sort((l,u)=>new Date(l.timestamp).getTime()-new Date(u.timestamp).getTime());let a=!1,s=!1;for(const l of n)if(l.type!=="reverted")try{switch(l.entity){case"completion":if(s=!0,l.operation==="create"){if(!l.data||typeof l.data.index!="number"||!l.data.outcome){ve.warn("Invalid completion data in optimistic update:",l.data);continue}r.completions.some(m=>m.index===l.data.index&&m.outcome===l.data.outcome&&Math.abs(new Date(m.timestamp).getTime()-new Date(l.data.timestamp).getTime())<1e3)||(r.completions=[l.data,...r.completions])}else l.operation==="update"?r.completions=r.completions.map(u=>u.timestamp===l.data.originalTimestamp?{...u,...l.data}:u):l.operation==="delete"&&(r.completions=r.completions.filter(u=>u.timestamp!==l.data.timestamp));break;case"arrangement":l.operation==="create"?r.arrangements=[...r.arrangements,l.data]:l.operation==="update"?r.arrangements=r.arrangements.map(u=>u.id===l.data.id?{...u,...l.data,updatedAt:l.timestamp}:u):l.operation==="delete"&&(r.arrangements=r.arrangements.filter(u=>u.id!==l.data.id));break;case"address":if(a=!0,l.operation==="create")r.addresses=[...r.addresses,l.data];else if(l.operation==="update"&&l.data?.addresses&&(r.addresses=Array.isArray(l.data.addresses)?l.data.addresses:r.addresses,l.data.bumpVersion)){const u=typeof r.currentListVersion=="number"?r.currentListVersion:1;r.currentListVersion=u+1,l.data.preserveCompletions||(r.completions=[]),r.activeIndex=null}break;case"session":l.operation==="create"?l.data&&l.data.date&&l.data.start?r.daySessions=[...r.daySessions,l.data]:ve.warn("Invalid session data in optimistic update:",l.data):l.operation==="update"&&(r.daySessions=r.daySessions.map(u=>u.date===l.data.date?{...u,...l.data}:u));break;default:ve.warn(`Unknown entity type in optimistic update: ${l.entity}`,l);break}}catch(u){ve.error(`Failed to apply optimistic update for ${l.entity}:`,u)}return a&&(!r.addresses||!Array.isArray(r.addresses))?(ve.error("Optimistic updates corrupted addresses, reverting to base state"),e):s&&(!r.completions||!Array.isArray(r.completions))?(ve.error("Optimistic updates corrupted completions, reverting to base state"),e):r}catch(r){return ve.error("Failed to apply optimistic updates, returning base state:",r),e}}function vS(e){const[t,r]=J.useState(xu),[n,a]=J.useState({updates:new Map,pendingOperations:new Set}),[s,l]=J.useState(!0),u=J.useMemo(()=>pS(),[]),m=J.useRef(e);J.useEffect(()=>{m.current=e},[e]);const p=J.useMemo(()=>{let M=t;return t.bonusSettings||(ve.warn("Missing bonusSettings in baseState, applying default"),M={...t,bonusSettings:rs},setTimeout(()=>r(M),0)),gS(M,n.updates)},[t,n.updates]),[g,y]=J.useState(new Map),[_,T]=J.useState({});J.useEffect(()=>{let M=!0;return(async()=>{try{const oe=await hu.queuedGet(vu);if(!M)return;if(oe){const se=oe._ownerUserId,fe=oe._ownerChecksum,xe=localStorage.getItem("navigator_expected_user_id");if(xe&&se&&se!==xe){ve.error(`🚨 INDEXEDDB CONTAMINATION: Data belongs to ${se} but expected ${xe}`);const Ke={timestamp:new Date().toISOString(),contaminatedData:oe,expectedUserId:xe,actualUserId:se,reason:"indexeddb_contamination"};localStorage.setItem(`navigator_emergency_backup_${Date.now()}`,JSON.stringify(Ke)),await hu.queuedSet(vu,null),ve.warn("🔒 SECURITY: Cleared contaminated IndexedDB data"),r({...xu,_schemaVersion:jo});return}if(T({ownerUserId:se,ownerChecksum:fe}),!uS(oe)){ve.warn("Loaded data failed validation, using initial state"),r({...xu,_schemaVersion:jo});return}const je=typeof oe.currentListVersion=="number"?oe.currentListVersion:1,X={addresses:oe.addresses.filter(im),activeIndex:typeof oe.activeIndex=="number"?oe.activeIndex:null,completions:hx(oe.completions,je),daySessions:Array.isArray(oe.daySessions)?oe.daySessions:[],arrangements:Array.isArray(oe.arrangements)?oe.arrangements:[],currentListVersion:je,subscription:oe.subscription||null,reminderSettings:oe.reminderSettings||tl,reminderNotifications:Array.isArray(oe.reminderNotifications)?oe.reminderNotifications:[],lastReminderProcessed:oe.lastReminderProcessed,bonusSettings:oe.bonusSettings||rs,_schemaVersion:jo};ve.info("State loaded from IndexedDB:",{hasBonusSettings:!!X.bonusSettings,bonusSettings:X.bonusSettings}),r(X)}else r({...xu,_schemaVersion:jo})}catch(oe){ve.error("Failed to load state from IndexedDB:",oe),r({...xu,_schemaVersion:jo})}finally{M&&l(!1)}})(),()=>{M=!1}},[]),J.useEffect(()=>{if(s)return;const M=setTimeout(async()=>{try{const oe={...t,_schemaVersion:jo};if(m.current){oe._ownerUserId=m.current;const se=JSON.stringify({addressCount:t.addresses.length,completionCount:t.completions.length,listVersion:t.currentListVersion}),fe=`${m.current}|${se}`;oe._ownerChecksum=btoa(fe).slice(0,32)}await hu.queuedSet(vu,oe)}catch(oe){ve.error("Failed to persist state to IndexedDB:",oe)}},150);return()=>clearTimeout(M)},[t,s]);const S=J.useCallback((M,oe,se,fe)=>{const xe=fe||Vs(M,oe,se),je=new Date().toISOString(),X={id:xe,timestamp:je,type:"optimistic",operation:M,entity:oe,data:se};return a(Ke=>{const Xe=new Map(Ke.updates);return Xe.set(xe,X),{updates:Xe,pendingOperations:new Set([...Ke.pendingOperations,xe])}}),xe},[]),w=J.useCallback((M,oe)=>{a(se=>{const fe=new Map(se.updates),xe=new Set(se.pendingOperations),je=fe.get(M);return je&&fe.set(M,{...je,type:"confirmed",data:oe||je.data}),xe.delete(M),{updates:fe,pendingOperations:xe}}),setTimeout(()=>{a(se=>{const fe=new Map(se.updates);return fe.delete(M),{...se,updates:fe}})},5e3)},[]),E=J.useCallback((M,oe)=>{ve.debug(`Reverting optimistic update ${M}:`,oe),a(se=>{const fe=new Map(se.updates),xe=new Set(se.pendingOperations),je=fe.get(M);return je&&fe.set(M,{...je,type:"reverted"}),xe.delete(M),{updates:fe,pendingOperations:xe}}),setTimeout(()=>{a(se=>{const fe=new Map(se.updates);return fe.delete(M),{...se,updates:fe}})},1e3)},[]),P=J.useCallback(()=>{a({updates:new Map,pendingOperations:new Set})},[]),I=J.useCallback((M,oe=!0)=>{ve.info(`🔄 IMPORT START: Importing ${M.length} addresses, preserveCompletions=${oe}`);const se=Date.now();localStorage.setItem("navigator_import_in_progress",se.toString()),ve.info("🛡️ IMPORT PROTECTION ACTIVATED:",new Date(se).toISOString());const fe=Vs("update","address",{type:"bulk_import",count:M.length,preserve:oe}),xe=Array.isArray(M)?M.filter(im):[];if(ve.info(`🔄 IMPORT VALIDATION: ${xe.length} valid out of ${M.length} total`),xe.length===0){ve.warn("No valid addresses to import");return}S("update","address",{addresses:xe,bumpVersion:!0,preserveCompletions:oe},fe),r(je=>{const X=(typeof je.currentListVersion=="number"?je.currentListVersion:1)+1;ve.info(`🔄 IMPORT BASE STATE UPDATE: addresses=${xe.length}, preserveCompletions=${oe}, oldCompletions=${je.completions.length}, newListVersion=${X}`);const Ke={...je,addresses:xe,activeIndex:null,currentListVersion:X,completions:oe?je.completions:[]};return ve.info(`🔄 IMPORT RESULT STATE: addresses=${Ke.addresses.length}, completions=${Ke.completions.length}, listVersion=${Ke.currentListVersion}`),Ke}),w(fe),setTimeout(()=>{localStorage.removeItem("navigator_import_in_progress"),ve.info("🛡️ IMPORT PROTECTION CLEARED after import completion")},2e3)},[S,w]),A=J.useCallback(M=>new Promise(oe=>{if(!im(M)){oe(-1);return}const se=Vs("create","address",M);S("create","address",M,se),r(fe=>{const xe=[...fe.addresses,M],je=xe.length-1;return w(se),oe(je),{...fe,addresses:xe}})}),[S,w]),R=J.useCallback(M=>{localStorage.setItem("navigator_active_protection","true"),r(oe=>{const se=oe.addresses[M];if(oe.activeIndex!==null&&oe.activeIndex!==M){const xe=oe.addresses[oe.activeIndex];return ve.warn(`Cannot start address #${M} - address #${oe.activeIndex} "${xe?.address}" is already active`),Tu("Please complete or cancel the current active address first"),localStorage.removeItem("navigator_active_protection"),oe}if(se&&oe.completions.some(je=>je.index===M&&(je.listVersion||oe.currentListVersion)===oe.currentListVersion))return ve.warn(`Cannot set active - address at index ${M} is already completed`),Tu("This address is already completed"),localStorage.removeItem("navigator_active_protection"),oe;const fe=new Date().toISOString();return ve.info(`📍 STARTING CASE: Address #${M} "${se?.address}" at ${fe} - SYNC BLOCKED until Complete/Cancel`),{...oe,activeIndex:M,activeStartTime:fe}})},[]),K=J.useCallback(()=>{localStorage.removeItem("navigator_active_protection"),r(M=>(ve.info("📍 CANCELING ACTIVE: Clearing active state - SYNC RESUMED"),{...M,activeIndex:null,activeStartTime:null}))},[]),[,W]=J.useState(new Set),D=J.useRef(new Set),ee=J.useRef(new Map);J.useEffect(()=>{const M=setInterval(()=>{const oe=Date.now()-3e4;let se=0;for(const[fe,xe]of ee.current.entries())xe.timestamp<oe&&(ee.current.delete(fe),se++);se>0&&ve.debug(`🧹 Cleaned up ${se} old completion entries from memory`)},15e3);return()=>clearInterval(M)},[]);const re=J.useCallback(async(M,oe,se,fe,xe,je)=>{if(!Number.isInteger(M)||M<0){const ft=`Invalid index: ${M}. Index must be a non-negative integer.`;throw ve.error(ft),fc("Invalid address index. Please refresh and try again."),new Error(ft)}const X=t;if(M>=X.addresses.length){const ft=`Index ${M} out of bounds. Total addresses: ${X.addresses.length}`;throw ve.error(ft),fc("Address not found. The list may have changed. Please refresh."),new Error(ft)}if(D.current.has(M))throw new Error(`Completion already pending for index ${M}`);const Ke=X.addresses[M];if(!Ke||!Ke.address){const ft=`Address at index ${M} is invalid or empty`;throw ve.error(ft),fc("Invalid address data. Please refresh and try again."),new Error(ft)}const Xe=X.completions.find(ft=>ft.address===Ke.address&&ft.listVersion===X.currentListVersion);if(Xe){const ft=new Date(Xe.timestamp).getTime(),Gt=Date.now()-ft;if(Gt<3e4)return Tu(`Address "${Ke.address}" was already completed ${Math.round(Gt/1e3)} seconds ago`),Promise.reject();console.log(`🔄 RE-COMPLETING: Address "${Ke.address}" was previously completed ${new Date(Xe.timestamp).toLocaleString()}, allowing new completion`)}const Qe=new Date().toISOString();let it;if(X.activeIndex===M&&X.activeStartTime){const ft=new Date(X.activeStartTime).getTime(),pt=new Date(Qe).getTime();it=Math.floor((pt-ft)/1e3),ve.info(`⏱️ CASE TIME TRACKED: ${Math.floor(it/60)}m ${it%60}s on "${Ke.address}"`)}const Le={index:M,address:Ke.address,lat:Ke.lat??null,lng:Ke.lng??null,outcome:oe,amount:se,timestamp:Qe,listVersion:X.currentListVersion,arrangementId:fe,caseReference:xe,timeSpentSeconds:it,numberOfCases:je},kt=Vs("create","completion",Le);try{D.current.add(M),W(new Set(D.current));const ft=`${M}_${oe}_${X.currentListVersion}`;return ee.current.set(ft,{timestamp:Date.now(),completion:Le}),S("create","completion",Le,kt),r(pt=>(pt.activeIndex===M&&(localStorage.removeItem("navigator_active_protection"),ve.info("📍 COMPLETED ACTIVE ADDRESS: Clearing active state - SYNC RESUMED")),{...pt,completions:[Le,...pt.completions],activeIndex:pt.activeIndex===M?null:pt.activeIndex,activeStartTime:pt.activeIndex===M?null:pt.activeStartTime})),kt}finally{D.current.delete(M),W(new Set(D.current))}},[t,S]),pe=J.useCallback(M=>{r(oe=>{const se=oe.completions.slice();let fe=-1,xe=0;for(let je=0;je<se.length;je++){const X=se[je];if(Number(X.index)===Number(M)&&X.listVersion===oe.currentListVersion){const Ke=new Date(X.timestamp).getTime();Ke>xe&&(xe=Ke,fe=je)}}if(fe>=0){const je=se[fe],X=Vs("delete","completion",je);S("delete","completion",je,X),se.splice(fe,1),setTimeout(()=>w(X),0)}return{...oe,completions:se}})},[S,w]),ue=J.useCallback(()=>{const M=new Date,oe=M.toISOString().slice(0,10);r(se=>{if(se.daySessions.find(X=>X.date===oe&&!X.end))return ve.info("Day already active for today, skipping start"),se;const xe=se.daySessions.map(X=>X.date<oe&&!X.end?(ve.info("Auto-closing stale session from previous day:",X),{...X,end:new Date(X.date+"T23:59:59.999Z").toISOString(),durationSeconds:Math.floor((new Date(X.date+"T23:59:59.999Z").getTime()-new Date(X.start).getTime())/1e3)}):X),je={date:oe,start:M.toISOString()};return ve.info("Starting new day session:",je),{...se,daySessions:[...xe,je]}})},[]),ce=J.useCallback(()=>{const M=new Date,oe=M.toISOString().slice(0,10);r(se=>{const{updatedSessions:fe,closedSessions:xe,endedSession:je}=mS(se.daySessions,oe,M);return xe.forEach(X=>ve.info("Auto-closing stale day session before ending today",X)),je?(ve.info("Ending day session:",je),{...se,daySessions:fe}):(ve.info("No active session to end for today"),xe.length>0?{...se,daySessions:fe}:se)})},[]),Ce=J.useCallback(M=>new Promise(oe=>{const se=new Date().toISOString(),fe=`arr_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,xe={...M,id:fe,createdAt:se,updatedAt:se},je=Vs("create","arrangement",xe);S("create","arrangement",xe,je),r(X=>(setTimeout(()=>{w(je),oe(fe)},0),{...X,arrangements:[...X.arrangements,xe]}))}),[S,w]),ye=J.useCallback((M,oe)=>new Promise(se=>{const fe=Vs("update","arrangement",{id:M,...oe});r(xe=>{const je={...oe,id:M,updatedAt:new Date().toISOString()};S("update","arrangement",je,fe);const X=xe.arrangements.map(Ke=>Ke.id===M?{...Ke,...oe,updatedAt:new Date().toISOString()}:Ke);return setTimeout(()=>{w(fe),se()},0),{...xe,arrangements:X}})}),[S,w]),he=J.useCallback(M=>new Promise(oe=>{r(se=>{const fe=se.arrangements.find(X=>X.id===M);if(!fe)return oe(),se;const xe=Vs("delete","arrangement",fe);S("delete","arrangement",{id:M},xe);const je=se.arrangements.filter(X=>X.id!==M);return setTimeout(()=>{w(xe),oe()},0),{...se,arrangements:je}})}),[S,w]),le=J.useCallback(M=>{r(oe=>({...oe,subscription:M}))},[]),j=J.useCallback(M=>{r(oe=>({...oe,reminderSettings:M}))},[]),H=J.useCallback(M=>{r(oe=>({...oe,bonusSettings:M}))},[]),O=J.useCallback((M,oe,se)=>{r(fe=>({...fe,reminderNotifications:nS(fe.reminderNotifications||[],M,oe,se)}))},[]),ne=J.useCallback(()=>{r(M=>{const oe=rS(M),se=aS(oe,M.arrangements);return{...M,reminderNotifications:se,lastReminderProcessed:new Date().toISOString()}})},[]);J.useEffect(()=>{const M=setInterval(()=>{s||ne()},6e4);return()=>clearInterval(M)},[s,ne]);function Y(M){return M&&typeof M=="object"&&Array.isArray(M.addresses)&&Array.isArray(M.completions)&&"activeIndex"in M&&Array.isArray(M.daySessions)}const F=J.useCallback(()=>({addresses:t.addresses,completions:t.completions,activeIndex:t.activeIndex,daySessions:t.daySessions,arrangements:t.arrangements,currentListVersion:t.currentListVersion}),[t]),U=J.useCallback(async(M,oe="replace")=>{if(!Y(M))throw console.error("🚨 RESTORE VALIDATION FAILED:",{hasObj:!!M,type:typeof M,hasAddresses:M&&Array.isArray(M.addresses),hasCompletions:M&&Array.isArray(M.completions),hasActiveIndex:M&&"activeIndex"in M,hasDaySessions:M&&Array.isArray(M.daySessions),objKeys:M?Object.keys(M):null}),new Error("Invalid backup file format");const se=typeof M.currentListVersion=="number"?M.currentListVersion:1,fe=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),xe="ontouchstart"in window||navigator.maxTouchPoints>0;console.log("📁 RESTORE DATA ANALYSIS:",{addressCount:M.addresses.length,completionCount:M.completions.length,arrangementCount:M.arrangements?.length||0,daySessionCount:M.daySessions?.length||0,activeIndex:M.activeIndex,listVersion:se,mergeStrategy:oe,isMobile:fe,isTouch:xe,userAgent:navigator.userAgent.substring(0,50)});const je={addresses:M.addresses,completions:hx(M.completions,se),activeIndex:M.activeIndex??null,daySessions:M.daySessions??[],arrangements:M.arrangements??[],currentListVersion:se};console.log("📁 RESTORED STATE PREPARED:",{addressCount:je.addresses.length,completionCount:je.completions.length,arrangementCount:je.arrangements.length,daySessionCount:je.daySessions.length,activeIndex:je.activeIndex,listVersion:je.currentListVersion}),r(oe==="merge"?X=>({addresses:je.currentListVersion>=X.currentListVersion?je.addresses:X.addresses,currentListVersion:Math.max(je.currentListVersion,X.currentListVersion),completions:[...X.completions,...je.completions.filter(Xe=>!X.completions.some(Qe=>Qe.timestamp===Xe.timestamp&&Qe.index===Xe.index&&Qe.outcome===Xe.outcome))].sort((Xe,Qe)=>new Date(Qe.timestamp).getTime()-new Date(Xe.timestamp).getTime()),arrangements:Array.from(new Map([...X.arrangements.map(Xe=>[Xe.id,Xe]),...je.arrangements.map(Xe=>[Xe.id,Xe])].sort(([,Xe],[,Qe])=>new Date(Qe.updatedAt).getTime()-new Date(Xe.updatedAt).getTime())).values()),daySessions:Array.from(new Map([...X.daySessions.map(Xe=>[Xe.date,Xe]),...je.daySessions.map(Xe=>[Xe.date,Xe])]).values()),activeIndex:je.activeIndex??X.activeIndex}):je),P();try{const X={...je,_schemaVersion:jo};if(console.log("💾 PERSISTING RESTORED STATE:",{addressCount:X.addresses.length,completionCount:X.completions.length,arrangementCount:X.arrangements.length,daySessionCount:X.daySessions.length,activeIndex:X.activeIndex,listVersion:X.currentListVersion,schemaVersion:X._schemaVersion}),"storage"in navigator&&"persist"in navigator.storage)try{const Qe=await navigator.storage.persist();console.log("📱 PERSISTENT STORAGE:",Qe?"GRANTED":"DENIED")}catch(Qe){console.warn("📱 PERSISTENT STORAGE REQUEST FAILED:",Qe)}if(await hu.queuedSet(vu,X),console.log("✅ RESTORED STATE PERSISTED TO INDEXEDDB"),"storage"in navigator&&"estimate"in navigator.storage)try{const Qe=await navigator.storage.estimate(),it=Qe.usage&&Qe.quota?Math.round(Qe.usage/Qe.quota*100):"unknown";console.log("📊 STORAGE QUOTA:",{used:Qe.usage?`${Math.round(Qe.usage/1024/1024)}MB`:"unknown",total:Qe.quota?`${Math.round(Qe.quota/1024/1024)}MB`:"unknown",percentUsed:`${it}%`})}catch(Qe){console.warn("📊 STORAGE QUOTA CHECK FAILED:",Qe)}const Ke=await hu.queuedGet(vu);console.log("🔍 VERIFICATION READ FROM INDEXEDDB:",{success:!!Ke,addressCount:Ke?.addresses?.length||0,completionCount:Ke?.completions?.length||0,arrangementCount:Ke?.arrangements?.length||0});const Xe=Date.now();localStorage.setItem("navigator_restore_in_progress",Xe.toString()),console.log("🛡️ RESTORE PROTECTION ACTIVATED:",new Date(Xe).toISOString()),localStorage.setItem("navigator_last_restore",Xe.toString())}catch(X){throw ve.error("Failed to persist restored state:",X),new Error("Restore failed: Could not save data")}},[P]),z=J.useCallback(M=>{const oe=localStorage.getItem("navigator_last_restore");if(oe){const se=Date.now()-parseInt(oe);se<36e5&&console.log("⚠️ STATE CHANGE AFTER RESTORE:",{timeSinceRestore:`${Math.round(se/1e3)}s`,newStateType:typeof M,isFunction:typeof M=="function",timestamp:new Date().toISOString()})}r(se=>{const fe=typeof M=="function"?M(se):M,xe=[...fe.completions];let je=!1;const X=Date.now()-3e4;for(const[Qe,it]of ee.current.entries())it.timestamp<X&&ee.current.delete(Qe);for(const[Qe,it]of ee.current.entries()){const{completion:Le,timestamp:kt}=it;Date.now()-kt<3e4&&(xe.some(pt=>pt.index===Le.index&&pt.outcome===Le.outcome&&pt.listVersion===Le.listVersion&&Math.abs(new Date(pt.timestamp).getTime()-new Date(Le.timestamp).getTime())<1e3)||(ve.info(`🛡️ PROTECTING RECENT COMPLETION: index=${Le.index}, outcome=${Le.outcome}`),xe.unshift(Le),je=!0))}let Ke=je?{...fe,completions:xe.sort((Qe,it)=>new Date(it.timestamp).getTime()-new Date(Qe.timestamp).getTime())}:fe;if(Ke.activeIndex!==null&&typeof Ke.activeIndex=="number"){const Qe=Ke.addresses[Ke.activeIndex];Qe?Ke.completions.some(Le=>Le.address===Qe.address&&(Le.listVersion||Ke.currentListVersion)===Ke.currentListVersion)&&(ve.info(`🔄 CLEARING ACTIVE INDEX: Address "${Qe.address}" was completed on another device`),kk(`Address "${Qe.address}" was completed on another device`),Ke={...Ke,activeIndex:null,activeStartTime:null}):(ve.warn(`🔄 CLEARING INVALID activeIndex: Index ${Ke.activeIndex} is out of bounds (max: ${Ke.addresses.length-1})`),Ke={...Ke,activeIndex:null,activeStartTime:null})}const Xe=new Map;return Ke.completions.forEach(Qe=>{const it=se.completions.find(Le=>Le.index===Qe.index&&Le.outcome===Qe.outcome&&Math.abs(new Date(Le.timestamp).getTime()-new Date(Qe.timestamp).getTime())<5e3);it&&it.timestamp!==Qe.timestamp&&Xe.set(`completion_${Qe.timestamp}`,{type:"completion",incoming:Qe,existing:it,resolution:"prefer_incoming"})}),Ke.arrangements.forEach(Qe=>{const it=se.arrangements.find(Le=>Le.id===Qe.id);if(it&&it.updatedAt!==Qe.updatedAt){const Le=new Date(Qe.updatedAt).getTime(),kt=new Date(it.updatedAt).getTime();Xe.set(`arrangement_${Qe.id}`,{type:"arrangement",incoming:Qe,existing:it,resolution:Le>kt?"prefer_incoming":"prefer_existing"})}}),Xe.size>0&&(ve.debug("Detected state conflicts:",Xe.size),y(Xe)),Ke}),P()},[P]),q=J.useCallback((M,oe,se,fe)=>S(oe,M,se,fe),[S]);return{state:p,baseState:t,loading:s,setState:z,setBaseState:r,deviceId:u,enqueueOp:q,ownerMetadata:_,optimisticUpdates:n.updates,pendingOperations:n.pendingOperations,confirmOptimisticUpdate:w,revertOptimisticUpdate:E,clearOptimisticUpdates:P,conflicts:g,resolveConflict:(M,oe)=>{y(se=>{const fe=new Map(se);return fe.delete(M),fe})},setAddresses:I,addAddress:A,setActive:R,cancelActive:K,complete:re,undo:pe,startDay:ue,endDay:ce,addArrangement:Ce,updateArrangement:ye,deleteArrangement:he,setSubscription:le,backupState:F,restoreState:U,updateReminderSettings:j,updateReminderNotification:O,processReminders:ne,updateBonusSettings:H}}function Vf(e){const t=e??{},r=typeof t.currentListVersion=="number"?t.currentListVersion:1;return{...t,addresses:Array.isArray(t.addresses)?t.addresses:[],completions:Array.isArray(t.completions)?t.completions:[],arrangements:Array.isArray(t.arrangements)?t.arrangements:[],daySessions:Array.isArray(t.daySessions)?t.daySessions:[],activeIndex:typeof t.activeIndex=="number"?t.activeIndex:null,currentListVersion:r}}function sm(e){const t=e??{};return{addresses:Array.isArray(t.addresses)?t.addresses:[],completions:Array.isArray(t.completions)?t.completions:[],arrangements:Array.isArray(t.arrangements)?t.arrangements:[],activeIndex:typeof t.activeIndex=="number"?t.activeIndex:null,currentListVersion:typeof t.currentListVersion=="number"?t.currentListVersion:1}}function $o(e){const t=a=>{if(!a||typeof a!="object"||Array.isArray(a))return!1;const s=Object.getPrototypeOf(a);return s===Object.prototype||s===null},r=JSON.stringify(e,(a,s)=>{if(!s||typeof s!="object")return s;if(s instanceof Date)return s.toISOString();if(typeof s.toJSON=="function"&&!t(s))return s.toJSON(a);if(t(s)){const l={};return Object.keys(s).sort().forEach(u=>{l[u]=s[u]}),l}return s});let n=0;for(let a=0;a<r.length;a++){const s=r.charCodeAt(a);n=(n<<5)-n+s,n=n&n}return n.toString()}class wi{static generateDeviceFingerprint(){try{const t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.hardwareConcurrency||"unknown"];return`device_${btoa(t.join("|")).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}_${Date.now()}`}catch{return`device_fallback_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}}static analyzeDataOwnership(t,r,n,a){const s={hasLocalData:this.hasSignificantLocalData(t),hasCloudData:n?this.hasSignificantLocalData(n):!1,localDataAge:this.estimateDataAge(t),userInLocalData:this.findUserSignalsInData(t,r,a),cloudUserMatch:n?this.findUserSignalsInData(n,r):null,hasOwnerSignature:!!a?.ownerUserId,signatureMatches:a?.ownerUserId===r.id};return ve.info("User detection signals:",s),s.hasOwnerSignature?s.signatureMatches?{isOwner:!0,confidence:"high",reason:"Owner signature matches current user",action:"sync"}:{isOwner:!1,confidence:"high",reason:"Owner signature belongs to different user",action:"backup_and_clear"}:s.hasCloudData&&s.cloudUserMatch?s.hasLocalData?s.userInLocalData?{isOwner:!0,confidence:"high",reason:"Both local and cloud data belong to user",action:"sync"}:{isOwner:!0,confidence:"medium",reason:"Cloud data belongs to user, local data unclear",action:"preserve_and_ask"}:{isOwner:!0,confidence:"high",reason:"Cloud data exists for user, no local conflict",action:"sync"}:s.hasLocalData&&s.userInLocalData?{isOwner:!0,confidence:"medium",reason:"Local data appears to belong to current user",action:"sync"}:s.hasLocalData&&!s.userInLocalData&&!s.hasCloudData?{isOwner:!1,confidence:"low",reason:"Local data has no user identification",action:"preserve_and_ask"}:{isOwner:!0,confidence:"low",reason:"Unclear ownership - preserving data for safety",action:"preserve_and_ask"}}static hasSignificantLocalData(t){const r=Array.isArray(t.addresses)?t.addresses.length:0,n=Array.isArray(t.completions)?t.completions.length:0,a=Array.isArray(t.arrangements)?t.arrangements.length:0;return r>5||n>0||a>0}static estimateDataAge(t){try{const r=Array.isArray(t.completions)?t.completions:[],n=Array.isArray(t.arrangements)?t.arrangements:[],a=[...r.map(u=>u.timestamp),...n.map(u=>u.updatedAt||u.createdAt)].filter(Boolean);if(a.length===0)return"unknown";const s=Math.max(...a.map(u=>new Date(u).getTime())),l=(Date.now()-s)/(1e3*60*60);return l<24?"recent":(l<168,"old")}catch{return"unknown"}}static findUserSignalsInData(t,r,n){try{if(n?.ownerUserId){const l=n.ownerUserId===r.id;return ve.info(`Owner signature check: ${l?"MATCH":"MISMATCH"}`,{stored:n.ownerUserId,current:r.id}),l}ve.warn("No owner signature found - using legacy heuristics (less reliable)");const a=Array.isArray(t.arrangements)?t.arrangements:[],s=r.email?.toLowerCase();return!!(s&&a.some(u=>u.customerName?.toLowerCase().includes(s)||u.notes?.toLowerCase().includes(s)))}catch{return!1}}static storeDeviceContext(t){try{const r={userId:t.id,email:t.email||void 0,deviceId:this.generateDeviceFingerprint(),sessionStart:new Date().toISOString()};localStorage.setItem("navigator_device_context",JSON.stringify(r));const n=$o(r);localStorage.setItem("navigator_device_context_checksum",n),ve.info("Device context stored:",{userId:r.userId,deviceId:r.deviceId})}catch(r){ve.error("Failed to store device context:",r)}}static getDeviceContext(){try{const t=localStorage.getItem("navigator_device_context"),r=localStorage.getItem("navigator_device_context_checksum");if(!t)return null;const n=JSON.parse(t);return r&&$o(n)!==r?(ve.warn("Device context checksum mismatch - data may be corrupted"),null):n}catch(t){return ve.error("Failed to get device context:",t),null}}static clearDeviceContext(){try{localStorage.removeItem("navigator_device_context"),localStorage.removeItem("navigator_device_context_checksum")}catch(t){ve.error("Failed to clear device context:",t)}}}const xS=Object.freeze(Object.defineProperty({__proto__:null,SmartUserDetection:wi},Symbol.toStringTag,{value:"Module"})),yS=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>si(async()=>{const{default:n}=await Promise.resolve().then(()=>bc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class hp extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class _S extends hp{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class px extends hp{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class gx extends hp{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(jm||(jm={}));var wS=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function u(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(u,m)}p((n=n.apply(e,t||[])).next())})};class bS{constructor(t,{headers:r={},customFetch:n,region:a=jm.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=yS(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return wS(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:l}=r;let u={},{region:m}=r;m||(m=this.region);const p=new URL(`${this.url}/${t}`);m&&m!=="any"&&(u["x-region"]=m,p.searchParams.set("forceFunctionRegion",m));let g;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(u["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(u["Content-Type"]="application/json",g=JSON.stringify(l)));const y=yield this.fetch(p.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),a),body:g}).catch(w=>{throw new _S(w)}),_=y.headers.get("x-relay-error");if(_&&_==="true")throw new px(y);if(!y.ok)throw new gx(y);let T=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),S;return T==="application/json"?S=yield y.json():T==="application/octet-stream"?S=yield y.blob():T==="text/event-stream"?S=y:T==="multipart/form-data"?S=yield y.formData():S=yield y.text(),{data:S,error:null,response:y}}catch(a){return{data:null,error:a,response:a instanceof gx||a instanceof px?a.context:void 0}}})}}var Jr={},Kl={},Yl={},ql={},Xl={},Jl={},kS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},xc=kS();const SS=xc.fetch,Sy=xc.fetch.bind(xc),Ty=xc.Headers,TS=xc.Request,ES=xc.Response,bc=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ty,Request:TS,Response:ES,default:Sy,fetch:SS},Symbol.toStringTag,{value:"Module"})),CS=ok(bc);var Sf={},vx;function Ey(){if(vx)return Sf;vx=1,Object.defineProperty(Sf,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Sf.default=e,Sf}var xx;function Cy(){if(xx)return Jl;xx=1;var e=Jl&&Jl.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Jl,"__esModule",{value:!0});const t=e(CS),r=e(Ey());class n{constructor(s){var l,u;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(l=s.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=s.signal,this.isMaybeSingle=(u=s.isMaybeSingle)!==null&&u!==void 0?u:!1,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,l){return this.headers=new Headers(this.headers),this.headers.set(s,l),this}then(s,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const u=this.fetch;let m=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var g,y,_,T;let S=null,w=null,E=null,P=p.status,I=p.statusText;if(p.ok){if(this.method!=="HEAD"){const W=await p.text();W===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((g=this.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?w=W:w=JSON.parse(W))}const R=(y=this.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),K=(_=p.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");R&&K&&K.length>1&&(E=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(S={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,E=null,P=406,I="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const R=await p.text();try{S=JSON.parse(R),Array.isArray(S)&&p.status===404&&(w=[],S=null,P=200,I="OK")}catch{p.status===404&&R===""?(P=204,I="No Content"):S={message:R}}if(S&&this.isMaybeSingle&&(!((T=S?.details)===null||T===void 0)&&T.includes("0 rows"))&&(S=null,P=200,I="OK"),S&&this.shouldThrowOnError)throw new r.default(S)}return{error:S,data:w,count:E,status:P,statusText:I}});return this.shouldThrowOnError||(m=m.catch(p=>{var g,y,_;return{error:{message:`${(g=p?.name)!==null&&g!==void 0?g:"FetchError"}: ${p?.message}`,details:`${(y=p?.stack)!==null&&y!==void 0?y:""}`,hint:"",code:`${(_=p?.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),m.then(s,l)}returns(){return this}overrideTypes(){return this}}return Jl.default=n,Jl}var yx;function Ay(){if(yx)return Xl;yx=1;var e=Xl&&Xl.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Xl,"__esModule",{value:!0});const t=e(Cy());class r extends t.default{select(a){let s=!1;const l=(a??"*").split("").map(u=>/\s/.test(u)&&!s?"":(u==='"'&&(s=!s),u)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:s=!0,nullsFirst:l,foreignTable:u,referencedTable:m=u}={}){const p=m?`${m}.order`:"order",g=this.url.searchParams.get(p);return this.url.searchParams.set(p,`${g?`${g},`:""}${a}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:s,referencedTable:l=s}={}){const u=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(u,`${a}`),this}range(a,s,{foreignTable:l,referencedTable:u=l}={}){const m=typeof u>"u"?"offset":`${u}.offset`,p=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(m,`${a}`),this.url.searchParams.set(p,`${s-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:s=!1,settings:l=!1,buffers:u=!1,wal:m=!1,format:p="text"}={}){var g;const y=[a?"analyze":null,s?"verbose":null,l?"settings":null,u?"buffers":null,m?"wal":null].filter(Boolean).join("|"),_=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${p}; for="${_}"; options=${y};`),p==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return Xl.default=r,Xl}var _x;function mp(){if(_x)return ql;_x=1;var e=ql&&ql.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ql,"__esModule",{value:!0});const t=e(Ay());class r extends t.default{eq(a,s){return this.url.searchParams.append(a,`eq.${s}`),this}neq(a,s){return this.url.searchParams.append(a,`neq.${s}`),this}gt(a,s){return this.url.searchParams.append(a,`gt.${s}`),this}gte(a,s){return this.url.searchParams.append(a,`gte.${s}`),this}lt(a,s){return this.url.searchParams.append(a,`lt.${s}`),this}lte(a,s){return this.url.searchParams.append(a,`lte.${s}`),this}like(a,s){return this.url.searchParams.append(a,`like.${s}`),this}likeAllOf(a,s){return this.url.searchParams.append(a,`like(all).{${s.join(",")}}`),this}likeAnyOf(a,s){return this.url.searchParams.append(a,`like(any).{${s.join(",")}}`),this}ilike(a,s){return this.url.searchParams.append(a,`ilike.${s}`),this}ilikeAllOf(a,s){return this.url.searchParams.append(a,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(a,s){return this.url.searchParams.append(a,`ilike(any).{${s.join(",")}}`),this}is(a,s){return this.url.searchParams.append(a,`is.${s}`),this}in(a,s){const l=Array.from(new Set(s)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cs.{${s.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(s)}`),this}containedBy(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cd.{${s.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(s)}`),this}rangeGt(a,s){return this.url.searchParams.append(a,`sr.${s}`),this}rangeGte(a,s){return this.url.searchParams.append(a,`nxl.${s}`),this}rangeLt(a,s){return this.url.searchParams.append(a,`sl.${s}`),this}rangeLte(a,s){return this.url.searchParams.append(a,`nxr.${s}`),this}rangeAdjacent(a,s){return this.url.searchParams.append(a,`adj.${s}`),this}overlaps(a,s){return typeof s=="string"?this.url.searchParams.append(a,`ov.${s}`):this.url.searchParams.append(a,`ov.{${s.join(",")}}`),this}textSearch(a,s,{config:l,type:u}={}){let m="";u==="plain"?m="pl":u==="phrase"?m="ph":u==="websearch"&&(m="w");const p=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${m}fts${p}.${s}`),this}match(a){return Object.entries(a).forEach(([s,l])=>{this.url.searchParams.append(s,`eq.${l}`)}),this}not(a,s,l){return this.url.searchParams.append(a,`not.${s}.${l}`),this}or(a,{foreignTable:s,referencedTable:l=s}={}){const u=l?`${l}.or`:"or";return this.url.searchParams.append(u,`(${a})`),this}filter(a,s,l){return this.url.searchParams.append(a,`${s}.${l}`),this}}return ql.default=r,ql}var wx;function Ny(){if(wx)return Yl;wx=1;var e=Yl&&Yl.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Yl,"__esModule",{value:!0});const t=e(mp());class r{constructor(a,{headers:s={},schema:l,fetch:u}){this.url=a,this.headers=new Headers(s),this.schema=l,this.fetch=u}select(a,{head:s=!1,count:l}={}){const u=s?"HEAD":"GET";let m=!1;const p=(a??"*").split("").map(g=>/\s/.test(g)&&!m?"":(g==='"'&&(m=!m),g)).join("");return this.url.searchParams.set("select",p),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:s,defaultToNull:l=!0}={}){var u;const m="POST";if(s&&this.headers.append("Prefer",`count=${s}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const p=a.reduce((g,y)=>g.concat(Object.keys(y)),[]);if(p.length>0){const g=[...new Set(p)].map(y=>`"${y}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(a,{onConflict:s,ignoreDuplicates:l=!1,count:u,defaultToNull:m=!0}={}){var p;const g="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),u&&this.headers.append("Prefer",`count=${u}`),m||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const y=a.reduce((_,T)=>_.concat(Object.keys(T)),[]);if(y.length>0){const _=[...new Set(y)].map(T=>`"${T}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}update(a,{count:s}={}){var l;const u="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:a}={}){var s;const l="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return Yl.default=r,Yl}var bx;function AS(){if(bx)return Kl;bx=1;var e=Kl&&Kl.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Kl,"__esModule",{value:!0});const t=e(Ny()),r=e(mp());class n{constructor(s,{headers:l={},schema:u,fetch:m}={}){this.url=s,this.headers=new Headers(l),this.schemaName=u,this.fetch=m}from(s){const l=new URL(`${this.url}/${s}`);return new t.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,l={},{head:u=!1,get:m=!1,count:p}={}){var g;let y;const _=new URL(`${this.url}/rpc/${s}`);let T;u||m?(y=u?"HEAD":"GET",Object.entries(l).filter(([w,E])=>E!==void 0).map(([w,E])=>[w,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([w,E])=>{_.searchParams.append(w,E)})):(y="POST",T=l);const S=new Headers(this.headers);return p&&S.set("Prefer",`count=${p}`),new r.default({method:y,url:_,headers:S,schema:this.schemaName,body:T,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}}return Kl.default=n,Kl}var kx;function NS(){if(kx)return Jr;kx=1;var e=Jr&&Jr.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.PostgrestError=Jr.PostgrestBuilder=Jr.PostgrestTransformBuilder=Jr.PostgrestFilterBuilder=Jr.PostgrestQueryBuilder=Jr.PostgrestClient=void 0;const t=e(AS());Jr.PostgrestClient=t.default;const r=e(Ny());Jr.PostgrestQueryBuilder=r.default;const n=e(mp());Jr.PostgrestFilterBuilder=n.default;const a=e(Ay());Jr.PostgrestTransformBuilder=a.default;const s=e(Cy());Jr.PostgrestBuilder=s.default;const l=e(Ey());return Jr.PostgrestError=l.default,Jr.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:s.default,PostgrestError:l.default},Jr}var PS=NS();const IS=hh(PS),{PostgrestClient:DS,PostgrestQueryBuilder:xL,PostgrestFilterBuilder:yL,PostgrestTransformBuilder:_L,PostgrestBuilder:wL,PostgrestError:bL}=IS;class FS{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const jS="2.15.1",OS=`realtime-js/${jS}`,RS="1.0.0",Om=1e4,LS=1e3,MS=100;var Eu;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Eu||(Eu={}));var Vr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Vr||(Vr={}));var ti;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ti||(ti={}));var Rm;(function(e){e.websocket="websocket"})(Rm||(Rm={}));var zo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(zo||(zo={}));class BS{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let l=this.HEADER_LENGTH+2;const u=n.decode(t.slice(l,l+a));l=l+a;const m=n.decode(t.slice(l,l+s));l=l+s;const p=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{ref:null,topic:u,event:m,payload:p}}}class Py{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var or;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(or||(or={}));const Sx=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,l)=>(s[l]=zS(l,e,t,a),s),{})},zS=(e,t,r,n)=>{const a=t.find(u=>u.name===e),s=a?.type,l=r[e];return s&&!n.includes(s)?Iy(s,l):Lm(l)},Iy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return HS(t,r)}switch(e){case or.bool:return US(t);case or.float4:case or.float8:case or.int2:case or.int4:case or.int8:case or.numeric:case or.oid:return WS(t);case or.json:case or.jsonb:return $S(t);case or.timestamp:return VS(t);case or.abstime:case or.date:case or.daterange:case or.int4range:case or.int8range:case or.money:case or.reltime:case or.text:case or.time:case or.timestamptz:case or.timetz:case or.tsrange:case or.tstzrange:return Lm(t);default:return Lm(t)}},Lm=e=>e,US=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},WS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},$S=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},HS=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const l=e.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(u=>Iy(t,u))}return e},VS=e=>typeof e=="string"?e.replace(" ","T"):e,Dy=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class om{constructor(t,r,n={},a=Om){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Tx;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Tx||(Tx={}));class Cu{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:l,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Cu.syncState(this.state,a,s,l),this.pendingDiffs.forEach(m=>{this.state=Cu.syncDiff(this.state,m,s,l)}),this.pendingDiffs=[],u()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:l,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Cu.syncDiff(this.state,a,s,l),u())}),this.onJoin((a,s,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:l})}),this.onLeave((a,s,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),l=this.transformState(r),u={},m={};return this.map(s,(p,g)=>{l[p]||(m[p]=g)}),this.map(l,(p,g)=>{const y=s[p];if(y){const _=g.map(E=>E.presence_ref),T=y.map(E=>E.presence_ref),S=g.filter(E=>T.indexOf(E.presence_ref)<0),w=y.filter(E=>_.indexOf(E.presence_ref)<0);S.length>0&&(u[p]=S),w.length>0&&(m[p]=w)}else u[p]=g}),this.syncDiff(s,{joins:u,leaves:m},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(u,m)=>{var p;const g=(p=t[u])!==null&&p!==void 0?p:[];if(t[u]=this.cloneDeep(m),g.length>0){const y=t[u].map(T=>T.presence_ref),_=g.filter(T=>y.indexOf(T.presence_ref)<0);t[u].unshift(..._)}n(u,g,m)}),this.map(l,(u,m)=>{let p=t[u];if(!p)return;const g=m.map(y=>y.presence_ref);p=p.filter(y=>g.indexOf(y.presence_ref)<0),t[u]=p,a(u,p,m),p.length===0&&delete t[u]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Ex;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Ex||(Ex={}));var Au;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Au||(Au={}));var Qi;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Qi||(Qi={}));class pp{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Vr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new om(this,ti.join,this.params,this.timeout),this.rejoinTimer=new Py(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Vr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Vr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ti.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new Cu(this),this.broadcastEndpointURL=Dy(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Vr.closed){const{config:{broadcast:s,presence:l,private:u}}=this.params,m=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(_=>_.filter))!==null&&a!==void 0?a:[],p=!!this.bindings[Au.PRESENCE]&&this.bindings[Au.PRESENCE].length>0,g={},y={broadcast:s,presence:Object.assign(Object.assign({},l),{enabled:p}),postgres_changes:m,private:u};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(_=>t?.(Qi.CHANNEL_ERROR,_)),this._onClose(()=>t?.(Qi.CLOSED)),this.updateJoinPayload(Object.assign({config:y},g)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var T;if(this.socket.setAuth(),_===void 0){t?.(Qi.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,w=(T=S?.length)!==null&&T!==void 0?T:0,E=[];for(let P=0;P<w;P++){const I=S[P],{filter:{event:A,schema:R,table:K,filter:W}}=I,D=_&&_[P];if(D&&D.event===A&&D.schema===R&&D.table===K&&D.filter===W)E.push(Object.assign(Object.assign({},I),{id:D.id}));else{this.unsubscribe(),this.state=Vr.errored,t?.(Qi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,t&&t(Qi.SUBSCRIBED);return}}).receive("error",_=>{this.state=Vr.errored,t?.(Qi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t?.(Qi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Vr.joined&&t===Au.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:l}=t,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=p.body)===null||a===void 0?void 0:a.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,u,m;const p=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((m=(u=(l=this.params)===null||l===void 0?void 0:l.config)===null||u===void 0?void 0:u.broadcast)===null||m===void 0)&&m.ack)&&s("ok"),p.receive("ok",()=>s("ok")),p.receive("error",()=>s("error")),p.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Vr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ti.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new om(this,ti.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Vr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new om(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>MS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const l=t.toLocaleLowerCase(),{close:u,error:m,leave:p,join:g}=ti;if(n&&[u,m,p,g].indexOf(l)>=0&&n!==this._joinRef())return;let _=this._onMessage(l,r,n);if(r&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(T=>{var S,w,E;return((S=T.filter)===null||S===void 0?void 0:S.event)==="*"||((E=(w=T.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===l}).map(T=>T.callback(_,n)):(s=this.bindings[l])===null||s===void 0||s.filter(T=>{var S,w,E,P,I,A;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in T){const R=T.id,K=(S=T.filter)===null||S===void 0?void 0:S.event;return R&&((w=r.ids)===null||w===void 0?void 0:w.includes(R))&&(K==="*"||K?.toLocaleLowerCase()===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const R=(I=(P=T?.filter)===null||P===void 0?void 0:P.event)===null||I===void 0?void 0:I.toLocaleLowerCase();return R==="*"||R===((A=r?.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===l}).map(T=>{if(typeof _=="object"&&"ids"in _){const S=_.data,{schema:w,table:E,commit_timestamp:P,type:I,errors:A}=S;_=Object.assign(Object.assign({},{schema:w,table:E,commit_timestamp:P,eventType:I,new:{},old:{},errors:A}),this._getPayloadRecords(S))}T.callback(_,n)})}_isClosed(){return this.state===Vr.closed}_isJoined(){return this.state===Vr.joined}_isJoining(){return this.state===Vr.joining}_isLeaving(){return this.state===Vr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&pp.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ti.close,{},t)}_onError(t){this._on(ti.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Sx(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Sx(t.columns,t.old_record)),r}}const Cx=()=>{},Tf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},GS=[1e3,2e3,5e3,1e4],ZS=1e4,KS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class YS{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Om,this.transport=null,this.heartbeatIntervalMs=Tf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Cx,this.ref=0,this.reconnectTimer=null,this.logger=Cx,this.conn=null,this.sendBuffer=[],this.serializer=new BS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...l)=>si(async()=>{const{default:u}=await Promise.resolve().then(()=>bc);return{default:u}},void 0).then(({default:u})=>u(...l)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...l)=>s(...l)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Rm.websocket}`,this.httpEndpoint=Dy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=FS.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:RS}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Eu.connecting:return zo.Connecting;case Eu.open:return zo.Open;case Eu.closing:return zo.Closing;default:return zo.Closed}}isConnected(){return this.connectionState()===zo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new pp(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,l=()=>{this.encode(t,u=>{var m;(m=this.conn)===null||m===void 0||m.send(u)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(LS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Tf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:l}=r,u=l?`(${l})`:"",m=s.status||"";this.log("receive",`${m} ${n} ${a} ${u}`.trim(),s),this.channels.filter(p=>p._isMember(n)).forEach(p=>p._trigger(a,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ti.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([KS],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:OS};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(ti.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Py(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Tf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,l,u,m,p;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Om,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:Tf.HEARTBEAT_INTERVAL,this.worker=(s=t?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=t?.accessToken)!==null&&l!==void 0?l:null,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t?.reconnectAfterMs)!==null&&u!==void 0?u:(g=>GS[g-1]||ZS),this.encode=(m=t?.encode)!==null&&m!==void 0?m:((g,y)=>y(JSON.stringify(g))),this.decode=(p=t?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class gp extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Gr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class qS extends gp{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Mm extends gp{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var XS=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function u(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(u,m)}p((n=n.apply(e,t||[])).next())})};const Fy=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>si(async()=>{const{default:n}=await Promise.resolve().then(()=>bc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},JS=()=>XS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield si(()=>Promise.resolve().then(()=>bc),void 0)).Response:Response}),Bm=e=>{if(Array.isArray(e))return e.map(r=>Bm(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Bm(n)}),t},QS=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var rl=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function u(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(u,m)}p((n=n.apply(e,t||[])).next())})};const lm=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),eT=(e,t,r)=>rl(void 0,void 0,void 0,function*(){const n=yield JS();e instanceof n&&!r?.noResolveJson?e.json().then(a=>{const s=e.status||500,l=a?.statusCode||s+"";t(new qS(lm(a),s,l))}).catch(a=>{t(new Mm(lm(a),a))}):t(new Mm(lm(e),e))}),tT=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"||!n?a:(QS(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(n)):a.body=n,t?.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function ad(e,t,r,n,a,s){return rl(this,void 0,void 0,function*(){return new Promise((l,u)=>{e(r,tT(t,n,a,s)).then(m=>{if(!m.ok)throw m;return n?.noResolveJson?m:m.json()}).then(m=>l(m)).catch(m=>eT(m,u,n))})})}function Jf(e,t,r,n){return rl(this,void 0,void 0,function*(){return ad(e,"GET",t,r,n)})}function Si(e,t,r,n,a){return rl(this,void 0,void 0,function*(){return ad(e,"POST",t,n,a,r)})}function zm(e,t,r,n,a){return rl(this,void 0,void 0,function*(){return ad(e,"PUT",t,n,a,r)})}function rT(e,t,r,n){return rl(this,void 0,void 0,function*(){return ad(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function jy(e,t,r,n,a){return rl(this,void 0,void 0,function*(){return ad(e,"DELETE",t,n,a,r)})}var jn=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function u(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(u,m)}p((n=n.apply(e,t||[])).next())})};const nT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ax={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class aT{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Fy(a)}uploadOrUpdate(t,r,n,a){return jn(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},Ax),a);let u=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const m=l.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),m&&s.append("metadata",this.encodeMetadata(m)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",l.cacheControl),m&&s.append("metadata",this.encodeMetadata(m))):(s=n,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType,m&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),a?.headers&&(u=Object.assign(Object.assign({},u),a.headers));const p=this._removeEmptyFolders(r),g=this._getFinalPath(p),y=yield(t=="PUT"?zm:Si)(this.fetch,`${this.url}/object/${g}`,s,Object.assign({headers:u},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:p,id:y.Id,fullPath:y.Key},error:null}}catch(s){if(Gr(s))return{data:null,error:s};throw s}})}upload(t,r,n){return jn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return jn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),l=this._getFinalPath(s),u=new URL(this.url+`/object/upload/sign/${l}`);u.searchParams.set("token",r);try{let m;const p=Object.assign({upsert:Ax.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&n instanceof Blob?(m=new FormData,m.append("cacheControl",p.cacheControl),m.append("",n)):typeof FormData<"u"&&n instanceof FormData?(m=n,m.append("cacheControl",p.cacheControl)):(m=n,g["cache-control"]=`max-age=${p.cacheControl}`,g["content-type"]=p.contentType);const y=yield zm(this.fetch,u.toString(),m,{headers:g});return{data:{path:s,fullPath:y.Key},error:null}}catch(m){if(Gr(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(t,r){return jn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r?.upsert&&(a["x-upsert"]="true");const s=yield Si(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),l=new URL(this.url+s.url),u=l.searchParams.get("token");if(!u)throw new gp("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:u},error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}update(t,r,n){return jn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return jn(this,void 0,void 0,function*(){try{return{data:yield Si(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}copy(t,r,n){return jn(this,void 0,void 0,function*(){try{return{data:{path:(yield Si(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return jn(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Si(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return jn(this,void 0,void 0,function*(){try{const a=yield Si(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}download(t,r){return jn(this,void 0,void 0,function*(){const a=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),l=s?`?${s}`:"";try{const u=this._getFinalPath(t);return{data:yield(yield Jf(this.fetch,`${this.url}/${a}/${u}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(Gr(u))return{data:null,error:u};throw u}})}info(t){return jn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Jf(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Bm(n),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}exists(t){return jn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield rT(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Gr(n)&&n instanceof Mm){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const u=typeof r?.transform<"u"?"render/image":"object",m=this.transformOptsToQueryString(r?.transform||{});m!==""&&a.push(m);let p=a.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${n}${p}`)}}}remove(t){return jn(this,void 0,void 0,function*(){try{return{data:yield jy(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}list(t,r,n){return jn(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},nT),r),{prefix:t||""});return{data:yield Si(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}listV2(t,r){return jn(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Si(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const iT="2.11.0",sT={"X-Client-Info":`storage-js/${iT}`};var Ql=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function u(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(u,m)}p((n=n.apply(e,t||[])).next())})};class oT{constructor(t,r={},n,a){const s=new URL(t);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},sT),r),this.fetch=Fy(n)}listBuckets(){return Ql(this,void 0,void 0,function*(){try{return{data:yield Jf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Gr(t))return{data:null,error:t};throw t}})}getBucket(t){return Ql(this,void 0,void 0,function*(){try{return{data:yield Jf(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return Ql(this,void 0,void 0,function*(){try{return{data:yield Si(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return Ql(this,void 0,void 0,function*(){try{return{data:yield zm(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Ql(this,void 0,void 0,function*(){try{return{data:yield Si(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Ql(this,void 0,void 0,function*(){try{return{data:yield jy(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}}class lT extends oT{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new aT(this.url,this.headers,t,this.fetch)}}const cT="2.56.0";let _u="";typeof Deno<"u"?_u="deno":typeof document<"u"?_u="web":typeof navigator<"u"&&navigator.product==="ReactNative"?_u="react-native":_u="node";const uT={"X-Client-Info":`supabase-js-${_u}/${cT}`},dT={headers:uT},fT={schema:"public"},hT={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},mT={};var pT=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function u(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(u,m)}p((n=n.apply(e,t||[])).next())})};const gT=e=>{let t;return e?t=e:typeof fetch>"u"?t=Sy:t=fetch,(...r)=>t(...r)},vT=()=>typeof Headers>"u"?Ty:Headers,xT=(e,t,r)=>{const n=gT(r),a=vT();return(s,l)=>pT(void 0,void 0,void 0,function*(){var u;const m=(u=yield t())!==null&&u!==void 0?u:e;let p=new a(l?.headers);return p.has("apikey")||p.set("apikey",e),p.has("Authorization")||p.set("Authorization",`Bearer ${m}`),n(s,Object.assign(Object.assign({},l),{headers:p}))})};var yT=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function u(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(u,m)}p((n=n.apply(e,t||[])).next())})};function _T(e){return e.endsWith("/")?e:e+"/"}function wT(e,t){var r,n;const{db:a,auth:s,realtime:l,global:u}=e,{db:m,auth:p,realtime:g,global:y}=t,_={db:Object.assign(Object.assign({},m),a),auth:Object.assign(Object.assign({},p),s),realtime:Object.assign(Object.assign({},g),l),storage:{},global:Object.assign(Object.assign(Object.assign({},y),u),{headers:Object.assign(Object.assign({},(r=y?.headers)!==null&&r!==void 0?r:{}),(n=u?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>yT(this,void 0,void 0,function*(){return""})};return e.accessToken?_.accessToken=e.accessToken:delete _.accessToken,_}const Oy="2.71.1",oc=30*1e3,Um=3,cm=Um*oc,bT="http://localhost:9999",kT="supabase.auth.token",ST={"X-Client-Info":`gotrue-js/${Oy}`},Wm="X-Supabase-Api-Version",Ry={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},TT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ET=600*1e3;class vp extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Nt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class CT extends vp{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function AT(e){return Nt(e)&&e.name==="AuthApiError"}class Ly extends vp{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class so extends vp{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Ks extends so{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function NT(e){return Nt(e)&&e.name==="AuthSessionMissingError"}class Ef extends so{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Cf extends so{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Af extends so{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function PT(e){return Nt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Nx extends so{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $m extends so{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function um(e){return Nt(e)&&e.name==="AuthRetryableFetchError"}class Px extends so{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Hm extends so{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Qf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ix=` 	
\r=`.split(""),IT=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ix.length;t+=1)e[Ix[t].charCodeAt(0)]=-2;for(let t=0;t<Qf.length;t+=1)e[Qf[t].charCodeAt(0)]=t;return e})();function Dx(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Qf[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Qf[n]),t.queuedBits-=6}}function My(e,t,r){const n=IT[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Fx(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=l=>{jT(l,n,r)};for(let l=0;l<e.length;l+=1)My(e.charCodeAt(l),a,s);return t.join("")}function DT(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function FT(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}DT(n,t)}}function jT(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function OT(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)My(e.charCodeAt(a),r,n);return new Uint8Array(t)}function RT(e){const t=[];return FT(e,r=>t.push(r)),new Uint8Array(t)}function LT(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Dx(a,r,n)),Dx(null,r,n),t.join("")}function MT(e){return Math.round(Date.now()/1e3)+e}function BT(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const ei=()=>typeof window<"u"&&typeof document<"u",Oo={tested:!1,writable:!1},By=()=>{if(!ei())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oo.tested)return Oo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Oo.tested=!0,Oo.writable=!0}catch{Oo.tested=!0,Oo.writable=!1}return Oo.writable};function zT(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const zy=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>si(async()=>{const{default:n}=await Promise.resolve().then(()=>bc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},UT=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",lc=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ro=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Gs=async(e,t)=>{await e.removeItem(t)};class ph{constructor(){this.promise=new ph.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}ph.promiseConstructor=Promise;function dm(e){const t=e.split(".");if(t.length!==3)throw new Hm("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!TT.test(t[n]))throw new Hm("JWT not in base64url format");return{header:JSON.parse(Fx(t[0])),payload:JSON.parse(Fx(t[1])),signature:OT(t[2]),raw:{header:t[0],payload:t[1]}}}async function WT(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function $T(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await e(s);if(!t(s,null,l)){n(l);return}}catch(l){if(!t(s,l)){a(l);return}}})()})}function HT(e){return("0"+e.toString(16)).substr(-2)}function VT(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,HT).join("")}async function GT(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function ZT(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await GT(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ec(e,t,r=!1){const n=VT();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await lc(e,`${t}-code-verifier`,a);const s=await ZT(n);return[s,n===s?"plain":"s256"]}const KT=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function YT(e){const t=e.headers.get(Wm);if(!t||!t.match(KT))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function qT(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function XT(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const JT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function tc(e){if(!JT.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function fm(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function jx(e){return JSON.parse(JSON.stringify(e))}var QT=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Mo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),eE=[502,503,504];async function Ox(e){var t;if(!UT(e))throw new $m(Mo(e),0);if(eE.includes(e.status))throw new $m(Mo(e),e.status);let r;try{r=await e.json()}catch(s){throw new Ly(Mo(s),s)}let n;const a=YT(e);if(a&&a.getTime()>=Ry["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Px(Mo(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ks}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new Px(Mo(r),e.status,r.weak_password.reasons);throw new CT(Mo(r),e.status||500,n)}const tE=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Rt(e,t,r,n){var a;const s=Object.assign({},n?.headers);s[Wm]||(s[Wm]=Ry["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const l=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(l.redirect_to=n.redirectTo);const u=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",m=await rE(e,t,r+u,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(m):{data:Object.assign({},m),error:null}}async function rE(e,t,r,n,a,s){const l=tE(t,n,a,s);let u;try{u=await e(r,Object.assign({},l))}catch(m){throw console.error(m),new $m(Mo(m),0)}if(u.ok||await Ox(u),n?.noResolveJson)return u;try{return await u.json()}catch(m){await Ox(m)}}function Ji(e){var t;let r=null;sE(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=MT(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Rx(e){const t=Ji(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function qs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function nE(e){return{data:e,error:null}}function aE(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,l=QT(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},m=Object.assign({},l);return{data:{properties:u,user:m},error:null}}function iE(e){return e}function sE(e){return e.access_token&&e.refresh_token&&e.expires_in}const hm=["global","local","others"];var oE=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class lE{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=zy(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=hm[0]){if(hm.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${hm.join(", ")}`);try{return await Rt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Nt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Rt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:qs})}catch(n){if(Nt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=oE(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await Rt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:aE,redirectTo:r?.redirectTo})}catch(r){if(Nt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Rt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:qs})}catch(r){if(Nt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,l,u,m;try{const p={nextPage:null,lastPage:0,total:0},g=await Rt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:iE});if(g.error)throw g.error;const y=await g.json(),_=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,T=(m=(u=g.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&m!==void 0?m:[];return T.length>0&&(T.forEach(S=>{const w=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(S.split(";")[1].split("=")[1]);p[`${E}Page`]=w}),p.total=parseInt(_)),{data:Object.assign(Object.assign({},y),p),error:null}}catch(p){if(Nt(p))return{data:{users:[]},error:p};throw p}}async getUserById(t){tc(t);try{return await Rt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:qs})}catch(r){if(Nt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){tc(t);try{return await Rt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:qs})}catch(n){if(Nt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){tc(t);try{return await Rt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:qs})}catch(n){if(Nt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){tc(t.userId);try{const{data:r,error:n}=await Rt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Nt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){tc(t.userId),tc(t.id);try{return{data:await Rt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Nt(r))return{data:null,error:r};throw r}}}function Lx(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function cE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const rc={debug:!!(globalThis&&By()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Uy extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class uE extends Uy{}async function dE(e,t,r){rc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),rc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){rc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{rc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw rc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new uE(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(rc.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}cE();const fE={url:bT,storageKey:kT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ST,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Mx(e,t,r){return await r()}const nc={};class Bu{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Bu.nextInstanceID,Bu.nextInstanceID+=1,this.instanceID>0&&ei()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},fE),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new lE({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=zy(a.fetch),this.lock=a.lock||Mx,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ei()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=dE:this.lock=Mx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:By()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Lx(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Lx(this.memoryStorage)),ei()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=nc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){nc[this.storageKey]=Object.assign(Object.assign({},nc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=nc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){nc[this.storageKey]=Object.assign(Object.assign({},nc[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Oy}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=zT(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),ei()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),PT(s)){const m=(t=s.details)===null||t===void 0?void 0:t.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:l,redirectType:u}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",u),await this._saveSession(l),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Nt(r)?{error:r}:{error:new Ly("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Ji}),{data:l,error:u}=s;if(u||!l)return{data:{user:null,session:null},error:u};const m=l.session,p=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(s){if(Nt(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:g,password:y,options:_}=t;let T=null,S=null;this.flowType==="pkce"&&([T,S]=await ec(this.storage,this.storageKey)),s=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_?.emailRedirectTo,body:{email:g,password:y,data:(r=_?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:_?.captchaToken},code_challenge:T,code_challenge_method:S},xform:Ji})}else if("phone"in t){const{phone:g,password:y,options:_}=t;s=await Rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:y,data:(n=_?.data)!==null&&n!==void 0?n:{},channel:(a=_?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:_?.captchaToken}},xform:Ji})}else throw new Cf("You must provide either an email or phone number and a password");const{data:l,error:u}=s;if(u||!l)return{data:{user:null,session:null},error:u};const m=l.session,p=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(s){if(Nt(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:l,options:u}=t;r=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Rx})}else if("phone"in t){const{phone:s,password:l,options:u}=t;r=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:u?.captchaToken}},xform:Rx})}else throw new Cf("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ef}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Nt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,l,u,m,p,g,y,_,T;let S,w;if("message"in t)S=t.message,w=t.signature;else{const{chain:E,wallet:P,statement:I,options:A}=t;let R;if(ei())if(typeof P=="object")R=P;else{const W=window;if("solana"in W&&typeof W.solana=="object"&&("signIn"in W.solana&&typeof W.solana.signIn=="function"||"signMessage"in W.solana&&typeof W.solana.signMessage=="function"))R=W.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof P!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");R=P}const K=new URL((r=A?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in R&&R.signIn){const W=await R.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},A?.signInWithSolana),{version:"1",domain:K.host,uri:K.href}),I?{statement:I}:null));let D;if(Array.isArray(W)&&W[0]&&typeof W[0]=="object")D=W[0];else if(W&&typeof W=="object"&&"signedMessage"in W&&"signature"in W)D=W;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)S=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),w=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in R)||typeof R.signMessage!="function"||!("publicKey"in R)||typeof R!="object"||!R.publicKey||!("toBase58"in R.publicKey)||typeof R.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${K.host} wants you to sign in with your Solana account:`,R.publicKey.toBase58(),...I?["",I,""]:[""],"Version: 1",`URI: ${K.href}`,`Issued At: ${(a=(n=A?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=A?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${A.signInWithSolana.notBefore}`]:[],...!((l=A?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${A.signInWithSolana.expirationTime}`]:[],...!((u=A?.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${A.signInWithSolana.chainId}`]:[],...!((m=A?.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${A.signInWithSolana.nonce}`]:[],...!((p=A?.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${A.signInWithSolana.requestId}`]:[],...!((y=(g=A?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||y===void 0)&&y.length?["Resources",...A.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const W=await R.signMessage(new TextEncoder().encode(S),"utf8");if(!W||!(W instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=W}}try{const{data:E,error:P}=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:LT(w)},!((_=t.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(T=t.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:Ji});if(P)throw P;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new Ef}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:P})}catch(E){if(Nt(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(t){const r=await Ro(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:l}=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Ji});if(await Gs(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Ef}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:l})}catch(s){if(Nt(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:l}=t,u=await Rt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Ji}),{data:m,error:p}=u;return p?{data:{user:null,session:null},error:p}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Ef}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:p})}catch(r){if(Nt(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,l;try{if("email"in t){const{email:u,options:m}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await ec(this.storage,this.storageKey));const{error:y}=await Rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(r=m?.data)!==null&&r!==void 0?r:{},create_user:(n=m?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:p,code_challenge_method:g},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in t){const{phone:u,options:m}=t,{data:p,error:g}=await Rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(a=m?.data)!==null&&a!==void 0?a:{},create_user:(s=m?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},channel:(l=m?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:p?.message_id},error:g}}throw new Cf("You must provide either an email or phone number.")}catch(u){if(Nt(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:u}=await Rt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Ji});if(u)throw u;if(!l)throw new Error("An error occurred on token verification.");const m=l.session,p=l.user;return m?.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(a){if(Nt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,l=null;return this.flowType==="pkce"&&([s,l]=await ec(this.storage,this.storageKey)),await Rt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:l}),headers:this.headers,xform:nE})}catch(s){if(Nt(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ks;const{error:a}=await Rt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Nt(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:l}=await Rt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:l,error:u}=await Rt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:u}}throw new Cf("You must provide either an email or phone number and a type")}catch(r){if(Nt(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ro(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<cm:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await Ro(this.userStorage,this.storageKey+"-user");l?.user?t.user=l.user:t.user=fm()}if(this.storage.isServer&&t.user){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(m,p,g)=>(!l&&p==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,p,g))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:qs}):await this._useSession(async r=>{var n,a,s;const{data:l,error:u}=r;if(u)throw u;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ks}:await Rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:qs})})}catch(r){if(Nt(r))return NT(r)&&(await this._removeSession(),await Gs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Ks;const l=a.session;let u=null,m=null;this.flowType==="pkce"&&t.email!=null&&([u,m]=await ec(this.storage,this.storageKey));const{data:p,error:g}=await Rt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:u,code_challenge_method:m}),jwt:l.access_token,xform:qs});if(g)throw g;return l.user=p.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(Nt(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ks;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:l}=dm(t.access_token);if(l.exp&&(n=l.exp,a=n<=r),a){const{session:u,error:m}=await this._callRefreshToken(t.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!u)return{data:{user:null,session:null},error:null};s=u}else{const{data:u,error:m}=await this._getUser(t.access_token);if(m)throw m;s={access_token:t.access_token,refresh_token:t.refresh_token,user:u.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Nt(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:u}=r;if(u)throw u;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Ks;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Nt(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!ei())throw new Af("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Af(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Nx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Af("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Nx("No code detected.");const{data:I,error:A}=await this._exchangeCodeForSession(t.code);if(A)throw A;const R=new URL(window.location.href);return R.searchParams.delete("code"),window.history.replaceState(window.history.state,"",R.toString()),{data:{session:I.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:l,expires_in:u,expires_at:m,token_type:p}=t;if(!s||!u||!l||!p)throw new Af("No session defined in URL");const g=Math.round(Date.now()/1e3),y=parseInt(u);let _=g+y;m&&(_=parseInt(m));const T=_-g;T*1e3<=oc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${y}s`);const S=_-y;g-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,_,g):g-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,_,g);const{data:w,error:E}=await this._getUser(s);if(E)throw E;const P={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:y,expires_at:_,refresh_token:l,token_type:p,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:P,redirectType:t.type},error:null}}catch(n){if(Nt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ro(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const l=(n=a.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:u}=await this.admin.signOut(l,t);if(u&&!(AT(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return t!=="others"&&(await this._removeSession(),await Gs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=BT(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await ec(this.storage,this.storageKey,!0));try{return await Rt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Nt(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Nt(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var l,u,m,p,g;const{data:y,error:_}=s;if(_)throw _;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(u=t.options)===null||u===void 0?void 0:u.scopes,queryParams:(m=t.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await Rt(this.fetch,"GET",T,{headers:this.headers,jwt:(g=(p=y.session)===null||p===void 0?void 0:p.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return ei()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(Nt(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:l}=r;if(l)throw l;return await Rt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Nt(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await $T(async a=>(a>0&&await WT(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Rt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Ji})),(a,s)=>{const l=200*Math.pow(2,a);return s&&um(s)&&Date.now()+l-n<oc})}catch(n){if(this._debug(r,"error",n),Nt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ei()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Ro(this.storage,this.storageKey);if(a&&this.userStorage){let l=await Ro(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:a.user},await lc(this.userStorage,this.storageKey+"-user",l)),a.user=(t=l?.user)!==null&&t!==void 0?t:fm()}else if(a&&!a.user&&!a.user){const l=await Ro(this.storage,this.storageKey+"-user");l&&l?.user?(a.user=l.user,await Gs(this.storage,this.storageKey+"-user"),await lc(this.storage,this.storageKey,a)):a.user=fm()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<cm;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${cm}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:l}=await this._callRefreshToken(a.refresh_token);l&&(console.error(l),um(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:u}=await this._getUser(a.access_token);!u&&l?.user?(a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ks;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ph;const{data:s,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new Ks;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const u={session:s.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(s){if(this._debug(a,"error",s),Nt(s)){const l={session:null,error:s};return um(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(t,r)}catch(m){s.push(m)}});if(await Promise.all(l),s.length>0){for(let u=0;u<s.length;u+=1)console.error(s[u]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await lc(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=jx(a);await lc(this.storage,this.storageKey,s)}else{const a=jx(r);await lc(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Gs(this.storage,this.storageKey),await Gs(this.storage,this.storageKey+"-code-verifier"),await Gs(this.storage,this.storageKey+"-user"),this.userStorage&&await Gs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ei()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),oc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/oc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${oc}ms, refresh threshold is ${Um} ticks`),a<=Um&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Uy)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ei()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,l]=await ec(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(u.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Rt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Nt(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:l}=r;if(l)return{data:null,error:l};const u=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:m,error:p}=await Rt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return p?{data:null,error:p}:(t.factorType==="totp"&&(!((a=m?.totp)===null||a===void 0)&&a.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(r){if(Nt(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:l,error:u}=await Rt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:u})})}catch(r){if(Nt(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Rt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Nt(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=t?.factors||[],a=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),s=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=dm(a.access_token);let u=null;l.aal&&(u=l.aal);let m=u;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(y=>y.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const g=l.amr||[];return{data:{currentLevel:u,nextLevel:m,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(u=>u.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(u=>u.kid===t),n&&this.jwks_cached_at+ET>a)return n;const{data:s,error:l}=await Rt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(u=>u.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:T,error:S}=await this.getSession();if(S||!T.session)return{data:null,error:S};n=T.session.access_token}const{header:a,payload:s,signature:l,raw:{header:u,payload:m}}=dm(n);r?.allowExpired||qT(s.exp);const p=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!p){const{error:T}=await this.getUser(n);if(T)throw T;return{data:{claims:s,header:a,signature:l},error:null}}const g=XT(a.alg),y=await crypto.subtle.importKey("jwk",p,g,!0,["verify"]);if(!await crypto.subtle.verify(g,y,l,RT(`${u}.${m}`)))throw new Hm("Invalid JWT signature");return{data:{claims:s,header:a,signature:l},error:null}}catch(n){if(Nt(n))return{data:null,error:n};throw n}}}Bu.nextInstanceID=0;const hE=Bu;class mE extends hE{constructor(t){super(t)}}var pE=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function u(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(u,m)}p((n=n.apply(e,t||[])).next())})};class gE{constructor(t,r,n){var a,s,l;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const u=_T(t),m=new URL(u);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const p=`sb-${m.hostname.split(".")[0]}-auth-token`,g={db:fT,realtime:mT,auth:Object.assign(Object.assign({},hT),{storageKey:p}),global:dT},y=wT(n??{},g);this.storageKey=(a=y.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=y.global.headers)!==null&&s!==void 0?s:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(_,T)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(T)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=y.auth)!==null&&l!==void 0?l:{},this.headers,y.global.fetch),this.fetch=xT(r,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new DS(new URL("rest/v1",m).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new lT(this.storageUrl.href,this.headers,this.fetch,n?.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new bS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return pE(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:s,flowType:l,lock:u,debug:m},p,g){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new mE({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),p),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:l,lock:u,debug:m,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new YS(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Wy=(e,t,r)=>new gE(e,t,r);function vE(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}vE()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const xE="https://eevfxrgemrtthxbcxtvq.supabase.co",yE="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",We=Wy(xE,yE,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"navigator-supabase-auth-token",debug:!1},realtime:{params:{eventsPerSecond:5}}}),_E={navigator_restore_in_progress:3e4,navigator_import_in_progress:6e3,navigator_active_protection:5e3};function Xs(e,t){const r=localStorage.getItem(e);if(!r)return!1;const n=parseInt(r,10);if(isNaN(n))return Bx(e),!1;const a=_E[e],s=Date.now()-n;return t!==void 0&&s<t?!0:s>=a?(Bx(e),!1):!0}function Bx(e){localStorage.removeItem(e)}async function zx(e){if(!We)throw new Error("Supabase not configured");const{data:t,error:r}=await We.rpc("create_trial_subscription",{target_user_id:e});if(r){if(r.message?.includes("already has a subscription"))return;throw console.error("Failed to create trial subscription:",r),r}if(t&&!t.success){if(t.message?.includes("already has a subscription"))return;throw console.error("Trial subscription creation failed:",t.message),new Error(t.message)}}function Ux(){let e=localStorage.getItem("navigator_device_id");return e||(e=`device_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,localStorage.setItem("navigator_device_id",e)),e}function $y(e,t){const r=typeof e.currentListVersion=="number"?e.currentListVersion:1,n=typeof t.currentListVersion=="number"?t.currentListVersion:1,a=P=>typeof P=="number"?P:Math.max(r,n),s=new Map,l=P=>{if(!P||typeof P.index!="number"||typeof P.timestamp!="string"||!P.outcome)return;const I={...P,listVersion:a(P.listVersion)},A=`${I.timestamp}_${I.index}_${I.outcome}`,R=s.get(A);if(!R){s.set(A,I);return}const K=new Date(R.timestamp).getTime();if(new Date(I.timestamp).getTime()>K){s.set(A,{...R,...I});return}s.set(A,{...I,...R})};t.completions?.forEach(l),e.completions?.forEach(l);const u=Array.from(s.values()).sort((P,I)=>new Date(I.timestamp).getTime()-new Date(P.timestamp).getTime()),m=()=>{const P=Array.isArray(e.addresses)?e.addresses:[],I=Array.isArray(t.addresses)?t.addresses:[],A=D=>D.some(ee=>ee.address?.trim()),R=A(I),K=A(P);return n>r?!R&&K?{addresses:P,listVersion:r}:{addresses:I,listVersion:n}:r>n?!K&&R?{addresses:I,listVersion:r}:{addresses:P,listVersion:r}:R&&!K?{addresses:I,listVersion:n}:!R&&K?{addresses:P,listVersion:r}:{addresses:I.length>=P.length?I:P,listVersion:n}},{addresses:p,listVersion:g}=m(),y=new Map,_=P=>{if(!P?.id)return;const I=y.get(P.id);if(!I){y.set(P.id,P);return}const A=new Date(I.updatedAt).getTime();new Date(P.updatedAt).getTime()>A&&y.set(P.id,P)};e.arrangements?.forEach(_),t.arrangements?.forEach(_);const T=new Map,S=P=>{if(!P?.date)return;const I=T.get(P.date);if(!I){T.set(P.date,P);return}const A=!!I.end,R=!!P.end;if(!A&&R){T.set(P.date,P);return}if(A&&R){const K=new Date(I.end??I.start).getTime();new Date(P.end??P.start).getTime()>K&&T.set(P.date,P)}};e.daySessions?.forEach(S),t.daySessions?.forEach(S);const w=Array.from(T.values()),E=Array.from(y.values());return{...t,addresses:p,completions:u,arrangements:E,daySessions:w,currentListVersion:g,activeIndex:t.activeIndex??e.activeIndex??null}}function Hy(){const[e,t]=J.useState(null),[r,n]=J.useState(!0),[a,s]=J.useState(!1),[l,u]=J.useState(typeof navigator<"u"?navigator.onLine:!0),[m,p]=J.useState(null),[g,y]=J.useState(null),_=J.useRef({lastSyncAt:"",deviceId:Ux(),version:0,checksum:""}),T=J.useRef([]),S=J.useRef(!1),w=J.useRef(null),E=J.useRef(""),P=J.useRef(null),I=J.useCallback(()=>p(null),[]),A=J.useCallback(async()=>{if(!e||!We||!l||S.current||T.current.length===0)return;S.current=!0,s(!0);const ye=T.current.slice(0,10),he=new Set;try{for(const le of ye)try{const{operation:j}=le,{error:H}=await We.from("navigator_operations").insert({user_id:e.id,operation_id:j.id,type:j.type,entity:j.entity,entity_id:j.entityId,data:j.data,device_id:_.current.deviceId,timestamp:j.timestamp,local_timestamp:j.localTimestamp});if(H&&H.code!=="23505")throw H;he.add(le.operation.id),le.resolve(j)}catch(j){le.operation.retries+=1,le.operation.retries<3||(console.warn(`Operation ${le.operation.id} failed after max retries:`,j),he.add(le.operation.id),le.reject(j))}T.current=T.current.filter(le=>!he.has(le.operation.id))}catch(le){console.error("Sync batch error:",le),p(le?.message||"Sync batch failed")}finally{S.current=!1,s(T.current.length>0),T.current.length>0&&(w.current=setTimeout(A,1e3))}},[e,l]),R=J.useCallback(async ye=>new Promise((he,le)=>{const j=JSON.stringify(ye.data),H=`${ye.type}_${ye.entity}_${ye.entityId}_${j}`;if(T.current.some(U=>{const z=JSON.stringify(U.operation.data);return`${U.operation.type}_${U.operation.entity}_${U.operation.entityId}_${z}`===H&&U.operation.retries<3})){he();return}const ne=new Date().toISOString(),F={operation:{...ye,id:`op_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,timestamp:ne,localTimestamp:ne,retries:0},resolve:he,reject:le};T.current.push(F),T.current.length>1e3&&(console.warn("Sync queue size limit reached, removing oldest entries"),T.current.splice(0,100).forEach(z=>{z.reject(new Error("Queue overflow - operation cancelled"))})),l&&A()}),[l,A]);J.useEffect(()=>{let ye=!0;if((async()=>{try{if(!navigator.onLine){const M=localStorage.getItem("navigator_was_authenticated"),oe=localStorage.getItem("navigator_expected_user_id");if(We)try{const{data:se}=await We.auth.getSession();if(ye&&se.session?.user)t(se.session.user);else if(M==="true"&&oe){const fe={id:oe,email:localStorage.getItem("navigator_last_user_email")||"offline@local",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString(),role:"authenticated",updated_at:new Date().toISOString()};ye&&(t(fe),localStorage.setItem("navigator_offline_mode","true"))}}catch{if(M==="true"&&oe&&ye){const fe={id:oe,email:localStorage.getItem("navigator_last_user_email")||"offline@local",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString(),role:"authenticated",updated_at:new Date().toISOString()};t(fe),localStorage.setItem("navigator_offline_mode","true")}}else if(M==="true"&&oe&&ye){const se={id:oe,email:localStorage.getItem("navigator_last_user_email")||"offline@local",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString(),role:"authenticated",updated_at:new Date().toISOString()};t(se),localStorage.setItem("navigator_offline_mode","true")}ye&&n(!1);return}if(!We){ye&&(p("Supabase not configured"),n(!1));return}const le=localStorage.getItem("navigator_expected_user_id"),j=localStorage.getItem("navigator_last_session_validation"),H=j?parseInt(j):0;if(Date.now()-H>9e5||!j){const M=localStorage.getItem(`sb-${window.location.hostname.replace(/\./g,"-")}-auth-token`);if(M)try{const se=JSON.parse(M)?.user?.id;if(le&&se&&se!==le){console.error("🚨 SESSION TAMPERING DETECTED: Session user ID does not match expected user ID"),localStorage.removeItem(`sb-${window.location.hostname.replace(/\./g,"-")}-auth-token`),localStorage.removeItem("navigator_expected_user_id"),sessionStorage.clear(),p("Session security error. Please sign in again."),n(!1);return}}catch(oe){console.warn("Could not parse session data for validation:",oe)}localStorage.setItem("navigator_last_session_validation",Date.now().toString())}const ne=new URLSearchParams(window.location.hash.substring(1)),Y=ne.get("access_token"),F=ne.get("refresh_token"),U=ne.get("type"),z=ne.get("error"),q=ne.get("error_description");if(z){console.error("Auth callback error:",z,q);const M=`Email confirmation failed: ${q||z}`;p(M),alert(M),window.history.replaceState(null,"",window.location.pathname),ye&&n(!1);return}if(Y&&U){try{const{data:M,error:oe}=await We.auth.setSession({access_token:Y,refresh_token:F||""});if(oe){console.error("Error setting session from URL:",oe);const se="Failed to confirm email: "+oe.message;p(se),alert(se+`

Please try signing in manually or contact support.`)}else if(M.session){t(M.session.user),I();try{await zx(M.session.user.id)}catch(se){console.warn("Trial subscription creation failed (may already exist):",se)}}else{console.warn("Session data missing after setSession");const se="Email confirmation incomplete. Please try signing in with your email and password.";p(se),alert(se)}}catch(M){console.error("Exception during session setup:",M),p("Error confirming email: "+(M?.message||String(M)))}window.history.replaceState(null,"",window.location.pathname)}else{const{data:M,error:oe}=await We.auth.getUser();if(oe)throw oe;if(M.user&&le&&M.user.id!==le){console.error(`🚨 USER ID MISMATCH: Expected ${le}, got ${M.user.id}`),p("Security error: Session user mismatch. Signing out for safety."),await We.auth.signOut(),localStorage.removeItem("navigator_expected_user_id"),ye&&(t(null),n(!1));return}ye&&t(M.user??null)}}catch(le){ye&&le?.message!=="Auth session missing!"&&p(le?.message||String(le))}finally{ye&&n(!1)}})(),!We)return()=>{ye=!1};const{data:he}=We.auth.onAuthStateChange((le,j)=>{if(ye){const H=localStorage.getItem("navigator_expected_user_id"),O=j?.user?.id;if(H&&O&&H!==O)if(console.error(`🚨 AUTH STATE CHANGE: User ID changed from ${H} to ${O}`),le==="SIGNED_IN"||le==="USER_UPDATED")console.log("🔒 SECURITY: Legitimate user change, updating expected user ID"),localStorage.setItem("navigator_expected_user_id",O);else{console.error("🚨 SECURITY: Unexpected user ID change on event:",le);return}t(j?.user??null),(le==="SIGNED_IN"||le==="USER_UPDATED")&&j&&(localStorage.setItem("navigator_was_authenticated","true"),localStorage.setItem("navigator_last_user_email",j.user.email||""),localStorage.removeItem("navigator_offline_mode"),I()),le==="SIGNED_OUT"&&(localStorage.removeItem("navigator_was_authenticated"),localStorage.removeItem("navigator_last_user_email"),localStorage.removeItem("navigator_offline_mode"))}});return()=>{ye=!1,he.subscription.unsubscribe()}},[I]),J.useEffect(()=>{if(typeof window>"u")return;const ye=()=>{u(!0),w.current=setTimeout(A,100),setTimeout(async()=>{const le=Object.keys(localStorage).filter(j=>j.startsWith("navigator_offline_state_"));if(le.length>0)for(const j of le)try{const H=JSON.parse(localStorage.getItem(j)||"{}");H.state&&(await pe(H.state),localStorage.removeItem(j))}catch(H){console.error(`🔌 OFFLINE PROTECTION: Failed to sync queued state ${j}:`,H)}},2e3)},he=()=>{u(!1)};return window.addEventListener("online",ye),window.addEventListener("offline",he),()=>{window.removeEventListener("online",ye),window.removeEventListener("offline",he)}},[A]);const K=J.useCallback(async(ye,he)=>{if(I(),!We)throw new Error("Supabase not configured");const{data:le,error:j}=await We.auth.signInWithPassword({email:ye,password:he});if(j)throw p(j.message),j;localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"),localStorage.setItem("navigator_was_authenticated","true"),localStorage.setItem("navigator_last_user_email",le.user.email||""),localStorage.removeItem("navigator_offline_mode");const{SmartUserDetection:H}=await si(async()=>{const{SmartUserDetection:O}=await Promise.resolve().then(()=>xS);return{SmartUserDetection:O}},void 0);return H.storeDeviceContext(le.user),t(le.user),{user:le.user}},[I]),W=J.useCallback(async(ye,he)=>{if(I(),!We)throw new Error("Supabase not configured");try{localStorage.removeItem("navigator-supabase-auth-token"),localStorage.removeItem("supabase.auth.token"),sessionStorage.clear(),await We.auth.signOut(),t(null),await new Promise(ne=>setTimeout(ne,1e3));const{data:O}=await We.auth.getSession();O.session&&(console.warn("Session still exists after cleanup, forcing removal..."),await We.auth.signOut(),await new Promise(ne=>setTimeout(ne,500)))}catch(O){console.warn("Error during pre-signup signout:",O)}const le=window.location.origin,{data:j,error:H}=await We.auth.signUp({email:ye,password:he,options:{data:{signup_source:"navigator_web"},emailRedirectTo:le}});if(H)throw p(H.message),H;if(j.user){try{await zx(j.user.id),localStorage.setItem("navigator_trial_created",Date.now().toString()),localStorage.setItem("navigator_trial_user_id",j.user.id)}catch(O){console.error("Failed to initialize new user:",O)}if(!j.session)return p("✉️ Check your email! Click the confirmation link to activate your account."),{user:j.user};t(j.user)}return{user:j.user}},[I]),D=J.useCallback(async()=>{if(I(),P.current&&(P.current(),P.current=null),!We)return;const{error:ye}=await We.auth.signOut();if(ye)throw p(ye.message),ye;try{const{clear:he}=await si(async()=>{const{clear:j}=await Promise.resolve().then(()=>_k);return{clear:j}},void 0);await he(),["navigator_trial_created","navigator_trial_user_id","navigator_last_user_id","navigator_device_context","navigator_device_context_checksum","navigator_supabase_url","navigator_supabase_key","navigator_supabase_skipped","navigator_data_counts","last_backup_time","navigator-web:settings","navigator_expected_user_id","navigator_last_session_validation","navigator_active_protection","navigator_restore_in_progress","navigator_import_in_progress","navigator_was_authenticated","navigator_last_user_email","navigator_offline_mode"].forEach(j=>localStorage.removeItem(j)),sessionStorage.clear()}catch(he){console.warn("Error clearing local data:",he)}t(null),y(null),_.current={lastSyncAt:"",deviceId:Ux(),version:0,checksum:""},T.current=[],S.current=!1,E.current="",w.current&&(clearTimeout(w.current),w.current=null)},[I]),ee=J.useCallback(async ye=>{if(I(),!We)throw new Error("Supabase not configured");const he=window.location.origin,{error:le}=await We.auth.resetPasswordForEmail(ye,{redirectTo:he});if(le)throw p(le.message),le},[I]),re=J.useCallback(async ye=>{if(I(),!We)throw new Error("Supabase not configured");if(!e)throw new Error("Not authenticated");const{error:he}=await We.auth.updateUser({password:ye});if(he)throw p(he.message),he},[I,e]),pe=J.useCallback(async ye=>{if(!e||!We){p(e?"Supabase not configured":"Not authenticated");return}if(JSON.stringify(ye)!==E.current)try{I(),s(!0);const le=new Date().toISOString(),{data:j,error:H}=await We.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle();if(H)throw H;let O=ye,ne=_.current.version+1;if(j&&j.updated_at>_.current.lastSyncAt){const M=j.data;O=await ue(ye,M),ne=(j.version||0)+1}const Y=$o(O),{error:F}=await We.from("navigator_state").upsert({user_id:e.id,data:O,updated_at:le,version:ne,checksum:Y,device_id:_.current.deviceId},{onConflict:"user_id"}).select("updated_at, version, checksum").single();if(F)throw console.error("Cloud sync database error:",F),F.code==="23505"||F.message?.includes("conflict")?(_.current.lastSyncAt="",_.current.version=0,new Error("Sync conflict detected - will retry with fresh data")):F;const{data:U,error:z}=await We.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).single();if(z)throw console.error("Sync verification failed:",z),new Error(`Sync verification failed: ${z.message}`);if(!U)throw new Error("Sync verification failed: No data found after upsert");const q=$o(U.data);q!==Y&&console.warn("Checksum mismatch (likely harmless serialization difference)",{expectedChecksum:Y,actualChecksum:q,expectedCompletions:O.completions?.length||0,actualCompletions:U.data?.completions?.length||0}),_.current={lastSyncAt:U.updated_at??le,deviceId:_.current.deviceId,version:U.version??ne,checksum:Y},E.current=JSON.stringify(O),y(new Date(U.updated_at??le))}catch(le){if(le?.message!=="Auth session missing!"&&p(le?.message||String(le)),console.error("Sync failed:",le),!l||le?.message?.includes("fetch")){const j=`navigator_offline_state_${Date.now()}`,H={state:ye,timestamp:new Date().toISOString(),reason:"network_failure",error:le?.message||String(le)};try{localStorage.setItem(j,JSON.stringify(H))}catch(O){console.error("Failed to queue offline state:",O)}}}finally{s(!1)}},[e,I]),ue=J.useCallback(async(ye,he)=>{if(Xs("navigator_restore_in_progress")){console.log("🛡️ RESTORE PROTECTION: Preferring local state to prevent data loss");const q=typeof ye.currentListVersion=="number"?ye.currentListVersion:1,M=typeof he.currentListVersion=="number"?he.currentListVersion:1;return{...ye,currentListVersion:Math.max(q,M)}}if(Xs("navigator_import_in_progress")){console.log("🛡️ IMPORT PROTECTION: Preferring local state to prevent import override");const q=typeof ye.currentListVersion=="number"?ye.currentListVersion:1,M=typeof he.currentListVersion=="number"?he.currentListVersion:1;return{...ye,currentListVersion:Math.max(q,M)}}const le=new Date(Date.now()-360*60*1e3);if(ye.completions.some(q=>q.timestamp&&new Date(q.timestamp)>le)){const q=ye.completions.length,M=he.completions.length;if(q>M)return{...ye,arrangements:he.arrangements.length>ye.arrangements.length?he.arrangements:ye.arrangements,daySessions:[...ye.daySessions,...he.daySessions.filter(oe=>!ye.daySessions.some(se=>se.date===oe.date))]}}const H={...ye},O=[...ye.completions,...he.completions],ne=new Map;O.forEach(q=>{if(!q.address||!q.timestamp)return;const M=`${q.address}_v${q.listVersion||1}`,oe=ne.get(M);if(!oe){ne.set(M,q);return}const se=new Date(oe.timestamp).getTime(),fe=new Date(q.timestamp).getTime();!isNaN(fe)&&(isNaN(se)||fe>se)&&ne.set(M,q)}),H.completions=Array.from(ne.values()).sort((q,M)=>new Date(M.timestamp).getTime()-new Date(q.timestamp).getTime());const Y=[...ye.arrangements,...he.arrangements],F=new Map;Y.forEach(q=>{const M=F.get(q.id);(!M||new Date(q.updatedAt)>new Date(M.updatedAt))&&F.set(q.id,q)}),H.arrangements=Array.from(F.values());const U=[...ye.daySessions,...he.daySessions],z=new Map;if(U.forEach(q=>{const M=z.get(q.date);(!M||q.end&&!M.end)&&z.set(q.date,q)}),H.daySessions=Array.from(z.values()),he.addresses.length>ye.addresses.length){H.addresses=he.addresses;const q=typeof ye.currentListVersion=="number"?ye.currentListVersion:1,M=typeof he.currentListVersion=="number"?he.currentListVersion:1;H.currentListVersion=Math.max(q,M)}else{const q=typeof ye.currentListVersion=="number"?ye.currentListVersion:1;H.currentListVersion=q}return H.activeIndex=ye.activeIndex??he.activeIndex??null,H},[]),ce=J.useCallback(async()=>{if(E.current="",_.current.lastSyncAt="",_.current.version=0,e&&We)try{const{data:ye,error:he}=await We.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle()}catch(ye){console.warn("Force sync failed:",ye)}},[e]),Ce=J.useCallback(ye=>{if(!e||!We)return()=>{};I();const he=We,le=he.channel("navigator_state_"+e.id);le.on("postgres_changes",{event:"*",schema:"public",table:"navigator_state",filter:`user_id=eq.${e.id}`},async H=>{try{const O=H?.new??H?.old??null;if(!O)return;const ne=localStorage.getItem("navigator_expected_user_id");if(ne&&O.user_id&&O.user_id!==ne){console.error(`🚨 SUBSCRIPTION DATA CONTAMINATION: Received data for user ${O.user_id} but expected ${ne}`);return}const Y=O.data;if(Y._ownerUserId&&Y._ownerUserId!==e.id){console.error(`🚨 DATA OWNERSHIP MISMATCH: Data belongs to ${Y._ownerUserId} but current user is ${e.id}`);return}const F=O.updated_at,U=O.version||0,z=O.checksum||"";if(O.device_id===_.current.deviceId||U<=_.current.version)return;const q=$o(Y);if(z&&z!==q){const fe="navigator_checksum_mismatch_count",xe="navigator_last_checksum_mismatch",je=parseInt(localStorage.getItem(fe)||"0"),X=parseInt(localStorage.getItem(xe)||"0"),Xe=Date.now()-X>3e5?1:je+1;localStorage.setItem(fe,Xe.toString()),localStorage.setItem(xe,Date.now().toString()),console.warn(`⚠️ CHECKSUM MISMATCH (${Xe}) - Data integrity issue detected`,{expected:q.substring(0,16)+"...",actual:z.substring(0,16)+"...",serverVersion:U,updatedAt:F,consecutiveMismatches:Xe}),Xe>=3&&(console.error("❌ PERSISTENT CHECKSUM MISMATCH - Forcing full sync (silent recovery)"),localStorage.removeItem(fe),localStorage.removeItem(xe),_.current.lastSyncAt="",_.current.version=0,_.current.checksum="");return}if(localStorage.removeItem("navigator_checksum_mismatch_count"),localStorage.removeItem("navigator_last_checksum_mismatch"),localStorage.getItem("navigator_active_protection"))return;_.current.lastSyncAt=F,_.current.version=U,_.current.checksum=z;const oe=localStorage.getItem("navigator_restore_in_progress");if(oe){const fe=parseInt(oe);if(Date.now()-fe<3e4)return;localStorage.removeItem("navigator_restore_in_progress")}const se=localStorage.getItem("navigator_import_in_progress");if(se){const fe=parseInt(se);if(Date.now()-fe<2e3)return;localStorage.removeItem("navigator_import_in_progress")}typeof ye=="function"?ye(fe=>{const xe=$y(fe,Y);return xe.completions.filter(X=>!fe.completions.some(Ke=>Ke.timestamp===X.timestamp&&Ke.address===X.address)).length>0,E.current=JSON.stringify(xe),xe}):E.current=JSON.stringify(Y),y(new Date(F))}catch(O){console.warn("subscribeToData handler error:",O?.message||O),p("Sync error: "+(O?.message||O))}}),le.subscribe();const j=()=>{try{he.removeChannel(le)}catch{}};return P.current=j,j},[e,I]);return J.useMemo(()=>({user:e,isLoading:r,isOnline:l,isSyncing:a,error:m,lastSyncTime:g,clearError:I,signIn:K,signUp:W,signOut:D,resetPassword:ee,updatePassword:re,syncData:pe,subscribeToData:Ce,queueOperation:R,forceFullSync:ce}),[e,r,l,a,m,g,I,K,W,D,ee,re,pe,Ce,R,ce])}function xp({isOpen:e,onClose:t,title:r,children:n,size:a="md",showCloseButton:s=!0}){J.useEffect(()=>{const m=p=>{p.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",m),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",m),document.body.style.overflow=""}},[e,t]);const l=J.useRef(null);if(J.useEffect(()=>{if(e&&l.current){const p=l.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];p&&p.focus()}},[e]),!e)return null;const u={sm:"modal-sm",md:"modal-md",lg:"modal-lg"};return d.jsx("div",{className:"modal-overlay",onClick:t,children:d.jsxs("div",{ref:l,className:`modal-content ${u[a]}`,onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":r?"modal-title":void 0,children:[r&&d.jsxs("div",{className:"modal-header",children:[d.jsx("h2",{id:"modal-title",className:"modal-title",children:r}),s&&d.jsx("button",{className:"modal-close-btn",onClick:t,"aria-label":"Close modal",children:"✕"})]}),d.jsx("div",{className:"modal-body",children:n})]})})}function wE({isOpen:e,onClose:t,title:r,message:n,type:a="info"}){const l={info:{icon:"ℹ️",className:"alert-info"},success:{icon:"✅",className:"alert-success"},warning:{icon:"⚠️",className:"alert-warning"},error:{icon:"❌",className:"alert-error"}}[a];return J.useEffect(()=>{const u=m=>{m.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",u),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",u),document.body.style.overflow=""}},[e,t]),e?d.jsx("div",{className:"modal-overlay",onClick:t,children:d.jsxs("div",{className:`modal-content modal-sm alert-modal ${l.className}`,onClick:u=>u.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":r?"modal-title":void 0,children:[r&&d.jsxs("div",{className:"modal-header",children:[d.jsx("h2",{id:"modal-title",className:"modal-title",children:r}),d.jsx("button",{className:"modal-close-btn",onClick:t,"aria-label":"Close modal",children:"✕"})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{className:"alert-content",children:[d.jsx("div",{className:"alert-icon",children:l.icon}),d.jsx("div",{className:"alert-message",children:n})]}),d.jsx("div",{className:"modal-actions",children:d.jsx("button",{className:"btn btn-primary",onClick:t,children:"OK"})})]})]})}):null}function bE({isOpen:e,onConfirm:t,onCancel:r,title:n,message:a,confirmText:s="Confirm",cancelText:l="Cancel",type:u="info"}){const p={danger:{icon:"🗑️",confirmClass:"btn-danger"},warning:{icon:"⚠️",confirmClass:"btn-warning"},info:{icon:"ℹ️",confirmClass:"btn-primary"}}[u],g=()=>{t(),r()};return d.jsx(xp,{isOpen:e,onClose:r,title:n,size:"sm",children:d.jsxs("div",{className:"confirm-modal",children:[d.jsxs("div",{className:"confirm-content",children:[d.jsx("div",{className:"confirm-icon",children:p.icon}),d.jsx("div",{className:"confirm-message",children:a})]}),d.jsxs("div",{className:"modal-actions",children:[d.jsx("button",{className:"btn btn-ghost",onClick:r,children:l}),d.jsx("button",{className:`btn ${p.confirmClass}`,onClick:g,children:s})]})]})})}function kE({isOpen:e,onSubmit:t,onCancel:r,title:n,message:a,placeholder:s,defaultValue:l="",inputType:u="text",submitText:m="Submit",cancelText:p="Cancel"}){const[g,y]=J.useState(l);J.useEffect(()=>{e&&y(l)},[e,l]);const _=T=>{T.preventDefault(),g.trim()&&(t(g.trim()),r())};return d.jsx(xp,{isOpen:e,onClose:r,title:n,size:"sm",children:d.jsx("form",{onSubmit:_,children:d.jsxs("div",{className:"prompt-modal",children:[d.jsx("div",{className:"prompt-message",children:a}),d.jsx("input",{name:"modalInput",type:u,value:g,onChange:T=>y(T.target.value),placeholder:s,className:"input",autoFocus:!0,required:!0}),d.jsxs("div",{className:"modal-actions",children:[d.jsx("button",{type:"button",className:"btn btn-ghost",onClick:r,children:p}),d.jsx("button",{type:"submit",className:"btn btn-primary",children:m})]})]})})})}const Nf={alert:{isOpen:!1,options:{message:""}},confirm:{isOpen:!1,options:{message:""}},prompt:{isOpen:!1,options:{message:""}}};function SE(){const[e,t]=J.useState(Nf),r=J.useCallback(m=>new Promise(p=>{t(g=>({...g,alert:{isOpen:!0,options:m,resolve:p}}))}),[]),n=J.useCallback(m=>new Promise(p=>{t(g=>({...g,confirm:{isOpen:!0,options:m,resolve:p}}))}),[]),a=J.useCallback(m=>new Promise(p=>{t(g=>({...g,prompt:{isOpen:!0,options:m,resolve:p}}))}),[]),s=J.useCallback(()=>{t(m=>(m.alert.resolve&&m.alert.resolve(),{...m,alert:{...Nf.alert}}))},[]),l=J.useCallback((m=!1)=>{t(p=>(p.confirm.resolve&&p.confirm.resolve(m),{...p,confirm:{...Nf.confirm}}))},[]),u=J.useCallback((m=null)=>{t(p=>(p.prompt.resolve&&p.prompt.resolve(m),{...p,prompt:{...Nf.prompt}}))},[]);return{alertModal:e.alert,confirmModal:e.confirm,promptModal:e.prompt,alert:r,confirm:n,prompt:a,closeAlert:s,closeConfirm:l,closePrompt:u}}const Vy=J.createContext(null);function TE({children:e}){const t=SE();return d.jsxs(Vy.Provider,{value:t,children:[e,d.jsx(wE,{isOpen:t.alertModal.isOpen,onClose:t.closeAlert,title:t.alertModal.options.title,message:t.alertModal.options.message,type:t.alertModal.options.type}),d.jsx(bE,{isOpen:t.confirmModal.isOpen,onConfirm:()=>t.closeConfirm(!0),onCancel:()=>t.closeConfirm(!1),title:t.confirmModal.options.title,message:t.confirmModal.options.message,confirmText:t.confirmModal.options.confirmText,cancelText:t.confirmModal.options.cancelText,type:t.confirmModal.options.type}),d.jsx(kE,{isOpen:t.promptModal.isOpen,onSubmit:r=>t.closePrompt(r),onCancel:()=>t.closePrompt(null),title:t.promptModal.options.title,message:t.promptModal.options.message,placeholder:t.promptModal.options.placeholder,defaultValue:t.promptModal.options.defaultValue,inputType:t.promptModal.options.inputType,submitText:t.promptModal.options.submitText,cancelText:t.promptModal.options.cancelText})]})}function EE(){const e=J.useContext(Vy);if(!e)throw new Error("useModalContext must be used within a ModalProvider");return e}function CE({onSignIn:e,onSignUp:t,onResetPassword:r,isLoading:n,error:a,onClearError:s}){const[l,u]=J.useState("signin"),[m,p]=J.useState(""),[g,y]=J.useState(""),[_,T]=J.useState(""),[S,w]=J.useState(!1),[E,P]=J.useState(null),I=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,A=async R=>{if(R.preventDefault(),n)return;if(P(null),!m||m.trim()===""){P("Email is required");return}if(!I.test(m)){P("Please enter a valid email address");return}if(l==="reset"){try{await r(m),w(!0)}catch{}return}if(!g||g.trim()===""){P("Password is required");return}if(g.length<6){P("Password must be at least 6 characters");return}if(g.length>72){P("Password must be less than 72 characters");return}if(["password","123456","qwerty","abc123","password123"].includes(g.toLowerCase())){P("Please choose a stronger password");return}if(l==="signup"){if(!_||_.trim()===""){P("Please confirm your password");return}if(g!==_){P("Passwords do not match");return}}try{l==="signin"?await e(m,g):await t(m,g)}catch{}};return J.useEffect(()=>{if(a){const R=setTimeout(()=>{s()},5e3);return()=>clearTimeout(R)}},[a,s]),d.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1rem"},children:d.jsxs("div",{style:{width:"100%",maxWidth:"420px",background:"white",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[d.jsxs("div",{style:{padding:"3rem 2.5rem 2rem",textAlign:"center",background:"white"},children:[d.jsx("h1",{style:{margin:"0 0 0.75rem 0",fontSize:"2rem",fontWeight:700,color:"#1a202c",letterSpacing:"-0.025em"},children:"Navigator"}),d.jsx("p",{style:{margin:0,color:"#718096",fontSize:"0.9375rem",fontWeight:400},children:l==="signin"?"Welcome back":l==="signup"?"Create your account":"Reset your password"})]}),d.jsxs("div",{style:{padding:"0 2.5rem 2.5rem"},children:[(a||E)&&d.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",background:"#fee2e2",borderLeft:"4px solid #dc2626",borderRadius:"6px",color:"#991b1b",fontSize:"0.875rem",lineHeight:"1.5"},children:E||a}),l==="reset"&&S&&d.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",background:"#d1fae5",borderLeft:"4px solid #059669",borderRadius:"6px",color:"#065f46",fontSize:"0.875rem",lineHeight:"1.5"},children:"Password reset email sent! Check your inbox."}),d.jsx("form",{onSubmit:A,children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.25rem"},children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Email address"}),d.jsx("input",{id:"email",name:"email",type:"email",value:m,onChange:R=>p(R.target.value),disabled:n,required:!0,autoComplete:"email",placeholder:"you@example.com",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:R=>R.target.style.borderColor="#667eea",onBlur:R=>R.target.style.borderColor="#d1d5db"})]}),l!=="reset"&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Password"}),d.jsx("input",{id:"password",name:"password",type:"password",value:g,onChange:R=>y(R.target.value),disabled:n,minLength:6,required:!0,autoComplete:l==="signup"?"new-password":"current-password",placeholder:"Enter your password",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:R=>R.target.style.borderColor="#667eea",onBlur:R=>R.target.style.borderColor="#d1d5db"})]}),l==="signup"&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"confirmPassword",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Confirm password"}),d.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:_,onChange:R=>T(R.target.value),disabled:n,minLength:6,required:!0,autoComplete:"new-password",placeholder:"Confirm your password",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:R=>R.target.style.borderColor="#667eea",onBlur:R=>R.target.style.borderColor="#d1d5db"})]}),d.jsx("button",{type:"submit",disabled:n,style:{width:"100%",marginTop:"0.5rem",padding:"0.875rem 1rem",fontSize:"1rem",fontWeight:600,color:"white",background:n?"#9ca3af":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"8px",cursor:n?"not-allowed":"pointer",transition:"all 0.15s ease",boxShadow:"0 4px 6px rgba(102, 126, 234, 0.25)"},onMouseEnter:R=>!n&&(R.currentTarget.style.transform="translateY(-1px)"),onMouseLeave:R=>R.currentTarget.style.transform="translateY(0)",children:n?l==="signin"?"Signing in...":l==="signup"?"Creating account...":"Sending reset email...":l==="signin"?"Sign In":l==="signup"?"Create Account":"Send Reset Link"})]})}),l==="signin"&&d.jsx("div",{style:{textAlign:"center",marginTop:"1rem"},children:d.jsx("button",{type:"button",onClick:()=>{u("reset"),w(!1),s()},style:{background:"none",border:"none",color:"#667eea",fontSize:"0.875rem",cursor:"pointer",fontWeight:500,textDecoration:"none"},onMouseEnter:R=>R.currentTarget.style.textDecoration="underline",onMouseLeave:R=>R.currentTarget.style.textDecoration="none",children:"Forgot your password?"})}),d.jsx("div",{style:{position:"relative",margin:"1.5rem 0",height:"1px",background:"#e5e7eb"},children:d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"0 1rem",background:"white",color:"#9ca3af",fontSize:"0.75rem",fontWeight:500},children:"OR"})}),d.jsx("div",{style:{textAlign:"center",fontSize:"0.875rem",color:"#6b7280"},children:l==="reset"?d.jsxs(d.Fragment,{children:["Remember your password?"," ",d.jsx("button",{type:"button",onClick:()=>{u("signin"),w(!1),s()},style:{background:"none",border:"none",color:"#667eea",fontWeight:600,cursor:"pointer",fontSize:"inherit"},onMouseEnter:R=>R.currentTarget.style.textDecoration="underline",onMouseLeave:R=>R.currentTarget.style.textDecoration="none",children:"Sign in"})]}):d.jsxs(d.Fragment,{children:[l==="signin"?"New to Navigator?":"Already have an account?"," ",d.jsx("button",{type:"button",onClick:()=>{u(l==="signin"?"signup":"signin"),T(""),w(!1),s()},style:{background:"none",border:"none",color:"#667eea",fontWeight:600,cursor:"pointer",fontSize:"inherit"},onMouseEnter:R=>R.currentTarget.style.textDecoration="underline",onMouseLeave:R=>R.currentTarget.style.textDecoration="none",children:l==="signin"?"Create account":"Sign in"})]})})]})]})})}function es({isLoading:e=!1,loadingText:t="Loading...",children:r,disabled:n,...a}){return d.jsxs("button",{...a,disabled:n||e,className:`${a.className||""} ${e?"btn-loading":""}`.trim(),children:[e&&d.jsx("span",{className:"loading-spinner","aria-hidden":"true",children:d.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"spinner-icon",children:d.jsx("circle",{cx:"8",cy:"8",r:"6",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"37.7",strokeDashoffset:"37.7"})})}),d.jsx("span",{className:e?"loading-text":"",children:e?t:r})]})}function AE({size:e="md",text:t,className:r=""}){const a={sm:"16",md:"24",lg:"32"}[e];return d.jsxs("div",{className:`loading-spinner-container ${r}`,children:[d.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",className:"loading-spinner-icon",children:d.jsx("circle",{cx:"12",cy:"12",r:"9",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"56.5",strokeDashoffset:"56.5"})}),t&&d.jsx("span",{className:"loading-text",children:t})]})}function yp({state:e,arrangement:t,preSelectedAddressIndex:r,onAddAddress:n,onSave:a,onCancel:s,isLoading:l=!1,onComplete:u,fullscreen:m=!1}){const p=rr.useRef(null),[g,y]=rr.useState(!1),[_,T]=rr.useState((r!=null,"existing")),[S,w]=rr.useState({addressIndex:t?.addressIndex??r??0,manualAddress:"",customerName:t?.customerName??"",phoneNumber:t?.phoneNumber??"",totalAmount:t?.amount??"",scheduledDate:t?.scheduledDate??new Date().toISOString().slice(0,10),scheduledTime:t?.scheduledTime??"",notes:t?.notes??"",status:t?.status??"Scheduled",previousPayments:[],isRecurring:!1,recurrenceType:"weekly",recurrenceInterval:1,totalPayments:4}),[E,P]=rr.useState({}),[I,A]=rr.useState(()=>{try{const U=localStorage.getItem("uaf-collapsed-sections");return U?JSON.parse(U):{previousPayments:!1,recurringPayments:!0}}catch{return{previousPayments:!1,recurringPayments:!0}}}),[R,K]=rr.useState(!1);rr.useEffect(()=>{try{localStorage.setItem("uaf-collapsed-sections",JSON.stringify(I))}catch(U){console.error("Failed to save collapse preferences:",U)}},[I]);const W=U=>{A(z=>({...z,[U]:!z[U]}))},D=S.previousPayments.reduce((U,z)=>U+parseFloat(z.amount||"0"),0),ee=parseFloat(S.totalAmount||"0"),re=ee-D,pe=S.previousPayments.length>0,ue=rr.useMemo(()=>[...S.previousPayments].sort((U,z)=>new Date(U.date).getTime()-new Date(z.date).getTime()),[S.previousPayments]),ce=rr.useMemo(()=>{if(!S.isRecurring||S.totalPayments<2)return[];const U=[],z=Fa(S.scheduledDate);for(let q=0;q<S.totalPayments;q++){let M=z;S.recurrenceType==="weekly"?M=sx(z,q*S.recurrenceInterval):S.recurrenceType==="biweekly"?M=sx(z,q*2):S.recurrenceType==="monthly"&&(M=Tk(z,q*S.recurrenceInterval)),U.push(qf(M,"MMM d, yyyy"))}return U},[S.isRecurring,S.scheduledDate,S.recurrenceType,S.recurrenceInterval,S.totalPayments]),Ce=rr.useMemo(()=>{if(!t||!t.recurrenceType||t.recurrenceType==="none")return 0;const U=t.paymentsMade||0,z=t.totalPayments||1;return Math.round(U/z*100)},[t]);rr.useEffect(()=>{if(t){const U=t.addressIndex>=0&&t.addressIndex<e.addresses.length,z=U?e.addresses[t.addressIndex]?.address:null,q=t.address;!U||!(z===q)?(T("manual"),w(oe=>({...oe,addressIndex:0,manualAddress:q,customerName:t.customerName??"",phoneNumber:t.phoneNumber??"",totalAmount:t.amount??"",scheduledDate:t.scheduledDate,scheduledTime:t.scheduledTime??"",notes:t.notes??"",status:t.status}))):(T("existing"),w(oe=>({...oe,addressIndex:t.addressIndex,manualAddress:"",customerName:t.customerName??"",phoneNumber:t.phoneNumber??"",totalAmount:t.amount??"",scheduledDate:t.scheduledDate,scheduledTime:t.scheduledTime??"",notes:t.notes??"",status:t.status}))),t.recurrenceType&&t.recurrenceType!=="none"&&w(oe=>({...oe,isRecurring:!0}))}},[t,e.addresses]);const ye=U=>{const z=parseFloat(U||"0");return!U||Number.isNaN(z)||z<=0?(P(q=>({...q,amount:"Please enter a valid total amount"})),!1):(P(q=>({...q,amount:void 0})),!0)},he=()=>{let U=!0;return ye(S.totalAmount)||(U=!1),re<0&&(P(z=>({...z,amount:"Previous payments exceed total amount"})),U=!1),_==="existing"&&e.addresses.length===0&&(P(z=>({...z,address:"No addresses available"})),U=!1),_==="manual"&&!S.manualAddress.trim()&&(P(z=>({...z,address:"Please enter an address"})),U=!1),U},le=()=>{const U={id:`previous_${Date.now()}`,amount:"",date:new Date().toISOString().slice(0,10),notes:""};w(z=>({...z,previousPayments:[...z.previousPayments,U]}))},j=(U,z)=>{w(q=>({...q,previousPayments:q.previousPayments.map(M=>M.id===U?{...M,...z}:M)}))},H=U=>{w(z=>({...z,previousPayments:z.previousPayments.filter(q=>q.id!==U)}))},O=async U=>{U&&U.preventDefault(),!(g||l)&&he()&&K(!0)},ne=async()=>{K(!1),y(!0);try{let U=S.addressIndex,z="";if(_==="existing"){const se=e.addresses[S.addressIndex];if(!se)throw new Error("Selected address is not valid");if(S.addressIndex<0||S.addressIndex>=e.addresses.length){const fe=e.addresses.findIndex(xe=>xe.address.toLowerCase().trim()===se.address.toLowerCase().trim());if(fe>=0)U=fe,z=e.addresses[fe].address;else throw new Error("Selected address is no longer available")}else z=se.address}else{const se=e.addresses.findIndex(fe=>fe.address.toLowerCase().trim()===S.manualAddress.toLowerCase().trim());if(se>=0)U=se,z=e.addresses[se].address;else{if(!n)throw new Error("Cannot add new addresses");const fe={address:S.manualAddress.trim(),lat:null,lng:null};U=await n(fe),z=fe.address}}const q=re>0?re:ee;let M=q;S.isRecurring&&S.totalPayments>1&&(M=q/S.totalPayments);const oe={addressIndex:U,address:z,customerName:S.customerName,phoneNumber:S.phoneNumber,scheduledDate:S.scheduledDate,scheduledTime:S.scheduledTime,amount:M.toFixed(2),notes:S.notes,status:S.status,recurrenceType:S.isRecurring?S.recurrenceType:"none",recurrenceInterval:S.isRecurring?S.recurrenceInterval:void 0,totalPayments:S.isRecurring?S.totalPayments:1,paymentsMade:t?.paymentsMade??0};await a(oe);for(const se of S.previousPayments)if(parseFloat(se.amount)>0)try{u(U,"PIF",se.amount)}catch(fe){console.error("Error recording previous payment:",fe)}}catch(U){console.error("Error saving arrangement:",U),alert(`Failed to save arrangement: ${U instanceof Error?U.message:"Please try again."}`)}finally{y(!1)}};rr.useEffect(()=>{if(!m)return;const U=z=>{z.key==="Escape"&&s()};return document.addEventListener("keydown",U),()=>document.removeEventListener("keydown",U)},[m,s]);const Y=d.jsxs("form",{onSubmit:O,className:"uaf-form",children:[d.jsxs("div",{className:"uaf-header",children:[d.jsx("h3",{className:"uaf-title",children:t?"✏️ Edit Payment Arrangement":"➕ Create Payment Arrangement"}),m&&d.jsx("button",{type:"button",className:"uaf-close",onClick:s,"aria-label":"Close",children:"✕"})]}),d.jsxs("div",{className:"uaf-section",children:[d.jsx("h4",{className:"uaf-section-title",children:"📍 Address & Customer"}),!t&&d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Address Source"}),d.jsxs("div",{className:"uaf-radio-group",children:[d.jsxs("label",{className:"uaf-radio-option",children:[d.jsx("input",{type:"radio",checked:_==="existing",onChange:()=>T("existing")}),d.jsx("span",{children:"📋 From List"})]}),d.jsxs("label",{className:"uaf-radio-option",children:[d.jsx("input",{type:"radio",checked:_==="manual",onChange:()=>T("manual")}),d.jsx("span",{children:"✏️ Enter Manually"})]})]})]}),_==="existing"?d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Address *"}),e.addresses.length===0?d.jsx("div",{className:"uaf-warning",children:'⚠️ No addresses in your list. Switch to "Enter Manually" to add a new address.'}):d.jsx("select",{value:S.addressIndex,onChange:U=>w(z=>({...z,addressIndex:parseInt(U.target.value)})),className:"uaf-input",required:!0,children:e.addresses.map((U,z)=>d.jsxs("option",{value:z,children:["#",z+1," - ",U.address]},z))})]}):d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Address *"}),d.jsx("input",{type:"text",value:S.manualAddress,onChange:U=>w(z=>({...z,manualAddress:U.target.value})),className:"uaf-input",placeholder:"Enter full address",required:!0}),d.jsx("div",{className:"uaf-hint",children:"💡 If this address doesn't exist in your list, it will be automatically added."})]}),d.jsxs("div",{className:"uaf-row",children:[d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Customer Name"}),d.jsx("input",{type:"text",value:S.customerName,onChange:U=>w(z=>({...z,customerName:U.target.value})),className:"uaf-input",placeholder:"Customer name"})]}),d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Phone Number"}),d.jsx("input",{type:"tel",value:S.phoneNumber,onChange:U=>w(z=>({...z,phoneNumber:U.target.value})),className:"uaf-input",placeholder:"Phone number"})]})]})]}),d.jsxs("div",{className:"uaf-section",children:[d.jsx("h4",{className:"uaf-section-title",children:"💰 Payment Details"}),d.jsxs("div",{className:"uaf-row",children:[d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Total Amount Owed *"}),d.jsxs("div",{className:"uaf-amount-input-wrapper",children:[d.jsx("span",{className:"uaf-amount-symbol",children:"£"}),d.jsx("input",{type:"number",step:"0.01",min:"0",value:S.totalAmount,onChange:U=>{w(z=>({...z,totalAmount:U.target.value})),ye(U.target.value)},className:`uaf-input uaf-amount-input ${E.amount?"uaf-input-error":""}`,placeholder:"0.00",required:!0})]}),E.amount&&d.jsx("div",{className:"uaf-error",children:E.amount})]}),d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Due Date *"}),d.jsx("input",{type:"date",value:S.scheduledDate,onChange:U=>w(z=>({...z,scheduledDate:U.target.value})),className:"uaf-input",required:!0})]})]}),d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Time (Optional)"}),d.jsx("input",{type:"time",value:S.scheduledTime,onChange:U=>w(z=>({...z,scheduledTime:U.target.value})),className:"uaf-input"})]})]}),d.jsxs("div",{className:"uaf-section",children:[d.jsxs("div",{className:"uaf-section-header uaf-section-header-collapsible",onClick:()=>W("previousPayments"),children:[d.jsxs("h4",{className:"uaf-section-title",children:[d.jsx("span",{className:"uaf-collapse-icon",children:I.previousPayments?"▶":"▼"}),"💳 Payments Already Made ",pe&&`(${S.previousPayments.length})`]}),d.jsx("button",{type:"button",onClick:U=>{U.stopPropagation(),le()},className:"uaf-btn uaf-btn-sm uaf-btn-outline",children:"+ Add Payment"})]}),!I.previousPayments&&d.jsxs(d.Fragment,{children:[S.previousPayments.length===0?d.jsx("div",{className:"uaf-empty",children:"No previous payments recorded yet."}):d.jsx("div",{className:"uaf-payments-list",children:ue.map(U=>d.jsxs("div",{className:"uaf-payment-item",children:[d.jsxs("div",{className:"uaf-row",children:[d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Amount"}),d.jsx("input",{type:"number",step:"0.01",min:"0",value:U.amount,onChange:z=>j(U.id,{amount:z.target.value}),className:"uaf-input",placeholder:"0.00"})]}),d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Date Paid"}),d.jsx("input",{type:"date",value:U.date,onChange:z=>j(U.id,{date:z.target.value}),className:"uaf-input"})]}),d.jsx("div",{className:"uaf-field uaf-field-actions",children:d.jsx("button",{type:"button",onClick:()=>H(U.id),className:"uaf-btn uaf-btn-sm uaf-btn-danger",title:"Remove payment",children:"🗑️"})})]}),d.jsx("div",{className:"uaf-field",children:d.jsx("input",{type:"text",value:U.notes||"",onChange:z=>j(U.id,{notes:z.target.value}),className:"uaf-input",placeholder:"Payment notes (optional)"})})]},U.id))}),pe&&d.jsxs("div",{className:"uaf-payment-summary",children:[d.jsxs("div",{className:"uaf-summary-row",children:[d.jsx("span",{children:"Total Amount Owed:"}),d.jsxs("span",{children:["£",parseFloat(S.totalAmount||"0").toFixed(2)]})]}),d.jsxs("div",{className:"uaf-summary-row",children:[d.jsx("span",{children:"Already Paid:"}),d.jsxs("span",{children:["-£",D.toFixed(2)]})]}),d.jsxs("div",{className:"uaf-summary-row uaf-summary-total",children:[d.jsx("span",{children:"Still Owed:"}),d.jsxs("span",{children:["£",Math.max(0,re).toFixed(2)]})]})]})]})]}),re>0&&d.jsxs("div",{className:"uaf-section",children:[d.jsx("div",{className:"uaf-section-header uaf-section-header-collapsible",onClick:()=>W("recurringPayments"),children:d.jsxs("h4",{className:"uaf-section-title",children:[d.jsx("span",{className:"uaf-collapse-icon",children:I.recurringPayments?"▶":"▼"}),"🔄 Optional: Split Remaining Balance"]})}),!I.recurringPayments&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"uaf-field",children:d.jsxs("label",{className:"uaf-radio-option",children:[d.jsx("input",{type:"checkbox",checked:S.isRecurring,onChange:U=>w(z=>({...z,isRecurring:U.target.checked}))}),d.jsxs("span",{children:["Split £",re.toFixed(2)," into multiple payments"]})]})}),S.isRecurring&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"uaf-row",children:[d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Frequency"}),d.jsxs("select",{value:S.recurrenceType,onChange:U=>w(z=>({...z,recurrenceType:U.target.value})),className:"uaf-input",children:[d.jsx("option",{value:"weekly",children:"Weekly"}),d.jsx("option",{value:"biweekly",children:"Bi-weekly (Every 2 weeks)"}),d.jsx("option",{value:"monthly",children:"Monthly"})]})]}),d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Number of Payments"}),d.jsx("input",{type:"number",min:"2",max:"12",value:S.totalPayments,onChange:U=>w(z=>({...z,totalPayments:parseInt(U.target.value)||2})),className:"uaf-input"})]})]}),d.jsxs("div",{className:"uaf-payment-preview",children:["💡 ",S.totalPayments," payments of £",(re/S.totalPayments).toFixed(2)," each"]}),ce.length>0&&d.jsxs("div",{className:"uaf-timeline",children:[d.jsx("div",{className:"uaf-timeline-title",children:"📅 Payment Schedule:"}),d.jsx("div",{className:"uaf-timeline-dates",children:ce.map((U,z)=>d.jsxs("div",{className:"uaf-timeline-item",children:[d.jsx("span",{className:"uaf-timeline-number",children:z+1}),d.jsx("span",{className:"uaf-timeline-date",children:U}),d.jsxs("span",{className:"uaf-timeline-amount",children:["£",(re/S.totalPayments).toFixed(2)]})]},z))})]}),t&&t.recurrenceType&&t.recurrenceType!=="none"&&d.jsxs("div",{className:"uaf-completion-progress",children:[d.jsxs("div",{className:"uaf-completion-header",children:[d.jsx("span",{children:"Payment Progress"}),d.jsxs("span",{className:"uaf-completion-text",children:[t.paymentsMade||0," of ",t.totalPayments||1," (",Ce,"%)"]})]}),d.jsx("div",{className:"uaf-completion-bar",children:d.jsx("div",{className:"uaf-completion-fill",style:{width:`${Ce}%`}})})]})]})]})]}),d.jsx("div",{className:"uaf-section",children:d.jsxs("div",{className:"uaf-field",children:[d.jsx("label",{className:"uaf-label",children:"Notes"}),d.jsx("textarea",{value:S.notes,onChange:U=>w(z=>({...z,notes:U.target.value})),className:"uaf-input uaf-textarea",rows:3,placeholder:"Payment terms, special instructions, etc..."})]})}),d.jsxs("div",{className:"uaf-actions",children:[d.jsx("button",{type:"button",className:"uaf-btn uaf-btn-ghost",onClick:s,children:"Cancel"}),d.jsxs(es,{type:"submit",className:"uaf-btn uaf-btn-primary",isLoading:l||g,loadingText:t?"Updating...":"Creating...",disabled:_==="existing"&&e.addresses.length===0,children:[t?"💾 Update":"📅 Review & Create"," Arrangement"]})]}),R&&d.jsx("div",{className:"uaf-confirmation-overlay",onClick:()=>K(!1),children:d.jsxs("div",{className:"uaf-confirmation-modal",onClick:U=>U.stopPropagation(),children:[d.jsx("div",{className:"uaf-confirmation-header",children:d.jsx("h3",{children:"✅ Confirm Arrangement Details"})}),d.jsxs("div",{className:"uaf-confirmation-body",children:[d.jsxs("div",{className:"uaf-confirmation-section",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"📍 Address"}),d.jsx("div",{className:"uaf-confirmation-value",children:_==="existing"?e.addresses[S.addressIndex]?.address:S.manualAddress})]}),S.customerName&&d.jsxs("div",{className:"uaf-confirmation-section",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"👤 Customer"}),d.jsx("div",{className:"uaf-confirmation-value",children:S.customerName})]}),d.jsxs("div",{className:"uaf-confirmation-section",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"💰 Total Amount"}),d.jsxs("div",{className:"uaf-confirmation-value uaf-confirmation-amount",children:["£",parseFloat(S.totalAmount||"0").toFixed(2)]})]}),pe&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"uaf-confirmation-section",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"💳 Previous Payments"}),d.jsxs("div",{className:"uaf-confirmation-value",children:["£",D.toFixed(2)," (",S.previousPayments.length," payment",S.previousPayments.length>1?"s":"",")"]})]}),d.jsxs("div",{className:"uaf-confirmation-section",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"📊 Remaining Balance"}),d.jsxs("div",{className:"uaf-confirmation-value uaf-confirmation-highlight",children:["£",re.toFixed(2)]})]})]}),d.jsxs("div",{className:"uaf-confirmation-section",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"📅 Payment Due"}),d.jsxs("div",{className:"uaf-confirmation-value",children:[qf(Fa(S.scheduledDate),"MMMM d, yyyy"),S.scheduledTime&&` at ${S.scheduledTime}`]})]}),S.isRecurring&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"uaf-confirmation-section",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"🔄 Payment Plan"}),d.jsxs("div",{className:"uaf-confirmation-value",children:[S.totalPayments," ",S.recurrenceType," payments of £",(re/S.totalPayments).toFixed(2)]})]}),d.jsxs("div",{className:"uaf-confirmation-timeline",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"📅 Schedule:"}),d.jsxs("div",{className:"uaf-confirmation-dates",children:[ce.slice(0,3).map((U,z)=>d.jsx("span",{children:U},z)),ce.length>3&&d.jsxs("span",{children:["+ ",ce.length-3," more..."]})]})]})]}),S.notes&&d.jsxs("div",{className:"uaf-confirmation-section",children:[d.jsx("div",{className:"uaf-confirmation-label",children:"📝 Notes"}),d.jsx("div",{className:"uaf-confirmation-value",children:S.notes})]})]}),d.jsxs("div",{className:"uaf-confirmation-actions",children:[d.jsx("button",{type:"button",className:"uaf-btn uaf-btn-ghost",onClick:()=>K(!1),children:"← Back to Edit"}),d.jsx(es,{type:"button",className:"uaf-btn uaf-btn-success",isLoading:g,loadingText:"Creating...",onClick:ne,children:"✅ Confirm & Create"})]})]})})]}),F=d.jsx("style",{children:`
        /* Unified Arrangement Form Styles */
        .uaf-container {
          background: var(--card-bg, white);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 12px;
          overflow: hidden;
        }

        .uaf-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 4000;
          display: flex;
          align-items: flex-start;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          overflow-y: auto;
          padding-top: 2rem;
        }

        .uaf-modal {
          background: var(--card-bg, white);
          border-radius: 16px;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
          width: 100%;
          max-width: 700px;
          max-height: 90vh;
          overflow-y: auto;
          margin: 0 auto;
        }

        .uaf-form {
          padding: 1.5rem;
          color: var(--text-primary);
        }

        .uaf-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 2rem;
          padding-bottom: 1rem;
          border-bottom: 1px solid var(--border, #e2e8f0);
        }

        .uaf-title {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          padding: 0.5rem;
          border-radius: 8px;
          cursor: pointer;
          color: var(--text-muted);
          line-height: 1;
        }

        .uaf-close:hover {
          background: var(--gray-100);
        }

        .uaf-section {
          margin-bottom: 1.5rem;
          padding: 0;
          background: transparent;
          border-radius: 0;
          border: none;
          border-bottom: 1px solid var(--border, #e2e8f0);
          padding-bottom: 1.5rem;
        }

        .uaf-section:last-of-type {
          border-bottom: none;
          padding-bottom: 0;
        }

        .uaf-section-title {
          margin: 0 0 1rem 0;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-section-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .uaf-field {
          margin-bottom: 1rem;
        }

        .uaf-field-actions {
          display: flex;
          align-items: flex-end;
        }

        .uaf-label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          margin-bottom: 0.5rem;
        }

        .uaf-input {
          width: 100%;
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
          padding: 0.75rem;
          font-size: 14px;
          background: var(--input-bg, white);
          color: var(--text-primary);
          transition: border-color 0.15s ease;
        }

        .uaf-input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14,165,233,0.1);
        }

        .uaf-input-error {
          border-color: var(--danger, #dc2626);
        }

        .uaf-textarea {
          resize: vertical;
          min-height: 80px;
        }

        .uaf-error {
          color: var(--danger, #dc2626);
          font-size: 0.8125rem;
          margin-top: 0.25rem;
        }

        .uaf-warning {
          padding: 0.75rem;
          background: var(--warning-light, #fef3c7);
          border: 1px solid var(--warning, #f59e0b);
          border-radius: 6px;
          color: var(--warning-dark, #92400e);
          font-size: 0.875rem;
        }

        .uaf-hint {
          font-size: 0.8125rem;
          color: var(--text-muted);
          margin-top: 0.25rem;
        }

        .uaf-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
          align-items: start;
        }

        .uaf-radio-group {
          display: flex;
          gap: 1rem;
          flex-wrap: wrap;
        }

        .uaf-radio-option {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          cursor: pointer;
          padding: 0.5rem 1rem;
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
          background: var(--input-bg, white);
          transition: all 0.15s ease;
        }

        .uaf-radio-option:hover {
          border-color: var(--primary, #0ea5e9);
        }

        .uaf-radio-option input[type="radio"] {
          margin: 0;
        }

        .uaf-radio-option input[type="radio"]:checked + span {
          font-weight: 600;
          color: var(--primary, #0ea5e9);
        }

        .uaf-payment-preview {
          padding: 0.75rem;
          background: var(--blue-50, #eff6ff);
          border: 1px solid var(--blue-200, #bfdbfe);
          border-radius: 6px;
          color: var(--blue-700, #1d4ed8);
          font-size: 0.875rem;
          font-weight: 500;
        }

        .uaf-empty {
          text-align: center;
          padding: 2rem;
          color: var(--text-muted);
          font-style: italic;
        }

        .uaf-payments-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .uaf-payment-item {
          padding: 1rem;
          background: var(--input-bg, white);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-payment-summary {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-summary-row {
          display: flex;
          justify-content: space-between;
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .uaf-summary-total {
          border-top: 1px solid var(--border, #e2e8f0);
          padding-top: 0.5rem;
          margin-top: 0.5rem;
          font-weight: 600;
          font-size: 1rem;
          color: var(--success-dark, #059669);
        }

        .uaf-actions {
          display: flex;
          gap: 0.75rem;
          justify-content: flex-end;
          padding-top: 1rem;
          border-top: 1px solid var(--border, #e2e8f0);
        }

        .uaf-btn {
          border-radius: 6px;
          padding: 0.75rem 1.5rem;
          font-weight: 500;
          border: 1px solid transparent;
          cursor: pointer;
          transition: all 0.15s ease;
          font-size: 14px;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
        }

        .uaf-btn-sm {
          padding: 0.5rem 1rem;
          font-size: 0.875rem;
        }

        .uaf-btn-ghost {
          background: var(--card-bg, white);
          border-color: var(--border, #e2e8f0);
          color: var(--text-primary);
        }

        .uaf-btn-ghost:hover {
          background: var(--gray-100, #f3f4f6);
        }

        .uaf-btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
          border-color: var(--primary, #0ea5e9);
        }

        .uaf-btn-primary:hover {
          background: var(--primary-dark, #0284c7);
        }

        .uaf-btn-outline {
          background: transparent;
          border-color: var(--primary, #0ea5e9);
          color: var(--primary, #0ea5e9);
        }

        .uaf-btn-outline:hover {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .uaf-btn-danger {
          background: var(--danger, #dc2626);
          color: white;
          border-color: var(--danger, #dc2626);
        }

        .uaf-btn-danger:hover {
          background: var(--danger-dark, #b91c1c);
        }

        .uaf-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .uaf-btn-success {
          background: var(--success, #10b981);
          color: white;
          border-color: var(--success, #10b981);
        }

        .uaf-btn-success:hover {
          background: var(--success-dark, #059669);
        }

        /* Collapsible Section Styles */
        .uaf-section-header-collapsible {
          cursor: pointer;
          user-select: none;
        }

        .uaf-section-header-collapsible:hover {
          background: var(--gray-50, #f9fafb);
          border-radius: 6px;
          margin: -0.5rem;
          padding: 0.5rem;
        }

        .uaf-collapse-icon {
          display: inline-block;
          margin-right: 0.5rem;
          font-size: 0.75rem;
          transition: transform 0.2s ease;
        }

        /* Amount Input with £ Symbol */
        .uaf-amount-input-wrapper {
          position: relative;
          display: flex;
          align-items: center;
        }

        .uaf-amount-symbol {
          position: absolute;
          left: 0.75rem;
          font-size: 1.1rem;
          font-weight: 600;
          color: var(--success, #10b981);
          z-index: 1;
          pointer-events: none;
        }

        .uaf-amount-input {
          padding-left: 2rem !important;
          font-weight: 600;
          color: var(--success-dark, #059669);
          border-color: var(--success-light, #a7f3d0) !important;
          background: var(--success-lighter, #f0fdf4) !important;
        }

        .uaf-amount-input:focus {
          border-color: var(--success, #10b981) !important;
          box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1) !important;
        }

        /* Timeline Styles */
        .uaf-timeline {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-timeline-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-secondary);
          margin-bottom: 0.75rem;
        }

        .uaf-timeline-dates {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .uaf-timeline-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: 4px;
          border-left: 3px solid var(--primary, #0ea5e9);
        }

        .uaf-timeline-number {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 1.5rem;
          height: 1.5rem;
          background: var(--primary, #0ea5e9);
          color: white;
          border-radius: 50%;
          font-size: 0.75rem;
          font-weight: 600;
          flex-shrink: 0;
        }

        .uaf-timeline-date {
          flex: 1;
          font-size: 0.875rem;
          color: var(--text-primary);
        }

        .uaf-timeline-amount {
          font-weight: 600;
          color: var(--success-dark, #059669);
          font-size: 0.875rem;
        }

        /* Completion Progress Bar */
        .uaf-completion-progress {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--blue-50, #eff6ff);
          border: 1px solid var(--blue-200, #bfdbfe);
          border-radius: 6px;
        }

        .uaf-completion-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--blue-700, #1d4ed8);
        }

        .uaf-completion-text {
          font-size: 0.8125rem;
        }

        .uaf-completion-bar {
          width: 100%;
          height: 0.5rem;
          background: var(--blue-100, #dbeafe);
          border-radius: 1rem;
          overflow: hidden;
        }

        .uaf-completion-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--success, #10b981), var(--primary, #0ea5e9));
          transition: width 0.3s ease;
          border-radius: 1rem;
        }

        /* Confirmation Modal Styles */
        .uaf-confirmation-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.6);
          z-index: 5000;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        .uaf-confirmation-modal {
          background: var(--card-bg, white);
          border-radius: 16px;
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          width: 100%;
          max-width: 550px;
          max-height: 85vh;
          overflow-y: auto;
          animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .uaf-confirmation-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--border, #e2e8f0);
          background: var(--gray-50, #f9fafb);
        }

        .uaf-confirmation-header h3 {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-confirmation-body {
          padding: 1.5rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .uaf-confirmation-section {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .uaf-confirmation-label {
          font-size: 0.8125rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .uaf-confirmation-value {
          font-size: 1rem;
          color: var(--text-primary);
          font-weight: 500;
        }

        .uaf-confirmation-amount {
          font-size: 1.5rem;
          font-weight: 700;
          color: var(--success-dark, #059669);
        }

        .uaf-confirmation-highlight {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--primary, #0ea5e9);
        }

        .uaf-confirmation-timeline {
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border-radius: 6px;
          border: 1px solid var(--border, #e2e8f0);
        }

        .uaf-confirmation-dates {
          display: flex;
          flex-wrap: wrap;
          gap: 0.5rem;
          margin-top: 0.5rem;
        }

        .uaf-confirmation-dates span {
          padding: 0.25rem 0.75rem;
          background: var(--primary-light, #e0f2fe);
          color: var(--primary-dark, #0369a1);
          border-radius: 4px;
          font-size: 0.8125rem;
          font-weight: 500;
        }

        .uaf-confirmation-actions {
          display: flex;
          gap: 0.75rem;
          padding: 1.5rem;
          border-top: 1px solid var(--border, #e2e8f0);
          background: var(--gray-50, #f9fafb);
        }

        .uaf-confirmation-actions .uaf-btn {
          flex: 1;
        }

        /* Dark mode styles */
        .dark-mode .uaf-container,
        .dark-mode .uaf-modal {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-section {
          background: transparent;
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-summary {
          background: var(--gray-300);
          border-color: var(--gray-400);
        }

        .dark-mode .uaf-input {
          background: var(--gray-100);
          border-color: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .uaf-radio-option {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-preview {
          background: var(--blue-100);
          border-color: var(--blue-300);
          color: var(--blue-800);
        }

        .dark-mode .uaf-warning {
          background: var(--yellow-100);
          border-color: var(--yellow-400);
          color: var(--yellow-800);
        }

        /* Dark mode for new components */
        .dark-mode .uaf-amount-input {
          background: var(--success-lighter, #ecfdf5) !important;
          color: var(--success-dark, #065f46);
        }

        .dark-mode .uaf-amount-symbol {
          color: var(--success-dark, #065f46);
        }

        .dark-mode .uaf-timeline {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-timeline-item {
          background: var(--gray-100);
        }

        .dark-mode .uaf-completion-progress {
          background: var(--blue-100);
          border-color: var(--blue-300);
        }

        .dark-mode .uaf-confirmation-overlay {
          background: rgba(0, 0, 0, 0.75);
        }

        .dark-mode .uaf-confirmation-modal {
          background: var(--gray-100);
        }

        .dark-mode .uaf-confirmation-header {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-confirmation-header h3 {
          color: var(--gray-800);
        }

        .dark-mode .uaf-confirmation-label {
          color: var(--gray-600);
        }

        .dark-mode .uaf-confirmation-value {
          color: var(--gray-800);
        }

        .dark-mode .uaf-confirmation-timeline {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-confirmation-actions {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .uaf-modal {
            margin: 0.5rem;
            max-width: none;
          }

          .uaf-row {
            grid-template-columns: 1fr;
          }

          .uaf-radio-group {
            flex-direction: column;
          }

          .uaf-actions {
            flex-direction: column-reverse;
          }

          .uaf-btn {
            width: 100%;
          }
        }
      `});return m?d.jsxs(d.Fragment,{children:[d.jsx("div",{ref:p,className:"uaf-overlay",onClick:U=>{U.target===U.currentTarget&&s()},children:d.jsx("div",{className:"uaf-modal",children:Y})}),F]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"uaf-container",children:Y}),F]})}class Vm{static normalizeAddress(t){return t.toLowerCase().trim().replace(/\s+/g," ").replace(/,/g,"").replace(/\./g,"").replace(/\b(flat|apt|apartment|unit|floor|fl)\b\s*\d+\s*/gi,"").replace(/\b\d+[a-z]\b/g,r=>r.replace(/[a-z]/g,""))}static getAddressHistory(t,r){const n=this.normalizeAddress(t),a=r.filter(A=>this.normalizeAddress(A.address||"")===n);if(a.length===0)return null;const s={PIF:a.filter(A=>A.outcome==="PIF").length,Done:a.filter(A=>A.outcome==="Done").length,DA:a.filter(A=>A.outcome==="DA").length,ARR:a.filter(A=>A.outcome==="ARR").length},l=a.filter(A=>A.outcome==="PIF"),u=l.reduce((A,R)=>A+parseFloat(R.amount||"0"),0),m=l.length>0?u/l.length:0,p=a.length>0?Math.round(s.PIF/a.length*100):0,g=[...a].sort((A,R)=>new Date(R.timestamp).getTime()-new Date(A.timestamp).getTime()),y=g[0],_=g.map(A=>{const R=new Date(A.timestamp);return{date:A.timestamp,outcome:A.outcome,amount:A.amount,dayOfWeek:R.toLocaleDateString("en-GB",{weekday:"long"}),hour:R.getHours()}}),T={};_.forEach(A=>{T[A.hour]||(T[A.hour]={total:0,pif:0}),T[A.hour].total++,A.outcome==="PIF"&&T[A.hour].pif++});let S,w=0;Object.entries(T).forEach(([A,R])=>{if(R.total>=2){const K=R.pif/R.total*100;K>w&&(w=K,S={hour:parseInt(A),successRate:Math.round(K)})}});const E={};_.forEach(A=>{E[A.dayOfWeek]||(E[A.dayOfWeek]={total:0,pif:0}),E[A.dayOfWeek].total++,A.outcome==="PIF"&&E[A.dayOfWeek].pif++});let P,I=0;return Object.entries(E).forEach(([A,R])=>{if(R.total>=2){const K=R.pif/R.total*100;K>I&&(I=K,P={day:A,successRate:Math.round(K)})}}),{address:t,normalizedAddress:n,totalVisits:a.length,outcomes:s,totalPIFAmount:u,averagePIFAmount:m,lastVisitDate:y.timestamp,lastOutcome:y.outcome,successRate:p,visitHistory:_,bestTimeOfDay:S,bestDayOfWeek:P}}static getHighValueAddresses(t,r=10){const n=new Map;return t.completions.forEach(a=>{const s=this.normalizeAddress(a.address||"");if(!n.has(s)){const l=this.getAddressHistory(a.address||"",t.completions);l&&n.set(s,l)}}),Array.from(n.values()).map(a=>({address:a.address,history:a})).sort((a,s)=>s.history.totalPIFAmount-a.history.totalPIFAmount).slice(0,r)}static getHighSuccessAreas(t){const r=new Map,n=a=>{const s=a.match(/\b([A-Z]{1,2}\d{1,2}[A-Z]?\s?\d[A-Z]{2})\b/i);return s?s[1].toUpperCase().split(" ")[0]:null};return t.completions.forEach(a=>{const s=n(a.address||"");if(!s)return;r.has(s)||r.set(s,{totalVisits:0,pifCount:0,pifAmounts:[],addresses:new Set});const l=r.get(s);l.totalVisits++,l.addresses.add(this.normalizeAddress(a.address||"")),a.outcome==="PIF"&&(l.pifCount++,l.pifAmounts.push(parseFloat(a.amount||"0")))}),Array.from(r.entries()).filter(([a,s])=>s.totalVisits>=5).map(([a,s])=>({area:a,totalAddresses:s.addresses.size,totalVisits:s.totalVisits,successRate:Math.round(s.pifCount/s.totalVisits*100),averagePIFAmount:s.pifAmounts.length>0?s.pifAmounts.reduce((l,u)=>l+u,0)/s.pifAmounts.length:0})).sort((a,s)=>s.successRate-a.successRate)}static getOptimalVisitTime(t){if(t.length<10)return null;const r={};t.forEach(s=>{const l=new Date(s.timestamp),u=l.getHours(),p=`${l.toLocaleDateString("en-GB",{weekday:"long"})}-${u}`;r[p]||(r[p]={total:0,pif:0}),r[p].total++,s.outcome==="PIF"&&r[p].pif++});let n=null,a=0;return Object.entries(r).forEach(([s,l])=>{if(l.total>=5){const u=l.pif/l.total*100;if(u>a){const[m,p]=s.split("-");a=u,n={hour:parseInt(p),dayOfWeek:m,successRate:Math.round(u)}}}}),n}static getRecommendations(t){const r=this.getHighValueAddresses(t,5).map(m=>m.address),n=this.getHighSuccessAreas(t).slice(0,3),a=n.map(m=>`${m.area} (${m.successRate}% success)`),s=this.getOptimalVisitTime(t.completions),l=s?`${s.dayOfWeek}s around ${s.hour}:00 (${s.successRate}% success)`:null,u=[];if(n.length>0){const m=n[0];u.push(`🎯 ${m.area} has your highest success rate at ${m.successRate}%`)}return r.length>0&&u.push("💰 Focus on high-value addresses for maximum earnings"),s&&u.push(`⏰ ${l} is your most successful time slot`),{highValueAddresses:r,bestAreas:a,optimalTime:l,insights:u}}static async cacheIntelligence(t){try{const r=this.getRecommendations(t),n=this.getHighSuccessAreas(t),a={recommendations:r,highSuccessAreas:n,timestamp:new Date().toISOString()};localStorage.setItem("navigator_address_intelligence",JSON.stringify(a)),ve.info("Address intelligence cached")}catch(r){ve.error("Failed to cache address intelligence:",r)}}static getCachedIntelligence(){try{const t=localStorage.getItem("navigator_address_intelligence");if(!t)return null;const r=JSON.parse(t);return Date.now()-new Date(r.timestamp).getTime()>3600*1e3?null:r}catch{return null}}}const NE=({address:e,completions:t})=>{const r=J.useMemo(()=>Vm.getAddressHistory(e,t),[e,t]);if(!r||r.totalVisits===0)return null;const n=a=>{switch(a){case"PIF":return"#10b981";case"Done":return"#3b82f6";case"DA":return"#f59e0b";case"ARR":return"#8b5cf6";default:return"#6b7280"}};return d.jsxs("div",{style:{background:"linear-gradient(135deg, rgba(99, 102, 241, 0.05), rgba(139, 92, 246, 0.03))",border:"1.5px solid rgba(99, 102, 241, 0.15)",borderRadius:"12px",padding:"1rem",marginTop:"0.75rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.75rem"},children:[d.jsx("span",{style:{fontSize:"1.25rem"},children:"📊"}),d.jsx("h4",{style:{margin:0,fontSize:"0.9375rem",fontWeight:600,color:"#111827"},children:"Address History"}),d.jsxs("span",{style:{padding:"0.25rem 0.625rem",background:"rgba(99, 102, 241, 0.1)",color:"#6366f1",borderRadius:"6px",fontSize:"0.75rem",fontWeight:600},children:[r.totalVisits," visit",r.totalVisits>1?"s":""]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"0.625rem",marginBottom:"0.75rem"},children:[d.jsxs("div",{style:{padding:"0.75rem",background:"white",borderRadius:"8px",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:700,color:r.successRate>50?"#10b981":"#f59e0b"},children:[r.successRate,"%"]}),d.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.125rem"},children:"Success Rate"})]}),r.averagePIFAmount>0&&d.jsxs("div",{style:{padding:"0.75rem",background:"white",borderRadius:"8px",textAlign:"center"},children:[d.jsxs("div",{style:{fontSize:"1.5rem",fontWeight:700,color:"#10b981"},children:["£",Math.round(r.averagePIFAmount)]}),d.jsx("div",{style:{fontSize:"0.75rem",color:"#6b7280",marginTop:"0.125rem"},children:"Avg PIF"})]})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.75rem"},children:Object.entries(r.outcomes).map(([a,s])=>s===0?null:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.375rem",padding:"0.375rem 0.625rem",background:"white",borderRadius:"6px",fontSize:"0.8125rem"},children:[d.jsx("div",{style:{width:"8px",height:"8px",background:n(a),borderRadius:"50%"}}),d.jsx("span",{style:{fontWeight:600,color:"#111827"},children:s}),d.jsx("span",{style:{color:"#6b7280"},children:a})]},a))}),(r.bestTimeOfDay||r.bestDayOfWeek)&&d.jsxs("div",{style:{padding:"0.625rem 0.75rem",background:"rgba(16, 185, 129, 0.08)",border:"1px solid rgba(16, 185, 129, 0.15)",borderRadius:"8px",fontSize:"0.8125rem",color:"#059669"},children:[d.jsx("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"💡 Best Visit Times:"}),d.jsxs("div",{style:{color:"#047857"},children:[r.bestTimeOfDay&&d.jsxs("div",{children:["• Around ",r.bestTimeOfDay.hour,":00 (",r.bestTimeOfDay.successRate,"% success)"]}),r.bestDayOfWeek&&d.jsxs("div",{children:["• On ",r.bestDayOfWeek.day,"s (",r.bestDayOfWeek.successRate,"% success)"]})]})]}),d.jsxs("div",{style:{marginTop:"0.75rem",paddingTop:"0.75rem",borderTop:"1px solid rgba(0, 0, 0, 0.06)",fontSize:"0.8125rem",color:"#6b7280"},children:["Last visit: ",d.jsxs("strong",{style:{color:"#111827"},children:[new Date(r.lastVisitDate).toLocaleDateString("en-GB")," (",r.lastOutcome,")"]})]})]})},PE=rr.memo(NE);function Gy(e,t){const r=J.useRef(t);J.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}var Zy=dy();const IE=1;function DE(e){return Object.freeze({__version:IE,map:e})}function Ky(e,t){return Object.freeze({...e,...t})}const Yy=J.createContext(null),qy=Yy.Provider;function gh(){const e=J.useContext(Yy);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Xy(e){function t(r,n){const{instance:a,context:s}=e(r).current;return J.useImperativeHandle(n,()=>a),r.children==null?null:rr.createElement(qy,{value:s},r.children)}return J.forwardRef(t)}function FE(e){function t(r,n){const[a,s]=J.useState(!1),{instance:l}=e(r,s).current;J.useImperativeHandle(n,()=>l),J.useEffect(function(){a&&l.update()},[l,a,r.children]);const u=l._contentNode;return u?Zy.createPortal(r.children,u):null}return J.forwardRef(t)}function jE(e){function t(r,n){const{instance:a}=e(r).current;return J.useImperativeHandle(n,()=>a),null}return J.forwardRef(t)}function _p(e,t){const r=J.useRef();J.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function vh(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function OE(e,t){return function(n,a){const s=gh(),l=e(vh(n,s),s);return Gy(s.map,n.attribution),_p(l.current,n.eventHandlers),t(l.current,s,n,a),l}}var wu={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var RE=wu.exports,Wx;function LE(){return Wx||(Wx=1,(function(e,t){(function(r,n){n(t)})(RE,(function(r){var n="1.9.4";function a(o){var f,v,b,N;for(v=1,b=arguments.length;v<b;v++){N=arguments[v];for(f in N)o[f]=N[f]}return o}var s=Object.create||(function(){function o(){}return function(f){return o.prototype=f,new o}})();function l(o,f){var v=Array.prototype.slice;if(o.bind)return o.bind.apply(o,v.call(arguments,1));var b=v.call(arguments,2);return function(){return o.apply(f,b.length?b.concat(v.call(arguments)):arguments)}}var u=0;function m(o){return"_leaflet_id"in o||(o._leaflet_id=++u),o._leaflet_id}function p(o,f,v){var b,N,G,me;return me=function(){b=!1,N&&(G.apply(v,N),N=!1)},G=function(){b?N=arguments:(o.apply(v,arguments),setTimeout(me,f),b=!0)},G}function g(o,f,v){var b=f[1],N=f[0],G=b-N;return o===b&&v?o:((o-N)%G+G)%G+N}function y(){return!1}function _(o,f){if(f===!1)return o;var v=Math.pow(10,f===void 0?6:f);return Math.round(o*v)/v}function T(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function S(o){return T(o).split(/\s+/)}function w(o,f){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?s(o.options):{});for(var v in f)o.options[v]=f[v];return o.options}function E(o,f,v){var b=[];for(var N in o)b.push(encodeURIComponent(v?N.toUpperCase():N)+"="+encodeURIComponent(o[N]));return(!f||f.indexOf("?")===-1?"?":"&")+b.join("&")}var P=/\{ *([\w_ -]+) *\}/g;function I(o,f){return o.replace(P,function(v,b){var N=f[b];if(N===void 0)throw new Error("No value provided for variable "+v);return typeof N=="function"&&(N=N(f)),N})}var A=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function R(o,f){for(var v=0;v<o.length;v++)if(o[v]===f)return v;return-1}var K="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function W(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var D=0;function ee(o){var f=+new Date,v=Math.max(0,16-(f-D));return D=f+v,window.setTimeout(o,v)}var re=window.requestAnimationFrame||W("RequestAnimationFrame")||ee,pe=window.cancelAnimationFrame||W("CancelAnimationFrame")||W("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function ue(o,f,v){if(v&&re===ee)o.call(f);else return re.call(window,l(o,f))}function ce(o){o&&pe.call(window,o)}var Ce={__proto__:null,extend:a,create:s,bind:l,get lastId(){return u},stamp:m,throttle:p,wrapNum:g,falseFn:y,formatNum:_,trim:T,splitWords:S,setOptions:w,getParamString:E,template:I,isArray:A,indexOf:R,emptyImageUrl:K,requestFn:re,cancelFn:pe,requestAnimFrame:ue,cancelAnimFrame:ce};function ye(){}ye.extend=function(o){var f=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=f.__super__=this.prototype,b=s(v);b.constructor=f,f.prototype=b;for(var N in this)Object.prototype.hasOwnProperty.call(this,N)&&N!=="prototype"&&N!=="__super__"&&(f[N]=this[N]);return o.statics&&a(f,o.statics),o.includes&&(he(o.includes),a.apply(null,[b].concat(o.includes))),a(b,o),delete b.statics,delete b.includes,b.options&&(b.options=v.options?s(v.options):{},a(b.options,o.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var G=0,me=b._initHooks.length;G<me;G++)b._initHooks[G].call(this)}},f},ye.include=function(o){var f=this.prototype.options;return a(this.prototype,o),o.options&&(this.prototype.options=f,this.mergeOptions(o.options)),this},ye.mergeOptions=function(o){return a(this.prototype.options,o),this},ye.addInitHook=function(o){var f=Array.prototype.slice.call(arguments,1),v=typeof o=="function"?o:function(){this[o].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function he(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=A(o)?o:[o];for(var f=0;f<o.length;f++)o[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var le={on:function(o,f,v){if(typeof o=="object")for(var b in o)this._on(b,o[b],f);else{o=S(o);for(var N=0,G=o.length;N<G;N++)this._on(o[N],f,v)}return this},off:function(o,f,v){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var b in o)this._off(b,o[b],f);else{o=S(o);for(var N=arguments.length===1,G=0,me=o.length;G<me;G++)N?this._off(o[G]):this._off(o[G],f,v)}return this},_on:function(o,f,v,b){if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}if(this._listens(o,f,v)===!1){v===this&&(v=void 0);var N={fn:f,ctx:v};b&&(N.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(N)}},_off:function(o,f,v){var b,N,G;if(this._events&&(b=this._events[o],!!b)){if(arguments.length===1){if(this._firingCount)for(N=0,G=b.length;N<G;N++)b[N].fn=y;delete this._events[o];return}if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}var me=this._listens(o,f,v);if(me!==!1){var Se=b[me];this._firingCount&&(Se.fn=y,this._events[o]=b=b.slice()),b.splice(me,1)}}},fire:function(o,f,v){if(!this.listens(o,v))return this;var b=a({},f,{type:o,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var N=this._events[o];if(N){this._firingCount=this._firingCount+1||1;for(var G=0,me=N.length;G<me;G++){var Se=N[G],Pe=Se.fn;Se.once&&this.off(o,Pe,Se.ctx),Pe.call(Se.ctx||this,b)}this._firingCount--}}return v&&this._propagateEvent(b),this},listens:function(o,f,v,b){typeof o!="string"&&console.warn('"string" type argument expected');var N=f;typeof f!="function"&&(b=!!f,N=void 0,v=void 0);var G=this._events&&this._events[o];if(G&&G.length&&this._listens(o,N,v)!==!1)return!0;if(b){for(var me in this._eventParents)if(this._eventParents[me].listens(o,f,v,b))return!0}return!1},_listens:function(o,f,v){if(!this._events)return!1;var b=this._events[o]||[];if(!f)return!!b.length;v===this&&(v=void 0);for(var N=0,G=b.length;N<G;N++)if(b[N].fn===f&&b[N].ctx===v)return N;return!1},once:function(o,f,v){if(typeof o=="object")for(var b in o)this._on(b,o[b],f,!0);else{o=S(o);for(var N=0,G=o.length;N<G;N++)this._on(o[N],f,v,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[m(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[m(o)],this},_propagateEvent:function(o){for(var f in this._eventParents)this._eventParents[f].fire(o.type,a({layer:o.target,propagatedFrom:o.target},o),!0)}};le.addEventListener=le.on,le.removeEventListener=le.clearAllEventListeners=le.off,le.addOneTimeEventListener=le.once,le.fireEvent=le.fire,le.hasEventListeners=le.listens;var j=ye.extend(le);function H(o,f,v){this.x=v?Math.round(o):o,this.y=v?Math.round(f):f}var O=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};H.prototype={clone:function(){return new H(this.x,this.y)},add:function(o){return this.clone()._add(ne(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(ne(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new H(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new H(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=O(this.x),this.y=O(this.y),this},distanceTo:function(o){o=ne(o);var f=o.x-this.x,v=o.y-this.y;return Math.sqrt(f*f+v*v)},equals:function(o){return o=ne(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=ne(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+_(this.x)+", "+_(this.y)+")"}};function ne(o,f,v){return o instanceof H?o:A(o)?new H(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new H(o.x,o.y):new H(o,f,v)}function Y(o,f){if(o)for(var v=f?[o,f]:o,b=0,N=v.length;b<N;b++)this.extend(v[b])}Y.prototype={extend:function(o){var f,v;if(!o)return this;if(o instanceof H||typeof o[0]=="number"||"x"in o)f=v=ne(o);else if(o=F(o),f=o.min,v=o.max,!f||!v)return this;return!this.min&&!this.max?(this.min=f.clone(),this.max=v.clone()):(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(o){return ne((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return ne(this.min.x,this.max.y)},getTopRight:function(){return ne(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var f,v;return typeof o[0]=="number"||o instanceof H?o=ne(o):o=F(o),o instanceof Y?(f=o.min,v=o.max):f=v=o,f.x>=this.min.x&&v.x<=this.max.x&&f.y>=this.min.y&&v.y<=this.max.y},intersects:function(o){o=F(o);var f=this.min,v=this.max,b=o.min,N=o.max,G=N.x>=f.x&&b.x<=v.x,me=N.y>=f.y&&b.y<=v.y;return G&&me},overlaps:function(o){o=F(o);var f=this.min,v=this.max,b=o.min,N=o.max,G=N.x>f.x&&b.x<v.x,me=N.y>f.y&&b.y<v.y;return G&&me},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var f=this.min,v=this.max,b=Math.abs(f.x-v.x)*o,N=Math.abs(f.y-v.y)*o;return F(ne(f.x-b,f.y-N),ne(v.x+b,v.y+N))},equals:function(o){return o?(o=F(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function F(o,f){return!o||o instanceof Y?o:new Y(o,f)}function U(o,f){if(o)for(var v=f?[o,f]:o,b=0,N=v.length;b<N;b++)this.extend(v[b])}U.prototype={extend:function(o){var f=this._southWest,v=this._northEast,b,N;if(o instanceof q)b=o,N=o;else if(o instanceof U){if(b=o._southWest,N=o._northEast,!b||!N)return this}else return o?this.extend(M(o)||z(o)):this;return!f&&!v?(this._southWest=new q(b.lat,b.lng),this._northEast=new q(N.lat,N.lng)):(f.lat=Math.min(b.lat,f.lat),f.lng=Math.min(b.lng,f.lng),v.lat=Math.max(N.lat,v.lat),v.lng=Math.max(N.lng,v.lng)),this},pad:function(o){var f=this._southWest,v=this._northEast,b=Math.abs(f.lat-v.lat)*o,N=Math.abs(f.lng-v.lng)*o;return new U(new q(f.lat-b,f.lng-N),new q(v.lat+b,v.lng+N))},getCenter:function(){return new q((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new q(this.getNorth(),this.getWest())},getSouthEast:function(){return new q(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof q||"lat"in o?o=M(o):o=z(o);var f=this._southWest,v=this._northEast,b,N;return o instanceof U?(b=o.getSouthWest(),N=o.getNorthEast()):b=N=o,b.lat>=f.lat&&N.lat<=v.lat&&b.lng>=f.lng&&N.lng<=v.lng},intersects:function(o){o=z(o);var f=this._southWest,v=this._northEast,b=o.getSouthWest(),N=o.getNorthEast(),G=N.lat>=f.lat&&b.lat<=v.lat,me=N.lng>=f.lng&&b.lng<=v.lng;return G&&me},overlaps:function(o){o=z(o);var f=this._southWest,v=this._northEast,b=o.getSouthWest(),N=o.getNorthEast(),G=N.lat>f.lat&&b.lat<v.lat,me=N.lng>f.lng&&b.lng<v.lng;return G&&me},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,f){return o?(o=z(o),this._southWest.equals(o.getSouthWest(),f)&&this._northEast.equals(o.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function z(o,f){return o instanceof U?o:new U(o,f)}function q(o,f,v){if(isNaN(o)||isNaN(f))throw new Error("Invalid LatLng object: ("+o+", "+f+")");this.lat=+o,this.lng=+f,v!==void 0&&(this.alt=+v)}q.prototype={equals:function(o,f){if(!o)return!1;o=M(o);var v=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return v<=(f===void 0?1e-9:f)},toString:function(o){return"LatLng("+_(this.lat,o)+", "+_(this.lng,o)+")"},distanceTo:function(o){return se.distance(this,M(o))},wrap:function(){return se.wrapLatLng(this)},toBounds:function(o){var f=180*o/40075017,v=f/Math.cos(Math.PI/180*this.lat);return z([this.lat-f,this.lng-v],[this.lat+f,this.lng+v])},clone:function(){return new q(this.lat,this.lng,this.alt)}};function M(o,f,v){return o instanceof q?o:A(o)&&typeof o[0]!="object"?o.length===3?new q(o[0],o[1],o[2]):o.length===2?new q(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new q(o.lat,"lng"in o?o.lng:o.lon,o.alt):f===void 0?null:new q(o,f,v)}var oe={latLngToPoint:function(o,f){var v=this.projection.project(o),b=this.scale(f);return this.transformation._transform(v,b)},pointToLatLng:function(o,f){var v=this.scale(f),b=this.transformation.untransform(o,v);return this.projection.unproject(b)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var f=this.projection.bounds,v=this.scale(o),b=this.transformation.transform(f.min,v),N=this.transformation.transform(f.max,v);return new Y(b,N)},infinite:!1,wrapLatLng:function(o){var f=this.wrapLng?g(o.lng,this.wrapLng,!0):o.lng,v=this.wrapLat?g(o.lat,this.wrapLat,!0):o.lat,b=o.alt;return new q(v,f,b)},wrapLatLngBounds:function(o){var f=o.getCenter(),v=this.wrapLatLng(f),b=f.lat-v.lat,N=f.lng-v.lng;if(b===0&&N===0)return o;var G=o.getSouthWest(),me=o.getNorthEast(),Se=new q(G.lat-b,G.lng-N),Pe=new q(me.lat-b,me.lng-N);return new U(Se,Pe)}},se=a({},oe,{wrapLng:[-180,180],R:6371e3,distance:function(o,f){var v=Math.PI/180,b=o.lat*v,N=f.lat*v,G=Math.sin((f.lat-o.lat)*v/2),me=Math.sin((f.lng-o.lng)*v/2),Se=G*G+Math.cos(b)*Math.cos(N)*me*me,Pe=2*Math.atan2(Math.sqrt(Se),Math.sqrt(1-Se));return this.R*Pe}}),fe=6378137,xe={R:fe,MAX_LATITUDE:85.0511287798,project:function(o){var f=Math.PI/180,v=this.MAX_LATITUDE,b=Math.max(Math.min(v,o.lat),-v),N=Math.sin(b*f);return new H(this.R*o.lng*f,this.R*Math.log((1+N)/(1-N))/2)},unproject:function(o){var f=180/Math.PI;return new q((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*f,o.x*f/this.R)},bounds:(function(){var o=fe*Math.PI;return new Y([-o,-o],[o,o])})()};function je(o,f,v,b){if(A(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=f,this._c=v,this._d=b}je.prototype={transform:function(o,f){return this._transform(o.clone(),f)},_transform:function(o,f){return f=f||1,o.x=f*(this._a*o.x+this._b),o.y=f*(this._c*o.y+this._d),o},untransform:function(o,f){return f=f||1,new H((o.x/f-this._b)/this._a,(o.y/f-this._d)/this._c)}};function X(o,f,v,b){return new je(o,f,v,b)}var Ke=a({},se,{code:"EPSG:3857",projection:xe,transformation:(function(){var o=.5/(Math.PI*xe.R);return X(o,.5,-o,.5)})()}),Xe=a({},Ke,{code:"EPSG:900913"});function Qe(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function it(o,f){var v="",b,N,G,me,Se,Pe;for(b=0,G=o.length;b<G;b++){for(Se=o[b],N=0,me=Se.length;N<me;N++)Pe=Se[N],v+=(N?"L":"M")+Pe.x+" "+Pe.y;v+=f?Oe.svg?"z":"x":""}return v||"M0 0"}var Le=document.documentElement.style,kt="ActiveXObject"in window,ft=kt&&!document.addEventListener,pt="msLaunchUri"in navigator&&!("documentMode"in document),Gt=Ge("webkit"),Cn=Ge("android"),zr=Ge("android 2")||Ge("android 3"),Cr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),un=Cn&&Ge("Google")&&Cr<537&&!("AudioNode"in window),Fr=!!window.opera,nn=!pt&&Ge("chrome"),Jt=Ge("gecko")&&!Gt&&!Fr&&!kt,Ar=!nn&&Ge("safari"),ht=Ge("phantom"),Ct="OTransition"in Le,pr=navigator.platform.indexOf("Win")===0,Ht=kt&&"transition"in Le,ct="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!zr,oi="MozPerspective"in Le,Ii=!window.L_DISABLE_3D&&(Ht||ct||oi)&&!Ct&&!ht,Yn=typeof orientation<"u"||Ge("mobile"),La=Yn&&Gt,qn=Yn&&ct,hr=!window.PointerEvent&&window.MSPointerEvent,Xn=!!(window.PointerEvent||hr),An="ontouchstart"in window||!!window.TouchEvent,Ma=!window.L_NO_TOUCH&&(An||Xn),ls=Yn&&Fr,cs=Yn&&Jt,us=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ds=(function(){var o=!1;try{var f=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",y,f),window.removeEventListener("testPassiveEventSupport",y,f)}catch{}return o})(),Di=(function(){return!!document.createElement("canvas").getContext})(),li=!!(document.createElementNS&&Qe("svg").createSVGRect),Ba=!!li&&(function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),De=!li&&(function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var f=o.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}})(),He=navigator.platform.indexOf("Mac")===0,tt=navigator.platform.indexOf("Linux")===0;function Ge(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var Oe={ie:kt,ielt9:ft,edge:pt,webkit:Gt,android:Cn,android23:zr,androidStock:un,opera:Fr,chrome:nn,gecko:Jt,safari:Ar,phantom:ht,opera12:Ct,win:pr,ie3d:Ht,webkit3d:ct,gecko3d:oi,any3d:Ii,mobile:Yn,mobileWebkit:La,mobileWebkit3d:qn,msPointer:hr,pointer:Xn,touch:Ma,touchNative:An,mobileOpera:ls,mobileGecko:cs,retina:us,passiveEvents:ds,canvas:Di,svg:li,vml:De,inlineSvg:Ba,mac:He,linux:tt},B=Oe.msPointer?"MSPointerDown":"pointerdown",Q=Oe.msPointer?"MSPointerMove":"pointermove",Z=Oe.msPointer?"MSPointerUp":"pointerup",te=Oe.msPointer?"MSPointerCancel":"pointercancel",ie={touchstart:B,touchmove:Q,touchend:Z,touchcancel:te},ae={touchstart:Ve,touchmove:Ze,touchend:Ze,touchcancel:Ze},we={},Te=!1;function be(o,f,v){return f==="touchstart"&&nt(),ae[f]?(v=ae[f].bind(this,v),o.addEventListener(ie[f],v,!1),v):(console.warn("wrong event specified:",f),y)}function ke(o,f,v){if(!ie[f]){console.warn("wrong event specified:",f);return}o.removeEventListener(ie[f],v,!1)}function Ae(o){we[o.pointerId]=o}function ze(o){we[o.pointerId]&&(we[o.pointerId]=o)}function qe(o){delete we[o.pointerId]}function nt(){Te||(document.addEventListener(B,Ae,!0),document.addEventListener(Q,ze,!0),document.addEventListener(Z,qe,!0),document.addEventListener(te,qe,!0),Te=!0)}function Ze(o,f){if(f.pointerType!==(f.MSPOINTER_TYPE_MOUSE||"mouse")){f.touches=[];for(var v in we)f.touches.push(we[v]);f.changedTouches=[f],o(f)}}function Ve(o,f){f.MSPOINTER_TYPE_TOUCH&&f.pointerType===f.MSPOINTER_TYPE_TOUCH&&vr(f),Ze(o,f)}function St(o){var f={},v,b;for(b in o)v=o[b],f[b]=v&&v.bind?v.bind(o):v;return o=f,f.type="dblclick",f.detail=2,f.isTrusted=!1,f._simulated=!0,f}var Zt=200;function Qt(o,f){o.addEventListener("dblclick",f);var v=0,b;function N(G){if(G.detail!==1){b=G.detail;return}if(!(G.pointerType==="mouse"||G.sourceCapabilities&&!G.sourceCapabilities.firesTouchEvents)){var me=Oi(G);if(!(me.some(function(Pe){return Pe instanceof HTMLLabelElement&&Pe.attributes.for})&&!me.some(function(Pe){return Pe instanceof HTMLInputElement||Pe instanceof HTMLSelectElement}))){var Se=Date.now();Se-v<=Zt?(b++,b===2&&f(St(G))):b=1,v=Se}}}return o.addEventListener("click",N),{dblclick:f,simDblclick:N}}function gr(o,f){o.removeEventListener("dblclick",f.dblclick),o.removeEventListener("click",f.simDblclick)}var za=ms(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Mn=ms(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Jn=Mn==="webkitTransition"||Mn==="OTransition"?Mn+"End":"transitionend";function Nr(o){return typeof o=="string"?document.getElementById(o):o}function Ua(o,f){var v=o.style[f]||o.currentStyle&&o.currentStyle[f];if((!v||v==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(o,null);v=b?b[f]:null}return v==="auto"?null:v}function mt(o,f,v){var b=document.createElement(o);return b.className=f||"",v&&v.appendChild(b),b}function lr(o){var f=o.parentNode;f&&f.removeChild(o)}function ul(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function fs(o){var f=o.parentNode;f&&f.lastChild!==o&&f.appendChild(o)}function Wa(o){var f=o.parentNode;f&&f.firstChild!==o&&f.insertBefore(o,f.firstChild)}function hs(o,f){if(o.classList!==void 0)return o.classList.contains(f);var v=dl(o);return v.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(v)}function Et(o,f){if(o.classList!==void 0)for(var v=S(f),b=0,N=v.length;b<N;b++)o.classList.add(v[b]);else if(!hs(o,f)){var G=dl(o);Ac(o,(G?G+" ":"")+f)}}function ir(o,f){o.classList!==void 0?o.classList.remove(f):Ac(o,T((" "+dl(o)+" ").replace(" "+f+" "," ")))}function Ac(o,f){o.className.baseVal===void 0?o.className=f:o.className.baseVal=f}function dl(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function dn(o,f){"opacity"in o.style?o.style.opacity=f:"filter"in o.style&&md(o,f)}function md(o,f){var v=!1,b="DXImageTransform.Microsoft.Alpha";try{v=o.filters.item(b)}catch{if(f===1)return}f=Math.round(f*100),v?(v.Enabled=f!==100,v.Opacity=f):o.style.filter+=" progid:"+b+"(opacity="+f+")"}function ms(o){for(var f=document.documentElement.style,v=0;v<o.length;v++)if(o[v]in f)return o[v];return!1}function Qn(o,f,v){var b=f||new H(0,0);o.style[za]=(Oe.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(v?" scale("+v+")":"")}function wr(o,f){o._leaflet_pos=f,Oe.any3d?Qn(o,f):(o.style.left=f.x+"px",o.style.top=f.y+"px")}function $a(o){return o._leaflet_pos||new H(0,0)}var Mt,ps,fl;if("onselectstart"in document)Mt=function(){wt(window,"selectstart",vr)},ps=function(){er(window,"selectstart",vr)};else{var Fi=ms(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Mt=function(){if(Fi){var o=document.documentElement.style;fl=o[Fi],o[Fi]="none"}},ps=function(){Fi&&(document.documentElement.style[Fi]=fl,fl=void 0)}}function hl(){wt(window,"dragstart",vr)}function ml(){er(window,"dragstart",vr)}var uo,fo;function gs(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(ea(),uo=o,fo=o.style.outlineStyle,o.style.outlineStyle="none",wt(window,"keydown",ea))}function ea(){uo&&(uo.style.outlineStyle=fo,uo=void 0,fo=void 0,er(window,"keydown",ea))}function Ha(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function pa(o){var f=o.getBoundingClientRect();return{x:f.width/o.offsetWidth||1,y:f.height/o.offsetHeight||1,boundingClientRect:f}}var ho={__proto__:null,TRANSFORM:za,TRANSITION:Mn,TRANSITION_END:Jn,get:Nr,getStyle:Ua,create:mt,remove:lr,empty:ul,toFront:fs,toBack:Wa,hasClass:hs,addClass:Et,removeClass:ir,setClass:Ac,getClass:dl,setOpacity:dn,testProp:ms,setTransform:Qn,setPosition:wr,getPosition:$a,get disableTextSelection(){return Mt},get enableTextSelection(){return ps},disableImageDrag:hl,enableImageDrag:ml,preventOutline:gs,restoreOutline:ea,getSizedParentNode:Ha,getScale:pa};function wt(o,f,v,b){if(f&&typeof f=="object")for(var N in f)Pc(o,N,f[N],v);else{f=S(f);for(var G=0,me=f.length;G<me;G++)Pc(o,f[G],v,b)}return this}var Ur="_leaflet_events";function er(o,f,v,b){if(arguments.length===1)Nc(o),delete o[Ur];else if(f&&typeof f=="object")for(var N in f)pl(o,N,f[N],v);else if(f=S(f),arguments.length===2)Nc(o,function(Se){return R(f,Se)!==-1});else for(var G=0,me=f.length;G<me;G++)pl(o,f[G],v,b);return this}function Nc(o,f){for(var v in o[Ur]){var b=v.split(/\d/)[0];(!f||f(b))&&pl(o,b,null,null,v)}}var ji={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Pc(o,f,v,b){var N=f+m(v)+(b?"_"+m(b):"");if(o[Ur]&&o[Ur][N])return this;var G=function(Se){return v.call(b||o,Se||window.event)},me=G;!Oe.touchNative&&Oe.pointer&&f.indexOf("touch")===0?G=be(o,f,G):Oe.touch&&f==="dblclick"?G=Qt(o,G):"addEventListener"in o?f==="touchstart"||f==="touchmove"||f==="wheel"||f==="mousewheel"?o.addEventListener(ji[f]||f,G,Oe.passiveEvents?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(G=function(Se){Se=Se||window.event,go(o,Se)&&me(Se)},o.addEventListener(ji[f],G,!1)):o.addEventListener(f,me,!1):o.attachEvent("on"+f,G),o[Ur]=o[Ur]||{},o[Ur][N]=G}function pl(o,f,v,b,N){N=N||f+m(v)+(b?"_"+m(b):"");var G=o[Ur]&&o[Ur][N];if(!G)return this;!Oe.touchNative&&Oe.pointer&&f.indexOf("touch")===0?ke(o,f,G):Oe.touch&&f==="dblclick"?gr(o,G):"removeEventListener"in o?o.removeEventListener(ji[f]||f,G,!1):o.detachEvent("on"+f,G),o[Ur][N]=null}function ga(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function gl(o){return Pc(o,"wheel",ga),this}function mo(o){return wt(o,"mousedown touchstart dblclick contextmenu",ga),o._leaflet_disable_click=!0,this}function vr(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function ta(o){return vr(o),ga(o),this}function Oi(o){if(o.composedPath)return o.composedPath();for(var f=[],v=o.target;v;)f.push(v),v=v.parentNode;return f}function po(o,f){if(!f)return new H(o.clientX,o.clientY);var v=pa(f),b=v.boundingClientRect;return new H((o.clientX-b.left)/v.x-f.clientLeft,(o.clientY-b.top)/v.y-f.clientTop)}var Dh=Oe.linux&&Oe.chrome?window.devicePixelRatio:Oe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function pd(o){return Oe.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/Dh:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function go(o,f){var v=f.relatedTarget;if(!v)return!0;try{for(;v&&v!==o;)v=v.parentNode}catch{return!1}return v!==o}var vl={__proto__:null,on:wt,off:er,stopPropagation:ga,disableScrollPropagation:gl,disableClickPropagation:mo,preventDefault:vr,stop:ta,getPropagationPath:Oi,getMousePosition:po,getWheelDelta:pd,isExternalTarget:go,addListener:wt,removeListener:er},xl=j.extend({run:function(o,f,v,b){this.stop(),this._el=o,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=$a(o),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ue(this._animate,this),this._step()},_step:function(o){var f=+new Date-this._startTime,v=this._duration*1e3;f<v?this._runFrame(this._easeOut(f/v),o):(this._runFrame(1),this._complete())},_runFrame:function(o,f){var v=this._startPos.add(this._offset.multiplyBy(o));f&&v._round(),wr(this._el,v),this.fire("step")},_complete:function(){ce(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),Ot=j.extend({options:{crs:Ke,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,f){f=w(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(M(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Mn&&Oe.any3d&&!Oe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),wt(this._proxy,Jn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,f,v){if(f=f===void 0?this._zoom:this._limitZoom(f),o=this._limitCenter(M(o),f,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=a({animate:v.animate},v.zoom),v.pan=a({animate:v.animate,duration:v.duration},v.pan));var b=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,f,v.zoom):this._tryAnimatedPan(o,v.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(o,f,v.pan&&v.pan.noMoveStart),this},setZoom:function(o,f){return this._loaded?this.setView(this.getCenter(),o,{zoom:f}):(this._zoom=o,this)},zoomIn:function(o,f){return o=o||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,f)},zoomOut:function(o,f){return o=o||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,f)},setZoomAround:function(o,f,v){var b=this.getZoomScale(f),N=this.getSize().divideBy(2),G=o instanceof H?o:this.latLngToContainerPoint(o),me=G.subtract(N).multiplyBy(1-1/b),Se=this.containerPointToLatLng(N.add(me));return this.setView(Se,f,{zoom:v})},_getBoundsCenterZoom:function(o,f){f=f||{},o=o.getBounds?o.getBounds():z(o);var v=ne(f.paddingTopLeft||f.padding||[0,0]),b=ne(f.paddingBottomRight||f.padding||[0,0]),N=this.getBoundsZoom(o,!1,v.add(b));if(N=typeof f.maxZoom=="number"?Math.min(f.maxZoom,N):N,N===1/0)return{center:o.getCenter(),zoom:N};var G=b.subtract(v).divideBy(2),me=this.project(o.getSouthWest(),N),Se=this.project(o.getNorthEast(),N),Pe=this.unproject(me.add(Se).divideBy(2).add(G),N);return{center:Pe,zoom:N}},fitBounds:function(o,f){if(o=z(o),!o.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(o,f);return this.setView(v.center,v.zoom,f)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,f){return this.setView(o,this._zoom,{pan:f})},panBy:function(o,f){if(o=ne(o).round(),f=f||{},!o.x&&!o.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new xl,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){Et(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,v,f.duration||.25,f.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,f,v){if(v=v||{},v.animate===!1||!Oe.any3d)return this.setView(o,f,v);this._stop();var b=this.project(this.getCenter()),N=this.project(o),G=this.getSize(),me=this._zoom;o=M(o),f=f===void 0?me:f;var Se=Math.max(G.x,G.y),Pe=Se*this.getZoomScale(me,f),Re=N.distanceTo(b)||1,rt=1.42,gt=rt*rt;function At(Vt){var Is=Vt?-1:1,Gh=Vt?Pe:Se,Zh=Pe*Pe-Se*Se+Is*gt*gt*Re*Re,Wi=2*Gh*gt*Re,$i=Zh/Wi,Hi=Math.sqrt($i*$i+1)-$i,Dl=Hi<1e-9?-18:Math.log(Hi);return Dl}function Wr(Vt){return(Math.exp(Vt)-Math.exp(-Vt))/2}function jr(Vt){return(Math.exp(Vt)+Math.exp(-Vt))/2}function In(Vt){return Wr(Vt)/jr(Vt)}var hn=At(0);function Ns(Vt){return Se*(jr(hn)/jr(hn+rt*Vt))}function Xc(Vt){return Se*(jr(hn)*In(hn+rt*Vt)-Wr(hn))/gt}function gi(Vt){return 1-Math.pow(1-Vt,1.5)}var Rd=Date.now(),Ui=(At(1)-hn)/rt,_a=v.duration?1e3*v.duration:1e3*Ui*.8;function Ps(){var Vt=(Date.now()-Rd)/_a,Is=gi(Vt)*Ui;Vt<=1?(this._flyToFrame=ue(Ps,this),this._move(this.unproject(b.add(N.subtract(b).multiplyBy(Xc(Is)/Re)),me),this.getScaleZoom(Se/Ns(Is),me),{flyTo:!0})):this._move(o,f)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),Ps.call(this),this},flyToBounds:function(o,f){var v=this._getBoundsCenterZoom(o,f);return this.flyTo(v.center,v.zoom,f)},setMaxBounds:function(o){return o=z(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var f=this.options.minZoom;return this.options.minZoom=o,this._loaded&&f!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var f=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&f!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,f){this._enforcingBounds=!0;var v=this.getCenter(),b=this._limitCenter(v,this._zoom,z(o));return v.equals(b)||this.panTo(b,f),this._enforcingBounds=!1,this},panInside:function(o,f){f=f||{};var v=ne(f.paddingTopLeft||f.padding||[0,0]),b=ne(f.paddingBottomRight||f.padding||[0,0]),N=this.project(this.getCenter()),G=this.project(o),me=this.getPixelBounds(),Se=F([me.min.add(v),me.max.subtract(b)]),Pe=Se.getSize();if(!Se.contains(G)){this._enforcingBounds=!0;var Re=G.subtract(Se.getCenter()),rt=Se.extend(G).getSize().subtract(Pe);N.x+=Re.x<0?-rt.x:rt.x,N.y+=Re.y<0?-rt.y:rt.y,this.panTo(this.unproject(N),f),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=a({animate:!1,pan:!0},o===!0?{animate:!0}:o);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),b=f.divideBy(2).round(),N=v.divideBy(2).round(),G=b.subtract(N);return!G.x&&!G.y?this:(o.animate&&o.pan?this.panBy(G):(o.pan&&this._rawPanBy(G),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=a({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=l(this._handleGeolocationResponse,this),v=l(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,v,o):navigator.geolocation.getCurrentPosition(f,v,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var f=o.code,v=o.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var f=o.coords.latitude,v=o.coords.longitude,b=new q(f,v),N=b.toBounds(o.coords.accuracy*2),G=this._locateOptions;if(G.setView){var me=this.getBoundsZoom(N);this.setView(b,G.maxZoom?Math.min(me,G.maxZoom):me)}var Se={latlng:b,bounds:N,timestamp:o.timestamp};for(var Pe in o.coords)typeof o.coords[Pe]=="number"&&(Se[Pe]=o.coords[Pe]);this.fire("locationfound",Se)}},addHandler:function(o,f){if(!f)return this;var v=this[o]=new f(this);return this._handlers.push(v),this.options[o]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),lr(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ce(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)lr(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,f){var v="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),b=mt("div",v,f||this._mapPane);return o&&(this._panes[o]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),f=this.unproject(o.getBottomLeft()),v=this.unproject(o.getTopRight());return new U(f,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,f,v){o=z(o),v=ne(v||[0,0]);var b=this.getZoom()||0,N=this.getMinZoom(),G=this.getMaxZoom(),me=o.getNorthWest(),Se=o.getSouthEast(),Pe=this.getSize().subtract(v),Re=F(this.project(Se,b),this.project(me,b)).getSize(),rt=Oe.any3d?this.options.zoomSnap:1,gt=Pe.x/Re.x,At=Pe.y/Re.y,Wr=f?Math.max(gt,At):Math.min(gt,At);return b=this.getScaleZoom(Wr,b),rt&&(b=Math.round(b/(rt/100))*(rt/100),b=f?Math.ceil(b/rt)*rt:Math.floor(b/rt)*rt),Math.max(N,Math.min(G,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new H(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,f){var v=this._getTopLeftPoint(o,f);return new Y(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,f){var v=this.options.crs;return f=f===void 0?this._zoom:f,v.scale(o)/v.scale(f)},getScaleZoom:function(o,f){var v=this.options.crs;f=f===void 0?this._zoom:f;var b=v.zoom(o*v.scale(f));return isNaN(b)?1/0:b},project:function(o,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(M(o),f)},unproject:function(o,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(ne(o),f)},layerPointToLatLng:function(o){var f=ne(o).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(o){var f=this.project(M(o))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(M(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(z(o))},distance:function(o,f){return this.options.crs.distance(M(o),M(f))},containerPointToLayerPoint:function(o){return ne(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return ne(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var f=this.containerPointToLayerPoint(ne(o));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(M(o)))},mouseEventToContainerPoint:function(o){return po(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var f=this._container=Nr(o);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");wt(f,"scroll",this._onScroll,this),this._containerId=m(f)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&Oe.any3d,Et(o,"leaflet-container"+(Oe.touch?" leaflet-touch":"")+(Oe.retina?" leaflet-retina":"")+(Oe.ielt9?" leaflet-oldie":"")+(Oe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=Ua(o,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&f!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),wr(this._mapPane,new H(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Et(o.markerPane,"leaflet-zoom-hide"),Et(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,f,v){wr(this._mapPane,new H(0,0));var b=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var N=this._zoom!==f;this._moveStart(N,v)._move(o,f)._moveEnd(N),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(o,f){return o&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(o,f,v,b){f===void 0&&(f=this._zoom);var N=this._zoom!==f;return this._zoom=f,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),b?v&&v.pinch&&this.fire("zoom",v):((N||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ce(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){wr(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[m(this._container)]=this;var f=o?er:wt;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),Oe.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ce(this._resizeRequest),this._resizeRequest=ue(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,f){for(var v=[],b,N=f==="mouseout"||f==="mouseover",G=o.target||o.srcElement,me=!1;G;){if(b=this._targets[m(G)],b&&(f==="click"||f==="preclick")&&this._draggableMoved(b)){me=!0;break}if(b&&b.listens(f,!0)&&(N&&!go(G,o)||(v.push(b),N))||G===this._container)break;G=G.parentNode}return!v.length&&!me&&!N&&this.listens(f,!0)&&(v=[this]),v},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var f=o.target||o.srcElement;if(!(!this._loaded||f._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(f))){var v=o.type;v==="mousedown"&&gs(f),this._fireDOMEvent(o,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,f,v){if(o.type==="click"){var b=a({},o);b.type="preclick",this._fireDOMEvent(b,b.type,v)}var N=this._findEventTargets(o,f);if(v){for(var G=[],me=0;me<v.length;me++)v[me].listens(f,!0)&&G.push(v[me]);N=G.concat(N)}if(N.length){f==="contextmenu"&&vr(o);var Se=N[0],Pe={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var Re=Se.getLatLng&&(!Se._radius||Se._radius<=10);Pe.containerPoint=Re?this.latLngToContainerPoint(Se.getLatLng()):this.mouseEventToContainerPoint(o),Pe.layerPoint=this.containerPointToLayerPoint(Pe.containerPoint),Pe.latlng=Re?Se.getLatLng():this.layerPointToLatLng(Pe.layerPoint)}for(me=0;me<N.length;me++)if(N[me].fire(f,Pe,!0),Pe.originalEvent._stopped||N[me].options.bubblingMouseEvents===!1&&R(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,f=this._handlers.length;o<f;o++)this._handlers[o].disable()},whenReady:function(o,f){return this._loaded?o.call(f||this,{target:this}):this.on("load",o,f),this},_getMapPanePos:function(){return $a(this._mapPane)||new H(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,f){var v=o&&f!==void 0?this._getNewPixelOrigin(o,f):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,f){var v=this.getSize()._divideBy(2);return this.project(o,f)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,f,v){var b=this._getNewPixelOrigin(v,f);return this.project(o,f)._subtract(b)},_latLngBoundsToNewLayerBounds:function(o,f,v){var b=this._getNewPixelOrigin(v,f);return F([this.project(o.getSouthWest(),f)._subtract(b),this.project(o.getNorthWest(),f)._subtract(b),this.project(o.getSouthEast(),f)._subtract(b),this.project(o.getNorthEast(),f)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,f,v){if(!v)return o;var b=this.project(o,f),N=this.getSize().divideBy(2),G=new Y(b.subtract(N),b.add(N)),me=this._getBoundsOffset(G,v,f);return Math.abs(me.x)<=1&&Math.abs(me.y)<=1?o:this.unproject(b.add(me),f)},_limitOffset:function(o,f){if(!f)return o;var v=this.getPixelBounds(),b=new Y(v.min.add(o),v.max.add(o));return o.add(this._getBoundsOffset(b,f))},_getBoundsOffset:function(o,f,v){var b=F(this.project(f.getNorthEast(),v),this.project(f.getSouthWest(),v)),N=b.min.subtract(o.min),G=b.max.subtract(o.max),me=this._rebound(N.x,-G.x),Se=this._rebound(N.y,-G.y);return new H(me,Se)},_rebound:function(o,f){return o+f>0?Math.round(o-f)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(f))},_limitZoom:function(o){var f=this.getMinZoom(),v=this.getMaxZoom(),b=Oe.any3d?this.options.zoomSnap:1;return b&&(o=Math.round(o/b)*b),Math.max(f,Math.min(v,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ir(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,f){var v=this._getCenterOffset(o)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,f),!0)},_createAnimProxy:function(){var o=this._proxy=mt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(f){var v=za,b=this._proxy.style[v];Qn(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),b===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){lr(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),f=this.getZoom();Qn(this._proxy,this.project(o,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,f,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(f),N=this._getCenterOffset(o)._divideBy(1-1/b);return v.animate!==!0&&!this.getSize().contains(N)?!1:(ue(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(o,f,!0)},this),!0)},_animateZoom:function(o,f,v,b){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=f,Et(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:f,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ir(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ci(o,f){return new Ot(o,f)}var Nn=ye.extend({options:{position:"topright"},initialize:function(o){w(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var f=this._map;return f&&f.removeControl(this),this.options.position=o,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var f=this._container=this.onAdd(o),v=this.getPosition(),b=o._controlCorners[v];return Et(f,"leaflet-control"),v.indexOf("bottom")!==-1?b.insertBefore(f,b.firstChild):b.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(lr(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),ui=function(o){return new Nn(o)};Ot.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},f="leaflet-",v=this._controlContainer=mt("div",f+"control-container",this._container);function b(N,G){var me=f+N+" "+f+G;o[N+G]=mt("div",me,v)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)lr(this._controlCorners[o]);lr(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ic=Nn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,f,v,b){return v<b?-1:b<v?1:0}},initialize:function(o,f,v){w(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in o)this._addLayer(o[b],b);for(b in f)this._addLayer(f[b],b,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return Nn.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,f){return this._addLayer(o,f),this._map?this._update():this},addOverlay:function(o,f){return this._addLayer(o,f,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var f=this._getLayer(m(o));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){Et(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(Et(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):ir(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ir(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",f=this._container=mt("div",o),v=this.options.collapsed;f.setAttribute("aria-haspopup",!0),mo(f),gl(f);var b=this._section=mt("section",o+"-list");v&&(this._map.on("click",this.collapse,this),wt(f,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var N=this._layersLink=mt("a",o+"-toggle",f);N.href="#",N.title="Layers",N.setAttribute("role","button"),wt(N,{keydown:function(G){G.keyCode===13&&this._expandSafely()},click:function(G){vr(G),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=mt("div",o+"-base",b),this._separator=mt("div",o+"-separator",b),this._overlaysList=mt("div",o+"-overlays",b),f.appendChild(b)},_getLayer:function(o){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&m(this._layers[f].layer)===o)return this._layers[f]},_addLayer:function(o,f,v){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:f,overlay:v}),this.options.sortLayers&&this._layers.sort(l(function(b,N){return this.options.sortFunction(b.layer,N.layer,b.name,N.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ul(this._baseLayersList),ul(this._overlaysList),this._layerControlInputs=[];var o,f,v,b,N=0;for(v=0;v<this._layers.length;v++)b=this._layers[v],this._addItem(b),f=f||b.overlay,o=o||!b.overlay,N+=b.overlay?0:1;return this.options.hideSingleBase&&(o=o&&N>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=f&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var f=this._getLayer(m(o.target)),v=f.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;v&&this._map.fire(v,f)},_createRadioElement:function(o,f){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(f?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=v,b.firstChild},_addItem:function(o){var f=document.createElement("label"),v=this._map.hasLayer(o.layer),b;o.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=v):b=this._createRadioElement("leaflet-base-layers_"+m(this),v),this._layerControlInputs.push(b),b.layerId=m(o.layer),wt(b,"click",this._onInputClick,this);var N=document.createElement("span");N.innerHTML=" "+o.name;var G=document.createElement("span");f.appendChild(G),G.appendChild(b),G.appendChild(N);var me=o.overlay?this._overlaysList:this._baseLayersList;return me.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,f,v,b=[],N=[];this._handlingClick=!0;for(var G=o.length-1;G>=0;G--)f=o[G],v=this._getLayer(f.layerId).layer,f.checked?b.push(v):f.checked||N.push(v);for(G=0;G<N.length;G++)this._map.hasLayer(N[G])&&this._map.removeLayer(N[G]);for(G=0;G<b.length;G++)this._map.hasLayer(b[G])||this._map.addLayer(b[G]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,f,v,b=this._map.getZoom(),N=o.length-1;N>=0;N--)f=o[N],v=this._getLayer(f.layerId).layer,f.disabled=v.options.minZoom!==void 0&&b<v.options.minZoom||v.options.maxZoom!==void 0&&b>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,wt(o,"click",vr),this.expand();var f=this;setTimeout(function(){er(o,"click",vr),f._preventClick=!1})}}),yl=function(o,f,v){return new Ic(o,f,v)},vs=Nn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var f="leaflet-control-zoom",v=mt("div",f+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,f+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,f+"-out",v,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,f,v,b,N){var G=mt("a",v,b);return G.innerHTML=o,G.href="#",G.title=f,G.setAttribute("role","button"),G.setAttribute("aria-label",f),mo(G),wt(G,"click",ta),wt(G,"click",N,this),wt(G,"click",this._refocusOnMap,this),G},_updateDisabled:function(){var o=this._map,f="leaflet-disabled";ir(this._zoomInButton,f),ir(this._zoomOutButton,f),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(Et(this._zoomOutButton,f),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(Et(this._zoomInButton,f),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ot.mergeOptions({zoomControl:!0}),Ot.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new vs,this.addControl(this.zoomControl))});var gd=function(o){return new vs(o)},fn=Nn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var f="leaflet-control-scale",v=mt("div",f),b=this.options;return this._addScales(b,f+"-line",v),o.on(b.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),v},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,f,v){o.metric&&(this._mScale=mt("div",f,v)),o.imperial&&(this._iScale=mt("div",f,v))},_update:function(){var o=this._map,f=o.getSize().y/2,v=o.distance(o.containerPointToLatLng([0,f]),o.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(v)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var f=this._getRoundNum(o),v=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,v,f/o)},_updateImperial:function(o){var f=o*3.2808399,v,b,N;f>5280?(v=f/5280,b=this._getRoundNum(v),this._updateScale(this._iScale,b+" mi",b/v)):(N=this._getRoundNum(f),this._updateScale(this._iScale,N+" ft",N/f))},_updateScale:function(o,f,v){o.style.width=Math.round(this.options.maxWidth*v)+"px",o.innerHTML=f},_getRoundNum:function(o){var f=Math.pow(10,(Math.floor(o)+"").length-1),v=o/f;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,f*v}}),xs=function(o){return new fn(o)},Dc='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ri=Nn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Oe.inlineSvg?Dc+" ":"")+"Leaflet</a>"},initialize:function(o){w(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=mt("div","leaflet-control-attribution"),mo(this._container);for(var f in o._layers)o._layers[f].getAttribution&&this.addAttribution(o._layers[f].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var f in this._attributions)this._attributions[f]&&o.push(f);var v=[];this.options.prefix&&v.push(this.options.prefix),o.length&&v.push(o.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});Ot.mergeOptions({attributionControl:!0}),Ot.addInitHook(function(){this.options.attributionControl&&new Ri().addTo(this)});var Fh=function(o){return new Ri(o)};Nn.Layers=Ic,Nn.Zoom=vs,Nn.Scale=fn,Nn.Attribution=Ri,ui.layers=yl,ui.zoom=gd,ui.scale=xs,ui.attribution=Fh;var Bn=ye.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Bn.addTo=function(o,f){return o.addHandler(f,this),this};var Fc={Events:le},ys=Oe.touch?"touchstart mousedown":"mousedown",ra=j.extend({options:{clickTolerance:3},initialize:function(o,f,v,b){w(this,b),this._element=o,this._dragStartTarget=f||o,this._preventOutline=v},enable:function(){this._enabled||(wt(this._dragStartTarget,ys,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(ra._dragging===this&&this.finishDrag(!0),er(this._dragStartTarget,ys,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!hs(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){ra._dragging===this&&this.finishDrag();return}if(!(ra._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(ra._dragging=this,this._preventOutline&&gs(this._element),hl(),Mt(),!this._moving)){this.fire("down");var f=o.touches?o.touches[0]:o,v=Ha(this._element);this._startPoint=new H(f.clientX,f.clientY),this._startPos=$a(this._element),this._parentScale=pa(v);var b=o.type==="mousedown";wt(document,b?"mousemove":"touchmove",this._onMove,this),wt(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var f=o.touches&&o.touches.length===1?o.touches[0]:o,v=new H(f.clientX,f.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,vr(o),this._moved||(this.fire("dragstart"),this._moved=!0,Et(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Et(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),wr(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){ir(document.body,"leaflet-dragging"),this._lastTarget&&(ir(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),er(document,"mousemove touchmove",this._onMove,this),er(document,"mouseup touchend touchcancel",this._onUp,this),ml(),ps();var f=this._moved&&this._moving;this._moving=!1,ra._dragging=!1,f&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function jc(o,f,v){var b,N=[1,4,2,8],G,me,Se,Pe,Re,rt,gt,At;for(G=0,rt=o.length;G<rt;G++)o[G]._code=Li(o[G],f);for(Se=0;Se<4;Se++){for(gt=N[Se],b=[],G=0,rt=o.length,me=rt-1;G<rt;me=G++)Pe=o[G],Re=o[me],Pe._code&gt?Re._code&gt||(At=wl(Re,Pe,gt,f,v),At._code=Li(At,f),b.push(At)):(Re._code&gt&&(At=wl(Re,Pe,gt,f,v),At._code=Li(At,f),b.push(At)),b.push(Pe));o=b}return o}function vd(o,f){var v,b,N,G,me,Se,Pe,Re,rt;if(!o||o.length===0)throw new Error("latlngs not passed");zn(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var gt=M([0,0]),At=z(o),Wr=At.getNorthWest().distanceTo(At.getSouthWest())*At.getNorthEast().distanceTo(At.getNorthWest());Wr<1700&&(gt=Oc(o));var jr=o.length,In=[];for(v=0;v<jr;v++){var hn=M(o[v]);In.push(f.project(M([hn.lat-gt.lat,hn.lng-gt.lng])))}for(Se=Pe=Re=0,v=0,b=jr-1;v<jr;b=v++)N=In[v],G=In[b],me=N.y*G.x-G.y*N.x,Pe+=(N.x+G.x)*me,Re+=(N.y+G.y)*me,Se+=me*3;Se===0?rt=In[0]:rt=[Pe/Se,Re/Se];var Ns=f.unproject(ne(rt));return M([Ns.lat+gt.lat,Ns.lng+gt.lng])}function Oc(o){for(var f=0,v=0,b=0,N=0;N<o.length;N++){var G=M(o[N]);f+=G.lat,v+=G.lng,b++}return M([f/b,v/b])}var jh={__proto__:null,clipPolygon:jc,polygonCenter:vd,centroid:Oc};function _l(o,f){if(!f||!o.length)return o.slice();var v=f*f;return o=Lh(o,v),o=Rh(o,v),o}function xd(o,f,v){return Math.sqrt(Mi(o,f,v,!0))}function Oh(o,f,v){return Mi(o,f,v)}function Rh(o,f){var v=o.length,b=typeof Uint8Array<"u"?Uint8Array:Array,N=new b(v);N[0]=N[v-1]=1,Rc(o,N,f,0,v-1);var G,me=[];for(G=0;G<v;G++)N[G]&&me.push(o[G]);return me}function Rc(o,f,v,b,N){var G=0,me,Se,Pe;for(Se=b+1;Se<=N-1;Se++)Pe=Mi(o[Se],o[b],o[N],!0),Pe>G&&(me=Se,G=Pe);G>v&&(f[me]=1,Rc(o,f,v,b,me),Rc(o,f,v,me,N))}function Lh(o,f){for(var v=[o[0]],b=1,N=0,G=o.length;b<G;b++)Mh(o[b],o[N])>f&&(v.push(o[b]),N=b);return N<G-1&&v.push(o[G-1]),v}var Lc;function yd(o,f,v,b,N){var G=b?Lc:Li(o,v),me=Li(f,v),Se,Pe,Re;for(Lc=me;;){if(!(G|me))return[o,f];if(G&me)return!1;Se=G||me,Pe=wl(o,f,Se,v,N),Re=Li(Pe,v),Se===G?(o=Pe,G=Re):(f=Pe,me=Re)}}function wl(o,f,v,b,N){var G=f.x-o.x,me=f.y-o.y,Se=b.min,Pe=b.max,Re,rt;return v&8?(Re=o.x+G*(Pe.y-o.y)/me,rt=Pe.y):v&4?(Re=o.x+G*(Se.y-o.y)/me,rt=Se.y):v&2?(Re=Pe.x,rt=o.y+me*(Pe.x-o.x)/G):v&1&&(Re=Se.x,rt=o.y+me*(Se.x-o.x)/G),new H(Re,rt,N)}function Li(o,f){var v=0;return o.x<f.min.x?v|=1:o.x>f.max.x&&(v|=2),o.y<f.min.y?v|=4:o.y>f.max.y&&(v|=8),v}function Mh(o,f){var v=f.x-o.x,b=f.y-o.y;return v*v+b*b}function Mi(o,f,v,b){var N=f.x,G=f.y,me=v.x-N,Se=v.y-G,Pe=me*me+Se*Se,Re;return Pe>0&&(Re=((o.x-N)*me+(o.y-G)*Se)/Pe,Re>1?(N=v.x,G=v.y):Re>0&&(N+=me*Re,G+=Se*Re)),me=o.x-N,Se=o.y-G,b?me*me+Se*Se:new H(N,G)}function zn(o){return!A(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function _d(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),zn(o)}function wd(o,f){var v,b,N,G,me,Se,Pe,Re;if(!o||o.length===0)throw new Error("latlngs not passed");zn(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var rt=M([0,0]),gt=z(o),At=gt.getNorthWest().distanceTo(gt.getSouthWest())*gt.getNorthEast().distanceTo(gt.getNorthWest());At<1700&&(rt=Oc(o));var Wr=o.length,jr=[];for(v=0;v<Wr;v++){var In=M(o[v]);jr.push(f.project(M([In.lat-rt.lat,In.lng-rt.lng])))}for(v=0,b=0;v<Wr-1;v++)b+=jr[v].distanceTo(jr[v+1])/2;if(b===0)Re=jr[0];else for(v=0,G=0;v<Wr-1;v++)if(me=jr[v],Se=jr[v+1],N=me.distanceTo(Se),G+=N,G>b){Pe=(G-b)/N,Re=[Se.x-Pe*(Se.x-me.x),Se.y-Pe*(Se.y-me.y)];break}var hn=f.unproject(ne(Re));return M([hn.lat+rt.lat,hn.lng+rt.lng])}var bd={__proto__:null,simplify:_l,pointToSegmentDistance:xd,closestPointOnSegment:Oh,clipSegment:yd,_getEdgeIntersection:wl,_getBitCode:Li,_sqClosestPointOnSegment:Mi,isFlat:zn,_flat:_d,polylineCenter:wd},Mc={project:function(o){return new H(o.lng,o.lat)},unproject:function(o){return new q(o.y,o.x)},bounds:new Y([-180,-90],[180,90])},Bc={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Y([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var f=Math.PI/180,v=this.R,b=o.lat*f,N=this.R_MINOR/v,G=Math.sqrt(1-N*N),me=G*Math.sin(b),Se=Math.tan(Math.PI/4-b/2)/Math.pow((1-me)/(1+me),G/2);return b=-v*Math.log(Math.max(Se,1e-10)),new H(o.lng*f*v,b)},unproject:function(o){for(var f=180/Math.PI,v=this.R,b=this.R_MINOR/v,N=Math.sqrt(1-b*b),G=Math.exp(-o.y/v),me=Math.PI/2-2*Math.atan(G),Se=0,Pe=.1,Re;Se<15&&Math.abs(Pe)>1e-7;Se++)Re=N*Math.sin(me),Re=Math.pow((1-Re)/(1+Re),N/2),Pe=Math.PI/2-2*Math.atan(G*Re)-me,me+=Pe;return new q(me*f,o.x*f/v)}},Bh={__proto__:null,LonLat:Mc,Mercator:Bc,SphericalMercator:xe},zh=a({},se,{code:"EPSG:3395",projection:Bc,transformation:(function(){var o=.5/(Math.PI*Bc.R);return X(o,.5,-o,.5)})()}),kd=a({},se,{code:"EPSG:4326",projection:Mc,transformation:X(1/180,1,-1/180,.5)}),Uh=a({},oe,{projection:Mc,transformation:X(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,f){var v=f.lng-o.lng,b=f.lat-o.lat;return Math.sqrt(v*v+b*b)},infinite:!0});oe.Earth=se,oe.EPSG3395=zh,oe.EPSG3857=Ke,oe.EPSG900913=Xe,oe.EPSG4326=kd,oe.Simple=Uh;var na=j.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[m(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[m(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var f=o.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var v=this.getEvents();f.on(v,this),this.once("remove",function(){f.off(v,this)},this)}this.onAdd(f),this.fire("add"),f.fire("layeradd",{layer:this})}}});Ot.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var f=m(o);return this._layers[f]?this:(this._layers[f]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var f=m(o);return this._layers[f]?(this._loaded&&o.onRemove(this),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return m(o)in this._layers},eachLayer:function(o,f){for(var v in this._layers)o.call(f,this._layers[v]);return this},_addLayers:function(o){o=o?A(o)?o:[o]:[];for(var f=0,v=o.length;f<v;f++)this.addLayer(o[f])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[m(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var f=m(o);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,f=-1/0,v=this._getZoomSpan();for(var b in this._zoomBoundLayers){var N=this._zoomBoundLayers[b].options;o=N.minZoom===void 0?o:Math.min(o,N.minZoom),f=N.maxZoom===void 0?f:Math.max(f,N.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=o===1/0?void 0:o,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var di=na.extend({initialize:function(o,f){w(this,f),this._layers={};var v,b;if(o)for(v=0,b=o.length;v<b;v++)this.addLayer(o[v])},addLayer:function(o){var f=this.getLayerId(o);return this._layers[f]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var f=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(o){var f=typeof o=="number"?o:this.getLayerId(o);return f in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var f=Array.prototype.slice.call(arguments,1),v,b;for(v in this._layers)b=this._layers[v],b[o]&&b[o].apply(b,f);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,f){for(var v in this._layers)o.call(f,this._layers[v]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return m(o)}}),vo=function(o,f){return new di(o,f)},Va=di.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),di.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),di.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new U;for(var f in this._layers){var v=this._layers[f];o.extend(v.getBounds?v.getBounds():v.getLatLng())}return o}}),Sd=function(o,f){return new Va(o,f)},Bi=ye.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){w(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,f){var v=this._getIconUrl(o);if(!v){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(v,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(b,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(o,f){var v=this.options,b=v[f+"Size"];typeof b=="number"&&(b=[b,b]);var N=ne(b),G=ne(f==="shadow"&&v.shadowAnchor||v.iconAnchor||N&&N.divideBy(2,!0));o.className="leaflet-marker-"+f+" "+(v.className||""),G&&(o.style.marginLeft=-G.x+"px",o.style.marginTop=-G.y+"px"),N&&(o.style.width=N.x+"px",o.style.height=N.y+"px")},_createImg:function(o,f){return f=f||document.createElement("img"),f.src=o,f},_getIconUrl:function(o){return Oe.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function Td(o){return new Bi(o)}var _s=Bi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof _s.imagePath!="string"&&(_s.imagePath=this._detectIconPath()),(this.options.imagePath||_s.imagePath)+Bi.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var f=function(v,b,N){var G=b.exec(v);return G&&G[N]};return o=f(o,/^url\((['"])?(.+)\1\)$/,2),o&&f(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=mt("div","leaflet-default-icon-path",document.body),f=Ua(o,"background-image")||Ua(o,"backgroundImage");if(document.body.removeChild(o),f=this._stripUrl(f),f)return f;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),zc=Bn.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new ra(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Et(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ir(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var f=this._marker,v=f._map,b=this._marker.options.autoPanSpeed,N=this._marker.options.autoPanPadding,G=$a(f._icon),me=v.getPixelBounds(),Se=v.getPixelOrigin(),Pe=F(me.min._subtract(Se).add(N),me.max._subtract(Se).subtract(N));if(!Pe.contains(G)){var Re=ne((Math.max(Pe.max.x,G.x)-Pe.max.x)/(me.max.x-Pe.max.x)-(Math.min(Pe.min.x,G.x)-Pe.min.x)/(me.min.x-Pe.min.x),(Math.max(Pe.max.y,G.y)-Pe.max.y)/(me.max.y-Pe.max.y)-(Math.min(Pe.min.y,G.y)-Pe.min.y)/(me.min.y-Pe.min.y)).multiplyBy(b);v.panBy(Re,{animate:!1}),this._draggable._newPos._add(Re),this._draggable._startPos._add(Re),wr(f._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=ue(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(ce(this._panRequest),this._panRequest=ue(this._adjustPan.bind(this,o)))},_onDrag:function(o){var f=this._marker,v=f._shadow,b=$a(f._icon),N=f._map.layerPointToLatLng(b);v&&wr(v,b),f._latlng=N,o.latlng=N,o.oldLatLng=this._oldLatLng,f.fire("move",o).fire("drag",o)},_onDragEnd:function(o){ce(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),Ga=na.extend({options:{icon:new _s,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,f){w(this,f),this._latlng=M(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var f=this._latlng;return this._latlng=M(o),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=o.icon.createIcon(this._icon),b=!1;v!==this._icon&&(this._icon&&this._removeIcon(),b=!0,o.title&&(v.title=o.title),v.tagName==="IMG"&&(v.alt=o.alt||"")),Et(v,f),o.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&wt(v,"focus",this._panOnFocus,this);var N=o.icon.createShadow(this._shadow),G=!1;N!==this._shadow&&(this._removeShadow(),G=!0),N&&(Et(N,f),N.alt=""),this._shadow=N,o.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),N&&G&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&er(this._icon,"focus",this._panOnFocus,this),lr(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&lr(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&wr(this._icon,o),this._shadow&&wr(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(f)},_initInteraction:function(){if(this.options.interactive&&(Et(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),zc)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new zc(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&dn(this._icon,o),this._shadow&&dn(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var f=this.options.icon.options,v=f.iconSize?ne(f.iconSize):ne(0,0),b=f.iconAnchor?ne(f.iconAnchor):ne(0,0);o.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:v.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Wh(o,f){return new Ga(o,f)}var fi=na.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return w(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),bl=fi.extend({options:{fill:!0,radius:10},initialize:function(o,f){w(this,f),this._latlng=M(o),this._radius=this.options.radius},setLatLng:function(o){var f=this._latlng;return this._latlng=M(o),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var f=o&&o.radius||this._radius;return fi.prototype.setStyle.call(this,o),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,f=this._radiusY||o,v=this._clickTolerance(),b=[o+v,f+v];this._pxBounds=new Y(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ed(o,f){return new bl(o,f)}var kl=bl.extend({initialize:function(o,f,v){if(typeof f=="number"&&(f=a({},v,{radius:f})),w(this,f),this._latlng=M(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new U(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:fi.prototype.setStyle,_project:function(){var o=this._latlng.lng,f=this._latlng.lat,v=this._map,b=v.options.crs;if(b.distance===se.distance){var N=Math.PI/180,G=this._mRadius/se.R/N,me=v.project([f+G,o]),Se=v.project([f-G,o]),Pe=me.add(Se).divideBy(2),Re=v.unproject(Pe).lat,rt=Math.acos((Math.cos(G*N)-Math.sin(f*N)*Math.sin(Re*N))/(Math.cos(f*N)*Math.cos(Re*N)))/N;(isNaN(rt)||rt===0)&&(rt=G/Math.cos(Math.PI/180*f)),this._point=Pe.subtract(v.getPixelOrigin()),this._radius=isNaN(rt)?0:Pe.x-v.project([Re,o-rt]).x,this._radiusY=Pe.y-me.y}else{var gt=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(gt).x}this._updateBounds()}});function xo(o,f,v){return new kl(o,f,v)}var Pn=fi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,f){w(this,f),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var f=1/0,v=null,b=Mi,N,G,me=0,Se=this._parts.length;me<Se;me++)for(var Pe=this._parts[me],Re=1,rt=Pe.length;Re<rt;Re++){N=Pe[Re-1],G=Pe[Re];var gt=b(o,N,G,!0);gt<f&&(f=gt,v=b(o,N,G))}return v&&(v.distance=Math.sqrt(f)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return wd(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,f){return f=f||this._defaultShape(),o=M(o),f.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new U,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return zn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var f=[],v=zn(o),b=0,N=o.length;b<N;b++)v?(f[b]=M(o[b]),this._bounds.extend(f[b])):f[b]=this._convertLatLngs(o[b]);return f},_project:function(){var o=new Y;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),f=new H(o,o);this._rawPxBounds&&(this._pxBounds=new Y([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)]))},_projectLatlngs:function(o,f,v){var b=o[0]instanceof q,N=o.length,G,me;if(b){for(me=[],G=0;G<N;G++)me[G]=this._map.latLngToLayerPoint(o[G]),v.extend(me[G]);f.push(me)}else for(G=0;G<N;G++)this._projectLatlngs(o[G],f,v)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,v,b,N,G,me,Se,Pe;for(v=0,N=0,G=this._rings.length;v<G;v++)for(Pe=this._rings[v],b=0,me=Pe.length;b<me-1;b++)Se=yd(Pe[b],Pe[b+1],o,b,!0),Se&&(f[N]=f[N]||[],f[N].push(Se[0]),(Se[1]!==Pe[b+1]||b===me-2)&&(f[N].push(Se[1]),N++))}},_simplifyPoints:function(){for(var o=this._parts,f=this.options.smoothFactor,v=0,b=o.length;v<b;v++)o[v]=_l(o[v],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,f){var v,b,N,G,me,Se,Pe=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(v=0,G=this._parts.length;v<G;v++)for(Se=this._parts[v],b=0,me=Se.length,N=me-1;b<me;N=b++)if(!(!f&&b===0)&&xd(o,Se[N],Se[b])<=Pe)return!0;return!1}});function $h(o,f){return new Pn(o,f)}Pn._flat=_d;var Za=Pn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return vd(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var f=Pn.prototype._convertLatLngs.call(this,o),v=f.length;return v>=2&&f[0]instanceof q&&f[0].equals(f[v-1])&&f.pop(),f},_setLatLngs:function(o){Pn.prototype._setLatLngs.call(this,o),zn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return zn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,f=this.options.weight,v=new H(f,f);if(o=new Y(o.min.subtract(v),o.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,N=this._rings.length,G;b<N;b++)G=jc(this._rings[b],o,!0),G.length&&this._parts.push(G)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var f=!1,v,b,N,G,me,Se,Pe,Re;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(G=0,Pe=this._parts.length;G<Pe;G++)for(v=this._parts[G],me=0,Re=v.length,Se=Re-1;me<Re;Se=me++)b=v[me],N=v[Se],b.y>o.y!=N.y>o.y&&o.x<(N.x-b.x)*(o.y-b.y)/(N.y-b.y)+b.x&&(f=!f);return f||Pn.prototype._containsPoint.call(this,o,!0)}});function Hh(o,f){return new Za(o,f)}var va=Va.extend({initialize:function(o,f){w(this,f),this._layers={},o&&this.addData(o)},addData:function(o){var f=A(o)?o:o.features,v,b,N;if(f){for(v=0,b=f.length;v<b;v++)N=f[v],(N.geometries||N.geometry||N.features||N.coordinates)&&this.addData(N);return this}var G=this.options;if(G.filter&&!G.filter(o))return this;var me=ws(o,G);return me?(me.feature=Al(o),me.defaultOptions=me.options,this.resetStyle(me),G.onEachFeature&&G.onEachFeature(o,me),this.addLayer(me)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=a({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(f){this._setLayerStyle(f,o)},this)},_setLayerStyle:function(o,f){o.setStyle&&(typeof f=="function"&&(f=f(o.feature)),o.setStyle(f))}});function ws(o,f){var v=o.type==="Feature"?o.geometry:o,b=v?v.coordinates:null,N=[],G=f&&f.pointToLayer,me=f&&f.coordsToLatLng||Tl,Se,Pe,Re,rt;if(!b&&!v)return null;switch(v.type){case"Point":return Se=me(b),Sl(G,o,Se,f);case"MultiPoint":for(Re=0,rt=b.length;Re<rt;Re++)Se=me(b[Re]),N.push(Sl(G,o,Se,f));return new Va(N);case"LineString":case"MultiLineString":return Pe=yo(b,v.type==="LineString"?0:1,me),new Pn(Pe,f);case"Polygon":case"MultiPolygon":return Pe=yo(b,v.type==="Polygon"?1:2,me),new Za(Pe,f);case"GeometryCollection":for(Re=0,rt=v.geometries.length;Re<rt;Re++){var gt=ws({geometry:v.geometries[Re],type:"Feature",properties:o.properties},f);gt&&N.push(gt)}return new Va(N);case"FeatureCollection":for(Re=0,rt=v.features.length;Re<rt;Re++){var At=ws(v.features[Re],f);At&&N.push(At)}return new Va(N);default:throw new Error("Invalid GeoJSON object.")}}function Sl(o,f,v,b){return o?o(f,v):new Ga(v,b&&b.markersInheritOptions&&b)}function Tl(o){return new q(o[1],o[0],o[2])}function yo(o,f,v){for(var b=[],N=0,G=o.length,me;N<G;N++)me=f?yo(o[N],f-1,v):(v||Tl)(o[N]),b.push(me);return b}function El(o,f){return o=M(o),o.alt!==void 0?[_(o.lng,f),_(o.lat,f),_(o.alt,f)]:[_(o.lng,f),_(o.lat,f)]}function Cl(o,f,v,b){for(var N=[],G=0,me=o.length;G<me;G++)N.push(f?Cl(o[G],zn(o[G])?0:f-1,v,b):El(o[G],b));return!f&&v&&N.length>0&&N.push(N[0].slice()),N}function bs(o,f){return o.feature?a({},o.feature,{geometry:f}):Al(f)}function Al(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var Uc={toGeoJSON:function(o){return bs(this,{type:"Point",coordinates:El(this.getLatLng(),o)})}};Ga.include(Uc),kl.include(Uc),bl.include(Uc),Pn.include({toGeoJSON:function(o){var f=!zn(this._latlngs),v=Cl(this._latlngs,f?1:0,!1,o);return bs(this,{type:(f?"Multi":"")+"LineString",coordinates:v})}}),Za.include({toGeoJSON:function(o){var f=!zn(this._latlngs),v=f&&!zn(this._latlngs[0]),b=Cl(this._latlngs,v?2:f?1:0,!0,o);return f||(b=[b]),bs(this,{type:(v?"Multi":"")+"Polygon",coordinates:b})}}),di.include({toMultiPoint:function(o){var f=[];return this.eachLayer(function(v){f.push(v.toGeoJSON(o).geometry.coordinates)}),bs(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(o){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(o);var v=f==="GeometryCollection",b=[];return this.eachLayer(function(N){if(N.toGeoJSON){var G=N.toGeoJSON(o);if(v)b.push(G.geometry);else{var me=Al(G);me.type==="FeatureCollection"?b.push.apply(b,me.features):b.push(me)}}}),v?bs(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function Cd(o,f){return new va(o,f)}var aa=Cd,hi=na.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,f,v){this._url=o,this._bounds=z(f),w(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Et(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){lr(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&fs(this._image),this},bringToBack:function(){return this._map&&Wa(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=z(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",f=this._image=o?this._url:mt("img");if(Et(f,"leaflet-image-layer"),this._zoomAnimated&&Et(f,"leaflet-zoom-animated"),this.options.className&&Et(f,this.options.className),f.onselectstart=y,f.onmousemove=y,f.onload=l(this.fire,this,"load"),f.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(o){var f=this._map.getZoomScale(o.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;Qn(this._image,v,f)},_reset:function(){var o=this._image,f=new Y(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=f.getSize();wr(o,f.min),o.style.width=v.x+"px",o.style.height=v.y+"px"},_updateOpacity:function(){dn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),Ad=function(o,f,v){return new hi(o,f,v)},Wc=hi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",f=this._image=o?this._url:mt("video");if(Et(f,"leaflet-image-layer"),this._zoomAnimated&&Et(f,"leaflet-zoom-animated"),this.options.className&&Et(f,this.options.className),f.onselectstart=y,f.onmousemove=y,f.onloadeddata=l(this.fire,this,"load"),o){for(var v=f.getElementsByTagName("source"),b=[],N=0;N<v.length;N++)b.push(v[N].src);this._url=v.length>0?b:[f.src];return}A(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(f.style,"objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop,f.muted=!!this.options.muted,f.playsInline=!!this.options.playsInline;for(var G=0;G<this._url.length;G++){var me=mt("source");me.src=this._url[G],f.appendChild(me)}}});function Nd(o,f,v){return new Wc(o,f,v)}var $c=hi.extend({_initImage:function(){var o=this._image=this._url;Et(o,"leaflet-image-layer"),this._zoomAnimated&&Et(o,"leaflet-zoom-animated"),this.options.className&&Et(o,this.options.className),o.onselectstart=y,o.onmousemove=y}});function Hc(o,f,v){return new $c(o,f,v)}var xa=na.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,f){o&&(o instanceof q||A(o))?(this._latlng=M(o),w(this,f)):(w(this,o),this._source=f),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&dn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&dn(this._container,1),this.bringToFront(),this.options.interactive&&(Et(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(dn(this._container,0),this._removeTimeout=setTimeout(l(lr,void 0,this._container),200)):lr(this._container),this.options.interactive&&(ir(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=M(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&fs(this._container),this},bringToBack:function(){return this._map&&Wa(this._container),this},_prepareOpen:function(o){var f=this._source;if(!f._map)return!1;if(f instanceof Va){f=null;var v=this._source._layers;for(var b in v)if(v[b]._map){f=v[b];break}if(!f)return!1;this._source=f}if(!o)if(f.getCenter)o=f.getCenter();else if(f.getLatLng)o=f.getLatLng();else if(f.getBounds)o=f.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")o.innerHTML=f;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),f=ne(this.options.offset),v=this._getAnchor();this._zoomAnimated?wr(this._container,o.add(v)):f=f.add(o).add(v);var b=this._containerBottom=-f.y,N=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=b+"px",this._container.style.left=N+"px"}},_getAnchor:function(){return[0,0]}});Ot.include({_initOverlay:function(o,f,v,b){var N=f;return N instanceof o||(N=new o(b).setContent(f)),v&&N.setLatLng(v),N}}),na.include({_initOverlay:function(o,f,v,b){var N=v;return N instanceof o?(w(N,b),N._source=this):(N=f&&!b?f:new o(b,this),N.setContent(v)),N}});var Nl=xa.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,xa.prototype.openOn.call(this,o)},onAdd:function(o){xa.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof fi||this._source.on("preclick",ga))},onRemove:function(o){xa.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof fi||this._source.off("preclick",ga))},getEvents:function(){var o=xa.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",f=this._container=mt("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=mt("div",o+"-content-wrapper",f);if(this._contentNode=mt("div",o+"-content",v),mo(f),gl(this._contentNode),wt(f,"contextmenu",ga),this._tipContainer=mt("div",o+"-tip-container",f),this._tip=mt("div",o+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=mt("a",o+"-close-button",f);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',wt(b,"click",function(N){vr(N),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,f=o.style;f.width="",f.whiteSpace="nowrap";var v=o.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),f.width=v+1+"px",f.whiteSpace="",f.height="";var b=o.offsetHeight,N=this.options.maxHeight,G="leaflet-popup-scrolled";N&&b>N?(f.height=N+"px",Et(o,G)):ir(o,G),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),v=this._getAnchor();wr(this._container,f.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,f=parseInt(Ua(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+f,b=this._containerWidth,N=new H(this._containerLeft,-v-this._containerBottom);N._add($a(this._container));var G=o.layerPointToContainerPoint(N),me=ne(this.options.autoPanPadding),Se=ne(this.options.autoPanPaddingTopLeft||me),Pe=ne(this.options.autoPanPaddingBottomRight||me),Re=o.getSize(),rt=0,gt=0;G.x+b+Pe.x>Re.x&&(rt=G.x+b-Re.x+Pe.x),G.x-rt-Se.x<0&&(rt=G.x-Se.x),G.y+v+Pe.y>Re.y&&(gt=G.y+v-Re.y+Pe.y),G.y-gt-Se.y<0&&(gt=G.y-Se.y),(rt||gt)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([rt,gt]))}},_getAnchor:function(){return ne(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ks=function(o,f){return new Nl(o,f)};Ot.mergeOptions({closePopupOnClick:!0}),Ot.include({openPopup:function(o,f,v){return this._initOverlay(Nl,o,f,v).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),na.include({bindPopup:function(o,f){return this._popup=this._initOverlay(Nl,this._popup,o,f),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof Va||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){ta(o);var f=o.layer||o.target;if(this._popup._source===f&&!(f instanceof fi)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=f,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var Ss=xa.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){xa.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){xa.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=xa.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",f=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=mt("div",f),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+m(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var f,v,b=this._map,N=this._container,G=b.latLngToContainerPoint(b.getCenter()),me=b.layerPointToContainerPoint(o),Se=this.options.direction,Pe=N.offsetWidth,Re=N.offsetHeight,rt=ne(this.options.offset),gt=this._getAnchor();Se==="top"?(f=Pe/2,v=Re):Se==="bottom"?(f=Pe/2,v=0):Se==="center"?(f=Pe/2,v=Re/2):Se==="right"?(f=0,v=Re/2):Se==="left"?(f=Pe,v=Re/2):me.x<G.x?(Se="right",f=0,v=Re/2):(Se="left",f=Pe+(rt.x+gt.x)*2,v=Re/2),o=o.subtract(ne(f,v,!0)).add(rt).add(gt),ir(N,"leaflet-tooltip-right"),ir(N,"leaflet-tooltip-left"),ir(N,"leaflet-tooltip-top"),ir(N,"leaflet-tooltip-bottom"),Et(N,"leaflet-tooltip-"+Se),wr(N,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&dn(this._container,o)},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(f)},_getAnchor:function(){return ne(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),_o=function(o,f){return new Ss(o,f)};Ot.include({openTooltip:function(o,f,v){return this._initOverlay(Ss,o,f,v).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),na.include({bindTooltip:function(o,f){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ss,this._tooltip,o,f),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var f=o?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[f](v),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof Va||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var f=typeof o.getElement=="function"&&o.getElement();f&&(wt(f,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),wt(f,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var f=typeof o.getElement=="function"&&o.getElement();f&&f.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var f=this;this._map.once("moveend",function(){f._openOnceFlag=!1,f._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var f=o.latlng,v,b;this._tooltip.options.sticky&&o.originalEvent&&(v=this._map.mouseEventToContainerPoint(o.originalEvent),b=this._map.containerPointToLayerPoint(v),f=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(f)}});var Pl=Bi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var f=o&&o.tagName==="DIV"?o:document.createElement("div"),v=this.options;if(v.html instanceof Element?(ul(f),f.appendChild(v.html)):f.innerHTML=v.html!==!1?v.html:"",v.bgPos){var b=ne(v.bgPos);f.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function Pd(o){return new Pl(o)}Bi.Default=_s;var mi=na.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Oe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){w(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),lr(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(fs(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Wa(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof H?o:new H(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var f=this.getPane().children,v=-o(-1/0,1/0),b=0,N=f.length,G;b<N;b++)G=f[b].style.zIndex,f[b]!==this._container&&G&&(v=o(v,+G));isFinite(v)&&(this.options.zIndex=v+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Oe.ielt9){dn(this._container,this.options.opacity);var o=+new Date,f=!1,v=!1;for(var b in this._tiles){var N=this._tiles[b];if(!(!N.current||!N.loaded)){var G=Math.min(1,(o-N.loaded)/200);dn(N.el,G),G<1?f=!0:(N.active?v=!0:this._onOpaqueTile(N),N.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),f&&(ce(this._fadeFrame),this._fadeFrame=ue(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=mt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,f=this.options.maxZoom;if(o!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===o?(this._levels[v].el.style.zIndex=f-Math.abs(o-v),this._onUpdateLevel(v)):(lr(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var b=this._levels[o],N=this._map;return b||(b=this._levels[o]={},b.el=mt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=f,b.origin=N.project(N.unproject(N.getPixelOrigin()),o).round(),b.zoom=o,this._setZoomTransform(b,N.getCenter(),N.getZoom()),y(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var o,f,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)f=this._tiles[o],f.retain=f.current;for(o in this._tiles)if(f=this._tiles[o],f.current&&!f.active){var b=f.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var f in this._tiles)this._tiles[f].coords.z===o&&this._removeTile(f)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)lr(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,f,v,b){var N=Math.floor(o/2),G=Math.floor(f/2),me=v-1,Se=new H(+N,+G);Se.z=+me;var Pe=this._tileCoordsToKey(Se),Re=this._tiles[Pe];return Re&&Re.active?(Re.retain=!0,!0):(Re&&Re.loaded&&(Re.retain=!0),me>b?this._retainParent(N,G,me,b):!1)},_retainChildren:function(o,f,v,b){for(var N=2*o;N<2*o+2;N++)for(var G=2*f;G<2*f+2;G++){var me=new H(N,G);me.z=v+1;var Se=this._tileCoordsToKey(me),Pe=this._tiles[Se];if(Pe&&Pe.active){Pe.retain=!0;continue}else Pe&&Pe.loaded&&(Pe.retain=!0);v+1<b&&this._retainChildren(N,G,v+1,b)}},_resetView:function(o){var f=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var f=this.options;return f.minNativeZoom!==void 0&&o<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<o?f.maxNativeZoom:o},_setView:function(o,f,v,b){var N=Math.round(f);this.options.maxZoom!==void 0&&N>this.options.maxZoom||this.options.minZoom!==void 0&&N<this.options.minZoom?N=void 0:N=this._clampZoom(N);var G=this.options.updateWhenZooming&&N!==this._tileZoom;(!b||G)&&(this._tileZoom=N,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),N!==void 0&&this._update(o),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(o,f)},_setZoomTransforms:function(o,f){for(var v in this._levels)this._setZoomTransform(this._levels[v],o,f)},_setZoomTransform:function(o,f,v){var b=this._map.getZoomScale(v,o.zoom),N=o.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(f,v)).round();Oe.any3d?Qn(o.el,N,b):wr(o.el,N)},_resetGrid:function(){var o=this._map,f=o.options.crs,v=this._tileSize=this.getTileSize(),b=this._tileZoom,N=this._map.getPixelWorldBounds(this._tileZoom);N&&(this._globalTileRange=this._pxBoundsToTileRange(N)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,f.wrapLng[0]],b).x/v.x),Math.ceil(o.project([0,f.wrapLng[1]],b).x/v.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([f.wrapLat[0],0],b).y/v.x),Math.ceil(o.project([f.wrapLat[1],0],b).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var f=this._map,v=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),b=f.getZoomScale(v,this._tileZoom),N=f.project(o,this._tileZoom).floor(),G=f.getSize().divideBy(b*2);return new Y(N.subtract(G),N.add(G))},_update:function(o){var f=this._map;if(f){var v=this._clampZoom(f.getZoom());if(o===void 0&&(o=f.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(o),N=this._pxBoundsToTileRange(b),G=N.getCenter(),me=[],Se=this.options.keepBuffer,Pe=new Y(N.getBottomLeft().subtract([Se,-Se]),N.getTopRight().add([Se,-Se]));if(!(isFinite(N.min.x)&&isFinite(N.min.y)&&isFinite(N.max.x)&&isFinite(N.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Re in this._tiles){var rt=this._tiles[Re].coords;(rt.z!==this._tileZoom||!Pe.contains(new H(rt.x,rt.y)))&&(this._tiles[Re].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(o,v);return}for(var gt=N.min.y;gt<=N.max.y;gt++)for(var At=N.min.x;At<=N.max.x;At++){var Wr=new H(At,gt);if(Wr.z=this._tileZoom,!!this._isValidTile(Wr)){var jr=this._tiles[this._tileCoordsToKey(Wr)];jr?jr.current=!0:me.push(Wr)}}if(me.sort(function(hn,Ns){return hn.distanceTo(G)-Ns.distanceTo(G)}),me.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var In=document.createDocumentFragment();for(At=0;At<me.length;At++)this._addTile(me[At],In);this._level.el.appendChild(In)}}}},_isValidTile:function(o){var f=this._map.options.crs;if(!f.infinite){var v=this._globalTileRange;if(!f.wrapLng&&(o.x<v.min.x||o.x>v.max.x)||!f.wrapLat&&(o.y<v.min.y||o.y>v.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(o);return z(this.options.bounds).overlaps(b)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var f=this._map,v=this.getTileSize(),b=o.scaleBy(v),N=b.add(v),G=f.unproject(b,o.z),me=f.unproject(N,o.z);return[G,me]},_tileCoordsToBounds:function(o){var f=this._tileCoordsToNwSe(o),v=new U(f[0],f[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var f=o.split(":"),v=new H(+f[0],+f[1]);return v.z=+f[2],v},_removeTile:function(o){var f=this._tiles[o];f&&(lr(f.el),delete this._tiles[o],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){Et(o,"leaflet-tile");var f=this.getTileSize();o.style.width=f.x+"px",o.style.height=f.y+"px",o.onselectstart=y,o.onmousemove=y,Oe.ielt9&&this.options.opacity<1&&dn(o,this.options.opacity)},_addTile:function(o,f){var v=this._getTilePos(o),b=this._tileCoordsToKey(o),N=this.createTile(this._wrapCoords(o),l(this._tileReady,this,o));this._initTile(N),this.createTile.length<2&&ue(l(this._tileReady,this,o,null,N)),wr(N,v),this._tiles[b]={el:N,coords:o,current:!0},f.appendChild(N),this.fire("tileloadstart",{tile:N,coords:o})},_tileReady:function(o,f,v){f&&this.fire("tileerror",{error:f,tile:v,coords:o});var b=this._tileCoordsToKey(o);v=this._tiles[b],v&&(v.loaded=+new Date,this._map._fadeAnimated?(dn(v.el,0),ce(this._fadeFrame),this._fadeFrame=ue(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),f||(Et(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Oe.ielt9||!this._map._fadeAnimated?ue(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var f=new H(this._wrapX?g(o.x,this._wrapX):o.x,this._wrapY?g(o.y,this._wrapY):o.y);return f.z=o.z,f},_pxBoundsToTileRange:function(o){var f=this.getTileSize();return new Y(o.min.unscaleBy(f).floor(),o.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function Ts(o){return new mi(o)}var pi=mi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,f){this._url=o,f=w(this,f),f.detectRetina&&Oe.retina&&f.maxZoom>0?(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom=Math.min(f.maxZoom,f.minZoom+1)):(f.zoomOffset++,f.maxZoom=Math.max(f.minZoom,f.maxZoom-1)),f.minZoom=Math.max(0,f.minZoom)):f.zoomReverse?f.minZoom=Math.min(f.maxZoom,f.minZoom):f.maxZoom=Math.max(f.minZoom,f.maxZoom),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,f){return this._url===o&&f===void 0&&(f=!0),this._url=o,f||this.redraw(),this},createTile:function(o,f){var v=document.createElement("img");return wt(v,"load",l(this._tileOnLoad,this,f,v)),wt(v,"error",l(this._tileOnError,this,f,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(o),v},getTileUrl:function(o){var f={r:Oe.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-o.y;this.options.tms&&(f.y=v),f["-y"]=v}return I(this._url,a(f,this.options))},_tileOnLoad:function(o,f){Oe.ielt9?setTimeout(l(o,this,null,f),0):o(null,f)},_tileOnError:function(o,f,v){var b=this.options.errorTileUrl;b&&f.getAttribute("src")!==b&&(f.src=b),o(v,f)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,f=this.options.maxZoom,v=this.options.zoomReverse,b=this.options.zoomOffset;return v&&(o=f-o),o+b},_getSubdomain:function(o){var f=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var o,f;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(f=this._tiles[o].el,f.onload=y,f.onerror=y,!f.complete)){f.src=K;var v=this._tiles[o].coords;lr(f),delete this._tiles[o],this.fire("tileabort",{tile:f,coords:v})}},_removeTile:function(o){var f=this._tiles[o];if(f)return f.el.setAttribute("src",K),mi.prototype._removeTile.call(this,o)},_tileReady:function(o,f,v){if(!(!this._map||v&&v.getAttribute("src")===K))return mi.prototype._tileReady.call(this,o,f,v)}});function Vc(o,f){return new pi(o,f)}var wo=pi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,f){this._url=o;var v=a({},this.defaultWmsParams);for(var b in f)b in this.options||(v[b]=f[b]);f=w(this,f);var N=f.detectRetina&&Oe.retina?2:1,G=this.getTileSize();v.width=G.x*N,v.height=G.y*N,this.wmsParams=v},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,pi.prototype.onAdd.call(this,o)},getTileUrl:function(o){var f=this._tileCoordsToNwSe(o),v=this._crs,b=F(v.project(f[0]),v.project(f[1])),N=b.min,G=b.max,me=(this._wmsVersion>=1.3&&this._crs===kd?[N.y,N.x,G.y,G.x]:[N.x,N.y,G.x,G.y]).join(","),Se=pi.prototype.getTileUrl.call(this,o);return Se+E(this.wmsParams,Se,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+me},setParams:function(o,f){return a(this.wmsParams,o),f||this.redraw(),this}});function Id(o,f){return new wo(o,f)}pi.WMS=wo,Vc.wms=Id;var ya=na.extend({options:{padding:.1},initialize:function(o){w(this,o),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Et(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,f){var v=this._map.getZoomScale(f,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),N=this._map.project(this._center,f),G=b.multiplyBy(-v).add(N).subtract(this._map._getNewPixelOrigin(o,f));Oe.any3d?Qn(this._container,G,v):wr(this._container,G)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,f=this._map.getSize(),v=this._map.containerPointToLayerPoint(f.multiplyBy(-o)).round();this._bounds=new Y(v,v.add(f.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Gc=ya.extend({options:{tolerance:0},getEvents:function(){var o=ya.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ya.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");wt(o,"mousemove",this._onMouseMove,this),wt(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),wt(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){ce(this._redrawRequest),delete this._ctx,lr(this._container),er(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var f in this._layers)o=this._layers[f],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ya.prototype._update.call(this);var o=this._bounds,f=this._container,v=o.getSize(),b=Oe.retina?2:1;wr(f,o.min),f.width=b*v.x,f.height=b*v.y,f.style.width=v.x+"px",f.style.height=v.y+"px",Oe.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){ya.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[m(o)]=o;var f=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var f=o._order,v=f.next,b=f.prev;v?v.prev=b:this._drawLast=b,b?b.next=v:this._drawFirst=v,delete o._order,delete this._layers[m(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var f=o.options.dashArray.split(/[, ]+/),v=[],b,N;for(N=0;N<f.length;N++){if(b=Number(f[N]),isNaN(b))return;v.push(b)}o.options._dashArray=v}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||ue(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var f=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Y,this._redrawBounds.extend(o._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(o._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var f=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,f.x,f.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,f=this._redrawBounds;if(this._ctx.save(),f){var v=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)o=b.layer,(!f||o._pxBounds&&o._pxBounds.intersects(f))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,f){if(this._drawing){var v,b,N,G,me=o._parts,Se=me.length,Pe=this._ctx;if(Se){for(Pe.beginPath(),v=0;v<Se;v++){for(b=0,N=me[v].length;b<N;b++)G=me[v][b],Pe[b?"lineTo":"moveTo"](G.x,G.y);f&&Pe.closePath()}this._fillStroke(Pe,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var f=o._point,v=this._ctx,b=Math.max(Math.round(o._radius),1),N=(Math.max(Math.round(o._radiusY),1)||b)/b;N!==1&&(v.save(),v.scale(1,N)),v.beginPath(),v.arc(f.x,f.y/N,b,0,Math.PI*2,!1),N!==1&&v.restore(),this._fillStroke(v,o)}},_fillStroke:function(o,f){var v=f.options;v.fill&&(o.globalAlpha=v.fillOpacity,o.fillStyle=v.fillColor||v.color,o.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(o.setLineDash&&o.setLineDash(f.options&&f.options._dashArray||[]),o.globalAlpha=v.opacity,o.lineWidth=v.weight,o.strokeStyle=v.color,o.lineCap=v.lineCap,o.lineJoin=v.lineJoin,o.stroke())},_onClick:function(o){for(var f=this._map.mouseEventToLayerPoint(o),v,b,N=this._drawFirst;N;N=N.next)v=N.layer,v.options.interactive&&v._containsPoint(f)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(v))&&(b=v);this._fireEvent(b?[b]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,f)}},_handleMouseOut:function(o){var f=this._hoveredLayer;f&&(ir(this._container,"leaflet-interactive"),this._fireEvent([f],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,f){if(!this._mouseHoverThrottled){for(var v,b,N=this._drawFirst;N;N=N.next)v=N.layer,v.options.interactive&&v._containsPoint(f)&&(b=v);b!==this._hoveredLayer&&(this._handleMouseOut(o),b&&(Et(this._container,"leaflet-interactive"),this._fireEvent([b],o,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,f,v){this._map._fireDOMEvent(f,v||f.type,o)},_bringToFront:function(o){var f=o._order;if(f){var v=f.next,b=f.prev;if(v)v.prev=b;else return;b?b.next=v:v&&(this._drawFirst=v),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(o)}},_bringToBack:function(o){var f=o._order;if(f){var v=f.next,b=f.prev;if(b)b.next=v;else return;v?v.prev=b:b&&(this._drawLast=b),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(o)}}});function Zc(o){return Oe.canvas?new Gc(o):null}var Es=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Dd={_initContainer:function(){this._container=mt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ya.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var f=o._container=Es("shape");Et(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",o._path=Es("path"),f.appendChild(o._path),this._updateStyle(o),this._layers[m(o)]=o},_addPath:function(o){var f=o._container;this._container.appendChild(f),o.options.interactive&&o.addInteractiveTarget(f)},_removePath:function(o){var f=o._container;lr(f),o.removeInteractiveTarget(f),delete this._layers[m(o)]},_updateStyle:function(o){var f=o._stroke,v=o._fill,b=o.options,N=o._container;N.stroked=!!b.stroke,N.filled=!!b.fill,b.stroke?(f||(f=o._stroke=Es("stroke")),N.appendChild(f),f.weight=b.weight+"px",f.color=b.color,f.opacity=b.opacity,b.dashArray?f.dashStyle=A(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=b.lineCap.replace("butt","flat"),f.joinstyle=b.lineJoin):f&&(N.removeChild(f),o._stroke=null),b.fill?(v||(v=o._fill=Es("fill")),N.appendChild(v),v.color=b.fillColor||b.color,v.opacity=b.fillOpacity):v&&(N.removeChild(v),o._fill=null)},_updateCircle:function(o){var f=o._point.round(),v=Math.round(o._radius),b=Math.round(o._radiusY||v);this._setPath(o,o._empty()?"M0 0":"AL "+f.x+","+f.y+" "+v+","+b+" 0,"+65535*360)},_setPath:function(o,f){o._path.v=f},_bringToFront:function(o){fs(o._container)},_bringToBack:function(o){Wa(o._container)}},ia=Oe.vml?Es:Qe,zi=ya.extend({_initContainer:function(){this._container=ia("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ia("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){lr(this._container),er(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ya.prototype._update.call(this);var o=this._bounds,f=o.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,v.setAttribute("width",f.x),v.setAttribute("height",f.y)),wr(v,o.min),v.setAttribute("viewBox",[o.min.x,o.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(o){var f=o._path=ia("path");o.options.className&&Et(f,o.options.className),o.options.interactive&&Et(f,"leaflet-interactive"),this._updateStyle(o),this._layers[m(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){lr(o._path),o.removeInteractiveTarget(o._path),delete this._layers[m(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var f=o._path,v=o.options;f&&(v.stroke?(f.setAttribute("stroke",v.color),f.setAttribute("stroke-opacity",v.opacity),f.setAttribute("stroke-width",v.weight),f.setAttribute("stroke-linecap",v.lineCap),f.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?f.setAttribute("stroke-dasharray",v.dashArray):f.removeAttribute("stroke-dasharray"),v.dashOffset?f.setAttribute("stroke-dashoffset",v.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),v.fill?(f.setAttribute("fill",v.fillColor||v.color),f.setAttribute("fill-opacity",v.fillOpacity),f.setAttribute("fill-rule",v.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(o,f){this._setPath(o,it(o._parts,f))},_updateCircle:function(o){var f=o._point,v=Math.max(Math.round(o._radius),1),b=Math.max(Math.round(o._radiusY),1)||v,N="a"+v+","+b+" 0 1,0 ",G=o._empty()?"M0 0":"M"+(f.x-v)+","+f.y+N+v*2+",0 "+N+-v*2+",0 ";this._setPath(o,G)},_setPath:function(o,f){o._path.setAttribute("d",f)},_bringToFront:function(o){fs(o._path)},_bringToBack:function(o){Wa(o._path)}});Oe.vml&&zi.include(Dd);function Il(o){return Oe.svg||Oe.vml?new zi(o):null}Ot.include({getRenderer:function(o){var f=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var f=this._paneRenderers[o];return f===void 0&&(f=this._createRenderer({pane:o}),this._paneRenderers[o]=f),f},_createRenderer:function(o){return this.options.preferCanvas&&Zc(o)||Il(o)}});var Fd=Za.extend({initialize:function(o,f){Za.prototype.initialize.call(this,this._boundsToLatLngs(o),f)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=z(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function Vh(o,f){return new Fd(o,f)}zi.create=ia,zi.pointsToPath=it,va.geometryToLayer=ws,va.coordsToLatLng=Tl,va.coordsToLatLngs=yo,va.latLngToCoords=El,va.latLngsToCoords=Cl,va.getFeature=bs,va.asFeature=Al,Ot.mergeOptions({boxZoom:!0});var Cs=Bn.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){wt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){er(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){lr(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Mt(),hl(),this._startPoint=this._map.mouseEventToContainerPoint(o),wt(document,{contextmenu:ta,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=mt("div","leaflet-zoom-box",this._container),Et(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var f=new Y(this._point,this._startPoint),v=f.getSize();wr(this._box,f.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(lr(this._box),ir(this._container,"leaflet-crosshair")),ps(),ml(),er(document,{contextmenu:ta,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var f=new U(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ot.addInitHook("addHandler","boxZoom",Cs),Ot.mergeOptions({doubleClickZoom:!0});var jd=Bn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var f=this._map,v=f.getZoom(),b=f.options.zoomDelta,N=o.originalEvent.shiftKey?v-b:v+b;f.options.doubleClickZoom==="center"?f.setZoom(N):f.setZoomAround(o.containerPoint,N)}});Ot.addInitHook("addHandler","doubleClickZoom",jd),Ot.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Kc=Bn.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new ra(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}Et(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ir(this._map._container,"leaflet-grab"),ir(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=z(this._map.options.maxBounds);this._offsetLimit=F(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var f=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(f),this._prunePositions(f)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,f){return o-(o-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;o.x<f.min.x&&(o.x=this._viscousLimit(o.x,f.min.x)),o.y<f.min.y&&(o.y=this._viscousLimit(o.y,f.min.y)),o.x>f.max.x&&(o.x=this._viscousLimit(o.x,f.max.x)),o.y>f.max.y&&(o.y=this._viscousLimit(o.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,f=Math.round(o/2),v=this._initialWorldOffset,b=this._draggable._newPos.x,N=(b-f+v)%o+f-v,G=(b+f+v)%o-f-v,me=Math.abs(N+v)<Math.abs(G+v)?N:G;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=me},_onDragEnd:function(o){var f=this._map,v=f.options,b=!v.inertia||o.noInertia||this._times.length<2;if(f.fire("dragend",o),b)f.fire("moveend");else{this._prunePositions(+new Date);var N=this._lastPos.subtract(this._positions[0]),G=(this._lastTime-this._times[0])/1e3,me=v.easeLinearity,Se=N.multiplyBy(me/G),Pe=Se.distanceTo([0,0]),Re=Math.min(v.inertiaMaxSpeed,Pe),rt=Se.multiplyBy(Re/Pe),gt=Re/(v.inertiaDeceleration*me),At=rt.multiplyBy(-gt/2).round();!At.x&&!At.y?f.fire("moveend"):(At=f._limitOffset(At,f.options.maxBounds),ue(function(){f.panBy(At,{duration:gt,easeLinearity:me,noMoveStart:!0,animate:!0})}))}}});Ot.addInitHook("addHandler","dragging",Kc),Ot.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Yc=Bn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),wt(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),er(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,f=document.documentElement,v=o.scrollTop||f.scrollTop,b=o.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(b,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var f=this._panKeys={},v=this.keyCodes,b,N;for(b=0,N=v.left.length;b<N;b++)f[v.left[b]]=[-1*o,0];for(b=0,N=v.right.length;b<N;b++)f[v.right[b]]=[o,0];for(b=0,N=v.down.length;b<N;b++)f[v.down[b]]=[0,o];for(b=0,N=v.up.length;b<N;b++)f[v.up[b]]=[0,-1*o]},_setZoomDelta:function(o){var f=this._zoomKeys={},v=this.keyCodes,b,N;for(b=0,N=v.zoomIn.length;b<N;b++)f[v.zoomIn[b]]=o;for(b=0,N=v.zoomOut.length;b<N;b++)f[v.zoomOut[b]]=-o},_addHooks:function(){wt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){er(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var f=o.keyCode,v=this._map,b;if(f in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(b=this._panKeys[f],o.shiftKey&&(b=ne(b).multiplyBy(3)),v.options.maxBounds&&(b=v._limitOffset(ne(b),v.options.maxBounds)),v.options.worldCopyJump){var N=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(b)));v.panTo(N)}else v.panBy(b)}else if(f in this._zoomKeys)v.setZoom(v.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;ta(o)}}});Ot.addInitHook("addHandler","keyboard",Yc),Ot.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var tr=Bn.extend({addHooks:function(){wt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){er(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var f=pd(o),v=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var b=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),b),ta(o)},_performZoom:function(){var o=this._map,f=o.getZoom(),v=this._map.options.zoomSnap||0;o._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),N=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,G=v?Math.ceil(N/v)*v:N,me=o._limitZoom(f+(this._delta>0?G:-G))-f;this._delta=0,this._startTime=null,me&&(o.options.scrollWheelZoom==="center"?o.setZoom(f+me):o.setZoomAround(this._lastMousePos,f+me))}});Ot.addInitHook("addHandler","scrollWheelZoom",tr);var qc=600;Ot.mergeOptions({tapHold:Oe.touchNative&&Oe.safari&&Oe.mobile,tapTolerance:15});var bo=Bn.extend({addHooks:function(){wt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){er(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var f=o.touches[0];this._startPos=this._newPos=new H(f.clientX,f.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(wt(document,"touchend",vr),wt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",f))},this),qc),wt(document,"touchend touchcancel contextmenu",this._cancel,this),wt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){er(document,"touchend",vr),er(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),er(document,"touchend touchcancel contextmenu",this._cancel,this),er(document,"touchmove",this._onMove,this)},_onMove:function(o){var f=o.touches[0];this._newPos=new H(f.clientX,f.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,f){var v=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY});v._simulated=!0,f.target.dispatchEvent(v)}});Ot.addInitHook("addHandler","tapHold",bo),Ot.mergeOptions({touchZoom:Oe.touch,bounceAtZoomLimits:!0});var As=Bn.extend({addHooks:function(){Et(this._map._container,"leaflet-touch-zoom"),wt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ir(this._map._container,"leaflet-touch-zoom"),er(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var f=this._map;if(!(!o.touches||o.touches.length!==2||f._animatingZoom||this._zooming)){var v=f.mouseEventToContainerPoint(o.touches[0]),b=f.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(v.add(b)._divideBy(2))),this._startDist=v.distanceTo(b),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),wt(document,"touchmove",this._onTouchMove,this),wt(document,"touchend touchcancel",this._onTouchEnd,this),vr(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var f=this._map,v=f.mouseEventToContainerPoint(o.touches[0]),b=f.mouseEventToContainerPoint(o.touches[1]),N=v.distanceTo(b)/this._startDist;if(this._zoom=f.getScaleZoom(N,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&N<1||this._zoom>f.getMaxZoom()&&N>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,N===1)return}else{var G=v._add(b)._divideBy(2)._subtract(this._centerPoint);if(N===1&&G.x===0&&G.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(G),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),ce(this._animRequest);var me=l(f._move,f,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ue(me,this,!0),vr(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ce(this._animRequest),er(document,"touchmove",this._onTouchMove,this),er(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ot.addInitHook("addHandler","touchZoom",As),Ot.BoxZoom=Cs,Ot.DoubleClickZoom=jd,Ot.Drag=Kc,Ot.Keyboard=Yc,Ot.ScrollWheelZoom=tr,Ot.TapHold=bo,Ot.TouchZoom=As,r.Bounds=Y,r.Browser=Oe,r.CRS=oe,r.Canvas=Gc,r.Circle=kl,r.CircleMarker=bl,r.Class=ye,r.Control=Nn,r.DivIcon=Pl,r.DivOverlay=xa,r.DomEvent=vl,r.DomUtil=ho,r.Draggable=ra,r.Evented=j,r.FeatureGroup=Va,r.GeoJSON=va,r.GridLayer=mi,r.Handler=Bn,r.Icon=Bi,r.ImageOverlay=hi,r.LatLng=q,r.LatLngBounds=U,r.Layer=na,r.LayerGroup=di,r.LineUtil=bd,r.Map=Ot,r.Marker=Ga,r.Mixin=Fc,r.Path=fi,r.Point=H,r.PolyUtil=jh,r.Polygon=Za,r.Polyline=Pn,r.Popup=Nl,r.PosAnimation=xl,r.Projection=Bh,r.Rectangle=Fd,r.Renderer=ya,r.SVG=zi,r.SVGOverlay=$c,r.TileLayer=pi,r.Tooltip=Ss,r.Transformation=je,r.Util=Ce,r.VideoOverlay=Wc,r.bind=l,r.bounds=F,r.canvas=Zc,r.circle=xo,r.circleMarker=Ed,r.control=ui,r.divIcon=Pd,r.extend=a,r.featureGroup=Sd,r.geoJSON=Cd,r.geoJson=aa,r.gridLayer=Ts,r.icon=Td,r.imageOverlay=Ad,r.latLng=M,r.latLngBounds=z,r.layerGroup=vo,r.map=ci,r.marker=Wh,r.point=ne,r.polygon=Hh,r.polyline=$h,r.popup=ks,r.rectangle=Vh,r.setOptions=w,r.stamp=m,r.svg=Il,r.svgOverlay=Hc,r.tileLayer=Vc,r.tooltip=_o,r.transformation=X,r.version=n,r.videoOverlay=Nd;var Od=window.L;r.noConflict=function(){return window.L=Od,this},window.L=r}))})(wu,wu.exports)),wu.exports}var kc=LE();const zu=hh(kc);function xh(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function yh(e,t){return t==null?function(n,a){const s=J.useRef();return s.current||(s.current=e(n,a)),s}:function(n,a){const s=J.useRef();s.current||(s.current=e(n,a));const l=J.useRef(n),{instance:u}=s.current;return J.useEffect(function(){l.current!==n&&(t(u,n,l.current),l.current=n)},[u,n,a]),s}}function Jy(e,t){J.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){t.layerContainer?.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function Qy(e){return function(r){const n=gh(),a=e(vh(r,n),n);return Gy(n.map,r.attribution),_p(a.current,r.eventHandlers),Jy(a.current,n),a}}function ME(e,t){const r=J.useRef();J.useEffect(function(){if(t.pathOptions!==r.current){const a=t.pathOptions??{};e.instance.setStyle(a),r.current=a}},[e,t])}function BE(e){return function(r){const n=gh(),a=e(vh(r,n),n);return _p(a.current,r.eventHandlers),Jy(a.current,n),ME(a.current,r),a}}function zE(e,t){const r=yh(e,t),n=Qy(r);return Xy(n)}function UE(e,t){const r=yh(e),n=OE(r,t);return FE(n)}function WE(e,t){const r=yh(e,t),n=BE(r);return Xy(n)}function $E(e,t){const r=yh(e,t),n=Qy(r);return jE(n)}function HE(e,t,r){const{opacity:n,zIndex:a}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function e_(){return gh().map}function Gm(){return Gm=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gm.apply(this,arguments)}function VE({bounds:e,boundsOptions:t,center:r,children:n,className:a,id:s,placeholder:l,style:u,whenReady:m,zoom:p,...g},y){const[_]=J.useState({className:a,id:s,style:u}),[T,S]=J.useState(null);J.useImperativeHandle(y,()=>T?.map??null,[T]);const w=J.useCallback(P=>{if(P!==null&&T===null){const I=new kc.Map(P,g);r!=null&&p!=null?I.setView(r,p):e!=null&&I.fitBounds(e,t),m!=null&&I.whenReady(m),S(DE(I))}},[]);J.useEffect(()=>()=>{T?.map.remove()},[T]);const E=T?rr.createElement(qy,{value:T},n):l??null;return rr.createElement("div",Gm({},_,{ref:w}),E)}const t_=J.forwardRef(VE),r_=zE(function({position:t,...r},n){const a=new kc.Marker(t,r);return xh(a,Ky(n,{overlayContainer:a}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),GE=WE(function({positions:t,...r},n){const a=new kc.Polyline(t,r);return xh(a,Ky(n,{overlayContainer:a}))},function(t,r,n){r.positions!==n.positions&&t.setLatLngs(r.positions)}),Zm=UE(function(t,r){const n=new kc.Popup(t,r.overlayContainer);return xh(n,r)},function(t,r,{position:n},a){J.useEffect(function(){const{instance:l}=t;function u(p){p.popup===l&&(l.update(),a(!0))}function m(p){p.popup===l&&a(!1)}return r.map.on({popupopen:u,popupclose:m}),r.overlayContainer==null?(n!=null&&l.setLatLng(n),l.openOn(r.map)):r.overlayContainer.bindPopup(l),function(){r.map.off({popupopen:u,popupclose:m}),r.overlayContainer?.unbindPopup(),r.map.removeLayer(l)}},[t,r,a,n])}),n_=$E(function({url:t,...r},n){const a=new kc.TileLayer(t,vh(r,n));return xh(a,n)},function(t,r,n){HE(t,r,n);const{url:a}=r;a!=null&&a!==n.url&&t.setUrl(a)});function $x({startTime:e}){const[t,r]=J.useState(0);if(J.useEffect(()=>{if(!e)return;const s=()=>{const u=new Date(e).getTime(),m=Date.now();r(Math.floor((m-u)/1e3))};s();const l=setInterval(s,1e3);return()=>clearInterval(l)},[e]),!e)return null;const n=Math.floor(t/60),a=t%60;return d.jsxs("div",{className:"elapsed-timer",children:[d.jsx("span",{className:"timer-icon",children:"⏱️"}),d.jsxs("span",{className:"timer-value",children:[n,":",a.toString().padStart(2,"0")]})]})}function ZE({positions:e,resetTrigger:t}){const r=e_(),n=J.useRef(!1),a=J.useRef(0);return J.useEffect(()=>{if(!(e.length===0||!(!n.current||t&&t!==a.current)))if(n.current=!0,t&&(a.current=t),e.length===1)r.setView(e[0],15);else{const l=zu.latLngBounds(e);r.fitBounds(l.pad(.1))}},[r,e,t]),null}function KE(e,t){return zu.divIcon({className:"custom-numbered-marker",html:`<div class="marker-pin ${t?"marker-active":""}">
      <div class="marker-number">${e}</div>
    </div>`,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]})}function YE(e){return typeof e.lat=="number"&&typeof e.lng=="number"&&!Number.isNaN(e.lat)&&!Number.isNaN(e.lng)?`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(`${e.lat},${e.lng}`)}`:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e?.address??"")}`}const qE=function({state:t,setActive:r,cancelActive:n,onComplete:a,onAddArrangement:s,filterText:l}){const u=Array.isArray(t.addresses)?t.addresses:[],m=Array.isArray(t.completions)?t.completions:[],p=t.activeIndex,[g,y]=J.useState(()=>{const O=localStorage.getItem("navigator_address_view_mode");return O==="map"||O==="list"?O:"list"}),[_,T]=J.useState(0);J.useEffect(()=>{localStorage.setItem("navigator_address_view_mode",g)},[g]);const S=J.useMemo(()=>{const O=new Set;return u.forEach((ne,Y)=>{if(!ne.address)return;m.some(U=>U.index===Y&&(U.listVersion||t.currentListVersion)===t.currentListVersion)&&O.add(Y)}),O},[m,u,t.currentListVersion]),w=(l??"").trim().toLowerCase(),E=J.useMemo(()=>u.map((O,ne)=>({a:O,i:ne})).filter(({a:O})=>!w||(O.address??"").toLowerCase().includes(w)).filter(({i:O})=>!S.has(O)),[u,w,S]),[P,I]=J.useState(null),[A,R]=J.useState(""),[K,W]=J.useState(""),[D,ee]=J.useState("1"),[re,pe]=J.useState(null),[ue,ce]=J.useState(null),Ce=J.useRef(new Map),[ye,he]=J.useState(null),le=J.useMemo(()=>{const O=new Set;return m.forEach(ne=>{if(ne.address){const Y=Vm.normalizeAddress(ne.address);O.add(Y)}}),O},[m]);J.useEffect(()=>{p===null&&(I(null),R(""),W(""),ee("1"),pe(null),he(null),ce(null))},[p]);const j=J.useCallback(async(O,ne,Y,F,U,z)=>{const q=Ce.current.get(O);if(q){await q;return}const M=(async()=>{try{ce(O),await a(O,ne,Y,F,U,z),I(null)}catch(oe){throw console.error("Completion failed:",oe),oe}finally{ce(null),Ce.current.delete(O)}})();Ce.current.set(O,M),await M},[a]),H=J.useMemo(()=>E.filter(({a:O})=>O.lat&&O.lng),[E]);return E.length===0?d.jsxs("div",{className:"empty-state",children:[d.jsx("div",{className:"empty-icon",children:"📍"}),d.jsx("div",{className:"empty-title",children:"No Pending Addresses"}),d.jsx("div",{className:"empty-message",children:"Import an Excel file or add addresses manually to get started"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"view-toggle-container",children:[d.jsxs("button",{className:`view-toggle-btn ${g==="list"?"active":""}`,onClick:()=>y("list"),children:[d.jsx("span",{children:"📋"}),d.jsx("span",{children:"List"})]}),d.jsxs("button",{className:`view-toggle-btn ${g==="map"?"active":""}`,onClick:()=>y("map"),disabled:H.length===0,children:[d.jsx("span",{children:"🗺️"}),d.jsx("span",{children:"Map"}),H.length===0&&d.jsx("span",{className:"badge-warning",children:"(No coordinates)"})]})]}),g==="map"&&H.length>0&&d.jsxs("div",{className:"map-view-container",children:[d.jsx("button",{className:"map-reset-btn",onClick:()=>T(Date.now()),title:"Reset map view to show all addresses",children:"🎯 Reset View"}),d.jsxs(t_,{center:[51.5074,-.1278],zoom:10,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[d.jsx(n_,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),d.jsx(ZE,{positions:H.map(({a:O})=>[O.lat,O.lng]),resetTrigger:_}),H.map(({a:O,i:ne},Y)=>{const F=p===ne;return d.jsx(r_,{position:[O.lat,O.lng],icon:KE(Y+1,F),children:d.jsx(Zm,{children:d.jsxs("div",{className:"map-popup",children:[d.jsxs("div",{className:"popup-header",children:[d.jsxs("span",{className:"popup-number",children:["#",Y+1]}),d.jsx("span",{className:`popup-status ${F?"status-active":"status-pending"}`,children:F?"Active":"Pending"})]}),d.jsx("div",{className:"popup-address",children:O.address}),!F&&d.jsx("button",{className:"popup-btn-start",onClick:()=>r(ne),children:"▶️ Start"}),F&&d.jsxs("div",{className:"popup-active-info",children:[d.jsx($x,{startTime:t.activeStartTime}),d.jsx("button",{className:"popup-btn-complete",onClick:()=>{y("list")},children:"✅ Complete"})]})]})})},ne)})]})]}),g==="list"&&d.jsx("div",{className:"address-list-modern",children:E.map(({a:O,i:ne},Y)=>{const F=p===ne,U=YE(O);return d.jsxs("div",{className:`address-card-modern ${F?"active":""}`,children:[d.jsxs("div",{className:"address-header-modern",children:[d.jsxs("div",{className:"address-content",children:[d.jsx("div",{className:"address-number",children:Y+1}),d.jsxs("div",{className:"address-info",children:[d.jsx("div",{className:"address-title",title:O.address,children:O.address}),d.jsxs("div",{className:"address-meta",children:[d.jsxs("div",{className:"address-meta-item",children:[d.jsx("span",{children:"📍"}),d.jsxs("span",{children:["Index #",ne+1]})]}),O.lat&&O.lng&&d.jsxs("div",{className:"address-meta-item",children:[d.jsx("span",{children:"🌍"}),d.jsx("span",{children:"Coordinates ready"})]}),F&&t.activeStartTime&&d.jsx("div",{className:"address-meta-item",children:d.jsx($x,{startTime:t.activeStartTime})})]})]})]}),d.jsxs("div",{className:`address-status-badge ${F?"status-active":"status-pending"}`,children:[F&&d.jsx("span",{children:"●"}),F?"Active":"Pending"]})]}),d.jsxs("div",{className:"address-actions-modern",children:[d.jsxs("a",{className:"action-btn-modern btn-navigate",href:U,target:"_blank",rel:"noreferrer",title:"Open in Google Maps",onClick:()=>{},children:[d.jsx("span",{children:"🧭"}),d.jsx("span",{children:"Navigate"})]}),F?d.jsxs(d.Fragment,{children:[d.jsxs("button",{className:"action-btn-modern btn-complete",onClick:()=>{I(P!==ne?ne:null),R(""),W(""),pe(null)},children:[d.jsx("span",{children:"✅"}),d.jsx("span",{children:"Complete"})]}),d.jsxs("button",{className:"action-btn-modern",style:{background:"var(--gray-100)",color:"var(--gray-600)"},onClick:()=>{window.confirm("Are you sure you want to cancel? Any tracked time will be lost.")&&n()},children:[d.jsx("span",{children:"❎"}),d.jsx("span",{children:"Cancel"})]})]}):d.jsxs("button",{className:"action-btn-modern btn-set-active",onClick:()=>r(ne),children:[d.jsx("span",{children:"▶️"}),d.jsx("span",{children:"Start"})]})]}),le.has(Vm.normalizeAddress(O.address))&&d.jsx(PE,{address:O.address,completions:m}),F&&P===ne&&d.jsxs("div",{className:"outcome-panel-modern",children:[d.jsx("div",{className:"outcome-header",children:d.jsx("span",{className:"outcome-title",children:"Select Outcome"})}),d.jsxs("div",{className:"outcome-buttons",children:[d.jsxs("button",{className:"outcome-btn outcome-done",disabled:ue===ne,onClick:()=>j(ne,"Done"),title:"Mark as Done",children:[d.jsx("span",{className:"outcome-icon",children:"✅"}),d.jsx("span",{className:"outcome-label",children:"Done"})]}),d.jsxs("button",{className:"outcome-btn outcome-da",disabled:ue===ne,onClick:()=>j(ne,"DA"),title:"Mark as DA",children:[d.jsx("span",{className:"outcome-icon",children:"🚫"}),d.jsx("span",{className:"outcome-label",children:"DA"})]}),d.jsxs("button",{className:"outcome-btn outcome-arr",onClick:()=>{I(null),he(ne)},title:"Create arrangement",children:[d.jsx("span",{className:"outcome-icon",children:"📅"}),d.jsx("span",{className:"outcome-label",children:"Arrangement"})]})]}),d.jsx("div",{className:"pif-section",children:d.jsxs("div",{className:"pif-input-group",children:[d.jsx("span",{className:"pif-label",children:"💰 PIF Amount:"}),d.jsx("input",{id:`pif-amount-${ne}`,name:`pifAmount-${ne}`,type:"number",step:"0.01",min:"0",inputMode:"decimal",className:"pif-input",placeholder:"£0.00",value:A,onChange:z=>R(z.target.value),autoComplete:"off",onKeyDown:z=>{if(z.key==="Enter"){const q=Number(A);if(!Number.isFinite(q)||q<=0){alert("Enter a valid PIF amount (e.g. 50)");return}pe(ne)}}}),d.jsxs("button",{className:"outcome-btn outcome-pif",disabled:ue===ne,onClick:()=>{const z=Number(A);if(!Number.isFinite(z)||z<=0){alert("Enter a valid PIF amount (e.g. 50)");return}pe(ne)},children:[d.jsx("span",{className:"outcome-icon",children:"💷"}),d.jsx("span",{className:"outcome-label",children:"Next"})]})]})}),ue===ne&&d.jsxs("div",{className:"outcome-loading",children:[d.jsx("span",{className:"spinner-small"}),d.jsx("span",{children:"Processing..."})]})]})]},ne)})}),ye!==null&&s&&u[ye]&&d.jsx(yp,{state:t,preSelectedAddressIndex:ye,onSave:async O=>{await s(O),j(ye,"ARR"),he(null)},onCancel:()=>he(null),onComplete:j,fullscreen:!0}),re!==null&&d.jsx("div",{className:"case-ref-modal-overlay",onClick:()=>pe(null),children:d.jsxs("div",{className:"case-ref-modal",onClick:O=>O.stopPropagation(),children:[d.jsxs("div",{className:"case-ref-modal-header",children:[d.jsx("h3",{children:"📋 Enter Case Details"}),d.jsx("button",{className:"close-btn",onClick:()=>pe(null),children:"✕"})]}),d.jsxs("div",{className:"case-ref-modal-body",children:[d.jsxs("p",{children:["PIF Amount: ",d.jsxs("strong",{children:["£",Number(A).toFixed(2)]})]}),d.jsxs("div",{className:"case-ref-input-wrapper",children:[d.jsx("label",{htmlFor:"case-ref-input",children:"Case Reference Number"}),d.jsx("input",{id:"case-ref-input",type:"number",inputMode:"numeric",className:"case-ref-input",placeholder:"e.g. 123456",value:K,onChange:O=>W(O.target.value),autoComplete:"off",autoFocus:!0})]}),d.jsxs("div",{className:"case-ref-input-wrapper",style:{marginTop:"1rem"},children:[d.jsx("label",{htmlFor:"num-cases-input",children:"Number of Cases"}),d.jsx("input",{id:"num-cases-input",type:"number",inputMode:"numeric",className:"case-ref-input",placeholder:"e.g. 1",min:"1",value:D,onChange:O=>ee(O.target.value),autoComplete:"off",onKeyDown:O=>{if(O.key==="Enter"){const ne=Number(K),Y=Number(D);if(!K||!K.trim()){alert("Please enter a case reference number");return}if(!Number.isFinite(ne)||ne<=0||!Number.isInteger(ne)){alert("Case reference must be a valid whole number");return}if(!Number.isFinite(Y)||Y<=0||!Number.isInteger(Y)){alert("Number of cases must be a valid whole number");return}j(re,"PIF",Number(A).toFixed(2),void 0,K.trim(),Y),pe(null),W(""),ee("1"),R("")}}}),d.jsx("small",{style:{fontSize:"0.75rem",color:"var(--gray-500)",marginTop:"0.25rem"},children:"If 1 debtor has 3 linked cases, enter 3"})]})]}),d.jsxs("div",{className:"case-ref-modal-footer",children:[d.jsx("button",{className:"modal-btn modal-btn-cancel",onClick:()=>{pe(null),W(""),ee("1")},children:"Cancel"}),d.jsx("button",{className:"modal-btn modal-btn-save",disabled:ue===re,onClick:()=>{const O=Number(K),ne=Number(D);if(!K||!K.trim()){alert("Please enter a case reference number");return}if(!Number.isFinite(O)||O<=0||!Number.isInteger(O)){alert("Case reference must be a valid whole number");return}if(!Number.isFinite(ne)||ne<=0||!Number.isInteger(ne)){alert("Number of cases must be a valid whole number");return}j(re,"PIF",Number(A).toFixed(2),void 0,K.trim(),ne),pe(null),W(""),ee("1"),R("")},children:ue===re?"Saving...":"Save PIF"})]})]})}),d.jsx("style",{children:`
        /* Elapsed Timer Styles */
        .elapsed-timer {
          display: inline-flex;
          align-items: center;
          gap: 0.25rem;
          padding: 0.25rem 0.5rem;
          background: var(--primary);
          color: white;
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.875rem;
          animation: pulse 2s ease-in-out infinite;
        }

        .timer-icon {
          font-size: 1rem;
        }

        .timer-value {
          font-variant-numeric: tabular-nums;
          min-width: 3rem;
          text-align: center;
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.85;
          }
        }

        /* View Toggle Styles */
        .view-toggle-container {
          display: flex;
          gap: 0.5rem;
          padding: 0.75rem;
          margin-bottom: 1rem;
          background: var(--surface);
          border: 1px solid var(--border);
          border-radius: var(--radius-lg);
        }

        .view-toggle-btn {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem 1rem;
          border: 2px solid var(--border);
          border-radius: var(--radius-md);
          background: var(--surface);
          color: var(--text-secondary);
          font-weight: 600;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .view-toggle-btn:hover:not(:disabled) {
          background: var(--gray-50);
          border-color: var(--primary);
        }

        .view-toggle-btn.active {
          background: var(--primary);
          border-color: var(--primary);
          color: white;
        }

        .view-toggle-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .badge-warning {
          font-size: 0.65rem;
          color: var(--warning);
          font-weight: normal;
        }

        /* Map View Styles */
        .map-view-container {
          height: 600px;
          max-height: calc(100vh - 300px);
          position: relative;
          border-radius: var(--radius-lg);
          overflow: hidden;
          border: 1px solid var(--border);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          z-index: 1;
        }

        /* Ensure Leaflet map respects container */
        .map-view-container .leaflet-container {
          border-radius: var(--radius-lg);
          z-index: 1;
        }

        /* Map Reset Button */
        .map-reset-btn {
          position: absolute;
          top: 10px;
          right: 10px;
          z-index: 10;
          padding: 0.5rem 1rem;
          background: var(--surface);
          color: var(--text-primary);
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.875rem;
          cursor: pointer;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
          transition: all 0.2s ease;
        }

        .map-reset-btn:hover {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
          transform: translateY(-1px);
          box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        }

        .map-reset-btn:active {
          transform: translateY(0);
        }

        /* Custom Numbered Markers */
        .custom-numbered-marker {
          background: transparent;
          border: none;
        }

        .marker-pin {
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .marker-pin::before {
          content: '';
          position: absolute;
          width: 36px;
          height: 36px;
          background: var(--primary);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          border: 3px solid white;
        }

        .marker-pin.marker-active::before {
          background: var(--success);
          animation: markerPulse 2s ease-in-out infinite;
        }

        @keyframes markerPulse {
          0%, 100% {
            transform: rotate(-45deg) scale(1);
          }
          50% {
            transform: rotate(-45deg) scale(1.1);
          }
        }

        .marker-number {
          position: relative;
          z-index: 1;
          color: white;
          font-weight: bold;
          font-size: 0.875rem;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
          transform: translateY(-2px);
        }

        /* Leaflet Popup Override for Dark Mode */
        .leaflet-popup-content-wrapper {
          background: var(--surface) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--border) !important;
          box-shadow: 0 3px 14px rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-tip {
          background: var(--surface) !important;
          border: 1px solid var(--border) !important;
        }

        .leaflet-popup-close-button {
          color: var(--text-primary) !important;
        }

        .leaflet-popup-close-button:hover {
          color: var(--primary) !important;
        }

        /* Map Popup Styles */
        .map-popup {
          min-width: 200px;
          padding: 0.5rem;
        }

        .popup-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid var(--border);
        }

        .popup-number {
          font-weight: bold;
          color: var(--primary);
          font-size: 1rem;
        }

        .popup-status {
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          font-size: 0.75rem;
          font-weight: 600;
        }

        .popup-status.status-active {
          background: var(--success);
          color: white;
        }

        .popup-status.status-pending {
          background: var(--gray-700);
          color: var(--gray-100);
        }

        .popup-address {
          margin-bottom: 0.75rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .popup-btn-start,
        .popup-btn-complete {
          width: 100%;
          padding: 0.5rem 1rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .popup-btn-start {
          background: var(--primary);
          color: white;
        }

        .popup-btn-start:hover {
          background: var(--primary-dark);
        }

        .popup-btn-complete {
          background: var(--success);
          color: white;
          margin-top: 0.5rem;
        }

        .popup-btn-complete:hover {
          background: var(--success-dark);
        }

        .popup-active-info {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .popup-active-info .elapsed-timer {
          justify-content: center;
          margin-bottom: 0.25rem;
        }

        /* Modern Outcome Panel Styles */
        .outcome-panel-modern {
          background: var(--gray-50);
          border: 2px solid var(--primary);
          border-radius: var(--radius-lg);
          padding: 1rem;
          margin-top: 1rem;
          animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .outcome-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .outcome-title {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-buttons {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .outcome-btn {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 0.25rem;
          padding: 0.75rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: var(--transition-normal);
          position: relative;
          overflow: hidden;
        }

        .outcome-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(100%);
          transition: transform 0.3s ease;
        }

        .outcome-btn:hover::before {
          transform: translateY(0);
        }

        .outcome-btn:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .outcome-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .outcome-icon {
          font-size: 1.25rem;
        }

        .outcome-label {
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-done {
          background: var(--success);
          color: white;
        }

        .outcome-da {
          background: var(--danger);
          color: white;
        }

        .outcome-arr {
          background: var(--warning);
          color: white;
        }

        .outcome-pif {
          background: var(--primary);
          color: white;
        }

        .pif-section {
          padding-top: 1rem;
          border-top: 1px solid var(--gray-200);
        }

        .pif-input-group {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .pif-label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .pif-input {
          flex: 1;
          padding: 0.625rem 0.75rem;
          border: 2px solid var(--gray-200);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
          font-weight: 600;
          text-align: right;
          transition: var(--transition-normal);
        }

        .pif-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        .outcome-loading {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem;
          color: var(--gray-600);
          font-size: 0.875rem;
        }

        .spinner-small {
          width: 16px;
          height: 16px;
          border: 2px solid var(--gray-300);
          border-top-color: var(--primary);
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .outcome-buttons {
            grid-template-columns: 1fr;
          }

          .pif-input-group {
            flex-direction: column;
            align-items: stretch;
          }

          .outcome-btn {
            flex-direction: row;
            justify-content: center;
            gap: 0.5rem;
          }
        }

        /* Case Reference Modal Styles */
        .case-ref-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        .case-ref-modal {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
          width: 90%;
          max-width: 450px;
          animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .case-ref-modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
        }

        .case-ref-modal-header h3 {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--gray-800);
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: var(--gray-500);
          cursor: pointer;
          padding: 0.25rem;
          line-height: 1;
          transition: var(--transition-normal);
        }

        .close-btn:hover {
          color: var(--gray-700);
          transform: scale(1.1);
        }

        .case-ref-modal-body {
          padding: 1.5rem;
        }

        .case-ref-modal-body p {
          margin: 0 0 1.5rem 0;
          font-size: 1rem;
          color: var(--gray-600);
        }

        .case-ref-modal-body strong {
          color: var(--primary);
          font-size: 1.125rem;
        }

        .case-ref-input-wrapper {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .case-ref-input-wrapper label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .case-ref-input {
          padding: 0.875rem 1rem;
          border: 2px solid var(--gray-300);
          border-radius: var(--radius-md);
          font-size: 1rem;
          font-weight: 600;
          transition: var(--transition-normal);
        }

        .case-ref-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 4px var(--primary-light);
        }

        .case-ref-modal-footer {
          display: flex;
          gap: 0.75rem;
          padding: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .modal-btn {
          flex: 1;
          padding: 0.875rem 1.5rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.938rem;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .modal-btn-cancel {
          background: var(--gray-100);
          color: var(--gray-700);
        }

        .modal-btn-cancel:hover {
          background: var(--gray-200);
        }

        .modal-btn-save {
          background: var(--primary);
          color: white;
        }

        .modal-btn-save:hover:not(:disabled) {
          background: var(--primary-dark);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .modal-btn-save:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        @media (max-width: 768px) {
          .case-ref-modal {
            width: 95%;
            margin: 1rem;
          }

          .case-ref-modal-header,
          .case-ref-modal-body,
          .case-ref-modal-footer {
            padding: 1rem;
          }
        }
      `})]})},XE=J.memo(qE),JE="Europe/London";function Ys(e,t=JE){const r=e.toLocaleDateString("en-GB",{timeZone:t,year:"numeric"}),n=e.toLocaleDateString("en-GB",{timeZone:t,month:"2-digit"}),a=e.toLocaleDateString("en-GB",{timeZone:t,day:"2-digit"});return r+"-"+n+"-"+a}function Km(e){const t=e.split("-");return new Date(Number(t[0]),Number(t[1])-1,Number(t[2]))}function Gf(e,t){const r=new Date(e.getTime());return r.setDate(r.getDate()+t),r}function Pf(e){return new Date(e.getFullYear(),e.getMonth(),1)}function mm(e,t){return e===t}function QE(e,t,r){return e>=t&&e<=r}function Hx(e){return(e/3600).toFixed(2)}function eC(e){const t=e;if(typeof t.durationSeconds=="number")return Math.max(0,t.durationSeconds);if(e.start&&e.end)try{const r=new Date(e.start).getTime(),n=new Date(e.end).getTime();if(isFinite(r)&&isFinite(n)&&n>r)return Math.floor((n-r)/1e3)}catch(r){console.warn("Failed to calculate duration:",r)}return 0}function tC(e,t){if(!e||!t)return[];const r=Km(e),n=Km(t);if(!(r<=n))return[e];const a=[];let s=new Date(r.getTime());for(;s<=n;)a.push(Ys(s)),s=Gf(s,1);return a}function rC({startKey:e,endKey:t,onChange:r}){const n=Km(t||e||Ys(new Date)),[a,s]=J.useState(Pf(n)),[l,u]=J.useState(!1);function m(P){const I=Pf(P),R=(I.getDay()+6)%7,K=Gf(I,-R),W=[];for(let D=0;D<42;D++){const ee=Gf(K,D);W.push({key:Ys(ee),inMonth:ee.getMonth()===P.getMonth(),date:ee})}return W}const p=m(a),g=a.toLocaleDateString("en-GB",{month:"long"})+" "+String(a.getFullYear()),y=e<=t?e:t,_=e<=t?t:e,T=Ys(new Date);function S(){s(new Date(a.getFullYear(),a.getMonth()-1,1))}function w(){s(new Date(a.getFullYear(),a.getMonth()+1,1))}function E(P){if(!l){r(P,P),u(!0);return}let I=e||P,A=P;if(A<I){const R=I;I=A,A=R}r(I,A),u(!1)}return d.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[d.jsx("button",{className:"btn btn-ghost",onClick:S,"aria-label":"Previous month",children:"Prev"}),d.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:g}),d.jsx("button",{className:"btn btn-ghost",onClick:w,"aria-label":"Next month",children:"Next"})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,fontSize:12,color:"var(--text-secondary)",textAlign:"center",marginBottom:4},children:[d.jsx("div",{children:"Mon"}),d.jsx("div",{children:"Tue"}),d.jsx("div",{children:"Wed"}),d.jsx("div",{children:"Thu"}),d.jsx("div",{children:"Fri"}),d.jsx("div",{children:"Sat"}),d.jsx("div",{children:"Sun"})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:p.map(P=>{const I=QE(P.key,y,_),A=mm(P.key,e),R=mm(P.key,t),K=mm(P.key,T),W={padding:"0.5rem 0",borderRadius:8,border:"1px solid var(--border-light)",background:I?"var(--surface-strong)":"var(--surface)",textAlign:"center",cursor:"pointer",opacity:P.inMonth?1:.45,position:"relative",userSelect:"none"},D={position:"absolute",top:6,right:6,width:6,height:6,borderRadius:6,background:K?"currentColor":"transparent",opacity:K?.7:0},ee={position:"absolute",inset:0,borderRadius:8,border:A||R?"2px solid var(--primary, #4f46e5)":"2px solid transparent",pointerEvents:"none"};return d.jsxs("div",{style:W,title:P.key,onClick:()=>E(P.key),children:[d.jsx("div",{style:{fontWeight:A||R?700:500,color:"var(--text-primary)"},children:String(P.date.getDate())}),d.jsx("div",{style:D}),d.jsx("div",{style:ee})]},P.key)})}),d.jsxs("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:[d.jsx("button",{className:"btn btn-ghost",onClick:()=>{const P=Ys(new Date);r(P,P),s(Pf(new Date)),u(!1)},children:"Today"}),d.jsx("button",{className:"btn btn-ghost",onClick:()=>{const P=new Date,I=Gf(new Date,-6);r(Ys(I),Ys(P)),s(Pf(P)),u(!1)},children:"Last 7 days"})]})]})}function nC(e,t){const r=e,n=[r.date,r.day,r.at,r.timestamp,r.completedAt,r.created_at];for(const s of n){if(!s)continue;const l=new Date(s);if(!Number.isNaN(l.getTime()))return l.toISOString().slice(0,10)}const a=new Set(t.map(s=>s.date));return a.size===1&&Array.from(a)[0]||null}const aC=function({state:t,onChangeOutcome:r,onAddArrangement:n,onComplete:a}){const{addresses:s,completions:l,daySessions:u,arrangements:m}=t,[p,g]=J.useState(null),[y,_]=J.useState(""),[T,S]=J.useState(null),w=u.length>0?u[u.length-1].date:Ys(new Date),[E,P]=J.useState(w),[I,A]=J.useState(w),[R,K]=J.useState(!1),W=J.useMemo(()=>{const le=new Map;for(const j of u){const H=j.date;if(!H)continue;const O=le.get(H)||0;le.set(H,O+eC(j))}return le},[u]),D=J.useMemo(()=>{const le=new Map;return l.forEach((j,H)=>{const O=nC(j,u);if(!O)return;const ne=le.get(O);ne?ne.push(H):le.set(O,[H])}),le},[l,u]),ee=tC(E,I);let re=0,pe=0,ue=0,ce=0;ee.forEach(le=>{re+=W.get(le)||0;const j=D.get(le)||[];pe+=j.length,ue+=j.map(H=>l[H]).filter(H=>H.outcome==="PIF").length,ce+=j.map(H=>l[H]).filter(H=>H.outcome==="DA").length});const[Ce,ye]=J.useState({});function he(le){ye(j=>({...j,[le]:!j[le]}))}return d.jsxs("div",{children:[d.jsx("div",{style:{marginBottom:"0.9rem"},children:d.jsx(rC,{startKey:E,endKey:I,onChange:(le,j)=>{P(le),A(j)}})}),d.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"12px",padding:"1rem",boxShadow:"var(--shadow-sm)",marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",marginBottom:8,flexWrap:"wrap"},children:[d.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:"Summary "+(E===I?"("+E+")":"("+E+" -> "+I+")")}),d.jsx("button",{className:"btn btn-ghost",onClick:()=>K(le=>!le),children:R?"Hide details":"View details"})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("span",{className:"pill",children:["Hours ",Hx(re)]}),d.jsxs("span",{className:"pill pill-done",children:["Completed ",pe]}),d.jsxs("span",{className:"pill pill-pif",children:["PIF ",ue]}),d.jsxs("span",{className:"pill pill-da",children:["DA ",ce]})]})]}),R&&d.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:ee.map(le=>{const j=W.get(le)||0,H=D.get(le)||[],O=H.map(U=>l[U]).filter(U=>U.outcome==="PIF").length,ne=H.map(U=>l[U]).filter(U=>U.outcome==="DA").length,Y=H.map(U=>l[U]).filter(U=>U.outcome==="ARR").length,F=H.length;return d.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[d.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},children:[d.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",flexWrap:"wrap"},children:[d.jsx("strong",{children:le}),d.jsxs("span",{className:"pill",children:["Hours ",Hx(j)]}),d.jsxs("span",{className:"pill pill-done",children:["Completed ",F]}),d.jsxs("span",{className:"pill pill-pif",children:["PIF ",O]}),d.jsxs("span",{className:"pill pill-da",children:["DA ",ne]}),Y>0&&d.jsxs("span",{className:"pill pill-arr",children:["ARR ",Y]})]}),d.jsx("button",{className:"btn btn-ghost",onClick:()=>he(le),children:Ce[le]?"Hide":"View"})]}),Ce[le]&&d.jsx("div",{style:{marginTop:"0.75rem"},children:H.length===0?d.jsx("div",{style:{fontSize:14,color:"var(--text-secondary)"},children:"No entries for this day."}):d.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:H.map(U=>{const z=l[U],q=s[z.index],M=q&&q.address||q&&q.name||(typeof z.index=="number"?"Address #"+z.index:"Address"),oe=z.outcome,se=z.arrangementId?m.find(fe=>fe.id===z.arrangementId):null;return d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",alignItems:"center",border:"1px dashed var(--border-light)",borderRadius:10,padding:"0.5rem 0.75rem"},children:[d.jsxs("div",{style:{minWidth:0},children:[d.jsx("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-primary)"},children:M}),d.jsxs("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:["Index "+String(z.index),z.outcome==="PIF"&&d.jsx("span",{style:{marginLeft:8,display:"inline-flex",alignItems:"center",gap:4},children:p===U?d.jsxs(d.Fragment,{children:[d.jsx("span",{children:"· £"}),d.jsx("label",{htmlFor:`pif-amount-${U}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"PIF Amount"}),d.jsx("input",{id:`pif-amount-${U}`,name:"pifAmount",type:"number",step:"0.01",min:"0",inputMode:"decimal",style:{width:70,padding:"2px 4px",fontSize:12,border:"1px solid var(--border)",borderRadius:3,background:"var(--surface)"},value:y,onChange:fe=>_(fe.target.value),onKeyDown:fe=>{if(fe.key==="Enter"){const xe=parseFloat(y);isFinite(xe)&&xe>=0&&(r(U,"PIF",xe.toFixed(2)),g(null),_(""))}else fe.key==="Escape"&&(g(null),_(""))},autoFocus:!0}),d.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--success)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{const fe=parseFloat(y);isFinite(fe)&&fe>=0&&(r(U,"PIF",fe.toFixed(2)),g(null),_(""))},children:"✓"}),d.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--danger)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{g(null),_("")},children:"✕"})]}):d.jsxs(d.Fragment,{children:[d.jsxs("span",{children:["· £",z.amount||"0.00"]}),d.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--primary)",color:"white",border:"none",borderRadius:3,cursor:"pointer",marginLeft:4},onClick:()=>{g(U),_(z.amount||"")},title:"Edit PIF amount",children:"✏️"}),z.caseReference&&d.jsxs("span",{style:{marginLeft:8},children:["· Ref: ",z.caseReference]})]})}),se&&d.jsxs(d.Fragment,{children:[d.jsx("br",{}),d.jsxs("span",{style:{color:"var(--primary)",fontSize:"0.75rem"},children:["📅 From arrangement",se.customerName&&` (${se.customerName})`,z.outcome==="Done"&&" • Defaulted",z.outcome==="PIF"&&se.recurrenceType&&se.recurrenceType!=="none"&&` • ${se.recurrenceType==="weekly"?"Weekly":"Monthly"} payment`]})]}),z.timeSpentSeconds!==void 0&&z.timeSpentSeconds>0&&d.jsxs(d.Fragment,{children:[!se&&d.jsx("br",{}),d.jsxs("span",{style:{color:"var(--gray-600)",fontSize:"0.75rem",marginLeft:se?8:0},children:[se&&" • ","⏱️ ",Math.floor(z.timeSpentSeconds/60),"m ",z.timeSpentSeconds%60,"s"]})]})]})]}),d.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[d.jsx("label",{htmlFor:`outcome-${U}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"Outcome"}),d.jsxs("select",{id:`outcome-${U}`,name:`outcome-${U}`,value:oe||"",onChange:fe=>{const xe=fe.target.value;xe==="ARR"&&n?S({completionIndex:U,addressIndex:z.index}):r(U,xe,z.amount)},className:"input",style:{padding:"0.25rem 0.5rem",height:32},children:[d.jsx("option",{value:"",children:"-"}),d.jsx("option",{value:"Done",children:se?"Done (Defaulted)":"Done"}),d.jsx("option",{value:"PIF",children:se?"PIF (Arrangement)":"PIF"}),d.jsx("option",{value:"DA",children:"DA"}),d.jsx("option",{value:"ARR",children:"ARR"})]})]})]},U)})})})]},le)})}),T&&n&&a&&d.jsx(yp,{state:t,preSelectedAddressIndex:T.addressIndex,onSave:async le=>{await n(le),r(T.completionIndex,"ARR"),S(null)},onCancel:()=>S(null),onComplete:a,fullscreen:!0})]})},iC=J.memo(aC),sC=()=>{const[e,t]=J.useState(!1),r=J.useRef(null);return{isLoading:e,executeBackup:async s=>{if(e){console.warn("Backup already in progress, ignoring duplicate request");return}t(!0),r.current=setTimeout(()=>{console.error("Backup timeout reached - forcing reset"),t(!1)},6e4);try{await s(),console.log("Backup completed successfully")}catch(l){throw console.error("Backup failed:",l),l}finally{r.current&&(clearTimeout(r.current),r.current=null),t(!1)}},forceReset:()=>{console.warn("Force resetting backup loading state"),r.current&&(clearTimeout(r.current),r.current=null),t(!1)}}},a_=["Reminder: Please arrange payment by end of day to avoid further action.","Friendly reminder: Your arrangement is due. Contact us to confirm.","Action required: Settle outstanding balance today for compliance.","Update: Payment arrangement needed. Reply to reschedule if required."],If={backupOnEndOfDay:!1,reminderText:a_[0],darkMode:!1,pushNotifications:!0,autoSyncOnStart:!0,confirmBeforeDelete:!0,keepDataForMonths:6},Vx="navigator-web:settings",wp=()=>{const[e,t]=J.useState(()=>{if(typeof window<"u")try{const g=localStorage.getItem(Vx);return g?{...If,...JSON.parse(g)}:If}catch{return If}return If});J.useEffect(()=>{typeof window<"u"&&localStorage.setItem(Vx,JSON.stringify(e))},[e]),J.useEffect(()=>{e.darkMode?(document.documentElement.classList.add("dark-mode"),document.body.style.background="linear-gradient(135deg, #1f2937 0%, #111827 100%)"):(document.documentElement.classList.remove("dark-mode"),document.body.style.background="linear-gradient(135deg, #667eea 0%, #764ba2 100%)")},[e.darkMode]);const r=g=>{t(y=>({...y,...g}))};return{settings:e,updateSettings:r,toggleBackup:()=>r({backupOnEndOfDay:!e.backupOnEndOfDay}),toggleDarkMode:()=>r({darkMode:!e.darkMode}),togglePushNotifications:()=>r({pushNotifications:!e.pushNotifications}),toggleAutoSync:()=>r({autoSyncOnStart:!e.autoSyncOnStart}),toggleConfirmBeforeDelete:()=>r({confirmBeforeDelete:!e.confirmBeforeDelete}),updateReminderText:g=>r({reminderText:g}),updateKeepDataForMonths:g=>r({keepDataForMonths:g}),predefinedReminders:a_}};function Gx(e,t){const[r,n,a]=e.split("-").map(Number),[s,l]=t.split(":").map(Number);try{return new Date(r,(n||1)-1,a||1,s||0,l||0).toISOString()}catch{return""}}function Zx(e){if(!e)return"—";try{return new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Europe/London"})}catch{return"—"}}function Df(e){if(!e)return"";try{const t=new Date(e),r=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");return`${r}:${n}`}catch{return""}}function Kx(e){if(!e)return"";try{const t=new Date(e),r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${a}`}catch{return""}}const oC=function({sessions:t,completions:r,startDay:n,endDay:a,onEditStart:s,onEditEnd:l,onBackup:u}){const{settings:m}=wp(),{isLoading:p,executeBackup:g,forceReset:y}=sC(),_=new Date().toISOString().slice(0,10),T=t.filter(H=>H.date===_),S=T.find(H=>!H.end)||null,w=S||T.slice().sort((H,O)=>{const ne=new Date(H.start||H.date+"T00:00:00.000Z").getTime();return new Date(O.start||O.date+"T00:00:00.000Z").getTime()-ne})[0],E=!!S,P=async()=>{try{m.backupOnEndOfDay&&u&&await g(u),a()}catch(H){console.error("Failed to complete backup during end day:",H),a()}},A=r.filter(H=>(H.timestamp||"").slice(0,10)===_).reduce((H,O)=>((O.outcome==="PIF"||O.outcome==="DA"||O.outcome==="Done"||O.outcome==="ARR")&&(H[O.outcome]+=1),H),{PIF:0,DA:0,Done:0,ARR:0}),[R,K]=J.useState(!1),[W,D]=J.useState(_),[ee,re]=J.useState(()=>{if(w?.start)return Df(w.start);const H=new Date;return`${String(H.getHours()).padStart(2,"0")}:${String(H.getMinutes()).padStart(2,"0")}`});J.useEffect(()=>{if(w?.start)D(Kx(w.start)||w.date),re(Df(w.start));else{D(_);const H=new Date;re(`${String(H.getHours()).padStart(2,"0")}:${String(H.getMinutes()).padStart(2,"0")}`)}},[w?.start,w?.date,_]);const pe=J.useCallback(()=>{const H=Gx(W,ee);H&&s(H),K(!1)},[W,ee,s]),[ue,ce]=J.useState(!1),[Ce,ye]=J.useState(_),[he,le]=J.useState(()=>{if(w?.end)return Df(w.end);const H=new Date;return`${String(H.getHours()).padStart(2,"0")}:${String(H.getMinutes()).padStart(2,"0")}`});J.useEffect(()=>{if(w?.end)ye(Kx(w.end)||w.date),le(Df(w.end));else{ye(_);const H=new Date;le(`${String(H.getHours()).padStart(2,"0")}:${String(H.getMinutes()).padStart(2,"0")}`)}},[w?.end,w?.date,_]);const j=J.useCallback(()=>{const H=Gx(Ce,he);H&&l(H),ce(!1)},[Ce,he,l]);return d.jsxs("div",{className:`day-panel-modern ${E?"day-panel-active":""}`,children:[d.jsxs("div",{className:"day-panel-header",children:[d.jsxs("div",{className:"day-status",children:[d.jsx("div",{className:"day-status-icon",children:E?"🟢":w?"🔴":"⚫"}),d.jsxs("div",{className:"day-status-text",children:[d.jsx("div",{className:"day-status-title",children:E?"Day Running":w?"Day Completed":"No Session Today"}),d.jsx("div",{className:"day-status-subtitle",children:w?.start?d.jsxs(d.Fragment,{children:[Zx(w.start),w?.end&&d.jsxs(d.Fragment,{children:[" → ",Zx(w.end)]}),E&&!w?.end&&d.jsxs(d.Fragment,{children:[" • ",d.jsx("span",{style:{color:"var(--success)"},children:"Active"})]})]}):"Click 'Start Day' to begin tracking"})]})]}),d.jsxs("div",{className:"day-stats-modern",children:[d.jsxs("div",{className:"stat-pill stat-pill-pif",children:[d.jsx("span",{className:"stat-number",children:A.PIF}),d.jsx("span",{className:"stat-label",children:"PIF"})]}),d.jsxs("div",{className:"stat-pill stat-pill-done",children:[d.jsx("span",{className:"stat-number",children:A.Done}),d.jsx("span",{className:"stat-label",children:"Done"})]}),d.jsxs("div",{className:"stat-pill stat-pill-da",children:[d.jsx("span",{className:"stat-number",children:A.DA}),d.jsx("span",{className:"stat-label",children:"DA"})]}),d.jsxs("div",{className:"stat-pill stat-pill-arr",children:[d.jsx("span",{className:"stat-number",children:A.ARR}),d.jsx("span",{className:"stat-label",children:"ARR"})]})]})]}),d.jsxs("div",{className:"day-panel-actions",children:[d.jsx("div",{className:"primary-actions",children:E?d.jsxs("button",{className:"btn btn-danger btn-modern",onClick:P,disabled:p,children:[d.jsx("span",{className:"btn-icon",children:p?"⏳":"⏹️"}),p?"Ending Day...":"End Day"]}):d.jsxs("button",{className:"btn btn-primary btn-modern",onClick:n,children:[d.jsx("span",{className:"btn-icon",children:"▶️"}),"Start Day"]})}),d.jsxs("div",{className:"edit-actions",children:[R?d.jsxs("div",{className:"day-edit-group",children:[d.jsx("input",{id:"start-date",name:"startDate",type:"date",className:"input input-sm",value:W,onChange:H=>D(H.target.value),autoComplete:"off"}),d.jsx("input",{id:"start-time",name:"startTime",type:"time",className:"input input-sm",value:ee,onChange:H=>re(H.target.value),autoComplete:"off"}),d.jsx("button",{className:"btn btn-primary btn-sm",onClick:pe,children:"💾"}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>K(!1),children:"✕"})]}):d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>K(!0),title:"Edit today's start time",children:"✏️ Edit start"}),ue?d.jsxs("div",{className:"day-edit-group",children:[d.jsx("input",{id:"end-date",name:"endDate",type:"date",className:"input input-sm",value:Ce,onChange:H=>ye(H.target.value),autoComplete:"off"}),d.jsx("input",{id:"end-time",name:"endTime",type:"time",className:"input input-sm",value:he,onChange:H=>le(H.target.value),autoComplete:"off"}),d.jsx("button",{className:"btn btn-primary btn-sm",onClick:j,children:"💾"}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(!1),children:"✕"})]}):d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(!0),title:"Edit today's finish time",children:"✏️ Edit finish"})]})]}),d.jsx(xp,{isOpen:p,onClose:()=>{console.warn("Emergency backup escape triggered by user"),y()},title:"Backing up data",showCloseButton:!0,size:"sm",children:d.jsx("div",{className:"backup-loading-modal",children:d.jsxs("div",{className:"backup-loading-content",children:[d.jsx(AE,{size:"lg"}),d.jsx("h3",{className:"backup-loading-title",children:"Backing up data, please wait..."}),d.jsx("p",{className:"backup-loading-message",children:"This usually takes 5-15 seconds. If stuck for more than 20 seconds, you can close this dialog to continue."}),d.jsx("div",{className:"backup-loading-warning",style:{marginTop:"1rem",fontSize:"0.9rem",color:"var(--warning)",textAlign:"center"},children:"⚠️ If backup appears stuck, click the ✕ button to escape"})]})})})]})},lC=J.memo(oC),cC=function({state:t,onAddArrangement:r,onUpdateArrangement:n,onDeleteArrangement:a,onAddAddress:s,onComplete:l,autoCreateForAddress:u,onAutoCreateHandled:m}){const[p,g]=J.useState("thisWeek"),[y,_]=J.useState(!1),[T,S]=J.useState(null),[w,E]=J.useState({saving:!1,updating:!1,deleting:new Set,markingPaid:new Set,markingDefaulted:new Set,sendingReminder:new Set}),[P,I]=J.useState(new Set),A=he=>{if(!he)return"";let le=he.replace(/[^\d+]/g,"");return le.startsWith("0")||le.startsWith("+44")||le.startsWith("44")?le:le.length===10&&le.startsWith("7")?"0"+le:le},R=async he=>{if(!he.phoneNumber){alert("No phone number available for this arrangement.");return}E(le=>({...le,sendingReminder:new Set([...le.sendingReminder,he.id])}));try{const le={id:"temp",arrangementId:he.id,type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},j=wy(he,le,t.reminderSettings),O=`sms:${A(he.phoneNumber)}?body=${encodeURIComponent(j)}`;window.location.href=O;const ne=new Date().toISOString();await n(he.id,{lastReminderSent:ne,reminderCount:(he.reminderCount||0)+1,updatedAt:ne}),I(Y=>new Set([...Y,he.id])),setTimeout(()=>{I(Y=>{const F=new Set(Y);return F.delete(he.id),F})},3e3)}catch(le){console.error("Failed to send reminder:",le),alert("Failed to update reminder information. Please try again.")}finally{E(le=>({...le,sendingReminder:new Set([...le.sendingReminder].filter(j=>j!==he.id))}))}};J.useEffect(()=>{u!=null&&(_(!0),m?.())},[u,m]);const K=J.useMemo(()=>{const he=new Date,le=vc(he,{weekStartsOn:1}),j=Fk(he,{weekStartsOn:1});let H=t.arrangements;return p==="thisWeek"?H=t.arrangements.filter(O=>{const ne=Fa(O.scheduledDate);return j2(ne,{start:le,end:j})&&O.status!=="Completed"&&O.status!=="Cancelled"}):H=t.arrangements.filter(O=>O.status!=="Completed"&&O.status!=="Cancelled"),H.sort((O,ne)=>{const Y=Fa(O.scheduledDate).getTime(),F=Fa(ne.scheduledDate).getTime();if(Y!==F)return Y-F;const U=O.scheduledTime||"00:00",z=ne.scheduledTime||"00:00";return U.localeCompare(z)})},[t.arrangements,p]),W=J.useMemo(()=>{const he=new Map;return K.forEach(le=>{const j=le.scheduledDate;he.has(j)||he.set(j,[]),he.get(j).push(le)}),Array.from(he.entries()).sort((le,j)=>le[0].localeCompare(j[0]))},[K]),D=J.useMemo(()=>{const he=K.length,le=new Date().toISOString().slice(0,10),j=K.filter(ne=>ne.scheduledDate===le).length,H=K.filter(ne=>{const Y=Fa(ne.scheduledDate);return F2(Y)&&ne.status==="Scheduled"}).length,O=K.reduce((ne,Y)=>{if(Y.amount&&Y.status!=="Completed"){const F=parseFloat(Y.amount);return ne+(isNaN(F)?0:F)}return ne},0);return{total:he,todayCount:j,overdue:H,totalAmountDue:O}},[K]),ee=he=>{switch(he){case"Scheduled":return"📅";case"Confirmed":return"✅";case"Completed":return"🎉";case"Cancelled":return"❌";case"Missed":return"⚠️"}},re=he=>{const le=Fa(he),j=new Date,H=fp(j,1);return ox(le,j)?"Today":ox(le,H)?"Tomorrow":qf(le,"EEEE, d MMM yyyy")},pe=(he,le,j=1)=>{const H=new Date(he);switch(le){case"weekly":H.setDate(H.getDate()+7*j);break;case"biweekly":H.setDate(H.getDate()+14);break;case"monthly":H.setMonth(H.getMonth()+j);break;default:return he}return H.toISOString().slice(0,10)},ue=async he=>{const le=t.arrangements.find(j=>j.id===he);le&&(n(he,{status:"Completed",updatedAt:new Date().toISOString()}),l(le.addressIndex,"Done",void 0,le.id))},ce=async(he,le)=>{const j=t.arrangements.find(Y=>Y.id===he);if(!j)return;const H=(j.paymentsMade||0)+1,O=H>=(j.totalPayments||1),ne=j.recurrenceType&&j.recurrenceType!=="none";if(n(he,{status:"Completed",amount:le,paymentsMade:H,updatedAt:new Date().toISOString()}),l(j.addressIndex,"PIF",le,j.id),ne&&!O){const Y=pe(j.scheduledDate,j.recurrenceType,j.recurrenceInterval||1),F=H+1,U={addressIndex:j.addressIndex,address:j.address,customerName:j.customerName,phoneNumber:j.phoneNumber,scheduledDate:Y,scheduledTime:j.scheduledTime,status:"Scheduled",notes:j.notes?`${j.notes} (Payment ${F}/${j.totalPayments})`:`Payment ${F}/${j.totalPayments}`,amount:j.amount,recurrenceType:j.recurrenceType,recurrenceInterval:j.recurrenceInterval,totalPayments:j.totalPayments,paymentsMade:H,parentArrangementId:j.parentArrangementId||j.id};await r(U)}},Ce=async he=>{E(le=>({...le,saving:!0}));try{if(he.addressIndex<0||he.addressIndex>=t.addresses.length)throw new Error("Selected address is no longer valid. Please refresh and try again.");if(he.initialPaymentAmount&&parseFloat(he.initialPaymentAmount)>0){const j=await r(he);if(await new Promise(O=>setTimeout(O,100)),!t.arrangements.find(O=>O.id===j))throw new Error("Arrangement was created but not yet available. Please refresh and mark the payment manually.");await ce(j,he.initialPaymentAmount)}else{await r(he);try{l(he.addressIndex,"ARR")}catch(j){console.error("Error recording ARR completion:",j),alert("Arrangement created successfully, but there was an issue recording the completion. You may need to manually mark this address as ARR.")}}_(!1),S(null)}catch(le){console.error("Error saving arrangement:",le),alert(`Failed to save arrangement: ${le instanceof Error?le.message:"Please try again."}`)}finally{E(le=>({...le,saving:!1}))}},ye=async(he,le)=>{E(j=>({...j,updating:!0}));try{await n(he,le),S(null)}catch(j){console.error("Error updating arrangement:",j),alert("Failed to update arrangement. Please try again.")}finally{E(j=>({...j,updating:!1}))}};return d.jsxs("div",{className:"arrangements-wrap",children:[d.jsxs("div",{className:"top-row",children:[d.jsxs("div",{className:"stat-item",children:[d.jsx("div",{className:"stat-label",children:"📋 Due"}),d.jsx("div",{className:"stat-value",children:D.total})]}),d.jsxs("div",{className:"stat-item",children:[d.jsx("div",{className:"stat-label",children:"📅 Today"}),d.jsx("div",{className:"stat-value",style:{color:D.todayCount>0?"var(--warning)":"var(--text-primary)"},children:D.todayCount})]}),D.overdue>0&&d.jsxs("div",{className:"stat-item",children:[d.jsx("div",{className:"stat-label",children:"⚠️ Overdue"}),d.jsx("div",{className:"stat-value",style:{color:"var(--danger)"},children:D.overdue})]}),D.totalAmountDue>0&&d.jsxs("div",{className:"stat-item",children:[d.jsx("div",{className:"stat-label",children:"💰 Total Due"}),d.jsxs("div",{className:"stat-value",style:{color:"var(--success)"},children:["£",D.totalAmountDue.toFixed(2)]})]}),d.jsx("div",{className:"stat-actions",children:d.jsxs("div",{className:"btn-group",children:[d.jsx("button",{className:`btn ${p==="thisWeek"?"btn-primary":"btn-ghost"}`,onClick:()=>g("thisWeek"),children:"📅 This Week"}),d.jsx("button",{className:`btn ${p==="all"?"btn-primary":"btn-ghost"}`,onClick:()=>g("all"),children:"📋 All Pending"}),d.jsx("button",{className:"btn btn-success",onClick:()=>_(!0),children:"➕ Add Arrangement"})]})})]}),(y||T)&&d.jsx(yp,{state:t,arrangement:T?t.arrangements.find(he=>he.id===T):void 0,preSelectedAddressIndex:u,onAddAddress:s,onSave:T?he=>ye(T,he):Ce,onCancel:()=>{_(!1),S(null)},isLoading:w.saving||w.updating,onComplete:l,fullscreen:!0}),d.jsx("div",{className:"days-list",children:W.length===0?d.jsxs("div",{className:"empty-box",children:[d.jsxs("div",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:["📅 No payment arrangements ",p==="thisWeek"?"due this week":"pending"]}),d.jsx("div",{style:{fontSize:"0.875rem",opacity:.75},children:p==="thisWeek"?"No payment arrangements are scheduled for this week":"No pending payment arrangements found"})]}):W.map(([he,le])=>d.jsxs("div",{className:"day-card fade-in-up",children:[d.jsx("div",{className:"day-header",children:d.jsxs("div",{children:[d.jsx("div",{className:"day-title",children:re(he)}),d.jsxs("div",{className:"muted",children:[le.length," payment",le.length===1?"":"s"," due",le.some(j=>j.amount)&&d.jsxs(d.Fragment,{children:[" • £",le.reduce((j,H)=>{const O=parseFloat(H.amount||"0");return j+(isNaN(O)?0:O)},0).toFixed(2)," total"]})]})]})}),d.jsx("div",{className:"arrangements-list",children:le.map(j=>d.jsxs("div",{className:"arrangement-card-modern",children:[d.jsxs("div",{className:"arrangement-card-header",children:[d.jsxs("div",{className:"arrangement-primary-info",children:[d.jsxs("div",{className:"arrangement-address-modern",children:[d.jsxs("span",{className:"address-index",children:["#",j.addressIndex+1]}),d.jsx("span",{className:"address-text",children:j.address})]}),j.customerName&&d.jsxs("div",{className:"arrangement-customer-modern",children:[d.jsx("span",{className:"customer-icon",children:"👤"}),d.jsx("span",{className:"customer-name",children:j.customerName})]})]}),d.jsx("div",{className:"arrangement-status-modern",children:d.jsxs("span",{className:`status-badge-modern status-${j.status.toLowerCase()}`,children:[d.jsx("span",{className:"status-icon",children:ee(j.status)}),d.jsx("span",{className:"status-text",children:j.status})]})})]}),d.jsx("div",{className:"arrangement-card-body",children:d.jsxs("div",{className:"arrangement-details-grid",children:[d.jsxs("div",{className:"detail-item",children:[d.jsx("span",{className:"detail-icon",children:"📅"}),d.jsxs("div",{className:"detail-content",children:[d.jsx("span",{className:"detail-label",children:"Date"}),d.jsx("span",{className:"detail-value",children:j.scheduledDate})]})]}),j.scheduledTime&&d.jsxs("div",{className:"detail-item",children:[d.jsx("span",{className:"detail-icon",children:"🕐"}),d.jsxs("div",{className:"detail-content",children:[d.jsx("span",{className:"detail-label",children:"Time"}),d.jsx("span",{className:"detail-value",children:j.scheduledTime})]})]}),j.amount&&d.jsxs("div",{className:"detail-item",children:[d.jsx("span",{className:"detail-icon",children:"💰"}),d.jsxs("div",{className:"detail-content",children:[d.jsx("span",{className:"detail-label",children:"Amount"}),d.jsxs("span",{className:"detail-value amount-value",children:["£",j.amount]})]})]}),j.phoneNumber&&d.jsxs("div",{className:"detail-item",children:[d.jsx("span",{className:"detail-icon",children:"📞"}),d.jsxs("div",{className:"detail-content",children:[d.jsx("span",{className:"detail-label",children:"Phone"}),d.jsx("a",{href:`tel:${j.phoneNumber}`,className:"detail-value phone-link",children:j.phoneNumber})]})]}),j.notes&&d.jsxs("div",{className:"detail-item detail-notes",children:[d.jsx("span",{className:"detail-icon",children:"📝"}),d.jsxs("div",{className:"detail-content",children:[d.jsx("span",{className:"detail-label",children:"Notes"}),d.jsx("span",{className:"detail-value",children:j.notes})]})]}),j.recurrenceType&&j.recurrenceType!=="none"&&d.jsxs("div",{className:"detail-item",children:[d.jsx("span",{className:"detail-icon",children:"🔄"}),d.jsxs("div",{className:"detail-content",children:[d.jsx("span",{className:"detail-label",children:"Recurrence"}),d.jsxs("span",{className:"detail-value",children:[j.recurrenceType==="weekly"?"Weekly":j.recurrenceType==="biweekly"?"Bi-weekly":j.recurrenceType==="monthly"?"Monthly":j.recurrenceType,j.recurrenceInterval&&j.recurrenceInterval>1&&j.recurrenceType!=="biweekly"&&` (every ${j.recurrenceInterval})`,d.jsxs("div",{className:"recurrence-progress",children:["Payment ",(j.paymentsMade||0)+1," of ",j.totalPayments||1]})]})]})]})]})}),d.jsxs("div",{className:"arrangement-actions",children:[j.status==="Scheduled"&&(!j.recurrenceType||j.recurrenceType==="none"||j.paymentsMade&&j.totalPayments&&j.paymentsMade>=j.totalPayments-1)&&d.jsx(es,{className:"btn btn-sm btn-success",isLoading:w.markingPaid.has(j.id),loadingText:"Processing...",onClick:async()=>{const H=window.prompt(`Payment received:

Expected: £${j.amount||"0.00"}
Enter actual amount received:`,j.amount||"");if(H!==null&&H.trim()){E(O=>({...O,markingPaid:new Set([...O.markingPaid,j.id])}));try{await ce(j.id,H.trim())}finally{E(O=>({...O,markingPaid:new Set([...O.markingPaid].filter(ne=>ne!==j.id))}))}}},children:"✅ Confirm Payment"}),(j.status==="Scheduled"||j.status==="Confirmed")&&d.jsxs(d.Fragment,{children:[j.phoneNumber&&d.jsxs("div",{style:{position:"relative"},children:[d.jsx(es,{className:"btn btn-sm btn-primary",isLoading:w.sendingReminder.has(j.id),loadingText:"Opening...",onClick:()=>R(j),title:`Send SMS reminder to ${j.phoneNumber}`,children:"📱 Send SMS"}),P.has(j.id)&&d.jsx("div",{className:"reminder-confirmation",style:{position:"absolute",top:"-35px",left:"0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"nowrap",zIndex:1e3,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"✅ SMS opened!"}),j.reminderCount&&j.reminderCount>0&&d.jsxs("div",{className:"reminder-history",children:[j.reminderCount," SMS reminder",j.reminderCount>1?"s":""," sent",j.lastReminderSent&&d.jsxs("span",{children:[" • Last: ",qf(Fa(j.lastReminderSent),"MMM d, HH:mm")]})]})]}),j.recurrenceType&&j.recurrenceType!=="none"&&(!j.paymentsMade||!j.totalPayments||j.paymentsMade<j.totalPayments-1)&&d.jsx(es,{className:"btn btn-sm btn-success",isLoading:w.markingPaid.has(j.id),loadingText:"Processing...",onClick:async()=>{const H=window.prompt(`Continue with payment plan:

Expected: £${j.amount||"0.00"}
Enter actual amount received:`,j.amount||"");if(H!==null&&H.trim()){E(O=>({...O,markingPaid:new Set([...O.markingPaid,j.id])}));try{await ce(j.id,H.trim())}finally{E(O=>({...O,markingPaid:new Set([...O.markingPaid].filter(ne=>ne!==j.id))}))}}},children:"✅ Continue Plan"}),d.jsx(es,{className:"btn btn-sm btn-warning",isLoading:w.markingDefaulted.has(j.id),loadingText:"Processing...",onClick:async()=>{if(confirm("Mark this arrangement as defaulted? This will complete the case as 'Done (Defaulted Arrangement)'.")){E(H=>({...H,markingDefaulted:new Set([...H.markingDefaulted,j.id])}));try{await ue(j.id)}finally{E(H=>({...H,markingDefaulted:new Set([...H.markingDefaulted].filter(O=>O!==j.id))}))}}},children:"❌ Defaulted"})]}),d.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>S(j.id),disabled:w.updating||w.saving,children:"✏️ Edit"}),d.jsx(es,{className:"btn btn-sm btn-danger",isLoading:w.deleting.has(j.id),loadingText:"Deleting...",onClick:async()=>{if(confirm("Are you sure you want to delete this arrangement?")){E(H=>({...H,deleting:new Set([...H.deleting,j.id])}));try{await a(j.id)}finally{E(H=>({...H,deleting:new Set([...H.deleting].filter(O=>O!==j.id))}))}}},children:"🗑️ Delete"})]})]},j.id))})]},he))}),d.jsx("style",{children:`
        .arrangement-card-modern {
          background: linear-gradient(135deg, white 0%, var(--gray-50) 100%);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          padding: 1.5rem;
          margin-bottom: 1rem;
          box-shadow: var(--shadow-sm);
          transition: all 0.2s ease;
          position: relative;
          overflow: hidden;
        }

        .arrangement-card-modern:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
          border-color: var(--primary-light);
        }

        .arrangement-card-modern::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 3px;
          background: linear-gradient(90deg, var(--primary) 0%, var(--success) 100%);
        }

        .arrangement-card-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1.25rem;
          gap: 1rem;
        }

        .arrangement-primary-info {
          flex: 1;
        }

        .arrangement-address-modern {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          margin-bottom: 0.5rem;
        }

        .address-index {
          background: var(--primary);
          color: white;
          font-size: 0.75rem;
          font-weight: 600;
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          min-width: 2rem;
          text-align: center;
        }

        .address-text {
          font-weight: 600;
          font-size: 1.1rem;
          color: var(--text-primary);
          line-height: 1.2;
        }

        .arrangement-customer-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.9rem;
          color: var(--text-secondary);
        }

        .customer-icon {
          font-size: 1rem;
        }

        .customer-name {
          font-weight: 500;
        }

        .arrangement-status-modern {
          flex-shrink: 0;
        }

        .status-badge-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          border-radius: var(--radius-full);
          font-size: 0.875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          transition: all 0.2s ease;
        }

        .status-badge-modern.status-scheduled {
          background: linear-gradient(135deg, var(--blue-50) 0%, var(--blue-25) 100%);
          color: var(--blue-700);
          border: 1px solid var(--blue-200);
        }

        .status-badge-modern.status-confirmed {
          background: linear-gradient(135deg, var(--success-light) 0%, var(--success-lighter) 100%);
          color: var(--success-dark);
          border: 1px solid var(--success-border);
        }

        .status-badge-modern.status-completed {
          background: linear-gradient(135deg, var(--green-50) 0%, var(--green-25) 100%);
          color: var(--green-700);
          border: 1px solid var(--green-200);
        }

        .status-badge-modern.status-cancelled {
          background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-25) 100%);
          color: var(--gray-700);
          border: 1px solid var(--gray-200);
        }

        .status-badge-modern.status-missed {
          background: linear-gradient(135deg, var(--danger-light) 0%, var(--danger-lighter) 100%);
          color: var(--danger-dark);
          border: 1px solid var(--danger-border);
        }

        .status-icon {
          font-size: 0.875rem;
        }

        .arrangement-card-body {
          margin-bottom: 1.25rem;
        }

        .arrangement-details-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          padding: 0.75rem;
          background: var(--gray-25);
          border-radius: var(--radius-md);
          transition: all 0.2s ease;
        }

        .detail-item:hover {
          background: var(--gray-50);
        }

        .detail-notes {
          grid-column: 1 / -1;
        }

        /* Dark mode styles for arrangements */
        .dark-mode .arrangement-card-modern {
          background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-card-modern:hover {
          border-color: var(--primary);
          background: linear-gradient(135deg, var(--gray-200) 0%, var(--gray-300) 100%);
        }

        .dark-mode .address-text {
          color: var(--gray-800);
        }

        .dark-mode .customer-name {
          color: var(--gray-600);
        }

        .dark-mode .detail-item {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .detail-item:hover {
          background: var(--gray-300);
        }

        .dark-mode .detail-label {
          color: var(--gray-500);
        }

        .dark-mode .detail-value {
          color: var(--gray-800);
        }

        .dark-mode .phone-link {
          color: var(--primary) !important;
        }

        .dark-mode .recurrence-progress {
          color: var(--gray-500);
        }

        .dark-mode .reminder-confirmation {
          background: var(--gray-200) !important;
          color: var(--gray-800) !important;
        }

        .dark-mode .reminder-history {
          color: var(--gray-600) !important;
        }

        /* Basic card and form styles */
        .card {
          background: white;
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          overflow: hidden;
        }

        .card-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
          background: var(--gray-50);
        }

        .card-body {
          padding: 1.5rem;
        }

        .form-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 1rem;
        }

        .form-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .form-group-full {
          grid-column: 1 / -1;
        }

        .form-group label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .btn-row {
          display: flex;
          gap: 0.75rem;
          align-items: center;
          flex-wrap: wrap;
        }

        .btn-row-end {
          justify-content: flex-end;
        }

        .arrangements-wrap {
          max-width: none;
          width: 100%;
        }

        .top-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          margin-bottom: 2rem;
          flex-wrap: wrap;
        }

        .stat-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 0.75rem 1rem;
          background: white;
          border-radius: var(--radius-md);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          min-width: 80px;
        }

        .stat-label {
          font-size: 0.75rem;
          color: var(--gray-600);
          margin-bottom: 0.25rem;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--gray-800);
        }

        .stat-actions {
          display: flex;
          gap: 1rem;
          align-items: center;
        }

        .days-list {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .day-card {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          overflow: hidden;
        }

        .day-header {
          padding: 1.5rem;
          background: var(--gray-50);
          border-bottom: 1px solid var(--gray-200);
        }

        .day-title {
          font-size: 1.125rem;
          font-weight: 700;
          color: var(--gray-800);
          margin-bottom: 0.25rem;
        }

        .muted {
          font-size: 0.875rem;
          color: var(--gray-500);
        }

        .arrangements-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          padding: 1.5rem;
        }

        .empty-box {
          padding: 3rem;
          text-align: center;
          background: white;
          border-radius: var(--radius-lg);
          border: 2px dashed var(--gray-300);
          color: var(--gray-500);
        }

        .fade-in-up {
          animation: fadeInUp 0.3s ease-out;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        /* Dark mode for basic elements */
        .dark-mode .card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .card-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .form-group label {
          color: var(--gray-700);
        }

        .dark-mode .stat-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .stat-label {
          color: var(--gray-500);
        }

        .dark-mode .stat-value {
          color: var(--gray-800);
        }

        .dark-mode .day-card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .day-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .day-title {
          color: var(--gray-800);
        }

        .dark-mode .muted {
          color: var(--gray-500);
        }

        .dark-mode .empty-box {
          background: var(--gray-100);
          border-color: var(--gray-400);
          color: var(--gray-500);
        }

        /* Dark mode button styles */
        .dark-mode .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        /* Dark mode arrangement actions */
        .dark-mode .arrangement-actions .btn {
          background: var(--gray-200);
          color: var(--gray-700);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-actions .btn:hover {
          background: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .arrangement-actions .btn-success {
          background: var(--success);
          color: white;
          border-color: var(--success);
        }

        .dark-mode .arrangement-actions .btn-success:hover {
          background: var(--success-dark);
          border-color: var(--success-dark);
        }

        .dark-mode .arrangement-actions .btn-primary {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }

        .dark-mode .arrangement-actions .btn-primary:hover {
          background: var(--primary-hover);
          border-color: var(--primary-hover);
        }

        .dark-mode .arrangement-actions .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .arrangement-actions .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .arrangement-actions .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .arrangement-actions .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        .dark-mode .arrangement-actions .btn-ghost {
          background: transparent;
          color: var(--gray-600);
          border-color: var(--gray-400);
        }

        .dark-mode .arrangement-actions .btn-ghost:hover {
          background: var(--gray-200);
          color: var(--gray-800);
        }

        .detail-icon {
          font-size: 1.1rem;
          flex-shrink: 0;
          margin-top: 0.125rem;
        }

        .detail-content {
          flex: 1;
          min-width: 0;
        }

        .detail-label {
          display: block;
          font-size: 0.75rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
          margin-bottom: 0.25rem;
        }

        .detail-value {
          display: block;
          font-size: 0.9rem;
          color: var(--text-primary);
          font-weight: 500;
          word-break: break-word;
        }

        .amount-value {
          color: var(--success-dark);
          font-weight: 700;
          font-size: 1rem;
        }

        .phone-link {
          color: var(--primary) !important;
          text-decoration: none;
          transition: color 0.2s ease;
        }

        .phone-link:hover {
          color: var(--primary-dark) !important;
          text-decoration: underline;
        }

        .recurrence-progress {
          font-size: 0.8rem;
          color: var(--text-secondary);
          margin-top: 0.25rem;
          font-weight: 400;
        }

        .arrangement-actions {
          display: flex;
          gap: 0.75rem;
          flex-wrap: wrap;
          align-items: center;
          margin-top: 1.5rem;
          padding-top: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .dark-mode .arrangement-actions {
          border-top-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .arrangement-card-header {
            flex-direction: column;
            align-items: stretch;
          }

          .arrangement-details-grid {
            grid-template-columns: 1fr;
          }

          .detail-notes {
            grid-column: 1;
          }
        }
      `})]})},uC=J.memo(cC);async function dC(e){const t=await e.text();return JSON.parse(t)}function fC({onAdd:e,inline:t}){const[r,n]=J.useState(!1),[a,s]=J.useState(""),[l,u]=J.useState(""),[m,p]=J.useState(""),[g,y]=J.useState(!1),_=J.useRef(!1),[T,S]=J.useState(null),w=()=>{s(""),u(""),p(""),S(null)},E=async I=>{if(I?.preventDefault(),_.current)return;S(null);const A=a.trim();if(!A)return S("Address is required.");let R=null,K=null;if(l.trim()){const W=Number(l);if(Number.isNaN(W))return S("Latitude must be a number.");R=W}if(m.trim()){const W=Number(m);if(Number.isNaN(W))return S("Longitude must be a number.");K=W}_.current=!0,y(!0);try{await e({address:A,lat:R,lng:K}),w(),n(!1)}catch(W){S(W?.message||String(W))}finally{_.current=!1,y(!1)}},P=t?d.jsx("button",{type:"button",className:"btn",onClick:()=>n(!0),children:"+ Add address"}):d.jsx("button",{type:"button",onClick:()=>n(!0),"aria-label":"Add address",style:hC,className:"fab-add-address",children:"+"});return d.jsxs(d.Fragment,{children:[P,r&&Zy.createPortal(d.jsx("div",{style:mC,role:"dialog","aria-modal":"true",children:d.jsxs("div",{style:pC,children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("h3",{style:{margin:0},children:"Add Address"}),d.jsx("button",{className:"btn btn-ghost",onClick:()=>{w(),n(!1)},disabled:g,"aria-label":"Close",children:"✕"})]}),d.jsxs("form",{onSubmit:E,style:{marginTop:"0.5rem"},children:[d.jsx("label",{className:"label",htmlFor:"manual-address",children:"Address *"}),d.jsx("textarea",{id:"manual-address",value:a,onChange:I=>s(I.target.value),className:"input",rows:3,placeholder:"e.g. 10 Example St, City, POSTCODE",required:!0}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("label",{className:"label",htmlFor:"manual-lat",children:"Lat (optional)"}),d.jsx("input",{id:"manual-lat",type:"text",inputMode:"decimal",value:l,onChange:I=>u(I.target.value),className:"input",placeholder:"51.5034"})]}),d.jsxs("div",{style:{flex:1},children:[d.jsx("label",{className:"label",htmlFor:"manual-lng",children:"Lng (optional)"}),d.jsx("input",{id:"manual-lng",type:"text",inputMode:"decimal",value:m,onChange:I=>p(I.target.value),className:"input",placeholder:"-0.1276"})]})]}),T&&d.jsx("div",{style:{color:"var(--danger)",fontSize:"0.875rem",marginTop:"0.5rem"},children:T}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem",justifyContent:"flex-end"},children:[d.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>{w(),n(!1)},disabled:g,children:"Cancel"}),d.jsx("button",{type:"submit",className:"btn",disabled:g,children:g?"Adding...":"Add"})]})]})]})}),document.body)]})}const hC={position:"fixed",right:16,bottom:"calc(16px + env(safe-area-inset-bottom, 0))",width:56,height:56,borderRadius:"50%",border:"none",background:"var(--primary)",color:"#fff",fontSize:28,lineHeight:"56px",textAlign:"center",boxShadow:"0 6px 18px rgba(0,0,0,0.18)",cursor:"pointer",zIndex:4e3},mC={position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:12,zIndex:4100},pC={width:"100%",maxWidth:520,background:"var(--surface)",borderRadius:14,padding:14,border:"1px solid var(--border-light)",boxShadow:"var(--shadow-lg)"},gC=[{id:"enforcement_pro",name:"Enforcement Pro",price:2500,currency:"GBP",features:["Route optimization for 30+ addresses","Commission tracking & reporting","Payment arrangements with SMS reminders","Daily/weekly earnings reports","Unlimited cloud sync & backup","Priority customer support"],trialDays:14}];function vC(e){const t=new Date(e),r=new Date,n=t.getTime()-r.getTime();return Math.ceil(n/(1e3*60*60*24))}function xC(e){if(!e)return!1;const t=new Date,r=new Date(e.currentPeriodEnd);return(e.status==="active"||e.status==="trial")&&r>t}function yC(e){return e?e.status==="trial":!1}function _C(e){if(!e)return!0;const t=new Date,r=new Date(e.currentPeriodEnd);return e.status==="expired"||e.status==="cancelled"||r<=t}function bp(e){const[t,r]=J.useState(null),[n]=J.useState(gC),[a,s]=J.useState(!0),[l,u]=J.useState(null),[m,p]=J.useState(!1),[g,y]=J.useState(!1),_=J.useCallback(()=>u(null),[]);J.useEffect(()=>{(async()=>{if(!e||!We){p(!1);return}try{const{data:ee}=await We.rpc("is_owner",{user_uuid:e.id});p(ee||!1)}catch{p(!1)}})()},[e]);const T=xC(t),S=yC(t),w=_C(t),E=t?vC(t.currentPeriodEnd):0,P=m||T&&!w||g,I=J.useCallback(async()=>{if(!e||!We){r(null),s(!1);return}try{s(!0),_();const{data:D,error:ee}=await We.from("user_subscriptions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).maybeSingle();if(ee)throw ee;const re=D?{id:D.id,userId:D.user_id,planId:D.plan_id,status:D.status,currentPeriodStart:D.current_period_start,currentPeriodEnd:D.current_period_end,trialStart:D.trial_start||void 0,trialEnd:D.trial_end||void 0,cancelledAt:D.cancelled_at||void 0,createdAt:D.created_at,updatedAt:D.updated_at,lastPaymentAt:D.last_payment_at||void 0,nextPaymentDue:D.next_payment_due||void 0}:null;r(re)}catch(D){ve.error("Failed to load subscription:",D),u(D?.message||"Failed to load subscription"),r(null)}finally{s(!1)}},[e,_]),A=J.useCallback(async()=>{if(!We){y(!1);return}try{const D=localStorage.getItem("navigator_trial_created"),ee=localStorage.getItem("navigator_trial_user_id");if(!D||!ee){y(!1);return}const re=parseInt(D);if((Date.now()-re)/(1e3*60*60)>25){console.log("Trial too old, clearing localStorage"),localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"),y(!1);return}const{data:ue,error:ce}=await We.rpc("check_trial_access",{target_user_id:ee});if(ce){console.warn("Server trial access check failed:",ce),y(!1);return}console.log("Server trial access result:",ue),y(ue?.hasAccess||!1),ue?.hasAccess||(localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"))}catch(D){console.warn("Server trial access check error:",D),y(!1)}},[]);J.useEffect(()=>{e?I():(r(null),s(!1)),A()},[e,I,A]);const R=J.useCallback(async()=>{if(!e||!We)throw new Error("User not authenticated");if(t)throw new Error("User already has a subscription");try{_(),s(!0);const D=n[0],ee=new Date,re=new Date(ee);re.setDate(re.getDate()+D.trialDays);const pe={user_id:e.id,plan_id:D.id,status:"trial",current_period_start:ee.toISOString(),current_period_end:re.toISOString(),trial_start:ee.toISOString(),trial_end:re.toISOString(),created_at:ee.toISOString(),updated_at:ee.toISOString()},{error:ue}=await We.from("user_subscriptions").insert(pe);if(ue)throw ue;await I(),ve.info("Trial started successfully")}catch(D){throw ve.error("Failed to start trial:",D),u(D?.message||"Failed to start trial"),D}finally{s(!1)}},[e,t,n,_,I]),K=J.useCallback(async D=>{if(!e||!We)throw new Error("User not authenticated");if(!n.find(re=>re.id===D))throw new Error("Invalid plan selected");try{_(),s(!0);const re=new Date,pe=new Date(re);pe.setMonth(pe.getMonth()+1);const ue=t?{status:"active",plan_id:D,current_period_start:re.toISOString(),current_period_end:pe.toISOString(),last_payment_at:re.toISOString(),next_payment_due:pe.toISOString(),updated_at:re.toISOString()}:{user_id:e.id,plan_id:D,status:"active",current_period_start:re.toISOString(),current_period_end:pe.toISOString(),last_payment_at:re.toISOString(),next_payment_due:pe.toISOString(),created_at:re.toISOString(),updated_at:re.toISOString()};if(t){const{error:ce}=await We.from("user_subscriptions").update(ue).eq("id",t.id);if(ce)throw ce}else{const{error:ce}=await We.from("user_subscriptions").insert(ue);if(ce)throw ce}await I(),ve.info("Subscription activated successfully")}catch(re){throw ve.error("Failed to subscribe:",re),u(re?.message||"Failed to subscribe"),re}finally{s(!1)}},[e,t,n,_,I]),W=J.useCallback(async()=>{if(!e||!We||!t)throw new Error("No active subscription to cancel");try{_(),s(!0);const D=new Date,ee={status:"cancelled",cancelled_at:D.toISOString(),updated_at:D.toISOString()},{error:re}=await We.from("user_subscriptions").update(ee).eq("id",t.id);if(re)throw re;await I(),ve.info("Subscription cancelled successfully")}catch(D){throw ve.error("Failed to cancel subscription:",D),u(D?.message||"Failed to cancel subscription"),D}finally{s(!1)}},[e,t,_,I]);return{subscription:t,availablePlans:n,isLoading:a,error:l,isActive:T,isTrial:S,isExpired:w,daysRemaining:E,hasAccess:P,startTrial:R,subscribe:K,cancelSubscription:W,refreshSubscription:I,clearError:_}}function i_(e){const[t,r]=J.useState(!1),[n,a]=J.useState(!1),[s,l]=J.useState(null),[u,m]=J.useState(!0),[p,g]=J.useState(null),y=J.useCallback(()=>g(null),[]),_=J.useCallback(async()=>{if(!e||!We){r(!1),a(!1),l(null),m(!1);return}try{m(!0),y();const{data:T,error:S}=await We.rpc("is_admin",{user_uuid:e.id});if(S){r(!1),a(!1),l(null),m(!1);return}if(r(T||!1),T){const{data:w,error:E}=await We.rpc("is_owner",{user_uuid:e.id});E?console.warn("Failed to check owner status:",E):a(w||!1);const{data:P,error:I}=await We.from("admin_users").select("*").eq("user_id",e.id).single();I?console.warn("Failed to fetch admin user details:",I):l(P)}else a(!1),l(null)}catch(T){console.log("Admin check failed:",T.message),r(!1),a(!1),l(null)}finally{m(!1)}},[e,y]);return J.useEffect(()=>{_()},[_]),{isAdmin:t,isOwner:n,adminUser:s,isLoading:u,error:p,refreshAdmin:_,clearError:y}}function wC(e,t){const r=e/100;return new Intl.NumberFormat("en-GB",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(r)}function Ff(e){return new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})}function bC({user:e,onClose:t}){const{subscription:r,availablePlans:n,isLoading:a,error:s,isActive:l,isTrial:u,isExpired:m,daysRemaining:p,hasAccess:g,startTrial:y,subscribe:_,cancelSubscription:T,clearError:S}=bp(e),{isOwner:w}=i_(e),[E,P]=J.useState(null),I=async()=>{try{P("trial"),await y()}catch{}finally{P(null)}},A=async K=>{try{P(`subscribe-${K}`),await _(K)}catch{}finally{P(null)}},R=async()=>{if(confirm("Are you sure you want to cancel your subscription? You will lose access at the end of your current billing period."))try{P("cancel"),await T()}catch{}finally{P(null)}};return a?d.jsx("div",{className:"subscription-manager",children:d.jsxs("div",{className:"subscription-loading",children:[d.jsx("div",{className:"spinner"}),d.jsx("p",{children:"Loading subscription..."})]})}):w?d.jsxs("div",{className:"subscription-manager",children:[d.jsxs("div",{className:"subscription-header",children:[d.jsx("h2",{children:"Owner Access"}),t&&d.jsx("button",{className:"close-button",onClick:t,"aria-label":"Close",children:"✕"})]}),d.jsx("div",{className:"owner-status",children:d.jsxs("div",{className:"owner-card",children:[d.jsx("div",{className:"owner-badge",children:"🔑 OWNER"}),d.jsx("h3",{children:"Unlimited Access"}),d.jsx("p",{children:"As the owner, you have unrestricted access to all premium features:"}),d.jsx("div",{className:"owner-features",children:d.jsxs("ul",{children:[d.jsx("li",{children:"✓ Route optimization for unlimited addresses"}),d.jsx("li",{children:"✓ Commission tracking & reporting"}),d.jsx("li",{children:"✓ Payment arrangements with SMS reminders"}),d.jsx("li",{children:"✓ Daily/weekly earnings reports"}),d.jsx("li",{children:"✓ Unlimited cloud sync & backup"}),d.jsx("li",{children:"✓ Admin dashboard and user management"}),d.jsx("li",{children:"✓ Priority customer support tools"})]})}),d.jsxs("div",{className:"owner-info",children:[d.jsx("h4",{children:"Business Status"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Plan:"})," Owner Access (No subscription required)"]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Status:"})," ",d.jsx("span",{className:"status-active",children:"Active"})]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Billing:"})," N/A - Owner account"]})]}),d.jsxs("div",{className:"owner-actions",children:[d.jsx("p",{children:d.jsx("strong",{children:"Need to manage customer subscriptions?"})}),d.jsx("button",{className:"btn-secondary",onClick:t,style:{marginRight:"8px"},children:"Close"}),d.jsx("button",{className:"btn-primary",onClick:()=>{console.log("Redirect to admin dashboard"),t&&t()},children:"Go to Admin Dashboard"})]})]})})]}):d.jsxs("div",{className:"subscription-manager",children:[d.jsxs("div",{className:"subscription-header",children:[d.jsx("h2",{children:"Subscription Management"}),t&&d.jsx("button",{className:"close-button",onClick:t,"aria-label":"Close",children:"✕"})]}),s&&d.jsxs("div",{className:"error-banner",children:[d.jsx("p",{children:s}),d.jsx("button",{onClick:S,children:"Dismiss"})]}),r?d.jsxs("div",{className:"current-subscription",children:[d.jsx("h3",{children:"Current Subscription"}),d.jsxs("div",{className:"subscription-card",children:[d.jsxs("div",{className:"subscription-info",children:[d.jsx("div",{className:"plan-name",children:n.find(K=>K.id===r.planId)?.name||"Unknown Plan"}),d.jsxs("div",{className:"subscription-status",children:[d.jsx("span",{className:`status-badge ${r.status}`,children:r.status.charAt(0).toUpperCase()+r.status.slice(1)}),u&&d.jsx("span",{className:"trial-badge",children:p>0?`${p} days remaining`:"Trial expired"})]})]}),d.jsxs("div",{className:"subscription-details",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Current Period:"})," ",Ff(r.currentPeriodStart)," - ",Ff(r.currentPeriodEnd)]}),r.nextPaymentDue&&l&&!u&&d.jsxs("p",{children:[d.jsx("strong",{children:"Next Payment:"})," ",Ff(r.nextPaymentDue)]}),r.cancelledAt&&d.jsxs("p",{children:[d.jsx("strong",{children:"Cancelled:"})," ",Ff(r.cancelledAt)]})]}),g&&d.jsxs("div",{className:"subscription-features",children:[d.jsx("h4",{children:"Your Features:"}),d.jsx("ul",{children:n.find(K=>K.id===r.planId)?.features.map((K,W)=>d.jsxs("li",{children:["✓ ",K]},W))})]}),d.jsxs("div",{className:"subscription-actions",children:[u&&p>0&&d.jsx("button",{className:"btn-primary",onClick:()=>A(r.planId),disabled:E!==null,children:E===`subscribe-${r.planId}`?"Processing...":"Upgrade to Paid"}),l&&!u&&d.jsx("button",{className:"btn-secondary",onClick:R,disabled:E!==null,children:E==="cancel"?"Processing...":"Cancel Subscription"})]})]})]}):d.jsxs("div",{className:"available-plans",children:[d.jsx("h3",{children:"Choose Your Plan"}),d.jsx("p",{className:"plans-intro",children:"Transform your enforcement work with our unified platform. Replace multiple expensive apps with one powerful solution."}),n.map(K=>d.jsxs("div",{className:"plan-card featured",children:[d.jsxs("div",{className:"plan-header",children:[d.jsx("h4",{children:K.name}),d.jsxs("div",{className:"plan-price",children:[d.jsx("span",{className:"price",children:wC(K.price,K.currency)}),d.jsx("span",{className:"period",children:"/month"})]})]}),d.jsx("div",{className:"plan-features",children:d.jsx("ul",{children:K.features.map((W,D)=>d.jsxs("li",{children:["✓ ",W]},D))})}),d.jsxs("div",{className:"plan-actions",children:[d.jsx("button",{className:"btn-primary full-width",onClick:I,disabled:E!==null,children:E==="trial"?"Starting Trial...":`Start ${K.trialDays}-Day Free Trial`}),d.jsx("p",{className:"trial-note",children:"No payment required • Cancel anytime • Full access during trial"})]})]},K.id)),d.jsxs("div",{className:"value-proposition",children:[d.jsx("h4",{children:"Why Enforcement Pro?"}),d.jsxs("div",{className:"comparison",children:[d.jsxs("div",{className:"comparison-item",children:[d.jsx("span",{className:"old-cost",children:"Route Planning App: £20-30/month"}),d.jsx("span",{className:"new-cost",children:"✓ Included"})]}),d.jsxs("div",{className:"comparison-item",children:[d.jsx("span",{className:"old-cost",children:"SMS Service: £10-15/month"}),d.jsx("span",{className:"new-cost",children:"✓ Included"})]}),d.jsxs("div",{className:"comparison-item",children:[d.jsx("span",{className:"old-cost",children:"Basic Tracking: £10-20/month"}),d.jsx("span",{className:"new-cost",children:"✓ Included"})]}),d.jsx("div",{className:"total-savings",children:d.jsx("strong",{children:"Total Monthly Savings: £15-40"})})]})]})]}),m&&d.jsxs("div",{className:"access-warning",children:[d.jsx("h4",{children:"⚠️ Subscription Expired"}),d.jsx("p",{children:"Your subscription has expired. Please renew to continue using premium features."}),d.jsx("button",{className:"btn-primary",onClick:()=>n[0]&&A(n[0].id),disabled:E!==null,children:"Renew Subscription"})]})]})}const kC=`
.subscription-manager {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  color: var(--text-color, #000);
}

.subscription-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  border-bottom: 1px solid var(--border-color, #e1e5e9);
  padding-bottom: 16px;
}

.subscription-header h2 {
  color: var(--text-color, #000);
  margin: 0;
}

.close-button {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  color: var(--text-color, #000);
}

.close-button:hover {
  background-color: var(--hover-bg, #f5f5f5);
}

.dark-mode .close-button:hover {
  background-color: var(--dark-hover-bg, #333);
}

.subscription-loading {
  text-align: center;
  padding: 40px;
  color: var(--text-color, #000);
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid var(--border-color, #f3f3f3);
  border-top: 4px solid #007bff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.error-banner {
  background-color: var(--error-bg, #fee);
  border: 1px solid var(--error-border, #fcc);
  border-radius: 4px;
  padding: 12px;
  margin-bottom: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: var(--error-text, #721c24);
}

.dark-mode .error-banner {
  background-color: var(--dark-error-bg, #4a1a1a);
  border-color: var(--dark-error-border, #8b2635);
  color: var(--dark-error-text, #ff6b6b);
}

.current-subscription, .available-plans {
  margin-bottom: 24px;
}

.current-subscription h3, .available-plans h3 {
  color: var(--text-color, #000);
  margin-bottom: 16px;
}

.subscription-card, .plan-card {
  border: 1px solid var(--border-color, #e1e5e9);
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 16px;
  background-color: var(--card-bg, #fff);
  color: var(--text-color, #000);
}

.dark-mode .subscription-card,
.dark-mode .plan-card {
  background-color: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.plan-card.featured {
  border-color: #007bff;
  position: relative;
  margin-top: 16px;
}

.plan-card.featured::before {
  content: 'Most Popular';
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  background: #007bff;
  color: white;
  padding: 6px 16px;
  font-size: 12px;
  font-weight: 600;
  border-radius: 16px;
  white-space: nowrap;
}

.status-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  text-transform: uppercase;
}

.status-badge.active { background: #d4edda; color: #155724; }
.status-badge.trial { background: #fff3cd; color: #856404; }
.status-badge.expired { background: #f8d7da; color: #721c24; }
.status-badge.cancelled { background: #e2e3e5; color: #6c757d; }

.trial-badge {
  margin-left: 8px;
  padding: 4px 8px;
  background: #e3f2fd;
  color: #1976d2;
  border-radius: 4px;
  font-size: 12px;
}

.dark-mode .trial-badge {
  background: var(--dark-secondary-bg, #2a4a5c);
  color: var(--dark-secondary-text, #87ceeb);
  border: 1px solid var(--dark-border-color, #444);
}

.plan-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 16px;
}

.plan-header h4 {
  color: var(--text-color, #000);
  margin: 0;
}

.plan-price .price {
  font-size: 24px;
  font-weight: bold;
  color: #007bff;
}

.plan-price .period {
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
}

.dark-mode .plan-price .period {
  color: var(--dark-secondary-text, #aaa);
}

.plan-features ul {
  list-style: none;
  padding: 0;
  margin: 16px 0;
}

.plan-features li {
  padding: 4px 0;
  color: #28a745;
}

.subscription-info .plan-name {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-color, #000);
  margin-bottom: 8px;
}

.subscription-details {
  margin: 16px 0;
  color: var(--text-color, #000);
}

.subscription-details p {
  margin: 8px 0;
  color: var(--text-color, #000);
}

.subscription-details strong {
  color: var(--text-color, #000);
}

.subscription-features h4 {
  color: var(--text-color, #000);
  margin: 16px 0 8px 0;
}

.subscription-actions, .plan-actions {
  margin-top: 20px;
}

.btn-primary, .btn-secondary {
  padding: 10px 20px;
  border-radius: 6px;
  border: none;
  font-weight: 500;
  cursor: pointer;
  margin-right: 8px;
  transition: background-color 0.2s;
}

.btn-primary {
  background: #007bff;
  color: white;
}

.btn-primary:hover:not(:disabled) {
  background: #0056b3;
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover:not(:disabled) {
  background: #545b62;
}

.btn-primary:disabled, .btn-secondary:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.full-width {
  width: 100%;
  margin-right: 0;
}

.trial-note {
  text-align: center;
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
  margin-top: 8px;
}

.dark-mode .trial-note {
  color: var(--dark-secondary-text, #aaa);
}

.comparison {
  background: var(--secondary-bg, #f8f9fa);
  padding: 16px;
  border-radius: 6px;
  margin-top: 12px;
  color: var(--text-color, #000);
}

.dark-mode .comparison {
  background: var(--dark-secondary-bg, #333);
}

.comparison-item {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
}

.old-cost {
  color: var(--secondary-text, #6c757d);
  text-decoration: line-through;
}

.dark-mode .old-cost {
  color: var(--dark-secondary-text, #aaa);
}

.new-cost {
  color: #28a745;
  font-weight: 500;
}

.total-savings {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--border-color, #dee2e6);
  text-align: center;
  color: #007bff;
}

.dark-mode .total-savings {
  border-top-color: var(--dark-border-color, #555);
}

.access-warning {
  background: var(--warning-bg, #fff3cd);
  border: 1px solid var(--warning-border, #ffeaa7);
  border-radius: 6px;
  padding: 16px;
  text-align: center;
  color: var(--warning-text, #856404);
}

.dark-mode .access-warning {
  background: var(--dark-warning-bg, #4a3c1a);
  border-color: var(--dark-warning-border, #8b7355);
  color: var(--dark-warning-text, #ffc107);
}

.access-warning h4 {
  color: var(--warning-text, #856404);
  margin: 0 0 8px 0;
}

.dark-mode .access-warning h4 {
  color: var(--dark-warning-text, #ffc107);
}

.value-proposition h4 {
  color: var(--text-color, #000);
  margin: 16px 0 12px 0;
}

.plans-intro {
  color: var(--text-color, #000);
  margin-bottom: 20px;
}

.owner-status {
  margin-bottom: 24px;
}

.owner-card {
  border: 2px solid #28a745;
  border-radius: 12px;
  padding: 24px;
  background: linear-gradient(135deg, #f8fff9 0%, #e8f5e8 100%);
  text-align: center;
}

.owner-badge {
  display: inline-block;
  background: #28a745;
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 16px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.owner-features {
  margin: 20px 0;
  text-align: left;
}

.owner-features ul {
  list-style: none;
  padding: 0;
  max-width: 400px;
  margin: 0 auto;
}

.owner-features li {
  padding: 6px 0;
  color: #28a745;
  font-weight: 500;
}

.owner-info {
  background: var(--card-bg, white);
  border-radius: 8px;
  padding: 16px;
  margin: 20px 0;
  border: 1px solid #d4edda;
  color: var(--text-color, #000);
}

.dark-mode .owner-info {
  background: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.owner-info h4 {
  margin: 0 0 12px 0;
  color: #28a745;
}

.owner-info p {
  margin: 8px 0;
  text-align: left;
  color: var(--text-color, #000);
}

.status-active {
  color: #28a745;
  font-weight: 600;
}

.owner-actions {
  margin-top: 24px;
}

.owner-actions p {
  margin-bottom: 16px;
  font-weight: 500;
  color: var(--text-color, #000);
}

.owner-card h3 {
  color: var(--text-color, #000);
  margin: 0 0 16px 0;
}

.owner-card p {
  color: var(--text-color, #000);
}

.dark-mode .owner-card {
  background: linear-gradient(135deg, #2a4a2a 0%, #1a3a1a 100%);
}
`;if(typeof document<"u"){const e=document.createElement("style");e.textContent=kC,document.head.appendChild(e)}const SC=function({user:t,onClose:r}){const[n,a]=J.useState(null),[s,l]=J.useState([]),[u,m]=J.useState([]),[p,g]=J.useState([]),[y,_]=J.useState(!0),[T,S]=J.useState(null),[w,E]=J.useState("subscriptions"),[P,I]=J.useState(""),[A,R]=J.useState(1),[K,W]=J.useState(7),[D,ee]=J.useState(""),[re,pe]=J.useState(null);J.useEffect(()=>{ue()},[t]);const ue=async()=>{if(!(!t||!We))try{_(!0),S(null);const{data:j,error:H}=await We.rpc("is_admin",{user_uuid:t.id});if(H)throw console.error("Admin check error:",H),H;if(!j)throw new Error("Access denied: Admin privileges required");const{data:O,error:ne}=await We.from("admin_users").select("*").eq("user_id",t.id).single();if(ne)throw ne;a(O);const{data:Y,error:F}=await We.rpc("get_admin_subscription_overview");if(F)throw console.error("Subscription overview error:",F),F;l(Y||[]);let U=[];try{const{data:oe,error:se}=await We.from("admin_actions").select(`
            id,
            action_type,
            target_user_id,
            performed_at,
            details,
            admin_users!inner(email)
          `).order("performed_at",{ascending:!1}).limit(20);se?(console.warn("Admin actions table not found or error:",se),U=[]):U=oe||[]}catch(oe){console.warn("Failed to load admin actions:",oe),U=[]}const z=(U||[]).map(oe=>({...oe,admin_email:oe.admin_users?.email||(Array.isArray(oe.admin_users)?oe.admin_users[0]?.email:null)}));m(z);const{data:q,error:M}=await We.from("admin_upcoming_deletions").select("*").order("deletion_scheduled_for",{ascending:!0});M?console.warn("Failed to load upcoming deletions:",M):g(q||[])}catch(j){S(j.message||"Failed to load admin data")}finally{_(!1)}},ce=async()=>{if(!(!P||!We))try{pe("grant");const{error:j}=await We.rpc("admin_grant_subscription",{target_user_id:P,plan_id:"enforcement_pro",duration_months:A,admin_notes:D||`Granted ${A} month(s) by admin`});if(j)throw j;await ue(),I(""),R(1),ee(""),alert("Subscription granted successfully!")}catch(j){alert("Failed to grant subscription: "+j.message)}finally{pe(null)}},Ce=async()=>{if(!(!P||!We))try{pe("extend");const{error:j}=await We.rpc("admin_extend_trial",{target_user_id:P,additional_days:K,admin_notes:D||`Extended trial by ${K} days`});if(j)throw j;await ue(),I(""),W(7),ee(""),alert("Trial extended successfully!")}catch(j){alert("Failed to extend trial: "+j.message)}finally{pe(null)}},ye=async(j,H)=>{if(!(!We||!confirm(`Cancel scheduled deletion for ${H}?`)))try{pe("cancel-deletion");const{error:ne}=await We.from("inactive_account_warnings").update({cancelled:!0,warning_acknowledged:!0}).eq("user_id",j).eq("cancelled",!1);if(ne)throw ne;await ue(),alert(`Scheduled deletion cancelled for ${H}`)}catch(ne){alert("Failed to cancel deletion: "+ne.message)}finally{pe(null)}},he=j=>j?new Date(j).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",le=j=>{const O={active_trial:{color:"#fff3cd",label:"Active Trial"},active_paid:{color:"#d4edda",label:"Active Paid"},expired:{color:"#f8d7da",label:"Expired"},cancelled:{color:"#e2e3e5",label:"Cancelled"}}[j]||{color:"#f8f9fa",label:j};return d.jsx("span",{style:{backgroundColor:O.color,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500"},children:O.label})};return y?d.jsx("div",{className:"admin-dashboard",children:d.jsx("div",{className:"loading",children:"Loading admin dashboard..."})}):T?d.jsx("div",{className:"admin-dashboard",children:d.jsxs("div",{className:"error",children:[d.jsx("h3",{children:"Access Denied"}),d.jsx("p",{children:T}),r&&d.jsx("button",{onClick:r,children:"Close"})]})}):d.jsxs("div",{className:"admin-dashboard",children:[d.jsxs("div",{className:"admin-header-fixed",children:[d.jsxs("div",{className:"admin-header",children:[d.jsx("h2",{children:"Admin Dashboard"}),d.jsxs("div",{className:"admin-info",children:[d.jsxs("span",{children:["Role: ",d.jsx("strong",{children:n?.role})]}),r&&d.jsx("button",{className:"close-button",onClick:r,children:"✕"})]})]}),d.jsxs("div",{className:"admin-tabs",children:[d.jsxs("button",{className:w==="subscriptions"?"active":"",onClick:()=>E("subscriptions"),children:["Subscriptions (",s.length,")"]}),d.jsxs("button",{className:w==="actions"?"active":"",onClick:()=>E("actions"),children:["Actions (",u.length,")"]}),d.jsxs("button",{className:w==="inactive"?"active":"",onClick:()=>E("inactive"),children:["Inactive (",p.length,")"]}),d.jsx("button",{className:w==="settings"?"active":"",onClick:()=>E("settings"),children:"Settings"})]})]}),d.jsxs("div",{className:"admin-content-scrollable",children:[w==="subscriptions"&&d.jsxs("div",{className:"subscriptions-tab",children:[d.jsxs("div",{className:"stats-bar",children:[d.jsxs("div",{className:"stat",children:[d.jsx("strong",{children:s.filter(j=>j.subscription_status==="trial").length}),d.jsx("span",{children:"Active Trials"})]}),d.jsxs("div",{className:"stat",children:[d.jsx("strong",{children:s.filter(j=>j.subscription_status==="active").length}),d.jsx("span",{children:"Paid Subscriptions"})]}),d.jsxs("div",{className:"stat",children:[d.jsx("strong",{children:s.filter(j=>j.subscription_status==="expired").length}),d.jsx("span",{children:"Expired"})]}),d.jsxs("div",{className:"stat",children:[d.jsxs("strong",{children:["£",s.filter(j=>j.subscription_status==="active").length*25]}),d.jsx("span",{children:"Monthly Revenue"})]})]}),d.jsxs("div",{className:"admin-actions-panel",children:[d.jsx("h3",{children:"Admin Actions"}),d.jsxs("div",{className:"admin-form",children:[d.jsxs("div",{className:"form-row",children:[d.jsx("label",{htmlFor:"selected-user-id",children:"Select User"}),d.jsxs("select",{id:"selected-user-id",name:"selectedUserId",value:P,onChange:j=>I(j.target.value),children:[d.jsx("option",{value:"",children:"Select User..."}),s.map(j=>d.jsxs("option",{value:j.user_id,children:[j.user_email," - ",le(j.subscription_status).props.children]},j.user_id))]})]}),d.jsxs("div",{className:"form-row",children:[d.jsx("div",{className:"action-group",children:d.jsxs("div",{className:"input-group",children:[d.jsx("label",{htmlFor:"grant-months",children:"Grant Subscription (months):"}),d.jsx("input",{id:"grant-months",name:"grantMonths",type:"number",min:"1",max:"12",value:A,onChange:j=>R(parseInt(j.target.value)||1)}),d.jsx("button",{onClick:ce,disabled:!P||re!==null,children:re==="grant"?"Granting...":"Grant"})]})}),d.jsx("div",{className:"action-group",children:d.jsxs("div",{className:"input-group",children:[d.jsx("label",{htmlFor:"extend-days",children:"Extend Trial (days):"}),d.jsx("input",{id:"extend-days",name:"extendDays",type:"number",min:"1",max:"90",value:K,onChange:j=>W(parseInt(j.target.value)||7)}),d.jsx("button",{onClick:Ce,disabled:!P||re!==null,children:re==="extend"?"Extending...":"Extend"})]})})]}),d.jsxs("div",{className:"form-row",children:[d.jsx("label",{htmlFor:"admin-notes",children:"Admin notes (optional)"}),d.jsx("textarea",{id:"admin-notes",name:"adminNotes",placeholder:"Admin notes (optional)",value:D,onChange:j=>ee(j.target.value),rows:2})]})]})]}),d.jsxs("div",{className:"subscriptions-table",children:[d.jsx("h3",{children:"All Subscriptions"}),d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"User Email"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Plan"}),d.jsx("th",{children:"API Requests"}),d.jsx("th",{children:"Created"}),d.jsx("th",{children:"Period End"})]})}),d.jsx("tbody",{children:s.map(j=>d.jsxs("tr",{children:[d.jsx("td",{children:j.user_email}),d.jsx("td",{children:le(j.subscription_status)}),d.jsx("td",{children:j.subscription_plan||"No Plan"}),d.jsx("td",{children:j.total_api_requests||0}),d.jsx("td",{children:he(j.subscription_created_at)}),d.jsx("td",{children:he(j.current_period_end)})]},j.user_email))})]})]})]}),w==="actions"&&d.jsxs("div",{className:"actions-tab",children:[d.jsx("h3",{children:"Recent Admin Actions"}),d.jsx("div",{className:"actions-list",children:u.map(j=>d.jsxs("div",{className:"action-item",children:[d.jsxs("div",{className:"action-header",children:[d.jsx("strong",{children:j.action_type.replace("_"," ").toUpperCase()}),d.jsx("span",{className:"action-date",children:he(j.performed_at)})]}),d.jsxs("div",{className:"action-details",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Admin:"})," ",j.admin_email]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Target User:"})," ",j.target_user_id]}),j.details&&d.jsxs("div",{className:"action-notes",children:[d.jsx("strong",{children:"Details:"}),d.jsx("pre",{children:JSON.stringify(j.details,null,2)})]})]})]},j.id))})]}),w==="inactive"&&d.jsxs("div",{className:"inactive-tab",children:[d.jsx("h3",{children:"Upcoming Account Deletions (GDPR Compliance)"}),p.length===0?d.jsx("div",{className:"no-deletions",children:d.jsx("p",{children:"No accounts scheduled for deletion. All users are active! 🎉"})}):d.jsxs("div",{className:"deletions-table",children:[d.jsxs("table",{children:[d.jsx("thead",{children:d.jsxs("tr",{children:[d.jsx("th",{children:"User Email"}),d.jsx("th",{children:"Last Activity"}),d.jsx("th",{children:"Warning Sent"}),d.jsx("th",{children:"Deletion Date"}),d.jsx("th",{children:"Days Until"}),d.jsx("th",{children:"Status"}),d.jsx("th",{children:"Actions"})]})}),d.jsx("tbody",{children:p.map(j=>d.jsxs("tr",{children:[d.jsx("td",{children:j.user_email}),d.jsx("td",{children:he(j.last_activity_at)}),d.jsx("td",{children:he(j.warning_sent_at)}),d.jsx("td",{children:he(j.deletion_scheduled_for)}),d.jsx("td",{children:d.jsxs("span",{style:{color:j.days_until_deletion<=7?"var(--danger)":"var(--text)",fontWeight:j.days_until_deletion<=7?"700":"400"},children:[j.days_until_deletion," days"]})}),d.jsx("td",{children:j.warning_acknowledged?d.jsx("span",{style:{color:"var(--primary)"},children:"Acknowledged"}):d.jsx("span",{style:{color:"var(--text-muted)"},children:"Pending"})}),d.jsx("td",{children:d.jsx("button",{className:"cancel-btn",onClick:()=>ye(j.user_id,j.user_email),disabled:re!==null,style:{background:"var(--danger)",color:"white",border:"none",padding:"0.375rem 0.75rem",borderRadius:"var(--radius)",cursor:"pointer",fontSize:"0.625rem",fontWeight:"600",whiteSpace:"nowrap"},children:"Cancel Deletion"})})]},j.user_id))})]}),d.jsxs("div",{className:"deletion-info",style:{marginTop:"1rem",padding:"1rem",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",fontSize:"0.75rem",color:"var(--text-muted)"},children:[d.jsx("p",{children:d.jsx("strong",{children:"How it works:"})}),d.jsxs("ul",{style:{marginLeft:"1.5rem",marginTop:"0.5rem"},children:[d.jsx("li",{children:"Accounts inactive for 5 months receive a warning email"}),d.jsx("li",{children:"After 6 months of inactivity, account is automatically deleted"}),d.jsx("li",{children:"Users can prevent deletion by simply logging in or creating data"}),d.jsx("li",{children:"Active subscriptions are never deleted automatically"}),d.jsx("li",{children:"Admins can cancel scheduled deletions manually using the button above"})]})]})]})]}),w==="settings"&&d.jsxs("div",{className:"settings-tab",children:[d.jsx("h3",{children:"Admin Settings"}),d.jsxs("div",{className:"settings-info",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Your Role:"})," ",n?.role]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Permissions:"})," ",n?.permissions.join(", ")]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Account Created:"})," ",he(n?.created_at||"")]})]}),d.jsxs("div",{className:"quick-stats",children:[d.jsx("h4",{children:"Quick Stats"}),d.jsxs("ul",{children:[d.jsxs("li",{children:["Total Users: ",s.length]}),d.jsxs("li",{children:["Active Trials: ",s.filter(j=>j.subscription_status==="trial").length]}),d.jsxs("li",{children:["Paid Customers: ",s.filter(j=>j.subscription_status==="active").length]}),d.jsxs("li",{children:["Monthly Revenue: £",s.filter(j=>j.subscription_status==="active").length*25]}),d.jsxs("li",{children:["Total Actions Performed: ",u.length]})]})]})]})]})]})},TC=J.memo(SC),EC=`
/* ==== Admin Dashboard Modern Professional Styles ==== */
.admin-dashboard {
  display: flex;
  flex-direction: column;
  height: 100vh;
  background: var(--background);
  overflow: hidden;
  position: relative;
}

.admin-header-fixed {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--background);
  border-bottom: 2px solid var(--border-light);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.admin-content-scrollable {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 1.5rem;
  max-width: 1400px;
  margin: 0 auto;
  width: 100%;
  box-sizing: border-box;
}

.admin-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: var(--surface);
}

.admin-header h2 {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text);
  margin: 0;
  letter-spacing: -0.02em;
}

.admin-info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--text-muted);
  font-size: 0.75rem;
}

.close-button {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-muted);
}

.close-button:hover {
  background: var(--background);
  color: var(--text);
}

.admin-tabs {
  display: flex;
  gap: 0;
  background: var(--background);
  padding: 0 1.5rem;
  border-bottom: 1px solid var(--border-light);
}

.admin-tabs button {
  padding: 0.875rem 1.5rem;
  border: none;
  background: transparent;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  font-weight: 600;
  color: var(--text-muted);
  transition: all 0.2s ease;
  font-size: 0.875rem;
  white-space: nowrap;
}

.admin-tabs button:hover {
  color: var(--text);
  background: var(--surface);
}

.admin-tabs button.active {
  color: var(--primary);
  border-bottom-color: var(--primary);
  background: transparent;
}

.stats-bar {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.stat {
  background: linear-gradient(135deg, var(--surface) 0%, var(--background) 100%);
  padding: 1.25rem;
  border-radius: 12px;
  border: 1px solid var(--border-light);
  text-align: center;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.stat:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  border-color: var(--primary);
}

.stat strong {
  display: block;
  font-size: 2rem;
  font-weight: 800;
  color: var(--primary);
  margin-bottom: 0.5rem;
  line-height: 1;
}

.stat span {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  line-height: 1.4;
}

.admin-actions-panel {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.admin-actions-panel h3 {
  margin: 0 0 1.25rem 0;
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--text);
  border-bottom: 2px solid var(--border-light);
  padding-bottom: 0.75rem;
}

.admin-form .form-row {
  margin-bottom: 1.25rem;
}

.admin-form .form-row:last-child {
  margin-bottom: 0;
}

.admin-form label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: var(--text);
  font-size: 0.875rem;
}

.admin-form select,
.admin-form input,
.admin-form textarea {
  width: 100%;
  padding: 0.75rem;
  border: 2px solid var(--border-light);
  border-radius: 8px;
  font-size: 0.875rem;
  transition: all 0.2s ease;
  background: var(--background);
  color: var(--text);
  box-sizing: border-box;
  font-family: inherit;
}

.admin-form select:focus,
.admin-form input:focus,
.admin-form textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(var(--primary-rgb, 74, 144, 226), 0.1);
}

.form-row .action-group {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  align-items: start;
}

.input-group {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  background: var(--background);
  padding: 1rem;
  border-radius: 8px;
  border: 1px solid var(--border-light);
}

.input-group label {
  margin: 0;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  min-width: fit-content;
}

.input-group input {
  width: 80px;
  min-width: 60px;
  padding: 0.5rem;
  text-align: center;
  font-weight: 600;
}

.input-group button {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0.625rem 1.5rem;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 700;
  transition: all 0.2s ease;
  font-size: 0.875rem;
  white-space: nowrap;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.input-group button:hover {
  background: var(--primary-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.input-group button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.subscriptions-table {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.subscriptions-table h3 {
  margin: 0;
  padding: 1rem 1.5rem;
  background: var(--background);
  border-bottom: 2px solid var(--border-light);
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--text);
}

.subscriptions-table table {
  width: 100%;
  border-collapse: collapse;
  display: block;
  max-height: 500px;
  overflow-y: auto;
}

.subscriptions-table thead {
  display: table;
  width: 100%;
  table-layout: fixed;
  position: sticky;
  top: 0;
  z-index: 10;
}

.subscriptions-table tbody {
  display: table;
  width: 100%;
  table-layout: fixed;
}

.subscriptions-table th,
.subscriptions-table td {
  padding: 1rem 1.5rem;
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.subscriptions-table th {
  background: var(--surface);
  font-weight: 700;
  font-size: 0.75rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  white-space: nowrap;
  border-bottom: 2px solid var(--border-light);
}

.subscriptions-table td {
  font-size: 0.875rem;
  color: var(--text);
  background: var(--background);
}

.subscriptions-table tbody tr:hover td {
  background: var(--surface);
}

.actions-tab,
.inactive-tab,
.settings-tab {
  max-width: 1200px;
}

.actions-list {
  max-height: 600px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding-right: 0.5rem;
}

.action-item {
  border: 1px solid var(--border-light);
  border-radius: 12px;
  margin-bottom: 1rem;
  padding: 1.25rem;
  background: var(--surface);
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
}

.action-item:hover {
  transform: translateX(4px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border-color: var(--primary);
}

.action-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  gap: 1rem;
  padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--border-light);
}

.action-header strong {
  color: var(--primary);
  font-weight: 700;
  font-size: 0.875rem;
  flex: 1;
  text-transform: capitalize;
}

.action-date {
  color: var(--text-muted);
  font-size: 0.75rem;
  font-weight: 600;
  white-space: nowrap;
  background: var(--background);
  padding: 0.25rem 0.75rem;
  border-radius: 6px;
}

.action-details p {
  margin: 0.5rem 0;
  font-size: 0.875rem;
  color: var(--text);
  line-height: 1.6;
}

.action-notes {
  margin-top: 1rem;
}

.action-notes pre {
  background: var(--background);
  padding: 1rem;
  border-radius: 8px;
  font-size: 0.75rem;
  overflow-x: auto;
  border: 1px solid var(--border-light);
  color: var(--text);
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
}

.settings-info,
.quick-stats,
.deletions-table {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.settings-info h4,
.quick-stats h4 {
  margin: 0 0 1rem 0;
  color: var(--text);
  font-weight: 700;
  font-size: 1.125rem;
  border-bottom: 2px solid var(--border-light);
  padding-bottom: 0.75rem;
}

.settings-info p {
  margin: 0.75rem 0;
  color: var(--text);
  font-size: 0.875rem;
  line-height: 1.6;
}

.quick-stats ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.quick-stats li {
  padding: 1rem 0;
  border-bottom: 1px solid var(--border-light);
  color: var(--text);
  display: flex;
  justify-content: space-between;
  font-size: 0.875rem;
  font-weight: 500;
  gap: 1rem;
}

.quick-stats li:last-child {
  border-bottom: none;
}

.deletions-table table {
  width: 100%;
  border-collapse: collapse;
  display: block;
  max-height: 400px;
  overflow-y: auto;
  margin-top: 1rem;
}

.deletions-table thead {
  display: table;
  width: 100%;
  table-layout: fixed;
  position: sticky;
  top: 0;
  z-index: 10;
}

.deletions-table tbody {
  display: table;
  width: 100%;
  table-layout: fixed;
}

.deletions-table th,
.deletions-table td {
  padding: 1rem;
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.deletions-table th {
  background: var(--surface);
  font-weight: 700;
  font-size: 0.75rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  border-bottom: 2px solid var(--border-light);
}

.deletions-table td {
  font-size: 0.875rem;
  color: var(--text);
  background: var(--background);
}

.deletions-table tbody tr:hover td {
  background: var(--surface);
}

.no-deletions {
  text-align: center;
  padding: 3rem 1rem;
  color: var(--text-muted);
  font-size: 1rem;
}

.loading,
.error {
  text-align: center;
  padding: 2rem 1rem;
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  margin: 1rem;
}

.error h3 {
  color: var(--danger);
  margin-bottom: 1rem;
  font-size: 1rem;
}

.loading {
  color: var(--text-muted);
  font-size: 0.875rem;
}

/* CSS Variables handle dark mode automatically through the app's theme system */

/* ==== Responsive Design ==== */
@media (max-width: 768px) {
  .admin-content-scrollable {
    padding: 1rem;
  }

  .admin-header {
    flex-direction: column;
    gap: 0.75rem;
    padding: 1rem;
  }

  .admin-header h2 {
    font-size: 1.25rem;
  }

  .admin-tabs {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    padding: 0 1rem;
  }

  .admin-tabs button {
    padding: 0.75rem 1rem;
    font-size: 0.8125rem;
  }

  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
  }

  .stat strong {
    font-size: 1.5rem;
  }

  .stat span {
    font-size: 0.6875rem;
  }

  .form-row .action-group {
    grid-template-columns: 1fr;
    gap: 0.75rem;
  }

  .subscriptions-table table,
  .deletions-table table {
    max-height: 400px;
  }

  .subscriptions-table th,
  .subscriptions-table td,
  .deletions-table th,
  .deletions-table td {
    padding: 0.75rem 1rem;
    font-size: 0.8125rem;
  }

  .action-item {
    padding: 1rem;
  }
}

@media (max-width: 480px) {
  .admin-content-scrollable {
    padding: 0.75rem;
  }

  .admin-header {
    padding: 0.75rem;
  }

  .admin-header h2 {
    font-size: 1.125rem;
  }

  .admin-info span {
    font-size: 0.75rem;
  }

  .admin-tabs {
    flex-wrap: nowrap;
    overflow-x: auto;
    padding: 0 0.75rem;
  }

  .admin-tabs button {
    padding: 0.625rem 0.875rem;
    font-size: 0.75rem;
  }

  .stats-bar {
    grid-template-columns: 1fr;
    gap: 0.5rem;
  }

  .stat {
    padding: 1rem;
  }

  .stat strong {
    font-size: 1.5rem;
  }

  .stat span {
    font-size: 0.6875rem;
  }

  .admin-actions-panel,
  .settings-info,
  .quick-stats,
  .deletions-table {
    padding: 1rem;
  }

  .admin-actions-panel h3,
  .settings-info h4,
  .quick-stats h4 {
    font-size: 1rem;
  }

  .input-group {
    flex-wrap: wrap;
    justify-content: space-between;
  }

  .input-group label {
    flex: 1 1 100%;
    margin-bottom: 0.5rem;
  }

  .input-group input {
    flex: 1;
  }

  .input-group button {
    flex: 1;
    min-width: 120px;
  }

  .subscriptions-table h3,
  .deletions-table h3 {
    font-size: 1rem;
    padding: 0.75rem 1rem;
  }

  .subscriptions-table th,
  .subscriptions-table td,
  .deletions-table th,
  .deletions-table td {
    padding: 0.75rem;
    font-size: 0.75rem;
  }

  .action-item {
    padding: 0.875rem;
  }

  .action-header {
    flex-direction: column;
    align-items: flex-start;
  }

  .action-date {
    align-self: flex-end;
  }

  .quick-stats li {
    font-size: 0.8125rem;
    padding: 0.75rem 0;
  }
}
`;if(typeof document<"u"&&!document.getElementById("admin-dashboard-styles")){const t=document.createElement("style");t.id="admin-dashboard-styles",t.textContent=EC,document.head.appendChild(t)}function CC({featureName:e,onUpgrade:t}){return d.jsxs("div",{className:"feature-locked",children:[d.jsx("div",{className:"lock-icon",children:"🔒"}),d.jsx("h3",{children:e}),d.jsx("p",{children:"This premium feature requires an active subscription."}),d.jsx("button",{className:"upgrade-button",onClick:t,children:"Upgrade to Enforcement Pro"})]})}function s_({user:e,fallback:t,children:r}){const{hasAccess:n,isLoading:a}=bp(e);return a?d.jsxs("div",{className:"subscription-loading",children:[d.jsx("div",{className:"spinner-small"}),d.jsx("span",{children:"Checking access..."})]}):n?d.jsx(d.Fragment,{children:r}):t?d.jsx(d.Fragment,{children:t}):d.jsx(CC,{featureName:"Premium Feature",onUpgrade:()=>{console.log("Upgrade clicked - implement subscription flow")}})}function AC({state:e,user:t}){const[r,n]=J.useState(()=>{const p=new Date;return p.setDate(1),p.toISOString().slice(0,10)}),[a,s]=J.useState(()=>new Date().toISOString().slice(0,10)),l=J.useMemo(()=>{const g=(e.completions||[]).filter(ue=>{const ce=ue.timestamp.slice(0,10);return ce>=r&&ce<=a}),y=g.filter(ue=>ue.outcome==="PIF"),_=y.reduce((ue,ce)=>{const Ce=parseFloat(ce.amount||"0");return ue+(isNaN(Ce)?0:Ce)},0),T=g.length,S=y.length,w=g.filter(ue=>ue.outcome==="Done").length,E=g.filter(ue=>ue.outcome==="DA").length,P=g.filter(ue=>ue.outcome==="ARR").length,I=e.daySessions||[],A=new Set(g.map(ue=>ue.timestamp.slice(0,10))),R=new Set(I.filter(ue=>ue.date>=r&&ue.date<=a&&ue.end&&A.has(ue.date)).map(ue=>ue.date)).size,K=e.bonusSettings||rs,W=fx(g,R,K),D=lS(g,R,K),ee=g.reduce((ue,ce)=>{const Ce=ce.timestamp.slice(0,10);if(ue[Ce]||(ue[Ce]={date:Ce,pifs:0,total:0,fees:0,completions:[]}),ue[Ce].total++,ue[Ce].completions.push(ce),ce.outcome==="PIF"){ue[Ce].pifs++;const ye=parseFloat(ce.amount||"0");isNaN(ye)||(ue[Ce].fees+=ye)}return ue},{}),re=Object.values(ee).map(ue=>{const ce=ue.completions,Ce=fx(ce,1,K);return{date:ue.date,pifs:ue.pifs,total:ue.total,fees:ue.fees,bonus:Ce}});let pe="";if(K.calculationType==="simple"){const ue=K.simpleSettings?.pifBonus||100,ce=K.simpleSettings?.dailyThreshold||100;pe=`£${ue}/PIF - £${ce}/day`}else K.calculationType==="complex"?pe="TCG Regulations 2014":K.calculationType==="custom"&&(pe="Custom Formula");return{totalPifFees:_,totalAddresses:T,pifCount:S,doneCount:w,daCount:E,arrCount:P,totalBonus:W,workingDays:R,bonusBreakdown:D,formulaDescription:pe,dailyStats:re.sort((ue,ce)=>ce.date.localeCompare(ue.date))}},[e.completions,e.daySessions,e.bonusSettings,r,a]),u=p=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2}).format(p),m=()=>{const p=new Date(r).toLocaleDateString("en-GB"),g=new Date(a).toLocaleDateString("en-GB");return`${p} - ${g}`};return d.jsx(s_,{user:t,fallback:d.jsx(NC,{}),children:d.jsxs("div",{className:"earnings-calendar",style:{padding:"1rem"},children:[d.jsx("h2",{children:"Earnings Overview"}),d.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",alignItems:"center",flexWrap:"wrap"},children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"start-date",style:{display:"block",marginBottom:"0.5rem"},children:"From:"}),d.jsx("input",{id:"start-date",type:"date",value:r,onChange:p=>n(p.target.value),className:"input"})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"end-date",style:{display:"block",marginBottom:"0.5rem"},children:"To:"}),d.jsx("input",{id:"end-date",type:"date",value:a,onChange:p=>s(p.target.value),className:"input"})]})]}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[d.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--success)"},children:"Total PIF Fees"}),d.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:u(l.totalPifFees)}),d.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[l.pifCount," PIF completions"]})]}),d.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Total Addresses"}),d.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:l.totalAddresses}),d.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:m()})]}),d.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--primary)"},children:"Potential Bonus"}),d.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:u(l.totalBonus)}),d.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:l.formulaDescription}),d.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[l.workingDays," working day",l.workingDays!==1?"s":""]})]}),d.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Breakdown"}),d.jsxs("div",{style:{fontSize:"0.875rem"},children:[d.jsxs("div",{children:["PIF: ",l.pifCount]}),d.jsxs("div",{children:["Done: ",l.doneCount]}),d.jsxs("div",{children:["DA: ",l.daCount]}),d.jsxs("div",{children:["ARR: ",l.arrCount]})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{children:"Daily Breakdown"}),l.dailyStats.length===0?d.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No completions found in selected date range"}):d.jsx("div",{style:{overflowX:"auto"},children:d.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)"},children:[d.jsx("thead",{children:d.jsxs("tr",{style:{background:"var(--background)"},children:[d.jsx("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid var(--border-light)"},children:"Date"}),d.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIFs"}),d.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Total Addresses"}),d.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIF Fees"}),d.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Bonus"})]})}),d.jsx("tbody",{children:l.dailyStats.map(p=>d.jsxs("tr",{children:[d.jsx("td",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border-light)"},children:new Date(p.date).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})}),d.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:p.pifs}),d.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:p.total}),d.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold"},children:u(p.fees)}),d.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold",color:p.bonus>0?"var(--primary)":"var(--text-muted)"},children:u(p.bonus)})]},p.date))})]})})]})]})})}function NC(){return d.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",margin:"1rem"},children:[d.jsx("h2",{children:"Earnings Tracking"}),d.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--text-muted)"},children:"Track your PIF fees and completion statistics with detailed date range analysis."}),d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",fontSize:"0.875rem"},children:"Premium Feature"})}),d.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Start your free trial to access earnings tracking and reporting."})]})}class PC{currentToken=null;generateToken(){return this.currentToken="session_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36),this.currentToken}getToken(){return this.currentToken}clearToken(){this.currentToken=null}}const Uu=new PC;async function IC(e,t={}){const r="your-new-google-maps-api-key-here";if(!e.trim()||e.length<3)return[];try{const n=t.sessionToken||Uu.generateToken(),a={input:e,sessionToken:n,...t.componentRestrictions&&{regionCode:t.componentRestrictions.country.toUpperCase()},...t.types&&t.types.length>0&&{includedPrimaryTypes:t.types}};console.log("Making Places API (New) autocomplete request:",a);const s=await fetch("https://places.googleapis.com/v1/places:autocomplete",{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":r,"X-Goog-FieldMask":"suggestions.placePrediction.place,suggestions.placePrediction.placeId,suggestions.placePrediction.text"},body:JSON.stringify(a)});if(!s.ok){const u=await s.text();throw console.error("Places API error:",s.status,u),new Error(`Places API error: ${s.status} - ${u}`)}const l=await s.json();return console.log("Places API response:",l),l.suggestions?l.suggestions.filter(u=>u.placePrediction).map(u=>({place_id:u.placePrediction.placeId,description:u.placePrediction.text?.text||"",structured_formatting:{main_text:u.placePrediction.structuredFormat?.mainText?.text||"",secondary_text:u.placePrediction.structuredFormat?.secondaryText?.text||""},types:u.placePrediction.types||[]})):[]}catch(n){throw console.error("Places API autocomplete failed:",n),n}}async function DC(e,t){const r="your-new-google-maps-api-key-here";try{console.log("Getting place details for:",e);const n=`https://places.googleapis.com/v1/places/${e}`,a=await fetch(n,{method:"GET",headers:{"X-Goog-Api-Key":r,"X-Goog-FieldMask":"id,displayName,formattedAddress,location,types"}});if(!a.ok){const l=await a.text();throw console.error("Place details API error:",a.status,l),new Error(`Place details API error: ${a.status} - ${l}`)}const s=await a.json();return console.log("Place details response:",s),t&&Uu.clearToken(),s.id&&s.location?{place_id:s.id,name:s.displayName?.text||"",formatted_address:s.formattedAddress||"",geometry:{location:{lat:s.location.latitude,lng:s.location.longitude}},types:s.types||[]}:null}catch(n){throw console.error("Place details failed:",n),t&&Uu.clearToken(),n}}function FC(){return Uu.getToken()}function Yx(){Uu.clearToken()}function o_(e){if(e<60)return`${Math.round(e)}s`;const t=Math.floor(e/60);if(t<60)return`${t}m`;const r=Math.floor(t/60),n=t%60;return n>0?`${r}h ${n}m`:`${r}h`}function l_(e){if(e<1e3)return`${Math.round(e)}m`;const t=e/1e3;return t<10?`${t.toFixed(1)}km`:`${Math.round(t)}km`}function c_(e){return`${Math.round(e*100)}%`}const qx="geocode-cache",pm=720*60*60*1e3;class jC{cache={};isLoadingCache=!1;cacheLoadPromise=null;apiKey;constructor(t){this.apiKey=t,this.cacheLoadPromise=this.loadCache()}async loadCache(){if(this.isLoadingCache)return this.cacheLoadPromise||Promise.resolve();this.isLoadingCache=!0;try{const t=await up(qx);t&&(this.cache={...t,...this.cache},this.cleanExpiredEntries())}catch(t){console.warn("Failed to load geocoding cache:",t)}finally{this.isLoadingCache=!1,this.cacheLoadPromise=null}}async saveCache(){try{await dp(qx,this.cache)}catch(t){console.warn("Failed to save geocoding cache:",t)}}cleanExpiredEntries(){const t=Date.now(),r=[];for(const[n,a]of Object.entries(this.cache))t-a.timestamp>pm&&r.push(n);for(const n of r)delete this.cache[n];r.length>0&&this.saveCache()}normalizeAddress(t){return t.trim().toLowerCase().replace(/\s+/g," ")}async geocodeAddressInternal(t){if(this.cacheLoadPromise&&await this.cacheLoadPromise,!this.apiKey)return{success:!1,address:t,originalAddress:t,error:"Google Maps API key not configured"};if(!t?.trim())return{success:!1,address:t,originalAddress:t,error:"Empty address provided"};const r=this.normalizeAddress(t),n=this.cache[r];if(n&&Date.now()-n.timestamp<pm)return n.result;try{console.log(`Geocoding with Google Maps SDK: "${t}"`);const{geocodeAddressSDK:a,isGoogleMapsSDKAvailable:s}=await si(async()=>{const{geocodeAddressSDK:l,isGoogleMapsSDKAvailable:u}=await import("./googleMapsSDK-CCdvlH9E.js");return{geocodeAddressSDK:l,isGoogleMapsSDKAvailable:u}},[]);if(s()){const l=await a(t);if(l.success)return this.cache[r]={result:l,timestamp:Date.now()},this.saveCache().catch(console.warn),l;this.cache[r]={result:l,timestamp:Date.now()},this.saveCache().catch(console.warn)}}catch(a){console.warn("JavaScript SDK geocoding failed, falling back to Supabase Edge Function:",a)}return{success:!1,address:t,originalAddress:t,error:"Google Maps direct geocoding not available"}}getCacheStats(){const t=Date.now();let r=0,n=0;for(const a of Object.values(this.cache))t-a.timestamp<pm?r++:n++;return{totalEntries:Object.keys(this.cache).length,validEntries:r,expiredEntries:n}}async clearCache(){this.cache={},await this.saveCache()}}let gm=null;function kp(){if(!gm){const e="your-new-google-maps-api-key-here";gm=new jC(e)}return gm}async function OC(e,t,r){const n=kp(),a=[],s=5;for(let u=0;u<e.length;u+=s){const m=e.slice(u,u+s),p=m.map(y=>n.geocodeAddressInternal(y)),g=await Promise.all(p);a.push(...g),r&&r(a.length,e.length,m[m.length-1]),u+s<e.length&&await new Promise(y=>setTimeout(y,200))}const l=a.filter(u=>!u.success).length;if(l>e.length*.5){console.warn(`${l}/${e.length} addresses failed with direct API, trying Supabase Edge Function...`);try{const{geocodeAddresses:u}=await si(async()=>{const{geocodeAddresses:p}=await Promise.resolve().then(()=>u_);return{geocodeAddresses:p}},void 0),m=await u(e,r);return a.map((p,g)=>p.success?p:m[g])}catch(u){console.warn("Centralized batch geocoding also failed:",u)}}return a}async function RC(e,t,r="GB",n=5){if(!e.trim()||e.length<3)return[];try{console.log(`Searching addresses with Google Places API: "${e}"`);const s=await IC(e,{componentRestrictions:{country:r.toLowerCase()},types:["street_address","route","premise"]});if(s.length>0)return s.slice(0,n).map(l=>({label:l.description,coordinates:[0,0],confidence:.9,placeId:l.place_id}))}catch(s){console.warn("Google Places API search failed, trying Supabase Edge Function:",s)}try{const{searchAddresses:s}=await si(async()=>{const{searchAddresses:u}=await Promise.resolve().then(()=>u_);return{searchAddresses:u}},void 0),l=await s(e,r,n);if(l.length>0)return l}catch(s){console.warn("Centralized address search also failed:",s)}const a=kp();if(a.apiKey)try{const s=await a.geocodeAddressInternal(e);if(s.success&&s.lat&&s.lng)return[{label:s.formattedAddress||s.address,coordinates:[s.lng,s.lat],confidence:s.confidence||.7}]}catch(s){console.warn("Direct geocoding fallback also failed:",s)}return[]}async function LC(e){if(!e)return null;try{const r=FC()||void 0,n=await DC(e,r);if(Yx(),n?.geometry?.location)return{lat:n.geometry.location.lat,lng:n.geometry.location.lng,formattedAddress:n.formatted_address||n.name||""}}catch(r){Yx(),console.error("Failed to resolve place details with new API:",r)}const t=kp();if(t.apiKey)try{const r=await t.geocodeAddressInternal(e);if(r.success&&r.lat&&r.lng)return{lat:r.lat,lng:r.lng,formattedAddress:r.formattedAddress||r.address}}catch(r){console.warn("Geocoding fallback for place resolution failed:",r)}return null}async function MC(e,t){if(!We)throw new Error("Supabase client not available");try{console.log(`Geocoding ${e.length} addresses via centralized service`);const r=[],n=10;for(let a=0;a<e.length;a+=n){const s=e.slice(a,a+n),{data:l,error:u}=await We.functions.invoke("geocode",{body:{addresses:s,countryCode:"GB"}});if(u){console.error("Geocoding batch error:",u);const m=s.map(p=>({success:!1,address:p,originalAddress:p,error:u.message||"Geocoding service error"}));r.push(...m)}else if(l?.results)r.push(...l.results);else{console.error("Unexpected geocoding response:",l);const m=s.map(p=>({success:!1,address:p,originalAddress:p,error:"Unexpected service response"}));r.push(...m)}t&&t(r.length,e.length,s[s.length-1])}return console.log(`Geocoding completed: ${r.filter(a=>a.success).length}/${r.length} successful`),r}catch(r){return console.error("Geocoding service failed:",r),e.map(n=>({success:!1,address:n,originalAddress:n,error:r instanceof Error?r.message:"Service unavailable"}))}}async function BC(e,t="GB",r=5,n,a){if(!We)return console.error("Supabase client not available for address search"),[];try{if(!e.trim()||e.length<3)return[];const{data:s,error:l}=await We.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:t,limit:Math.min(r,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return l?(console.error("Address search error:",l),[]):s?.results||[]}catch(s){return console.error("Address search failed:",s),[]}}function Ym(e){const t=e.lat!==null&&e.lat!==void 0&&e.lng!==null&&e.lng!==void 0&&!isNaN(e.lat)&&!isNaN(e.lng);return{success:t,address:e.address,originalAddress:e.address,lat:t&&e.lat!==null?e.lat:void 0,lng:t&&e.lng!==null?e.lng:void 0,confidence:t?1:void 0,error:t?void 0:"No coordinates available"}}function Zf(e){return{address:e.address,lat:e.success&&e.lat!==void 0?e.lat:null,lng:e.success&&e.lng!==void 0?e.lng:null}}const u_=Object.freeze(Object.defineProperty({__proto__:null,addressRowToGeocodingResult:Ym,formatConfidence:c_,formatDistance:l_,formatDuration:o_,geocodeAddresses:MC,geocodingResultToAddressRow:Zf,searchAddresses:BC},Symbol.toStringTag,{value:"Module"}));async function Xx(e,t){console.log(`Geocoding ${e.length} addresses via Google Maps (hybrid service)`);try{const r=await OC(e,void 0,t);return console.log(`Google Maps geocoding completed: ${r.filter(n=>n.success).length}/${r.length} successful`),r}catch(r){return console.error("Google Maps geocoding service failed:",r),e.map(n=>({success:!1,address:n,originalAddress:n,error:r instanceof Error?r.message:"Google Maps service unavailable"}))}}async function zC(e,t="GB",r=5,n,a){try{const s=await RC(e);if(s.length>0)return s.slice(0,r)}catch(s){console.warn("Google Maps search failed, falling back to centralized service:",s)}if(!We)return console.error("No search services available"),[];try{if(!e.trim()||e.length<3)return[];const{data:s,error:l}=await We.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:t,limit:Math.min(r,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return l?(console.error("Address search error:",l),[]):s?.results||[]}catch(s){return console.error("Address search failed:",s),[]}}async function UC(e,t){if(!We)throw new Error("Supabase client not available");try{const r=e.map((l,u)=>({...l,originalIndex:u})).filter(({lat:l,lng:u})=>l!=null&&u!==null&&u!==void 0&&!isNaN(l)&&!isNaN(u));if(r.length===0)return{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((l,u)=>u),error:"No addresses have valid coordinates for route optimization"};if(r.length===1)return{success:!0,optimizedOrder:[r[0].originalIndex],totalDistance:0,totalDuration:0,unassigned:[]};console.log(`Optimizing route for ${r.length} addresses via OpenRouteService (hybrid service)`);const n={addresses:r.map(l=>({address:l.address,lat:l.lat,lng:l.lng})),startLocation:t};console.log("Route optimization request:",{addressCount:n.addresses.length,hasStartLocation:!!t,firstAddress:n.addresses[0]});let a=null,s=null;try{const l="https://eevfxrgemrtthxbcxtvq.supabase.co",u="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",m=`${l}/functions/v1/optimize-route`,p=(await We.auth.getSession()).data.session?.access_token;console.log("Making direct request to Edge Function:",{url:m,hasAuthToken:!!p,requestBodySize:JSON.stringify(n).length});const g={"Content-Type":"application/json",apikey:u};p&&(g.Authorization=`Bearer ${p}`);const y=await fetch(m,{method:"POST",headers:g,body:JSON.stringify(n)});if(console.log("Edge Function response status:",{status:y.status,statusText:y.statusText,ok:y.ok,headers:Object.fromEntries(y.headers.entries())}),y.ok)a=await y.json();else{const _=await y.text();console.error("Edge Function error response:",{status:y.status,statusText:y.statusText,body:_});try{const T=JSON.parse(_);s=new Error(`Edge Function error (${y.status}): ${T.error||_}`)}catch{s=new Error(`Edge Function error (${y.status}): ${_}`)}}}catch(l){console.error("Failed to make direct request to Edge Function:",l);const u=await We.functions.invoke("optimize-route",{body:n});a=u.data,s=u.error}if(s){console.error("Route optimization error details:",{error:s,errorMessage:s.message,errorName:s.name,errorStack:s.stack,data:a});let l=`Route optimization service error: ${s.message||"Unknown error"}`;return s.message?.includes("OpenRouteService API key")?l="Route optimization service not configured. Please contact support.":s.message?.includes("non-2xx status code")?l="Route optimization service is temporarily unavailable. Please try again later.":s.message?.includes("Unauthorized")?l="Authentication required. Please log in again.":s.message?.includes("Subscription required")?l="Route optimization requires an active subscription.":s.message?.includes("OpenRouteService API error")?l=`OpenRouteService API error: ${s.message.split("OpenRouteService API error: ")[1]||s.message}`:s.message?.includes("Maximum 100 addresses")?l="Too many addresses. Maximum 100 addresses allowed per optimization.":s.message?.includes("No addresses have valid coordinates")&&(l="No addresses have valid coordinates for route optimization."),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((u,m)=>m),error:l}}return console.log("Route optimization response received:",{hasData:!!a,dataKeys:a?Object.keys(a):null,success:a?.success}),a?(console.log(`Route optimization completed: ${a.optimizedOrder?.length||0} addresses optimized`),a):(console.error("Route optimization: No data received from Edge Function"),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((l,u)=>u),error:"No response from optimization service"})}catch(r){return console.error("Route optimization failed:",r),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((n,a)=>a),error:r instanceof Error?r.message:"Unknown error occurred"}}}async function WC(e,t,r){if(!We)return{success:!1,routeSegments:[],error:"Supabase client not available"};try{const n=[];r&&n.push(r);for(const l of t){const u=e[l];u.lat&&u.lng&&n.push([u.lng,u.lat])}if(n.length<2)return{success:!1,routeSegments:[],error:"Need at least 2 waypoints to generate route"};const{data:a,error:s}=await We.functions.invoke("get-route-directions",{body:{coordinates:n,profile:"driving-car"}});return s?(console.error("Route directions error:",s),{success:!1,routeSegments:[],error:s.message||"Failed to get route directions"}):{success:!0,routeSegments:a?.segments||[],error:void 0}}catch(n){return console.error("Failed to get route directions:",n),{success:!1,routeSegments:[],error:n instanceof Error?n.message:"Unknown error occurred"}}}function $C({id:e,value:t,onChange:r,onSelect:n,placeholder:a="Start typing an address...",disabled:s=!1,className:l="input"}){const[u,m]=J.useState([]),[p,g]=J.useState(!1),[y,_]=J.useState(!1),[T,S]=J.useState(-1),w=J.useRef(null),E=J.useRef(null),P=J.useRef(),I=J.useCallback(async D=>{if(!D.trim()||D.length<3){J.startTransition(()=>{m([]),_(!1)});return}g(!0);try{const ee=await zC(D);J.startTransition(()=>{m(ee),_(ee.length>0),S(-1)})}catch(ee){console.error("Address search failed:",ee),J.startTransition(()=>{m([]),_(!1)})}finally{g(!1)}},[]),A=D=>{const ee=D.target.value;r(ee),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{I(ee)},300)},R=async D=>{if(D.placeId){g(!0);try{const ee=await LC(D.placeId);ee?(r(D.label),n(D.label,ee.lat,ee.lng)):(r(D.label),n(D.label,0,0))}catch(ee){console.error("Failed to resolve place details:",ee),r(D.label),n(D.label,0,0)}finally{g(!1)}}else{const[ee,re]=D.coordinates;r(D.label),n(D.label,re,ee)}J.startTransition(()=>{_(!1),S(-1),m([])}),setTimeout(()=>{w.current?.blur()},0)},K=D=>{if(!(!y||u.length===0))switch(D.key){case"ArrowDown":D.preventDefault(),S(ee=>ee<u.length-1?ee+1:ee);break;case"ArrowUp":D.preventDefault(),S(ee=>ee>0?ee-1:-1);break;case"Enter":D.preventDefault(),T>=0&&T<u.length&&R(u[T]);break;case"Escape":J.startTransition(()=>{_(!1),S(-1)}),setTimeout(()=>{w.current?.blur()},0);break}};J.useEffect(()=>{const D=ee=>{try{w.current&&!w.current.contains(ee.target)&&E.current&&!E.current.contains(ee.target)&&J.startTransition(()=>{_(!1),S(-1)})}catch(re){console.debug("Click outside detection error (ignoring):",re)}};return document.addEventListener("mousedown",D),()=>{try{document.removeEventListener("mousedown",D)}catch(ee){console.debug("Event listener cleanup error (ignoring):",ee)}}},[]),J.useEffect(()=>()=>{P.current&&clearTimeout(P.current)},[]);const W=D=>D>=.8?"var(--success)":D>=.5?"var(--warning)":"var(--danger)";return d.jsxs("div",{style:{position:"relative",width:"100%"},children:[d.jsxs("div",{style:{position:"relative"},children:[d.jsx("input",{id:e,ref:w,name:"address",type:"text",value:t,onChange:A,onKeyDown:K,onFocus:()=>{u.length>0&&_(!0)},placeholder:a,disabled:s,className:l,style:{width:"100%",paddingRight:p?"2.5rem":"1rem"},autoComplete:"off"}),p&&d.jsx("div",{style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem"},children:d.jsx("div",{className:"spinner",style:{width:"100%",height:"100%"}})})]}),y&&u.length>0&&d.jsx("div",{ref:E,style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",maxHeight:"300px",overflowY:"auto",marginTop:"0.25rem"},children:u.map((D,ee)=>d.jsxs("button",{onClick:()=>{setTimeout(()=>R(D),0)},style:{width:"100%",padding:"0.75rem 1rem",border:"none",background:T===ee?"var(--primary-light)":"transparent",color:T===ee?"var(--primary)":"var(--text-primary)",textAlign:"left",cursor:"pointer",borderBottom:ee<u.length-1?"1px solid var(--border-light)":"none",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem",lineHeight:"1.4"},onMouseEnter:()=>S(ee),children:[d.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis"},children:D.label}),d.jsxs("span",{style:{fontSize:"0.75rem",color:W(D.confidence),marginLeft:"0.5rem",flexShrink:0},title:`Confidence: ${Math.round(D.confidence*100)}%`,children:[Math.round(D.confidence*100),"%"]})]},`${D.label}-${ee}`))}),y&&u.length===0&&!p&&t.length>=3&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",padding:"1rem",marginTop:"0.25rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.875rem"},children:/[A-Z]{1,2}[0-9]{1,2}\s?[0-9][A-Z]{2}/i.test(t)?"Address not found. Try removing the house number or use just the postcode.":'No addresses found. Try including the postcode (e.g., "High Street SW1A 1AA").'})]})}function HC(e,t,r,n){let a="marker-pin";return t?a+=" marker-start":r?n!==void 0&&(n<.5?a+=" marker-low-confidence":n<.8&&(a+=" marker-medium-confidence")):a+=" marker-not-geocoded",zu.divIcon({className:"custom-numbered-marker",html:`<div class="${a}">
      <div class="marker-number">${t?"🏠":e}</div>
    </div>`,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]})}function VC({pins:e}){const t=e_();return J.useEffect(()=>{if(e.length!==0)if(e.length===1){const r=e[0];t.setView([r.lat,r.lng],15)}else{const r=new zu.FeatureGroup(e.map(n=>zu.marker([n.lat,n.lng])));t.fitBounds(r.getBounds().pad(.1))}},[t,e.length]),null}function GC({addresses:e,startingPointIndex:t,onStartingPointChange:r,optimizedOrder:n,showRouteLines:a=!1,confidences:s}){const[l,u]=J.useState([]),[m,p]=J.useState(!1),_=e.map((I,A)=>({id:`pin-${A}`,address:I.address,lat:I.lat||0,lng:I.lng||0,isStart:A===t,isGeocoded:!!(I.lat&&I.lng),confidence:s?.[A]})).filter(I=>I.isGeocoded),T=J.useRef("");J.useEffect(()=>{async function I(){if(!a||!n||n.length<2){u([]),T.current="";return}const A=n.filter(K=>K<0||K>=e.length);if(A.length>0){console.error("Invalid optimizedOrder indices:",A),u([]);return}const R=`${n.join(",")}-${t}`;if(T.current!==R){p(!0);try{const K=t!==void 0&&e[t]?[e[t].lng,e[t].lat]:void 0,W=await WC(e,n,K);W.success?(u(W.routeSegments),T.current=R):(console.error("Route directions failed:",W.error),u([]))}catch(K){console.error("Route directions error:",K),u([])}finally{p(!1)}}}I()},[a,n,e.length,t]);const S=I=>{r(t===I?null:I)},w=(I,A)=>A<=1?"#3388ff":`hsl(${(1-I/(A-1))*120}, 70%, 50%)`,E=[54.5,-2];return d.jsxs("div",{style:{height:"100%",width:"100%"},children:[d.jsxs(t_,{center:E,zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[d.jsx(n_,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),d.jsx(VC,{pins:_}),_.map((I,A)=>{const R=e.findIndex(K=>K.lat===I.lat&&K.lng===I.lng&&K.address===I.address);return d.jsx(r_,{position:[I.lat,I.lng],icon:HC(A+1,I.isStart,I.isGeocoded,I.confidence),children:d.jsx(Zm,{children:d.jsxs("div",{style:{minWidth:"200px"},children:[d.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:I.address}),d.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.5rem"},children:["Lat: ",I.lat.toFixed(6),", Lng: ",I.lng.toFixed(6)]}),I.confidence&&d.jsxs("div",{style:{fontSize:"0.875rem",marginBottom:"0.5rem",color:I.confidence>=.8?"var(--success)":I.confidence>=.5?"var(--warning)":"var(--danger)"},children:["Confidence: ",Math.round(I.confidence*100),"%"]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:d.jsx("button",{onClick:()=>S(R),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:I.isStart?"var(--success)":"var(--primary)",color:"white",border:"none",borderRadius:"var(--radius)",cursor:"pointer"},children:I.isStart?"🏁 Starting Point":"📍 Set as Start"})})]})})},I.id)}),a&&l.map((I,A)=>{const R=I.geometry.map(K=>[K[1],K[0]]);return d.jsx(GE,{positions:R,color:w(A,l.length),weight:4,opacity:.8,dashArray:A===0?void 0:"5, 5",children:d.jsx(Zm,{children:d.jsxs("div",{children:[d.jsxs("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:["Route Segment ",A+1]}),d.jsxs("div",{style:{fontSize:"0.875rem"},children:["Distance: ",(I.distance/1e3).toFixed(1)," km",d.jsx("br",{}),"Duration: ",Math.round(I.duration/60)," min"]})]})})},`route-segment-${A}`)})]}),m&&d.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",background:"var(--surface)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",boxShadow:"var(--shadow)",fontSize:"0.875rem",zIndex:10},children:"🗺️ Loading route directions..."}),d.jsx("style",{children:`
        /* Custom Numbered Markers */
        .custom-numbered-marker {
          background: transparent;
          border: none;
        }

        .marker-pin {
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .marker-pin::before {
          content: '';
          position: absolute;
          width: 36px;
          height: 36px;
          background: var(--primary);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          border: 3px solid white;
        }

        .marker-pin.marker-start::before {
          background: var(--success);
          animation: markerPulse 2s ease-in-out infinite;
        }

        .marker-pin.marker-not-geocoded::before {
          background: var(--gray-400);
        }

        .marker-pin.marker-low-confidence::before {
          background: var(--danger);
        }

        .marker-pin.marker-medium-confidence::before {
          background: var(--warning);
        }

        @keyframes markerPulse {
          0%, 100% {
            transform: rotate(-45deg) scale(1);
          }
          50% {
            transform: rotate(-45deg) scale(1.1);
          }
        }

        .marker-number {
          position: relative;
          z-index: 1;
          color: white;
          font-weight: bold;
          font-size: 0.875rem;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
          transform: translateY(-2px);
        }

        /* Leaflet Popup Override for Dark Mode */
        .leaflet-popup-content-wrapper {
          background: var(--surface) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--border) !important;
          box-shadow: 0 3px 14px rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-tip {
          background: var(--surface) !important;
          border: 1px solid var(--border) !important;
        }

        .leaflet-popup-close-button {
          color: var(--text-primary) !important;
        }

        .leaflet-popup-close-button:hover {
          color: var(--primary) !important;
        }
      `})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Wu={};Wu.version="0.18.5";var fa=1200,Ko=1252,ZC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_h=function(e){ZC.indexOf(e)!=-1&&(Ko=Sp[0]=e)};function KC(){_h(1252)}var ja=function(e){fa=e,_h(e)};function wh(){ja(1200),KC()}function eh(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function YC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function d_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var uc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?YC(e.slice(2)):t==254&&r==255?d_(e.slice(2)):t==65279?e.slice(1):e},bu=function(t){return String.fromCharCode(t)},qm=function(t){return String.fromCharCode(t)},Bt;function qC(e){Bt=e,ja=function(t){fa=t,_h(t)},uc=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Bt.utils.decode(1200,eh(t.slice(2))):t},bu=function(r){return fa===1200?String.fromCharCode(r):Bt.utils.decode(fa,[r&255,r>>8])[0]},qm=function(r){return Bt.utils.decode(Ko,[r])[0]},z_()}var Js="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function $u(e){for(var t="",r=0,n=0,a=0,s=0,l=0,u=0,m=0,p=0;p<e.length;)r=e.charCodeAt(p++),s=r>>2,n=e.charCodeAt(p++),l=(r&3)<<4|n>>4,a=e.charCodeAt(p++),u=(n&15)<<2|a>>6,m=a&63,isNaN(n)?u=m=64:isNaN(a)&&(m=64),t+=Js.charAt(s)+Js.charAt(l)+Js.charAt(u)+Js.charAt(m);return t}function ha(e){var t="",r=0,n=0,a=0,s=0,l=0,u=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<e.length;)s=Js.indexOf(e.charAt(p++)),l=Js.indexOf(e.charAt(p++)),r=s<<2|l>>4,t+=String.fromCharCode(r),u=Js.indexOf(e.charAt(p++)),n=(l&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(n)),m=Js.indexOf(e.charAt(p++)),a=(u&3)<<6|m,m!==64&&(t+=String.fromCharCode(a));return t}var Dt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),is=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function ro(e){return Dt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Jx(e){return Dt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ua=function(t){return Dt?is(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function id(e){if(typeof ArrayBuffer>"u")return ua(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function oo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function XC(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Tp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Tp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var tn=Dt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:is(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function JC(e){for(var t=[],r=0,n=e.length+250,a=ro(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=e.charCodeAt(++s)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ro(65535),n=65530)}return t.push(a.slice(0,r)),tn(t)}var kn=/\u0000/g,ku=/[\u0001-\u0006]/g;function hc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ni(e,t){var r=""+e;return r.length>=t?r:kr("0",t-r.length)+r}function Ep(e,t){var r=""+e;return r.length>=t?r:kr(" ",t-r.length)+r}function th(e,t){var r=""+e;return r.length>=t?r:r+kr(" ",t-r.length)}function QC(e,t){var r=""+Math.round(e);return r.length>=t?r:kr("0",t-r.length)+r}function eA(e,t){var r=""+e;return r.length>=t?r:kr("0",t-r.length)+r}var Qx=Math.pow(2,32);function ac(e,t){if(e>Qx||e<-Qx)return QC(e,t);var r=Math.round(e);return eA(r,t)}function rh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var e1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function tA(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var yt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},t1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},rA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function nh(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,l=1,u=0,m=1,p=0,g=0,y=Math.floor(a);p<t&&(y=Math.floor(a),u=y*l+s,g=y*p+m,!(a-y<5e-8));)a=1/(a-y),s=l,l=u,m=p,p=g;if(g>t&&(p>t?(g=m,u=s):(g=p,u=l)),!r)return[0,n*u,g];var _=Math.floor(n*u/g);return[_,n*u-_*g,g]}function Qs(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,l=[],u={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),l=[m.getFullYear(),m.getMonth()+1,m.getDate()],s=m.getDay(),n<60&&(s=(s+6)%7),r&&(s=lA(m,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=s,u}var f_=new Date(1899,11,31,0,0,0),nA=f_.getTime(),aA=new Date(1900,2,1,0,0,0);function h_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=aA&&(r+=1440*60*1e3),(r-(nA+(e.getTimezoneOffset()-f_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Cp(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function iA(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function sA(e){var t=e<0?12:11,r=Cp(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function oA(e){var t=Cp(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Hu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=sA(e):t===10?r=e.toFixed(10).substr(0,12):r=oA(e),Cp(iA(r.toUpperCase()))}function Yo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Hu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ma(14,h_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function lA(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function cA(e,t,r,n){var a="",s=0,l=0,u=r.y,m,p=0;switch(e){case 98:u=r.y+543;case 121:switch(t.length){case 1:case 2:m=u%100,p=2;break;default:m=u%1e4,p=4;break}break;case 109:switch(t.length){case 1:case 2:m=r.m,p=t.length;break;case 3:return vm[r.m-1][1];case 5:return vm[r.m-1][0];default:return vm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:m=r.d,p=t.length;break;case 3:return e1[r.q][0];default:return e1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:m=1+(r.H+11)%12,p=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:m=r.H,p=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:m=r.M,p=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ni(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(a=ni(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":m=r.D*24+r.H;break;case"[m]":case"[mm]":m=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":m=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}p=t.length===3?1:2;break;case 101:m=u,p=1;break}var g=p>0?ni(m,p):"";return g}function eo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var m_=/%/g;function uA(e,t,r){var n=t.replace(m_,""),a=t.length-n.length;return ns(e,n,r*Math.pow(10,2*a))+kr("%",a)}function dA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ns(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function p_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+p_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,m,p,g){return m+p+g.substr(0,(a+s)%a)+"."+g.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var g_=/# (\?+)( ?)\/( ?)(\d+)/;function fA(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),l=a-s*n,u=n;return r+(s===0?"":""+s)+" "+(l===0?kr(" ",e[1].length+1+e[4].length):Ep(l,e[1].length)+e[2]+"/"+e[3]+ni(u,e[4].length))}function hA(e,t,r){return r+(t===0?"":""+t)+kr(" ",e[1].length+2+e[4].length)}var v_=/^#*0*\.([0#]+)/,x_=/\).*[0#]/,y_=/\(###\) ###\\?-####/;function On(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function r1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function n1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function mA(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function pA(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Aa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(x_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Aa("n",n,r):"("+Aa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return dA(e,t,r);if(t.indexOf("%")!==-1)return uA(e,t,r);if(t.indexOf("E")!==-1)return p_(t,r);if(t.charCodeAt(0)===36)return"$"+Aa(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,u,m=Math.abs(r),p=r<0?"-":"";if(t.match(/^00+$/))return p+ac(m,t.length);if(t.match(/^[#?]+$/))return a=ac(r,0),a==="0"&&(a=""),a.length>t.length?a:On(t.substr(0,t.length-a.length))+a;if(s=t.match(g_))return fA(s,m,p);if(t.match(/^#+0+$/))return p+ac(m,t.length-t.indexOf("0"));if(s=t.match(v_))return a=r1(r,s[1].length).replace(/^([^\.]+)$/,"$1."+On(s[1])).replace(/\.$/,"."+On(s[1])).replace(/\.(\d*)$/,function(S,w){return"."+w+kr("0",On(s[1]).length-w.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return p+r1(m,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return p+eo(ac(m,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Aa(e,t,-r):eo(""+(Math.floor(r)+mA(r,s[1].length)))+"."+ni(n1(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Aa(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hc(Aa(e,t.replace(/[\\-]/g,""),r)),l=0,hc(hc(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(t.match(y_))return a=Aa(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=nh(m,Math.pow(10,l)-1,!1),a=""+p,g=ns("n",s[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+s[2]+"/"+s[3],g=th(u[2],l),g.length<s[4].length&&(g=On(s[4].substr(s[4].length-g.length))+g),a+=g,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=nh(m,Math.pow(10,l)-1,!0),p+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Ep(u[1],l)+s[2]+"/"+s[3]+th(u[2],l):kr(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=ac(r,0),t.length<=a.length?a:On(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=t.indexOf(".")-l,_=t.length-a.length-y;return On(t.substr(0,y)+a+t.substr(t.length-_))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=n1(r,s[1].length),r<0?"-"+Aa(e,t,-r):eo(pA(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ni(0,3-S.length):"")+S})+"."+ni(l,s[1].length);switch(t){case"###,##0.00":return Aa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var T=eo(ac(m,0));return T!=="0"?p+T:"";case"###,###.00":return Aa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Aa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function gA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ns(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function vA(e,t,r){var n=t.replace(m_,""),a=t.length-n.length;return ns(e,n,r*Math.pow(10,2*a))+kr("%",a)}function __(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+__(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,m,p,g){return m+p+g.substr(0,(a+s)%a)+"."+g.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function bi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(x_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bi("n",n,r):"("+bi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return gA(e,t,r);if(t.indexOf("%")!==-1)return vA(e,t,r);if(t.indexOf("E")!==-1)return __(t,r);if(t.charCodeAt(0)===36)return"$"+bi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,u,m=Math.abs(r),p=r<0?"-":"";if(t.match(/^00+$/))return p+ni(m,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:On(t.substr(0,t.length-a.length))+a;if(s=t.match(g_))return hA(s,m,p);if(t.match(/^#+0+$/))return p+ni(m,t.length-t.indexOf("0"));if(s=t.match(v_))return a=(""+r).replace(/^([^\.]+)$/,"$1."+On(s[1])).replace(/\.$/,"."+On(s[1])),a=a.replace(/\.(\d*)$/,function(S,w){return"."+w+kr("0",On(s[1]).length-w.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return p+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return p+eo(""+m);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bi(e,t,-r):eo(""+r)+"."+kr("0",s[1].length);if(s=t.match(/^#,#*,#0/))return bi(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=hc(bi(e,t.replace(/[\\-]/g,""),r)),l=0,hc(hc(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(t.match(y_))return a=bi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),u=nh(m,Math.pow(10,l)-1,!1),a=""+p,g=ns("n",s[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+s[2]+"/"+s[3],g=th(u[2],l),g.length<s[4].length&&(g=On(s[4].substr(s[4].length-g.length))+g),a+=g,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),u=nh(m,Math.pow(10,l)-1,!0),p+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Ep(u[1],l)+s[2]+"/"+s[3]+th(u[2],l):kr(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:On(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=t.indexOf(".")-l,_=t.length-a.length-y;return On(t.substr(0,y)+a+t.substr(t.length-_))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+bi(e,t,-r):eo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ni(0,3-S.length):"")+S})+"."+ni(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var T=eo(""+m);return T!=="0"?p+T:"";default:if(t.match(/\.[0#?]*$/))return bi(e,t.slice(0,t.lastIndexOf(".")),r)+On(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ns(e,t,r){return(r|0)===r?bi(e,t,r):Aa(e,t,r)}function xA(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var w_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":rh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(w_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function yA(e,t,r,n){for(var a=[],s="",l=0,u="",m="t",p,g,y,_="H";l<e.length;)switch(u=e.charAt(l)){case"G":if(!rh(e,l))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(y=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(y);a[a.length]={t:"t",v:s},++l;break;case"\\":var T=e.charAt(++l),S=T==="("||T===")"?T:"t";a[a.length]={t:S,v:T},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(p==null&&(p=Qs(t,r,e.charAt(l+1)==="2"),p==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},m=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||p==null&&(p=Qs(t,r),p==null))return"";for(s=u;++l<e.length&&e.charAt(l).toLowerCase()===u;)s+=u;u==="m"&&m.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:s},m=u;break;case"A":case"a":case"上":var w={t:u,v:u};if(p==null&&(p=Qs(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(p!=null&&(w.v=p.H>=12?"P":"A"),w.t="T",_="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(p!=null&&(w.v=p.H>=12?"PM":"AM"),w.t="T",l+=5,_="h"):e.substr(l,5).toUpperCase()==="上午/下午"?(p!=null&&(w.v=p.H>=12?"下午":"上午"),w.t="T",l+=5,_="h"):(w.t="t",++l),p==null&&w.t==="T")return"";a[a.length]=w,m=u;break;case"[":for(s=u;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(w_)){if(p==null&&(p=Qs(t,r),p==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},m=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",nl(e)||(a[a.length]={t:"t",v:s}));break;case".":if(p!=null){for(s=u;++l<e.length&&(u=e.charAt(l))==="0";)s+=u;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++l<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(l))>-1;)s+=u;a[a.length]={t:"n",v:s};break;case"?":for(s=u;e.charAt(++l)===u;)s+=u;a[a.length]={t:u,v:s},m=u;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++l;break}var E=0,P=0,I;for(l=a.length-1,m="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,m="h",E<1&&(E=1);break;case"s":(I=a[l].v.match(/\.0+$/))&&(P=Math.max(P,I[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":m=a[l].t;break;case"m":m==="s"&&(a[l].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[l].v.match(/[Hh]/)&&(E=1),E<2&&a[l].v.match(/[Mm]/)&&(E=2),E<3&&a[l].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var A="",R;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=cA(a[l].t.charCodeAt(0),a[l].v,p,P),a[l].t="t";break;case"n":case"?":for(R=l+1;a[R]!=null&&((u=a[R].t)==="?"||u==="D"||(u===" "||u==="t")&&a[R+1]!=null&&(a[R+1].t==="?"||a[R+1].t==="t"&&a[R+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[R].v==="/"||a[R].v===" "&&a[R+1]!=null&&a[R+1].t=="?"));)a[l].v+=a[R].v,a[R]={v:"",t:";"},++R;A+=a[l].v,l=R-1;break;case"G":a[l].t="t",a[l].v=Yo(t,r);break}var K="",W,D;if(A.length>0){A.charCodeAt(0)==40?(W=t<0&&A.charCodeAt(0)===45?-t:t,D=ns("n",A,W)):(W=t<0&&n>1?-t:t,D=ns("n",A,W),W<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),R=D.length-1;var ee=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){ee=l;break}var re=a.length;if(ee===a.length&&D.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(R>=a[l].v.length-1?(R-=a[l].v.length,a[l].v=D.substr(R+1,a[l].v.length)):R<0?a[l].v="":(a[l].v=D.substr(0,R+1),R=-1),a[l].t="t",re=l);R>=0&&re<a.length&&(a[re].v=D.substr(0,R+1)+a[re].v)}else if(ee!==a.length&&D.indexOf("E")===-1){for(R=D.indexOf(".")-1,l=ee;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===ee?a[l].v.indexOf(".")-1:a[l].v.length-1,K=a[l].v.substr(g+1);g>=0;--g)R>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(K=D.charAt(R--)+K);a[l].v=K,a[l].t="t",re=l}for(R>=0&&re<a.length&&(a[re].v=D.substr(0,R+1)+a[re].v),R=D.indexOf(".")+1,l=ee;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==ee)){for(g=a[l].v.indexOf(".")>-1&&l===ee?a[l].v.indexOf(".")+1:0,K=a[l].v.substr(0,g);g<a[l].v.length;++g)R<D.length&&(K+=D.charAt(R++));a[l].v=K,a[l].t="t",re=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(W=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=ns(a[l].t,a[l].v,W),a[l].t="t");var pe="";for(l=0;l!==a.length;++l)a[l]!=null&&(pe+=a[l].v);return pe}var a1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function i1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function _A(e,t){var r=xA(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(a1),u=r[1].match(a1);return i1(t,l)?[n,r[0]]:i1(t,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,s]}function ma(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:yt)[e],n==null&&(n=r.table&&r.table[t1[e]]||yt[t1[e]]),n==null&&(n=rA[e]||"General");break}if(rh(n,0))return Yo(t,r);t instanceof Date&&(t=h_(t,r.date1904));var a=_A(n,t);if(rh(a[1]))return Yo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return yA(a[1],t,r,a[0])}function Ei(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(yt[r]==null){t<0&&(t=r);continue}if(yt[r]==e){t=r;break}}t<0&&(t=391)}return yt[t]=e,t}function sd(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ei(e[t],t)}function Sc(){yt=tA()}var b_={format:ma,load:Ei,_table:yt,load_table:sd,parse_date_code:Qs,is_date:nl,get_table:function(){return b_._table=yt}},wA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},k_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function bA(e){var t=typeof e=="number"?yt[e]:e;return t=t.replace(k_,"(\\d+)"),new RegExp("^"+t+"$")}function kA(e,t,r){var n=-1,a=-1,s=-1,l=-1,u=-1,m=-1;(t.match(k_)||[]).forEach(function(y,_){var T=parseInt(r[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":n=T;break;case"d":s=T;break;case"h":l=T;break;case"s":m=T;break;case"m":l>=0?u=T:a=T;break}}),m>=0&&u==-1&&a>=0&&(u=a,a=-1);var p=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return l==-1&&u==-1&&m==-1?p:n==-1&&a==-1&&s==-1?g:p+"T"+g}var SA=(function(){var e={};e.version="1.2.0";function t(){for(var D=0,ee=new Array(256),re=0;re!=256;++re)D=re,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,ee[re]=D;return typeof Int32Array<"u"?new Int32Array(ee):ee}var r=t();function n(D){var ee=0,re=0,pe=0,ue=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(pe=0;pe!=256;++pe)ue[pe]=D[pe];for(pe=0;pe!=256;++pe)for(re=D[pe],ee=256+pe;ee<4096;ee+=256)re=ue[ee]=re>>>8^D[re&255];var ce=[];for(pe=1;pe!=16;++pe)ce[pe-1]=typeof Int32Array<"u"?ue.subarray(pe*256,pe*256+256):ue.slice(pe*256,pe*256+256);return ce}var a=n(r),s=a[0],l=a[1],u=a[2],m=a[3],p=a[4],g=a[5],y=a[6],_=a[7],T=a[8],S=a[9],w=a[10],E=a[11],P=a[12],I=a[13],A=a[14];function R(D,ee){for(var re=ee^-1,pe=0,ue=D.length;pe<ue;)re=re>>>8^r[(re^D.charCodeAt(pe++))&255];return~re}function K(D,ee){for(var re=ee^-1,pe=D.length-15,ue=0;ue<pe;)re=A[D[ue++]^re&255]^I[D[ue++]^re>>8&255]^P[D[ue++]^re>>16&255]^E[D[ue++]^re>>>24]^w[D[ue++]]^S[D[ue++]]^T[D[ue++]]^_[D[ue++]]^y[D[ue++]]^g[D[ue++]]^p[D[ue++]]^m[D[ue++]]^u[D[ue++]]^l[D[ue++]]^s[D[ue++]]^r[D[ue++]];for(pe+=15;ue<pe;)re=re>>>8^r[(re^D[ue++])&255];return~re}function W(D,ee){for(var re=ee^-1,pe=0,ue=D.length,ce=0,Ce=0;pe<ue;)ce=D.charCodeAt(pe++),ce<128?re=re>>>8^r[(re^ce)&255]:ce<2048?(re=re>>>8^r[(re^(192|ce>>6&31))&255],re=re>>>8^r[(re^(128|ce&63))&255]):ce>=55296&&ce<57344?(ce=(ce&1023)+64,Ce=D.charCodeAt(pe++)&1023,re=re>>>8^r[(re^(240|ce>>8&7))&255],re=re>>>8^r[(re^(128|ce>>2&63))&255],re=re>>>8^r[(re^(128|Ce>>6&15|(ce&3)<<4))&255],re=re>>>8^r[(re^(128|Ce&63))&255]):(re=re>>>8^r[(re^(224|ce>>12&15))&255],re=re>>>8^r[(re^(128|ce>>6&63))&255],re=re>>>8^r[(re^(128|ce&63))&255]);return~re}return e.table=r,e.bstr=R,e.buf=K,e.str=W,e})(),dt=(function(){var t={};t.version="1.2.1";function r(B,Q){for(var Z=B.split("/"),te=Q.split("/"),ie=0,ae=0,we=Math.min(Z.length,te.length);ie<we;++ie){if(ae=Z[ie].length-te[ie].length)return ae;if(Z[ie]!=te[ie])return Z[ie]<te[ie]?-1:1}return Z.length-te.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var Q=B.lastIndexOf("/");return Q===-1?B:B.slice(0,Q+1)}function a(B){if(B.charAt(B.length-1)=="/")return a(B.slice(0,-1));var Q=B.lastIndexOf("/");return Q===-1?B:B.slice(Q+1)}function s(B,Q){typeof Q=="string"&&(Q=new Date(Q));var Z=Q.getHours();Z=Z<<6|Q.getMinutes(),Z=Z<<5|Q.getSeconds()>>>1,B.write_shift(2,Z);var te=Q.getFullYear()-1980;te=te<<4|Q.getMonth()+1,te=te<<5|Q.getDate(),B.write_shift(2,te)}function l(B){var Q=B.read_shift(2)&65535,Z=B.read_shift(2)&65535,te=new Date,ie=Z&31;Z>>>=5;var ae=Z&15;Z>>>=4,te.setMilliseconds(0),te.setFullYear(Z+1980),te.setMonth(ae-1),te.setDate(ie);var we=Q&31;Q>>>=5;var Te=Q&63;return Q>>>=6,te.setHours(Q),te.setMinutes(Te),te.setSeconds(we<<1),te}function u(B){ln(B,0);for(var Q={},Z=0;B.l<=B.length-4;){var te=B.read_shift(2),ie=B.read_shift(2),ae=B.l+ie,we={};switch(te){case 21589:Z=B.read_shift(1),Z&1&&(we.mtime=B.read_shift(4)),ie>5&&(Z&2&&(we.atime=B.read_shift(4)),Z&4&&(we.ctime=B.read_shift(4))),we.mtime&&(we.mt=new Date(we.mtime*1e3));break}B.l=ae,Q[te]=we}return Q}var m;function p(){return m||(m={})}function g(B,Q){if(B[0]==80&&B[1]==75)return hr(B,Q);if((B[0]|32)==109&&(B[1]|32)==105)return li(B,Q);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var Z=3,te=512,ie=0,ae=0,we=0,Te=0,be=0,ke=[],Ae=B.slice(0,512);ln(Ae,0);var ze=y(Ae);switch(Z=ze[0],Z){case 3:te=512;break;case 4:te=4096;break;case 0:if(ze[1]==0)return hr(B,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}te!==512&&(Ae=B.slice(0,te),ln(Ae,28));var qe=B.slice(0,te);_(Ae,Z);var nt=Ae.read_shift(4,"i");if(Z===3&&nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nt);Ae.l+=4,we=Ae.read_shift(4,"i"),Ae.l+=4,Ae.chk("00100000","Mini Stream Cutoff Size: "),Te=Ae.read_shift(4,"i"),ie=Ae.read_shift(4,"i"),be=Ae.read_shift(4,"i"),ae=Ae.read_shift(4,"i");for(var Ze=-1,Ve=0;Ve<109&&(Ze=Ae.read_shift(4,"i"),!(Ze<0));++Ve)ke[Ve]=Ze;var St=T(B,te);E(be,ae,St,te,ke);var Zt=I(St,we,ke,te);Zt[we].name="!Directory",ie>0&&Te!==Ce&&(Zt[Te].name="!MiniFAT"),Zt[ke[0]].name="!FAT",Zt.fat_addrs=ke,Zt.ssz=te;var Qt={},gr=[],za=[],Mn=[];A(we,Zt,St,gr,ie,Qt,za,Te),S(za,Mn,gr),gr.shift();var Jn={FileIndex:za,FullPaths:Mn};return Q&&Q.raw&&(Jn.raw={header:qe,sectors:St}),Jn}function y(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(ye,"Header Signature: "),B.l+=16;var Q=B.read_shift(2,"u");return[B.read_shift(2,"u"),Q]}function _(B,Q){var Z=9;switch(B.l+=2,Z=B.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function T(B,Q){for(var Z=Math.ceil(B.length/Q)-1,te=[],ie=1;ie<Z;++ie)te[ie-1]=B.slice(ie*Q,(ie+1)*Q);return te[Z-1]=B.slice(Z*Q),te}function S(B,Q,Z){for(var te=0,ie=0,ae=0,we=0,Te=0,be=Z.length,ke=[],Ae=[];te<be;++te)ke[te]=Ae[te]=te,Q[te]=Z[te];for(;Te<Ae.length;++Te)te=Ae[Te],ie=B[te].L,ae=B[te].R,we=B[te].C,ke[te]===te&&(ie!==-1&&ke[ie]!==ie&&(ke[te]=ke[ie]),ae!==-1&&ke[ae]!==ae&&(ke[te]=ke[ae])),we!==-1&&(ke[we]=te),ie!==-1&&te!=ke[te]&&(ke[ie]=ke[te],Ae.lastIndexOf(ie)<Te&&Ae.push(ie)),ae!==-1&&te!=ke[te]&&(ke[ae]=ke[te],Ae.lastIndexOf(ae)<Te&&Ae.push(ae));for(te=1;te<be;++te)ke[te]===te&&(ae!==-1&&ke[ae]!==ae?ke[te]=ke[ae]:ie!==-1&&ke[ie]!==ie&&(ke[te]=ke[ie]));for(te=1;te<be;++te)if(B[te].type!==0){if(Te=te,Te!=ke[Te])do Te=ke[Te],Q[te]=Q[Te]+"/"+Q[te];while(Te!==0&&ke[Te]!==-1&&Te!=ke[Te]);ke[te]=-1}for(Q[0]+="/",te=1;te<be;++te)B[te].type!==2&&(Q[te]+="/")}function w(B,Q,Z){for(var te=B.start,ie=B.size,ae=[],we=te;Z&&ie>0&&we>=0;)ae.push(Q.slice(we*ce,we*ce+ce)),ie-=ce,we=Uo(Z,we*4);return ae.length===0?Fe(0):tn(ae).slice(0,B.size)}function E(B,Q,Z,te,ie){var ae=Ce;if(B===Ce){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var we=Z[B],Te=(te>>>2)-1;if(!we)return;for(var be=0;be<Te&&(ae=Uo(we,be*4))!==Ce;++be)ie.push(ae);E(Uo(we,te-4),Q-1,Z,te,ie)}}function P(B,Q,Z,te,ie){var ae=[],we=[];ie||(ie=[]);var Te=te-1,be=0,ke=0;for(be=Q;be>=0;){ie[be]=!0,ae[ae.length]=be,we.push(B[be]);var Ae=Z[Math.floor(be*4/te)];if(ke=be*4&Te,te<4+ke)throw new Error("FAT boundary crossed: "+be+" 4 "+te);if(!B[Ae])break;be=Uo(B[Ae],ke)}return{nodes:ae,data:v1([we])}}function I(B,Q,Z,te){var ie=B.length,ae=[],we=[],Te=[],be=[],ke=te-1,Ae=0,ze=0,qe=0,nt=0;for(Ae=0;Ae<ie;++Ae)if(Te=[],qe=Ae+Q,qe>=ie&&(qe-=ie),!we[qe]){be=[];var Ze=[];for(ze=qe;ze>=0;){Ze[ze]=!0,we[ze]=!0,Te[Te.length]=ze,be.push(B[ze]);var Ve=Z[Math.floor(ze*4/te)];if(nt=ze*4&ke,te<4+nt)throw new Error("FAT boundary crossed: "+ze+" 4 "+te);if(!B[Ve]||(ze=Uo(B[Ve],nt),Ze[ze]))break}ae[qe]={nodes:Te,data:v1([be])}}return ae}function A(B,Q,Z,te,ie,ae,we,Te){for(var be=0,ke=te.length?2:0,Ae=Q[B].data,ze=0,qe=0,nt;ze<Ae.length;ze+=128){var Ze=Ae.slice(ze,ze+128);ln(Ze,64),qe=Ze.read_shift(2),nt=Th(Ze,0,qe-ke),te.push(nt);var Ve={name:nt,type:Ze.read_shift(1),color:Ze.read_shift(1),L:Ze.read_shift(4,"i"),R:Ze.read_shift(4,"i"),C:Ze.read_shift(4,"i"),clsid:Ze.read_shift(16),state:Ze.read_shift(4,"i"),start:0,size:0},St=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);St!==0&&(Ve.ct=R(Ze,Ze.l-8));var Zt=Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2)+Ze.read_shift(2);Zt!==0&&(Ve.mt=R(Ze,Ze.l-8)),Ve.start=Ze.read_shift(4,"i"),Ve.size=Ze.read_shift(4,"i"),Ve.size<0&&Ve.start<0&&(Ve.size=Ve.type=0,Ve.start=Ce,Ve.name=""),Ve.type===5?(be=Ve.start,ie>0&&be!==Ce&&(Q[be].name="!StreamData")):Ve.size>=4096?(Ve.storage="fat",Q[Ve.start]===void 0&&(Q[Ve.start]=P(Z,Ve.start,Q.fat_addrs,Q.ssz)),Q[Ve.start].name=Ve.name,Ve.content=Q[Ve.start].data.slice(0,Ve.size)):(Ve.storage="minifat",Ve.size<0?Ve.size=0:be!==Ce&&Ve.start!==Ce&&Q[be]&&(Ve.content=w(Ve,Q[be].data,(Q[Te]||{}).data))),Ve.content&&ln(Ve.content,0),ae[nt]=Ve,we.push(Ve)}}function R(B,Q){return new Date((en(B,Q+4)/1e7*Math.pow(2,32)+en(B,Q)/1e7-11644473600)*1e3)}function K(B,Q){return p(),g(m.readFileSync(B),Q)}function W(B,Q){var Z=Q&&Q.type;switch(Z||Dt&&Buffer.isBuffer(B)&&(Z="buffer"),Z||"base64"){case"file":return K(B,Q);case"base64":return g(ua(ha(B)),Q);case"binary":return g(ua(B),Q)}return g(B,Q)}function D(B,Q){var Z=Q||{},te=Z.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=te+"/",B.FileIndex[0]={name:te,type:5}),Z.CLSID&&(B.FileIndex[0].clsid=Z.CLSID),ee(B)}function ee(B){var Q="Sh33tJ5";if(!dt.find(B,"/"+Q)){var Z=Fe(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,B.FileIndex.push({name:Q,type:2,content:Z,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+Q),re(B)}}function re(B,Q){D(B);for(var Z=!1,te=!1,ie=B.FullPaths.length-1;ie>=0;--ie){var ae=B.FileIndex[ie];switch(ae.type){case 0:te?Z=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(ae.R*ae.L*ae.C)&&(Z=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!Q)){var we=new Date(1987,1,19),Te=0,be=Object.create?Object.create(null):{},ke=[];for(ie=0;ie<B.FullPaths.length;++ie)be[B.FullPaths[ie]]=!0,B.FileIndex[ie].type!==0&&ke.push([B.FullPaths[ie],B.FileIndex[ie]]);for(ie=0;ie<ke.length;++ie){var Ae=n(ke[ie][0]);te=be[Ae],te||(ke.push([Ae,{name:a(Ae).replace("/",""),type:1,clsid:le,ct:we,mt:we,content:null}]),be[Ae]=!0)}for(ke.sort(function(nt,Ze){return r(nt[0],Ze[0])}),B.FullPaths=[],B.FileIndex=[],ie=0;ie<ke.length;++ie)B.FullPaths[ie]=ke[ie][0],B.FileIndex[ie]=ke[ie][1];for(ie=0;ie<ke.length;++ie){var ze=B.FileIndex[ie],qe=B.FullPaths[ie];if(ze.name=a(qe).replace("/",""),ze.L=ze.R=ze.C=-(ze.color=1),ze.size=ze.content?ze.content.length:0,ze.start=0,ze.clsid=ze.clsid||le,ie===0)ze.C=ke.length>1?1:-1,ze.size=0,ze.type=5;else if(qe.slice(-1)=="/"){for(Te=ie+1;Te<ke.length&&n(B.FullPaths[Te])!=qe;++Te);for(ze.C=Te>=ke.length?-1:Te,Te=ie+1;Te<ke.length&&n(B.FullPaths[Te])!=n(qe);++Te);ze.R=Te>=ke.length?-1:Te,ze.type=1}else n(B.FullPaths[ie+1]||"")==n(qe)&&(ze.R=ie+1),ze.type=2}}}function pe(B,Q){var Z=Q||{};if(Z.fileType=="mad")return Ba(B,Z);switch(re(B),Z.fileType){case"zip":return An(B,Z)}var te=(function(nt){for(var Ze=0,Ve=0,St=0;St<nt.FileIndex.length;++St){var Zt=nt.FileIndex[St];if(Zt.content){var Qt=Zt.content.length;Qt>0&&(Qt<4096?Ze+=Qt+63>>6:Ve+=Qt+511>>9)}}for(var gr=nt.FullPaths.length+3>>2,za=Ze+7>>3,Mn=Ze+127>>7,Jn=za+Ve+gr+Mn,Nr=Jn+127>>7,Ua=Nr<=109?0:Math.ceil((Nr-109)/127);Jn+Nr+Ua+127>>7>Nr;)Ua=++Nr<=109?0:Math.ceil((Nr-109)/127);var mt=[1,Ua,Nr,Mn,gr,Ve,Ze,0];return nt.FileIndex[0].size=Ze<<6,mt[7]=(nt.FileIndex[0].start=mt[0]+mt[1]+mt[2]+mt[3]+mt[4]+mt[5])+(mt[6]+7>>3),mt})(B),ie=Fe(te[7]<<9),ae=0,we=0;{for(ae=0;ae<8;++ae)ie.write_shift(1,he[ae]);for(ae=0;ae<8;++ae)ie.write_shift(2,0);for(ie.write_shift(2,62),ie.write_shift(2,3),ie.write_shift(2,65534),ie.write_shift(2,9),ie.write_shift(2,6),ae=0;ae<3;++ae)ie.write_shift(2,0);for(ie.write_shift(4,0),ie.write_shift(4,te[2]),ie.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),ie.write_shift(4,0),ie.write_shift(4,4096),ie.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:Ce),ie.write_shift(4,te[3]),ie.write_shift(-4,te[1]?te[0]-1:Ce),ie.write_shift(4,te[1]),ae=0;ae<109;++ae)ie.write_shift(-4,ae<te[2]?te[1]+ae:-1)}if(te[1])for(we=0;we<te[1];++we){for(;ae<236+we*127;++ae)ie.write_shift(-4,ae<te[2]?te[1]+ae:-1);ie.write_shift(-4,we===te[1]-1?Ce:we+1)}var Te=function(nt){for(we+=nt;ae<we-1;++ae)ie.write_shift(-4,ae+1);nt&&(++ae,ie.write_shift(-4,Ce))};for(we=ae=0,we+=te[1];ae<we;++ae)ie.write_shift(-4,j.DIFSECT);for(we+=te[2];ae<we;++ae)ie.write_shift(-4,j.FATSECT);Te(te[3]),Te(te[4]);for(var be=0,ke=0,Ae=B.FileIndex[0];be<B.FileIndex.length;++be)Ae=B.FileIndex[be],Ae.content&&(ke=Ae.content.length,!(ke<4096)&&(Ae.start=we,Te(ke+511>>9)));for(Te(te[6]+7>>3);ie.l&511;)ie.write_shift(-4,j.ENDOFCHAIN);for(we=ae=0,be=0;be<B.FileIndex.length;++be)Ae=B.FileIndex[be],Ae.content&&(ke=Ae.content.length,!(!ke||ke>=4096)&&(Ae.start=we,Te(ke+63>>6)));for(;ie.l&511;)ie.write_shift(-4,j.ENDOFCHAIN);for(ae=0;ae<te[4]<<2;++ae){var ze=B.FullPaths[ae];if(!ze||ze.length===0){for(be=0;be<17;++be)ie.write_shift(4,0);for(be=0;be<3;++be)ie.write_shift(4,-1);for(be=0;be<12;++be)ie.write_shift(4,0);continue}Ae=B.FileIndex[ae],ae===0&&(Ae.start=Ae.size?Ae.start-1:Ce);var qe=ae===0&&Z.root||Ae.name;if(ke=2*(qe.length+1),ie.write_shift(64,qe,"utf16le"),ie.write_shift(2,ke),ie.write_shift(1,Ae.type),ie.write_shift(1,Ae.color),ie.write_shift(-4,Ae.L),ie.write_shift(-4,Ae.R),ie.write_shift(-4,Ae.C),Ae.clsid)ie.write_shift(16,Ae.clsid,"hex");else for(be=0;be<4;++be)ie.write_shift(4,0);ie.write_shift(4,Ae.state||0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,Ae.start),ie.write_shift(4,Ae.size),ie.write_shift(4,0)}for(ae=1;ae<B.FileIndex.length;++ae)if(Ae=B.FileIndex[ae],Ae.size>=4096)if(ie.l=Ae.start+1<<9,Dt&&Buffer.isBuffer(Ae.content))Ae.content.copy(ie,ie.l,0,Ae.size),ie.l+=Ae.size+511&-512;else{for(be=0;be<Ae.size;++be)ie.write_shift(1,Ae.content[be]);for(;be&511;++be)ie.write_shift(1,0)}for(ae=1;ae<B.FileIndex.length;++ae)if(Ae=B.FileIndex[ae],Ae.size>0&&Ae.size<4096)if(Dt&&Buffer.isBuffer(Ae.content))Ae.content.copy(ie,ie.l,0,Ae.size),ie.l+=Ae.size+63&-64;else{for(be=0;be<Ae.size;++be)ie.write_shift(1,Ae.content[be]);for(;be&63;++be)ie.write_shift(1,0)}if(Dt)ie.l=ie.length;else for(;ie.l<ie.length;)ie.write_shift(1,0);return ie}function ue(B,Q){var Z=B.FullPaths.map(function(be){return be.toUpperCase()}),te=Z.map(function(be){var ke=be.split("/");return ke[ke.length-(be.slice(-1)=="/"?2:1)]}),ie=!1;Q.charCodeAt(0)===47?(ie=!0,Q=Z[0].slice(0,-1)+Q):ie=Q.indexOf("/")!==-1;var ae=Q.toUpperCase(),we=ie===!0?Z.indexOf(ae):te.indexOf(ae);if(we!==-1)return B.FileIndex[we];var Te=!ae.match(ku);for(ae=ae.replace(kn,""),Te&&(ae=ae.replace(ku,"!")),we=0;we<Z.length;++we)if((Te?Z[we].replace(ku,"!"):Z[we]).replace(kn,"")==ae||(Te?te[we].replace(ku,"!"):te[we]).replace(kn,"")==ae)return B.FileIndex[we];return null}var ce=64,Ce=-2,ye="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],le="00000000000000000000000000000000",j={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ce,FREESECT:-1,HEADER_SIGNATURE:ye,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:le,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function H(B,Q,Z){p();var te=pe(B,Z);m.writeFileSync(Q,te)}function O(B){for(var Q=new Array(B.length),Z=0;Z<B.length;++Z)Q[Z]=String.fromCharCode(B[Z]);return Q.join("")}function ne(B,Q){var Z=pe(B,Q);switch(Q&&Q.type||"buffer"){case"file":return p(),m.writeFileSync(Q.filename,Z),Z;case"binary":return typeof Z=="string"?Z:O(Z);case"base64":return $u(typeof Z=="string"?Z:O(Z));case"buffer":if(Dt)return Buffer.isBuffer(Z)?Z:is(Z);case"array":return typeof Z=="string"?ua(Z):Z}return Z}var Y;function F(B){try{var Q=B.InflateRaw,Z=new Q;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)Y=B;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function U(B,Q){if(!Y)return La(B,Q);var Z=Y.InflateRaw,te=new Z,ie=te._processChunk(B.slice(B.l),te._finishFlushFlag);return B.l+=te.bytesRead,ie}function z(B){return Y?Y.deflateRawSync(B):ht(B)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],oe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(B){var Q=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var fe=typeof Uint8Array<"u",xe=fe?new Uint8Array(256):[],je=0;je<256;++je)xe[je]=se(je);function X(B,Q){var Z=xe[B&255];return Q<=8?Z>>>8-Q:(Z=Z<<8|xe[B>>8&255],Q<=16?Z>>>16-Q:(Z=Z<<8|xe[B>>16&255],Z>>>24-Q))}function Ke(B,Q){var Z=Q&7,te=Q>>>3;return(B[te]|(Z<=6?0:B[te+1]<<8))>>>Z&3}function Xe(B,Q){var Z=Q&7,te=Q>>>3;return(B[te]|(Z<=5?0:B[te+1]<<8))>>>Z&7}function Qe(B,Q){var Z=Q&7,te=Q>>>3;return(B[te]|(Z<=4?0:B[te+1]<<8))>>>Z&15}function it(B,Q){var Z=Q&7,te=Q>>>3;return(B[te]|(Z<=3?0:B[te+1]<<8))>>>Z&31}function Le(B,Q){var Z=Q&7,te=Q>>>3;return(B[te]|(Z<=1?0:B[te+1]<<8))>>>Z&127}function kt(B,Q,Z){var te=Q&7,ie=Q>>>3,ae=(1<<Z)-1,we=B[ie]>>>te;return Z<8-te||(we|=B[ie+1]<<8-te,Z<16-te)||(we|=B[ie+2]<<16-te,Z<24-te)||(we|=B[ie+3]<<24-te),we&ae}function ft(B,Q,Z){var te=Q&7,ie=Q>>>3;return te<=5?B[ie]|=(Z&7)<<te:(B[ie]|=Z<<te&255,B[ie+1]=(Z&7)>>8-te),Q+3}function pt(B,Q,Z){var te=Q&7,ie=Q>>>3;return Z=(Z&1)<<te,B[ie]|=Z,Q+1}function Gt(B,Q,Z){var te=Q&7,ie=Q>>>3;return Z<<=te,B[ie]|=Z&255,Z>>>=8,B[ie+1]=Z,Q+8}function Cn(B,Q,Z){var te=Q&7,ie=Q>>>3;return Z<<=te,B[ie]|=Z&255,Z>>>=8,B[ie+1]=Z&255,B[ie+2]=Z>>>8,Q+16}function zr(B,Q){var Z=B.length,te=2*Z>Q?2*Z:Q+5,ie=0;if(Z>=Q)return B;if(Dt){var ae=Jx(te);if(B.copy)B.copy(ae);else for(;ie<B.length;++ie)ae[ie]=B[ie];return ae}else if(fe){var we=new Uint8Array(te);if(we.set)we.set(B);else for(;ie<Z;++ie)we[ie]=B[ie];return we}return B.length=te,B}function Cr(B){for(var Q=new Array(B),Z=0;Z<B;++Z)Q[Z]=0;return Q}function un(B,Q,Z){var te=1,ie=0,ae=0,we=0,Te=0,be=B.length,ke=fe?new Uint16Array(32):Cr(32);for(ae=0;ae<32;++ae)ke[ae]=0;for(ae=be;ae<Z;++ae)B[ae]=0;be=B.length;var Ae=fe?new Uint16Array(be):Cr(be);for(ae=0;ae<be;++ae)ke[ie=B[ae]]++,te<ie&&(te=ie),Ae[ae]=0;for(ke[0]=0,ae=1;ae<=te;++ae)ke[ae+16]=Te=Te+ke[ae-1]<<1;for(ae=0;ae<be;++ae)Te=B[ae],Te!=0&&(Ae[ae]=ke[Te+16]++);var ze=0;for(ae=0;ae<be;++ae)if(ze=B[ae],ze!=0)for(Te=X(Ae[ae],te)>>te-ze,we=(1<<te+4-ze)-1;we>=0;--we)Q[Te|we<<ze]=ze&15|ae<<4;return te}var Fr=fe?new Uint16Array(512):Cr(512),nn=fe?new Uint16Array(32):Cr(32);if(!fe){for(var Jt=0;Jt<512;++Jt)Fr[Jt]=0;for(Jt=0;Jt<32;++Jt)nn[Jt]=0}(function(){for(var B=[],Q=0;Q<32;Q++)B.push(5);un(B,nn,32);var Z=[];for(Q=0;Q<=143;Q++)Z.push(8);for(;Q<=255;Q++)Z.push(9);for(;Q<=279;Q++)Z.push(7);for(;Q<=287;Q++)Z.push(8);un(Z,Fr,288)})();var Ar=(function(){for(var Q=fe?new Uint8Array(32768):[],Z=0,te=0;Z<oe.length-1;++Z)for(;te<oe[Z+1];++te)Q[te]=Z;for(;te<32768;++te)Q[te]=29;var ie=fe?new Uint8Array(259):[];for(Z=0,te=0;Z<M.length-1;++Z)for(;te<M[Z+1];++te)ie[te]=Z;function ae(Te,be){for(var ke=0;ke<Te.length;){var Ae=Math.min(65535,Te.length-ke),ze=ke+Ae==Te.length;for(be.write_shift(1,+ze),be.write_shift(2,Ae),be.write_shift(2,~Ae&65535);Ae-- >0;)be[be.l++]=Te[ke++]}return be.l}function we(Te,be){for(var ke=0,Ae=0,ze=fe?new Uint16Array(32768):[];Ae<Te.length;){var qe=Math.min(65535,Te.length-Ae);if(qe<10){for(ke=ft(be,ke,+(Ae+qe==Te.length)),ke&7&&(ke+=8-(ke&7)),be.l=ke/8|0,be.write_shift(2,qe),be.write_shift(2,~qe&65535);qe-- >0;)be[be.l++]=Te[Ae++];ke=be.l*8;continue}ke=ft(be,ke,+(Ae+qe==Te.length)+2);for(var nt=0;qe-- >0;){var Ze=Te[Ae];nt=(nt<<5^Ze)&32767;var Ve=-1,St=0;if((Ve=ze[nt])&&(Ve|=Ae&-32768,Ve>Ae&&(Ve-=32768),Ve<Ae))for(;Te[Ve+St]==Te[Ae+St]&&St<250;)++St;if(St>2){Ze=ie[St],Ze<=22?ke=Gt(be,ke,xe[Ze+1]>>1)-1:(Gt(be,ke,3),ke+=5,Gt(be,ke,xe[Ze-23]>>5),ke+=3);var Zt=Ze<8?0:Ze-4>>2;Zt>0&&(Cn(be,ke,St-M[Ze]),ke+=Zt),Ze=Q[Ae-Ve],ke=Gt(be,ke,xe[Ze]>>3),ke-=3;var Qt=Ze<4?0:Ze-2>>1;Qt>0&&(Cn(be,ke,Ae-Ve-oe[Ze]),ke+=Qt);for(var gr=0;gr<St;++gr)ze[nt]=Ae&32767,nt=(nt<<5^Te[Ae])&32767,++Ae;qe-=St-1}else Ze<=143?Ze=Ze+48:ke=pt(be,ke,1),ke=Gt(be,ke,xe[Ze]),ze[nt]=Ae&32767,++Ae}ke=Gt(be,ke,0)-1}return be.l=(ke+7)/8|0,be.l}return function(be,ke){return be.length<8?ae(be,ke):we(be,ke)}})();function ht(B){var Q=Fe(50+Math.floor(B.length*1.1)),Z=Ar(B,Q);return Q.slice(0,Z)}var Ct=fe?new Uint16Array(32768):Cr(32768),pr=fe?new Uint16Array(32768):Cr(32768),Ht=fe?new Uint16Array(128):Cr(128),ct=1,oi=1;function Ii(B,Q){var Z=it(B,Q)+257;Q+=5;var te=it(B,Q)+1;Q+=5;var ie=Qe(B,Q)+4;Q+=4;for(var ae=0,we=fe?new Uint8Array(19):Cr(19),Te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],be=1,ke=fe?new Uint8Array(8):Cr(8),Ae=fe?new Uint8Array(8):Cr(8),ze=we.length,qe=0;qe<ie;++qe)we[q[qe]]=ae=Xe(B,Q),be<ae&&(be=ae),ke[ae]++,Q+=3;var nt=0;for(ke[0]=0,qe=1;qe<=be;++qe)Ae[qe]=nt=nt+ke[qe-1]<<1;for(qe=0;qe<ze;++qe)(nt=we[qe])!=0&&(Te[qe]=Ae[nt]++);var Ze=0;for(qe=0;qe<ze;++qe)if(Ze=we[qe],Ze!=0){nt=xe[Te[qe]]>>8-Ze;for(var Ve=(1<<7-Ze)-1;Ve>=0;--Ve)Ht[nt|Ve<<Ze]=Ze&7|qe<<3}var St=[];for(be=1;St.length<Z+te;)switch(nt=Ht[Le(B,Q)],Q+=nt&7,nt>>>=3){case 16:for(ae=3+Ke(B,Q),Q+=2,nt=St[St.length-1];ae-- >0;)St.push(nt);break;case 17:for(ae=3+Xe(B,Q),Q+=3;ae-- >0;)St.push(0);break;case 18:for(ae=11+Le(B,Q),Q+=7;ae-- >0;)St.push(0);break;default:St.push(nt),be<nt&&(be=nt);break}var Zt=St.slice(0,Z),Qt=St.slice(Z);for(qe=Z;qe<286;++qe)Zt[qe]=0;for(qe=te;qe<30;++qe)Qt[qe]=0;return ct=un(Zt,Ct,286),oi=un(Qt,pr,30),Q}function Yn(B,Q){if(B[0]==3&&!(B[1]&3))return[ro(Q),2];for(var Z=0,te=0,ie=Jx(Q||1<<18),ae=0,we=ie.length>>>0,Te=0,be=0;(te&1)==0;){if(te=Xe(B,Z),Z+=3,te>>>1)te>>1==1?(Te=9,be=5):(Z=Ii(B,Z),Te=ct,be=oi);else{Z&7&&(Z+=8-(Z&7));var ke=B[Z>>>3]|B[(Z>>>3)+1]<<8;if(Z+=32,ke>0)for(!Q&&we<ae+ke&&(ie=zr(ie,ae+ke),we=ie.length);ke-- >0;)ie[ae++]=B[Z>>>3],Z+=8;continue}for(;;){!Q&&we<ae+32767&&(ie=zr(ie,ae+32767),we=ie.length);var Ae=kt(B,Z,Te),ze=te>>>1==1?Fr[Ae]:Ct[Ae];if(Z+=ze&15,ze>>>=4,(ze>>>8&255)===0)ie[ae++]=ze;else{if(ze==256)break;ze-=257;var qe=ze<8?0:ze-4>>2;qe>5&&(qe=0);var nt=ae+M[ze];qe>0&&(nt+=kt(B,Z,qe),Z+=qe),Ae=kt(B,Z,be),ze=te>>>1==1?nn[Ae]:pr[Ae],Z+=ze&15,ze>>>=4;var Ze=ze<4?0:ze-2>>1,Ve=oe[ze];for(Ze>0&&(Ve+=kt(B,Z,Ze),Z+=Ze),!Q&&we<nt&&(ie=zr(ie,nt+100),we=ie.length);ae<nt;)ie[ae]=ie[ae-Ve],++ae}}}return Q?[ie,Z+7>>>3]:[ie.slice(0,ae),Z+7>>>3]}function La(B,Q){var Z=B.slice(B.l||0),te=Yn(Z,Q);return B.l+=te[1],te[0]}function qn(B,Q){if(B)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function hr(B,Q){var Z=B;ln(Z,0);var te=[],ie=[],ae={FileIndex:te,FullPaths:ie};D(ae,{root:Q.root});for(var we=Z.length-4;(Z[we]!=80||Z[we+1]!=75||Z[we+2]!=5||Z[we+3]!=6)&&we>=0;)--we;Z.l=we+4,Z.l+=4;var Te=Z.read_shift(2);Z.l+=6;var be=Z.read_shift(4);for(Z.l=be,we=0;we<Te;++we){Z.l+=20;var ke=Z.read_shift(4),Ae=Z.read_shift(4),ze=Z.read_shift(2),qe=Z.read_shift(2),nt=Z.read_shift(2);Z.l+=8;var Ze=Z.read_shift(4),Ve=u(Z.slice(Z.l+ze,Z.l+ze+qe));Z.l+=ze+qe+nt;var St=Z.l;Z.l=Ze+4,Xn(Z,ke,Ae,ae,Ve),Z.l=St}return ae}function Xn(B,Q,Z,te,ie){B.l+=2;var ae=B.read_shift(2),we=B.read_shift(2),Te=l(B);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var be=B.read_shift(4),ke=B.read_shift(4),Ae=B.read_shift(4),ze=B.read_shift(2),qe=B.read_shift(2),nt="",Ze=0;Ze<ze;++Ze)nt+=String.fromCharCode(B[B.l++]);if(qe){var Ve=u(B.slice(B.l,B.l+qe));(Ve[21589]||{}).mt&&(Te=Ve[21589].mt),((ie||{})[21589]||{}).mt&&(Te=ie[21589].mt)}B.l+=qe;var St=B.slice(B.l,B.l+ke);switch(we){case 8:St=U(B,Ae);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+we)}var Zt=!1;ae&8&&(be=B.read_shift(4),be==134695760&&(be=B.read_shift(4),Zt=!0),ke=B.read_shift(4),Ae=B.read_shift(4)),ke!=Q&&qn(Zt,"Bad compressed size: "+Q+" != "+ke),Ae!=Z&&qn(Zt,"Bad uncompressed size: "+Z+" != "+Ae),He(te,nt,St,{unsafe:!0,mt:Te})}function An(B,Q){var Z=Q||{},te=[],ie=[],ae=Fe(1),we=Z.compression?8:0,Te=0,be=0,ke=0,Ae=0,ze=0,qe=B.FullPaths[0],nt=qe,Ze=B.FileIndex[0],Ve=[],St=0;for(be=1;be<B.FullPaths.length;++be)if(nt=B.FullPaths[be].slice(qe.length),Ze=B.FileIndex[be],!(!Ze.size||!Ze.content||nt=="Sh33tJ5")){var Zt=Ae,Qt=Fe(nt.length);for(ke=0;ke<nt.length;++ke)Qt.write_shift(1,nt.charCodeAt(ke)&127);Qt=Qt.slice(0,Qt.l),Ve[ze]=SA.buf(Ze.content,0);var gr=Ze.content;we==8&&(gr=z(gr)),ae=Fe(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,Te),ae.write_shift(2,we),Ze.mt?s(ae,Ze.mt):ae.write_shift(4,0),ae.write_shift(-4,Ve[ze]),ae.write_shift(4,gr.length),ae.write_shift(4,Ze.content.length),ae.write_shift(2,Qt.length),ae.write_shift(2,0),Ae+=ae.length,te.push(ae),Ae+=Qt.length,te.push(Qt),Ae+=gr.length,te.push(gr),ae=Fe(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,Te),ae.write_shift(2,we),ae.write_shift(4,0),ae.write_shift(-4,Ve[ze]),ae.write_shift(4,gr.length),ae.write_shift(4,Ze.content.length),ae.write_shift(2,Qt.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,Zt),St+=ae.l,ie.push(ae),St+=Qt.length,ie.push(Qt),++ze}return ae=Fe(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,ze),ae.write_shift(2,ze),ae.write_shift(4,St),ae.write_shift(4,Ae),ae.write_shift(2,0),tn([tn(te),tn(ie),ae])}var Ma={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ls(B,Q){if(B.ctype)return B.ctype;var Z=B.name||"",te=Z.match(/\.([^\.]+)$/);return te&&Ma[te[1]]||Q&&(te=(Z=Q).match(/[\.\\]([^\.\\])+$/),te&&Ma[te[1]])?Ma[te[1]]:"application/octet-stream"}function cs(B){for(var Q=$u(B),Z=[],te=0;te<Q.length;te+=76)Z.push(Q.slice(te,te+76));return Z.join(`\r
`)+`\r
`}function us(B){var Q=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ke){var Ae=ke.charCodeAt(0).toString(16).toUpperCase();return"="+(Ae.length==1?"0"+Ae:Ae)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],te=Q.split(`\r
`),ie=0;ie<te.length;++ie){var ae=te[ie];if(ae.length==0){Z.push("");continue}for(var we=0;we<ae.length;){var Te=76,be=ae.slice(we,we+Te);be.charAt(Te-1)=="="?Te--:be.charAt(Te-2)=="="?Te-=2:be.charAt(Te-3)=="="&&(Te-=3),be=ae.slice(we,we+Te),we+=Te,we<ae.length&&(be+="="),Z.push(be)}}return Z.join(`\r
`)}function ds(B){for(var Q=[],Z=0;Z<B.length;++Z){for(var te=B[Z];Z<=B.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+B[++Z];Q.push(te)}for(var ie=0;ie<Q.length;++ie)Q[ie]=Q[ie].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return ua(Q.join(`\r
`))}function Di(B,Q,Z){for(var te="",ie="",ae="",we,Te=0;Te<10;++Te){var be=Q[Te];if(!be||be.match(/^\s*$/))break;var ke=be.match(/^(.*?):\s*([^\s].*)$/);if(ke)switch(ke[1].toLowerCase()){case"content-location":te=ke[2].trim();break;case"content-type":ae=ke[2].trim();break;case"content-transfer-encoding":ie=ke[2].trim();break}}switch(++Te,ie.toLowerCase()){case"base64":we=ua(ha(Q.slice(Te).join("")));break;case"quoted-printable":we=ds(Q.slice(Te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ie)}var Ae=He(B,te.slice(Z.length),we,{unsafe:!0});ae&&(Ae.ctype=ae)}function li(B,Q){if(O(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=Q&&Q.root||"",te=(Dt&&Buffer.isBuffer(B)?B.toString("binary"):O(B)).split(`\r
`),ie=0,ae="";for(ie=0;ie<te.length;++ie)if(ae=te[ie],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),Z||(Z=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),ae.slice(0,Z.length)!=Z););var we=(te[1]||"").match(/boundary="(.*?)"/);if(!we)throw new Error("MAD cannot find boundary");var Te="--"+(we[1]||""),be=[],ke=[],Ae={FileIndex:be,FullPaths:ke};D(Ae);var ze,qe=0;for(ie=0;ie<te.length;++ie){var nt=te[ie];nt!==Te&&nt!==Te+"--"||(qe++&&Di(Ae,te.slice(ze,ie),Z),ze=ie)}return Ae}function Ba(B,Q){var Z=Q||{},te=Z.boundary||"SheetJS";te="------="+te;for(var ie=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],ae=B.FullPaths[0],we=ae,Te=B.FileIndex[0],be=1;be<B.FullPaths.length;++be)if(we=B.FullPaths[be].slice(ae.length),Te=B.FileIndex[be],!(!Te.size||!Te.content||we=="Sh33tJ5")){we=we.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(St){return"_x"+St.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(St){return"_u"+St.charCodeAt(0).toString(16)+"_"});for(var ke=Te.content,Ae=Dt&&Buffer.isBuffer(ke)?ke.toString("binary"):O(ke),ze=0,qe=Math.min(1024,Ae.length),nt=0,Ze=0;Ze<=qe;++Ze)(nt=Ae.charCodeAt(Ze))>=32&&nt<128&&++ze;var Ve=ze>=qe*4/5;ie.push(te),ie.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+we),ie.push("Content-Transfer-Encoding: "+(Ve?"quoted-printable":"base64")),ie.push("Content-Type: "+ls(Te,we)),ie.push(""),ie.push(Ve?us(Ae):cs(Ae))}return ie.push(te+`--\r
`),ie.join(`\r
`)}function De(B){var Q={};return D(Q,B),Q}function He(B,Q,Z,te){var ie=te&&te.unsafe;ie||D(B);var ae=!ie&&dt.find(B,Q);if(!ae){var we=B.FullPaths[0];Q.slice(0,we.length)==we?we=Q:(we.slice(-1)!="/"&&(we+="/"),we=(we+Q).replace("//","/")),ae={name:a(Q),type:2},B.FileIndex.push(ae),B.FullPaths.push(we),ie||dt.utils.cfb_gc(B)}return ae.content=Z,ae.size=Z?Z.length:0,te&&(te.CLSID&&(ae.clsid=te.CLSID),te.mt&&(ae.mt=te.mt),te.ct&&(ae.ct=te.ct)),ae}function tt(B,Q){D(B);var Z=dt.find(B,Q);if(Z){for(var te=0;te<B.FileIndex.length;++te)if(B.FileIndex[te]==Z)return B.FileIndex.splice(te,1),B.FullPaths.splice(te,1),!0}return!1}function Ge(B,Q,Z){D(B);var te=dt.find(B,Q);if(te){for(var ie=0;ie<B.FileIndex.length;++ie)if(B.FileIndex[ie]==te)return B.FileIndex[ie].name=a(Z),B.FullPaths[ie]=Z,!0}return!1}function Oe(B){re(B,!0)}return t.find=ue,t.read=W,t.parse=g,t.write=ne,t.writeFile=H,t.utils={cfb_new:De,cfb_add:He,cfb_del:tt,cfb_mov:Ge,cfb_gc:Oe,ReadShift:Nu,CheckField:U_,prep_blob:ln,bconcat:tn,use_zlib:F,_deflateRaw:ht,_inflateRaw:La,consts:j},t})();let to;function TA(e){to=e}function EA(e){return typeof e=="string"?id(e):Array.isArray(e)?XC(e):e}function od(e,t,r){if(typeof to<"u"&&to.writeFileSync)return r?to.writeFileSync(e,t,r):to.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=id(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ti(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([EA(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=oo(t)),u.write(t),u.close(),t}catch(m){if(!m.message||!m.message.match(/onstruct/))throw m}throw new Error("cannot save file "+e)}function CA(e){if(typeof to<"u")return to.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Er(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function s1(e,t){for(var r=[],n=Er(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function bh(e){for(var t=[],r=Er(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function kh(e){for(var t=[],r=Er(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function AA(e){for(var t=[],r=Er(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var ah=new Date(1899,11,30,0,0,0);function Kr(e,t){var r=e.getTime(),n=ah.getTime()+(e.getTimezoneOffset()-ah.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var S_=new Date,NA=ah.getTime()+(S_.getTimezoneOffset()-ah.getTimezoneOffset())*6e4,o1=S_.getTimezoneOffset();function Sh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+NA),t.getTimezoneOffset()!==o1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-o1)*6e4),t}function PA(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var l1=new Date("2017-02-19T19:06:09.000Z"),T_=isNaN(l1.getFullYear())?new Date("2/19/17"):l1,IA=T_.getFullYear()==2017;function fr(e,t){var r=new Date(e);if(IA)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(T_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function qo(e,t){if(Dt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ti(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ti(d_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ti(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ti(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ar(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ar(e[r]));return t}function kr(e,t){for(var r="";r.length<t;)r+=e;return r}function ai(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var DA=["january","february","march","april","may","june","july","august","september","october","november","december"];function yc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&DA.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var FA=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],u=1;u<s.length;++u)l.push(a),l.push(s[u]);return l}})();function E_(e){return e?e.content&&e.type?qo(e.content,!0):e.data?uc(e.data):e.asNodeBuffer&&Dt?uc(e.asNodeBuffer().toString("binary")):e.asBinary?uc(e.asBinary()):e._data&&e._data.getContent?uc(qo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function C_(e){if(!e)return null;if(e.data)return eh(e.data);if(e.asNodeBuffer&&Dt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?eh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function jA(e){return e&&e.name.slice(-4)===".bin"?C_(e):E_(e)}function Ia(e,t){for(var r=e.FullPaths||Er(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Ap(e,t){var r=Ia(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Lr(e,t,r){if(!r)return jA(Ap(e,t));if(!t)return null;try{return Lr(e,t)}catch{return null}}function da(e,t,r){if(!r)return E_(Ap(e,t));if(!t)return null;try{return da(e,t)}catch{return null}}function OA(e,t,r){return C_(Ap(e,t))}function c1(e){for(var t=e.FullPaths||Er(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function It(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Dt?n=is(r):n=JC(r),dt.utils.cfb_add(e,t,n)}dt.utils.cfb_add(e,t,r)}else e.file(t,r)}function Np(){return dt.utils.cfb_new()}function A_(e,t){switch(t.type){case"base64":return dt.read(e,{type:"base64"});case"binary":return dt.read(e,{type:"binary"});case"buffer":case"array":return dt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Su(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Dr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,RA=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,u1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,LA=/<[^>]*>/g,En=Dr.match(u1)?u1:LA,MA=/<\w*:/,BA=/<(\/?)\w+:/;function bt(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var l=e.match(RA),u=0,m="",p=0,g="",y="",_=1;if(l)for(p=0;p!=l.length;++p){for(y=l[p],s=0;s!=y.length&&y.charCodeAt(s)!==61;++s);for(g=y.slice(0,s).trim();y.charCodeAt(s+1)==32;)++s;for(_=(a=y.charCodeAt(s+1))==34||a==39?1:0,m=y.slice(s+1+_,y.length-_),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),n[g]=m,n[g.toLowerCase()]=m;else{var T=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(n[T]&&g.slice(u-3,u)=="ext")continue;n[T]=m,n[T.toLowerCase()]=m}}return n}function Ni(e){return e.replace(BA,"<$1")}var N_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Pp=bh(N_),Ut=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(u,m){return N_[u]||String.fromCharCode(parseInt(m,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,m){return String.fromCharCode(parseInt(m,16))});var l=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,l)+r(a.slice(l+3))}})(),Ip=/[&<>'"]/g,zA=/[\u0000-\u0008\u000b-\u001f]/g;function Xt(e){var t=e+"";return t.replace(Ip,function(r){return Pp[r]}).replace(zA,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function d1(e){return Xt(e).replace(/ /g,"_x0020_")}var P_=/[\u0000-\u001f]/g;function Dp(e){var t=e+"";return t.replace(Ip,function(r){return Pp[r]}).replace(/\n/g,"<br/>").replace(P_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function UA(e){var t=e+"";return t.replace(Ip,function(r){return Pp[r]}).replace(P_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var f1=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function WA(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ur(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function xm(e){for(var t="",r=0,n=0,a=0,s=0,l=0,u=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}l=e.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function h1(e){var t=ro(2*e.length),r,n,a=1,s=0,l=0,u;for(n=0;n<e.length;n+=a)a=1,(u=e.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(e.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function m1(e){return is(e,"binary").toString("utf8")}var jf="foo bar bazâð£",nr=Dt&&(m1(jf)==xm(jf)&&m1||h1(jf)==xm(jf)&&h1)||xm,Ti=Dt?function(e){return is(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Vu=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),I_=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),$A=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),HA=/<\/?(?:vt:)?variant>/g,VA=/<(?:vt:)([^>]*)>([\s\S]*)</;function p1(e,t){var r=bt(e),n=e.match($A(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var l=s.replace(HA,"").match(VA);l&&a.push({v:nr(l[2]),t:l[1]})}),a}var D_=/(^\s|\s$|\n)/;function cn(e,t){return"<"+e+(t.match(D_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Gu(e){return Er(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Je(e,t,r){return"<"+e+(r!=null?Gu(r):"")+(t!=null?(t.match(D_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Xm(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function GA(e,t){switch(typeof e){case"string":var r=Je("vt:lpwstr",Xt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Je((e|0)==e?"vt:i4":"vt:r8",Xt(String(e)));case"boolean":return Je("vt:bool",e?"true":"false")}if(e instanceof Date)return Je("vt:filetime",Xm(e));throw new Error("Unable to serialize "+e)}function Fp(e){if(Dt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return nr(oo(Tp(e)));throw new Error("Bad input format: expected Buffer or string")}var Zu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},al=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ca={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function ZA(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function KA(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,l=n?-t:t;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var u=0;u<=5;++u,s/=256)e[r+u]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var g1=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},v1=Dt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:is(t)})):g1(e)}:g1,x1=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ts(e,a)));return n.join("").replace(kn,"")},Th=Dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(kn,""):x1(e,t,r)}:x1,y1=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},F_=Dt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):y1(e,t,r)}:y1,_1=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(cc(e,a)));return n.join("")},Tc=Dt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):_1(t,r,n)}:_1,j_=function(e,t){var r=en(e,t);return r>0?Tc(e,t+4,t+4+r-1):""},jp=j_,O_=function(e,t){var r=en(e,t);return r>0?Tc(e,t+4,t+4+r-1):""},Op=O_,R_=function(e,t){var r=2*en(e,t);return r>0?Tc(e,t+4,t+4+r-1):""},Rp=R_,L_=function(t,r){var n=en(t,r);return n>0?Th(t,r+4,r+4+n):""},Lp=L_,M_=function(e,t){var r=en(e,t);return r>0?Tc(e,t+4,t+4+r):""},Mp=M_,B_=function(e,t){return ZA(e,t)},ih=B_,Bp=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Dt&&(jp=function(t,r){if(!Buffer.isBuffer(t))return j_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Op=function(t,r){if(!Buffer.isBuffer(t))return O_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Rp=function(t,r){if(!Buffer.isBuffer(t))return R_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Lp=function(t,r){if(!Buffer.isBuffer(t))return L_(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Mp=function(t,r){if(!Buffer.isBuffer(t))return M_(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},ih=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):B_(t,r)},Bp=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function z_(){Th=function(e,t,r){return Bt.utils.decode(1200,e.slice(t,r)).replace(kn,"")},Tc=function(e,t,r){return Bt.utils.decode(65001,e.slice(t,r))},jp=function(e,t){var r=en(e,t);return r>0?Bt.utils.decode(Ko,e.slice(t+4,t+4+r-1)):""},Op=function(e,t){var r=en(e,t);return r>0?Bt.utils.decode(fa,e.slice(t+4,t+4+r-1)):""},Rp=function(e,t){var r=2*en(e,t);return r>0?Bt.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Lp=function(e,t){var r=en(e,t);return r>0?Bt.utils.decode(1200,e.slice(t+4,t+4+r)):""},Mp=function(e,t){var r=en(e,t);return r>0?Bt.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Bt<"u"&&z_();var cc=function(e,t){return e[t]},ts=function(e,t){return e[t+1]*256+e[t]},YA=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},en=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Uo=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},qA=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Nu(e,t){var r="",n,a,s=[],l,u,m,p;switch(t){case"dbcs":if(p=this.l,Dt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)r+=String.fromCharCode(ts(this,p)),p+=2;e*=2;break;case"utf8":r=Tc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Th(this,this.l,this.l+e);break;case"wstr":if(typeof Bt<"u")r=Bt.utils.decode(fa,this.slice(this.l,this.l+2*e));else return Nu.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=jp(this,this.l),e=4+en(this,this.l);break;case"lpstr-cp":r=Op(this,this.l),e=4+en(this,this.l);break;case"lpwstr":r=Rp(this,this.l),e=4+2*en(this,this.l);break;case"lpp4":e=4+en(this,this.l),r=Lp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+en(this,this.l),r=Mp(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=cc(this,this.l+e++))!==0;)s.push(bu(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=ts(this,this.l+e))!==0;)s.push(bu(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",p=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(p)!==-1)return l=cc(this,p),this.l=p+1,u=Nu.call(this,e-m,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(bu(ts(this,p))),p+=2}r=s.join(""),e*=2;break;case"cpstr":if(typeof Bt<"u"){r=Bt.utils.decode(fa,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",p=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(p)!==-1)return l=cc(this,p),this.l=p+1,u=Nu.call(this,e-m,l?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(bu(cc(this,p))),p+=1}r=s.join("");break;default:switch(e){case 1:return n=cc(this,this.l),this.l++,n;case 2:return n=(t==="i"?YA:ts)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Uo:qA)(this,this.l),this.l+=4,n):(a=en(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=ih(this,this.l):a=ih([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=F_(this,this.l,e);break}}return this.l+=e,r}var XA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},JA=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},QA=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function e4(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)QA(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof Bt<"u"&&Ko==874)for(a=0;a!=t.length;++a){var s=Bt.utils.encode(Ko,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var u=t.charCodeAt(a);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,XA(this,t,this.l);break;case 8:if(n=8,r==="f"){KA(this,t,this.l);break}case 16:break;case-4:n=4,JA(this,t,this.l);break}return this.l+=n,this}function U_(e,t){var r=F_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ln(e,t){e.l=t,e.read_shift=Nu,e.chk=U_,e.write_shift=e4}function Tn(e,t){e.l+=t}function Fe(e){var t=ro(e);return ln(t,0),t}function ss(e,t,r){if(e){var n,a,s;ln(e,e.l||0);for(var l=e.length,u=0,m=0;e.l<l;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var p=Qu[u]||Qu[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;m=e.l+s;var g=p.f&&p.f(e,s,r);if(e.l=m,t(g,p,u))return}}}function Kn(){var e=[],t=Dt?256:2048,r=function(p){var g=Fe(p);return ln(g,0),g},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(p){return n&&p<n.length-n.l?n:(a(),n=r(Math.max(p+1,t)))},l=function(){return a(),tn(e)},u=function(p){a(),n=p,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:u,end:l,_bufs:e}}function Me(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=Qu[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Bp(r)&&e.push(r)}}function Pu(e,t,r){var n=ar(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function w1(e,t,r){var n=ar(e);return n.s=Pu(n.s,t.s,r),n.e=Pu(n.e,t.s,r),n}function Iu(e,t){if(e.cRel&&e.c<0)for(e=ar(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ar(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=_t(e);return!e.cRel&&e.cRel!=null&&(r=n4(r)),!e.rRel&&e.rRel!=null&&(r=t4(r)),r}function ym(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+dr(e.s.c)+":"+(e.e.cRel?"":"$")+dr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sr(e.s.r)+":"+(e.e.rRel?"":"$")+Sr(e.e.r):Iu(e.s,t.biff)+":"+Iu(e.e,t.biff)}function zp(e){return parseInt(r4(e),10)-1}function Sr(e){return""+(e+1)}function t4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function r4(e){return e.replace(/\$(\d+)$/,"$1")}function Up(e){for(var t=a4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function dr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function n4(e){return e.replace(/^([A-Z])/,"$$$1")}function a4(e){return e.replace(/^\$([A-Z])/,"$1")}function i4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _r(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function _t(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ln(e){var t=e.indexOf(":");return t==-1?{s:_r(e),e:_r(e)}:{s:_r(e.slice(0,t)),e:_r(e.slice(t+1))}}function Pt(e,t){return typeof t>"u"||typeof t=="number"?Pt(e.s,e.e):(typeof e!="string"&&(e=_t(e)),typeof t!="string"&&(t=_t(t)),e==t?e:e+":"+t)}function Lt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function b1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ma(e.z,r?Kr(t):t)}catch{}try{return e.w=ma((e.XF||{}).numFmtId||(r?14:0),r?Kr(t):t)}catch{return""+t}}function Ai(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?os[e.v]||e.v:t==null?b1(e,e.v):b1(e,t))}function lo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function W_(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),l=0,u=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var m=typeof n.origin=="string"?_r(n.origin):n.origin;l=m.r,u=m.c}s["!ref"]||(s["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var g=Lt(s["!ref"]);p.s.c=g.s.c,p.s.r=g.s.r,p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),l==-1&&(p.e.r=l=g.e.r+1)}for(var y=0;y!=t.length;++y)if(t[y]){if(!Array.isArray(t[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[y].length;++_)if(!(typeof t[y][_]>"u")){var T={v:t[y][_]},S=l+y,w=u+_;if(p.s.r>S&&(p.s.r=S),p.s.c>w&&(p.s.c=w),p.e.r<S&&(p.e.r=S),p.e.c<w&&(p.e.c=w),t[y][_]&&typeof t[y][_]=="object"&&!Array.isArray(t[y][_])&&!(t[y][_]instanceof Date))T=t[y][_];else if(Array.isArray(T.v)&&(T.f=t[y][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(n.nullError)T.t="e",T.v=0;else if(n.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=n.dateNF||yt[14],n.cellDates?(T.t="d",T.w=ma(T.z,Kr(T.v))):(T.t="n",T.v=Kr(T.v),T.w=ma(T.z,T.v))):T.t="s";if(a)s[S]||(s[S]=[]),s[S][w]&&s[S][w].z&&(T.z=s[S][w].z),s[S][w]=T;else{var E=_t({c:w,r:S});s[E]&&s[E].z&&(T.z=s[E].z),s[E]=T}}}return p.s.c<1e7&&(s["!ref"]=Pt(p)),s}function Ec(e,t){return W_(null,e,t)}function s4(e){return e.read_shift(4,"i")}function ii(e,t){return t||(t=Fe(4)),t.write_shift(4,e),t}function Sn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function rn(e,t){var r=!1;return t==null&&(r=!0,t=Fe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function o4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function l4(e,t){return t||(t=Fe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Wp(e,t){var r=e.l,n=e.read_shift(1),a=Sn(e),s=[],l={t:a,h:a};if((n&1)!==0){for(var u=e.read_shift(4),m=0;m!=u;++m)s.push(o4(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function c4(e,t){var r=!1;return t==null&&(r=!0,t=Fe(15+4*e.t.length)),t.write_shift(1,0),rn(e.t,t),r?t.slice(0,t.l):t}var u4=Wp;function d4(e,t){var r=!1;return t==null&&(r=!0,t=Fe(23+4*e.t.length)),t.write_shift(1,1),rn(e.t,t),t.write_shift(4,1),l4({},t),r?t.slice(0,t.l):t}function Ra(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function il(e,t){return t==null&&(t=Fe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function sl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ol(e,t){return t==null&&(t=Fe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var f4=Sn,$_=rn;function $p(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function sh(e,t){var r=!1;return t==null&&(r=!0,t=Fe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var h4=Sn,Jm=$p,Hp=sh;function Vp(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?ih([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Uo(t,0)>>2;return r?a/100:a}function H_(e,t){t==null&&(t=Fe(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function V_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function m4(e,t){return t||(t=Fe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ll=V_,Cc=m4;function bn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Xo(e,t){return(t||Fe(8)).write_shift(8,e,"f")}function p4(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),u=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var p=Ho[a];p&&(t.rgb=Yu(p));break;case 2:t.rgb=Yu([l,u,m]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function oh(e,t){if(t||(t=Fe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function g4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function v4(e,t){t||(t=Fe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function G_(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function x4(e){return G_(e,1)}function y4(e){return G_(e,2)}var Gp=2,Zn=3,Of=11,k1=12,lh=19,Rf=64,_4=65,w4=71,b4=4108,k4=4126,Qr=80,Z_=81,S4=[Qr,Z_],Qm={1:{n:"CodePage",t:Gp},2:{n:"Category",t:Qr},3:{n:"PresentationFormat",t:Qr},4:{n:"ByteCount",t:Zn},5:{n:"LineCount",t:Zn},6:{n:"ParagraphCount",t:Zn},7:{n:"SlideCount",t:Zn},8:{n:"NoteCount",t:Zn},9:{n:"HiddenCount",t:Zn},10:{n:"MultimediaClipCount",t:Zn},11:{n:"ScaleCrop",t:Of},12:{n:"HeadingPairs",t:b4},13:{n:"TitlesOfParts",t:k4},14:{n:"Manager",t:Qr},15:{n:"Company",t:Qr},16:{n:"LinksUpToDate",t:Of},17:{n:"CharacterCount",t:Zn},19:{n:"SharedDoc",t:Of},22:{n:"HyperlinksChanged",t:Of},23:{n:"AppVersion",t:Zn,p:"version"},24:{n:"DigSig",t:_4},26:{n:"ContentType",t:Qr},27:{n:"ContentStatus",t:Qr},28:{n:"Language",t:Qr},29:{n:"Version",t:Qr},255:{},2147483648:{n:"Locale",t:lh},2147483651:{n:"Behavior",t:lh},1919054434:{}},ep={1:{n:"CodePage",t:Gp},2:{n:"Title",t:Qr},3:{n:"Subject",t:Qr},4:{n:"Author",t:Qr},5:{n:"Keywords",t:Qr},6:{n:"Comments",t:Qr},7:{n:"Template",t:Qr},8:{n:"LastAuthor",t:Qr},9:{n:"RevNumber",t:Qr},10:{n:"EditTime",t:Rf},11:{n:"LastPrinted",t:Rf},12:{n:"CreatedDate",t:Rf},13:{n:"ModifiedDate",t:Rf},14:{n:"PageCount",t:Zn},15:{n:"WordCount",t:Zn},16:{n:"CharCount",t:Zn},17:{n:"Thumbnail",t:w4},18:{n:"Application",t:Qr},19:{n:"DocSecurity",t:Zn},255:{},2147483648:{n:"Locale",t:lh},2147483651:{n:"Behavior",t:lh},1919054434:{}},S1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},T4=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function E4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var C4=E4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ho=ar(C4),os={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},K_={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},tp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Lf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Zp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function A4(e){var t=Zp();if(!e||!e.match)return t;var r={};if((e.match(En)||[]).forEach(function(n){var a=bt(n);switch(a[0].replace(MA,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[tp[a.ContentType]]!==void 0&&t[tp[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Zr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Y_(e,t){var r=AA(tp),n=[],a;n[n.length]=Dr,n[n.length]=Je("Types",null,{xmlns:Zr.CT,"xmlns:xsd":Zr.xsd,"xmlns:xsi":Zr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(m){return Je("Default",null,{Extension:m[0],ContentType:m[1]})}));var s=function(m){e[m]&&e[m].length>0&&(a=e[m][0],n[n.length]=Je("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Lf[m][t.bookType]||Lf[m].xlsx}))},l=function(m){(e[m]||[]).forEach(function(p){n[n.length]=Je("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:Lf[m][t.bookType]||Lf[m].xlsx})})},u=function(m){(e[m]||[]).forEach(function(p){n[n.length]=Je("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:r[m][0]})})};return s("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var jt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ku(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Du(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(En)||[]).forEach(function(a){var s=bt(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var u=s.TargetMode==="External"?s.Target:Su(s.Target,t);r[u]=l,n[s.Id]=l}}),r["!id"]=n,r}function mc(e){var t=[Dr,Je("Relationships",null,{xmlns:Zr.RELS})];return Er(e["!id"]).forEach(function(r){t[t.length]=Je("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function qt(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[jt.HLINK,jt.XPATH,jt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var N4="application/vnd.oasis.opendocument.spreadsheet";function P4(e,t){for(var r=Fp(e),n,a;n=Zu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=bt(n[0],!1),a.path=="/"&&a.type!==N4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function I4(e){var t=[Dr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function T1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function D4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function F4(e){var t=[Dr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(T1(e[r][0],e[r][1])),t.push(D4("",e[r][0]));return t.push(T1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function q_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Wu.version+"</meta:generator></office:meta></office:document-meta>"}var Oa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],j4=(function(){for(var e=new Array(Oa.length),t=0;t<Oa.length;++t){var r=Oa[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function X_(e){var t={};e=nr(e);for(var r=0;r<Oa.length;++r){var n=Oa[r],a=e.match(j4[r]);a!=null&&a.length>0&&(t[n[1]]=Ut(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=fr(t[n[1]]))}return t}function _m(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Xt(t),n[n.length]=r?Je(e,t,r):cn(e,t))}function J_(e,t){var r=t||{},n=[Dr,Je("cp:coreProperties",null,{"xmlns:cp":Zr.CORE_PROPS,"xmlns:dc":Zr.dc,"xmlns:dcterms":Zr.dcterms,"xmlns:dcmitype":Zr.dcmitype,"xmlns:xsi":Zr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&_m("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Xm(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&_m("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Xm(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Oa.length;++s){var l=Oa[s],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&_m(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Q_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ew(e,t,r,n){var a=[];if(typeof e=="string")a=p1(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(g){return{v:g}}));var l=typeof t=="string"?p1(t,n).map(function(g){return g.v}):t,u=0,m=0;if(l.length>0)for(var p=0;p!==a.length;p+=2){switch(m=+a[p+1].v,a[p].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=m,r.SheetNames=l.slice(u,u+m);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=m,r.DefinedNames=l.slice(u,u+m);break;case"Charts":case"Diagramme":r.Chartsheets=m,r.ChartNames=l.slice(u,u+m);break}u+=m}}function O4(e,t,r){var n={};return t||(t={}),e=nr(e),Vo.forEach(function(a){var s=(e.match(Vu(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=Ut(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ew(n.HeadingPairs,n.TitlesOfParts,t,r),t}function tw(e){var t=[],r=Je;return e||(e={}),e.Application="SheetJS",t[t.length]=Dr,t[t.length]=Je("Properties",null,{xmlns:Zr.EXT_PROPS,"xmlns:vt":Zr.vt}),Vo.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Xt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Xt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var R4=/<[^>]+>[^<]*/g;function L4(e,t){var r={},n="",a=e.match(R4);if(a)for(var s=0;s!=a.length;++s){var l=a[s],u=bt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ut(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var m=l.split(">"),p=m[0].slice(4),g=m[1];switch(p){case"lpstr":case"bstr":case"lpwstr":r[n]=Ut(g);break;case"bool":r[n]=ur(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(g);break;case"filetime":case"date":r[n]=fr(g);break;case"cy":case"error":r[n]=Ut(g);break;default:if(p.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,p,m)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function rw(e){var t=[Dr,Je("Properties",null,{xmlns:Zr.CUST_PROPS,"xmlns:vt":Zr.vt})];if(!e)return t.join("");var r=1;return Er(e).forEach(function(a){++r,t[t.length]=Je("property",GA(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Xt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var rp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},wm;function M4(e,t,r){wm||(wm=bh(rp)),t=wm[t]||t,e[t]=r}function B4(e,t){var r=[];return Er(rp).map(function(n){for(var a=0;a<Oa.length;++a)if(Oa[a][1]==n)return Oa[a];for(a=0;a<Vo.length;++a)if(Vo[a][1]==n)return Vo[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(cn(rp[n[1]]||n[1],a))}}),Je("DocumentProperties",r.join(""),{xmlns:ca.o})}function z4(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Er(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<Oa.length;++l)if(s==Oa[l][1])return;for(l=0;l<Vo.length;++l)if(s==Vo[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var u=e[s],m="string";typeof u=="number"?(m="float",u=String(u)):u===!0||u===!1?(m="boolean",u=u?"1":"0"):u=String(u),a.push(Je(d1(s),u,{"dt:dt":m}))}}),t&&Er(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Je(d1(s),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+ca.o+'">'+a.join("")+"</"+n+">"}function Kp(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function U4(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var l=Fe(8);return l.write_shift(4,n),l.write_shift(4,a),l}function nw(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function aw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function iw(e,t,r){return t===31?aw(e):nw(e,t,r)}function np(e,t,r){return iw(e,t,r===!1?0:4)}function W4(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return iw(e,t,0)}function $4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(kn,""),e.l-a&2&&(e.l+=2)}return r}function H4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(kn,"");return r}function V4(e){var t=e.l,r=ch(e,Z_);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=ch(e,Zn);return[r,n]}function G4(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(V4(e));return r}function E1(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(kn,"").replace(ku,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function sw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Z4(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ch(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==k1&&n!==t&&S4.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===k1?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return nw(e,n,4).replace(kn,"");case 31:return aw(e);case 64:return Kp(e);case 65:return sw(e);case 71:return Z4(e);case 80:return np(e,n,!s.raw).replace(kn,"");case 81:return W4(e,n).replace(kn,"");case 4108:return G4(e);case 4126:case 4127:return n==4127?$4(e):H4(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function C1(e,t){var r=Fe(4),n=Fe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Fe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=U4(t);break;case 31:case 80:for(n=Fe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return tn([r,n])}function A1(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],l=0,u=0,m=-1,p={};for(l=0;l!=a;++l){var g=e.read_shift(4),y=e.read_shift(4);s[l]=[g,y+r]}s.sort(function(I,A){return I[1]-A[1]});var _={};for(l=0;l!=a;++l){if(e.l!==s[l][1]){var T=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,T=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],T=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],T=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(T=!1,e.l=s[l][1]),T)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var S=t[s[l][0]];if(_[S.n]=ch(e,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ja(u=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(s[l][0]===1){if(u=_.CodePage=ch(e,Gp),ja(u),m!==-1){var w=e.l;e.l=s[m][1],p=E1(e,u),e.l=w}}else if(s[l][0]===0){if(u===0){m=l,e.l=s[l+1][1];continue}p=E1(e,u)}else{var E=p[s[l][0]],P;switch(e[e.l]){case 65:e.l+=4,P=sw(e);break;case 30:e.l+=4,P=np(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,P=np(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,P=e.read_shift(4,"i");break;case 19:e.l+=4,P=e.read_shift(4);break;case 5:e.l+=4,P=e.read_shift(8,"f");break;case 11:e.l+=4,P=Ir(e,4);break;case 64:e.l+=4,P=fr(Kp(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[E]=P}}return e.l=r+n,_}var ow=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function K4(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function N1(e,t,r){var n=Fe(8),a=[],s=[],l=8,u=0,m=Fe(8),p=Fe(8);if(m.write_shift(4,2),m.write_shift(4,1200),p.write_shift(4,1),s.push(m),a.push(p),l+=8+m.length,!t){p=Fe(8),p.write_shift(4,0),a.unshift(p);var g=[Fe(4)];for(g[0].write_shift(4,e.length),u=0;u<e.length;++u){var y=e[u][0];for(m=Fe(8+2*(y.length+1)+(y.length%2?0:2)),m.write_shift(4,u+2),m.write_shift(4,y.length+1),m.write_shift(0,y,"dbcs");m.l!=m.length;)m.write_shift(1,0);g.push(m)}m=tn(g),s.unshift(m),l+=8+m.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(ow.indexOf(e[u][0])>-1||Q_.indexOf(e[u][0])>-1)&&e[u][1]!=null){var _=e[u][1],T=0;if(t){T=+t[e[u][0]];var S=r[T];if(S.p=="version"&&typeof _=="string"){var w=_.split(".");_=(+w[0]<<16)+(+w[1]||0)}m=C1(S.t,_)}else{var E=K4(_);E==-1&&(E=31,_=String(_)),m=C1(E,_)}s.push(m),p=Fe(8),p.write_shift(4,t?T:2+u),a.push(p),l+=8+m.length}var P=8*(s.length+1);for(u=0;u<s.length;++u)a[u].write_shift(4,P),P+=s[u].length;return n.write_shift(4,l),n.write_shift(4,s.length),tn([n].concat(a).concat(s))}function P1(e,t,r){var n=e.content;if(!n)return{};ln(n,0);var a,s,l,u,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var p=n.read_shift(4),g=n.read_shift(16);if(g!==dt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),m=n.read_shift(4));var y=A1(n,t),_={SystemIdentifier:p};for(var T in y)_[T]=y[T];if(_.FMTID=s,a===1)return _;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var S;try{S=A1(n,null)}catch{}for(T in S)_[T]=S[T];return _.FMTID=[s,l],_}function I1(e,t,r,n,a,s){var l=Fe(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,dt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var m=N1(e,r,n);if(u.push(m),a){var p=N1(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+m.length),u.push(p)}return tn(u)}function Zs(e,t){return e.read_shift(t),null}function Y4(e,t){t||(t=Fe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function q4(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Ir(e,t){return e.read_shift(t)===1}function Rn(e,t){return t||(t=Fe(2)),t.write_shift(2,+!!e),t}function Mr(e){return e.read_shift(2,"u")}function Da(e,t){return t||(t=Fe(2)),t.write_shift(2,e),t}function lw(e,t){return q4(e,t,Mr)}function X4(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function cw(e,t,r){return r||(r=Fe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ld(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=fa;if(r&&r.biff>=8&&(fa=1200),!r||r.biff==8){var l=e.read_shift(1);l&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var u=n?e.read_shift(n,a):"";return fa=s,u}function J4(e){var t=fa;fa=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,s=n&8,l=1+(n&1),u=0,m,p={};s&&(u=e.read_shift(2)),a&&(m=e.read_shift(4));var g=l==2?"dbcs-cont":"sbcs-cont",y=r===0?"":e.read_shift(r,g);return s&&(e.l+=4*u),a&&(e.l+=m),p.t=y,s||(p.raw="<t>"+p.t+"</t>",p.r=p.t),fa=t,p}function Q4(e){var t=e.t||"",r=Fe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Fe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return tn(a)}function Jo(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function cd(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Jo(e,n,r)}function cl(e,t,r){if(r.biff>5)return cd(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function uw(e,t,r){return r||(r=Fe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function eN(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function tN(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(kn,"");return n&&(e.l+=24),a}function rN(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(kn,"");return r+l}function nN(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return tN(e);case"0303000000000000c000000000000046":return rN(e);default:throw new Error("Unsupported Moniker "+r)}}function Mf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(kn,""):"";return r}function D1(e,t){t||(t=Fe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function aN(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,l,u,m,p="",g,y;a&16&&(s=Mf(e,r-e.l)),a&128&&(l=Mf(e,r-e.l)),(a&257)===257&&(u=Mf(e,r-e.l)),(a&257)===1&&(m=nN(e,r-e.l)),a&8&&(p=Mf(e,r-e.l)),a&32&&(g=e.read_shift(16)),a&64&&(y=Kp(e)),e.l=r;var _=l||u||m||"";_&&p&&(_+="#"+p),_||(_="#"+p),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var T={Target:_};return g&&(T.guid=g),y&&(T.time=y),s&&(T.Tooltip=s),T}function iN(e){var t=Fe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),D1(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var u=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)t.write_shift(2,u.charCodeAt(r));t.write_shift(2,0),s&8&&D1(a>-1?n.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var m=0;n.slice(m*3,m*3+3)=="../"||n.slice(m*3,m*3+3)=="..\\";)++m;for(t.write_shift(2,m),t.write_shift(4,n.length-3*m+1),r=0;r<n.length-3*m;++r)t.write_shift(1,n.charCodeAt(r+3*m)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function dw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function fw(e,t){var r=dw(e);return r[3]=0,r}function Pi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Qo(e,t,r,n){return n||(n=Fe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function sN(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function oN(e,t,r){return t===0?"":cl(e,t,r)}function lN(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,s,l]}function hw(e){var t=e.read_shift(2),r=Vp(e);return[t,r]}function cN(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=ld(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Eh(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function mw(e,t){return t||(t=Fe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function pw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var uN=pw;function gw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function dN(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function fN(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function xn(e){e.l+=2,e.l+=e.read_shift(2)}var hN={0:xn,4:xn,5:xn,6:xn,7:fN,8:xn,9:xn,10:xn,11:xn,12:xn,13:dN,14:xn,15:xn,16:xn,17:xn,18:xn,19:xn,20:xn,21:gw};function mN(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(hN[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Bf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Yp(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Fe(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function pN(e,t){return t===0||e.read_shift(2),1200}function gN(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=cl(e,0,r);return e.read_shift(t+n-e.l),a}function vN(e,t){var r=!t||t.biff==8,n=Fe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function xN(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function yN(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=ld(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:s,name:l}}function _N(e,t){var r=!t||t.biff>=8?2:1,n=Fe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function wN(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],l=0;l!=a&&e.l<r;++l)s.push(J4(e));return s.Count=n,s.Unique=a,s}function bN(e,t){var r=Fe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Q4(e[a]);var s=tn([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function kN(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function SN(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function TN(e){var t=sN(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function EN(e){return e.read_shift(2),e.read_shift(4)}function F1(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function CN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),m=e.read_shift(2),p=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:l,FirstTab:u,Selected:m,TabRatio:p}}function AN(){var e=Fe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function NN(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function PN(e){var t=Fe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function IN(){}function DN(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ld(e,0,r),n}function FN(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=Fe(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function jN(e){var t=Pi(e);return t.isst=e.read_shift(4),t}function ON(e,t,r,n){var a=Fe(10);return Qo(e,t,n,a),a.write_shift(4,r),a}function RN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Pi(e);r.biff==2&&e.l++;var s=cd(e,n-e.l,r);return a.val=s,a}function LN(e,t,r,n,a){var s=!a||a.biff==8,l=Fe(8+ +s+(1+s)*r.length);return Qo(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function MN(e,t,r){var n=e.read_shift(2),a=cl(e,0,r);return[n,a]}function BN(e,t,r,n){var a=r&&r.biff==5;n||(n=Fe(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var zN=cl;function j1(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),l=e.read_shift(a),u=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:s,c:u},e:{r:l,c:m}}}function UN(e,t){var r=t.biff==8||!t.biff?4:2,n=Fe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function WN(e){var t=e.read_shift(2),r=e.read_shift(2),n=hw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function $N(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(hw(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:s}}function HN(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:s}}function VN(e,t,r,n){var a={},s=e.read_shift(4),l=e.read_shift(4),u=e.read_shift(4),m=e.read_shift(2);return a.patternType=T4[u>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=m&127,a.icvBack=m>>7&127,a.fsxButton=m>>14&1),a}function GN(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=VN(e,t,n.fStyle,r),n}function O1(e,t,r,n){var a=r&&r.biff==5;n||(n=Fe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function ZN(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function KN(e){var t=Fe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function R1(e,t,r){var n=Pi(e);(r.biff==2||t==9)&&++e.l;var a=X4(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function YN(e,t,r,n,a,s){var l=Fe(8);return Qo(e,t,n,l),cw(r,s,l),l}function qN(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Pi(e),a=bn(e);return n.val=a,n}function XN(e,t,r,n){var a=Fe(14);return Qo(e,t,n,a),Xo(r,a),a}var L1=oN;function JN(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=Jo(e,s),u=[];n>e.l;)u.push(cd(e));return[s,a,l,u]}function M1(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=cN(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var QN=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function B1(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(r&&r.biff==2?1:2),m=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),m=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var p=Jo(e,l,r);a&32&&(p=QN[p.charCodeAt(0)]);var g=n-e.l;r&&r.biff==2&&--g;var y=n==e.l||u===0||!(g>0)?[]:mD(e,g,r,u);return{chKey:s,Name:p,itab:m,rgce:y}}function vw(e,t,r){if(r.biff<8)return eP(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(lN(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function eP(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ld(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function tP(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Jo(e,n,r),l=Jo(e,a,r);return[s,l]}function rP(e,t,r){var n=pw(e);e.l++;var a=e.read_shift(1);return t-=8,[pD(e,t,r),a,n]}function z1(e,t,r){var n=uN(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,fD(e,t,r)]}function nP(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function aP(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),u=cl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},u,l,s]}}function iP(e,t,r){return aP(e,t,r)}function sP(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Eh(e));return r}function oP(e){var t=Fe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)mw(e[r],t);return t}function lP(e,t,r){if(r&&r.biff<8)return uP(e,t,r);var n=gw(e),a=mN(e,t-22,n[1]);return{cmo:n,ft:a}}var cP={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function uP(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((cP[n]||Tn)(e,t,r)),{cmo:[a,n,s],ft:l}}function dP(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=eN(e,6,r);var u=e.read_shift(2);e.read_shift(2),Mr(e,2);var m=e.read_shift(2);e.l+=m;for(var p=1;p<e.lens.length-1;++p){if(e.l-n!=e.lens[p])throw new Error("TxO: bad continue record");var g=e[e.l],y=Jo(e,e.lens[p+1]-e.lens[p]-1);if(a+=y,a.length>=(g?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function fP(e,t){var r=Eh(e);e.l+=16;var n=aN(e,t-24);return[r,n]}function hP(e){var t=Fe(24),r=_r(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return tn([t,iN(e[1])])}function mP(e,t){e.read_shift(2);var r=Eh(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(kn,""),[r,n]}function pP(e){var t=e[1].Tooltip,r=Fe(10+2*(t.length+1));r.write_shift(2,2048);var n=_r(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function gP(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=S1[r]||r,r=e.read_shift(2),t[1]=S1[r]||r,t}function vP(e){return e||(e=Fe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function xP(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fw(e));return r}function yP(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(fw(e));return r}function _P(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function xw(e,t,r){if(!r.cellStyles)return Tn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),u=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var p={s:a,e:s,w:l,ixfe:u,flags:m};return(r.biff>=5||!r.biff)&&(p.level=m>>8&7),p}function wP(e,t){var r=Fe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function bP(e,t){var r={};return t<32||(e.l+=16,r.header=bn(e),r.footer=bn(e),e.l+=2),r}function kP(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function SP(e){for(var t=Fe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var TP=Pi,EP=lw,CP=cd;function AP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function NP(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Pi(e);++e.l;var a=cl(e,t-7,r);return n.t="str",n.val=a,n}function PP(e){var t=Pi(e);++e.l;var r=bn(e);return t.t="n",t.val=r,t}function IP(e,t,r){var n=Fe(15);return hd(n,e,t),n.write_shift(8,r,"f"),n}function DP(e){var t=Pi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function FP(e,t,r){var n=Fe(9);return hd(n,e,t),n.write_shift(2,r),n}function jP(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function OP(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function RP(e,t,r){var n=e.l+t,a=Pi(e),s=e.read_shift(2),l=Jo(e,s,r);return e.l=n,a.t="str",a.val=l,a}var LP=[2,3,48,49,131,139,140,245],ap=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=bh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,m){var p=[],g=ro(1);switch(m.type){case"base64":g=ua(ha(u));break;case"binary":g=ua(u);break;case"buffer":case"array":g=u;break}ln(g,0);var y=g.read_shift(1),_=!!(y&136),T=!1,S=!1;switch(y){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var w=0,E=521;y==2&&(w=g.read_shift(2)),g.l+=3,y!=2&&(w=g.read_shift(4)),w>1048576&&(w=1e6),y!=2&&(E=g.read_shift(2));var P=g.read_shift(2),I=m.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(I=e[g[g.l]]),g.l+=1,g.l+=2),S&&(g.l+=36);for(var A=[],R={},K=Math.min(g.length,y==2?521:E-10-(T?264:0)),W=S?32:11;g.l<K&&g[g.l]!=13;)switch(R={},R.name=Bt.utils.decode(I,g.slice(g.l,g.l+W)).replace(/[\u0000\r\n].*$/g,""),g.l+=W,R.type=String.fromCharCode(g.read_shift(1)),y!=2&&!S&&(R.offset=g.read_shift(4)),R.len=g.read_shift(1),y==2&&(R.offset=g.read_shift(2)),R.dec=g.read_shift(1),R.name.length&&A.push(R),y!=2&&(g.l+=S?13:14),R.type){case"B":(!T||R.len!=8)&&m.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(g[g.l]!==13&&(g.l=E-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=E;var D=0,ee=0;for(p[0]=[],ee=0;ee!=A.length;++ee)p[0][ee]=A[ee].name;for(;w-- >0;){if(g[g.l]===42){g.l+=P;continue}for(++g.l,p[++D]=[],ee=0,ee=0;ee!=A.length;++ee){var re=g.slice(g.l,g.l+A[ee].len);g.l+=A[ee].len,ln(re,0);var pe=Bt.utils.decode(I,re);switch(A[ee].type){case"C":pe.trim().length&&(p[D][ee]=pe.replace(/\s+$/,""));break;case"D":pe.length===8?p[D][ee]=new Date(+pe.slice(0,4),+pe.slice(4,6)-1,+pe.slice(6,8)):p[D][ee]=pe;break;case"F":p[D][ee]=parseFloat(pe.trim());break;case"+":case"I":p[D][ee]=S?re.read_shift(-4,"i")^2147483648:re.read_shift(4,"i");break;case"L":switch(pe.trim().toUpperCase()){case"Y":case"T":p[D][ee]=!0;break;case"N":case"F":p[D][ee]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+pe+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));p[D][ee]="##MEMO##"+(S?parseInt(pe.trim(),10):re.read_shift(4));break;case"N":pe=pe.replace(/\u0000/g,"").trim(),pe&&pe!="."&&(p[D][ee]=+pe||0);break;case"@":p[D][ee]=new Date(re.read_shift(-8,"f")-621356832e5);break;case"T":p[D][ee]=new Date((re.read_shift(4)-2440588)*864e5+re.read_shift(4));break;case"Y":p[D][ee]=re.read_shift(4,"i")/1e4+re.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[D][ee]=-re.read_shift(-8,"f");break;case"B":if(T&&A[ee].len==8){p[D][ee]=re.read_shift(8,"f");break}case"G":case"P":re.l+=A[ee].len;break;case"0":if(A[ee].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[ee].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return m&&m.sheetRows&&(p=p.slice(0,m.sheetRows)),m.DBF=A,p}function n(u,m){var p=m||{};p.dateNF||(p.dateNF="yyyymmdd");var g=Ec(r(u,p),p);return g["!cols"]=p.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete p.DBF,g}function a(u,m){try{return lo(n(u,m),m)}catch(p){if(m&&m.WTF)throw p}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,m){var p=m||{};if(+p.codepage>=0&&ja(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var g=Kn(),y=fh(u,{header:1,raw:!0,cellDates:!0}),_=y[0],T=y.slice(1),S=u["!cols"]||[],w=0,E=0,P=0,I=1;for(w=0;w<_.length;++w){if(((S[w]||{}).DBF||{}).name){_[w]=S[w].DBF.name,++P;continue}if(_[w]!=null){if(++P,typeof _[w]=="number"&&(_[w]=_[w].toString(10)),typeof _[w]!="string")throw new Error("DBF Invalid column name "+_[w]+" |"+typeof _[w]+"|");if(_.indexOf(_[w])!==w){for(E=0;E<1024;++E)if(_.indexOf(_[w]+"_"+E)==-1){_[w]+="_"+E;break}}}}var A=Lt(u["!ref"]),R=[],K=[],W=[];for(w=0;w<=A.e.c-A.s.c;++w){var D="",ee="",re=0,pe=[];for(E=0;E<T.length;++E)T[E][w]!=null&&pe.push(T[E][w]);if(pe.length==0||_[w]==null){R[w]="?";continue}for(E=0;E<pe.length;++E){switch(typeof pe[E]){case"number":ee="B";break;case"string":ee="C";break;case"boolean":ee="L";break;case"object":ee=pe[E]instanceof Date?"D":"C";break;default:ee="C"}re=Math.max(re,String(pe[E]).length),D=D&&D!=ee?"C":ee}re>250&&(re=250),ee=((S[w]||{}).DBF||{}).type,ee=="C"&&S[w].DBF.len>re&&(re=S[w].DBF.len),D=="B"&&ee=="N"&&(D="N",W[w]=S[w].DBF.dec,re=S[w].DBF.len),K[w]=D=="C"||ee=="N"?re:s[D]||0,I+=K[w],R[w]=D}var ue=g.next(32);for(ue.write_shift(4,318902576),ue.write_shift(4,T.length),ue.write_shift(2,296+32*P),ue.write_shift(2,I),w=0;w<4;++w)ue.write_shift(4,0);for(ue.write_shift(4,0|(+t[Ko]||3)<<8),w=0,E=0;w<_.length;++w)if(_[w]!=null){var ce=g.next(32),Ce=(_[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ce.write_shift(1,Ce,"sbcs"),ce.write_shift(1,R[w]=="?"?"C":R[w],"sbcs"),ce.write_shift(4,E),ce.write_shift(1,K[w]||s[R[w]]||0),ce.write_shift(1,W[w]||0),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(1,0),ce.write_shift(4,0),ce.write_shift(4,0),E+=K[w]||s[R[w]]||0}var ye=g.next(264);for(ye.write_shift(4,13),w=0;w<65;++w)ye.write_shift(4,0);for(w=0;w<T.length;++w){var he=g.next(I);for(he.write_shift(1,0),E=0;E<_.length;++E)if(_[E]!=null)switch(R[E]){case"L":he.write_shift(1,T[w][E]==null?63:T[w][E]?84:70);break;case"B":he.write_shift(8,T[w][E]||0,"f");break;case"N":var le="0";for(typeof T[w][E]=="number"&&(le=T[w][E].toFixed(W[E]||0)),P=0;P<K[E]-le.length;++P)he.write_shift(1,32);he.write_shift(1,le,"sbcs");break;case"D":T[w][E]?(he.write_shift(4,("0000"+T[w][E].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(T[w][E].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+T[w][E].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var j=String(T[w][E]!=null?T[w][E]:"").slice(0,K[E]);for(he.write_shift(1,j,"sbcs"),P=0;P<K[E]-j.length;++P)he.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),yw=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Er(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,T){var S=e[T];return typeof S=="number"?qm(S):S},n=function(_,T,S){var w=T.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return w==59?_:qm(w)};e["|"]=254;function a(_,T){switch(T.type){case"base64":return s(ha(_),T);case"binary":return s(_,T);case"buffer":return s(Dt&&Buffer.isBuffer(_)?_.toString("binary"):oo(_),T);case"array":return s(qo(_),T)}throw new Error("Unrecognized type "+T.type)}function s(_,T){var S=_.split(/[\n\r]+/),w=-1,E=-1,P=0,I=0,A=[],R=[],K=null,W={},D=[],ee=[],re=[],pe=0,ue;for(+T.codepage>=0&&ja(+T.codepage);P!==S.length;++P){pe=0;var ce=S[P].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Ce=ce.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),ye=Ce[0],he;if(ce.length>0)switch(ye){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ce[1].charAt(0)=="P"&&R.push(ce.slice(3).replace(/;;/g,";"));break;case"C":var le=!1,j=!1,H=!1,O=!1,ne=-1,Y=-1;for(I=1;I<Ce.length;++I)switch(Ce[I].charAt(0)){case"A":break;case"X":E=parseInt(Ce[I].slice(1))-1,j=!0;break;case"Y":for(w=parseInt(Ce[I].slice(1))-1,j||(E=0),ue=A.length;ue<=w;++ue)A[ue]=[];break;case"K":he=Ce[I].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(ai(he))?isNaN(yc(he).getDate())||(he=fr(he)):(he=ai(he),K!==null&&nl(K)&&(he=Sh(he))),typeof Bt<"u"&&typeof he=="string"&&(T||{}).type!="string"&&(T||{}).codepage&&(he=Bt.utils.decode(T.codepage,he)),le=!0;break;case"E":O=!0;var F=pc(Ce[I].slice(1),{r:w,c:E});A[w][E]=[A[w][E],F];break;case"S":H=!0,A[w][E]=[A[w][E],"S5S"];break;case"G":break;case"R":ne=parseInt(Ce[I].slice(1))-1;break;case"C":Y=parseInt(Ce[I].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ce)}if(le&&(A[w][E]&&A[w][E].length==2?A[w][E][0]=he:A[w][E]=he,K=null),H){if(O)throw new Error("SYLK shared formula cannot have own formula");var U=ne>-1&&A[ne][Y];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");A[w][E][1]=Lw(U[1],{r:w-ne,c:E-Y})}break;case"F":var z=0;for(I=1;I<Ce.length;++I)switch(Ce[I].charAt(0)){case"X":E=parseInt(Ce[I].slice(1))-1,++z;break;case"Y":for(w=parseInt(Ce[I].slice(1))-1,ue=A.length;ue<=w;++ue)A[ue]=[];break;case"M":pe=parseInt(Ce[I].slice(1))/20;break;case"F":break;case"G":break;case"P":K=R[parseInt(Ce[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(re=Ce[I].slice(1).split(" "),ue=parseInt(re[0],10);ue<=parseInt(re[1],10);++ue)pe=parseInt(re[2],10),ee[ue-1]=pe===0?{hidden:!0}:{wch:pe},no(ee[ue-1]);break;case"C":E=parseInt(Ce[I].slice(1))-1,ee[E]||(ee[E]={});break;case"R":w=parseInt(Ce[I].slice(1))-1,D[w]||(D[w]={}),pe>0?(D[w].hpt=pe,D[w].hpx=wc(pe)):pe===0&&(D[w].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ce)}z<1&&(K=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ce)}}return D.length>0&&(W["!rows"]=D),ee.length>0&&(W["!cols"]=ee),T&&T.sheetRows&&(A=A.slice(0,T.sheetRows)),[A,W]}function l(_,T){var S=a(_,T),w=S[0],E=S[1],P=Ec(w,T);return Er(E).forEach(function(I){P[I]=E[I]}),P}function u(_,T){return lo(l(_,T),T)}function m(_,T,S,w){var E="C;Y"+(S+1)+";X"+(w+1)+";K";switch(_.t){case"n":E+=_.v||0,_.f&&!_.F&&(E+=";E"+tg(_.f,{r:S,c:w}));break;case"b":E+=_.v?"TRUE":"FALSE";break;case"e":E+=_.w||_.v;break;case"d":E+='"'+(_.w||_.v)+'"';break;case"s":E+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function p(_,T){T.forEach(function(S,w){var E="F;W"+(w+1)+" "+(w+1)+" ";S.hidden?E+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=qu(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=Xu(S.wpx)),typeof S.wch=="number"&&(E+=Math.round(S.wch))),E.charAt(E.length-1)!=" "&&_.push(E)})}function g(_,T){T.forEach(function(S,w){var E="F;";S.hidden?E+="M0;":S.hpt?E+="M"+20*S.hpt+";":S.hpx&&(E+="M"+20*Ju(S.hpx)+";"),E.length>2&&_.push(E+"R"+(w+1))})}function y(_,T){var S=["ID;PWXL;N;E"],w=[],E=Lt(_["!ref"]),P,I=Array.isArray(_),A=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&p(S,_["!cols"]),_["!rows"]&&g(S,_["!rows"]),S.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var R=E.s.r;R<=E.e.r;++R)for(var K=E.s.c;K<=E.e.c;++K){var W=_t({r:R,c:K});P=I?(_[R]||[])[K]:_[W],!(!P||P.v==null&&(!P.f||P.F))&&w.push(m(P,_,R,K))}return S.join(A)+A+w.join(A)+A+"E"+A}return{to_workbook:u,to_sheet:l,from_sheet:y}})(),_w=(function(){function e(s,l){switch(l.type){case"base64":return t(ha(s),l);case"binary":return t(s,l);case"buffer":return t(Dt&&Buffer.isBuffer(s)?s.toString("binary"):oo(s),l);case"array":return t(qo(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var u=s.split(`
`),m=-1,p=-1,g=0,y=[];g!==u.length;++g){if(u[g].trim()==="BOT"){y[++m]=[],p=0;continue}if(!(m<0)){var _=u[g].trim().split(","),T=_[0],S=_[1];++g;for(var w=u[g]||"";(w.match(/["]/g)||[]).length&1&&g<u.length-1;)w+=`
`+u[++g];switch(w=w.trim(),+T){case-1:if(w==="BOT"){y[++m]=[],p=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?y[m][p]=!0:w==="FALSE"?y[m][p]=!1:isNaN(ai(S))?isNaN(yc(S).getDate())?y[m][p]=S:y[m][p]=fr(S):y[m][p]=ai(S),++p;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),y[m][p++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(y=y.slice(0,l.sheetRows)),y}function r(s,l){return Ec(e(s,l),l)}function n(s,l){return lo(r(s,l),l)}var a=(function(){var s=function(m,p,g,y,_){m.push(p),m.push(g+","+y),m.push('"'+_.replace(/"/g,'""')+'"')},l=function(m,p,g,y){m.push(p+","+g),m.push(p==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(m){var p=[],g=Lt(m["!ref"]),y,_=Array.isArray(m);s(p,"TABLE",0,1,"sheetjs"),s(p,"VECTORS",0,g.e.r-g.s.r+1,""),s(p,"TUPLES",0,g.e.c-g.s.c+1,""),s(p,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){l(p,-1,0,"BOT");for(var S=g.s.c;S<=g.e.c;++S){var w=_t({r:T,c:S});if(y=_?(m[T]||[])[S]:m[w],!y){l(p,1,0,"");continue}switch(y.t){case"n":var E=y.w;!E&&y.v!=null&&(E=y.v),E==null?y.f&&!y.F?l(p,1,0,"="+y.f):l(p,1,0,""):l(p,0,E,"V");break;case"b":l(p,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":l(p,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=ma(y.z||yt[14],Kr(fr(y.v)))),l(p,0,y.w,"V");break;default:l(p,1,0,"")}}}l(p,-1,0,"EOD");var P=`\r
`,I=p.join(P);return I}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),ww=(function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(y,_){for(var T=y.split(`
`),S=-1,w=-1,E=0,P=[];E!==T.length;++E){var I=T[E].trim().split(":");if(I[0]==="cell"){var A=_r(I[1]);if(P.length<=A.r)for(S=P.length;S<=A.r;++S)P[S]||(P[S]=[]);switch(S=A.r,w=A.c,I[2]){case"t":P[S][w]=e(I[3]);break;case"v":P[S][w]=+I[3];break;case"vtf":var R=I[I.length-1];case"vtc":switch(I[3]){case"nl":P[S][w]=!!+I[4];break;default:P[S][w]=+I[4];break}I[2]=="vtf"&&(P[S][w]=[P[S][w],R])}}}return _&&_.sheetRows&&(P=P.slice(0,_.sheetRows)),P}function n(y,_){return Ec(r(y,_),_)}function a(y,_){return lo(n(y,_),_)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function p(y){if(!y||!y["!ref"])return"";for(var _=[],T=[],S,w="",E=Ln(y["!ref"]),P=Array.isArray(y),I=E.s.r;I<=E.e.r;++I)for(var A=E.s.c;A<=E.e.c;++A)if(w=_t({r:I,c:A}),S=P?(y[I]||[])[A]:y[w],!(!S||S.v==null||S.t==="z")){switch(T=["cell",w,"t"],S.t){case"s":case"str":T.push(t(S.v));break;case"n":S.f?(T[2]="vtf",T[3]="n",T[4]=S.v,T[5]=t(S.f)):(T[2]="v",T[3]=S.v);break;case"b":T[2]="vt"+(S.f?"f":"c"),T[3]="nl",T[4]=S.v?"1":"0",T[5]=t(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var R=Kr(fr(S.v));T[2]="vtc",T[3]="nd",T[4]=""+R,T[5]=S.w||ma(S.z||yt[14],R);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(y){return[s,l,u,l,p(y),m].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:g}})(),_c=(function(){function e(g,y,_,T,S){S.raw?y[_][T]=g:g===""||(g==="TRUE"?y[_][T]=!0:g==="FALSE"?y[_][T]=!1:isNaN(ai(g))?isNaN(yc(g).getDate())?y[_][T]=g:y[_][T]=fr(g):y[_][T]=ai(g))}function t(g,y){var _=y||{},T=[];if(!g||g.length===0)return T;for(var S=g.split(/[\r\n]/),w=S.length-1;w>=0&&S[w].length===0;)--w;for(var E=10,P=0,I=0;I<=w;++I)P=S[I].indexOf(" "),P==-1?P=S[I].length:P++,E=Math.max(E,P);for(I=0;I<=w;++I){T[I]=[];var A=0;for(e(S[I].slice(0,E).trim(),T,I,A,_),A=1;A<=(S[I].length-E)/10+1;++A)e(S[I].slice(E+(A-1)*10,E+A*10).trim(),T,I,A,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(g){for(var y={},_=!1,T=0,S=0;T<g.length;++T)(S=g.charCodeAt(T))==34?_=!_:!_&&S in r&&(y[S]=(y[S]||0)+1);S=[];for(T in y)Object.prototype.hasOwnProperty.call(y,T)&&S.push([y[T],T]);if(!S.length){y=n;for(T in y)Object.prototype.hasOwnProperty.call(y,T)&&S.push([y[T],T])}return S.sort(function(w,E){return w[0]-E[0]||n[w[1]]-n[E[1]]}),r[S.pop()[1]]||44}function s(g,y){var _=y||{},T="",S=_.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=a(g.slice(0,1024)):_&&_.FS?T=_.FS:T=a(g.slice(0,1024));var E=0,P=0,I=0,A=0,R=0,K=T.charCodeAt(0),W=!1,D=0,ee=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var re=_.dateNF!=null?bA(_.dateNF):null;function pe(){var ue=g.slice(A,R),ce={};if(ue.charAt(0)=='"'&&ue.charAt(ue.length-1)=='"'&&(ue=ue.slice(1,-1).replace(/""/g,'"')),ue.length===0)ce.t="z";else if(_.raw)ce.t="s",ce.v=ue;else if(ue.trim().length===0)ce.t="s",ce.v=ue;else if(ue.charCodeAt(0)==61)ue.charCodeAt(1)==34&&ue.charCodeAt(ue.length-1)==34?(ce.t="s",ce.v=ue.slice(2,-1).replace(/""/g,'"')):J3(ue)?(ce.t="n",ce.f=ue.slice(1)):(ce.t="s",ce.v=ue);else if(ue=="TRUE")ce.t="b",ce.v=!0;else if(ue=="FALSE")ce.t="b",ce.v=!1;else if(!isNaN(I=ai(ue)))ce.t="n",_.cellText!==!1&&(ce.w=ue),ce.v=I;else if(!isNaN(yc(ue).getDate())||re&&ue.match(re)){ce.z=_.dateNF||yt[14];var Ce=0;re&&ue.match(re)&&(ue=kA(ue,_.dateNF,ue.match(re)||[]),Ce=1),_.cellDates?(ce.t="d",ce.v=fr(ue,Ce)):(ce.t="n",ce.v=Kr(fr(ue,Ce))),_.cellText!==!1&&(ce.w=ma(ce.z,ce.v instanceof Date?Kr(ce.v):ce.v)),_.cellNF||delete ce.z}else ce.t="s",ce.v=ue;if(ce.t=="z"||(_.dense?(S[E]||(S[E]=[]),S[E][P]=ce):S[_t({c:P,r:E})]=ce),A=R+1,ee=g.charCodeAt(A),w.e.c<P&&(w.e.c=P),w.e.r<E&&(w.e.r=E),D==K)++P;else if(P=0,++E,_.sheetRows&&_.sheetRows<=E)return!0}e:for(;R<g.length;++R)switch(D=g.charCodeAt(R)){case 34:ee===34&&(W=!W);break;case K:case 10:case 13:if(!W&&pe())break e;break}return R-A>0&&pe(),S["!ref"]=Pt(w),S}function l(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?s(g,y):Ec(t(g,y),y)}function u(g,y){var _="",T=y.type=="string"?[0,0,0,0]:ug(g,y);switch(y.type){case"base64":_=ha(g);break;case"binary":_=g;break;case"buffer":y.codepage==65001?_=g.toString("utf8"):y.codepage&&typeof Bt<"u"?_=Bt.utils.decode(y.codepage,g):_=Dt&&Buffer.isBuffer(g)?g.toString("binary"):oo(g);break;case"array":_=qo(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+y.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=nr(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=nr(_):y.type=="binary"&&typeof Bt<"u"&&y.codepage&&(_=Bt.utils.decode(y.codepage,Bt.utils.encode(28591,_))),_.slice(0,19)=="socialcalc:version:"?ww.to_sheet(y.type=="string"?_:nr(_),y):l(_,y)}function m(g,y){return lo(u(g,y),y)}function p(g){for(var y=[],_=Lt(g["!ref"]),T,S=Array.isArray(g),w=_.s.r;w<=_.e.r;++w){for(var E=[],P=_.s.c;P<=_.e.c;++P){var I=_t({r:w,c:P});if(T=S?(g[w]||[])[P]:g[I],!T||T.v==null){E.push("          ");continue}for(var A=(T.w||(Ai(T),T.w)||"").slice(0,10);A.length<10;)A+=" ";E.push(A+(P===0?" ":""))}y.push(E.join(""))}return y.join(`
`)}return{to_workbook:m,to_sheet:u,from_sheet:p}})();function MP(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=yw.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return _c.to_workbook(e,t)}}var Go=(function(){function e(F,U,z){if(F){ln(F,F.l||0);for(var q=z.Enum||ne;F.l<F.length;){var M=F.read_shift(2),oe=q[M]||q[65535],se=F.read_shift(2),fe=F.l+se,xe=oe.f&&oe.f(F,se,z);if(F.l=fe,U(xe,oe,M))return}}}function t(F,U){switch(U.type){case"base64":return r(ua(ha(F)),U);case"binary":return r(ua(F),U);case"buffer":case"array":return r(F,U)}throw"Unsupported type "+U.type}function r(F,U){if(!F)return F;var z=U||{},q=z.dense?[]:{},M="Sheet1",oe="",se=0,fe={},xe=[],je=[],X={s:{r:0,c:0},e:{r:0,c:0}},Ke=z.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)z.Enum=ne,e(F,function(Le,kt,ft){switch(ft){case 0:z.vers=Le,Le>=4096&&(z.qpro=!0);break;case 6:X=Le;break;case 204:Le&&(oe=Le);break;case 222:oe=Le;break;case 15:case 51:z.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:ft==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=z.dateNF||yt[14],z.cellDates&&(Le[1].t="d",Le[1].v=Sh(Le[1].v))),z.qpro&&Le[3]>se&&(q["!ref"]=Pt(X),fe[M]=q,xe.push(M),q=z.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},se=Le[3],M=oe||"Sheet"+(se+1),oe="");var pt=z.dense?(q[Le[0].r]||[])[Le[0].c]:q[_t(Le[0])];if(pt){pt.t=Le[1].t,pt.v=Le[1].v,Le[1].z!=null&&(pt.z=Le[1].z),Le[1].f!=null&&(pt.f=Le[1].f);break}z.dense?(q[Le[0].r]||(q[Le[0].r]=[]),q[Le[0].r][Le[0].c]=Le[1]):q[_t(Le[0])]=Le[1];break}},z);else if(F[2]==26||F[2]==14)z.Enum=Y,F[2]==14&&(z.qpro=!0,F.l=0),e(F,function(Le,kt,ft){switch(ft){case 204:M=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>se&&(q["!ref"]=Pt(X),fe[M]=q,xe.push(M),q=z.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},se=Le[3],M="Sheet"+(se+1)),Ke>0&&Le[0].r>=Ke)break;z.dense?(q[Le[0].r]||(q[Le[0].r]=[]),q[Le[0].r][Le[0].c]=Le[1]):q[_t(Le[0])]=Le[1],X.e.c<Le[0].c&&(X.e.c=Le[0].c),X.e.r<Le[0].r&&(X.e.r=Le[0].r);break;case 27:Le[14e3]&&(je[Le[14e3][0]]=Le[14e3][1]);break;case 1537:je[Le[0]]=Le[1],Le[0]==se&&(M=Le[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(q["!ref"]=Pt(X),fe[oe||M]=q,xe.push(oe||M),!je.length)return{SheetNames:xe,Sheets:fe};for(var Xe={},Qe=[],it=0;it<je.length;++it)fe[xe[it]]?(Qe.push(je[it]||xe[it]),Xe[je[it]]=fe[je[it]]||fe[xe[it]]):(Qe.push(je[it]),Xe[je[it]]={"!ref":"A1"});return{SheetNames:Qe,Sheets:Xe}}function n(F,U){var z=U||{};if(+z.codepage>=0&&ja(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var q=Kn(),M=Lt(F["!ref"]),oe=Array.isArray(F),se=[];et(q,0,s(1030)),et(q,6,m(M));for(var fe=Math.min(M.e.r,8191),xe=M.s.r;xe<=fe;++xe)for(var je=Sr(xe),X=M.s.c;X<=M.e.c;++X){xe===M.s.r&&(se[X]=dr(X));var Ke=se[X]+je,Xe=oe?(F[xe]||[])[X]:F[Ke];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")(Xe.v|0)==Xe.v&&Xe.v>=-32768&&Xe.v<=32767?et(q,13,T(xe,X,Xe.v)):et(q,14,w(xe,X,Xe.v));else{var Qe=Ai(Xe);et(q,15,y(xe,X,Qe.slice(0,239)))}}return et(q,1),q.end()}function a(F,U){var z=U||{};if(+z.codepage>=0&&ja(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var q=Kn();et(q,0,l(F));for(var M=0,oe=0;M<F.SheetNames.length;++M)(F.Sheets[F.SheetNames[M]]||{})["!ref"]&&et(q,27,O(F.SheetNames[M],oe++));var se=0;for(M=0;M<F.SheetNames.length;++M){var fe=F.Sheets[F.SheetNames[M]];if(!(!fe||!fe["!ref"])){for(var xe=Lt(fe["!ref"]),je=Array.isArray(fe),X=[],Ke=Math.min(xe.e.r,8191),Xe=xe.s.r;Xe<=Ke;++Xe)for(var Qe=Sr(Xe),it=xe.s.c;it<=xe.e.c;++it){Xe===xe.s.r&&(X[it]=dr(it));var Le=X[it]+Qe,kt=je?(fe[Xe]||[])[it]:fe[Le];if(!(!kt||kt.t=="z"))if(kt.t=="n")et(q,23,pe(Xe,it,se,kt.v));else{var ft=Ai(kt);et(q,22,D(Xe,it,se,ft.slice(0,239)))}}++se}}return et(q,1),q.end()}function s(F){var U=Fe(2);return U.write_shift(2,F),U}function l(F){var U=Fe(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var z=0,q=0,M=0,oe=0;oe<F.SheetNames.length;++oe){var se=F.SheetNames[oe],fe=F.Sheets[se];if(!(!fe||!fe["!ref"])){++M;var xe=Ln(fe["!ref"]);z<xe.e.r&&(z=xe.e.r),q<xe.e.c&&(q=xe.e.c)}}return z>8191&&(z=8191),U.write_shift(2,z),U.write_shift(1,M),U.write_shift(1,q),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function u(F,U,z){var q={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&z.qpro?(q.s.c=F.read_shift(1),F.l++,q.s.r=F.read_shift(2),q.e.c=F.read_shift(1),F.l++,q.e.r=F.read_shift(2),q):(q.s.c=F.read_shift(2),q.s.r=F.read_shift(2),U==12&&z.qpro&&(F.l+=2),q.e.c=F.read_shift(2),q.e.r=F.read_shift(2),U==12&&z.qpro&&(F.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function m(F){var U=Fe(8);return U.write_shift(2,F.s.c),U.write_shift(2,F.s.r),U.write_shift(2,F.e.c),U.write_shift(2,F.e.r),U}function p(F,U,z){var q=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(q[0].c=F.read_shift(1),q[3]=F.read_shift(1),q[0].r=F.read_shift(2),F.l+=2):(q[2]=F.read_shift(1),q[0].c=F.read_shift(2),q[0].r=F.read_shift(2)),q}function g(F,U,z){var q=F.l+U,M=p(F,U,z);if(M[1].t="s",z.vers==20768){F.l++;var oe=F.read_shift(1);return M[1].v=F.read_shift(oe,"utf8"),M}return z.qpro&&F.l++,M[1].v=F.read_shift(q-F.l,"cstr"),M}function y(F,U,z){var q=Fe(7+z.length);q.write_shift(1,255),q.write_shift(2,U),q.write_shift(2,F),q.write_shift(1,39);for(var M=0;M<q.length;++M){var oe=z.charCodeAt(M);q.write_shift(1,oe>=128?95:oe)}return q.write_shift(1,0),q}function _(F,U,z){var q=p(F,U,z);return q[1].v=F.read_shift(2,"i"),q}function T(F,U,z){var q=Fe(7);return q.write_shift(1,255),q.write_shift(2,U),q.write_shift(2,F),q.write_shift(2,z,"i"),q}function S(F,U,z){var q=p(F,U,z);return q[1].v=F.read_shift(8,"f"),q}function w(F,U,z){var q=Fe(13);return q.write_shift(1,255),q.write_shift(2,U),q.write_shift(2,F),q.write_shift(8,z,"f"),q}function E(F,U,z){var q=F.l+U,M=p(F,U,z);if(M[1].v=F.read_shift(8,"f"),z.qpro)F.l=q;else{var oe=F.read_shift(2);R(F.slice(F.l,F.l+oe),M),F.l+=oe}return M}function P(F,U,z){var q=U&32768;return U&=-32769,U=(q?F:0)+(U>=8192?U-16384:U),(q?"":"$")+(z?dr(U):Sr(U))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(F,U){ln(F,0);for(var z=[],q=0,M="",oe="",se="",fe="";F.l<F.length;){var xe=F[F.l++];switch(xe){case 0:z.push(F.read_shift(8,"f"));break;case 1:oe=P(U[0].c,F.read_shift(2),!0),M=P(U[0].r,F.read_shift(2),!1),z.push(oe+M);break;case 2:{var je=P(U[0].c,F.read_shift(2),!0),X=P(U[0].r,F.read_shift(2),!1);oe=P(U[0].c,F.read_shift(2),!0),M=P(U[0].r,F.read_shift(2),!1),z.push(je+X+":"+oe+M)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(F.read_shift(2));break;case 6:{for(var Ke="";xe=F[F.l++];)Ke+=String.fromCharCode(xe);z.push('"'+Ke.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:fe=z.pop(),se=z.pop(),z.push(["AND","OR"][xe-20]+"("+se+","+fe+")");break;default:if(xe<32&&A[xe])fe=z.pop(),se=z.pop(),z.push(se+A[xe]+fe);else if(I[xe]){if(q=I[xe][1],q==69&&(q=F[F.l++]),q>z.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+z.join("|")+"|");return}var Xe=z.slice(-q);z.length-=q,z.push(I[xe][0]+"("+Xe.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}z.length==1?U[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function K(F){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=F.read_shift(2),U[3]=F[F.l++],U[0].c=F[F.l++],U}function W(F,U){var z=K(F);return z[1].t="s",z[1].v=F.read_shift(U-4,"cstr"),z}function D(F,U,z,q){var M=Fe(6+q.length);M.write_shift(2,F),M.write_shift(1,z),M.write_shift(1,U),M.write_shift(1,39);for(var oe=0;oe<q.length;++oe){var se=q.charCodeAt(oe);M.write_shift(1,se>=128?95:se)}return M.write_shift(1,0),M}function ee(F,U){var z=K(F);z[1].v=F.read_shift(2);var q=z[1].v>>1;if(z[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return z[1].v=q,z}function re(F,U){var z=K(F),q=F.read_shift(4),M=F.read_shift(4),oe=F.read_shift(2);if(oe==65535)return q===0&&M===3221225472?(z[1].t="e",z[1].v=15):q===0&&M===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var se=oe&32768;return oe=(oe&32767)-16446,z[1].v=(1-se*2)*(M*Math.pow(2,oe+32)+q*Math.pow(2,oe)),z}function pe(F,U,z,q){var M=Fe(14);if(M.write_shift(2,F),M.write_shift(1,z),M.write_shift(1,U),q==0)return M.write_shift(4,0),M.write_shift(4,0),M.write_shift(2,65535),M;var oe=0,se=0,fe=0,xe=0;return q<0&&(oe=1,q=-q),se=Math.log2(q)|0,q/=Math.pow(2,se-31),xe=q>>>0,(xe&2147483648)==0&&(q/=2,++se,xe=q>>>0),q-=xe,xe|=2147483648,xe>>>=0,q*=Math.pow(2,32),fe=q>>>0,M.write_shift(4,fe),M.write_shift(4,xe),se+=16383+(oe?32768:0),M.write_shift(2,se),M}function ue(F,U){var z=re(F);return F.l+=U-14,z}function ce(F,U){var z=K(F),q=F.read_shift(4);return z[1].v=q>>6,z}function Ce(F,U){var z=K(F),q=F.read_shift(8,"f");return z[1].v=q,z}function ye(F,U){var z=Ce(F);return F.l+=U-10,z}function he(F,U){return F[F.l+U-1]==0?F.read_shift(U,"cstr"):""}function le(F,U){var z=F[F.l++];z>U-1&&(z=U-1);for(var q="";q.length<z;)q+=String.fromCharCode(F[F.l++]);return q}function j(F,U,z){if(!(!z.qpro||U<21)){var q=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var M=F.read_shift(U-21,"cstr");return[q,M]}}function H(F,U){for(var z={},q=F.l+U;F.l<q;){var M=F.read_shift(2);if(M==14e3){for(z[M]=[0,""],z[M][0]=F.read_shift(2);F[F.l];)z[M][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return z}function O(F,U){var z=Fe(5+F.length);z.write_shift(2,14e3),z.write_shift(2,U);for(var q=0;q<F.length;++q){var M=F.charCodeAt(q);z[z.l++]=M>127?95:M}return z[z.l++]=0,z}var ne={0:{n:"BOF",f:Mr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:le},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:re},24:{n:"NUMBER18",f:ee},25:{n:"FORMULA19",f:ue},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:H},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ce},38:{n:"??"},39:{n:"NUMBER27",f:Ce},40:{n:"FORMULA28",f:ye},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:j},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function BP(e){var t={},r=e.match(En),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=bt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Sp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var zP=(function(){var e=Vu("t"),t=Vu("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var u={t:"s",v:Ut(l[1])},m=s.match(t);return m&&(u.s=BP(m[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),UP=(function(){var t=/(\r\n|\n)/g;function r(a,s,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),s.push('<span style="'+u.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var m=a.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(s.push("<"+m+">"),l.push("</"+m+">")),l.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),WP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$P=/<(?:\w+:)?r>/,HP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function qp(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ut(nr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=nr(e),r&&(n.h=Dp(n.t))):e.match($P)&&(n.r=nr(e),n.t=Ut(nr((e.replace(HP,"").match(WP)||[]).join("").replace(En,""))),r&&(n.h=UP(zP(n.r)))),n):{t:""}}var VP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,GP=/<(?:\w+:)?(?:si|sstItem)>/g,ZP=/<\/(?:\w+:)?(?:si|sstItem)>/;function KP(e,t){var r=[],n="";if(!e)return r;var a=e.match(VP);if(a){n=a[2].replace(GP,"").split(ZP);for(var s=0;s!=n.length;++s){var l=qp(n[s].trim(),t);l!=null&&(r[r.length]=l)}a=bt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var YP=/^\s|\s$|[\t\n\r]/;function bw(e,t){if(!t.bookSST)return"";var r=[Dr];r[r.length]=Je("sst",null,{xmlns:al[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(YP)&&(s+=' xml:space="preserve"'),s+=">"+Xt(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function qP(e){return[e.read_shift(4),e.read_shift(4)]}function XP(e,t){var r=[],n=!1;return ss(e,function(s,l,u){switch(u){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function JP(e,t){return t||(t=Fe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var QP=c4;function e5(e){var t=Kn();Me(t,159,JP(e));for(var r=0;r<e.length;++r)Me(t,19,QP(e[r]));return Me(t,160),t.end()}function kw(e){if(typeof Bt<"u")return Bt.utils.encode(Ko,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function as(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function t5(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=as(e,4),t.U=as(e,4),t.W=as(e,4),t}function r5(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function n5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(r5(e));return t}function a5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function i5(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=as(e,4),t.U=as(e,4),t.W=as(e,4),t}function s5(e){var t=i5(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Sw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Tw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function o5(e){var t=as(e);switch(t.Minor){case 2:return[t.Minor,l5(e)];case 3:return[t.Minor,c5()];case 4:return[t.Minor,u5(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function l5(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Sw(e,r),a=Tw(e,e.length-e.l);return{t:"Std",h:n,v:a}}function c5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function u5(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(En,function(s){var l=bt(s);switch(Ni(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function d5(e,t){var r={},n=r.EncryptionVersionInfo=as(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Sw(e,a),t-=a,r.EncryptionVerifier=Tw(e,t),r}function f5(e){var t={},r=t.EncryptionVersionInfo=as(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Xp(e){var t=0,r,n=kw(e),a=n.length+1,s,l,u,m,p;for(r=ro(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)l=r[s],u=(t&16384)===0?0:1,m=t<<1&32767,p=u|m,t=p^l;return t^52811}var Ew=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},s=function(l){for(var u=t[l.length-1],m=104,p=l.length-1;p>=0;--p)for(var g=l[p],y=0;y!=7;++y)g&64&&(u^=r[m]),g*=2,--m;return u};return function(l){for(var u=kw(l),m=s(u),p=u.length,g=ro(16),y=0;y!=16;++y)g[y]=0;var _,T,S;for((p&1)===1&&(_=m>>8,g[p]=a(e[0],_),--p,_=m&255,T=u[u.length-1],g[p]=a(T,_));p>0;)--p,_=m>>8,g[p]=a(u[p],_),--p,_=m&255,g[p]=a(u[p],_);for(p=15,S=15-u.length;S>0;)_=m>>8,g[p]=a(e[S],_),--p,--S,_=m&255,g[p]=a(u[p],_),--p,--S;return g}})(),h5=function(e,t,r,n,a){a||(a=t),n||(n=Ew(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,a[s]=l,++r;return[a,r,n]},m5=function(e){var t=0,r=Ew(e);return function(n){var a=h5("",n,t,r);return t=a[1],a[0]}};function p5(e,t,r,n){var a={key:Mr(e),verificationBytes:Mr(e)};return r.password&&(a.verifier=Xp(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=m5(r.password)),a}function g5(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=f5(e):n.Data=d5(e,t),n}function v5(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?g5(e,t-2,n):p5(e,r.biff>=8?t:t-2,r,n),n}var Cw=(function(){function e(a,s){switch(s.type){case"base64":return t(ha(a),s);case"binary":return t(a,s);case"buffer":return t(Dt&&Buffer.isBuffer(a)?a.toString("binary"):oo(a),s);case"array":return t(qo(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var l=s||{},u=l.dense?[]:{},m=a.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(g,y){Array.isArray(u)&&(u[y]=[]);for(var _=/\\\w+\b/g,T=0,S,w=-1;S=_.exec(g);){switch(S[0]){case"\\cell":var E=g.slice(T,_.lastIndex-S[0].length);if(E[0]==" "&&(E=E.slice(1)),++w,E.length){var P={v:E,t:"s"};Array.isArray(u)?u[y][w]=P:u[_t({r:y,c:w})]=P}break}T=_.lastIndex}w>p.e.c&&(p.e.c=w)}),u["!ref"]=Pt(p),u}function r(a,s){return lo(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],l=Lt(a["!ref"]),u,m=Array.isArray(a),p=l.s.r;p<=l.e.r;++p){s.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)s.push("\\cellx"+(g+1));for(s.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var y=_t({r:p,c:g});u=m?(a[p]||[])[g]:a[y],!(!u||u.v==null&&(!u.f||u.F))&&(s.push(" "+(u.w||(Ai(u),u.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function x5(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Yu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function y5(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),l=a-s;if(l===0)return[0,0,t];var u=0,m=0,p=a+s;switch(m=l/(p>1?2-p:p),a){case t:u=((r-n)/l+6)%6;break;case r:u=(n-t)/l+2;break;case n:u=(t-r)/l+4;break}return[u/6,m,p/2]}function _5(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,l=[s,s,s],u=6*t,m;if(r!==0)switch(u|0){case 0:case 6:m=a*u,l[0]+=a,l[1]+=m;break;case 1:m=a*(2-u),l[0]+=m,l[1]+=a;break;case 2:m=a*(u-2),l[1]+=a,l[2]+=m;break;case 3:m=a*(4-u),l[1]+=m,l[2]+=a;break;case 4:m=a*(u-4),l[2]+=a,l[0]+=m;break;case 5:m=a*(6-u),l[2]+=m,l[0]+=a;break}for(var p=0;p!=3;++p)l[p]=Math.round(l[p]*255);return l}function uh(e,t){if(t===0)return e;var r=y5(x5(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Yu(_5(r))}var Aw=6,w5=15,b5=1,wn=Aw;function qu(e){return Math.floor((e+Math.round(128/wn)/256)*wn)}function Xu(e){return Math.floor((e-5)/wn*100+.5)/100}function dh(e){return Math.round((e*wn+5)/wn*256)/256}function bm(e){return dh(Xu(qu(e)))}function Jp(e){var t=Math.abs(e-bm(e)),r=wn;if(t>.005)for(wn=b5;wn<w5;++wn)Math.abs(e-bm(e))<=t&&(t=Math.abs(e-bm(e)),r=wn);wn=r}function no(e){e.width?(e.wpx=qu(e.width),e.wch=Xu(e.wpx),e.MDW=wn):e.wpx?(e.wch=Xu(e.wpx),e.width=dh(e.wch),e.MDW=wn):typeof e.wch=="number"&&(e.width=dh(e.wch),e.wpx=qu(e.width),e.MDW=wn),e.customWidth&&delete e.customWidth}var k5=96,Nw=k5;function Ju(e){return e*96/Nw}function wc(e){return e*Nw/96}var S5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function T5(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(En)||[]).forEach(function(l){var u=bt(l);switch(Ni(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=ur(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=ur(u.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in borders")}})}function E5(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(En)||[]).forEach(function(l){var u=bt(l);switch(Ni(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fills")}})}function C5(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(En)||[]).forEach(function(l){var u=bt(l);switch(Ni(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=nr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?ur(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?ur(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?ur(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?ur(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?ur(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?ur(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?ur(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Sp[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=ur(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var m=Ho[a.color.index];a.color.index==81&&(m=Ho[1]),m||(m=Ho[1]),a.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=uh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fonts")}})}function A5(e,t,r){t.NumberFmt=[];for(var n=Er(yt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=yt[n[a]];var s=e[0].match(En);if(s)for(a=0;a<s.length;++a){var l=bt(s[a]);switch(Ni(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Ut(nr(l.formatCode)),m=parseInt(l.numFmtId,10);if(t.NumberFmt[m]=u,m>0){if(m>392){for(m=392;m>60&&t.NumberFmt[m]!=null;--m);t.NumberFmt[m]=u}Ei(u,m)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function N5(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Je("numFmt",null,{numFmtId:n,formatCode:Xt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Je("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var zf=["numFmtId","fillId","fontId","borderId","xfId"],Uf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function P5(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(En)||[]).forEach(function(s){var l=bt(s),u=0;switch(Ni(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<zf.length;++u)n[zf[u]]&&(n[zf[u]]=parseInt(n[zf[u]],10));for(u=0;u<Uf.length;++u)n[Uf[u]]&&(n[Uf[u]]=ur(n[Uf[u]]));if(t.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[u]){n.numFmtId=u;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};l.vertical&&(m.vertical=l.vertical),l.horizontal&&(m.horizontal=l.horizontal),l.textRotation!=null&&(m.textRotation=l.textRotation),l.indent&&(m.indent=l.indent),l.wrapText&&(m.wrapText=ur(l.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function I5(e){var t=[];return t[t.length]=Je("cellXfs",null),e.forEach(function(r){t[t.length]=Je("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Je("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var D5=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,m,p){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=u.match(t))&&A5(y,g,p),(y=u.match(a))&&C5(y,g,m,p),(y=u.match(n))&&E5(y,g,m,p),(y=u.match(s))&&T5(y,g,m,p),(y=u.match(r))&&P5(y,g,p),g}})();function Pw(e,t){var r=[Dr,Je("styleSheet",null,{xmlns:al[0],"xmlns:vt":Zr.vt})],n;return e.SSF&&(n=N5(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=I5(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function F5(e,t){var r=e.read_shift(2),n=Sn(e);return[r,n]}function j5(e,t,r){r||(r=Fe(6+4*t.length)),r.write_shift(2,e),rn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function O5(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=g4(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var u=e.read_shift(1);u>0&&(n.family=u);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=p4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Sn(e),n}function R5(e,t){t||(t=Fe(153)),t.write_shift(2,e.sz*20),v4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),oh(e.color,t);var n=0;return n=2,t.write_shift(1,n),rn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var L5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],km,M5=Tn;function U1(e,t){t||(t=Fe(84)),km||(km=bh(L5));var r=km[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(oh({auto:1},t),oh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function B5(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Iw(e,t,r){r||(r=Fe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function yu(e,t){return t||(t=Fe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var z5=Tn;function U5(e,t){return t||(t=Fe(51)),t.write_shift(1,0),yu(null,t),yu(null,t),yu(null,t),yu(null,t),yu(null,t),t.length>t.l?t.slice(0,t.l):t}function W5(e,t){return t||(t=Fe(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),sh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function $5(e,t,r){var n=Fe(2052);return n.write_shift(4,e),sh(t,n),sh(r,n),n.length>n.l?n.slice(0,n.l):n}function H5(e,t,r){var n={};n.NumberFmt=[];for(var a in yt)n.NumberFmt[a]=yt[a];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return ss(e,function(m,p,g){switch(g){case 44:n.NumberFmt[m[0]]=m[1],Ei(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(m.color.rgb=uh(t.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(g),l=!0;break;case 38:s.pop(),l=!1;break;default:if(p.T>0)s.push(g);else if(p.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),n}function V5(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Me(e,615,ii(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Me(e,44,j5(a,t[a]))}),Me(e,616))}}function G5(e){var t=1;Me(e,611,ii(t)),Me(e,43,R5({sz:12,color:{theme:1},name:"Calibri",family:2})),Me(e,612)}function Z5(e){var t=2;Me(e,603,ii(t)),Me(e,45,U1({patternType:"none"})),Me(e,45,U1({patternType:"gray125"})),Me(e,604)}function K5(e){var t=1;Me(e,613,ii(t)),Me(e,46,U5()),Me(e,614)}function Y5(e){var t=1;Me(e,626,ii(t)),Me(e,47,Iw({numFmtId:0},65535)),Me(e,627)}function q5(e,t){Me(e,617,ii(t.length)),t.forEach(function(r){Me(e,47,Iw(r,0))}),Me(e,618)}function X5(e){var t=1;Me(e,619,ii(t)),Me(e,48,W5({xfId:0,name:"Normal"})),Me(e,620)}function J5(e){var t=0;Me(e,505,ii(t)),Me(e,506)}function Q5(e){var t=0;Me(e,508,$5(t,"TableStyleMedium9","PivotStyleMedium4")),Me(e,509)}function e3(e,t){var r=Kn();return Me(r,278),V5(r,e.SSF),G5(r),Z5(r),K5(r),Y5(r),q5(r,t.cellXfs),X5(r),J5(r),Q5(r),Me(r,279),r.end()}var t3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function r3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(En)||[]).forEach(function(a){var s=bt(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[t3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function n3(){}function a3(){}var i3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,s3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,o3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function l3(e,t,r){t.themeElements={};var n;[["clrScheme",i3,r3],["fontScheme",s3,n3],["fmtScheme",o3,a3]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var c3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Dw(e,t){(!e||e.length===0)&&(e=Qp());var r,n={};if(!(r=e.match(c3)))throw new Error("themeElements not found in theme");return l3(r[0],n,t),n.raw=e,n}function Qp(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Dr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function u3(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=A_(s,{type:"array"})}catch{return}var u=da(l,"theme/theme/theme1.xml",!0);if(u)return Dw(u,r)}}function d3(e){return e.read_shift(4)}function f3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=h3(e,4);break;case 2:t.xclrValue=dw(e);break;case 3:t.xclrValue=d3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function h3(e,t){return Tn(e,t)}function m3(e,t){return Tn(e,t)}function p3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=f3(e);break;case 6:n[1]=m3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function g3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(p3(e,r-e.l));return{ixfe:n,ext:s}}function v3(e,t){t.forEach(function(r){r[0]})}function x3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Sn(e)}}function y3(e){var t=Fe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),rn(e.name,t),t.slice(0,t.l)}function _3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function w3(e){var t=Fe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function b3(e,t){var r=Fe(8+2*t.length);return r.write_shift(4,e),rn(t,r),r.slice(0,r.l)}function k3(e){return e.l+=4,e.read_shift(4)!=0}function S3(e,t){var r=Fe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function T3(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],l=!1,u=2;return ss(e,function(m,p,g){switch(g){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(y){u==1?n.Cell.push({type:n.Types[y[0]-1].name,index:y[1]}):u==0&&n.Value.push({type:n.Types[y[0]-1].name,index:y[1]})});break;case 337:u=m?1:0;break;case 338:u=2;break;case 35:s.push(g),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!p.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function E3(){var e=Kn();return Me(e,332),Me(e,334,ii(1)),Me(e,335,y3({name:"XLDAPR",version:12e4,flags:3496657072})),Me(e,336),Me(e,339,b3(1,"XLDAPR")),Me(e,52),Me(e,35,ii(514)),Me(e,4096,ii(0)),Me(e,4097,Da(1)),Me(e,36),Me(e,53),Me(e,340),Me(e,337,S3(1)),Me(e,51,w3([[1,0]])),Me(e,338),Me(e,333),e.end()}function C3(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,l;return e.replace(En,function(u){var m=bt(u);switch(Ni(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var p=0;p<n.Types.length;++p)n.Types[p].name==m.name&&(l=n.Types[p]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):s==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+m.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return u}),n}function Fw(){var e=[Dr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function A3(e){var t=[];if(!e)return t;var r=1;return(e.match(En)||[]).forEach(function(n){var a=bt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function N3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=_t(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function P3(e,t,r){var n=[];return ss(e,function(s,l,u){switch(u){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function I3(e,t,r,n){if(!e)return e;var a=n||{},s=!1;ss(e,function(u,m,p){switch(p){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!m.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}},a)}function D3(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var dc=1024;function jw(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Je("xml",null,{"xmlns:v":ca.v,"xmlns:o":ca.o,"xmlns:x":ca.x,"xmlns:mv":ca.mv}).replace(/\/>/,">"),Je("o:shapelayout",Je("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Je("v:shapetype",[Je("v:stroke",null,{joinstyle:"miter"}),Je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];dc<e*1e3;)dc+=1e3;return t.forEach(function(s){var l=_r(s[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var m=u.type=="gradient"?Je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,p=Je("v:fill",m,u),g={on:"t",obscured:"t"};++dc,a=a.concat(["<v:shape"+Gu({id:"_x0000_s"+dc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",p,Je("v:shadow",null,g),Je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),cn("x:AutoFill","False"),cn("x:Row",String(l.r)),cn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function W1(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(l){var u=_r(l.ref);if(a?(e[u.r]||(e[u.r]=[]),s=e[u.r][u.c]):s=e[l.ref],!s){s={t:"z"},a?e[u.r][u.c]=s:e[l.ref]=s;var m=Lt(e["!ref"]||"BDWGO1000001:A1");m.s.r>u.r&&(m.s.r=u.r),m.e.r<u.r&&(m.e.r=u.r),m.s.c>u.c&&(m.s.c=u.c),m.e.c<u.c&&(m.e.c=u.c);var p=Pt(m);p!==e["!ref"]&&(e["!ref"]=p)}s.c||(s.c=[]);var g={a:l.author,t:l.t,r:l.r,T:r};l.h&&(g.h=l.h);for(var y=s.c.length-1;y>=0;--y){if(!r&&s.c[y].T)return;r&&!s.c[y].T&&s.c.splice(y,1)}if(r&&n){for(y=0;y<n.length;++y)if(g.a==n[y].id){g.a=n[y].name||g.a;break}}s.c.push(g)})}function F3(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var m=bt(u[0]),p={author:m.authorId&&r[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},g=_r(m.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var y=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!y&&!!y[1]&&qp(y[1])||{r:"",t:"",h:""};p.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),p.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(p.h=_.h),n.push(p)}}}}),n}function Ow(e){var t=[Dr,Je("comments",null,{xmlns:al[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Xt(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(m){m.a&&(a=r.indexOf(Xt(m.a))),s.push(m.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(cn("t",Xt(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)l+=`Reply:
    `+s[u]+`
`;t.push(cn("t",Xt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function j3(e,t){var r=[],n=!1,a={},s=0;return e.replace(En,function(u,m){var p=bt(u);switch(Ni(p[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:p.personId,guid:p.id,ref:p.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=m+u.length;break;case"</text>":a.t=e.slice(s,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+p[0]+" in threaded comments")}return u}),r}function O3(e,t,r){var n=[Dr,Je("ThreadedComments",null,{xmlns:Zr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var m={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?s=m.id:m.parentId=s,l.ID=m.id,l.a&&(m.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Je("threadedComment",cn("text",l.t||""),m))})}),n.push("</ThreadedComments>"),n.join("")}function R3(e,t){var r=[],n=!1;return e.replace(En,function(s){var l=bt(s);switch(Ni(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function L3(e){var t=[Dr,Je("personList",null,{xmlns:Zr.TCMNT,"xmlns:x":al[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Je("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function M3(e){var t={};t.iauthor=e.read_shift(4);var r=ll(e);return t.rfx=r.s,t.ref=_t(r.s),e.l+=16,t}function B3(e,t){return t==null&&(t=Fe(36)),t.write_shift(4,e[1].iauthor),Cc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var z3=Sn;function U3(e){return rn(e.slice(0,54))}function W3(e,t){var r=[],n=[],a={},s=!1;return ss(e,function(u,m,p){switch(p){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function $3(e){var t=Kn(),r=[];return Me(t,628),Me(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Me(t,632,U3(a.a)))})}),Me(t,631),Me(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:_r(n[0]),e:_r(n[0])};Me(t,635,B3([s,a])),a.t&&a.t.length>0&&Me(t,637,d4(a)),Me(t,636),delete a.iauthor})}),Me(t,634),Me(t,629),t.end()}var H3="application/vnd.ms-office.vbaProject";function V3(e){var t=dt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");dt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),dt.write(t)}function G3(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&dt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var Rw=["xlsb","xlsm","xlam","biff8","xla"];function Z3(){return{"!type":"dialog"}}function K3(){return{"!type":"dialog"}}function Y3(){return{"!type":"macro"}}function q3(){return{"!type":"macro"}}var pc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,l){var u=!1,m=!1;s.length==0?m=!0:s.charAt(0)=="["&&(m=!0,s=s.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var p=s.length>0?parseInt(s,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return u?g+=t.c:--g,m?p+=t.r:--p,a+(u?"":"$")+dr(g)+(m?"":"$")+Sr(p)}return function(a,s){return t=s,a.replace(e,r)}})(),eg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tg=(function(){return function(t,r){return t.replace(eg,function(n,a,s,l,u,m){var p=Up(l)-(s?0:r.c),g=zp(m)-(u?0:r.r),y=g==0?"":u?g+1:"["+g+"]",_=p==0?"":s?p+1:"["+p+"]";return a+"R"+y+"C"+_})}})();function Lw(e,t){return e.replace(eg,function(r,n,a,s,l,u){return n+(a=="$"?a+s:dr(Up(s)+t.c))+(l=="$"?l+u:Sr(zp(u)+t.r))})}function X3(e,t,r){var n=Ln(t),a=n.s,s=_r(r),l={r:s.r-a.r,c:s.c-a.c};return Lw(e,l)}function J3(e){return e.length!=1}function $1(e){return e.replace(/_xlfn\./g,"")}function Rr(e){e.l+=1}function ao(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Mw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Bw(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),l=ao(e),u=ao(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function Bw(e){var t=ao(e),r=ao(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Q3(e,t,r){if(r.biff<8)return Bw(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=ao(e),l=ao(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function zw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return eI(e);var n=e.read_shift(r&&r.biff==12?4:2),a=ao(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function eI(e){var t=ao(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function tI(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function rI(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return nI(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:u}}function nI(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function aI(e,t,r){var n=(e[e.l++]&96)>>5,a=Mw(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function iI(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=Mw(e,s,r);return[n,a,l]}function sI(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function oI(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function lI(e,t,r){var n=(e[e.l++]&96)>>5,a=Q3(e,t-1,r);return[n,a]}function cI(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function H1(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function uI(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function dI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function fI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function hI(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function mI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Uw(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function pI(e){return e.read_shift(2),Uw(e)}function gI(e){return e.read_shift(2),Uw(e)}function vI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=zw(e,0,r);return[n,a]}function xI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=rI(e,0,r);return[n,a]}function yI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=zw(e,0,r);return[n,a,s]}function _I(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[kD[a],Hw[a],n]}function wI(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:bI(e);return[a,(s[0]===0?Hw:bD)[s[1]]]}function bI(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function kI(e,t,r){e.l+=r&&r.biff==2?3:4}function SI(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function TI(e){return e.l++,os[e.read_shift(1)]}function EI(e){return e.l++,e.read_shift(2)}function CI(e){return e.l++,e.read_shift(1)!==0}function AI(e){return e.l++,bn(e)}function NI(e,t,r){return e.l++,ld(e,t-1,r)}function PI(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ir(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=os[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=bn(e);break;case 2:r[1]=cl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function II(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?ll:Eh)(e));return a}function DI(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var u=0;u!=a;++u)l[s][u]=PI(e,r.biff);return l}function FI(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function jI(e,t,r){if(r.biff==5)return OI(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function OI(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function RI(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function LI(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function MI(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function BI(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var zI=Tn,UI=Tn,WI=Tn;function ud(e,t,r){return e.l+=2,[tI(e)]}function rg(e){return e.l+=6,[]}var $I=ud,HI=rg,VI=rg,GI=ud;function Ww(e){return e.l+=2,[Mr(e),e.read_shift(2)&1]}var ZI=ud,KI=Ww,YI=rg,qI=ud,XI=ud,JI=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function QI(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),l=JI[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:s}}function eD(e){return e.l+=2,[e.read_shift(4)]}function tD(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function rD(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function nD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function aD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function iD(e){return e.l+=4,[0,0]}var V1={1:{n:"PtgExp",f:SI},2:{n:"PtgTbl",f:WI},3:{n:"PtgAdd",f:Rr},4:{n:"PtgSub",f:Rr},5:{n:"PtgMul",f:Rr},6:{n:"PtgDiv",f:Rr},7:{n:"PtgPower",f:Rr},8:{n:"PtgConcat",f:Rr},9:{n:"PtgLt",f:Rr},10:{n:"PtgLe",f:Rr},11:{n:"PtgEq",f:Rr},12:{n:"PtgGe",f:Rr},13:{n:"PtgGt",f:Rr},14:{n:"PtgNe",f:Rr},15:{n:"PtgIsect",f:Rr},16:{n:"PtgUnion",f:Rr},17:{n:"PtgRange",f:Rr},18:{n:"PtgUplus",f:Rr},19:{n:"PtgUminus",f:Rr},20:{n:"PtgPercent",f:Rr},21:{n:"PtgParen",f:Rr},22:{n:"PtgMissArg",f:Rr},23:{n:"PtgStr",f:NI},26:{n:"PtgSheet",f:tD},27:{n:"PtgEndSheet",f:rD},28:{n:"PtgErr",f:TI},29:{n:"PtgBool",f:CI},30:{n:"PtgInt",f:EI},31:{n:"PtgNum",f:AI},32:{n:"PtgArray",f:cI},33:{n:"PtgFunc",f:_I},34:{n:"PtgFuncVar",f:wI},35:{n:"PtgName",f:FI},36:{n:"PtgRef",f:vI},37:{n:"PtgArea",f:aI},38:{n:"PtgMemArea",f:RI},39:{n:"PtgMemErr",f:zI},40:{n:"PtgMemNoMem",f:UI},41:{n:"PtgMemFunc",f:LI},42:{n:"PtgRefErr",f:MI},43:{n:"PtgAreaErr",f:sI},44:{n:"PtgRefN",f:xI},45:{n:"PtgAreaN",f:lI},46:{n:"PtgMemAreaN",f:nD},47:{n:"PtgMemNoMemN",f:aD},57:{n:"PtgNameX",f:jI},58:{n:"PtgRef3d",f:yI},59:{n:"PtgArea3d",f:iI},60:{n:"PtgRefErr3d",f:BI},61:{n:"PtgAreaErr3d",f:oI},255:{}},sD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},oD={1:{n:"PtgElfLel",f:Ww},2:{n:"PtgElfRw",f:qI},3:{n:"PtgElfCol",f:$I},6:{n:"PtgElfRwV",f:XI},7:{n:"PtgElfColV",f:GI},10:{n:"PtgElfRadical",f:ZI},11:{n:"PtgElfRadicalS",f:YI},13:{n:"PtgElfColS",f:HI},15:{n:"PtgElfColSV",f:VI},16:{n:"PtgElfRadicalLel",f:KI},25:{n:"PtgList",f:QI},29:{n:"PtgSxName",f:eD},255:{}},lD={0:{n:"PtgAttrNoop",f:iD},1:{n:"PtgAttrSemi",f:mI},2:{n:"PtgAttrIf",f:fI},4:{n:"PtgAttrChoose",f:uI},8:{n:"PtgAttrGoto",f:dI},16:{n:"PtgAttrSum",f:kI},32:{n:"PtgAttrBaxcel",f:H1},33:{n:"PtgAttrBaxcel",f:H1},64:{n:"PtgAttrSpace",f:pI},65:{n:"PtgAttrSpaceSemi",f:gI},128:{n:"PtgAttrIfError",f:hI},255:{}};function dd(e,t,r,n){if(n.biff<8)return Tn(e,t);for(var a=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=DI(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=II(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&s.push(Tn(e,t)),s}function fd(e,t,r){for(var n=e.l+t,a,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],a=V1[s]||V1[sD[s]],(s===24||s===25)&&(a=(s===24?oD:lD)[e[e.l+1]]),!a||!a.f?Tn(e,t):l.push([a.n,a.f(e,t,r)]);return l}function cD(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var uD={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dD(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function $w(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function G1(e,t,r){var n=$w(e,t,r);return n=="#REF"?n:dD(n,r)}function _n(e,t,r,n,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},u=[],m,p,g,y=0,_=0,T,S="";if(!e[0]||!e[0][0])return"";for(var w=-1,E="",P=0,I=e[0].length;P<I;++P){var A=e[0][P];switch(A[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=u.pop(),p=u.pop(),w>=0){switch(e[0][w][1][0]){case 0:E=kr(" ",e[0][w][1][1]);break;case 1:E=kr("\r",e[0][w][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}p=p+E,w=-1}u.push(p+uD[A[0]]+m);break;case"PtgIsect":m=u.pop(),p=u.pop(),u.push(p+" "+m);break;case"PtgUnion":m=u.pop(),p=u.pop(),u.push(p+","+m);break;case"PtgRange":m=u.pop(),p=u.pop(),u.push(p+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Pu(A[1][1],l,a),u.push(Iu(g,s));break;case"PtgRefN":g=r?Pu(A[1][1],r,a):A[1][1],u.push(Iu(g,s));break;case"PtgRef3d":y=A[1][1],g=Pu(A[1][2],l,a),S=G1(n,y,a),u.push(S+"!"+Iu(g,s));break;case"PtgFunc":case"PtgFuncVar":var R=A[1][0],K=A[1][1];R||(R=0),R&=127;var W=R==0?[]:u.slice(-R);u.length-=R,K==="User"&&(K=W.shift()),u.push(K+"("+W.join(",")+")");break;case"PtgBool":u.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(A[1]);break;case"PtgNum":u.push(String(A[1]));break;case"PtgStr":u.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(A[1]);break;case"PtgAreaN":T=w1(A[1][1],r?{s:r}:l,a),u.push(ym(T,a));break;case"PtgArea":T=w1(A[1][1],l,a),u.push(ym(T,a));break;case"PtgArea3d":y=A[1][1],T=A[1][2],S=G1(n,y,a),u.push(S+"!"+ym(T,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=A[1][2];var D=(n.names||[])[_-1]||(n[0]||[])[_],ee=D?D.Name:"SH33TJSNAME"+String(_);ee&&ee.slice(0,6)=="_xlfn."&&!a.xlfn&&(ee=ee.slice(6)),u.push(ee);break;case"PtgNameX":var re=A[1][1];_=A[1][2];var pe;if(a.biff<=5)re<0&&(re=-re),n[re]&&(pe=n[re][_]);else{var ue="";if(((n[re]||[])[0]||[])[0]==14849||(((n[re]||[])[0]||[])[0]==1025?n[re][_]&&n[re][_].itab>0&&(ue=n.SheetNames[n[re][_].itab-1]+"!"):ue=n.SheetNames[_-1]+"!"),n[re]&&n[re][_])ue+=n[re][_].Name;else if(n[0]&&n[0][_])ue+=n[0][_].Name;else{var ce=($w(n,re,a)||"").split(";;");ce[_-1]?ue=ce[_-1]:ue+="SH33TJSERRX"}u.push(ue);break}pe||(pe={Name:"SH33TJSERRY"}),u.push(pe.Name);break;case"PtgParen":var Ce="(",ye=")";if(w>=0){switch(E="",e[0][w][1][0]){case 2:Ce=kr(" ",e[0][w][1][1])+Ce;break;case 3:Ce=kr("\r",e[0][w][1][1])+Ce;break;case 4:ye=kr(" ",e[0][w][1][1])+ye;break;case 5:ye=kr("\r",e[0][w][1][1])+ye;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}u.push(Ce+u.pop()+ye);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:A[1][1],r:A[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[_t(g)]){var le=n.sharedf[_t(g)];u.push(_n(le,l,he,n,a))}else{var j=!1;for(m=0;m!=n.arrayf.length;++m)if(p=n.arrayf[m],!(g.c<p[0].s.c||g.c>p[0].e.c)&&!(g.r<p[0].s.r||g.r>p[0].e.r)){u.push(_n(p[1],l,he,n,a)),j=!0;break}j||u.push(A[1])}break;case"PtgArray":u.push("{"+cD(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=P;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var H=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&H.indexOf(e[0][P][0])==-1){A=e[0][w];var O=!0;switch(A[1][0]){case 4:O=!1;case 0:E=kr(" ",A[1][1]);break;case 5:O=!1;case 1:E=kr("\r",A[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}u.push((O?E:"")+u.pop()+(O?"":E)),w=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function fD(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,l=e.read_shift(a);if(l==65535)return[[],Tn(e,t-2)];var u=fd(e,l,r);return t!==l+a&&(s=dd(e,t-l-a,u,r)),e.l=n,[u,s]}function hD(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,l=e.read_shift(a);if(l==65535)return[[],Tn(e,t-2)];var u=fd(e,l,r);return t!==l+a&&(s=dd(e,t-l-a,u,r)),e.l=n,[u,s]}function mD(e,t,r,n){var a=e.l+t,s=fd(e,n,r),l;return a!==e.l&&(l=dd(e,a-e.l,s,r)),[s,l]}function pD(e,t,r){var n=e.l+t,a,s=e.read_shift(2),l=fd(e,s,r);return s==65535?[[],Tn(e,t-2)]:(t!==s+2&&(a=dd(e,n-s-2,l,r)),[l,a])}function gD(e){var t;if(ts(e,e.l+6)!==65535)return[bn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function vD(e){if(e==null){var t=Fe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Xo(e);return Xo(0)}function Sm(e,t,r){var n=e.l+t,a=Pi(e);r.biff==2&&++e.l;var s=gD(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var u=hD(e,n-e.l,r);return{cell:a,val:s[0],formula:u,shared:l>>3&1,tt:s[1]}}function xD(e,t,r,n,a){var s=Qo(t,r,a),l=vD(e.v),u=Fe(6),m=33;u.write_shift(2,m),u.write_shift(4,0);for(var p=Fe(e.bf.length),g=0;g<e.bf.length;++g)p[g]=e.bf[g];var y=tn([s,l,u,p]);return y}function Ch(e,t,r){var n=e.read_shift(4),a=fd(e,n,r),s=e.read_shift(4),l=s>0?dd(e,s,a,r):null;return[a,l]}var yD=Ch,Ah=Ch,_D=Ch,wD=Ch,bD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Hw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},kD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Z1(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function SD(e){var t="of:="+e.replace(eg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Tm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function TD(e){return e.replace(/\./,"!")}var Fu={},gc={},ju=typeof Map<"u";function ng(e,t,r){var n=0,a=e.length;if(r){if(ju?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=ju?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(ju?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Nh(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(wn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Xu(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=dh(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Zo(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function co(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ei(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Vw(e,t,r,n,a,s){try{n.cellNF&&(e.z=yt[t])}catch(u){if(n.WTF)throw u}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=fr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(yt[t]==null&&Ei(wA[t]||"General",t),e.t==="e")e.w=e.w||os[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hu(e.v);else if(e.t==="d"){var l=Kr(e.v);(l|0)===l?e.w=l.toString(10):e.w=Hu(l)}else{if(e.v===void 0)return"";e.w=Yo(e.v,gc)}else e.t==="d"?e.w=ma(t,Kr(e.v),gc):e.w=ma(t,e.v,gc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=uh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=uh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&s.Fills)throw u}}}function ED(e,t,r){if(e&&e["!ref"]){var n=Lt(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function CD(e,t){var r=Lt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Pt(r))}var AD=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ND=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,PD=/<(?:\w:)?hyperlink [^>]*>/mg,ID=/"(\w*:\w*)"/,DD=/<(?:\w:)?col\b[^>]*[\/]?>/g,FD=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,jD=/<(?:\w:)?pageMargins[^>]*\/>/g,Gw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,OD=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,RD=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function LD(e,t,r,n,a,s,l){if(!e)return e;n||(n={"!id":{}});var u=t.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},p="",g="",y=e.match(ND);y?(p=e.slice(0,y.index),g=e.slice(y.index+y[0].length)):p=g=e;var _=p.match(Gw);_?ag(_[0],u,a,r):(_=p.match(OD))&&BD(_[0],_[1]||"",u,a,r);var T=(p.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var S=p.slice(T,T+50).match(ID);S&&CD(u,S[1])}var w=p.match(RD);w&&w[1]&&JD(w[1],a);var E=[];if(t.cellStyles){var P=p.match(DD);P&&ZD(E,P)}y&&tF(y[1],u,t,m,s,l);var I=g.match(FD);I&&(u["!autofilter"]=YD(I[0]));var A=[],R=g.match(AD);if(R)for(T=0;T!=R.length;++T)A[T]=Lt(R[T].slice(R[T].indexOf('"')+1));var K=g.match(PD);K&&HD(u,K,n);var W=g.match(jD);if(W&&(u["!margins"]=VD(bt(W[0]))),!u["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(u["!ref"]=Pt(m)),t.sheetRows>0&&u["!ref"]){var D=Lt(u["!ref"]);t.sheetRows<=+D.e.r&&(D.e.r=t.sheetRows-1,D.e.r>m.e.r&&(D.e.r=m.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>m.e.c&&(D.e.c=m.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Pt(D))}return E.length>0&&(u["!cols"]=E),A.length>0&&(u["!merges"]=A),u}function MD(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Pt(e[r])+'"/>';return t+"</mergeCells>"}function ag(e,t,r,n){var a=bt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ut(nr(a.codeName)))}function BD(e,t,r,n,a){ag(e.slice(0,e.indexOf(">")),r,n,a)}function zD(e,t,r,n,a){var s=!1,l={},u=null;if(n.bookType!=="xlsx"&&t.vbaraw){var m=t.SheetNames[r];try{t.Workbook&&(m=t.Workbook.Sheets[r].CodeName||m)}catch{}s=!0,l.codeName=Ti(Xt(m))}if(e&&e["!outline"]){var p={summaryBelow:1,summaryRight:1};e["!outline"].above&&(p.summaryBelow=0),e["!outline"].left&&(p.summaryRight=0),u=(u||"")+Je("outlinePr",null,p)}!s&&!u||(a[a.length]=Je("sheetPr",u,l))}var UD=["objects","scenarios","selectLockedCells","selectUnlockedCells"],WD=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $D(e){var t={sheet:1};return UD.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),WD.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Xp(e.password).toString(16).toUpperCase()),Je("sheetProtection",null,t)}function HD(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=bt(nr(t[a]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Ut(s.location))):(s.Target="#"+Ut(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var u=Lt(s.ref),m=u.s.r;m<=u.e.r;++m)for(var p=u.s.c;p<=u.e.c;++p){var g=_t({c:p,r:m});n?(e[m]||(e[m]=[]),e[m][p]||(e[m][p]={t:"z",v:void 0}),e[m][p].l=s):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=s)}}}function VD(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function GD(e){return Zo(e),Je("pageMargins",null,e)}function ZD(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=bt(t[n],!0);a.hidden&&(a.hidden=ur(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Jp(a.width)),no(a);s<=l;)e[s++]=ar(a)}}function KD(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Je("col",null,Nh(a,n)));return r[r.length]="</cols>",r.join("")}function YD(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function qD(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Pt(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=Ln(a);l.s.r==l.e.r&&(l.e.r=Ln(t["!ref"]).e.r,a=Pt(l));for(var u=0;u<s.length;++u){var m=s[u];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Je("autoFilter",null,{ref:a})}var XD=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function JD(e,t){t.Views||(t.Views=[{}]),(e.match(XD)||[]).forEach(function(r,n){var a=bt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),ur(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function QD(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Je("sheetViews",Je("sheetView",null,a),{})}function eF(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=os[e.v];break;case"d":n&&n.cellDates?a=fr(e.v,-1).toISOString():(e=ar(e),e.t="n",a=""+(e.v=Kr(fr(e.v)))),typeof e.z>"u"&&(e.z=yt[14]);break;default:a=e.v;break}var u=cn("v",Xt(a)),m={r:t},p=co(n.cellXfs,e,n);switch(p!==0&&(m.s=p),e.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=cn("v",""+ng(n.Strings,e.v,n.revStrings)),m.t="s";break}m.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Je("f",Xt(e.f),g)+(e.v!=null?u:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(m.cm=1),Je("c",u,m)}var tF=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Vu("v"),l=Vu("f");return function(m,p,g,y,_,T){for(var S=0,w="",E=[],P=[],I=0,A=0,R=0,K="",W,D,ee=0,re=0,pe,ue,ce=0,Ce=0,ye=Array.isArray(T.CellXf),he,le=[],j=[],H=Array.isArray(p),O=[],ne={},Y=!1,F=!!g.sheetStubs,U=m.split(t),z=0,q=U.length;z!=q;++z){w=U[z].trim();var M=w.length;if(M!==0){var oe=0;e:for(S=0;S<M;++S)switch(w[S]){case">":if(w[S-1]!="/"){++S;break e}if(g&&g.cellStyles){if(D=bt(w.slice(oe,S),!0),ee=D.r!=null?parseInt(D.r,10):ee+1,re=-1,g.sheetRows&&g.sheetRows<ee)continue;ne={},Y=!1,D.ht&&(Y=!0,ne.hpt=parseFloat(D.ht),ne.hpx=wc(ne.hpt)),D.hidden=="1"&&(Y=!0,ne.hidden=!0),D.outlineLevel!=null&&(Y=!0,ne.level=+D.outlineLevel),Y&&(O[ee-1]=ne)}break;case"<":oe=S;break}if(oe>=S)break;if(D=bt(w.slice(oe,S),!0),ee=D.r!=null?parseInt(D.r,10):ee+1,re=-1,!(g.sheetRows&&g.sheetRows<ee)){y.s.r>ee-1&&(y.s.r=ee-1),y.e.r<ee-1&&(y.e.r=ee-1),g&&g.cellStyles&&(ne={},Y=!1,D.ht&&(Y=!0,ne.hpt=parseFloat(D.ht),ne.hpx=wc(ne.hpt)),D.hidden=="1"&&(Y=!0,ne.hidden=!0),D.outlineLevel!=null&&(Y=!0,ne.level=+D.outlineLevel),Y&&(O[ee-1]=ne)),E=w.slice(S).split(e);for(var se=0;se!=E.length&&E[se].trim().charAt(0)=="<";++se);for(E=E.slice(se),S=0;S!=E.length;++S)if(w=E[S].trim(),w.length!==0){if(P=w.match(r),I=S,A=0,R=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,P!=null&&P.length===2){for(I=0,K=P[1],A=0;A!=K.length&&!((R=K.charCodeAt(A)-64)<1||R>26);++A)I=26*I+R;--I,re=I}else++re;for(A=0;A!=w.length&&w.charCodeAt(A)!==62;++A);if(++A,D=bt(w.slice(0,A),!0),D.r||(D.r=_t({r:ee-1,c:re})),K=w.slice(A),W={t:""},(P=K.match(s))!=null&&P[1]!==""&&(W.v=Ut(P[1])),g.cellFormula){if((P=K.match(l))!=null&&P[1]!==""){if(W.f=Ut(nr(P[1])).replace(/\r\n/g,`
`),g.xlfn||(W.f=$1(W.f)),P[0].indexOf('t="array"')>-1)W.F=(K.match(a)||[])[1],W.F.indexOf(":")>-1&&le.push([Lt(W.F),W.F]);else if(P[0].indexOf('t="shared"')>-1){ue=bt(P[0]);var fe=Ut(nr(P[1]));g.xlfn||(fe=$1(fe)),j[parseInt(ue.si,10)]=[ue,fe,D.r]}}else(P=K.match(/<f[^>]*\/>/))&&(ue=bt(P[0]),j[ue.si]&&(W.f=X3(j[ue.si][1],j[ue.si][2],D.r)));var xe=_r(D.r);for(A=0;A<le.length;++A)xe.r>=le[A][0].s.r&&xe.r<=le[A][0].e.r&&xe.c>=le[A][0].s.c&&xe.c<=le[A][0].e.c&&(W.F=le[A][1])}if(D.t==null&&W.v===void 0)if(W.f||W.F)W.v=0,W.t="n";else if(F)W.t="z";else continue;else W.t=D.t||"n";switch(y.s.c>re&&(y.s.c=re),y.e.c<re&&(y.e.c=re),W.t){case"n":if(W.v==""||W.v==null){if(!F)continue;W.t="z"}else W.v=parseFloat(W.v);break;case"s":if(typeof W.v>"u"){if(!F)continue;W.t="z"}else pe=Fu[parseInt(W.v,10)],W.v=pe.t,W.r=pe.r,g.cellHTML&&(W.h=pe.h);break;case"str":W.t="s",W.v=W.v!=null?nr(W.v):"",g.cellHTML&&(W.h=Dp(W.v));break;case"inlineStr":P=K.match(n),W.t="s",P!=null&&(pe=qp(P[1]))?(W.v=pe.t,g.cellHTML&&(W.h=pe.h)):W.v="";break;case"b":W.v=ur(W.v);break;case"d":g.cellDates?W.v=fr(W.v,1):(W.v=Kr(fr(W.v,1)),W.t="n");break;case"e":(!g||g.cellText!==!1)&&(W.w=W.v),W.v=K_[W.v];break}if(ce=Ce=0,he=null,ye&&D.s!==void 0&&(he=T.CellXf[D.s],he!=null&&(he.numFmtId!=null&&(ce=he.numFmtId),g.cellStyles&&he.fillId!=null&&(Ce=he.fillId))),Vw(W,ce,Ce,g,_,T),g.cellDates&&ye&&W.t=="n"&&nl(yt[ce])&&(W.t="d",W.v=Sh(W.v)),D.cm&&g.xlmeta){var je=(g.xlmeta.Cell||[])[+D.cm-1];je&&je.type=="XLDAPR"&&(W.D=!0)}if(H){var X=_r(D.r);p[X.r]||(p[X.r]=[]),p[X.r][X.c]=W}else p[D.r]=W}}}}O.length>0&&(p["!rows"]=O)}})();function rF(e,t,r,n){var a=[],s=[],l=Lt(e["!ref"]),u="",m,p="",g=[],y=0,_=0,T=e["!rows"],S=Array.isArray(e),w={r:p},E,P=-1;for(_=l.s.c;_<=l.e.c;++_)g[_]=dr(_);for(y=l.s.r;y<=l.e.r;++y){for(s=[],p=Sr(y),_=l.s.c;_<=l.e.c;++_){m=g[_]+p;var I=S?(e[y]||[])[_]:e[m];I!==void 0&&(u=eF(I,m,e,t))!=null&&s.push(u)}(s.length>0||T&&T[y])&&(w={r:p},T&&T[y]&&(E=T[y],E.hidden&&(w.hidden=1),P=-1,E.hpx?P=Ju(E.hpx):E.hpt&&(P=E.hpt),P>-1&&(w.ht=P,w.customHeight=1),E.level&&(w.outlineLevel=E.level)),a[a.length]=Je("row",s.join(""),w))}if(T)for(;y<T.length;++y)T&&T[y]&&(w={r:y+1},E=T[y],E.hidden&&(w.hidden=1),P=-1,E.hpx?P=Ju(E.hpx):E.hpt&&(P=E.hpt),P>-1&&(w.ht=P,w.customHeight=1),E.level&&(w.outlineLevel=E.level),a[a.length]=Je("row","",w));return a.join("")}function Zw(e,t,r,n){var a=[Dr,Je("worksheet",null,{xmlns:al[0],"xmlns:r":Zr.r})],s=r.SheetNames[e],l=0,u="",m=r.Sheets[s];m==null&&(m={});var p=m["!ref"]||"A1",g=Lt(p);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+p+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),p=Pt(g)}n||(n={}),m["!comments"]=[];var y=[];zD(m,r,e,t,a),a[a.length]=Je("dimension",null,{ref:p}),a[a.length]=QD(m,t,e,r),t.sheetFormat&&(a[a.length]=Je("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),m["!cols"]!=null&&m["!cols"].length>0&&(a[a.length]=KD(m,m["!cols"])),a[l=a.length]="<sheetData/>",m["!links"]=[],m["!ref"]!=null&&(u=rF(m,t),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),m["!protect"]&&(a[a.length]=$D(m["!protect"])),m["!autofilter"]!=null&&(a[a.length]=qD(m["!autofilter"],m,r,e)),m["!merges"]!=null&&m["!merges"].length>0&&(a[a.length]=MD(m["!merges"]));var _=-1,T,S=-1;return m["!links"].length>0&&(a[a.length]="<hyperlinks>",m["!links"].forEach(function(w){w[1].Target&&(T={ref:w[0]},w[1].Target.charAt(0)!="#"&&(S=qt(n,-1,Xt(w[1].Target).replace(/#.*$/,""),jt.HLINK),T["r:id"]="rId"+S),(_=w[1].Target.indexOf("#"))>-1&&(T.location=Xt(w[1].Target.slice(_+1))),w[1].Tooltip&&(T.tooltip=Xt(w[1].Tooltip)),a[a.length]=Je("hyperlink",null,T))}),a[a.length]="</hyperlinks>"),delete m["!links"],m["!margins"]!=null&&(a[a.length]=GD(m["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=cn("ignoredErrors",Je("ignoredError",null,{numberStoredAsText:1,sqref:p}))),y.length>0&&(S=qt(n,-1,"../drawings/drawing"+(e+1)+".xml",jt.DRAW),a[a.length]=Je("drawing",null,{"r:id":"rId"+S}),m["!drawing"]=y),m["!comments"].length>0&&(S=qt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",jt.VML),a[a.length]=Je("legacyDrawing",null,{"r:id":"rId"+S}),m["!legacy"]=S),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function nF(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function aF(e,t,r){var n=Fe(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Ju(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,m=n.l;n.l+=4;for(var p={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var y=-1,_=-1,T=g<<10;T<g+1<<10;++T){p.c=T;var S=Array.isArray(r)?(r[p.r]||[])[p.c]:r[_t(p)];S&&(y<0&&(y=T),_=T)}y<0||(++u,n.write_shift(4,y),n.write_shift(4,_))}var w=n.l;return n.l=m,n.write_shift(4,u),n.l=w,n.length>n.l?n.slice(0,n.l):n}function iF(e,t,r,n){var a=aF(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Me(e,0,a)}var sF=ll,oF=Cc;function lF(){}function cF(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=f4(e),r}function uF(e,t,r){r==null&&(r=Fe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return oh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),$_(e,r),r.slice(0,r.l)}function dF(e){var t=Ra(e);return[t]}function fF(e,t,r){return r==null&&(r=Fe(8)),il(t,r)}function hF(e){var t=sl(e);return[t]}function mF(e,t,r){return r==null&&(r=Fe(4)),ol(t,r)}function pF(e){var t=Ra(e),r=e.read_shift(1);return[t,r,"b"]}function gF(e,t,r){return r==null&&(r=Fe(9)),il(t,r),r.write_shift(1,e.v?1:0),r}function vF(e){var t=sl(e),r=e.read_shift(1);return[t,r,"b"]}function xF(e,t,r){return r==null&&(r=Fe(5)),ol(t,r),r.write_shift(1,e.v?1:0),r}function yF(e){var t=Ra(e),r=e.read_shift(1);return[t,r,"e"]}function _F(e,t,r){return r==null&&(r=Fe(9)),il(t,r),r.write_shift(1,e.v),r}function wF(e){var t=sl(e),r=e.read_shift(1);return[t,r,"e"]}function bF(e,t,r){return r==null&&(r=Fe(8)),ol(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function kF(e){var t=Ra(e),r=e.read_shift(4);return[t,r,"s"]}function SF(e,t,r){return r==null&&(r=Fe(12)),il(t,r),r.write_shift(4,t.v),r}function TF(e){var t=sl(e),r=e.read_shift(4);return[t,r,"s"]}function EF(e,t,r){return r==null&&(r=Fe(8)),ol(t,r),r.write_shift(4,t.v),r}function CF(e){var t=Ra(e),r=bn(e);return[t,r,"n"]}function AF(e,t,r){return r==null&&(r=Fe(16)),il(t,r),Xo(e.v,r),r}function Kw(e){var t=sl(e),r=bn(e);return[t,r,"n"]}function NF(e,t,r){return r==null&&(r=Fe(12)),ol(t,r),Xo(e.v,r),r}function PF(e){var t=Ra(e),r=Vp(e);return[t,r,"n"]}function IF(e,t,r){return r==null&&(r=Fe(12)),il(t,r),H_(e.v,r),r}function DF(e){var t=sl(e),r=Vp(e);return[t,r,"n"]}function FF(e,t,r){return r==null&&(r=Fe(8)),ol(t,r),H_(e.v,r),r}function jF(e){var t=Ra(e),r=Wp(e);return[t,r,"is"]}function OF(e){var t=Ra(e),r=Sn(e);return[t,r,"str"]}function RF(e,t,r){return r==null&&(r=Fe(12+4*e.v.length)),il(t,r),rn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function LF(e){var t=sl(e),r=Sn(e);return[t,r,"str"]}function MF(e,t,r){return r==null&&(r=Fe(8+4*e.v.length)),ol(t,r),rn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function BF(e,t,r){var n=e.l+t,a=Ra(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"b"];if(r.cellFormula){e.l+=2;var u=Ah(e,n-e.l,r);l[3]=_n(u,null,a,r.supbooks,r)}else e.l=n;return l}function zF(e,t,r){var n=e.l+t,a=Ra(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"e"];if(r.cellFormula){e.l+=2;var u=Ah(e,n-e.l,r);l[3]=_n(u,null,a,r.supbooks,r)}else e.l=n;return l}function UF(e,t,r){var n=e.l+t,a=Ra(e);a.r=r["!row"];var s=bn(e),l=[a,s,"n"];if(r.cellFormula){e.l+=2;var u=Ah(e,n-e.l,r);l[3]=_n(u,null,a,r.supbooks,r)}else e.l=n;return l}function WF(e,t,r){var n=e.l+t,a=Ra(e);a.r=r["!row"];var s=Sn(e),l=[a,s,"str"];if(r.cellFormula){e.l+=2;var u=Ah(e,n-e.l,r);l[3]=_n(u,null,a,r.supbooks,r)}else e.l=n;return l}var $F=ll,HF=Cc;function VF(e,t){return t==null&&(t=Fe(4)),t.write_shift(4,e),t}function GF(e,t){var r=e.l+t,n=ll(e),a=$p(e),s=Sn(e),l=Sn(e),u=Sn(e);e.l=r;var m={rfx:n,relId:a,loc:s,display:u};return l&&(m.Tooltip=l),m}function ZF(e,t){var r=Fe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Cc({s:_r(e[0]),e:_r(e[0])},r),Hp("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return rn(a||"",r),rn(e[1].Tooltip||"",r),rn("",r),r.slice(0,r.l)}function KF(){}function YF(e,t,r){var n=e.l+t,a=V_(e),s=e.read_shift(1),l=[a];if(l[2]=s,r.cellFormula){var u=yD(e,n-e.l,r);l[1]=u}else e.l=n;return l}function qF(e,t,r){var n=e.l+t,a=ll(e),s=[a];if(r.cellFormula){var l=wD(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function XF(e,t,r){r==null&&(r=Fe(18));var n=Nh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var Yw=["left","right","top","bottom","header","footer"];function JF(e){var t={};return Yw.forEach(function(r){t[r]=bn(e)}),t}function QF(e,t){return t==null&&(t=Fe(48)),Zo(e),Yw.forEach(function(r){Xo(e[r],t)}),t}function ej(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function tj(e,t,r){r==null&&(r=Fe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function rj(e){var t=Fe(24);return t.write_shift(4,4),t.write_shift(4,1),Cc(e,t),t}function nj(e,t){return t==null&&(t=Fe(66)),t.write_shift(2,e.password?Xp(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function aj(){}function ij(){}function sj(e,t,r,n,a,s,l){if(!e)return e;var u=t||{};n||(n={"!id":{}});var m=u.dense?[]:{},p,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,_=!1,T,S,w,E,P,I,A,R,K,W=[];u.biff=12,u["!row"]=0;var D=0,ee=!1,re=[],pe={},ue=u.supbooks||a.supbooks||[[]];if(ue.sharedf=pe,ue.arrayf=re,ue.SheetNames=a.SheetNames||a.Sheets.map(function(H){return H.name}),!u.supbooks&&(u.supbooks=ue,a.Names))for(var ce=0;ce<a.Names.length;++ce)ue[0][ce+1]=a.Names[ce];var Ce=[],ye=[],he=!1;Qu[16]={n:"BrtShortReal",f:Kw};var le;if(ss(e,function(O,ne,Y){if(!_)switch(Y){case 148:p=O;break;case 0:T=O,u.sheetRows&&u.sheetRows<=T.r&&(_=!0),R=Sr(E=T.r),u["!row"]=T.r,(O.hidden||O.hpt||O.level!=null)&&(O.hpt&&(O.hpx=wc(O.hpt)),ye[O.r]=O);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:O[2]},O[2]){case"n":S.v=O[1];break;case"s":A=Fu[O[1]],S.v=A.t,S.r=A.r;break;case"b":S.v=!!O[1];break;case"e":S.v=O[1],u.cellText!==!1&&(S.w=os[S.v]);break;case"str":S.t="s",S.v=O[1];break;case"is":S.t="s",S.v=O[1].t;break}if((w=l.CellXf[O[0].iStyleRef])&&Vw(S,w.numFmtId,null,u,s,l),P=O[0].c==-1?P+1:O[0].c,u.dense?(m[E]||(m[E]=[]),m[E][P]=S):m[dr(P)+R]=S,u.cellFormula){for(ee=!1,D=0;D<re.length;++D){var F=re[D];T.r>=F[0].s.r&&T.r<=F[0].e.r&&P>=F[0].s.c&&P<=F[0].e.c&&(S.F=Pt(F[0]),ee=!0)}!ee&&O.length>3&&(S.f=O[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>P&&(g.s.c=P),g.e.r<T.r&&(g.e.r=T.r),g.e.c<P&&(g.e.c=P),u.cellDates&&w&&S.t=="n"&&nl(yt[w.numFmtId])){var U=Qs(S.v);U&&(S.t="d",S.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}le&&(le.type=="XLDAPR"&&(S.D=!0),le=void 0);break;case 1:case 12:if(!u.sheetStubs||y)break;S={t:"z",v:void 0},P=O[0].c==-1?P+1:O[0].c,u.dense?(m[E]||(m[E]=[]),m[E][P]=S):m[dr(P)+R]=S,g.s.r>T.r&&(g.s.r=T.r),g.s.c>P&&(g.s.c=P),g.e.r<T.r&&(g.e.r=T.r),g.e.c<P&&(g.e.c=P),le&&(le.type=="XLDAPR"&&(S.D=!0),le=void 0);break;case 176:W.push(O);break;case 49:le=((u.xlmeta||{}).Cell||[])[O-1];break;case 494:var z=n["!id"][O.relId];for(z?(O.Target=z.Target,O.loc&&(O.Target+="#"+O.loc),O.Rel=z):O.relId==""&&(O.Target="#"+O.loc),E=O.rfx.s.r;E<=O.rfx.e.r;++E)for(P=O.rfx.s.c;P<=O.rfx.e.c;++P)u.dense?(m[E]||(m[E]=[]),m[E][P]||(m[E][P]={t:"z",v:void 0}),m[E][P].l=O):(I=_t({c:P,r:E}),m[I]||(m[I]={t:"z",v:void 0}),m[I].l=O);break;case 426:if(!u.cellFormula)break;re.push(O),K=u.dense?m[E][P]:m[dr(P)+R],K.f=_n(O[1],g,{r:T.r,c:P},ue,u),K.F=Pt(O[0]);break;case 427:if(!u.cellFormula)break;pe[_t(O[0].s)]=O[1],K=u.dense?m[E][P]:m[dr(P)+R],K.f=_n(O[1],g,{r:T.r,c:P},ue,u);break;case 60:if(!u.cellStyles)break;for(;O.e>=O.s;)Ce[O.e--]={width:O.w/256,hidden:!!(O.flags&1),level:O.level},he||(he=!0,Jp(O.w/256)),no(Ce[O.e+1]);break;case 161:m["!autofilter"]={ref:Pt(O)};break;case 476:m["!margins"]=O;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),O.name&&(a.Sheets[r].CodeName=O.name),(O.above||O.left)&&(m["!outline"]={above:O.above,left:O.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),O.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!ne.T){if(!y||u.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},u),delete u.supbooks,delete u["!row"],!m["!ref"]&&(g.s.r<2e6||p&&(p.e.r>0||p.e.c>0||p.s.r>0||p.s.c>0))&&(m["!ref"]=Pt(p||g)),u.sheetRows&&m["!ref"]){var j=Lt(m["!ref"]);u.sheetRows<=+j.e.r&&(j.e.r=u.sheetRows-1,j.e.r>g.e.r&&(j.e.r=g.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>g.e.c&&(j.e.c=g.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),m["!fullref"]=m["!ref"],m["!ref"]=Pt(j))}return W.length>0&&(m["!merges"]=W),Ce.length>0&&(m["!cols"]=Ce),ye.length>0&&(m["!rows"]=ye),m}function oj(e,t,r,n,a,s,l){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=ar(t),t.z=t.z||yt[14],t.v=Kr(fr(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var m={r,c:n};switch(m.s=co(a.cellXfs,t,a),t.l&&s["!links"].push([_t(m),t.l]),t.c&&s["!comments"].push([_t(m),t.c]),t.t){case"s":case"str":return a.bookSST?(u=ng(a.Strings,t.v,a.revStrings),m.t="s",m.v=u,l?Me(e,18,EF(t,m)):Me(e,7,SF(t,m))):(m.t="str",l?Me(e,17,MF(t,m)):Me(e,6,RF(t,m))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?Me(e,13,FF(t,m)):Me(e,2,IF(t,m)):l?Me(e,16,NF(t,m)):Me(e,5,AF(t,m)),!0;case"b":return m.t="b",l?Me(e,15,xF(t,m)):Me(e,4,gF(t,m)),!0;case"e":return m.t="e",l?Me(e,14,bF(t,m)):Me(e,3,_F(t,m)),!0}return l?Me(e,12,mF(t,m)):Me(e,1,fF(t,m)),!0}function lj(e,t,r,n){var a=Lt(t["!ref"]||"A1"),s,l="",u=[];Me(e,145);var m=Array.isArray(t),p=a.e.r;t["!rows"]&&(p=Math.max(a.e.r,t["!rows"].length-1));for(var g=a.s.r;g<=p;++g){l=Sr(g),iF(e,t,a,g);var y=!1;if(g<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){g===a.s.r&&(u[_]=dr(_)),s=u[_]+l;var T=m?(t[g]||[])[_]:t[s];if(!T){y=!1;continue}y=oj(e,T,g,_,n,t,y)}}Me(e,146)}function cj(e,t){!t||!t["!merges"]||(Me(e,177,VF(t["!merges"].length)),t["!merges"].forEach(function(r){Me(e,176,HF(r))}),Me(e,178))}function uj(e,t){!t||!t["!cols"]||(Me(e,390),t["!cols"].forEach(function(r,n){r&&Me(e,60,XF(n,r))}),Me(e,391))}function dj(e,t){!t||!t["!ref"]||(Me(e,648),Me(e,649,rj(Lt(t["!ref"]))),Me(e,650))}function fj(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=qt(r,-1,n[1].Target.replace(/#.*$/,""),jt.HLINK);Me(e,494,ZF(n,a))}}),delete t["!links"]}function hj(e,t,r,n){if(t["!comments"].length>0){var a=qt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",jt.VML);Me(e,551,Hp("rId"+a)),t["!legacy"]=a}}function mj(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Pt(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=Ln(s);u.s.r==u.e.r&&(u.e.r=Ln(t["!ref"]).e.r,s=Pt(u));for(var m=0;m<l.length;++m){var p=l[m];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==n){p.Ref="'"+r.SheetNames[n]+"'!"+s;break}}m==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Me(e,161,Cc(Lt(s))),Me(e,162)}}function pj(e,t,r){Me(e,133),Me(e,137,tj(t,r)),Me(e,138),Me(e,134)}function gj(e,t){t["!protect"]&&Me(e,535,nj(t["!protect"]))}function vj(e,t,r,n){var a=Kn(),s=r.SheetNames[e],l=r.Sheets[s]||{},u=s;try{r&&r.Workbook&&(u=r.Workbook.Sheets[e].CodeName||u)}catch{}var m=Lt(l["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Me(a,129),(r.vbaraw||l["!outline"])&&Me(a,147,uF(u,l["!outline"])),Me(a,148,oF(m)),pj(a,l,r.Workbook),uj(a,l),lj(a,l,e,t),gj(a,l),mj(a,l,r,e),cj(a,l),fj(a,l,n),l["!margins"]&&Me(a,476,QF(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&dj(a,l),hj(a,l,e,n),Me(a,130),a.end()}function xj(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var a=Ut((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function yj(e,t,r,n,a,s){var l=s||{"!type":"chart"};if(!e)return s;var u=0,m=0,p="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var _=xj(y);g.s.r=g.s.c=0,g.e.c=u,p=dr(u),_[0].forEach(function(T,S){l[p+Sr(S)]={t:"n",v:T,z:_[1]},m=S}),g.e.r<m&&(g.e.r=m),++u}),u>0&&(l["!ref"]=Pt(g)),l}function _j(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,u=e.match(Gw);return u&&ag(u[0],s,a,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function wj(e,t){e.l+=10;var r=Sn(e);return{name:r}}function bj(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return ss(e,function(m,p,g){switch(g){case 550:s["!rel"]=m;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),m.name&&(a.Sheets[r].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(p.T>0)){if(!(p.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var ig=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],kj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Sj=[],Tj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function K1(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ur(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Y1(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ur(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function qw(e){Y1(e.WBProps,ig),Y1(e.CalcPr,Tj),K1(e.WBView,kj),K1(e.Sheets,Sj),gc.date1904=ur(e.WBProps.date1904)}function Ej(e){return!e.Workbook||!e.Workbook.WBProps?"false":ur(e.Workbook.WBProps.date1904)?"true":"false"}var Cj="][*?/\\".split("");function Xw(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Cj.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Aj(e,t,r){e.forEach(function(n,a){Xw(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[a]&&t[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function Jw(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Aj(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)ED(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Nj=/<\w+:workbook/;function Pj(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},l=0;if(e.replace(En,function(m,p){var g=bt(m);switch(Ni(g[0])){case"<?xml":break;case"<workbook":m.match(Nj)&&(a="xmlns"+m.match(/<(\w+):/)[1]),r.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ig.forEach(function(y){if(g[y[0]]!=null)switch(y[2]){case"bool":r.WBProps[y[0]]=ur(g[y[0]]);break;case"int":r.WBProps[y[0]]=parseInt(g[y[0]],10);break;default:r.WBProps[y[0]]=g[y[0]]}}),g.codeName&&(r.WBProps.CodeName=nr(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Ut(nr(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=nr(g.name),g.comment&&(s.Comment=g.comment),g.localSheetId&&(s.Sheet=+g.localSheetId),ur(g.hidden||"0")&&(s.Hidden=!0),l=p+m.length;break;case"</definedName>":s.Ref=Ut(nr(e.slice(l,p))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return m}),al.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return qw(r),r}function Qw(e){var t=[Dr];t[t.length]=Je("workbook",null,{xmlns:al[0],"xmlns:r":Zr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ig.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Je("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:Xt(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Je("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var m={name:u.Name};u.Comment&&(m.comment=u.Comment),u.Sheet!=null&&(m.localSheetId=""+u.Sheet),u.Hidden&&(m.hidden="1"),u.Ref&&(t[t.length]=Je("definedName",Xt(u.Ref),m))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Ij(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Jm(e),r.name=Sn(e),r}function Dj(e,t){return t||(t=Fe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Hp(e.strRelID,t),rn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Fj(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Sn(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function jj(e,t){t||(t=Fe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),$_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Oj(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Rj(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=h4(e),l=_D(e,0,r),u=$p(e);e.l=n;var m={Name:s,Ptg:l};return a<268435455&&(m.Sheet=a),u&&(m.Comment=u),m}function Lj(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],Qu[16]={n:"BrtFRTArchID$",f:Oj},ss(e,function(m,p,g){switch(g){case 156:l.SheetNames.push(m.name),r.Sheets.push(m);break;case 153:r.WBProps=m;break;case 39:m.Sheet!=null&&(t.SID=m.Sheet),m.Ref=_n(m.Ptg,null,null,l,t),delete t.SID,delete m.Ptg,s.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,m]):l[0]=[g,m],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(m),l.XTI=l.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(g),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(g),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!p.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),qw(r),r.Names=s,r.supbooks=l,r}function Mj(e,t){Me(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Me(e,156,Dj(a))}Me(e,144)}function Bj(e,t){t||(t=Fe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return rn("SheetJS",t),rn(Wu.version,t),rn(Wu.version,t),rn("7262",t),t.length>t.l?t.slice(0,t.l):t}function zj(e,t){t||(t=Fe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Uj(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Me(e,135),Me(e,158,zj(a)),Me(e,136))}}function Wj(e,t){var r=Kn();return Me(r,131),Me(r,128,Bj()),Me(r,153,jj(e.Workbook&&e.Workbook.WBProps||null)),Uj(r,e),Mj(r,e),Me(r,132),r.end()}function $j(e,t,r){return t.slice(-4)===".bin"?Lj(e,r):Pj(e,r)}function Hj(e,t,r,n,a,s,l,u){return t.slice(-4)===".bin"?sj(e,n,r,a,s,l,u):LD(e,n,r,a,s,l,u)}function Vj(e,t,r,n,a,s,l,u){return t.slice(-4)===".bin"?bj(e,n,r,a,s):_j(e,n,r,a,s)}function Gj(e,t,r,n,a,s,l,u){return t.slice(-4)===".bin"?Y3():q3()}function Zj(e,t,r,n,a,s,l,u){return t.slice(-4)===".bin"?Z3():K3()}function Kj(e,t,r,n){return t.slice(-4)===".bin"?H5(e,r,n):D5(e,r,n)}function Yj(e,t,r){return Dw(e,r)}function qj(e,t,r){return t.slice(-4)===".bin"?XP(e,r):KP(e,r)}function Xj(e,t,r){return t.slice(-4)===".bin"?W3(e,r):F3(e,r)}function Jj(e,t,r){return t.slice(-4)===".bin"?P3(e):A3(e)}function Qj(e,t,r,n){return r.slice(-4)===".bin"?I3(e,t,r,n):void 0}function eO(e,t,r){return t.slice(-4)===".bin"?T3(e,t,r):C3(e,t,r)}function tO(e,t,r){return(t.slice(-4)===".bin"?Wj:Qw)(e)}function rO(e,t,r,n,a){return(t.slice(-4)===".bin"?vj:Zw)(e,r,n,a)}function nO(e,t,r){return(t.slice(-4)===".bin"?e3:Pw)(e,r)}function aO(e,t,r){return(t.slice(-4)===".bin"?e5:bw)(e,r)}function iO(e,t,r){return(t.slice(-4)===".bin"?$3:Ow)(e)}function sO(e){return(e.slice(-4)===".bin"?E3:Fw)()}var eb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,tb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qa(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(eb),s,l,u,m;if(a)for(m=0;m!=a.length;++m)s=a[m].match(tb),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(l+1),n[u]=s[2].slice(1,s[2].length-1));return n}function oO(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(eb),a,s,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(tb),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Ou;function lO(e,t){var r=Ou[e]||Ut(e);return r==="General"?Yo(t):ma(r,t)}function cO(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ur(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=fr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ut(t)]=a}function uO(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||os[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hu(e.v):e.w=Yo(e.v):e.w=lO(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Ou[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&nl(n)){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function dO(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=S5[n.Pattern]||n.Pattern)}e[t.ID]=t}function fO(e,t,r,n,a,s,l,u,m,p){var g="General",y=n.StyleID,_={};p=p||{};var T=[],S=0;for(y===void 0&&u&&(y=u.StyleID),y===void 0&&l&&(y=l.StyleID);s[y]!==void 0&&(s[y].nf&&(g=s[y].nf),s[y].Interior&&T.push(s[y].Interior),!!s[y].Parent);)y=s[y].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ur(e);break;case"String":n.t="s",n.r=f1(Ut(e)),n.v=e.indexOf("<")>-1?Ut(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(fr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Ut(e):n.v<60&&(n.v=n.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=K_[e],p.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=f1(t||e));break}if(uO(n,g,p),p.cellFormula!==!1)if(n.Formula){var w=Ut(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=pc(w,a),delete n.Formula,n.ArrayRange=="RC"?n.F=pc("RC:RC",a):n.ArrayRange&&(n.F=pc(n.ArrayRange,a),m.push([Lt(n.F),n.F]))}else for(S=0;S<m.length;++S)a.r>=m[S][0].s.r&&a.r<=m[S][0].e.r&&a.c>=m[S][0].s.c&&a.c<=m[S][0].e.c&&(n.F=m[S][1]);p.cellStyles&&(T.forEach(function(E){!_.patternType&&E.patternType&&(_.patternType=E.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function hO(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Em(e,t){var r=t||{};Sc();var n=uc(Fp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Bt<"u"?n=Bt.utils.decode(65001,eh(n)):n=nr(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=ar(r);return l.type="string",_c.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(kt){a.indexOf("<"+kt)>=0&&(s=!0)}),s)return YO(n,r);Ou={"General Number":"General","General Date":yt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":yt[15],"Short Date":yt[14],"Long Time":yt[19],"Medium Time":yt[18],"Short Time":yt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:yt[2],Standard:yt[4],Percent:yt[10],Scientific:yt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,m=[],p,g={},y=[],_=r.dense?[]:{},T="",S={},w={},E=Qa('<Data ss:Type="String">'),P=0,I=0,A=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},K={},W={},D="",ee=0,re=[],pe={},ue={},ce=0,Ce=[],ye=[],he={},le=[],j,H=!1,O=[],ne=[],Y={},F=0,U=0,z={Sheets:[],WBProps:{date1904:!1}},q={};Zu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var M="";u=Zu.exec(n);)switch(u[3]=(M=u[3]).toLowerCase()){case"data":if(M=="data"){if(u[1]==="/"){if((p=m.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&m.push([u[3],!0]);break}if(m[m.length-1][1])break;u[1]==="/"?fO(n.slice(P,u.index),D,E,m[m.length-1][0]=="comment"?he:S,{c:I,r:A},K,le[I],w,O,r):(D="",E=Qa(u[0]),P=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(ye.length>0&&(S.c=ye),(!r.sheetRows||r.sheetRows>A)&&S.v!==void 0&&(r.dense?(_[A]||(_[A]=[]),_[A][I]=S):_[dr(I)+Sr(A)]=S),S.HRef&&(S.l={Target:Ut(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(F=I+(parseInt(S.MergeAcross,10)|0),U=A+(parseInt(S.MergeDown,10)|0),re.push({s:{c:I,r:A},e:{c:F,r:U}})),!r.sheetStubs)S.MergeAcross?I=F+1:++I;else if(S.MergeAcross||S.MergeDown){for(var oe=I;oe<=F;++oe)for(var se=A;se<=U;++se)(oe>I||se>A)&&(r.dense?(_[se]||(_[se]=[]),_[se][oe]={t:"z"}):_[dr(oe)+Sr(se)]={t:"z"});I=F+1}else++I;else S=oO(u[0]),S.Index&&(I=+S.Index-1),I<R.s.c&&(R.s.c=I),I>R.e.c&&(R.e.c=I),u[0].slice(-2)==="/>"&&++I,ye=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(A<R.s.r&&(R.s.r=A),A>R.e.r&&(R.e.r=A),u[0].slice(-2)==="/>"&&(w=Qa(u[0]),w.Index&&(A=+w.Index-1)),I=0,++A):(w=Qa(u[0]),w.Index&&(A=+w.Index-1),Y={},(w.AutoFitHeight=="0"||w.Height)&&(Y.hpx=parseInt(w.Height,10),Y.hpt=Ju(Y.hpx),ne[A]=Y),w.Hidden=="1"&&(Y.hidden=!0,ne[A]=Y));break;case"worksheet":if(u[1]==="/"){if((p=m.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"));y.push(T),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(_["!ref"]=Pt(R),r.sheetRows&&r.sheetRows<=R.e.r&&(_["!fullref"]=_["!ref"],R.e.r=r.sheetRows-1,_["!ref"]=Pt(R))),re.length&&(_["!merges"]=re),le.length>0&&(_["!cols"]=le),ne.length>0&&(_["!rows"]=ne),g[T]=_}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=I=0,m.push([u[3],!1]),p=Qa(u[0]),T=Ut(p.Name),_=r.dense?[]:{},re=[],O=[],ne=[],q={name:T,Hidden:0},z.Sheets.push(q);break;case"table":if(u[1]==="/"){if((p=m.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else{if(u[0].slice(-2)=="/>")break;m.push([u[3],!1]),le=[],H=!1}break;case"style":u[1]==="/"?dO(K,W,r):W=Qa(u[0]);break;case"numberformat":W.nf=Ut(Qa(u[0]).Format||"General"),Ou[W.nf]&&(W.nf=Ou[W.nf]);for(var fe=0;fe!=392&&yt[fe]!=W.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(yt[fe]==null){Ei(W.nf,fe);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(j=Qa(u[0]),j.Hidden&&(j.hidden=!0,delete j.Hidden),j.Width&&(j.wpx=parseInt(j.Width,10)),!H&&j.wpx>10){H=!0,wn=Aw;for(var xe=0;xe<le.length;++xe)le[xe]&&no(le[xe])}H&&no(j),le[j.Index-1||le.length]=j;for(var je=0;je<+j.Span;++je)le[le.length]=ar(j);break;case"namedrange":if(u[1]==="/")break;z.Names||(z.Names=[]);var X=bt(u[0]),Ke={Name:X.Name,Ref:pc(X.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(Ke.Sheet=z.Sheets.length-1),z.Names.push(Ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?D+=n.slice(ee,u.index):ee=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;W.Interior=Qa(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?M4(pe,M,n.slice(ce,u.index)):ce=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((p=m.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else m.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((p=m.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"));hO(he),ye.push(he)}else m.push([u[3],!1]),p=Qa(u[0]),he={a:p.Author};break;case"autofilter":if(u[1]==="/"){if((p=m.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Xe=Qa(u[0]);_["!autofilter"]={ref:pc(Xe.Range).replace(/\$/g,"")},m.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((p=m.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&m.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((p=m.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&m.push([u[3],!0]);break;case"null":break;default:if(m.length==0&&u[3]=="document"||m.length==0&&u[3]=="uof")return ey(n,r);var Qe=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Qe=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Qe=!1}break;case"excelworkbook":switch(u[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Qe=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Qe=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(ce,u.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else ce=u.index+u[0].length;break;case"header":_["!margins"]||Zo(_["!margins"]={},"xlml"),isNaN(+bt(u[0]).Margin)||(_["!margins"].header=+bt(u[0]).Margin);break;case"footer":_["!margins"]||Zo(_["!margins"]={},"xlml"),isNaN(+bt(u[0]).Margin)||(_["!margins"].footer=+bt(u[0]).Margin);break;case"pagemargins":var it=bt(u[0]);_["!margins"]||Zo(_["!margins"]={},"xlml"),isNaN(+it.Top)||(_["!margins"].top=+it.Top),isNaN(+it.Left)||(_["!margins"].left=+it.Left),isNaN(+it.Right)||(_["!margins"].right=+it.Right),isNaN(+it.Bottom)||(_["!margins"].bottom=+it.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Qe=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Qe=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Qe=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Qe=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Qe=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Qe=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Qe=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Qe=!1}break;case"smarttags":break;default:Qe=!1;break}if(Qe||u[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?cO(ue,M,Ce,n.slice(ce,u.index)):(Ce=u,ce=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+m.join("|")}var Le={};return!r.bookSheets&&!r.bookProps&&(Le.Sheets=g),Le.SheetNames=y,Le.Workbook=z,Le.SSF=ar(yt),Le.Props=pe,Le.Custprops=ue,Le}function ip(e,t){switch(lg(t=t||{}),t.type||"base64"){case"base64":return Em(ha(e),t);case"binary":case"buffer":case"file":return Em(e,t);case"array":return Em(oo(e),t)}}function mO(e,t){var r=[];return e.Props&&r.push(B4(e.Props,t)),e.Custprops&&r.push(z4(e.Props,e.Custprops)),r.join("")}function pO(){return""}function gO(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Je("NumberFormat",null,{"ss:Format":Xt(yt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Je("Style",s.join(""),l))}),Je("Styles",r.join(""))}function rb(e){return Je("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+tg(e.Ref,{r:0,c:0})})}function vO(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(rb(a)))}return Je("Names",r.join(""))}function xO(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||s.push(rb(u)))}return s.join("")}function yO(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Je("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Je("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Je("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Je("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(cn("ProtectContents","True")),e["!protect"].objects&&a.push(cn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(cn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(cn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(cn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Je("WorksheetOptions",a.join(""),{xmlns:ca.x})}function _O(e){return e.map(function(t){var r=WA(t.t||""),n=Je("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Je("Comment",n,{"ss:Author":t.a})}).join("")}function wO(e,t,r,n,a,s,l){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+Xt(tg(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var m=_r(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(m.r==l.r?"":"["+(m.r-l.r)+"]")+"C"+(m.c==l.c?"":"["+(m.c-l.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=Xt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=Xt(e.l.Tooltip))),r["!merges"])for(var p=r["!merges"],g=0;g!=p.length;++g)p[g].s.c!=l.c||p[g].s.r!=l.r||(p[g].e.c>p[g].s.c&&(u["ss:MergeAcross"]=p[g].e.c-p[g].s.c),p[g].e.r>p[g].s.r&&(u["ss:MergeDown"]=p[g].e.r-p[g].s.r));var y="",_="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":y="Number",_=String(e.v);break;case"b":y="Boolean",_=e.v?"1":"0";break;case"e":y="Error",_=os[e.v];break;case"d":y="DateTime",_=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||yt[14]);break;case"s":y="String",_=UA(e.v||"");break}var T=co(n.cellXfs,e,n);u["ss:StyleID"]="s"+(21+T),u["ss:Index"]=l.c+1;var S=e.v!=null?_:"",w=e.t=="z"?"":'<Data ss:Type="'+y+'">'+S+"</Data>";return(e.c||[]).length>0&&(w+=_O(e.c)),Je("Cell",w,u)}function bO(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=wc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function kO(e,t,r,n){if(!e["!ref"])return"";var a=Lt(e["!ref"]),s=e["!merges"]||[],l=0,u=[];e["!cols"]&&e["!cols"].forEach(function(E,P){no(E);var I=!!E.width,A=Nh(P,E),R={"ss:Index":P+1};I&&(R["ss:Width"]=qu(A.width)),E.hidden&&(R["ss:Hidden"]="1"),u.push(Je("Column",null,R))});for(var m=Array.isArray(e),p=a.s.r;p<=a.e.r;++p){for(var g=[bO(p,(e["!rows"]||[])[p])],y=a.s.c;y<=a.e.c;++y){var _=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>y)&&!(s[l].s.r>p)&&!(s[l].e.c<y)&&!(s[l].e.r<p)){(s[l].s.c!=y||s[l].s.r!=p)&&(_=!0);break}if(!_){var T={r:p,c:y},S=_t(T),w=m?(e[p]||[])[y]:e[S];g.push(wO(w,S,e,t,r,n,T))}}g.push("</Row>"),g.length>2&&u.push(g.join(""))}return u.join("")}function SO(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],l=s?xO(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?kO(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(yO(s,t,e,r)),n.join("")}function TO(e,t){t||(t={}),e.SSF||(e.SSF=ar(yt)),e.SSF&&(Sc(),sd(e.SSF),t.revssf=kh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],co(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(mO(e,t)),r.push(pO()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Je("Worksheet",SO(n,t,e),{"ss:Name":Xt(e.SheetNames[n])}));return r[2]=gO(e,t),r[3]=vO(e),Dr+Je("Workbook",r.join(""),{xmlns:ca.ss,"xmlns:o":ca.o,"xmlns:x":ca.x,"xmlns:ss":ca.ss,"xmlns:dt":ca.dt,"xmlns:html":ca.html})}function EO(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=x4(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=y4(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var CO=[60,1084,2066,2165,2175];function AO(e,t,r,n,a){var s=n,l=[],u=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=s;for(var m=ts(r,r.l),p=sp[m],g=0;p!=null&&CO.indexOf(m)>-1;)s=ts(r,r.l+2),g=r.l+4,m==2066?g+=4:(m==2165||m==2175)&&(g+=12),u=r.slice(g,r.l+4+s),l.push(u),r.l+=4+s,p=sp[m=ts(r,r.l)];var y=tn(l);ln(y,0);var _=0;y.lens=[];for(var T=0;T<l.length;++T)y.lens.push(_),_+=l[T].length;if(y.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+y.length+" < "+n;return t.f(y,y.length,a)}function _i(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=yt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||os[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Hu(e.v):e.w=Yo(e.v):e.w=ma(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&nl(yt[n]||String(n))){var a=Qs(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Wf(e,t,r){return{v:e,ixfe:t,t:r}}function NO(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},l={},u=null,m=[],p="",g={},y,_="",T,S,w,E,P={},I=[],A,R,K=[],W=[],D={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ee={},re=function(ht){return ht<8?Ho[ht]:ht<64&&W[ht-8]||Ho[ht]},pe=function(ht,Ct,pr){var Ht=Ct.XF.data;if(!(!Ht||!Ht.patternType||!pr||!pr.cellStyles)){Ct.s={},Ct.s.patternType=Ht.patternType;var ct;(ct=Yu(re(Ht.icvFore)))&&(Ct.s.fgColor={rgb:ct}),(ct=Yu(re(Ht.icvBack)))&&(Ct.s.bgColor={rgb:ct})}},ue=function(ht,Ct,pr){if(!(Y>1)&&!(pr.sheetRows&&ht.r>=pr.sheetRows)){if(pr.cellStyles&&Ct.XF&&Ct.XF.data&&pe(ht,Ct,pr),delete Ct.ixfe,delete Ct.XF,y=ht,_=_t(ht),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ht.r<l.s.r&&(l.s.r=ht.r),ht.c<l.s.c&&(l.s.c=ht.c),ht.r+1>l.e.r&&(l.e.r=ht.r+1),ht.c+1>l.e.c&&(l.e.c=ht.c+1),pr.cellFormula&&Ct.f){for(var Ht=0;Ht<I.length;++Ht)if(!(I[Ht][0].s.c>ht.c||I[Ht][0].s.r>ht.r)&&!(I[Ht][0].e.c<ht.c||I[Ht][0].e.r<ht.r)){Ct.F=Pt(I[Ht][0]),(I[Ht][0].s.c!=ht.c||I[Ht][0].s.r!=ht.r)&&delete Ct.f,Ct.f&&(Ct.f=""+_n(I[Ht][1],l,ht,O,ce));break}}pr.dense?(a[ht.r]||(a[ht.r]=[]),a[ht.r][ht.c]=Ct):a[_]=Ct}},ce={enc:!1,sbcch:0,snames:[],sharedf:P,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ce.password=t.password);var Ce,ye=[],he=[],le=[],j=[],H=!1,O=[];O.SheetNames=ce.snames,O.sharedf=ce.sharedf,O.arrayf=ce.arrayf,O.names=[],O.XTI=[];var ne=0,Y=0,F=0,U=[],z=[],q;ce.codepage=1200,ja(1200);for(var M=!1;e.l<e.length-1;){var oe=e.l,se=e.read_shift(2);if(se===0&&ne===10)break;var fe=e.l===e.length?0:e.read_shift(2),xe=sp[se];if(xe&&xe.f){if(t.bookSheets&&ne===133&&se!==133)break;if(ne=se,xe.r===2||xe.r==12){var je=e.read_shift(2);if(fe-=2,!ce.enc&&je!==se&&((je&255)<<8|je>>8)!==se)throw new Error("rt mismatch: "+je+"!="+se);xe.r==12&&(e.l+=10,fe-=10)}var X={};if(se===10?X=xe.f(e,fe,ce):X=AO(se,xe,e,fe,ce),Y==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(se){case 34:r.opts.Date1904=D.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(ce.enc||(e.l=0),ce.enc=X,!t.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:ce.lastuser=X;break;case 66:var Ke=Number(X);switch(Ke){case 21010:Ke=1200;break;case 32768:Ke=1e4;break;case 32769:Ke=1252;break}ja(ce.codepage=Ke),M=!0;break;case 317:ce.rrtabid=X;break;case 25:ce.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:ce.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(a["!type"]="dialog"),X.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),X.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:K.push(X);break;case 430:O.push([X]),O[O.length-1].XTI=[];break;case 35:case 547:O[O.length-1].push(X);break;case 24:case 536:q={Name:X.Name,Ref:_n(X.rgce,l,null,O,ce)},X.itab>0&&(q.Sheet=X.itab-1),O.names.push(q),O[0]||(O[0]=[],O[0].XTI=[]),O[O.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(z[X.itab-1]={ref:Pt(X.rgce[0][0][1][2])});break;case 22:ce.ExternCount=X;break;case 23:O.length==0&&(O[0]=[],O[0].XTI=[]),O[O.length-1].XTI=O[O.length-1].XTI.concat(X),O.XTI=O.XTI.concat(X);break;case 2196:if(ce.biff<8)break;q!=null&&(q.Comment=X[1]);break;case 18:a["!protect"]=X;break;case 19:X!==0&&ce.WTF&&console.error("Password verifier: "+X);break;case 133:s[X.pos]=X,ce.snames.push(X.name);break;case 10:{if(--Y)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Pt(l),t.sheetRows&&t.sheetRows<=l.e.r){var Xe=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Pt(l),l.e.r=Xe}l.e.r++,l.e.c++}ye.length>0&&(a["!merges"]=ye),he.length>0&&(a["!objects"]=he),le.length>0&&(a["!cols"]=le),j.length>0&&(a["!rows"]=j),D.Sheets.push(ee)}p===""?g=a:n[p]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ce.biff===8&&(ce.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),ce.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(ce.biff=5,M=!0,ja(ce.codepage=28591)),ce.biff==8&&X.BIFFVer==0&&X.dt==16&&(ce.biff=2),Y++)break;if(a=t.dense?[]:{},ce.biff<8&&!M&&(M=!0,ja(ce.codepage=t.codepage||1252)),ce.biff<5||X.BIFFVer==0&&X.dt==4096){p===""&&(p="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Qe={pos:e.l-fe,name:p};s[Qe.pos]=Qe,ce.snames.push(p)}else p=(s[oe]||{name:""}).name;X.dt==32&&(a["!type"]="chart"),X.dt==64&&(a["!type"]="macro"),ye=[],he=[],ce.arrayf=I=[],le=[],j=[],H=!1,ee={Hidden:(s[oe]||{hs:0}).hs,name:p}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[X.r]||[])[X.c]:a[_t({c:X.c,r:X.r})])&&++X.c,A={ixfe:X.ixfe,XF:K[X.ixfe]||{},v:X.val,t:"n"},F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue({c:X.c,r:X.r},A,t);break;case 5:case 517:A={ixfe:X.ixfe,XF:K[X.ixfe],v:X.val,t:X.t},F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue({c:X.c,r:X.r},A,t);break;case 638:A={ixfe:X.ixfe,XF:K[X.ixfe],v:X.rknum,t:"n"},F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue({c:X.c,r:X.r},A,t);break;case 189:for(var it=X.c;it<=X.C;++it){var Le=X.rkrec[it-X.c][0];A={ixfe:Le,XF:K[Le],v:X.rkrec[it-X.c][1],t:"n"},F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue({c:it,r:X.r},A,t)}break;case 6:case 518:case 1030:{if(X.val=="String"){u=X;break}if(A=Wf(X.val,X.cell.ixfe,X.tt),A.XF=K[A.ixfe],t.cellFormula){var kt=X.formula;if(kt&&kt[0]&&kt[0][0]&&kt[0][0][0]=="PtgExp"){var ft=kt[0][0][1][0],pt=kt[0][0][1][1],Gt=_t({r:ft,c:pt});P[Gt]?A.f=""+_n(X.formula,l,X.cell,O,ce):A.F=((t.dense?(a[ft]||[])[pt]:a[Gt])||{}).F}else A.f=""+_n(X.formula,l,X.cell,O,ce)}F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue(X.cell,A,t),u=X}break;case 7:case 519:if(u)u.val=X,A=Wf(X,u.cell.ixfe,"s"),A.XF=K[A.ixfe],t.cellFormula&&(A.f=""+_n(u.formula,l,u.cell,O,ce)),F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue(u.cell,A,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(X);var Cn=_t(X[0].s);if(T=t.dense?(a[X[0].s.r]||[])[X[0].s.c]:a[Cn],t.cellFormula&&T){if(!u||!Cn||!T)break;T.f=""+_n(X[1],l,X[0],O,ce),T.F=Pt(X[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!u)break;P[_t(u.cell)]=X[0],T=t.dense?(a[u.cell.r]||[])[u.cell.c]:a[_t(u.cell)],(T||{}).f=""+_n(X[0],l,y,O,ce)}}break;case 253:A=Wf(m[X.isst].t,X.ixfe,"s"),m[X.isst].h&&(A.h=m[X.isst].h),A.XF=K[A.ixfe],F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue({c:X.c,r:X.r},A,t);break;case 513:t.sheetStubs&&(A={ixfe:X.ixfe,XF:K[X.ixfe],t:"z"},F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue({c:X.c,r:X.r},A,t));break;case 190:if(t.sheetStubs)for(var zr=X.c;zr<=X.C;++zr){var Cr=X.ixfe[zr-X.c];A={ixfe:Cr,XF:K[Cr],t:"z"},F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue({c:zr,r:X.r},A,t)}break;case 214:case 516:case 4:A=Wf(X.val,X.ixfe,"s"),A.XF=K[A.ixfe],F>0&&(A.z=U[A.ixfe>>8&63]),_i(A,t,r.opts.Date1904),ue({c:X.c,r:X.r},A,t);break;case 0:case 512:Y===1&&(l=X);break;case 252:m=X;break;case 1054:if(ce.biff==4){U[F++]=X[1];for(var un=0;un<F+163&&yt[un]!=X[1];++un);un>=163&&Ei(X[1],F+163)}else Ei(X[1],X[0]);break;case 30:{U[F++]=X;for(var Fr=0;Fr<F+163&&yt[Fr]!=X;++Fr);Fr>=163&&Ei(X,F+163)}break;case 229:ye=ye.concat(X);break;case 93:he[X.cmo[0]]=ce.lastobj=X;break;case 438:ce.lastobj.TxO=X;break;case 127:ce.lastobj.ImData=X;break;case 440:for(E=X[0].s.r;E<=X[0].e.r;++E)for(w=X[0].s.c;w<=X[0].e.c;++w)T=t.dense?(a[E]||[])[w]:a[_t({c:w,r:E})],T&&(T.l=X[1]);break;case 2048:for(E=X[0].s.r;E<=X[0].e.r;++E)for(w=X[0].s.c;w<=X[0].e.c;++w)T=t.dense?(a[E]||[])[w]:a[_t({c:w,r:E})],T&&T.l&&(T.l.Tooltip=X[1]);break;case 28:{if(ce.biff<=5&&ce.biff>=2)break;T=t.dense?(a[X[0].r]||[])[X[0].c]:a[_t(X[0])];var nn=he[X[2]];T||(t.dense?(a[X[0].r]||(a[X[0].r]=[]),T=a[X[0].r][X[0].c]={t:"z"}):T=a[_t(X[0])]={t:"z"},l.e.r=Math.max(l.e.r,X[0].r),l.s.r=Math.min(l.s.r,X[0].r),l.e.c=Math.max(l.e.c,X[0].c),l.s.c=Math.min(l.s.c,X[0].c)),T.c||(T.c=[]),S={a:X[1],t:nn.TxO.t},T.c.push(S)}break;case 2173:v3(K[X.ixfe],X.ext);break;case 125:{if(!ce.cellStyles)break;for(;X.e>=X.s;)le[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},H||(H=!0,Jp(X.w/256)),no(le[X.e+1])}break;case 520:{var Jt={};X.level!=null&&(j[X.r]=Jt,Jt.level=X.level),X.hidden&&(j[X.r]=Jt,Jt.hidden=!0),X.hpt&&(j[X.r]=Jt,Jt.hpt=X.hpt,Jt.hpx=wc(X.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Zo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=X;break;case 161:a["!margins"]||Zo(a["!margins"]={}),a["!margins"].header=X.header,a["!margins"].footer=X.footer;break;case 574:X.RTL&&(D.Views[0].RTL=!0);break;case 146:W=X;break;case 2198:Ce=X;break;case 140:R=X;break;case 442:p?ee.CodeName=X||ee.name:D.WBProps.CodeName=X||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=fe}return r.SheetNames=Er(s).sort(function(Ar,ht){return Number(Ar)-Number(ht)}).map(function(Ar){return s[Ar].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&z.forEach(function(Ar,ht){r.Sheets[r.SheetNames[ht]]["!autofilter"]=Ar}),r.Strings=m,r.SSF=ar(yt),ce.enc&&(r.Encryption=ce.enc),Ce&&(r.Themes=Ce),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),O.names.length>0&&(D.Names=O.names),r.Workbook=D,r}var Ru={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function PO(e,t,r){var n=dt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=P1(n,Qm,Ru.DSI);for(var s in a)t[s]=a[s]}catch(p){if(r.WTF)throw p}var l=dt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var u=P1(l,ep,Ru.SI);for(var m in u)t[m]==null&&(t[m]=u[m])}catch(p){if(r.WTF)throw p}t.HeadingPairs&&t.TitlesOfParts&&(ew(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function IO(e,t){var r=[],n=[],a=[],s=0,l,u=s1(Qm,"n"),m=s1(ep,"n");if(e.Props)for(l=Er(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(u,l[s])?r:Object.prototype.hasOwnProperty.call(m,l[s])?n:a).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=Er(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(u,l[s])?r:Object.prototype.hasOwnProperty.call(m,l[s])?n:a).push([l[s],e.Custprops[l[s]]]);var p=[];for(s=0;s<a.length;++s)ow.indexOf(a[s][0])>-1||Q_.indexOf(a[s][0])>-1||a[s][1]!=null&&p.push(a[s]);n.length&&dt.utils.cfb_add(t,"/SummaryInformation",I1(n,Ru.SI,m,ep)),(r.length||p.length)&&dt.utils.cfb_add(t,"/DocumentSummaryInformation",I1(r,Ru.DSI,u,Qm,p.length?p:null,Ru.UDI))}function sg(e,t){t||(t={}),lg(t),wh(),t.codepage&&_h(t.codepage);var r,n;if(e.FullPaths){if(dt.find(e,"/encryption"))throw new Error("File is password-protected");r=dt.find(e,"!CompObj"),n=dt.find(e,"/Workbook")||dt.find(e,"/Book")}else{switch(t.type){case"base64":e=ua(ha(e));break;case"binary":e=ua(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ln(e,0),n={content:e}}var a,s;if(r&&EO(r),t.bookProps&&!t.bookSheets)a={};else{var l=Dt?"buffer":"array";if(n&&n.content)a=NO(n.content,t);else if((s=dt.find(e,"PerfectOffice_MAIN"))&&s.content)a=Go.to_workbook(s.content,(t.type=l,t));else if((s=dt.find(e,"NativeContent_MAIN"))&&s.content)a=Go.to_workbook(s.content,(t.type=l,t));else throw(s=dt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&dt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=V3(e))}var u={};return e.FullPaths&&PO(e,u,t),a.Props=a.Custprops=u,t.bookFiles&&(a.cfb=e),a}function DO(e,t){var r=t||{},n=dt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return dt.utils.cfb_add(n,a,nb(e,r)),r.biff==8&&(e.Props||e.Custprops)&&IO(e,n),r.biff==8&&e.vbaraw&&G3(n,dt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Qu={0:{f:nF},1:{f:dF},2:{f:PF},3:{f:yF},4:{f:pF},5:{f:CF},6:{f:OF},7:{f:kF},8:{f:WF},9:{f:UF},10:{f:BF},11:{f:zF},12:{f:hF},13:{f:DF},14:{f:wF},15:{f:vF},16:{f:Kw},17:{f:LF},18:{f:TF},19:{f:Wp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Rj},40:{},42:{},43:{f:O5},44:{f:F5},45:{f:M5},46:{f:z5},47:{f:B5},48:{},49:{f:s4},50:{},51:{f:_3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:xw},62:{f:jF},63:{f:N3},64:{f:aj},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Tn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ej},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:cF},148:{f:sF,p:16},151:{f:KF},152:{},153:{f:Fj},154:{},155:{},156:{f:Ij},157:{},158:{},159:{T:1,f:qP},160:{T:-1},161:{T:1,f:ll},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$F},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:x3},336:{T:-1},337:{f:k3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Jm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:vw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:YF},427:{f:qF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:JF},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:lF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:GF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Jm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:z3},633:{T:1},634:{T:-1},635:{T:1,f:M3},636:{T:-1},637:{f:u4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:wj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:ij},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},sp={6:{f:Sm},10:{f:Zs},12:{f:Mr},13:{f:Mr},14:{f:Ir},15:{f:Ir},16:{f:bn},17:{f:Ir},18:{f:Ir},19:{f:Mr},20:{f:L1},21:{f:L1},23:{f:vw},24:{f:B1},25:{f:Ir},26:{},27:{},28:{f:iP},29:{},34:{f:Ir},35:{f:M1},38:{f:bn},39:{f:bn},40:{f:bn},41:{f:bn},42:{f:Ir},43:{f:Ir},47:{f:v5},49:{f:DN},51:{f:Mr},60:{},61:{f:CN},64:{f:Ir},65:{f:IN},66:{f:Mr},77:{},80:{},81:{},82:{},85:{f:Mr},89:{},90:{},91:{},92:{f:gN},93:{f:lP},94:{},95:{f:Ir},96:{},97:{},99:{f:Ir},125:{f:xw},128:{f:ZN},129:{f:xN},130:{f:Mr},131:{f:Ir},132:{f:Ir},133:{f:yN},134:{},140:{f:gP},141:{f:Mr},144:{},146:{f:yP},151:{},152:{},153:{},154:{},155:{},156:{f:Mr},157:{},158:{},160:{f:EP},161:{f:bP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$N},190:{f:HN},193:{f:Zs},197:{},198:{},199:{},200:{},201:{},202:{f:Ir},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mr},220:{},221:{f:Ir},222:{},224:{f:GN},225:{f:pN},226:{f:Zs},227:{},229:{f:sP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:wN},253:{f:jN},255:{f:kN},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:lw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ir},353:{f:Zs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:JN},431:{f:Ir},432:{},433:{},434:{},437:{},438:{f:dP},439:{f:Ir},440:{f:fP},441:{},442:{f:cd},443:{},444:{f:Mr},445:{},446:{},448:{f:Zs},449:{f:EN,r:2},450:{f:Zs},512:{f:j1},513:{f:TP},515:{f:qN},516:{f:RN},517:{f:R1},519:{f:CP},520:{f:SN},523:{},545:{f:z1},549:{f:F1},566:{},574:{f:NN},638:{f:WN},659:{},1048:{},1054:{f:MN},1084:{},1212:{f:rP},2048:{f:mP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Zs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:_P,r:12},2173:{f:g3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ir,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:tP,r:12},2197:{},2198:{f:u3,r:12},2199:{},2200:{},2201:{},2202:{f:nP,r:12},2203:{f:Zs},2204:{},2205:{},2206:{},2207:{},2211:{f:TN},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:kP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:xP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:j1},1:{},2:{f:DP},3:{f:PP},4:{f:NP},5:{f:R1},7:{f:jP},8:{},9:{f:Bf},11:{},22:{f:Mr},30:{f:zN},31:{},32:{},33:{f:z1},36:{},37:{f:F1},50:{f:OP},62:{},52:{},67:{},68:{f:Mr},69:{},86:{},126:{},127:{f:AP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:RP},223:{},234:{},354:{},421:{},518:{f:Sm},521:{f:Bf},536:{f:B1},547:{f:M1},561:{},579:{},1030:{f:Sm},1033:{f:Bf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function et(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&Bp(r)&&e.push(r)}}function FO(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return et(e,t,r,a);var s=t;if(!isNaN(s)){for(var l=r.parts||[],u=0,m=0,p=0;p+(l[u]||8224)<=8224;)p+=l[u]||8224,u++;var g=e.next(4);for(g.write_shift(2,s),g.write_shift(2,p),e.push(r.slice(m,m+p)),m+=p;m<a;){for(g=e.next(4),g.write_shift(2,60),p=0;p+(l[u]||8224)<=8224;)p+=l[u]||8224,u++;g.write_shift(2,p),e.push(r.slice(m,m+p)),m+=p}}}function hd(e,t,r){return e||(e=Fe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function jO(e,t,r,n){var a=Fe(9);return hd(a,e,t),cw(r,n||"b",a),a}function OO(e,t,r){var n=Fe(8+2*r.length);return hd(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function RO(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Kr(fr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?et(e,2,FP(r,n,a)):et(e,3,IP(r,n,a));return;case"b":case"e":et(e,5,jO(r,n,t.v,t.t));return;case"s":case"str":et(e,4,OO(r,n,(t.v||"").slice(0,255)));return}et(e,1,hd(null,r,n))}function LO(e,t,r,n){var a=Array.isArray(t),s=Lt(t["!ref"]||"A1"),l,u="",m=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Pt(s)}for(var p=s.s.r;p<=s.e.r;++p){u=Sr(p);for(var g=s.s.c;g<=s.e.c;++g){p===s.s.r&&(m[g]=dr(g)),l=m[g]+u;var y=a?(t[p]||[])[g]:t[l];y&&RO(e,y,p,g)}}}function MO(e,t){for(var r=t||{},n=Kn(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return et(n,r.biff==4?1033:r.biff==3?521:9,Yp(e,16,r)),LO(n,e.Sheets[e.SheetNames[a]],a,r),et(n,10),n.end()}function BO(e,t,r){et(e,49,FN({sz:12,name:"Arial"},r))}function zO(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&et(e,1054,BN(a,t[a],r))})}function UO(e,t){var r=Fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),et(e,2151,r),r=Fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),mw(Lt(t["!ref"]||"A1"),r),r.write_shift(4,4),et(e,2152,r)}function WO(e,t){for(var r=0;r<16;++r)et(e,224,O1({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){et(e,224,O1(n,0,t))})}function $O(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];et(e,440,hP(n)),n[1].Tooltip&&et(e,2048,pP(n))}delete t["!links"]}function HO(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&et(e,125,wP(Nh(a,n),a))})}}function VO(e,t,r,n,a){var s=16+co(a.cellXfs,t,a);if(t.v==null&&!t.bf){et(e,513,Qo(r,n,s));return}if(t.bf)et(e,6,xD(t,r,n,a,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?Kr(fr(t.v)):t.v;et(e,515,XN(r,n,l,s));break;case"b":case"e":et(e,517,YN(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var u=ng(a.Strings,t.v,a.revStrings);et(e,253,ON(r,n,u,s))}else et(e,516,LN(r,n,(t.v||"").slice(0,255),s,a));break;default:et(e,513,Qo(r,n,s))}}function GO(e,t,r){var n=Kn(),a=r.SheetNames[e],s=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[e]||{},m=Array.isArray(s),p=t.biff==8,g,y="",_=[],T=Lt(s["!ref"]||"A1"),S=p?65536:16384;if(T.e.c>255||T.e.r>=S){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,S-1)}et(n,2057,Yp(r,16,t)),et(n,13,Da(1)),et(n,12,Da(100)),et(n,15,Rn(!0)),et(n,17,Rn(!1)),et(n,16,Xo(.001)),et(n,95,Rn(!0)),et(n,42,Rn(!1)),et(n,43,Rn(!1)),et(n,130,Da(1)),et(n,128,KN()),et(n,131,Rn(!1)),et(n,132,Rn(!1)),p&&HO(n,s["!cols"]),et(n,512,UN(T,t)),p&&(s["!links"]=[]);for(var w=T.s.r;w<=T.e.r;++w){y=Sr(w);for(var E=T.s.c;E<=T.e.c;++E){w===T.s.r&&(_[E]=dr(E)),g=_[E]+y;var P=m?(s[w]||[])[E]:s[g];P&&(VO(n,P,w,E,t),p&&P.l&&s["!links"].push([g,P.l]))}}var I=u.CodeName||u.name||a;return p&&et(n,574,PN((l.Views||[])[0])),p&&(s["!merges"]||[]).length&&et(n,229,oP(s["!merges"])),p&&$O(n,s),et(n,442,uw(I)),p&&UO(n,s),et(n,10),n.end()}function ZO(e,t,r){var n=Kn(),a=(e||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,m=r.biff==5;if(et(n,2057,Yp(e,5,r)),r.bookType=="xla"&&et(n,135),et(n,225,u?Da(1200):null),et(n,193,Y4(2)),m&&et(n,191),m&&et(n,192),et(n,226),et(n,92,vN("SheetJS",r)),et(n,66,Da(u?1200:1252)),u&&et(n,353,Da(0)),u&&et(n,448),et(n,317,SP(e.SheetNames.length)),u&&e.vbaraw&&et(n,211),u&&e.vbaraw){var p=l.CodeName||"ThisWorkbook";et(n,442,uw(p))}et(n,156,Da(17)),et(n,25,Rn(!1)),et(n,18,Rn(!1)),et(n,19,Da(0)),u&&et(n,431,Rn(!1)),u&&et(n,444,Da(0)),et(n,61,AN()),et(n,64,Rn(!1)),et(n,141,Da(0)),et(n,34,Rn(Ej(e)=="true")),et(n,14,Rn(!0)),u&&et(n,439,Rn(!1)),et(n,218,Da(0)),BO(n,e,r),zO(n,e.SSF,r),WO(n,r),u&&et(n,352,Rn(!1));var g=n.end(),y=Kn();u&&et(y,140,vP()),u&&r.Strings&&FO(y,252,bN(r.Strings)),et(y,10);var _=y.end(),T=Kn(),S=0,w=0;for(w=0;w<e.SheetNames.length;++w)S+=(u?12:11)+(u?2:1)*e.SheetNames[w].length;var E=g.length+S+_.length;for(w=0;w<e.SheetNames.length;++w){var P=s[w]||{};et(T,133,_N({pos:E,hs:P.Hidden||0,dt:0,name:e.SheetNames[w]},r)),E+=t[w].length}var I=T.end();if(S!=I.length)throw new Error("BS8 "+S+" != "+I.length);var A=[];return g.length&&A.push(g),I.length&&A.push(I),_.length&&A.push(_),tn(A)}function KO(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ar(yt)),e&&e.SSF&&(Sc(),sd(e.SSF),r.revssf=kh(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,cg(r),r.cellXfs=[],co(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=GO(a,r,e);return n.unshift(ZO(e,n,r)),tn(n)}function nb(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Ln(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return KO(e,t);case 4:case 3:case 2:return MO(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function q1(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=a.index,u=s&&s.index||e.length,m=FA(e.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),p=-1,g=0,y=0,_=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(l=0;l<m.length;++l){var w=m[l].trim(),E=w.slice(0,3).toLowerCase();if(E=="<tr"){if(++p,r.sheetRows&&r.sheetRows<=p){--p;break}g=0;continue}if(!(E!="<td"&&E!="<th")){var P=w.split(/<\/t[dh]>/i);for(u=0;u<P.length;++u){var I=P[u].trim();if(I.match(/<t[dh]/i)){for(var A=I,R=0;A.charAt(0)=="<"&&(R=A.indexOf(">"))>-1;)A=A.slice(R+1);for(var K=0;K<S.length;++K){var W=S[K];W.s.c==g&&W.s.r<p&&p<=W.e.r&&(g=W.e.c+1,K=-1)}var D=bt(I.slice(0,I.indexOf(">")));_=D.colspan?+D.colspan:1,((y=+D.rowspan)>1||_>1)&&S.push({s:{r:p,c:g},e:{r:p+(y||1)-1,c:g+_-1}});var ee=D.t||D["data-t"]||"";if(!A.length){g+=_;continue}if(A=I_(A),T.s.r>p&&(T.s.r=p),T.e.r<p&&(T.e.r=p),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!A.length){g+=_;continue}var re={t:"s",v:A};r.raw||!A.trim().length||ee=="s"||(A==="TRUE"?re={t:"b",v:!0}:A==="FALSE"?re={t:"b",v:!1}:isNaN(ai(A))?isNaN(yc(A).getDate())||(re={t:"d",v:fr(A)},r.cellDates||(re={t:"n",v:Kr(re.v)}),re.z=r.dateNF||yt[14]):re={t:"n",v:ai(A)}),r.dense?(n[p]||(n[p]=[]),n[p][g]=re):n[_t({r:p,c:g})]=re,g+=_}}}}return n["!ref"]=Pt(T),S.length&&(n["!merges"]=S),n}function ab(e,t,r,n){for(var a=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var u=0,m=0,p=0;p<a.length;++p)if(!(a[p].s.r>r||a[p].s.c>l)&&!(a[p].e.r<r||a[p].e.c<l)){if(a[p].s.r<r||a[p].s.c<l){u=-1;break}u=a[p].e.r-a[p].s.r+1,m=a[p].e.c-a[p].s.c+1;break}if(!(u<0)){var g=_t({r,c:l}),y=n.dense?(e[r]||[])[l]:e[g],_=y&&y.v!=null&&(y.h||Dp(y.w||(Ai(y),y.w)||""))||"",T={};u>1&&(T.rowspan=u),m>1&&(T.colspan=m),n.editable?_='<span contenteditable="true">'+_+"</span>":y&&(T["data-t"]=y&&y.t||"z",y.v!=null&&(T["data-v"]=y.v),y.z!=null&&(T["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),T.id=(n.id||"sjs")+"-"+g,s.push(Je("td",_,T))}}var S="<tr>";return S+s.join("")+"</tr>"}var ib='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',sb="</body></html>";function YO(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return lo(q1(r[0],t),t);var n=mg();return r.forEach(function(a,s){pg(n,q1(a,t),"Sheet"+(s+1))}),n}function ob(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function lb(e,t){var r=t||{},n=r.header!=null?r.header:ib,a=r.footer!=null?r.footer:sb,s=[n],l=Ln(e["!ref"]);r.dense=Array.isArray(e),s.push(ob(e,l,r));for(var u=l.s.r;u<=l.e.r;++u)s.push(ab(e,l,u,r));return s.push("</table>"+a),s.join("")}function cb(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?_r(n.origin):n.origin;a=l.r,s=l.c}var u=t.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,u.length),p={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var g=Ln(e["!ref"]);p.s.r=Math.min(p.s.r,g.s.r),p.s.c=Math.min(p.s.c,g.s.c),p.e.r=Math.max(p.e.r,g.e.r),p.e.c=Math.max(p.e.c,g.e.c),a==-1&&(p.e.r=a=g.e.r+1)}var y=[],_=0,T=e["!rows"]||(e["!rows"]=[]),S=0,w=0,E=0,P=0,I=0,A=0;for(e["!cols"]||(e["!cols"]=[]);S<u.length&&w<m;++S){var R=u[S];if(X1(R)){if(n.display)continue;T[w]={hidden:!0}}var K=R.children;for(E=P=0;E<K.length;++E){var W=K[E];if(!(n.display&&X1(W))){var D=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):I_(W.innerHTML),ee=W.getAttribute("data-z")||W.getAttribute("z");for(_=0;_<y.length;++_){var re=y[_];re.s.c==P+s&&re.s.r<w+a&&w+a<=re.e.r&&(P=re.e.c+1-s,_=-1)}A=+W.getAttribute("colspan")||1,((I=+W.getAttribute("rowspan")||1)>1||A>1)&&y.push({s:{r:w+a,c:P+s},e:{r:w+a+(I||1)-1,c:P+s+(A||1)-1}});var pe={t:"s",v:D},ue=W.getAttribute("data-t")||W.getAttribute("t")||"";D!=null&&(D.length==0?pe.t=ue||"z":n.raw||D.trim().length==0||ue=="s"||(D==="TRUE"?pe={t:"b",v:!0}:D==="FALSE"?pe={t:"b",v:!1}:isNaN(ai(D))?isNaN(yc(D).getDate())||(pe={t:"d",v:fr(D)},n.cellDates||(pe={t:"n",v:Kr(pe.v)}),pe.z=n.dateNF||yt[14]):pe={t:"n",v:ai(D)})),pe.z===void 0&&ee!=null&&(pe.z=ee);var ce="",Ce=W.getElementsByTagName("A");if(Ce&&Ce.length)for(var ye=0;ye<Ce.length&&!(Ce[ye].hasAttribute("href")&&(ce=Ce[ye].getAttribute("href"),ce.charAt(0)!="#"));++ye);ce&&ce.charAt(0)!="#"&&(pe.l={Target:ce}),n.dense?(e[w+a]||(e[w+a]=[]),e[w+a][P+s]=pe):e[_t({c:P+s,r:w+a})]=pe,p.e.c<P+s&&(p.e.c=P+s),P+=A}}++w}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),p.e.r=Math.max(p.e.r,w-1+a),e["!ref"]=Pt(p),w>=m&&(e["!fullref"]=Pt((p.e.r=u.length-S+w-1+a,p))),e}function ub(e,t){var r=t||{},n=r.dense?[]:{};return cb(n,e,t)}function qO(e,t){return lo(ub(e,t),t)}function X1(e){var t="",r=XO(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function XO(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function JO(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ut(t.replace(/<[^>]*>/g,""));return[r]}var J1={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function db(e,t){var r=t||{},n=Fp(e),a=[],s,l,u={name:""},m="",p=0,g,y,_={},T=[],S=r.dense?[]:{},w,E,P={value:""},I="",A=0,R=[],K=-1,W=-1,D={s:{r:1e6,c:1e7},e:{r:0,c:0}},ee=0,re={},pe=[],ue={},ce=0,Ce=0,ye=[],he=1,le=1,j=[],H={Names:[]},O={},ne=["",""],Y=[],F={},U="",z=0,q=!1,M=!1,oe=0;for(Zu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=Zu.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"工作表":w[1]==="/"?(D.e.c>=D.s.c&&D.e.r>=D.s.r?S["!ref"]=Pt(D):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=D.e.r&&(S["!fullref"]=S["!ref"],D.e.r=r.sheetRows-1,S["!ref"]=Pt(D)),pe.length&&(S["!merges"]=pe),ye.length&&(S["!rows"]=ye),g.name=g.名称||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),_[g.name]=S,M=!1):w[0].charAt(w[0].length-2)!=="/"&&(g=bt(w[0],!1),K=W=-1,D.s.r=D.s.c=1e7,D.e.r=D.e.c=0,S=r.dense?[]:{},pe=[],ye=[],M=!0);break;case"table-row-group":w[1]==="/"?--ee:++ee;break;case"table-row":case"行":if(w[1]==="/"){K+=he,he=1;break}if(y=bt(w[0],!1),y.行号?K=y.行号-1:K==-1&&(K=0),he=+y["number-rows-repeated"]||1,he<10)for(oe=0;oe<he;++oe)ee>0&&(ye[K+oe]={level:ee});W=-1;break;case"covered-table-cell":w[1]!=="/"&&++W,r.sheetStubs&&(r.dense?(S[K]||(S[K]=[]),S[K][W]={t:"z"}):S[_t({r:K,c:W})]={t:"z"}),I="",R=[];break;case"table-cell":case"数据":if(w[0].charAt(w[0].length-2)==="/")++W,P=bt(w[0],!1),le=parseInt(P["number-columns-repeated"]||"1",10),E={t:"z",v:null},P.formula&&r.cellFormula!=!1&&(E.f=Z1(Ut(P.formula))),(P.数据类型||P["value-type"])=="string"&&(E.t="s",E.v=Ut(P["string-value"]||""),r.dense?(S[K]||(S[K]=[]),S[K][W]=E):S[_t({r:K,c:W})]=E),W+=le-1;else if(w[1]!=="/"){++W,I="",A=0,R=[],le=1;var se=he?K+he-1:K;if(W>D.e.c&&(D.e.c=W),W<D.s.c&&(D.s.c=W),K<D.s.r&&(D.s.r=K),se>D.e.r&&(D.e.r=se),P=bt(w[0],!1),Y=[],F={},E={t:P.数据类型||P["value-type"],v:null},r.cellFormula)if(P.formula&&(P.formula=Ut(P.formula)),P["number-matrix-columns-spanned"]&&P["number-matrix-rows-spanned"]&&(ce=parseInt(P["number-matrix-rows-spanned"],10)||0,Ce=parseInt(P["number-matrix-columns-spanned"],10)||0,ue={s:{r:K,c:W},e:{r:K+ce-1,c:W+Ce-1}},E.F=Pt(ue),j.push([ue,E.F])),P.formula)E.f=Z1(P.formula);else for(oe=0;oe<j.length;++oe)K>=j[oe][0].s.r&&K<=j[oe][0].e.r&&W>=j[oe][0].s.c&&W<=j[oe][0].e.c&&(E.F=j[oe][1]);switch((P["number-columns-spanned"]||P["number-rows-spanned"])&&(ce=parseInt(P["number-rows-spanned"],10)||0,Ce=parseInt(P["number-columns-spanned"],10)||0,ue={s:{r:K,c:W},e:{r:K+ce-1,c:W+Ce-1}},pe.push(ue)),P["number-columns-repeated"]&&(le=parseInt(P["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=ur(P["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(P.value);break;case"percentage":E.t="n",E.v=parseFloat(P.value);break;case"currency":E.t="n",E.v=parseFloat(P.value);break;case"date":E.t="d",E.v=fr(P["date-value"]),r.cellDates||(E.t="n",E.v=Kr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=PA(P["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Sh(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(P.数据数值);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",P["string-value"]!=null&&(I=Ut(P["string-value"]),R=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(q=!1,E.t==="s"&&(E.v=I||"",R.length&&(E.R=R),q=A==0),O.Target&&(E.l=O),Y.length>0&&(E.c=Y,Y=[]),I&&r.cellText!==!1&&(E.w=I),q&&(E.t="z",delete E.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=K))for(var fe=0;fe<he;++fe){if(le=parseInt(P["number-columns-repeated"]||"1",10),r.dense)for(S[K+fe]||(S[K+fe]=[]),S[K+fe][W]=fe==0?E:ar(E);--le>0;)S[K+fe][W+le]=ar(E);else for(S[_t({r:K+fe,c:W})]=E;--le>0;)S[_t({r:K+fe,c:W+le})]=ar(E);D.e.c<=W&&(D.e.c=W)}le=parseInt(P["number-columns-repeated"]||"1",10),W+=le-1,le=0,E={},I="",R=[]}O={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s;F.t=I,R.length&&(F.R=R),F.a=U,Y.push(F)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);U="",z=0,I="",A=0,R=[];break;case"creator":w[1]==="/"?U=n.slice(z,w.index):z=w.index+w[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);I="",A=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(re[u.name]=m,(s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&(m="",u=bt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=bt(w[0],!1),m+=J1[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=bt(w[0],!1),m+=J1[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(p,w.index);break}else p=w.index+w[0].length;break;case"named-range":l=bt(w[0],!1),ne=Tm(l["cell-range-address"]);var xe={Name:l.name,Ref:ne[0]+"!"+ne[1]};M&&(xe.Sheet=T.length),H.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!P||!P["string-value"])){var je=JO(n.slice(A,w.index));I=(I.length>0?I+`
`:"")+je[0]}else bt(w[0],!1),A=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{ne=Tm(bt(w[0])["target-range-address"]),_[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(O=bt(w[0],!1),!O.href)break;O.Target=Ut(O.href),delete O.href,O.Target.charAt(0)=="#"&&O.Target.indexOf(".")>-1?(ne=Tm(O.Target.slice(1)),O.Target="#"+ne[0]+"!"+ne[1]):O.Target.match(/^\.\.[\\\/]/)&&(O.Target=O.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(w)}}var X={Sheets:_,SheetNames:T,Workbook:H};return r.bookSheets&&delete X.Sheets,X}function Q1(e,t){t=t||{},Ia(e,"META-INF/manifest.xml")&&P4(Lr(e,"META-INF/manifest.xml"),t);var r=da(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=db(nr(r),t);return Ia(e,"meta.xml")&&(n.Props=X_(Lr(e,"meta.xml"))),n}function ey(e,t){return db(e,t)}var QO=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Gu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Dr+t}})(),ty=(function(){var e=function(s){return Xt(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,u){var m=[];m.push('      <table:table table:name="'+Xt(l.SheetNames[u])+`" table:style-name="ta1">
`);var p=0,g=0,y=Ln(s["!ref"]||"A1"),_=s["!merges"]||[],T=0,S=Array.isArray(s);if(s["!cols"])for(g=0;g<=y.e.c;++g)m.push("        <table:table-column"+(s["!cols"][g]?' table:style-name="co'+s["!cols"][g].ods+'"':"")+`></table:table-column>
`);var w="",E=s["!rows"]||[];for(p=0;p<y.s.r;++p)w=E[p]?' table:style-name="ro'+E[p].ods+'"':"",m.push("        <table:table-row"+w+`></table:table-row>
`);for(;p<=y.e.r;++p){for(w=E[p]?' table:style-name="ro'+E[p].ods+'"':"",m.push("        <table:table-row"+w+`>
`),g=0;g<y.s.c;++g)m.push(t);for(;g<=y.e.c;++g){var P=!1,I={},A="";for(T=0;T!=_.length;++T)if(!(_[T].s.c>g)&&!(_[T].s.r>p)&&!(_[T].e.c<g)&&!(_[T].e.r<p)){(_[T].s.c!=g||_[T].s.r!=p)&&(P=!0),I["table:number-columns-spanned"]=_[T].e.c-_[T].s.c+1,I["table:number-rows-spanned"]=_[T].e.r-_[T].s.r+1;break}if(P){m.push(r);continue}var R=_t({r:p,c:g}),K=S?(s[p]||[])[g]:s[R];if(K&&K.f&&(I["table:formula"]=Xt(SD(K.f)),K.F&&K.F.slice(0,R.length)==R)){var W=Ln(K.F);I["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,I["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!K){m.push(t);continue}switch(K.t){case"b":A=K.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=K.v?"true":"false";break;case"n":A=K.w||String(K.v||0),I["office:value-type"]="float",I["office:value"]=K.v||0;break;case"s":case"str":A=K.v==null?"":K.v,I["office:value-type"]="string";break;case"d":A=K.w||fr(K.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=fr(K.v).toISOString(),I["table:style-name"]="ce1";break;default:m.push(t);continue}var D=e(A);if(K.l&&K.l.Target){var ee=K.l.Target;ee=ee.charAt(0)=="#"?"#"+TD(ee.slice(1)):ee,ee.charAt(0)!="#"&&!ee.match(/^\w+:/)&&(ee="../"+ee),D=Je("text:a",D,{"xlink:href":ee.replace(/&/g,"&amp;")})}m.push("          "+Je("table:table-cell",Je("text:p",D,{}),I)+`
`)}m.push(`        </table:table-row>
`)}return m.push(`      </table:table>
`),m.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(p){return l.Sheets[p]}).forEach(function(p){if(p&&p["!cols"]){for(var g=0;g<p["!cols"].length;++g)if(p["!cols"][g]){var y=p["!cols"][g];if(y.width==null&&y.wpx==null&&y.wch==null)continue;no(y),y.ods=u;var _=p["!cols"][g].wpx+"px";s.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),s.push(`  </style:style>
`),++u}}});var m=0;l.SheetNames.map(function(p){return l.Sheets[p]}).forEach(function(p){if(p&&p["!rows"]){for(var g=0;g<p["!rows"].length;++g)if(p["!rows"][g]){p["!rows"][g].ods=m;var y=p["!rows"][g].hpx+"px";s.push('  <style:style style:name="ro'+m+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),s.push(`  </style:style>
`),++m}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,u){var m=[Dr],p=Gu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Gu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(m.push("<office:document"+p+g+`>
`),m.push(q_().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+p+`>
`),a(m,l),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var y=0;y!=l.SheetNames.length;++y)m.push(n(l.Sheets[l.SheetNames[y]],l,y));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),u.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}})();function fb(e,t){if(t.bookType=="fods")return ty(e,t);var r=Np(),n="",a=[],s=[];return n="mimetype",It(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",It(r,n,ty(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",It(r,n,QO(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",It(r,n,Dr+q_()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",It(r,n,F4(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",It(r,n,I4(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function el(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function op(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):nr(oo(e))}function eR(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ua(Ti(e))}function tR(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function io(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function ry(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function rR(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function nR(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function ed(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Kt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Tr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function $t(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=ed(e,r),s=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(s){case 0:{for(var m=r[0];e[r[0]++]>=128;);u=e.slice(m,r[0])}break;case 5:l=4,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=ed(e,r),u=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var p={data:u,type:s};t[a]==null?t[a]=[p]:t[a].push(p)}return t}function on(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Kt(n*8+a.type)),a.type==2&&t.push(Kt(a.data.length)),t.push(a.data))})}),io(t)}function og(e,t){return e?.map(function(r){return t(r.data)})||[]}function Na(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=ed(e,n),s=$t(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:Tr(s[1][0].data),messages:[]};s[2].forEach(function(u){var m=$t(u.data),p=Tr(m[3][0].data);l.messages.push({meta:m,data:e.slice(n[0],n[0]+p)}),n[0]+=p}),(t=s[3])!=null&&t[0]&&(l.merge=Tr(s[3][0].data)>>>0>0),r.push(l)}return r}function ic(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Kt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Kt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Kt(l.data.length)}],n[2].push({data:on(l.meta),type:2})});var s=on(n);t.push(Kt(s.length)),t.push(s),a.forEach(function(l){return t.push(l)})}),io(t)}function aR(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ed(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=t[r[0]],u>1&&(l|=t[r[0]+1]<<8),u>2&&(l|=t[r[0]+2]<<16),u>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var m=0,p=0;if(s==1?(p=(t[r[0]]>>2&7)+4,m=(t[r[0]++]&224)<<3,m|=t[r[0]++]):(p=(t[r[0]++]>>2)+1,s==2?(m=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(m=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[io(a)],m==0)throw new Error("Invalid offset 0");if(m>a[0].length)throw new Error("Invalid offset beyond length");if(p>=m)for(a.push(a[0].slice(-m)),p-=m;p>=a[a.length-1].length;)a.push(a[a.length-1]),p-=a[a.length-1].length;a.push(a[0].slice(-m,-m+p))}}var g=io(a);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function Pa(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(aR(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return io(t)}function sc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Kt(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return io(t)}function iR(e,t,r,n){var a=el(e),s=a.getUint32(4,!0),l=(n>1?12:8)+ry(s&(n>1?3470:398))*4,u=-1,m=-1,p=NaN,g=new Date(2001,0,1);s&512&&(u=a.getUint32(l,!0),l+=4),l+=ry(s&(n>1?12288:4096))*4,s&16&&(m=a.getUint32(l,!0),l+=4),s&32&&(p=a.getFloat64(l,!0),l+=8),s&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var y;switch(e[2]){case 0:break;case 2:y={t:"n",v:p};break;case 3:y={t:"s",v:t[m]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:p>0};break;case 7:y={t:"n",v:p/86400};break;case 8:y={t:"e",v:0};break;case 9:if(u>-1)y={t:"s",v:r[u]};else if(m>-1)y={t:"s",v:t[m]};else if(!isNaN(p))y={t:"n",v:p};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return y}function sR(e,t,r){var n=el(e),a=n.getUint32(8,!0),s=12,l=-1,u=-1,m=NaN,p=NaN,g=new Date(2001,0,1);a&1&&(m=rR(e,s),s+=16),a&2&&(p=n.getFloat64(s,!0),s+=8),a&4&&(g.setTime(g.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(u=n.getUint32(s,!0),s+=4),a&16&&(l=n.getUint32(s,!0),s+=4);var y;switch(e[1]){case 0:break;case 2:y={t:"n",v:m};break;case 3:y={t:"s",v:t[u]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:p>0};break;case 7:y={t:"n",v:p/86400};break;case 8:y={t:"e",v:0};break;case 9:if(l>-1)y={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:y={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return y}function Cm(e,t){var r=new Uint8Array(32),n=el(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,nR(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Am(e,t){var r=new Uint8Array(32),n=el(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function oR(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return iR(e,t,r,e[0]);case 5:return sR(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function yn(e){var t=$t(e);return ed(t[1][0].data)}function ny(e,t){var r=$t(t.data),n=Tr(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(l){var u=$t(l.data),m=Tr(u[1][0].data)>>>0;switch(n){case 1:s[m]=op(u[3][0].data);break;case 8:{var p=e[yn(u[9][0].data)][0],g=$t(p.data),y=e[yn(g[1][0].data)][0],_=Tr(y.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var T=$t(y.data);s[m]=T[3].map(function(S){return op(S.data)}).join("")}break}}),s}function lR(e,t){var r,n,a,s,l,u,m,p,g,y,_,T,S,w,E=$t(e),P=Tr(E[1][0].data)>>>0,I=Tr(E[2][0].data)>>>0,A=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Tr(E[8][0].data)>0||!1,R,K;if((s=(a=E[7])==null?void 0:a[0])!=null&&s.data&&t!=0)R=(u=(l=E[7])==null?void 0:l[0])==null?void 0:u.data,K=(p=(m=E[6])==null?void 0:m[0])==null?void 0:p.data;else if((y=(g=E[4])==null?void 0:g[0])!=null&&y.data&&t!=1)R=(T=(_=E[4])==null?void 0:_[0])==null?void 0:T.data,K=(w=(S=E[3])==null?void 0:S[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var W=A?4:1,D=el(R),ee=[],re=0;re<R.length/2;++re){var pe=D.getUint16(re*2,!0);pe<65535&&ee.push([re,pe])}if(ee.length!=I)throw"Expected ".concat(I," cells, found ").concat(ee.length);var ue=[];for(re=0;re<ee.length-1;++re)ue[ee[re][0]]=K.subarray(ee[re][1]*W,ee[re+1][1]*W);return ee.length>=1&&(ue[ee[ee.length-1][0]]=K.subarray(ee[ee.length-1][1]*W)),{R:P,cells:ue}}function cR(e,t){var r,n=$t(t.data),a=(r=n?.[7])!=null&&r[0]?Tr(n[7][0].data)>>>0>0?1:0:-1,s=og(n[5],function(l){return lR(l,a)});return{nrows:Tr(n[4][0].data)>>>0,data:s.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(m,p){if(l[u.R][p])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(p));l[u.R][p]=m}),l},[])}}function uR(e,t,r){var n,a=$t(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Tr(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Tr(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Pt(s);var l=$t(a[4][0].data),u=ny(e,e[yn(l[4][0].data)][0]),m=(n=l[17])!=null&&n[0]?ny(e,e[yn(l[17][0].data)][0]):[],p=$t(l[3][0].data),g=0;p[1].forEach(function(y){var _=$t(y.data),T=e[yn(_[2][0].data)][0],S=Tr(T.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var w=cR(e,T);w.data.forEach(function(E,P){E.forEach(function(I,A){var R=_t({r:g+P,c:A}),K=oR(I,u,m);K&&(r[R]=K)})}),g+=w.nrows})}function dR(e,t){var r=$t(t.data),n={"!ref":"A1"},a=e[yn(r[2][0].data)],s=Tr(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return uR(e,a[0],n),n}function fR(e,t){var r,n=$t(t.data),a={name:(r=n[1])!=null&&r[0]?op(n[1][0].data):"",sheets:[]},s=og(n[2],yn);return s.forEach(function(l){e[l].forEach(function(u){var m=Tr(u.meta[1][0].data);m==6e3&&a.sheets.push(dR(e,u))})}),a}function hR(e,t){var r=mg(),n=$t(t.data),a=og(n[1],yn);if(a.forEach(function(s){e[s].forEach(function(l){var u=Tr(l.meta[1][0].data);if(u==2){var m=fR(e,l);m.sheets.forEach(function(p,g){pg(r,p,g==0?m.name:m.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Nm(e){var t,r,n,a,s={},l=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var p;try{p=Pa(m.content)}catch(y){return console.log("?? "+m.content.length+" "+(y.message||y))}var g;try{g=Na(p)}catch(y){return console.log("## "+(y.message||y))}g.forEach(function(y){s[y.id]=y.messages,l.push(y.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(t=s?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Tr(s[1][0].meta[1][0].data)==1&&s[1][0];if(u||l.forEach(function(m){s[m].forEach(function(p){var g=Tr(p.meta[1][0].data)>>>0;if(g==1)if(!u)u=p;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return hR(s,u)}function mR(e,t,r){var n,a,s,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Tr(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var m=0,p=el(e[7][0].data),g=0,y=[],_=el(e[4][0].data),T=0,S=[],w=0;w<t.length;++w){if(t[w]==null){p.setUint16(w*2,65535,!0),_.setUint16(w*2,65535);continue}p.setUint16(w*2,g,!0),_.setUint16(w*2,T,!0);var E,P;switch(typeof t[w]){case"string":E=Cm({t:"s",v:t[w]},r),P=Am({t:"s",v:t[w]},r);break;case"number":E=Cm({t:"n",v:t[w]},r),P=Am({t:"n",v:t[w]},r);break;case"boolean":E=Cm({t:"b",v:t[w]},r),P=Am({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}y.push(E),g+=E.length,S.push(P),T+=P.length,++m}for(e[2][0].data=Kt(m);w<e[7][0].data.length/2;++w)p.setUint16(w*2,65535,!0),_.setUint16(w*2,65535,!0);return e[6][0].data=io(y),e[3][0].data=io(S),m}function pR(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ln(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Pt(n)));var s=fh(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(U){return U.forEach(function(z){typeof z=="string"&&l.push(z)})});var u={},m=[],p=dt.read(t.numbers,{type:"base64"});p.FileIndex.map(function(U,z){return[U,p.FullPaths[z]]}).forEach(function(U){var z=U[0],q=U[1];if(z.type==2&&z.name.match(/\.iwa/)){var M=z.content,oe=Pa(M),se=Na(oe);se.forEach(function(fe){m.push(fe.id),u[fe.id]={deps:[],location:q,type:Tr(fe.messages[0].meta[1][0].data)}})}}),m.sort(function(U,z){return U-z});var g=m.filter(function(U){return U>1}).map(function(U){return[U,Kt(U)]});p.FileIndex.map(function(U,z){return[U,p.FullPaths[z]]}).forEach(function(U){var z=U[0];if(U[1],!!z.name.match(/\.iwa/)){var q=Na(Pa(z.content));q.forEach(function(M){M.messages.forEach(function(oe){g.forEach(function(se){M.messages.some(function(fe){return Tr(fe.meta[1][0].data)!=11006&&tR(fe.data,se[1])})&&u[se[0]].deps.push(M.id)})})})}});for(var y=dt.find(p,u[1].location),_=Na(Pa(y.content)),T,S=0;S<_.length;++S){var w=_[S];w.id==1&&(T=w)}var E=yn($t(T.messages[0].data)[1][0].data);for(y=dt.find(p,u[E].location),_=Na(Pa(y.content)),S=0;S<_.length;++S)w=_[S],w.id==E&&(T=w);for(E=yn($t(T.messages[0].data)[2][0].data),y=dt.find(p,u[E].location),_=Na(Pa(y.content)),S=0;S<_.length;++S)w=_[S],w.id==E&&(T=w);for(E=yn($t(T.messages[0].data)[2][0].data),y=dt.find(p,u[E].location),_=Na(Pa(y.content)),S=0;S<_.length;++S)w=_[S],w.id==E&&(T=w);var P=$t(T.messages[0].data);{P[6][0].data=Kt(n.e.r+1),P[7][0].data=Kt(n.e.c+1);var I=yn(P[46][0].data),A=dt.find(p,u[I].location),R=Na(Pa(A.content));{for(var K=0;K<R.length&&R[K].id!=I;++K);if(R[K].id!=I)throw"Bad ColumnRowUIDMapArchive";var W=$t(R[K].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var D=0;D<=n.e.c;++D){var ee=[];ee[1]=ee[2]=[{type:0,data:Kt(D+420690)}],W[1].push({type:2,data:on(ee)}),W[2].push({type:0,data:Kt(D)}),W[3].push({type:0,data:Kt(D)})}W[4]=[],W[5]=[],W[6]=[];for(var re=0;re<=n.e.r;++re)ee=[],ee[1]=ee[2]=[{type:0,data:Kt(re+726270)}],W[4].push({type:2,data:on(ee)}),W[5].push({type:0,data:Kt(re)}),W[6].push({type:0,data:Kt(re)});R[K].messages[0].data=on(W)}A.content=sc(ic(R)),A.size=A.content.length,delete P[46];var pe=$t(P[4][0].data);{pe[7][0].data=Kt(n.e.r+1);var ue=$t(pe[1][0].data),ce=yn(ue[2][0].data);A=dt.find(p,u[ce].location),R=Na(Pa(A.content));{if(R[0].id!=ce)throw"Bad HeaderStorageBucket";var Ce=$t(R[0].messages[0].data);for(re=0;re<s.length;++re){var ye=$t(Ce[2][0].data);ye[1][0].data=Kt(re),ye[4][0].data=Kt(s[re].length),Ce[2][re]={type:Ce[2][0].type,data:on(ye)}}R[0].messages[0].data=on(Ce)}A.content=sc(ic(R)),A.size=A.content.length;var he=yn(pe[2][0].data);A=dt.find(p,u[he].location),R=Na(Pa(A.content));{if(R[0].id!=he)throw"Bad HeaderStorageBucket";for(Ce=$t(R[0].messages[0].data),D=0;D<=n.e.c;++D)ye=$t(Ce[2][0].data),ye[1][0].data=Kt(D),ye[4][0].data=Kt(n.e.r+1),Ce[2][D]={type:Ce[2][0].type,data:on(ye)};R[0].messages[0].data=on(Ce)}A.content=sc(ic(R)),A.size=A.content.length;var le=yn(pe[4][0].data);(function(){for(var U=dt.find(p,u[le].location),z=Na(Pa(U.content)),q,M=0;M<z.length;++M){var oe=z[M];oe.id==le&&(q=oe)}var se=$t(q.messages[0].data);{se[3]=[];var fe=[];l.forEach(function(X,Ke){fe[1]=[{type:0,data:Kt(Ke)}],fe[2]=[{type:0,data:Kt(1)}],fe[3]=[{type:2,data:eR(X)}],se[3].push({type:2,data:on(fe)})})}q.messages[0].data=on(se);var xe=ic(z),je=sc(xe);U.content=je,U.size=U.content.length})();var j=$t(pe[3][0].data);{var H=j[1][0];delete j[2];var O=$t(H.data);{var ne=yn(O[2][0].data);(function(){for(var U=dt.find(p,u[ne].location),z=Na(Pa(U.content)),q,M=0;M<z.length;++M){var oe=z[M];oe.id==ne&&(q=oe)}var se=$t(q.messages[0].data);{delete se[6],delete j[7];var fe=new Uint8Array(se[5][0].data);se[5]=[];for(var xe=0,je=0;je<=n.e.r;++je){var X=$t(fe);xe+=mR(X,s[je],l),X[1][0].data=Kt(je),se[5].push({data:on(X),type:2})}se[1]=[{type:0,data:Kt(n.e.c+1)}],se[2]=[{type:0,data:Kt(n.e.r+1)}],se[3]=[{type:0,data:Kt(xe)}],se[4]=[{type:0,data:Kt(n.e.r+1)}]}q.messages[0].data=on(se);var Ke=ic(z),Xe=sc(Ke);U.content=Xe,U.size=U.content.length})()}H.data=on(O)}pe[3][0].data=on(j)}P[4][0].data=on(pe)}T.messages[0].data=on(P);var Y=ic(_),F=sc(Y);return y.content=F,y.size=y.content.length,p}function hb(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function lg(e){hb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function cg(e){hb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function gR(e){return jt.WS.indexOf(e)>-1?"sheet":e==jt.CS?"chart":e==jt.DS?"dialog":e==jt.MS?"macro":e&&e.length?e:"sheet"}function vR(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,gR(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function xR(e,t,r,n,a,s,l,u,m,p,g,y){try{s[n]=Du(da(e,r,!0),t);var _=Lr(e,t),T;switch(u){case"sheet":T=Hj(_,t,a,m,s[n],p,g,y);break;case"chart":if(T=Vj(_,t,a,m,s[n],p,g,y),!T||!T["!drawel"])break;var S=Su(T["!drawel"].Target,t),w=Ku(S),E=D3(da(e,S,!0),Du(da(e,w,!0),S)),P=Su(E,S),I=Ku(P);T=yj(da(e,P,!0),P,m,Du(da(e,I,!0),P),p,T);break;case"macro":T=Gj(_,t,a,m,s[n],p,g,y);break;case"dialog":T=Zj(_,t,a,m,s[n],p,g,y);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=T;var A=[];s&&s[n]&&Er(s[n]).forEach(function(R){var K="";if(s[n][R].Type==jt.CMNT){K=Su(s[n][R].Target,t);var W=Xj(Lr(e,K,!0),K,m);if(!W||!W.length)return;W1(T,W,!1)}s[n][R].Type==jt.TCMNT&&(K=Su(s[n][R].Target,t),A=A.concat(j3(Lr(e,K,!0),m)))}),A&&A.length&&W1(T,A,!0,m.people||[])}catch(R){if(m.WTF)throw R}}function Ca(e){return e.charAt(0)=="/"?e.slice(1):e}function mb(e,t){if(Sc(),t=t||{},lg(t),Ia(e,"META-INF/manifest.xml")||Ia(e,"objectdata.xml"))return Q1(e,t);if(Ia(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Nm<"u"){if(e.FileIndex)return Nm(e);var r=dt.utils.cfb_new();return c1(e).forEach(function(ye){It(r,ye,OA(e,ye))}),Nm(r)}throw new Error("Unsupported NUMBERS file")}if(!Ia(e,"[Content_Types].xml"))throw Ia(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ia(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=c1(e),a=A4(da(e,"[Content_Types].xml")),s=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Lr(e,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Lr(e,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var m={},p={};if(!t.bookSheets&&!t.bookProps){if(Fu=[],a.sst)try{Fu=qj(Lr(e,Ca(a.sst)),a.sst,t)}catch(ye){if(t.WTF)throw ye}t.cellStyles&&a.themes.length&&(m=Yj(da(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(p=Kj(Lr(e,Ca(a.style)),a.style,m,t))}a.links.map(function(ye){try{var he=Du(da(e,Ku(Ca(ye))),ye);return Qj(Lr(e,Ca(ye)),he,ye,t)}catch{}});var g=$j(Lr(e,Ca(a.workbooks[0])),a.workbooks[0],t),y={},_="";a.coreprops.length&&(_=Lr(e,Ca(a.coreprops[0]),!0),_&&(y=X_(_)),a.extprops.length!==0&&(_=Lr(e,Ca(a.extprops[0]),!0),_&&O4(_,y,t)));var T={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(_=da(e,Ca(a.custprops[0]),!0),_&&(T=L4(_,t)));var S={};if((t.bookSheets||t.bookProps)&&(g.Sheets?l=g.Sheets.map(function(he){return he.name}):y.Worksheets&&y.SheetNames.length>0&&(l=y.SheetNames),t.bookProps&&(S.Props=y,S.Custprops=T),t.bookSheets&&typeof l<"u"&&(S.SheetNames=l),t.bookSheets?S.SheetNames:t.bookProps))return S;l={};var w={};t.bookDeps&&a.calcchain&&(w=Jj(Lr(e,Ca(a.calcchain)),a.calcchain));var E=0,P={},I,A;{var R=g.Sheets;y.Worksheets=R.length,y.SheetNames=[];for(var K=0;K!=R.length;++K)y.SheetNames[K]=R[K].name}var W=s?"bin":"xml",D=a.workbooks[0].lastIndexOf("/"),ee=(a.workbooks[0].slice(0,D+1)+"_rels/"+a.workbooks[0].slice(D+1)+".rels").replace(/^\//,"");Ia(e,ee)||(ee="xl/_rels/workbook."+W+".rels");var re=Du(da(e,ee,!0),ee.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=eO(Lr(e,Ca(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=R3(Lr(e,Ca(a.people[0])),t)),re&&(re=vR(re,g.Sheets));var pe=Lr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=y.Worksheets;++E){var ue="sheet";if(re&&re[E]?(I="xl/"+re[E][1].replace(/[\/]?xl\//,""),Ia(e,I)||(I=re[E][1]),Ia(e,I)||(I=ee.replace(/_rels\/.*$/,"")+re[E][1]),ue=re[E][2]):(I="xl/worksheets/sheet"+(E+1-pe)+"."+W,I=I.replace(/sheet0\./,"sheet.")),A=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(y.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ce=!1,Ce=0;Ce!=t.sheets.length;++Ce)typeof t.sheets[Ce]=="number"&&t.sheets[Ce]==E&&(ce=1),typeof t.sheets[Ce]=="string"&&t.sheets[Ce].toLowerCase()==y.SheetNames[E].toLowerCase()&&(ce=1);if(!ce)continue e}}xR(e,I,A,y.SheetNames[E],E,P,l,ue,t,g,m,p)}return S={Directory:a,Workbook:g,Props:y,Custprops:T,Deps:w,Sheets:l,SheetNames:y.SheetNames,Strings:Fu,Styles:p,Themes:m,SSF:ar(yt)},t&&t.bookFiles&&(e.files?(S.keys=n,S.files=e.files):(S.keys=[],S.files={},e.FullPaths.forEach(function(ye,he){ye=ye.replace(/^Root Entry[\/]/,""),S.keys.push(ye),S.files[ye]=e.FileIndex[he]}))),t&&t.bookVBA&&(a.vba.length>0?S.vbaraw=Lr(e,Ca(a.vba[0]),!0):a.defaults&&a.defaults.bin===H3&&(S.vbaraw=Lr(e,"xl/vbaProject.bin",!0))),S}function yR(e,t){var r=t||{},n="Workbook",a=dt.find(e,n);try{if(n="/!DataSpaces/Version",a=dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(t5(a.content),n="/!DataSpaces/DataSpaceMap",a=dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=n5(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=a5(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);s5(a.content)}catch{}if(n="/EncryptionInfo",a=dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=o5(a.content);if(n="/EncryptedPackage",a=dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function _R(e,t){return t.bookType=="ods"?fb(e,t):t.bookType=="numbers"?pR(e,t):t.bookType=="xlsb"?wR(e,t):pb(e,t)}function wR(e,t){dc=1024,e&&!e.SSF&&(e.SSF=ar(yt)),e&&e.SSF&&(Sc(),sd(e.SSF),t.revssf=kh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ju?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=Rw.indexOf(t.bookType)>-1,a=Zp();cg(t=t||{});var s=Np(),l="",u=0;if(t.cellXfs=[],co(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",It(s,l,J_(e.Props,t)),a.coreprops.push(l),qt(t.rels,2,l,jt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],p=0;p<e.SheetNames.length;++p)(e.Workbook.Sheets[p]||{}).Hidden!=2&&m.push(e.SheetNames[p]);e.Props.SheetNames=m}for(e.Props.Worksheets=e.Props.SheetNames.length,It(s,l,tw(e.Props)),a.extprops.push(l),qt(t.rels,3,l,jt.EXT_PROPS),e.Custprops!==e.Props&&Er(e.Custprops||{}).length>0&&(l="docProps/custom.xml",It(s,l,rw(e.Custprops)),a.custprops.push(l),qt(t.rels,4,l,jt.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var g={"!id":{}},y=e.Sheets[e.SheetNames[u-1]],_=(y||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,It(s,l,rO(u-1,l,t,e,g)),a.sheets.push(l),qt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,jt.WS[0])}if(y){var T=y["!comments"],S=!1,w="";T&&T.length>0&&(w="xl/comments"+u+"."+r,It(s,w,iO(T,w)),a.comments.push(w),qt(g,-1,"../comments"+u+"."+r,jt.CMNT),S=!0),y["!legacy"]&&S&&It(s,"xl/drawings/vmlDrawing"+u+".vml",jw(u,y["!comments"])),delete y["!comments"],delete y["!legacy"]}g["!id"].rId1&&It(s,Ku(l),mc(g))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,It(s,l,aO(t.Strings,l,t)),a.strs.push(l),qt(t.wbrels,-1,"sharedStrings."+r,jt.SST)),l="xl/workbook."+r,It(s,l,tO(e,l)),a.workbooks.push(l),qt(t.rels,1,l,jt.WB),l="xl/theme/theme1.xml",It(s,l,Qp(e.Themes,t)),a.themes.push(l),qt(t.wbrels,-1,"theme/theme1.xml",jt.THEME),l="xl/styles."+r,It(s,l,nO(e,l,t)),a.styles.push(l),qt(t.wbrels,-1,"styles."+r,jt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",It(s,l,e.vbaraw),a.vba.push(l),qt(t.wbrels,-1,"vbaProject.bin",jt.VBA)),l="xl/metadata."+r,It(s,l,sO(l)),a.metadata.push(l),qt(t.wbrels,-1,"metadata."+r,jt.XLMETA),It(s,"[Content_Types].xml",Y_(a,t)),It(s,"_rels/.rels",mc(t.rels)),It(s,"xl/_rels/workbook."+r+".rels",mc(t.wbrels)),delete t.revssf,delete t.ssf,s}function pb(e,t){dc=1024,e&&!e.SSF&&(e.SSF=ar(yt)),e&&e.SSF&&(Sc(),sd(e.SSF),t.revssf=kh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ju?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=Rw.indexOf(t.bookType)>-1,a=Zp();cg(t=t||{});var s=Np(),l="",u=0;if(t.cellXfs=[],co(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",It(s,l,J_(e.Props,t)),a.coreprops.push(l),qt(t.rels,2,l,jt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],p=0;p<e.SheetNames.length;++p)(e.Workbook.Sheets[p]||{}).Hidden!=2&&m.push(e.SheetNames[p]);e.Props.SheetNames=m}e.Props.Worksheets=e.Props.SheetNames.length,It(s,l,tw(e.Props)),a.extprops.push(l),qt(t.rels,3,l,jt.EXT_PROPS),e.Custprops!==e.Props&&Er(e.Custprops||{}).length>0&&(l="docProps/custom.xml",It(s,l,rw(e.Custprops)),a.custprops.push(l),qt(t.rels,4,l,jt.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var y={"!id":{}},_=e.Sheets[e.SheetNames[u-1]],T=(_||{})["!type"]||"sheet";switch(T){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,It(s,l,Zw(u-1,t,e,y)),a.sheets.push(l),qt(t.wbrels,-1,"worksheets/sheet"+u+"."+r,jt.WS[0])}if(_){var S=_["!comments"],w=!1,E="";if(S&&S.length>0){var P=!1;S.forEach(function(I){I[1].forEach(function(A){A.T==!0&&(P=!0)})}),P&&(E="xl/threadedComments/threadedComment"+u+"."+r,It(s,E,O3(S,g,t)),a.threadedcomments.push(E),qt(y,-1,"../threadedComments/threadedComment"+u+"."+r,jt.TCMNT)),E="xl/comments"+u+"."+r,It(s,E,Ow(S)),a.comments.push(E),qt(y,-1,"../comments"+u+"."+r,jt.CMNT),w=!0}_["!legacy"]&&w&&It(s,"xl/drawings/vmlDrawing"+u+".vml",jw(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}y["!id"].rId1&&It(s,Ku(l),mc(y))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,It(s,l,bw(t.Strings,t)),a.strs.push(l),qt(t.wbrels,-1,"sharedStrings."+r,jt.SST)),l="xl/workbook."+r,It(s,l,Qw(e)),a.workbooks.push(l),qt(t.rels,1,l,jt.WB),l="xl/theme/theme1.xml",It(s,l,Qp(e.Themes,t)),a.themes.push(l),qt(t.wbrels,-1,"theme/theme1.xml",jt.THEME),l="xl/styles."+r,It(s,l,Pw(e,t)),a.styles.push(l),qt(t.wbrels,-1,"styles."+r,jt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",It(s,l,e.vbaraw),a.vba.push(l),qt(t.wbrels,-1,"vbaProject.bin",jt.VBA)),l="xl/metadata."+r,It(s,l,Fw()),a.metadata.push(l),qt(t.wbrels,-1,"metadata."+r,jt.XLMETA),g.length>1&&(l="xl/persons/person.xml",It(s,l,L3(g)),a.people.push(l),qt(t.wbrels,-1,"persons/person.xml",jt.PEOPLE)),It(s,"[Content_Types].xml",Y_(a,t)),It(s,"_rels/.rels",mc(t.rels)),It(s,"xl/_rels/workbook."+r+".rels",mc(t.wbrels)),delete t.revssf,delete t.ssf,s}function ug(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ha(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function bR(e,t){return dt.find(e,"EncryptedPackage")?yR(e,t):sg(e,t)}function kR(e,t){var r,n=e,a=t||{};return a.type||(a.type=Dt&&Buffer.isBuffer(e)?"buffer":"base64"),r=A_(n,a),mb(r,a)}function gb(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ip(e.slice(r),t);default:break e}return _c.to_workbook(e,t)}function SR(e,t){var r="",n=ug(e,t);switch(t.type){case"base64":r=ha(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=qo(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=nr(r)),t.type="binary",gb(r,t)}function TR(e,t){var r=e;return t.type=="base64"&&(r=ha(r)),r=Bt.utils.decode(1200,r.slice(2),"str"),t.type="binary",gb(r,t)}function ER(e){return e.match(/[^\x00-\x7F]/)?Ti(e):e}function Pm(e,t,r,n){return n?(r.type="string",_c.to_workbook(e,r)):_c.to_workbook(t,r)}function td(e,t){wh();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return td(new Uint8Array(e),(r=ar(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),gc={},r.dateNF&&(gc.dateNF=r.dateNF),r.type||(r.type=Dt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Dt?"buffer":"binary",n=CA(e),typeof Uint8Array<"u"&&!Dt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=ER(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=ar(r),r.type="array",td(Tp(n),r)}switch((a=ug(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return bR(dt.read(n,r),r);break;case 9:if(a[1]<=8)return sg(n,r);break;case 60:return ip(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return MP(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return _w.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?kR(n,r):Pm(e,n,r,s);case 239:return a[3]===60?ip(n,r):Pm(e,n,r,s);case 255:if(a[1]===254)return TR(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Go.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Go.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return ap.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Cw.to_workbook(n,r);break;case 10:case 13:case 32:return SR(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return LP.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?ap.to_workbook(n,r):Pm(e,n,r,s)}function ay(e,t){var r=t||{};return r.type="file",td(e,r)}function vb(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return od(t.file,dt.write(e,{type:Dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return dt.write(e,t)}function CR(e,t){var r=ar(t||{}),n=_R(e,r);return xb(n,r)}function AR(e,t){var r=ar(t||{}),n=pb(e,r);return xb(n,r)}function xb(e,t){var r={},n=Dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?dt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(id(a))}return t.password&&typeof encrypt_agile<"u"?vb(encrypt_agile(a,t.password),t):t.type==="file"?od(t.file,a):t.type=="string"?nr(a):a}function NR(e,t){var r=t||{},n=DO(e,r);return vb(n,r)}function ki(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return $u(Ti(n));case"binary":return Ti(n);case"string":return e;case"file":return od(t.file,n,"utf8");case"buffer":return Dt?is(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ki(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function PR(e,t){switch(t.type){case"base64":return $u(e);case"binary":return e;case"string":return e;case"file":return od(t.file,e,"binary");case"buffer":return Dt?is(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $f(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?$u(r):t.type=="string"?nr(r):r;case"file":return od(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function dg(e,t){wh(),Jw(e);var r=ar(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=dg(e,r);return r.type="array",id(n)}return AR(e,r)}function Ph(e,t){wh(),Jw(e);var r=ar(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Ph(e,r);return r.type="array",id(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ki(TO(e,r),r);case"slk":case"sylk":return ki(yw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return ki(lb(e.Sheets[e.SheetNames[a]],r),r);case"txt":return PR(wb(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ki(hg(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ki(_w.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return $f(ap.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ki(_c.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ki(Cw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return ki(ww.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ki(fb(e,r),r);case"wk1":return $f(Go.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return $f(Go.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),$f(nb(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),NR(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return CR(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function fg(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function iy(e,t,r){var n=r||{};return n.type="file",n.file=t,fg(n),Ph(e,n)}function IR(e,t,r){var n=r||{};return n.type="file",n.file=t,fg(n),dg(e,n)}function DR(e,t,r,n){var a=r||{};a.type="file",a.file=e,fg(a),a.type="buffer";var s=n;return s instanceof Function||(s=r),to.writeFile(e,Ph(t,a),s)}function yb(e,t,r,n,a,s,l,u){var m=Sr(r),p=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||e[r])for(var T=t.s.c;T<=t.e.c;++T){var S=l?e[r][T]:e[n[T]+m];if(S===void 0||S.t===void 0){if(p===void 0)continue;s[T]!=null&&(_[s[T]]=p);continue}var w=S.v;switch(S.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(s[T]!=null){if(w==null)if(S.t=="e"&&w===null)_[s[T]]=null;else if(p!==void 0)_[s[T]]=p;else if(g&&w===null)_[s[T]]=null;else continue;else _[s[T]]=g&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?w:Ai(S,w,u);w!=null&&(y=!1)}}return{row:_,isempty:y}}function fh(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],l=0,u="",m={s:{r:0,c:0},e:{r:0,c:0}},p=t||{},g=p.range!=null?p.range:e["!ref"];switch(p.header===1?n=1:p.header==="A"?n=2:Array.isArray(p.header)?n=3:p.header==null&&(n=0),typeof g){case"string":m=Lt(g);break;case"number":m=Lt(e["!ref"]),m.s.r=g;break;default:m=g}n>0&&(a=0);var y=Sr(m.s.r),_=[],T=[],S=0,w=0,E=Array.isArray(e),P=m.s.r,I=0,A={};E&&!e[P]&&(e[P]=[]);var R=p.skipHidden&&e["!cols"]||[],K=p.skipHidden&&e["!rows"]||[];for(I=m.s.c;I<=m.e.c;++I)if(!(R[I]||{}).hidden)switch(_[I]=dr(I),r=E?e[P][I]:e[_[I]+y],n){case 1:s[I]=I-m.s.c;break;case 2:s[I]=_[I];break;case 3:s[I]=p.header[I-m.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=Ai(r,null,p),w=A[l]||0,!w)A[l]=1;else{do u=l+"_"+w++;while(A[u]);A[l]=w,A[u]=1}s[I]=u}for(P=m.s.r+a;P<=m.e.r;++P)if(!(K[P]||{}).hidden){var W=yb(e,m,P,_,n,s,E,p);(W.isempty===!1||(n===1?p.blankrows!==!1:p.blankrows))&&(T[S++]=W.row)}return T.length=S,T}var sy=/"/g;function _b(e,t,r,n,a,s,l,u){for(var m=!0,p=[],g="",y=Sr(r),_=t.s.c;_<=t.e.c;++_)if(n[_]){var T=u.dense?(e[r]||[])[_]:e[n[_]+y];if(T==null)g="";else if(T.v!=null){m=!1,g=""+(u.rawNumbers&&T.t=="n"?T.v:Ai(T,null,u));for(var S=0,w=0;S!==g.length;++S)if((w=g.charCodeAt(S))===a||w===s||w===34||u.forceQuotes){g='"'+g.replace(sy,'""')+'"';break}g=="ID"&&(g='"ID"')}else T.f!=null&&!T.F?(m=!1,g="="+T.f,g.indexOf(",")>=0&&(g='"'+g.replace(sy,'""')+'"')):g="";p.push(g)}return u.blankrows===!1&&m?null:p.join(l)}function hg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Lt(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,m=u.charCodeAt(0),p=new RegExp((s=="|"?"\\|":s)+"+$"),g="",y=[];n.dense=Array.isArray(e);for(var _=n.skipHidden&&e["!cols"]||[],T=n.skipHidden&&e["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(y[S]=dr(S));for(var w=0,E=a.s.r;E<=a.e.r;++E)(T[E]||{}).hidden||(g=_b(e,a,E,y,l,m,s,n),g!=null&&(n.strip&&(g=g.replace(p,"")),(g||n.blankrows!==!1)&&r.push((w++?u:"")+g)));return delete n.dense,r.join("")}function wb(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hg(e,t);if(typeof Bt>"u"||t.type=="string")return r;var n=Bt.utils.encode(1200,r,"str");return"ÿþ"+n}function FR(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Lt(e["!ref"]),s="",l=[],u,m=[],p=Array.isArray(e);for(u=a.s.c;u<=a.e.c;++u)l[u]=dr(u);for(var g=a.s.r;g<=a.e.r;++g)for(s=Sr(g),u=a.s.c;u<=a.e.c;++u)if(t=l[u]+s,r=p?(e[g]||[])[u]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}m[m.length]=t+"="+n}return m}function bb(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},l=0,u=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var m=typeof n.origin=="string"?_r(n.origin):n.origin;l=m.r,u=m.c}var p,g={s:{c:0,r:0},e:{c:u,r:l+t.length-1+a}};if(s["!ref"]){var y=Lt(s["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),l==-1&&(l=y.e.r+1,g.e.r=l+t.length-1+a)}else l==-1&&(l=0,g.e.r=t.length-1+a);var _=n.header||[],T=0;t.forEach(function(w,E){Er(w).forEach(function(P){(T=_.indexOf(P))==-1&&(_[T=_.length]=P);var I=w[P],A="z",R="",K=_t({c:u+T,r:l+E+a});p=rd(s,K),I&&typeof I=="object"&&!(I instanceof Date)?s[K]=I:(typeof I=="number"?A="n":typeof I=="boolean"?A="b":typeof I=="string"?A="s":I instanceof Date?(A="d",n.cellDates||(A="n",I=Kr(I)),R=n.dateNF||yt[14]):I===null&&n.nullError&&(A="e",I=0),p?(p.t=A,p.v=I,delete p.w,delete p.R,R&&(p.z=R)):s[K]=p={t:A,v:I},R&&(p.z=R))})}),g.e.c=Math.max(g.e.c,u+_.length-1);var S=Sr(l);if(a)for(T=0;T<_.length;++T)s[dr(T+u)+S]={t:"s",v:_[T]};return s["!ref"]=Pt(g),s}function jR(e,t){return bb(null,e,t)}function rd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=_r(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?rd(e,_t(t)):rd(e,_t({r:t,c:r||0}))}function OR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function mg(){return{SheetNames:[],Sheets:{}}}function pg(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(Xw(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function RR(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=OR(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function LR(e,t){return e.z=t,e}function kb(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function MR(e,t,r){return kb(e,"#"+t,r)}function BR(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function zR(e,t,r,n){for(var a=typeof t!="string"?t:Lt(t),s=typeof t=="string"?t:Pt(t),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var m=rd(e,l,u);m.t="n",m.F=s,delete m.v,l==a.s.r&&u==a.s.c&&(m.f=r,n&&(m.D=!0))}return e}var Sb={encode_col:dr,encode_row:Sr,encode_cell:_t,encode_range:Pt,decode_col:Up,decode_row:zp,split_cell:i4,decode_cell:_r,decode_range:Ln,format_cell:Ai,sheet_add_aoa:W_,sheet_add_json:bb,sheet_add_dom:cb,aoa_to_sheet:Ec,json_to_sheet:jR,table_to_sheet:ub,table_to_book:qO,sheet_to_csv:hg,sheet_to_txt:wb,sheet_to_json:fh,sheet_to_html:lb,sheet_to_formulae:FR,sheet_to_row_object_array:fh,sheet_get_cell:rd,book_new:mg,book_append_sheet:pg,book_set_sheet_visibility:RR,cell_set_number_format:LR,cell_set_hyperlink:kb,cell_set_internal_link:MR,cell_add_comment:BR,sheet_set_array_formula:zR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Ih;function UR(e){Ih=e}function WR(e,t){var r=Ih(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=Lt(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,m=u.charCodeAt(0),p=new RegExp((s=="|"?"\\|":s)+"+$"),g="",y=[];n.dense=Array.isArray(e);for(var _=n.skipHidden&&e["!cols"]||[],T=n.skipHidden&&e["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(y[S]=dr(S));var w=a.s.r,E=!1,P=0;return r._read=function(){if(!E)return E=!0,r.push("\uFEFF");for(;w<=a.e.r;)if(++w,!(T[w-1]||{}).hidden&&(g=_b(e,a,w-1,y,l,m,s,n),g!=null&&(n.strip&&(g=g.replace(p,"")),g||n.blankrows!==!1)))return r.push((P++?u:"")+g);return r.push(null)},r}function $R(e,t){var r=Ih(),n=t||{},a=n.header!=null?n.header:ib,s=n.footer!=null?n.footer:sb;r.push(a);var l=Ln(e["!ref"]);n.dense=Array.isArray(e),r.push(ob(e,l,n));var u=l.s.r,m=!1;return r._read=function(){if(u>l.e.r)return m||(m=!0,r.push("</table>"+s)),r.push(null);for(;u<=l.e.r;){r.push(ab(e,l,u,n)),++u;break}},r}function HR(e,t){var r=Ih({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,s=1,l=[],u=0,m="",p={s:{r:0,c:0},e:{r:0,c:0}},g=t||{},y=g.range!=null?g.range:e["!ref"];switch(g.header===1?a=1:g.header==="A"?a=2:Array.isArray(g.header)&&(a=3),typeof y){case"string":p=Lt(y);break;case"number":p=Lt(e["!ref"]),p.s.r=y;break;default:p=y}a>0&&(s=0);var _=Sr(p.s.r),T=[],S=0,w=Array.isArray(e),E=p.s.r,P=0,I={};w&&!e[E]&&(e[E]=[]);var A=g.skipHidden&&e["!cols"]||[],R=g.skipHidden&&e["!rows"]||[];for(P=p.s.c;P<=p.e.c;++P)if(!(A[P]||{}).hidden)switch(T[P]=dr(P),n=w?e[E][P]:e[T[P]+_],a){case 1:l[P]=P-p.s.c;break;case 2:l[P]=T[P];break;case 3:l[P]=g.header[P-p.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),m=u=Ai(n,null,g),S=I[u]||0,!S)I[u]=1;else{do m=u+"_"+S++;while(I[m]);I[u]=S,I[m]=1}l[P]=m}return E=p.s.r+s,r._read=function(){for(;E<=p.e.r;)if(!(R[E-1]||{}).hidden){var K=yb(e,p,E,T,a,l,w,g);if(++E,K.isempty===!1||(a===1?g.blankrows!==!1:g.blankrows)){r.push(K.row);return}}return r.push(null)},r}var VR={to_json:HR,to_html:$R,to_csv:WR,set_readable:UR};const GR=Wu.version,ZR=Object.freeze(Object.defineProperty({__proto__:null,CFB:dt,SSF:b_,parse_xlscfb:sg,parse_zip:mb,read:td,readFile:ay,readFileSync:ay,set_cptable:qC,set_fs:TA,stream:VR,utils:Sb,version:GR,write:Ph,writeFile:iy,writeFileAsync:DR,writeFileSync:iy,writeFileXLSX:IR,writeXLSX:dg},Symbol.toStringTag,{value:"Module"}));function KR({onImported:e}){const[t,r]=J.useState(!1),[n,a]=J.useState(!1),s=J.useRef(null),l=J.useRef(!1),u=async y=>{if(!(!y||l.current)){l.current=!0,r(!0);try{const _=await y.arrayBuffer(),T=td(_,{type:"array"}),S=T.Sheets[T.SheetNames[0]],w=Sb.sheet_to_json(S,{header:1});if(!w.length){alert("📄 File appears to be empty. Please check your Excel file.");return}const E=(w[0]||[]).map(re=>String(re??"").trim().toLowerCase());let P=E.findIndex(re=>re.includes("address"));P===-1&&(P=0);const I=E.findIndex(re=>re==="lat"||re.includes("latitude")),A=E.findIndex(re=>re==="lng"||re==="lon"||re.includes("longitude")),R=I===-1?void 0:I,K=A===-1?void 0:A,W=[];for(let re=1;re<w.length;re++){const pe=w[re]||[],ue=String(pe[P]??"").trim();if(!ue)continue;const ce=R!==void 0&&pe[R]!=null&&pe[R]!==""?oy(pe[R]):void 0,Ce=K!==void 0&&pe[K]!=null&&pe[K]!==""?oy(pe[K]):void 0;W.push({address:ue,lat:ce,lng:Ce})}if(W.length===0){alert("🚫 No valid addresses found in the file. Please check the format.");return}e(W);const D=W.some(re=>re.lat!=null&&re.lng!=null),ee=`✅ Successfully imported ${W.length} address${W.length===1?"":"es"}${D?" with GPS coordinates":""}!`;console.log(ee)}catch(_){console.error(_),alert("❌ Failed to read Excel file. Please ensure it's a valid .xlsx or .xls file.")}finally{l.current=!1,r(!1),s.current&&(s.current.value="")}}},m=async y=>{if(l.current)return;const _=y.target.files?.[0];_&&await u(_)},p=y=>{y.preventDefault(),y.stopPropagation(),y.type==="dragenter"||y.type==="dragover"?a(!0):y.type==="dragleave"&&a(!1)},g=async y=>{if(y.preventDefault(),y.stopPropagation(),l.current)return;a(!1);const T=Array.from(y.dataTransfer.files).find(S=>S.name.endsWith(".xlsx")||S.name.endsWith(".xls")||S.type.includes("spreadsheet"));T?await u(T):alert("📋 Please drop an Excel file (.xlsx or .xls)")};return d.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:"0.75rem",flex:1},children:[d.jsx("input",{ref:s,type:"file",accept:".xlsx,.xls",onChange:m,className:"file-input",id:"excel-input",disabled:t,style:{display:"none"}}),d.jsx(es,{className:"btn btn-primary",onClick:()=>s.current?.click(),isLoading:t,loadingText:"Processing...",disabled:t,style:{whiteSpace:"nowrap"},children:"📊 Import Excel"}),d.jsx("div",{onDragEnter:p,onDragLeave:p,onDragOver:p,onDrop:g,className:"btn btn-ghost",style:{border:`2px dashed ${n?"var(--primary)":"var(--border-light)"}`,background:n?"var(--primary-light)":"transparent",color:n?"var(--primary-dark)":"var(--text-muted)",fontSize:"0.875rem",textAlign:"center",cursor:"pointer",transition:"all var(--transition-fast)",userSelect:"none",minWidth:"140px",flex:1,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>s.current?.click(),children:n?d.jsx("span",{children:"📥 Drop Excel file here"}):d.jsx("span",{children:"🖱️ Or drag & drop Excel"})})]})}function oy(e){const t=Number(e);return Number.isFinite(t)?t:void 0}const YR=function({user:t,onAddressesReady:r}){const[n,a]=J.useState([]),[s,l]=J.useState(""),[u,m]=J.useState(!1),[p,g]=J.useState(!1),[y,_]=J.useState(null),[T,S]=J.useState(!0),[w,E]=J.useState(!1),[P,I]=J.useState(null),[A,R]=J.useState(null),K=J.useCallback(H=>{const O=H.map(Ym);a(O),R(null),_(null)},[]),W=()=>{if(!s.trim())return;const H={success:!1,address:s.trim(),originalAddress:s.trim(),error:"Not geocoded yet"};J.startTransition(()=>{a(O=>[...O,H]),l(""),R(null)})},D=(H,O,ne)=>{const Y={success:!0,address:H,originalAddress:H,lat:O,lng:ne,confidence:1,formattedAddress:H};J.startTransition(()=>{a(F=>[...F,Y]),l(""),R(null)})},ee=H=>{J.startTransition(()=>{a(O=>O.filter((ne,Y)=>Y!==H)),R(null),y===H?_(null):y!==null&&y>H&&_(y-1)})},re=(H,O)=>{J.startTransition(()=>{a(ne=>ne.map((Y,F)=>F===H?{...Y,address:O,success:!1,error:"Modified - needs geocoding"}:Y)),R(null)})},pe=async H=>{const O=n[H];if(!O.success)try{const ne=await Xx([O.address]),Y=[...n];Y[H]=ne[0],a(Y),R(null)}catch(ne){console.error("Single geocoding failed:",ne),alert("Geocoding failed. Please check your connection and subscription.")}},ue=(H,O,ne)=>{const Y=[...n];Y[H]={...Y[H],lat:O,lng:ne,success:O!==void 0&&ne!==void 0,formattedAddress:Y[H].formattedAddress||Y[H].address,error:O!==void 0&&ne!==void 0?void 0:"Manual coordinates incomplete"},a(Y),R(null)},ce=async()=>{const H=n.map((O,ne)=>({addr:O,index:ne})).filter(({addr:O})=>!O.success);if(H.length===0){alert("All addresses are already geocoded!");return}g(!0),I({completed:0,total:H.length,current:""});try{const O=H.map(({addr:F})=>F.address),ne=await Xx(O,(F,U,z)=>{I({completed:F,total:U,current:z})}),Y=[...n];H.forEach(({index:F},U)=>{Y[F]=ne[U]}),a(Y),R(null)}catch(O){console.error("Batch geocoding failed:",O),alert("Geocoding failed. Please check your connection and subscription.")}finally{g(!1),I(null)}},Ce=async()=>{const H=n.filter(O=>O.success&&O.lat&&O.lng);if(H.length===0){alert("No addresses with valid coordinates available for optimization");return}if(H.length<n.length){const O=n.length-H.length;if(!confirm(`${O} addresses don't have coordinates and will be excluded from optimization. Continue?`))return}m(!0),R(null);try{const O=n.map(Zf);let ne;if(y!==null&&y>=0){const F=n[y];F.success&&F.lat&&F.lng&&(ne=[F.lng,F.lat])}const Y=await UC(O,ne);if(R({optimizedOrder:Y.optimizedOrder,totalDistance:Y.totalDistance,totalDuration:Y.totalDuration,unassigned:Y.unassigned,error:Y.error}),Y.success&&Y.optimizedOrder.length>0){const F=Y.optimizedOrder.map(U=>n[U]);if(a(F),R({optimizedOrder:F.map((U,z)=>z),totalDistance:Y.totalDistance,totalDuration:Y.totalDuration,unassigned:Y.unassigned,error:Y.error}),y!==null){const U=Y.optimizedOrder.indexOf(y);_(U>=0?U:null)}}}catch(O){console.error("Route optimization failed:",O),R({optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:[],error:O instanceof Error?O.message:"Optimization failed"})}finally{m(!1)}},ye=()=>{const H=n.map(Zf);r(H),alert(`Exported ${H.length} addresses to your main address list!`)},he=()=>{confirm("Are you sure you want to clear all addresses?")&&(a([]),R(null),_(null))},le=H=>{const O=H.map(Ym);a(O),R(null)},j={total:n.length,geocoded:n.filter(H=>H.success).length,needsGeocoding:n.filter(H=>!H.success).length,highConfidence:n.filter(H=>H.success&&(H.confidence||0)>=.8).length,lowConfidence:n.filter(H=>H.success&&(H.confidence||0)<.5).length};return d.jsx(s_,{user:t,fallback:d.jsx(qR,{}),children:d.jsxs("div",{className:"route-planning",style:{maxWidth:"100%",padding:"0"},children:[!1,n.length===0&&d.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)",overflow:"hidden"},children:[d.jsxs("button",{onClick:()=>E(!w),style:{width:"100%",padding:"1rem 1.5rem",background:"transparent",border:"none",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",color:"var(--text-primary)",fontSize:"1rem",fontWeight:"600"},children:[d.jsx("span",{children:"📁 Import Excel File"}),d.jsx("span",{style:{fontSize:"1.25rem"},children:w?"▼":"▶"})]}),w&&d.jsx("div",{style:{padding:"0 1.5rem 1.5rem 1.5rem"},children:d.jsx(KR,{onImported:K})})]}),n.length>0&&d.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[d.jsx("h3",{style:{margin:0,fontSize:"1.125rem",color:"var(--text-primary)"},children:"🗺️ Map View"}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>S(!T),children:T?"Hide":"Show"})]}),T&&d.jsx("div",{style:{height:"400px",borderRadius:"var(--radius-md)",overflow:"hidden",border:"1px solid var(--border)"},children:d.jsx(GC,{addresses:n.map(Zf),onAddressesUpdate:le,startingPointIndex:y??void 0,onStartingPointChange:_,optimizedOrder:A?.optimizedOrder,showRouteLines:!!A&&!A.error,confidences:n.map(H=>H.confidence)})})]}),d.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsx($C,{id:"manual-address-input",value:s,onChange:l,onSelect:D,placeholder:"Type an address to add...",disabled:!1}),d.jsx("button",{className:"btn btn-primary",onClick:W,disabled:!s.trim(),style:{width:"100%",marginTop:"0.5rem",padding:"0.75rem",fontSize:"0.9375rem",fontWeight:"600"},children:"+ Add Address"})]}),A&&d.jsx("div",{style:{marginBottom:"1rem",padding:"1rem",background:"var(--surface)",border:A.error?"2px solid var(--danger)":"2px solid var(--success)",borderRadius:"var(--radius-md)",color:A.error?"var(--danger)":"var(--success)"},children:A.error?d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.25rem",fontSize:"0.9375rem"},children:"❌ Optimization Failed"}),d.jsx("div",{style:{fontSize:"0.8125rem"},children:A.error})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem",fontSize:"0.9375rem"},children:"✓ Route Optimized"}),d.jsxs("div",{style:{fontSize:"0.8125rem",lineHeight:"1.5"},children:[d.jsxs("div",{children:["📍 ",A.optimizedOrder.length," stops"]}),d.jsxs("div",{children:["🚗 ",o_(A.totalDuration)]}),d.jsxs("div",{children:["📏 ",l_(A.totalDistance)]})]})]})}),n.length>0&&j.geocoded>=2&&d.jsx("button",{className:"btn btn-primary",onClick:Ce,disabled:u,style:{width:"100%",padding:"0.875rem",fontSize:"1rem",fontWeight:"600"},children:u?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"spinner",style:{display:"inline-block",width:"1rem",height:"1rem",marginRight:"0.5rem"}}),"Optimizing..."]}):`🗺️ Optimize ${j.geocoded} Address${j.geocoded>1?"es":""}`})]}),n.length>0&&d.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("h3",{style:{margin:0,fontSize:"1.125rem",color:"var(--text-primary)"},children:A&&!A.error&&A.optimizedOrder.length>0?"📍 Optimized Route":`Addresses (${n.length})`}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[j.needsGeocoding>0&&d.jsx("button",{className:"btn btn-primary btn-sm",onClick:ce,disabled:p,style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem",whiteSpace:"nowrap"},children:p?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"spinner",style:{display:"inline-block",width:"0.875rem",height:"0.875rem",marginRight:"0.25rem"}}),"Geocoding..."]}):`🌍 Geocode ${j.needsGeocoding}`}),y!==null&&d.jsxs("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-md)",fontSize:"0.75rem",fontWeight:"600"},children:["🏠 Start: #",y+1]})]})]}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-around",gap:"0.5rem",padding:"0.75rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)",fontSize:"0.75rem"},children:[d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--primary)"},children:j.total}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Total"})]}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--success)"},children:j.geocoded}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Ready"})]}),d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--warning)"},children:j.needsGeocoding}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Pending"})]})]})]}),P&&d.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--primary-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--primary)"},children:[d.jsxs("div",{style:{marginBottom:"0.5rem",fontWeight:"600",color:"var(--primary)",fontSize:"0.875rem"},children:["Geocoding ",P.completed," of ",P.total]}),d.jsx("div",{style:{background:"var(--gray-200)",borderRadius:"999px",height:"0.375rem",overflow:"hidden"},children:d.jsx("div",{style:{background:"var(--primary)",height:"100%",width:`${P.completed/P.total*100}%`,transition:"width 0.3s ease",borderRadius:"999px"}})})]}),d.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",margin:"0 -1.5rem",padding:"0 1.5rem"},children:[...n].sort((H,O)=>!H.success&&O.success?-1:H.success&&!O.success?1:0).map(H=>{const O=n.indexOf(H);return d.jsxs("div",{style:{padding:"1rem",borderBottom:O<n.length-1?"1px solid var(--border-light)":"none",display:"flex",alignItems:"flex-start",gap:"0.75rem",background:O===y?"var(--primary-light)":"transparent",borderRadius:"var(--radius-md)",marginBottom:O<n.length-1?"0.5rem":"0"},children:[d.jsx("div",{style:{minWidth:"2rem",height:"2rem",borderRadius:"50%",background:O===y?"var(--primary)":H.success?"var(--success)":"var(--warning)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0,cursor:"pointer",border:O===y?"2px solid white":"none"},onClick:()=>{_(O===y?null:O)},title:O===y?"Starting Point (click to clear)":"Click to set as starting point",children:O===y?"🏠":O+1}),d.jsxs("div",{style:{flex:1,minWidth:0},children:[d.jsx("input",{name:`address-${O}`,type:"text",value:H.address,onChange:ne=>re(O,ne.target.value),className:"input",style:{width:"100%",marginBottom:"0.5rem",fontSize:"0.9375rem",padding:"0.5rem",border:"1px solid var(--border)"}}),d.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",lineHeight:"1.4"},children:H.success?d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{color:"var(--success)"},children:"✓"})," ",H.formattedAddress||H.address,H.confidence&&d.jsx("span",{style:{display:"inline-block",marginLeft:"0.5rem",padding:"0.125rem 0.5rem",borderRadius:"999px",background:H.confidence>=.8?"var(--success-light)":H.confidence>=.5?"var(--warning-light)":"var(--danger-light)",color:H.confidence>=.8?"var(--success-dark)":H.confidence>=.5?"var(--warning-dark)":"var(--danger-dark)",fontSize:"0.75rem",fontWeight:"600"},children:c_(H.confidence)})]}):d.jsxs("span",{style:{color:"var(--warning)"},children:["⚠️ ",H.error]})}),!H.success&&d.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem",alignItems:"center"},children:[d.jsx("input",{type:"number",step:"any",placeholder:"Latitude",value:H.lat??"",onChange:ne=>{const Y=ne.target.value?parseFloat(ne.target.value):void 0;ue(O,Y,H.lng)},className:"input",style:{flex:1,fontSize:"0.75rem",padding:"0.375rem 0.5rem",border:"1px solid var(--border)"}}),d.jsx("input",{type:"number",step:"any",placeholder:"Longitude",value:H.lng??"",onChange:ne=>{const Y=ne.target.value?parseFloat(ne.target.value):void 0;ue(O,H.lat,Y)},className:"input",style:{flex:1,fontSize:"0.75rem",padding:"0.375rem 0.5rem",border:"1px solid var(--border)"}})]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",flexShrink:0},children:[!H.success&&d.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>pe(O),title:"Geocode this address",style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem",minWidth:"auto"},children:"🌍"}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ee(O),title:"Remove",style:{padding:"0.5rem",minWidth:"auto",fontSize:"1.125rem"},children:"✕"})]})]},O)})})]}),n.length>0&&d.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginBottom:"1rem"},children:[d.jsx("button",{className:"btn btn-success",onClick:ye,style:{flex:1,padding:"0.875rem",fontSize:"1rem",fontWeight:"600"},children:"📤 Export to Main List"}),d.jsx("button",{className:"btn btn-ghost",onClick:he,style:{padding:"0.875rem",fontSize:"1rem"},children:"🗑️"})]}),n.length===0&&d.jsxs("div",{style:{textAlign:"center",padding:"3rem 1.5rem",background:"var(--surface)",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[d.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"🗺️"}),d.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--text-primary)"},children:"Start Planning Your Route"}),d.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem",fontSize:"0.9375rem"},children:"Import addresses from Excel or add them manually"})]})]})})};function qR(){return d.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--gray-100)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",boxShadow:"var(--shadow-sm)",color:"var(--gray-800)"},children:[d.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"🗺️"}),d.jsx("h2",{children:"Route Planning"}),d.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--gray-500)"},children:"Plan your daily routes with intelligent address geocoding and route optimization."}),d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius-md)",fontSize:"0.875rem"},children:"Premium Feature"})}),d.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--gray-500)",textAlign:"left",maxWidth:"400px",margin:"0 auto"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Import addresses from Excel"}),d.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Google-style address autocomplete"}),d.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Automatic geocoding with confidence scores"}),d.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Intelligent route optimization"}),d.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Manual address correction"}),d.jsx("div",{children:"✅ Export to main address list"})]})]})}const XR=J.memo(YR);function JR({onSetupComplete:e,onSkip:t,isOpen:r}){const[n,a]=rr.useState(""),[s,l]=rr.useState(""),[u,m]=rr.useState(!1),[p,g]=rr.useState("idle"),[y,_]=rr.useState("");if(!r)return null;const T=async()=>{if(!n||!s){_("Please enter both URL and key");return}m(!0),g("idle"),_("");try{if(!new URL(n).hostname.includes("supabase"))throw new Error("URL should be a Supabase project URL (e.g., https://your-project.supabase.co)");const E=Wy(n,s),{data:P,error:I}=await E.auth.getSession();if(I&&I.message!=="Auth session missing!")throw I;g("success"),ve.info("Supabase connection test successful")}catch(w){g("error"),_(w.message||"Connection failed"),ve.error("Supabase connection test failed:",w)}finally{m(!1)}},S=()=>{p==="success"&&e(n,s)};return d.jsxs("div",{className:"modal-overlay",children:[d.jsxs("div",{className:"modal-content",style:{maxWidth:"600px"},children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h2",{children:"📁 Optional: Connect Your Own Cloud Storage"}),d.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem"},children:"Set up your own Supabase project for cloud backup and sync (completely optional)"})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--blue-50)",borderRadius:"var(--radius-md)",border:"1px solid var(--blue-200)"},children:[d.jsx("h4",{style:{margin:"0 0 0.5rem",color:"var(--blue-700)"},children:"📋 Quick Setup Instructions"}),d.jsxs("ol",{style:{margin:0,paddingLeft:"1.2rem",color:"var(--blue-600)",fontSize:"0.9rem"},children:[d.jsxs("li",{children:["Go to ",d.jsx("a",{href:"https://supabase.com",target:"_blank",rel:"noopener",children:"supabase.com"})," and create a free account"]}),d.jsx("li",{children:"Create a new project (choose any name/region)"}),d.jsx("li",{children:"Go to Settings → API in your project dashboard"}),d.jsx("li",{children:"Copy your Project URL and anon/public key below"})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"supabase-url",children:"Project URL *"}),d.jsx("input",{id:"supabase-url",type:"url",value:n,onChange:w=>a(w.target.value),placeholder:"https://your-project-id.supabase.co",style:{fontFamily:"monospace"}})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"supabase-key",children:"Anonymous/Public Key *"}),d.jsx("textarea",{id:"supabase-key",value:s,onChange:w=>l(w.target.value),placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",rows:3,style:{fontFamily:"monospace",fontSize:"0.85rem"}})]}),p==="success"&&d.jsx("div",{style:{padding:"0.75rem",background:"var(--green-50)",border:"1px solid var(--green-200)",borderRadius:"var(--radius-md)",color:"var(--green-700)"},children:"✅ Connection successful! Your Supabase project is ready."}),p==="error"&&d.jsxs("div",{style:{padding:"0.75rem",background:"var(--red-50)",border:"1px solid var(--red-200)",borderRadius:"var(--radius-md)",color:"var(--red-700)"},children:["❌ ",y]}),d.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[d.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem"},children:"🔒 Privacy & Security"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--gray-600)"},children:[d.jsx("li",{children:"Your credentials are stored locally in your browser only"}),d.jsx("li",{children:"All data goes directly to YOUR Supabase project"}),d.jsx("li",{children:"We never see or access your data"}),d.jsx("li",{children:"You can disconnect at any time"})]})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Skip (Use Offline Only)"}),d.jsx("button",{className:"btn btn-primary",onClick:T,disabled:!n||!s||u,children:u?"🔄 Testing...":"🧪 Test Connection"}),d.jsx("button",{className:"btn btn-success",onClick:S,disabled:p!=="success",children:"✅ Save & Connect"})]})]}),d.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: white;
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
          flex-wrap: wrap;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .form-group input,
        .form-group textarea {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-size: 0.9rem;
        }

        .form-group input:focus,
        .form-group textarea:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        @media (max-width: 640px) {
          .modal-footer {
            flex-direction: column;
          }

          .modal-footer button {
            width: 100%;
          }
        }
      `})]})}class ri{static BACKUP_KEY="navigator_local_backups";static MAX_BACKUPS=10;static downloadBackup(t,r){try{const n=new Date().toISOString().replace(/[:.]/g,"-"),a=r||`navigator-backup-${n}.json`,s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),l=URL.createObjectURL(s),u=document.createElement("a");u.href=l,u.download=a,document.body.appendChild(u),u.click();try{u.parentNode===document.body&&document.body.removeChild(u)}catch(m){ve.warn("Non-critical DOM cleanup error during backup download:",m)}URL.revokeObjectURL(l),ve.info(`Backup downloaded: ${a} (${s.size} bytes)`)}catch(n){throw ve.error("Failed to download backup:",n),n}}static storeLocalBackup(t){try{const r=this.getLocalBackups(),a={timestamp:new Date().toISOString(),data:t,size:JSON.stringify(t).length,version:t._schemaVersion||1};r.unshift(a);const s=r.slice(0,this.MAX_BACKUPS);localStorage.setItem(this.BACKUP_KEY,JSON.stringify(s)),ve.info(`Local backup stored (${s.length}/${this.MAX_BACKUPS})`)}catch(r){ve.error("Failed to store local backup:",r)}}static getLocalBackups(){try{const t=localStorage.getItem(this.BACKUP_KEY);return t?JSON.parse(t):[]}catch(t){return ve.error("Failed to get local backups:",t),[]}}static restoreFromLocalBackup(t){const r=this.getLocalBackups();if(t<0||t>=r.length)throw new Error("Invalid backup index");return r[t].data}static async getStorageUsage(){if("storage"in navigator&&"estimate"in navigator.storage)try{const t=await navigator.storage.estimate(),r=t.usage||0,n=t.quota||0,a=n>0?r/n*100:0;return{used:r,quota:n,percentage:a}}catch(t){ve.warn("Failed to get storage estimate:",t)}return{used:0,quota:0,percentage:0}}static async isStorageLow(){const{percentage:t}=await this.getStorageUsage();return t>80}static createComprehensiveBackup(t){return{version:"1.0",created:new Date().toISOString(),platform:navigator.platform,userAgent:navigator.userAgent.substring(0,100),app:{name:"Navigator Web",version:"1.0.0"},data:t,checksum:$o(t)}}static verifyBackup(t){try{return!t.data||!t.checksum?!1:$o(t.data)===t.checksum}catch(r){return ve.error("Backup verification failed:",r),!1}}static async performCriticalBackup(t,r){try{if(ve.info(`Performing critical backup: ${r}`),this.storeLocalBackup(t),this.shouldDownloadBackup(r)){const s=this.createComprehensiveBackup(t);this.downloadBackup(s,`navigator-critical-${r}-${Date.now()}.json`),ve.info(`Backup file downloaded for critical event: ${r}`)}await this.isStorageLow()&&ve.warn("Browser storage is running low!")}catch(n){throw ve.error("Critical backup failed:",n),n}}static shouldDownloadBackup(t){return["manual","import","day-end","restore","data-loss-risk"].includes(t)}static cleanupOldBackups(){try{const t=this.getLocalBackups(),r=new Date;r.setDate(r.getDate()-30);const n=t.filter(a=>new Date(a.timestamp)>r);n.length!==t.length&&(localStorage.setItem(this.BACKUP_KEY,JSON.stringify(n)),ve.info(`Cleaned up ${t.length-n.length} old backups`))}catch(t){ve.error("Failed to cleanup old backups:",t)}}static getBackupStats(){const t=this.getLocalBackups(),r=t.reduce((s,l)=>s+(l.size||0),0),n=t.length>0?t[t.length-1].timestamp:null,a=t.length>0?t[0].timestamp:null;return{count:t.length,totalSize:r,oldestDate:n,newestDate:a}}}function QR({currentData:e,onRestore:t,isOpen:r,onClose:n}){const[a,s]=rr.useState([]),[l,u]=rr.useState({used:0,quota:0,percentage:0}),[m,p]=rr.useState(!1);rr.useEffect(()=>{r&&(g(),y())},[r]);const g=()=>{try{const I=ri.getLocalBackups();s(I)}catch(I){ve.error("Failed to load backups:",I)}},y=async()=>{try{const I=await ri.getStorageUsage();u(I)}catch(I){ve.error("Failed to load storage usage:",I)}},_=async()=>{p(!0);try{await ri.performCriticalBackup(e,"manual"),g(),ve.info("Manual backup created successfully")}catch(I){ve.error("Failed to create manual backup:",I)}finally{p(!1)}},T=I=>{try{const A=ri.restoreFromLocalBackup(I);t(A),n()}catch(A){ve.error("Failed to restore from backup:",A)}},S=(I,A)=>{try{const R=new Date(I.timestamp).toISOString().replace(/[:.]/g,"-");ri.downloadBackup(I.data,`navigator-backup-${R}.json`)}catch(R){ve.error("Failed to download backup:",R)}},w=I=>{if(I===0)return"0 B";const A=1024,R=["B","KB","MB","GB"],K=Math.floor(Math.log(I)/Math.log(A));return parseFloat((I/Math.pow(A,K)).toFixed(1))+" "+R[K]},E=I=>new Date(I).toLocaleString(),P=I=>I>80?"var(--danger)":I>60?"var(--warning)":"var(--success)";return r?d.jsxs("div",{className:"modal-overlay",children:[d.jsxs("div",{className:"modal-content",style:{maxWidth:"800px"},children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h2",{children:"💾 Backup Manager"}),d.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem",color:"var(--text-primary)"},children:"Local backups are automatically created and downloaded to prevent data loss"})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius-md)"},children:[d.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:"📊 Storage Usage"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[d.jsx("div",{style:{flex:1,height:"8px",background:"var(--gray-200)",borderRadius:"4px",overflow:"hidden"},children:d.jsx("div",{style:{height:"100%",background:P(l.percentage),width:`${Math.min(l.percentage,100)}%`,transition:"width 0.3s ease"}})}),d.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",minWidth:"60px"},children:[l.percentage.toFixed(1),"%"]})]}),d.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:[w(l.used)," of ",w(l.quota)," used",l.percentage>80&&d.jsx("span",{style:{color:"var(--danger)",fontWeight:500,marginLeft:"0.5rem"},children:"⚠️ Storage running low!"})]})]}),d.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--info-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--info)"},children:[d.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--info-dark)"},children:"📁 Create Manual Backup"}),d.jsx("p",{style:{margin:"0 0 1rem",fontSize:"0.85rem",color:"var(--info-dark)"},children:"Create an immediate backup and download it to your computer for safekeeping."}),d.jsx("button",{className:"btn btn-primary",onClick:_,disabled:m,children:m?"📦 Creating...":"📦 Create & Download Backup"})]}),d.jsxs("div",{children:[d.jsxs("h4",{style:{margin:"0 0 1rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:["📚 Local Backups (",a.length,")"]}),a.length===0?d.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"No local backups found. Create your first backup above!"}):d.jsx("div",{style:{maxHeight:"300px",overflow:"auto"},children:a.map((I,A)=>d.jsx("div",{style:{padding:"1rem",border:"1px solid var(--border-light)",borderRadius:"var(--radius-md)",marginBottom:"0.5rem",background:"var(--surface)"},children:d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[d.jsxs("div",{children:[d.jsx("div",{style:{fontWeight:500,fontSize:"0.9rem",color:"var(--text-primary)"},children:E(I.timestamp)}),d.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:["Size: ",w(I.size||0)," • Version: ",I.version||1]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>S(I),title:"Download backup file",children:"📥"}),d.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>T(A),title:"Restore from this backup",children:"🔄 Restore"})]})]})},A))})]}),d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"var(--success-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--success)"},children:[d.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem",color:"var(--success-dark)"},children:"✅ Data Protection Features"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--success-dark)"},children:[d.jsx("li",{children:"Automatic backups every 5 minutes when data changes"}),d.jsx("li",{children:"Critical backups downloaded after completions"}),d.jsx("li",{children:"Local browser storage with 10 backup rotation"}),d.jsx("li",{children:"Storage monitoring and cleanup"}),d.jsx("li",{children:"Data integrity verification"})]})]})]}),d.jsx("div",{className:"modal-footer",children:d.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Close"})})]}),d.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: var(--surface);
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border-light);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
        }

        .btn-sm {
          padding: 0.375rem 0.75rem;
          font-size: 0.8rem;
        }
      `})]}):null}function eL({settings:e,onUpdateSettings:t,onClose:r}){const[n,a]=J.useState(e),[s,l]=J.useState("templates"),[u,m]=J.useState(null),[p,g]=J.useState(""),[y,_]=J.useState(!1),[T,S]=J.useState(!1),w=async()=>{S(!0);try{if(!n.agentProfile.name.trim()){alert("Agent name is required");return}if(!n.agentProfile.signature.trim()){alert("Agent signature is required");return}if(n.messageTemplates.length===0){a(W=>({...W,messageTemplates:_y,activeTemplateId:"professional_standard"}));return}await t(n),r()}catch(W){console.error("Failed to save settings:",W),alert("Failed to save settings. Please try again.")}finally{S(!1)}},E=W=>{a(D=>({...D,agentProfile:{...D.agentProfile,...W}}))},P=(W,D)=>{a(ee=>({...ee,messageTemplates:ee.messageTemplates.map(re=>re.id===W?{...re,...D}:re)}))},I=()=>{const W={id:`custom_${Date.now()}`,name:"New Custom Template",template:"{greeting}Payment Reminder\\n\\n{refLine}Your payment is due {date}{time}.\\n\\nAmount: £{amount}\\n\\n[Your custom message here]\\n\\n{signature}{contactInfo}",variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]};a(D=>({...D,messageTemplates:[...D.messageTemplates,W]})),m(W.id)},A=W=>{if(n.messageTemplates.length<=1){alert("You must have at least one message template");return}a(D=>{const ee=D.messageTemplates.filter(pe=>pe.id!==W),re=D.activeTemplateId===W?ee[0]?.id||"professional_standard":D.activeTemplateId;return{...D,messageTemplates:ee,activeTemplateId:re}})},R=()=>{try{const W={id:"preview",addressIndex:0,address:"123 Sample Street, London",customerName:"123456789 Smith",phoneNumber:"07123456789",scheduledDate:new Date(Date.now()+864e5).toISOString().slice(0,10),scheduledTime:"14:00",status:"Scheduled",amount:"125.00",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},D={id:"preview",arrangementId:"preview",type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},ee=wy(W,D,n);g(ee),_(!0)}catch(W){console.error("Preview failed:",W),alert("Failed to generate preview. Please check your template.")}},K=(W,D)=>{a(ee=>({...ee,customizableSchedule:{...ee.customizableSchedule,[W]:D}}))};return d.jsxs("div",{className:"modal-backdrop",onClick:W=>W.target===W.currentTarget&&r(),children:[d.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90vw",maxHeight:"90vh",overflow:"auto"},children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h2",{style:{margin:0},children:"⚙️ Reminder Settings"}),d.jsx("button",{className:"btn btn-ghost",onClick:r,children:"✕"})]}),d.jsxs("div",{className:"modal-body",children:[d.jsxs("div",{className:"btn-group",style:{marginBottom:"1.5rem"},children:[d.jsx("button",{className:`btn ${s==="profile"?"btn-primary":"btn-ghost"}`,onClick:()=>l("profile"),children:"👤 Agent Profile"}),d.jsx("button",{className:`btn ${s==="templates"?"btn-primary":"btn-ghost"}`,onClick:()=>l("templates"),children:"📝 Message Templates"}),d.jsx("button",{className:`btn ${s==="schedule"?"btn-primary":"btn-ghost"}`,onClick:()=>l("schedule"),children:"📅 Schedule Settings"})]}),s==="profile"&&d.jsxs("div",{className:"settings-tab",children:[d.jsx("h3",{children:"Agent Profile Information"}),d.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"This information will be used in your reminder messages and signature."}),d.jsxs("div",{className:"form-grid",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"agent-name",children:"👤 Agent Name *"}),d.jsx("input",{id:"agent-name",name:"agentName",type:"text",value:n.agentProfile.name,onChange:W=>E({name:W.target.value}),className:"input",placeholder:"Enter your full name",required:!0})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"agent-title",children:"🏷️ Job Title *"}),d.jsxs("select",{id:"agent-title",name:"agentTitle",value:n.agentProfile.title,onChange:W=>E({title:W.target.value}),className:"input",children:[d.jsx("option",{value:"Enforcement Agent",children:"Enforcement Agent"}),d.jsx("option",{value:"Bailiff",children:"Bailiff"}),d.jsx("option",{value:"Recovery Officer",children:"Recovery Officer"}),d.jsx("option",{value:"Collection Agent",children:"Collection Agent"}),d.jsx("option",{value:"Senior Enforcement Agent",children:"Senior Enforcement Agent"}),d.jsx("option",{value:"Lead Bailiff",children:"Lead Bailiff"})]})]}),d.jsxs("div",{className:"form-group form-group-full",children:[d.jsx("label",{htmlFor:"agent-signature",children:"✍️ Message Signature *"}),d.jsx("input",{id:"agent-signature",name:"agentSignature",type:"text",value:n.agentProfile.signature,onChange:W=>E({signature:W.target.value}),className:"input",placeholder:"e.g., Enforcement Agent J. Smith",required:!0}),d.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"This will appear at the end of your reminder messages"})]}),d.jsxs("div",{className:"form-group form-group-full",children:[d.jsx("label",{htmlFor:"agent-contact-info",children:"📞 Contact Information (Optional)"}),d.jsx("input",{id:"agent-contact-info",name:"agentContactInfo",type:"text",value:n.agentProfile.contactInfo||"",onChange:W=>E({contactInfo:W.target.value}),className:"input",placeholder:"e.g., Tel: 01234 567890"}),d.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Additional contact information to include in messages"})]})]})]}),s==="templates"&&d.jsxs("div",{className:"settings-tab",children:[d.jsxs("div",{style:{marginBottom:"1.5rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[d.jsx("h3",{children:"Message Templates"}),d.jsxs("div",{children:[d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:R,children:"👁️ Preview"}),d.jsx("button",{className:"btn btn-success btn-sm",onClick:I,children:"➕ Add Template"})]})]}),d.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:["Create and customize SMS reminder messages. Use variables to automatically insert customer and payment details.",d.jsx("br",{}),d.jsx("strong",{children:"💡 Click the ✏️ Edit button next to any template to see the enhanced editor with variable reference panel."})]})]}),d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:"active-template",children:"Active Template"}),d.jsx("select",{id:"active-template",name:"activeTemplate",value:n.activeTemplateId,onChange:W=>a(D=>({...D,activeTemplateId:W.target.value})),className:"input",children:n.messageTemplates.map(W=>d.jsx("option",{value:W.id,children:W.name},W.id))})]}),d.jsx("div",{className:"templates-list",children:n.messageTemplates.map(W=>d.jsxs("div",{className:"template-item",children:[d.jsxs("div",{className:"template-header",children:[d.jsxs("div",{children:[d.jsx("strong",{children:W.name}),W.id===n.activeTemplateId&&d.jsx("span",{className:"pill",style:{backgroundColor:"var(--success)15",color:"var(--success)",marginLeft:"0.5rem"},children:"Active"})]}),d.jsxs("div",{children:[d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>m(u===W.id?null:W.id),children:u===W.id?"👁️":"✏️"}),W.id.startsWith("custom_")&&d.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>A(W.id),children:"🗑️"})]})]}),u===W.id&&d.jsxs("div",{className:"template-editor",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:`template-name-${W.id}`,children:"Template Name"}),d.jsx("input",{id:`template-name-${W.id}`,name:`templateName-${W.id}`,type:"text",value:W.name,onChange:D=>P(W.id,{name:D.target.value}),className:"input"})]}),d.jsxs("div",{className:"template-editor-layout",children:[d.jsxs("div",{className:"form-group",children:[d.jsx("label",{htmlFor:`template-content-${W.id}`,children:"Message Template"}),d.jsx("textarea",{id:`template-content-${W.id}`,name:`templateContent-${W.id}`,value:W.template,onChange:D=>P(W.id,{template:D.target.value}),className:"input",rows:12,style:{fontFamily:"monospace",fontSize:"0.875rem"}}),d.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Use variables like ","{greeting}"," and ","{amount}"," - see reference panel →"]})]}),d.jsxs("div",{className:"variable-reference-panel",children:[d.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.875rem",color:"var(--text-primary)"},children:"📋 Available Variables"}),d.jsxs("div",{className:"variable-group",children:[d.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Customer Info"}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{greeting}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Smart greeting: "Mr/Mrs Smith, "'})]}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{refLine}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Reference line: "Reference: 123456789\\\\n\\\\n"'})]}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{customerName}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full name: "123456789 Smith"'})]})]}),d.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[d.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Payment Details"}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{amount}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Payment amount: "125.00"'})]}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{date}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Due date: "15/01/2025"'})]}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{time}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Time (if set): " at 14:00"'})]})]}),d.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[d.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Agent Info"}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{signature}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full signature: "Enforcement Agent J. Smith"'})]}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentName}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Name only: "J. Smith"'})]}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentTitle}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Job title: "Enforcement Agent"'})]}),d.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[d.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{contactInfo}"}),d.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Contact: "Tel: 01234 567890"'})]})]}),d.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"var(--blue-50)",borderRadius:"var(--radius-sm)",border:"1px solid var(--blue-200)"},children:[d.jsx("div",{style:{fontSize:"0.75rem",color:"var(--blue-700)",fontWeight:600,marginBottom:"0.25rem"},children:"💡 Tips:"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1rem",fontSize:"0.75rem",color:"var(--blue-600)"},children:[d.jsx("li",{children:"Use \\\\n for line breaks"}),d.jsx("li",{children:"Variables are case-sensitive"}),d.jsx("li",{children:"Preview to test your template"}),d.jsx("li",{children:"Empty variables won't show"})]})]})]})]})]})]},W.id))})]}),s==="schedule"&&d.jsxs("div",{className:"settings-tab",children:[d.jsx("h3",{children:"Reminder Schedule"}),d.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Choose when reminder notifications should be sent before payment due dates."}),d.jsx("div",{className:"form-group",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("input",{name:"globalEnabled",type:"checkbox",checked:n.globalEnabled,onChange:W=>a(D=>({...D,globalEnabled:W.target.checked}))}),"Enable automatic reminders"]})}),d.jsx("div",{className:"form-group",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("input",{name:"smsEnabled",type:"checkbox",checked:n.smsEnabled,onChange:W=>a(D=>({...D,smsEnabled:W.target.checked})),disabled:!n.globalEnabled}),"Enable SMS reminders"]})}),d.jsx("hr",{style:{margin:"1.5rem 0"}}),d.jsx("h4",{children:"Reminder Timing"}),d.jsxs("div",{className:"schedule-options",children:[d.jsx("div",{className:"form-group",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("input",{name:"threeDayReminder",type:"checkbox",checked:n.customizableSchedule.threeDayReminder,onChange:W=>K("threeDayReminder",W.target.checked),disabled:!n.globalEnabled}),"Send reminder 3 days before payment due"]})}),d.jsx("div",{className:"form-group",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("input",{name:"oneDayReminder",type:"checkbox",checked:n.customizableSchedule.oneDayReminder,onChange:W=>K("oneDayReminder",W.target.checked),disabled:!n.globalEnabled}),"Send reminder 1 day before payment due"]})}),d.jsx("div",{className:"form-group",children:d.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("input",{name:"dayOfReminder",type:"checkbox",checked:n.customizableSchedule.dayOfReminder,onChange:W=>K("dayOfReminder",W.target.checked),disabled:!n.globalEnabled}),"Send reminder on payment due date"]})})]}),d.jsxs("div",{className:"custom-days-section",children:[d.jsx("h4",{children:"Custom Reminder Days"}),d.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1rem"},children:"Add additional reminder days (e.g., 7 for weekly, 14 for bi-weekly)"}),d.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem"},children:n.customizableSchedule.customDays.map((W,D)=>d.jsxs("span",{className:"pill",style:{backgroundColor:"var(--primary)15",color:"var(--primary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[W," days before",d.jsx("button",{onClick:()=>{const ee=[...n.customizableSchedule.customDays];ee.splice(D,1),K("customDays",ee)},style:{background:"none",border:"none",color:"inherit",cursor:"pointer",padding:"0 0.25rem"},children:"✕"})]},D))}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[d.jsx("input",{name:"customDayInput",type:"number",min:"1",max:"365",placeholder:"Days before",className:"input",style:{width:"120px"},onKeyPress:W=>{if(W.key==="Enter"){const D=W.target,ee=parseInt(D.value);ee&&ee>0&&!n.customizableSchedule.customDays.includes(ee)&&(K("customDays",[...n.customizableSchedule.customDays,ee]),D.value="")}}}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:W=>{const D=W.target.parentElement?.querySelector("input"),ee=parseInt(D.value);ee&&ee>0&&!n.customizableSchedule.customDays.includes(ee)&&(K("customDays",[...n.customizableSchedule.customDays,ee]),D.value="")},children:"➕ Add"})]})]})]})]}),d.jsxs("div",{className:"modal-footer",children:[d.jsx("button",{className:"btn btn-ghost",onClick:r,children:"Cancel"}),d.jsx(es,{className:"btn btn-primary",onClick:w,isLoading:T,loadingText:"Saving...",children:"💾 Save Settings"})]})]}),y&&d.jsx("div",{className:"modal-backdrop",onClick:()=>_(!1),children:d.jsxs("div",{className:"modal-content",onClick:W=>W.stopPropagation(),children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h3",{style:{margin:0},children:"📱 Message Preview"}),d.jsx("button",{className:"btn btn-ghost",onClick:()=>_(!1),children:"✕"})]}),d.jsxs("div",{className:"modal-body",children:[d.jsx("div",{style:{padding:"1rem",backgroundColor:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:"pre-wrap",lineHeight:1.5},children:p}),d.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"This is how your message will appear when sent to customers."})]}),d.jsx("div",{className:"modal-footer",children:d.jsx("button",{className:"btn btn-primary",onClick:()=>_(!1),children:"Close Preview"})})]})}),d.jsx("style",{children:`
        /* Modal Backdrop */
        .modal-backdrop {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        /* Modal Content */
        .modal-content {
          background: white;
          border-radius: var(--radius-lg, 12px);
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          max-width: 900px;
          width: 95vw;
          max-height: 95vh;
          overflow: hidden;
          display: flex;
          flex-direction: column;
        }

        @media (max-width: 480px) {
          .modal-content {
            width: 98vw;
            max-height: 98vh;
            border-radius: var(--radius-md, 8px);
            margin: 0 0.5rem;
          }
        }

        /* Modal Header */
        .modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem 2rem;
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-header {
            padding: 1rem 1.5rem;
          }

          .modal-header h2 {
            font-size: 1.25rem;
          }
        }

        .modal-header h2 {
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--gray-900, #111827);
          margin: 0;
        }

        .modal-header .btn {
          padding: 0.5rem;
          min-width: auto;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          font-size: 1rem;
        }

        /* Modal Body */
        .modal-body {
          padding: 2rem;
          overflow-y: auto;
          flex: 1;
        }

        /* Modal Footer */
        .modal-footer {
          padding: 1.5rem 2rem;
          border-top: 1px solid var(--gray-200, #e5e7eb);
          display: flex;
          justify-content: flex-end;
          gap: 1rem;
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-body {
            padding: 1.5rem;
          }

          .modal-footer {
            padding: 1rem 1.5rem;
            flex-direction: column-reverse;
            gap: 0.75rem;
          }

          .modal-footer .btn {
            width: 100%;
            justify-content: center;
          }
        }

        /* Template Editor Layout */
        .template-editor-layout {
          display: grid;
          grid-template-columns: 1fr 320px;
          gap: 1.5rem;
          min-height: 500px;
        }

        @media (max-width: 1024px) {
          .template-editor-layout {
            grid-template-columns: 1fr;
            gap: 1rem;
          }

          .variable-reference-panel {
            order: -1;
            max-height: 300px !important;
          }
        }

        /* Variable Reference Panel */
        .variable-reference-panel {
          background: var(--gray-50, #f8f9fa);
          border: 1px solid var(--gray-200, #e9ecef);
          border-radius: var(--radius-md, 8px);
          padding: 1.25rem;
          font-size: 0.875rem;
          max-height: 500px;
          overflow-y: auto;
          position: sticky;
          top: 0;
        }

        .variable-group {
          margin-bottom: 1.5rem;
        }

        .variable-group:last-child {
          margin-bottom: 0;
        }

        .variable-group h5 {
          margin: 0 0 0.75rem;
          font-size: 0.875rem;
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.025em;
        }

        .variable-item {
          margin-bottom: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: var(--radius-sm, 6px);
          border: 1px solid var(--gray-100, #f3f4f6);
        }

        .variable-item:last-child {
          margin-bottom: 0;
        }

        .variable-item code {
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          background: var(--primary-light, #e0f2fe);
          padding: 0.25rem 0.5rem;
          border-radius: 0.25rem;
          font-size: 0.8125rem;
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .variable-item div {
          color: var(--text-muted, #6b7280);
          font-size: 0.8125rem;
          margin-top: 0.375rem;
          line-height: 1.4;
        }

        /* Form Improvements */
        .form-group {
          margin-bottom: 1.5rem;
        }

        .form-group label {
          display: block;
          font-weight: 500;
          color: var(--gray-700, #374151);
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .form-group .input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--gray-300, #d1d5db);
          border-radius: var(--radius-md, 8px);
          font-size: 0.875rem;
          transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .form-group .input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }

        .form-group textarea.input {
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
          line-height: 1.5;
        }

        /* Button Group */
        .btn-group {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 2rem;
        }

        .btn-group .btn {
          flex: 1;
          text-align: center;
          font-size: 0.875rem;
          padding: 0.75rem 0.5rem;
        }

        /* Mobile-specific tab optimizations */
        @media (max-width: 480px) {
          .btn-group {
            gap: 0.25rem;
            margin-bottom: 1.5rem;
          }

          .btn-group .btn {
            font-size: 0.75rem;
            padding: 0.625rem 0.375rem;
            line-height: 1.2;
          }
        }

        @media (max-width: 360px) {
          .btn-group {
            flex-direction: column;
            gap: 0.5rem;
          }

          .btn-group .btn {
            flex: none;
            font-size: 0.875rem;
            padding: 0.75rem 1rem;
          }
        }

        /* Templates List */
        .templates-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .template-item {
          border: 1px solid var(--gray-200, #e5e7eb);
          border-radius: var(--radius-lg, 12px);
          overflow: hidden;
        }

        .template-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          background: var(--gray-50, #f9fafb);
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
        }

        .template-editor {
          padding: 1.5rem;
          background: white;
        }

        /* Dark Mode Support */
        .dark-mode .modal-content {
          background: var(--gray-800, #1f2937);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-header {
          border-bottom-color: var(--gray-700, #374151);
        }

        .dark-mode .modal-header h2 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-footer {
          border-top-color: var(--gray-700, #374151);
        }

        /* Form Elements Dark Mode */
        .dark-mode .form-group label {
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .form-group .input {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .form-group .input:focus {
          border-color: var(--primary, #0ea5e9);
          background: var(--gray-700, #374151);
        }

        .dark-mode .form-group .input::placeholder {
          color: var(--gray-400, #9ca3af);
        }

        /* Variable Reference Panel Dark Mode */
        .dark-mode .variable-reference-panel {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .variable-group h5 {
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item {
          background: var(--gray-800, #1f2937);
          border-color: var(--gray-600, #4b5563);
        }

        .dark-mode .variable-item code {
          background: var(--primary-dark, #0c4a6e);
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item div {
          color: var(--gray-300, #d1d5db);
        }

        /* Template Items Dark Mode */
        .dark-mode .template-item {
          border-color: var(--gray-600, #4b5563);
          background: var(--gray-800, #1f2937);
        }

        .dark-mode .template-header {
          background: var(--gray-700, #374151);
          border-bottom-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .template-editor {
          background: var(--gray-800, #1f2937);
        }

        /* Button Group Dark Mode */
        .dark-mode .btn-group .btn {
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .btn-group .btn.btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .dark-mode .btn-group .btn.btn-ghost {
          background: var(--gray-700, #374151);
        }

        .dark-mode .btn-group .btn.btn-ghost:hover {
          background: var(--gray-600, #4b5563);
        }

        /* Additional Text Elements */
        .dark-mode .settings-tab h3 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .settings-tab p {
          color: var(--gray-300, #d1d5db);
        }

        .dark-mode .setting-description {
          color: var(--gray-400, #9ca3af);
        }

        /* Tips Box Dark Mode */
        .dark-mode .variable-reference-panel div[style*="background: var(--blue-50)"] {
          background: var(--gray-600, #4b5563) !important;
          border-color: var(--gray-500, #6b7280) !important;
        }

        .dark-mode .variable-reference-panel div[style*="color: var(--blue-700)"] {
          color: var(--blue-300, #93c5fd) !important;
        }

        .dark-mode .variable-reference-panel ul {
          color: var(--gray-300, #d1d5db) !important;
        }

        /* Template List Dark Mode */
        .dark-mode .template-item strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .pill {
          background: var(--success-dark, #166534) !important;
          color: var(--success-light, #86efac) !important;
        }

        .dark-mode .template-header strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .template-header {
          color: var(--gray-100, #f3f4f6) !important;
        }
      `})]})}function tL({settings:e,onUpdateSettings:t,onClose:r}){const[n,a]=J.useState(e||rs);J.useEffect(()=>{a(e||rs)},[e]);const s=()=>{t(n),r()},l=()=>{a(rs)};return d.jsxs("div",{className:"modal-overlay",onClick:r,children:[d.jsxs("div",{className:"modal-content bonus-settings-modal",onClick:u=>u.stopPropagation(),style:{maxWidth:"700px",maxHeight:"90vh",overflow:"auto"},children:[d.jsxs("div",{className:"modal-header",children:[d.jsx("h2",{style:{margin:0},children:"⚙️ Bonus Calculation Settings"}),d.jsx("button",{className:"close-btn",onClick:r,children:"✕"})]}),d.jsxs("div",{className:"modal-body",style:{padding:"1.5rem"},children:[d.jsx("div",{className:"setting-group",children:d.jsxs("label",{className:"setting-row",children:[d.jsx("input",{type:"checkbox",checked:n.enabled,onChange:u=>a({...n,enabled:u.target.checked})}),d.jsx("span",{className:"setting-label",children:"Enable Bonus Tracking"})]})}),n.enabled&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"setting-group",children:[d.jsx("label",{className:"setting-label-main",children:"Calculation Method"}),d.jsxs("div",{className:"calc-type-grid",children:[d.jsxs("button",{className:`calc-type-btn ${n.calculationType==="simple"?"active":""}`,onClick:()=>a({...n,calculationType:"simple"}),children:[d.jsx("div",{className:"calc-type-icon",children:"📊"}),d.jsx("div",{className:"calc-type-name",children:"Simple"}),d.jsx("div",{className:"calc-type-desc",children:"£X per PIF - £Y per day"})]}),d.jsxs("button",{className:`calc-type-btn ${n.calculationType==="complex"?"active":""}`,onClick:()=>a({...n,calculationType:"complex"}),children:[d.jsx("div",{className:"calc-type-icon",children:"🧮"}),d.jsx("div",{className:"calc-type-name",children:"Complex"}),d.jsx("div",{className:"calc-type-desc",children:"TCG Regulations 2014"})]}),d.jsxs("button",{className:`calc-type-btn ${n.calculationType==="custom"?"active":""}`,onClick:()=>a({...n,calculationType:"custom"}),children:[d.jsx("div",{className:"calc-type-icon",children:"⚡"}),d.jsx("div",{className:"calc-type-name",children:"Custom"}),d.jsx("div",{className:"calc-type-desc",children:"JavaScript formula"})]})]})]}),n.calculationType==="simple"&&d.jsxs("div",{className:"setting-group",children:[d.jsx("h3",{style:{marginBottom:"1rem"},children:"Simple Calculation"}),d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"Bonus per PIF (£)"}),d.jsx("input",{type:"number",className:"input",min:"0",step:"1",value:n.simpleSettings?.pifBonus||100,onChange:u=>a({...n,simpleSettings:{...n.simpleSettings,pifBonus:parseFloat(u.target.value)||0}})})]}),d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"Daily Threshold (£)"}),d.jsx("input",{type:"number",className:"input",min:"0",step:"1",value:n.simpleSettings?.dailyThreshold||100,onChange:u=>a({...n,simpleSettings:{...n.simpleSettings,dailyThreshold:parseFloat(u.target.value)||0}})})]}),d.jsxs("div",{className:"formula-preview",children:[d.jsx("strong",{children:"Formula:"})," (PIFs × £",n.simpleSettings?.pifBonus||100,") - (Days × £",n.simpleSettings?.dailyThreshold||100,")"]})]}),n.calculationType==="complex"&&d.jsxs("div",{className:"setting-group",children:[d.jsx("h3",{style:{marginBottom:"1rem"},children:"Complex Calculation (TCG Regulations 2014)"}),d.jsxs("div",{className:"settings-grid",children:[d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"Standard PIF Bonus (£)"}),d.jsx("input",{type:"number",className:"input",min:"0",step:"1",value:n.complexSettings?.basePifBonus||100,onChange:u=>a({...n,complexSettings:{...n.complexSettings,basePifBonus:parseFloat(u.target.value)||0}})})]}),d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"Small PIF Bonus (£)"}),d.jsx("input",{type:"number",className:"input",min:"0",step:"1",value:n.complexSettings?.smallPifBonus||30,onChange:u=>a({...n,complexSettings:{...n.complexSettings,smallPifBonus:parseFloat(u.target.value)||0}})}),d.jsx("small",{children:"For debts < £100"})]}),d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"Large Debt Threshold (£)"}),d.jsx("input",{type:"number",className:"input",min:"0",step:"100",value:n.complexSettings?.largePifThreshold||1500,onChange:u=>a({...n,complexSettings:{...n.complexSettings,largePifThreshold:parseFloat(u.target.value)||0}})})]}),d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"Large PIF Max (£)"}),d.jsx("input",{type:"number",className:"input",min:"0",step:"50",value:n.complexSettings?.largePifCap||500,onChange:u=>a({...n,complexSettings:{...n.complexSettings,largePifCap:parseFloat(u.target.value)||0}})}),d.jsx("small",{children:"Maximum bonus per large PIF"})]}),d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"Linked Case Bonus (£)"}),d.jsx("input",{type:"number",className:"input",min:"0",step:"5",value:n.complexSettings?.linkedCaseBonus||10,onChange:u=>a({...n,complexSettings:{...n.complexSettings,linkedCaseBonus:parseFloat(u.target.value)||0}})}),d.jsx("small",{children:"For cases with £0 enforcement fee"})]}),d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"Daily Threshold (£)"}),d.jsx("input",{type:"number",className:"input",min:"0",step:"10",value:n.complexSettings?.dailyThreshold||100,onChange:u=>a({...n,complexSettings:{...n.complexSettings,dailyThreshold:parseFloat(u.target.value)||0}})})]})]}),d.jsxs("div",{className:"formula-preview",children:[d.jsx("strong",{children:"Formula:"}),d.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[d.jsxs("li",{children:["Standard PIF (£100-£1500): £",n.complexSettings?.basePifBonus||100]}),d.jsxs("li",{children:["Large PIF (>£1500): £",n.complexSettings?.basePifBonus||100," + 2.5% of 7.5% over £1500 (max £",n.complexSettings?.largePifCap||500,")"]}),d.jsxs("li",{children:["Small PIF (<£100): £",n.complexSettings?.smallPifBonus||30]}),d.jsxs("li",{children:["Linked cases (£0): £",n.complexSettings?.linkedCaseBonus||10]}),d.jsxs("li",{children:["Daily threshold: £",n.complexSettings?.dailyThreshold||100]})]})]})]}),n.calculationType==="custom"&&d.jsxs("div",{className:"setting-group",children:[d.jsx("h3",{style:{marginBottom:"1rem"},children:"Custom Formula"}),d.jsxs("label",{className:"setting-row-input",children:[d.jsx("span",{className:"setting-label",children:"JavaScript Expression"}),d.jsx("textarea",{className:"input",rows:5,placeholder:"(T - (75 * N + 122.5)) / 1.075",value:n.customFormula||"",onChange:u=>a({...n,customFormula:u.target.value}),style:{fontFamily:"monospace",fontSize:"0.875rem"}})]}),d.jsxs("div",{className:"formula-preview",children:[d.jsx("strong",{children:"Available variables:"}),d.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[d.jsxs("li",{children:[d.jsx("code",{children:"T"})," - Total amount collected (£)"]}),d.jsxs("li",{children:[d.jsx("code",{children:"N"})," - Number of cases"]}),d.jsxs("li",{children:[d.jsx("code",{children:"D"})," - Calculated debt amount (£)"]}),d.jsxs("li",{children:[d.jsx("code",{children:"days"})," - Working days"]})]}),d.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--text-muted)"},children:["Example: ",d.jsx("code",{children:"(T - (75 * N + 122.5)) / 1.075 * 0.1"})]})]})]}),d.jsxs("div",{className:"setting-group",children:[d.jsx("h3",{style:{marginBottom:"1rem"},children:"Additional Options"}),d.jsxs("label",{className:"setting-row",children:[d.jsx("input",{type:"checkbox",checked:n.adjustForWorkingDays,onChange:u=>a({...n,adjustForWorkingDays:u.target.checked})}),d.jsxs("span",{className:"setting-label",children:["Adjust for Working Days",d.jsx("small",{style:{display:"block",marginTop:"0.25rem"},children:"Calculate threshold based on actual days worked"})]})]})]})]})]}),d.jsxs("div",{className:"modal-footer",style:{display:"flex",gap:"0.75rem",padding:"1.5rem"},children:[d.jsx("button",{className:"btn btn-ghost",onClick:l,children:"Reset to Default"}),d.jsx("div",{style:{flex:1}}),d.jsx("button",{className:"btn btn-ghost",onClick:r,children:"Cancel"}),d.jsx("button",{className:"btn btn-primary",onClick:s,children:"Save Settings"})]})]}),d.jsx("style",{children:`
        .bonus-settings-modal .setting-group {
          margin-bottom: 2rem;
          padding-bottom: 2rem;
          border-bottom: 1px solid var(--border);
        }

        .bonus-settings-modal .setting-group:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }

        .setting-label-main {
          display: block;
          font-weight: 600;
          margin-bottom: 1rem;
          color: var(--text-primary);
        }

        .setting-row {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          padding: 0.75rem;
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: background 0.2s;
        }

        .setting-row:hover {
          background: var(--gray-50);
        }

        .setting-row input[type="checkbox"] {
          margin-top: 0.25rem;
        }

        .setting-label {
          flex: 1;
          font-weight: 500;
        }

        .setting-label small {
          display: block;
          margin-top: 0.25rem;
          font-size: 0.75rem;
          color: var(--text-muted);
          font-weight: normal;
        }

        .setting-row-input {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .setting-row-input .setting-label {
          font-weight: 600;
          color: var(--text-primary);
        }

        .setting-row-input small {
          font-size: 0.75rem;
          color: var(--text-muted);
        }

        .calc-type-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
          gap: 1rem;
        }

        .calc-type-btn {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 1.5rem 1rem;
          border: 2px solid var(--border);
          border-radius: var(--radius-lg);
          background: var(--surface);
          cursor: pointer;
          transition: all 0.2s;
        }

        .calc-type-btn:hover {
          border-color: var(--primary);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .calc-type-btn.active {
          border-color: var(--primary);
          background: var(--primary-light);
        }

        .calc-type-icon {
          font-size: 2rem;
          margin-bottom: 0.5rem;
        }

        .calc-type-name {
          font-weight: 600;
          margin-bottom: 0.25rem;
          color: var(--text-primary);
        }

        .calc-type-desc {
          font-size: 0.75rem;
          color: var(--text-muted);
          text-align: center;
        }

        .settings-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 1rem;
        }

        .formula-preview {
          margin-top: 1.5rem;
          padding: 1rem;
          background: var(--gray-50);
          border-left: 4px solid var(--primary);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
        }

        .formula-preview strong {
          color: var(--primary);
        }

        .formula-preview code {
          background: var(--gray-100);
          padding: 0.125rem 0.375rem;
          border-radius: var(--radius-sm);
          font-family: monospace;
          font-size: 0.875em;
        }

        .formula-preview ul {
          font-size: 0.875rem;
        }

        .formula-preview li {
          margin-bottom: 0.25rem;
        }
      `})]})}function rL(e,t){const r={exportedAt:new Date().toISOString(),exportedBy:t||"unknown",version:"1.0",dataController:"User (you are responsible for this data)",dataProcessor:"Navigator Web",addresses:e.addresses||[],completions:e.completions||[],arrangements:e.arrangements||[],daySessions:e.daySessions||[],currentListVersion:e.currentListVersion||1,subscription:e.subscription||null,privacyNotice:{message:"This export contains all your data stored in Navigator Web.",gdprRights:"You have the right to access, rectify, erase, restrict, port, and object to processing of this data.",dataController:"You are the data controller for customer/debtor information",contact:"For questions: See PRIVACY.md"}},n=JSON.stringify(r,null,2),a=new Blob([n],{type:"application/json"}),s=URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download=`navigator-data-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}async function ly(){if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate(),t=e.usage||0,r=e.quota||0,n=r>0?Math.round(t/r*100):0;return{used:t,quota:r,percentage:n,usedMB:(t/1024/1024).toFixed(2),quotaMB:(r/1024/1024).toFixed(2)}}return{used:0,quota:0,percentage:0,usedMB:"0.00",quotaMB:"0.00"}}async function nL(){try{const e=Object.keys(localStorage).filter(t=>t.startsWith("geocoding_cache_"));if(e.forEach(t=>localStorage.removeItem(t)),"caches"in window){const r=(await caches.keys()).filter(n=>n.includes("map")||n.includes("tile"));await Promise.all(r.map(n=>caches.delete(n)))}console.log(`Cleared ${e.length} geocoding cache entries`),alert(`Cache cleared successfully!

Removed:
- ${e.length} geocoding entries
- Map tile caches`)}catch(e){console.error("Failed to clear caches:",e),alert("Failed to clear some caches. See console for details.")}}const aL="1.0.0",iL={version:aL},sL=({trigger:e,reminderSettings:t,onUpdateReminderSettings:r,bonusSettings:n,onUpdateBonusSettings:a,onChangePassword:s,onChangeEmail:l,onDeleteAccount:u,appState:m,userEmail:p,onImportExcel:g,onRestoreBackup:y,onManualSync:_,isSyncing:T,onShowBackupManager:S,onShowCloudBackups:w,onShowSubscription:E,onShowSupabaseSetup:P,onSignOut:I,hasSupabase:A})=>{const[R,K]=J.useState(!1),[W,D]=J.useState(!1),[ee,re]=J.useState(!1),[pe,ue]=J.useState(null),[ce,Ce]=J.useState("general"),ye=J.useRef(null),he=J.useRef(null),le=J.useRef(null),{settings:j,toggleBackup:H,toggleDarkMode:O,togglePushNotifications:ne,toggleAutoSync:Y,toggleConfirmBeforeDelete:F,updateKeepDataForMonths:U}=wp();J.useEffect(()=>{R&&!pe&&ly().then(ue)},[R,pe]),J.useEffect(()=>{const se=fe=>{ye.current&&!ye.current.contains(fe.target)&&K(!1)};return R&&document.addEventListener("mousedown",se),()=>{document.removeEventListener("mousedown",se)}},[R]),J.useEffect(()=>{const se=fe=>{fe.key==="Escape"&&(K(!1),Ce(null))};return R&&document.addEventListener("keydown",se),()=>{document.removeEventListener("keydown",se)}},[R]);const z=se=>{Ce(ce===se?null:se)},q=({checked:se,onChange:fe,id:xe})=>d.jsxs("div",{className:"modern-toggle-switch",onClick:fe,children:[d.jsx("input",{type:"checkbox",id:xe,checked:se,onChange:fe,className:"modern-toggle-input"}),d.jsx("div",{className:`modern-toggle-slider ${se?"checked":""}`,children:d.jsx("div",{className:"modern-toggle-thumb"})})]}),M=({title:se,icon:fe,sectionKey:xe,children:je})=>{const X=ce===xe;return d.jsxs("div",{className:"modern-settings-section-container",children:[d.jsxs("button",{type:"button",className:"modern-section-header",onClick:()=>z(xe),children:[d.jsxs("div",{className:"modern-section-title-area",children:[d.jsx("span",{className:"modern-section-icon",children:fe}),d.jsx("span",{className:"modern-section-title",children:se})]}),d.jsx("span",{className:`modern-section-chevron ${X?"expanded":""}`,children:"›"})]}),d.jsx("div",{className:`modern-section-content ${X?"expanded":""}`,children:d.jsx("div",{className:"modern-section-inner",children:je})})]})},oe=se=>{const fe=se.target.files?.[0];fe&&g&&(g(fe),K(!1))};return d.jsxs("div",{className:"modern-settings-dropdown",ref:ye,children:[d.jsx("button",{className:"modern-settings-trigger",onClick:()=>K(!R),"aria-expanded":R,"aria-haspopup":"true",children:e||d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"modern-trigger-icon",children:"⚙️"}),d.jsx("span",{className:"modern-trigger-text",children:"Settings"})]})}),R&&d.jsxs("div",{className:"modern-settings-panel",children:[d.jsxs("div",{className:"modern-panel-header",children:[d.jsxs("div",{className:"modern-header-content",children:[d.jsx("h2",{className:"modern-panel-title",children:"Settings"}),d.jsx("p",{className:"modern-panel-subtitle",children:"Manage your app preferences"})]}),d.jsx("button",{className:"modern-close-button",onClick:()=>K(!1),"aria-label":"Close settings",children:"✕"})]}),d.jsxs("div",{className:"modern-panel-body",children:[d.jsxs(M,{title:"General",icon:"📱",sectionKey:"general",children:[d.jsxs("div",{className:"modern-setting-row",children:[d.jsxs("div",{className:"modern-setting-info",children:[d.jsx("div",{className:"modern-setting-label",children:"Dark Mode"}),d.jsx("div",{className:"modern-setting-desc",children:"Switch between light and dark theme"})]}),d.jsx(q,{id:"dark-mode",checked:j.darkMode,onChange:O})]}),d.jsxs("div",{className:"modern-setting-row",children:[d.jsxs("div",{className:"modern-setting-info",children:[d.jsx("div",{className:"modern-setting-label",children:"Push Notifications"}),d.jsx("div",{className:"modern-setting-desc",children:"Receive arrangement reminders"})]}),d.jsx(q,{id:"push-notifs",checked:j.pushNotifications,onChange:ne})]}),d.jsxs("div",{className:"modern-setting-row",children:[d.jsxs("div",{className:"modern-setting-info",children:[d.jsx("div",{className:"modern-setting-label",children:"Auto-sync on startup"}),d.jsx("div",{className:"modern-setting-desc",children:"Automatically sync when app opens"})]}),d.jsx(q,{id:"auto-sync",checked:j.autoSyncOnStart,onChange:Y})]})]}),d.jsxs(M,{title:"Data & Backup",icon:"💾",sectionKey:"data",children:[d.jsxs("div",{className:"modern-subsection",children:[d.jsx("div",{className:"modern-subsection-title",children:"Import & Export"}),d.jsx("input",{type:"file",ref:he,accept:".xlsx,.xls,.csv",onChange:oe,style:{display:"none"}}),d.jsxs("button",{className:"modern-action-button",onClick:()=>he.current?.click(),children:[d.jsx("span",{className:"modern-button-icon",children:"📊"}),d.jsx("span",{className:"modern-button-text",children:"Import Excel/CSV"})]}),m&&d.jsxs("button",{onClick:()=>{rL(m,p),K(!1)},className:"modern-action-button primary",children:[d.jsx("span",{className:"modern-button-icon",children:"💾"}),d.jsx("span",{className:"modern-button-text",children:"Backup All Data"})]})]}),d.jsxs("div",{className:"modern-subsection",children:[d.jsx("div",{className:"modern-subsection-title",children:"Backup Management"}),d.jsx("input",{type:"file",ref:le,accept:"application/json",onChange:se=>{y&&(y(se),K(!1))},style:{display:"none"}}),d.jsxs("button",{className:"modern-action-button",onClick:()=>le.current?.click(),children:[d.jsx("span",{className:"modern-button-icon",children:"📂"}),d.jsx("span",{className:"modern-button-text",children:"Restore from Backup"})]}),S&&d.jsxs("button",{className:"modern-action-button",onClick:()=>{S(),K(!1)},children:[d.jsx("span",{className:"modern-button-icon",children:"💾"}),d.jsx("span",{className:"modern-button-text",children:"Local Backup Manager"})]}),A&&w&&d.jsxs("button",{className:"modern-action-button",onClick:()=>{w(),K(!1)},children:[d.jsx("span",{className:"modern-button-icon",children:"☁️"}),d.jsx("span",{className:"modern-button-text",children:"Cloud Backups (Last 7 Days)"})]}),!A&&P&&d.jsxs("button",{className:"modern-action-button",onClick:()=>{P(),K(!1)},children:[d.jsx("span",{className:"modern-button-icon",children:"🔗"}),d.jsx("span",{className:"modern-button-text",children:"Connect Cloud Storage"})]}),d.jsxs("div",{className:"modern-setting-row",children:[d.jsxs("div",{className:"modern-setting-info",children:[d.jsx("div",{className:"modern-setting-label",children:"Auto-backup on end of day"}),d.jsx("div",{className:"modern-setting-desc",children:"Automatic backup when finishing your day"})]}),d.jsx(q,{id:"backup-toggle",checked:j.backupOnEndOfDay,onChange:H})]})]}),_&&d.jsxs("div",{className:"modern-subsection",children:[d.jsx("div",{className:"modern-subsection-title",children:"Cloud Sync"}),d.jsxs("button",{className:"modern-action-button",onClick:()=>{_(),K(!1)},disabled:T,children:[d.jsx("span",{className:"modern-button-icon",children:T?"⟳":"🔄"}),d.jsx("span",{className:"modern-button-text",children:T?"Syncing...":"Sync Now"})]})]})]}),d.jsx(M,{title:"Reminders & SMS",icon:"🔔",sectionKey:"reminders",children:d.jsxs("button",{className:"modern-feature-button",onClick:()=>{D(!0),K(!1)},children:[d.jsxs("div",{className:"modern-feature-content",children:[d.jsx("div",{className:"modern-feature-title",children:"Reminder Settings"}),d.jsx("div",{className:"modern-feature-desc",children:"Configure message templates, scheduling, and reminder preferences"})]}),d.jsx("span",{className:"modern-feature-arrow",children:"→"})]})}),d.jsx(M,{title:"Earnings & Bonus",icon:"💰",sectionKey:"earnings",children:d.jsxs("button",{className:"modern-feature-button",onClick:()=>{console.log("Bonus settings button clicked"),console.log("bonusSettings:",n),console.log("onUpdateBonusSettings:",a),console.log("typeof bonusSettings:",typeof n),console.log("typeof onUpdateBonusSettings:",typeof a),re(!0),K(!1)},children:[d.jsxs("div",{className:"modern-feature-content",children:[d.jsx("div",{className:"modern-feature-title",children:"Bonus Calculation Settings"}),d.jsx("div",{className:"modern-feature-desc",children:"Configure your bonus calculation formula, thresholds, and case counting"})]}),d.jsx("span",{className:"modern-feature-arrow",children:"→"})]})}),d.jsxs(M,{title:"Privacy & Safety",icon:"🔒",sectionKey:"privacy",children:[d.jsxs("div",{className:"modern-setting-row",children:[d.jsxs("div",{className:"modern-setting-info",children:[d.jsx("div",{className:"modern-setting-label",children:"Confirm before deleting"}),d.jsx("div",{className:"modern-setting-desc",children:"Ask for confirmation on deletions"})]}),d.jsx(q,{id:"confirm-delete",checked:j.confirmBeforeDelete,onChange:F})]}),d.jsxs("div",{className:"modern-setting-column",children:[d.jsx("label",{htmlFor:"data-retention",className:"modern-setting-label",children:"Data Retention Period"}),d.jsxs("select",{id:"data-retention",className:"modern-select",value:j.keepDataForMonths,onChange:se=>U(Number(se.target.value)),children:[d.jsx("option",{value:3,children:"3 months"}),d.jsx("option",{value:6,children:"6 months"}),d.jsx("option",{value:12,children:"1 year"}),d.jsx("option",{value:0,children:"Forever"})]}),d.jsx("p",{className:"modern-setting-desc",children:"Automatically removes old data once per day"})]}),pe&&d.jsxs("div",{className:"modern-storage-card",children:[d.jsxs("div",{className:"modern-storage-header",children:[d.jsx("span",{className:"modern-storage-label",children:"Storage Usage"}),d.jsxs("span",{className:"modern-storage-value",children:[pe.usedMB," / ",pe.quotaMB," MB"]})]}),d.jsx("div",{className:"modern-storage-bar",children:d.jsx("div",{className:`modern-storage-fill ${pe.percentage>80?"warning":""}`,style:{width:`${pe.percentage}%`}})}),d.jsxs("div",{className:"modern-storage-percent",children:[pe.percentage,"% used"]})]}),d.jsxs("button",{onClick:async()=>{await nL(),ue(null),setTimeout(()=>ly().then(ue),500)},className:"modern-action-button",children:[d.jsx("span",{className:"modern-button-icon",children:"🗑️"}),d.jsx("span",{className:"modern-button-text",children:"Clear Cache & Temporary Data"})]}),d.jsxs("div",{className:"modern-link-group",children:[d.jsxs("a",{href:"/PRIVACY.md",target:"_blank",rel:"noopener noreferrer",className:"modern-link-button",children:[d.jsx("span",{className:"modern-button-icon",children:"🔒"}),d.jsx("span",{className:"modern-button-text",children:"Privacy Policy"})]}),d.jsxs("a",{href:"/TERMS_OF_USE.md",target:"_blank",rel:"noopener noreferrer",className:"modern-link-button",children:[d.jsx("span",{className:"modern-button-icon",children:"📄"}),d.jsx("span",{className:"modern-button-text",children:"Terms of Use"})]})]})]}),d.jsxs(M,{title:"Account",icon:"👤",sectionKey:"account",children:[d.jsxs("div",{className:"modern-subsection",children:[d.jsx("div",{className:"modern-subsection-title",children:"Account Settings"}),E&&d.jsxs("button",{className:"modern-action-button accent",onClick:()=>{E(),K(!1)},children:[d.jsx("span",{className:"modern-button-icon",children:"⭐"}),d.jsx("span",{className:"modern-button-text",children:"Subscription"})]}),s&&d.jsxs("button",{className:"modern-action-button",onClick:()=>{s(),K(!1)},children:[d.jsx("span",{className:"modern-button-icon",children:"🔑"}),d.jsx("span",{className:"modern-button-text",children:"Change Password"})]}),l&&d.jsxs("button",{className:"modern-action-button",onClick:()=>{l(),K(!1)},children:[d.jsx("span",{className:"modern-button-icon",children:"📧"}),d.jsx("span",{className:"modern-button-text",children:"Change Email"})]}),I&&d.jsxs("button",{className:"modern-action-button",onClick:()=>{I(),K(!1)},children:[d.jsx("span",{className:"modern-button-icon",children:"🚪"}),d.jsx("span",{className:"modern-button-text",children:"Sign Out"})]})]}),u&&d.jsxs("div",{className:"modern-subsection modern-danger-zone",children:[d.jsxs("div",{className:"modern-danger-zone-header",children:[d.jsx("span",{className:"modern-danger-icon",children:"⚠️"}),d.jsxs("div",{children:[d.jsx("div",{className:"modern-subsection-title danger",children:"Danger Zone"}),d.jsx("div",{className:"modern-danger-desc",children:"Irreversible actions"})]})]}),d.jsxs("button",{className:"modern-action-button danger-full",onClick:()=>{u(),K(!1)},children:[d.jsx("span",{className:"modern-button-icon",children:"🗑️"}),d.jsx("span",{className:"modern-button-text",children:"Delete Account Permanently"})]})]})]})]}),d.jsx("div",{className:"modern-panel-footer",children:d.jsxs("div",{className:"modern-footer-text",children:["Settings sync across devices • Version ",iL.version]})})]}),W&&d.jsx(eL,{settings:t||tl,onUpdateSettings:se=>{r&&r(se),D(!1)},onClose:()=>D(!1)}),ee&&n&&a&&d.jsx(tL,{settings:n,onUpdateSettings:se=>{a(se),re(!1)},onClose:()=>re(!1)}),d.jsx("style",{children:`
        /* Modern Settings Dropdown - Complete Redesign */
        .modern-settings-dropdown {
          position: relative;
          display: inline-block;
        }

        /* Trigger Button */
        .modern-settings-trigger {
          display: flex;
          align-items: center;
          gap: 0.625rem;
          padding: 0.75rem 1.25rem;
          background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
          border: 1.5px solid rgba(99, 102, 241, 0.12);
          border-radius: 12px;
          color: #1f2937;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .modern-settings-trigger:hover {
          background: linear-gradient(135deg, #ffffff 0%, #f0f1ff 100%);
          border-color: rgba(99, 102, 241, 0.3);
          box-shadow: 0 4px 16px rgba(99, 102, 241, 0.15);
          transform: translateY(-1px);
        }

        .modern-trigger-icon {
          font-size: 1.25rem;
        }

        /* Main Panel */
        .modern-settings-panel {
          position: absolute;
          top: calc(100% + 12px);
          right: 0;
          z-index: 999999;
          width: 440px;
          max-height: 85vh;
          background: linear-gradient(135deg, #ffffff 0%, #fafbff 100%);
          border: 1px solid rgba(99, 102, 241, 0.08);
          border-radius: 20px;
          box-shadow:
            0 24px 64px rgba(0, 0, 0, 0.12),
            0 12px 32px rgba(99, 102, 241, 0.08),
            0 0 0 1px rgba(99, 102, 241, 0.05);
          overflow: hidden;
          display: flex;
          flex-direction: column;
          animation: modernSlideIn 0.35s cubic-bezier(0.4, 0, 0.2, 1);
          backdrop-filter: blur(8px);
        }

        @keyframes modernSlideIn {
          from {
            opacity: 0;
            transform: translateY(-16px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        /* Panel Header */
        .modern-panel-header {
          display: flex;
          align-items: flex-start;
          justify-content: space-between;
          padding: 1.75rem 1.75rem 1.25rem;
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.03) 100%);
          border-bottom: 1px solid rgba(99, 102, 241, 0.08);
        }

        .modern-header-content {
          flex: 1;
        }

        .modern-panel-title {
          font-size: 1.5rem;
          font-weight: 700;
          color: #111827;
          margin: 0 0 0.375rem 0;
          letter-spacing: -0.03em;
        }

        .modern-panel-subtitle {
          font-size: 0.875rem;
          color: #6b7280;
          margin: 0;
        }

        .modern-close-button {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 32px;
          height: 32px;
          background: white;
          border: 1px solid rgba(0, 0, 0, 0.08);
          border-radius: 8px;
          color: #6b7280;
          font-size: 1.125rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modern-close-button:hover {
          background: #f9fafb;
          border-color: #ef4444;
          color: #ef4444;
          transform: scale(1.05);
        }

        /* Panel Body */
        .modern-panel-body {
          flex: 1;
          overflow-y: auto;
          padding: 0.5rem 0.75rem 1rem;
        }

        .modern-panel-body::-webkit-scrollbar {
          width: 6px;
        }

        .modern-panel-body::-webkit-scrollbar-track {
          background: transparent;
        }

        .modern-panel-body::-webkit-scrollbar-thumb {
          background: rgba(99, 102, 241, 0.2);
          border-radius: 3px;
        }

        .modern-panel-body::-webkit-scrollbar-thumb:hover {
          background: rgba(99, 102, 241, 0.3);
        }

        /* Collapsible Sections */
        .modern-settings-section-container {
          margin: 0.5rem 0.5rem;
          background: white;
          border: 1.5px solid rgba(99, 102, 241, 0.08);
          border-radius: 14px;
          overflow: hidden;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-settings-section-container:hover {
          border-color: rgba(99, 102, 241, 0.15);
          box-shadow: 0 4px 12px rgba(99, 102, 241, 0.06);
        }

        .modern-section-header {
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1rem 1.25rem;
          background: transparent;
          border: none;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modern-section-header:hover {
          background: rgba(99, 102, 241, 0.03);
        }

        .modern-section-title-area {
          display: flex;
          align-items: center;
          gap: 0.875rem;
        }

        .modern-section-icon {
          font-size: 1.375rem;
        }

        .modern-section-title {
          font-size: 1rem;
          font-weight: 600;
          color: #111827;
          letter-spacing: -0.01em;
        }

        .modern-section-chevron {
          font-size: 1.5rem;
          color: #9ca3af;
          transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-section-chevron.expanded {
          transform: rotate(90deg);
          color: #6366f1;
        }

        .modern-section-content {
          max-height: 0;
          overflow: hidden;
          transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-section-content.expanded {
          max-height: 2000px;
        }

        .modern-section-inner {
          padding: 0 1.25rem 1.25rem;
        }

        /* Subsections */
        .modern-subsection {
          margin-bottom: 1.5rem;
        }

        .modern-subsection:last-child {
          margin-bottom: 0;
        }

        .modern-subsection-title {
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.075em;
          color: #6366f1;
          margin-bottom: 0.75rem;
        }

        .modern-subsection-title.danger {
          color: #dc2626;
        }

        /* Danger Zone Styles */
        .modern-danger-zone {
          margin-top: 1.5rem;
          padding: 1.25rem;
          background: linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, rgba(220, 38, 38, 0.08) 100%);
          border: 2px solid rgba(239, 68, 68, 0.25);
          border-radius: 12px;
        }

        .modern-danger-zone-header {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          margin-bottom: 1rem;
        }

        .modern-danger-icon {
          font-size: 1.75rem;
          flex-shrink: 0;
        }

        .modern-danger-desc {
          font-size: 0.8125rem;
          color: #dc2626;
          margin-top: 0.25rem;
          font-weight: 500;
        }

        /* Setting Rows */
        .modern-setting-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          padding: 0.875rem 0;
          border-bottom: 1px solid rgba(0, 0, 0, 0.04);
        }

        .modern-setting-row:last-child {
          border-bottom: none;
        }

        .modern-setting-column {
          padding: 0.875rem 0;
          border-bottom: 1px solid rgba(0, 0, 0, 0.04);
        }

        .modern-setting-column:last-child {
          border-bottom: none;
        }

        .modern-setting-info {
          flex: 1;
        }

        .modern-setting-label {
          font-size: 0.9375rem;
          font-weight: 600;
          color: #374151;
          margin-bottom: 0.25rem;
          display: block;
        }

        .modern-setting-desc {
          font-size: 0.8125rem;
          color: #9ca3af;
          line-height: 1.4;
          margin-top: 0.25rem;
        }

        /* Toggle Switch */
        .modern-toggle-switch {
          position: relative;
          width: 52px;
          height: 28px;
          cursor: pointer;
          flex-shrink: 0;
        }

        .modern-toggle-input {
          opacity: 0;
          width: 0;
          height: 0;
        }

        .modern-toggle-slider {
          position: absolute;
          inset: 0;
          background: #e5e7eb;
          border-radius: 28px;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-toggle-slider.checked {
          background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        }

        .modern-toggle-thumb {
          position: absolute;
          height: 24px;
          width: 24px;
          left: 2px;
          bottom: 2px;
          background: white;
          border-radius: 50%;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .modern-toggle-slider.checked .modern-toggle-thumb {
          transform: translateX(24px);
          box-shadow: 0 3px 12px rgba(99, 102, 241, 0.4);
        }

        /* Select Dropdown */
        .modern-select {
          width: 100%;
          padding: 0.75rem 1rem;
          margin-top: 0.5rem;
          background: white;
          border: 1.5px solid rgba(0, 0, 0, 0.1);
          border-radius: 10px;
          font-size: 0.9375rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modern-select:hover {
          border-color: rgba(99, 102, 241, 0.3);
        }

        .modern-select:focus {
          outline: none;
          border-color: #6366f1;
          box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* Action Buttons */
        .modern-action-button {
          width: 100%;
          display: flex;
          align-items: center;
          gap: 0.875rem;
          padding: 0.875rem 1rem;
          margin-bottom: 0.625rem;
          background: white;
          border: 1.5px solid rgba(0, 0, 0, 0.08);
          border-radius: 10px;
          font-size: 0.9375rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
          transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-action-button:last-child {
          margin-bottom: 0;
        }

        .modern-action-button:hover {
          background: #f9fafb;
          border-color: rgba(99, 102, 241, 0.3);
          transform: translateX(2px);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        }

        .modern-action-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
          transform: none;
        }

        .modern-action-button.primary {
          background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
          border-color: transparent;
          color: white;
          font-weight: 600;
        }

        .modern-action-button.primary:hover {
          box-shadow: 0 8px 24px rgba(99, 102, 241, 0.35);
          transform: translateY(-1px);
        }

        .modern-action-button.accent {
          background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(251, 191, 36, 0.1) 100%);
          border-color: rgba(245, 158, 11, 0.3);
          color: #b45309;
        }

        .modern-action-button.accent:hover {
          background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(251, 191, 36, 0.15) 100%);
          border-color: rgba(245, 158, 11, 0.5);
        }

        .modern-action-button.danger {
          background: rgba(239, 68, 68, 0.06);
          border-color: rgba(239, 68, 68, 0.2);
          color: #dc2626;
        }

        .modern-action-button.danger:hover {
          background: rgba(239, 68, 68, 0.12);
          border-color: rgba(239, 68, 68, 0.4);
        }

        .modern-action-button.danger-full {
          background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
          border: 2px solid #991b1b;
          color: white;
          font-weight: 600;
          box-shadow: 0 4px 12px rgba(220, 38, 38, 0.25);
        }

        .modern-action-button.danger-full:hover {
          background: linear-gradient(135deg, #b91c1c 0%, #991b1b 100%);
          border-color: #7f1d1d;
          box-shadow: 0 6px 20px rgba(220, 38, 38, 0.4);
          transform: translateY(-1px);
        }

        .modern-action-button.small {
          padding: 0.75rem 0.875rem;
          font-size: 0.875rem;
        }

        .modern-button-icon {
          font-size: 1.125rem;
          flex-shrink: 0;
        }

        .modern-button-text {
          flex: 1;
          text-align: left;
        }

        /* Button Groups */
        .modern-button-group {
          display: flex;
          gap: 0.625rem;
        }

        .modern-button-group .modern-action-button {
          flex: 1;
        }

        /* Link Buttons */
        .modern-link-group {
          display: flex;
          gap: 0.625rem;
          margin-top: 0.625rem;
        }

        .modern-link-button {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem 0.875rem;
          background: white;
          border: 1.5px solid rgba(0, 0, 0, 0.08);
          border-radius: 10px;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
          text-decoration: none;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modern-link-button:hover {
          background: #f9fafb;
          border-color: rgba(99, 102, 241, 0.3);
          transform: translateY(-1px);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        }

        /* Storage Card */
        .modern-storage-card {
          padding: 1rem;
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.03) 100%);
          border: 1.5px solid rgba(99, 102, 241, 0.15);
          border-radius: 12px;
          margin: 0.875rem 0;
        }

        .modern-storage-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 0.625rem;
        }

        .modern-storage-label {
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          color: #6366f1;
        }

        .modern-storage-value {
          font-size: 0.875rem;
          font-weight: 600;
          color: #111827;
        }

        .modern-storage-bar {
          height: 8px;
          background: rgba(0, 0, 0, 0.06);
          border-radius: 8px;
          overflow: hidden;
          margin-bottom: 0.5rem;
        }

        .modern-storage-fill {
          height: 100%;
          background: linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%);
          border-radius: 8px;
          transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-storage-fill.warning {
          background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
        }

        .modern-storage-percent {
          font-size: 0.8125rem;
          color: #6b7280;
          text-align: right;
        }

        /* Feature Button (for SMS Settings) */
        .modern-feature-button {
          width: 100%;
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1.125rem 1.25rem;
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.03) 100%);
          border: 1.5px solid rgba(99, 102, 241, 0.15);
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-feature-button:hover {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.08) 100%);
          border-color: rgba(99, 102, 241, 0.3);
          transform: translateX(2px);
          box-shadow: 0 4px 16px rgba(99, 102, 241, 0.12);
        }

        .modern-feature-content {
          flex: 1;
        }

        .modern-feature-title {
          font-size: 1rem;
          font-weight: 600;
          color: #111827;
          margin-bottom: 0.25rem;
        }

        .modern-feature-desc {
          font-size: 0.8125rem;
          color: #6b7280;
          line-height: 1.4;
        }

        .modern-feature-arrow {
          font-size: 1.25rem;
          color: #9ca3af;
          transition: transform 0.2s;
        }

        .modern-feature-button:hover .modern-feature-arrow {
          transform: translateX(4px);
          color: #6366f1;
        }

        /* Panel Footer */
        .modern-panel-footer {
          padding: 1rem 1.75rem;
          background: rgba(99, 102, 241, 0.02);
          border-top: 1px solid rgba(99, 102, 241, 0.08);
        }

        .modern-footer-text {
          font-size: 0.75rem;
          color: #9ca3af;
          text-align: center;
          line-height: 1.5;
        }

        /* Dark Mode Support */
        .dark-mode .modern-settings-trigger {
          background: linear-gradient(135deg, rgba(31, 41, 55, 0.95) 0%, rgba(17, 24, 39, 1) 100%);
          border-color: rgba(139, 92, 246, 0.2);
          color: #e5e7eb;
        }

        .dark-mode .modern-settings-trigger:hover {
          background: linear-gradient(135deg, rgba(31, 41, 55, 1) 0%, rgba(17, 24, 39, 1) 100%);
          border-color: rgba(139, 92, 246, 0.4);
        }

        .dark-mode .modern-settings-panel {
          background: linear-gradient(135deg, rgba(17, 24, 39, 0.98) 0%, rgba(31, 41, 55, 0.98) 100%);
          border-color: rgba(139, 92, 246, 0.15);
        }

        .dark-mode .modern-panel-header {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(139, 92, 246, 0.05) 100%);
          border-bottom-color: rgba(139, 92, 246, 0.15);
        }

        .dark-mode .modern-panel-title,
        .dark-mode .modern-section-title,
        .dark-mode .modern-setting-label,
        .dark-mode .modern-feature-title,
        .dark-mode .modern-storage-value {
          color: #f9fafb;
        }

        .dark-mode .modern-panel-subtitle,
        .dark-mode .modern-setting-desc,
        .dark-mode .modern-feature-desc,
        .dark-mode .modern-footer-text {
          color: #9ca3af;
        }

        .dark-mode .modern-settings-section-container {
          background: rgba(17, 24, 39, 0.6);
          border-color: rgba(139, 92, 246, 0.15);
        }

        .dark-mode .modern-section-header:hover {
          background: rgba(99, 102, 241, 0.05);
        }

        .dark-mode .modern-setting-row,
        .dark-mode .modern-setting-column {
          border-bottom-color: rgba(255, 255, 255, 0.06);
        }

        .dark-mode .modern-action-button,
        .dark-mode .modern-link-button {
          background: rgba(17, 24, 39, 0.8);
          border-color: rgba(255, 255, 255, 0.1);
          color: #e5e7eb;
        }

        .dark-mode .modern-action-button:hover,
        .dark-mode .modern-link-button:hover {
          background: rgba(17, 24, 39, 0.95);
          border-color: rgba(139, 92, 246, 0.4);
        }

        .dark-mode .modern-select {
          background: rgba(17, 24, 39, 0.8);
          border-color: rgba(255, 255, 255, 0.1);
          color: #e5e7eb;
        }

        .dark-mode .modern-storage-card {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.08) 100%);
          border-color: rgba(99, 102, 241, 0.25);
        }

        .dark-mode .modern-storage-bar {
          background: rgba(0, 0, 0, 0.3);
        }

        .dark-mode .modern-feature-button {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.08) 100%);
          border-color: rgba(99, 102, 241, 0.25);
        }

        .dark-mode .modern-feature-button:hover {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(139, 92, 246, 0.12) 100%);
          border-color: rgba(99, 102, 241, 0.4);
        }

        .dark-mode .modern-close-button {
          background: rgba(17, 24, 39, 0.8);
          border-color: rgba(255, 255, 255, 0.1);
          color: #9ca3af;
        }

        .dark-mode .modern-close-button:hover {
          background: rgba(239, 68, 68, 0.1);
          border-color: #ef4444;
          color: #ef4444;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .modern-settings-dropdown {
            position: static;
          }

          .modern-settings-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            right: auto;
            bottom: auto;
            transform: translate(-50%, -50%);
            width: calc(100vw - 2rem);
            max-width: 420px;
            max-height: 85vh;
            z-index: 999999;
          }

          @keyframes modernSlideIn {
            from {
              opacity: 0;
              transform: translate(-50%, -50%) scale(0.92);
            }
            to {
              opacity: 1;
              transform: translate(-50%, -50%) scale(1);
            }
          }

          .modern-panel-header {
            padding: 1.5rem 1.25rem 1rem;
          }

          .modern-panel-title {
            font-size: 1.375rem;
          }

          .modern-section-inner {
            padding: 0 1rem 1rem;
          }

          .modern-settings-trigger {
            padding: 0.625rem 1rem;
            font-size: 0.875rem;
          }

          .modern-trigger-icon {
            font-size: 1.125rem;
          }
        }

        /* Mobile Overlay */
        @media (max-width: 768px) {
          .modern-settings-panel::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: -1;
            animation: fadeIn 0.3s ease-out;
          }

          @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
          }
        }
      `})]})},oL=()=>{const[e,t]=rr.useState([]);return rr.useEffect(()=>Mu.subscribe(t),[]),e.length===0?null:d.jsxs("div",{className:"toast-container",children:[e.map(r=>d.jsx("div",{className:`toast toast-${r.type}`,onClick:()=>Mu.remove(r.id),children:d.jsxs("div",{className:"toast-content",children:[d.jsxs("span",{className:"toast-icon",children:[r.type==="success"&&"✅",r.type==="error"&&"❌",r.type==="warning"&&"⚠️",r.type==="info"&&"ℹ️"]}),d.jsx("span",{className:"toast-message",children:r.message})]})},r.id)),d.jsx("style",{children:`
        .toast-container {
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 9999;
          display: flex;
          flex-direction: column;
          gap: 8px;
          pointer-events: none;
        }

        .toast {
          pointer-events: auto;
          background: var(--card-bg, white);
          color: var(--text-primary, #374151);
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          border-left: 4px solid;
          min-width: 300px;
          max-width: 400px;
          padding: 12px 16px;
          cursor: pointer;
          transition: all 0.3s ease;
          animation: slideIn 0.3s ease-out;
        }

        .toast:hover {
          transform: translateY(-2px);
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .toast-success {
          border-left-color: #22c55e;
          background: #f0fdf4;
        }

        .toast-error {
          border-left-color: #ef4444;
          background: #fef2f2;
        }

        .toast-warning {
          border-left-color: #f59e0b;
          background: #fffbeb;
        }

        .toast-info {
          border-left-color: #3b82f6;
          background: #eff6ff;
        }

        .toast-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .toast-icon {
          font-size: 16px;
        }

        .toast-message {
          color: inherit;
          font-weight: 500;
          flex: 1;
          line-height: 1.4;
        }

        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateX(100%);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }

        @media (max-width: 768px) {
          .toast-container {
            top: 10px;
            right: 10px;
            left: 10px;
          }

          .toast {
            min-width: auto;
            max-width: none;
          }
        }
      `})]})},Im="navigator_privacy_consent",cy="v1.0_2025-01-06",lL=({onAccept:e})=>{const[t,r]=J.useState(!1),[n,a]=J.useState(!1);J.useEffect(()=>{const u=localStorage.getItem(Im);(!u||u!==cy)&&r(!0)},[]);const s=()=>{localStorage.setItem(Im,cy),r(!1),e&&e()},l=()=>{window.confirm(`You can still use Navigator Web in offline mode (no cloud sync).

To use cloud sync and multi-device features, you must accept our privacy policy.

Click OK to use offline mode, or Cancel to review the privacy policy.`)&&(localStorage.setItem(Im,"offline_mode"),r(!1))};return t?d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1e5,backdropFilter:"blur(4px)"}}),d.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"white",borderTop:"3px solid var(--primary, #667eea)",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.15)",zIndex:100001,padding:"1.5rem",maxHeight:n?"80vh":"auto",overflowY:"auto"},children:d.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:n?d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[d.jsx("h3",{style:{margin:0,fontSize:"1.25rem",fontWeight:600,color:"#1a202c"},children:"Privacy & Cookie Policy"}),d.jsx("button",{onClick:()=>a(!1),style:{padding:"0.5rem",background:"transparent",border:"none",fontSize:"1.5rem",color:"#718096",cursor:"pointer",lineHeight:1},children:"✕"})]}),d.jsxs("div",{style:{background:"#f7fafc",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #e2e8f0"},children:[d.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#2d3748"},children:"What We Collect"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#4a5568",lineHeight:"1.6"},children:[d.jsx("li",{children:"Your email address (for authentication)"}),d.jsx("li",{children:"Work data you enter (addresses, completions, arrangements)"}),d.jsx("li",{children:"Device identifiers (for multi-device sync)"}),d.jsx("li",{children:"Technical data (login times, browser info)"})]})]}),d.jsxs("div",{style:{background:"#f7fafc",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #e2e8f0"},children:[d.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#2d3748"},children:"How We Use It"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#4a5568",lineHeight:"1.6"},children:[d.jsx("li",{children:"Authenticate your account"}),d.jsx("li",{children:"Sync data across your devices"}),d.jsx("li",{children:"Provide route planning and geocoding"}),d.jsx("li",{children:"Enable backup and restore"})]}),d.jsx("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.875rem",color:"#718096",fontStyle:"italic"},children:"We do NOT analyze, share, or sell your data."})]}),d.jsxs("div",{style:{background:"#fff5f5",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #feb2b2"},children:[d.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#c53030"},children:"⚠️ Your GDPR Responsibilities"}),d.jsxs("p",{style:{margin:0,fontSize:"0.875rem",color:"#742a2a",lineHeight:"1.6"},children:[d.jsx("strong",{children:"YOU are the Data Controller"})," for customer/debtor data you process. You must have lawful authority and comply with GDPR/UK DPA 2018. We are only the Data Processor providing infrastructure."]})]}),d.jsxs("div",{style:{background:"#f0fff4",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #9ae6b4"},children:[d.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#22543d"},children:"✅ Your Rights"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#276749",lineHeight:"1.6"},children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Access:"})," Export all data (Settings → Export Data)"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Delete:"})," Remove account permanently (Settings → Delete Account)"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Rectify:"})," Edit any data directly in the app"]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Portability:"})," Download in JSON/CSV format"]})]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"1px solid #e2e8f0"},children:[d.jsx("button",{onClick:l,style:{flex:1,padding:"0.75rem 1.5rem",background:"#e2e8f0",border:"none",borderRadius:"6px",color:"#2d3748",fontSize:"0.9375rem",fontWeight:500,cursor:"pointer"},children:"Decline (Offline Mode)"}),d.jsx("button",{onClick:s,style:{flex:1,padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",color:"white",fontSize:"0.9375rem",fontWeight:600,cursor:"pointer",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)"},children:"Accept & Continue"})]}),d.jsxs("p",{style:{margin:"1rem 0 0 0",fontSize:"0.75rem",color:"#718096",textAlign:"center"},children:["Read full"," ",d.jsx("a",{href:"/PRIVACY.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Privacy Policy"})," ","and"," ",d.jsx("a",{href:"/TERMS_OF_USE.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Terms of Use"})]})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"1.5rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"300px"},children:[d.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1.125rem",fontWeight:600,color:"#1a202c"},children:"🔒 Privacy & Data Protection"}),d.jsxs("p",{style:{margin:0,fontSize:"0.875rem",lineHeight:"1.5",color:"#4a5568"},children:["We use cookies and cloud storage to sync your work data across devices. We are a ",d.jsx("strong",{children:"data processor"})," - you remain the ",d.jsx("strong",{children:"data controller"})," for any customer data you process."]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",flexWrap:"wrap"},children:[d.jsx("button",{onClick:()=>a(!0),style:{padding:"0.625rem 1.25rem",background:"transparent",border:"1px solid #cbd5e0",borderRadius:"6px",color:"#4a5568",fontSize:"0.875rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:u=>{u.currentTarget.style.background="#f7fafc",u.currentTarget.style.borderColor="#a0aec0"},onMouseLeave:u=>{u.currentTarget.style.background="transparent",u.currentTarget.style.borderColor="#cbd5e0"},children:"Learn More"}),d.jsx("button",{onClick:l,style:{padding:"0.625rem 1.25rem",background:"#e2e8f0",border:"none",borderRadius:"6px",color:"#2d3748",fontSize:"0.875rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:u=>{u.currentTarget.style.background="#cbd5e0"},onMouseLeave:u=>{u.currentTarget.style.background="#e2e8f0"},children:"Decline"}),d.jsx("button",{onClick:s,style:{padding:"0.625rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",color:"white",fontSize:"0.875rem",fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)"},onMouseEnter:u=>{u.currentTarget.style.transform="translateY(-1px)",u.currentTarget.style.boxShadow="0 4px 8px rgba(102, 126, 234, 0.4)"},onMouseLeave:u=>{u.currentTarget.style.transform="translateY(0)",u.currentTarget.style.boxShadow="0 2px 4px rgba(102, 126, 234, 0.3)"},children:"Accept & Continue"})]})]}),d.jsxs("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e2e8f0",fontSize:"0.75rem",color:"#718096"},children:['By clicking "Accept", you agree to our'," ",d.jsx("a",{href:"/PRIVACY.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Privacy Policy"})," ","and"," ",d.jsx("a",{href:"/TERMS_OF_USE.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Terms of Use"}),". This app is for professional enforcement use only."]})]})})}),d.jsx("style",{children:`
        @media (max-width: 768px) {
          .privacy-consent-banner {
            padding: 1rem !important;
          }
        }
      `})]}):null};class cL{deferredPrompt=null;serviceWorkerRegistration=null;constructor(){this.init()}async init(){await this.requestPersistentStorage(),this.setupInstallPrompt(),this.setupServiceWorkerUpdates(),this.setupServiceWorkerMessages()}async requestPersistentStorage(){if(!navigator.storage||!navigator.storage.persist)return ve.warn("Persistent storage not supported"),!1;try{return await navigator.storage.persisted()?(ve.info("✅ Storage is already persistent"),!0):await navigator.storage.persist()?(ve.info("✅ Persistent storage granted"),localStorage.setItem("navigator_persistent_storage","true"),!0):(ve.warn("⚠️ Persistent storage denied - data may be evicted under storage pressure"),!1)}catch(t){return ve.error("Failed to request persistent storage:",t),!1}}async getStorageQuota(){if(!navigator.storage||!navigator.storage.estimate)return null;try{const t=await navigator.storage.estimate(),r=t.usage||0,n=t.quota||0,a=n>0?Math.round(r/n*100):0;return{usage:r,quota:n,percentage:a}}catch(t){return ve.error("Failed to get storage quota:",t),null}}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),this.deferredPrompt=t,ve.info("📲 PWA install prompt available"),window.dispatchEvent(new CustomEvent("pwa-installable")),localStorage.setItem("navigator_pwa_installable","true")}),window.addEventListener("appinstalled",()=>{ve.info("✅ PWA installed successfully"),this.deferredPrompt=null,localStorage.setItem("navigator_pwa_installed","true"),localStorage.removeItem("navigator_pwa_installable"),window.dispatchEvent(new CustomEvent("pwa-installed"))})}async showInstallPrompt(){if(!this.deferredPrompt)return ve.warn("Install prompt not available"),"unavailable";try{await this.deferredPrompt.prompt();const t=await this.deferredPrompt.userChoice;return ve.info("User install choice:",t.outcome),this.deferredPrompt=null,t.outcome}catch(t){return ve.error("Install prompt failed:",t),"dismissed"}}isInstallable(){return this.deferredPrompt!==null}isInstalled(){return!!(window.matchMedia("(display-mode: standalone)").matches||localStorage.getItem("navigator_pwa_installed")==="true"||navigator.standalone===!0)}async setupServiceWorkerUpdates(){if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.ready;this.serviceWorkerRegistration=t,setInterval(()=>{t.update()},3600*1e3),t.addEventListener("updatefound",()=>{const r=t.installing;r&&r.addEventListener("statechange",()=>{r.state==="installed"&&navigator.serviceWorker.controller&&(ve.info("🔄 New service worker available"),window.dispatchEvent(new CustomEvent("pwa-update-available")))})}),ve.info("✅ Service worker updates configured")}catch(t){ve.error("Failed to setup service worker updates:",t)}}async updateServiceWorker(){if(!this.serviceWorkerRegistration)return;const t=this.serviceWorkerRegistration.waiting;t&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())}setupServiceWorkerMessages(){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{ve.info("[PWA] Message from service worker:",t.data),t.data.type==="BACKGROUND_SYNC_START"?window.dispatchEvent(new CustomEvent("background-sync-start",{detail:t.data})):t.data.type==="BACKGROUND_SYNC_COMPLETE"&&window.dispatchEvent(new CustomEvent("background-sync-complete",{detail:t.data}))})}async registerBackgroundSync(t="sync-data"){if(!this.serviceWorkerRegistration)return ve.warn("Service worker not registered"),!1;if(!("sync"in this.serviceWorkerRegistration))return ve.warn("Background sync not supported"),!1;try{return await this.serviceWorkerRegistration.sync.register(t),ve.info("✅ Background sync registered:",t),!0}catch(r){return ve.error("Background sync registration failed:",r),!1}}async preCacheUrls(t){return!this.serviceWorkerRegistration||!this.serviceWorkerRegistration.active?{success:!1,error:"Service worker not active"}:new Promise(r=>{const n=new MessageChannel;n.port1.onmessage=a=>{r(a.data)},this.serviceWorkerRegistration.active.postMessage({type:"CACHE_URLS",urls:t},[n.port2])})}async clearCaches(t){return!this.serviceWorkerRegistration||!this.serviceWorkerRegistration.active?!1:new Promise(r=>{const n=new MessageChannel;n.port1.onmessage=a=>{r(a.data.success)},this.serviceWorkerRegistration.active.postMessage({type:"CLEAR_CACHE",cacheName:t},[n.port2])})}async checkConnectivity(){if(!navigator.onLine)return!1;try{const t=window.location.pathname.startsWith("/navigator-web/")?"/navigator-web/manifest.webmanifest":"/manifest.webmanifest";return(await fetch(t,{method:"HEAD",cache:"no-cache"})).ok}catch{return navigator.onLine}}}const Lu=new cL,uL=({isOnline:e,isSyncing:t,lastSyncTime:r,onForceSync:n})=>{const[a,s]=J.useState(!1),[l,u]=J.useState("connected");J.useEffect(()=>{const _=async()=>{if(!e){u("disconnected");return}u("checking");const S=await Lu.checkConnectivity();u(S?"connected":"disconnected")};_();const T=setInterval(_,3e4);return()=>clearInterval(T)},[e]);const m=()=>!e||l==="disconnected"?"#ef4444":t?"#f59e0b":"#10b981",p=()=>!e||l==="disconnected"?"Offline":t?"Syncing":l==="checking"?"Checking":"Online",g=()=>!e||l==="disconnected"?"📡":t?"⟳":l==="checking"?"⏳":"✓",y=()=>{if(!r)return"Never synced";const T=Date.now()-r.getTime(),S=Math.floor(T/6e4),w=Math.floor(T/36e5),E=Math.floor(T/864e5);return E>0?`${E}d ago`:w>0?`${w}h ago`:S>0?`${S}m ago`:"Just now"};return d.jsxs("div",{style:{position:"relative"},children:[d.jsxs("button",{onClick:()=>s(!a),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.875rem",background:!e||l==="disconnected"?"linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.15))":"linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.15))",border:`1.5px solid ${m()}`,borderRadius:"10px",color:m(),fontSize:"0.875rem",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:_=>{_.currentTarget.style.transform="scale(1.05)"},onMouseLeave:_=>{_.currentTarget.style.transform="scale(1)"},children:[d.jsx("span",{style:{fontSize:"1rem"},children:g()}),d.jsx("span",{children:p()}),t&&d.jsx("div",{style:{width:"8px",height:"8px",background:m(),borderRadius:"50%",animation:"pulse 1.5s infinite"}})]}),a&&d.jsxs("div",{style:{position:"absolute",top:"calc(100% + 8px)",right:0,zIndex:9999,width:"280px",background:"white",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"12px",boxShadow:"0 12px 32px rgba(0, 0, 0, 0.15)",padding:"1rem",animation:"slideDown 0.2s ease-out"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid rgba(0, 0, 0, 0.08)"},children:[d.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600},children:"Connection Status"}),d.jsx("button",{onClick:()=>s(!1),style:{background:"none",border:"none",fontSize:"1.25rem",cursor:"pointer",color:"#9ca3af",padding:0,lineHeight:1},children:"✕"})]}),d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[d.jsx("div",{style:{width:"12px",height:"12px",background:m(),borderRadius:"50%",flexShrink:0}}),d.jsxs("div",{style:{flex:1},children:[d.jsx("div",{style:{fontSize:"0.9375rem",fontWeight:500,color:"#111827"},children:p()}),d.jsx("div",{style:{fontSize:"0.8125rem",color:"#6b7280",marginTop:"0.125rem"},children:!e||l==="disconnected"?"Working in offline mode":t?"Syncing your data...":"All changes synced"})]})]}),d.jsxs("div",{style:{fontSize:"0.8125rem",color:"#6b7280",padding:"0.5rem",background:"rgba(0, 0, 0, 0.02)",borderRadius:"6px"},children:["Last sync: ",d.jsx("strong",{style:{color:"#111827"},children:y()})]})]}),n&&e&&l==="connected"&&!t&&d.jsx("button",{onClick:()=>{n(),s(!1)},style:{width:"100%",padding:"0.75rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"0.875rem",fontWeight:600,cursor:"pointer",marginBottom:"0.75rem",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:_=>{_.currentTarget.style.transform="translateY(-2px)",_.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},onMouseLeave:_=>{_.currentTarget.style.transform="translateY(0)",_.currentTarget.style.boxShadow="none"},children:"🔄 Force Sync Now"}),(!e||l==="disconnected")&&d.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.05)",border:"1px solid rgba(239, 68, 68, 0.1)",borderRadius:"8px",fontSize:"0.8125rem",color:"#6b7280"},children:[d.jsx("div",{style:{fontWeight:600,color:"#ef4444",marginBottom:"0.25rem"},children:"📡 Offline Mode"}),d.jsxs("div",{children:["• All changes saved locally",d.jsx("br",{}),"• Will sync when connection returns",d.jsx("br",{}),"• Background sync enabled"]})]})]}),d.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-8px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]})},dL=()=>{const[e,t]=J.useState(!1),[r,n]=J.useState(!1);J.useEffect(()=>{if(Lu.isInstalled())return;const l=localStorage.getItem("navigator_pwa_prompt_dismissed");if(l){const p=parseInt(l);if((Date.now()-p)/(1e3*60*60*24)<7)return}const u=()=>{t(!0)},m=()=>{t(!1)};return window.addEventListener("pwa-installable",u),window.addEventListener("pwa-installed",m),Lu.isInstallable()&&t(!0),()=>{window.removeEventListener("pwa-installable",u),window.removeEventListener("pwa-installed",m)}},[]);const a=async()=>{n(!0);const l=await Lu.showInstallPrompt();l==="accepted"?t(!1):l==="dismissed"&&(localStorage.setItem("navigator_pwa_prompt_dismissed",Date.now().toString()),t(!1)),n(!1)},s=()=>{localStorage.setItem("navigator_pwa_prompt_dismissed",Date.now().toString()),t(!1)};return e?d.jsxs("div",{style:{position:"fixed",bottom:"1rem",left:"1rem",right:"1rem",zIndex:1e4,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"1.25rem",borderRadius:"16px",boxShadow:"0 12px 40px rgba(102, 126, 234, 0.4)",animation:"slideUp 0.4s ease-out",maxWidth:"500px",margin:"0 auto"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"start",gap:"1rem"},children:[d.jsx("div",{style:{fontSize:"2.5rem",flexShrink:0},children:"📱"}),d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.125rem",fontWeight:700},children:"Install Navigator App"}),d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.875rem",opacity:.95,lineHeight:1.5},children:"Get faster access, work offline, and receive reminders. Install now for the best experience!"}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{onClick:a,disabled:r,style:{flex:1,padding:"0.75rem 1.5rem",background:"white",color:"#667eea",border:"none",borderRadius:"10px",fontSize:"1rem",fontWeight:600,cursor:r?"wait":"pointer",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",transition:"transform 0.2s"},onMouseEnter:l=>{r||(l.target.style.transform="translateY(-2px)")},onMouseLeave:l=>{l.target.style.transform="translateY(0)"},children:r?"Installing...":"Install"}),d.jsx("button",{onClick:s,style:{padding:"0.75rem 1rem",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"none",borderRadius:"10px",fontSize:"0.9375rem",fontWeight:500,cursor:"pointer"},children:"Not now"})]})]})]}),d.jsx("style",{children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(100px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @media (max-width: 640px) {
          div[style*="position: fixed"][style*="bottom: 1rem"] {
            left: 0.5rem !important;
            right: 0.5rem !important;
          }
        }
      `})]}):null},Kf="navigator_last_cleanup",Tb=1440*60*1e3;async function fL(e,t){const r=localStorage.getItem(Kf),n=Date.now();if(r){const p=parseInt(r,10);if(!isNaN(p)&&n-p<Tb)return null}if(t===0)return localStorage.setItem(Kf,n.toString()),{deletedCompletions:0,deletedArrangements:0,deletedSessions:0};const a=new Date;a.setMonth(a.getMonth()-t);const s={deletedCompletions:0,deletedArrangements:0,deletedSessions:0},l=e.completions.filter(p=>p.timestamp?new Date(p.timestamp)<a:!1);s.deletedCompletions=l.length;const u=e.arrangements.filter(p=>p.createdAt?new Date(p.createdAt)<a:!1);s.deletedArrangements=u.length;const m=e.daySessions.filter(p=>p.date?new Date(p.date)<a:!1);return s.deletedSessions=m.length,localStorage.setItem(Kf,n.toString()),s}function hL(e,t){if(t===0)return e;const r=new Date;r.setMonth(r.getMonth()-t);const n=e.completions.filter(l=>l.timestamp?new Date(l.timestamp)>=r:!0),a=e.arrangements.filter(l=>l.createdAt?new Date(l.createdAt)>=r:!0),s=e.daySessions.filter(l=>l.date?new Date(l.date)>=r:!0);return{...e,completions:n,arrangements:a,daySessions:s}}function mL(){const e=localStorage.getItem(Kf);if(!e)return!0;const t=parseInt(e,10);return isNaN(t)?!0:Date.now()-t>=Tb}async function Dm(e,t,r){if(!(!e.user||!r)){if(Xs("navigator_restore_in_progress")){ve.info("🛡️ RESTORE PROTECTION: Skipping session reconciliation to prevent data loss");return}try{ve.info("Post-restore: Reconciling session state with cloud...");const{data:n,error:a}=await r.from("navigator_state").select("data").eq("user_id",e.user.id).maybeSingle();if(a||!n?.data){ve.warn("No cloud state found for session reconciliation");return}const l=Vf(n.data).daySessions||[];t(u=>({...u,daySessions:l})),ve.info("Session state reconciled with cloud successfully")}catch(n){ve.error("Failed to reconcile session state:",n)}}}class uy extends J.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,msg:String(t)}}render(){return this.state.hasError?d.jsxs("div",{className:"container",style:{paddingTop:"4rem"},children:[d.jsx("h2",{children:"Something went wrong"}),d.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:this.state.msg})]}):this.props.children}}async function Bo(e,t="manual",r=0){if(!We)throw ve.error("Supabase not configured for backup"),new Error("Supabase not configured");const n=await We.auth.getUser(),a=n&&n.data&&n.data.user?n.data.user.id:void 0;if(!a)throw ve.error("User not authenticated for backup"),new Error("User not authenticated");const s="Europe/London",l=new Date,u=l.toLocaleDateString("en-GB",{timeZone:s,year:"numeric"}),m=l.toLocaleDateString("en-GB",{timeZone:s,month:"2-digit"}),p=l.toLocaleDateString("en-GB",{timeZone:s,day:"2-digit"}),g=`${u}-${m}-${p}`,y=l.toLocaleTimeString("en-GB",{timeZone:s,hour12:!1}).replace(/:/g,""),_="navigator-backups",T=`backup_${g}_${y}_${t}_retry${r}.json`,S=`${a}/${g}/${T}`;try{const w=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});ve.info(`Uploading backup to ${S}, size: ${w.size} bytes`);const E=await We.storage.from(_).upload(S,w,{upsert:!0,contentType:"application/json"});if(E.error)throw ve.error("Backup upload failed:",E.error),new Error(E.error.message);ve.info("Backup upload successful:",S);try{await We.from("backups").insert({user_id:a,day_key:g,object_path:S,size_bytes:w.size}),ve.info("Backup database record created")}catch(P){ve.warn("Backups table insert failed (non-critical):",P instanceof Error?P.message:P)}return{objectPath:S,size:w.size}}catch(w){if(ve.error(`Backup attempt ${r+1} failed:`,w),r<2){const E=Math.pow(2,r)*1e3;return ve.info(`Retrying backup in ${E}ms...`),await new Promise(P=>setTimeout(P,E)),Bo(e,t,r+1)}throw new Error(`Backup failed after ${r+1} attempts: ${w.message}`)}}function Hf({title:e,value:t,change:r,changeType:n,icon:a,iconType:s}){return d.jsxs("div",{className:"stat-card-modern",children:[d.jsxs("div",{className:"stat-header",children:[d.jsx("div",{className:"stat-title",children:e}),d.jsx("div",{className:`stat-icon ${s}`,children:a})]}),d.jsx("div",{className:"stat-value",children:t}),r&&d.jsxs("div",{className:`stat-change ${n||"neutral"}`,children:[n==="positive"&&d.jsx("span",{children:"↑"}),n==="negative"&&d.jsx("span",{children:"↓"}),d.jsx("span",{children:r})]})]})}function pL(){const e=Hy(),[t,r]=J.useState(!1),[n,a]=J.useState(!1);return J.useEffect(()=>{if(e.isLoading){const s=setTimeout(()=>r(!0),500),l=setTimeout(()=>{navigator.onLine||(ve.warn("🔌 OFFLINE: Force skipping loading screen to allow local data access"),a(!0))},3e3),u=setTimeout(()=>{ve.warn("⏱️ TIMEOUT: Force skipping loading screen after 10 seconds"),a(!0)},1e4);return()=>{clearTimeout(s),clearTimeout(l),clearTimeout(u)}}else r(!1),a(!1)},[e.isLoading]),e.isLoading&&t&&!n?d.jsx("div",{className:"app-wrapper",children:d.jsx("div",{className:"main-area",children:d.jsx("div",{className:"content-area",children:d.jsxs("div",{className:"loading",children:[d.jsx("div",{className:"spinner"}),d.jsx("div",{children:"Restoring session..."}),!e.isOnline&&d.jsx("div",{style:{marginTop:"1rem",color:"var(--warning)",fontSize:"0.875rem"},children:"📡 You appear to be offline. Loading local data..."})]})})})}):e.user?d.jsx(uy,{children:d.jsx(TE,{children:d.jsx(gL,{})})}):d.jsx(uy,{children:d.jsx(CE,{onSignIn:async(s,l)=>{await e.signIn(s,l)},onSignUp:async(s,l)=>{await e.signUp(s,l)},onResetPassword:async s=>{await e.resetPassword(s)},isLoading:e.isLoading,error:e.error,onClearError:e.clearError})})}function gL(){const e=Hy(),{state:t,loading:r,setAddresses:n,addAddress:a,setActive:s,cancelActive:l,complete:u,undo:m,startDay:p,endDay:g,backupState:y,restoreState:_,addArrangement:T,updateArrangement:S,deleteArrangement:w,setState:E,setBaseState:P,deviceId:I,enqueueOp:A,updateReminderSettings:R,updateBonusSettings:K,ownerMetadata:W}=vS(e.user?.id),{confirm:D,alert:ee}=EE(),{settings:re}=wp(),{hasAccess:pe}=bp(e.user),{isAdmin:ue,isOwner:ce}=i_(e.user),[Ce,ye]=J.useState(!1),[he,le]=J.useState(!1),[j,H]=J.useState(!1),[O,ne]=J.useState(!1),[Y,F]=J.useState(!1),[U,z]=J.useState(!1),[q,M]=J.useState(!1),[oe,se]=J.useState(!1),[fe,xe]=J.useState(!1),je=()=>{const De=window.location.hash.slice(1);return["list","completed","arrangements","earnings","planning"].includes(De)?De:"list"},[X,Ke]=J.useState(je),[Xe,Qe]=J.useState(""),[it,Le]=J.useState(null),[kt,ft]=J.useState(!1),pt=J.useRef(null);J.useEffect(()=>{const De=()=>{const He=je();Ke(He)};return window.addEventListener("popstate",De),()=>window.removeEventListener("popstate",De)},[]),J.useEffect(()=>{kt&&localStorage.getItem("navigator_ownership_uncertain")==="true"&&xe(!0)},[kt]),J.useEffect(()=>{(async()=>{try{await Lu.requestPersistentStorage(),ve.info("PWA initialized successfully")}catch(He){ve.error("PWA initialization failed:",He)}})()},[]),J.useEffect(()=>{(async()=>{if(!mL())return;const He=await fL(t,re.keepDataForMonths);if(He&&(He.deletedCompletions>0||He.deletedArrangements>0)){const tt=hL(t,re.keepDataForMonths);E(tt),console.log(`Data cleanup completed: ${He.deletedCompletions} completions, ${He.deletedArrangements} arrangements, ${He.deletedSessions} sessions removed`)}})()},[]);const Gt=J.useCallback(De=>{De!==X&&(Ke(De),window.history.pushState({tab:De},"",`#${De}`))},[X]),[Cn,zr]=J.useState(!1),[Cr,un]=J.useState([]),[Fr,nn]=J.useState(!1),[Jt,Ar]=J.useState(null),ht=Array.isArray(t.addresses)?t.addresses:[],Ct=Array.isArray(t.completions)?t.completions:[],pr=Array.isArray(t.arrangements)?t.arrangements:[],Ht=Array.isArray(t.daySessions)?t.daySessions:[],ct=J.useMemo(()=>({...t,addresses:ht,completions:Ct,arrangements:pr,daySessions:Ht}),[t,ht,Ct,pr,Ht]);function oi(De,He="Europe/London"){const tt=De.toLocaleDateString("en-GB",{timeZone:He,year:"numeric"}),Ge=De.toLocaleDateString("en-GB",{timeZone:He,month:"2-digit"}),Oe=De.toLocaleDateString("en-GB",{timeZone:He,day:"2-digit"});return`${tt}-${Ge}-${Oe}`}const Ii=J.useCallback(async()=>{if(!We){Ar("Supabase not configured");return}nn(!0),Ar(null);try{const He=(await We.auth.getUser())?.data?.user?.id;if(!He)throw new Error("Not authenticated");const tt=new Date,Ge=new Date;Ge.setDate(Ge.getDate()-6);const Oe=oi(Ge),B=oi(tt),Q=await We.from("backups").select("object_path,size_bytes,created_at,day_key").eq("user_id",He).gte("day_key",Oe).lte("day_key",B).order("day_key",{ascending:!1}).order("created_at",{ascending:!1});if(Q.error)throw Q.error;const Z=Q.data??[];un(Z)}catch(De){Ar(De?.message||String(De))}finally{nn(!1)}},[]),Yn=J.useCallback(async De=>{if(!We){await ee({title:"Configuration Error",message:"Supabase is not configured.",type:"error"});return}const He=De.split("/").pop()||De;if(await D({title:"Restore from Cloud",message:`Restore "${He}" from cloud?

This will overwrite your current data.`,confirmText:"Restore",cancelText:"Cancel",type:"warning"})){nn(!0),Ar(null);try{const Oe=await We.storage.from("navigator-backups").download(De);if(Oe.error)throw Oe.error;const Q=await Oe.data.text(),Z=JSON.parse(Q),te=sm(Z),ie=ct.daySessions,ae={...te,daySessions:ie};_(ae),setTimeout(async()=>{await e.syncData(ae),pt.current=JSON.stringify(ae)},31e3),await Dm(e,E,We),ft(!0),await ee({title:"Success",message:"Successfully restored from cloud",type:"success"}),zr(!1)}catch(Ge){Ar(Ge?.message||String(Ge))}finally{nn(!1)}}},[e,_,ee,D]),La=J.useRef(null),qn=J.useRef(!1);J.useEffect(()=>{if(e.user?.id){const De=localStorage.getItem("navigator_expected_user_id");!De||De!==e.user.id?(ve.info(`🔒 SECURITY: Setting expected user ID: ${e.user.id}`),localStorage.setItem("navigator_expected_user_id",e.user.id),La.current=e.user.id):La.current=De}},[e.user?.id]),J.useEffect(()=>{if(!e.user||r)return;if(!e.isOnline){ve.info("🔌 OFFLINE: Skipping bootstrap sync, using local data only"),localStorage.getItem("navigator_offline_mode")==="true"&&ve.info("🔌 ONLINE RESTORED: Clearing offline mode, will re-authenticate"),ft(!0);return}if(localStorage.removeItem("navigator_offline_mode"),!We){ft(!0);return}if(qn.current){ve.warn("🔒 SECURITY: Bootstrap sync already in progress, skipping");return}let De=!1,He;return(async()=>{try{qn.current=!0;const tt=e.user.id,Ge=localStorage.getItem("navigator_expected_user_id");if(Ge&&Ge!==tt){ve.error(`🚨 SESSION POISONING DETECTED: Expected ${Ge}, got ${tt}`);const Z={timestamp:new Date().toISOString(),expectedUserId:Ge,actualUserId:tt,localState:ct,reason:"session_poisoning_detected"};localStorage.setItem(`navigator_emergency_backup_${Date.now()}`,JSON.stringify(Z)),await ee({title:"⚠️ Security Alert: Session Mismatch",message:"Detected session for different user. Your data has been backed up. Please sign out and sign in again.",type:"error"}),await e.signOut();return}if(localStorage.getItem("navigator_active_protection")&&t.activeIndex!==null){ve.info(`🛡️ ACTIVE PROTECTION: Skipping bootstrap sync - user has active address #${t.activeIndex}`),ft(!0);return}const Q=(await We.from("navigator_state").select("data, updated_at, version").eq("user_id",tt).maybeSingle()).data;if(Q&&Q.data&&Q.data._ownerUserId&&Q.data._ownerUserId!==tt){ve.error(`🚨 DATA CONTAMINATION: Cloud state has wrong owner! Expected ${tt}, found ${Q.data._ownerUserId}`),await ee({title:"⚠️ Data Security Error",message:"Cloud data ownership mismatch detected. Using local data only.",type:"error"}),ft(!0);return}if(Q&&Q.data){const Z=Vf(Q.data);if(!De){if(ht.length>0||Ct.length>0||pr.length>0||Ht.length>0){const ie=Ct.length,ae=Z.completions?.length||0,we=Q.updated_at?new Date(Q.updated_at):new Date(0),Te=new Date(Date.now()-7200*1e3),be=Ct.some(ke=>ke.timestamp&&new Date(ke.timestamp)>Te);if(ve.sync("🔍 SESSION RESTORATION ANALYSIS:",{localCompletions:ie,cloudCompletions:ae,cloudLastUpdated:we.toISOString(),hasRecentLocalActivity:be,willMerge:ie>0||be}),ie>ae||be){ve.sync("🛡️ DATA PROTECTION: Local data appears newer, merging states to prevent loss");const Ae=$y(ct,Z);E(Ae),pt.current=JSON.stringify(Ae),setTimeout(async()=>{try{await e.syncData(Ae),ve.sync("✅ Synced merged state back to cloud")}catch(ze){ve.error("Failed to sync merged state:",ze)}},1e3)}else ve.sync("☁️ Using cloud state (appears more complete)"),E(Z),pt.current=JSON.stringify(Z)}else ve.sync("☁️ No local data, using cloud state"),E(Z),pt.current=JSON.stringify(Z);ft(!0),ve.sync("Session restored, version:",Q?.version)}}else if(ht.length>0||Ct.length>0||pr.length>0||Ht.length>0){ve.info("Analyzing data ownership for current user...");try{let te=null;try{const{data:ae}=await We.from("navigator_state").select("data").eq("user_id",e.user.id).maybeSingle();te=ae?.data}catch(ae){ve.warn("Could not fetch cloud data for analysis:",ae)}const ie=wi.analyzeDataOwnership(ct,e.user,te,W);switch(ve.info("Data ownership analysis:",ie),ie.action){case"sync":ve.sync("Syncing local data to cloud (ownership confirmed)"),await e.syncData(ct),wi.storeDeviceContext(e.user),De||(pt.current=JSON.stringify(ct),ft(!0));break;case"backup_and_clear":ve.warn("Creating safety backup before clearing (different user detected)");try{const ae=`navigator_safety_backup_${Date.now()}_user_switch`,we={...ct,_backup_timestamp:new Date().toISOString(),_backup_reason:"user_switch",_ownership_analysis:ie};localStorage.setItem(ae,JSON.stringify(we)),ve.info(`Safety backup created: ${ae}`),E({addresses:[],completions:[],arrangements:[],daySessions:[],activeIndex:null,currentListVersion:1}),wi.storeDeviceContext(e.user),De||ft(!0)}catch(ae){ve.error("Backup failed - preserving data for safety:",ae),wi.storeDeviceContext(e.user),De||ft(!0)}break;case"preserve_and_ask":default:ve.info("Preserving local data (uncertain ownership) - user must decide before syncing"),localStorage.setItem("navigator_ownership_uncertain","true"),wi.storeDeviceContext(e.user),De||ft(!0);break}}catch(te){ve.error("User detection analysis failed - preserving data for safety:",te),await e.syncData(ct),wi.storeDeviceContext(e.user),De||(pt.current=JSON.stringify(ct),ft(!0))}}else wi.storeDeviceContext(e.user),De||ft(!0);He=e.subscribeToData(Z=>{if(Z){if(Xs("navigator_restore_in_progress")){ve.sync("🛡️ RESTORE PROTECTION: App.tsx subscription skipping cloud state update to prevent data loss");return}if(Xs("navigator_import_in_progress")){ve.sync("🛡️ IMPORT PROTECTION: App.tsx subscription skipping cloud state update to prevent import override");return}if(typeof Z=="function")ve.sync("Received cloud update (React updater)"),E(te=>{const ie=Z(te),ae=Vf(ie),we=JSON.stringify(ae);return pt.current=we,ae}),ft(!0);else{const te=JSON.stringify(Z);if(te===pt.current)return;const ie=Vf(Z);ve.sync("Received cloud update (direct state)"),E(ie),pt.current=te,ft(!0)}}})}catch(tt){ve.error("Bootstrap sync failed:",tt),De||ft(!0)}finally{qn.current=!1}})(),()=>{De=!0,qn.current=!1,He&&He()}},[e.user,e.isOnline,r,ct,t.activeIndex,ee]),J.useEffect(()=>{if(!e.user||r||!kt)return;const De=JSON.stringify(ct);if(De===pt.current)return;const He=setTimeout(async()=>{try{if(Xs("navigator_restore_in_progress")){ve.sync("🛡️ RESTORE PROTECTION: Debounced sync skipping to prevent data loss");return}if(Xs("navigator_import_in_progress",300)){ve.sync("🛡️ IMPORT PROTECTION: Waiting 300ms for import state to settle before sync");return}ve.sync("Syncing changes to cloud..."),pt.current=De,await e.syncData(ct),ve.sync("Sync completed successfully")}catch(tt){ve.error("Sync failed:",tt),pt.current="";const Ge=5e3;ve.sync(`🔄 Scheduling sync retry in ${Ge/1e3}s...`),setTimeout(async()=>{try{ve.sync("🔄 Attempting sync retry..."),await e.syncData(ct),ve.sync("✅ Sync retry successful"),pt.current=JSON.stringify(ct)}catch(Oe){ve.error("Sync retry also failed:",Oe)}},Ge)}},150);return()=>clearTimeout(He)},[ct,e,kt,r]),J.useEffect(()=>{if(!e.user||r||!kt)return;let De=JSON.stringify(ct);const He=async()=>{const B=JSON.stringify(ct);if(B!==De&&(ct.completions.length>0||ct.addresses.length>0))try{ve.info("Performing periodic safety backup..."),await Bo(ct,"manual"),De=B,ve.info("Periodic backup successful")}catch(Q){ve.error("Periodic backup failed:",Q)}},tt=setInterval(He,3600*1e3),Ge=localStorage.getItem("last_backup_time"),Oe=Date.now();return(!Ge||Oe-parseInt(Ge)>3600*1e3)&&setTimeout(async()=>{await He(),localStorage.setItem("last_backup_time",Oe.toString())},5e3),()=>clearInterval(tt)},[ct,e.user,kt,r]),J.useEffect(()=>{if(!e.user||r||!kt)return;const De=()=>{const tt=ct.completions.length,Ge=ct.addresses.length,Oe=localStorage.getItem("navigator_data_counts");if(Oe){const{completions:B,addresses:Q}=JSON.parse(Oe);if(e.isSyncing){ve.info("Skipping data integrity check - cloud sync in progress");return}const Z=120*1e3,ie=(e.lastSyncTime?Date.now()-e.lastSyncTime.getTime():1/0)<Z,ae=ie?50:10,we=ie?200:50;tt<B-ae&&(ve.error(`POTENTIAL DATA LOSS DETECTED: Completions dropped from ${B} to ${tt}`),ie?ve.warn(`Large completion count change during recent sync (${B} → ${tt}) - monitoring`):ee({title:"⚠️ POTENTIAL DATA LOSS",message:`Completions count dropped significantly (${B} → ${tt}). Check cloud backups immediately!`,type:"error"})),Ge<Q-we&&(ve.error(`POTENTIAL DATA LOSS DETECTED: Addresses dropped from ${Q} to ${Ge}`),ie?ve.warn(`Large address count change during recent sync (${Q} → ${Ge}) - monitoring`):ee({title:"⚠️ POTENTIAL DATA LOSS",message:`Address count dropped significantly (${Q} → ${Ge}). Check cloud backups immediately!`,type:"error"}))}localStorage.setItem("navigator_data_counts",JSON.stringify({completions:tt,addresses:Ge,timestamp:new Date().toISOString()}))},He=setInterval(De,30*1e3);return setTimeout(De,3e3),()=>clearInterval(He)},[ct,e.user,e.isSyncing,e.lastSyncTime,kt,r]);const hr=J.useMemo(()=>{const De=t.currentListVersion,He=new Set(Ct.filter(Te=>Te.listVersion===De).map(Te=>Te.index)),tt=ht.length,Ge=tt-He.size,Oe=Ct.filter(Te=>Te.listVersion===De&&Te.outcome==="PIF").length,B=Ct.filter(Te=>Te.listVersion===De&&Te.outcome==="Done").length,Q=Ct.filter(Te=>Te.listVersion===De&&Te.outcome==="DA").length,Z=Ct.filter(Te=>Te.listVersion===De&&Te.outcome==="ARR").length,te=He.size,ie=pr.filter(Te=>Te.status!=="Completed"&&Te.status!=="Cancelled").length,ae=new Date().toISOString().slice(0,10),we=Ct.filter(Te=>Te.outcome==="PIF"&&(Te.timestamp||"").slice(0,10)===ae).reduce((Te,be)=>Te+parseFloat(be.amount||"0"),0);return{total:tt,pending:Ge,completed:te,pifCount:Oe,doneCount:B,daCount:Q,arrCount:Z,pendingArrangements:ie,todaysPIF:we}},[ht,Ct,pr,t.currentListVersion]),Xn=J.useCallback(De=>{ve.info(`Importing ${De.length} addresses...`),n(De,!0)},[n]),An=J.useCallback(async(De,He,tt,Ge,Oe,B)=>{try{await u(De,He,tt,Ge,Oe,B);try{const Q=y();We&&(await Bo(Q,"manual"),ve.info("Cloud backup after completion successful")),ri.storeLocalBackup(Q),ve.info("Local storage backup after completion successful")}catch(Q){ve.error("Backup failed after completion:",Q)}}catch(Q){ve.error("Failed to complete address:",Q)}},[u,y]),Ma=J.useCallback(De=>{const He=typeof De=="string"?new Date(De):De;if(Number.isNaN(He.getTime())){ve.error("Invalid start date:",De);return}const tt=He.toISOString(),Ge=tt.slice(0,10);P(Oe=>{const B=Oe.daySessions.slice();let Q=B.findIndex(we=>we.date===Ge),Z;if(Q>=0?Z={...B[Q],start:tt}:Z={date:Ge,start:tt},Z.end)try{const we=new Date(tt).getTime(),Te=new Date(Z.end).getTime();Te>=we?Z.durationSeconds=Math.floor((Te-we)/1e3):(delete Z.end,delete Z.durationSeconds)}catch(we){ve.error("Error calculating duration:",we)}const te=new Date().toISOString();Z.updatedAt=te,Z.updatedBy=I;const ie=`edit_start_${Ge}_${Date.now()}`,ae={...Z,id:Ge,updatedAt:te,updatedBy:I};return A("session",Q>=0?"update":"create",ae,ie),Q>=0?B[Q]=Z:B.push(Z),{...Oe,daySessions:B}})},[P,I,A]),ls=J.useCallback(De=>{const He=typeof De=="string"?new Date(De):De;if(Number.isNaN(He.getTime())){ve.error("Invalid end date:",De);return}const tt=He.toISOString(),Ge=tt.slice(0,10);P(Oe=>{const B=Oe.daySessions.slice();let Q=B.findIndex(we=>we.date===Ge),Z;if(Q>=0?Z={...B[Q]}:Z={date:Ge,start:tt},Z.end=tt,Z.start)try{const we=new Date(Z.start).getTime(),Te=new Date(tt).getTime();Te>=we?Z.durationSeconds=Math.floor((Te-we)/1e3):(Z.start=tt,Z.durationSeconds=0)}catch(we){ve.error("Error calculating duration:",we),Z.durationSeconds=0}const te=new Date().toISOString();Z.updatedAt=te,Z.updatedBy=I;const ie=`edit_end_${Ge}_${Date.now()}`,ae={...Z,id:Ge,updatedAt:te,updatedBy:I};return A("session",Q>=0?"update":"create",ae,ie),Q>=0?B[Q]=Z:B.push(Z),{...Oe,daySessions:B}})},[P,I,A]),cs=async De=>{const He=De.target.files?.[0];if(He)try{const tt=await dC(He),Ge=sm(tt),Oe=ct.daySessions,B={...Ge,daySessions:Oe};_(B),setTimeout(async()=>{await e.syncData(B),pt.current=JSON.stringify(B)},31e3),await Dm(e,E,We),ft(!0),await ee({title:"Success",message:"Restore completed successfully!",type:"success"})}catch(tt){ve.error("Restore failed:",tt),await ee({title:"Error",message:"Restore failed: "+(tt?.message||tt),type:"error"})}finally{De.target.value=""}},us=J.useCallback(async(De,He,tt)=>{E(Ge=>{if(!Number.isInteger(De)||De<0||De>=Ge.completions.length)return Ge;const Oe=Ge.completions.slice();return Oe[De]={...Oe[De],outcome:He,amount:tt},{...Ge,completions:Oe}});try{await new Promise(Oe=>setTimeout(Oe,100));const Ge=y();We&&(await Bo(Ge,"manual"),ve.info("Cloud backup after outcome change successful")),ri.storeLocalBackup(Ge),ve.info("Local storage backup after outcome change successful")}catch(Ge){ve.error("Backup failed after outcome change:",Ge)}},[E,y]),ds=J.useCallback(async()=>{try{ve.sync("Manual sync initiated...");const De=JSON.stringify(ct);if(Xs("navigator_restore_in_progress")){ve.sync("🛡️ RESTORE PROTECTION: Manual sync blocked to prevent data loss"),await ee({title:"Restore in Progress",message:"Please wait 30 seconds before manual sync to prevent data loss"});return}pt.current=De,await e.syncData(ct),ve.sync("Manual sync completed successfully");try{await Bo(ct,"manual"),ve.info("Safety backup after manual sync completed")}catch(He){ve.warn("Safety backup after sync failed:",He)}}catch(De){ve.error("Manual sync failed:",De),pt.current=""}},[e,ct]),Di=(De,He)=>{localStorage.setItem("navigator_supabase_url",De),localStorage.setItem("navigator_supabase_key",He),window.location.reload()},li=()=>{localStorage.setItem("navigator_supabase_skipped","true"),ne(!1)};J.useEffect(()=>{if(!e.user||r)return;const De=!!We,He=localStorage.getItem("navigator_supabase_skipped");!De&&!He&&ne(!0)},[e.user,r]),J.useEffect(()=>{if(!kt)return;let De=JSON.stringify(ct);const He=async()=>{const B=JSON.stringify(ct);if(B!==De&&(ct.completions.length>0||ct.addresses.length>0))try{ve.info("Performing periodic safety backup..."),e.user&&We&&await Bo(ct,"periodic"),ri.storeLocalBackup(ct),De=B,ve.info("Periodic backup successful")}catch(Q){ve.error("Periodic backup failed:",Q)}},tt=setInterval(He,3600*1e3),Ge=setInterval(()=>{ri.cleanupOldBackups()},10080*60*1e3),Oe=ri.getBackupStats();return(Oe.count===0||ct.completions.length>0&&Oe.count<3)&&setTimeout(async()=>{await He()},5e3),()=>{clearInterval(tt),clearInterval(Ge)}},[ct,e.user,kt]);const Ba=()=>{const De=e.user?.email||"",He=De.split("@")[0].split(".");return He.length>=2?(He[0][0]+He[1][0]).toUpperCase():De.slice(0,2).toUpperCase()};return r?d.jsx("div",{className:"app-wrapper",children:d.jsx("div",{className:"main-area",children:d.jsx("div",{className:"content-area",children:d.jsxs("div",{className:"loading",children:[d.jsx("div",{className:"spinner"}),"Preparing your workspace..."]})})})}):d.jsxs("div",{className:"app-wrapper",children:[d.jsx(JR,{isOpen:O,onSetupComplete:Di,onSkip:li}),d.jsx(QR,{isOpen:Y,onClose:()=>F(!1),currentData:ct,onRestore:De=>{const He=sm(De),tt=ct.daySessions,Ge={...He,daySessions:tt};_(Ge),e.user&&We&&(setTimeout(async()=>{await e.syncData(Ge)},31e3),Dm(e,E,We))}}),he&&ue&&d.jsx(TC,{user:e.user,onClose:()=>le(!1)}),Ce&&d.jsx(bC,{user:e.user,onClose:()=>ye(!1)}),d.jsxs("main",{className:"main-area",children:[!e.isOnline&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #FFA500, #FF8C00)",color:"white",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 2px 8px rgba(255, 140, 0, 0.3)",zIndex:100},children:[d.jsx("span",{children:"📡"}),d.jsx("span",{children:"Working Offline - Changes will sync when connection returns"})]}),localStorage.getItem("navigator_offline_mode")==="true"&&d.jsxs("div",{style:{background:"linear-gradient(135deg, #9C27B0, #7B1FA2)",color:"white",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 2px 8px rgba(156, 39, 176, 0.3)",zIndex:100},children:[d.jsx("span",{children:"⚡"}),d.jsx("span",{children:"Offline Mode - Sign in when online to sync data"})]}),d.jsxs("header",{className:"app-header-modern",children:[d.jsxs("div",{className:"header-left",children:[d.jsxs("div",{className:"logo-section",children:[d.jsx("div",{className:"logo-icon",children:"📍"}),d.jsxs("div",{className:"logo-text",children:[d.jsx("div",{className:"logo-title",children:"Navigator"}),d.jsx("div",{className:"logo-subtitle",children:"Enforcement Pro"})]})]}),X==="list"&&d.jsxs("div",{className:"search-container-modern",children:[d.jsx("span",{className:"search-icon",children:"🔍"}),d.jsx("input",{id:"search-addresses",name:"searchAddresses",type:"search",className:"search-input-modern",placeholder:"Search addresses...",value:Xe,onChange:De=>Qe(De.target.value)})]})]}),d.jsxs("div",{className:"header-center",children:[d.jsx(uL,{isOnline:e.isOnline,isSyncing:e.isSyncing,lastSyncTime:e.lastSyncTime,onForceSync:e.forceFullSync}),d.jsx(sL,{reminderSettings:t.reminderSettings,onUpdateReminderSettings:R,bonusSettings:t.bonusSettings,onUpdateBonusSettings:K,onChangePassword:()=>z(!0),onChangeEmail:()=>M(!0),onDeleteAccount:()=>se(!0),appState:t,userEmail:e.user?.email,onImportExcel:async De=>{try{const He=await si(()=>Promise.resolve().then(()=>ZR),void 0),tt=await De.arrayBuffer(),Ge=He.read(tt,{type:"array"}),Oe=Ge.Sheets[Ge.SheetNames[0]],B=He.utils.sheet_to_json(Oe,{header:1});if(!B.length){ee({message:"📄 File appears to be empty. Please check your Excel file."});return}const Q=(B[0]||[]).map(be=>String(be??"").trim().toLowerCase());let Z=Q.findIndex(be=>be.includes("address"));Z===-1&&(Z=0);const te=Q.findIndex(be=>be==="lat"||be.includes("latitude")),ie=Q.findIndex(be=>be==="lng"||be==="lon"||be.includes("longitude")),ae=te===-1?void 0:te,we=ie===-1?void 0:ie,Te=[];for(let be=1;be<B.length;be++){const ke=B[be]||[],Ae=String(ke[Z]??"").trim();if(!Ae)continue;const ze=ae!==void 0&&ke[ae]!=null&&ke[ae]!==""?Number(ke[ae]):void 0,qe=we!==void 0&&ke[we]!=null&&ke[we]!==""?Number(ke[we]):void 0;Te.push({address:Ae,lat:ze,lng:qe})}if(Te.length===0){ee({message:"🚫 No valid addresses found in the file. Please check the format."});return}Xn(Te),console.log(`✅ Successfully imported ${Te.length} addresses!`)}catch(He){console.error(He),ee({message:"❌ Failed to read Excel file. Please ensure it's a valid .xlsx or .xls file."})}},onRestoreBackup:cs,onManualSync:ds,isSyncing:e.isSyncing,onShowBackupManager:()=>F(!0),onShowCloudBackups:async()=>{zr(!0),await Ii()},onShowSubscription:()=>ye(!0),onShowSupabaseSetup:()=>ne(!0),onSignOut:e.signOut,hasSupabase:!!We})]}),d.jsx("button",{className:"menu-toggle",onClick:()=>H(!j),children:"☰"})]}),d.jsxs("div",{className:"content-area",children:[X==="list"&&d.jsxs(d.Fragment,{children:[d.jsx(lC,{sessions:Ht,completions:Ct,startDay:p,endDay:g,onEditStart:Ma,onEditEnd:ls,onBackup:async()=>{const De=y(),He=tt=>new Promise((Ge,Oe)=>setTimeout(()=>Oe(new Error("Backup timeout")),tt));try{We&&(await Promise.race([Bo(De,"finish"),He(3e4)]),ve.info("Cloud backup at day end successful")),await Promise.race([ri.performCriticalBackup(De,"day-end"),He(15e3)]),ve.info("Local backup at day end successful")}catch(tt){throw ve.error("Backup failed or timed out:",tt),tt}}}),d.jsxs("div",{className:"stats-grid",children:[d.jsx(Hf,{title:"Pending Addresses",value:hr.pending,change:`${hr.completed} completed today`,changeType:"positive",icon:"📍",iconType:"info"}),d.jsx(Hf,{title:"Today's Earnings",value:`£${hr.todaysPIF.toFixed(0)}`,change:`${hr.pifCount} PIF today`,changeType:"positive",icon:"💰",iconType:"success"}),d.jsx(Hf,{title:"Arrangements Due",value:hr.pendingArrangements,change:"Check arrangements tab",changeType:"neutral",icon:"📅",iconType:"warning"}),d.jsx(Hf,{title:"Completion Rate",value:`${Math.round(hr.completed/Math.max(hr.total,1)*100)}%`,change:"Good performance",changeType:"positive",icon:"📊",iconType:"success"})]}),d.jsx(XE,{state:ct,setActive:s,cancelActive:l,onComplete:An,onAddArrangement:T,filterText:Xe}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",margin:"1.25rem 0 3rem",flexWrap:"wrap",alignItems:"center"},children:[d.jsx("button",{className:"btn btn-ghost",onClick:()=>m(-1),title:"Undo last completion",children:"↶ Undo Last"}),d.jsxs("span",{className:"pill pill-pif",children:["PIF ",hr.pifCount]}),d.jsxs("span",{className:"pill pill-done",children:["Done ",hr.doneCount]}),d.jsxs("span",{className:"pill pill-da",children:["DA ",hr.daCount]}),d.jsxs("span",{className:"pill pill-active",children:["ARR ",hr.arrCount]})]})]}),X==="completed"&&d.jsx(iC,{state:ct,onChangeOutcome:us,onAddArrangement:T,onComplete:An}),X==="arrangements"&&d.jsx(uC,{state:ct,onAddArrangement:T,onUpdateArrangement:S,onDeleteArrangement:w,onAddAddress:async De=>a(De),onComplete:An,autoCreateForAddress:it,onAutoCreateHandled:()=>Le(null)}),X==="earnings"&&d.jsx(AC,{state:ct,user:e.user}),X==="planning"&&d.jsx(XR,{user:e.user,onAddressesReady:De=>{n(De,!1)}})]}),d.jsx(fC,{onAdd:a})]}),d.jsxs("aside",{className:`sidebar-right ${j?"open":""}`,children:[d.jsx("div",{className:"sidebar-header",children:d.jsxs("div",{className:"user-profile-section",children:[d.jsx("div",{className:"user-avatar",children:Ba()}),d.jsxs("div",{className:"user-info",children:[d.jsx("div",{className:"user-name",children:e.user?.email?.split("@")[0]}),d.jsx("div",{className:"user-plan",children:ce?"Owner Access":pe?"Premium Plan":"Free Trial"})]})]})}),d.jsxs("nav",{className:"nav-menu",children:[d.jsxs("div",{className:"nav-section",children:[d.jsx("div",{className:"nav-section-title",children:"Main"}),d.jsxs("div",{className:`nav-item ${X==="list"?"active":""}`,onClick:()=>{Gt("list"),H(!1)},children:[d.jsx("span",{className:"nav-icon",children:"📋"}),d.jsx("span",{children:"Address List"}),d.jsx("span",{className:"nav-badge",children:hr.pending})]}),d.jsxs("div",{className:`nav-item ${X==="completed"?"active":""}`,onClick:()=>{Gt("completed"),H(!1)},children:[d.jsx("span",{className:"nav-icon",children:"✅"}),d.jsx("span",{children:"Completed"}),d.jsx("span",{className:"nav-badge",children:hr.completed})]}),d.jsxs("div",{className:`nav-item ${X==="arrangements"?"active":""}`,onClick:()=>{Gt("arrangements"),H(!1)},children:[d.jsx("span",{className:"nav-icon",children:"📅"}),d.jsx("span",{children:"Arrangements"}),d.jsx("span",{className:"nav-badge",children:hr.pendingArrangements})]})]}),d.jsxs("div",{className:"nav-section",children:[d.jsx("div",{className:"nav-section-title",children:"Analytics"}),d.jsxs("div",{className:`nav-item ${X==="earnings"?"active":""}`,onClick:()=>{Gt("earnings"),H(!1)},children:[d.jsx("span",{className:"nav-icon",children:"💰"}),d.jsx("span",{children:"Earnings"})]}),d.jsxs("div",{className:`nav-item ${X==="planning"?"active":""}`,onClick:()=>{Gt("planning"),H(!1)},children:[d.jsx("span",{className:"nav-icon",children:"🗺️"}),d.jsx("span",{children:"Route Planning"})]})]}),ue&&d.jsxs("div",{className:"nav-section",children:[d.jsx("div",{className:"nav-section-title",children:"Admin"}),d.jsxs("div",{className:"nav-item",onClick:()=>{le(!0),H(!1)},children:[d.jsx("span",{className:"nav-icon",children:"👑"}),d.jsx("span",{children:"Admin Panel"})]})]})]})]}),d.jsx("div",{className:`sidebar-overlay ${j?"active":""}`,onClick:()=>H(!1)}),Cn&&d.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3,minWidth:320,maxWidth:500,maxHeight:"70vh",background:"white",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-2xl)",overflow:"hidden",display:"flex",flexDirection:"column"},children:[d.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--gray-200)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("h3",{style:{margin:0},children:"Cloud Backups (Last 7 Days)"}),d.jsx("button",{className:"btn btn-ghost",style:{padding:"0.5rem"},onClick:()=>zr(!1),children:"✕"})]}),d.jsxs("div",{style:{flex:1,overflow:"auto",padding:"1rem"},children:[Fr&&d.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[d.jsx("div",{className:"spinner"}),d.jsx("p",{children:"Loading backups..."})]}),!Fr&&Jt&&d.jsx("div",{style:{padding:"1rem",color:"var(--danger)"},children:Jt}),!Fr&&!Jt&&Cr.length===0&&d.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--gray-500)"},children:"No backups found"}),!Fr&&!Jt&&Cr.map(De=>{const He=De.object_path.split("/"),tt=He[He.length-1]||De.object_path,Ge=De.day_key||"",Oe=De.size_bytes?Math.round(De.size_bytes/1024)+" KB":"";return d.jsxs("button",{className:"btn btn-ghost",style:{width:"100%",justifyContent:"space-between",marginBottom:"0.5rem",padding:"1rem"},onClick:()=>Yn(De.object_path),children:[d.jsx("span",{style:{fontWeight:500},children:tt}),d.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--gray-500)"},children:[Ge," · ",Oe]})]},De.object_path)})]})]}),Cn&&d.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1999},onClick:()=>zr(!1)}),e.error&&e.error!=="Auth session missing!"&&!e.isLoading&&d.jsxs("div",{style:{position:"fixed",bottom:"1rem",left:"50%",transform:"translateX(-50%)",background:"var(--danger-light)",border:"1px solid var(--danger)",borderRadius:"var(--radius-lg)",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",boxShadow:"var(--shadow-lg)",zIndex:1e3},children:[d.jsxs("span",{style:{color:"var(--danger)"},children:["⚠️ ",e.error]}),d.jsx("button",{className:"btn btn-ghost btn-sm",onClick:e.clearError,children:"Dismiss"})]}),U&&d.jsx("div",{className:"modal-overlay",onClick:()=>z(!1),children:d.jsxs("div",{className:"modal-content",onClick:De=>De.stopPropagation(),style:{maxWidth:"450px"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"1px solid var(--gray-200)"},children:[d.jsxs("div",{children:[d.jsx("h2",{style:{margin:0,fontSize:"1.5rem",color:"var(--text-primary)"},children:"Change Password"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Update your account password"})]}),d.jsx("button",{onClick:()=>z(!1),style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"var(--text-secondary)",padding:"0.25rem",lineHeight:1},children:"✕"})]}),d.jsxs("form",{onSubmit:async De=>{De.preventDefault();const He=De.target,tt=He.elements.namedItem("newPassword").value,Ge=He.elements.namedItem("confirmPassword").value;if(tt!==Ge){await ee({title:"Password Mismatch",message:"The passwords you entered do not match. Please try again.",type:"error"});return}if(tt.length<6){await ee({title:"Password Too Short",message:"Password must be at least 6 characters long.",type:"error"});return}try{await e.updatePassword(tt),z(!1),await ee({title:"Password Updated",message:"Your password has been updated successfully!",type:"success"})}catch(Oe){await ee({title:"Update Failed",message:Oe.message||"Failed to update password. Please try again.",type:"error"})}},children:[d.jsxs("div",{style:{marginBottom:"1.25rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500,fontSize:"0.9375rem",color:"var(--text-primary)"},children:"New Password"}),d.jsx("input",{type:"password",name:"newPassword",className:"input",required:!0,minLength:6,placeholder:"Enter new password",style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1.5px solid var(--gray-300)",fontSize:"1rem"}}),d.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8125rem",color:"var(--text-secondary)"},children:"Must be at least 6 characters"})]}),d.jsxs("div",{style:{marginBottom:"1.5rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500,fontSize:"0.9375rem",color:"var(--text-primary)"},children:"Confirm Password"}),d.jsx("input",{type:"password",name:"confirmPassword",className:"input",required:!0,minLength:6,placeholder:"Re-enter new password",style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1.5px solid var(--gray-300)",fontSize:"1rem"}})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1.5rem",paddingTop:"1rem",borderTop:"1px solid var(--gray-200)"},children:[d.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:1,padding:"0.875rem",fontSize:"1rem",fontWeight:600},children:"Update Password"}),d.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>z(!1),style:{padding:"0.875rem 1.5rem",fontSize:"1rem"},children:"Cancel"})]})]})]})}),q&&d.jsx("div",{className:"modal-overlay",onClick:()=>M(!1),children:d.jsxs("div",{className:"modal-content",onClick:De=>De.stopPropagation(),style:{maxWidth:"400px"},children:[d.jsx("h2",{style:{marginBottom:"1rem"},children:"Change Email"}),d.jsx("p",{style:{marginBottom:"1rem",color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Note: You'll need to confirm your new email address."}),d.jsxs("form",{onSubmit:async De=>{De.preventDefault();const tt=De.target.elements.namedItem("newEmail").value;try{if(!We)throw new Error("Supabase not configured");const{error:Ge}=await We.auth.updateUser({email:tt});if(Ge)throw Ge;window.alert("Confirmation email sent! Please check your inbox."),M(!1)}catch(Ge){window.alert("Error: "+Ge.message)}},children:[d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"New Email"}),d.jsx("input",{type:"email",name:"newEmail",className:"input",required:!0})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:1},children:"Update Email"}),d.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>M(!1),children:"Cancel"})]})]})]})}),oe&&d.jsx("div",{className:"modal-overlay",onClick:()=>se(!1),children:d.jsxs("div",{className:"modal-content",onClick:De=>De.stopPropagation(),style:{maxWidth:"400px"},children:[d.jsx("h2",{style:{marginBottom:"1rem",color:"var(--danger)"},children:"Delete Account"}),d.jsx("p",{style:{marginBottom:"1rem"},children:"⚠️ This action cannot be undone. All your data will be permanently deleted."}),d.jsxs("p",{style:{marginBottom:"1rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Type ",d.jsx("strong",{children:"DELETE"})," to confirm:"]}),d.jsxs("form",{onSubmit:async De=>{if(De.preventDefault(),De.target.elements.namedItem("confirmation").value!=="DELETE"){window.alert("Please type DELETE to confirm");return}try{if(!We)throw new Error("Supabase not configured");const{error:Ge}=await We.rpc("delete_user_account");if(Ge)throw Ge;await e.signOut(),window.alert("Account deleted successfully"),se(!1)}catch(Ge){window.alert("Error: "+Ge.message)}},children:[d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx("input",{type:"text",name:"confirmation",className:"input",required:!0,placeholder:"Type DELETE"})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{type:"submit",className:"btn",style:{flex:1,background:"var(--danger)",color:"white"},children:"Delete Account"}),d.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>se(!1),children:"Cancel"})]})]})]})}),d.jsx(oL,{}),fe&&d.jsx("div",{className:"modal-overlay",onClick:De=>De.stopPropagation(),children:d.jsxs("div",{className:"modal-content",onClick:De=>De.stopPropagation(),style:{maxWidth:"500px"},children:[d.jsx("h2",{style:{marginBottom:"1rem",color:"var(--warning)"},children:"⚠️ Data Ownership Unclear"}),d.jsx("p",{style:{marginBottom:"1rem"},children:"We found local data on this device, but we cannot determine if it belongs to your account."}),d.jsx("p",{style:{marginBottom:"1rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"This can happen when:"}),d.jsxs("ul",{style:{marginBottom:"1rem",paddingLeft:"1.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:[d.jsx("li",{children:"You're using a shared device"}),d.jsx("li",{children:"Another user previously used this browser"}),d.jsx("li",{children:"You're signing in from a different account"})]}),d.jsx("p",{style:{marginBottom:"1.5rem",fontWeight:500},children:"What would you like to do with the local data?"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx("button",{className:"btn btn-primary",style:{width:"100%"},onClick:async()=>{localStorage.removeItem("navigator_ownership_uncertain"),xe(!1);try{await e.syncData(ct),wi.storeDeviceContext(e.user),pt.current=JSON.stringify(ct),await ee({title:"Success",message:"Your data has been synced to the cloud.",type:"success"})}catch(De){ve.error("Failed to sync data:",De),await ee({title:"Sync Failed",message:"Failed to sync data to cloud. Please try again.",type:"error"})}},children:"Keep & Sync to My Account"}),d.jsx("button",{className:"btn",style:{width:"100%",background:"var(--gray-200)"},onClick:async()=>{if(await D({title:"Discard Local Data?",message:"This will permanently delete the local data and load your cloud data instead. This action cannot be undone.",confirmText:"Discard Local Data",cancelText:"Cancel",type:"warning"})){localStorage.removeItem("navigator_ownership_uncertain");try{const He=`navigator_safety_backup_${Date.now()}_user_choice_discard`;localStorage.setItem(He,JSON.stringify({...ct,_backup_timestamp:new Date().toISOString(),_backup_reason:"user_chose_discard"})),ve.info(`Safety backup created: ${He}`)}catch(He){ve.warn("Failed to create safety backup:",He)}E({addresses:[],completions:[],arrangements:[],daySessions:[],activeIndex:null,currentListVersion:1}),wi.storeDeviceContext(e.user),xe(!1),await ee({title:"Data Cleared",message:"Local data has been cleared. Your cloud data will now load.",type:"success"})}},children:"Discard Local Data"}),d.jsx("button",{className:"btn btn-ghost",style:{width:"100%"},onClick:()=>{xe(!1),ee({title:"Decision Deferred",message:"You can access this prompt again from Settings > Account > Resolve Data Ownership",type:"info"})},children:"Decide Later"})]})]})}),d.jsx(dL,{}),d.jsx(lL,{})]})}const vL="https://eevfxrgemrtthxbcxtvq.supabase.co";try{const e=new URL(vL).origin;["preconnect","dns-prefetch"].forEach(t=>{const r=document.createElement("link");r.rel=t,r.href=e,t==="preconnect"&&(r.crossOrigin=""),document.head.appendChild(r)})}catch{}gk.createRoot(document.getElementById("root")).render(d.jsx(pL,{}));
