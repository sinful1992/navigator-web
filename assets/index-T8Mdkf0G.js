(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function sf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function I_(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var r=e.default;if(typeof r=="function"){var t=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),t}var Lh={exports:{}},yc={},Rh={exports:{}},Tt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var og;function O_(){if(og)return Tt;og=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),y=Symbol.iterator;function b(D){return D===null||typeof D!="object"?null:(D=y&&D[y]||D["@@iterator"],typeof D=="function"?D:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function C(D,P,I){this.props=D,this.context=P,this.refs=k,this.updater=I||E}C.prototype.isReactComponent={},C.prototype.setState=function(D,P){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,P,"setState")},C.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function R(){}R.prototype=C.prototype;function j(D,P,I){this.props=D,this.context=P,this.refs=k,this.updater=I||E}var N=j.prototype=new R;N.constructor=j,S(N,C.prototype),N.isPureReactComponent=!0;var F=Array.isArray,K=Object.prototype.hasOwnProperty,z={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function ne(D,P,I){var B,G={},te=null,de=null;if(P!=null)for(B in P.ref!==void 0&&(de=P.ref),P.key!==void 0&&(te=""+P.key),P)K.call(P,B)&&!O.hasOwnProperty(B)&&(G[B]=P[B]);var pe=arguments.length-2;if(pe===1)G.children=I;else if(1<pe){for(var me=Array(pe),ye=0;ye<pe;ye++)me[ye]=arguments[ye+2];G.children=me}if(D&&D.defaultProps)for(B in pe=D.defaultProps,pe)G[B]===void 0&&(G[B]=pe[B]);return{$$typeof:e,type:D,key:te,ref:de,props:G,_owner:z.current}}function ee(D,P){return{$$typeof:e,type:D.type,key:P,ref:D.ref,props:D.props,_owner:D._owner}}function ve(D){return typeof D=="object"&&D!==null&&D.$$typeof===e}function he(D){var P={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(I){return P[I]})}var ce=/\/+/g;function Ne(D,P){return typeof D=="object"&&D!==null&&D.key!=null?he(""+D.key):P.toString(36)}function xe(D,P,I,B,G){var te=typeof D;(te==="undefined"||te==="boolean")&&(D=null);var de=!1;if(D===null)de=!0;else switch(te){case"string":case"number":de=!0;break;case"object":switch(D.$$typeof){case e:case r:de=!0}}if(de)return de=D,G=G(de),D=B===""?"."+Ne(de,0):B,F(G)?(I="",D!=null&&(I=D.replace(ce,"$&/")+"/"),xe(G,P,I,"",function(ye){return ye})):G!=null&&(ve(G)&&(G=ee(G,I+(!G.key||de&&de.key===G.key?"":(""+G.key).replace(ce,"$&/")+"/")+D)),P.push(G)),1;if(de=0,B=B===""?".":B+":",F(D))for(var pe=0;pe<D.length;pe++){te=D[pe];var me=B+Ne(te,pe);de+=xe(te,P,I,me,G)}else if(me=b(D),typeof me=="function")for(D=me.call(D),pe=0;!(te=D.next()).done;)te=te.value,me=B+Ne(te,pe++),de+=xe(te,P,I,me,G);else if(te==="object")throw P=String(D),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.");return de}function le(D,P,I){if(D==null)return D;var B=[],G=0;return xe(D,B,"","",function(te){return P.call(I,te,G++)}),B}function Q(D){if(D._status===-1){var P=D._result;P=P(),P.then(function(I){(D._status===0||D._status===-1)&&(D._status=1,D._result=I)},function(I){(D._status===0||D._status===-1)&&(D._status=2,D._result=I)}),D._status===-1&&(D._status=0,D._result=P)}if(D._status===1)return D._result.default;throw D._result}var M={current:null},V={transition:null},H={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:V,ReactCurrentOwner:z};function se(){throw Error("act(...) is not supported in production builds of React.")}return Tt.Children={map:le,forEach:function(D,P,I){le(D,function(){P.apply(this,arguments)},I)},count:function(D){var P=0;return le(D,function(){P++}),P},toArray:function(D){return le(D,function(P){return P})||[]},only:function(D){if(!ve(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Tt.Component=C,Tt.Fragment=t,Tt.Profiler=a,Tt.PureComponent=j,Tt.StrictMode=n,Tt.Suspense=m,Tt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=H,Tt.act=se,Tt.cloneElement=function(D,P,I){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var B=S({},D.props),G=D.key,te=D.ref,de=D._owner;if(P!=null){if(P.ref!==void 0&&(te=P.ref,de=z.current),P.key!==void 0&&(G=""+P.key),D.type&&D.type.defaultProps)var pe=D.type.defaultProps;for(me in P)K.call(P,me)&&!O.hasOwnProperty(me)&&(B[me]=P[me]===void 0&&pe!==void 0?pe[me]:P[me])}var me=arguments.length-2;if(me===1)B.children=I;else if(1<me){pe=Array(me);for(var ye=0;ye<me;ye++)pe[ye]=arguments[ye+2];B.children=pe}return{$$typeof:e,type:D.type,key:G,ref:te,props:B,_owner:de}},Tt.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:l,_context:D},D.Consumer=D},Tt.createElement=ne,Tt.createFactory=function(D){var P=ne.bind(null,D);return P.type=D,P},Tt.createRef=function(){return{current:null}},Tt.forwardRef=function(D){return{$$typeof:f,render:D}},Tt.isValidElement=ve,Tt.lazy=function(D){return{$$typeof:x,_payload:{_status:-1,_result:D},_init:Q}},Tt.memo=function(D,P){return{$$typeof:g,type:D,compare:P===void 0?null:P}},Tt.startTransition=function(D){var P=V.transition;V.transition={};try{D()}finally{V.transition=P}},Tt.unstable_act=se,Tt.useCallback=function(D,P){return M.current.useCallback(D,P)},Tt.useContext=function(D){return M.current.useContext(D)},Tt.useDebugValue=function(){},Tt.useDeferredValue=function(D){return M.current.useDeferredValue(D)},Tt.useEffect=function(D,P){return M.current.useEffect(D,P)},Tt.useId=function(){return M.current.useId()},Tt.useImperativeHandle=function(D,P,I){return M.current.useImperativeHandle(D,P,I)},Tt.useInsertionEffect=function(D,P){return M.current.useInsertionEffect(D,P)},Tt.useLayoutEffect=function(D,P){return M.current.useLayoutEffect(D,P)},Tt.useMemo=function(D,P){return M.current.useMemo(D,P)},Tt.useReducer=function(D,P,I){return M.current.useReducer(D,P,I)},Tt.useRef=function(D){return M.current.useRef(D)},Tt.useState=function(D){return M.current.useState(D)},Tt.useSyncExternalStore=function(D,P,I){return M.current.useSyncExternalStore(D,P,I)},Tt.useTransition=function(){return M.current.useTransition()},Tt.version="18.3.1",Tt}var lg;function U0(){return lg||(lg=1,Rh.exports=O_()),Rh.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cg;function j_(){if(cg)return yc;cg=1;var e=U0(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(f,m,g){var x,y={},b=null,E=null;g!==void 0&&(b=""+g),m.key!==void 0&&(b=""+m.key),m.ref!==void 0&&(E=m.ref);for(x in m)n.call(m,x)&&!l.hasOwnProperty(x)&&(y[x]=m[x]);if(f&&f.defaultProps)for(x in m=f.defaultProps,m)y[x]===void 0&&(y[x]=m[x]);return{$$typeof:r,type:f,key:b,ref:E,props:y,_owner:a.current}}return yc.Fragment=t,yc.jsx=c,yc.jsxs=c,yc}var ug;function F_(){return ug||(ug=1,Lh.exports=j_()),Lh.exports}var u=F_(),gd={},Mh={exports:{}},Pn={},Bh={exports:{}},zh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dg;function L_(){return dg||(dg=1,(function(e){function r(V,H){var se=V.length;V.push(H);e:for(;0<se;){var D=se-1>>>1,P=V[D];if(0<a(P,H))V[D]=H,V[se]=P,se=D;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var H=V[0],se=V.pop();if(se!==H){V[0]=se;e:for(var D=0,P=V.length,I=P>>>1;D<I;){var B=2*(D+1)-1,G=V[B],te=B+1,de=V[te];if(0>a(G,se))te<P&&0>a(de,G)?(V[D]=de,V[te]=se,D=te):(V[D]=G,V[B]=se,D=B);else if(te<P&&0>a(de,se))V[D]=de,V[te]=se,D=te;else break e}}return H}function a(V,H){var se=V.sortIndex-H.sortIndex;return se!==0?se:V.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,f=c.now();e.unstable_now=function(){return c.now()-f}}var m=[],g=[],x=1,y=null,b=3,E=!1,S=!1,k=!1,C=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(V){for(var H=t(g);H!==null;){if(H.callback===null)n(g);else if(H.startTime<=V)n(g),H.sortIndex=H.expirationTime,r(m,H);else break;H=t(g)}}function F(V){if(k=!1,N(V),!S)if(t(m)!==null)S=!0,Q(K);else{var H=t(g);H!==null&&M(F,H.startTime-V)}}function K(V,H){S=!1,k&&(k=!1,R(ne),ne=-1),E=!0;var se=b;try{for(N(H),y=t(m);y!==null&&(!(y.expirationTime>H)||V&&!he());){var D=y.callback;if(typeof D=="function"){y.callback=null,b=y.priorityLevel;var P=D(y.expirationTime<=H);H=e.unstable_now(),typeof P=="function"?y.callback=P:y===t(m)&&n(m),N(H)}else n(m);y=t(m)}if(y!==null)var I=!0;else{var B=t(g);B!==null&&M(F,B.startTime-H),I=!1}return I}finally{y=null,b=se,E=!1}}var z=!1,O=null,ne=-1,ee=5,ve=-1;function he(){return!(e.unstable_now()-ve<ee)}function ce(){if(O!==null){var V=e.unstable_now();ve=V;var H=!0;try{H=O(!0,V)}finally{H?Ne():(z=!1,O=null)}}else z=!1}var Ne;if(typeof j=="function")Ne=function(){j(ce)};else if(typeof MessageChannel<"u"){var xe=new MessageChannel,le=xe.port2;xe.port1.onmessage=ce,Ne=function(){le.postMessage(null)}}else Ne=function(){C(ce,0)};function Q(V){O=V,z||(z=!0,Ne())}function M(V,H){ne=C(function(){V(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){S||E||(S=!0,Q(K))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ee=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_getFirstCallbackNode=function(){return t(m)},e.unstable_next=function(V){switch(b){case 1:case 2:case 3:var H=3;break;default:H=b}var se=b;b=H;try{return V()}finally{b=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,H){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var se=b;b=V;try{return H()}finally{b=se}},e.unstable_scheduleCallback=function(V,H,se){var D=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?D+se:D):se=D,V){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=se+P,V={id:x++,callback:H,priorityLevel:V,startTime:se,expirationTime:P,sortIndex:-1},se>D?(V.sortIndex=se,r(g,V),t(m)===null&&V===t(g)&&(k?(R(ne),ne=-1):k=!0,M(F,se-D))):(V.sortIndex=P,r(m,V),S||E||(S=!0,Q(K))),V},e.unstable_shouldYield=he,e.unstable_wrapCallback=function(V){var H=b;return function(){var se=b;b=H;try{return V.apply(this,arguments)}finally{b=se}}}})(zh)),zh}var fg;function R_(){return fg||(fg=1,Bh.exports=L_()),Bh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hg;function M_(){if(hg)return Pn;hg=1;var e=U0(),r=R_();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function l(i,o){c(i,o),c(i+"Capture",o)}function c(i,o){for(a[i]=o,i=0;i<o.length;i++)n.add(o[i])}var f=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},y={};function b(i){return m.call(y,i)?!0:m.call(x,i)?!1:g.test(i)?y[i]=!0:(x[i]=!0,!1)}function E(i,o,h,v){if(h!==null&&h.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return v?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function S(i,o,h,v){if(o===null||typeof o>"u"||E(i,o,h,v))return!0;if(v)return!1;if(h!==null)switch(h.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function k(i,o,h,v,w,T,W){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=v,this.attributeNamespace=w,this.mustUseProperty=h,this.propertyName=i,this.type=o,this.sanitizeURL=T,this.removeEmptyString=W}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){C[i]=new k(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];C[o]=new k(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){C[i]=new k(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){C[i]=new k(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){C[i]=new k(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){C[i]=new k(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){C[i]=new k(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){C[i]=new k(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){C[i]=new k(i,5,!1,i.toLowerCase(),null,!1,!1)});var R=/[\-:]([a-z])/g;function j(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(R,j);C[o]=new k(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(R,j);C[o]=new k(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(R,j);C[o]=new k(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){C[i]=new k(i,1,!1,i.toLowerCase(),null,!1,!1)}),C.xlinkHref=new k("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){C[i]=new k(i,1,!1,i.toLowerCase(),null,!0,!0)});function N(i,o,h,v){var w=C.hasOwnProperty(o)?C[o]:null;(w!==null?w.type!==0:v||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(S(o,h,w,v)&&(h=null),v||w===null?b(o)&&(h===null?i.removeAttribute(o):i.setAttribute(o,""+h)):w.mustUseProperty?i[w.propertyName]=h===null?w.type===3?!1:"":h:(o=w.attributeName,v=w.attributeNamespace,h===null?i.removeAttribute(o):(w=w.type,h=w===3||w===4&&h===!0?"":""+h,v?i.setAttributeNS(v,o,h):i.setAttribute(o,h))))}var F=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,K=Symbol.for("react.element"),z=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),ne=Symbol.for("react.strict_mode"),ee=Symbol.for("react.profiler"),ve=Symbol.for("react.provider"),he=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),Ne=Symbol.for("react.suspense"),xe=Symbol.for("react.suspense_list"),le=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),M=Symbol.for("react.offscreen"),V=Symbol.iterator;function H(i){return i===null||typeof i!="object"?null:(i=V&&i[V]||i["@@iterator"],typeof i=="function"?i:null)}var se=Object.assign,D;function P(i){if(D===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);D=o&&o[1]||""}return`
`+D+i}var I=!1;function B(i,o){if(!i||I)return"";I=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Pe){var v=Pe}Reflect.construct(i,[],o)}else{try{o.call()}catch(Pe){v=Pe}i.call(o.prototype)}else{try{throw Error()}catch(Pe){v=Pe}i()}}catch(Pe){if(Pe&&v&&typeof Pe.stack=="string"){for(var w=Pe.stack.split(`
`),T=v.stack.split(`
`),W=w.length-1,oe=T.length-1;1<=W&&0<=oe&&w[W]!==T[oe];)oe--;for(;1<=W&&0<=oe;W--,oe--)if(w[W]!==T[oe]){if(W!==1||oe!==1)do if(W--,oe--,0>oe||w[W]!==T[oe]){var fe=`
`+w[W].replace(" at new "," at ");return i.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",i.displayName)),fe}while(1<=W&&0<=oe);break}}}finally{I=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?P(i):""}function G(i){switch(i.tag){case 5:return P(i.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return i=B(i.type,!1),i;case 11:return i=B(i.type.render,!1),i;case 1:return i=B(i.type,!0),i;default:return""}}function te(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case O:return"Fragment";case z:return"Portal";case ee:return"Profiler";case ne:return"StrictMode";case Ne:return"Suspense";case xe:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case he:return(i.displayName||"Context")+".Consumer";case ve:return(i._context.displayName||"Context")+".Provider";case ce:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case le:return o=i.displayName||null,o!==null?o:te(i.type)||"Memo";case Q:o=i._payload,i=i._init;try{return te(i(o))}catch{}}return null}function de(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return te(o);case 8:return o===ne?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function pe(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function me(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ye(i){var o=me(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),v=""+i[o];if(!i.hasOwnProperty(o)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var w=h.get,T=h.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return w.call(this)},set:function(W){v=""+W,T.call(this,W)}}),Object.defineProperty(i,o,{enumerable:h.enumerable}),{getValue:function(){return v},setValue:function(W){v=""+W},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Ke(i){i._valueTracker||(i._valueTracker=ye(i))}function ae(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var h=o.getValue(),v="";return i&&(v=me(i)?i.checked?"true":"false":i.value),i=v,i!==h?(o.setValue(i),!0):!1}function at(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function dt(i,o){var h=o.checked;return se({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function mt(i,o){var h=o.defaultValue==null?"":o.defaultValue,v=o.checked!=null?o.checked:o.defaultChecked;h=pe(o.value!=null?o.value:h),i._wrapperState={initialChecked:v,initialValue:h,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function st(i,o){o=o.checked,o!=null&&N(i,"checked",o,!1)}function Le(i,o){st(i,o);var h=pe(o.value),v=o.type;if(h!=null)v==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(v==="submit"||v==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?dr(i,o.type,h):o.hasOwnProperty("defaultValue")&&dr(i,o.type,pe(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function At(i,o,h){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var v=o.type;if(!(v!=="submit"&&v!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,h||o===i.value||(i.value=o),i.defaultValue=o}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function dr(i,o,h){(o!=="number"||at(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var Yt=Array.isArray;function Qt(i,o,h,v){if(i=i.options,o){o={};for(var w=0;w<h.length;w++)o["$"+h[w]]=!0;for(h=0;h<i.length;h++)w=o.hasOwnProperty("$"+i[h].value),i[h].selected!==w&&(i[h].selected=w),w&&v&&(i[h].defaultSelected=!0)}else{for(h=""+pe(h),o=null,w=0;w<i.length;w++){if(i[w].value===h){i[w].selected=!0,v&&(i[w].defaultSelected=!0);return}o!==null||i[w].disabled||(o=i[w])}o!==null&&(o.selected=!0)}}function _n(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return se({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function br(i,o){var h=o.value;if(h==null){if(h=o.children,o=o.defaultValue,h!=null){if(o!=null)throw Error(t(92));if(Yt(h)){if(1<h.length)throw Error(t(93));h=h[0]}o=h}o==null&&(o=""),h=o}i._wrapperState={initialValue:pe(h)}}function er(i,o){var h=pe(o.value),v=pe(o.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),o.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),v!=null&&(i.defaultValue=""+v)}function kr(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function fr(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Sr(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?fr(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var St,ir=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,h,v,w){MSApp.execUnsafeLocalFunction(function(){return i(o,h,v,w)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(St=St||document.createElement("div"),St.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=St.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function ct(i,o){if(o){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=o;return}}i.textContent=o}var Ge={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tr=["Webkit","ms","Moz","O"];Object.keys(Ge).forEach(function(i){Tr.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Ge[o]=Ge[i]})});function $t(i,o,h){return o==null||typeof o=="boolean"||o===""?"":h||typeof o!="number"||o===0||Ge.hasOwnProperty(i)&&Ge[i]?(""+o).trim():o+"px"}function Gr(i,o){i=i.style;for(var h in o)if(o.hasOwnProperty(h)){var v=h.indexOf("--")===0,w=$t(h,o[h],v);h==="float"&&(h="cssFloat"),v?i.setProperty(h,w):i[h]=w}}var sr=se({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ri(i,o){if(o){if(sr[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function ln(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fa=null;function La(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var da=null,Dn=null,In=null;function fa(i){if(i=mi(i)){if(typeof da!="function")throw Error(t(280));var o=i.stateNode;o&&(o=Wo(o),da(i.stateNode,i.type,o))}}function Di(i){Dn?In?In.push(i):In=[i]:Dn=i}function Ii(){if(Dn){var i=Dn,o=In;if(In=Dn=null,fa(i),o)for(i=0;i<o.length;i++)fa(o[i])}}function As(i,o){return i(o)}function ni(){}var Ie=!1;function qe(i,o,h){if(Ie)return i(o,h);Ie=!0;try{return As(i,o,h)}finally{Ie=!1,(Dn!==null||In!==null)&&(ni(),Ii())}}function Je(i,o){var h=i.stateNode;if(h===null)return null;var v=Wo(h);if(v===null)return null;h=v[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(t(231,o,typeof h));return h}var He=!1;if(f)try{var Qe={};Object.defineProperty(Qe,"passive",{get:function(){He=!0}}),window.addEventListener("test",Qe,Qe),window.removeEventListener("test",Qe,Qe)}catch{He=!1}function ot(i,o,h,v,w,T,W,oe,fe){var Pe=Array.prototype.slice.call(arguments,3);try{o.apply(h,Pe)}catch(Re){this.onError(Re)}}var it=!1,Oe=null,U=!1,re=null,q={onError:function(i){it=!0,Oe=i}};function X(i,o,h,v,w,T,W,oe,fe){it=!1,Oe=null,ot.apply(q,arguments)}function J(i,o,h,v,w,T,W,oe,fe){if(X.apply(this,arguments),it){if(it){var Pe=Oe;it=!1,Oe=null}else throw Error(t(198));U||(U=!0,re=Pe)}}function ie(i){var o=i,h=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(h=o.return),i=o.return;while(i)}return o.tag===3?h:null}function ke(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function De(i){if(ie(i)!==i)throw Error(t(188))}function Se(i){var o=i.alternate;if(!o){if(o=ie(i),o===null)throw Error(t(188));return o!==i?null:i}for(var h=i,v=o;;){var w=h.return;if(w===null)break;var T=w.alternate;if(T===null){if(v=w.return,v!==null){h=v;continue}break}if(w.child===T.child){for(T=w.child;T;){if(T===h)return De(w),i;if(T===v)return De(w),o;T=T.sibling}throw Error(t(188))}if(h.return!==v.return)h=w,v=T;else{for(var W=!1,oe=w.child;oe;){if(oe===h){W=!0,h=w,v=T;break}if(oe===v){W=!0,v=w,h=T;break}oe=oe.sibling}if(!W){for(oe=T.child;oe;){if(oe===h){W=!0,h=T,v=w;break}if(oe===v){W=!0,v=T,h=w;break}oe=oe.sibling}if(!W)throw Error(t(189))}}if(h.alternate!==v)throw Error(t(190))}if(h.tag!==3)throw Error(t(188));return h.stateNode.current===h?i:o}function Ee(i){return i=Se(i),i!==null?Ce(i):null}function Ce(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=Ce(i);if(o!==null)return o;i=i.sibling}return null}var Me=r.unstable_scheduleCallback,Ve=r.unstable_cancelCallback,Ye=r.unstable_shouldYield,$e=r.unstable_requestPaint,Ue=r.unstable_now,vt=r.unstable_getCurrentPriorityLevel,Rt=r.unstable_ImmediatePriority,Bt=r.unstable_UserBlockingPriority,tr=r.unstable_NormalPriority,ha=r.unstable_LowPriority,wn=r.unstable_IdlePriority,On=null,hr=null;function ma(i){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(On,i,void 0,(i.current.flags&128)===128)}catch{}}var lt=Math.clz32?Math.clz32:Oi,Kt=Math.log,wo=Math.LN2;function Oi(i){return i>>>=0,i===0?32:31-(Kt(i)/wo|0)|0}var pa=64,ji=4194304;function yt(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Vt(i,o){var h=i.pendingLanes;if(h===0)return 0;var v=0,w=i.suspendedLanes,T=i.pingedLanes,W=h&268435455;if(W!==0){var oe=W&~w;oe!==0?v=yt(oe):(T&=W,T!==0&&(v=yt(T)))}else W=h&~w,W!==0?v=yt(W):T!==0&&(v=yt(T));if(v===0)return 0;if(o!==0&&o!==v&&(o&w)===0&&(w=v&-v,T=o&-o,w>=T||w===16&&(T&4194240)!==0))return o;if((v&4)!==0&&(v|=h&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=v;0<o;)h=31-lt(o),w=1<<h,v|=i[h],o&=~w;return v}function Fl(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bo(i,o){for(var h=i.suspendedLanes,v=i.pingedLanes,w=i.expirationTimes,T=i.pendingLanes;0<T;){var W=31-lt(T),oe=1<<W,fe=w[W];fe===-1?((oe&h)===0||(oe&v)!==0)&&(w[W]=Fl(oe,o)):fe<=o&&(i.expiredLanes|=oe),T&=~oe}}function Zr(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function cu(){var i=pa;return pa<<=1,(pa&4194240)===0&&(pa=64),i}function Fi(i){for(var o=[],h=0;31>h;h++)o.push(i);return o}function jn(i,o,h){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-lt(o),i[o]=h}function or(i,o){var h=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var v=i.eventTimes;for(i=i.expirationTimes;0<h;){var w=31-lt(h),T=1<<w;o[w]=0,v[w]=-1,i[w]=-1,h&=~T}}function ga(i,o){var h=i.entangledLanes|=o;for(i=i.entanglements;h;){var v=31-lt(h),w=1<<v;w&o|i[v]&o&&(i[v]|=o),h&=~w}}var Pt=0;function Li(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var ko,ai,So,To,Ps,Ns=!1,Ri=[],Fn=null,va=null,Zn=null,Ds=new Map,pt=new Map,Er=[],zt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ll(i,o){switch(i){case"focusin":case"focusout":Fn=null;break;case"dragenter":case"dragleave":va=null;break;case"mouseover":case"mouseout":Zn=null;break;case"pointerover":case"pointerout":Ds.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":pt.delete(o.pointerId)}}function ii(i,o,h,v,w,T){return i===null||i.nativeEvent!==T?(i={blockedOn:o,domEventName:h,eventSystemFlags:v,nativeEvent:T,targetContainers:[w]},o!==null&&(o=mi(o),o!==null&&ai(o)),i):(i.eventSystemFlags|=v,o=i.targetContainers,w!==null&&o.indexOf(w)===-1&&o.push(w),i)}function Rl(i,o,h,v,w){switch(o){case"focusin":return Fn=ii(Fn,i,o,h,v,w),!0;case"dragenter":return va=ii(va,i,o,h,v,w),!0;case"mouseover":return Zn=ii(Zn,i,o,h,v,w),!0;case"pointerover":var T=w.pointerId;return Ds.set(T,ii(Ds.get(T)||null,i,o,h,v,w)),!0;case"gotpointercapture":return T=w.pointerId,pt.set(T,ii(pt.get(T)||null,i,o,h,v,w)),!0}return!1}function Eo(i){var o=hi(i.target);if(o!==null){var h=ie(o);if(h!==null){if(o=h.tag,o===13){if(o=ke(h),o!==null){i.blockedOn=o,Ps(i.priority,function(){So(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Kn(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var h=Po(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var v=new h.constructor(h.type,h);Fa=v,h.target.dispatchEvent(v),Fa=null}else return o=mi(h),o!==null&&ai(o),i.blockedOn=h,!1;o.shift()}return!0}function Co(i,o,h){Kn(i)&&h.delete(o)}function Is(){Ns=!1,Fn!==null&&Kn(Fn)&&(Fn=null),va!==null&&Kn(va)&&(va=null),Zn!==null&&Kn(Zn)&&(Zn=null),Ds.forEach(Co),pt.forEach(Co)}function rr(i,o){i.blockedOn===o&&(i.blockedOn=null,Ns||(Ns=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Is)))}function Ln(i){function o(w){return rr(w,i)}if(0<Ri.length){rr(Ri[0],i);for(var h=1;h<Ri.length;h++){var v=Ri[h];v.blockedOn===i&&(v.blockedOn=null)}}for(Fn!==null&&rr(Fn,i),va!==null&&rr(va,i),Zn!==null&&rr(Zn,i),Ds.forEach(o),pt.forEach(o),h=0;h<Er.length;h++)v=Er[h],v.blockedOn===i&&(v.blockedOn=null);for(;0<Er.length&&(h=Er[0],h.blockedOn===null);)Eo(h),h.blockedOn===null&&Er.shift()}var si=F.ReactCurrentBatchConfig,Os=!0;function vf(i,o,h,v){var w=Pt,T=si.transition;si.transition=null;try{Pt=1,js(i,o,h,v)}finally{Pt=w,si.transition=T}}function uu(i,o,h,v){var w=Pt,T=si.transition;si.transition=null;try{Pt=4,js(i,o,h,v)}finally{Pt=w,si.transition=T}}function js(i,o,h,v){if(Os){var w=Po(i,o,h,v);if(w===null)s(i,o,v,Ao,h),Ll(i,v);else if(Rl(w,i,o,h,v))v.stopPropagation();else if(Ll(i,v),o&4&&-1<zt.indexOf(i)){for(;w!==null;){var T=mi(w);if(T!==null&&ko(T),T=Po(i,o,h,v),T===null&&s(i,o,v,Ao,h),T===w)break;w=T}w!==null&&v.stopPropagation()}else s(i,o,v,null,h)}}var Ao=null;function Po(i,o,h,v){if(Ao=null,i=La(v),i=hi(i),i!==null)if(o=ie(i),o===null)i=null;else if(h=o.tag,h===13){if(i=ke(o),i!==null)return i;i=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Ao=i,null}function Et(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vt()){case Rt:return 1;case Bt:return 4;case tr:case ha:return 16;case wn:return 536870912;default:return 16}default:return 16}}var Ra=null,cn=null,Ma=null;function Ml(){if(Ma)return Ma;var i,o=cn,h=o.length,v,w="value"in Ra?Ra.value:Ra.textContent,T=w.length;for(i=0;i<h&&o[i]===w[i];i++);var W=h-i;for(v=1;v<=W&&o[h-v]===w[T-v];v++);return Ma=w.slice(i,1<v?1-v:void 0)}function No(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Mi(){return!0}function du(){return!1}function Kr(i){function o(h,v,w,T,W){this._reactName=h,this._targetInst=w,this.type=v,this.nativeEvent=T,this.target=W,this.currentTarget=null;for(var oe in i)i.hasOwnProperty(oe)&&(h=i[oe],this[oe]=h?h(T):T[oe]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Mi:du,this.isPropagationStopped=du,this}return se(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Mi)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Mi)},persist:function(){},isPersistent:Mi}),o}var Bi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bl=Kr(Bi),oi=se({},Bi,{view:0,detail:0}),xf=Kr(oi),bn,zl,zi,Rn=se({},oi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ci,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==zi&&(zi&&i.type==="mousemove"?(bn=i.screenX-zi.screenX,zl=i.screenY-zi.screenY):zl=bn=0,zi=i),bn)},movementY:function(i){return"movementY"in i?i.movementY:zl}}),Ul=Kr(Rn),fu=se({},Rn,{dataTransfer:0}),$l=Kr(fu),yf=se({},oi,{relatedTarget:0}),Do=Kr(yf),hu=se({},Bi,{animationName:0,elapsedTime:0,pseudoElement:0}),_f=Kr(hu),wf=se({},Bi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Wl=Kr(wf),bf=se({},Bi,{data:0}),Vl=Kr(bf),mu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Io={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},li={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kf(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=li[i])?!!o[i]:!1}function ci(){return kf}var kn=se({},oi,{key:function(i){if(i.key){var o=mu[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=No(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Io[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ci,charCode:function(i){return i.type==="keypress"?No(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?No(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),pu=Kr(kn),gu=se({},Rn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vu=Kr(gu),Hl=se({},oi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ci}),Gl=Kr(Hl),Sf=se({},Bi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tf=Kr(Sf),xu=se({},Rn,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Ef=Kr(xu),Mn=[9,13,27,32],Ba=f&&"CompositionEvent"in window,Fs=null;f&&"documentMode"in document&&(Fs=document.documentMode);var xa=f&&"TextEvent"in window&&!Fs,yu=f&&(!Ba||Fs&&8<Fs&&11>=Fs),ui=" ",_u=!1;function Ui(i,o){switch(i){case"keyup":return Mn.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zl(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ya=!1;function Cf(i,o){switch(i){case"compositionend":return Zl(o);case"keypress":return o.which!==32?null:(_u=!0,ui);case"textInput":return i=o.data,i===ui&&_u?null:i;default:return null}}function za(i,o){if(ya)return i==="compositionend"||!Ba&&Ui(i,o)?(i=Ml(),Ma=cn=Ra=null,ya=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return yu&&o.locale!=="ko"?null:o.data;default:return null}}var Oo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wu(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Oo[i.type]:o==="textarea"}function jo(i,o,h,v){Di(v),o=p(o,"onChange"),0<o.length&&(h=new Bl("onChange","change",null,h,v),i.push({event:h,listeners:o}))}var Ls=null,un=null;function Af(i){rc(i,0)}function _a(i){var o=pi(i);if(ae(o))return i}function Pf(i,o){if(i==="change")return o}var qn=!1;if(f){var $i;if(f){var Fo="oninput"in document;if(!Fo){var Lo=document.createElement("div");Lo.setAttribute("oninput","return;"),Fo=typeof Lo.oninput=="function"}$i=Fo}else $i=!1;qn=$i&&(!document.documentMode||9<document.documentMode)}function Rs(){Ls&&(Ls.detachEvent("onpropertychange",Ro),un=Ls=null)}function Ro(i){if(i.propertyName==="value"&&_a(un)){var o=[];jo(o,un,i,La(i)),qe(Af,o)}}function Mo(i,o,h){i==="focusin"?(Rs(),Ls=o,un=h,Ls.attachEvent("onpropertychange",Ro)):i==="focusout"&&Rs()}function Wi(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return _a(un)}function Bo(i,o){if(i==="click")return _a(o)}function Kl(i,o){if(i==="input"||i==="change")return _a(o)}function bu(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Bn=typeof Object.is=="function"?Object.is:bu;function Ua(i,o){if(Bn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var h=Object.keys(i),v=Object.keys(o);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var w=h[v];if(!m.call(o,w)||!Bn(i[w],o[w]))return!1}return!0}function ku(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function ql(i,o){var h=ku(i);i=0;for(var v;h;){if(h.nodeType===3){if(v=i+h.textContent.length,i<=o&&v>=o)return{node:h,offset:o-i};i=v}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=ku(h)}}function Su(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Su(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Yl(){for(var i=window,o=at();o instanceof i.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)i=o.contentWindow;else break;o=at(i.document)}return o}function Xl(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function Yn(i){var o=Yl(),h=i.focusedElem,v=i.selectionRange;if(o!==h&&h&&h.ownerDocument&&Su(h.ownerDocument.documentElement,h)){if(v!==null&&Xl(h)){if(o=v.start,i=v.end,i===void 0&&(i=o),"selectionStart"in h)h.selectionStart=o,h.selectionEnd=Math.min(i,h.value.length);else if(i=(o=h.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var w=h.textContent.length,T=Math.min(v.start,w);v=v.end===void 0?T:Math.min(v.end,w),!i.extend&&T>v&&(w=v,v=T,T=w),w=ql(h,T);var W=ql(h,v);w&&W&&(i.rangeCount!==1||i.anchorNode!==w.node||i.anchorOffset!==w.offset||i.focusNode!==W.node||i.focusOffset!==W.offset)&&(o=o.createRange(),o.setStart(w.node,w.offset),i.removeAllRanges(),T>v?(i.addRange(o),i.extend(W.node,W.offset)):(o.setEnd(W.node,W.offset),i.addRange(o)))}}for(o=[],i=h;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<o.length;h++)i=o[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var zo=f&&"documentMode"in document&&11>=document.documentMode,Vi=null,Hi=null,Ms=null,Uo=!1;function Tu(i,o,h){var v=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Uo||Vi==null||Vi!==at(v)||(v=Vi,"selectionStart"in v&&Xl(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Ms&&Ua(Ms,v)||(Ms=v,v=p(Hi,"onSelect"),0<v.length&&(o=new Bl("onSelect","select",null,o,h),i.push({event:o,listeners:v}),o.target=Vi)))}function $a(i,o){var h={};return h[i.toLowerCase()]=o.toLowerCase(),h["Webkit"+i]="webkit"+o,h["Moz"+i]="moz"+o,h}var Gi={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionend:$a("Transition","TransitionEnd")},Wa={},Jl={};f&&(Jl=document.createElement("div").style,"AnimationEvent"in window||(delete Gi.animationend.animation,delete Gi.animationiteration.animation,delete Gi.animationstart.animation),"TransitionEvent"in window||delete Gi.transitionend.transition);function Bs(i){if(Wa[i])return Wa[i];if(!Gi[i])return i;var o=Gi[i],h;for(h in o)if(o.hasOwnProperty(h)&&h in Jl)return Wa[i]=o[h];return i}var Eu=Bs("animationend"),Xn=Bs("animationiteration"),Ql=Bs("animationstart"),ec=Bs("transitionend"),Zi=new Map,Cu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zn(i,o){Zi.set(i,o),l(o,[i])}for(var di=0;di<Cu.length;di++){var $o=Cu[di],Au=$o.toLowerCase(),Nf=$o[0].toUpperCase()+$o.slice(1);zn(Au,"on"+Nf)}zn(Eu,"onAnimationEnd"),zn(Xn,"onAnimationIteration"),zn(Ql,"onAnimationStart"),zn("dblclick","onDoubleClick"),zn("focusin","onFocus"),zn("focusout","onBlur"),zn(ec,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pu=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ki));function tc(i,o,h){var v=i.type||"unknown-event";i.currentTarget=h,J(v,o,void 0,i),i.currentTarget=null}function rc(i,o){o=(o&4)!==0;for(var h=0;h<i.length;h++){var v=i[h],w=v.event;v=v.listeners;e:{var T=void 0;if(o)for(var W=v.length-1;0<=W;W--){var oe=v[W],fe=oe.instance,Pe=oe.currentTarget;if(oe=oe.listener,fe!==T&&w.isPropagationStopped())break e;tc(w,oe,Pe),T=fe}else for(W=0;W<v.length;W++){if(oe=v[W],fe=oe.instance,Pe=oe.currentTarget,oe=oe.listener,fe!==T&&w.isPropagationStopped())break e;tc(w,oe,Pe),T=fe}}}if(U)throw i=re,U=!1,re=null,i}function Ut(i,o){var h=o[Ji];h===void 0&&(h=o[Ji]=new Set);var v=i+"__bubble";h.has(v)||(Nu(o,i,2,!1),h.add(v))}function nc(i,o,h){var v=0;o&&(v|=4),Nu(h,i,v,o)}var zs="_reactListening"+Math.random().toString(36).slice(2);function qi(i){if(!i[zs]){i[zs]=!0,n.forEach(function(h){h!=="selectionchange"&&(Pu.has(h)||nc(h,!1,i),nc(h,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[zs]||(o[zs]=!0,nc("selectionchange",!1,o))}}function Nu(i,o,h,v){switch(Et(o)){case 1:var w=vf;break;case 4:w=uu;break;default:w=js}h=w.bind(null,o,h,i),w=void 0,!He||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(w=!0),v?w!==void 0?i.addEventListener(o,h,{capture:!0,passive:w}):i.addEventListener(o,h,!0):w!==void 0?i.addEventListener(o,h,{passive:w}):i.addEventListener(o,h,!1)}function s(i,o,h,v,w){var T=v;if((o&1)===0&&(o&2)===0&&v!==null)e:for(;;){if(v===null)return;var W=v.tag;if(W===3||W===4){var oe=v.stateNode.containerInfo;if(oe===w||oe.nodeType===8&&oe.parentNode===w)break;if(W===4)for(W=v.return;W!==null;){var fe=W.tag;if((fe===3||fe===4)&&(fe=W.stateNode.containerInfo,fe===w||fe.nodeType===8&&fe.parentNode===w))return;W=W.return}for(;oe!==null;){if(W=hi(oe),W===null)return;if(fe=W.tag,fe===5||fe===6){v=T=W;continue e}oe=oe.parentNode}}v=v.return}qe(function(){var Pe=T,Re=La(h),ze=[];e:{var Fe=Zi.get(i);if(Fe!==void 0){var Xe=Bl,tt=i;switch(i){case"keypress":if(No(h)===0)break e;case"keydown":case"keyup":Xe=pu;break;case"focusin":tt="focus",Xe=Do;break;case"focusout":tt="blur",Xe=Do;break;case"beforeblur":case"afterblur":Xe=Do;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Xe=Ul;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Xe=$l;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Xe=Gl;break;case Eu:case Xn:case Ql:Xe=_f;break;case ec:Xe=Tf;break;case"scroll":Xe=xf;break;case"wheel":Xe=Ef;break;case"copy":case"cut":case"paste":Xe=Wl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Xe=vu}var rt=(o&4)!==0,mr=!rt&&i==="scroll",we=rt?Fe!==null?Fe+"Capture":null:Fe;rt=[];for(var ge=Pe,Te;ge!==null;){Te=ge;var We=Te.stateNode;if(Te.tag===5&&We!==null&&(Te=We,we!==null&&(We=Je(ge,we),We!=null&&rt.push(d(ge,We,Te)))),mr)break;ge=ge.return}0<rt.length&&(Fe=new Xe(Fe,tt,null,h,Re),ze.push({event:Fe,listeners:rt}))}}if((o&7)===0){e:{if(Fe=i==="mouseover"||i==="pointerover",Xe=i==="mouseout"||i==="pointerout",Fe&&h!==Fa&&(tt=h.relatedTarget||h.fromElement)&&(hi(tt)||tt[Lt]))break e;if((Xe||Fe)&&(Fe=Re.window===Re?Re:(Fe=Re.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,Xe?(tt=h.relatedTarget||h.toElement,Xe=Pe,tt=tt?hi(tt):null,tt!==null&&(mr=ie(tt),tt!==mr||tt.tag!==5&&tt.tag!==6)&&(tt=null)):(Xe=null,tt=Pe),Xe!==tt)){if(rt=Ul,We="onMouseLeave",we="onMouseEnter",ge="mouse",(i==="pointerout"||i==="pointerover")&&(rt=vu,We="onPointerLeave",we="onPointerEnter",ge="pointer"),mr=Xe==null?Fe:pi(Xe),Te=tt==null?Fe:pi(tt),Fe=new rt(We,ge+"leave",Xe,h,Re),Fe.target=mr,Fe.relatedTarget=Te,We=null,hi(Re)===Pe&&(rt=new rt(we,ge+"enter",tt,h,Re),rt.target=Te,rt.relatedTarget=mr,We=rt),mr=We,Xe&&tt)t:{for(rt=Xe,we=tt,ge=0,Te=rt;Te;Te=_(Te))ge++;for(Te=0,We=we;We;We=_(We))Te++;for(;0<ge-Te;)rt=_(rt),ge--;for(;0<Te-ge;)we=_(we),Te--;for(;ge--;){if(rt===we||we!==null&&rt===we.alternate)break t;rt=_(rt),we=_(we)}rt=null}else rt=null;Xe!==null&&A(ze,Fe,Xe,rt,!1),tt!==null&&mr!==null&&A(ze,mr,tt,rt,!0)}}e:{if(Fe=Pe?pi(Pe):window,Xe=Fe.nodeName&&Fe.nodeName.toLowerCase(),Xe==="select"||Xe==="input"&&Fe.type==="file")var nt=Pf;else if(wu(Fe))if(qn)nt=Kl;else{nt=Wi;var ft=Mo}else(Xe=Fe.nodeName)&&Xe.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(nt=Bo);if(nt&&(nt=nt(i,Pe))){jo(ze,nt,h,Re);break e}ft&&ft(i,Fe,Pe),i==="focusout"&&(ft=Fe._wrapperState)&&ft.controlled&&Fe.type==="number"&&dr(Fe,"number",Fe.value)}switch(ft=Pe?pi(Pe):window,i){case"focusin":(wu(ft)||ft.contentEditable==="true")&&(Vi=ft,Hi=Pe,Ms=null);break;case"focusout":Ms=Hi=Vi=null;break;case"mousedown":Uo=!0;break;case"contextmenu":case"mouseup":case"dragend":Uo=!1,Tu(ze,h,Re);break;case"selectionchange":if(zo)break;case"keydown":case"keyup":Tu(ze,h,Re)}var ht;if(Ba)e:{switch(i){case"compositionstart":var xt="onCompositionStart";break e;case"compositionend":xt="onCompositionEnd";break e;case"compositionupdate":xt="onCompositionUpdate";break e}xt=void 0}else ya?Ui(i,h)&&(xt="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(xt="onCompositionStart");xt&&(yu&&h.locale!=="ko"&&(ya||xt!=="onCompositionStart"?xt==="onCompositionEnd"&&ya&&(ht=Ml()):(Ra=Re,cn="value"in Ra?Ra.value:Ra.textContent,ya=!0)),ft=p(Pe,xt),0<ft.length&&(xt=new Vl(xt,i,null,h,Re),ze.push({event:xt,listeners:ft}),ht?xt.data=ht:(ht=Zl(h),ht!==null&&(xt.data=ht)))),(ht=xa?Cf(i,h):za(i,h))&&(Pe=p(Pe,"onBeforeInput"),0<Pe.length&&(Re=new Vl("onBeforeInput","beforeinput",null,h,Re),ze.push({event:Re,listeners:Pe}),Re.data=ht))}rc(ze,o)})}function d(i,o,h){return{instance:i,listener:o,currentTarget:h}}function p(i,o){for(var h=o+"Capture",v=[];i!==null;){var w=i,T=w.stateNode;w.tag===5&&T!==null&&(w=T,T=Je(i,h),T!=null&&v.unshift(d(i,T,w)),T=Je(i,o),T!=null&&v.push(d(i,T,w))),i=i.return}return v}function _(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function A(i,o,h,v,w){for(var T=o._reactName,W=[];h!==null&&h!==v;){var oe=h,fe=oe.alternate,Pe=oe.stateNode;if(fe!==null&&fe===v)break;oe.tag===5&&Pe!==null&&(oe=Pe,w?(fe=Je(h,T),fe!=null&&W.unshift(d(h,fe,oe))):w||(fe=Je(h,T),fe!=null&&W.push(d(h,fe,oe)))),h=h.return}W.length!==0&&i.push({event:o,listeners:W})}var Z=/\r\n?/g,ue=/\u0000|\uFFFD/g;function _e(i){return(typeof i=="string"?i:""+i).replace(Z,`
`).replace(ue,"")}function Ae(i,o,h){if(o=_e(o),_e(i)!==o&&h)throw Error(t(425))}function je(){}var Ze=null,ut=null;function wt(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Cr=typeof setTimeout=="function"?setTimeout:void 0,gr=typeof clearTimeout=="function"?clearTimeout:void 0,dn=typeof Promise=="function"?Promise:void 0,qr=typeof queueMicrotask=="function"?queueMicrotask:typeof dn<"u"?function(i){return dn.resolve(null).then(i).catch(Yi)}:Cr;function Yi(i){setTimeout(function(){throw i})}function ac(i,o){var h=o,v=0;do{var w=h.nextSibling;if(i.removeChild(h),w&&w.nodeType===8)if(h=w.data,h==="/$"){if(v===0){i.removeChild(w),Ln(o);return}v--}else h!=="$"&&h!=="$?"&&h!=="$!"||v++;h=w}while(h);Ln(o)}function Va(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Du(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(o===0)return i;o--}else h==="/$"&&o++}i=i.previousSibling}return null}var fi=Math.random().toString(36).slice(2),Jn="__reactFiber$"+fi,Xi="__reactProps$"+fi,Lt="__reactContainer$"+fi,Ji="__reactEvents$"+fi,Df="__reactListeners$"+fi,If="__reactHandles$"+fi;function hi(i){var o=i[Jn];if(o)return o;for(var h=i.parentNode;h;){if(o=h[Lt]||h[Jn]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(i=Du(i);i!==null;){if(h=i[Jn])return h;i=Du(i)}return o}i=h,h=i.parentNode}return null}function mi(i){return i=i[Jn]||i[Lt],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function pi(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Wo(i){return i[Xi]||null}var Of=[],Vo=-1;function Qi(i){return{current:i}}function qt(i){0>Vo||(i.current=Of[Vo],Of[Vo]=null,Vo--)}function Ht(i,o){Vo++,Of[Vo]=i.current,i.current=o}var es={},Yr=Qi(es),Sn=Qi(!1),Us=es;function Ho(i,o){var h=i.type.contextTypes;if(!h)return es;var v=i.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===o)return v.__reactInternalMemoizedMaskedChildContext;var w={},T;for(T in h)w[T]=o[T];return v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=w),w}function Tn(i){return i=i.childContextTypes,i!=null}function Iu(){qt(Sn),qt(Yr)}function Pm(i,o,h){if(Yr.current!==es)throw Error(t(168));Ht(Yr,o),Ht(Sn,h)}function Nm(i,o,h){var v=i.stateNode;if(o=o.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var w in v)if(!(w in o))throw Error(t(108,de(i)||"Unknown",w));return se({},h,v)}function Ou(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||es,Us=Yr.current,Ht(Yr,i),Ht(Sn,Sn.current),!0}function Dm(i,o,h){var v=i.stateNode;if(!v)throw Error(t(169));h?(i=Nm(i,o,Us),v.__reactInternalMemoizedMergedChildContext=i,qt(Sn),qt(Yr),Ht(Yr,i)):qt(Sn),Ht(Sn,h)}var gi=null,ju=!1,jf=!1;function Im(i){gi===null?gi=[i]:gi.push(i)}function Xy(i){ju=!0,Im(i)}function ts(){if(!jf&&gi!==null){jf=!0;var i=0,o=Pt;try{var h=gi;for(Pt=1;i<h.length;i++){var v=h[i];do v=v(!0);while(v!==null)}gi=null,ju=!1}catch(w){throw gi!==null&&(gi=gi.slice(i+1)),Me(Rt,ts),w}finally{Pt=o,jf=!1}}return null}var Go=[],Zo=0,Fu=null,Lu=0,Qn=[],ea=0,$s=null,vi=1,xi="";function Ws(i,o){Go[Zo++]=Lu,Go[Zo++]=Fu,Fu=i,Lu=o}function Om(i,o,h){Qn[ea++]=vi,Qn[ea++]=xi,Qn[ea++]=$s,$s=i;var v=vi;i=xi;var w=32-lt(v)-1;v&=~(1<<w),h+=1;var T=32-lt(o)+w;if(30<T){var W=w-w%5;T=(v&(1<<W)-1).toString(32),v>>=W,w-=W,vi=1<<32-lt(o)+w|h<<w|v,xi=T+i}else vi=1<<T|h<<w|v,xi=i}function Ff(i){i.return!==null&&(Ws(i,1),Om(i,1,0))}function Lf(i){for(;i===Fu;)Fu=Go[--Zo],Go[Zo]=null,Lu=Go[--Zo],Go[Zo]=null;for(;i===$s;)$s=Qn[--ea],Qn[ea]=null,xi=Qn[--ea],Qn[ea]=null,vi=Qn[--ea],Qn[ea]=null}var Un=null,$n=null,Xt=!1,wa=null;function jm(i,o){var h=aa(5,null,null,0);h.elementType="DELETED",h.stateNode=o,h.return=i,o=i.deletions,o===null?(i.deletions=[h],i.flags|=16):o.push(h)}function Fm(i,o){switch(i.tag){case 5:var h=i.type;return o=o.nodeType!==1||h.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Un=i,$n=Va(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Un=i,$n=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(h=$s!==null?{id:vi,overflow:xi}:null,i.memoizedState={dehydrated:o,treeContext:h,retryLane:1073741824},h=aa(18,null,null,0),h.stateNode=o,h.return=i,i.child=h,Un=i,$n=null,!0):!1;default:return!1}}function Rf(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Mf(i){if(Xt){var o=$n;if(o){var h=o;if(!Fm(i,o)){if(Rf(i))throw Error(t(418));o=Va(h.nextSibling);var v=Un;o&&Fm(i,o)?jm(v,h):(i.flags=i.flags&-4097|2,Xt=!1,Un=i)}}else{if(Rf(i))throw Error(t(418));i.flags=i.flags&-4097|2,Xt=!1,Un=i}}}function Lm(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Un=i}function Ru(i){if(i!==Un)return!1;if(!Xt)return Lm(i),Xt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!wt(i.type,i.memoizedProps)),o&&(o=$n)){if(Rf(i))throw Rm(),Error(t(418));for(;o;)jm(i,o),o=Va(o.nextSibling)}if(Lm(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(o===0){$n=Va(i.nextSibling);break e}o--}else h!=="$"&&h!=="$!"&&h!=="$?"||o++}i=i.nextSibling}$n=null}}else $n=Un?Va(i.stateNode.nextSibling):null;return!0}function Rm(){for(var i=$n;i;)i=Va(i.nextSibling)}function Ko(){$n=Un=null,Xt=!1}function Bf(i){wa===null?wa=[i]:wa.push(i)}var Jy=F.ReactCurrentBatchConfig;function ic(i,o,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(t(309));var v=h.stateNode}if(!v)throw Error(t(147,i));var w=v,T=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===T?o.ref:(o=function(W){var oe=w.refs;W===null?delete oe[T]:oe[T]=W},o._stringRef=T,o)}if(typeof i!="string")throw Error(t(284));if(!h._owner)throw Error(t(290,i))}return i}function Mu(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Mm(i){var o=i._init;return o(i._payload)}function Bm(i){function o(we,ge){if(i){var Te=we.deletions;Te===null?(we.deletions=[ge],we.flags|=16):Te.push(ge)}}function h(we,ge){if(!i)return null;for(;ge!==null;)o(we,ge),ge=ge.sibling;return null}function v(we,ge){for(we=new Map;ge!==null;)ge.key!==null?we.set(ge.key,ge):we.set(ge.index,ge),ge=ge.sibling;return we}function w(we,ge){return we=cs(we,ge),we.index=0,we.sibling=null,we}function T(we,ge,Te){return we.index=Te,i?(Te=we.alternate,Te!==null?(Te=Te.index,Te<ge?(we.flags|=2,ge):Te):(we.flags|=2,ge)):(we.flags|=1048576,ge)}function W(we){return i&&we.alternate===null&&(we.flags|=2),we}function oe(we,ge,Te,We){return ge===null||ge.tag!==6?(ge=Nh(Te,we.mode,We),ge.return=we,ge):(ge=w(ge,Te),ge.return=we,ge)}function fe(we,ge,Te,We){var nt=Te.type;return nt===O?Re(we,ge,Te.props.children,We,Te.key):ge!==null&&(ge.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===Q&&Mm(nt)===ge.type)?(We=w(ge,Te.props),We.ref=ic(we,ge,Te),We.return=we,We):(We=ld(Te.type,Te.key,Te.props,null,we.mode,We),We.ref=ic(we,ge,Te),We.return=we,We)}function Pe(we,ge,Te,We){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==Te.containerInfo||ge.stateNode.implementation!==Te.implementation?(ge=Dh(Te,we.mode,We),ge.return=we,ge):(ge=w(ge,Te.children||[]),ge.return=we,ge)}function Re(we,ge,Te,We,nt){return ge===null||ge.tag!==7?(ge=Xs(Te,we.mode,We,nt),ge.return=we,ge):(ge=w(ge,Te),ge.return=we,ge)}function ze(we,ge,Te){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=Nh(""+ge,we.mode,Te),ge.return=we,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case K:return Te=ld(ge.type,ge.key,ge.props,null,we.mode,Te),Te.ref=ic(we,null,ge),Te.return=we,Te;case z:return ge=Dh(ge,we.mode,Te),ge.return=we,ge;case Q:var We=ge._init;return ze(we,We(ge._payload),Te)}if(Yt(ge)||H(ge))return ge=Xs(ge,we.mode,Te,null),ge.return=we,ge;Mu(we,ge)}return null}function Fe(we,ge,Te,We){var nt=ge!==null?ge.key:null;if(typeof Te=="string"&&Te!==""||typeof Te=="number")return nt!==null?null:oe(we,ge,""+Te,We);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case K:return Te.key===nt?fe(we,ge,Te,We):null;case z:return Te.key===nt?Pe(we,ge,Te,We):null;case Q:return nt=Te._init,Fe(we,ge,nt(Te._payload),We)}if(Yt(Te)||H(Te))return nt!==null?null:Re(we,ge,Te,We,null);Mu(we,Te)}return null}function Xe(we,ge,Te,We,nt){if(typeof We=="string"&&We!==""||typeof We=="number")return we=we.get(Te)||null,oe(ge,we,""+We,nt);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case K:return we=we.get(We.key===null?Te:We.key)||null,fe(ge,we,We,nt);case z:return we=we.get(We.key===null?Te:We.key)||null,Pe(ge,we,We,nt);case Q:var ft=We._init;return Xe(we,ge,Te,ft(We._payload),nt)}if(Yt(We)||H(We))return we=we.get(Te)||null,Re(ge,we,We,nt,null);Mu(ge,We)}return null}function tt(we,ge,Te,We){for(var nt=null,ft=null,ht=ge,xt=ge=0,Rr=null;ht!==null&&xt<Te.length;xt++){ht.index>xt?(Rr=ht,ht=null):Rr=ht.sibling;var Ft=Fe(we,ht,Te[xt],We);if(Ft===null){ht===null&&(ht=Rr);break}i&&ht&&Ft.alternate===null&&o(we,ht),ge=T(Ft,ge,xt),ft===null?nt=Ft:ft.sibling=Ft,ft=Ft,ht=Rr}if(xt===Te.length)return h(we,ht),Xt&&Ws(we,xt),nt;if(ht===null){for(;xt<Te.length;xt++)ht=ze(we,Te[xt],We),ht!==null&&(ge=T(ht,ge,xt),ft===null?nt=ht:ft.sibling=ht,ft=ht);return Xt&&Ws(we,xt),nt}for(ht=v(we,ht);xt<Te.length;xt++)Rr=Xe(ht,we,xt,Te[xt],We),Rr!==null&&(i&&Rr.alternate!==null&&ht.delete(Rr.key===null?xt:Rr.key),ge=T(Rr,ge,xt),ft===null?nt=Rr:ft.sibling=Rr,ft=Rr);return i&&ht.forEach(function(us){return o(we,us)}),Xt&&Ws(we,xt),nt}function rt(we,ge,Te,We){var nt=H(Te);if(typeof nt!="function")throw Error(t(150));if(Te=nt.call(Te),Te==null)throw Error(t(151));for(var ft=nt=null,ht=ge,xt=ge=0,Rr=null,Ft=Te.next();ht!==null&&!Ft.done;xt++,Ft=Te.next()){ht.index>xt?(Rr=ht,ht=null):Rr=ht.sibling;var us=Fe(we,ht,Ft.value,We);if(us===null){ht===null&&(ht=Rr);break}i&&ht&&us.alternate===null&&o(we,ht),ge=T(us,ge,xt),ft===null?nt=us:ft.sibling=us,ft=us,ht=Rr}if(Ft.done)return h(we,ht),Xt&&Ws(we,xt),nt;if(ht===null){for(;!Ft.done;xt++,Ft=Te.next())Ft=ze(we,Ft.value,We),Ft!==null&&(ge=T(Ft,ge,xt),ft===null?nt=Ft:ft.sibling=Ft,ft=Ft);return Xt&&Ws(we,xt),nt}for(ht=v(we,ht);!Ft.done;xt++,Ft=Te.next())Ft=Xe(ht,we,xt,Ft.value,We),Ft!==null&&(i&&Ft.alternate!==null&&ht.delete(Ft.key===null?xt:Ft.key),ge=T(Ft,ge,xt),ft===null?nt=Ft:ft.sibling=Ft,ft=Ft);return i&&ht.forEach(function(D_){return o(we,D_)}),Xt&&Ws(we,xt),nt}function mr(we,ge,Te,We){if(typeof Te=="object"&&Te!==null&&Te.type===O&&Te.key===null&&(Te=Te.props.children),typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case K:e:{for(var nt=Te.key,ft=ge;ft!==null;){if(ft.key===nt){if(nt=Te.type,nt===O){if(ft.tag===7){h(we,ft.sibling),ge=w(ft,Te.props.children),ge.return=we,we=ge;break e}}else if(ft.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===Q&&Mm(nt)===ft.type){h(we,ft.sibling),ge=w(ft,Te.props),ge.ref=ic(we,ft,Te),ge.return=we,we=ge;break e}h(we,ft);break}else o(we,ft);ft=ft.sibling}Te.type===O?(ge=Xs(Te.props.children,we.mode,We,Te.key),ge.return=we,we=ge):(We=ld(Te.type,Te.key,Te.props,null,we.mode,We),We.ref=ic(we,ge,Te),We.return=we,we=We)}return W(we);case z:e:{for(ft=Te.key;ge!==null;){if(ge.key===ft)if(ge.tag===4&&ge.stateNode.containerInfo===Te.containerInfo&&ge.stateNode.implementation===Te.implementation){h(we,ge.sibling),ge=w(ge,Te.children||[]),ge.return=we,we=ge;break e}else{h(we,ge);break}else o(we,ge);ge=ge.sibling}ge=Dh(Te,we.mode,We),ge.return=we,we=ge}return W(we);case Q:return ft=Te._init,mr(we,ge,ft(Te._payload),We)}if(Yt(Te))return tt(we,ge,Te,We);if(H(Te))return rt(we,ge,Te,We);Mu(we,Te)}return typeof Te=="string"&&Te!==""||typeof Te=="number"?(Te=""+Te,ge!==null&&ge.tag===6?(h(we,ge.sibling),ge=w(ge,Te),ge.return=we,we=ge):(h(we,ge),ge=Nh(Te,we.mode,We),ge.return=we,we=ge),W(we)):h(we,ge)}return mr}var qo=Bm(!0),zm=Bm(!1),Bu=Qi(null),zu=null,Yo=null,zf=null;function Uf(){zf=Yo=zu=null}function $f(i){var o=Bu.current;qt(Bu),i._currentValue=o}function Wf(i,o,h){for(;i!==null;){var v=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,v!==null&&(v.childLanes|=o)):v!==null&&(v.childLanes&o)!==o&&(v.childLanes|=o),i===h)break;i=i.return}}function Xo(i,o){zu=i,zf=Yo=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(En=!0),i.firstContext=null)}function ta(i){var o=i._currentValue;if(zf!==i)if(i={context:i,memoizedValue:o,next:null},Yo===null){if(zu===null)throw Error(t(308));Yo=i,zu.dependencies={lanes:0,firstContext:i}}else Yo=Yo.next=i;return o}var Vs=null;function Vf(i){Vs===null?Vs=[i]:Vs.push(i)}function Um(i,o,h,v){var w=o.interleaved;return w===null?(h.next=h,Vf(o)):(h.next=w.next,w.next=h),o.interleaved=h,yi(i,v)}function yi(i,o){i.lanes|=o;var h=i.alternate;for(h!==null&&(h.lanes|=o),h=i,i=i.return;i!==null;)i.childLanes|=o,h=i.alternate,h!==null&&(h.childLanes|=o),h=i,i=i.return;return h.tag===3?h.stateNode:null}var rs=!1;function Hf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function $m(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function _i(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function ns(i,o,h){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(Ot&2)!==0){var w=v.pending;return w===null?o.next=o:(o.next=w.next,w.next=o),v.pending=o,yi(i,h)}return w=v.interleaved,w===null?(o.next=o,Vf(v)):(o.next=w.next,w.next=o),v.interleaved=o,yi(i,h)}function Uu(i,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194240)!==0)){var v=o.lanes;v&=i.pendingLanes,h|=v,o.lanes=h,ga(i,h)}}function Wm(i,o){var h=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var w=null,T=null;if(h=h.firstBaseUpdate,h!==null){do{var W={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};T===null?w=T=W:T=T.next=W,h=h.next}while(h!==null);T===null?w=T=o:T=T.next=o}else w=T=o;h={baseState:v.baseState,firstBaseUpdate:w,lastBaseUpdate:T,shared:v.shared,effects:v.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=o:i.next=o,h.lastBaseUpdate=o}function $u(i,o,h,v){var w=i.updateQueue;rs=!1;var T=w.firstBaseUpdate,W=w.lastBaseUpdate,oe=w.shared.pending;if(oe!==null){w.shared.pending=null;var fe=oe,Pe=fe.next;fe.next=null,W===null?T=Pe:W.next=Pe,W=fe;var Re=i.alternate;Re!==null&&(Re=Re.updateQueue,oe=Re.lastBaseUpdate,oe!==W&&(oe===null?Re.firstBaseUpdate=Pe:oe.next=Pe,Re.lastBaseUpdate=fe))}if(T!==null){var ze=w.baseState;W=0,Re=Pe=fe=null,oe=T;do{var Fe=oe.lane,Xe=oe.eventTime;if((v&Fe)===Fe){Re!==null&&(Re=Re.next={eventTime:Xe,lane:0,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null});e:{var tt=i,rt=oe;switch(Fe=o,Xe=h,rt.tag){case 1:if(tt=rt.payload,typeof tt=="function"){ze=tt.call(Xe,ze,Fe);break e}ze=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=rt.payload,Fe=typeof tt=="function"?tt.call(Xe,ze,Fe):tt,Fe==null)break e;ze=se({},ze,Fe);break e;case 2:rs=!0}}oe.callback!==null&&oe.lane!==0&&(i.flags|=64,Fe=w.effects,Fe===null?w.effects=[oe]:Fe.push(oe))}else Xe={eventTime:Xe,lane:Fe,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null},Re===null?(Pe=Re=Xe,fe=ze):Re=Re.next=Xe,W|=Fe;if(oe=oe.next,oe===null){if(oe=w.shared.pending,oe===null)break;Fe=oe,oe=Fe.next,Fe.next=null,w.lastBaseUpdate=Fe,w.shared.pending=null}}while(!0);if(Re===null&&(fe=ze),w.baseState=fe,w.firstBaseUpdate=Pe,w.lastBaseUpdate=Re,o=w.shared.interleaved,o!==null){w=o;do W|=w.lane,w=w.next;while(w!==o)}else T===null&&(w.shared.lanes=0);Zs|=W,i.lanes=W,i.memoizedState=ze}}function Vm(i,o,h){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var v=i[o],w=v.callback;if(w!==null){if(v.callback=null,v=h,typeof w!="function")throw Error(t(191,w));w.call(v)}}}var sc={},Ha=Qi(sc),oc=Qi(sc),lc=Qi(sc);function Hs(i){if(i===sc)throw Error(t(174));return i}function Gf(i,o){switch(Ht(lc,o),Ht(oc,i),Ht(Ha,sc),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Sr(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Sr(o,i)}qt(Ha),Ht(Ha,o)}function Jo(){qt(Ha),qt(oc),qt(lc)}function Hm(i){Hs(lc.current);var o=Hs(Ha.current),h=Sr(o,i.type);o!==h&&(Ht(oc,i),Ht(Ha,h))}function Zf(i){oc.current===i&&(qt(Ha),qt(oc))}var nr=Qi(0);function Wu(i){for(var o=i;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Kf=[];function qf(){for(var i=0;i<Kf.length;i++)Kf[i]._workInProgressVersionPrimary=null;Kf.length=0}var Vu=F.ReactCurrentDispatcher,Yf=F.ReactCurrentBatchConfig,Gs=0,ar=null,Ar=null,Fr=null,Hu=!1,cc=!1,uc=0,Qy=0;function Xr(){throw Error(t(321))}function Xf(i,o){if(o===null)return!1;for(var h=0;h<o.length&&h<i.length;h++)if(!Bn(i[h],o[h]))return!1;return!0}function Jf(i,o,h,v,w,T){if(Gs=T,ar=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Vu.current=i===null||i.memoizedState===null?n_:a_,i=h(v,w),cc){T=0;do{if(cc=!1,uc=0,25<=T)throw Error(t(301));T+=1,Fr=Ar=null,o.updateQueue=null,Vu.current=i_,i=h(v,w)}while(cc)}if(Vu.current=Ku,o=Ar!==null&&Ar.next!==null,Gs=0,Fr=Ar=ar=null,Hu=!1,o)throw Error(t(300));return i}function Qf(){var i=uc!==0;return uc=0,i}function Ga(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fr===null?ar.memoizedState=Fr=i:Fr=Fr.next=i,Fr}function ra(){if(Ar===null){var i=ar.alternate;i=i!==null?i.memoizedState:null}else i=Ar.next;var o=Fr===null?ar.memoizedState:Fr.next;if(o!==null)Fr=o,Ar=i;else{if(i===null)throw Error(t(310));Ar=i,i={memoizedState:Ar.memoizedState,baseState:Ar.baseState,baseQueue:Ar.baseQueue,queue:Ar.queue,next:null},Fr===null?ar.memoizedState=Fr=i:Fr=Fr.next=i}return Fr}function dc(i,o){return typeof o=="function"?o(i):o}function eh(i){var o=ra(),h=o.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=i;var v=Ar,w=v.baseQueue,T=h.pending;if(T!==null){if(w!==null){var W=w.next;w.next=T.next,T.next=W}v.baseQueue=w=T,h.pending=null}if(w!==null){T=w.next,v=v.baseState;var oe=W=null,fe=null,Pe=T;do{var Re=Pe.lane;if((Gs&Re)===Re)fe!==null&&(fe=fe.next={lane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),v=Pe.hasEagerState?Pe.eagerState:i(v,Pe.action);else{var ze={lane:Re,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null};fe===null?(oe=fe=ze,W=v):fe=fe.next=ze,ar.lanes|=Re,Zs|=Re}Pe=Pe.next}while(Pe!==null&&Pe!==T);fe===null?W=v:fe.next=oe,Bn(v,o.memoizedState)||(En=!0),o.memoizedState=v,o.baseState=W,o.baseQueue=fe,h.lastRenderedState=v}if(i=h.interleaved,i!==null){w=i;do T=w.lane,ar.lanes|=T,Zs|=T,w=w.next;while(w!==i)}else w===null&&(h.lanes=0);return[o.memoizedState,h.dispatch]}function th(i){var o=ra(),h=o.queue;if(h===null)throw Error(t(311));h.lastRenderedReducer=i;var v=h.dispatch,w=h.pending,T=o.memoizedState;if(w!==null){h.pending=null;var W=w=w.next;do T=i(T,W.action),W=W.next;while(W!==w);Bn(T,o.memoizedState)||(En=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),h.lastRenderedState=T}return[T,v]}function Gm(){}function Zm(i,o){var h=ar,v=ra(),w=o(),T=!Bn(v.memoizedState,w);if(T&&(v.memoizedState=w,En=!0),v=v.queue,rh(Ym.bind(null,h,v,i),[i]),v.getSnapshot!==o||T||Fr!==null&&Fr.memoizedState.tag&1){if(h.flags|=2048,fc(9,qm.bind(null,h,v,w,o),void 0,null),Lr===null)throw Error(t(349));(Gs&30)!==0||Km(h,o,w)}return w}function Km(i,o,h){i.flags|=16384,i={getSnapshot:o,value:h},o=ar.updateQueue,o===null?(o={lastEffect:null,stores:null},ar.updateQueue=o,o.stores=[i]):(h=o.stores,h===null?o.stores=[i]:h.push(i))}function qm(i,o,h,v){o.value=h,o.getSnapshot=v,Xm(o)&&Jm(i)}function Ym(i,o,h){return h(function(){Xm(o)&&Jm(i)})}function Xm(i){var o=i.getSnapshot;i=i.value;try{var h=o();return!Bn(i,h)}catch{return!0}}function Jm(i){var o=yi(i,1);o!==null&&Ta(o,i,1,-1)}function Qm(i){var o=Ga();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dc,lastRenderedState:i},o.queue=i,i=i.dispatch=r_.bind(null,ar,i),[o.memoizedState,i]}function fc(i,o,h,v){return i={tag:i,create:o,destroy:h,deps:v,next:null},o=ar.updateQueue,o===null?(o={lastEffect:null,stores:null},ar.updateQueue=o,o.lastEffect=i.next=i):(h=o.lastEffect,h===null?o.lastEffect=i.next=i:(v=h.next,h.next=i,i.next=v,o.lastEffect=i)),i}function ep(){return ra().memoizedState}function Gu(i,o,h,v){var w=Ga();ar.flags|=i,w.memoizedState=fc(1|o,h,void 0,v===void 0?null:v)}function Zu(i,o,h,v){var w=ra();v=v===void 0?null:v;var T=void 0;if(Ar!==null){var W=Ar.memoizedState;if(T=W.destroy,v!==null&&Xf(v,W.deps)){w.memoizedState=fc(o,h,T,v);return}}ar.flags|=i,w.memoizedState=fc(1|o,h,T,v)}function tp(i,o){return Gu(8390656,8,i,o)}function rh(i,o){return Zu(2048,8,i,o)}function rp(i,o){return Zu(4,2,i,o)}function np(i,o){return Zu(4,4,i,o)}function ap(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function ip(i,o,h){return h=h!=null?h.concat([i]):null,Zu(4,4,ap.bind(null,o,i),h)}function nh(){}function sp(i,o){var h=ra();o=o===void 0?null:o;var v=h.memoizedState;return v!==null&&o!==null&&Xf(o,v[1])?v[0]:(h.memoizedState=[i,o],i)}function op(i,o){var h=ra();o=o===void 0?null:o;var v=h.memoizedState;return v!==null&&o!==null&&Xf(o,v[1])?v[0]:(i=i(),h.memoizedState=[i,o],i)}function lp(i,o,h){return(Gs&21)===0?(i.baseState&&(i.baseState=!1,En=!0),i.memoizedState=h):(Bn(h,o)||(h=cu(),ar.lanes|=h,Zs|=h,i.baseState=!0),o)}function e_(i,o){var h=Pt;Pt=h!==0&&4>h?h:4,i(!0);var v=Yf.transition;Yf.transition={};try{i(!1),o()}finally{Pt=h,Yf.transition=v}}function cp(){return ra().memoizedState}function t_(i,o,h){var v=os(i);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},up(i))dp(o,h);else if(h=Um(i,o,h,v),h!==null){var w=hn();Ta(h,i,v,w),fp(h,o,v)}}function r_(i,o,h){var v=os(i),w={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(up(i))dp(o,w);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=o.lastRenderedReducer,T!==null))try{var W=o.lastRenderedState,oe=T(W,h);if(w.hasEagerState=!0,w.eagerState=oe,Bn(oe,W)){var fe=o.interleaved;fe===null?(w.next=w,Vf(o)):(w.next=fe.next,fe.next=w),o.interleaved=w;return}}catch{}finally{}h=Um(i,o,w,v),h!==null&&(w=hn(),Ta(h,i,v,w),fp(h,o,v))}}function up(i){var o=i.alternate;return i===ar||o!==null&&o===ar}function dp(i,o){cc=Hu=!0;var h=i.pending;h===null?o.next=o:(o.next=h.next,h.next=o),i.pending=o}function fp(i,o,h){if((h&4194240)!==0){var v=o.lanes;v&=i.pendingLanes,h|=v,o.lanes=h,ga(i,h)}}var Ku={readContext:ta,useCallback:Xr,useContext:Xr,useEffect:Xr,useImperativeHandle:Xr,useInsertionEffect:Xr,useLayoutEffect:Xr,useMemo:Xr,useReducer:Xr,useRef:Xr,useState:Xr,useDebugValue:Xr,useDeferredValue:Xr,useTransition:Xr,useMutableSource:Xr,useSyncExternalStore:Xr,useId:Xr,unstable_isNewReconciler:!1},n_={readContext:ta,useCallback:function(i,o){return Ga().memoizedState=[i,o===void 0?null:o],i},useContext:ta,useEffect:tp,useImperativeHandle:function(i,o,h){return h=h!=null?h.concat([i]):null,Gu(4194308,4,ap.bind(null,o,i),h)},useLayoutEffect:function(i,o){return Gu(4194308,4,i,o)},useInsertionEffect:function(i,o){return Gu(4,2,i,o)},useMemo:function(i,o){var h=Ga();return o=o===void 0?null:o,i=i(),h.memoizedState=[i,o],i},useReducer:function(i,o,h){var v=Ga();return o=h!==void 0?h(o):o,v.memoizedState=v.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},v.queue=i,i=i.dispatch=t_.bind(null,ar,i),[v.memoizedState,i]},useRef:function(i){var o=Ga();return i={current:i},o.memoizedState=i},useState:Qm,useDebugValue:nh,useDeferredValue:function(i){return Ga().memoizedState=i},useTransition:function(){var i=Qm(!1),o=i[0];return i=e_.bind(null,i[1]),Ga().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,h){var v=ar,w=Ga();if(Xt){if(h===void 0)throw Error(t(407));h=h()}else{if(h=o(),Lr===null)throw Error(t(349));(Gs&30)!==0||Km(v,o,h)}w.memoizedState=h;var T={value:h,getSnapshot:o};return w.queue=T,tp(Ym.bind(null,v,T,i),[i]),v.flags|=2048,fc(9,qm.bind(null,v,T,h,o),void 0,null),h},useId:function(){var i=Ga(),o=Lr.identifierPrefix;if(Xt){var h=xi,v=vi;h=(v&~(1<<32-lt(v)-1)).toString(32)+h,o=":"+o+"R"+h,h=uc++,0<h&&(o+="H"+h.toString(32)),o+=":"}else h=Qy++,o=":"+o+"r"+h.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},a_={readContext:ta,useCallback:sp,useContext:ta,useEffect:rh,useImperativeHandle:ip,useInsertionEffect:rp,useLayoutEffect:np,useMemo:op,useReducer:eh,useRef:ep,useState:function(){return eh(dc)},useDebugValue:nh,useDeferredValue:function(i){var o=ra();return lp(o,Ar.memoizedState,i)},useTransition:function(){var i=eh(dc)[0],o=ra().memoizedState;return[i,o]},useMutableSource:Gm,useSyncExternalStore:Zm,useId:cp,unstable_isNewReconciler:!1},i_={readContext:ta,useCallback:sp,useContext:ta,useEffect:rh,useImperativeHandle:ip,useInsertionEffect:rp,useLayoutEffect:np,useMemo:op,useReducer:th,useRef:ep,useState:function(){return th(dc)},useDebugValue:nh,useDeferredValue:function(i){var o=ra();return Ar===null?o.memoizedState=i:lp(o,Ar.memoizedState,i)},useTransition:function(){var i=th(dc)[0],o=ra().memoizedState;return[i,o]},useMutableSource:Gm,useSyncExternalStore:Zm,useId:cp,unstable_isNewReconciler:!1};function ba(i,o){if(i&&i.defaultProps){o=se({},o),i=i.defaultProps;for(var h in i)o[h]===void 0&&(o[h]=i[h]);return o}return o}function ah(i,o,h,v){o=i.memoizedState,h=h(v,o),h=h==null?o:se({},o,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var qu={isMounted:function(i){return(i=i._reactInternals)?ie(i)===i:!1},enqueueSetState:function(i,o,h){i=i._reactInternals;var v=hn(),w=os(i),T=_i(v,w);T.payload=o,h!=null&&(T.callback=h),o=ns(i,T,w),o!==null&&(Ta(o,i,w,v),Uu(o,i,w))},enqueueReplaceState:function(i,o,h){i=i._reactInternals;var v=hn(),w=os(i),T=_i(v,w);T.tag=1,T.payload=o,h!=null&&(T.callback=h),o=ns(i,T,w),o!==null&&(Ta(o,i,w,v),Uu(o,i,w))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var h=hn(),v=os(i),w=_i(h,v);w.tag=2,o!=null&&(w.callback=o),o=ns(i,w,v),o!==null&&(Ta(o,i,v,h),Uu(o,i,v))}};function hp(i,o,h,v,w,T,W){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,T,W):o.prototype&&o.prototype.isPureReactComponent?!Ua(h,v)||!Ua(w,T):!0}function mp(i,o,h){var v=!1,w=es,T=o.contextType;return typeof T=="object"&&T!==null?T=ta(T):(w=Tn(o)?Us:Yr.current,v=o.contextTypes,T=(v=v!=null)?Ho(i,w):es),o=new o(h,T),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=qu,i.stateNode=o,o._reactInternals=i,v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=w,i.__reactInternalMemoizedMaskedChildContext=T),o}function pp(i,o,h,v){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,v),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,v),o.state!==i&&qu.enqueueReplaceState(o,o.state,null)}function ih(i,o,h,v){var w=i.stateNode;w.props=h,w.state=i.memoizedState,w.refs={},Hf(i);var T=o.contextType;typeof T=="object"&&T!==null?w.context=ta(T):(T=Tn(o)?Us:Yr.current,w.context=Ho(i,T)),w.state=i.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(ah(i,o,T,h),w.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(o=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),o!==w.state&&qu.enqueueReplaceState(w,w.state,null),$u(i,h,w,v),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308)}function Qo(i,o){try{var h="",v=o;do h+=G(v),v=v.return;while(v);var w=h}catch(T){w=`
Error generating stack: `+T.message+`
`+T.stack}return{value:i,source:o,stack:w,digest:null}}function sh(i,o,h){return{value:i,source:null,stack:h??null,digest:o??null}}function oh(i,o){try{console.error(o.value)}catch(h){setTimeout(function(){throw h})}}var s_=typeof WeakMap=="function"?WeakMap:Map;function gp(i,o,h){h=_i(-1,h),h.tag=3,h.payload={element:null};var v=o.value;return h.callback=function(){rd||(rd=!0,bh=v),oh(i,o)},h}function vp(i,o,h){h=_i(-1,h),h.tag=3;var v=i.type.getDerivedStateFromError;if(typeof v=="function"){var w=o.value;h.payload=function(){return v(w)},h.callback=function(){oh(i,o)}}var T=i.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(h.callback=function(){oh(i,o),typeof v!="function"&&(is===null?is=new Set([this]):is.add(this));var W=o.stack;this.componentDidCatch(o.value,{componentStack:W!==null?W:""})}),h}function xp(i,o,h){var v=i.pingCache;if(v===null){v=i.pingCache=new s_;var w=new Set;v.set(o,w)}else w=v.get(o),w===void 0&&(w=new Set,v.set(o,w));w.has(h)||(w.add(h),i=__.bind(null,i,o,h),o.then(i,i))}function yp(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function _p(i,o,h,v,w){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(o=_i(-1,1),o.tag=2,ns(h,o,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=w,i)}var o_=F.ReactCurrentOwner,En=!1;function fn(i,o,h,v){o.child=i===null?zm(o,null,h,v):qo(o,i.child,h,v)}function wp(i,o,h,v,w){h=h.render;var T=o.ref;return Xo(o,w),v=Jf(i,o,h,v,T,w),h=Qf(),i!==null&&!En?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~w,wi(i,o,w)):(Xt&&h&&Ff(o),o.flags|=1,fn(i,o,v,w),o.child)}function bp(i,o,h,v,w){if(i===null){var T=h.type;return typeof T=="function"&&!Ph(T)&&T.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(o.tag=15,o.type=T,kp(i,o,T,v,w)):(i=ld(h.type,null,v,o,o.mode,w),i.ref=o.ref,i.return=o,o.child=i)}if(T=i.child,(i.lanes&w)===0){var W=T.memoizedProps;if(h=h.compare,h=h!==null?h:Ua,h(W,v)&&i.ref===o.ref)return wi(i,o,w)}return o.flags|=1,i=cs(T,v),i.ref=o.ref,i.return=o,o.child=i}function kp(i,o,h,v,w){if(i!==null){var T=i.memoizedProps;if(Ua(T,v)&&i.ref===o.ref)if(En=!1,o.pendingProps=v=T,(i.lanes&w)!==0)(i.flags&131072)!==0&&(En=!0);else return o.lanes=i.lanes,wi(i,o,w)}return lh(i,o,h,v,w)}function Sp(i,o,h){var v=o.pendingProps,w=v.children,T=i!==null?i.memoizedState:null;if(v.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ht(tl,Wn),Wn|=h;else{if((h&1073741824)===0)return i=T!==null?T.baseLanes|h:h,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Ht(tl,Wn),Wn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=T!==null?T.baseLanes:h,Ht(tl,Wn),Wn|=v}else T!==null?(v=T.baseLanes|h,o.memoizedState=null):v=h,Ht(tl,Wn),Wn|=v;return fn(i,o,w,h),o.child}function Tp(i,o){var h=o.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(o.flags|=512,o.flags|=2097152)}function lh(i,o,h,v,w){var T=Tn(h)?Us:Yr.current;return T=Ho(o,T),Xo(o,w),h=Jf(i,o,h,v,T,w),v=Qf(),i!==null&&!En?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~w,wi(i,o,w)):(Xt&&v&&Ff(o),o.flags|=1,fn(i,o,h,w),o.child)}function Ep(i,o,h,v,w){if(Tn(h)){var T=!0;Ou(o)}else T=!1;if(Xo(o,w),o.stateNode===null)Xu(i,o),mp(o,h,v),ih(o,h,v,w),v=!0;else if(i===null){var W=o.stateNode,oe=o.memoizedProps;W.props=oe;var fe=W.context,Pe=h.contextType;typeof Pe=="object"&&Pe!==null?Pe=ta(Pe):(Pe=Tn(h)?Us:Yr.current,Pe=Ho(o,Pe));var Re=h.getDerivedStateFromProps,ze=typeof Re=="function"||typeof W.getSnapshotBeforeUpdate=="function";ze||typeof W.UNSAFE_componentWillReceiveProps!="function"&&typeof W.componentWillReceiveProps!="function"||(oe!==v||fe!==Pe)&&pp(o,W,v,Pe),rs=!1;var Fe=o.memoizedState;W.state=Fe,$u(o,v,W,w),fe=o.memoizedState,oe!==v||Fe!==fe||Sn.current||rs?(typeof Re=="function"&&(ah(o,h,Re,v),fe=o.memoizedState),(oe=rs||hp(o,h,oe,v,Fe,fe,Pe))?(ze||typeof W.UNSAFE_componentWillMount!="function"&&typeof W.componentWillMount!="function"||(typeof W.componentWillMount=="function"&&W.componentWillMount(),typeof W.UNSAFE_componentWillMount=="function"&&W.UNSAFE_componentWillMount()),typeof W.componentDidMount=="function"&&(o.flags|=4194308)):(typeof W.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=v,o.memoizedState=fe),W.props=v,W.state=fe,W.context=Pe,v=oe):(typeof W.componentDidMount=="function"&&(o.flags|=4194308),v=!1)}else{W=o.stateNode,$m(i,o),oe=o.memoizedProps,Pe=o.type===o.elementType?oe:ba(o.type,oe),W.props=Pe,ze=o.pendingProps,Fe=W.context,fe=h.contextType,typeof fe=="object"&&fe!==null?fe=ta(fe):(fe=Tn(h)?Us:Yr.current,fe=Ho(o,fe));var Xe=h.getDerivedStateFromProps;(Re=typeof Xe=="function"||typeof W.getSnapshotBeforeUpdate=="function")||typeof W.UNSAFE_componentWillReceiveProps!="function"&&typeof W.componentWillReceiveProps!="function"||(oe!==ze||Fe!==fe)&&pp(o,W,v,fe),rs=!1,Fe=o.memoizedState,W.state=Fe,$u(o,v,W,w);var tt=o.memoizedState;oe!==ze||Fe!==tt||Sn.current||rs?(typeof Xe=="function"&&(ah(o,h,Xe,v),tt=o.memoizedState),(Pe=rs||hp(o,h,Pe,v,Fe,tt,fe)||!1)?(Re||typeof W.UNSAFE_componentWillUpdate!="function"&&typeof W.componentWillUpdate!="function"||(typeof W.componentWillUpdate=="function"&&W.componentWillUpdate(v,tt,fe),typeof W.UNSAFE_componentWillUpdate=="function"&&W.UNSAFE_componentWillUpdate(v,tt,fe)),typeof W.componentDidUpdate=="function"&&(o.flags|=4),typeof W.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof W.componentDidUpdate!="function"||oe===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=4),typeof W.getSnapshotBeforeUpdate!="function"||oe===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=1024),o.memoizedProps=v,o.memoizedState=tt),W.props=v,W.state=tt,W.context=fe,v=Pe):(typeof W.componentDidUpdate!="function"||oe===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=4),typeof W.getSnapshotBeforeUpdate!="function"||oe===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=1024),v=!1)}return ch(i,o,h,v,T,w)}function ch(i,o,h,v,w,T){Tp(i,o);var W=(o.flags&128)!==0;if(!v&&!W)return w&&Dm(o,h,!1),wi(i,o,T);v=o.stateNode,o_.current=o;var oe=W&&typeof h.getDerivedStateFromError!="function"?null:v.render();return o.flags|=1,i!==null&&W?(o.child=qo(o,i.child,null,T),o.child=qo(o,null,oe,T)):fn(i,o,oe,T),o.memoizedState=v.state,w&&Dm(o,h,!0),o.child}function Cp(i){var o=i.stateNode;o.pendingContext?Pm(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Pm(i,o.context,!1),Gf(i,o.containerInfo)}function Ap(i,o,h,v,w){return Ko(),Bf(w),o.flags|=256,fn(i,o,h,v),o.child}var uh={dehydrated:null,treeContext:null,retryLane:0};function dh(i){return{baseLanes:i,cachePool:null,transitions:null}}function Pp(i,o,h){var v=o.pendingProps,w=nr.current,T=!1,W=(o.flags&128)!==0,oe;if((oe=W)||(oe=i!==null&&i.memoizedState===null?!1:(w&2)!==0),oe?(T=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(w|=1),Ht(nr,w&1),i===null)return Mf(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(W=v.children,i=v.fallback,T?(v=o.mode,T=o.child,W={mode:"hidden",children:W},(v&1)===0&&T!==null?(T.childLanes=0,T.pendingProps=W):T=cd(W,v,0,null),i=Xs(i,v,h,null),T.return=o,i.return=o,T.sibling=i,o.child=T,o.child.memoizedState=dh(h),o.memoizedState=uh,i):fh(o,W));if(w=i.memoizedState,w!==null&&(oe=w.dehydrated,oe!==null))return l_(i,o,W,v,oe,w,h);if(T){T=v.fallback,W=o.mode,w=i.child,oe=w.sibling;var fe={mode:"hidden",children:v.children};return(W&1)===0&&o.child!==w?(v=o.child,v.childLanes=0,v.pendingProps=fe,o.deletions=null):(v=cs(w,fe),v.subtreeFlags=w.subtreeFlags&14680064),oe!==null?T=cs(oe,T):(T=Xs(T,W,h,null),T.flags|=2),T.return=o,v.return=o,v.sibling=T,o.child=v,v=T,T=o.child,W=i.child.memoizedState,W=W===null?dh(h):{baseLanes:W.baseLanes|h,cachePool:null,transitions:W.transitions},T.memoizedState=W,T.childLanes=i.childLanes&~h,o.memoizedState=uh,v}return T=i.child,i=T.sibling,v=cs(T,{mode:"visible",children:v.children}),(o.mode&1)===0&&(v.lanes=h),v.return=o,v.sibling=null,i!==null&&(h=o.deletions,h===null?(o.deletions=[i],o.flags|=16):h.push(i)),o.child=v,o.memoizedState=null,v}function fh(i,o){return o=cd({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Yu(i,o,h,v){return v!==null&&Bf(v),qo(o,i.child,null,h),i=fh(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function l_(i,o,h,v,w,T,W){if(h)return o.flags&256?(o.flags&=-257,v=sh(Error(t(422))),Yu(i,o,W,v)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(T=v.fallback,w=o.mode,v=cd({mode:"visible",children:v.children},w,0,null),T=Xs(T,w,W,null),T.flags|=2,v.return=o,T.return=o,v.sibling=T,o.child=v,(o.mode&1)!==0&&qo(o,i.child,null,W),o.child.memoizedState=dh(W),o.memoizedState=uh,T);if((o.mode&1)===0)return Yu(i,o,W,null);if(w.data==="$!"){if(v=w.nextSibling&&w.nextSibling.dataset,v)var oe=v.dgst;return v=oe,T=Error(t(419)),v=sh(T,v,void 0),Yu(i,o,W,v)}if(oe=(W&i.childLanes)!==0,En||oe){if(v=Lr,v!==null){switch(W&-W){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(v.suspendedLanes|W))!==0?0:w,w!==0&&w!==T.retryLane&&(T.retryLane=w,yi(i,w),Ta(v,i,w,-1))}return Ah(),v=sh(Error(t(421))),Yu(i,o,W,v)}return w.data==="$?"?(o.flags|=128,o.child=i.child,o=w_.bind(null,i),w._reactRetry=o,null):(i=T.treeContext,$n=Va(w.nextSibling),Un=o,Xt=!0,wa=null,i!==null&&(Qn[ea++]=vi,Qn[ea++]=xi,Qn[ea++]=$s,vi=i.id,xi=i.overflow,$s=o),o=fh(o,v.children),o.flags|=4096,o)}function Np(i,o,h){i.lanes|=o;var v=i.alternate;v!==null&&(v.lanes|=o),Wf(i.return,o,h)}function hh(i,o,h,v,w){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:w}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=v,T.tail=h,T.tailMode=w)}function Dp(i,o,h){var v=o.pendingProps,w=v.revealOrder,T=v.tail;if(fn(i,o,v.children,h),v=nr.current,(v&2)!==0)v=v&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Np(i,h,o);else if(i.tag===19)Np(i,h,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}if(Ht(nr,v),(o.mode&1)===0)o.memoizedState=null;else switch(w){case"forwards":for(h=o.child,w=null;h!==null;)i=h.alternate,i!==null&&Wu(i)===null&&(w=h),h=h.sibling;h=w,h===null?(w=o.child,o.child=null):(w=h.sibling,h.sibling=null),hh(o,!1,w,h,T);break;case"backwards":for(h=null,w=o.child,o.child=null;w!==null;){if(i=w.alternate,i!==null&&Wu(i)===null){o.child=w;break}i=w.sibling,w.sibling=h,h=w,w=i}hh(o,!0,h,null,T);break;case"together":hh(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Xu(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function wi(i,o,h){if(i!==null&&(o.dependencies=i.dependencies),Zs|=o.lanes,(h&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,h=cs(i,i.pendingProps),o.child=h,h.return=o;i.sibling!==null;)i=i.sibling,h=h.sibling=cs(i,i.pendingProps),h.return=o;h.sibling=null}return o.child}function c_(i,o,h){switch(o.tag){case 3:Cp(o),Ko();break;case 5:Hm(o);break;case 1:Tn(o.type)&&Ou(o);break;case 4:Gf(o,o.stateNode.containerInfo);break;case 10:var v=o.type._context,w=o.memoizedProps.value;Ht(Bu,v._currentValue),v._currentValue=w;break;case 13:if(v=o.memoizedState,v!==null)return v.dehydrated!==null?(Ht(nr,nr.current&1),o.flags|=128,null):(h&o.child.childLanes)!==0?Pp(i,o,h):(Ht(nr,nr.current&1),i=wi(i,o,h),i!==null?i.sibling:null);Ht(nr,nr.current&1);break;case 19:if(v=(h&o.childLanes)!==0,(i.flags&128)!==0){if(v)return Dp(i,o,h);o.flags|=128}if(w=o.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Ht(nr,nr.current),v)break;return null;case 22:case 23:return o.lanes=0,Sp(i,o,h)}return wi(i,o,h)}var Ip,mh,Op,jp;Ip=function(i,o){for(var h=o.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},mh=function(){},Op=function(i,o,h,v){var w=i.memoizedProps;if(w!==v){i=o.stateNode,Hs(Ha.current);var T=null;switch(h){case"input":w=dt(i,w),v=dt(i,v),T=[];break;case"select":w=se({},w,{value:void 0}),v=se({},v,{value:void 0}),T=[];break;case"textarea":w=_n(i,w),v=_n(i,v),T=[];break;default:typeof w.onClick!="function"&&typeof v.onClick=="function"&&(i.onclick=je)}ri(h,v);var W;h=null;for(Pe in w)if(!v.hasOwnProperty(Pe)&&w.hasOwnProperty(Pe)&&w[Pe]!=null)if(Pe==="style"){var oe=w[Pe];for(W in oe)oe.hasOwnProperty(W)&&(h||(h={}),h[W]="")}else Pe!=="dangerouslySetInnerHTML"&&Pe!=="children"&&Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&Pe!=="autoFocus"&&(a.hasOwnProperty(Pe)?T||(T=[]):(T=T||[]).push(Pe,null));for(Pe in v){var fe=v[Pe];if(oe=w?.[Pe],v.hasOwnProperty(Pe)&&fe!==oe&&(fe!=null||oe!=null))if(Pe==="style")if(oe){for(W in oe)!oe.hasOwnProperty(W)||fe&&fe.hasOwnProperty(W)||(h||(h={}),h[W]="");for(W in fe)fe.hasOwnProperty(W)&&oe[W]!==fe[W]&&(h||(h={}),h[W]=fe[W])}else h||(T||(T=[]),T.push(Pe,h)),h=fe;else Pe==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,oe=oe?oe.__html:void 0,fe!=null&&oe!==fe&&(T=T||[]).push(Pe,fe)):Pe==="children"?typeof fe!="string"&&typeof fe!="number"||(T=T||[]).push(Pe,""+fe):Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&(a.hasOwnProperty(Pe)?(fe!=null&&Pe==="onScroll"&&Ut("scroll",i),T||oe===fe||(T=[])):(T=T||[]).push(Pe,fe))}h&&(T=T||[]).push("style",h);var Pe=T;(o.updateQueue=Pe)&&(o.flags|=4)}},jp=function(i,o,h,v){h!==v&&(o.flags|=4)};function hc(i,o){if(!Xt)switch(i.tailMode){case"hidden":o=i.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function Jr(i){var o=i.alternate!==null&&i.alternate.child===i.child,h=0,v=0;if(o)for(var w=i.child;w!==null;)h|=w.lanes|w.childLanes,v|=w.subtreeFlags&14680064,v|=w.flags&14680064,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)h|=w.lanes|w.childLanes,v|=w.subtreeFlags,v|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=v,i.childLanes=h,o}function u_(i,o,h){var v=o.pendingProps;switch(Lf(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jr(o),null;case 1:return Tn(o.type)&&Iu(),Jr(o),null;case 3:return v=o.stateNode,Jo(),qt(Sn),qt(Yr),qf(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(i===null||i.child===null)&&(Ru(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,wa!==null&&(Th(wa),wa=null))),mh(i,o),Jr(o),null;case 5:Zf(o);var w=Hs(lc.current);if(h=o.type,i!==null&&o.stateNode!=null)Op(i,o,h,v,w),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!v){if(o.stateNode===null)throw Error(t(166));return Jr(o),null}if(i=Hs(Ha.current),Ru(o)){v=o.stateNode,h=o.type;var T=o.memoizedProps;switch(v[Jn]=o,v[Xi]=T,i=(o.mode&1)!==0,h){case"dialog":Ut("cancel",v),Ut("close",v);break;case"iframe":case"object":case"embed":Ut("load",v);break;case"video":case"audio":for(w=0;w<Ki.length;w++)Ut(Ki[w],v);break;case"source":Ut("error",v);break;case"img":case"image":case"link":Ut("error",v),Ut("load",v);break;case"details":Ut("toggle",v);break;case"input":mt(v,T),Ut("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!T.multiple},Ut("invalid",v);break;case"textarea":br(v,T),Ut("invalid",v)}ri(h,T),w=null;for(var W in T)if(T.hasOwnProperty(W)){var oe=T[W];W==="children"?typeof oe=="string"?v.textContent!==oe&&(T.suppressHydrationWarning!==!0&&Ae(v.textContent,oe,i),w=["children",oe]):typeof oe=="number"&&v.textContent!==""+oe&&(T.suppressHydrationWarning!==!0&&Ae(v.textContent,oe,i),w=["children",""+oe]):a.hasOwnProperty(W)&&oe!=null&&W==="onScroll"&&Ut("scroll",v)}switch(h){case"input":Ke(v),At(v,T,!0);break;case"textarea":Ke(v),kr(v);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(v.onclick=je)}v=w,o.updateQueue=v,v!==null&&(o.flags|=4)}else{W=w.nodeType===9?w:w.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=fr(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=W.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof v.is=="string"?i=W.createElement(h,{is:v.is}):(i=W.createElement(h),h==="select"&&(W=i,v.multiple?W.multiple=!0:v.size&&(W.size=v.size))):i=W.createElementNS(i,h),i[Jn]=o,i[Xi]=v,Ip(i,o,!1,!1),o.stateNode=i;e:{switch(W=ln(h,v),h){case"dialog":Ut("cancel",i),Ut("close",i),w=v;break;case"iframe":case"object":case"embed":Ut("load",i),w=v;break;case"video":case"audio":for(w=0;w<Ki.length;w++)Ut(Ki[w],i);w=v;break;case"source":Ut("error",i),w=v;break;case"img":case"image":case"link":Ut("error",i),Ut("load",i),w=v;break;case"details":Ut("toggle",i),w=v;break;case"input":mt(i,v),w=dt(i,v),Ut("invalid",i);break;case"option":w=v;break;case"select":i._wrapperState={wasMultiple:!!v.multiple},w=se({},v,{value:void 0}),Ut("invalid",i);break;case"textarea":br(i,v),w=_n(i,v),Ut("invalid",i);break;default:w=v}ri(h,w),oe=w;for(T in oe)if(oe.hasOwnProperty(T)){var fe=oe[T];T==="style"?Gr(i,fe):T==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,fe!=null&&ir(i,fe)):T==="children"?typeof fe=="string"?(h!=="textarea"||fe!=="")&&ct(i,fe):typeof fe=="number"&&ct(i,""+fe):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(a.hasOwnProperty(T)?fe!=null&&T==="onScroll"&&Ut("scroll",i):fe!=null&&N(i,T,fe,W))}switch(h){case"input":Ke(i),At(i,v,!1);break;case"textarea":Ke(i),kr(i);break;case"option":v.value!=null&&i.setAttribute("value",""+pe(v.value));break;case"select":i.multiple=!!v.multiple,T=v.value,T!=null?Qt(i,!!v.multiple,T,!1):v.defaultValue!=null&&Qt(i,!!v.multiple,v.defaultValue,!0);break;default:typeof w.onClick=="function"&&(i.onclick=je)}switch(h){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Jr(o),null;case 6:if(i&&o.stateNode!=null)jp(i,o,i.memoizedProps,v);else{if(typeof v!="string"&&o.stateNode===null)throw Error(t(166));if(h=Hs(lc.current),Hs(Ha.current),Ru(o)){if(v=o.stateNode,h=o.memoizedProps,v[Jn]=o,(T=v.nodeValue!==h)&&(i=Un,i!==null))switch(i.tag){case 3:Ae(v.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Ae(v.nodeValue,h,(i.mode&1)!==0)}T&&(o.flags|=4)}else v=(h.nodeType===9?h:h.ownerDocument).createTextNode(v),v[Jn]=o,o.stateNode=v}return Jr(o),null;case 13:if(qt(nr),v=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Xt&&$n!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Rm(),Ko(),o.flags|=98560,T=!1;else if(T=Ru(o),v!==null&&v.dehydrated!==null){if(i===null){if(!T)throw Error(t(318));if(T=o.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(t(317));T[Jn]=o}else Ko(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Jr(o),T=!1}else wa!==null&&(Th(wa),wa=null),T=!0;if(!T)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=h,o):(v=v!==null,v!==(i!==null&&i.memoizedState!==null)&&v&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(nr.current&1)!==0?Pr===0&&(Pr=3):Ah())),o.updateQueue!==null&&(o.flags|=4),Jr(o),null);case 4:return Jo(),mh(i,o),i===null&&qi(o.stateNode.containerInfo),Jr(o),null;case 10:return $f(o.type._context),Jr(o),null;case 17:return Tn(o.type)&&Iu(),Jr(o),null;case 19:if(qt(nr),T=o.memoizedState,T===null)return Jr(o),null;if(v=(o.flags&128)!==0,W=T.rendering,W===null)if(v)hc(T,!1);else{if(Pr!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(W=Wu(i),W!==null){for(o.flags|=128,hc(T,!1),v=W.updateQueue,v!==null&&(o.updateQueue=v,o.flags|=4),o.subtreeFlags=0,v=h,h=o.child;h!==null;)T=h,i=v,T.flags&=14680066,W=T.alternate,W===null?(T.childLanes=0,T.lanes=i,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=W.childLanes,T.lanes=W.lanes,T.child=W.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=W.memoizedProps,T.memoizedState=W.memoizedState,T.updateQueue=W.updateQueue,T.type=W.type,i=W.dependencies,T.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return Ht(nr,nr.current&1|2),o.child}i=i.sibling}T.tail!==null&&Ue()>rl&&(o.flags|=128,v=!0,hc(T,!1),o.lanes=4194304)}else{if(!v)if(i=Wu(W),i!==null){if(o.flags|=128,v=!0,h=i.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),hc(T,!0),T.tail===null&&T.tailMode==="hidden"&&!W.alternate&&!Xt)return Jr(o),null}else 2*Ue()-T.renderingStartTime>rl&&h!==1073741824&&(o.flags|=128,v=!0,hc(T,!1),o.lanes=4194304);T.isBackwards?(W.sibling=o.child,o.child=W):(h=T.last,h!==null?h.sibling=W:o.child=W,T.last=W)}return T.tail!==null?(o=T.tail,T.rendering=o,T.tail=o.sibling,T.renderingStartTime=Ue(),o.sibling=null,h=nr.current,Ht(nr,v?h&1|2:h&1),o):(Jr(o),null);case 22:case 23:return Ch(),v=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==v&&(o.flags|=8192),v&&(o.mode&1)!==0?(Wn&1073741824)!==0&&(Jr(o),o.subtreeFlags&6&&(o.flags|=8192)):Jr(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function d_(i,o){switch(Lf(o),o.tag){case 1:return Tn(o.type)&&Iu(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Jo(),qt(Sn),qt(Yr),qf(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Zf(o),null;case 13:if(qt(nr),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));Ko()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return qt(nr),null;case 4:return Jo(),null;case 10:return $f(o.type._context),null;case 22:case 23:return Ch(),null;case 24:return null;default:return null}}var Ju=!1,Qr=!1,f_=typeof WeakSet=="function"?WeakSet:Set,et=null;function el(i,o){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){lr(i,o,v)}else h.current=null}function ph(i,o,h){try{h()}catch(v){lr(i,o,v)}}var Fp=!1;function h_(i,o){if(Ze=Os,i=Yl(),Xl(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var v=h.getSelection&&h.getSelection();if(v&&v.rangeCount!==0){h=v.anchorNode;var w=v.anchorOffset,T=v.focusNode;v=v.focusOffset;try{h.nodeType,T.nodeType}catch{h=null;break e}var W=0,oe=-1,fe=-1,Pe=0,Re=0,ze=i,Fe=null;t:for(;;){for(var Xe;ze!==h||w!==0&&ze.nodeType!==3||(oe=W+w),ze!==T||v!==0&&ze.nodeType!==3||(fe=W+v),ze.nodeType===3&&(W+=ze.nodeValue.length),(Xe=ze.firstChild)!==null;)Fe=ze,ze=Xe;for(;;){if(ze===i)break t;if(Fe===h&&++Pe===w&&(oe=W),Fe===T&&++Re===v&&(fe=W),(Xe=ze.nextSibling)!==null)break;ze=Fe,Fe=ze.parentNode}ze=Xe}h=oe===-1||fe===-1?null:{start:oe,end:fe}}else h=null}h=h||{start:0,end:0}}else h=null;for(ut={focusedElem:i,selectionRange:h},Os=!1,et=o;et!==null;)if(o=et,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,et=i;else for(;et!==null;){o=et;try{var tt=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(tt!==null){var rt=tt.memoizedProps,mr=tt.memoizedState,we=o.stateNode,ge=we.getSnapshotBeforeUpdate(o.elementType===o.type?rt:ba(o.type,rt),mr);we.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var Te=o.stateNode.containerInfo;Te.nodeType===1?Te.textContent="":Te.nodeType===9&&Te.documentElement&&Te.removeChild(Te.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(We){lr(o,o.return,We)}if(i=o.sibling,i!==null){i.return=o.return,et=i;break}et=o.return}return tt=Fp,Fp=!1,tt}function mc(i,o,h){var v=o.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var w=v=v.next;do{if((w.tag&i)===i){var T=w.destroy;w.destroy=void 0,T!==void 0&&ph(o,h,T)}w=w.next}while(w!==v)}}function Qu(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var h=o=o.next;do{if((h.tag&i)===i){var v=h.create;h.destroy=v()}h=h.next}while(h!==o)}}function gh(i){var o=i.ref;if(o!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof o=="function"?o(i):o.current=i}}function Lp(i){var o=i.alternate;o!==null&&(i.alternate=null,Lp(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Jn],delete o[Xi],delete o[Ji],delete o[Df],delete o[If])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Rp(i){return i.tag===5||i.tag===3||i.tag===4}function Mp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Rp(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function vh(i,o,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?h.nodeType===8?h.parentNode.insertBefore(i,o):h.insertBefore(i,o):(h.nodeType===8?(o=h.parentNode,o.insertBefore(i,h)):(o=h,o.appendChild(i)),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=je));else if(v!==4&&(i=i.child,i!==null))for(vh(i,o,h),i=i.sibling;i!==null;)vh(i,o,h),i=i.sibling}function xh(i,o,h){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?h.insertBefore(i,o):h.appendChild(i);else if(v!==4&&(i=i.child,i!==null))for(xh(i,o,h),i=i.sibling;i!==null;)xh(i,o,h),i=i.sibling}var Ur=null,ka=!1;function as(i,o,h){for(h=h.child;h!==null;)Bp(i,o,h),h=h.sibling}function Bp(i,o,h){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(On,h)}catch{}switch(h.tag){case 5:Qr||el(h,o);case 6:var v=Ur,w=ka;Ur=null,as(i,o,h),Ur=v,ka=w,Ur!==null&&(ka?(i=Ur,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):Ur.removeChild(h.stateNode));break;case 18:Ur!==null&&(ka?(i=Ur,h=h.stateNode,i.nodeType===8?ac(i.parentNode,h):i.nodeType===1&&ac(i,h),Ln(i)):ac(Ur,h.stateNode));break;case 4:v=Ur,w=ka,Ur=h.stateNode.containerInfo,ka=!0,as(i,o,h),Ur=v,ka=w;break;case 0:case 11:case 14:case 15:if(!Qr&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){w=v=v.next;do{var T=w,W=T.destroy;T=T.tag,W!==void 0&&((T&2)!==0||(T&4)!==0)&&ph(h,o,W),w=w.next}while(w!==v)}as(i,o,h);break;case 1:if(!Qr&&(el(h,o),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(oe){lr(h,o,oe)}as(i,o,h);break;case 21:as(i,o,h);break;case 22:h.mode&1?(Qr=(v=Qr)||h.memoizedState!==null,as(i,o,h),Qr=v):as(i,o,h);break;default:as(i,o,h)}}function zp(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new f_),o.forEach(function(v){var w=b_.bind(null,i,v);h.has(v)||(h.add(v),v.then(w,w))})}}function Sa(i,o){var h=o.deletions;if(h!==null)for(var v=0;v<h.length;v++){var w=h[v];try{var T=i,W=o,oe=W;e:for(;oe!==null;){switch(oe.tag){case 5:Ur=oe.stateNode,ka=!1;break e;case 3:Ur=oe.stateNode.containerInfo,ka=!0;break e;case 4:Ur=oe.stateNode.containerInfo,ka=!0;break e}oe=oe.return}if(Ur===null)throw Error(t(160));Bp(T,W,w),Ur=null,ka=!1;var fe=w.alternate;fe!==null&&(fe.return=null),w.return=null}catch(Pe){lr(w,o,Pe)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Up(o,i),o=o.sibling}function Up(i,o){var h=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Sa(o,i),Za(i),v&4){try{mc(3,i,i.return),Qu(3,i)}catch(rt){lr(i,i.return,rt)}try{mc(5,i,i.return)}catch(rt){lr(i,i.return,rt)}}break;case 1:Sa(o,i),Za(i),v&512&&h!==null&&el(h,h.return);break;case 5:if(Sa(o,i),Za(i),v&512&&h!==null&&el(h,h.return),i.flags&32){var w=i.stateNode;try{ct(w,"")}catch(rt){lr(i,i.return,rt)}}if(v&4&&(w=i.stateNode,w!=null)){var T=i.memoizedProps,W=h!==null?h.memoizedProps:T,oe=i.type,fe=i.updateQueue;if(i.updateQueue=null,fe!==null)try{oe==="input"&&T.type==="radio"&&T.name!=null&&st(w,T),ln(oe,W);var Pe=ln(oe,T);for(W=0;W<fe.length;W+=2){var Re=fe[W],ze=fe[W+1];Re==="style"?Gr(w,ze):Re==="dangerouslySetInnerHTML"?ir(w,ze):Re==="children"?ct(w,ze):N(w,Re,ze,Pe)}switch(oe){case"input":Le(w,T);break;case"textarea":er(w,T);break;case"select":var Fe=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!T.multiple;var Xe=T.value;Xe!=null?Qt(w,!!T.multiple,Xe,!1):Fe!==!!T.multiple&&(T.defaultValue!=null?Qt(w,!!T.multiple,T.defaultValue,!0):Qt(w,!!T.multiple,T.multiple?[]:"",!1))}w[Xi]=T}catch(rt){lr(i,i.return,rt)}}break;case 6:if(Sa(o,i),Za(i),v&4){if(i.stateNode===null)throw Error(t(162));w=i.stateNode,T=i.memoizedProps;try{w.nodeValue=T}catch(rt){lr(i,i.return,rt)}}break;case 3:if(Sa(o,i),Za(i),v&4&&h!==null&&h.memoizedState.isDehydrated)try{Ln(o.containerInfo)}catch(rt){lr(i,i.return,rt)}break;case 4:Sa(o,i),Za(i);break;case 13:Sa(o,i),Za(i),w=i.child,w.flags&8192&&(T=w.memoizedState!==null,w.stateNode.isHidden=T,!T||w.alternate!==null&&w.alternate.memoizedState!==null||(wh=Ue())),v&4&&zp(i);break;case 22:if(Re=h!==null&&h.memoizedState!==null,i.mode&1?(Qr=(Pe=Qr)||Re,Sa(o,i),Qr=Pe):Sa(o,i),Za(i),v&8192){if(Pe=i.memoizedState!==null,(i.stateNode.isHidden=Pe)&&!Re&&(i.mode&1)!==0)for(et=i,Re=i.child;Re!==null;){for(ze=et=Re;et!==null;){switch(Fe=et,Xe=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:mc(4,Fe,Fe.return);break;case 1:el(Fe,Fe.return);var tt=Fe.stateNode;if(typeof tt.componentWillUnmount=="function"){v=Fe,h=Fe.return;try{o=v,tt.props=o.memoizedProps,tt.state=o.memoizedState,tt.componentWillUnmount()}catch(rt){lr(v,h,rt)}}break;case 5:el(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){Vp(ze);continue}}Xe!==null?(Xe.return=Fe,et=Xe):Vp(ze)}Re=Re.sibling}e:for(Re=null,ze=i;;){if(ze.tag===5){if(Re===null){Re=ze;try{w=ze.stateNode,Pe?(T=w.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(oe=ze.stateNode,fe=ze.memoizedProps.style,W=fe!=null&&fe.hasOwnProperty("display")?fe.display:null,oe.style.display=$t("display",W))}catch(rt){lr(i,i.return,rt)}}}else if(ze.tag===6){if(Re===null)try{ze.stateNode.nodeValue=Pe?"":ze.memoizedProps}catch(rt){lr(i,i.return,rt)}}else if((ze.tag!==22&&ze.tag!==23||ze.memoizedState===null||ze===i)&&ze.child!==null){ze.child.return=ze,ze=ze.child;continue}if(ze===i)break e;for(;ze.sibling===null;){if(ze.return===null||ze.return===i)break e;Re===ze&&(Re=null),ze=ze.return}Re===ze&&(Re=null),ze.sibling.return=ze.return,ze=ze.sibling}}break;case 19:Sa(o,i),Za(i),v&4&&zp(i);break;case 21:break;default:Sa(o,i),Za(i)}}function Za(i){var o=i.flags;if(o&2){try{e:{for(var h=i.return;h!==null;){if(Rp(h)){var v=h;break e}h=h.return}throw Error(t(160))}switch(v.tag){case 5:var w=v.stateNode;v.flags&32&&(ct(w,""),v.flags&=-33);var T=Mp(i);xh(i,T,w);break;case 3:case 4:var W=v.stateNode.containerInfo,oe=Mp(i);vh(i,oe,W);break;default:throw Error(t(161))}}catch(fe){lr(i,i.return,fe)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function m_(i,o,h){et=i,$p(i)}function $p(i,o,h){for(var v=(i.mode&1)!==0;et!==null;){var w=et,T=w.child;if(w.tag===22&&v){var W=w.memoizedState!==null||Ju;if(!W){var oe=w.alternate,fe=oe!==null&&oe.memoizedState!==null||Qr;oe=Ju;var Pe=Qr;if(Ju=W,(Qr=fe)&&!Pe)for(et=w;et!==null;)W=et,fe=W.child,W.tag===22&&W.memoizedState!==null?Hp(w):fe!==null?(fe.return=W,et=fe):Hp(w);for(;T!==null;)et=T,$p(T),T=T.sibling;et=w,Ju=oe,Qr=Pe}Wp(i)}else(w.subtreeFlags&8772)!==0&&T!==null?(T.return=w,et=T):Wp(i)}}function Wp(i){for(;et!==null;){var o=et;if((o.flags&8772)!==0){var h=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Qr||Qu(5,o);break;case 1:var v=o.stateNode;if(o.flags&4&&!Qr)if(h===null)v.componentDidMount();else{var w=o.elementType===o.type?h.memoizedProps:ba(o.type,h.memoizedProps);v.componentDidUpdate(w,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var T=o.updateQueue;T!==null&&Vm(o,T,v);break;case 3:var W=o.updateQueue;if(W!==null){if(h=null,o.child!==null)switch(o.child.tag){case 5:h=o.child.stateNode;break;case 1:h=o.child.stateNode}Vm(o,W,h)}break;case 5:var oe=o.stateNode;if(h===null&&o.flags&4){h=oe;var fe=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":fe.autoFocus&&h.focus();break;case"img":fe.src&&(h.src=fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Pe=o.alternate;if(Pe!==null){var Re=Pe.memoizedState;if(Re!==null){var ze=Re.dehydrated;ze!==null&&Ln(ze)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Qr||o.flags&512&&gh(o)}catch(Fe){lr(o,o.return,Fe)}}if(o===i){et=null;break}if(h=o.sibling,h!==null){h.return=o.return,et=h;break}et=o.return}}function Vp(i){for(;et!==null;){var o=et;if(o===i){et=null;break}var h=o.sibling;if(h!==null){h.return=o.return,et=h;break}et=o.return}}function Hp(i){for(;et!==null;){var o=et;try{switch(o.tag){case 0:case 11:case 15:var h=o.return;try{Qu(4,o)}catch(fe){lr(o,h,fe)}break;case 1:var v=o.stateNode;if(typeof v.componentDidMount=="function"){var w=o.return;try{v.componentDidMount()}catch(fe){lr(o,w,fe)}}var T=o.return;try{gh(o)}catch(fe){lr(o,T,fe)}break;case 5:var W=o.return;try{gh(o)}catch(fe){lr(o,W,fe)}}}catch(fe){lr(o,o.return,fe)}if(o===i){et=null;break}var oe=o.sibling;if(oe!==null){oe.return=o.return,et=oe;break}et=o.return}}var p_=Math.ceil,ed=F.ReactCurrentDispatcher,yh=F.ReactCurrentOwner,na=F.ReactCurrentBatchConfig,Ot=0,Lr=null,vr=null,$r=0,Wn=0,tl=Qi(0),Pr=0,pc=null,Zs=0,td=0,_h=0,gc=null,Cn=null,wh=0,rl=1/0,bi=null,rd=!1,bh=null,is=null,nd=!1,ss=null,ad=0,vc=0,kh=null,id=-1,sd=0;function hn(){return(Ot&6)!==0?Ue():id!==-1?id:id=Ue()}function os(i){return(i.mode&1)===0?1:(Ot&2)!==0&&$r!==0?$r&-$r:Jy.transition!==null?(sd===0&&(sd=cu()),sd):(i=Pt,i!==0||(i=window.event,i=i===void 0?16:Et(i.type)),i)}function Ta(i,o,h,v){if(50<vc)throw vc=0,kh=null,Error(t(185));jn(i,h,v),((Ot&2)===0||i!==Lr)&&(i===Lr&&((Ot&2)===0&&(td|=h),Pr===4&&ls(i,$r)),An(i,v),h===1&&Ot===0&&(o.mode&1)===0&&(rl=Ue()+500,ju&&ts()))}function An(i,o){var h=i.callbackNode;bo(i,o);var v=Vt(i,i===Lr?$r:0);if(v===0)h!==null&&Ve(h),i.callbackNode=null,i.callbackPriority=0;else if(o=v&-v,i.callbackPriority!==o){if(h!=null&&Ve(h),o===1)i.tag===0?Xy(Zp.bind(null,i)):Im(Zp.bind(null,i)),qr(function(){(Ot&6)===0&&ts()}),h=null;else{switch(Li(v)){case 1:h=Rt;break;case 4:h=Bt;break;case 16:h=tr;break;case 536870912:h=wn;break;default:h=tr}h=tg(h,Gp.bind(null,i))}i.callbackPriority=o,i.callbackNode=h}}function Gp(i,o){if(id=-1,sd=0,(Ot&6)!==0)throw Error(t(327));var h=i.callbackNode;if(nl()&&i.callbackNode!==h)return null;var v=Vt(i,i===Lr?$r:0);if(v===0)return null;if((v&30)!==0||(v&i.expiredLanes)!==0||o)o=od(i,v);else{o=v;var w=Ot;Ot|=2;var T=qp();(Lr!==i||$r!==o)&&(bi=null,rl=Ue()+500,qs(i,o));do try{x_();break}catch(oe){Kp(i,oe)}while(!0);Uf(),ed.current=T,Ot=w,vr!==null?o=0:(Lr=null,$r=0,o=Pr)}if(o!==0){if(o===2&&(w=Zr(i),w!==0&&(v=w,o=Sh(i,w))),o===1)throw h=pc,qs(i,0),ls(i,v),An(i,Ue()),h;if(o===6)ls(i,v);else{if(w=i.current.alternate,(v&30)===0&&!g_(w)&&(o=od(i,v),o===2&&(T=Zr(i),T!==0&&(v=T,o=Sh(i,T))),o===1))throw h=pc,qs(i,0),ls(i,v),An(i,Ue()),h;switch(i.finishedWork=w,i.finishedLanes=v,o){case 0:case 1:throw Error(t(345));case 2:Ys(i,Cn,bi);break;case 3:if(ls(i,v),(v&130023424)===v&&(o=wh+500-Ue(),10<o)){if(Vt(i,0)!==0)break;if(w=i.suspendedLanes,(w&v)!==v){hn(),i.pingedLanes|=i.suspendedLanes&w;break}i.timeoutHandle=Cr(Ys.bind(null,i,Cn,bi),o);break}Ys(i,Cn,bi);break;case 4:if(ls(i,v),(v&4194240)===v)break;for(o=i.eventTimes,w=-1;0<v;){var W=31-lt(v);T=1<<W,W=o[W],W>w&&(w=W),v&=~T}if(v=w,v=Ue()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*p_(v/1960))-v,10<v){i.timeoutHandle=Cr(Ys.bind(null,i,Cn,bi),v);break}Ys(i,Cn,bi);break;case 5:Ys(i,Cn,bi);break;default:throw Error(t(329))}}}return An(i,Ue()),i.callbackNode===h?Gp.bind(null,i):null}function Sh(i,o){var h=gc;return i.current.memoizedState.isDehydrated&&(qs(i,o).flags|=256),i=od(i,o),i!==2&&(o=Cn,Cn=h,o!==null&&Th(o)),i}function Th(i){Cn===null?Cn=i:Cn.push.apply(Cn,i)}function g_(i){for(var o=i;;){if(o.flags&16384){var h=o.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var w=h[v],T=w.getSnapshot;w=w.value;try{if(!Bn(T(),w))return!1}catch{return!1}}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ls(i,o){for(o&=~_h,o&=~td,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var h=31-lt(o),v=1<<h;i[h]=-1,o&=~v}}function Zp(i){if((Ot&6)!==0)throw Error(t(327));nl();var o=Vt(i,0);if((o&1)===0)return An(i,Ue()),null;var h=od(i,o);if(i.tag!==0&&h===2){var v=Zr(i);v!==0&&(o=v,h=Sh(i,v))}if(h===1)throw h=pc,qs(i,0),ls(i,o),An(i,Ue()),h;if(h===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Ys(i,Cn,bi),An(i,Ue()),null}function Eh(i,o){var h=Ot;Ot|=1;try{return i(o)}finally{Ot=h,Ot===0&&(rl=Ue()+500,ju&&ts())}}function Ks(i){ss!==null&&ss.tag===0&&(Ot&6)===0&&nl();var o=Ot;Ot|=1;var h=na.transition,v=Pt;try{if(na.transition=null,Pt=1,i)return i()}finally{Pt=v,na.transition=h,Ot=o,(Ot&6)===0&&ts()}}function Ch(){Wn=tl.current,qt(tl)}function qs(i,o){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,gr(h)),vr!==null)for(h=vr.return;h!==null;){var v=h;switch(Lf(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Iu();break;case 3:Jo(),qt(Sn),qt(Yr),qf();break;case 5:Zf(v);break;case 4:Jo();break;case 13:qt(nr);break;case 19:qt(nr);break;case 10:$f(v.type._context);break;case 22:case 23:Ch()}h=h.return}if(Lr=i,vr=i=cs(i.current,null),$r=Wn=o,Pr=0,pc=null,_h=td=Zs=0,Cn=gc=null,Vs!==null){for(o=0;o<Vs.length;o++)if(h=Vs[o],v=h.interleaved,v!==null){h.interleaved=null;var w=v.next,T=h.pending;if(T!==null){var W=T.next;T.next=w,v.next=W}h.pending=v}Vs=null}return i}function Kp(i,o){do{var h=vr;try{if(Uf(),Vu.current=Ku,Hu){for(var v=ar.memoizedState;v!==null;){var w=v.queue;w!==null&&(w.pending=null),v=v.next}Hu=!1}if(Gs=0,Fr=Ar=ar=null,cc=!1,uc=0,yh.current=null,h===null||h.return===null){Pr=1,pc=o,vr=null;break}e:{var T=i,W=h.return,oe=h,fe=o;if(o=$r,oe.flags|=32768,fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Pe=fe,Re=oe,ze=Re.tag;if((Re.mode&1)===0&&(ze===0||ze===11||ze===15)){var Fe=Re.alternate;Fe?(Re.updateQueue=Fe.updateQueue,Re.memoizedState=Fe.memoizedState,Re.lanes=Fe.lanes):(Re.updateQueue=null,Re.memoizedState=null)}var Xe=yp(W);if(Xe!==null){Xe.flags&=-257,_p(Xe,W,oe,T,o),Xe.mode&1&&xp(T,Pe,o),o=Xe,fe=Pe;var tt=o.updateQueue;if(tt===null){var rt=new Set;rt.add(fe),o.updateQueue=rt}else tt.add(fe);break e}else{if((o&1)===0){xp(T,Pe,o),Ah();break e}fe=Error(t(426))}}else if(Xt&&oe.mode&1){var mr=yp(W);if(mr!==null){(mr.flags&65536)===0&&(mr.flags|=256),_p(mr,W,oe,T,o),Bf(Qo(fe,oe));break e}}T=fe=Qo(fe,oe),Pr!==4&&(Pr=2),gc===null?gc=[T]:gc.push(T),T=W;do{switch(T.tag){case 3:T.flags|=65536,o&=-o,T.lanes|=o;var we=gp(T,fe,o);Wm(T,we);break e;case 1:oe=fe;var ge=T.type,Te=T.stateNode;if((T.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||Te!==null&&typeof Te.componentDidCatch=="function"&&(is===null||!is.has(Te)))){T.flags|=65536,o&=-o,T.lanes|=o;var We=vp(T,oe,o);Wm(T,We);break e}}T=T.return}while(T!==null)}Xp(h)}catch(nt){o=nt,vr===h&&h!==null&&(vr=h=h.return);continue}break}while(!0)}function qp(){var i=ed.current;return ed.current=Ku,i===null?Ku:i}function Ah(){(Pr===0||Pr===3||Pr===2)&&(Pr=4),Lr===null||(Zs&268435455)===0&&(td&268435455)===0||ls(Lr,$r)}function od(i,o){var h=Ot;Ot|=2;var v=qp();(Lr!==i||$r!==o)&&(bi=null,qs(i,o));do try{v_();break}catch(w){Kp(i,w)}while(!0);if(Uf(),Ot=h,ed.current=v,vr!==null)throw Error(t(261));return Lr=null,$r=0,Pr}function v_(){for(;vr!==null;)Yp(vr)}function x_(){for(;vr!==null&&!Ye();)Yp(vr)}function Yp(i){var o=eg(i.alternate,i,Wn);i.memoizedProps=i.pendingProps,o===null?Xp(i):vr=o,yh.current=null}function Xp(i){var o=i;do{var h=o.alternate;if(i=o.return,(o.flags&32768)===0){if(h=u_(h,o,Wn),h!==null){vr=h;return}}else{if(h=d_(h,o),h!==null){h.flags&=32767,vr=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Pr=6,vr=null;return}}if(o=o.sibling,o!==null){vr=o;return}vr=o=i}while(o!==null);Pr===0&&(Pr=5)}function Ys(i,o,h){var v=Pt,w=na.transition;try{na.transition=null,Pt=1,y_(i,o,h,v)}finally{na.transition=w,Pt=v}return null}function y_(i,o,h,v){do nl();while(ss!==null);if((Ot&6)!==0)throw Error(t(327));h=i.finishedWork;var w=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var T=h.lanes|h.childLanes;if(or(i,T),i===Lr&&(vr=Lr=null,$r=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||nd||(nd=!0,tg(tr,function(){return nl(),null})),T=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||T){T=na.transition,na.transition=null;var W=Pt;Pt=1;var oe=Ot;Ot|=4,yh.current=null,h_(i,h),Up(h,i),Yn(ut),Os=!!Ze,ut=Ze=null,i.current=h,m_(h),$e(),Ot=oe,Pt=W,na.transition=T}else i.current=h;if(nd&&(nd=!1,ss=i,ad=w),T=i.pendingLanes,T===0&&(is=null),ma(h.stateNode),An(i,Ue()),o!==null)for(v=i.onRecoverableError,h=0;h<o.length;h++)w=o[h],v(w.value,{componentStack:w.stack,digest:w.digest});if(rd)throw rd=!1,i=bh,bh=null,i;return(ad&1)!==0&&i.tag!==0&&nl(),T=i.pendingLanes,(T&1)!==0?i===kh?vc++:(vc=0,kh=i):vc=0,ts(),null}function nl(){if(ss!==null){var i=Li(ad),o=na.transition,h=Pt;try{if(na.transition=null,Pt=16>i?16:i,ss===null)var v=!1;else{if(i=ss,ss=null,ad=0,(Ot&6)!==0)throw Error(t(331));var w=Ot;for(Ot|=4,et=i.current;et!==null;){var T=et,W=T.child;if((et.flags&16)!==0){var oe=T.deletions;if(oe!==null){for(var fe=0;fe<oe.length;fe++){var Pe=oe[fe];for(et=Pe;et!==null;){var Re=et;switch(Re.tag){case 0:case 11:case 15:mc(8,Re,T)}var ze=Re.child;if(ze!==null)ze.return=Re,et=ze;else for(;et!==null;){Re=et;var Fe=Re.sibling,Xe=Re.return;if(Lp(Re),Re===Pe){et=null;break}if(Fe!==null){Fe.return=Xe,et=Fe;break}et=Xe}}}var tt=T.alternate;if(tt!==null){var rt=tt.child;if(rt!==null){tt.child=null;do{var mr=rt.sibling;rt.sibling=null,rt=mr}while(rt!==null)}}et=T}}if((T.subtreeFlags&2064)!==0&&W!==null)W.return=T,et=W;else e:for(;et!==null;){if(T=et,(T.flags&2048)!==0)switch(T.tag){case 0:case 11:case 15:mc(9,T,T.return)}var we=T.sibling;if(we!==null){we.return=T.return,et=we;break e}et=T.return}}var ge=i.current;for(et=ge;et!==null;){W=et;var Te=W.child;if((W.subtreeFlags&2064)!==0&&Te!==null)Te.return=W,et=Te;else e:for(W=ge;et!==null;){if(oe=et,(oe.flags&2048)!==0)try{switch(oe.tag){case 0:case 11:case 15:Qu(9,oe)}}catch(nt){lr(oe,oe.return,nt)}if(oe===W){et=null;break e}var We=oe.sibling;if(We!==null){We.return=oe.return,et=We;break e}et=oe.return}}if(Ot=w,ts(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(On,i)}catch{}v=!0}return v}finally{Pt=h,na.transition=o}}return!1}function Jp(i,o,h){o=Qo(h,o),o=gp(i,o,1),i=ns(i,o,1),o=hn(),i!==null&&(jn(i,1,o),An(i,o))}function lr(i,o,h){if(i.tag===3)Jp(i,i,h);else for(;o!==null;){if(o.tag===3){Jp(o,i,h);break}else if(o.tag===1){var v=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(is===null||!is.has(v))){i=Qo(h,i),i=vp(o,i,1),o=ns(o,i,1),i=hn(),o!==null&&(jn(o,1,i),An(o,i));break}}o=o.return}}function __(i,o,h){var v=i.pingCache;v!==null&&v.delete(o),o=hn(),i.pingedLanes|=i.suspendedLanes&h,Lr===i&&($r&h)===h&&(Pr===4||Pr===3&&($r&130023424)===$r&&500>Ue()-wh?qs(i,0):_h|=h),An(i,o)}function Qp(i,o){o===0&&((i.mode&1)===0?o=1:(o=ji,ji<<=1,(ji&130023424)===0&&(ji=4194304)));var h=hn();i=yi(i,o),i!==null&&(jn(i,o,h),An(i,h))}function w_(i){var o=i.memoizedState,h=0;o!==null&&(h=o.retryLane),Qp(i,h)}function b_(i,o){var h=0;switch(i.tag){case 13:var v=i.stateNode,w=i.memoizedState;w!==null&&(h=w.retryLane);break;case 19:v=i.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(o),Qp(i,h)}var eg;eg=function(i,o,h){if(i!==null)if(i.memoizedProps!==o.pendingProps||Sn.current)En=!0;else{if((i.lanes&h)===0&&(o.flags&128)===0)return En=!1,c_(i,o,h);En=(i.flags&131072)!==0}else En=!1,Xt&&(o.flags&1048576)!==0&&Om(o,Lu,o.index);switch(o.lanes=0,o.tag){case 2:var v=o.type;Xu(i,o),i=o.pendingProps;var w=Ho(o,Yr.current);Xo(o,h),w=Jf(null,o,v,i,w,h);var T=Qf();return o.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Tn(v)?(T=!0,Ou(o)):T=!1,o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,Hf(o),w.updater=qu,o.stateNode=w,w._reactInternals=o,ih(o,v,i,h),o=ch(null,o,v,!0,T,h)):(o.tag=0,Xt&&T&&Ff(o),fn(null,o,w,h),o=o.child),o;case 16:v=o.elementType;e:{switch(Xu(i,o),i=o.pendingProps,w=v._init,v=w(v._payload),o.type=v,w=o.tag=S_(v),i=ba(v,i),w){case 0:o=lh(null,o,v,i,h);break e;case 1:o=Ep(null,o,v,i,h);break e;case 11:o=wp(null,o,v,i,h);break e;case 14:o=bp(null,o,v,ba(v.type,i),h);break e}throw Error(t(306,v,""))}return o;case 0:return v=o.type,w=o.pendingProps,w=o.elementType===v?w:ba(v,w),lh(i,o,v,w,h);case 1:return v=o.type,w=o.pendingProps,w=o.elementType===v?w:ba(v,w),Ep(i,o,v,w,h);case 3:e:{if(Cp(o),i===null)throw Error(t(387));v=o.pendingProps,T=o.memoizedState,w=T.element,$m(i,o),$u(o,v,null,h);var W=o.memoizedState;if(v=W.element,T.isDehydrated)if(T={element:v,isDehydrated:!1,cache:W.cache,pendingSuspenseBoundaries:W.pendingSuspenseBoundaries,transitions:W.transitions},o.updateQueue.baseState=T,o.memoizedState=T,o.flags&256){w=Qo(Error(t(423)),o),o=Ap(i,o,v,h,w);break e}else if(v!==w){w=Qo(Error(t(424)),o),o=Ap(i,o,v,h,w);break e}else for($n=Va(o.stateNode.containerInfo.firstChild),Un=o,Xt=!0,wa=null,h=zm(o,null,v,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Ko(),v===w){o=wi(i,o,h);break e}fn(i,o,v,h)}o=o.child}return o;case 5:return Hm(o),i===null&&Mf(o),v=o.type,w=o.pendingProps,T=i!==null?i.memoizedProps:null,W=w.children,wt(v,w)?W=null:T!==null&&wt(v,T)&&(o.flags|=32),Tp(i,o),fn(i,o,W,h),o.child;case 6:return i===null&&Mf(o),null;case 13:return Pp(i,o,h);case 4:return Gf(o,o.stateNode.containerInfo),v=o.pendingProps,i===null?o.child=qo(o,null,v,h):fn(i,o,v,h),o.child;case 11:return v=o.type,w=o.pendingProps,w=o.elementType===v?w:ba(v,w),wp(i,o,v,w,h);case 7:return fn(i,o,o.pendingProps,h),o.child;case 8:return fn(i,o,o.pendingProps.children,h),o.child;case 12:return fn(i,o,o.pendingProps.children,h),o.child;case 10:e:{if(v=o.type._context,w=o.pendingProps,T=o.memoizedProps,W=w.value,Ht(Bu,v._currentValue),v._currentValue=W,T!==null)if(Bn(T.value,W)){if(T.children===w.children&&!Sn.current){o=wi(i,o,h);break e}}else for(T=o.child,T!==null&&(T.return=o);T!==null;){var oe=T.dependencies;if(oe!==null){W=T.child;for(var fe=oe.firstContext;fe!==null;){if(fe.context===v){if(T.tag===1){fe=_i(-1,h&-h),fe.tag=2;var Pe=T.updateQueue;if(Pe!==null){Pe=Pe.shared;var Re=Pe.pending;Re===null?fe.next=fe:(fe.next=Re.next,Re.next=fe),Pe.pending=fe}}T.lanes|=h,fe=T.alternate,fe!==null&&(fe.lanes|=h),Wf(T.return,h,o),oe.lanes|=h;break}fe=fe.next}}else if(T.tag===10)W=T.type===o.type?null:T.child;else if(T.tag===18){if(W=T.return,W===null)throw Error(t(341));W.lanes|=h,oe=W.alternate,oe!==null&&(oe.lanes|=h),Wf(W,h,o),W=T.sibling}else W=T.child;if(W!==null)W.return=T;else for(W=T;W!==null;){if(W===o){W=null;break}if(T=W.sibling,T!==null){T.return=W.return,W=T;break}W=W.return}T=W}fn(i,o,w.children,h),o=o.child}return o;case 9:return w=o.type,v=o.pendingProps.children,Xo(o,h),w=ta(w),v=v(w),o.flags|=1,fn(i,o,v,h),o.child;case 14:return v=o.type,w=ba(v,o.pendingProps),w=ba(v.type,w),bp(i,o,v,w,h);case 15:return kp(i,o,o.type,o.pendingProps,h);case 17:return v=o.type,w=o.pendingProps,w=o.elementType===v?w:ba(v,w),Xu(i,o),o.tag=1,Tn(v)?(i=!0,Ou(o)):i=!1,Xo(o,h),mp(o,v,w),ih(o,v,w,h),ch(null,o,v,!0,i,h);case 19:return Dp(i,o,h);case 22:return Sp(i,o,h)}throw Error(t(156,o.tag))};function tg(i,o){return Me(i,o)}function k_(i,o,h,v){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function aa(i,o,h,v){return new k_(i,o,h,v)}function Ph(i){return i=i.prototype,!(!i||!i.isReactComponent)}function S_(i){if(typeof i=="function")return Ph(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ce)return 11;if(i===le)return 14}return 2}function cs(i,o){var h=i.alternate;return h===null?(h=aa(i.tag,o,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=o,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,o=i.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function ld(i,o,h,v,w,T){var W=2;if(v=i,typeof i=="function")Ph(i)&&(W=1);else if(typeof i=="string")W=5;else e:switch(i){case O:return Xs(h.children,w,T,o);case ne:W=8,w|=8;break;case ee:return i=aa(12,h,o,w|2),i.elementType=ee,i.lanes=T,i;case Ne:return i=aa(13,h,o,w),i.elementType=Ne,i.lanes=T,i;case xe:return i=aa(19,h,o,w),i.elementType=xe,i.lanes=T,i;case M:return cd(h,w,T,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ve:W=10;break e;case he:W=9;break e;case ce:W=11;break e;case le:W=14;break e;case Q:W=16,v=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=aa(W,h,o,w),o.elementType=i,o.type=v,o.lanes=T,o}function Xs(i,o,h,v){return i=aa(7,i,v,o),i.lanes=h,i}function cd(i,o,h,v){return i=aa(22,i,v,o),i.elementType=M,i.lanes=h,i.stateNode={isHidden:!1},i}function Nh(i,o,h){return i=aa(6,i,null,o),i.lanes=h,i}function Dh(i,o,h){return o=aa(4,i.children!==null?i.children:[],i.key,o),o.lanes=h,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function T_(i,o,h,v,w){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fi(0),this.expirationTimes=Fi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fi(0),this.identifierPrefix=v,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function Ih(i,o,h,v,w,T,W,oe,fe){return i=new T_(i,o,h,oe,fe),o===1?(o=1,T===!0&&(o|=8)):o=0,T=aa(3,null,null,o),i.current=T,T.stateNode=i,T.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Hf(T),i}function E_(i,o,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:z,key:v==null?null:""+v,children:i,containerInfo:o,implementation:h}}function rg(i){if(!i)return es;i=i._reactInternals;e:{if(ie(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Tn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var h=i.type;if(Tn(h))return Nm(i,h,o)}return o}function ng(i,o,h,v,w,T,W,oe,fe){return i=Ih(h,v,!0,i,w,T,W,oe,fe),i.context=rg(null),h=i.current,v=hn(),w=os(h),T=_i(v,w),T.callback=o??null,ns(h,T,w),i.current.lanes=w,jn(i,w,v),An(i,v),i}function ud(i,o,h,v){var w=o.current,T=hn(),W=os(w);return h=rg(h),o.context===null?o.context=h:o.pendingContext=h,o=_i(T,W),o.payload={element:i},v=v===void 0?null:v,v!==null&&(o.callback=v),i=ns(w,o,W),i!==null&&(Ta(i,w,W,T),Uu(i,w,W)),W}function dd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function ag(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<o?h:o}}function Oh(i,o){ag(i,o),(i=i.alternate)&&ag(i,o)}function C_(){return null}var ig=typeof reportError=="function"?reportError:function(i){console.error(i)};function jh(i){this._internalRoot=i}fd.prototype.render=jh.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));ud(i,o,null,null)},fd.prototype.unmount=jh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Ks(function(){ud(null,i,null,null)}),o[Lt]=null}};function fd(i){this._internalRoot=i}fd.prototype.unstable_scheduleHydration=function(i){if(i){var o=To();i={blockedOn:null,target:i,priority:o};for(var h=0;h<Er.length&&o!==0&&o<Er[h].priority;h++);Er.splice(h,0,i),h===0&&Eo(i)}};function Fh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function hd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function sg(){}function A_(i,o,h,v,w){if(w){if(typeof v=="function"){var T=v;v=function(){var Pe=dd(W);T.call(Pe)}}var W=ng(o,v,i,0,null,!1,!1,"",sg);return i._reactRootContainer=W,i[Lt]=W.current,qi(i.nodeType===8?i.parentNode:i),Ks(),W}for(;w=i.lastChild;)i.removeChild(w);if(typeof v=="function"){var oe=v;v=function(){var Pe=dd(fe);oe.call(Pe)}}var fe=Ih(i,0,!1,null,null,!1,!1,"",sg);return i._reactRootContainer=fe,i[Lt]=fe.current,qi(i.nodeType===8?i.parentNode:i),Ks(function(){ud(o,fe,h,v)}),fe}function md(i,o,h,v,w){var T=h._reactRootContainer;if(T){var W=T;if(typeof w=="function"){var oe=w;w=function(){var fe=dd(W);oe.call(fe)}}ud(o,W,i,w)}else W=A_(h,o,i,w,v);return dd(W)}ko=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var h=yt(o.pendingLanes);h!==0&&(ga(o,h|1),An(o,Ue()),(Ot&6)===0&&(rl=Ue()+500,ts()))}break;case 13:Ks(function(){var v=yi(i,1);if(v!==null){var w=hn();Ta(v,i,1,w)}}),Oh(i,1)}},ai=function(i){if(i.tag===13){var o=yi(i,134217728);if(o!==null){var h=hn();Ta(o,i,134217728,h)}Oh(i,134217728)}},So=function(i){if(i.tag===13){var o=os(i),h=yi(i,o);if(h!==null){var v=hn();Ta(h,i,o,v)}Oh(i,o)}},To=function(){return Pt},Ps=function(i,o){var h=Pt;try{return Pt=i,o()}finally{Pt=h}},da=function(i,o,h){switch(o){case"input":if(Le(i,h),o=h.name,h.type==="radio"&&o!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<h.length;o++){var v=h[o];if(v!==i&&v.form===i.form){var w=Wo(v);if(!w)throw Error(t(90));ae(v),Le(v,w)}}}break;case"textarea":er(i,h);break;case"select":o=h.value,o!=null&&Qt(i,!!h.multiple,o,!1)}},As=Eh,ni=Ks;var P_={usingClientEntryPoint:!1,Events:[mi,pi,Wo,Di,Ii,Eh]},xc={findFiberByHostInstance:hi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},N_={bundleType:xc.bundleType,version:xc.version,rendererPackageName:xc.rendererPackageName,rendererConfig:xc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:F.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Ee(i),i===null?null:i.stateNode},findFiberByHostInstance:xc.findFiberByHostInstance||C_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pd.isDisabled&&pd.supportsFiber)try{On=pd.inject(N_),hr=pd}catch{}}return Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P_,Pn.createPortal=function(i,o){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fh(o))throw Error(t(200));return E_(i,o,null,h)},Pn.createRoot=function(i,o){if(!Fh(i))throw Error(t(299));var h=!1,v="",w=ig;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onRecoverableError!==void 0&&(w=o.onRecoverableError)),o=Ih(i,1,!1,null,null,h,!1,v,w),i[Lt]=o.current,qi(i.nodeType===8?i.parentNode:i),new jh(o)},Pn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Ee(o),i=i===null?null:i.stateNode,i},Pn.flushSync=function(i){return Ks(i)},Pn.hydrate=function(i,o,h){if(!hd(o))throw Error(t(200));return md(null,i,o,!0,h)},Pn.hydrateRoot=function(i,o,h){if(!Fh(i))throw Error(t(405));var v=h!=null&&h.hydratedSources||null,w=!1,T="",W=ig;if(h!=null&&(h.unstable_strictMode===!0&&(w=!0),h.identifierPrefix!==void 0&&(T=h.identifierPrefix),h.onRecoverableError!==void 0&&(W=h.onRecoverableError)),o=ng(o,null,i,1,h??null,w,!1,T,W),i[Lt]=o.current,qi(i),v)for(i=0;i<v.length;i++)h=v[i],w=h._getVersion,w=w(h._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[h,w]:o.mutableSourceEagerHydrationData.push(h,w);return new fd(o)},Pn.render=function(i,o,h){if(!hd(o))throw Error(t(200));return md(null,i,o,!1,h)},Pn.unmountComponentAtNode=function(i){if(!hd(i))throw Error(t(40));return i._reactRootContainer?(Ks(function(){md(null,null,i,!1,function(){i._reactRootContainer=null,i[Lt]=null})}),!0):!1},Pn.unstable_batchedUpdates=Eh,Pn.unstable_renderSubtreeIntoContainer=function(i,o,h,v){if(!hd(h))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return md(i,o,h,!1,v)},Pn.version="18.3.1-next-f1338f8080-20240426",Pn}var mg;function gx(){if(mg)return Mh.exports;mg=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),Mh.exports=M_(),Mh.exports}var pg;function B_(){if(pg)return gd;pg=1;var e=gx();return gd.createRoot=e.createRoot,gd.hydrateRoot=e.hydrateRoot,gd}var z_=B_();const U_=sf(z_);var Y=U0();const Wt=sf(Y);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var vx=1252,$_=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},W0=function(e){$_.indexOf(e)!=-1&&(vx=$0[0]=e)};function W_(){W0(1252)}var Ia=function(e){W0(e)};function xx(){Ia(1200),W_()}function gg(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function V_(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function yx(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var kc=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?V_(e.slice(2)):r==254&&t==255?yx(e.slice(2)):r==65279?e.slice(1):e},vd=function(r){return String.fromCharCode(r)},vg=function(r){return String.fromCharCode(r)},$c,ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xg(e){for(var r="",t=0,n=0,a=0,l=0,c=0,f=0,m=0,g=0;g<e.length;)t=e.charCodeAt(g++),l=t>>2,n=e.charCodeAt(g++),c=(t&3)<<4|n>>4,a=e.charCodeAt(g++),f=(n&15)<<2|a>>6,m=a&63,isNaN(n)?f=m=64:isNaN(a)&&(m=64),r+=ws.charAt(l)+ws.charAt(c)+ws.charAt(f)+ws.charAt(m);return r}function Gn(e){var r="",t=0,n=0,a=0,l=0,c=0,f=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var g=0;g<e.length;)l=ws.indexOf(e.charAt(g++)),c=ws.indexOf(e.charAt(g++)),t=l<<2|c>>4,r+=String.fromCharCode(t),f=ws.indexOf(e.charAt(g++)),n=(c&15)<<4|f>>2,f!==64&&(r+=String.fromCharCode(n)),m=ws.indexOf(e.charAt(g++)),a=(f&3)<<6|m,m!==64&&(r+=String.fromCharCode(a));return r}var Nt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),mo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function Ss(e){return Nt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function yg(e){return Nt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Da=function(r){return Nt?mo(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function po(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function V0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return V0(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var xs=Nt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:mo(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function H_(e){for(var r=[],t=0,n=e.length+250,a=Ss(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)a[t++]=c;else if(c<2048)a[t++]=192|c>>6&31,a[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var f=e.charCodeAt(++l)&1023;a[t++]=240|c>>8&7,a[t++]=128|c>>2&63,a[t++]=128|f>>6&15|(c&3)<<4,a[t++]=128|f&63}else a[t++]=224|c>>12&15,a[t++]=128|c>>6&63,a[t++]=128|c&63;t>n&&(r.push(a.slice(0,t)),t=0,a=Ss(65535),n=65530)}return r.push(a.slice(0,t)),xs(r)}var xn=/\u0000/g,Sc=/[\u0001-\u0006]/g;function wl(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Oa(e,r){var t=""+e;return t.length>=r?t:cr("0",r-t.length)+t}function H0(e,r){var t=""+e;return t.length>=r?t:cr(" ",r-t.length)+t}function Vd(e,r){var t=""+e;return t.length>=r?t:t+cr(" ",r-t.length)}function G_(e,r){var t=""+Math.round(e);return t.length>=r?t:cr("0",r-t.length)+t}function Z_(e,r){var t=""+e;return t.length>=r?t:cr("0",r-t.length)+t}var _g=Math.pow(2,32);function al(e,r){if(e>_g||e<-_g)return G_(e,r);var t=Math.round(e);return Z_(t,r)}function Hd(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var wg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Uh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function K_(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},bg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},q_={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gd(e,r,t){for(var n=e<0?-1:1,a=e*n,l=0,c=1,f=0,m=1,g=0,x=0,y=Math.floor(a);g<r&&(y=Math.floor(a),f=y*c+l,x=y*g+m,!(a-y<5e-8));)a=1/(a-y),l=c,c=f,m=g,g=x;if(x>r&&(g>r?(x=m,f=l):(x=g,f=c)),!t)return[0,n*f,x];var b=Math.floor(n*f/x);return[b,n*f-b*x,x]}function io(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),l=0,c=[],f={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),r&&r.date1904&&(n+=1462),f.u>.9999&&(f.u=0,++a==86400&&(f.T=a=0,++n,++f.D)),n===60)c=t?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=t?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),c=[m.getFullYear(),m.getMonth()+1,m.getDate()],l=m.getDay(),n<60&&(l=(l+6)%7),t&&(l=tw(m,c))}return f.y=c[0],f.m=c[1],f.d=c[2],f.S=a%60,a=Math.floor(a/60),f.M=a%60,a=Math.floor(a/60),f.H=a,f.q=l,f}var _x=new Date(1899,11,31,0,0,0),Y_=_x.getTime(),X_=new Date(1900,2,1,0,0,0);function wx(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=X_&&(t+=1440*60*1e3),(t-(Y_+(e.getTimezoneOffset()-_x.getTimezoneOffset())*6e4))/(1440*60*1e3)}function G0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function J_(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Q_(e){var r=e<0?12:11,t=G0(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function ew(e){var r=G0(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Wc(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=Q_(e):r===10?t=e.toFixed(10).substr(0,12):t=ew(e),G0(J_(t.toUpperCase()))}function uo(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Wc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ca(14,wx(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function tw(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function rw(e,r,t,n){var a="",l=0,c=0,f=t.y,m,g=0;switch(e){case 98:f=t.y+543;case 121:switch(r.length){case 1:case 2:m=f%100,g=2;break;default:m=f%1e4,g=4;break}break;case 109:switch(r.length){case 1:case 2:m=t.m,g=r.length;break;case 3:return Uh[t.m-1][1];case 5:return Uh[t.m-1][0];default:return Uh[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:m=t.d,g=r.length;break;case 3:return wg[t.q][0];default:return wg[t.q][1]}break;case 104:switch(r.length){case 1:case 2:m=1+(t.H+11)%12,g=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:m=t.H,g=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:m=t.M,g=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?Oa(t.S,r.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(t.S+t.u)),l>=60*c&&(l=0),r==="s"?l===0?"0":""+l/c:(a=Oa(l,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":m=t.D*24+t.H;break;case"[m]":case"[mm]":m=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":m=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}g=r.length===3?1:2;break;case 101:m=f,g=1;break}var x=g>0?Oa(m,g):"";return x}function bs(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var bx=/%/g;function nw(e,r,t){var n=r.replace(bx,""),a=r.length-n.length;return Ci(e,n,t*Math.pow(10,2*a))+cr("%",a)}function aw(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Ci(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function kx(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+kx(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%a;if(l<0&&(l+=a),t=(r/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),t.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,m,g,x){return m+g+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Sx=/# (\?+)( ?)\/( ?)(\d+)/;function iw(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),l=Math.floor(a/n),c=a-l*n,f=n;return t+(l===0?"":""+l)+" "+(c===0?cr(" ",e[1].length+1+e[4].length):H0(c,e[1].length)+e[2]+"/"+e[3]+Oa(f,e[4].length))}function sw(e,r,t){return t+(r===0?"":""+r)+cr(" ",e[1].length+2+e[4].length)}var Tx=/^#*0*\.([0#]+)/,Ex=/\).*[0#]/,Cx=/\(###\) ###\\?-####/;function pn(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function kg(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function Sg(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function ow(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function lw(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function sa(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Ex)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?sa("n",n,t):"("+sa("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return aw(e,r,t);if(r.indexOf("%")!==-1)return nw(e,r,t);if(r.indexOf("E")!==-1)return kx(r,t);if(r.charCodeAt(0)===36)return"$"+sa(e,r.substr(r.charAt(1)==" "?2:1),t);var a,l,c,f,m=Math.abs(t),g=t<0?"-":"";if(r.match(/^00+$/))return g+al(m,r.length);if(r.match(/^[#?]+$/))return a=al(t,0),a==="0"&&(a=""),a.length>r.length?a:pn(r.substr(0,r.length-a.length))+a;if(l=r.match(Sx))return iw(l,m,g);if(r.match(/^#+0+$/))return g+al(m,r.length-r.indexOf("0"));if(l=r.match(Tx))return a=kg(t,l[1].length).replace(/^([^\.]+)$/,"$1."+pn(l[1])).replace(/\.$/,"."+pn(l[1])).replace(/\.(\d*)$/,function(S,k){return"."+k+cr("0",pn(l[1]).length-k.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return g+kg(m,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return g+bs(al(m,0));if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+sa(e,r,-t):bs(""+(Math.floor(t)+ow(t,l[1].length)))+"."+Oa(Sg(t,l[1].length),l[1].length);if(l=r.match(/^#,#*,#0/))return sa(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=wl(sa(e,r.replace(/[\\-]/g,""),t)),c=0,wl(wl(r.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<a.length?a.charAt(c++):S==="0"?"0":""}));if(r.match(Cx))return a=sa(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),f=Gd(m,Math.pow(10,c)-1,!1),a=""+g,x=Ci("n",l[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=Vd(f[2],c),x.length<l[4].length&&(x=pn(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),f=Gd(m,Math.pow(10,c)-1,!0),g+(f[0]||(f[1]?"":"0"))+" "+(f[1]?H0(f[1],c)+l[2]+"/"+l[3]+Vd(f[2],c):cr(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return a=al(t,0),r.length<=a.length?a:pn(r.substr(0,r.length-a.length))+a;if(l=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=r.indexOf(".")-c,b=r.length-a.length-y;return pn(r.substr(0,y)+a+r.substr(r.length-b))}if(l=r.match(/^00,000\.([#0]*0)$/))return c=Sg(t,l[1].length),t<0?"-"+sa(e,r,-t):bs(lw(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Oa(0,3-S.length):"")+S})+"."+Oa(c,l[1].length);switch(r){case"###,##0.00":return sa(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var E=bs(al(m,0));return E!=="0"?g+E:"";case"###,###.00":return sa(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return sa(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function cw(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Ci(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function uw(e,r,t){var n=r.replace(bx,""),a=r.length-n.length;return Ci(e,n,t*Math.pow(10,2*a))+cr("%",a)}function Ax(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ax(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%a;if(l<0&&(l+=a),t=(r/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),!t.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,m,g,x){return m+g+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function qa(e,r,t){if(e.charCodeAt(0)===40&&!r.match(Ex)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?qa("n",n,t):"("+qa("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return cw(e,r,t);if(r.indexOf("%")!==-1)return uw(e,r,t);if(r.indexOf("E")!==-1)return Ax(r,t);if(r.charCodeAt(0)===36)return"$"+qa(e,r.substr(r.charAt(1)==" "?2:1),t);var a,l,c,f,m=Math.abs(t),g=t<0?"-":"";if(r.match(/^00+$/))return g+Oa(m,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:pn(r.substr(0,r.length-a.length))+a;if(l=r.match(Sx))return sw(l,m,g);if(r.match(/^#+0+$/))return g+Oa(m,r.length-r.indexOf("0"));if(l=r.match(Tx))return a=(""+t).replace(/^([^\.]+)$/,"$1."+pn(l[1])).replace(/\.$/,"."+pn(l[1])),a=a.replace(/\.(\d*)$/,function(S,k){return"."+k+cr("0",pn(l[1]).length-k.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return g+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return g+bs(""+m);if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+qa(e,r,-t):bs(""+t)+"."+cr("0",l[1].length);if(l=r.match(/^#,#*,#0/))return qa(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=wl(qa(e,r.replace(/[\\-]/g,""),t)),c=0,wl(wl(r.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<a.length?a.charAt(c++):S==="0"?"0":""}));if(r.match(Cx))return a=qa(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),f=Gd(m,Math.pow(10,c)-1,!1),a=""+g,x=Ci("n",l[1],f[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=Vd(f[2],c),x.length<l[4].length&&(x=pn(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),f=Gd(m,Math.pow(10,c)-1,!0),g+(f[0]||(f[1]?"":"0"))+" "+(f[1]?H0(f[1],c)+l[2]+"/"+l[3]+Vd(f[2],c):cr(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:pn(r.substr(0,r.length-a.length))+a;if(l=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var y=r.indexOf(".")-c,b=r.length-a.length-y;return pn(r.substr(0,y)+a+r.substr(r.length-b))}if(l=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+qa(e,r,-t):bs(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Oa(0,3-S.length):"")+S})+"."+Oa(0,l[1].length);switch(r){case"###,###":case"##,###":case"#,###":var E=bs(""+m);return E!=="0"?g+E:"";default:if(r.match(/\.[0#?]*$/))return qa(e,r.slice(0,r.lastIndexOf(".")),t)+pn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Ci(e,r,t){return(t|0)===t?qa(e,r,t):sa(e,r,t)}function dw(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var Px=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Pl(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Hd(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(Px))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function fw(e,r,t,n){for(var a=[],l="",c=0,f="",m="t",g,x,y,b="H";c<e.length;)switch(f=e.charAt(c)){case"G":if(!Hd(e,c))throw new Error("unrecognized character "+f+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(y=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(y);a[a.length]={t:"t",v:l},++c;break;case"\\":var E=e.charAt(++c),S=E==="("||E===")"?E:"t";a[a.length]={t:S,v:E},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(g==null&&(g=io(r,t,e.charAt(c+1)==="2"),g==null))return"";a[a.length]={t:"X",v:e.substr(c,2)},m=f,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||g==null&&(g=io(r,t),g==null))return"";for(l=f;++c<e.length&&e.charAt(c).toLowerCase()===f;)l+=f;f==="m"&&m.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=b),a[a.length]={t:f,v:l},m=f;break;case"A":case"a":case"":var k={t:f,v:f};if(g==null&&(g=io(r,t)),e.substr(c,3).toUpperCase()==="A/P"?(g!=null&&(k.v=g.H>=12?"P":"A"),k.t="T",b="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(g!=null&&(k.v=g.H>=12?"PM":"AM"),k.t="T",c+=5,b="h"):e.substr(c,5).toUpperCase()==="/"?(g!=null&&(k.v=g.H>=12?"":""),k.t="T",c+=5,b="h"):(k.t="t",++c),g==null&&k.t==="T")return"";a[a.length]=k,m=f;break;case"[":for(l=f;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(Px)){if(g==null&&(g=io(r,t),g==null))return"";a[a.length]={t:"Z",v:l.toLowerCase()},m=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Pl(e)||(a[a.length]={t:"t",v:l}));break;case".":if(g!=null){for(l=f;++c<e.length&&(f=e.charAt(c))==="0";)l+=f;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=f;++c<e.length&&"0#?.,E+-%".indexOf(f=e.charAt(c))>-1;)l+=f;a[a.length]={t:"n",v:l};break;case"?":for(l=f;e.charAt(++c)===f;)l+=f;a[a.length]={t:f,v:l},m=f;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:n===1?"t":f,v:f},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=f;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:f,v:f},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+e);a[a.length]={t:"t",v:f},++c;break}var C=0,R=0,j;for(c=a.length-1,m="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=b,m="h",C<1&&(C=1);break;case"s":(j=a[c].v.match(/\.0+$/))&&(R=Math.max(R,j[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":m=a[c].t;break;case"m":m==="s"&&(a[c].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&a[c].v.match(/[Hh]/)&&(C=1),C<2&&a[c].v.match(/[Mm]/)&&(C=2),C<3&&a[c].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M),g.M>=60&&(g.M=0,++g.H);break;case 2:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M);break}var N="",F;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=rw(a[c].t.charCodeAt(0),a[c].v,g,R),a[c].t="t";break;case"n":case"?":for(F=c+1;a[F]!=null&&((f=a[F].t)==="?"||f==="D"||(f===" "||f==="t")&&a[F+1]!=null&&(a[F+1].t==="?"||a[F+1].t==="t"&&a[F+1].v==="/")||a[c].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(a[F].v==="/"||a[F].v===" "&&a[F+1]!=null&&a[F+1].t=="?"));)a[c].v+=a[F].v,a[F]={v:"",t:";"},++F;N+=a[c].v,c=F-1;break;case"G":a[c].t="t",a[c].v=uo(r,t);break}var K="",z,O;if(N.length>0){N.charCodeAt(0)==40?(z=r<0&&N.charCodeAt(0)===45?-r:r,O=Ci("n",N,z)):(z=r<0&&n>1?-r:r,O=Ci("n",N,z),z<0&&a[0]&&a[0].t=="t"&&(O=O.substr(1),a[0].v="-"+a[0].v)),F=O.length-1;var ne=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){ne=c;break}var ee=a.length;if(ne===a.length&&O.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(F>=a[c].v.length-1?(F-=a[c].v.length,a[c].v=O.substr(F+1,a[c].v.length)):F<0?a[c].v="":(a[c].v=O.substr(0,F+1),F=-1),a[c].t="t",ee=c);F>=0&&ee<a.length&&(a[ee].v=O.substr(0,F+1)+a[ee].v)}else if(ne!==a.length&&O.indexOf("E")===-1){for(F=O.indexOf(".")-1,c=ne;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(x=a[c].v.indexOf(".")>-1&&c===ne?a[c].v.indexOf(".")-1:a[c].v.length-1,K=a[c].v.substr(x+1);x>=0;--x)F>=0&&(a[c].v.charAt(x)==="0"||a[c].v.charAt(x)==="#")&&(K=O.charAt(F--)+K);a[c].v=K,a[c].t="t",ee=c}for(F>=0&&ee<a.length&&(a[ee].v=O.substr(0,F+1)+a[ee].v),F=O.indexOf(".")+1,c=ne;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==ne)){for(x=a[c].v.indexOf(".")>-1&&c===ne?a[c].v.indexOf(".")+1:0,K=a[c].v.substr(0,x);x<a[c].v.length;++x)F<O.length&&(K+=O.charAt(F++));a[c].v=K,a[c].t="t",ee=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(z=n>1&&r<0&&c>0&&a[c-1].v==="-"?-r:r,a[c].v=Ci(a[c].t,a[c].v,z),a[c].t="t");var ve="";for(c=0;c!==a.length;++c)a[c]!=null&&(ve+=a[c].v);return ve}var Tg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Eg(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function hw(e,r){var t=dw(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(Tg),f=t[1].match(Tg);return Eg(r,c)?[n,t[0]]:Eg(r,f)?[n,t[1]]:[n,t[c!=null&&f!=null?2:1]]}return[n,l]}function ca(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:kt)[e],n==null&&(n=t.table&&t.table[bg[e]]||kt[bg[e]]),n==null&&(n=q_[e]||"General");break}if(Hd(n,0))return uo(r,t);r instanceof Date&&(r=wx(r,t.date1904));var a=hw(n,r);if(Hd(a[1]))return uo(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return fw(a[1],r,t,a[0])}function so(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(kt[t]==null){r<0&&(r=t);continue}if(kt[t]==e){r=t;break}}r<0&&(r=391)}return kt[r]=e,r}function Nx(){kt=K_()}var mw={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Dx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function pw(e){var r=typeof e=="number"?kt[e]:e;return r=r.replace(Dx,"(\\d+)"),new RegExp("^"+r+"$")}function gw(e,r,t){var n=-1,a=-1,l=-1,c=-1,f=-1,m=-1;(r.match(Dx)||[]).forEach(function(y,b){var E=parseInt(t[b+1],10);switch(y.toLowerCase().charAt(0)){case"y":n=E;break;case"d":l=E;break;case"h":c=E;break;case"s":m=E;break;case"m":c>=0?f=E:a=E;break}}),m>=0&&f==-1&&a>=0&&(f=a,a=-1);var g=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);g.length==7&&(g="0"+g),g.length==8&&(g="20"+g);var x=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return c==-1&&f==-1&&m==-1?g:n==-1&&a==-1&&l==-1?x:g+"T"+x}var vw=(function(){var e={};e.version="1.2.0";function r(){for(var O=0,ne=new Array(256),ee=0;ee!=256;++ee)O=ee,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,ne[ee]=O;return typeof Int32Array<"u"?new Int32Array(ne):ne}var t=r();function n(O){var ne=0,ee=0,ve=0,he=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ve=0;ve!=256;++ve)he[ve]=O[ve];for(ve=0;ve!=256;++ve)for(ee=O[ve],ne=256+ve;ne<4096;ne+=256)ee=he[ne]=ee>>>8^O[ee&255];var ce=[];for(ve=1;ve!=16;++ve)ce[ve-1]=typeof Int32Array<"u"?he.subarray(ve*256,ve*256+256):he.slice(ve*256,ve*256+256);return ce}var a=n(t),l=a[0],c=a[1],f=a[2],m=a[3],g=a[4],x=a[5],y=a[6],b=a[7],E=a[8],S=a[9],k=a[10],C=a[11],R=a[12],j=a[13],N=a[14];function F(O,ne){for(var ee=ne^-1,ve=0,he=O.length;ve<he;)ee=ee>>>8^t[(ee^O.charCodeAt(ve++))&255];return~ee}function K(O,ne){for(var ee=ne^-1,ve=O.length-15,he=0;he<ve;)ee=N[O[he++]^ee&255]^j[O[he++]^ee>>8&255]^R[O[he++]^ee>>16&255]^C[O[he++]^ee>>>24]^k[O[he++]]^S[O[he++]]^E[O[he++]]^b[O[he++]]^y[O[he++]]^x[O[he++]]^g[O[he++]]^m[O[he++]]^f[O[he++]]^c[O[he++]]^l[O[he++]]^t[O[he++]];for(ve+=15;he<ve;)ee=ee>>>8^t[(ee^O[he++])&255];return~ee}function z(O,ne){for(var ee=ne^-1,ve=0,he=O.length,ce=0,Ne=0;ve<he;)ce=O.charCodeAt(ve++),ce<128?ee=ee>>>8^t[(ee^ce)&255]:ce<2048?(ee=ee>>>8^t[(ee^(192|ce>>6&31))&255],ee=ee>>>8^t[(ee^(128|ce&63))&255]):ce>=55296&&ce<57344?(ce=(ce&1023)+64,Ne=O.charCodeAt(ve++)&1023,ee=ee>>>8^t[(ee^(240|ce>>8&7))&255],ee=ee>>>8^t[(ee^(128|ce>>2&63))&255],ee=ee>>>8^t[(ee^(128|Ne>>6&15|(ce&3)<<4))&255],ee=ee>>>8^t[(ee^(128|Ne&63))&255]):(ee=ee>>>8^t[(ee^(224|ce>>12&15))&255],ee=ee>>>8^t[(ee^(128|ce>>6&63))&255],ee=ee>>>8^t[(ee^(128|ce&63))&255]);return~ee}return e.table=t,e.bstr=F,e.buf=K,e.str=z,e})(),Dt=(function(){var r={};r.version="1.2.1";function t(U,re){for(var q=U.split("/"),X=re.split("/"),J=0,ie=0,ke=Math.min(q.length,X.length);J<ke;++J){if(ie=q[J].length-X[J].length)return ie;if(q[J]!=X[J])return q[J]<X[J]?-1:1}return q.length-X.length}function n(U){if(U.charAt(U.length-1)=="/")return U.slice(0,-1).indexOf("/")===-1?U:n(U.slice(0,-1));var re=U.lastIndexOf("/");return re===-1?U:U.slice(0,re+1)}function a(U){if(U.charAt(U.length-1)=="/")return a(U.slice(0,-1));var re=U.lastIndexOf("/");return re===-1?U:U.slice(re+1)}function l(U,re){typeof re=="string"&&(re=new Date(re));var q=re.getHours();q=q<<6|re.getMinutes(),q=q<<5|re.getSeconds()>>>1,U.write_shift(2,q);var X=re.getFullYear()-1980;X=X<<4|re.getMonth()+1,X=X<<5|re.getDate(),U.write_shift(2,X)}function c(U){var re=U.read_shift(2)&65535,q=U.read_shift(2)&65535,X=new Date,J=q&31;q>>>=5;var ie=q&15;q>>>=4,X.setMilliseconds(0),X.setFullYear(q+1980),X.setMonth(ie-1),X.setDate(J);var ke=re&31;re>>>=5;var De=re&63;return re>>>=6,X.setHours(re),X.setMinutes(De),X.setSeconds(ke<<1),X}function f(U){Wr(U,0);for(var re={},q=0;U.l<=U.length-4;){var X=U.read_shift(2),J=U.read_shift(2),ie=U.l+J,ke={};switch(X){case 21589:q=U.read_shift(1),q&1&&(ke.mtime=U.read_shift(4)),J>5&&(q&2&&(ke.atime=U.read_shift(4)),q&4&&(ke.ctime=U.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}U.l=ie,re[X]=ke}return re}var m;function g(){return m||(m={})}function x(U,re){if(U[0]==80&&U[1]==75)return da(U,re);if((U[0]|32)==109&&(U[1]|32)==105)return qe(U,re);if(U.length<512)throw new Error("CFB file size "+U.length+" < 512");var q=3,X=512,J=0,ie=0,ke=0,De=0,Se=0,Ee=[],Ce=U.slice(0,512);Wr(Ce,0);var Me=y(Ce);switch(q=Me[0],q){case 3:X=512;break;case 4:X=4096;break;case 0:if(Me[1]==0)return da(U,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}X!==512&&(Ce=U.slice(0,X),Wr(Ce,28));var Ve=U.slice(0,X);b(Ce,q);var Ye=Ce.read_shift(4,"i");if(q===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);Ce.l+=4,ke=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),De=Ce.read_shift(4,"i"),J=Ce.read_shift(4,"i"),Se=Ce.read_shift(4,"i"),ie=Ce.read_shift(4,"i");for(var $e=-1,Ue=0;Ue<109&&($e=Ce.read_shift(4,"i"),!($e<0));++Ue)Ee[Ue]=$e;var vt=E(U,X);C(Se,ie,vt,X,Ee);var Rt=j(vt,ke,Ee,X);Rt[ke].name="!Directory",J>0&&De!==Ne&&(Rt[De].name="!MiniFAT"),Rt[Ee[0]].name="!FAT",Rt.fat_addrs=Ee,Rt.ssz=X;var Bt={},tr=[],ha=[],wn=[];N(ke,Rt,vt,tr,J,Bt,ha,De),S(ha,wn,tr),tr.shift();var On={FileIndex:ha,FullPaths:wn};return re&&re.raw&&(On.raw={header:Ve,sectors:vt}),On}function y(U){if(U[U.l]==80&&U[U.l+1]==75)return[0,0];U.chk(xe,"Header Signature: "),U.l+=16;var re=U.read_shift(2,"u");return[U.read_shift(2,"u"),re]}function b(U,re){var q=9;switch(U.l+=2,q=U.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}U.chk("0600","Mini Sector Shift: "),U.chk("000000000000","Reserved: ")}function E(U,re){for(var q=Math.ceil(U.length/re)-1,X=[],J=1;J<q;++J)X[J-1]=U.slice(J*re,(J+1)*re);return X[q-1]=U.slice(q*re),X}function S(U,re,q){for(var X=0,J=0,ie=0,ke=0,De=0,Se=q.length,Ee=[],Ce=[];X<Se;++X)Ee[X]=Ce[X]=X,re[X]=q[X];for(;De<Ce.length;++De)X=Ce[De],J=U[X].L,ie=U[X].R,ke=U[X].C,Ee[X]===X&&(J!==-1&&Ee[J]!==J&&(Ee[X]=Ee[J]),ie!==-1&&Ee[ie]!==ie&&(Ee[X]=Ee[ie])),ke!==-1&&(Ee[ke]=X),J!==-1&&X!=Ee[X]&&(Ee[J]=Ee[X],Ce.lastIndexOf(J)<De&&Ce.push(J)),ie!==-1&&X!=Ee[X]&&(Ee[ie]=Ee[X],Ce.lastIndexOf(ie)<De&&Ce.push(ie));for(X=1;X<Se;++X)Ee[X]===X&&(ie!==-1&&Ee[ie]!==ie?Ee[X]=Ee[ie]:J!==-1&&Ee[J]!==J&&(Ee[X]=Ee[J]));for(X=1;X<Se;++X)if(U[X].type!==0){if(De=X,De!=Ee[De])do De=Ee[De],re[X]=re[De]+"/"+re[X];while(De!==0&&Ee[De]!==-1&&De!=Ee[De]);Ee[X]=-1}for(re[0]+="/",X=1;X<Se;++X)U[X].type!==2&&(re[X]+="/")}function k(U,re,q){for(var X=U.start,J=U.size,ie=[],ke=X;q&&J>0&&ke>=0;)ie.push(re.slice(ke*ce,ke*ce+ce)),J-=ce,ke=no(q,ke*4);return ie.length===0?Ir(0):xs(ie).slice(0,U.size)}function C(U,re,q,X,J){var ie=Ne;if(U===Ne){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(U!==-1){var ke=q[U],De=(X>>>2)-1;if(!ke)return;for(var Se=0;Se<De&&(ie=no(ke,Se*4))!==Ne;++Se)J.push(ie);C(no(ke,X-4),re-1,q,X,J)}}function R(U,re,q,X,J){var ie=[],ke=[];J||(J=[]);var De=X-1,Se=0,Ee=0;for(Se=re;Se>=0;){J[Se]=!0,ie[ie.length]=Se,ke.push(U[Se]);var Ce=q[Math.floor(Se*4/X)];if(Ee=Se*4&De,X<4+Ee)throw new Error("FAT boundary crossed: "+Se+" 4 "+X);if(!U[Ce])break;Se=no(U[Ce],Ee)}return{nodes:ie,data:Lg([ke])}}function j(U,re,q,X){var J=U.length,ie=[],ke=[],De=[],Se=[],Ee=X-1,Ce=0,Me=0,Ve=0,Ye=0;for(Ce=0;Ce<J;++Ce)if(De=[],Ve=Ce+re,Ve>=J&&(Ve-=J),!ke[Ve]){Se=[];var $e=[];for(Me=Ve;Me>=0;){$e[Me]=!0,ke[Me]=!0,De[De.length]=Me,Se.push(U[Me]);var Ue=q[Math.floor(Me*4/X)];if(Ye=Me*4&Ee,X<4+Ye)throw new Error("FAT boundary crossed: "+Me+" 4 "+X);if(!U[Ue]||(Me=no(U[Ue],Ye),$e[Me]))break}ie[Ve]={nodes:De,data:Lg([Se])}}return ie}function N(U,re,q,X,J,ie,ke,De){for(var Se=0,Ee=X.length?2:0,Ce=re[U].data,Me=0,Ve=0,Ye;Me<Ce.length;Me+=128){var $e=Ce.slice(Me,Me+128);Wr($e,64),Ve=$e.read_shift(2),Ye=X0($e,0,Ve-Ee),X.push(Ye);var Ue={name:Ye,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},vt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);vt!==0&&(Ue.ct=F($e,$e.l-8));var Rt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);Rt!==0&&(Ue.mt=F($e,$e.l-8)),Ue.start=$e.read_shift(4,"i"),Ue.size=$e.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=Ne,Ue.name=""),Ue.type===5?(Se=Ue.start,J>0&&Se!==Ne&&(re[Se].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",re[Ue.start]===void 0&&(re[Ue.start]=R(q,Ue.start,re.fat_addrs,re.ssz)),re[Ue.start].name=Ue.name,Ue.content=re[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:Se!==Ne&&Ue.start!==Ne&&re[Se]&&(Ue.content=k(Ue,re[Se].data,(re[De]||{}).data))),Ue.content&&Wr(Ue.content,0),ie[Ye]=Ue,ke.push(Ue)}}function F(U,re){return new Date((Vn(U,re+4)/1e7*Math.pow(2,32)+Vn(U,re)/1e7-11644473600)*1e3)}function K(U,re){return g(),x(m.readFileSync(U),re)}function z(U,re){var q=re&&re.type;switch(q||Nt&&Buffer.isBuffer(U)&&(q="buffer"),q||"base64"){case"file":return K(U,re);case"base64":return x(Da(Gn(U)),re);case"binary":return x(Da(U),re)}return x(U,re)}function O(U,re){var q=re||{},X=q.root||"Root Entry";if(U.FullPaths||(U.FullPaths=[]),U.FileIndex||(U.FileIndex=[]),U.FullPaths.length!==U.FileIndex.length)throw new Error("inconsistent CFB structure");U.FullPaths.length===0&&(U.FullPaths[0]=X+"/",U.FileIndex[0]={name:X,type:5}),q.CLSID&&(U.FileIndex[0].clsid=q.CLSID),ne(U)}function ne(U){var re="Sh33tJ5";if(!Dt.find(U,"/"+re)){var q=Ir(4);q[0]=55,q[1]=q[3]=50,q[2]=54,U.FileIndex.push({name:re,type:2,content:q,size:4,L:69,R:69,C:69}),U.FullPaths.push(U.FullPaths[0]+re),ee(U)}}function ee(U,re){O(U);for(var q=!1,X=!1,J=U.FullPaths.length-1;J>=0;--J){var ie=U.FileIndex[J];switch(ie.type){case 0:X?q=!0:(U.FileIndex.pop(),U.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(ie.R*ie.L*ie.C)&&(q=!0),ie.R>-1&&ie.L>-1&&ie.R==ie.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!re)){var ke=new Date(1987,1,19),De=0,Se=Object.create?Object.create(null):{},Ee=[];for(J=0;J<U.FullPaths.length;++J)Se[U.FullPaths[J]]=!0,U.FileIndex[J].type!==0&&Ee.push([U.FullPaths[J],U.FileIndex[J]]);for(J=0;J<Ee.length;++J){var Ce=n(Ee[J][0]);X=Se[Ce],X||(Ee.push([Ce,{name:a(Ce).replace("/",""),type:1,clsid:Q,ct:ke,mt:ke,content:null}]),Se[Ce]=!0)}for(Ee.sort(function(Ye,$e){return t(Ye[0],$e[0])}),U.FullPaths=[],U.FileIndex=[],J=0;J<Ee.length;++J)U.FullPaths[J]=Ee[J][0],U.FileIndex[J]=Ee[J][1];for(J=0;J<Ee.length;++J){var Me=U.FileIndex[J],Ve=U.FullPaths[J];if(Me.name=a(Ve).replace("/",""),Me.L=Me.R=Me.C=-(Me.color=1),Me.size=Me.content?Me.content.length:0,Me.start=0,Me.clsid=Me.clsid||Q,J===0)Me.C=Ee.length>1?1:-1,Me.size=0,Me.type=5;else if(Ve.slice(-1)=="/"){for(De=J+1;De<Ee.length&&n(U.FullPaths[De])!=Ve;++De);for(Me.C=De>=Ee.length?-1:De,De=J+1;De<Ee.length&&n(U.FullPaths[De])!=n(Ve);++De);Me.R=De>=Ee.length?-1:De,Me.type=1}else n(U.FullPaths[J+1]||"")==n(Ve)&&(Me.R=J+1),Me.type=2}}}function ve(U,re){var q=re||{};if(q.fileType=="mad")return Je(U,q);switch(ee(U),q.fileType){case"zip":return In(U,q)}var X=(function(Ye){for(var $e=0,Ue=0,vt=0;vt<Ye.FileIndex.length;++vt){var Rt=Ye.FileIndex[vt];if(Rt.content){var Bt=Rt.content.length;Bt>0&&(Bt<4096?$e+=Bt+63>>6:Ue+=Bt+511>>9)}}for(var tr=Ye.FullPaths.length+3>>2,ha=$e+7>>3,wn=$e+127>>7,On=ha+Ue+tr+wn,hr=On+127>>7,ma=hr<=109?0:Math.ceil((hr-109)/127);On+hr+ma+127>>7>hr;)ma=++hr<=109?0:Math.ceil((hr-109)/127);var lt=[1,ma,hr,wn,tr,Ue,$e,0];return Ye.FileIndex[0].size=$e<<6,lt[7]=(Ye.FileIndex[0].start=lt[0]+lt[1]+lt[2]+lt[3]+lt[4]+lt[5])+(lt[6]+7>>3),lt})(U),J=Ir(X[7]<<9),ie=0,ke=0;{for(ie=0;ie<8;++ie)J.write_shift(1,le[ie]);for(ie=0;ie<8;++ie)J.write_shift(2,0);for(J.write_shift(2,62),J.write_shift(2,3),J.write_shift(2,65534),J.write_shift(2,9),J.write_shift(2,6),ie=0;ie<3;++ie)J.write_shift(2,0);for(J.write_shift(4,0),J.write_shift(4,X[2]),J.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),J.write_shift(4,0),J.write_shift(4,4096),J.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:Ne),J.write_shift(4,X[3]),J.write_shift(-4,X[1]?X[0]-1:Ne),J.write_shift(4,X[1]),ie=0;ie<109;++ie)J.write_shift(-4,ie<X[2]?X[1]+ie:-1)}if(X[1])for(ke=0;ke<X[1];++ke){for(;ie<236+ke*127;++ie)J.write_shift(-4,ie<X[2]?X[1]+ie:-1);J.write_shift(-4,ke===X[1]-1?Ne:ke+1)}var De=function(Ye){for(ke+=Ye;ie<ke-1;++ie)J.write_shift(-4,ie+1);Ye&&(++ie,J.write_shift(-4,Ne))};for(ke=ie=0,ke+=X[1];ie<ke;++ie)J.write_shift(-4,M.DIFSECT);for(ke+=X[2];ie<ke;++ie)J.write_shift(-4,M.FATSECT);De(X[3]),De(X[4]);for(var Se=0,Ee=0,Ce=U.FileIndex[0];Se<U.FileIndex.length;++Se)Ce=U.FileIndex[Se],Ce.content&&(Ee=Ce.content.length,!(Ee<4096)&&(Ce.start=ke,De(Ee+511>>9)));for(De(X[6]+7>>3);J.l&511;)J.write_shift(-4,M.ENDOFCHAIN);for(ke=ie=0,Se=0;Se<U.FileIndex.length;++Se)Ce=U.FileIndex[Se],Ce.content&&(Ee=Ce.content.length,!(!Ee||Ee>=4096)&&(Ce.start=ke,De(Ee+63>>6)));for(;J.l&511;)J.write_shift(-4,M.ENDOFCHAIN);for(ie=0;ie<X[4]<<2;++ie){var Me=U.FullPaths[ie];if(!Me||Me.length===0){for(Se=0;Se<17;++Se)J.write_shift(4,0);for(Se=0;Se<3;++Se)J.write_shift(4,-1);for(Se=0;Se<12;++Se)J.write_shift(4,0);continue}Ce=U.FileIndex[ie],ie===0&&(Ce.start=Ce.size?Ce.start-1:Ne);var Ve=ie===0&&q.root||Ce.name;if(Ee=2*(Ve.length+1),J.write_shift(64,Ve,"utf16le"),J.write_shift(2,Ee),J.write_shift(1,Ce.type),J.write_shift(1,Ce.color),J.write_shift(-4,Ce.L),J.write_shift(-4,Ce.R),J.write_shift(-4,Ce.C),Ce.clsid)J.write_shift(16,Ce.clsid,"hex");else for(Se=0;Se<4;++Se)J.write_shift(4,0);J.write_shift(4,Ce.state||0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,0),J.write_shift(4,Ce.start),J.write_shift(4,Ce.size),J.write_shift(4,0)}for(ie=1;ie<U.FileIndex.length;++ie)if(Ce=U.FileIndex[ie],Ce.size>=4096)if(J.l=Ce.start+1<<9,Nt&&Buffer.isBuffer(Ce.content))Ce.content.copy(J,J.l,0,Ce.size),J.l+=Ce.size+511&-512;else{for(Se=0;Se<Ce.size;++Se)J.write_shift(1,Ce.content[Se]);for(;Se&511;++Se)J.write_shift(1,0)}for(ie=1;ie<U.FileIndex.length;++ie)if(Ce=U.FileIndex[ie],Ce.size>0&&Ce.size<4096)if(Nt&&Buffer.isBuffer(Ce.content))Ce.content.copy(J,J.l,0,Ce.size),J.l+=Ce.size+63&-64;else{for(Se=0;Se<Ce.size;++Se)J.write_shift(1,Ce.content[Se]);for(;Se&63;++Se)J.write_shift(1,0)}if(Nt)J.l=J.length;else for(;J.l<J.length;)J.write_shift(1,0);return J}function he(U,re){var q=U.FullPaths.map(function(Se){return Se.toUpperCase()}),X=q.map(function(Se){var Ee=Se.split("/");return Ee[Ee.length-(Se.slice(-1)=="/"?2:1)]}),J=!1;re.charCodeAt(0)===47?(J=!0,re=q[0].slice(0,-1)+re):J=re.indexOf("/")!==-1;var ie=re.toUpperCase(),ke=J===!0?q.indexOf(ie):X.indexOf(ie);if(ke!==-1)return U.FileIndex[ke];var De=!ie.match(Sc);for(ie=ie.replace(xn,""),De&&(ie=ie.replace(Sc,"!")),ke=0;ke<q.length;++ke)if((De?q[ke].replace(Sc,"!"):q[ke]).replace(xn,"")==ie||(De?X[ke].replace(Sc,"!"):X[ke]).replace(xn,"")==ie)return U.FileIndex[ke];return null}var ce=64,Ne=-2,xe="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],Q="00000000000000000000000000000000",M={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ne,FREESECT:-1,HEADER_SIGNATURE:xe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(U,re,q){g();var X=ve(U,q);m.writeFileSync(re,X)}function H(U){for(var re=new Array(U.length),q=0;q<U.length;++q)re[q]=String.fromCharCode(U[q]);return re.join("")}function se(U,re){var q=ve(U,re);switch(re&&re.type||"buffer"){case"file":return g(),m.writeFileSync(re.filename,q),q;case"binary":return typeof q=="string"?q:H(q);case"base64":return xg(typeof q=="string"?q:H(q));case"buffer":if(Nt)return Buffer.isBuffer(q)?q:mo(q);case"array":return typeof q=="string"?Da(q):q}return q}var D;function P(U){try{var re=U.InflateRaw,q=new re;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)D=U;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function I(U,re){if(!D)return Fa(U,re);var q=D.InflateRaw,X=new q,J=X._processChunk(U.slice(U.l),X._finishFlushFlag);return U.l+=X.bytesRead,J}function B(U){return D?D.deflateRawSync(U):ct(U)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(U){var re=(U<<1|U<<11)&139536|(U<<5|U<<15)&558144;return(re>>16|re>>8|re)&255}for(var me=typeof Uint8Array<"u",ye=me?new Uint8Array(256):[],Ke=0;Ke<256;++Ke)ye[Ke]=pe(Ke);function ae(U,re){var q=ye[U&255];return re<=8?q>>>8-re:(q=q<<8|ye[U>>8&255],re<=16?q>>>16-re:(q=q<<8|ye[U>>16&255],q>>>24-re))}function at(U,re){var q=re&7,X=re>>>3;return(U[X]|(q<=6?0:U[X+1]<<8))>>>q&3}function dt(U,re){var q=re&7,X=re>>>3;return(U[X]|(q<=5?0:U[X+1]<<8))>>>q&7}function mt(U,re){var q=re&7,X=re>>>3;return(U[X]|(q<=4?0:U[X+1]<<8))>>>q&15}function st(U,re){var q=re&7,X=re>>>3;return(U[X]|(q<=3?0:U[X+1]<<8))>>>q&31}function Le(U,re){var q=re&7,X=re>>>3;return(U[X]|(q<=1?0:U[X+1]<<8))>>>q&127}function At(U,re,q){var X=re&7,J=re>>>3,ie=(1<<q)-1,ke=U[J]>>>X;return q<8-X||(ke|=U[J+1]<<8-X,q<16-X)||(ke|=U[J+2]<<16-X,q<24-X)||(ke|=U[J+3]<<24-X),ke&ie}function dr(U,re,q){var X=re&7,J=re>>>3;return X<=5?U[J]|=(q&7)<<X:(U[J]|=q<<X&255,U[J+1]=(q&7)>>8-X),re+3}function Yt(U,re,q){var X=re&7,J=re>>>3;return q=(q&1)<<X,U[J]|=q,re+1}function Qt(U,re,q){var X=re&7,J=re>>>3;return q<<=X,U[J]|=q&255,q>>>=8,U[J+1]=q,re+8}function _n(U,re,q){var X=re&7,J=re>>>3;return q<<=X,U[J]|=q&255,q>>>=8,U[J+1]=q&255,U[J+2]=q>>>8,re+16}function br(U,re){var q=U.length,X=2*q>re?2*q:re+5,J=0;if(q>=re)return U;if(Nt){var ie=yg(X);if(U.copy)U.copy(ie);else for(;J<U.length;++J)ie[J]=U[J];return ie}else if(me){var ke=new Uint8Array(X);if(ke.set)ke.set(U);else for(;J<q;++J)ke[J]=U[J];return ke}return U.length=X,U}function er(U){for(var re=new Array(U),q=0;q<U;++q)re[q]=0;return re}function kr(U,re,q){var X=1,J=0,ie=0,ke=0,De=0,Se=U.length,Ee=me?new Uint16Array(32):er(32);for(ie=0;ie<32;++ie)Ee[ie]=0;for(ie=Se;ie<q;++ie)U[ie]=0;Se=U.length;var Ce=me?new Uint16Array(Se):er(Se);for(ie=0;ie<Se;++ie)Ee[J=U[ie]]++,X<J&&(X=J),Ce[ie]=0;for(Ee[0]=0,ie=1;ie<=X;++ie)Ee[ie+16]=De=De+Ee[ie-1]<<1;for(ie=0;ie<Se;++ie)De=U[ie],De!=0&&(Ce[ie]=Ee[De+16]++);var Me=0;for(ie=0;ie<Se;++ie)if(Me=U[ie],Me!=0)for(De=ae(Ce[ie],X)>>X-Me,ke=(1<<X+4-Me)-1;ke>=0;--ke)re[De|ke<<Me]=Me&15|ie<<4;return X}var fr=me?new Uint16Array(512):er(512),Sr=me?new Uint16Array(32):er(32);if(!me){for(var St=0;St<512;++St)fr[St]=0;for(St=0;St<32;++St)Sr[St]=0}(function(){for(var U=[],re=0;re<32;re++)U.push(5);kr(U,Sr,32);var q=[];for(re=0;re<=143;re++)q.push(8);for(;re<=255;re++)q.push(9);for(;re<=279;re++)q.push(7);for(;re<=287;re++)q.push(8);kr(q,fr,288)})();var ir=(function(){for(var re=me?new Uint8Array(32768):[],q=0,X=0;q<de.length-1;++q)for(;X<de[q+1];++X)re[X]=q;for(;X<32768;++X)re[X]=29;var J=me?new Uint8Array(259):[];for(q=0,X=0;q<te.length-1;++q)for(;X<te[q+1];++X)J[X]=q;function ie(De,Se){for(var Ee=0;Ee<De.length;){var Ce=Math.min(65535,De.length-Ee),Me=Ee+Ce==De.length;for(Se.write_shift(1,+Me),Se.write_shift(2,Ce),Se.write_shift(2,~Ce&65535);Ce-- >0;)Se[Se.l++]=De[Ee++]}return Se.l}function ke(De,Se){for(var Ee=0,Ce=0,Me=me?new Uint16Array(32768):[];Ce<De.length;){var Ve=Math.min(65535,De.length-Ce);if(Ve<10){for(Ee=dr(Se,Ee,+(Ce+Ve==De.length)),Ee&7&&(Ee+=8-(Ee&7)),Se.l=Ee/8|0,Se.write_shift(2,Ve),Se.write_shift(2,~Ve&65535);Ve-- >0;)Se[Se.l++]=De[Ce++];Ee=Se.l*8;continue}Ee=dr(Se,Ee,+(Ce+Ve==De.length)+2);for(var Ye=0;Ve-- >0;){var $e=De[Ce];Ye=(Ye<<5^$e)&32767;var Ue=-1,vt=0;if((Ue=Me[Ye])&&(Ue|=Ce&-32768,Ue>Ce&&(Ue-=32768),Ue<Ce))for(;De[Ue+vt]==De[Ce+vt]&&vt<250;)++vt;if(vt>2){$e=J[vt],$e<=22?Ee=Qt(Se,Ee,ye[$e+1]>>1)-1:(Qt(Se,Ee,3),Ee+=5,Qt(Se,Ee,ye[$e-23]>>5),Ee+=3);var Rt=$e<8?0:$e-4>>2;Rt>0&&(_n(Se,Ee,vt-te[$e]),Ee+=Rt),$e=re[Ce-Ue],Ee=Qt(Se,Ee,ye[$e]>>3),Ee-=3;var Bt=$e<4?0:$e-2>>1;Bt>0&&(_n(Se,Ee,Ce-Ue-de[$e]),Ee+=Bt);for(var tr=0;tr<vt;++tr)Me[Ye]=Ce&32767,Ye=(Ye<<5^De[Ce])&32767,++Ce;Ve-=vt-1}else $e<=143?$e=$e+48:Ee=Yt(Se,Ee,1),Ee=Qt(Se,Ee,ye[$e]),Me[Ye]=Ce&32767,++Ce}Ee=Qt(Se,Ee,0)-1}return Se.l=(Ee+7)/8|0,Se.l}return function(Se,Ee){return Se.length<8?ie(Se,Ee):ke(Se,Ee)}})();function ct(U){var re=Ir(50+Math.floor(U.length*1.1)),q=ir(U,re);return re.slice(0,q)}var Ge=me?new Uint16Array(32768):er(32768),Tr=me?new Uint16Array(32768):er(32768),$t=me?new Uint16Array(128):er(128),Gr=1,sr=1;function ri(U,re){var q=st(U,re)+257;re+=5;var X=st(U,re)+1;re+=5;var J=mt(U,re)+4;re+=4;for(var ie=0,ke=me?new Uint8Array(19):er(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,Ee=me?new Uint8Array(8):er(8),Ce=me?new Uint8Array(8):er(8),Me=ke.length,Ve=0;Ve<J;++Ve)ke[G[Ve]]=ie=dt(U,re),Se<ie&&(Se=ie),Ee[ie]++,re+=3;var Ye=0;for(Ee[0]=0,Ve=1;Ve<=Se;++Ve)Ce[Ve]=Ye=Ye+Ee[Ve-1]<<1;for(Ve=0;Ve<Me;++Ve)(Ye=ke[Ve])!=0&&(De[Ve]=Ce[Ye]++);var $e=0;for(Ve=0;Ve<Me;++Ve)if($e=ke[Ve],$e!=0){Ye=ye[De[Ve]]>>8-$e;for(var Ue=(1<<7-$e)-1;Ue>=0;--Ue)$t[Ye|Ue<<$e]=$e&7|Ve<<3}var vt=[];for(Se=1;vt.length<q+X;)switch(Ye=$t[Le(U,re)],re+=Ye&7,Ye>>>=3){case 16:for(ie=3+at(U,re),re+=2,Ye=vt[vt.length-1];ie-- >0;)vt.push(Ye);break;case 17:for(ie=3+dt(U,re),re+=3;ie-- >0;)vt.push(0);break;case 18:for(ie=11+Le(U,re),re+=7;ie-- >0;)vt.push(0);break;default:vt.push(Ye),Se<Ye&&(Se=Ye);break}var Rt=vt.slice(0,q),Bt=vt.slice(q);for(Ve=q;Ve<286;++Ve)Rt[Ve]=0;for(Ve=X;Ve<30;++Ve)Bt[Ve]=0;return Gr=kr(Rt,Ge,286),sr=kr(Bt,Tr,30),re}function ln(U,re){if(U[0]==3&&!(U[1]&3))return[Ss(re),2];for(var q=0,X=0,J=yg(re||1<<18),ie=0,ke=J.length>>>0,De=0,Se=0;(X&1)==0;){if(X=dt(U,q),q+=3,X>>>1)X>>1==1?(De=9,Se=5):(q=ri(U,q),De=Gr,Se=sr);else{q&7&&(q+=8-(q&7));var Ee=U[q>>>3]|U[(q>>>3)+1]<<8;if(q+=32,Ee>0)for(!re&&ke<ie+Ee&&(J=br(J,ie+Ee),ke=J.length);Ee-- >0;)J[ie++]=U[q>>>3],q+=8;continue}for(;;){!re&&ke<ie+32767&&(J=br(J,ie+32767),ke=J.length);var Ce=At(U,q,De),Me=X>>>1==1?fr[Ce]:Ge[Ce];if(q+=Me&15,Me>>>=4,(Me>>>8&255)===0)J[ie++]=Me;else{if(Me==256)break;Me-=257;var Ve=Me<8?0:Me-4>>2;Ve>5&&(Ve=0);var Ye=ie+te[Me];Ve>0&&(Ye+=At(U,q,Ve),q+=Ve),Ce=At(U,q,Se),Me=X>>>1==1?Sr[Ce]:Tr[Ce],q+=Me&15,Me>>>=4;var $e=Me<4?0:Me-2>>1,Ue=de[Me];for($e>0&&(Ue+=At(U,q,$e),q+=$e),!re&&ke<Ye&&(J=br(J,Ye+100),ke=J.length);ie<Ye;)J[ie]=J[ie-Ue],++ie}}}return re?[J,q+7>>>3]:[J.slice(0,ie),q+7>>>3]}function Fa(U,re){var q=U.slice(U.l||0),X=ln(q,re);return U.l+=X[1],X[0]}function La(U,re){if(U)typeof console<"u"&&console.error(re);else throw new Error(re)}function da(U,re){var q=U;Wr(q,0);var X=[],J=[],ie={FileIndex:X,FullPaths:J};O(ie,{root:re.root});for(var ke=q.length-4;(q[ke]!=80||q[ke+1]!=75||q[ke+2]!=5||q[ke+3]!=6)&&ke>=0;)--ke;q.l=ke+4,q.l+=4;var De=q.read_shift(2);q.l+=6;var Se=q.read_shift(4);for(q.l=Se,ke=0;ke<De;++ke){q.l+=20;var Ee=q.read_shift(4),Ce=q.read_shift(4),Me=q.read_shift(2),Ve=q.read_shift(2),Ye=q.read_shift(2);q.l+=8;var $e=q.read_shift(4),Ue=f(q.slice(q.l+Me,q.l+Me+Ve));q.l+=Me+Ve+Ye;var vt=q.l;q.l=$e+4,Dn(q,Ee,Ce,ie,Ue),q.l=vt}return ie}function Dn(U,re,q,X,J){U.l+=2;var ie=U.read_shift(2),ke=U.read_shift(2),De=c(U);if(ie&8257)throw new Error("Unsupported ZIP encryption");for(var Se=U.read_shift(4),Ee=U.read_shift(4),Ce=U.read_shift(4),Me=U.read_shift(2),Ve=U.read_shift(2),Ye="",$e=0;$e<Me;++$e)Ye+=String.fromCharCode(U[U.l++]);if(Ve){var Ue=f(U.slice(U.l,U.l+Ve));(Ue[21589]||{}).mt&&(De=Ue[21589].mt),((J||{})[21589]||{}).mt&&(De=J[21589].mt)}U.l+=Ve;var vt=U.slice(U.l,U.l+Ee);switch(ke){case 8:vt=I(U,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var Rt=!1;ie&8&&(Se=U.read_shift(4),Se==134695760&&(Se=U.read_shift(4),Rt=!0),Ee=U.read_shift(4),Ce=U.read_shift(4)),Ee!=re&&La(Rt,"Bad compressed size: "+re+" != "+Ee),Ce!=q&&La(Rt,"Bad uncompressed size: "+q+" != "+Ce),Qe(X,Ye,vt,{unsafe:!0,mt:De})}function In(U,re){var q=re||{},X=[],J=[],ie=Ir(1),ke=q.compression?8:0,De=0,Se=0,Ee=0,Ce=0,Me=0,Ve=U.FullPaths[0],Ye=Ve,$e=U.FileIndex[0],Ue=[],vt=0;for(Se=1;Se<U.FullPaths.length;++Se)if(Ye=U.FullPaths[Se].slice(Ve.length),$e=U.FileIndex[Se],!(!$e.size||!$e.content||Ye=="Sh33tJ5")){var Rt=Ce,Bt=Ir(Ye.length);for(Ee=0;Ee<Ye.length;++Ee)Bt.write_shift(1,Ye.charCodeAt(Ee)&127);Bt=Bt.slice(0,Bt.l),Ue[Me]=vw.buf($e.content,0);var tr=$e.content;ke==8&&(tr=B(tr)),ie=Ir(30),ie.write_shift(4,67324752),ie.write_shift(2,20),ie.write_shift(2,De),ie.write_shift(2,ke),$e.mt?l(ie,$e.mt):ie.write_shift(4,0),ie.write_shift(-4,Ue[Me]),ie.write_shift(4,tr.length),ie.write_shift(4,$e.content.length),ie.write_shift(2,Bt.length),ie.write_shift(2,0),Ce+=ie.length,X.push(ie),Ce+=Bt.length,X.push(Bt),Ce+=tr.length,X.push(tr),ie=Ir(46),ie.write_shift(4,33639248),ie.write_shift(2,0),ie.write_shift(2,20),ie.write_shift(2,De),ie.write_shift(2,ke),ie.write_shift(4,0),ie.write_shift(-4,Ue[Me]),ie.write_shift(4,tr.length),ie.write_shift(4,$e.content.length),ie.write_shift(2,Bt.length),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(4,0),ie.write_shift(4,Rt),vt+=ie.l,J.push(ie),vt+=Bt.length,J.push(Bt),++Me}return ie=Ir(22),ie.write_shift(4,101010256),ie.write_shift(2,0),ie.write_shift(2,0),ie.write_shift(2,Me),ie.write_shift(2,Me),ie.write_shift(4,vt),ie.write_shift(4,Ce),ie.write_shift(2,0),xs([xs(X),xs(J),ie])}var fa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Di(U,re){if(U.ctype)return U.ctype;var q=U.name||"",X=q.match(/\.([^\.]+)$/);return X&&fa[X[1]]||re&&(X=(q=re).match(/[\.\\]([^\.\\])+$/),X&&fa[X[1]])?fa[X[1]]:"application/octet-stream"}function Ii(U){for(var re=xg(U),q=[],X=0;X<re.length;X+=76)q.push(re.slice(X,X+76));return q.join(`\r
`)+`\r
`}function As(U){var re=U.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var Ce=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],X=re.split(`\r
`),J=0;J<X.length;++J){var ie=X[J];if(ie.length==0){q.push("");continue}for(var ke=0;ke<ie.length;){var De=76,Se=ie.slice(ke,ke+De);Se.charAt(De-1)=="="?De--:Se.charAt(De-2)=="="?De-=2:Se.charAt(De-3)=="="&&(De-=3),Se=ie.slice(ke,ke+De),ke+=De,ke<ie.length&&(Se+="="),q.push(Se)}}return q.join(`\r
`)}function ni(U){for(var re=[],q=0;q<U.length;++q){for(var X=U[q];q<=U.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+U[++q];re.push(X)}for(var J=0;J<re.length;++J)re[J]=re[J].replace(/[=][0-9A-Fa-f]{2}/g,function(ie){return String.fromCharCode(parseInt(ie.slice(1),16))});return Da(re.join(`\r
`))}function Ie(U,re,q){for(var X="",J="",ie="",ke,De=0;De<10;++De){var Se=re[De];if(!Se||Se.match(/^\s*$/))break;var Ee=Se.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":X=Ee[2].trim();break;case"content-type":ie=Ee[2].trim();break;case"content-transfer-encoding":J=Ee[2].trim();break}}switch(++De,J.toLowerCase()){case"base64":ke=Da(Gn(re.slice(De).join("")));break;case"quoted-printable":ke=ni(re.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+J)}var Ce=Qe(U,X.slice(q.length),ke,{unsafe:!0});ie&&(Ce.ctype=ie)}function qe(U,re){if(H(U.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=re&&re.root||"",X=(Nt&&Buffer.isBuffer(U)?U.toString("binary"):H(U)).split(`\r
`),J=0,ie="";for(J=0;J<X.length;++J)if(ie=X[J],!!/^Content-Location:/i.test(ie)&&(ie=ie.slice(ie.indexOf("file")),q||(q=ie.slice(0,ie.lastIndexOf("/")+1)),ie.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),ie.slice(0,q.length)!=q););var ke=(X[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var De="--"+(ke[1]||""),Se=[],Ee=[],Ce={FileIndex:Se,FullPaths:Ee};O(Ce);var Me,Ve=0;for(J=0;J<X.length;++J){var Ye=X[J];Ye!==De&&Ye!==De+"--"||(Ve++&&Ie(Ce,X.slice(Me,J),q),Me=J)}return Ce}function Je(U,re){var q=re||{},X=q.boundary||"SheetJS";X="------="+X;for(var J=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],ie=U.FullPaths[0],ke=ie,De=U.FileIndex[0],Se=1;Se<U.FullPaths.length;++Se)if(ke=U.FullPaths[Se].slice(ie.length),De=U.FileIndex[Se],!(!De.size||!De.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(vt){return"_x"+vt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(vt){return"_u"+vt.charCodeAt(0).toString(16)+"_"});for(var Ee=De.content,Ce=Nt&&Buffer.isBuffer(Ee)?Ee.toString("binary"):H(Ee),Me=0,Ve=Math.min(1024,Ce.length),Ye=0,$e=0;$e<=Ve;++$e)(Ye=Ce.charCodeAt($e))>=32&&Ye<128&&++Me;var Ue=Me>=Ve*4/5;J.push(X),J.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+ke),J.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),J.push("Content-Type: "+Di(De,ke)),J.push(""),J.push(Ue?As(Ce):Ii(Ce))}return J.push(X+`--\r
`),J.join(`\r
`)}function He(U){var re={};return O(re,U),re}function Qe(U,re,q,X){var J=X&&X.unsafe;J||O(U);var ie=!J&&Dt.find(U,re);if(!ie){var ke=U.FullPaths[0];re.slice(0,ke.length)==ke?ke=re:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+re).replace("//","/")),ie={name:a(re),type:2},U.FileIndex.push(ie),U.FullPaths.push(ke),J||Dt.utils.cfb_gc(U)}return ie.content=q,ie.size=q?q.length:0,X&&(X.CLSID&&(ie.clsid=X.CLSID),X.mt&&(ie.mt=X.mt),X.ct&&(ie.ct=X.ct)),ie}function ot(U,re){O(U);var q=Dt.find(U,re);if(q){for(var X=0;X<U.FileIndex.length;++X)if(U.FileIndex[X]==q)return U.FileIndex.splice(X,1),U.FullPaths.splice(X,1),!0}return!1}function it(U,re,q){O(U);var X=Dt.find(U,re);if(X){for(var J=0;J<U.FileIndex.length;++J)if(U.FileIndex[J]==X)return U.FileIndex[J].name=a(q),U.FullPaths[J]=q,!0}return!1}function Oe(U){ee(U,!0)}return r.find=he,r.read=z,r.parse=x,r.write=se,r.writeFile=V,r.utils={cfb_new:He,cfb_add:Qe,cfb_del:ot,cfb_mov:it,cfb_gc:Oe,ReadShift:Pc,CheckField:Qx,prep_blob:Wr,bconcat:xs,use_zlib:P,_deflateRaw:ct,_inflateRaw:Fa,consts:M},r})();function xw(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Xa(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function Z0(e){for(var r=[],t=Xa(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var Zd=new Date(1899,11,30,0,0,0);function yn(e,r){var t=e.getTime(),n=Zd.getTime()+(e.getTimezoneOffset()-Zd.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var Ix=new Date,yw=Zd.getTime()+(Ix.getTimezoneOffset()-Zd.getTimezoneOffset())*6e4,Cg=Ix.getTimezoneOffset();function of(e){var r=new Date;return r.setTime(e*24*60*60*1e3+yw),r.getTimezoneOffset()!==Cg&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Cg)*6e4),r}function _w(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=a.length;++l)if(a[l]){switch(t=1,l>3&&(n=!0),a[l].slice(a[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[l].slice(a[l].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[l],10)}return r}var Ag=new Date("2017-02-19T19:06:09.000Z"),Ox=isNaN(Ag.getFullYear())?new Date("2/19/17"):Ag,ww=Ox.getFullYear()==2017;function zr(e,r){var t=new Date(e);if(ww)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Ox.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function fo(e,r){if(Nt&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Ec(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ec(yx(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Ec(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ec(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return t[l]||l})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Vr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Vr(e[t]));return r}function cr(e,r){for(var t="";t.length<r;)t+=e;return t}function ja(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,l){return t=-t,l}),!isNaN(r=Number(n)))?r/t:r}var bw=["january","february","march","april","may","june","july","august","september","october","november","december"];function Tl(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),l=r.getDate();if(isNaN(l))return t;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&bw.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||l>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var kw=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var l=t.split(n),c=[l[0]],f=1;f<l.length;++f)c.push(a),c.push(l[f]);return c}})();function jx(e){return e?e.content&&e.type?fo(e.content,!0):e.data?kc(e.data):e.asNodeBuffer&&Nt?kc(e.asNodeBuffer().toString("binary")):e.asBinary?kc(e.asBinary()):e._data&&e._data.getContent?kc(fo(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Fx(e){if(!e)return null;if(e.data)return gg(e.data);if(e.asNodeBuffer&&Nt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?gg(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Sw(e){return e&&e.name.slice(-4)===".bin"?Fx(e):jx(e)}function oa(e,r){for(var t=e.FullPaths||Xa(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),l=0;l<t.length;++l){var c=t[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||a==c)return e.files?e.files[t[l]]:e.FileIndex[l]}return null}function K0(e,r){var t=oa(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function yr(e,r,t){if(!t)return Sw(K0(e,r));if(!r)return null;try{return yr(e,r)}catch{return null}}function Hn(e,r,t){if(!t)return jx(K0(e,r));if(!r)return null;try{return Hn(e,r)}catch{return null}}function Tw(e,r,t){return Fx(K0(e,r))}function Pg(e){for(var r=e.FullPaths||Xa(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function Ew(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Nt?n=mo(t):n=H_(t),Dt.utils.cfb_add(e,r,n)}Dt.utils.cfb_add(e,r,t)}else e.file(r,t)}function Lx(e,r){switch(r.type){case"base64":return Dt.read(e,{type:"base64"});case"binary":return Dt.read(e,{type:"binary"});case"buffer":case"array":return Dt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function Tc(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var Rx=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Cw=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ng=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Aw=/<[^>]*>/g,on=Rx.match(Ng)?Ng:Aw,Pw=/<\w*:/,Nw=/<(\/?)\w+:/;function gt(e,r,t){for(var n={},a=0,l=0;a!==e.length&&!((l=e.charCodeAt(a))===32||l===10||l===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var c=e.match(Cw),f=0,m="",g=0,x="",y="",b=1;if(c)for(g=0;g!=c.length;++g){for(y=c[g],l=0;l!=y.length&&y.charCodeAt(l)!==61;++l);for(x=y.slice(0,l).trim();y.charCodeAt(l+1)==32;)++l;for(b=(a=y.charCodeAt(l+1))==34||a==39?1:0,m=y.slice(l+1+b,y.length-b),f=0;f!=x.length&&x.charCodeAt(f)!==58;++f);if(f===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),n[x]=m,n[x.toLowerCase()]=m;else{var E=(f===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(f+1);if(n[E]&&x.slice(f-3,f)=="ext")continue;n[E]=m,n[E.toLowerCase()]=m}}return n}function ei(e){return e.replace(Nw,"<$1")}var Mx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Dw=Z0(Mx),jt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",l=a.indexOf("<![CDATA[");if(l==-1)return a.replace(e,function(f,m){return Mx[f]||String.fromCharCode(parseInt(m,f.indexOf("x")>-1?16:10))||f}).replace(r,function(f,m){return String.fromCharCode(parseInt(m,16))});var c=a.indexOf("]]>");return t(a.slice(0,l))+a.slice(l+9,c)+t(a.slice(c+3))}})(),Iw=/[&<>'"]/g,Ow=/[\u0000-\u001f]/g;function q0(e){var r=e+"";return r.replace(Iw,function(t){return Dw[t]}).replace(/\n/g,"<br/>").replace(Ow,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Dg=(function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}})();function Jt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $h(e){for(var r="",t=0,n=0,a=0,l=0,c=0,f=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){c=(n&31)<<6,c|=a&63,r+=String.fromCharCode(c);continue}if(l=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|l&63);continue}c=e.charCodeAt(t++),f=((n&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(f>>>10&1023)),r+=String.fromCharCode(56320+(f&1023))}return r}function Ig(e){var r=Ss(2*e.length),t,n,a=1,l=0,c=0,f;for(n=0;n<e.length;n+=a)a=1,(f=e.charCodeAt(n))<128?t=f:f<224?(t=(f&31)*64+(e.charCodeAt(n+1)&63),a=2):f<240?(t=(f&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(f&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(r[l++]=c&255,r[l++]=c>>>8,c=0),r[l++]=t%256,r[l++]=t>>>8;return r.slice(0,l).toString("ucs2")}function Og(e){return mo(e,"binary").toString("utf8")}var xd="foo bar baz",Zt=Nt&&(Og(xd)==$h(xd)&&Og||Ig(xd)==$h(xd)&&Ig)||$h,Ec=Nt?function(e){return mo(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Vc=(function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),Bx=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),jw=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),Fw=/<\/?(?:vt:)?variant>/g,Lw=/<(?:vt:)([^>]*)>([\s\S]*)</;function jg(e,r){var t=gt(e),n=e.match(jw(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(l){var c=l.replace(Fw,"").match(Lw);c&&a.push({v:Zt(c[2]),t:c[1]})}),a}var Rw=/(^\s|\s$|\n)/;function Mw(e){return Xa(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Bw(e,r,t){return"<"+e+(t!=null?Mw(t):"")+(r!=null?(r.match(Rw)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Y0(e){if(Nt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Zt(po(V0(e)));throw new Error("Bad input format: expected Buffer or string")}var Hc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,zw={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Uw=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function $w(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,l=5;l>=0;--l)a=a*256+e[r+l];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function Ww(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,l=0,c=n?-r:r;isFinite(c)?c==0?a=l=0:(a=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?a=-1022:(l-=Math.pow(2,52),a+=1023)):(a=2047,l=isNaN(r)?26985:0);for(var f=0;f<=5;++f,l/=256)e[t+f]=l&255;e[t+6]=(a&15)<<4|l&15,e[t+7]=a>>4|n}var Fg=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,l=e[0][n].length;a<l;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},Lg=Nt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:mo(r)})):Fg(e)}:Fg,Rg=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(Ei(e,a)));return n.join("").replace(xn,"")},X0=Nt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(xn,""):Rg(e,r,t)}:Rg,Mg=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},zx=Nt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Mg(e,r,t)}:Mg,Bg=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(vl(e,a)));return n.join("")},tu=Nt?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Bg(r,t,n)}:Bg,Ux=function(e,r){var t=Vn(e,r);return t>0?tu(e,r+4,r+4+t-1):""},$x=Ux,Wx=function(e,r){var t=Vn(e,r);return t>0?tu(e,r+4,r+4+t-1):""},Vx=Wx,Hx=function(e,r){var t=2*Vn(e,r);return t>0?tu(e,r+4,r+4+t-1):""},Gx=Hx,Zx=function(r,t){var n=Vn(r,t);return n>0?X0(r,t+4,t+4+n):""},Kx=Zx,qx=function(e,r){var t=Vn(e,r);return t>0?tu(e,r+4,r+4+t):""},Yx=qx,Xx=function(e,r){return $w(e,r)},Kd=Xx,Jx=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Nt&&($x=function(r,t){if(!Buffer.isBuffer(r))return Ux(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Vx=function(r,t){if(!Buffer.isBuffer(r))return Wx(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Gx=function(r,t){if(!Buffer.isBuffer(r))return Hx(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},Kx=function(r,t){if(!Buffer.isBuffer(r))return Zx(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},Yx=function(r,t){if(!Buffer.isBuffer(r))return qx(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Kd=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):Xx(r,t)},Jx=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var vl=function(e,r){return e[r]},Ei=function(e,r){return e[r+1]*256+e[r]},Vw=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Vn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},no=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Hw=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Pc(e,r){var t="",n,a,l=[],c,f,m,g;switch(r){case"dbcs":if(g=this.l,Nt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)t+=String.fromCharCode(Ei(this,g)),g+=2;e*=2;break;case"utf8":t=tu(this,this.l,this.l+e);break;case"utf16le":e*=2,t=X0(this,this.l,this.l+e);break;case"wstr":return Pc.call(this,e,"dbcs");case"lpstr-ansi":t=$x(this,this.l),e=4+Vn(this,this.l);break;case"lpstr-cp":t=Vx(this,this.l),e=4+Vn(this,this.l);break;case"lpwstr":t=Gx(this,this.l),e=4+2*Vn(this,this.l);break;case"lpp4":e=4+Vn(this,this.l),t=Kx(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Vn(this,this.l),t=Yx(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(c=vl(this,this.l+e++))!==0;)l.push(vd(c));t=l.join("");break;case"_wstr":for(e=0,t="";(c=Ei(this,this.l+e))!==0;)l.push(vd(c)),e+=2;e+=2,t=l.join("");break;case"dbcs-cont":for(t="",g=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return c=vl(this,g),this.l=g+1,f=Pc.call(this,e-m,c?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(vd(Ei(this,g))),g+=2}t=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",g=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return c=vl(this,g),this.l=g+1,f=Pc.call(this,e-m,c?"dbcs-cont":"sbcs-cont"),l.join("")+f;l.push(vd(vl(this,g))),g+=1}t=l.join("");break;default:switch(e){case 1:return n=vl(this,this.l),this.l++,n;case 2:return n=(r==="i"?Vw:Ei)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?no:Hw)(this,this.l),this.l+=4,n):(a=Vn(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Kd(this,this.l):a=Kd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=zx(this,this.l,e);break}}return this.l+=e,t}var Gw=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Zw=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Kw=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function qw(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)Kw(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var c=r.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,Gw(this,r,this.l);break;case 8:if(n=8,t==="f"){Ww(this,r,this.l);break}case 16:break;case-4:n=4,Zw(this,r,this.l);break}return this.l+=n,this}function Qx(e,r){var t=zx(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Wr(e,r){e.l=r,e.read_shift=Pc,e.chk=Qx,e.write_shift=qw}function sn(e,r){e.l+=r}function Ir(e){var r=Ss(e);return Wr(r,0),r}function Ni(e,r,t){if(e){var n,a,l;Wr(e,e.l||0);for(var c=e.length,f=0,m=0;e.l<c;){f=e.read_shift(1),f&128&&(f=(f&127)+((e.read_shift(1)&127)<<7));var g=ef[f]||ef[65535];for(n=e.read_shift(1),l=n&127,a=1;a<4&&n&128;++a)l+=((n=e.read_shift(1))&127)<<7*a;m=e.l+l;var x=g.f&&g.f(e,l,t);if(e.l=m,r(x,g,f))return}}}function m0(){var e=[],r=Nt?256:2048,t=function(g){var x=Ir(g);return Wr(x,0),x},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(g){return n&&g<n.length-n.l?n:(a(),n=t(Math.max(g+1,r)))},c=function(){return a(),xs(e)},f=function(g){a(),n=g,n.l==null&&(n.l=n.length),l(r)};return{next:l,push:f,end:c,_bufs:e}}function Nc(e,r,t){var n=Vr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function zg(e,r,t){var n=Vr(e);return n.s=Nc(n.s,r.s,t),n.e=Nc(n.e,r.s,t),n}function Dc(e,r){if(e.cRel&&e.c<0)for(e=Vr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Vr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=_t(e);return!e.cRel&&e.cRel!=null&&(t=Jw(t)),!e.rRel&&e.rRel!=null&&(t=Yw(t)),t}function Wh(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Or(e.s.c)+":"+(e.e.cRel?"":"$")+Or(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Hr(e.s.r)+":"+(e.e.rRel?"":"$")+Hr(e.e.r):Dc(e.s,r.biff)+":"+Dc(e.e,r.biff)}function J0(e){return parseInt(Xw(e),10)-1}function Hr(e){return""+(e+1)}function Yw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Xw(e){return e.replace(/\$(\d+)$/,"$1")}function Q0(e){for(var r=Qw(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Or(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Jw(e){return e.replace(/^([A-Z])/,"$$$1")}function Qw(e){return e.replace(/^\$([A-Z])/,"$1")}function eb(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function vn(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function _t(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Nl(e){var r=e.indexOf(":");return r==-1?{s:vn(e),e:vn(e)}:{s:vn(e.slice(0,r)),e:vn(e.slice(r+1))}}function It(e,r){return typeof r>"u"||typeof r=="number"?It(e.s,e.e):(typeof e!="string"&&(e=_t(e)),typeof r!="string"&&(r=_t(r)),e==r?e:e+":"+r)}function ur(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,l=e.length;for(t=0;n<l&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<l&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===l||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=l&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=l&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function Ug(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=ca(e.z,t?yn(r):r)}catch{}try{return e.w=ca((e.XF||{}).numFmtId||(t?14:0),t?yn(r):r)}catch{return""+r}}function Pi(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?xo[e.v]||e.v:r==null?Ug(e,e.v):Ug(e,r))}function Es(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function e1(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,l=e||(a?[]:{}),c=0,f=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var m=typeof n.origin=="string"?vn(n.origin):n.origin;c=m.r,f=m.c}l["!ref"]||(l["!ref"]="A1:A1")}var g={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var x=ur(l["!ref"]);g.s.c=x.s.c,g.s.r=x.s.r,g.e.c=Math.max(g.e.c,x.e.c),g.e.r=Math.max(g.e.r,x.e.r),c==-1&&(g.e.r=c=x.e.r+1)}for(var y=0;y!=r.length;++y)if(r[y]){if(!Array.isArray(r[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var b=0;b!=r[y].length;++b)if(!(typeof r[y][b]>"u")){var E={v:r[y][b]},S=c+y,k=f+b;if(g.s.r>S&&(g.s.r=S),g.s.c>k&&(g.s.c=k),g.e.r<S&&(g.e.r=S),g.e.c<k&&(g.e.c=k),r[y][b]&&typeof r[y][b]=="object"&&!Array.isArray(r[y][b])&&!(r[y][b]instanceof Date))E=r[y][b];else if(Array.isArray(E.v)&&(E.f=r[y][b][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(n.nullError)E.t="e",E.v=0;else if(n.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=n.dateNF||kt[14],n.cellDates?(E.t="d",E.w=ca(E.z,yn(E.v))):(E.t="n",E.v=yn(E.v),E.w=ca(E.z,E.v))):E.t="s";if(a)l[S]||(l[S]=[]),l[S][k]&&l[S][k].z&&(E.z=l[S][k].z),l[S][k]=E;else{var C=_t({c:k,r:S});l[C]&&l[C].z&&(E.z=l[C].z),l[C]=E}}}return g.s.c<1e7&&(l["!ref"]=It(g)),l}function Dl(e,r){return e1(null,e,r)}function tb(e){return e.read_shift(4,"i")}function an(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function rb(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function em(e,r){var t=e.l,n=e.read_shift(1),a=an(e),l=[],c={t:a,h:a};if((n&1)!==0){for(var f=e.read_shift(4),m=0;m!=f;++m)l.push(rb(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=t+r,c}var nb=em;function ua(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function go(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var ab=an;function tm(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var ib=an,p0=tm;function rm(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?Kd([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):no(r,0)>>2;return t?a/100:a}function t1(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var vo=t1;function rn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function sb(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),f=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var g=oo[a];g&&(r.rgb=Zc(g));break;case 2:r.rgb=Zc([c,f,m]);break;case 3:r.theme=a;break}return l!=0&&(r.tint=l>0?l/32767:l/32768),r}function ob(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function r1(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function lb(e){return r1(e,1)}function cb(e){return r1(e,2)}var nm=2,Nn=3,yd=11,$g=12,qd=19,_d=64,ub=65,db=71,fb=4108,hb=4126,Br=80,n1=81,mb=[Br,n1],pb={1:{n:"CodePage",t:nm},2:{n:"Category",t:Br},3:{n:"PresentationFormat",t:Br},4:{n:"ByteCount",t:Nn},5:{n:"LineCount",t:Nn},6:{n:"ParagraphCount",t:Nn},7:{n:"SlideCount",t:Nn},8:{n:"NoteCount",t:Nn},9:{n:"HiddenCount",t:Nn},10:{n:"MultimediaClipCount",t:Nn},11:{n:"ScaleCrop",t:yd},12:{n:"HeadingPairs",t:fb},13:{n:"TitlesOfParts",t:hb},14:{n:"Manager",t:Br},15:{n:"Company",t:Br},16:{n:"LinksUpToDate",t:yd},17:{n:"CharacterCount",t:Nn},19:{n:"SharedDoc",t:yd},22:{n:"HyperlinksChanged",t:yd},23:{n:"AppVersion",t:Nn,p:"version"},24:{n:"DigSig",t:ub},26:{n:"ContentType",t:Br},27:{n:"ContentStatus",t:Br},28:{n:"Language",t:Br},29:{n:"Version",t:Br},255:{},2147483648:{n:"Locale",t:qd},2147483651:{n:"Behavior",t:qd},1919054434:{}},gb={1:{n:"CodePage",t:nm},2:{n:"Title",t:Br},3:{n:"Subject",t:Br},4:{n:"Author",t:Br},5:{n:"Keywords",t:Br},6:{n:"Comments",t:Br},7:{n:"Template",t:Br},8:{n:"LastAuthor",t:Br},9:{n:"RevNumber",t:Br},10:{n:"EditTime",t:_d},11:{n:"LastPrinted",t:_d},12:{n:"CreatedDate",t:_d},13:{n:"ModifiedDate",t:_d},14:{n:"PageCount",t:Nn},15:{n:"WordCount",t:Nn},16:{n:"CharCount",t:Nn},17:{n:"Thumbnail",t:db},18:{n:"Application",t:Br},19:{n:"DocSecurity",t:Nn},255:{},2147483648:{n:"Locale",t:qd},2147483651:{n:"Behavior",t:qd},1919054434:{}},Wg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},vb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function xb(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var yb=xb([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),oo=Vr(yb),xo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},a1={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Vg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function _b(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function wb(e){var r=_b();if(!e||!e.match)return r;var t={};if((e.match(on)||[]).forEach(function(n){var a=gt(n);switch(a[0].replace(Pw,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[Vg[a.ContentType]]!==void 0&&r[Vg[a.ContentType]].push(a.PartName);break}}),r.xmlns!==zw.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var _l={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function g0(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Ic(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(on)||[]).forEach(function(a){var l=gt(a);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var f=l.TargetMode==="External"?l.Target:Tc(l.Target,r);t[f]=c,n[l.Id]=c}}),t["!id"]=n,t}var bb="application/vnd.oasis.opendocument.spreadsheet";function kb(e,r){for(var t=Y0(e),n,a;n=Hc.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=gt(n[0],!1),a.path=="/"&&a.type!==bb)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var Oc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Sb=(function(){for(var e=new Array(Oc.length),r=0;r<Oc.length;++r){var t=Oc[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function i1(e){var r={};e=Zt(e);for(var t=0;t<Oc.length;++t){var n=Oc[t],a=e.match(Sb[t]);a!=null&&a.length>0&&(r[n[1]]=jt(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=zr(r[n[1]]))}return r}var Tb=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function s1(e,r,t,n){var a=[];if(typeof e=="string")a=jg(e,n);else for(var l=0;l<e.length;++l)a=a.concat(e[l].map(function(x){return{v:x}}));var c=typeof r=="string"?jg(r,n).map(function(x){return x.v}):r,f=0,m=0;if(c.length>0)for(var g=0;g!==a.length;g+=2){switch(m=+a[g+1].v,a[g].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=m,t.SheetNames=c.slice(f,f+m);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=m,t.DefinedNames=c.slice(f,f+m);break;case"Charts":case"Diagramme":t.Chartsheets=m,t.ChartNames=c.slice(f,f+m);break}f+=m}}function Eb(e,r,t){var n={};return r||(r={}),e=Zt(e),Tb.forEach(function(a){var l=(e.match(Vc(a[0]))||[])[1];switch(a[2]){case"string":l&&(r[a[1]]=jt(l));break;case"bool":r[a[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(n[a[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&s1(n.HeadingPairs,n.TitlesOfParts,r,t),r}var Cb=/<[^>]+>[^<]*/g;function Ab(e,r){var t={},n="",a=e.match(Cb);if(a)for(var l=0;l!=a.length;++l){var c=a[l],f=gt(c);switch(f[0]){case"<?xml":break;case"<Properties":break;case"<property":n=jt(f.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var m=c.split(">"),g=m[0].slice(4),x=m[1];switch(g){case"lpstr":case"bstr":case"lpwstr":t[n]=jt(x);break;case"bool":t[n]=Jt(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(x,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(x);break;case"filetime":case"date":t[n]=zr(x);break;case"cy":case"error":t[n]=jt(x);break;default:if(g.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",c,g,m)}}else if(c.slice(0,2)!=="</"){if(r.WTF)throw new Error(c)}}}return t}var Pb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Vh;function Nb(e,r,t){Vh||(Vh=Z0(Pb)),r=Vh[r]||r,e[r]=t}function am(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function o1(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function l1(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function c1(e,r,t){return r===31?l1(e):o1(e,r,t)}function v0(e,r,t){return c1(e,r,t===!1?0:4)}function Db(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return c1(e,r,0)}function Ib(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(xn,""),e.l-a&2&&(e.l+=2)}return t}function Ob(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(xn,"");return t}function jb(e){var r=e.l,t=Yd(e,n1);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Yd(e,Nn);return[t,n]}function Fb(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(jb(e));return t}function Hg(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var l=e.read_shift(4),c=e.read_shift(4);n[l]=e.read_shift(c,r===1200?"utf16le":"utf8").replace(xn,"").replace(Sc,"!"),r===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function u1(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function Lb(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Yd(e,r,t){var n=e.read_shift(2),a,l=t||{};if(e.l+=2,r!==$g&&n!==r&&mb.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===$g?n:r){case 2:return a=e.read_shift(2,"i"),l.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return o1(e,n,4).replace(xn,"");case 31:return l1(e);case 64:return am(e);case 65:return u1(e);case 71:return Lb(e);case 80:return v0(e,n,!l.raw).replace(xn,"");case 81:return Db(e,n).replace(xn,"");case 4108:return Fb(e);case 4126:case 4127:return n==4127?Ib(e):Ob(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function Gg(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),l=[],c=0,f=0,m=-1,g={};for(c=0;c!=a;++c){var x=e.read_shift(4),y=e.read_shift(4);l[c]=[x,y+t]}l.sort(function(j,N){return j[1]-N[1]});var b={};for(c=0;c!=a;++c){if(e.l!==l[c][1]){var E=!0;if(c>0&&r)switch(r[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,E=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],E=!1);break}if((!r||c==0)&&e.l<=l[c][1]&&(E=!1,e.l=l[c][1]),E)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(r){var S=r[l[c][0]];if(b[S.n]=Yd(e,S.t,{raw:!0}),S.p==="version"&&(b[S.n]=String(b[S.n]>>16)+"."+("0000"+String(b[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(b[S.n]){case 0:b[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ia(f=b[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+b[S.n])}}else if(l[c][0]===1){if(f=b.CodePage=Yd(e,nm),Ia(f),m!==-1){var k=e.l;e.l=l[m][1],g=Hg(e,f),e.l=k}}else if(l[c][0]===0){if(f===0){m=c,e.l=l[c+1][1];continue}g=Hg(e,f)}else{var C=g[l[c][0]],R;switch(e[e.l]){case 65:e.l+=4,R=u1(e);break;case 30:e.l+=4,R=v0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,R=v0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,R=e.read_shift(4,"i");break;case 19:e.l+=4,R=e.read_shift(4);break;case 5:e.l+=4,R=e.read_shift(8,"f");break;case 11:e.l+=4,R=pr(e,4);break;case 64:e.l+=4,R=zr(am(e));break;default:throw new Error("unparsed value: "+e[e.l])}b[C]=R}}return e.l=t+n,b}function Zg(e,r,t){var n=e.content;if(!n)return{};Wr(n,0);var a,l,c,f,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var g=n.read_shift(4),x=n.read_shift(16);if(x!==Dt.utils.consts.HEADER_CLSID&&x!==t)throw new Error("Bad PropertySet CLSID "+x);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(l=n.read_shift(16),f=n.read_shift(4),a===1&&f!==n.l)throw new Error("Length mismatch: "+f+" !== "+n.l);a===2&&(c=n.read_shift(16),m=n.read_shift(4));var y=Gg(n,r),b={SystemIdentifier:g};for(var E in y)b[E]=y[E];if(b.FMTID=l,a===1)return b;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var S;try{S=Gg(n,null)}catch{}for(E in S)b[E]=S[E];return b.FMTID=[l,c],b}function ds(e,r){return e.read_shift(r),null}function Rb(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function pr(e,r){return e.read_shift(r)===1}function _r(e){return e.read_shift(2,"u")}function d1(e,r){return Rb(e,r,_r)}function Mb(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function ru(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=e.read_shift(1);l&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var c=n?e.read_shift(n,a):"";return c}function Bb(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,l=1+(t&1),c=0,f,m={};a&&(c=e.read_shift(2)),n&&(f=e.read_shift(4));var g=l==2?"dbcs-cont":"sbcs-cont",x=r===0?"":e.read_shift(r,g);return a&&(e.l+=4*c),n&&(e.l+=f),m.t=x,a||(m.raw="<t>"+m.t+"</t>",m.r=m.t),m}function ho(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function nu(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):ho(e,n,t)}function yo(e,r,t){if(t.biff>5)return nu(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zb(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function Ub(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(xn,"");return n&&(e.l+=24),a}function $b(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(xn,"");return t+c}function Wb(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Ub(e);case"0303000000000000c000000000000046":return $b(e);default:throw new Error("Unsupported Moniker "+t)}}function wd(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(xn,""):"";return t}function Vb(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var l,c,f,m,g="",x,y;a&16&&(l=wd(e,t-e.l)),a&128&&(c=wd(e,t-e.l)),(a&257)===257&&(f=wd(e,t-e.l)),(a&257)===1&&(m=Wb(e,t-e.l)),a&8&&(g=wd(e,t-e.l)),a&32&&(x=e.read_shift(16)),a&64&&(y=am(e)),e.l=t;var b=c||f||m||"";b&&g&&(b+="#"+g),b||(b="#"+g),a&2&&b.charAt(0)=="/"&&b.charAt(1)!="/"&&(b="file://"+b);var E={Target:b};return x&&(E.guid=x),y&&(E.time=y),l&&(E.Tooltip=l),E}function f1(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function h1(e,r){var t=f1(e);return t[3]=0,t}function ti(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function Hb(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Gb(e,r,t){return r===0?"":yo(e,r,t)}function Zb(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),l=e.read_shift(n,"i"),c=e.read_shift(n,"i");return[a,l,c]}function m1(e){var r=e.read_shift(2),t=rm(e);return[r,t]}function Kb(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=ru(e,r,t),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,a}function lf(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function p1(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var qb=p1;function g1(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function Yb(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Xb(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function en(e){e.l+=2,e.l+=e.read_shift(2)}var Jb={0:en,4:en,5:en,6:en,7:Xb,8:en,9:en,10:en,11:en,12:en,13:Yb,14:en,15:en,16:en,17:en,18:en,19:en,20:en,21:g1};function Qb(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(Jb[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function bd(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function ek(e,r){return r===0||e.read_shift(2),1200}function tk(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=yo(e,0,t);return e.read_shift(r+n-e.l),a}function rk(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function nk(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=ru(e,0,t);return c.length===0&&(c="Sheet1"),{pos:n,hs:a,dt:l,name:c}}function ak(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),l=[],c=0;c!=a&&e.l<t;++c)l.push(Bb(e));return l.Count=n,l.Unique=a,l}function ik(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function sk(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function ok(e){var r=Hb(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function lk(e){return e.read_shift(2),e.read_shift(4)}function Kg(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,a]}function ck(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),m=e.read_shift(2),g=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:l,CurTab:c,FirstTab:f,Selected:m,TabRatio:g}}function uk(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function dk(){}function fk(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ru(e,0,t),n}function hk(e){var r=ti(e);return r.isst=e.read_shift(4),r}function mk(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=ti(e);t.biff==2&&e.l++;var l=nu(e,n-e.l,t);return a.val=l,a}function pk(e,r,t){var n=e.read_shift(2),a=yo(e,0,t);return[n,a]}var gk=yo;function qg(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,l=e.read_shift(a),c=e.read_shift(a),f=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:l,c:f},e:{r:c,c:m}}}function vk(e){var r=e.read_shift(2),t=e.read_shift(2),n=m1(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function xk(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),l=[];e.l<t;)l.push(m1(e));if(e.l!==t)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:c,rkrec:l}}function yk(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),l=[];e.l<t;)l.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:c,ixfe:l}}function _k(e,r,t,n){var a={},l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(4),m=e.read_shift(2);return a.patternType=vb[f>>26],n.cellStyles&&(a.alc=l&7,a.fWrap=l>>3&1,a.alcV=l>>4&7,a.fJustLast=l>>7&1,a.trot=l>>8&255,a.cIndent=l>>16&15,a.fShrinkToFit=l>>20&1,a.iReadOrder=l>>22&2,a.fAtrNum=l>>26&1,a.fAtrFnt=l>>27&1,a.fAtrAlc=l>>28&1,a.fAtrBdr=l>>29&1,a.fAtrPat=l>>30&1,a.fAtrProt=l>>31&1,a.dgLeft=c&15,a.dgRight=c>>4&15,a.dgTop=c>>8&15,a.dgBottom=c>>12&15,a.icvLeft=c>>16&127,a.icvRight=c>>23&127,a.grbitDiag=c>>30&3,a.icvTop=f&127,a.icvBottom=f>>7&127,a.icvDiag=f>>14&127,a.dgDiag=f>>21&15,a.icvFore=m&127,a.icvBack=m>>7&127,a.fsxButton=m>>14&1),a}function wk(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=_k(e,r,n.fStyle,t),n}function bk(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Yg(e,r,t){var n=ti(e);(t.biff==2||r==9)&&++e.l;var a=Mb(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function kk(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=ti(e),a=rn(e);return n.val=a,n}var Xg=Gb;function Sk(e,r,t){var n=e.l+r,a=e.read_shift(2),l=e.read_shift(2);if(t.sbcch=l,l==1025||l==14849)return[l,a];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=ho(e,l),f=[];n>e.l;)f.push(nu(e));return[l,a,c,f]}function Jg(e,r,t){var n=e.read_shift(2),a,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=Kb(e,r-2,t)),l.body=a||e.read_shift(r-2),typeof a=="string"&&(l.Name=a),l}var Tk=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Qg(e,r,t){var n=e.l+r,a=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(t&&t.biff==2?1:2),m=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),m=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var g=ho(e,c,t);a&32&&(g=Tk[g.charCodeAt(0)]);var x=n-e.l;t&&t.biff==2&&--x;var y=n==e.l||f===0||!(x>0)?[]:sE(e,x,t,f);return{chKey:l,Name:g,itab:m,rgce:y}}function v1(e,r,t){if(t.biff<8)return Ek(e,r,t);for(var n=[],a=e.l+r,l=e.read_shift(t.biff>8?4:2);l--!==0;)n.push(Zb(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Ek(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=ru(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function Ck(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),l=ho(e,n,t),c=ho(e,a,t);return[l,c]}function Ak(e,r,t){var n=p1(e);e.l++;var a=e.read_shift(1);return r-=8,[oE(e,r,t),a,n]}function ev(e,r,t){var n=qb(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,aE(e,r,t)]}function Pk(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function Nk(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=yo(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},f,c,l]}}function Dk(e,r,t){return Nk(e,r,t)}function Ik(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(lf(e));return t}function Ok(e,r,t){if(t&&t.biff<8)return Fk(e,r,t);var n=g1(e),a=Qb(e,r-22,n[1]);return{cmo:n,ft:a}}var jk={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function Fk(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var c=[];return c.push((jk[n]||sn)(e,r,t)),{cmo:[a,n,l],ft:c}}function Lk(e,r,t){var n=e.l,a="";try{e.l+=4;var l=(t.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=zb(e,6,t);var f=e.read_shift(2);e.read_shift(2),_r(e,2);var m=e.read_shift(2);e.l+=m;for(var g=1;g<e.lens.length-1;++g){if(e.l-n!=e.lens[g])throw new Error("TxO: bad continue record");var x=e[e.l],y=ho(e,e.lens[g+1]-e.lens[g]-1);if(a+=y,a.length>=(x?f:2*f))break}if(a.length!==f&&a.length!==f*2)throw new Error("cchText: "+f+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function Rk(e,r){var t=lf(e);e.l+=16;var n=Vb(e,r-24);return[t,n]}function Mk(e,r){e.read_shift(2);var t=lf(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(xn,""),[t,n]}function Bk(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Wg[t]||t,t=e.read_shift(2),r[1]=Wg[t]||t,r}function zk(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(h1(e));return t}function Uk(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(h1(e));return t}function $k(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function x1(e,r,t){if(!t.cellStyles)return sn(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var g={s:a,e:l,w:c,ixfe:f,flags:m};return(t.biff>=5||!t.biff)&&(g.level=m>>8&7),g}function Wk(e,r){var t={};return r<32||(e.l+=16,t.header=rn(e),t.footer=rn(e),e.l+=2),t}function Vk(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var Hk=ti,Gk=d1,Zk=nu;function Kk(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function qk(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=ti(e);++e.l;var a=yo(e,r-7,t);return n.t="str",n.val=a,n}function Yk(e){var r=ti(e);++e.l;var t=rn(e);return r.t="n",r.val=t,r}function Xk(e){var r=ti(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function Jk(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function Qk(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function eS(e,r,t){var n=e.l+r,a=ti(e),l=e.read_shift(2),c=ho(e,l,t);return e.l=n,a.t="str",a.val=c,a}var tS=[2,3,48,49,131,139,140,245],tv=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Z0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(f,m){var g=[],x=Ss(1);switch(m.type){case"base64":x=Da(Gn(f));break;case"binary":x=Da(f);break;case"buffer":case"array":x=f;break}Wr(x,0);var y=x.read_shift(1),b=!!(y&136),E=!1,S=!1;switch(y){case 2:break;case 3:break;case 48:E=!0,b=!0;break;case 49:E=!0,b=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var k=0,C=521;y==2&&(k=x.read_shift(2)),x.l+=3,y!=2&&(k=x.read_shift(4)),k>1048576&&(k=1e6),y!=2&&(C=x.read_shift(2));var R=x.read_shift(2),j=m.codepage||1252;y!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(j=e[x[x.l]]),x.l+=1,x.l+=2),S&&(x.l+=36);for(var N=[],F={},K=Math.min(x.length,y==2?521:C-10-(E?264:0)),z=S?32:11;x.l<K&&x[x.l]!=13;)switch(F={},F.name=$c.utils.decode(j,x.slice(x.l,x.l+z)).replace(/[\u0000\r\n].*$/g,""),x.l+=z,F.type=String.fromCharCode(x.read_shift(1)),y!=2&&!S&&(F.offset=x.read_shift(4)),F.len=x.read_shift(1),y==2&&(F.offset=x.read_shift(2)),F.dec=x.read_shift(1),F.name.length&&N.push(F),y!=2&&(x.l+=S?13:14),F.type){case"B":(!E||F.len!=8)&&m.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+F.name+":"+F.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+F.type)}if(x[x.l]!==13&&(x.l=C-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=C;var O=0,ne=0;for(g[0]=[],ne=0;ne!=N.length;++ne)g[0][ne]=N[ne].name;for(;k-- >0;){if(x[x.l]===42){x.l+=R;continue}for(++x.l,g[++O]=[],ne=0,ne=0;ne!=N.length;++ne){var ee=x.slice(x.l,x.l+N[ne].len);x.l+=N[ne].len,Wr(ee,0);var ve=$c.utils.decode(j,ee);switch(N[ne].type){case"C":ve.trim().length&&(g[O][ne]=ve.replace(/\s+$/,""));break;case"D":ve.length===8?g[O][ne]=new Date(+ve.slice(0,4),+ve.slice(4,6)-1,+ve.slice(6,8)):g[O][ne]=ve;break;case"F":g[O][ne]=parseFloat(ve.trim());break;case"+":case"I":g[O][ne]=S?ee.read_shift(-4,"i")^2147483648:ee.read_shift(4,"i");break;case"L":switch(ve.trim().toUpperCase()){case"Y":case"T":g[O][ne]=!0;break;case"N":case"F":g[O][ne]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ve+"|")}break;case"M":if(!b)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));g[O][ne]="##MEMO##"+(S?parseInt(ve.trim(),10):ee.read_shift(4));break;case"N":ve=ve.replace(/\u0000/g,"").trim(),ve&&ve!="."&&(g[O][ne]=+ve||0);break;case"@":g[O][ne]=new Date(ee.read_shift(-8,"f")-621356832e5);break;case"T":g[O][ne]=new Date((ee.read_shift(4)-2440588)*864e5+ee.read_shift(4));break;case"Y":g[O][ne]=ee.read_shift(4,"i")/1e4+ee.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[O][ne]=-ee.read_shift(-8,"f");break;case"B":if(E&&N[ne].len==8){g[O][ne]=ee.read_shift(8,"f");break}case"G":case"P":ee.l+=N[ne].len;break;case"0":if(N[ne].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[ne].type)}}}if(y!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),m.DBF=N,g}function n(f,m){var g=m||{};g.dateNF||(g.dateNF="yyyymmdd");var x=Dl(t(f,g),g);return x["!cols"]=g.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete g.DBF,x}function a(f,m){try{return Es(n(f,m),m)}catch(g){if(m&&m.WTF)throw g}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(f,m){var g=m||{};if(+g.codepage>=0&&Ia(+g.codepage),g.type=="string")throw new Error("Cannot write DBF to JS string");var x=m0(),y=S0(f,{header:1,raw:!0,cellDates:!0}),b=y[0],E=y.slice(1),S=f["!cols"]||[],k=0,C=0,R=0,j=1;for(k=0;k<b.length;++k){if(((S[k]||{}).DBF||{}).name){b[k]=S[k].DBF.name,++R;continue}if(b[k]!=null){if(++R,typeof b[k]=="number"&&(b[k]=b[k].toString(10)),typeof b[k]!="string")throw new Error("DBF Invalid column name "+b[k]+" |"+typeof b[k]+"|");if(b.indexOf(b[k])!==k){for(C=0;C<1024;++C)if(b.indexOf(b[k]+"_"+C)==-1){b[k]+="_"+C;break}}}}var N=ur(f["!ref"]),F=[],K=[],z=[];for(k=0;k<=N.e.c-N.s.c;++k){var O="",ne="",ee=0,ve=[];for(C=0;C<E.length;++C)E[C][k]!=null&&ve.push(E[C][k]);if(ve.length==0||b[k]==null){F[k]="?";continue}for(C=0;C<ve.length;++C){switch(typeof ve[C]){case"number":ne="B";break;case"string":ne="C";break;case"boolean":ne="L";break;case"object":ne=ve[C]instanceof Date?"D":"C";break;default:ne="C"}ee=Math.max(ee,String(ve[C]).length),O=O&&O!=ne?"C":ne}ee>250&&(ee=250),ne=((S[k]||{}).DBF||{}).type,ne=="C"&&S[k].DBF.len>ee&&(ee=S[k].DBF.len),O=="B"&&ne=="N"&&(O="N",z[k]=S[k].DBF.dec,ee=S[k].DBF.len),K[k]=O=="C"||ne=="N"?ee:l[O]||0,j+=K[k],F[k]=O}var he=x.next(32);for(he.write_shift(4,318902576),he.write_shift(4,E.length),he.write_shift(2,296+32*R),he.write_shift(2,j),k=0;k<4;++k)he.write_shift(4,0);for(he.write_shift(4,0|(+r[vx]||3)<<8),k=0,C=0;k<b.length;++k)if(b[k]!=null){var ce=x.next(32),Ne=(b[k].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ce.write_shift(1,Ne,"sbcs"),ce.write_shift(1,F[k]=="?"?"C":F[k],"sbcs"),ce.write_shift(4,C),ce.write_shift(1,K[k]||l[F[k]]||0),ce.write_shift(1,z[k]||0),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(1,0),ce.write_shift(4,0),ce.write_shift(4,0),C+=K[k]||l[F[k]]||0}var xe=x.next(264);for(xe.write_shift(4,13),k=0;k<65;++k)xe.write_shift(4,0);for(k=0;k<E.length;++k){var le=x.next(j);for(le.write_shift(1,0),C=0;C<b.length;++C)if(b[C]!=null)switch(F[C]){case"L":le.write_shift(1,E[k][C]==null?63:E[k][C]?84:70);break;case"B":le.write_shift(8,E[k][C]||0,"f");break;case"N":var Q="0";for(typeof E[k][C]=="number"&&(Q=E[k][C].toFixed(z[C]||0)),R=0;R<K[C]-Q.length;++R)le.write_shift(1,32);le.write_shift(1,Q,"sbcs");break;case"D":E[k][C]?(le.write_shift(4,("0000"+E[k][C].getFullYear()).slice(-4),"sbcs"),le.write_shift(2,("00"+(E[k][C].getMonth()+1)).slice(-2),"sbcs"),le.write_shift(2,("00"+E[k][C].getDate()).slice(-2),"sbcs")):le.write_shift(8,"00000000","sbcs");break;case"C":var M=String(E[k][C]!=null?E[k][C]:"").slice(0,K[C]);for(le.write_shift(1,M,"sbcs"),R=0;R<K[C]-M.length;++R)le.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:a,to_sheet:n,from_sheet:c}})(),rS=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Xa(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(b,E){var S=e[E];return typeof S=="number"?vg(S):S},n=function(b,E,S){var k=E.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return k==59?b:vg(k)};e["|"]=254;function a(b,E){switch(E.type){case"base64":return l(Gn(b),E);case"binary":return l(b,E);case"buffer":return l(Nt&&Buffer.isBuffer(b)?b.toString("binary"):po(b),E);case"array":return l(fo(b),E)}throw new Error("Unrecognized type "+E.type)}function l(b,E){var S=b.split(/[\n\r]+/),k=-1,C=-1,R=0,j=0,N=[],F=[],K=null,z={},O=[],ne=[],ee=[],ve=0,he;for(+E.codepage>=0&&Ia(+E.codepage);R!==S.length;++R){ve=0;var ce=S[R].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),Ne=ce.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),xe=Ne[0],le;if(ce.length>0)switch(xe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ne[1].charAt(0)=="P"&&F.push(ce.slice(3).replace(/;;/g,";"));break;case"C":var Q=!1,M=!1,V=!1,H=!1,se=-1,D=-1;for(j=1;j<Ne.length;++j)switch(Ne[j].charAt(0)){case"A":break;case"X":C=parseInt(Ne[j].slice(1))-1,M=!0;break;case"Y":for(k=parseInt(Ne[j].slice(1))-1,M||(C=0),he=N.length;he<=k;++he)N[he]=[];break;case"K":le=Ne[j].slice(1),le.charAt(0)==='"'?le=le.slice(1,le.length-1):le==="TRUE"?le=!0:le==="FALSE"?le=!1:isNaN(ja(le))?isNaN(Tl(le).getDate())||(le=zr(le)):(le=ja(le),K!==null&&Pl(K)&&(le=of(le))),Q=!0;break;case"E":H=!0;var P=bl(Ne[j].slice(1),{r:k,c:C});N[k][C]=[N[k][C],P];break;case"S":V=!0,N[k][C]=[N[k][C],"S5S"];break;case"G":break;case"R":se=parseInt(Ne[j].slice(1))-1;break;case"C":D=parseInt(Ne[j].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ce)}if(Q&&(N[k][C]&&N[k][C].length==2?N[k][C][0]=le:N[k][C]=le,K=null),V){if(H)throw new Error("SYLK shared formula cannot have own formula");var I=se>-1&&N[se][D];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");N[k][C][1]=A1(I[1],{r:k-se,c:C-D})}break;case"F":var B=0;for(j=1;j<Ne.length;++j)switch(Ne[j].charAt(0)){case"X":C=parseInt(Ne[j].slice(1))-1,++B;break;case"Y":for(k=parseInt(Ne[j].slice(1))-1,he=N.length;he<=k;++he)N[he]=[];break;case"M":ve=parseInt(Ne[j].slice(1))/20;break;case"F":break;case"G":break;case"P":K=F[parseInt(Ne[j].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(ee=Ne[j].slice(1).split(" "),he=parseInt(ee[0],10);he<=parseInt(ee[1],10);++he)ve=parseInt(ee[2],10),ne[he-1]=ve===0?{hidden:!0}:{wch:ve},El(ne[he-1]);break;case"C":C=parseInt(Ne[j].slice(1))-1,ne[C]||(ne[C]={});break;case"R":k=parseInt(Ne[j].slice(1))-1,O[k]||(O[k]={}),ve>0?(O[k].hpt=ve,O[k].hpx=Kc(ve)):ve===0&&(O[k].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ce)}B<1&&(K=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+ce)}}return O.length>0&&(z["!rows"]=O),ne.length>0&&(z["!cols"]=ne),E&&E.sheetRows&&(N=N.slice(0,E.sheetRows)),[N,z]}function c(b,E){var S=a(b,E),k=S[0],C=S[1],R=Dl(k,E);return Xa(C).forEach(function(j){R[j]=C[j]}),R}function f(b,E){return Es(c(b,E),E)}function m(b,E,S,k){var C="C;Y"+(S+1)+";X"+(k+1)+";K";switch(b.t){case"n":C+=b.v||0,b.f&&!b.F&&(C+=";E"+$2(b.f,{r:S,c:k}));break;case"b":C+=b.v?"TRUE":"FALSE";break;case"e":C+=b.w||b.v;break;case"d":C+='"'+(b.w||b.v)+'"';break;case"s":C+='"'+b.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function g(b,E){E.forEach(function(S,k){var C="F;W"+(k+1)+" "+(k+1)+" ";S.hidden?C+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=Jd(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=Qd(S.wpx)),typeof S.wch=="number"&&(C+=Math.round(S.wch))),C.charAt(C.length-1)!=" "&&b.push(C)})}function x(b,E){E.forEach(function(S,k){var C="F;";S.hidden?C+="M0;":S.hpt?C+="M"+20*S.hpt+";":S.hpx&&(C+="M"+20*T1(S.hpx)+";"),C.length>2&&b.push(C+"R"+(k+1))})}function y(b,E){var S=["ID;PWXL;N;E"],k=[],C=ur(b["!ref"]),R,j=Array.isArray(b),N=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),b["!cols"]&&g(S,b["!cols"]),b["!rows"]&&x(S,b["!rows"]),S.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var F=C.s.r;F<=C.e.r;++F)for(var K=C.s.c;K<=C.e.c;++K){var z=_t({r:F,c:K});R=j?(b[F]||[])[K]:b[z],!(!R||R.v==null&&(!R.f||R.F))&&k.push(m(R,b,F,K))}return S.join(N)+N+k.join(N)+N+"E"+N}return{to_workbook:f,to_sheet:c,from_sheet:y}})(),nS=(function(){function e(l,c){switch(c.type){case"base64":return r(Gn(l),c);case"binary":return r(l,c);case"buffer":return r(Nt&&Buffer.isBuffer(l)?l.toString("binary"):po(l),c);case"array":return r(fo(l),c)}throw new Error("Unrecognized type "+c.type)}function r(l,c){for(var f=l.split(`
`),m=-1,g=-1,x=0,y=[];x!==f.length;++x){if(f[x].trim()==="BOT"){y[++m]=[],g=0;continue}if(!(m<0)){var b=f[x].trim().split(","),E=b[0],S=b[1];++x;for(var k=f[x]||"";(k.match(/["]/g)||[]).length&1&&x<f.length-1;)k+=`
`+f[++x];switch(k=k.trim(),+E){case-1:if(k==="BOT"){y[++m]=[],g=0;continue}else if(k!=="EOD")throw new Error("Unrecognized DIF special command "+k);break;case 0:k==="TRUE"?y[m][g]=!0:k==="FALSE"?y[m][g]=!1:isNaN(ja(S))?isNaN(Tl(S).getDate())?y[m][g]=S:y[m][g]=zr(S):y[m][g]=ja(S),++g;break;case 1:k=k.slice(1,k.length-1),k=k.replace(/""/g,'"'),k&&k.match(/^=".*"$/)&&(k=k.slice(2,-1)),y[m][g++]=k!==""?k:null;break}if(k==="EOD")break}}return c&&c.sheetRows&&(y=y.slice(0,c.sheetRows)),y}function t(l,c){return Dl(e(l,c),c)}function n(l,c){return Es(t(l,c),c)}var a=(function(){var l=function(m,g,x,y,b){m.push(g),m.push(x+","+y),m.push('"'+b.replace(/"/g,'""')+'"')},c=function(m,g,x,y){m.push(g+","+x),m.push(g==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(m){var g=[],x=ur(m["!ref"]),y,b=Array.isArray(m);l(g,"TABLE",0,1,"sheetjs"),l(g,"VECTORS",0,x.e.r-x.s.r+1,""),l(g,"TUPLES",0,x.e.c-x.s.c+1,""),l(g,"DATA",0,0,"");for(var E=x.s.r;E<=x.e.r;++E){c(g,-1,0,"BOT");for(var S=x.s.c;S<=x.e.c;++S){var k=_t({r:E,c:S});if(y=b?(m[E]||[])[S]:m[k],!y){c(g,1,0,"");continue}switch(y.t){case"n":var C=y.w;!C&&y.v!=null&&(C=y.v),C==null?y.f&&!y.F?c(g,1,0,"="+y.f):c(g,1,0,""):c(g,0,C,"V");break;case"b":c(g,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":c(g,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=ca(y.z||kt[14],yn(zr(y.v)))),c(g,0,y.w,"V");break;default:c(g,1,0,"")}}}c(g,-1,0,"EOD");var R=`\r
`,j=g.join(R);return j}})();return{to_workbook:n,to_sheet:t,from_sheet:a}})(),aS=(function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(y,b){for(var E=y.split(`
`),S=-1,k=-1,C=0,R=[];C!==E.length;++C){var j=E[C].trim().split(":");if(j[0]==="cell"){var N=vn(j[1]);if(R.length<=N.r)for(S=R.length;S<=N.r;++S)R[S]||(R[S]=[]);switch(S=N.r,k=N.c,j[2]){case"t":R[S][k]=e(j[3]);break;case"v":R[S][k]=+j[3];break;case"vtf":var F=j[j.length-1];case"vtc":switch(j[3]){case"nl":R[S][k]=!!+j[4];break;default:R[S][k]=+j[4];break}j[2]=="vtf"&&(R[S][k]=[R[S][k],F])}}}return b&&b.sheetRows&&(R=R.slice(0,b.sheetRows)),R}function n(y,b){return Dl(t(y,b),b)}function a(y,b){return Es(n(y,b),b)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function g(y){if(!y||!y["!ref"])return"";for(var b=[],E=[],S,k="",C=Nl(y["!ref"]),R=Array.isArray(y),j=C.s.r;j<=C.e.r;++j)for(var N=C.s.c;N<=C.e.c;++N)if(k=_t({r:j,c:N}),S=R?(y[j]||[])[N]:y[k],!(!S||S.v==null||S.t==="z")){switch(E=["cell",k,"t"],S.t){case"s":case"str":E.push(r(S.v));break;case"n":S.f?(E[2]="vtf",E[3]="n",E[4]=S.v,E[5]=r(S.f)):(E[2]="v",E[3]=S.v);break;case"b":E[2]="vt"+(S.f?"f":"c"),E[3]="nl",E[4]=S.v?"1":"0",E[5]=r(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var F=yn(zr(S.v));E[2]="vtc",E[3]="nd",E[4]=""+F,E[5]=S.w||ca(S.z||kt[14],F);break;case"e":continue}b.push(E.join(":"))}return b.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),b.push("valueformat:1:text-wiki"),b.join(`
`)}function x(y){return[l,c,f,c,g(y),m].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:x}})(),Gc=(function(){function e(x,y,b,E,S){S.raw?y[b][E]=x:x===""||(x==="TRUE"?y[b][E]=!0:x==="FALSE"?y[b][E]=!1:isNaN(ja(x))?isNaN(Tl(x).getDate())?y[b][E]=x:y[b][E]=zr(x):y[b][E]=ja(x))}function r(x,y){var b=y||{},E=[];if(!x||x.length===0)return E;for(var S=x.split(/[\r\n]/),k=S.length-1;k>=0&&S[k].length===0;)--k;for(var C=10,R=0,j=0;j<=k;++j)R=S[j].indexOf(" "),R==-1?R=S[j].length:R++,C=Math.max(C,R);for(j=0;j<=k;++j){E[j]=[];var N=0;for(e(S[j].slice(0,C).trim(),E,j,N,b),N=1;N<=(S[j].length-C)/10+1;++N)e(S[j].slice(C+(N-1)*10,C+N*10).trim(),E,j,N,b)}return b.sheetRows&&(E=E.slice(0,b.sheetRows)),E}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(x){for(var y={},b=!1,E=0,S=0;E<x.length;++E)(S=x.charCodeAt(E))==34?b=!b:!b&&S in t&&(y[S]=(y[S]||0)+1);S=[];for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&S.push([y[E],E]);if(!S.length){y=n;for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&S.push([y[E],E])}return S.sort(function(k,C){return k[0]-C[0]||n[k[1]]-n[C[1]]}),t[S.pop()[1]]||44}function l(x,y){var b=y||{},E="",S=b.dense?[]:{},k={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(E=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(E=x.charAt(4),x=x.slice(6)):E=a(x.slice(0,1024)):b&&b.FS?E=b.FS:E=a(x.slice(0,1024));var C=0,R=0,j=0,N=0,F=0,K=E.charCodeAt(0),z=!1,O=0,ne=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var ee=b.dateNF!=null?pw(b.dateNF):null;function ve(){var he=x.slice(N,F),ce={};if(he.charAt(0)=='"'&&he.charAt(he.length-1)=='"'&&(he=he.slice(1,-1).replace(/""/g,'"')),he.length===0)ce.t="z";else if(b.raw)ce.t="s",ce.v=he;else if(he.trim().length===0)ce.t="s",ce.v=he;else if(he.charCodeAt(0)==61)he.charCodeAt(1)==34&&he.charCodeAt(he.length-1)==34?(ce.t="s",ce.v=he.slice(2,-1).replace(/""/g,'"')):V2(he)?(ce.t="n",ce.f=he.slice(1)):(ce.t="s",ce.v=he);else if(he=="TRUE")ce.t="b",ce.v=!0;else if(he=="FALSE")ce.t="b",ce.v=!1;else if(!isNaN(j=ja(he)))ce.t="n",b.cellText!==!1&&(ce.w=he),ce.v=j;else if(!isNaN(Tl(he).getDate())||ee&&he.match(ee)){ce.z=b.dateNF||kt[14];var Ne=0;ee&&he.match(ee)&&(he=gw(he,b.dateNF,he.match(ee)||[]),Ne=1),b.cellDates?(ce.t="d",ce.v=zr(he,Ne)):(ce.t="n",ce.v=yn(zr(he,Ne))),b.cellText!==!1&&(ce.w=ca(ce.z,ce.v instanceof Date?yn(ce.v):ce.v)),b.cellNF||delete ce.z}else ce.t="s",ce.v=he;if(ce.t=="z"||(b.dense?(S[C]||(S[C]=[]),S[C][R]=ce):S[_t({c:R,r:C})]=ce),N=F+1,ne=x.charCodeAt(N),k.e.c<R&&(k.e.c=R),k.e.r<C&&(k.e.r=C),O==K)++R;else if(R=0,++C,b.sheetRows&&b.sheetRows<=C)return!0}e:for(;F<x.length;++F)switch(O=x.charCodeAt(F)){case 34:ne===34&&(z=!z);break;case K:case 10:case 13:if(!z&&ve())break e;break}return F-N>0&&ve(),S["!ref"]=It(k),S}function c(x,y){return!(y&&y.PRN)||y.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?l(x,y):Dl(r(x,y),y)}function f(x,y){var b="",E=y.type=="string"?[0,0,0,0]:fm(x,y);switch(y.type){case"base64":b=Gn(x);break;case"binary":b=x;break;case"buffer":y.codepage==65001?b=x.toString("utf8"):y.codepage&&typeof $c<"u"||(b=Nt&&Buffer.isBuffer(x)?x.toString("binary"):po(x));break;case"array":b=fo(x);break;case"string":b=x;break;default:throw new Error("Unrecognized type "+y.type)}return E[0]==239&&E[1]==187&&E[2]==191?b=Zt(b.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?b=Zt(b):y.type=="binary"&&typeof $c<"u",b.slice(0,19)=="socialcalc:version:"?aS.to_sheet(y.type=="string"?b:Zt(b),y):c(b,y)}function m(x,y){return Es(f(x,y),y)}function g(x){for(var y=[],b=ur(x["!ref"]),E,S=Array.isArray(x),k=b.s.r;k<=b.e.r;++k){for(var C=[],R=b.s.c;R<=b.e.c;++R){var j=_t({r:k,c:R});if(E=S?(x[k]||[])[R]:x[j],!E||E.v==null){C.push("          ");continue}for(var N=(E.w||(Pi(E),E.w)||"").slice(0,10);N.length<10;)N+=" ";C.push(N+(R===0?" ":""))}y.push(C.join(""))}return y.join(`
`)}return{to_workbook:m,to_sheet:f,from_sheet:g}})();function iS(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=rS.to_workbook(e,t);return t.WTF=n,a}catch(l){if(t.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return Gc.to_workbook(e,r)}}var jc=(function(){function e(P,I,B){if(P){Wr(P,P.l||0);for(var G=B.Enum||se;P.l<P.length;){var te=P.read_shift(2),de=G[te]||G[65535],pe=P.read_shift(2),me=P.l+pe,ye=de.f&&de.f(P,pe,B);if(P.l=me,I(ye,de,te))return}}}function r(P,I){switch(I.type){case"base64":return t(Da(Gn(P)),I);case"binary":return t(Da(P),I);case"buffer":case"array":return t(P,I)}throw"Unsupported type "+I.type}function t(P,I){if(!P)return P;var B=I||{},G=B.dense?[]:{},te="Sheet1",de="",pe=0,me={},ye=[],Ke=[],ae={s:{r:0,c:0},e:{r:0,c:0}},at=B.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)B.Enum=se,e(P,function(Le,At,dr){switch(dr){case 0:B.vers=Le,Le>=4096&&(B.qpro=!0);break;case 6:ae=Le;break;case 204:Le&&(de=Le);break;case 222:de=Le;break;case 15:case 51:B.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:dr==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=B.dateNF||kt[14],B.cellDates&&(Le[1].t="d",Le[1].v=of(Le[1].v))),B.qpro&&Le[3]>pe&&(G["!ref"]=It(ae),me[te]=G,ye.push(te),G=B.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},pe=Le[3],te=de||"Sheet"+(pe+1),de="");var Yt=B.dense?(G[Le[0].r]||[])[Le[0].c]:G[_t(Le[0])];if(Yt){Yt.t=Le[1].t,Yt.v=Le[1].v,Le[1].z!=null&&(Yt.z=Le[1].z),Le[1].f!=null&&(Yt.f=Le[1].f);break}B.dense?(G[Le[0].r]||(G[Le[0].r]=[]),G[Le[0].r][Le[0].c]=Le[1]):G[_t(Le[0])]=Le[1];break}},B);else if(P[2]==26||P[2]==14)B.Enum=D,P[2]==14&&(B.qpro=!0,P.l=0),e(P,function(Le,At,dr){switch(dr){case 204:te=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>pe&&(G["!ref"]=It(ae),me[te]=G,ye.push(te),G=B.dense?[]:{},ae={s:{r:0,c:0},e:{r:0,c:0}},pe=Le[3],te="Sheet"+(pe+1)),at>0&&Le[0].r>=at)break;B.dense?(G[Le[0].r]||(G[Le[0].r]=[]),G[Le[0].r][Le[0].c]=Le[1]):G[_t(Le[0])]=Le[1],ae.e.c<Le[0].c&&(ae.e.c=Le[0].c),ae.e.r<Le[0].r&&(ae.e.r=Le[0].r);break;case 27:Le[14e3]&&(Ke[Le[14e3][0]]=Le[14e3][1]);break;case 1537:Ke[Le[0]]=Le[1],Le[0]==pe&&(te=Le[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(G["!ref"]=It(ae),me[de||te]=G,ye.push(de||te),!Ke.length)return{SheetNames:ye,Sheets:me};for(var dt={},mt=[],st=0;st<Ke.length;++st)me[ye[st]]?(mt.push(Ke[st]||ye[st]),dt[Ke[st]]=me[Ke[st]]||me[ye[st]]):(mt.push(Ke[st]),dt[Ke[st]]={"!ref":"A1"});return{SheetNames:mt,Sheets:dt}}function n(P,I){var B=I||{};if(+B.codepage>=0&&Ia(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var G=m0(),te=ur(P["!ref"]),de=Array.isArray(P),pe=[];Ca(G,0,l(1030)),Ca(G,6,m(te));for(var me=Math.min(te.e.r,8191),ye=te.s.r;ye<=me;++ye)for(var Ke=Hr(ye),ae=te.s.c;ae<=te.e.c;++ae){ye===te.s.r&&(pe[ae]=Or(ae));var at=pe[ae]+Ke,dt=de?(P[ye]||[])[ae]:P[at];if(!(!dt||dt.t=="z"))if(dt.t=="n")(dt.v|0)==dt.v&&dt.v>=-32768&&dt.v<=32767?Ca(G,13,E(ye,ae,dt.v)):Ca(G,14,k(ye,ae,dt.v));else{var mt=Pi(dt);Ca(G,15,y(ye,ae,mt.slice(0,239)))}}return Ca(G,1),G.end()}function a(P,I){var B=I||{};if(+B.codepage>=0&&Ia(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var G=m0();Ca(G,0,c(P));for(var te=0,de=0;te<P.SheetNames.length;++te)(P.Sheets[P.SheetNames[te]]||{})["!ref"]&&Ca(G,27,H(P.SheetNames[te],de++));var pe=0;for(te=0;te<P.SheetNames.length;++te){var me=P.Sheets[P.SheetNames[te]];if(!(!me||!me["!ref"])){for(var ye=ur(me["!ref"]),Ke=Array.isArray(me),ae=[],at=Math.min(ye.e.r,8191),dt=ye.s.r;dt<=at;++dt)for(var mt=Hr(dt),st=ye.s.c;st<=ye.e.c;++st){dt===ye.s.r&&(ae[st]=Or(st));var Le=ae[st]+mt,At=Ke?(me[dt]||[])[st]:me[Le];if(!(!At||At.t=="z"))if(At.t=="n")Ca(G,23,ve(dt,st,pe,At.v));else{var dr=Pi(At);Ca(G,22,O(dt,st,pe,dr.slice(0,239)))}}++pe}}return Ca(G,1),G.end()}function l(P){var I=Ir(2);return I.write_shift(2,P),I}function c(P){var I=Ir(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var B=0,G=0,te=0,de=0;de<P.SheetNames.length;++de){var pe=P.SheetNames[de],me=P.Sheets[pe];if(!(!me||!me["!ref"])){++te;var ye=Nl(me["!ref"]);B<ye.e.r&&(B=ye.e.r),G<ye.e.c&&(G=ye.e.c)}}return B>8191&&(B=8191),I.write_shift(2,B),I.write_shift(1,te),I.write_shift(1,G),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function f(P,I,B){var G={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&B.qpro?(G.s.c=P.read_shift(1),P.l++,G.s.r=P.read_shift(2),G.e.c=P.read_shift(1),P.l++,G.e.r=P.read_shift(2),G):(G.s.c=P.read_shift(2),G.s.r=P.read_shift(2),I==12&&B.qpro&&(P.l+=2),G.e.c=P.read_shift(2),G.e.r=P.read_shift(2),I==12&&B.qpro&&(P.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function m(P){var I=Ir(8);return I.write_shift(2,P.s.c),I.write_shift(2,P.s.r),I.write_shift(2,P.e.c),I.write_shift(2,P.e.r),I}function g(P,I,B){var G=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(G[0].c=P.read_shift(1),G[3]=P.read_shift(1),G[0].r=P.read_shift(2),P.l+=2):(G[2]=P.read_shift(1),G[0].c=P.read_shift(2),G[0].r=P.read_shift(2)),G}function x(P,I,B){var G=P.l+I,te=g(P,I,B);if(te[1].t="s",B.vers==20768){P.l++;var de=P.read_shift(1);return te[1].v=P.read_shift(de,"utf8"),te}return B.qpro&&P.l++,te[1].v=P.read_shift(G-P.l,"cstr"),te}function y(P,I,B){var G=Ir(7+B.length);G.write_shift(1,255),G.write_shift(2,I),G.write_shift(2,P),G.write_shift(1,39);for(var te=0;te<G.length;++te){var de=B.charCodeAt(te);G.write_shift(1,de>=128?95:de)}return G.write_shift(1,0),G}function b(P,I,B){var G=g(P,I,B);return G[1].v=P.read_shift(2,"i"),G}function E(P,I,B){var G=Ir(7);return G.write_shift(1,255),G.write_shift(2,I),G.write_shift(2,P),G.write_shift(2,B,"i"),G}function S(P,I,B){var G=g(P,I,B);return G[1].v=P.read_shift(8,"f"),G}function k(P,I,B){var G=Ir(13);return G.write_shift(1,255),G.write_shift(2,I),G.write_shift(2,P),G.write_shift(8,B,"f"),G}function C(P,I,B){var G=P.l+I,te=g(P,I,B);if(te[1].v=P.read_shift(8,"f"),B.qpro)P.l=G;else{var de=P.read_shift(2);F(P.slice(P.l,P.l+de),te),P.l+=de}return te}function R(P,I,B){var G=I&32768;return I&=-32769,I=(G?P:0)+(I>=8192?I-16384:I),(G?"":"$")+(B?Or(I):Hr(I))}var j={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function F(P,I){Wr(P,0);for(var B=[],G=0,te="",de="",pe="",me="";P.l<P.length;){var ye=P[P.l++];switch(ye){case 0:B.push(P.read_shift(8,"f"));break;case 1:de=R(I[0].c,P.read_shift(2),!0),te=R(I[0].r,P.read_shift(2),!1),B.push(de+te);break;case 2:{var Ke=R(I[0].c,P.read_shift(2),!0),ae=R(I[0].r,P.read_shift(2),!1);de=R(I[0].c,P.read_shift(2),!0),te=R(I[0].r,P.read_shift(2),!1),B.push(Ke+ae+":"+de+te)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(P.read_shift(2));break;case 6:{for(var at="";ye=P[P.l++];)at+=String.fromCharCode(ye);B.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:me=B.pop(),pe=B.pop(),B.push(["AND","OR"][ye-20]+"("+pe+","+me+")");break;default:if(ye<32&&N[ye])me=B.pop(),pe=B.pop(),B.push(pe+N[ye]+me);else if(j[ye]){if(G=j[ye][1],G==69&&(G=P[P.l++]),G>B.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+B.join("|")+"|");return}var dt=B.slice(-G);B.length-=G,B.push(j[ye][0]+"("+dt.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}B.length==1?I[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function K(P){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=P.read_shift(2),I[3]=P[P.l++],I[0].c=P[P.l++],I}function z(P,I){var B=K(P);return B[1].t="s",B[1].v=P.read_shift(I-4,"cstr"),B}function O(P,I,B,G){var te=Ir(6+G.length);te.write_shift(2,P),te.write_shift(1,B),te.write_shift(1,I),te.write_shift(1,39);for(var de=0;de<G.length;++de){var pe=G.charCodeAt(de);te.write_shift(1,pe>=128?95:pe)}return te.write_shift(1,0),te}function ne(P,I){var B=K(P);B[1].v=P.read_shift(2);var G=B[1].v>>1;if(B[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return B[1].v=G,B}function ee(P,I){var B=K(P),G=P.read_shift(4),te=P.read_shift(4),de=P.read_shift(2);if(de==65535)return G===0&&te===3221225472?(B[1].t="e",B[1].v=15):G===0&&te===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var pe=de&32768;return de=(de&32767)-16446,B[1].v=(1-pe*2)*(te*Math.pow(2,de+32)+G*Math.pow(2,de)),B}function ve(P,I,B,G){var te=Ir(14);if(te.write_shift(2,P),te.write_shift(1,B),te.write_shift(1,I),G==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var de=0,pe=0,me=0,ye=0;return G<0&&(de=1,G=-G),pe=Math.log2(G)|0,G/=Math.pow(2,pe-31),ye=G>>>0,(ye&2147483648)==0&&(G/=2,++pe,ye=G>>>0),G-=ye,ye|=2147483648,ye>>>=0,G*=Math.pow(2,32),me=G>>>0,te.write_shift(4,me),te.write_shift(4,ye),pe+=16383+(de?32768:0),te.write_shift(2,pe),te}function he(P,I){var B=ee(P);return P.l+=I-14,B}function ce(P,I){var B=K(P),G=P.read_shift(4);return B[1].v=G>>6,B}function Ne(P,I){var B=K(P),G=P.read_shift(8,"f");return B[1].v=G,B}function xe(P,I){var B=Ne(P);return P.l+=I-10,B}function le(P,I){return P[P.l+I-1]==0?P.read_shift(I,"cstr"):""}function Q(P,I){var B=P[P.l++];B>I-1&&(B=I-1);for(var G="";G.length<B;)G+=String.fromCharCode(P[P.l++]);return G}function M(P,I,B){if(!(!B.qpro||I<21)){var G=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var te=P.read_shift(I-21,"cstr");return[G,te]}}function V(P,I){for(var B={},G=P.l+I;P.l<G;){var te=P.read_shift(2);if(te==14e3){for(B[te]=[0,""],B[te][0]=P.read_shift(2);P[P.l];)B[te][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return B}function H(P,I){var B=Ir(5+P.length);B.write_shift(2,14e3),B.write_shift(2,I);for(var G=0;G<P.length;++G){var te=P.charCodeAt(G);B[B.l++]=te>127?95:te}return B[B.l++]=0,B}var se={0:{n:"BOF",f:_r},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:b},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:le},222:{n:"SHEETNAMELP",f:Q},65535:{n:""}},D={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:ee},24:{n:"NUMBER18",f:ne},25:{n:"FORMULA19",f:he},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ce},38:{n:"??"},39:{n:"NUMBER27",f:Ne},40:{n:"FORMULA28",f:xe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:le},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:M},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}})();function sS(e){var r={},t=e.match(on),n=0,a=!1;if(t)for(;n!=t.length;++n){var l=gt(t[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;r.cp=$0[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=l.val;break;case"<sz":r.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":l.rgb&&(r.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(l[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+l[0])}}return r}var oS=(function(){var e=Vc("t"),r=Vc("rPr");function t(l){var c=l.match(e);if(!c)return{t:"s",v:""};var f={t:"s",v:jt(c[1])},m=l.match(r);return m&&(f.s=sS(m[1])),f}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(a).map(t).filter(function(f){return f.v})}})(),lS=(function(){var r=/(\r\n|\n)/g;function t(a,l,c){var f=[];a.u&&f.push("text-decoration: underline;"),a.uval&&f.push("text-underline-style:"+a.uval+";"),a.sz&&f.push("font-size:"+a.sz+"pt;"),a.outline&&f.push("text-effect: outline;"),a.shadow&&f.push("text-shadow: auto;"),l.push('<span style="'+f.join("")+'">'),a.b&&(l.push("<b>"),c.push("</b>")),a.i&&(l.push("<i>"),c.push("</i>")),a.strike&&(l.push("<s>"),c.push("</s>"));var m=a.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(l.push("<"+m+">"),c.push("</"+m+">")),c.push("</span>"),a}function n(a){var l=[[],a.v,[]];return a.v?(a.s&&t(a.s,l[0],l[2]),l[0].join("")+l[1].replace(r,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),cS=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uS=/<(?:\w+:)?r>/,dS=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function im(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=jt(Zt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Zt(e),t&&(n.h=q0(n.t))):e.match(uS)&&(n.r=Zt(e),n.t=jt(Zt((e.replace(dS,"").match(cS)||[]).join("").replace(on,""))),t&&(n.h=lS(oS(n.r)))),n):{t:""}}var fS=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hS=/<(?:\w+:)?(?:si|sstItem)>/g,mS=/<\/(?:\w+:)?(?:si|sstItem)>/;function pS(e,r){var t=[],n="";if(!e)return t;var a=e.match(fS);if(a){n=a[2].replace(hS,"").split(mS);for(var l=0;l!=n.length;++l){var c=im(n[l].trim(),r);c!=null&&(t[t.length]=c)}a=gt(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function gS(e){return[e.read_shift(4),e.read_shift(4)]}function vS(e,r){var t=[],n=!1;return Ni(e,function(l,c,f){switch(f){case 159:t.Count=l[0],t.Unique=l[1];break;case 19:t.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||r.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}),t}function y1(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Ai(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function xS(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Ai(e,4),r.U=Ai(e,4),r.W=Ai(e,4),r}function yS(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),l=[];a-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function _S(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(yS(e));return r}function wS(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function bS(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Ai(e,4),r.U=Ai(e,4),r.W=Ai(e,4),r}function kS(e){var r=bS(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function _1(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function w1(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function SS(e){var r=Ai(e);switch(r.Minor){case 2:return[r.Minor,TS(e)];case 3:return[r.Minor,ES()];case 4:return[r.Minor,CS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function TS(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=_1(e,t),a=w1(e,e.length-e.l);return{t:"Std",h:n,v:a}}function ES(){throw new Error("File is password-protected: ECMA-376 Extensible")}function CS(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(on,function(l){var c=gt(l);switch(ei(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(f){n[f]=c[f]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function AS(e,r){var t={},n=t.EncryptionVersionInfo=Ai(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=_1(e,a),r-=a,t.EncryptionVerifier=w1(e,r),t}function PS(e){var r={},t=r.EncryptionVersionInfo=Ai(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function NS(e){var r=0,t,n=y1(e),a=n.length+1,l,c,f,m,g;for(t=Ss(a),t[0]=n.length,l=1;l!=a;++l)t[l]=n[l-1];for(l=a-1;l>=0;--l)c=t[l],f=(r&16384)===0?0:1,m=r<<1&32767,g=f|m,r=g^c;return r^52811}var b1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},a=function(c,f){return n(c^f)},l=function(c){for(var f=r[c.length-1],m=104,g=c.length-1;g>=0;--g)for(var x=c[g],y=0;y!=7;++y)x&64&&(f^=t[m]),x*=2,--m;return f};return function(c){for(var f=y1(c),m=l(f),g=f.length,x=Ss(16),y=0;y!=16;++y)x[y]=0;var b,E,S;for((g&1)===1&&(b=m>>8,x[g]=a(e[0],b),--g,b=m&255,E=f[f.length-1],x[g]=a(E,b));g>0;)--g,b=m>>8,x[g]=a(f[g],b),--g,b=m&255,x[g]=a(f[g],b);for(g=15,S=15-f.length;S>0;)b=m>>8,x[g]=a(e[S],b),--g,--S,b=m&255,x[g]=a(f[g],b),--g,--S;return x}})(),DS=function(e,r,t,n,a){a||(a=r),n||(n=b1(e));var l,c;for(l=0;l!=r.length;++l)c=r[l],c^=n[t],c=(c>>5|c<<3)&255,a[l]=c,++t;return[a,t,n]},IS=function(e){var r=0,t=b1(e);return function(n){var a=DS("",n,r,t);return r=a[1],a[0]}};function OS(e,r,t,n){var a={key:_r(e),verificationBytes:_r(e)};return t.password&&(a.verifier=NS(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=IS(t.password)),a}function jS(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=PS(e):n.Data=AS(e,r),n}function FS(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?jS(e,r-2,n):OS(e,t.biff>=8?r:r-2,t,n),n}var LS=(function(){function e(a,l){switch(l.type){case"base64":return r(Gn(a),l);case"binary":return r(a,l);case"buffer":return r(Nt&&Buffer.isBuffer(a)?a.toString("binary"):po(a),l);case"array":return r(fo(a),l)}throw new Error("Unrecognized type "+l.type)}function r(a,l){var c=l||{},f=c.dense?[]:{},m=a.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(x,y){Array.isArray(f)&&(f[y]=[]);for(var b=/\\\w+\b/g,E=0,S,k=-1;S=b.exec(x);){switch(S[0]){case"\\cell":var C=x.slice(E,b.lastIndex-S[0].length);if(C[0]==" "&&(C=C.slice(1)),++k,C.length){var R={v:C,t:"s"};Array.isArray(f)?f[y][k]=R:f[_t({r:y,c:k})]=R}break}E=b.lastIndex}k>g.e.c&&(g.e.c=k)}),f["!ref"]=It(g),f}function t(a,l){return Es(e(a,l),l)}function n(a){for(var l=["{\\rtf1\\ansi"],c=ur(a["!ref"]),f,m=Array.isArray(a),g=c.s.r;g<=c.e.r;++g){l.push("\\trowd\\trautofit1");for(var x=c.s.c;x<=c.e.c;++x)l.push("\\cellx"+(x+1));for(l.push("\\pard\\intbl"),x=c.s.c;x<=c.e.c;++x){var y=_t({r:g,c:x});f=m?(a[g]||[])[x]:a[y],!(!f||f.v==null&&(!f.f||f.F))&&(l.push(" "+(f.w||(Pi(f),f.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}})();function RS(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Zc(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function MS(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),l=Math.min(r,t,n),c=a-l;if(c===0)return[0,0,r];var f=0,m=0,g=a+l;switch(m=c/(g>1?2-g:g),a){case r:f=((t-n)/c+6)%6;break;case t:f=(n-r)/c+2;break;case n:f=(r-t)/c+4;break}return[f/6,m,g/2]}function BS(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),l=n-a/2,c=[l,l,l],f=6*r,m;if(t!==0)switch(f|0){case 0:case 6:m=a*f,c[0]+=a,c[1]+=m;break;case 1:m=a*(2-f),c[0]+=m,c[1]+=a;break;case 2:m=a*(f-2),c[1]+=a,c[2]+=m;break;case 3:m=a*(4-f),c[1]+=m,c[2]+=a;break;case 4:m=a*(f-4),c[2]+=a,c[0]+=m;break;case 5:m=a*(6-f),c[2]+=m,c[0]+=a;break}for(var g=0;g!=3;++g)c[g]=Math.round(c[g]*255);return c}function Xd(e,r){if(r===0)return e;var t=MS(RS(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Zc(BS(t))}var k1=6,zS=15,US=1,gn=k1;function Jd(e){return Math.floor((e+Math.round(128/gn)/256)*gn)}function Qd(e){return Math.floor((e-5)/gn*100+.5)/100}function x0(e){return Math.round((e*gn+5)/gn*256)/256}function Hh(e){return x0(Qd(Jd(e)))}function sm(e){var r=Math.abs(e-Hh(e)),t=gn;if(r>.005)for(gn=US;gn<zS;++gn)Math.abs(e-Hh(e))<=r&&(r=Math.abs(e-Hh(e)),t=gn);gn=t}function El(e){e.width?(e.wpx=Jd(e.width),e.wch=Qd(e.wpx),e.MDW=gn):e.wpx?(e.wch=Qd(e.wpx),e.width=x0(e.wch),e.MDW=gn):typeof e.wch=="number"&&(e.width=x0(e.wch),e.wpx=Jd(e.width),e.MDW=gn),e.customWidth&&delete e.customWidth}var $S=96,S1=$S;function T1(e){return e*96/S1}function Kc(e){return e*S1/96}var WS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function VS(e,r,t,n){r.Borders=[];var a={},l=!1;(e[0].match(on)||[]).forEach(function(c){var f=gt(c);switch(ei(f[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},f.diagonalUp&&(a.diagonalUp=Jt(f.diagonalUp)),f.diagonalDown&&(a.diagonalDown=Jt(f.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in borders")}})}function HS(e,r,t,n){r.Fills=[];var a={},l=!1;(e[0].match(on)||[]).forEach(function(c){var f=gt(c);switch(ei(f[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":f.patternType&&(a.patternType=f.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),f.indexed&&(a.bgColor.indexed=parseInt(f.indexed,10)),f.theme&&(a.bgColor.theme=parseInt(f.theme,10)),f.tint&&(a.bgColor.tint=parseFloat(f.tint)),f.rgb&&(a.bgColor.rgb=f.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),f.theme&&(a.fgColor.theme=parseInt(f.theme,10)),f.tint&&(a.fgColor.tint=parseFloat(f.tint)),f.rgb!=null&&(a.fgColor.rgb=f.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fills")}})}function GS(e,r,t,n){r.Fonts=[];var a={},l=!1;(e[0].match(on)||[]).forEach(function(c){var f=gt(c);switch(ei(f[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":f.val&&(a.name=Zt(f.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=f.val?Jt(f.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=f.val?Jt(f.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(f.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=f.val?Jt(f.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=f.val?Jt(f.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=f.val?Jt(f.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=f.val?Jt(f.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=f.val?Jt(f.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":f.val&&(a.sz=+f.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":f.val&&(a.vertAlign=f.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":f.val&&(a.family=parseInt(f.val,10));break;case"<family/>":case"</family>":break;case"<scheme":f.val&&(a.scheme=f.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(f.val=="1")break;f.codepage=$0[parseInt(f.val,10)];break;case"<color":if(a.color||(a.color={}),f.auto&&(a.color.auto=Jt(f.auto)),f.rgb)a.color.rgb=f.rgb.slice(-6);else if(f.indexed){a.color.index=parseInt(f.indexed,10);var m=oo[a.color.index];a.color.index==81&&(m=oo[1]),m||(m=oo[1]),a.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else f.theme&&(a.color.theme=parseInt(f.theme,10),f.tint&&(a.color.tint=parseFloat(f.tint)),f.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Xd(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+f[0]+" in fonts")}})}function ZS(e,r,t){r.NumberFmt=[];for(var n=Xa(kt),a=0;a<n.length;++a)r.NumberFmt[n[a]]=kt[n[a]];var l=e[0].match(on);if(l)for(a=0;a<l.length;++a){var c=gt(l[a]);switch(ei(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var f=jt(Zt(c.formatCode)),m=parseInt(c.numFmtId,10);if(r.NumberFmt[m]=f,m>0){if(m>392){for(m=392;m>60&&r.NumberFmt[m]!=null;--m);r.NumberFmt[m]=f}so(f,m)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var kd=["numFmtId","fillId","fontId","borderId","xfId"],Sd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function KS(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(on)||[]).forEach(function(l){var c=gt(l),f=0;switch(ei(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],f=0;f<kd.length;++f)n[kd[f]]&&(n[kd[f]]=parseInt(n[kd[f]],10));for(f=0;f<Sd.length;++f)n[Sd[f]]&&(n[Sd[f]]=Jt(n[Sd[f]]));if(r.NumberFmt&&n.numFmtId>392){for(f=392;f>60;--f)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[f]){n.numFmtId=f;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};c.vertical&&(m.vertical=c.vertical),c.horizontal&&(m.horizontal=c.horizontal),c.textRotation!=null&&(m.textRotation=c.textRotation),c.indent&&(m.indent=c.indent),c.wrapText&&(m.wrapText=Jt(c.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var qS=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(f,m,g){var x={};if(!f)return x;f=f.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=f.match(r))&&ZS(y,x,g),(y=f.match(a))&&GS(y,x,m,g),(y=f.match(n))&&HS(y,x,m,g),(y=f.match(l))&&VS(y,x,m,g),(y=f.match(t))&&KS(y,x,g),x}})();function YS(e,r){var t=e.read_shift(2),n=an(e);return[t,n]}function XS(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=ob(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(n.underline=c);var f=e.read_shift(1);f>0&&(n.family=f);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=sb(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=an(e),n}var JS=sn;function QS(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var e2=sn;function t2(e,r,t){var n={};n.NumberFmt=[];for(var a in kt)n.NumberFmt[a]=kt[a];n.CellXf=[],n.Fonts=[];var l=[],c=!1;return Ni(e,function(m,g,x){switch(x){case 44:n.NumberFmt[m[0]]=m[1],so(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(m.color.rgb=Xd(r.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(x),c=!0;break;case 38:l.pop(),c=!1;break;default:if(g.T>0)l.push(x);else if(g.T<0)l.pop();else if(!c||t.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),n}var r2=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function n2(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(on)||[]).forEach(function(a){var l=gt(a);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(r.themeElements.clrScheme[r2.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function a2(){}function i2(){}var s2=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,o2=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,l2=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function c2(e,r,t){r.themeElements={};var n;[["clrScheme",s2,n2],["fontScheme",o2,a2],["fmtScheme",l2,i2]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var u2=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function E1(e,r){(!e||e.length===0)&&(e=d2());var t,n={};if(!(t=e.match(u2)))throw new Error("themeElements not found in theme");return c2(t[0],n,r),n.raw=e,n}function d2(e,r){var t=[Rx];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function f2(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var c;try{c=Lx(l,{type:"array"})}catch{return}var f=Hn(c,"theme/theme/theme1.xml",!0);if(f)return E1(f,t)}}function h2(e){return e.read_shift(4)}function m2(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=p2(e,4);break;case 2:r.xclrValue=f1(e);break;case 3:r.xclrValue=h2(e);break;case 4:e.l+=4;break}return e.l+=8,r}function p2(e,r){return sn(e,r)}function g2(e,r){return sn(e,r)}function v2(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=m2(e);break;case 6:n[1]=g2(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function x2(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),l=[];a-- >0;)l.push(v2(e,t-e.l));return{ixfe:n,ext:l}}function y2(e,r){r.forEach(function(t){t[0]})}function _2(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:an(e)}}function w2(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function b2(e){return e.l+=4,e.read_shift(4)!=0}function k2(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},l=[],c=!1,f=2;return Ni(e,function(m,g,x){switch(x){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(y){f==1?n.Cell.push({type:n.Types[y[0]-1].name,index:y[1]}):f==0&&n.Value.push({type:n.Types[y[0]-1].name,index:y[1]})});break;case 337:f=m?1:0;break;case 338:f=2;break;case 35:l.push(x),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!g.T){if(!c||a.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),n}function S2(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,l=2,c;return e.replace(on,function(f){var m=gt(f);switch(ei(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var g=0;g<n.Types.length;++g)n.Types[g].name==m.name&&(c=n.Types[g]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):l==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+m.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return f}),n}function T2(e){var r=[];if(!e)return r;var t=1;return(e.match(on)||[]).forEach(function(n){var a=gt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function E2(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=_t(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function C2(e,r,t){var n=[];return Ni(e,function(l,c,f){switch(f){case 63:n.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function A2(e,r,t,n){if(!e)return e;var a=n||{},l=!1;Ni(e,function(f,m,g){switch(g){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!m.T){if(!l||a.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}},a)}function P2(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function rv(e,r,t,n){var a=Array.isArray(e),l;r.forEach(function(c){var f=vn(c.ref);if(a?(e[f.r]||(e[f.r]=[]),l=e[f.r][f.c]):l=e[c.ref],!l){l={t:"z"},a?e[f.r][f.c]=l:e[c.ref]=l;var m=ur(e["!ref"]||"BDWGO1000001:A1");m.s.r>f.r&&(m.s.r=f.r),m.e.r<f.r&&(m.e.r=f.r),m.s.c>f.c&&(m.s.c=f.c),m.e.c<f.c&&(m.e.c=f.c);var g=It(m);g!==e["!ref"]&&(e["!ref"]=g)}l.c||(l.c=[]);var x={a:c.author,t:c.t,r:c.r,T:t};c.h&&(x.h=c.h);for(var y=l.c.length-1;y>=0;--y){if(!t&&l.c[y].T)return;t&&!l.c[y].T&&l.c.splice(y,1)}if(t&&n){for(y=0;y<n.length;++y)if(x.a==n[y].id){x.a=n[y].name||x.a;break}}l.c.push(x)})}function N2(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var f=c.match(/<(?:\w+:)?author[^>]*>(.*)/);f&&t.push(f[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var f=c.match(/<(?:\w+:)?comment[^>]*>/);if(f){var m=gt(f[0]),g={author:m.authorId&&t[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},x=vn(m.ref);if(!(r.sheetRows&&r.sheetRows<=x.r)){var y=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),b=!!y&&!!y[1]&&im(y[1])||{r:"",t:"",h:""};g.r=b.r,b.r=="<t></t>"&&(b.t=b.h=""),g.t=(b.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(g.h=b.h),n.push(g)}}}}),n}function D2(e,r){var t=[],n=!1,a={},l=0;return e.replace(on,function(f,m){var g=gt(f);switch(ei(g[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:g.personId,guid:g.id,ref:g.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":l=m+f.length;break;case"</text>":a.t=e.slice(l,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+g[0]+" in threaded comments")}return f}),t}function I2(e,r){var t=[],n=!1;return e.replace(on,function(l){var c=gt(l);switch(ei(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),t}function O2(e){var r={};r.iauthor=e.read_shift(4);var t=vo(e);return r.rfx=t.s,r.ref=_t(t.s),e.l+=16,r}var j2=an;function F2(e,r){var t=[],n=[],a={},l=!1;return Ni(e,function(f,m,g){switch(g){case 632:n.push(f);break;case 635:a=f;break;case 637:a.t=f.t,a.h=f.h,a.r=f.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!l||r.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}),t}var L2="application/vnd.ms-office.vbaProject";function R2(e){var r=Dt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dt.utils.cfb_add(r,a,e.FileIndex[n].content)}}),Dt.write(r)}function M2(){return{"!type":"dialog"}}function B2(){return{"!type":"dialog"}}function z2(){return{"!type":"macro"}}function U2(){return{"!type":"macro"}}var bl=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,l,c){var f=!1,m=!1;l.length==0?m=!0:l.charAt(0)=="["&&(m=!0,l=l.slice(1,-1)),c.length==0?f=!0:c.charAt(0)=="["&&(f=!0,c=c.slice(1,-1));var g=l.length>0?parseInt(l,10)|0:0,x=c.length>0?parseInt(c,10)|0:0;return f?x+=r.c:--x,m?g+=r.r:--g,a+(f?"":"$")+Or(x)+(m?"":"$")+Hr(g)}return function(a,l){return r=l,a.replace(e,t)}})(),C1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,$2=(function(){return function(r,t){return r.replace(C1,function(n,a,l,c,f,m){var g=Q0(c)-(l?0:t.c),x=J0(m)-(f?0:t.r),y=x==0?"":f?x+1:"["+x+"]",b=g==0?"":l?g+1:"["+g+"]";return a+"R"+y+"C"+b})}})();function A1(e,r){return e.replace(C1,function(t,n,a,l,c,f){return n+(a=="$"?a+l:Or(Q0(l)+r.c))+(c=="$"?c+f:Hr(J0(f)+r.r))})}function W2(e,r,t){var n=Nl(r),a=n.s,l=vn(t),c={r:l.r-a.r,c:l.c-a.c};return A1(e,c)}function V2(e){return e.length!=1}function nv(e){return e.replace(/_xlfn\./g,"")}function xr(e){e.l+=1}function Ts(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function P1(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return N1(e);t.biff==12&&(n=4)}var a=e.read_shift(n),l=e.read_shift(n),c=Ts(e),f=Ts(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:f[0],cRel:f[1],rRel:f[2]}}}function N1(e){var r=Ts(e),t=Ts(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function H2(e,r,t){if(t.biff<8)return N1(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),l=Ts(e),c=Ts(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function D1(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return G2(e);var n=e.read_shift(t&&t.biff==12?4:2),a=Ts(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function G2(e){var r=Ts(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function Z2(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function K2(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return q2(e);var a=e.read_shift(n>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,f=(l&32768)>>15;if(l&=16383,f==1)for(;a>524287;)a-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:a,c:l,cRel:c,rRel:f}}function q2(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function Y2(e,r,t){var n=(e[e.l++]&96)>>5,a=P1(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function X2(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=P1(e,l,t);return[n,a,c]}function J2(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function Q2(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,a]}function eT(e,r,t){var n=(e[e.l++]&96)>>5,a=H2(e,r-1,t);return[n,a]}function tT(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function av(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function rT(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],l=0;l<=n;++l)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function nT(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function aT(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function iT(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function sT(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function I1(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function oT(e){return e.read_shift(2),I1(e)}function lT(e){return e.read_shift(2),I1(e)}function cT(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=D1(e,0,t);return[n,a]}function uT(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=K2(e,0,t);return[n,a]}function dT(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var l=D1(e,0,t);return[n,a,l]}function fT(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[hE[a],F1[a],n]}function hT(e,r,t){var n=e[e.l++],a=e.read_shift(1),l=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:mT(e);return[a,(l[0]===0?F1:fE)[l[1]]]}function mT(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function pT(e,r,t){e.l+=t&&t.biff==2?3:4}function gT(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function vT(e){return e.l++,xo[e.read_shift(1)]}function xT(e){return e.l++,e.read_shift(2)}function yT(e){return e.l++,e.read_shift(1)!==0}function _T(e){return e.l++,rn(e)}function wT(e,r,t){return e.l++,ru(e,r-1,t)}function bT(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=pr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=xo[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=rn(e);break;case 2:t[1]=yo(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function kT(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],l=0;l!=n;++l)a.push((t.biff==12?vo:lf)(e));return a}function ST(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var f=0;f!=a;++f)c[l][f]=bT(e,t.biff);return c}function TT(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,l=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function ET(e,r,t){if(t.biff==5)return CT(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),l=e.read_shift(4);return[n,a,l]}function CT(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function AT(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function PT(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function NT(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function DT(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,a]}var IT=sn,OT=sn,jT=sn;function au(e,r,t){return e.l+=2,[Z2(e)]}function om(e){return e.l+=6,[]}var FT=au,LT=om,RT=om,MT=au;function O1(e){return e.l+=2,[_r(e),e.read_shift(2)&1]}var BT=au,zT=O1,UT=om,$T=au,WT=au,VT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function HT(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),l=e.read_shift(2),c=VT[t>>2&31];return{ixti:r,coltype:t&3,rt:c,idx:n,c:a,C:l}}function GT(e){return e.l+=2,[e.read_shift(4)]}function ZT(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function KT(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function qT(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function YT(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function XT(e){return e.l+=4,[0,0]}var iv={1:{n:"PtgExp",f:gT},2:{n:"PtgTbl",f:jT},3:{n:"PtgAdd",f:xr},4:{n:"PtgSub",f:xr},5:{n:"PtgMul",f:xr},6:{n:"PtgDiv",f:xr},7:{n:"PtgPower",f:xr},8:{n:"PtgConcat",f:xr},9:{n:"PtgLt",f:xr},10:{n:"PtgLe",f:xr},11:{n:"PtgEq",f:xr},12:{n:"PtgGe",f:xr},13:{n:"PtgGt",f:xr},14:{n:"PtgNe",f:xr},15:{n:"PtgIsect",f:xr},16:{n:"PtgUnion",f:xr},17:{n:"PtgRange",f:xr},18:{n:"PtgUplus",f:xr},19:{n:"PtgUminus",f:xr},20:{n:"PtgPercent",f:xr},21:{n:"PtgParen",f:xr},22:{n:"PtgMissArg",f:xr},23:{n:"PtgStr",f:wT},26:{n:"PtgSheet",f:ZT},27:{n:"PtgEndSheet",f:KT},28:{n:"PtgErr",f:vT},29:{n:"PtgBool",f:yT},30:{n:"PtgInt",f:xT},31:{n:"PtgNum",f:_T},32:{n:"PtgArray",f:tT},33:{n:"PtgFunc",f:fT},34:{n:"PtgFuncVar",f:hT},35:{n:"PtgName",f:TT},36:{n:"PtgRef",f:cT},37:{n:"PtgArea",f:Y2},38:{n:"PtgMemArea",f:AT},39:{n:"PtgMemErr",f:IT},40:{n:"PtgMemNoMem",f:OT},41:{n:"PtgMemFunc",f:PT},42:{n:"PtgRefErr",f:NT},43:{n:"PtgAreaErr",f:J2},44:{n:"PtgRefN",f:uT},45:{n:"PtgAreaN",f:eT},46:{n:"PtgMemAreaN",f:qT},47:{n:"PtgMemNoMemN",f:YT},57:{n:"PtgNameX",f:ET},58:{n:"PtgRef3d",f:dT},59:{n:"PtgArea3d",f:X2},60:{n:"PtgRefErr3d",f:DT},61:{n:"PtgAreaErr3d",f:Q2},255:{}},JT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},QT={1:{n:"PtgElfLel",f:O1},2:{n:"PtgElfRw",f:$T},3:{n:"PtgElfCol",f:FT},6:{n:"PtgElfRwV",f:WT},7:{n:"PtgElfColV",f:MT},10:{n:"PtgElfRadical",f:BT},11:{n:"PtgElfRadicalS",f:UT},13:{n:"PtgElfColS",f:LT},15:{n:"PtgElfColSV",f:RT},16:{n:"PtgElfRadicalLel",f:zT},25:{n:"PtgList",f:HT},29:{n:"PtgSxName",f:GT},255:{}},eE={0:{n:"PtgAttrNoop",f:XT},1:{n:"PtgAttrSemi",f:sT},2:{n:"PtgAttrIf",f:aT},4:{n:"PtgAttrChoose",f:rT},8:{n:"PtgAttrGoto",f:nT},16:{n:"PtgAttrSum",f:pT},32:{n:"PtgAttrBaxcel",f:av},33:{n:"PtgAttrBaxcel",f:av},64:{n:"PtgAttrSpace",f:oT},65:{n:"PtgAttrSpaceSemi",f:lT},128:{n:"PtgAttrIfError",f:iT},255:{}};function iu(e,r,t,n){if(n.biff<8)return sn(e,r);for(var a=e.l+r,l=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=ST(e,0,n),l.push(t[c][1]);break;case"PtgMemArea":t[c][2]=kT(e,t[c][1],n),l.push(t[c][2]);break;case"PtgExp":n&&n.biff==12&&(t[c][1][1]=e.read_shift(4),l.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return r=a-e.l,r!==0&&l.push(sn(e,r)),l}function su(e,r,t){for(var n=e.l+r,a,l,c=[];n!=e.l;)r=n-e.l,l=e[e.l],a=iv[l]||iv[JT[l]],(l===24||l===25)&&(a=(l===24?QT:eE)[e[e.l+1]]),!a||!a.f?sn(e,r):c.push([a.n,a.f(e,r,t)]);return c}function tE(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var rE={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function nE(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function j1(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function sv(e,r,t){var n=j1(e,r,t);return n=="#REF"?n:nE(n,t)}function tn(e,r,t,n,a){var l=a&&a.biff||8,c={s:{c:0,r:0}},f=[],m,g,x,y=0,b=0,E,S="";if(!e[0]||!e[0][0])return"";for(var k=-1,C="",R=0,j=e[0].length;R<j;++R){var N=e[0][R];switch(N[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=f.pop(),g=f.pop(),k>=0){switch(e[0][k][1][0]){case 0:C=cr(" ",e[0][k][1][1]);break;case 1:C=cr("\r",e[0][k][1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}g=g+C,k=-1}f.push(g+rE[N[0]]+m);break;case"PtgIsect":m=f.pop(),g=f.pop(),f.push(g+" "+m);break;case"PtgUnion":m=f.pop(),g=f.pop(),f.push(g+","+m);break;case"PtgRange":m=f.pop(),g=f.pop(),f.push(g+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Nc(N[1][1],c,a),f.push(Dc(x,l));break;case"PtgRefN":x=t?Nc(N[1][1],t,a):N[1][1],f.push(Dc(x,l));break;case"PtgRef3d":y=N[1][1],x=Nc(N[1][2],c,a),S=sv(n,y,a),f.push(S+"!"+Dc(x,l));break;case"PtgFunc":case"PtgFuncVar":var F=N[1][0],K=N[1][1];F||(F=0),F&=127;var z=F==0?[]:f.slice(-F);f.length-=F,K==="User"&&(K=z.shift()),f.push(K+"("+z.join(",")+")");break;case"PtgBool":f.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(N[1]);break;case"PtgNum":f.push(String(N[1]));break;case"PtgStr":f.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(N[1]);break;case"PtgAreaN":E=zg(N[1][1],t?{s:t}:c,a),f.push(Wh(E,a));break;case"PtgArea":E=zg(N[1][1],c,a),f.push(Wh(E,a));break;case"PtgArea3d":y=N[1][1],E=N[1][2],S=sv(n,y,a),f.push(S+"!"+Wh(E,a));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":b=N[1][2];var O=(n.names||[])[b-1]||(n[0]||[])[b],ne=O?O.Name:"SH33TJSNAME"+String(b);ne&&ne.slice(0,6)=="_xlfn."&&!a.xlfn&&(ne=ne.slice(6)),f.push(ne);break;case"PtgNameX":var ee=N[1][1];b=N[1][2];var ve;if(a.biff<=5)ee<0&&(ee=-ee),n[ee]&&(ve=n[ee][b]);else{var he="";if(((n[ee]||[])[0]||[])[0]==14849||(((n[ee]||[])[0]||[])[0]==1025?n[ee][b]&&n[ee][b].itab>0&&(he=n.SheetNames[n[ee][b].itab-1]+"!"):he=n.SheetNames[b-1]+"!"),n[ee]&&n[ee][b])he+=n[ee][b].Name;else if(n[0]&&n[0][b])he+=n[0][b].Name;else{var ce=(j1(n,ee,a)||"").split(";;");ce[b-1]?he=ce[b-1]:he+="SH33TJSERRX"}f.push(he);break}ve||(ve={Name:"SH33TJSERRY"}),f.push(ve.Name);break;case"PtgParen":var Ne="(",xe=")";if(k>=0){switch(C="",e[0][k][1][0]){case 2:Ne=cr(" ",e[0][k][1][1])+Ne;break;case 3:Ne=cr("\r",e[0][k][1][1])+Ne;break;case 4:xe=cr(" ",e[0][k][1][1])+xe;break;case 5:xe=cr("\r",e[0][k][1][1])+xe;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][k][1][0])}k=-1}f.push(Ne+f.pop()+xe);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":x={c:N[1][1],r:N[1][0]};var le={c:t.c,r:t.r};if(n.sharedf[_t(x)]){var Q=n.sharedf[_t(x)];f.push(tn(Q,c,le,n,a))}else{var M=!1;for(m=0;m!=n.arrayf.length;++m)if(g=n.arrayf[m],!(x.c<g[0].s.c||x.c>g[0].e.c)&&!(x.r<g[0].s.r||x.r>g[0].e.r)){f.push(tn(g[1],c,le,n,a)),M=!0;break}M||f.push(N[1])}break;case"PtgArray":f.push("{"+tE(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":k=R;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&k>=0&&V.indexOf(e[0][R][0])==-1){N=e[0][k];var H=!0;switch(N[1][0]){case 4:H=!1;case 0:C=cr(" ",N[1][1]);break;case 5:H=!1;case 1:C=cr("\r",N[1][1]);break;default:if(C="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}f.push((H?C:"")+f.pop()+(H?"":C)),k=-1}}if(f.length>1&&a.WTF)throw new Error("bad formula stack");return f[0]}function aE(e,r,t){var n=e.l+r,a=t.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],sn(e,r-2)];var f=su(e,c,t);return r!==c+a&&(l=iu(e,r-c-a,f,t)),e.l=n,[f,l]}function iE(e,r,t){var n=e.l+r,a=t.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],sn(e,r-2)];var f=su(e,c,t);return r!==c+a&&(l=iu(e,r-c-a,f,t)),e.l=n,[f,l]}function sE(e,r,t,n){var a=e.l+r,l=su(e,n,t),c;return a!==e.l&&(c=iu(e,a-e.l,l,t)),[l,c]}function oE(e,r,t){var n=e.l+r,a,l=e.read_shift(2),c=su(e,l,t);return l==65535?[[],sn(e,r-2)]:(r!==l+2&&(a=iu(e,n-l-2,c,t)),[c,a])}function lE(e){var r;if(Ei(e,e.l+6)!==65535)return[rn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Gh(e,r,t){var n=e.l+r,a=ti(e);t.biff==2&&++e.l;var l=lE(e),c=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var f=iE(e,n-e.l,t);return{cell:a,val:l[0],formula:f,shared:c>>3&1,tt:l[1]}}function cf(e,r,t){var n=e.read_shift(4),a=su(e,n,t),l=e.read_shift(4),c=l>0?iu(e,l,a,t):null;return[a,c]}var cE=cf,uf=cf,uE=cf,dE=cf,fE={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},F1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},hE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ov(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Zh(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Fc={},kl={};function Lc(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function L1(e,r,t,n,a,l){try{n.cellNF&&(e.z=kt[r])}catch(f){if(n.WTF)throw f}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=zr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(kt[r]==null&&so(mw[r]||"General",r),e.t==="e")e.w=e.w||xo[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v);else if(e.t==="d"){var c=yn(e.v);(c|0)===c?e.w=c.toString(10):e.w=Wc(c)}else{if(e.v===void 0)return"";e.w=uo(e.v,kl)}else e.t==="d"?e.w=ca(r,yn(e.v),kl):e.w=ca(r,e.v,kl)}catch(f){if(n.WTF)throw f}if(n.cellStyles&&t!=null)try{e.s=l.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Xd(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Xd(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(f){if(n.WTF&&l.Fills)throw f}}}function mE(e,r){var t=ur(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=It(t))}var pE=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,gE=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,vE=/<(?:\w:)?hyperlink [^>]*>/mg,xE=/"(\w*:\w*)"/,yE=/<(?:\w:)?col\b[^>]*[\/]?>/g,_E=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wE=/<(?:\w:)?pageMargins[^>]*\/>/g,R1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,bE=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,kE=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function SE(e,r,t,n,a,l,c){if(!e)return e;n||(n={"!id":{}});var f=r.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},g="",x="",y=e.match(gE);y?(g=e.slice(0,y.index),x=e.slice(y.index+y[0].length)):g=x=e;var b=g.match(R1);b?lm(b[0],f,a,t):(b=g.match(bE))&&TE(b[0],b[1]||"",f,a,t);var E=(g.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(E>0){var S=g.slice(E,E+50).match(xE);S&&mE(f,S[1])}var k=g.match(kE);k&&k[1]&&DE(k[1],a);var C=[];if(r.cellStyles){var R=g.match(yE);R&&AE(C,R)}y&&IE(y[1],f,r,m,l,c);var j=x.match(_E);j&&(f["!autofilter"]=PE(j[0]));var N=[],F=x.match(pE);if(F)for(E=0;E!=F.length;++E)N[E]=ur(F[E].slice(F[E].indexOf('"')+1));var K=x.match(vE);K&&EE(f,K,n);var z=x.match(wE);if(z&&(f["!margins"]=CE(gt(z[0]))),!f["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(f["!ref"]=It(m)),r.sheetRows>0&&f["!ref"]){var O=ur(f["!ref"]);r.sheetRows<=+O.e.r&&(O.e.r=r.sheetRows-1,O.e.r>m.e.r&&(O.e.r=m.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>m.e.c&&(O.e.c=m.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),f["!fullref"]=f["!ref"],f["!ref"]=It(O))}return C.length>0&&(f["!cols"]=C),N.length>0&&(f["!merges"]=N),f}function lm(e,r,t,n){var a=gt(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=jt(Zt(a.codeName)))}function TE(e,r,t,n,a){lm(e.slice(0,e.indexOf(">")),t,n,a)}function EE(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var l=gt(Zt(r[a]),!0);if(!l.ref)return;var c=((t||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+jt(l.location))):(l.Target="#"+jt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var f=ur(l.ref),m=f.s.r;m<=f.e.r;++m)for(var g=f.s.c;g<=f.e.c;++g){var x=_t({c:g,r:m});n?(e[m]||(e[m]=[]),e[m][g]||(e[m][g]={t:"z",v:void 0}),e[m][g].l=l):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=l)}}}function CE(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function AE(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=gt(r[n],!0);a.hidden&&(a.hidden=Jt(a.hidden));var l=parseInt(a.min,10)-1,c=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,sm(a.width)),El(a);l<=c;)e[l++]=Vr(a)}}function PE(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var NE=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function DE(e,r){r.Views||(r.Views=[{}]),(e.match(NE)||[]).forEach(function(t,n){var a=gt(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),Jt(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var IE=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,l=Vc("v"),c=Vc("f");return function(m,g,x,y,b,E){for(var S=0,k="",C=[],R=[],j=0,N=0,F=0,K="",z,O,ne=0,ee=0,ve,he,ce=0,Ne=0,xe=Array.isArray(E.CellXf),le,Q=[],M=[],V=Array.isArray(g),H=[],se={},D=!1,P=!!x.sheetStubs,I=m.split(r),B=0,G=I.length;B!=G;++B){k=I[B].trim();var te=k.length;if(te!==0){var de=0;e:for(S=0;S<te;++S)switch(k[S]){case">":if(k[S-1]!="/"){++S;break e}if(x&&x.cellStyles){if(O=gt(k.slice(de,S),!0),ne=O.r!=null?parseInt(O.r,10):ne+1,ee=-1,x.sheetRows&&x.sheetRows<ne)continue;se={},D=!1,O.ht&&(D=!0,se.hpt=parseFloat(O.ht),se.hpx=Kc(se.hpt)),O.hidden=="1"&&(D=!0,se.hidden=!0),O.outlineLevel!=null&&(D=!0,se.level=+O.outlineLevel),D&&(H[ne-1]=se)}break;case"<":de=S;break}if(de>=S)break;if(O=gt(k.slice(de,S),!0),ne=O.r!=null?parseInt(O.r,10):ne+1,ee=-1,!(x.sheetRows&&x.sheetRows<ne)){y.s.r>ne-1&&(y.s.r=ne-1),y.e.r<ne-1&&(y.e.r=ne-1),x&&x.cellStyles&&(se={},D=!1,O.ht&&(D=!0,se.hpt=parseFloat(O.ht),se.hpx=Kc(se.hpt)),O.hidden=="1"&&(D=!0,se.hidden=!0),O.outlineLevel!=null&&(D=!0,se.level=+O.outlineLevel),D&&(H[ne-1]=se)),C=k.slice(S).split(e);for(var pe=0;pe!=C.length&&C[pe].trim().charAt(0)=="<";++pe);for(C=C.slice(pe),S=0;S!=C.length;++S)if(k=C[S].trim(),k.length!==0){if(R=k.match(t),j=S,N=0,F=0,k="<c "+(k.slice(0,1)=="<"?">":"")+k,R!=null&&R.length===2){for(j=0,K=R[1],N=0;N!=K.length&&!((F=K.charCodeAt(N)-64)<1||F>26);++N)j=26*j+F;--j,ee=j}else++ee;for(N=0;N!=k.length&&k.charCodeAt(N)!==62;++N);if(++N,O=gt(k.slice(0,N),!0),O.r||(O.r=_t({r:ne-1,c:ee})),K=k.slice(N),z={t:""},(R=K.match(l))!=null&&R[1]!==""&&(z.v=jt(R[1])),x.cellFormula){if((R=K.match(c))!=null&&R[1]!==""){if(z.f=jt(Zt(R[1])).replace(/\r\n/g,`
`),x.xlfn||(z.f=nv(z.f)),R[0].indexOf('t="array"')>-1)z.F=(K.match(a)||[])[1],z.F.indexOf(":")>-1&&Q.push([ur(z.F),z.F]);else if(R[0].indexOf('t="shared"')>-1){he=gt(R[0]);var me=jt(Zt(R[1]));x.xlfn||(me=nv(me)),M[parseInt(he.si,10)]=[he,me,O.r]}}else(R=K.match(/<f[^>]*\/>/))&&(he=gt(R[0]),M[he.si]&&(z.f=W2(M[he.si][1],M[he.si][2],O.r)));var ye=vn(O.r);for(N=0;N<Q.length;++N)ye.r>=Q[N][0].s.r&&ye.r<=Q[N][0].e.r&&ye.c>=Q[N][0].s.c&&ye.c<=Q[N][0].e.c&&(z.F=Q[N][1])}if(O.t==null&&z.v===void 0)if(z.f||z.F)z.v=0,z.t="n";else if(P)z.t="z";else continue;else z.t=O.t||"n";switch(y.s.c>ee&&(y.s.c=ee),y.e.c<ee&&(y.e.c=ee),z.t){case"n":if(z.v==""||z.v==null){if(!P)continue;z.t="z"}else z.v=parseFloat(z.v);break;case"s":if(typeof z.v>"u"){if(!P)continue;z.t="z"}else ve=Fc[parseInt(z.v,10)],z.v=ve.t,z.r=ve.r,x.cellHTML&&(z.h=ve.h);break;case"str":z.t="s",z.v=z.v!=null?Zt(z.v):"",x.cellHTML&&(z.h=q0(z.v));break;case"inlineStr":R=K.match(n),z.t="s",R!=null&&(ve=im(R[1]))?(z.v=ve.t,x.cellHTML&&(z.h=ve.h)):z.v="";break;case"b":z.v=Jt(z.v);break;case"d":x.cellDates?z.v=zr(z.v,1):(z.v=yn(zr(z.v,1)),z.t="n");break;case"e":(!x||x.cellText!==!1)&&(z.w=z.v),z.v=a1[z.v];break}if(ce=Ne=0,le=null,xe&&O.s!==void 0&&(le=E.CellXf[O.s],le!=null&&(le.numFmtId!=null&&(ce=le.numFmtId),x.cellStyles&&le.fillId!=null&&(Ne=le.fillId))),L1(z,ce,Ne,x,b,E),x.cellDates&&xe&&z.t=="n"&&Pl(kt[ce])&&(z.t="d",z.v=of(z.v)),O.cm&&x.xlmeta){var Ke=(x.xlmeta.Cell||[])[+O.cm-1];Ke&&Ke.type=="XLDAPR"&&(z.D=!0)}if(V){var ae=vn(O.r);g[ae.r]||(g[ae.r]=[]),g[ae.r][ae.c]=z}else g[O.r]=z}}}}H.length>0&&(g["!rows"]=H)}})();function OE(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=a/20),t}var jE=vo;function FE(){}function LE(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=ab(e),t}function RE(e){var r=ua(e);return[r]}function ME(e){var r=go(e);return[r]}function BE(e){var r=ua(e),t=e.read_shift(1);return[r,t,"b"]}function zE(e){var r=go(e),t=e.read_shift(1);return[r,t,"b"]}function UE(e){var r=ua(e),t=e.read_shift(1);return[r,t,"e"]}function $E(e){var r=go(e),t=e.read_shift(1);return[r,t,"e"]}function WE(e){var r=ua(e),t=e.read_shift(4);return[r,t,"s"]}function VE(e){var r=go(e),t=e.read_shift(4);return[r,t,"s"]}function HE(e){var r=ua(e),t=rn(e);return[r,t,"n"]}function M1(e){var r=go(e),t=rn(e);return[r,t,"n"]}function GE(e){var r=ua(e),t=rm(e);return[r,t,"n"]}function ZE(e){var r=go(e),t=rm(e);return[r,t,"n"]}function KE(e){var r=ua(e),t=em(e);return[r,t,"is"]}function qE(e){var r=ua(e),t=an(e);return[r,t,"str"]}function YE(e){var r=go(e),t=an(e);return[r,t,"str"]}function XE(e,r,t){var n=e.l+r,a=ua(e);a.r=t["!row"];var l=e.read_shift(1),c=[a,l,"b"];if(t.cellFormula){e.l+=2;var f=uf(e,n-e.l,t);c[3]=tn(f,null,a,t.supbooks,t)}else e.l=n;return c}function JE(e,r,t){var n=e.l+r,a=ua(e);a.r=t["!row"];var l=e.read_shift(1),c=[a,l,"e"];if(t.cellFormula){e.l+=2;var f=uf(e,n-e.l,t);c[3]=tn(f,null,a,t.supbooks,t)}else e.l=n;return c}function QE(e,r,t){var n=e.l+r,a=ua(e);a.r=t["!row"];var l=rn(e),c=[a,l,"n"];if(t.cellFormula){e.l+=2;var f=uf(e,n-e.l,t);c[3]=tn(f,null,a,t.supbooks,t)}else e.l=n;return c}function eC(e,r,t){var n=e.l+r,a=ua(e);a.r=t["!row"];var l=an(e),c=[a,l,"str"];if(t.cellFormula){e.l+=2;var f=uf(e,n-e.l,t);c[3]=tn(f,null,a,t.supbooks,t)}else e.l=n;return c}var tC=vo;function rC(e,r){var t=e.l+r,n=vo(e),a=tm(e),l=an(e),c=an(e),f=an(e);e.l=t;var m={rfx:n,relId:a,loc:l,display:f};return c&&(m.Tooltip=c),m}function nC(){}function aC(e,r,t){var n=e.l+r,a=t1(e),l=e.read_shift(1),c=[a];if(c[2]=l,t.cellFormula){var f=cE(e,n-e.l,t);c[1]=f}else e.l=n;return c}function iC(e,r,t){var n=e.l+r,a=vo(e),l=[a];if(t.cellFormula){var c=dE(e,n-e.l,t);l[1]=c,e.l=n}else e.l=n;return l}var sC=["left","right","top","bottom","header","footer"];function oC(e){var r={};return sC.forEach(function(t){r[t]=rn(e)}),r}function lC(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function cC(){}function uC(){}function dC(e,r,t,n,a,l,c){if(!e)return e;var f=r||{};n||(n={"!id":{}});var m=f.dense?[]:{},g,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,b=!1,E,S,k,C,R,j,N,F,K,z=[];f.biff=12,f["!row"]=0;var O=0,ne=!1,ee=[],ve={},he=f.supbooks||a.supbooks||[[]];if(he.sharedf=ve,he.arrayf=ee,he.SheetNames=a.SheetNames||a.Sheets.map(function(V){return V.name}),!f.supbooks&&(f.supbooks=he,a.Names))for(var ce=0;ce<a.Names.length;++ce)he[0][ce+1]=a.Names[ce];var Ne=[],xe=[],le=!1;ef[16]={n:"BrtShortReal",f:M1};var Q;if(Ni(e,function(H,se,D){if(!b)switch(D){case 148:g=H;break;case 0:E=H,f.sheetRows&&f.sheetRows<=E.r&&(b=!0),F=Hr(C=E.r),f["!row"]=E.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Kc(H.hpt)),xe[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:H[2]},H[2]){case"n":S.v=H[1];break;case"s":N=Fc[H[1]],S.v=N.t,S.r=N.r;break;case"b":S.v=!!H[1];break;case"e":S.v=H[1],f.cellText!==!1&&(S.w=xo[S.v]);break;case"str":S.t="s",S.v=H[1];break;case"is":S.t="s",S.v=H[1].t;break}if((k=c.CellXf[H[0].iStyleRef])&&L1(S,k.numFmtId,null,f,l,c),R=H[0].c==-1?R+1:H[0].c,f.dense?(m[C]||(m[C]=[]),m[C][R]=S):m[Or(R)+F]=S,f.cellFormula){for(ne=!1,O=0;O<ee.length;++O){var P=ee[O];E.r>=P[0].s.r&&E.r<=P[0].e.r&&R>=P[0].s.c&&R<=P[0].e.c&&(S.F=It(P[0]),ne=!0)}!ne&&H.length>3&&(S.f=H[3])}if(x.s.r>E.r&&(x.s.r=E.r),x.s.c>R&&(x.s.c=R),x.e.r<E.r&&(x.e.r=E.r),x.e.c<R&&(x.e.c=R),f.cellDates&&k&&S.t=="n"&&Pl(kt[k.numFmtId])){var I=io(S.v);I&&(S.t="d",S.v=new Date(I.y,I.m-1,I.d,I.H,I.M,I.S,I.u))}Q&&(Q.type=="XLDAPR"&&(S.D=!0),Q=void 0);break;case 1:case 12:if(!f.sheetStubs||y)break;S={t:"z",v:void 0},R=H[0].c==-1?R+1:H[0].c,f.dense?(m[C]||(m[C]=[]),m[C][R]=S):m[Or(R)+F]=S,x.s.r>E.r&&(x.s.r=E.r),x.s.c>R&&(x.s.c=R),x.e.r<E.r&&(x.e.r=E.r),x.e.c<R&&(x.e.c=R),Q&&(Q.type=="XLDAPR"&&(S.D=!0),Q=void 0);break;case 176:z.push(H);break;case 49:Q=((f.xlmeta||{}).Cell||[])[H-1];break;case 494:var B=n["!id"][H.relId];for(B?(H.Target=B.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=B):H.relId==""&&(H.Target="#"+H.loc),C=H.rfx.s.r;C<=H.rfx.e.r;++C)for(R=H.rfx.s.c;R<=H.rfx.e.c;++R)f.dense?(m[C]||(m[C]=[]),m[C][R]||(m[C][R]={t:"z",v:void 0}),m[C][R].l=H):(j=_t({c:R,r:C}),m[j]||(m[j]={t:"z",v:void 0}),m[j].l=H);break;case 426:if(!f.cellFormula)break;ee.push(H),K=f.dense?m[C][R]:m[Or(R)+F],K.f=tn(H[1],x,{r:E.r,c:R},he,f),K.F=It(H[0]);break;case 427:if(!f.cellFormula)break;ve[_t(H[0].s)]=H[1],K=f.dense?m[C][R]:m[Or(R)+F],K.f=tn(H[1],x,{r:E.r,c:R},he,f);break;case 60:if(!f.cellStyles)break;for(;H.e>=H.s;)Ne[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},le||(le=!0,sm(H.w/256)),El(Ne[H.e+1]);break;case 161:m["!autofilter"]={ref:It(H)};break;case 476:m["!margins"]=H;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),H.name&&(a.Sheets[t].CodeName=H.name),(H.above||H.left)&&(m["!outline"]={above:H.above,left:H.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),H.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!se.T){if(!y||f.WTF)throw new Error("Unexpected record 0x"+D.toString(16))}}},f),delete f.supbooks,delete f["!row"],!m["!ref"]&&(x.s.r<2e6||g&&(g.e.r>0||g.e.c>0||g.s.r>0||g.s.c>0))&&(m["!ref"]=It(g||x)),f.sheetRows&&m["!ref"]){var M=ur(m["!ref"]);f.sheetRows<=+M.e.r&&(M.e.r=f.sheetRows-1,M.e.r>x.e.r&&(M.e.r=x.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>x.e.c&&(M.e.c=x.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),m["!fullref"]=m["!ref"],m["!ref"]=It(M))}return z.length>0&&(m["!merges"]=z),Ne.length>0&&(m["!cols"]=Ne),xe.length>0&&(m["!rows"]=xe),m}function fC(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(r[+c[1]]=t?+c[2]:c[2])});var a=jt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[r,a,n]}function hC(e,r,t,n,a,l){var c=l||{"!type":"chart"};if(!e)return l;var f=0,m=0,g="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var b=fC(y);x.s.r=x.s.c=0,x.e.c=f,g=Or(f),b[0].forEach(function(E,S){c[g+Hr(S)]={t:"n",v:E,z:b[1]},m=S}),x.e.r<m&&(x.e.r=m),++f}),f>0&&(c["!ref"]=It(x)),c}function mC(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,f=e.match(R1);return f&&lm(f[0],l,a,t),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function pC(e,r){e.l+=10;var t=an(e);return{name:t}}function gC(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Ni(e,function(m,g,x){switch(x){case 550:l["!rel"]=m;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),m.name&&(a.Sheets[t].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(g.T>0)){if(!(g.T<0)){if(!c||r.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},r),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var B1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vC=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xC=[],yC=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function lv(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var l=r[a];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=Jt(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function cv(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Jt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function z1(e){cv(e.WBProps,B1),cv(e.CalcPr,yC),lv(e.WBView,vC),lv(e.Sheets,xC),kl.date1904=Jt(e.WBProps.date1904)}var _C="][*?/\\".split("");function wC(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return _C.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var bC=/<\w+:workbook/;function kC(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",l={},c=0;if(e.replace(on,function(m,g){var x=gt(m);switch(ei(x[0])){case"<?xml":break;case"<workbook":m.match(bC)&&(a="xmlns"+m.match(/<(\w+):/)[1]),t.xmlns=x[a];break;case"</workbook>":break;case"<fileVersion":delete x[0],t.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":B1.forEach(function(y){if(x[y[0]]!=null)switch(y[2]){case"bool":t.WBProps[y[0]]=Jt(x[y[0]]);break;case"int":t.WBProps[y[0]]=parseInt(x[y[0]],10);break;default:t.WBProps[y[0]]=x[y[0]]}}),x.codeName&&(t.WBProps.CodeName=Zt(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],t.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=jt(Zt(x.name)),delete x[0],t.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=Zt(x.name),x.comment&&(l.Comment=x.comment),x.localSheetId&&(l.Sheet=+x.localSheetId),Jt(x.hidden||"0")&&(l.Hidden=!0),c=g+m.length;break;case"</definedName>":l.Ref=jt(Zt(e.slice(c,g))),t.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete x[0],t.CalcPr=x;break;case"<calcPr/>":delete x[0],t.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return m}),Uw.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return z1(t),t}function SC(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=p0(e),t.name=an(e),t}function TC(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?an(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function EC(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function CC(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),l=ib(e),c=uE(e,0,t),f=tm(e);e.l=n;var m={Name:l,Ptg:c};return a<268435455&&(m.Sheet=a),f&&(m.Comment=f),m}function AC(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],ef[16]={n:"BrtFRTArchID$",f:EC},Ni(e,function(m,g,x){switch(x){case 156:c.SheetNames.push(m.name),t.Sheets.push(m);break;case 153:t.WBProps=m;break;case 39:m.Sheet!=null&&(r.SID=m.Sheet),m.Ref=tn(m.Ptg,null,null,c,r),delete r.SID,delete m.Ptg,l.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([x,m]):c[0]=[x,m],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(m),c.XTI=c.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(x),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(x),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!g.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},r),z1(t),t.Names=l,t.supbooks=c,t}function PC(e,r,t){return r.slice(-4)===".bin"?AC(e,t):kC(e,t)}function NC(e,r,t,n,a,l,c,f){return r.slice(-4)===".bin"?dC(e,n,t,a,l,c,f):SE(e,n,t,a,l,c,f)}function DC(e,r,t,n,a,l,c,f){return r.slice(-4)===".bin"?gC(e,n,t,a,l):mC(e,n,t,a,l)}function IC(e,r,t,n,a,l,c,f){return r.slice(-4)===".bin"?z2():U2()}function OC(e,r,t,n,a,l,c,f){return r.slice(-4)===".bin"?M2():B2()}function jC(e,r,t,n){return r.slice(-4)===".bin"?t2(e,t,n):qS(e,t,n)}function FC(e,r,t){return E1(e,t)}function LC(e,r,t){return r.slice(-4)===".bin"?vS(e,t):pS(e,t)}function RC(e,r,t){return r.slice(-4)===".bin"?F2(e,t):N2(e,t)}function MC(e,r,t){return r.slice(-4)===".bin"?C2(e):T2(e)}function BC(e,r,t,n){return t.slice(-4)===".bin"?A2(e,r,t,n):void 0}function zC(e,r,t){return r.slice(-4)===".bin"?k2(e,r,t):S2(e,r,t)}var U1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,$1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ea(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(U1),l,c,f,m;if(a)for(m=0;m!=a.length;++m)l=a[m].match($1),(c=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?f="xmlns"+l[1].slice(6):f=l[1].slice(c+1),n[f]=l[2].slice(1,l[2].length-1));return n}function UC(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(U1),a,l,c,f;if(n)for(f=0;f!=n.length;++f)a=n[f].match($1),(l=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(l+1),t[c]=a[2].slice(1,a[2].length-1));return t}var Rc;function $C(e,r){var t=Rc[e]||jt(e);return t==="General"?uo(r):ca(t,r)}function WC(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Jt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=zr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[jt(r)]=a}function VC(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||xo[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v):e.w=uo(e.v):e.w=$C(r||"General",e.v)}catch(l){if(t.WTF)throw l}try{var n=Rc[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Pl(n)){var a=io(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(l){if(t.WTF)throw l}}}function HC(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=WS[n.Pattern]||n.Pattern)}e[r.ID]=r}function GC(e,r,t,n,a,l,c,f,m,g){var x="General",y=n.StyleID,b={};g=g||{};var E=[],S=0;for(y===void 0&&f&&(y=f.StyleID),y===void 0&&c&&(y=c.StyleID);l[y]!==void 0&&(l[y].nf&&(x=l[y].nf),l[y].Interior&&E.push(l[y].Interior),!!l[y].Parent);)y=l[y].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=Jt(e);break;case"String":n.t="s",n.r=Dg(jt(e)),n.v=e.indexOf("<")>-1?jt(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(zr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=jt(e):n.v<60&&(n.v=n.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=a1[e],g.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=Dg(r||e));break}if(VC(n,x,g),g.cellFormula!==!1)if(n.Formula){var k=jt(n.Formula);k.charCodeAt(0)==61&&(k=k.slice(1)),n.f=bl(k,a),delete n.Formula,n.ArrayRange=="RC"?n.F=bl("RC:RC",a):n.ArrayRange&&(n.F=bl(n.ArrayRange,a),m.push([ur(n.F),n.F]))}else for(S=0;S<m.length;++S)a.r>=m[S][0].s.r&&a.r<=m[S][0].e.r&&a.c>=m[S][0].s.c&&a.c<=m[S][0].e.c&&(n.F=m[S][1]);g.cellStyles&&(E.forEach(function(C){!b.patternType&&C.patternType&&(b.patternType=C.patternType)}),n.s=b),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function ZC(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Kh(e,r){var t=r||{};Nx();var n=kc(Y0(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Zt(n));var a=n.slice(0,1024).toLowerCase(),l=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var c=Vr(t);return c.type="string",Gc.to_workbook(n,c)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(At){a.indexOf("<"+At)>=0&&(l=!0)}),l)return rA(n,t);Rc={"General Number":"General","General Date":kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kt[15],"Short Date":kt[14],"Long Time":kt[19],"Medium Time":kt[18],"Short Time":kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kt[2],Standard:kt[4],Percent:kt[10],Scientific:kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var f,m=[],g,x={},y=[],b=t.dense?[]:{},E="",S={},k={},C=Ea('<Data ss:Type="String">'),R=0,j=0,N=0,F={s:{r:2e6,c:2e6},e:{r:0,c:0}},K={},z={},O="",ne=0,ee=[],ve={},he={},ce=0,Ne=[],xe=[],le={},Q=[],M,V=!1,H=[],se=[],D={},P=0,I=0,B={Sheets:[],WBProps:{date1904:!1}},G={};Hc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";f=Hc.exec(n);)switch(f[3]=(te=f[3]).toLowerCase()){case"data":if(te=="data"){if(f[1]==="/"){if((g=m.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&m.push([f[3],!0]);break}if(m[m.length-1][1])break;f[1]==="/"?GC(n.slice(R,f.index),O,C,m[m.length-1][0]=="comment"?le:S,{c:j,r:N},K,Q[j],k,H,t):(O="",C=Ea(f[0]),R=f.index+f[0].length);break;case"cell":if(f[1]==="/")if(xe.length>0&&(S.c=xe),(!t.sheetRows||t.sheetRows>N)&&S.v!==void 0&&(t.dense?(b[N]||(b[N]=[]),b[N][j]=S):b[Or(j)+Hr(N)]=S),S.HRef&&(S.l={Target:jt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(P=j+(parseInt(S.MergeAcross,10)|0),I=N+(parseInt(S.MergeDown,10)|0),ee.push({s:{c:j,r:N},e:{c:P,r:I}})),!t.sheetStubs)S.MergeAcross?j=P+1:++j;else if(S.MergeAcross||S.MergeDown){for(var de=j;de<=P;++de)for(var pe=N;pe<=I;++pe)(de>j||pe>N)&&(t.dense?(b[pe]||(b[pe]=[]),b[pe][de]={t:"z"}):b[Or(de)+Hr(pe)]={t:"z"});j=P+1}else++j;else S=UC(f[0]),S.Index&&(j=+S.Index-1),j<F.s.c&&(F.s.c=j),j>F.e.c&&(F.e.c=j),f[0].slice(-2)==="/>"&&++j,xe=[];break;case"row":f[1]==="/"||f[0].slice(-2)==="/>"?(N<F.s.r&&(F.s.r=N),N>F.e.r&&(F.e.r=N),f[0].slice(-2)==="/>"&&(k=Ea(f[0]),k.Index&&(N=+k.Index-1)),j=0,++N):(k=Ea(f[0]),k.Index&&(N=+k.Index-1),D={},(k.AutoFitHeight=="0"||k.Height)&&(D.hpx=parseInt(k.Height,10),D.hpt=T1(D.hpx),se[N]=D),k.Hidden=="1"&&(D.hidden=!0,se[N]=D));break;case"worksheet":if(f[1]==="/"){if((g=m.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"));y.push(E),F.s.r<=F.e.r&&F.s.c<=F.e.c&&(b["!ref"]=It(F),t.sheetRows&&t.sheetRows<=F.e.r&&(b["!fullref"]=b["!ref"],F.e.r=t.sheetRows-1,b["!ref"]=It(F))),ee.length&&(b["!merges"]=ee),Q.length>0&&(b["!cols"]=Q),se.length>0&&(b["!rows"]=se),x[E]=b}else F={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=j=0,m.push([f[3],!1]),g=Ea(f[0]),E=jt(g.Name),b=t.dense?[]:{},ee=[],H=[],se=[],G={name:E,Hidden:0},B.Sheets.push(G);break;case"table":if(f[1]==="/"){if((g=m.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else{if(f[0].slice(-2)=="/>")break;m.push([f[3],!1]),Q=[],V=!1}break;case"style":f[1]==="/"?HC(K,z,t):z=Ea(f[0]);break;case"numberformat":z.nf=jt(Ea(f[0]).Format||"General"),Rc[z.nf]&&(z.nf=Rc[z.nf]);for(var me=0;me!=392&&kt[me]!=z.nf;++me);if(me==392){for(me=57;me!=392;++me)if(kt[me]==null){so(z.nf,me);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(M=Ea(f[0]),M.Hidden&&(M.hidden=!0,delete M.Hidden),M.Width&&(M.wpx=parseInt(M.Width,10)),!V&&M.wpx>10){V=!0,gn=k1;for(var ye=0;ye<Q.length;++ye)Q[ye]&&El(Q[ye])}V&&El(M),Q[M.Index-1||Q.length]=M;for(var Ke=0;Ke<+M.Span;++Ke)Q[Q.length]=Vr(M);break;case"namedrange":if(f[1]==="/")break;B.Names||(B.Names=[]);var ae=gt(f[0]),at={Name:ae.Name,Ref:bl(ae.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(at.Sheet=B.Sheets.length-1),B.Names.push(at);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(f[0].slice(-2)==="/>")break;f[1]==="/"?O+=n.slice(ne,f.index):ne=f.index+f[0].length;break;case"interior":if(!t.cellStyles)break;z.Interior=Ea(f[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(f[0].slice(-2)==="/>")break;f[1]==="/"?Nb(ve,te,n.slice(ce,f.index)):ce=f.index+f[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(f[1]==="/"){if((g=m.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else m.push([f[3],!1]);break;case"comment":if(f[1]==="/"){if((g=m.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"));ZC(le),xe.push(le)}else m.push([f[3],!1]),g=Ea(f[0]),le={a:g.Author};break;case"autofilter":if(f[1]==="/"){if((g=m.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else if(f[0].charAt(f[0].length-2)!=="/"){var dt=Ea(f[0]);b["!autofilter"]={ref:bl(dt.Range).replace(/\$/g,"")},m.push([f[3],!0])}break;case"name":break;case"datavalidation":if(f[1]==="/"){if((g=m.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&m.push([f[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(f[1]==="/"){if((g=m.pop())[0]!==f[3])throw new Error("Bad state: "+g.join("|"))}else f[0].charAt(f[0].length-2)!=="/"&&m.push([f[3],!0]);break;case"null":break;default:if(m.length==0&&f[3]=="document"||m.length==0&&f[3]=="uof")return pv(n,t);var mt=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(f[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:mt=!1}break;case"componentoptions":switch(f[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:mt=!1}break;case"excelworkbook":switch(f[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:mt=!1}break;case"workbookoptions":switch(f[3]){case"owcversion":break;case"height":break;case"width":break;default:mt=!1}break;case"worksheetoptions":switch(f[3]){case"visible":if(f[0].slice(-2)!=="/>")if(f[1]==="/")switch(n.slice(ce,f.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else ce=f.index+f[0].length;break;case"header":b["!margins"]||Lc(b["!margins"]={},"xlml"),isNaN(+gt(f[0]).Margin)||(b["!margins"].header=+gt(f[0]).Margin);break;case"footer":b["!margins"]||Lc(b["!margins"]={},"xlml"),isNaN(+gt(f[0]).Margin)||(b["!margins"].footer=+gt(f[0]).Margin);break;case"pagemargins":var st=gt(f[0]);b["!margins"]||Lc(b["!margins"]={},"xlml"),isNaN(+st.Top)||(b["!margins"].top=+st.Top),isNaN(+st.Left)||(b["!margins"].left=+st.Left),isNaN(+st.Right)||(b["!margins"].right=+st.Right),isNaN(+st.Bottom)||(b["!margins"].bottom=+st.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":b["!outline"]||(b["!outline"]={}),b["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:mt=!1}break;case"pivottable":case"pivotcache":switch(f[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:mt=!1}break;case"pagebreaks":switch(f[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:mt=!1}break;case"autofilter":switch(f[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:mt=!1}break;case"querytable":switch(f[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:mt=!1}break;case"datavalidation":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:mt=!1}break;case"sorting":case"conditionalformatting":switch(f[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:mt=!1}break;case"mapinfo":case"schema":case"data":switch(f[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:mt=!1}break;case"smarttags":break;default:mt=!1;break}if(mt||f[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+f[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(f[0].slice(-2)==="/>")break;f[1]==="/"?WC(he,te,Ne,n.slice(ce,f.index)):(Ne=f,ce=f.index+f[0].length);break}if(t.WTF)throw"Unrecognized tag: "+f[3]+"|"+m.join("|")}var Le={};return!t.bookSheets&&!t.bookProps&&(Le.Sheets=x),Le.SheetNames=y,Le.Workbook=B,Le.SSF=Vr(kt),Le.Props=ve,Le.Custprops=he,Le}function y0(e,r){switch(dm(r=r||{}),r.type||"base64"){case"base64":return Kh(Gn(e),r);case"binary":case"buffer":case"file":return Kh(e,r);case"array":return Kh(po(e),r)}}function KC(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=lb(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=cb(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var qC=[60,1084,2066,2165,2175];function YC(e,r,t,n,a){var l=n,c=[],f=t.slice(t.l,t.l+l);if(a&&a.enc&&a.enc.insitu&&f.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(f)}c.push(f),t.l+=l;for(var m=Ei(t,t.l),g=_0[m],x=0;g!=null&&qC.indexOf(m)>-1;)l=Ei(t,t.l+2),x=t.l+4,m==2066?x+=4:(m==2165||m==2175)&&(x+=12),f=t.slice(x,t.l+4+l),c.push(f),t.l+=4+l,g=_0[m=Ei(t,t.l)];var y=xs(c);Wr(y,0);var b=0;y.lens=[];for(var E=0;E<c.length;++E)y.lens.push(b),b+=c[E].length;if(y.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+y.length+" < "+n;return r.f(y,y.length,a)}function Ka(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=kt[n])}catch(l){if(r.WTF)throw l}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||xo[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v):e.w=uo(e.v):e.w=ca(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(l){if(r.WTF)throw l}if(r.cellDates&&n&&e.t=="n"&&Pl(kt[n]||String(n))){var a=io(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Td(e,r,t){return{v:e,ixfe:r,t}}function XC(e,r){var t={opts:{}},n={},a=r.dense?[]:{},l={},c={},f=null,m=[],g="",x={},y,b="",E,S,k,C,R={},j=[],N,F,K=[],z=[],O={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ne={},ee=function(ct){return ct<8?oo[ct]:ct<64&&z[ct-8]||oo[ct]},ve=function(ct,Ge,Tr){var $t=Ge.XF.data;if(!(!$t||!$t.patternType||!Tr||!Tr.cellStyles)){Ge.s={},Ge.s.patternType=$t.patternType;var Gr;(Gr=Zc(ee($t.icvFore)))&&(Ge.s.fgColor={rgb:Gr}),(Gr=Zc(ee($t.icvBack)))&&(Ge.s.bgColor={rgb:Gr})}},he=function(ct,Ge,Tr){if(!(D>1)&&!(Tr.sheetRows&&ct.r>=Tr.sheetRows)){if(Tr.cellStyles&&Ge.XF&&Ge.XF.data&&ve(ct,Ge,Tr),delete Ge.ixfe,delete Ge.XF,y=ct,b=_t(ct),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<c.s.r&&(c.s.r=ct.r),ct.c<c.s.c&&(c.s.c=ct.c),ct.r+1>c.e.r&&(c.e.r=ct.r+1),ct.c+1>c.e.c&&(c.e.c=ct.c+1),Tr.cellFormula&&Ge.f){for(var $t=0;$t<j.length;++$t)if(!(j[$t][0].s.c>ct.c||j[$t][0].s.r>ct.r)&&!(j[$t][0].e.c<ct.c||j[$t][0].e.r<ct.r)){Ge.F=It(j[$t][0]),(j[$t][0].s.c!=ct.c||j[$t][0].s.r!=ct.r)&&delete Ge.f,Ge.f&&(Ge.f=""+tn(j[$t][1],c,ct,H,ce));break}}Tr.dense?(a[ct.r]||(a[ct.r]=[]),a[ct.r][ct.c]=Ge):a[b]=Ge}},ce={enc:!1,sbcch:0,snames:[],sharedf:R,arrayf:j,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(ce.password=r.password);var Ne,xe=[],le=[],Q=[],M=[],V=!1,H=[];H.SheetNames=ce.snames,H.sharedf=ce.sharedf,H.arrayf=ce.arrayf,H.names=[],H.XTI=[];var se=0,D=0,P=0,I=[],B=[],G;ce.codepage=1200,Ia(1200);for(var te=!1;e.l<e.length-1;){var de=e.l,pe=e.read_shift(2);if(pe===0&&se===10)break;var me=e.l===e.length?0:e.read_shift(2),ye=_0[pe];if(ye&&ye.f){if(r.bookSheets&&se===133&&pe!==133)break;if(se=pe,ye.r===2||ye.r==12){var Ke=e.read_shift(2);if(me-=2,!ce.enc&&Ke!==pe&&((Ke&255)<<8|Ke>>8)!==pe)throw new Error("rt mismatch: "+Ke+"!="+pe);ye.r==12&&(e.l+=10,me-=10)}var ae={};if(pe===10?ae=ye.f(e,me,ce):ae=YC(pe,ye,e,me,ce),D==0&&[9,521,1033,2057].indexOf(se)===-1)continue;switch(pe){case 34:t.opts.Date1904=O.WBProps.date1904=ae;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(ce.enc||(e.l=0),ce.enc=ae,!r.password)throw new Error("File is password-protected");if(ae.valid==null)throw new Error("Encryption scheme unsupported");if(!ae.valid)throw new Error("Password is incorrect");break;case 92:ce.lastuser=ae;break;case 66:var at=Number(ae);switch(at){case 21010:at=1200;break;case 32768:at=1e4;break;case 32769:at=1252;break}Ia(ce.codepage=at),te=!0;break;case 317:ce.rrtabid=ae;break;case 25:ce.winlocked=ae;break;case 439:t.opts.RefreshAll=ae;break;case 12:t.opts.CalcCount=ae;break;case 16:t.opts.CalcDelta=ae;break;case 17:t.opts.CalcIter=ae;break;case 13:t.opts.CalcMode=ae;break;case 14:t.opts.CalcPrecision=ae;break;case 95:t.opts.CalcSaveRecalc=ae;break;case 15:ce.CalcRefMode=ae;break;case 2211:t.opts.FullCalc=ae;break;case 129:ae.fDialog&&(a["!type"]="dialog"),ae.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),ae.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:K.push(ae);break;case 430:H.push([ae]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(ae);break;case 24:case 536:G={Name:ae.Name,Ref:tn(ae.rgce,c,null,H,ce)},ae.itab>0&&(G.Sheet=ae.itab-1),H.names.push(G),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(ae),ae.Name=="_xlnm._FilterDatabase"&&ae.itab>0&&ae.rgce&&ae.rgce[0]&&ae.rgce[0][0]&&ae.rgce[0][0][0]=="PtgArea3d"&&(B[ae.itab-1]={ref:It(ae.rgce[0][0][1][2])});break;case 22:ce.ExternCount=ae;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(ae),H.XTI=H.XTI.concat(ae);break;case 2196:if(ce.biff<8)break;G!=null&&(G.Comment=ae[1]);break;case 18:a["!protect"]=ae;break;case 19:ae!==0&&ce.WTF&&console.error("Password verifier: "+ae);break;case 133:l[ae.pos]=ae,ce.snames.push(ae.name);break;case 10:{if(--D)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,a["!ref"]=It(c),r.sheetRows&&r.sheetRows<=c.e.r){var dt=c.e.r;c.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=It(c),c.e.r=dt}c.e.r++,c.e.c++}xe.length>0&&(a["!merges"]=xe),le.length>0&&(a["!objects"]=le),Q.length>0&&(a["!cols"]=Q),M.length>0&&(a["!rows"]=M),O.Sheets.push(ne)}g===""?x=a:n[g]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ce.biff===8&&(ce.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ae.BIFFVer]||8),ce.biffguess=ae.BIFFVer==0,ae.BIFFVer==0&&ae.dt==4096&&(ce.biff=5,te=!0,Ia(ce.codepage=28591)),ce.biff==8&&ae.BIFFVer==0&&ae.dt==16&&(ce.biff=2),D++)break;if(a=r.dense?[]:{},ce.biff<8&&!te&&(te=!0,Ia(ce.codepage=r.codepage||1252)),ce.biff<5||ae.BIFFVer==0&&ae.dt==4096){g===""&&(g="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var mt={pos:e.l-me,name:g};l[mt.pos]=mt,ce.snames.push(g)}else g=(l[de]||{name:""}).name;ae.dt==32&&(a["!type"]="chart"),ae.dt==64&&(a["!type"]="macro"),xe=[],le=[],ce.arrayf=j=[],Q=[],M=[],V=!1,ne={Hidden:(l[de]||{hs:0}).hs,name:g}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[ae.r]||[])[ae.c]:a[_t({c:ae.c,r:ae.r})])&&++ae.c,N={ixfe:ae.ixfe,XF:K[ae.ixfe]||{},v:ae.val,t:"n"},P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he({c:ae.c,r:ae.r},N,r);break;case 5:case 517:N={ixfe:ae.ixfe,XF:K[ae.ixfe],v:ae.val,t:ae.t},P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he({c:ae.c,r:ae.r},N,r);break;case 638:N={ixfe:ae.ixfe,XF:K[ae.ixfe],v:ae.rknum,t:"n"},P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he({c:ae.c,r:ae.r},N,r);break;case 189:for(var st=ae.c;st<=ae.C;++st){var Le=ae.rkrec[st-ae.c][0];N={ixfe:Le,XF:K[Le],v:ae.rkrec[st-ae.c][1],t:"n"},P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he({c:st,r:ae.r},N,r)}break;case 6:case 518:case 1030:{if(ae.val=="String"){f=ae;break}if(N=Td(ae.val,ae.cell.ixfe,ae.tt),N.XF=K[N.ixfe],r.cellFormula){var At=ae.formula;if(At&&At[0]&&At[0][0]&&At[0][0][0]=="PtgExp"){var dr=At[0][0][1][0],Yt=At[0][0][1][1],Qt=_t({r:dr,c:Yt});R[Qt]?N.f=""+tn(ae.formula,c,ae.cell,H,ce):N.F=((r.dense?(a[dr]||[])[Yt]:a[Qt])||{}).F}else N.f=""+tn(ae.formula,c,ae.cell,H,ce)}P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he(ae.cell,N,r),f=ae}break;case 7:case 519:if(f)f.val=ae,N=Td(ae,f.cell.ixfe,"s"),N.XF=K[N.ixfe],r.cellFormula&&(N.f=""+tn(f.formula,c,f.cell,H,ce)),P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he(f.cell,N,r),f=null;else throw new Error("String record expects Formula");break;case 33:case 545:{j.push(ae);var _n=_t(ae[0].s);if(E=r.dense?(a[ae[0].s.r]||[])[ae[0].s.c]:a[_n],r.cellFormula&&E){if(!f||!_n||!E)break;E.f=""+tn(ae[1],c,ae[0],H,ce),E.F=It(ae[0])}}break;case 1212:{if(!r.cellFormula)break;if(b){if(!f)break;R[_t(f.cell)]=ae[0],E=r.dense?(a[f.cell.r]||[])[f.cell.c]:a[_t(f.cell)],(E||{}).f=""+tn(ae[0],c,y,H,ce)}}break;case 253:N=Td(m[ae.isst].t,ae.ixfe,"s"),m[ae.isst].h&&(N.h=m[ae.isst].h),N.XF=K[N.ixfe],P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he({c:ae.c,r:ae.r},N,r);break;case 513:r.sheetStubs&&(N={ixfe:ae.ixfe,XF:K[ae.ixfe],t:"z"},P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he({c:ae.c,r:ae.r},N,r));break;case 190:if(r.sheetStubs)for(var br=ae.c;br<=ae.C;++br){var er=ae.ixfe[br-ae.c];N={ixfe:er,XF:K[er],t:"z"},P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he({c:br,r:ae.r},N,r)}break;case 214:case 516:case 4:N=Td(ae.val,ae.ixfe,"s"),N.XF=K[N.ixfe],P>0&&(N.z=I[N.ixfe>>8&63]),Ka(N,r,t.opts.Date1904),he({c:ae.c,r:ae.r},N,r);break;case 0:case 512:D===1&&(c=ae);break;case 252:m=ae;break;case 1054:if(ce.biff==4){I[P++]=ae[1];for(var kr=0;kr<P+163&&kt[kr]!=ae[1];++kr);kr>=163&&so(ae[1],P+163)}else so(ae[1],ae[0]);break;case 30:{I[P++]=ae;for(var fr=0;fr<P+163&&kt[fr]!=ae;++fr);fr>=163&&so(ae,P+163)}break;case 229:xe=xe.concat(ae);break;case 93:le[ae.cmo[0]]=ce.lastobj=ae;break;case 438:ce.lastobj.TxO=ae;break;case 127:ce.lastobj.ImData=ae;break;case 440:for(C=ae[0].s.r;C<=ae[0].e.r;++C)for(k=ae[0].s.c;k<=ae[0].e.c;++k)E=r.dense?(a[C]||[])[k]:a[_t({c:k,r:C})],E&&(E.l=ae[1]);break;case 2048:for(C=ae[0].s.r;C<=ae[0].e.r;++C)for(k=ae[0].s.c;k<=ae[0].e.c;++k)E=r.dense?(a[C]||[])[k]:a[_t({c:k,r:C})],E&&E.l&&(E.l.Tooltip=ae[1]);break;case 28:{if(ce.biff<=5&&ce.biff>=2)break;E=r.dense?(a[ae[0].r]||[])[ae[0].c]:a[_t(ae[0])];var Sr=le[ae[2]];E||(r.dense?(a[ae[0].r]||(a[ae[0].r]=[]),E=a[ae[0].r][ae[0].c]={t:"z"}):E=a[_t(ae[0])]={t:"z"},c.e.r=Math.max(c.e.r,ae[0].r),c.s.r=Math.min(c.s.r,ae[0].r),c.e.c=Math.max(c.e.c,ae[0].c),c.s.c=Math.min(c.s.c,ae[0].c)),E.c||(E.c=[]),S={a:ae[1],t:Sr.TxO.t},E.c.push(S)}break;case 2173:y2(K[ae.ixfe],ae.ext);break;case 125:{if(!ce.cellStyles)break;for(;ae.e>=ae.s;)Q[ae.e--]={width:ae.w/256,level:ae.level||0,hidden:!!(ae.flags&1)},V||(V=!0,sm(ae.w/256)),El(Q[ae.e+1])}break;case 520:{var St={};ae.level!=null&&(M[ae.r]=St,St.level=ae.level),ae.hidden&&(M[ae.r]=St,St.hidden=!0),ae.hpt&&(M[ae.r]=St,St.hpt=ae.hpt,St.hpx=Kc(ae.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Lc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=ae;break;case 161:a["!margins"]||Lc(a["!margins"]={}),a["!margins"].header=ae.header,a["!margins"].footer=ae.footer;break;case 574:ae.RTL&&(O.Views[0].RTL=!0);break;case 146:z=ae;break;case 2198:Ne=ae;break;case 140:F=ae;break;case 442:g?ne.CodeName=ae||ne.name:O.WBProps.CodeName=ae||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),e.l+=me}return t.SheetNames=Xa(l).sort(function(ir,ct){return Number(ir)-Number(ct)}).map(function(ir){return l[ir].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&x["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=x)):t.Preamble=x,t.Sheets&&B.forEach(function(ir,ct){t.Sheets[t.SheetNames[ct]]["!autofilter"]=ir}),t.Strings=m,t.SSF=Vr(kt),ce.enc&&(t.Encryption=ce.enc),Ne&&(t.Themes=Ne),t.Metadata={},F!==void 0&&(t.Metadata.Country=F),H.names.length>0&&(O.Names=H.names),t.Workbook=O,t}var uv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function JC(e,r,t){var n=Dt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Zg(n,pb,uv.DSI);for(var l in a)r[l]=a[l]}catch(g){if(t.WTF)throw g}var c=Dt.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var f=Zg(c,gb,uv.SI);for(var m in f)r[m]==null&&(r[m]=f[m])}catch(g){if(t.WTF)throw g}r.HeadingPairs&&r.TitlesOfParts&&(s1(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function W1(e,r){r||(r={}),dm(r),xx(),r.codepage&&W0(r.codepage);var t,n;if(e.FullPaths){if(Dt.find(e,"/encryption"))throw new Error("File is password-protected");t=Dt.find(e,"!CompObj"),n=Dt.find(e,"/Workbook")||Dt.find(e,"/Book")}else{switch(r.type){case"base64":e=Da(Gn(e));break;case"binary":e=Da(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Wr(e,0),n={content:e}}var a,l;if(t&&KC(t),r.bookProps&&!r.bookSheets)a={};else{var c=Nt?"buffer":"array";if(n&&n.content)a=XC(n.content,r);else if((l=Dt.find(e,"PerfectOffice_MAIN"))&&l.content)a=jc.to_workbook(l.content,(r.type=c,r));else if((l=Dt.find(e,"NativeContent_MAIN"))&&l.content)a=jc.to_workbook(l.content,(r.type=c,r));else throw(l=Dt.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Dt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=R2(e))}var f={};return e.FullPaths&&JC(e,f,r),a.Props=a.Custprops=f,r.bookFiles&&(a.cfb=e),a}var ef={0:{f:OE},1:{f:RE},2:{f:GE},3:{f:UE},4:{f:BE},5:{f:HE},6:{f:qE},7:{f:WE},8:{f:eC},9:{f:QE},10:{f:XE},11:{f:JE},12:{f:ME},13:{f:ZE},14:{f:$E},15:{f:zE},16:{f:M1},17:{f:YE},18:{f:VE},19:{f:em},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:CC},40:{},42:{},43:{f:XS},44:{f:YS},45:{f:JS},46:{f:e2},47:{f:QS},48:{},49:{f:tb},50:{},51:{f:w2},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:x1},62:{f:KE},63:{f:E2},64:{f:cC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:sn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:LE},148:{f:jE,p:16},151:{f:nC},152:{},153:{f:TC},154:{},155:{},156:{f:SC},157:{},158:{},159:{T:1,f:gS},160:{T:-1},161:{T:1,f:vo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:tC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:_2},336:{T:-1},337:{f:b2,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:p0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:v1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:aC},427:{f:iC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:oC},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:FE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:rC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:p0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:j2},633:{T:1},634:{T:-1},635:{T:1,f:O2},636:{T:-1},637:{f:nb},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:uC},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_0={6:{f:Gh},10:{f:ds},12:{f:_r},13:{f:_r},14:{f:pr},15:{f:pr},16:{f:rn},17:{f:pr},18:{f:pr},19:{f:_r},20:{f:Xg},21:{f:Xg},23:{f:v1},24:{f:Qg},25:{f:pr},26:{},27:{},28:{f:Dk},29:{},34:{f:pr},35:{f:Jg},38:{f:rn},39:{f:rn},40:{f:rn},41:{f:rn},42:{f:pr},43:{f:pr},47:{f:FS},49:{f:fk},51:{f:_r},60:{},61:{f:ck},64:{f:pr},65:{f:dk},66:{f:_r},77:{},80:{},81:{},82:{},85:{f:_r},89:{},90:{},91:{},92:{f:tk},93:{f:Ok},94:{},95:{f:pr},96:{},97:{},99:{f:pr},125:{f:x1},128:{f:bk},129:{f:rk},130:{f:_r},131:{f:pr},132:{f:pr},133:{f:nk},134:{},140:{f:Bk},141:{f:_r},144:{},146:{f:Uk},151:{},152:{},153:{},154:{},155:{},156:{f:_r},157:{},158:{},160:{f:Gk},161:{f:Wk},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:xk},190:{f:yk},193:{f:ds},197:{},198:{},199:{},200:{},201:{},202:{f:pr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:_r},220:{},221:{f:pr},222:{},224:{f:wk},225:{f:ek},226:{f:ds},227:{},229:{f:Ik},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ak},253:{f:hk},255:{f:ik},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:d1},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:pr},353:{f:ds},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Sk},431:{f:pr},432:{},433:{},434:{},437:{},438:{f:Lk},439:{f:pr},440:{f:Rk},441:{},442:{f:nu},443:{},444:{f:_r},445:{},446:{},448:{f:ds},449:{f:lk,r:2},450:{f:ds},512:{f:qg},513:{f:Hk},515:{f:kk},516:{f:mk},517:{f:Yg},519:{f:Zk},520:{f:sk},523:{},545:{f:ev},549:{f:Kg},566:{},574:{f:uk},638:{f:vk},659:{},1048:{},1054:{f:pk},1084:{},1212:{f:Ak},2048:{f:Mk},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:bd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ds},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:$k,r:12},2173:{f:x2,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:pr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Ck,r:12},2197:{},2198:{f:f2,r:12},2199:{},2200:{},2201:{},2202:{f:Pk,r:12},2203:{f:ds},2204:{},2205:{},2206:{},2207:{},2211:{f:ok},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:_r},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Vk},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:zk},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:qg},1:{},2:{f:Xk},3:{f:Yk},4:{f:qk},5:{f:Yg},7:{f:Jk},8:{},9:{f:bd},11:{},22:{f:_r},30:{f:gk},31:{},32:{},33:{f:ev},36:{},37:{f:Kg},50:{f:Qk},62:{},52:{},67:{},68:{f:_r},69:{},86:{},126:{},127:{f:Kk},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eS},223:{},234:{},354:{},421:{},518:{f:Gh},521:{f:bd},536:{f:Qg},547:{f:Jg},561:{},579:{},1030:{f:Gh},1033:{f:bd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ca(e,r,t,n){var a=r;if(!isNaN(a)){var l=(t||[]).length||0,c=e.next(4);c.write_shift(2,a),c.write_shift(2,l),l>0&&Jx(t)&&e.push(t)}}function dv(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=a.index,f=l&&l.index||e.length,m=kw(e.slice(c,f),/(:?<tr[^>]*>)/i,"<tr>"),g=-1,x=0,y=0,b=0,E={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(c=0;c<m.length;++c){var k=m[c].trim(),C=k.slice(0,3).toLowerCase();if(C=="<tr"){if(++g,t.sheetRows&&t.sheetRows<=g){--g;break}x=0;continue}if(!(C!="<td"&&C!="<th")){var R=k.split(/<\/t[dh]>/i);for(f=0;f<R.length;++f){var j=R[f].trim();if(j.match(/<t[dh]/i)){for(var N=j,F=0;N.charAt(0)=="<"&&(F=N.indexOf(">"))>-1;)N=N.slice(F+1);for(var K=0;K<S.length;++K){var z=S[K];z.s.c==x&&z.s.r<g&&g<=z.e.r&&(x=z.e.c+1,K=-1)}var O=gt(j.slice(0,j.indexOf(">")));b=O.colspan?+O.colspan:1,((y=+O.rowspan)>1||b>1)&&S.push({s:{r:g,c:x},e:{r:g+(y||1)-1,c:x+b-1}});var ne=O.t||O["data-t"]||"";if(!N.length){x+=b;continue}if(N=Bx(N),E.s.r>g&&(E.s.r=g),E.e.r<g&&(E.e.r=g),E.s.c>x&&(E.s.c=x),E.e.c<x&&(E.e.c=x),!N.length){x+=b;continue}var ee={t:"s",v:N};t.raw||!N.trim().length||ne=="s"||(N==="TRUE"?ee={t:"b",v:!0}:N==="FALSE"?ee={t:"b",v:!1}:isNaN(ja(N))?isNaN(Tl(N).getDate())||(ee={t:"d",v:zr(N)},t.cellDates||(ee={t:"n",v:yn(ee.v)}),ee.z=t.dateNF||kt[14]):ee={t:"n",v:ja(N)}),t.dense?(n[g]||(n[g]=[]),n[g][x]=ee):n[_t({r:g,c:x})]=ee,x+=b}}}}return n["!ref"]=It(E),S.length&&(n["!merges"]=S),n}function QC(e,r,t,n){for(var a=e["!merges"]||[],l=[],c=r.s.c;c<=r.e.c;++c){for(var f=0,m=0,g=0;g<a.length;++g)if(!(a[g].s.r>t||a[g].s.c>c)&&!(a[g].e.r<t||a[g].e.c<c)){if(a[g].s.r<t||a[g].s.c<c){f=-1;break}f=a[g].e.r-a[g].s.r+1,m=a[g].e.c-a[g].s.c+1;break}if(!(f<0)){var x=_t({r:t,c}),y=n.dense?(e[t]||[])[c]:e[x],b=y&&y.v!=null&&(y.h||q0(y.w||(Pi(y),y.w)||""))||"",E={};f>1&&(E.rowspan=f),m>1&&(E.colspan=m),n.editable?b='<span contenteditable="true">'+b+"</span>":y&&(E["data-t"]=y&&y.t||"z",y.v!=null&&(E["data-v"]=y.v),y.z!=null&&(E["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(b='<a href="'+y.l.Target+'">'+b+"</a>")),E.id=(n.id||"sjs")+"-"+x,l.push(Bw("td",b,E))}}var S="<tr>";return S+l.join("")+"</tr>"}var eA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tA="</body></html>";function rA(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Es(dv(t[0],r),r);var n=hm();return t.forEach(function(a,l){mm(n,dv(a,r),"Sheet"+(l+1))}),n}function nA(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function aA(e,r){var t=r||{},n=t.header!=null?t.header:eA,a=t.footer!=null?t.footer:tA,l=[n],c=Nl(e["!ref"]);t.dense=Array.isArray(e),l.push(nA(e,c,t));for(var f=c.s.r;f<=c.e.r;++f)l.push(QC(e,c,f,t));return l.push("</table>"+a),l.join("")}function V1(e,r,t){var n=t||{},a=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?vn(n.origin):n.origin;a=c.r,l=c.c}var f=r.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,f.length),g={s:{r:0,c:0},e:{r:a,c:l}};if(e["!ref"]){var x=Nl(e["!ref"]);g.s.r=Math.min(g.s.r,x.s.r),g.s.c=Math.min(g.s.c,x.s.c),g.e.r=Math.max(g.e.r,x.e.r),g.e.c=Math.max(g.e.c,x.e.c),a==-1&&(g.e.r=a=x.e.r+1)}var y=[],b=0,E=e["!rows"]||(e["!rows"]=[]),S=0,k=0,C=0,R=0,j=0,N=0;for(e["!cols"]||(e["!cols"]=[]);S<f.length&&k<m;++S){var F=f[S];if(fv(F)){if(n.display)continue;E[k]={hidden:!0}}var K=F.children;for(C=R=0;C<K.length;++C){var z=K[C];if(!(n.display&&fv(z))){var O=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):Bx(z.innerHTML),ne=z.getAttribute("data-z")||z.getAttribute("z");for(b=0;b<y.length;++b){var ee=y[b];ee.s.c==R+l&&ee.s.r<k+a&&k+a<=ee.e.r&&(R=ee.e.c+1-l,b=-1)}N=+z.getAttribute("colspan")||1,((j=+z.getAttribute("rowspan")||1)>1||N>1)&&y.push({s:{r:k+a,c:R+l},e:{r:k+a+(j||1)-1,c:R+l+(N||1)-1}});var ve={t:"s",v:O},he=z.getAttribute("data-t")||z.getAttribute("t")||"";O!=null&&(O.length==0?ve.t=he||"z":n.raw||O.trim().length==0||he=="s"||(O==="TRUE"?ve={t:"b",v:!0}:O==="FALSE"?ve={t:"b",v:!1}:isNaN(ja(O))?isNaN(Tl(O).getDate())||(ve={t:"d",v:zr(O)},n.cellDates||(ve={t:"n",v:yn(ve.v)}),ve.z=n.dateNF||kt[14]):ve={t:"n",v:ja(O)})),ve.z===void 0&&ne!=null&&(ve.z=ne);var ce="",Ne=z.getElementsByTagName("A");if(Ne&&Ne.length)for(var xe=0;xe<Ne.length&&!(Ne[xe].hasAttribute("href")&&(ce=Ne[xe].getAttribute("href"),ce.charAt(0)!="#"));++xe);ce&&ce.charAt(0)!="#"&&(ve.l={Target:ce}),n.dense?(e[k+a]||(e[k+a]=[]),e[k+a][R+l]=ve):e[_t({c:R+l,r:k+a})]=ve,g.e.c<R+l&&(g.e.c=R+l),R+=N}}++k}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),g.e.r=Math.max(g.e.r,k-1+a),e["!ref"]=It(g),k>=m&&(e["!fullref"]=It((g.e.r=f.length-S+k-1+a,g))),e}function H1(e,r){var t=r||{},n=t.dense?[]:{};return V1(n,e,r)}function iA(e,r){return Es(H1(e,r),r)}function fv(e){var r="",t=sA(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function sA(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function oA(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=jt(r.replace(/<[^>]*>/g,""));return[t]}var hv={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function G1(e,r){var t=r||{},n=Y0(e),a=[],l,c,f={name:""},m="",g=0,x,y,b={},E=[],S=t.dense?[]:{},k,C,R={value:""},j="",N=0,F=[],K=-1,z=-1,O={s:{r:1e6,c:1e7},e:{r:0,c:0}},ne=0,ee={},ve=[],he={},ce=0,Ne=0,xe=[],le=1,Q=1,M=[],V={Names:[]},H={},se=["",""],D=[],P={},I="",B=0,G=!1,te=!1,de=0;for(Hc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");k=Hc.exec(n);)switch(k[3]=k[3].replace(/_.*$/,"")){case"table":case"":k[1]==="/"?(O.e.c>=O.s.c&&O.e.r>=O.s.r?S["!ref"]=It(O):S["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=O.e.r&&(S["!fullref"]=S["!ref"],O.e.r=t.sheetRows-1,S["!ref"]=It(O)),ve.length&&(S["!merges"]=ve),xe.length&&(S["!rows"]=xe),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),E.push(x.name),b[x.name]=S,te=!1):k[0].charAt(k[0].length-2)!=="/"&&(x=gt(k[0],!1),K=z=-1,O.s.r=O.s.c=1e7,O.e.r=O.e.c=0,S=t.dense?[]:{},ve=[],xe=[],te=!0);break;case"table-row-group":k[1]==="/"?--ne:++ne;break;case"table-row":case"":if(k[1]==="/"){K+=le,le=1;break}if(y=gt(k[0],!1),y.?K=y.-1:K==-1&&(K=0),le=+y["number-rows-repeated"]||1,le<10)for(de=0;de<le;++de)ne>0&&(xe[K+de]={level:ne});z=-1;break;case"covered-table-cell":k[1]!=="/"&&++z,t.sheetStubs&&(t.dense?(S[K]||(S[K]=[]),S[K][z]={t:"z"}):S[_t({r:K,c:z})]={t:"z"}),j="",F=[];break;case"table-cell":case"":if(k[0].charAt(k[0].length-2)==="/")++z,R=gt(k[0],!1),Q=parseInt(R["number-columns-repeated"]||"1",10),C={t:"z",v:null},R.formula&&t.cellFormula!=!1&&(C.f=ov(jt(R.formula))),(R.||R["value-type"])=="string"&&(C.t="s",C.v=jt(R["string-value"]||""),t.dense?(S[K]||(S[K]=[]),S[K][z]=C):S[_t({r:K,c:z})]=C),z+=Q-1;else if(k[1]!=="/"){++z,j="",N=0,F=[],Q=1;var pe=le?K+le-1:K;if(z>O.e.c&&(O.e.c=z),z<O.s.c&&(O.s.c=z),K<O.s.r&&(O.s.r=K),pe>O.e.r&&(O.e.r=pe),R=gt(k[0],!1),D=[],P={},C={t:R.||R["value-type"],v:null},t.cellFormula)if(R.formula&&(R.formula=jt(R.formula)),R["number-matrix-columns-spanned"]&&R["number-matrix-rows-spanned"]&&(ce=parseInt(R["number-matrix-rows-spanned"],10)||0,Ne=parseInt(R["number-matrix-columns-spanned"],10)||0,he={s:{r:K,c:z},e:{r:K+ce-1,c:z+Ne-1}},C.F=It(he),M.push([he,C.F])),R.formula)C.f=ov(R.formula);else for(de=0;de<M.length;++de)K>=M[de][0].s.r&&K<=M[de][0].e.r&&z>=M[de][0].s.c&&z<=M[de][0].e.c&&(C.F=M[de][1]);switch((R["number-columns-spanned"]||R["number-rows-spanned"])&&(ce=parseInt(R["number-rows-spanned"],10)||0,Ne=parseInt(R["number-columns-spanned"],10)||0,he={s:{r:K,c:z},e:{r:K+ce-1,c:z+Ne-1}},ve.push(he)),R["number-columns-repeated"]&&(Q=parseInt(R["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=Jt(R["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(R.value);break;case"percentage":C.t="n",C.v=parseFloat(R.value);break;case"currency":C.t="n",C.v=parseFloat(R.value);break;case"date":C.t="d",C.v=zr(R["date-value"]),t.cellDates||(C.t="n",C.v=yn(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=_w(R["time-value"])/86400,t.cellDates&&(C.t="d",C.v=of(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(R.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",R["string-value"]!=null&&(j=jt(R["string-value"]),F=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(G=!1,C.t==="s"&&(C.v=j||"",F.length&&(C.R=F),G=N==0),H.Target&&(C.l=H),D.length>0&&(C.c=D,D=[]),j&&t.cellText!==!1&&(C.w=j),G&&(C.t="z",delete C.v),(!G||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=K))for(var me=0;me<le;++me){if(Q=parseInt(R["number-columns-repeated"]||"1",10),t.dense)for(S[K+me]||(S[K+me]=[]),S[K+me][z]=me==0?C:Vr(C);--Q>0;)S[K+me][z+Q]=Vr(C);else for(S[_t({r:K+me,c:z})]=C;--Q>0;)S[_t({r:K+me,c:z+Q})]=Vr(C);O.e.c<=z&&(O.e.c=z)}Q=parseInt(R["number-columns-repeated"]||"1",10),z+=Q-1,Q=0,C={},j="",F=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(k[1]==="/"){if((l=a.pop())[0]!==k[3])throw"Bad state: "+l}else k[0].charAt(k[0].length-2)!=="/"&&a.push([k[3],!0]);break;case"annotation":if(k[1]==="/"){if((l=a.pop())[0]!==k[3])throw"Bad state: "+l;P.t=j,F.length&&(P.R=F),P.a=I,D.push(P)}else k[0].charAt(k[0].length-2)!=="/"&&a.push([k[3],!1]);I="",B=0,j="",N=0,F=[];break;case"creator":k[1]==="/"?I=n.slice(B,k.index):B=k.index+k[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(k[1]==="/"){if((l=a.pop())[0]!==k[3])throw"Bad state: "+l}else k[0].charAt(k[0].length-2)!=="/"&&a.push([k[3],!1]);j="",N=0,F=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(k[1]==="/"){if(ee[f.name]=m,(l=a.pop())[0]!==k[3])throw"Bad state: "+l}else k[0].charAt(k[0].length-2)!=="/"&&(m="",f=gt(k[0],!1),a.push([k[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":c=gt(k[0],!1),m+=hv[k[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":c=gt(k[0],!1),m+=hv[k[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(k[0].slice(-2)==="/>")break;if(k[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(g,k.index);break}else g=k.index+k[0].length;break;case"named-range":c=gt(k[0],!1),se=Zh(c["cell-range-address"]);var ye={Name:c.name,Ref:se[0]+"!"+se[1]};te&&(ye.Sheet=E.length),V.Names.push(ye);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(k[1]==="/"&&(!R||!R["string-value"])){var Ke=oA(n.slice(N,k.index));j=(j.length>0?j+`
`:"")+Ke[0]}else gt(k[0],!1),N=k.index+k[0].length;break;case"s":break;case"database-range":if(k[1]==="/")break;try{se=Zh(gt(k[0])["target-range-address"]),b[se[0]]["!autofilter"]={ref:se[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(k[1]!=="/"){if(H=gt(k[0],!1),!H.href)break;H.Target=jt(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(se=Zh(H.Target.slice(1)),H.Target="#"+se[0]+"!"+se[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(k[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(k)}}var ae={Sheets:b,SheetNames:E,Workbook:V};return t.bookSheets&&delete ae.Sheets,ae}function mv(e,r){r=r||{},oa(e,"META-INF/manifest.xml")&&kb(yr(e,"META-INF/manifest.xml"),r);var t=Hn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=G1(Zt(t),r);return oa(e,"meta.xml")&&(n.Props=i1(yr(e,"meta.xml"))),n}function pv(e,r){return G1(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function cm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function w0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Zt(po(e))}function b0(e){var r=e.reduce(function(a,l){return a+l.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function gv(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function lA(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function qc(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function jr(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function nn(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=qc(e,t),l=a&7;a=Math.floor(a/8);var c=0,f;if(a==0)break;switch(l){case 0:{for(var m=t[0];e[t[0]++]>=128;);f=e.slice(m,t[0])}break;case 5:c=4,f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=qc(e,t),f=e.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(a," at offset ").concat(n))}var g={data:f,type:l};r[a]==null?r[a]=[g]:r[a].push(g)}return r}function um(e,r){return e?.map(function(t){return r(t.data)})||[]}function cA(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=qc(e,n),l=nn(e.slice(n[0],n[0]+a));n[0]+=a;var c={id:jr(l[1][0].data),messages:[]};l[2].forEach(function(f){var m=nn(f.data),g=jr(m[3][0].data);c.messages.push({meta:m,data:e.slice(n[0],n[0]+g)}),n[0]+=g}),(r=l[3])!=null&&r[0]&&(c.merge=jr(l[3][0].data)>>>0>0),t.push(c)}return t}function uA(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=qc(r,t),a=[];t[0]<r.length;){var l=r[t[0]]&3;if(l==0){var c=r[t[0]++]>>2;if(c<60)++c;else{var f=c-59;c=r[t[0]],f>1&&(c|=r[t[0]+1]<<8),f>2&&(c|=r[t[0]+2]<<16),f>3&&(c|=r[t[0]+3]<<24),c>>>=0,c++,t[0]+=f}a.push(r.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var m=0,g=0;if(l==1?(g=(r[t[0]]>>2&7)+4,m=(r[t[0]++]&224)<<3,m|=r[t[0]++]):(g=(r[t[0]++]>>2)+1,l==2?(m=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(m=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[b0(a)],m==0)throw new Error("Invalid offset 0");if(m>a[0].length)throw new Error("Invalid offset beyond length");if(g>=m)for(a.push(a[0].slice(-m)),g-=m;g>=a[a.length-1].length;)a.push(a[a.length-1]),g-=a[a.length-1].length;a.push(a[0].slice(-m,-m+g))}}var x=b0(a);if(x.length!=n)throw new Error("Unexpected length: ".concat(x.length," != ").concat(n));return x}function dA(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(uA(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return b0(r)}function fA(e,r,t,n){var a=cm(e),l=a.getUint32(4,!0),c=(n>1?12:8)+gv(l&(n>1?3470:398))*4,f=-1,m=-1,g=NaN,x=new Date(2001,0,1);l&512&&(f=a.getUint32(c,!0),c+=4),c+=gv(l&(n>1?12288:4096))*4,l&16&&(m=a.getUint32(c,!0),c+=4),l&32&&(g=a.getFloat64(c,!0),c+=8),l&64&&(x.setTime(x.getTime()+a.getFloat64(c,!0)*1e3),c+=8);var y;switch(e[2]){case 0:break;case 2:y={t:"n",v:g};break;case 3:y={t:"s",v:r[m]};break;case 5:y={t:"d",v:x};break;case 6:y={t:"b",v:g>0};break;case 7:y={t:"n",v:g/86400};break;case 8:y={t:"e",v:0};break;case 9:if(f>-1)y={t:"s",v:t[f]};else if(m>-1)y={t:"s",v:r[m]};else if(!isNaN(g))y={t:"n",v:g};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return y}function hA(e,r,t){var n=cm(e),a=n.getUint32(8,!0),l=12,c=-1,f=-1,m=NaN,g=NaN,x=new Date(2001,0,1);a&1&&(m=lA(e,l),l+=16),a&2&&(g=n.getFloat64(l,!0),l+=8),a&4&&(x.setTime(x.getTime()+n.getFloat64(l,!0)*1e3),l+=8),a&8&&(f=n.getUint32(l,!0),l+=4),a&16&&(c=n.getUint32(l,!0),l+=4);var y;switch(e[1]){case 0:break;case 2:y={t:"n",v:m};break;case 3:y={t:"s",v:r[f]};break;case 5:y={t:"d",v:x};break;case 6:y={t:"b",v:g>0};break;case 7:y={t:"n",v:g/86400};break;case 8:y={t:"e",v:0};break;case 9:if(c>-1)y={t:"s",v:t[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:y={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return y}function mA(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return fA(e,r,t,e[0]);case 5:return hA(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ks(e){var r=nn(e);return qc(r[1][0].data)}function vv(e,r){var t=nn(r.data),n=jr(t[1][0].data),a=t[3],l=[];return(a||[]).forEach(function(c){var f=nn(c.data),m=jr(f[1][0].data)>>>0;switch(n){case 1:l[m]=w0(f[3][0].data);break;case 8:{var g=e[ks(f[9][0].data)][0],x=nn(g.data),y=e[ks(x[1][0].data)][0],b=jr(y.meta[1][0].data);if(b!=2001)throw new Error("2000 unexpected reference to ".concat(b));var E=nn(y.data);l[m]=E[3].map(function(S){return w0(S.data)}).join("")}break}}),l}function pA(e,r){var t,n,a,l,c,f,m,g,x,y,b,E,S,k,C=nn(e),R=jr(C[1][0].data)>>>0,j=jr(C[2][0].data)>>>0,N=((n=(t=C[8])==null?void 0:t[0])==null?void 0:n.data)&&jr(C[8][0].data)>0||!1,F,K;if((l=(a=C[7])==null?void 0:a[0])!=null&&l.data&&r!=0)F=(f=(c=C[7])==null?void 0:c[0])==null?void 0:f.data,K=(g=(m=C[6])==null?void 0:m[0])==null?void 0:g.data;else if((y=(x=C[4])==null?void 0:x[0])!=null&&y.data&&r!=1)F=(E=(b=C[4])==null?void 0:b[0])==null?void 0:E.data,K=(k=(S=C[3])==null?void 0:S[0])==null?void 0:k.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var z=N?4:1,O=cm(F),ne=[],ee=0;ee<F.length/2;++ee){var ve=O.getUint16(ee*2,!0);ve<65535&&ne.push([ee,ve])}if(ne.length!=j)throw"Expected ".concat(j," cells, found ").concat(ne.length);var he=[];for(ee=0;ee<ne.length-1;++ee)he[ne[ee][0]]=K.subarray(ne[ee][1]*z,ne[ee+1][1]*z);return ne.length>=1&&(he[ne[ne.length-1][0]]=K.subarray(ne[ne.length-1][1]*z)),{R,cells:he}}function gA(e,r){var t,n=nn(r.data),a=(t=n?.[7])!=null&&t[0]?jr(n[7][0].data)>>>0>0?1:0:-1,l=um(n[5],function(c){return pA(c,a)});return{nrows:jr(n[4][0].data)>>>0,data:l.reduce(function(c,f){return c[f.R]||(c[f.R]=[]),f.cells.forEach(function(m,g){if(c[f.R][g])throw new Error("Duplicate cell r=".concat(f.R," c=").concat(g));c[f.R][g]=m}),c},[])}}function vA(e,r,t){var n,a=nn(r.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(jr(a[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(l.e.c=(jr(a[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=It(l);var c=nn(a[4][0].data),f=vv(e,e[ks(c[4][0].data)][0]),m=(n=c[17])!=null&&n[0]?vv(e,e[ks(c[17][0].data)][0]):[],g=nn(c[3][0].data),x=0;g[1].forEach(function(y){var b=nn(y.data),E=e[ks(b[2][0].data)][0],S=jr(E.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var k=gA(e,E);k.data.forEach(function(C,R){C.forEach(function(j,N){var F=_t({r:x+R,c:N}),K=mA(j,f,m);K&&(t[F]=K)})}),x+=k.nrows})}function xA(e,r){var t=nn(r.data),n={"!ref":"A1"},a=e[ks(t[2][0].data)],l=jr(a[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return vA(e,a[0],n),n}function yA(e,r){var t,n=nn(r.data),a={name:(t=n[1])!=null&&t[0]?w0(n[1][0].data):"",sheets:[]},l=um(n[2],ks);return l.forEach(function(c){e[c].forEach(function(f){var m=jr(f.meta[1][0].data);m==6e3&&a.sheets.push(xA(e,f))})}),a}function _A(e,r){var t=hm(),n=nn(r.data),a=um(n[1],ks);if(a.forEach(function(l){e[l].forEach(function(c){var f=jr(c.meta[1][0].data);if(f==2){var m=yA(e,c);m.sheets.forEach(function(g,x){mm(t,g,x==0?m.name:m.name+"_"+x,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function qh(e){var r,t,n,a,l={},c=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var g;try{g=dA(m.content)}catch(y){return console.log("?? "+m.content.length+" "+(y.message||y))}var x;try{x=cA(g)}catch(y){return console.log("## "+(y.message||y))}x.forEach(function(y){l[y.id]=y.messages,c.push(y.id)})}}),!c.length)throw new Error("File has no messages");var f=((a=(n=(t=(r=l?.[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&jr(l[1][0].meta[1][0].data)==1&&l[1][0];if(f||c.forEach(function(m){l[m].forEach(function(g){var x=jr(g.meta[1][0].data)>>>0;if(x==1)if(!f)f=g;else throw new Error("Document has multiple roots")})}),!f)throw new Error("Cannot find Document root");return _A(l,f)}function wA(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function dm(e){wA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function bA(e){return _l.WS.indexOf(e)>-1?"sheet":e==_l.CS?"chart":e==_l.DS?"dialog":e==_l.MS?"macro":e&&e.length?e:"sheet"}function kA(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,bA(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function SA(e,r,t,n,a,l,c,f,m,g,x,y){try{l[n]=Ic(Hn(e,t,!0),r);var b=yr(e,r),E;switch(f){case"sheet":E=NC(b,r,a,m,l[n],g,x,y);break;case"chart":if(E=DC(b,r,a,m,l[n],g,x,y),!E||!E["!drawel"])break;var S=Tc(E["!drawel"].Target,r),k=g0(S),C=P2(Hn(e,S,!0),Ic(Hn(e,k,!0),S)),R=Tc(C,S),j=g0(R);E=hC(Hn(e,R,!0),R,m,Ic(Hn(e,j,!0),R),g,E);break;case"macro":E=IC(b,r,a,m,l[n],g,x,y);break;case"dialog":E=OC(b,r,a,m,l[n],g,x,y);break;default:throw new Error("Unrecognized sheet type "+f)}c[n]=E;var N=[];l&&l[n]&&Xa(l[n]).forEach(function(F){var K="";if(l[n][F].Type==_l.CMNT){K=Tc(l[n][F].Target,r);var z=RC(yr(e,K,!0),K,m);if(!z||!z.length)return;rv(E,z,!1)}l[n][F].Type==_l.TCMNT&&(K=Tc(l[n][F].Target,r),N=N.concat(D2(yr(e,K,!0),m)))}),N&&N.length&&rv(E,N,!0,m.people||[])}catch(F){if(m.WTF)throw F}}function ia(e){return e.charAt(0)=="/"?e.slice(1):e}function TA(e,r){if(Nx(),r=r||{},dm(r),oa(e,"META-INF/manifest.xml")||oa(e,"objectdata.xml"))return mv(e,r);if(oa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof qh<"u"){if(e.FileIndex)return qh(e);var t=Dt.utils.cfb_new();return Pg(e).forEach(function(xe){Ew(t,xe,Tw(e,xe))}),qh(t)}throw new Error("Unsupported NUMBERS file")}if(!oa(e,"[Content_Types].xml"))throw oa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):oa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Pg(e),a=wb(Hn(e,"[Content_Types].xml")),l=!1,c,f;if(a.workbooks.length===0&&(f="xl/workbook.xml",yr(e,f,!0)&&a.workbooks.push(f)),a.workbooks.length===0){if(f="xl/workbook.bin",!yr(e,f,!0))throw new Error("Could not find workbook");a.workbooks.push(f),l=!0}a.workbooks[0].slice(-3)=="bin"&&(l=!0);var m={},g={};if(!r.bookSheets&&!r.bookProps){if(Fc=[],a.sst)try{Fc=LC(yr(e,ia(a.sst)),a.sst,r)}catch(xe){if(r.WTF)throw xe}r.cellStyles&&a.themes.length&&(m=FC(Hn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(g=jC(yr(e,ia(a.style)),a.style,m,r))}a.links.map(function(xe){try{var le=Ic(Hn(e,g0(ia(xe))),xe);return BC(yr(e,ia(xe)),le,xe,r)}catch{}});var x=PC(yr(e,ia(a.workbooks[0])),a.workbooks[0],r),y={},b="";a.coreprops.length&&(b=yr(e,ia(a.coreprops[0]),!0),b&&(y=i1(b)),a.extprops.length!==0&&(b=yr(e,ia(a.extprops[0]),!0),b&&Eb(b,y,r)));var E={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(b=Hn(e,ia(a.custprops[0]),!0),b&&(E=Ab(b,r)));var S={};if((r.bookSheets||r.bookProps)&&(x.Sheets?c=x.Sheets.map(function(le){return le.name}):y.Worksheets&&y.SheetNames.length>0&&(c=y.SheetNames),r.bookProps&&(S.Props=y,S.Custprops=E),r.bookSheets&&typeof c<"u"&&(S.SheetNames=c),r.bookSheets?S.SheetNames:r.bookProps))return S;c={};var k={};r.bookDeps&&a.calcchain&&(k=MC(yr(e,ia(a.calcchain)),a.calcchain));var C=0,R={},j,N;{var F=x.Sheets;y.Worksheets=F.length,y.SheetNames=[];for(var K=0;K!=F.length;++K)y.SheetNames[K]=F[K].name}var z=l?"bin":"xml",O=a.workbooks[0].lastIndexOf("/"),ne=(a.workbooks[0].slice(0,O+1)+"_rels/"+a.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");oa(e,ne)||(ne="xl/_rels/workbook."+z+".rels");var ee=Ic(Hn(e,ne,!0),ne.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=zC(yr(e,ia(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=I2(yr(e,ia(a.people[0])),r)),ee&&(ee=kA(ee,x.Sheets));var ve=yr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=y.Worksheets;++C){var he="sheet";if(ee&&ee[C]?(j="xl/"+ee[C][1].replace(/[\/]?xl\//,""),oa(e,j)||(j=ee[C][1]),oa(e,j)||(j=ne.replace(/_rels\/.*$/,"")+ee[C][1]),he=ee[C][2]):(j="xl/worksheets/sheet"+(C+1-ve)+"."+z,j=j.replace(/sheet0\./,"sheet.")),N=j.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(C!=r.sheets)continue e;break;case"string":if(y.SheetNames[C].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var ce=!1,Ne=0;Ne!=r.sheets.length;++Ne)typeof r.sheets[Ne]=="number"&&r.sheets[Ne]==C&&(ce=1),typeof r.sheets[Ne]=="string"&&r.sheets[Ne].toLowerCase()==y.SheetNames[C].toLowerCase()&&(ce=1);if(!ce)continue e}}SA(e,j,N,y.SheetNames[C],C,R,c,he,r,x,m,g)}return S={Directory:a,Workbook:x,Props:y,Custprops:E,Deps:k,Sheets:c,SheetNames:y.SheetNames,Strings:Fc,Styles:g,Themes:m,SSF:Vr(kt)},r&&r.bookFiles&&(e.files?(S.keys=n,S.files=e.files):(S.keys=[],S.files={},e.FullPaths.forEach(function(xe,le){xe=xe.replace(/^Root Entry[\/]/,""),S.keys.push(xe),S.files[xe]=e.FileIndex[le]}))),r&&r.bookVBA&&(a.vba.length>0?S.vbaraw=yr(e,ia(a.vba[0]),!0):a.defaults&&a.defaults.bin===L2&&(S.vbaraw=yr(e,"xl/vbaProject.bin",!0))),S}function EA(e,r){var t=r||{},n="Workbook",a=Dt.find(e,n);try{if(n="/!DataSpaces/Version",a=Dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(xS(a.content),n="/!DataSpaces/DataSpaceMap",a=Dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=_S(a.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=wS(a.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);kS(a.content)}catch{}if(n="/EncryptionInfo",a=Dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var f=SS(a.content);if(n="/EncryptedPackage",a=Dt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(f[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(f[1],a.content,t.password||"",t);if(f[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(f[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function fm(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Gn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function CA(e,r){return Dt.find(e,"EncryptedPackage")?EA(e,r):W1(e,r)}function AA(e,r){var t,n=e,a=r||{};return a.type||(a.type=Nt&&Buffer.isBuffer(e)?"buffer":"base64"),t=Lx(n,a),TA(t,a)}function Z1(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return y0(e.slice(t),r);default:break e}return Gc.to_workbook(e,r)}function PA(e,r){var t="",n=fm(e,r);switch(r.type){case"base64":t=Gn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=fo(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Zt(t)),r.type="binary",Z1(t,r)}function NA(e,r){var t=e;return r.type=="base64"&&(t=Gn(t)),t=$c.utils.decode(1200,t.slice(2),"str"),r.type="binary",Z1(t,r)}function DA(e){return e.match(/[^\x00-\x7F]/)?Ec(e):e}function Yh(e,r,t,n){return n?(t.type="string",Gc.to_workbook(e,t)):Gc.to_workbook(r,t)}function k0(e,r){xx();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return k0(new Uint8Array(e),(t=Vr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],l=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),kl={},t.dateNF&&(kl.dateNF=t.dateNF),t.type||(t.type=Nt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Nt?"buffer":"binary",n=xw(e),typeof Uint8Array<"u"&&!Nt&&(t.type="array")),t.type=="string"&&(l=!0,t.type="binary",t.codepage=65001,n=DA(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),f=new Uint8Array(c);if(f.foo="bar",!f.foo)return t=Vr(t),t.type="array",k0(V0(n),t)}switch((a=fm(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return CA(Dt.read(n,t),t);break;case 9:if(a[1]<=8)return W1(n,t);break;case 60:return y0(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return iS(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return nS.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?AA(n,t):Yh(e,n,t,l);case 239:return a[3]===60?y0(n,t):Yh(e,n,t,l);case 255:if(a[1]===254)return NA(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return jc.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return jc.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return tv.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return LS.to_workbook(n,t);break;case 10:case 13:case 32:return PA(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tS.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?tv.to_workbook(n,t):Yh(e,n,t,l)}function IA(e,r,t,n,a,l,c,f){var m=Hr(t),g=f.defval,x=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),y=!0,b=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(b,"__rowNum__",{value:t,enumerable:!1})}catch{b.__rowNum__=t}else b.__rowNum__=t;if(!c||e[t])for(var E=r.s.c;E<=r.e.c;++E){var S=c?e[t][E]:e[n[E]+m];if(S===void 0||S.t===void 0){if(g===void 0)continue;l[E]!=null&&(b[l[E]]=g);continue}var k=S.v;switch(S.t){case"z":if(k==null)break;continue;case"e":k=k==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(l[E]!=null){if(k==null)if(S.t=="e"&&k===null)b[l[E]]=null;else if(g!==void 0)b[l[E]]=g;else if(x&&k===null)b[l[E]]=null;else continue;else b[l[E]]=x&&(S.t!=="n"||S.t==="n"&&f.rawNumbers!==!1)?k:Pi(S,k,f);k!=null&&(y=!1)}}return{row:b,isempty:y}}function S0(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,l=[],c=0,f="",m={s:{r:0,c:0},e:{r:0,c:0}},g=r||{},x=g.range!=null?g.range:e["!ref"];switch(g.header===1?n=1:g.header==="A"?n=2:Array.isArray(g.header)?n=3:g.header==null&&(n=0),typeof x){case"string":m=ur(x);break;case"number":m=ur(e["!ref"]),m.s.r=x;break;default:m=x}n>0&&(a=0);var y=Hr(m.s.r),b=[],E=[],S=0,k=0,C=Array.isArray(e),R=m.s.r,j=0,N={};C&&!e[R]&&(e[R]=[]);var F=g.skipHidden&&e["!cols"]||[],K=g.skipHidden&&e["!rows"]||[];for(j=m.s.c;j<=m.e.c;++j)if(!(F[j]||{}).hidden)switch(b[j]=Or(j),t=C?e[R][j]:e[b[j]+y],n){case 1:l[j]=j-m.s.c;break;case 2:l[j]=b[j];break;case 3:l[j]=g.header[j-m.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),f=c=Pi(t,null,g),k=N[c]||0,!k)N[c]=1;else{do f=c+"_"+k++;while(N[f]);N[c]=k,N[f]=1}l[j]=f}for(R=m.s.r+a;R<=m.e.r;++R)if(!(K[R]||{}).hidden){var z=IA(e,m,R,b,n,l,C,g);(z.isempty===!1||(n===1?g.blankrows!==!1:g.blankrows))&&(E[S++]=z.row)}return E.length=S,E}var xv=/"/g;function OA(e,r,t,n,a,l,c,f){for(var m=!0,g=[],x="",y=Hr(t),b=r.s.c;b<=r.e.c;++b)if(n[b]){var E=f.dense?(e[t]||[])[b]:e[n[b]+y];if(E==null)x="";else if(E.v!=null){m=!1,x=""+(f.rawNumbers&&E.t=="n"?E.v:Pi(E,null,f));for(var S=0,k=0;S!==x.length;++S)if((k=x.charCodeAt(S))===a||k===l||k===34||f.forceQuotes){x='"'+x.replace(xv,'""')+'"';break}x=="ID"&&(x='"ID"')}else E.f!=null&&!E.F?(m=!1,x="="+E.f,x.indexOf(",")>=0&&(x='"'+x.replace(xv,'""')+'"')):x="";g.push(x)}return f.blankrows===!1&&m?null:g.join(c)}function K1(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=ur(e["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),f=n.RS!==void 0?n.RS:`
`,m=f.charCodeAt(0),g=new RegExp((l=="|"?"\\|":l)+"+$"),x="",y=[];n.dense=Array.isArray(e);for(var b=n.skipHidden&&e["!cols"]||[],E=n.skipHidden&&e["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(b[S]||{}).hidden||(y[S]=Or(S));for(var k=0,C=a.s.r;C<=a.e.r;++C)(E[C]||{}).hidden||(x=OA(e,a,C,y,c,m,l,n),x!=null&&(n.strip&&(x=x.replace(g,"")),(x||n.blankrows!==!1)&&t.push((k++?f:"")+x)));return delete n.dense,t.join("")}function jA(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=K1(e,r);return t}function FA(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=ur(e["!ref"]),l="",c=[],f,m=[],g=Array.isArray(e);for(f=a.s.c;f<=a.e.c;++f)c[f]=Or(f);for(var x=a.s.r;x<=a.e.r;++x)for(l=Hr(x),f=a.s.c;f<=a.e.c;++f)if(r=c[f]+l,t=g?(e[x]||[])[f]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}m[m.length]=r+"="+n}return m}function q1(e,r,t){var n=t||{},a=+!n.skipHeader,l=e||{},c=0,f=0;if(l&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var m=typeof n.origin=="string"?vn(n.origin):n.origin;c=m.r,f=m.c}var g,x={s:{c:0,r:0},e:{c:f,r:c+r.length-1+a}};if(l["!ref"]){var y=ur(l["!ref"]);x.e.c=Math.max(x.e.c,y.e.c),x.e.r=Math.max(x.e.r,y.e.r),c==-1&&(c=y.e.r+1,x.e.r=c+r.length-1+a)}else c==-1&&(c=0,x.e.r=r.length-1+a);var b=n.header||[],E=0;r.forEach(function(k,C){Xa(k).forEach(function(R){(E=b.indexOf(R))==-1&&(b[E=b.length]=R);var j=k[R],N="z",F="",K=_t({c:f+E,r:c+C+a});g=Yc(l,K),j&&typeof j=="object"&&!(j instanceof Date)?l[K]=j:(typeof j=="number"?N="n":typeof j=="boolean"?N="b":typeof j=="string"?N="s":j instanceof Date?(N="d",n.cellDates||(N="n",j=yn(j)),F=n.dateNF||kt[14]):j===null&&n.nullError&&(N="e",j=0),g?(g.t=N,g.v=j,delete g.w,delete g.R,F&&(g.z=F)):l[K]=g={t:N,v:j},F&&(g.z=F))})}),x.e.c=Math.max(x.e.c,f+b.length-1);var S=Hr(c);if(a)for(E=0;E<b.length;++E)l[Or(E+f)+S]={t:"s",v:b[E]};return l["!ref"]=It(x),l}function LA(e,r){return q1(null,e,r)}function Yc(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=vn(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Yc(e,_t(r)):Yc(e,_t({r,c:t||0}))}function RA(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function hm(){return{SheetNames:[],Sheets:{}}}function mm(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);a=l&&+l[2]||0;var c=l&&l[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=c+a)!=-1;++a);}if(wC(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function MA(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=RA(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function BA(e,r){return e.z=r,e}function Y1(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function zA(e,r,t){return Y1(e,"#"+r,t)}function UA(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function $A(e,r,t,n){for(var a=typeof r!="string"?r:ur(r),l=typeof r=="string"?r:It(r),c=a.s.r;c<=a.e.r;++c)for(var f=a.s.c;f<=a.e.c;++f){var m=Yc(e,c,f);m.t="n",m.F=l,delete m.v,c==a.s.r&&f==a.s.c&&(m.f=t,n&&(m.D=!0))}return e}var WA={encode_col:Or,encode_row:Hr,encode_cell:_t,encode_range:It,decode_col:Q0,decode_row:J0,split_cell:eb,decode_cell:vn,decode_range:Nl,format_cell:Pi,sheet_add_aoa:e1,sheet_add_json:q1,sheet_add_dom:V1,aoa_to_sheet:Dl,json_to_sheet:LA,table_to_sheet:H1,table_to_book:iA,sheet_to_csv:K1,sheet_to_txt:jA,sheet_to_json:S0,sheet_to_html:aA,sheet_to_formulae:FA,sheet_to_row_object_array:S0,sheet_get_cell:Yc,book_new:hm,book_append_sheet:mm,book_set_sheet_visibility:MA,cell_set_number_format:BA,cell_set_hyperlink:Y1,cell_set_internal_link:zA,cell_add_comment:UA,sheet_set_array_formula:$A,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Ti({isLoading:e=!1,loadingText:r="Loading...",children:t,disabled:n,...a}){return u.jsxs("button",{...a,disabled:n||e,className:`${a.className||""} ${e?"btn-loading":""}`.trim(),children:[e&&u.jsx("span",{className:"loading-spinner","aria-hidden":"true",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"spinner-icon",children:u.jsx("circle",{cx:"8",cy:"8",r:"6",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"37.7",strokeDashoffset:"37.7"})})}),u.jsx("span",{className:e?"loading-text":"",children:e?r:t})]})}function VA({size:e="md",text:r,className:t=""}){const a={sm:"16",md:"24",lg:"32"}[e];return u.jsxs("div",{className:`loading-spinner-container ${t}`,children:[u.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",className:"loading-spinner-icon",children:u.jsx("circle",{cx:"12",cy:"12",r:"9",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"56.5",strokeDashoffset:"56.5"})}),r&&u.jsx("span",{className:"loading-text",children:r})]})}function X1({onImported:e}){const[r,t]=Y.useState(!1),[n,a]=Y.useState(!1),l=Y.useRef(null),c=Y.useRef(!1),f=async y=>{if(!(!y||c.current)){c.current=!0,t(!0);try{const b=await y.arrayBuffer(),E=k0(b,{type:"array"}),S=E.Sheets[E.SheetNames[0]],k=WA.sheet_to_json(S,{header:1});if(!k.length){alert(" File appears to be empty. Please check your Excel file.");return}const C=(k[0]||[]).map(ee=>String(ee??"").trim().toLowerCase());let R=C.findIndex(ee=>ee.includes("address"));R===-1&&(R=0);const j=C.findIndex(ee=>ee==="lat"||ee.includes("latitude")),N=C.findIndex(ee=>ee==="lng"||ee==="lon"||ee.includes("longitude")),F=j===-1?void 0:j,K=N===-1?void 0:N,z=[];for(let ee=1;ee<k.length;ee++){const ve=k[ee]||[],he=String(ve[R]??"").trim();if(!he)continue;const ce=F!==void 0&&ve[F]!=null&&ve[F]!==""?yv(ve[F]):void 0,Ne=K!==void 0&&ve[K]!=null&&ve[K]!==""?yv(ve[K]):void 0;z.push({address:he,lat:ce,lng:Ne})}if(z.length===0){alert(" No valid addresses found in the file. Please check the format.");return}e(z);const O=z.some(ee=>ee.lat!=null&&ee.lng!=null),ne=` Successfully imported ${z.length} address${z.length===1?"":"es"}${O?" with GPS coordinates":""}!`;console.log(ne)}catch(b){console.error(b),alert(" Failed to read Excel file. Please ensure it's a valid .xlsx or .xls file.")}finally{c.current=!1,t(!1),l.current&&(l.current.value="")}}},m=async y=>{if(c.current)return;const b=y.target.files?.[0];b&&await f(b)},g=y=>{y.preventDefault(),y.stopPropagation(),y.type==="dragenter"||y.type==="dragover"?a(!0):y.type==="dragleave"&&a(!1)},x=async y=>{if(y.preventDefault(),y.stopPropagation(),c.current)return;a(!1);const E=Array.from(y.dataTransfer.files).find(S=>S.name.endsWith(".xlsx")||S.name.endsWith(".xls")||S.type.includes("spreadsheet"));E?await f(E):alert(" Please drop an Excel file (.xlsx or .xls)")};return u.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:"0.75rem",flex:1},children:[u.jsx("input",{ref:l,type:"file",accept:".xlsx,.xls",onChange:m,className:"file-input",id:"excel-input",disabled:r,style:{display:"none"}}),u.jsx(Ti,{className:"btn btn-primary",onClick:()=>l.current?.click(),isLoading:r,loadingText:"Processing...",disabled:r,style:{whiteSpace:"nowrap"},children:" Import Excel"}),u.jsx("div",{onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:x,className:"btn btn-ghost",style:{border:`2px dashed ${n?"var(--primary)":"var(--border-light)"}`,background:n?"var(--primary-light)":"transparent",color:n?"var(--primary-dark)":"var(--text-muted)",fontSize:"0.875rem",textAlign:"center",cursor:"pointer",transition:"all var(--transition-fast)",userSelect:"none",minWidth:"140px",flex:1,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>l.current?.click(),children:n?u.jsx("span",{children:" Drop Excel file here"}):u.jsx("span",{children:" Or drag & drop Excel"})})]})}function yv(e){const r=Number(e);return Number.isFinite(r)?r:void 0}function ou(e){return new Promise((r,t)=>{e.oncomplete=e.onsuccess=()=>r(e.result),e.onabort=e.onerror=()=>t(e.error)})}function J1(e,r){let t;const n=()=>{if(t)return t;const a=indexedDB.open(e);return a.onupgradeneeded=()=>a.result.createObjectStore(r),t=ou(a),t.then(l=>{l.onclose=()=>t=void 0},()=>{}),t};return(a,l)=>n().then(c=>l(c.transaction(r,a).objectStore(r)))}let Xh;function pm(){return Xh||(Xh=J1("keyval-store","keyval")),Xh}function gm(e,r=pm()){return r("readonly",t=>ou(t.get(e)))}function vm(e,r,t=pm()){return t("readwrite",n=>(n.put(r,e),ou(n.transaction)))}function HA(e=pm()){return e("readwrite",r=>(r.clear(),ou(r.transaction)))}const GA=Object.freeze(Object.defineProperty({__proto__:null,clear:HA,createStore:J1,get:gm,promisifyRequest:ou,set:vm},Symbol.toStringTag,{value:"Module"})),ZA=["password","token","secret","apiKey","api_key","accessToken","refreshToken","sessionId","ssn","creditCard","cvv","pin","privateKey"];function T0(e){if(e==null||typeof e!="object")return e;if(Array.isArray(e))return e.map(t=>T0(t));const r={};for(const[t,n]of Object.entries(e)){const a=t.toLowerCase();ZA.some(c=>a.includes(c.toLowerCase()))?r[t]="[REDACTED]":typeof n=="object"&&n!==null?r[t]=T0(n):r[t]=n}return r}function _v(e){return e.map(r=>typeof r=="object"&&r!==null?T0(r):r)}const be={debug:(e,...r)=>{},info:(e,...r)=>{},warn:(e,...r)=>{console.warn(`[WARN] ${e}`,..._v(r))},error:(e,...r)=>{console.error(`[ERROR] ${e}`,..._v(r))},success:(e,...r)=>{},sync:(e,...r)=>{},time:e=>{},timeEnd:e=>{},group:e=>{},groupEnd:()=>{}};class KA{toasts=[];listeners=[];timeouts=new Map;show(r,t="info",n=4e3){const a={id:`toast_${Date.now()}_${Math.random().toString(36).slice(2)}`,message:r,type:t,timestamp:Date.now(),duration:n};if(this.toasts.push(a),this.notifyListeners(),n>0){const l=setTimeout(()=>{this.remove(a.id)},n);this.timeouts.set(a.id,l)}return a.id}remove(r){const t=this.timeouts.get(r);t&&(clearTimeout(t),this.timeouts.delete(r)),this.toasts=this.toasts.filter(n=>n.id!==r),this.notifyListeners()}clear(){this.timeouts.forEach(r=>clearTimeout(r)),this.timeouts.clear(),this.toasts=[],this.notifyListeners()}getToasts(){return[...this.toasts]}subscribe(r){return this.listeners.push(r),()=>{this.listeners=this.listeners.filter(t=>t!==r)}}notifyListeners(){this.listeners.forEach(r=>r([...this.toasts]))}}const Xc=new KA,Sl=(e,r)=>Xc.show(e,"error",r),Mc=(e,r)=>Xc.show(e,"warning",r),qA=(e,r)=>Xc.show(e,"info",r);class YA{queue=[];processing=!1;persistenceGranted=!1;constructor(){this.initializePersistence()}async initializePersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const r=await navigator.storage.persist();if(this.persistenceGranted=r,r?be.info(" Persistent storage granted - data protected from eviction"):(be.warn(" Persistent storage denied - data may be evicted by browser"),Mc("Storage persistence not granted. Your data may be lost if browser storage is full.",8e3)),"estimate"in navigator.storage){const t=await navigator.storage.estimate(),n=Math.round((t.usage||0)/1024/1024),a=Math.round((t.quota||0)/1024/1024);be.info(` Storage: ${n}MB used / ${a}MB quota`),t.usage&&t.quota&&t.usage>t.quota*.8&&(be.warn(" Storage quota 80% full - may cause data loss"),Mc("Storage is 80% full. Consider clearing old data to prevent loss.",1e4))}}else be.warn(" Storage persistence API not available")}catch(r){be.error("Failed to initialize storage persistence:",r)}}async queuedSet(r,t){return new Promise((n,a)=>{this.queue.push({key:r,data:t,resolve:n,reject:a}),this.processQueue()})}async processQueue(){if(!(this.processing||this.queue.length===0)){for(this.processing=!0;this.queue.length>0;){const r=this.queue.shift();try{let t=3,n;for(;t>0;)try{await vm(r.key,r.data),r.resolve(void 0);break}catch(a){n=a,t--,t>0&&(be.warn(`IndexedDB write failed, retrying... (${3-t}/3)`,a),await new Promise(l=>setTimeout(l,100*(4-t))))}t===0&&(be.error("IndexedDB write failed after 3 retries:",n),Sl("Failed to save data. Please check your browser storage settings.",1e4),r.reject(n))}catch(t){be.error("Storage queue operation failed:",t),r.reject(t)}}this.processing=!1}}async queuedGet(r){try{return await this.checkStorageHealth(),await gm(r)}catch(t){throw be.error("IndexedDB read failed:",t),Sl("Failed to load data from storage. Please refresh the page.",1e4),t}}async checkStorageHealth(){try{if("storage"in navigator&&"estimate"in navigator.storage){const r=await navigator.storage.estimate();if(r.usage&&r.quota&&r.usage>r.quota*.95)throw be.error(" CRITICAL: Storage quota 95% full - immediate data loss risk"),Sl("CRITICAL: Storage almost full! Clear browser data immediately to prevent loss.",15e3),new Error("Storage quota exhausted")}}catch(r){be.warn("Storage health check failed:",r)}}async requestPersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const r=await navigator.storage.persist();return this.persistenceGranted=r,r}}catch(r){be.error("Failed to request storage persistence:",r)}return!1}get isPersistent(){return this.persistenceGranted}}const Ed=new YA;function wr(e){const r=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&r==="[object Date]"?new e.constructor(+e):typeof e=="number"||r==="[object Number]"||typeof e=="string"||r==="[object String]"?new Date(e):new Date(NaN)}function Ja(e,r){return e instanceof Date?new e.constructor(r):new Date(r)}function xm(e,r){const t=wr(e);return isNaN(r)?Ja(e,NaN):(r&&t.setDate(t.getDate()+r),t)}function XA(e,r){const t=wr(e);if(isNaN(r))return Ja(e,NaN);if(!r)return t;const n=t.getDate(),a=Ja(e,t.getTime());a.setMonth(t.getMonth()+r+1,0);const l=a.getDate();return n>=l?a:(t.setFullYear(a.getFullYear(),a.getMonth(),n),t)}const Q1=6048e5,JA=864e5,ey=6e4,ty=36e5;let QA={};function df(){return QA}function Cl(e,r){const t=df(),n=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=wr(e),l=a.getDay(),c=(l<n?7:0)+l-n;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function tf(e){return Cl(e,{weekStartsOn:1})}function ry(e){const r=wr(e),t=r.getFullYear(),n=Ja(e,0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);const a=tf(n),l=Ja(e,0);l.setFullYear(t,0,4),l.setHours(0,0,0,0);const c=tf(l);return r.getTime()>=a.getTime()?t+1:r.getTime()>=c.getTime()?t:t-1}function lo(e){const r=wr(e);return r.setHours(0,0,0,0),r}function wv(e){const r=wr(e),t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return t.setUTCFullYear(r.getFullYear()),+e-+t}function eP(e,r){const t=lo(e),n=lo(r),a=+t-wv(t),l=+n-wv(n);return Math.round((a-l)/JA)}function tP(e){const r=ry(e),t=Ja(e,0);return t.setFullYear(r,0,4),t.setHours(0,0,0,0),tf(t)}function bv(e,r){const t=r*7;return xm(e,t)}function kv(e,r){const t=lo(e),n=lo(r);return+t==+n}function rP(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function nP(e){if(!rP(e)&&typeof e!="number")return!1;const r=wr(e);return!isNaN(Number(r))}function aP(e){const r=wr(e),t=Ja(e,0);return t.setFullYear(r.getFullYear(),0,1),t.setHours(0,0,0,0),t}function iP(e,r){const t=r?.weekStartsOn,n=wr(e),a=n.getDay(),l=(a<t?-7:0)+6-(a-t);return n.setDate(n.getDate()+l),n.setHours(23,59,59,999),n}const sP={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},oP=(e,r,t)=>{let n;const a=sP[e];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function Jh(e){return(r={})=>{const t=r.width?String(r.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const lP={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},cP={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},uP={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},dP={date:Jh({formats:lP,defaultWidth:"full"}),time:Jh({formats:cP,defaultWidth:"full"}),dateTime:Jh({formats:uP,defaultWidth:"full"})},fP={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},hP=(e,r,t,n)=>fP[e];function _c(e){return(r,t)=>{const n=t?.context?String(t.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const c=e.defaultFormattingWidth||e.defaultWidth,f=t?.width?String(t.width):c;a=e.formattingValues[f]||e.formattingValues[c]}else{const c=e.defaultWidth,f=t?.width?String(t.width):e.defaultWidth;a=e.values[f]||e.values[c]}const l=e.argumentCallback?e.argumentCallback(r):r;return a[l]}}const mP={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},pP={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},gP={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},vP={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},xP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},yP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},_P=(e,r)=>{const t=Number(e),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},wP={ordinalNumber:_P,era:_c({values:mP,defaultWidth:"wide"}),quarter:_c({values:pP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:_c({values:gP,defaultWidth:"wide"}),day:_c({values:vP,defaultWidth:"wide"}),dayPeriod:_c({values:xP,defaultWidth:"wide",formattingValues:yP,defaultFormattingWidth:"wide"})};function wc(e){return(r,t={})=>{const n=t.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],l=r.match(a);if(!l)return null;const c=l[0],f=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],m=Array.isArray(f)?kP(f,y=>y.test(c)):bP(f,y=>y.test(c));let g;g=e.valueCallback?e.valueCallback(m):m,g=t.valueCallback?t.valueCallback(g):g;const x=r.slice(c.length);return{value:g,rest:x}}}function bP(e,r){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&r(e[t]))return t}function kP(e,r){for(let t=0;t<e.length;t++)if(r(e[t]))return t}function SP(e){return(r,t={})=>{const n=r.match(e.matchPattern);if(!n)return null;const a=n[0],l=r.match(e.parsePattern);if(!l)return null;let c=e.valueCallback?e.valueCallback(l[0]):l[0];c=t.valueCallback?t.valueCallback(c):c;const f=r.slice(a.length);return{value:c,rest:f}}}const TP=/^(\d+)(th|st|nd|rd)?/i,EP=/\d+/i,CP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},AP={any:[/^b/i,/^(a|c)/i]},PP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},NP={any:[/1/i,/2/i,/3/i,/4/i]},DP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},IP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},OP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},jP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},FP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},LP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},RP={ordinalNumber:SP({matchPattern:TP,parsePattern:EP,valueCallback:e=>parseInt(e,10)}),era:wc({matchPatterns:CP,defaultMatchWidth:"wide",parsePatterns:AP,defaultParseWidth:"any"}),quarter:wc({matchPatterns:PP,defaultMatchWidth:"wide",parsePatterns:NP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:wc({matchPatterns:DP,defaultMatchWidth:"wide",parsePatterns:IP,defaultParseWidth:"any"}),day:wc({matchPatterns:OP,defaultMatchWidth:"wide",parsePatterns:jP,defaultParseWidth:"any"}),dayPeriod:wc({matchPatterns:FP,defaultMatchWidth:"any",parsePatterns:LP,defaultParseWidth:"any"})},MP={code:"en-US",formatDistance:oP,formatLong:dP,formatRelative:hP,localize:wP,match:RP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function BP(e){const r=wr(e);return eP(r,aP(r))+1}function zP(e){const r=wr(e),t=+tf(r)-+tP(r);return Math.round(t/Q1)+1}function ny(e,r){const t=wr(e),n=t.getFullYear(),a=df(),l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,c=Ja(e,0);c.setFullYear(n+1,0,l),c.setHours(0,0,0,0);const f=Cl(c,r),m=Ja(e,0);m.setFullYear(n,0,l),m.setHours(0,0,0,0);const g=Cl(m,r);return t.getTime()>=f.getTime()?n+1:t.getTime()>=g.getTime()?n:n-1}function UP(e,r){const t=df(),n=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=ny(e,r),l=Ja(e,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),Cl(l,r)}function $P(e,r){const t=wr(e),n=+Cl(t,r)-+UP(t,r);return Math.round(n/Q1)+1}function Mt(e,r){const t=e<0?"-":"",n=Math.abs(e).toString().padStart(r,"0");return t+n}const fs={y(e,r){const t=e.getFullYear(),n=t>0?t:1-t;return Mt(r==="yy"?n%100:n,r.length)},M(e,r){const t=e.getMonth();return r==="M"?String(t+1):Mt(t+1,2)},d(e,r){return Mt(e.getDate(),r.length)},a(e,r){const t=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,r){return Mt(e.getHours()%12||12,r.length)},H(e,r){return Mt(e.getHours(),r.length)},m(e,r){return Mt(e.getMinutes(),r.length)},s(e,r){return Mt(e.getSeconds(),r.length)},S(e,r){const t=r.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,t-3));return Mt(a,r.length)}},il={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Sv={G:function(e,r,t){const n=e.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(e,r,t){if(r==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return t.ordinalNumber(a,{unit:"year"})}return fs.y(e,r)},Y:function(e,r,t,n){const a=ny(e,n),l=a>0?a:1-a;if(r==="YY"){const c=l%100;return Mt(c,2)}return r==="Yo"?t.ordinalNumber(l,{unit:"year"}):Mt(l,r.length)},R:function(e,r){const t=ry(e);return Mt(t,r.length)},u:function(e,r){const t=e.getFullYear();return Mt(t,r.length)},Q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return Mt(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return Mt(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,r,t){const n=e.getMonth();switch(r){case"M":case"MM":return fs.M(e,r);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(e,r,t){const n=e.getMonth();switch(r){case"L":return String(n+1);case"LL":return Mt(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(e,r,t,n){const a=$P(e,n);return r==="wo"?t.ordinalNumber(a,{unit:"week"}):Mt(a,r.length)},I:function(e,r,t){const n=zP(e);return r==="Io"?t.ordinalNumber(n,{unit:"week"}):Mt(n,r.length)},d:function(e,r,t){return r==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):fs.d(e,r)},D:function(e,r,t){const n=BP(e);return r==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):Mt(n,r.length)},E:function(e,r,t){const n=e.getDay();switch(r){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(e,r,t,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(l);case"ee":return Mt(l,2);case"eo":return t.ordinalNumber(l,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,t,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(l);case"cc":return Mt(l,r.length);case"co":return t.ordinalNumber(l,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,t){const n=e.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return Mt(a,r.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(e,r,t){const a=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,t){const n=e.getHours();let a;switch(n===12?a=il.noon:n===0?a=il.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,t){const n=e.getHours();let a;switch(n>=17?a=il.evening:n>=12?a=il.afternoon:n>=4?a=il.morning:a=il.night,r){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,t){if(r==="ho"){let n=e.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return fs.h(e,r)},H:function(e,r,t){return r==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):fs.H(e,r)},K:function(e,r,t){const n=e.getHours()%12;return r==="Ko"?t.ordinalNumber(n,{unit:"hour"}):Mt(n,r.length)},k:function(e,r,t){let n=e.getHours();return n===0&&(n=24),r==="ko"?t.ordinalNumber(n,{unit:"hour"}):Mt(n,r.length)},m:function(e,r,t){return r==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):fs.m(e,r)},s:function(e,r,t){return r==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):fs.s(e,r)},S:function(e,r){return fs.S(e,r)},X:function(e,r,t){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return Ev(n);case"XXXX":case"XX":return eo(n);case"XXXXX":case"XXX":default:return eo(n,":")}},x:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"x":return Ev(n);case"xxxx":case"xx":return eo(n);case"xxxxx":case"xxx":default:return eo(n,":")}},O:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+Tv(n,":");case"OOOO":default:return"GMT"+eo(n,":")}},z:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+Tv(n,":");case"zzzz":default:return"GMT"+eo(n,":")}},t:function(e,r,t){const n=Math.trunc(e.getTime()/1e3);return Mt(n,r.length)},T:function(e,r,t){const n=e.getTime();return Mt(n,r.length)}};function Tv(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),l=n%60;return l===0?t+String(a):t+String(a)+r+Mt(l,2)}function Ev(e,r){return e%60===0?(e>0?"-":"+")+Mt(Math.abs(e)/60,2):eo(e,r)}function eo(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Mt(Math.trunc(n/60),2),l=Mt(n%60,2);return t+a+r+l}const Cv=(e,r)=>{switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},ay=(e,r)=>{switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},WP=(e,r)=>{const t=e.match(/(P+)(p+)?/)||[],n=t[1],a=t[2];if(!a)return Cv(e,r);let l;switch(n){case"P":l=r.dateTime({width:"short"});break;case"PP":l=r.dateTime({width:"medium"});break;case"PPP":l=r.dateTime({width:"long"});break;case"PPPP":default:l=r.dateTime({width:"full"});break}return l.replace("{{date}}",Cv(n,r)).replace("{{time}}",ay(a,r))},VP={p:ay,P:WP},HP=/^D+$/,GP=/^Y+$/,ZP=["D","DD","YY","YYYY"];function KP(e){return HP.test(e)}function qP(e){return GP.test(e)}function YP(e,r,t){const n=XP(e,r,t);if(console.warn(n),ZP.includes(e))throw new RangeError(n)}function XP(e,r,t){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${r}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const JP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,QP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eN=/^'([^]*?)'?$/,tN=/''/g,rN=/[a-zA-Z]/;function rf(e,r,t){const n=df(),a=n.locale??MP,l=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,c=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,f=wr(e);if(!nP(f))throw new RangeError("Invalid time value");let m=r.match(QP).map(x=>{const y=x[0];if(y==="p"||y==="P"){const b=VP[y];return b(x,a.formatLong)}return x}).join("").match(JP).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const y=x[0];if(y==="'")return{isToken:!1,value:nN(x)};if(Sv[y])return{isToken:!0,value:x};if(y.match(rN))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(m=a.localize.preprocessor(f,m));const g={firstWeekContainsDate:l,weekStartsOn:c,locale:a};return m.map(x=>{if(!x.isToken)return x.value;const y=x.value;(qP(y)||KP(y))&&YP(y,r,String(e));const b=Sv[y[0]];return b(f,y,a.localize,g)}).join("")}function nN(e){const r=e.match(eN);return r?r[1].replace(tN,"'"):e}function aN(e,r){const t=wr(e),n=wr(r);return t.getTime()>n.getTime()}function iN(e){return+wr(e)<Date.now()}function sN(e,r){const t=+wr(e),[n,a]=[+wr(r.start),+wr(r.end)].sort((l,c)=>l-c);return t>=n&&t<=a}function oN(e,r){return xm(e,-r)}function la(e,r){const n=dN(e);let a;if(n.date){const m=fN(n.date,2);a=hN(m.restDateString,m.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const l=a.getTime();let c=0,f;if(n.time&&(c=mN(n.time),isNaN(c)))return new Date(NaN);if(n.timezone){if(f=pN(n.timezone),isNaN(f))return new Date(NaN)}else{const m=new Date(l+c),g=new Date(0);return g.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),g.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),g}return new Date(l+c+f)}const Cd={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},lN=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,cN=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,uN=/^([+-])(\d{2})(?::?(\d{2}))?$/;function dN(e){const r={},t=e.split(Cd.dateTimeDelimiter);let n;if(t.length>2)return r;if(/:/.test(t[0])?n=t[0]:(r.date=t[0],n=t[1],Cd.timeZoneDelimiter.test(r.date)&&(r.date=e.split(Cd.timeZoneDelimiter)[0],n=e.substr(r.date.length,e.length))),n){const a=Cd.timezone.exec(n);a?(r.time=n.replace(a[1],""),r.timezone=a[1]):r.time=n}return r}function fN(e,r){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=e.match(t);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,l=n[2]?parseInt(n[2]):null;return{year:l===null?a:l*100,restDateString:e.slice((n[1]||n[2]).length)}}function hN(e,r){if(r===null)return new Date(NaN);const t=e.match(lN);if(!t)return new Date(NaN);const n=!!t[4],a=bc(t[1]),l=bc(t[2])-1,c=bc(t[3]),f=bc(t[4]),m=bc(t[5])-1;if(n)return _N(r,f,m)?gN(r,f,m):new Date(NaN);{const g=new Date(0);return!xN(r,l,c)||!yN(r,a)?new Date(NaN):(g.setUTCFullYear(r,l,Math.max(a,c)),g)}}function bc(e){return e?parseInt(e):1}function mN(e){const r=e.match(cN);if(!r)return NaN;const t=Qh(r[1]),n=Qh(r[2]),a=Qh(r[3]);return wN(t,n,a)?t*ty+n*ey+a*1e3:NaN}function Qh(e){return e&&parseFloat(e.replace(",","."))||0}function pN(e){if(e==="Z")return 0;const r=e.match(uN);if(!r)return 0;const t=r[1]==="+"?-1:1,n=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return bN(n,a)?t*(n*ty+a*ey):NaN}function gN(e,r,t){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,l=(r-1)*7+t+1-a;return n.setUTCDate(n.getUTCDate()+l),n}const vN=[31,null,31,30,31,30,31,31,30,31,30,31];function iy(e){return e%400===0||e%4===0&&e%100!==0}function xN(e,r,t){return r>=0&&r<=11&&t>=1&&t<=(vN[r]||(iy(e)?29:28))}function yN(e,r){return r>=1&&r<=(iy(e)?366:365)}function _N(e,r,t){return r>=1&&r<=53&&t>=0&&t<=6}function wN(e,r,t){return e===24?r===0&&t===0:t>=0&&t<60&&r>=0&&r<60&&e>=0&&e<25}function bN(e,r){return r>=0&&r<=59}const kN={name:"[Agent Name]",title:"Enforcement Agent",signature:"Enforcement Agent [Agent Name]",contactInfo:void 0},sy=[{id:"professional_standard",name:"Professional Standard",template:`{greeting}PAYMENT REMINDER

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: {amount}

Payment must be made as agreed. Failure to comply may result in further enforcement action.

Contact immediately if unable to pay as arranged.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"friendly_reminder",name:"Friendly Reminder",template:`{greeting}Payment Reminder

{refLine}This is a friendly reminder that your payment arrangement is due {date}{time}.

Amount: {amount}

Please ensure payment is made as agreed. If you need to discuss this arrangement, please contact us immediately.

Thank you,
{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"urgent_notice",name:"Urgent Notice",template:`{greeting}URGENT: PAYMENT DUE

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: {amount}

IMPORTANT: Payment must be made TODAY as agreed. Failure to comply will result in immediate further enforcement action.

Contact us NOW if unable to pay.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"payment_plan_reminder",name:"Payment Plan Reminder",template:`{greeting}Payment Plan Reminder

{refLine}Your next payment is due {date}{time}.

Payment Amount: {amount}

This is part of your agreed payment plan. Please ensure this payment is made on time to keep your arrangement active.

If you have any questions about your payment plan, please contact us.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"custom",name:"Custom Template",template:`{greeting}Payment Reminder

{refLine}Your payment is due {date}{time}.

Amount: {amount}

[Customize this message]

{signature}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]}],SN={daysBeforePayment:[3,1,0],enabled:!0,autoSend:!1},Il={defaultSchedule:SN,globalEnabled:!0,smsEnabled:!0,agentProfile:kN,messageTemplates:sy,activeTemplateId:"professional_standard",customizableSchedule:{threeDayReminder:!0,oneDayReminder:!0,dayOfReminder:!0,customDays:[]}};function TN(e,r=Il){const t=e.reminderSchedule||r.defaultSchedule;if(!t.enabled||!r.globalEnabled)return[];const n=la(e.scheduledDate);let a=[];return t.daysBeforePayment&&t.daysBeforePayment.length>0?a=[...t.daysBeforePayment]:(r.customizableSchedule.threeDayReminder&&a.push(3),r.customizableSchedule.oneDayReminder&&a.push(1),r.customizableSchedule.dayOfReminder&&a.push(0),a.push(...r.customizableSchedule.customDays)),[...new Set(a)].sort((c,f)=>f-c).map(c=>oN(n,c).toISOString())}function EN(e,r=Il){const t=TN(e,r),n=new Date().toISOString();return t.map((a,l)=>({id:`${e.id}_reminder_${l}`,arrangementId:e.id,type:CN(e,a),scheduledDate:a,status:"pending",createdAt:n,updatedAt:n}))}function CN(e,r){const t=lo(la(e.scheduledDate)),n=lo(la(r)),a=lo(new Date);return n.getTime()===t.getTime()?"payment_due":aN(a,t)?"overdue":"custom"}function AN(e){const r=e.reminderSettings||Il;if(!r.globalEnabled)return e.reminderNotifications||[];const t=e.reminderNotifications||[],n=[];return e.arrangements.filter(a=>a.status!=="Completed"&&a.status!=="Cancelled").forEach(a=>{if(!t.some(c=>c.arrangementId===a.id)){const c=EN(a,r);n.push(...c)}}),[...t,...n]}function PN(e,r,t,n){return e.map(a=>a.id===r?{...a,status:t,message:n||a.message,updatedAt:new Date().toISOString()}:a)}function NN(e,r){const t=new Set(r.filter(n=>n.status!=="Completed"&&n.status!=="Cancelled").map(n=>n.id));return e.filter(n=>t.has(n.arrangementId))}function oy(e,r,t=Il){const n=t.messageTemplates.find(k=>k.id===t.activeTemplateId)||t.messageTemplates[0],a=e.customerName||"",l=e.amount||"the arranged amount",c=la(e.scheduledDate);let f="",m="";if(a){const k=a.trim().split(/\s+/);k.length>=2?(m=k[0],f=`Mr/Mrs ${k.slice(1).join(" ")}, `):f=`${a}, `}const g=m?`Reference: ${m}

`:"",x=e.scheduledTime?` at ${e.scheduledTime}`:"",y=c.toLocaleDateString("en-GB");let b=n.template;const E=t.agentProfile.contactInfo?`
${t.agentProfile.contactInfo}`:"",S={greeting:f,refLine:g,date:y,time:x,amount:l,signature:t.agentProfile.signature,customerName:a,referenceNumber:m||"",agentName:t.agentProfile.name,agentTitle:t.agentProfile.title,contactInfo:E};return Object.entries(S).forEach(([k,C])=>{const R=new RegExp(`\\{${k}\\}`,"g");b=b.replace(R,C)}),b}const Ad="navigator_state_v5",sl=5,Pd={addresses:[],activeIndex:null,activeStartTime:null,completions:[],daySessions:[],arrangements:[],currentListVersion:1,subscription:null,reminderSettings:Il,reminderNotifications:[],lastReminderProcessed:void 0};function DN(e){return e&&typeof e.index=="number"&&typeof e.address=="string"&&typeof e.outcome=="string"&&["PIF","DA","Done","ARR"].includes(e.outcome)&&typeof e.timestamp=="string"&&!isNaN(new Date(e.timestamp).getTime())}function e0(e){return e&&typeof e.address=="string"&&e.address.trim().length>0}function IN(e){return e&&Array.isArray(e.addresses)&&Array.isArray(e.completions)&&Array.isArray(e.daySessions)&&Array.isArray(e.arrangements)&&(e.activeIndex===null||typeof e.activeIndex=="number")&&typeof e.currentListVersion=="number"}function Av(e,r){return(Array.isArray(e)?e:[]).filter(DN).map(n=>({...n,listVersion:typeof n?.listVersion=="number"?n.listVersion:r}))}function hs(e,r,t){const n=`${e}_${r}_${JSON.stringify(t).slice(0,50)}_${Date.now()}`,a=encodeURIComponent(n);return btoa(a).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}function ly(e,r){const t={...e,end:r.toISOString()},n=Date.parse(e.start),a=r.getTime();if(!Number.isNaN(n)&&!Number.isNaN(a)){const l=a-n;t.durationSeconds=l>=0?Math.floor(l/1e3):void 0}else t.durationSeconds=void 0;return t}function ON(e,r){const t=r.getTime(),n=Date.parse(e.start);let a=Date.parse(`${e.date}T23:59:59.999Z`);return Number.isNaN(a)&&(a=t),!Number.isNaN(n)&&a<n&&(a=n),a>t&&(a=t),Number.isNaN(a)&&(a=Number.isNaN(n)?t:n),ly(e,new Date(a))}function jN(e,r,t){const n=[],a=[];for(const l of e)if(!l.end&&l.date<r){const c=ON(l,t);n.push(c),a.push(c)}else n.push(l);return{sanitizedSessions:n,closedSessions:a}}function FN(e,r){for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(n.date===r&&!n.end)return t}return-1}function LN(e,r,t){const{sanitizedSessions:n,closedSessions:a}=jN(e,r,t),l=FN(n,r);if(l===-1)return{updatedSessions:n,closedSessions:a};const c=n.slice(),f=ly(c[l],t);return c[l]=f,{updatedSessions:c,closedSessions:a,endedSession:f}}const Pv="navigator_device_id";function RN(){try{const e=localStorage.getItem(Pv);if(e)return e;const r=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():"dev_"+Math.random().toString(36).slice(2);return localStorage.setItem(Pv,r),r}catch{return"dev_"+Math.random().toString(36).slice(2)}}function MN(e,r){if(r.size===0)return e;try{let t={...e,addresses:[...e.addresses],completions:[...e.completions],arrangements:[...e.arrangements],daySessions:[...e.daySessions]};const n=Array.from(r.values()).sort((c,f)=>new Date(c.timestamp).getTime()-new Date(f.timestamp).getTime());let a=!1,l=!1;for(const c of n)if(c.type!=="reverted")try{switch(c.entity){case"completion":if(l=!0,c.operation==="create"){if(!c.data||typeof c.data.index!="number"||!c.data.outcome){be.warn("Invalid completion data in optimistic update:",c.data);continue}t.completions.some(m=>m.index===c.data.index&&m.outcome===c.data.outcome&&Math.abs(new Date(m.timestamp).getTime()-new Date(c.data.timestamp).getTime())<1e3)||(t.completions=[c.data,...t.completions])}else c.operation==="update"?t.completions=t.completions.map(f=>f.timestamp===c.data.originalTimestamp?{...f,...c.data}:f):c.operation==="delete"&&(t.completions=t.completions.filter(f=>f.timestamp!==c.data.timestamp));break;case"arrangement":c.operation==="create"?t.arrangements=[...t.arrangements,c.data]:c.operation==="update"?t.arrangements=t.arrangements.map(f=>f.id===c.data.id?{...f,...c.data,updatedAt:c.timestamp}:f):c.operation==="delete"&&(t.arrangements=t.arrangements.filter(f=>f.id!==c.data.id));break;case"address":if(a=!0,c.operation==="create")t.addresses=[...t.addresses,c.data];else if(c.operation==="update"&&c.data?.addresses&&(t.addresses=Array.isArray(c.data.addresses)?c.data.addresses:t.addresses,c.data.bumpVersion)){const f=typeof t.currentListVersion=="number"?t.currentListVersion:1;t.currentListVersion=f+1,c.data.preserveCompletions||(t.completions=[]),t.activeIndex=null}break;case"session":c.operation==="create"?c.data&&c.data.date&&c.data.start?t.daySessions=[...t.daySessions,c.data]:be.warn("Invalid session data in optimistic update:",c.data):c.operation==="update"&&(t.daySessions=t.daySessions.map(f=>f.date===c.data.date?{...f,...c.data}:f));break;default:be.warn(`Unknown entity type in optimistic update: ${c.entity}`,c);break}}catch(f){be.error(`Failed to apply optimistic update for ${c.entity}:`,f)}return a&&(!t.addresses||!Array.isArray(t.addresses))?(be.error("Optimistic updates corrupted addresses, reverting to base state"),e):l&&(!t.completions||!Array.isArray(t.completions))?(be.error("Optimistic updates corrupted completions, reverting to base state"),e):t}catch(t){return be.error("Failed to apply optimistic updates, returning base state:",t),e}}function BN(){const[e,r]=Y.useState(Pd),[t,n]=Y.useState({updates:new Map,pendingOperations:new Set}),[a,l]=Y.useState(!0),c=Y.useMemo(()=>RN(),[]),f=Y.useMemo(()=>MN(e,t.updates),[e,t.updates]),[m,g]=Y.useState(new Map);Y.useEffect(()=>{let D=!0;return(async()=>{try{const P=await Ed.queuedGet(Ad);if(!D)return;if(P){if(!IN(P)){be.warn("Loaded data failed validation, using initial state"),r({...Pd,_schemaVersion:sl});return}const I=typeof P.currentListVersion=="number"?P.currentListVersion:1,B={addresses:P.addresses.filter(e0),activeIndex:typeof P.activeIndex=="number"?P.activeIndex:null,completions:Av(P.completions,I),daySessions:Array.isArray(P.daySessions)?P.daySessions:[],arrangements:Array.isArray(P.arrangements)?P.arrangements:[],currentListVersion:I,subscription:P.subscription||null,_schemaVersion:sl};r(B)}else r({...Pd,_schemaVersion:sl})}catch(P){be.error("Failed to load state from IndexedDB:",P),r({...Pd,_schemaVersion:sl})}finally{D&&l(!1)}})(),()=>{D=!1}},[]),Y.useEffect(()=>{if(a)return;const D=setTimeout(async()=>{try{const P={...e,_schemaVersion:sl};await Ed.queuedSet(Ad,P)}catch(P){be.error("Failed to persist state to IndexedDB:",P)}},150);return()=>clearTimeout(D)},[e,a]);const x=Y.useCallback((D,P,I,B)=>{const G=B||hs(D,P,I),te=new Date().toISOString(),de={id:G,timestamp:te,type:"optimistic",operation:D,entity:P,data:I};return n(pe=>{const me=new Map(pe.updates);return me.set(G,de),{updates:me,pendingOperations:new Set([...pe.pendingOperations,G])}}),G},[]),y=Y.useCallback((D,P)=>{n(I=>{const B=new Map(I.updates),G=new Set(I.pendingOperations),te=B.get(D);return te&&B.set(D,{...te,type:"confirmed",data:P||te.data}),G.delete(D),{updates:B,pendingOperations:G}}),setTimeout(()=>{n(I=>{const B=new Map(I.updates);return B.delete(D),{...I,updates:B}})},5e3)},[]),b=Y.useCallback((D,P)=>{be.debug(`Reverting optimistic update ${D}:`,P),n(I=>{const B=new Map(I.updates),G=new Set(I.pendingOperations),te=B.get(D);return te&&B.set(D,{...te,type:"reverted"}),G.delete(D),{updates:B,pendingOperations:G}}),setTimeout(()=>{n(I=>{const B=new Map(I.updates);return B.delete(D),{...I,updates:B}})},1e3)},[]),E=Y.useCallback(()=>{n({updates:new Map,pendingOperations:new Set})},[]),S=Y.useCallback((D,P=!0)=>{be.info(` IMPORT START: Importing ${D.length} addresses, preserveCompletions=${P}`);const I=Date.now();localStorage.setItem("navigator_import_in_progress",I.toString()),be.info(" IMPORT PROTECTION ACTIVATED:",new Date(I).toISOString());const B=hs("update","address",{type:"bulk_import",count:D.length,preserve:P}),G=Array.isArray(D)?D.filter(e0):[];if(be.info(` IMPORT VALIDATION: ${G.length} valid out of ${D.length} total`),G.length===0){be.warn("No valid addresses to import");return}x("update","address",{addresses:G,bumpVersion:!0,preserveCompletions:P},B),r(te=>{const de=(typeof te.currentListVersion=="number"?te.currentListVersion:1)+1;be.info(` IMPORT BASE STATE UPDATE: addresses=${G.length}, preserveCompletions=${P}, oldCompletions=${te.completions.length}, newListVersion=${de}`);const pe={...te,addresses:G,activeIndex:null,currentListVersion:de,completions:P?te.completions:[]};return be.info(` IMPORT RESULT STATE: addresses=${pe.addresses.length}, completions=${pe.completions.length}, listVersion=${pe.currentListVersion}`),pe}),y(B),setTimeout(()=>{localStorage.removeItem("navigator_import_in_progress"),be.info(" IMPORT PROTECTION CLEARED after import completion")},2e3)},[x,y]),k=Y.useCallback(D=>new Promise(P=>{if(!e0(D)){P(-1);return}const I=hs("create","address",D);x("create","address",D,I),r(B=>{const G=[...B.addresses,D],te=G.length-1;return y(I),P(te),{...B,addresses:G}})}),[x,y]),C=Y.useCallback(D=>{localStorage.setItem("navigator_active_protection","true"),r(P=>{const I=P.addresses[D];if(P.activeIndex!==null&&P.activeIndex!==D){const G=P.addresses[P.activeIndex];return be.warn(`Cannot start address #${D} - address #${P.activeIndex} "${G?.address}" is already active`),Mc("Please complete or cancel the current active address first"),localStorage.removeItem("navigator_active_protection"),P}if(I&&P.completions.some(te=>te.index===D&&(te.listVersion||P.currentListVersion)===P.currentListVersion))return be.warn(`Cannot set active - address at index ${D} is already completed`),Mc("This address is already completed"),localStorage.removeItem("navigator_active_protection"),P;const B=new Date().toISOString();return be.info(` STARTING CASE: Address #${D} "${I?.address}" at ${B} - SYNC BLOCKED until Complete/Cancel`),{...P,activeIndex:D,activeStartTime:B}})},[]),R=Y.useCallback(()=>{localStorage.removeItem("navigator_active_protection"),r(D=>(be.info(" CANCELING ACTIVE: Clearing active state - SYNC RESUMED"),{...D,activeIndex:null,activeStartTime:null}))},[]),[,j]=Y.useState(new Set),N=Y.useRef(new Set),F=Y.useRef(new Map);Y.useEffect(()=>{const D=setInterval(()=>{const P=Date.now()-3e4;let I=0;for(const[B,G]of F.current.entries())G.timestamp<P&&(F.current.delete(B),I++);I>0&&be.debug(` Cleaned up ${I} old completion entries from memory`)},15e3);return()=>clearInterval(D)},[]);const K=Y.useCallback(async(D,P,I,B,G)=>{if(!Number.isInteger(D)||D<0){const at=`Invalid index: ${D}. Index must be a non-negative integer.`;throw be.error(at),Sl("Invalid address index. Please refresh and try again."),new Error(at)}const te=e;if(D>=te.addresses.length){const at=`Index ${D} out of bounds. Total addresses: ${te.addresses.length}`;throw be.error(at),Sl("Address not found. The list may have changed. Please refresh."),new Error(at)}if(N.current.has(D))throw new Error(`Completion already pending for index ${D}`);const de=te.addresses[D];if(!de||!de.address){const at=`Address at index ${D} is invalid or empty`;throw be.error(at),Sl("Invalid address data. Please refresh and try again."),new Error(at)}const pe=te.completions.find(at=>at.address===de.address&&at.listVersion===te.currentListVersion);if(pe){const at=new Date(pe.timestamp).getTime(),mt=Date.now()-at;if(mt<3e4)return Mc(`Address "${de.address}" was already completed ${Math.round(mt/1e3)} seconds ago`),Promise.reject();console.log(` RE-COMPLETING: Address "${de.address}" was previously completed ${new Date(pe.timestamp).toLocaleString()}, allowing new completion`)}const me=new Date().toISOString();let ye;if(te.activeIndex===D&&te.activeStartTime){const at=new Date(te.activeStartTime).getTime(),dt=new Date(me).getTime();ye=Math.floor((dt-at)/1e3),be.info(` CASE TIME TRACKED: ${Math.floor(ye/60)}m ${ye%60}s on "${de.address}"`)}const Ke={index:D,address:de.address,lat:de.lat??null,lng:de.lng??null,outcome:P,amount:I,timestamp:me,listVersion:te.currentListVersion,arrangementId:B,caseReference:G,timeSpentSeconds:ye},ae=hs("create","completion",Ke);try{N.current.add(D),j(new Set(N.current));const at=`${D}_${P}_${te.currentListVersion}`;return F.current.set(at,{timestamp:Date.now(),completion:Ke}),x("create","completion",Ke,ae),r(dt=>(dt.activeIndex===D&&(localStorage.removeItem("navigator_active_protection"),be.info(" COMPLETED ACTIVE ADDRESS: Clearing active state - SYNC RESUMED")),{...dt,completions:[Ke,...dt.completions],activeIndex:dt.activeIndex===D?null:dt.activeIndex,activeStartTime:dt.activeIndex===D?null:dt.activeStartTime})),ae}finally{N.current.delete(D),j(new Set(N.current))}},[e,x]),z=Y.useCallback(D=>{r(P=>{const I=P.completions.slice();let B=-1,G=0;for(let te=0;te<I.length;te++){const de=I[te];if(Number(de.index)===Number(D)&&de.listVersion===P.currentListVersion){const pe=new Date(de.timestamp).getTime();pe>G&&(G=pe,B=te)}}if(B>=0){const te=I[B],de=hs("delete","completion",te);x("delete","completion",te,de),I.splice(B,1),setTimeout(()=>y(de),0)}return{...P,completions:I}})},[x,y]),O=Y.useCallback(()=>{const D=new Date,P=D.toISOString().slice(0,10);r(I=>{if(I.daySessions.find(de=>de.date===P&&!de.end))return be.info("Day already active for today, skipping start"),I;const G=I.daySessions.map(de=>de.date<P&&!de.end?(be.info("Auto-closing stale session from previous day:",de),{...de,end:new Date(de.date+"T23:59:59.999Z").toISOString(),durationSeconds:Math.floor((new Date(de.date+"T23:59:59.999Z").getTime()-new Date(de.start).getTime())/1e3)}):de),te={date:P,start:D.toISOString()};return be.info("Starting new day session:",te),{...I,daySessions:[...G,te]}})},[]),ne=Y.useCallback(()=>{const D=new Date,P=D.toISOString().slice(0,10);r(I=>{const{updatedSessions:B,closedSessions:G,endedSession:te}=LN(I.daySessions,P,D);return G.forEach(de=>be.info("Auto-closing stale day session before ending today",de)),te?(be.info("Ending day session:",te),{...I,daySessions:B}):(be.info("No active session to end for today"),G.length>0?{...I,daySessions:B}:I)})},[]),ee=Y.useCallback(D=>new Promise(P=>{const I=new Date().toISOString(),B=`arr_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,G={...D,id:B,createdAt:I,updatedAt:I},te=hs("create","arrangement",G);x("create","arrangement",G,te),r(de=>(setTimeout(()=>{y(te),P(B)},0),{...de,arrangements:[...de.arrangements,G]}))}),[x,y]),ve=Y.useCallback((D,P)=>new Promise(I=>{const B=hs("update","arrangement",{id:D,...P});r(G=>{const te={...P,id:D,updatedAt:new Date().toISOString()};x("update","arrangement",te,B);const de=G.arrangements.map(pe=>pe.id===D?{...pe,...P,updatedAt:new Date().toISOString()}:pe);return setTimeout(()=>{y(B),I()},0),{...G,arrangements:de}})}),[x,y]),he=Y.useCallback(D=>new Promise(P=>{r(I=>{const B=I.arrangements.find(de=>de.id===D);if(!B)return P(),I;const G=hs("delete","arrangement",B);x("delete","arrangement",{id:D},G);const te=I.arrangements.filter(de=>de.id!==D);return setTimeout(()=>{y(G),P()},0),{...I,arrangements:te}})}),[x,y]),ce=Y.useCallback(D=>{r(P=>({...P,subscription:D}))},[]),Ne=Y.useCallback(D=>{r(P=>({...P,reminderSettings:D}))},[]),xe=Y.useCallback((D,P,I)=>{r(B=>({...B,reminderNotifications:PN(B.reminderNotifications||[],D,P,I)}))},[]),le=Y.useCallback(()=>{r(D=>{const P=AN(D),I=NN(P,D.arrangements);return{...D,reminderNotifications:I,lastReminderProcessed:new Date().toISOString()}})},[]);Y.useEffect(()=>{const D=setInterval(()=>{a||le()},6e4);return()=>clearInterval(D)},[a,le]);function Q(D){return D&&typeof D=="object"&&Array.isArray(D.addresses)&&Array.isArray(D.completions)&&"activeIndex"in D&&Array.isArray(D.daySessions)}const M=Y.useCallback(()=>({addresses:e.addresses,completions:e.completions,activeIndex:e.activeIndex,daySessions:e.daySessions,arrangements:e.arrangements,currentListVersion:e.currentListVersion}),[e]),V=Y.useCallback(async(D,P="replace")=>{if(!Q(D))throw console.error(" RESTORE VALIDATION FAILED:",{hasObj:!!D,type:typeof D,hasAddresses:D&&Array.isArray(D.addresses),hasCompletions:D&&Array.isArray(D.completions),hasActiveIndex:D&&"activeIndex"in D,hasDaySessions:D&&Array.isArray(D.daySessions),objKeys:D?Object.keys(D):null}),new Error("Invalid backup file format");const I=typeof D.currentListVersion=="number"?D.currentListVersion:1,B=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),G="ontouchstart"in window||navigator.maxTouchPoints>0;console.log(" RESTORE DATA ANALYSIS:",{addressCount:D.addresses.length,completionCount:D.completions.length,arrangementCount:D.arrangements?.length||0,daySessionCount:D.daySessions?.length||0,activeIndex:D.activeIndex,listVersion:I,mergeStrategy:P,isMobile:B,isTouch:G,userAgent:navigator.userAgent.substring(0,50)});const te={addresses:D.addresses,completions:Av(D.completions,I),activeIndex:D.activeIndex??null,daySessions:D.daySessions??[],arrangements:D.arrangements??[],currentListVersion:I};console.log(" RESTORED STATE PREPARED:",{addressCount:te.addresses.length,completionCount:te.completions.length,arrangementCount:te.arrangements.length,daySessionCount:te.daySessions.length,activeIndex:te.activeIndex,listVersion:te.currentListVersion}),r(P==="merge"?de=>({addresses:te.currentListVersion>=de.currentListVersion?te.addresses:de.addresses,currentListVersion:Math.max(te.currentListVersion,de.currentListVersion),completions:[...de.completions,...te.completions.filter(me=>!de.completions.some(ye=>ye.timestamp===me.timestamp&&ye.index===me.index&&ye.outcome===me.outcome))].sort((me,ye)=>new Date(ye.timestamp).getTime()-new Date(me.timestamp).getTime()),arrangements:Array.from(new Map([...de.arrangements.map(me=>[me.id,me]),...te.arrangements.map(me=>[me.id,me])].sort(([,me],[,ye])=>new Date(ye.updatedAt).getTime()-new Date(me.updatedAt).getTime())).values()),daySessions:Array.from(new Map([...de.daySessions.map(me=>[me.date,me]),...te.daySessions.map(me=>[me.date,me])]).values()),activeIndex:te.activeIndex??de.activeIndex}):te),E();try{const de={...te,_schemaVersion:sl};if(console.log(" PERSISTING RESTORED STATE:",{addressCount:de.addresses.length,completionCount:de.completions.length,arrangementCount:de.arrangements.length,daySessionCount:de.daySessions.length,activeIndex:de.activeIndex,listVersion:de.currentListVersion,schemaVersion:de._schemaVersion}),"storage"in navigator&&"persist"in navigator.storage)try{const ye=await navigator.storage.persist();console.log(" PERSISTENT STORAGE:",ye?"GRANTED":"DENIED")}catch(ye){console.warn(" PERSISTENT STORAGE REQUEST FAILED:",ye)}if(await Ed.queuedSet(Ad,de),console.log(" RESTORED STATE PERSISTED TO INDEXEDDB"),"storage"in navigator&&"estimate"in navigator.storage)try{const ye=await navigator.storage.estimate(),Ke=ye.usage&&ye.quota?Math.round(ye.usage/ye.quota*100):"unknown";console.log(" STORAGE QUOTA:",{used:ye.usage?`${Math.round(ye.usage/1024/1024)}MB`:"unknown",total:ye.quota?`${Math.round(ye.quota/1024/1024)}MB`:"unknown",percentUsed:`${Ke}%`})}catch(ye){console.warn(" STORAGE QUOTA CHECK FAILED:",ye)}const pe=await Ed.queuedGet(Ad);console.log(" VERIFICATION READ FROM INDEXEDDB:",{success:!!pe,addressCount:pe?.addresses?.length||0,completionCount:pe?.completions?.length||0,arrangementCount:pe?.arrangements?.length||0});const me=Date.now();localStorage.setItem("navigator_restore_in_progress",me.toString()),console.log(" RESTORE PROTECTION ACTIVATED:",new Date(me).toISOString()),localStorage.setItem("navigator_last_restore",me.toString())}catch(de){throw be.error("Failed to persist restored state:",de),new Error("Restore failed: Could not save data")}},[E]),H=Y.useCallback(D=>{const P=localStorage.getItem("navigator_last_restore");if(P){const I=Date.now()-parseInt(P);I<36e5&&console.log(" STATE CHANGE AFTER RESTORE:",{timeSinceRestore:`${Math.round(I/1e3)}s`,newStateType:typeof D,isFunction:typeof D=="function",timestamp:new Date().toISOString()})}r(I=>{const B=typeof D=="function"?D(I):D,G=[...B.completions];let te=!1;const de=Date.now()-3e4;for(const[ye,Ke]of F.current.entries())Ke.timestamp<de&&F.current.delete(ye);for(const[ye,Ke]of F.current.entries()){const{completion:ae,timestamp:at}=Ke;Date.now()-at<3e4&&(G.some(mt=>mt.index===ae.index&&mt.outcome===ae.outcome&&mt.listVersion===ae.listVersion&&Math.abs(new Date(mt.timestamp).getTime()-new Date(ae.timestamp).getTime())<1e3)||(be.info(` PROTECTING RECENT COMPLETION: index=${ae.index}, outcome=${ae.outcome}`),G.unshift(ae),te=!0))}let pe=te?{...B,completions:G.sort((ye,Ke)=>new Date(Ke.timestamp).getTime()-new Date(ye.timestamp).getTime())}:B;if(pe.activeIndex!==null&&typeof pe.activeIndex=="number"){const ye=pe.addresses[pe.activeIndex];ye?pe.completions.some(ae=>ae.address===ye.address&&(ae.listVersion||pe.currentListVersion)===pe.currentListVersion)&&(be.info(` CLEARING ACTIVE INDEX: Address "${ye.address}" was completed on another device`),qA(`Address "${ye.address}" was completed on another device`),pe={...pe,activeIndex:null,activeStartTime:null}):(be.warn(` CLEARING INVALID activeIndex: Index ${pe.activeIndex} is out of bounds (max: ${pe.addresses.length-1})`),pe={...pe,activeIndex:null,activeStartTime:null})}const me=new Map;return pe.completions.forEach(ye=>{const Ke=I.completions.find(ae=>ae.index===ye.index&&ae.outcome===ye.outcome&&Math.abs(new Date(ae.timestamp).getTime()-new Date(ye.timestamp).getTime())<5e3);Ke&&Ke.timestamp!==ye.timestamp&&me.set(`completion_${ye.timestamp}`,{type:"completion",incoming:ye,existing:Ke,resolution:"prefer_incoming"})}),pe.arrangements.forEach(ye=>{const Ke=I.arrangements.find(ae=>ae.id===ye.id);if(Ke&&Ke.updatedAt!==ye.updatedAt){const ae=new Date(ye.updatedAt).getTime(),at=new Date(Ke.updatedAt).getTime();me.set(`arrangement_${ye.id}`,{type:"arrangement",incoming:ye,existing:Ke,resolution:ae>at?"prefer_incoming":"prefer_existing"})}}),me.size>0&&(be.debug("Detected state conflicts:",me.size),g(me)),pe}),E()},[E]),se=Y.useCallback((D,P,I,B)=>x(P,D,I,B),[x]);return{state:f,baseState:e,loading:a,setState:H,setBaseState:r,deviceId:c,enqueueOp:se,optimisticUpdates:t.updates,pendingOperations:t.pendingOperations,confirmOptimisticUpdate:y,revertOptimisticUpdate:b,clearOptimisticUpdates:E,conflicts:m,resolveConflict:(D,P)=>{g(I=>{const B=new Map(I);return B.delete(D),B})},setAddresses:S,addAddress:k,setActive:C,cancelActive:R,complete:K,undo:z,startDay:O,endDay:ne,addArrangement:ee,updateArrangement:ve,deleteArrangement:he,setSubscription:ce,backupState:M,restoreState:V,updateReminderSettings:Ne,updateReminderNotification:xe,processReminders:le}}function Ud(e){const r=e??{},t=typeof r.currentListVersion=="number"?r.currentListVersion:1;return{...r,addresses:Array.isArray(r.addresses)?r.addresses:[],completions:Array.isArray(r.completions)?r.completions:[],arrangements:Array.isArray(r.arrangements)?r.arrangements:[],daySessions:Array.isArray(r.daySessions)?r.daySessions:[],activeIndex:typeof r.activeIndex=="number"?r.activeIndex:null,currentListVersion:t}}function t0(e){const r=e??{};return{addresses:Array.isArray(r.addresses)?r.addresses:[],completions:Array.isArray(r.completions)?r.completions:[],arrangements:Array.isArray(r.arrangements)?r.arrangements:[],activeIndex:typeof r.activeIndex=="number"?r.activeIndex:null,currentListVersion:typeof r.currentListVersion=="number"?r.currentListVersion:1}}function co(e){const r=a=>{if(!a||typeof a!="object"||Array.isArray(a))return!1;const l=Object.getPrototypeOf(a);return l===Object.prototype||l===null},t=JSON.stringify(e,(a,l)=>{if(!l||typeof l!="object")return l;if(l instanceof Date)return l.toISOString();if(typeof l.toJSON=="function"&&!r(l))return l.toJSON(a);if(r(l)){const c={};return Object.keys(l).sort().forEach(f=>{c[f]=l[f]}),c}return l});let n=0;for(let a=0;a<t.length;a++){const l=t.charCodeAt(a);n=(n<<5)-n+l,n=n&n}return n.toString()}class ps{static generateDeviceFingerprint(){try{const r=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.hardwareConcurrency||"unknown"];return`device_${btoa(r.join("|")).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}_${Date.now()}`}catch{return`device_fallback_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}}static analyzeDataOwnership(r,t,n){const a={hasLocalData:this.hasSignificantLocalData(r),hasCloudData:n?this.hasSignificantLocalData(n):!1,localDataAge:this.estimateDataAge(r),userInLocalData:this.findUserSignalsInData(r,t),cloudUserMatch:n?this.findUserSignalsInData(n,t):null};return be.info("User detection signals:",a),a.hasCloudData&&a.cloudUserMatch?a.hasLocalData?a.userInLocalData?{isOwner:!0,confidence:"high",reason:"Both local and cloud data belong to user",action:"sync"}:{isOwner:!0,confidence:"medium",reason:"Cloud data belongs to user, local data unclear",action:"preserve_and_ask"}:{isOwner:!0,confidence:"high",reason:"Cloud data exists for user, no local conflict",action:"sync"}:a.hasLocalData&&a.userInLocalData?{isOwner:!0,confidence:"medium",reason:"Local data appears to belong to current user",action:"sync"}:a.hasLocalData&&!a.userInLocalData&&!a.hasCloudData?{isOwner:!1,confidence:"low",reason:"Local data has no user identification",action:"preserve_and_ask"}:{isOwner:!0,confidence:"low",reason:"Unclear ownership - preserving data for safety",action:"preserve_and_ask"}}static hasSignificantLocalData(r){const t=Array.isArray(r.addresses)?r.addresses.length:0,n=Array.isArray(r.completions)?r.completions.length:0,a=Array.isArray(r.arrangements)?r.arrangements.length:0;return t>5||n>0||a>0}static estimateDataAge(r){try{const t=Array.isArray(r.completions)?r.completions:[],n=Array.isArray(r.arrangements)?r.arrangements:[],a=[...t.map(f=>f.timestamp),...n.map(f=>f.updatedAt||f.createdAt)].filter(Boolean);if(a.length===0)return"unknown";const l=Math.max(...a.map(f=>new Date(f).getTime())),c=(Date.now()-l)/(1e3*60*60);return c<24?"recent":(c<168,"old")}catch{return"unknown"}}static findUserSignalsInData(r,t){try{const n=Array.isArray(r.arrangements)?r.arrangements:[],a=t.email?.toLowerCase();return a&&n.some(m=>m.customerName?.toLowerCase().includes(a)||m.notes?.toLowerCase().includes(a))?!0:(Array.isArray(r.completions)?r.completions:[]).filter(f=>(Date.now()-new Date(f.timestamp).getTime())/36e5<24).length>0}catch{return!1}}static storeDeviceContext(r){try{const t={userId:r.id,email:r.email||void 0,deviceId:this.generateDeviceFingerprint(),sessionStart:new Date().toISOString()};localStorage.setItem("navigator_device_context",JSON.stringify(t));const n=co(t);localStorage.setItem("navigator_device_context_checksum",n),be.info("Device context stored:",{userId:t.userId,deviceId:t.deviceId})}catch(t){be.error("Failed to store device context:",t)}}static getDeviceContext(){try{const r=localStorage.getItem("navigator_device_context"),t=localStorage.getItem("navigator_device_context_checksum");if(!r)return null;const n=JSON.parse(r);return t&&co(n)!==t?(be.warn("Device context checksum mismatch - data may be corrupted"),null):n}catch(r){return be.error("Failed to get device context:",r),null}}static clearDeviceContext(){try{localStorage.removeItem("navigator_device_context"),localStorage.removeItem("navigator_device_context_checksum")}catch(r){be.error("Failed to clear device context:",r)}}}const zN=Object.freeze(Object.defineProperty({__proto__:null,SmartUserDetection:ps},Symbol.toStringTag,{value:"Module"})),UN="modulepreload",$N=function(e){return"/"+e},Nv={},Qa=function(r,t,n){let a=Promise.resolve();if(t&&t.length>0){let g=function(x){return Promise.all(x.map(y=>Promise.resolve(y).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};var c=g;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=f?.nonce||f?.getAttribute("nonce");a=g(t.map(x=>{if(x=$N(x),x in Nv)return;Nv[x]=!0;const y=x.endsWith(".css"),b=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${b}`))return;const E=document.createElement("link");if(E.rel=y?"stylesheet":UN,y||(E.as="script"),E.crossOrigin="",E.href=x,m&&E.setAttribute("nonce",m),document.head.appendChild(E),y)return new Promise((S,k)=>{E.addEventListener("load",S),E.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${x}`)))})}))}function l(f){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=f,window.dispatchEvent(m),!m.defaultPrevented)throw f}return a.then(f=>{for(const m of f||[])m.status==="rejected"&&l(m.reason);return r().catch(l)})},WN=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Qa(async()=>{const{default:n}=await Promise.resolve().then(()=>Ol);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)};class ym extends Error{constructor(r,t="FunctionsError",n){super(r),this.name=t,this.context=n}}class VN extends ym{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class Dv extends ym{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class Iv extends ym{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var E0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(E0||(E0={}));var HN=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(x){try{g(n.next(x))}catch(y){c(y)}}function m(x){try{g(n.throw(x))}catch(y){c(y)}}function g(x){x.done?l(x.value):a(x.value).then(f,m)}g((n=n.apply(e,r||[])).next())})};class GN{constructor(r,{headers:t={},customFetch:n,region:a=E0.Any}={}){this.url=r,this.headers=t,this.region=a,this.fetch=WN(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,t={}){var n;return HN(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:c}=t;let f={},{region:m}=t;m||(m=this.region);const g=new URL(`${this.url}/${r}`);m&&m!=="any"&&(f["x-region"]=m,g.searchParams.set("forceFunctionRegion",m));let x;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",x=c):typeof c=="string"?(f["Content-Type"]="text/plain",x=c):typeof FormData<"u"&&c instanceof FormData?x=c:(f["Content-Type"]="application/json",x=JSON.stringify(c)));const y=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),a),body:x}).catch(k=>{throw new VN(k)}),b=y.headers.get("x-relay-error");if(b&&b==="true")throw new Dv(y);if(!y.ok)throw new Iv(y);let E=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),S;return E==="application/json"?S=yield y.json():E==="application/octet-stream"?S=yield y.blob():E==="text/event-stream"?S=y:E==="multipart/form-data"?S=yield y.formData():S=yield y.text(),{data:S,error:null,response:y}}catch(a){return{data:null,error:a,response:a instanceof Iv||a instanceof Dv?a.context:void 0}}})}}var Mr={},ol={},ll={},cl={},ul={},dl={},ZN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Al=ZN();const KN=Al.fetch,cy=Al.fetch.bind(Al),uy=Al.Headers,qN=Al.Request,YN=Al.Response,Ol=Object.freeze(Object.defineProperty({__proto__:null,Headers:uy,Request:qN,Response:YN,default:cy,fetch:KN},Symbol.toStringTag,{value:"Module"})),XN=I_(Ol);var Nd={},Ov;function dy(){if(Ov)return Nd;Ov=1,Object.defineProperty(Nd,"__esModule",{value:!0});class e extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Nd.default=e,Nd}var jv;function fy(){if(jv)return dl;jv=1;var e=dl&&dl.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(dl,"__esModule",{value:!0});const r=e(XN),t=e(dy());class n{constructor(l){var c,f;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(f=l.isMaybeSingle)!==null&&f!==void 0?f:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const f=this.fetch;let m=f(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var x,y,b,E;let S=null,k=null,C=null,R=g.status,j=g.statusText;if(g.ok){if(this.method!=="HEAD"){const z=await g.text();z===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((x=this.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?k=z:k=JSON.parse(z))}const F=(y=this.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),K=(b=g.headers.get("content-range"))===null||b===void 0?void 0:b.split("/");F&&K&&K.length>1&&(C=parseInt(K[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(k)&&(k.length>1?(S={code:"PGRST116",details:`Results contain ${k.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},k=null,C=null,R=406,j="Not Acceptable"):k.length===1?k=k[0]:k=null)}else{const F=await g.text();try{S=JSON.parse(F),Array.isArray(S)&&g.status===404&&(k=[],S=null,R=200,j="OK")}catch{g.status===404&&F===""?(R=204,j="No Content"):S={message:F}}if(S&&this.isMaybeSingle&&(!((E=S?.details)===null||E===void 0)&&E.includes("0 rows"))&&(S=null,R=200,j="OK"),S&&this.shouldThrowOnError)throw new t.default(S)}return{error:S,data:k,count:C,status:R,statusText:j}});return this.shouldThrowOnError||(m=m.catch(g=>{var x,y,b;return{error:{message:`${(x=g?.name)!==null&&x!==void 0?x:"FetchError"}: ${g?.message}`,details:`${(y=g?.stack)!==null&&y!==void 0?y:""}`,hint:"",code:`${(b=g?.code)!==null&&b!==void 0?b:""}`},data:null,count:null,status:0,statusText:""}})),m.then(l,c)}returns(){return this}overrideTypes(){return this}}return dl.default=n,dl}var Fv;function hy(){if(Fv)return ul;Fv=1;var e=ul&&ul.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ul,"__esModule",{value:!0});const r=e(fy());class t extends r.default{select(a){let l=!1;const c=(a??"*").split("").map(f=>/\s/.test(f)&&!l?"":(f==='"'&&(l=!l),f)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:f,referencedTable:m=f}={}){const g=m?`${m}.order`:"order",x=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${x?`${x},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const f=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(f,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:f=c}={}){const m=typeof f>"u"?"offset":`${f}.offset`,g=typeof f>"u"?"limit":`${f}.limit`;return this.url.searchParams.set(m,`${a}`),this.url.searchParams.set(g,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:f=!1,wal:m=!1,format:g="text"}={}){var x;const y=[a?"analyze":null,l?"verbose":null,c?"settings":null,f?"buffers":null,m?"wal":null].filter(Boolean).join("|"),b=(x=this.headers.get("Accept"))!==null&&x!==void 0?x:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${b}"; options=${y};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return ul.default=t,ul}var Lv;function _m(){if(Lv)return cl;Lv=1;var e=cl&&cl.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(cl,"__esModule",{value:!0});const r=e(hy());class t extends r.default{eq(a,l){return this.url.searchParams.append(a,`eq.${l}`),this}neq(a,l){return this.url.searchParams.append(a,`neq.${l}`),this}gt(a,l){return this.url.searchParams.append(a,`gt.${l}`),this}gte(a,l){return this.url.searchParams.append(a,`gte.${l}`),this}lt(a,l){return this.url.searchParams.append(a,`lt.${l}`),this}lte(a,l){return this.url.searchParams.append(a,`lte.${l}`),this}like(a,l){return this.url.searchParams.append(a,`like.${l}`),this}likeAllOf(a,l){return this.url.searchParams.append(a,`like(all).{${l.join(",")}}`),this}likeAnyOf(a,l){return this.url.searchParams.append(a,`like(any).{${l.join(",")}}`),this}ilike(a,l){return this.url.searchParams.append(a,`ilike.${l}`),this}ilikeAllOf(a,l){return this.url.searchParams.append(a,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(a,l){return this.url.searchParams.append(a,`ilike(any).{${l.join(",")}}`),this}is(a,l){return this.url.searchParams.append(a,`is.${l}`),this}in(a,l){const c=Array.from(new Set(l)).map(f=>typeof f=="string"&&new RegExp("[,()]").test(f)?`"${f}"`:`${f}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}contains(a,l){return typeof l=="string"?this.url.searchParams.append(a,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(a,`cs.{${l.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(l)}`),this}containedBy(a,l){return typeof l=="string"?this.url.searchParams.append(a,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(a,`cd.{${l.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(l)}`),this}rangeGt(a,l){return this.url.searchParams.append(a,`sr.${l}`),this}rangeGte(a,l){return this.url.searchParams.append(a,`nxl.${l}`),this}rangeLt(a,l){return this.url.searchParams.append(a,`sl.${l}`),this}rangeLte(a,l){return this.url.searchParams.append(a,`nxr.${l}`),this}rangeAdjacent(a,l){return this.url.searchParams.append(a,`adj.${l}`),this}overlaps(a,l){return typeof l=="string"?this.url.searchParams.append(a,`ov.${l}`):this.url.searchParams.append(a,`ov.{${l.join(",")}}`),this}textSearch(a,l,{config:c,type:f}={}){let m="";f==="plain"?m="pl":f==="phrase"?m="ph":f==="websearch"&&(m="w");const g=c===void 0?"":`(${c})`;return this.url.searchParams.append(a,`${m}fts${g}.${l}`),this}match(a){return Object.entries(a).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(a,l,c){return this.url.searchParams.append(a,`not.${l}.${c}`),this}or(a,{foreignTable:l,referencedTable:c=l}={}){const f=c?`${c}.or`:"or";return this.url.searchParams.append(f,`(${a})`),this}filter(a,l,c){return this.url.searchParams.append(a,`${l}.${c}`),this}}return cl.default=t,cl}var Rv;function my(){if(Rv)return ll;Rv=1;var e=ll&&ll.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ll,"__esModule",{value:!0});const r=e(_m());class t{constructor(a,{headers:l={},schema:c,fetch:f}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=f}select(a,{head:l=!1,count:c}={}){const f=l?"HEAD":"GET";let m=!1;const g=(a??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",g),c&&this.headers.append("Prefer",`count=${c}`),new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var f;const m="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const g=a.reduce((x,y)=>x.concat(Object.keys(y)),[]);if(g.length>0){const x=[...new Set(g)].map(y=>`"${y}"`);this.url.searchParams.set("columns",x.join(","))}}return new r.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:f,defaultToNull:m=!0}={}){var g;const x="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),f&&this.headers.append("Prefer",`count=${f}`),m||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const y=a.reduce((b,E)=>b.concat(Object.keys(E)),[]);if(y.length>0){const b=[...new Set(y)].map(E=>`"${E}"`);this.url.searchParams.set("columns",b.join(","))}}return new r.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(a,{count:l}={}){var c;const f="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new r.default({method:f,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new r.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return ll.default=t,ll}var Mv;function JN(){if(Mv)return ol;Mv=1;var e=ol&&ol.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(ol,"__esModule",{value:!0});const r=e(my()),t=e(_m());class n{constructor(l,{headers:c={},schema:f,fetch:m}={}){this.url=l,this.headers=new Headers(c),this.schemaName=f,this.fetch=m}from(l){const c=new URL(`${this.url}/${l}`);return new r.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new n(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:f=!1,get:m=!1,count:g}={}){var x;let y;const b=new URL(`${this.url}/rpc/${l}`);let E;f||m?(y=f?"HEAD":"GET",Object.entries(c).filter(([k,C])=>C!==void 0).map(([k,C])=>[k,Array.isArray(C)?`{${C.join(",")}}`:`${C}`]).forEach(([k,C])=>{b.searchParams.append(k,C)})):(y="POST",E=c);const S=new Headers(this.headers);return g&&S.set("Prefer",`count=${g}`),new t.default({method:y,url:b,headers:S,schema:this.schemaName,body:E,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}}return ol.default=n,ol}var Bv;function QN(){if(Bv)return Mr;Bv=1;var e=Mr&&Mr.__importDefault||function(f){return f&&f.__esModule?f:{default:f}};Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.PostgrestError=Mr.PostgrestBuilder=Mr.PostgrestTransformBuilder=Mr.PostgrestFilterBuilder=Mr.PostgrestQueryBuilder=Mr.PostgrestClient=void 0;const r=e(JN());Mr.PostgrestClient=r.default;const t=e(my());Mr.PostgrestQueryBuilder=t.default;const n=e(_m());Mr.PostgrestFilterBuilder=n.default;const a=e(hy());Mr.PostgrestTransformBuilder=a.default;const l=e(fy());Mr.PostgrestBuilder=l.default;const c=e(dy());return Mr.PostgrestError=c.default,Mr.default={PostgrestClient:r.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},Mr}var e4=QN();const t4=sf(e4),{PostgrestClient:r4,PostgrestQueryBuilder:DD,PostgrestFilterBuilder:ID,PostgrestTransformBuilder:OD,PostgrestBuilder:jD,PostgrestError:FD}=t4;class n4{static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let t=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(t+=`

Suggested solution: ${r.workaround}`),new Error(t)}static createWebSocket(r,t){const n=this.getWebSocketConstructor();return new n(r,t)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const a4="2.15.1",i4=`realtime-js/${a4}`,s4="1.0.0",C0=1e4,o4=1e3,l4=100;var Bc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Bc||(Bc={}));var Nr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Nr||(Nr={}));var Pa;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Pa||(Pa={}));var A0;(function(e){e.websocket="websocket"})(A0||(A0={}));var ao;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ao||(ao={}));class c4{constructor(){this.HEADER_LENGTH=1}decode(r,t){return r.constructor===ArrayBuffer?t(this._binaryDecode(r)):t(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const t=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,t,n)}_decodeBroadcast(r,t,n){const a=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const f=n.decode(r.slice(c,c+a));c=c+a;const m=n.decode(r.slice(c,c+l));c=c+l;const g=JSON.parse(n.decode(r.slice(c,r.byteLength)));return{ref:null,topic:f,event:m,payload:g}}}class py{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Gt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Gt||(Gt={}));const zv=(e,r,t={})=>{var n;const a=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((l,c)=>(l[c]=u4(c,e,r,a),l),{})},u4=(e,r,t,n)=>{const a=r.find(f=>f.name===e),l=a?.type,c=t[e];return l&&!n.includes(l)?gy(l,c):P0(c)},gy=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return m4(r,t)}switch(e){case Gt.bool:return d4(r);case Gt.float4:case Gt.float8:case Gt.int2:case Gt.int4:case Gt.int8:case Gt.numeric:case Gt.oid:return f4(r);case Gt.json:case Gt.jsonb:return h4(r);case Gt.timestamp:return p4(r);case Gt.abstime:case Gt.date:case Gt.daterange:case Gt.int4range:case Gt.int8range:case Gt.money:case Gt.reltime:case Gt.text:case Gt.time:case Gt.timestamptz:case Gt.timetz:case Gt.tsrange:case Gt.tstzrange:return P0(r);default:return P0(r)}},P0=e=>e,d4=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},f4=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},h4=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(r){return console.log(`JSON parse error: ${r}`),e}return e},m4=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,n=e[t];if(e[0]==="{"&&n==="}"){let l;const c=e.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(f=>gy(r,f))}return e},p4=e=>typeof e=="string"?e.replace(" ","T"):e,vy=e=>{let r=e;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")+"/api/broadcast"};class r0{constructor(r,t,n={},a=C0){this.channel=r,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var n;return this._hasReceived(r)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Uv;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Uv||(Uv={}));class zc{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.joinRef=this.channel._joinRef(),this.state=zc.syncState(this.state,a,l,c),this.pendingDiffs.forEach(m=>{this.state=zc.syncDiff(this.state,m,l,c)}),this.pendingDiffs=[],f()}),this.channel._on(n.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:f}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=zc.syncDiff(this.state,a,l,c),f())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,n,a){const l=this.cloneDeep(r),c=this.transformState(t),f={},m={};return this.map(l,(g,x)=>{c[g]||(m[g]=x)}),this.map(c,(g,x)=>{const y=l[g];if(y){const b=x.map(C=>C.presence_ref),E=y.map(C=>C.presence_ref),S=x.filter(C=>E.indexOf(C.presence_ref)<0),k=y.filter(C=>b.indexOf(C.presence_ref)<0);S.length>0&&(f[g]=S),k.length>0&&(m[g]=k)}else f[g]=x}),this.syncDiff(l,{joins:f,leaves:m},n,a)}static syncDiff(r,t,n,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(l,(f,m)=>{var g;const x=(g=r[f])!==null&&g!==void 0?g:[];if(r[f]=this.cloneDeep(m),x.length>0){const y=r[f].map(E=>E.presence_ref),b=x.filter(E=>y.indexOf(E.presence_ref)<0);r[f].unshift(...b)}n(f,x,m)}),this.map(c,(f,m)=>{let g=r[f];if(!g)return;const x=m.map(y=>y.presence_ref);g=g.filter(y=>x.indexOf(y.presence_ref)<0),r[f]=g,a(f,g,m),g.length===0&&delete r[f]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(n=>t(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,n)=>{const a=r[n];return"metas"in a?t[n]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[n]=a,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $v;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})($v||($v={}));var Uc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Uc||(Uc={}));var Si;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Si||(Si={}));class wm{constructor(r,t={config:{}},n){this.topic=r,this.params=t,this.socket=n,this.bindings={},this.state=Nr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new r0(this,Pa.join,this.params,this.timeout),this.rejoinTimer=new py(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Nr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Pa.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new zc(this),this.broadcastEndpointURL=vy(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(r,t=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Nr.closed){const{config:{broadcast:l,presence:c,private:f}}=this.params,m=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(b=>b.filter))!==null&&a!==void 0?a:[],g=!!this.bindings[Uc.PRESENCE]&&this.bindings[Uc.PRESENCE].length>0,x={},y={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:g}),postgres_changes:m,private:f};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(b=>r?.(Si.CHANNEL_ERROR,b)),this._onClose(()=>r?.(Si.CLOSED)),this.updateJoinPayload(Object.assign({config:y},x)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:b})=>{var E;if(this.socket.setAuth(),b===void 0){r?.(Si.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,k=(E=S?.length)!==null&&E!==void 0?E:0,C=[];for(let R=0;R<k;R++){const j=S[R],{filter:{event:N,schema:F,table:K,filter:z}}=j,O=b&&b[R];if(O&&O.event===N&&O.schema===F&&O.table===K&&O.filter===z)C.push(Object.assign(Object.assign({},j),{id:O.id}));else{this.unsubscribe(),this.state=Nr.errored,r?.(Si.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,r&&r(Si.SUBSCRIBED);return}}).receive("error",b=>{this.state=Nr.errored,r?.(Si.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{r?.(Si.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,n){return this.state===Nr.joined&&r===Uc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(r,t,n)}async send(r,t={}){var n,a;if(!this._canPush()&&r.type==="broadcast"){const{event:l,payload:c}=r,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=g.body)===null||a===void 0?void 0:a.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,f,m;const g=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((m=(f=(c=this.params)===null||c===void 0?void 0:c.config)===null||f===void 0?void 0:f.broadcast)===null||m===void 0)&&m.ack)&&l("ok"),g.receive("ok",()=>l("ok")),g.receive("error",()=>l("error")),g.receive("timeout",()=>l("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Nr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Pa.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new r0(this,Pa.leave,{},r),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Nr.closed,this.bindings={}}async _fetchWithTimeout(r,t,n){const a=new AbortController,l=setTimeout(()=>a.abort(),n),c=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(r,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new r0(this,r,t,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>l4){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(r,t,n){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,n){var a,l;const c=r.toLocaleLowerCase(),{close:f,error:m,leave:g,join:x}=Pa;if(n&&[f,m,g,x].indexOf(c)>=0&&n!==this._joinRef())return;let b=this._onMessage(c,t,n);if(t&&!b)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(E=>{var S,k,C;return((S=E.filter)===null||S===void 0?void 0:S.event)==="*"||((C=(k=E.filter)===null||k===void 0?void 0:k.event)===null||C===void 0?void 0:C.toLocaleLowerCase())===c}).map(E=>E.callback(b,n)):(l=this.bindings[c])===null||l===void 0||l.filter(E=>{var S,k,C,R,j,N;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in E){const F=E.id,K=(S=E.filter)===null||S===void 0?void 0:S.event;return F&&((k=t.ids)===null||k===void 0?void 0:k.includes(F))&&(K==="*"||K?.toLocaleLowerCase()===((C=t.data)===null||C===void 0?void 0:C.type.toLocaleLowerCase()))}else{const F=(j=(R=E?.filter)===null||R===void 0?void 0:R.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return F==="*"||F===((N=t?.event)===null||N===void 0?void 0:N.toLocaleLowerCase())}else return E.type.toLocaleLowerCase()===c}).map(E=>{if(typeof b=="object"&&"ids"in b){const S=b.data,{schema:k,table:C,commit_timestamp:R,type:j,errors:N}=S;b=Object.assign(Object.assign({},{schema:k,table:C,commit_timestamp:R,eventType:j,new:{},old:{},errors:N}),this._getPayloadRecords(S))}E.callback(b,n)})}_isClosed(){return this.state===Nr.closed}_isJoined(){return this.state===Nr.joined}_isJoining(){return this.state===Nr.joining}_isLeaving(){return this.state===Nr.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,n){const a=r.toLocaleLowerCase(),l={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(r,t){const n=r.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&wm.isEqual(a.filter,t))})),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(r[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Pa.close,{},r)}_onError(r){this._on(Pa.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nr.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=zv(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=zv(r.columns,r.old_record)),t}}const Wv=()=>{},Dd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},g4=[1e3,2e3,5e3,1e4],v4=1e4,x4=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class y4{constructor(r,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=C0,this.transport=null,this.heartbeatIntervalMs=Dd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Wv,this.ref=0,this.reconnectTimer=null,this.logger=Wv,this.conn=null,this.sendBuffer=[],this.serializer=new c4,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let l;return a?l=a:typeof fetch>"u"?l=(...c)=>Qa(async()=>{const{default:f}=await Promise.resolve().then(()=>Ol);return{default:f}},void 0).then(({default:f})=>f(...c)).catch(f=>{throw new Error(`Failed to load @supabase/node-fetch: ${f.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${r}/${A0.websocket}`,this.httpEndpoint=vy(r),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=n4.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const t=r.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:s4}))}disconnect(r,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},r?this.conn.close(r,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,t,n){this.logger(r,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Bc.connecting:return ao.Connecting;case Bc.open:return ao.Open;case Bc.closing:return ao.Closing;default:return ao.Closed}}isConnected(){return this.connectionState()===ao.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,t={config:{}}){const n=`realtime:${r}`,a=this.getChannels().find(l=>l.topic===n);if(a)return a;{const l=new wm(`realtime:${r}`,t,this);return this.channels.push(l),l}}push(r){const{topic:t,event:n,payload:a,ref:l}=r,c=()=>{this.encode(r,f=>{var m;(m=this.conn)===null||m===void 0||m.send(f)})};this.log("push",`${t} ${n} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var r;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(o4,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Dd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:l,ref:c}=t,f=c?`(${c})`:"",m=l.status||"";this.log("receive",`${m} ${n} ${a} ${f}`.trim(),l),this.channels.filter(g=>g._isMember(n)).forEach(g=>g._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(r){var t;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){var t;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(Pa.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const n=r.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${r}${n}${a}`}_workerObjectUrl(r){let t;if(r)t=r;else{const n=new Blob([x4],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(r,t=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(r=null){let t;r?t=r:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const a={access_token:t,version:i4};t&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Pa.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${r}`,t)})}_triggerStateCallbacks(r,t){try{this.stateChangeCallbacks[r].forEach(n=>{try{n(t)}catch(a){this.log("error",`error in ${r} callback`,a)}})}catch(n){this.log("error",`error triggering ${r} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new py(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Dd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var t,n,a,l,c,f,m,g;if(this.transport=(t=r?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=r?.timeout)!==null&&n!==void 0?n:C0,this.heartbeatIntervalMs=(a=r?.heartbeatIntervalMs)!==null&&a!==void 0?a:Dd.HEARTBEAT_INTERVAL,this.worker=(l=r?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=r?.accessToken)!==null&&c!==void 0?c:null,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(f=r?.reconnectAfterMs)!==null&&f!==void 0?f:(x=>g4[x-1]||v4),this.encode=(m=r?.encode)!==null&&m!==void 0?m:((x,y)=>y(JSON.stringify(x))),this.decode=(g=r?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}class bm extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function Dr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class _4 extends bm{constructor(r,t,n){super(r),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class N0 extends bm{constructor(r,t){super(r),this.name="StorageUnknownError",this.originalError=t}}var w4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(x){try{g(n.next(x))}catch(y){c(y)}}function m(x){try{g(n.throw(x))}catch(y){c(y)}}function g(x){x.done?l(x.value):a(x.value).then(f,m)}g((n=n.apply(e,r||[])).next())})};const xy=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Qa(async()=>{const{default:n}=await Promise.resolve().then(()=>Ol);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},b4=()=>w4(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Qa(()=>Promise.resolve().then(()=>Ol),void 0)).Response:Response}),D0=e=>{if(Array.isArray(e))return e.map(t=>D0(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,n])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));r[a]=D0(n)}),r},k4=e=>{if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var _o=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(x){try{g(n.next(x))}catch(y){c(y)}}function m(x){try{g(n.throw(x))}catch(y){c(y)}}function g(x){x.done?l(x.value):a(x.value).then(f,m)}g((n=n.apply(e,r||[])).next())})};const n0=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),S4=(e,r,t)=>_o(void 0,void 0,void 0,function*(){const n=yield b4();e instanceof n&&!t?.noResolveJson?e.json().then(a=>{const l=e.status||500,c=a?.statusCode||l+"";r(new _4(n0(a),l,c))}).catch(a=>{r(new N0(n0(a),a))}):r(new N0(n0(e),e))}),T4=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return e==="GET"||!n?a:(k4(n)?(a.headers=Object.assign({"Content-Type":"application/json"},r?.headers),a.body=JSON.stringify(n)):a.body=n,r?.duplex&&(a.duplex=r.duplex),Object.assign(Object.assign({},a),t))};function lu(e,r,t,n,a,l){return _o(this,void 0,void 0,function*(){return new Promise((c,f)=>{e(t,T4(r,n,a,l)).then(m=>{if(!m.ok)throw m;return n?.noResolveJson?m:m.json()}).then(m=>c(m)).catch(m=>S4(m,f,n))})})}function nf(e,r,t,n){return _o(this,void 0,void 0,function*(){return lu(e,"GET",r,t,n)})}function Ya(e,r,t,n,a){return _o(this,void 0,void 0,function*(){return lu(e,"POST",r,n,a,t)})}function I0(e,r,t,n,a){return _o(this,void 0,void 0,function*(){return lu(e,"PUT",r,n,a,t)})}function E4(e,r,t,n){return _o(this,void 0,void 0,function*(){return lu(e,"HEAD",r,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function yy(e,r,t,n,a){return _o(this,void 0,void 0,function*(){return lu(e,"DELETE",r,n,a,t)})}var mn=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(x){try{g(n.next(x))}catch(y){c(y)}}function m(x){try{g(n.throw(x))}catch(y){c(y)}}function g(x){x.done?l(x.value):a(x.value).then(f,m)}g((n=n.apply(e,r||[])).next())})};const C4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class A4{constructor(r,t={},n,a){this.url=r,this.headers=t,this.bucketId=n,this.fetch=xy(a)}uploadOrUpdate(r,t,n,a){return mn(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Vv),a);let f=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(c.upsert)});const m=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m))):(l=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType,m&&(f["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),a?.headers&&(f=Object.assign(Object.assign({},f),a.headers));const g=this._removeEmptyFolders(t),x=this._getFinalPath(g),y=yield(r=="PUT"?I0:Ya)(this.fetch,`${this.url}/object/${x}`,l,Object.assign({headers:f},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:g,id:y.Id,fullPath:y.Key},error:null}}catch(l){if(Dr(l))return{data:null,error:l};throw l}})}upload(r,t,n){return mn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,t,n)})}uploadToSignedUrl(r,t,n,a){return mn(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(r),c=this._getFinalPath(l),f=new URL(this.url+`/object/upload/sign/${c}`);f.searchParams.set("token",t);try{let m;const g=Object.assign({upsert:Vv.upsert},a),x=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&n instanceof Blob?(m=new FormData,m.append("cacheControl",g.cacheControl),m.append("",n)):typeof FormData<"u"&&n instanceof FormData?(m=n,m.append("cacheControl",g.cacheControl)):(m=n,x["cache-control"]=`max-age=${g.cacheControl}`,x["content-type"]=g.contentType);const y=yield I0(this.fetch,f.toString(),m,{headers:x});return{data:{path:l,fullPath:y.Key},error:null}}catch(m){if(Dr(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(r,t){return mn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const a=Object.assign({},this.headers);t?.upsert&&(a["x-upsert"]="true");const l=yield Ya(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),c=new URL(this.url+l.url),f=c.searchParams.get("token");if(!f)throw new bm("No token returned by API");return{data:{signedUrl:c.toString(),path:r,token:f},error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}update(r,t,n){return mn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,t,n)})}move(r,t,n){return mn(this,void 0,void 0,function*(){try{return{data:yield Ya(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}copy(r,t,n){return mn(this,void 0,void 0,function*(){try{return{data:{path:(yield Ya(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}createSignedUrl(r,t,n){return mn(this,void 0,void 0,function*(){try{let a=this._getFinalPath(r),l=yield Ya(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n?.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}createSignedUrls(r,t,n){return mn(this,void 0,void 0,function*(){try{const a=yield Ya(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:r},{headers:this.headers}),l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}download(r,t){return mn(this,void 0,void 0,function*(){const a=typeof t?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(t?.transform||{}),c=l?`?${l}`:"";try{const f=this._getFinalPath(r);return{data:yield(yield nf(this.fetch,`${this.url}/${a}/${f}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(f){if(Dr(f))return{data:null,error:f};throw f}})}info(r){return mn(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{const n=yield nf(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:D0(n),error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}exists(r){return mn(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{return yield E4(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Dr(n)&&n instanceof N0){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,t){const n=this._getFinalPath(r),a=[],l=t?.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&a.push(l);const f=typeof t?.transform<"u"?"render/image":"object",m=this.transformOptsToQueryString(t?.transform||{});m!==""&&a.push(m);let g=a.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${f}/public/${n}${g}`)}}}remove(r){return mn(this,void 0,void 0,function*(){try{return{data:yield yy(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(t){if(Dr(t))return{data:null,error:t};throw t}})}list(r,t,n){return mn(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},C4),t),{prefix:r||""});return{data:yield Ya(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}listV2(r,t){return mn(this,void 0,void 0,function*(){try{const n=Object.assign({},r);return{data:yield Ya(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const t=[];return r.width&&t.push(`width=${r.width}`),r.height&&t.push(`height=${r.height}`),r.resize&&t.push(`resize=${r.resize}`),r.format&&t.push(`format=${r.format}`),r.quality&&t.push(`quality=${r.quality}`),t.join("&")}}const P4="2.11.0",N4={"X-Client-Info":`storage-js/${P4}`};var fl=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(x){try{g(n.next(x))}catch(y){c(y)}}function m(x){try{g(n.throw(x))}catch(y){c(y)}}function g(x){x.done?l(x.value):a(x.value).then(f,m)}g((n=n.apply(e,r||[])).next())})};class D4{constructor(r,t={},n,a){const l=new URL(r);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},N4),t),this.fetch=xy(n)}listBuckets(){return fl(this,void 0,void 0,function*(){try{return{data:yield nf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(Dr(r))return{data:null,error:r};throw r}})}getBucket(r){return fl(this,void 0,void 0,function*(){try{return{data:yield nf(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(t){if(Dr(t))return{data:null,error:t};throw t}})}createBucket(r,t={public:!1}){return fl(this,void 0,void 0,function*(){try{return{data:yield Ya(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}updateBucket(r,t){return fl(this,void 0,void 0,function*(){try{return{data:yield I0(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}emptyBucket(r){return fl(this,void 0,void 0,function*(){try{return{data:yield Ya(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Dr(t))return{data:null,error:t};throw t}})}deleteBucket(r){return fl(this,void 0,void 0,function*(){try{return{data:yield yy(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(t){if(Dr(t))return{data:null,error:t};throw t}})}}class I4 extends D4{constructor(r,t={},n,a){super(r,t,n,a)}from(r){return new A4(this.url,this.headers,r,this.fetch)}}const O4="2.56.0";let Cc="";typeof Deno<"u"?Cc="deno":typeof document<"u"?Cc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Cc="react-native":Cc="node";const j4={"X-Client-Info":`supabase-js-${Cc}/${O4}`},F4={headers:j4},L4={schema:"public"},R4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},M4={};var B4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(x){try{g(n.next(x))}catch(y){c(y)}}function m(x){try{g(n.throw(x))}catch(y){c(y)}}function g(x){x.done?l(x.value):a(x.value).then(f,m)}g((n=n.apply(e,r||[])).next())})};const z4=e=>{let r;return e?r=e:typeof fetch>"u"?r=cy:r=fetch,(...t)=>r(...t)},U4=()=>typeof Headers>"u"?uy:Headers,$4=(e,r,t)=>{const n=z4(t),a=U4();return(l,c)=>B4(void 0,void 0,void 0,function*(){var f;const m=(f=yield r())!==null&&f!==void 0?f:e;let g=new a(c?.headers);return g.has("apikey")||g.set("apikey",e),g.has("Authorization")||g.set("Authorization",`Bearer ${m}`),n(l,Object.assign(Object.assign({},c),{headers:g}))})};var W4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(x){try{g(n.next(x))}catch(y){c(y)}}function m(x){try{g(n.throw(x))}catch(y){c(y)}}function g(x){x.done?l(x.value):a(x.value).then(f,m)}g((n=n.apply(e,r||[])).next())})};function V4(e){return e.endsWith("/")?e:e+"/"}function H4(e,r){var t,n;const{db:a,auth:l,realtime:c,global:f}=e,{db:m,auth:g,realtime:x,global:y}=r,b={db:Object.assign(Object.assign({},m),a),auth:Object.assign(Object.assign({},g),l),realtime:Object.assign(Object.assign({},x),c),storage:{},global:Object.assign(Object.assign(Object.assign({},y),f),{headers:Object.assign(Object.assign({},(t=y?.headers)!==null&&t!==void 0?t:{}),(n=f?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>W4(this,void 0,void 0,function*(){return""})};return e.accessToken?b.accessToken=e.accessToken:delete b.accessToken,b}const _y="2.71.1",xl=30*1e3,O0=3,a0=O0*xl,G4="http://localhost:9999",Z4="supabase.auth.token",K4={"X-Client-Info":`gotrue-js/${_y}`},j0="X-Supabase-Api-Version",wy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},q4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Y4=600*1e3;class km extends Error{constructor(r,t,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function bt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class X4 extends km{constructor(r,t,n){super(r,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function J4(e){return bt(e)&&e.name==="AuthApiError"}class by extends km{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class Cs extends km{constructor(r,t,n,a){super(r,n,a),this.name=t,this.status=n}}class gs extends Cs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Q4(e){return bt(e)&&e.name==="AuthSessionMissingError"}class Id extends Cs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Od extends Cs{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class jd extends Cs{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function e3(e){return bt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Hv extends Cs{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class F0 extends Cs{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function i0(e){return bt(e)&&e.name==="AuthRetryableFetchError"}class Gv extends Cs{constructor(r,t,n){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class L0 extends Cs{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const af="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zv=` 	
\r=`.split(""),t3=(()=>{const e=new Array(128);for(let r=0;r<e.length;r+=1)e[r]=-1;for(let r=0;r<Zv.length;r+=1)e[Zv[r].charCodeAt(0)]=-2;for(let r=0;r<af.length;r+=1)e[af[r].charCodeAt(0)]=r;return e})();function Kv(e,r,t){if(e!==null)for(r.queue=r.queue<<8|e,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(af[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(af[n]),r.queuedBits-=6}}function ky(e,r,t){const n=t3[e];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)t(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function qv(e){const r=[],t=c=>{r.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{a3(c,n,t)};for(let c=0;c<e.length;c+=1)ky(e.charCodeAt(c),a,l);return r.join("")}function r3(e,r){if(e<=127){r(e);return}else if(e<=2047){r(192|e>>6),r(128|e&63);return}else if(e<=65535){r(224|e>>12),r(128|e>>6&63),r(128|e&63);return}else if(e<=1114111){r(240|e>>18),r(128|e>>12&63),r(128|e>>6&63),r(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function n3(e,r){for(let t=0;t<e.length;t+=1){let n=e.charCodeAt(t);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}r3(n,r)}}function a3(e,r,t){if(r.utf8seq===0){if(e<=127){t(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=e&31;else if(r.utf8seq===3)r.codepoint=e&15;else if(r.utf8seq===4)r.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|e&63,r.utf8seq-=1,r.utf8seq===0&&t(r.codepoint)}}function i3(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};for(let a=0;a<e.length;a+=1)ky(e.charCodeAt(a),t,n);return new Uint8Array(r)}function s3(e){const r=[];return n3(e,t=>r.push(t)),new Uint8Array(r)}function o3(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};return e.forEach(a=>Kv(a,t,n)),Kv(null,t,n),r.join("")}function l3(e){return Math.round(Date.now()/1e3)+e}function c3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e=="x"?r:r&3|8).toString(16)})}const Aa=()=>typeof window<"u"&&typeof document<"u",Js={tested:!1,writable:!1},Sy=()=>{if(!Aa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Js.tested)return Js.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Js.tested=!0,Js.writable=!0}catch{Js.tested=!0,Js.writable=!1}return Js.writable};function u3(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{r[l]=a})}catch{}return t.searchParams.forEach((n,a)=>{r[a]=n}),r}const Ty=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Qa(async()=>{const{default:n}=await Promise.resolve().then(()=>Ol);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},d3=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",yl=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},Qs=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},ms=async(e,r)=>{await e.removeItem(r)};class ff{constructor(){this.promise=new ff.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}ff.promiseConstructor=Promise;function s0(e){const r=e.split(".");if(r.length!==3)throw new L0("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!q4.test(r[n]))throw new L0("JWT not in base64url format");return{header:JSON.parse(qv(r[0])),payload:JSON.parse(qv(r[1])),signature:i3(r[2]),raw:{header:r[0],payload:r[1]}}}async function f3(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function h3(e,r){return new Promise((n,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!r(l,null,c)){n(c);return}}catch(c){if(!r(l,c)){a(c);return}}})()})}function m3(e){return("0"+e.toString(16)).substr(-2)}function p3(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(r),Array.from(r,m3).join("")}async function g3(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function v3(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await g3(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function hl(e,r,t=!1){const n=p3();let a=n;t&&(a+="/PASSWORD_RECOVERY"),await yl(e,`${r}-code-verifier`,a);const l=await v3(n);return[l,n===l?"plain":"s256"]}const x3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function y3(e){const r=e.headers.get(j0);if(!r||!r.match(x3))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function _3(e){if(!e)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(e<=r)throw new Error("JWT has expired")}function w3(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const b3=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ml(e){if(!b3.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function o0(){const e={};return new Proxy(e,{get:(r,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Yv(e){return JSON.parse(JSON.stringify(e))}var k3=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};const to=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),S3=[502,503,504];async function Xv(e){var r;if(!d3(e))throw new F0(to(e),0);if(S3.includes(e.status))throw new F0(to(e),e.status);let t;try{t=await e.json()}catch(l){throw new by(to(l),l)}let n;const a=y3(e);if(a&&a.getTime()>=wy["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new Gv(to(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new gs}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Gv(to(t),e.status,t.weak_password.reasons);throw new X4(to(t),e.status||500,n)}const T3=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),t))};async function Ct(e,r,t,n){var a;const l=Object.assign({},n?.headers);l[j0]||(l[j0]=wy["2024-01-01"].name),n?.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(c.redirect_to=n.redirectTo);const f=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",m=await E3(e,r,t+f,{headers:l,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(m):{data:Object.assign({},m),error:null}}async function E3(e,r,t,n,a,l){const c=T3(r,n,a,l);let f;try{f=await e(t,Object.assign({},c))}catch(m){throw console.error(m),new F0(to(m),0)}if(f.ok||await Xv(f),n?.noResolveJson)return f;try{return await f.json()}catch(m){await Xv(m)}}function ki(e){var r;let t=null;N3(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=l3(e.expires_in)));const n=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:n},error:null}}function Jv(e){const r=ki(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(r.data.weak_password=e.weak_password),r}function ys(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function C3(e){return{data:e,error:null}}function A3(e){const{action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:l}=e,c=k3(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),f={action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:l},m=Object.assign({},c);return{data:{properties:f,user:m},error:null}}function P3(e){return e}function N3(e){return e.access_token&&e.refresh_token&&e.expires_in}const l0=["global","local","others"];var D3=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};class I3{constructor({url:r="",headers:t={},fetch:n}){this.url=r,this.headers=t,this.fetch=Ty(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,t=l0[0]){if(l0.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${l0.join(", ")}`);try{return await Ct(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(bt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,t={}){try{return await Ct(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:ys})}catch(n){if(bt(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:t}=r,n=D3(r,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await Ct(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:A3,redirectTo:t?.redirectTo})}catch(t){if(bt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await Ct(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:ys})}catch(t){if(bt(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,n,a,l,c,f,m;try{const g={nextPage:null,lastPage:0,total:0},x=await Ct(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=r?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=r?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:P3});if(x.error)throw x.error;const y=await x.json(),b=(c=x.headers.get("x-total-count"))!==null&&c!==void 0?c:0,E=(m=(f=x.headers.get("link"))===null||f===void 0?void 0:f.split(","))!==null&&m!==void 0?m:[];return E.length>0&&(E.forEach(S=>{const k=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),C=JSON.parse(S.split(";")[1].split("=")[1]);g[`${C}Page`]=k}),g.total=parseInt(b)),{data:Object.assign(Object.assign({},y),g),error:null}}catch(g){if(bt(g))return{data:{users:[]},error:g};throw g}}async getUserById(r){ml(r);try{return await Ct(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:ys})}catch(t){if(bt(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){ml(r);try{return await Ct(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:ys})}catch(n){if(bt(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,t=!1){ml(r);try{return await Ct(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:ys})}catch(n){if(bt(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){ml(r.userId);try{const{data:t,error:n}=await Ct(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:n}}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _deleteFactor(r){ml(r.userId),ml(r.id);try{return{data:await Ct(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(bt(t))return{data:null,error:t};throw t}}}function Qv(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}function O3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const pl={debug:!!(globalThis&&Sy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ey extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class j3 extends Ey{}async function F3(e,r,t){pl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),pl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){pl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await t()}finally{pl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(r===0)throw pl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new j3(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(pl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}O3();const L3={url:G4,storageKey:Z4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:K4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ex(e,r,t){return await t()}const gl={};class Jc{constructor(r){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Jc.nextInstanceID,Jc.nextInstanceID+=1,this.instanceID>0&&Aa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},L3),r);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new I3({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Ty(a.fetch),this.lock=a.lock||ex,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Aa()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=F3:this.lock=ex,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Sy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Qv(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Qv(this.memoryStorage)),Aa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var r,t;return(t=(r=gl[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(r){gl[this.storageKey]=Object.assign(Object.assign({},gl[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,t;return(t=(r=gl[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){gl[this.storageKey]=Object.assign(Object.assign({},gl[this.storageKey]),{cachedAt:r})}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${_y}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const t=u3(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Aa()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),e3(l)){const m=(r=l.details)===null||r===void 0?void 0:r.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:f}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",f),await this._saveSession(c),setTimeout(async()=>{f==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return bt(t)?{error:t}:{error:new by("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,n,a;try{const l=await Ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=r?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=r?.options)===null||a===void 0?void 0:a.captchaToken}},xform:ki}),{data:c,error:f}=l;if(f||!c)return{data:{user:null,session:null},error:f};const m=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:g,session:m},error:null}}catch(l){if(bt(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(r){var t,n,a;try{let l;if("email"in r){const{email:x,password:y,options:b}=r;let E=null,S=null;this.flowType==="pkce"&&([E,S]=await hl(this.storage,this.storageKey)),l=await Ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:b?.emailRedirectTo,body:{email:x,password:y,data:(t=b?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:b?.captchaToken},code_challenge:E,code_challenge_method:S},xform:ki})}else if("phone"in r){const{phone:x,password:y,options:b}=r;l=await Ct(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:y,data:(n=b?.data)!==null&&n!==void 0?n:{},channel:(a=b?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:b?.captchaToken}},xform:ki})}else throw new Od("You must provide either an email or phone number and a password");const{data:c,error:f}=l;if(f||!c)return{data:{user:null,session:null},error:f};const m=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:g,session:m},error:null}}catch(l){if(bt(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(r){try{let t;if("email"in r){const{email:l,password:c,options:f}=r;t=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Jv})}else if("phone"in r){const{phone:l,password:c,options:f}=r;t=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:Jv})}else throw new Od("You must provide either an email or phone number and a password");const{data:n,error:a}=t;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Id}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(bt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(r){var t,n,a,l;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=r.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=r.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:t}=r;if(t==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(r){var t,n,a,l,c,f,m,g,x,y,b,E;let S,k;if("message"in r)S=r.message,k=r.signature;else{const{chain:C,wallet:R,statement:j,options:N}=r;let F;if(Aa())if(typeof R=="object")F=R;else{const z=window;if("solana"in z&&typeof z.solana=="object"&&("signIn"in z.solana&&typeof z.solana.signIn=="function"||"signMessage"in z.solana&&typeof z.solana.signMessage=="function"))F=z.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof R!="object"||!N?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");F=R}const K=new URL((t=N?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in F&&F.signIn){const z=await F.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},N?.signInWithSolana),{version:"1",domain:K.host,uri:K.href}),j?{statement:j}:null));let O;if(Array.isArray(z)&&z[0]&&typeof z[0]=="object")O=z[0];else if(z&&typeof z=="object"&&"signedMessage"in z&&"signature"in z)O=z;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)S=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),k=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in F)||typeof F.signMessage!="function"||!("publicKey"in F)||typeof F!="object"||!F.publicKey||!("toBase58"in F.publicKey)||typeof F.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${K.host} wants you to sign in with your Solana account:`,F.publicKey.toBase58(),...j?["",j,""]:[""],"Version: 1",`URI: ${K.href}`,`Issued At: ${(a=(n=N?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=N?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${N.signInWithSolana.notBefore}`]:[],...!((c=N?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${N.signInWithSolana.expirationTime}`]:[],...!((f=N?.signInWithSolana)===null||f===void 0)&&f.chainId?[`Chain ID: ${N.signInWithSolana.chainId}`]:[],...!((m=N?.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${N.signInWithSolana.nonce}`]:[],...!((g=N?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${N.signInWithSolana.requestId}`]:[],...!((y=(x=N?.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||y===void 0)&&y.length?["Resources",...N.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const z=await F.signMessage(new TextEncoder().encode(S),"utf8");if(!z||!(z instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");k=z}}try{const{data:C,error:R}=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:o3(k)},!((b=r.options)===null||b===void 0)&&b.captchaToken?{gotrue_meta_security:{captcha_token:(E=r.options)===null||E===void 0?void 0:E.captchaToken}}:null),xform:ki});if(R)throw R;return!C||!C.session||!C.user?{data:{user:null,session:null},error:new Id}:(C.session&&(await this._saveSession(C.session),await this._notifyAllSubscribers("SIGNED_IN",C.session)),{data:Object.assign({},C),error:R})}catch(C){if(bt(C))return{data:{user:null,session:null},error:C};throw C}}async _exchangeCodeForSession(r){const t=await Qs(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(t??"").split("/");try{const{data:l,error:c}=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:ki});if(await ms(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Id}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(bt(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(r){try{const{options:t,provider:n,token:a,access_token:l,nonce:c}=r,f=await Ct(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:ki}),{data:m,error:g}=f;return g?{data:{user:null,session:null},error:g}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Id}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:g})}catch(t){if(bt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(r){var t,n,a,l,c;try{if("email"in r){const{email:f,options:m}=r;let g=null,x=null;this.flowType==="pkce"&&([g,x]=await hl(this.storage,this.storageKey));const{error:y}=await Ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:f,data:(t=m?.data)!==null&&t!==void 0?t:{},create_user:(n=m?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:g,code_challenge_method:x},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in r){const{phone:f,options:m}=r,{data:g,error:x}=await Ct(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:f,data:(a=m?.data)!==null&&a!==void 0?a:{},create_user:(l=m?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},channel:(c=m?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:x}}throw new Od("You must provide either an email or phone number.")}catch(f){if(bt(f))return{data:{user:null,session:null},error:f};throw f}}async verifyOtp(r){var t,n;try{let a,l;"options"in r&&(a=(t=r.options)===null||t===void 0?void 0:t.redirectTo,l=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:f}=await Ct(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:ki});if(f)throw f;if(!c)throw new Error("An error occurred on token verification.");const m=c.session,g=c.user;return m?.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:g,session:m},error:null}}catch(a){if(bt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(r){var t,n,a;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await hl(this.storage,this.storageKey)),await Ct(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=r?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:C3})}catch(l){if(bt(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:n}=r;if(n)throw n;if(!t)throw new gs;const{error:a}=await Ct(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(r){if(bt(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:n,type:a,options:l}=r,{error:c}=await Ct(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in r){const{phone:n,type:a,options:l}=r,{data:c,error:f}=await Ct(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:f}}throw new Od("You must provide either an email or phone number and a type")}catch(t){if(bt(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await Qs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<a0:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.userStorage){const c=await Qs(this.userStorage,this.storageKey+"-user");c?.user?r.user=c.user:r.user=o0()}if(this.storage.isServer&&r.user){let c=this.suppressGetSessionWarning;r=new Proxy(r,{get:(m,g,x)=>(!c&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,g,x))})}return{data:{session:r},error:null}}const{session:a,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await Ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:ys}):await this._useSession(async t=>{var n,a,l;const{data:c,error:f}=t;if(f)throw f;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new gs}:await Ct(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:ys})})}catch(t){if(bt(t))return Q4(t)&&(await this._removeSession(),await ms(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async n=>{const{data:a,error:l}=n;if(l)throw l;if(!a.session)throw new gs;const c=a.session;let f=null,m=null;this.flowType==="pkce"&&r.email!=null&&([f,m]=await hl(this.storage,this.storageKey));const{data:g,error:x}=await Ct(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:f,code_challenge_method:m}),jwt:c.access_token,xform:ys});if(x)throw x;return c.user=g.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(bt(n))return{data:{user:null},error:n};throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new gs;const t=Date.now()/1e3;let n=t,a=!0,l=null;const{payload:c}=s0(r.access_token);if(c.exp&&(n=c.exp,a=n<=t),a){const{session:f,error:m}=await this._callRefreshToken(r.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!f)return{data:{user:null,session:null},error:null};l=f}else{const{data:f,error:m}=await this._getUser(r.access_token);if(m)throw m;l={access_token:r.access_token,refresh_token:r.refresh_token,user:f.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(bt(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var n;if(!r){const{data:c,error:f}=t;if(f)throw f;r=(n=c.session)!==null&&n!==void 0?n:void 0}if(!r?.refresh_token)throw new gs;const{session:a,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(bt(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(r,t){try{if(!Aa())throw new jd("No browser detected.");if(r.error||r.error_description||r.error_code)throw new jd(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Hv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new jd("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new Hv("No code detected.");const{data:j,error:N}=await this._exchangeCodeForSession(r.code);if(N)throw N;const F=new URL(window.location.href);return F.searchParams.delete("code"),window.history.replaceState(window.history.state,"",F.toString()),{data:{session:j.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:f,expires_at:m,token_type:g}=r;if(!l||!f||!c||!g)throw new jd("No session defined in URL");const x=Math.round(Date.now()/1e3),y=parseInt(f);let b=x+y;m&&(b=parseInt(m));const E=b-x;E*1e3<=xl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${E}s, should have been closer to ${y}s`);const S=b-y;x-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,b,x):x-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,b,x);const{data:k,error:C}=await this._getUser(l);if(C)throw C;const R={provider_token:n,provider_refresh_token:a,access_token:l,expires_in:y,expires_at:b,refresh_token:c,token_type:g,user:k.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:R,redirectType:r.type},error:null}}catch(n){if(bt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await Qs(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return{error:l};const c=(n=a.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:f}=await this.admin.signOut(c,r);if(f&&!(J4(f)&&(f.status===404||f.status===401||f.status===403)))return{error:f}}return r!=="others"&&(await this._removeSession(),await ms(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const t=c3(),n={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async t=>{var n,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",r,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",l),console.error(l)}})}async resetPasswordForEmail(r,t={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await hl(this.storage,this.storageKey,!0));try{return await Ct(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(bt(l))return{data:null,error:l};throw l}}async getUserIdentities(){var r;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(t){if(bt(t))return{data:null,error:t};throw t}}async linkIdentity(r){var t;try{const{data:n,error:a}=await this._useSession(async l=>{var c,f,m,g,x;const{data:y,error:b}=l;if(b)throw b;const E=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(c=r.options)===null||c===void 0?void 0:c.redirectTo,scopes:(f=r.options)===null||f===void 0?void 0:f.scopes,queryParams:(m=r.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await Ct(this.fetch,"GET",E,{headers:this.headers,jwt:(x=(g=y.session)===null||g===void 0?void 0:g.access_token)!==null&&x!==void 0?x:void 0})});if(a)throw a;return Aa()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:r.provider,url:n?.url},error:null}}catch(n){if(bt(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async t=>{var n,a;const{data:l,error:c}=t;if(c)throw c;return await Ct(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await h3(async a=>(a>0&&await f3(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await Ct(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:ki})),(a,l)=>{const c=200*Math.pow(2,a);return l&&i0(l)&&Date.now()+c-n<xl})}catch(n){if(this._debug(t,"error",n),bt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",n),Aa()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Qs(this.storage,this.storageKey);if(a&&this.userStorage){let c=await Qs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await yl(this.userStorage,this.storageKey+"-user",c)),a.user=(r=c?.user)!==null&&r!==void 0?r:o0()}else if(a&&!a.user&&!a.user){const c=await Qs(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await ms(this.storage,this.storageKey+"-user"),await yl(this.storage,this.storageKey,a)):a.user=o0()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<a0;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${a0}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),i0(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:f}=await this._getUser(a.access_token);!f&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(r){var t,n;if(!r)throw new gs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new ff;const{data:l,error:c}=await this._refreshAccessToken(r);if(c)throw c;if(!l.session)throw new gs;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const f={session:l.session,error:null};return this.refreshingDeferred.resolve(f),f}catch(l){if(this._debug(a,"error",l),bt(l)){const c={session:null,error:l};return i0(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(r,t,n=!0){const a=`#_notifyAllSubscribers(${r})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async f=>{try{await f.callback(r,t)}catch(m){l.push(m)}});if(await Promise.all(c),l.length>0){for(let f=0;f<l.length;f+=1)console.error(l[f]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const t=Object.assign({},r),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await yl(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=Yv(a);await yl(this.storage,this.storageKey,l)}else{const a=Yv(t);await yl(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ms(this.storage,this.storageKey),await ms(this.storage,this.storageKey+"-code-verifier"),await ms(this.storage,this.storageKey+"-user"),this.userStorage&&await ms(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Aa()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),xl);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-r)/xl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${xl}ms, refresh threshold is ${O0} ticks`),a<=O0&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof Ey)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Aa()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,n){const a=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await hl(this.storage,this.storageKey),f=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(f.toString())}if(n?.queryParams){const l=new URLSearchParams(n.queryParams);a.push(l.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${a.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;return l?{data:null,error:l}:await Ct(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _enroll(r){try{return await this._useSession(async t=>{var n,a;const{data:l,error:c}=t;if(c)return{data:null,error:c};const f=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:m,error:g}=await Ct(this.fetch,"POST",`${this.url}/factors`,{body:f,headers:this.headers,jwt:(n=l?.session)===null||n===void 0?void 0:n.access_token});return g?{data:null,error:g}:(r.factorType==="totp"&&(!((a=m?.totp)===null||a===void 0)&&a.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(t){if(bt(t))return{data:null,error:t};throw t}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:f}=await Ct(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return f?{data:null,error:f}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:f})})}catch(t){if(bt(t))return{data:null,error:t};throw t}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;return l?{data:null,error:l}:await Ct(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(bt(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(r){const{data:t,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){const{data:{user:r},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=r?.factors||[],a=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var t,n;const{data:{session:a},error:l}=r;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=s0(a.access_token);let f=null;c.aal&&(f=c.aal);let m=f;((n=(t=a.user.factors)===null||t===void 0?void 0:t.filter(y=>y.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const x=c.amr||[];return{data:{currentLevel:f,nextLevel:m,currentAuthenticationMethods:x},error:null}}))}async fetchJwk(r,t={keys:[]}){let n=t.keys.find(f=>f.kid===r);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(f=>f.kid===r),n&&this.jwks_cached_at+Y4>a)return n;const{data:l,error:c}=await Ct(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,n=l.keys.find(f=>f.kid===r),!n)?null:n}async getClaims(r,t={}){try{let n=r;if(!n){const{data:E,error:S}=await this.getSession();if(S||!E.session)return{data:null,error:S};n=E.session.access_token}const{header:a,payload:l,signature:c,raw:{header:f,payload:m}}=s0(n);t?.allowExpired||_3(l.exp);const g=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!g){const{error:E}=await this.getUser(n);if(E)throw E;return{data:{claims:l,header:a,signature:c},error:null}}const x=w3(a.alg),y=await crypto.subtle.importKey("jwk",g,x,!0,["verify"]);if(!await crypto.subtle.verify(x,y,c,s3(`${f}.${m}`)))throw new L0("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(n){if(bt(n))return{data:null,error:n};throw n}}}Jc.nextInstanceID=0;const R3=Jc;class M3 extends R3{constructor(r){super(r)}}var B3=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function f(x){try{g(n.next(x))}catch(y){c(y)}}function m(x){try{g(n.throw(x))}catch(y){c(y)}}function g(x){x.done?l(x.value):a(x.value).then(f,m)}g((n=n.apply(e,r||[])).next())})};class z3{constructor(r,t,n){var a,l,c;if(this.supabaseUrl=r,this.supabaseKey=t,!r)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const f=V4(r),m=new URL(f);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const g=`sb-${m.hostname.split(".")[0]}-auth-token`,x={db:L4,realtime:M4,auth:Object.assign(Object.assign({},R4),{storageKey:g}),global:F4},y=H4(n??{},x);this.storageKey=(a=y.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=y.global.headers)!==null&&l!==void 0?l:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(b,E)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(E)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=y.auth)!==null&&c!==void 0?c:{},this.headers,y.global.fetch),this.fetch=$4(t,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new r4(new URL("rest/v1",m).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new I4(this.storageUrl.href,this.headers,this.fetch,n?.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new GN(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,t={},n={}){return this.rest.rpc(r,t,n)}channel(r,t={config:{}}){return this.realtime.channel(r,t)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,t;return B3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:a,storageKey:l,flowType:c,lock:f,debug:m},g,x){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M3({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),g),storageKey:l,autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:a,flowType:c,lock:f,debug:m,fetch:x,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new y4(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(r,t,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Cy=(e,r,t)=>new z3(e,r,t);function U3(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}U3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const $3="https://eevfxrgemrtthxbcxtvq.supabase.co",W3="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",Be=Cy($3,W3,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"navigator-supabase-auth-token",debug:!1},realtime:{params:{eventsPerSecond:5}}}),V3={navigator_restore_in_progress:3e4,navigator_import_in_progress:6e3,navigator_active_protection:5e3};function _s(e,r){const t=localStorage.getItem(e);if(!t)return!1;const n=parseInt(t,10);if(isNaN(n))return tx(e),!1;const a=V3[e],l=Date.now()-n;return r!==void 0&&l<r?!0:l>=a?(tx(e),!1):!0}function tx(e){localStorage.removeItem(e)}async function H3(e){if(!Be)throw new Error("Supabase not configured");const{data:r,error:t}=await Be.rpc("create_trial_subscription",{target_user_id:e});if(t)throw console.error("Failed to create trial subscription:",t),t;if(r&&!r.success)throw console.error("Trial subscription creation failed:",r.message),new Error(r.message)}function rx(){let e=localStorage.getItem("navigator_device_id");return e||(e=`device_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,localStorage.setItem("navigator_device_id",e)),e}function Ay(e,r){const t=typeof e.currentListVersion=="number"?e.currentListVersion:1,n=typeof r.currentListVersion=="number"?r.currentListVersion:1,a=R=>typeof R=="number"?R:Math.max(t,n),l=new Map,c=R=>{if(!R||typeof R.index!="number"||typeof R.timestamp!="string"||!R.outcome)return;const j={...R,listVersion:a(R.listVersion)},N=`${j.timestamp}_${j.index}_${j.outcome}`,F=l.get(N);if(!F){l.set(N,j);return}const K=new Date(F.timestamp).getTime();if(new Date(j.timestamp).getTime()>K){l.set(N,{...F,...j});return}l.set(N,{...j,...F})};r.completions?.forEach(c),e.completions?.forEach(c);const f=Array.from(l.values()).sort((R,j)=>new Date(j.timestamp).getTime()-new Date(R.timestamp).getTime()),m=()=>{const R=Array.isArray(e.addresses)?e.addresses:[],j=Array.isArray(r.addresses)?r.addresses:[],N=O=>O.some(ne=>ne.address?.trim()),F=N(j),K=N(R);return n>t?!F&&K?{addresses:R,listVersion:t}:{addresses:j,listVersion:n}:t>n?!K&&F?{addresses:j,listVersion:t}:{addresses:R,listVersion:t}:F&&!K?{addresses:j,listVersion:n}:!F&&K?{addresses:R,listVersion:t}:{addresses:j.length>=R.length?j:R,listVersion:n}},{addresses:g,listVersion:x}=m(),y=new Map,b=R=>{if(!R?.id)return;const j=y.get(R.id);if(!j){y.set(R.id,R);return}const N=new Date(j.updatedAt).getTime();new Date(R.updatedAt).getTime()>N&&y.set(R.id,R)};e.arrangements?.forEach(b),r.arrangements?.forEach(b);const E=new Map,S=R=>{if(!R?.date)return;const j=E.get(R.date);if(!j){E.set(R.date,R);return}const N=!!j.end,F=!!R.end;if(!N&&F){E.set(R.date,R);return}if(N&&F){const K=new Date(j.end??j.start).getTime();new Date(R.end??R.start).getTime()>K&&E.set(R.date,R)}};e.daySessions?.forEach(S),r.daySessions?.forEach(S);const k=Array.from(E.values()),C=Array.from(y.values());return{...r,addresses:g,completions:f,arrangements:C,daySessions:k,currentListVersion:x,activeIndex:r.activeIndex??e.activeIndex??null}}function Py(){const[e,r]=Y.useState(null),[t,n]=Y.useState(!0),[a,l]=Y.useState(!1),[c,f]=Y.useState(typeof navigator<"u"?navigator.onLine:!0),[m,g]=Y.useState(null),[x,y]=Y.useState(null),b=Y.useRef({lastSyncAt:"",deviceId:rx(),version:0,checksum:""}),E=Y.useRef([]),S=Y.useRef(!1),k=Y.useRef(null),C=Y.useRef(""),R=Y.useRef(null),j=Y.useCallback(()=>g(null),[]),N=Y.useCallback(async()=>{if(!e||!Be||!c||S.current||E.current.length===0)return;S.current=!0,l(!0);const xe=E.current.slice(0,10),le=new Set;try{for(const Q of xe)try{const{operation:M}=Q,{error:V}=await Be.from("navigator_operations").insert({user_id:e.id,operation_id:M.id,type:M.type,entity:M.entity,entity_id:M.entityId,data:M.data,device_id:b.current.deviceId,timestamp:M.timestamp,local_timestamp:M.localTimestamp});if(V&&V.code!=="23505")throw V;le.add(Q.operation.id),Q.resolve(M)}catch(M){Q.operation.retries+=1,Q.operation.retries<3||(console.warn(`Operation ${Q.operation.id} failed after max retries:`,M),le.add(Q.operation.id),Q.reject(M))}E.current=E.current.filter(Q=>!le.has(Q.operation.id))}catch(Q){console.error("Sync batch error:",Q),g(Q?.message||"Sync batch failed")}finally{S.current=!1,l(E.current.length>0),E.current.length>0&&(k.current=setTimeout(N,1e3))}},[e,c]),F=Y.useCallback(async xe=>new Promise((le,Q)=>{const M=JSON.stringify(xe.data),V=`${xe.type}_${xe.entity}_${xe.entityId}_${M}`;if(E.current.some(I=>{const B=JSON.stringify(I.operation.data);return`${I.operation.type}_${I.operation.entity}_${I.operation.entityId}_${B}`===V&&I.operation.retries<3})){le();return}const se=new Date().toISOString(),P={operation:{...xe,id:`op_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,timestamp:se,localTimestamp:se,retries:0},resolve:le,reject:Q};E.current.push(P),E.current.length>1e3&&(console.warn("Sync queue size limit reached, removing oldest entries"),E.current.splice(0,100).forEach(B=>{B.reject(new Error("Queue overflow - operation cancelled"))})),c&&N()}),[c,N]);Y.useEffect(()=>{let xe=!0;if((async()=>{try{if(!Be){xe&&(g("Supabase not configured"),n(!1));return}const Q=new URLSearchParams(window.location.hash.substring(1)),M=Q.get("access_token"),V=Q.get("refresh_token"),H=Q.get("type"),se=Q.get("error"),D=Q.get("error_description");if(se){console.error("Auth callback error:",se,D),g(D||se),window.history.replaceState(null,"",window.location.pathname),xe&&n(!1);return}if(M&&H){try{const{data:P,error:I}=await Be.auth.setSession({access_token:M,refresh_token:V||""});I?(console.error("Error setting session from URL:",I),g("Failed to confirm email: "+I.message)):P.session?(r(P.session.user),j()):(console.warn("Session data missing after setSession"),g("Email confirmation incomplete. Please try signing in."))}catch(P){console.error("Exception during session setup:",P),g("Error confirming email: "+(P?.message||String(P)))}window.history.replaceState(null,"",window.location.pathname)}else{const{data:P,error:I}=await Be.auth.getUser();if(I)throw I;xe&&r(P.user??null)}}catch(Q){xe&&Q?.message!=="Auth session missing!"&&g(Q?.message||String(Q))}finally{xe&&n(!1)}})(),!Be)return()=>{xe=!1};const{data:le}=Be.auth.onAuthStateChange((Q,M)=>{xe&&(r(M?.user??null),(Q==="SIGNED_IN"||Q==="USER_UPDATED")&&M&&j())});return()=>{xe=!1,le.subscription.unsubscribe()}},[j]),Y.useEffect(()=>{if(typeof window>"u")return;const xe=()=>{f(!0),k.current=setTimeout(N,100),setTimeout(async()=>{const Q=Object.keys(localStorage).filter(M=>M.startsWith("navigator_offline_state_"));if(Q.length>0)for(const M of Q)try{const V=JSON.parse(localStorage.getItem(M)||"{}");V.state&&(await ve(V.state),localStorage.removeItem(M))}catch(V){console.error(` OFFLINE PROTECTION: Failed to sync queued state ${M}:`,V)}},2e3)},le=()=>{f(!1)};return window.addEventListener("online",xe),window.addEventListener("offline",le),()=>{window.removeEventListener("online",xe),window.removeEventListener("offline",le)}},[N]);const K=Y.useCallback(async(xe,le)=>{if(j(),!Be)throw new Error("Supabase not configured");const{data:Q,error:M}=await Be.auth.signInWithPassword({email:xe,password:le});if(M)throw g(M.message),M;localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id");const{SmartUserDetection:V}=await Qa(async()=>{const{SmartUserDetection:H}=await Promise.resolve().then(()=>zN);return{SmartUserDetection:H}},void 0);return V.storeDeviceContext(Q.user),r(Q.user),{user:Q.user}},[j]),z=Y.useCallback(async(xe,le)=>{if(j(),!Be)throw new Error("Supabase not configured");try{localStorage.removeItem("navigator-supabase-auth-token"),localStorage.removeItem("supabase.auth.token"),sessionStorage.clear(),await Be.auth.signOut(),r(null),await new Promise(se=>setTimeout(se,1e3));const{data:H}=await Be.auth.getSession();H.session&&(console.warn("Session still exists after cleanup, forcing removal..."),await Be.auth.signOut(),await new Promise(se=>setTimeout(se,500)))}catch(H){console.warn("Error during pre-signup signout:",H)}const Q=window.location.origin,{data:M,error:V}=await Be.auth.signUp({email:xe,password:le,options:{data:{signup_source:"navigator_web"},emailRedirectTo:Q}});if(V)throw g(V.message),V;if(M.user){try{await H3(M.user.id),localStorage.setItem("navigator_trial_created",Date.now().toString()),localStorage.setItem("navigator_trial_user_id",M.user.id)}catch(H){console.error("Failed to initialize new user:",H)}if(!M.session)return g(" Check your email! Click the confirmation link to activate your account."),{user:M.user};r(M.user)}return{user:M.user}},[j]),O=Y.useCallback(async()=>{if(j(),R.current&&(R.current(),R.current=null),!Be)return;const{error:xe}=await Be.auth.signOut();if(xe)throw g(xe.message),xe;try{const{clear:le}=await Qa(async()=>{const{clear:M}=await Promise.resolve().then(()=>GA);return{clear:M}},void 0);await le(),["navigator_trial_created","navigator_trial_user_id","navigator_last_user_id","navigator_device_context","navigator_device_context_checksum","navigator_supabase_url","navigator_supabase_key","navigator_supabase_skipped","navigator_data_counts","last_backup_time","navigator-web:settings"].forEach(M=>localStorage.removeItem(M)),sessionStorage.clear()}catch(le){console.warn("Error clearing local data:",le)}r(null),y(null),b.current={lastSyncAt:"",deviceId:rx(),version:0,checksum:""},E.current=[],S.current=!1,C.current="",k.current&&(clearTimeout(k.current),k.current=null)},[j]),ne=Y.useCallback(async xe=>{if(j(),!Be)throw new Error("Supabase not configured");const le=window.location.origin,{error:Q}=await Be.auth.resetPasswordForEmail(xe,{redirectTo:le});if(Q)throw g(Q.message),Q},[j]),ee=Y.useCallback(async xe=>{if(j(),!Be)throw new Error("Supabase not configured");if(!e)throw new Error("Not authenticated");const{error:le}=await Be.auth.updateUser({password:xe});if(le)throw g(le.message),le},[j,e]),ve=Y.useCallback(async xe=>{if(!e||!Be){g(e?"Supabase not configured":"Not authenticated");return}if(JSON.stringify(xe)!==C.current)try{j(),l(!0);const Q=new Date().toISOString(),{data:M,error:V}=await Be.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle();if(V)throw V;let H=xe,se=b.current.version+1;if(M&&M.updated_at>b.current.lastSyncAt){const te=M.data;H=await he(xe,te),se=(M.version||0)+1}const D=co(H),{error:P}=await Be.from("navigator_state").upsert({user_id:e.id,data:H,updated_at:Q,version:se,checksum:D,device_id:b.current.deviceId},{onConflict:"user_id"}).select("updated_at, version, checksum").single();if(P)throw console.error("Cloud sync database error:",P),P.code==="23505"||P.message?.includes("conflict")?(b.current.lastSyncAt="",b.current.version=0,new Error("Sync conflict detected - will retry with fresh data")):P;const{data:I,error:B}=await Be.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).single();if(B)throw console.error("Sync verification failed:",B),new Error(`Sync verification failed: ${B.message}`);if(!I)throw new Error("Sync verification failed: No data found after upsert");const G=co(I.data);G!==D&&console.warn("Checksum mismatch (likely harmless serialization difference)",{expectedChecksum:D,actualChecksum:G,expectedCompletions:H.completions?.length||0,actualCompletions:I.data?.completions?.length||0}),b.current={lastSyncAt:I.updated_at??Q,deviceId:b.current.deviceId,version:I.version??se,checksum:D},C.current=JSON.stringify(H),y(new Date(I.updated_at??Q))}catch(Q){if(Q?.message!=="Auth session missing!"&&g(Q?.message||String(Q)),console.error("Sync failed:",Q),!c||Q?.message?.includes("fetch")){const M=`navigator_offline_state_${Date.now()}`,V={state:xe,timestamp:new Date().toISOString(),reason:"network_failure",error:Q?.message||String(Q)};try{localStorage.setItem(M,JSON.stringify(V))}catch(H){console.error("Failed to queue offline state:",H)}}}finally{l(!1)}},[e,j]),he=Y.useCallback(async(xe,le)=>{if(_s("navigator_restore_in_progress")){console.log(" RESTORE PROTECTION: Preferring local state to prevent data loss");const G=typeof xe.currentListVersion=="number"?xe.currentListVersion:1,te=typeof le.currentListVersion=="number"?le.currentListVersion:1;return{...xe,currentListVersion:Math.max(G,te)}}if(_s("navigator_import_in_progress")){console.log(" IMPORT PROTECTION: Preferring local state to prevent import override");const G=typeof xe.currentListVersion=="number"?xe.currentListVersion:1,te=typeof le.currentListVersion=="number"?le.currentListVersion:1;return{...xe,currentListVersion:Math.max(G,te)}}const Q=new Date(Date.now()-360*60*1e3);if(xe.completions.some(G=>G.timestamp&&new Date(G.timestamp)>Q)){const G=xe.completions.length,te=le.completions.length;if(G>te)return{...xe,arrangements:le.arrangements.length>xe.arrangements.length?le.arrangements:xe.arrangements,daySessions:[...xe.daySessions,...le.daySessions.filter(de=>!xe.daySessions.some(pe=>pe.date===de.date))]}}const V={...xe},H=[...xe.completions,...le.completions],se=new Map;H.forEach(G=>{if(!G.address||!G.timestamp)return;const te=`${G.address}_v${G.listVersion||1}`,de=se.get(te);if(!de){se.set(te,G);return}const pe=new Date(de.timestamp).getTime(),me=new Date(G.timestamp).getTime();!isNaN(me)&&(isNaN(pe)||me>pe)&&se.set(te,G)}),V.completions=Array.from(se.values()).sort((G,te)=>new Date(te.timestamp).getTime()-new Date(G.timestamp).getTime());const D=[...xe.arrangements,...le.arrangements],P=new Map;D.forEach(G=>{const te=P.get(G.id);(!te||new Date(G.updatedAt)>new Date(te.updatedAt))&&P.set(G.id,G)}),V.arrangements=Array.from(P.values());const I=[...xe.daySessions,...le.daySessions],B=new Map;if(I.forEach(G=>{const te=B.get(G.date);(!te||G.end&&!te.end)&&B.set(G.date,G)}),V.daySessions=Array.from(B.values()),le.addresses.length>xe.addresses.length){V.addresses=le.addresses;const G=typeof xe.currentListVersion=="number"?xe.currentListVersion:1,te=typeof le.currentListVersion=="number"?le.currentListVersion:1;V.currentListVersion=Math.max(G,te)}else{const G=typeof xe.currentListVersion=="number"?xe.currentListVersion:1;V.currentListVersion=G}return V.activeIndex=xe.activeIndex??le.activeIndex??null,V},[]),ce=Y.useCallback(async()=>{if(C.current="",b.current.lastSyncAt="",b.current.version=0,e&&Be)try{const{data:xe,error:le}=await Be.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle()}catch(xe){console.warn("Force sync failed:",xe)}},[e]),Ne=Y.useCallback(xe=>{if(!e||!Be)return()=>{};j();const le=Be,Q=le.channel("navigator_state_"+e.id);Q.on("postgres_changes",{event:"*",schema:"public",table:"navigator_state",filter:`user_id=eq.${e.id}`},async V=>{try{const H=V?.new??V?.old??null;if(!H)return;const se=H.updated_at,D=H.data,P=H.version||0,I=H.checksum||"";if(H.device_id===b.current.deviceId||P<=b.current.version)return;const B=co(D);if(I&&I!==B){const pe="navigator_checksum_mismatch_count",me="navigator_last_checksum_mismatch",ye=parseInt(localStorage.getItem(pe)||"0"),Ke=parseInt(localStorage.getItem(me)||"0"),at=Date.now()-Ke>3e5?1:ye+1;localStorage.setItem(pe,at.toString()),localStorage.setItem(me,Date.now().toString()),console.warn(` CHECKSUM MISMATCH (${at}) - Data integrity issue detected`,{expected:B.substring(0,16)+"...",actual:I.substring(0,16)+"...",serverVersion:P,updatedAt:se,consecutiveMismatches:at}),at>=3&&(console.error(" PERSISTENT CHECKSUM MISMATCH - Forcing full sync (silent recovery)"),localStorage.removeItem(pe),localStorage.removeItem(me),b.current.lastSyncAt="",b.current.version=0,b.current.checksum="");return}if(localStorage.removeItem("navigator_checksum_mismatch_count"),localStorage.removeItem("navigator_last_checksum_mismatch"),localStorage.getItem("navigator_active_protection"))return;b.current.lastSyncAt=se,b.current.version=P,b.current.checksum=I;const te=localStorage.getItem("navigator_restore_in_progress");if(te){const pe=parseInt(te);if(Date.now()-pe<3e4)return;localStorage.removeItem("navigator_restore_in_progress")}const de=localStorage.getItem("navigator_import_in_progress");if(de){const pe=parseInt(de);if(Date.now()-pe<2e3)return;localStorage.removeItem("navigator_import_in_progress")}typeof xe=="function"?xe(pe=>{const me=Ay(pe,D);return me.completions.filter(Ke=>!pe.completions.some(ae=>ae.timestamp===Ke.timestamp&&ae.address===Ke.address)).length>0,C.current=JSON.stringify(me),me}):C.current=JSON.stringify(D),y(new Date(se))}catch(H){console.warn("subscribeToData handler error:",H?.message||H),g("Sync error: "+(H?.message||H))}}),Q.subscribe();const M=()=>{try{le.removeChannel(Q)}catch{}};return R.current=M,M},[e,j]);return Y.useMemo(()=>({user:e,isLoading:t,isOnline:c,isSyncing:a,error:m,lastSyncTime:x,clearError:j,signIn:K,signUp:z,signOut:O,resetPassword:ne,updatePassword:ee,syncData:ve,subscribeToData:Ne,queueOperation:F,forceFullSync:ce}),[e,t,c,a,m,x,j,K,z,O,ne,ee,ve,Ne,F,ce])}function Sm({isOpen:e,onClose:r,title:t,children:n,size:a="md",showCloseButton:l=!0}){Y.useEffect(()=>{const m=g=>{g.key==="Escape"&&r()};return e&&(document.addEventListener("keydown",m),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",m),document.body.style.overflow=""}},[e,r]);const c=Y.useRef(null);if(Y.useEffect(()=>{if(e&&c.current){const g=c.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];g&&g.focus()}},[e]),!e)return null;const f={sm:"modal-sm",md:"modal-md",lg:"modal-lg"};return u.jsx("div",{className:"modal-overlay",onClick:r,children:u.jsxs("div",{ref:c,className:`modal-content ${f[a]}`,onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[t&&u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{id:"modal-title",className:"modal-title",children:t}),l&&u.jsx("button",{className:"modal-close-btn",onClick:r,"aria-label":"Close modal",children:""})]}),u.jsx("div",{className:"modal-body",children:n})]})})}function G3({isOpen:e,onClose:r,title:t,message:n,type:a="info"}){const c={info:{icon:"",className:"alert-info"},success:{icon:"",className:"alert-success"},warning:{icon:"",className:"alert-warning"},error:{icon:"",className:"alert-error"}}[a];return Y.useEffect(()=>{const f=m=>{m.key==="Escape"&&r()};return e&&(document.addEventListener("keydown",f),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",f),document.body.style.overflow=""}},[e,r]),e?u.jsx("div",{className:"modal-overlay",onClick:r,children:u.jsxs("div",{className:`modal-content modal-sm alert-modal ${c.className}`,onClick:f=>f.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[t&&u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{id:"modal-title",className:"modal-title",children:t}),u.jsx("button",{className:"modal-close-btn",onClick:r,"aria-label":"Close modal",children:""})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:"alert-content",children:[u.jsx("div",{className:"alert-icon",children:c.icon}),u.jsx("div",{className:"alert-message",children:n})]}),u.jsx("div",{className:"modal-actions",children:u.jsx("button",{className:"btn btn-primary",onClick:r,children:"OK"})})]})]})}):null}function Z3({isOpen:e,onConfirm:r,onCancel:t,title:n,message:a,confirmText:l="Confirm",cancelText:c="Cancel",type:f="info"}){const g={danger:{icon:"",confirmClass:"btn-danger"},warning:{icon:"",confirmClass:"btn-warning"},info:{icon:"",confirmClass:"btn-primary"}}[f],x=()=>{r(),t()};return u.jsx(Sm,{isOpen:e,onClose:t,title:n,size:"sm",children:u.jsxs("div",{className:"confirm-modal",children:[u.jsxs("div",{className:"confirm-content",children:[u.jsx("div",{className:"confirm-icon",children:g.icon}),u.jsx("div",{className:"confirm-message",children:a})]}),u.jsxs("div",{className:"modal-actions",children:[u.jsx("button",{className:"btn btn-ghost",onClick:t,children:c}),u.jsx("button",{className:`btn ${g.confirmClass}`,onClick:x,children:l})]})]})})}function K3({isOpen:e,onSubmit:r,onCancel:t,title:n,message:a,placeholder:l,defaultValue:c="",inputType:f="text",submitText:m="Submit",cancelText:g="Cancel"}){const[x,y]=Y.useState(c);Y.useEffect(()=>{e&&y(c)},[e,c]);const b=E=>{E.preventDefault(),x.trim()&&(r(x.trim()),t())};return u.jsx(Sm,{isOpen:e,onClose:t,title:n,size:"sm",children:u.jsx("form",{onSubmit:b,children:u.jsxs("div",{className:"prompt-modal",children:[u.jsx("div",{className:"prompt-message",children:a}),u.jsx("input",{name:"modalInput",type:f,value:x,onChange:E=>y(E.target.value),placeholder:l,className:"input",autoFocus:!0,required:!0}),u.jsxs("div",{className:"modal-actions",children:[u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:t,children:g}),u.jsx("button",{type:"submit",className:"btn btn-primary",children:m})]})]})})})}const Fd={alert:{isOpen:!1,options:{message:""}},confirm:{isOpen:!1,options:{message:""}},prompt:{isOpen:!1,options:{message:""}}};function q3(){const[e,r]=Y.useState(Fd),t=Y.useCallback(m=>new Promise(g=>{r(x=>({...x,alert:{isOpen:!0,options:m,resolve:g}}))}),[]),n=Y.useCallback(m=>new Promise(g=>{r(x=>({...x,confirm:{isOpen:!0,options:m,resolve:g}}))}),[]),a=Y.useCallback(m=>new Promise(g=>{r(x=>({...x,prompt:{isOpen:!0,options:m,resolve:g}}))}),[]),l=Y.useCallback(()=>{r(m=>(m.alert.resolve&&m.alert.resolve(),{...m,alert:{...Fd.alert}}))},[]),c=Y.useCallback((m=!1)=>{r(g=>(g.confirm.resolve&&g.confirm.resolve(m),{...g,confirm:{...Fd.confirm}}))},[]),f=Y.useCallback((m=null)=>{r(g=>(g.prompt.resolve&&g.prompt.resolve(m),{...g,prompt:{...Fd.prompt}}))},[]);return{alertModal:e.alert,confirmModal:e.confirm,promptModal:e.prompt,alert:t,confirm:n,prompt:a,closeAlert:l,closeConfirm:c,closePrompt:f}}const Ny=Y.createContext(null);function Y3({children:e}){const r=q3();return u.jsxs(Ny.Provider,{value:r,children:[e,u.jsx(G3,{isOpen:r.alertModal.isOpen,onClose:r.closeAlert,title:r.alertModal.options.title,message:r.alertModal.options.message,type:r.alertModal.options.type}),u.jsx(Z3,{isOpen:r.confirmModal.isOpen,onConfirm:()=>r.closeConfirm(!0),onCancel:()=>r.closeConfirm(!1),title:r.confirmModal.options.title,message:r.confirmModal.options.message,confirmText:r.confirmModal.options.confirmText,cancelText:r.confirmModal.options.cancelText,type:r.confirmModal.options.type}),u.jsx(K3,{isOpen:r.promptModal.isOpen,onSubmit:t=>r.closePrompt(t),onCancel:()=>r.closePrompt(null),title:r.promptModal.options.title,message:r.promptModal.options.message,placeholder:r.promptModal.options.placeholder,defaultValue:r.promptModal.options.defaultValue,inputType:r.promptModal.options.inputType,submitText:r.promptModal.options.submitText,cancelText:r.promptModal.options.cancelText})]})}function X3(){const e=Y.useContext(Ny);if(!e)throw new Error("useModalContext must be used within a ModalProvider");return e}function J3({onSignIn:e,onSignUp:r,onResetPassword:t,isLoading:n,error:a,onClearError:l}){const[c,f]=Y.useState("signin"),[m,g]=Y.useState(""),[x,y]=Y.useState(""),[b,E]=Y.useState(""),[S,k]=Y.useState(!1),[C,R]=Y.useState(null),j=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,N=async F=>{if(F.preventDefault(),n)return;if(R(null),!m||m.trim()===""){R("Email is required");return}if(!j.test(m)){R("Please enter a valid email address");return}if(c==="reset"){try{await t(m),k(!0)}catch{}return}if(!x||x.trim()===""){R("Password is required");return}if(x.length<6){R("Password must be at least 6 characters");return}if(x.length>72){R("Password must be less than 72 characters");return}if(["password","123456","qwerty","abc123","password123"].includes(x.toLowerCase())){R("Please choose a stronger password");return}if(c==="signup"){if(!b||b.trim()===""){R("Please confirm your password");return}if(x!==b){R("Passwords do not match");return}}try{c==="signin"?await e(m,x):await r(m,x)}catch{}};return Y.useEffect(()=>{if(a){const F=setTimeout(()=>{l()},5e3);return()=>clearTimeout(F)}},[a,l]),u.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1rem"},children:u.jsxs("div",{style:{width:"100%",maxWidth:"420px",background:"white",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[u.jsxs("div",{style:{padding:"3rem 2.5rem 2rem",textAlign:"center",background:"white"},children:[u.jsx("h1",{style:{margin:"0 0 0.75rem 0",fontSize:"2rem",fontWeight:700,color:"#1a202c",letterSpacing:"-0.025em"},children:"Navigator"}),u.jsx("p",{style:{margin:0,color:"#718096",fontSize:"0.9375rem",fontWeight:400},children:c==="signin"?"Welcome back":c==="signup"?"Create your account":"Reset your password"})]}),u.jsxs("div",{style:{padding:"0 2.5rem 2.5rem"},children:[(a||C)&&u.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",background:"#fee2e2",borderLeft:"4px solid #dc2626",borderRadius:"6px",color:"#991b1b",fontSize:"0.875rem",lineHeight:"1.5"},children:C||a}),c==="reset"&&S&&u.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",background:"#d1fae5",borderLeft:"4px solid #059669",borderRadius:"6px",color:"#065f46",fontSize:"0.875rem",lineHeight:"1.5"},children:"Password reset email sent! Check your inbox."}),u.jsx("form",{onSubmit:N,children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.25rem"},children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"email",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Email address"}),u.jsx("input",{id:"email",name:"email",type:"email",value:m,onChange:F=>g(F.target.value),disabled:n,required:!0,autoComplete:"email",placeholder:"you@example.com",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:F=>F.target.style.borderColor="#667eea",onBlur:F=>F.target.style.borderColor="#d1d5db"})]}),c!=="reset"&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Password"}),u.jsx("input",{id:"password",name:"password",type:"password",value:x,onChange:F=>y(F.target.value),disabled:n,minLength:6,required:!0,autoComplete:c==="signup"?"new-password":"current-password",placeholder:"Enter your password",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:F=>F.target.style.borderColor="#667eea",onBlur:F=>F.target.style.borderColor="#d1d5db"})]}),c==="signup"&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"confirmPassword",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Confirm password"}),u.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:b,onChange:F=>E(F.target.value),disabled:n,minLength:6,required:!0,autoComplete:"new-password",placeholder:"Confirm your password",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:F=>F.target.style.borderColor="#667eea",onBlur:F=>F.target.style.borderColor="#d1d5db"})]}),u.jsx("button",{type:"submit",disabled:n,style:{width:"100%",marginTop:"0.5rem",padding:"0.875rem 1rem",fontSize:"1rem",fontWeight:600,color:"white",background:n?"#9ca3af":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"8px",cursor:n?"not-allowed":"pointer",transition:"all 0.15s ease",boxShadow:"0 4px 6px rgba(102, 126, 234, 0.25)"},onMouseEnter:F=>!n&&(F.currentTarget.style.transform="translateY(-1px)"),onMouseLeave:F=>F.currentTarget.style.transform="translateY(0)",children:n?c==="signin"?"Signing in...":c==="signup"?"Creating account...":"Sending reset email...":c==="signin"?"Sign In":c==="signup"?"Create Account":"Send Reset Link"})]})}),c==="signin"&&u.jsx("div",{style:{textAlign:"center",marginTop:"1rem"},children:u.jsx("button",{type:"button",onClick:()=>{f("reset"),k(!1),l()},style:{background:"none",border:"none",color:"#667eea",fontSize:"0.875rem",cursor:"pointer",fontWeight:500,textDecoration:"none"},onMouseEnter:F=>F.currentTarget.style.textDecoration="underline",onMouseLeave:F=>F.currentTarget.style.textDecoration="none",children:"Forgot your password?"})}),u.jsx("div",{style:{position:"relative",margin:"1.5rem 0",height:"1px",background:"#e5e7eb"},children:u.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"0 1rem",background:"white",color:"#9ca3af",fontSize:"0.75rem",fontWeight:500},children:"OR"})}),u.jsx("div",{style:{textAlign:"center",fontSize:"0.875rem",color:"#6b7280"},children:c==="reset"?u.jsxs(u.Fragment,{children:["Remember your password?"," ",u.jsx("button",{type:"button",onClick:()=>{f("signin"),k(!1),l()},style:{background:"none",border:"none",color:"#667eea",fontWeight:600,cursor:"pointer",fontSize:"inherit"},onMouseEnter:F=>F.currentTarget.style.textDecoration="underline",onMouseLeave:F=>F.currentTarget.style.textDecoration="none",children:"Sign in"})]}):u.jsxs(u.Fragment,{children:[c==="signin"?"New to Navigator?":"Already have an account?"," ",u.jsx("button",{type:"button",onClick:()=>{f(c==="signin"?"signup":"signin"),E(""),k(!1),l()},style:{background:"none",border:"none",color:"#667eea",fontWeight:600,cursor:"pointer",fontSize:"inherit"},onMouseEnter:F=>F.currentTarget.style.textDecoration="underline",onMouseLeave:F=>F.currentTarget.style.textDecoration="none",children:c==="signin"?"Create account":"Sign in"})]})})]})]})})}function Tm({state:e,arrangement:r,preSelectedAddressIndex:t,onAddAddress:n,onSave:a,onCancel:l,isLoading:c=!1,onComplete:f,fullscreen:m=!1}){const g=Wt.useRef(null),[x,y]=Wt.useState(!1),[b,E]=Wt.useState((t!=null,"existing")),[S,k]=Wt.useState({addressIndex:r?.addressIndex??t??0,manualAddress:"",customerName:r?.customerName??"",phoneNumber:r?.phoneNumber??"",totalAmount:r?.amount??"",scheduledDate:r?.scheduledDate??new Date().toISOString().slice(0,10),scheduledTime:r?.scheduledTime??"",notes:r?.notes??"",status:r?.status??"Scheduled",previousPayments:[],isRecurring:!1,recurrenceType:"weekly",recurrenceInterval:1,totalPayments:4}),[C,R]=Wt.useState({}),[j,N]=Wt.useState(()=>{try{const I=localStorage.getItem("uaf-collapsed-sections");return I?JSON.parse(I):{previousPayments:!1,recurringPayments:!0}}catch{return{previousPayments:!1,recurringPayments:!0}}}),[F,K]=Wt.useState(!1);Wt.useEffect(()=>{try{localStorage.setItem("uaf-collapsed-sections",JSON.stringify(j))}catch(I){console.error("Failed to save collapse preferences:",I)}},[j]);const z=I=>{N(B=>({...B,[I]:!B[I]}))},O=S.previousPayments.reduce((I,B)=>I+parseFloat(B.amount||"0"),0),ne=parseFloat(S.totalAmount||"0"),ee=ne-O,ve=S.previousPayments.length>0,he=Wt.useMemo(()=>[...S.previousPayments].sort((I,B)=>new Date(I.date).getTime()-new Date(B.date).getTime()),[S.previousPayments]),ce=Wt.useMemo(()=>{if(!S.isRecurring||S.totalPayments<2)return[];const I=[],B=la(S.scheduledDate);for(let G=0;G<S.totalPayments;G++){let te=B;S.recurrenceType==="weekly"?te=bv(B,G*S.recurrenceInterval):S.recurrenceType==="biweekly"?te=bv(B,G*2):S.recurrenceType==="monthly"&&(te=XA(B,G*S.recurrenceInterval)),I.push(rf(te,"MMM d, yyyy"))}return I},[S.isRecurring,S.scheduledDate,S.recurrenceType,S.recurrenceInterval,S.totalPayments]),Ne=Wt.useMemo(()=>{if(!r||!r.recurrenceType||r.recurrenceType==="none")return 0;const I=r.paymentsMade||0,B=r.totalPayments||1;return Math.round(I/B*100)},[r]);Wt.useEffect(()=>{if(r){const I=r.addressIndex>=0&&r.addressIndex<e.addresses.length,B=I?e.addresses[r.addressIndex]?.address:null,G=r.address;!I||!(B===G)?(E("manual"),k(de=>({...de,addressIndex:0,manualAddress:G,customerName:r.customerName??"",phoneNumber:r.phoneNumber??"",totalAmount:r.amount??"",scheduledDate:r.scheduledDate,scheduledTime:r.scheduledTime??"",notes:r.notes??"",status:r.status}))):(E("existing"),k(de=>({...de,addressIndex:r.addressIndex,manualAddress:"",customerName:r.customerName??"",phoneNumber:r.phoneNumber??"",totalAmount:r.amount??"",scheduledDate:r.scheduledDate,scheduledTime:r.scheduledTime??"",notes:r.notes??"",status:r.status}))),r.recurrenceType&&r.recurrenceType!=="none"&&k(de=>({...de,isRecurring:!0}))}},[r,e.addresses]);const xe=I=>{const B=parseFloat(I||"0");return!I||Number.isNaN(B)||B<=0?(R(G=>({...G,amount:"Please enter a valid total amount"})),!1):(R(G=>({...G,amount:void 0})),!0)},le=()=>{let I=!0;return xe(S.totalAmount)||(I=!1),ee<0&&(R(B=>({...B,amount:"Previous payments exceed total amount"})),I=!1),b==="existing"&&e.addresses.length===0&&(R(B=>({...B,address:"No addresses available"})),I=!1),b==="manual"&&!S.manualAddress.trim()&&(R(B=>({...B,address:"Please enter an address"})),I=!1),I},Q=()=>{const I={id:`previous_${Date.now()}`,amount:"",date:new Date().toISOString().slice(0,10),notes:""};k(B=>({...B,previousPayments:[...B.previousPayments,I]}))},M=(I,B)=>{k(G=>({...G,previousPayments:G.previousPayments.map(te=>te.id===I?{...te,...B}:te)}))},V=I=>{k(B=>({...B,previousPayments:B.previousPayments.filter(G=>G.id!==I)}))},H=async I=>{I&&I.preventDefault(),!(x||c)&&le()&&K(!0)},se=async()=>{K(!1),y(!0);try{let I=S.addressIndex,B="";if(b==="existing"){const pe=e.addresses[S.addressIndex];if(!pe)throw new Error("Selected address is not valid");if(S.addressIndex<0||S.addressIndex>=e.addresses.length){const me=e.addresses.findIndex(ye=>ye.address.toLowerCase().trim()===pe.address.toLowerCase().trim());if(me>=0)I=me,B=e.addresses[me].address;else throw new Error("Selected address is no longer available")}else B=pe.address}else{const pe=e.addresses.findIndex(me=>me.address.toLowerCase().trim()===S.manualAddress.toLowerCase().trim());if(pe>=0)I=pe,B=e.addresses[pe].address;else{if(!n)throw new Error("Cannot add new addresses");const me={address:S.manualAddress.trim(),lat:null,lng:null};I=await n(me),B=me.address}}const G=ee>0?ee:ne;let te=G;S.isRecurring&&S.totalPayments>1&&(te=G/S.totalPayments);const de={addressIndex:I,address:B,customerName:S.customerName,phoneNumber:S.phoneNumber,scheduledDate:S.scheduledDate,scheduledTime:S.scheduledTime,amount:te.toFixed(2),notes:S.notes,status:S.status,recurrenceType:S.isRecurring?S.recurrenceType:"none",recurrenceInterval:S.isRecurring?S.recurrenceInterval:void 0,totalPayments:S.isRecurring?S.totalPayments:1,paymentsMade:r?.paymentsMade??0};await a(de);for(const pe of S.previousPayments)if(parseFloat(pe.amount)>0)try{f(I,"PIF",pe.amount)}catch(me){console.error("Error recording previous payment:",me)}}catch(I){console.error("Error saving arrangement:",I),alert(`Failed to save arrangement: ${I instanceof Error?I.message:"Please try again."}`)}finally{y(!1)}};Wt.useEffect(()=>{if(!m)return;const I=B=>{B.key==="Escape"&&l()};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[m,l]);const D=u.jsxs("form",{onSubmit:H,className:"uaf-form",children:[u.jsxs("div",{className:"uaf-header",children:[u.jsx("h3",{className:"uaf-title",children:r?" Edit Payment Arrangement":" Create Payment Arrangement"}),m&&u.jsx("button",{type:"button",className:"uaf-close",onClick:l,"aria-label":"Close",children:""})]}),u.jsxs("div",{className:"uaf-section",children:[u.jsx("h4",{className:"uaf-section-title",children:" Address & Customer"}),!r&&u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Address Source"}),u.jsxs("div",{className:"uaf-radio-group",children:[u.jsxs("label",{className:"uaf-radio-option",children:[u.jsx("input",{type:"radio",checked:b==="existing",onChange:()=>E("existing")}),u.jsx("span",{children:" From List"})]}),u.jsxs("label",{className:"uaf-radio-option",children:[u.jsx("input",{type:"radio",checked:b==="manual",onChange:()=>E("manual")}),u.jsx("span",{children:" Enter Manually"})]})]})]}),b==="existing"?u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Address *"}),e.addresses.length===0?u.jsx("div",{className:"uaf-warning",children:' No addresses in your list. Switch to "Enter Manually" to add a new address.'}):u.jsx("select",{value:S.addressIndex,onChange:I=>k(B=>({...B,addressIndex:parseInt(I.target.value)})),className:"uaf-input",required:!0,children:e.addresses.map((I,B)=>u.jsxs("option",{value:B,children:["#",B+1," - ",I.address]},B))})]}):u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Address *"}),u.jsx("input",{type:"text",value:S.manualAddress,onChange:I=>k(B=>({...B,manualAddress:I.target.value})),className:"uaf-input",placeholder:"Enter full address",required:!0}),u.jsx("div",{className:"uaf-hint",children:" If this address doesn't exist in your list, it will be automatically added."})]}),u.jsxs("div",{className:"uaf-row",children:[u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Customer Name"}),u.jsx("input",{type:"text",value:S.customerName,onChange:I=>k(B=>({...B,customerName:I.target.value})),className:"uaf-input",placeholder:"Customer name"})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Phone Number"}),u.jsx("input",{type:"tel",value:S.phoneNumber,onChange:I=>k(B=>({...B,phoneNumber:I.target.value})),className:"uaf-input",placeholder:"Phone number"})]})]})]}),u.jsxs("div",{className:"uaf-section",children:[u.jsx("h4",{className:"uaf-section-title",children:" Payment Details"}),u.jsxs("div",{className:"uaf-row",children:[u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Total Amount Owed *"}),u.jsxs("div",{className:"uaf-amount-input-wrapper",children:[u.jsx("span",{className:"uaf-amount-symbol",children:""}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:S.totalAmount,onChange:I=>{k(B=>({...B,totalAmount:I.target.value})),xe(I.target.value)},className:`uaf-input uaf-amount-input ${C.amount?"uaf-input-error":""}`,placeholder:"0.00",required:!0})]}),C.amount&&u.jsx("div",{className:"uaf-error",children:C.amount})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Due Date *"}),u.jsx("input",{type:"date",value:S.scheduledDate,onChange:I=>k(B=>({...B,scheduledDate:I.target.value})),className:"uaf-input",required:!0})]})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Time (Optional)"}),u.jsx("input",{type:"time",value:S.scheduledTime,onChange:I=>k(B=>({...B,scheduledTime:I.target.value})),className:"uaf-input"})]})]}),u.jsxs("div",{className:"uaf-section",children:[u.jsxs("div",{className:"uaf-section-header uaf-section-header-collapsible",onClick:()=>z("previousPayments"),children:[u.jsxs("h4",{className:"uaf-section-title",children:[u.jsx("span",{className:"uaf-collapse-icon",children:j.previousPayments?"":""})," Payments Already Made ",ve&&`(${S.previousPayments.length})`]}),u.jsx("button",{type:"button",onClick:I=>{I.stopPropagation(),Q()},className:"uaf-btn uaf-btn-sm uaf-btn-outline",children:"+ Add Payment"})]}),!j.previousPayments&&u.jsxs(u.Fragment,{children:[S.previousPayments.length===0?u.jsx("div",{className:"uaf-empty",children:"No previous payments recorded yet."}):u.jsx("div",{className:"uaf-payments-list",children:he.map(I=>u.jsxs("div",{className:"uaf-payment-item",children:[u.jsxs("div",{className:"uaf-row",children:[u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Amount"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:I.amount,onChange:B=>M(I.id,{amount:B.target.value}),className:"uaf-input",placeholder:"0.00"})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Date Paid"}),u.jsx("input",{type:"date",value:I.date,onChange:B=>M(I.id,{date:B.target.value}),className:"uaf-input"})]}),u.jsx("div",{className:"uaf-field uaf-field-actions",children:u.jsx("button",{type:"button",onClick:()=>V(I.id),className:"uaf-btn uaf-btn-sm uaf-btn-danger",title:"Remove payment",children:""})})]}),u.jsx("div",{className:"uaf-field",children:u.jsx("input",{type:"text",value:I.notes||"",onChange:B=>M(I.id,{notes:B.target.value}),className:"uaf-input",placeholder:"Payment notes (optional)"})})]},I.id))}),ve&&u.jsxs("div",{className:"uaf-payment-summary",children:[u.jsxs("div",{className:"uaf-summary-row",children:[u.jsx("span",{children:"Total Amount Owed:"}),u.jsxs("span",{children:["",parseFloat(S.totalAmount||"0").toFixed(2)]})]}),u.jsxs("div",{className:"uaf-summary-row",children:[u.jsx("span",{children:"Already Paid:"}),u.jsxs("span",{children:["-",O.toFixed(2)]})]}),u.jsxs("div",{className:"uaf-summary-row uaf-summary-total",children:[u.jsx("span",{children:"Still Owed:"}),u.jsxs("span",{children:["",Math.max(0,ee).toFixed(2)]})]})]})]})]}),ee>0&&u.jsxs("div",{className:"uaf-section",children:[u.jsx("div",{className:"uaf-section-header uaf-section-header-collapsible",onClick:()=>z("recurringPayments"),children:u.jsxs("h4",{className:"uaf-section-title",children:[u.jsx("span",{className:"uaf-collapse-icon",children:j.recurringPayments?"":""})," Optional: Split Remaining Balance"]})}),!j.recurringPayments&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"uaf-field",children:u.jsxs("label",{className:"uaf-radio-option",children:[u.jsx("input",{type:"checkbox",checked:S.isRecurring,onChange:I=>k(B=>({...B,isRecurring:I.target.checked}))}),u.jsxs("span",{children:["Split ",ee.toFixed(2)," into multiple payments"]})]})}),S.isRecurring&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"uaf-row",children:[u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Frequency"}),u.jsxs("select",{value:S.recurrenceType,onChange:I=>k(B=>({...B,recurrenceType:I.target.value})),className:"uaf-input",children:[u.jsx("option",{value:"weekly",children:"Weekly"}),u.jsx("option",{value:"biweekly",children:"Bi-weekly (Every 2 weeks)"}),u.jsx("option",{value:"monthly",children:"Monthly"})]})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Number of Payments"}),u.jsx("input",{type:"number",min:"2",max:"12",value:S.totalPayments,onChange:I=>k(B=>({...B,totalPayments:parseInt(I.target.value)||2})),className:"uaf-input"})]})]}),u.jsxs("div",{className:"uaf-payment-preview",children:[" ",S.totalPayments," payments of ",(ee/S.totalPayments).toFixed(2)," each"]}),ce.length>0&&u.jsxs("div",{className:"uaf-timeline",children:[u.jsx("div",{className:"uaf-timeline-title",children:" Payment Schedule:"}),u.jsx("div",{className:"uaf-timeline-dates",children:ce.map((I,B)=>u.jsxs("div",{className:"uaf-timeline-item",children:[u.jsx("span",{className:"uaf-timeline-number",children:B+1}),u.jsx("span",{className:"uaf-timeline-date",children:I}),u.jsxs("span",{className:"uaf-timeline-amount",children:["",(ee/S.totalPayments).toFixed(2)]})]},B))})]}),r&&r.recurrenceType&&r.recurrenceType!=="none"&&u.jsxs("div",{className:"uaf-completion-progress",children:[u.jsxs("div",{className:"uaf-completion-header",children:[u.jsx("span",{children:"Payment Progress"}),u.jsxs("span",{className:"uaf-completion-text",children:[r.paymentsMade||0," of ",r.totalPayments||1," (",Ne,"%)"]})]}),u.jsx("div",{className:"uaf-completion-bar",children:u.jsx("div",{className:"uaf-completion-fill",style:{width:`${Ne}%`}})})]})]})]})]}),u.jsx("div",{className:"uaf-section",children:u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Notes"}),u.jsx("textarea",{value:S.notes,onChange:I=>k(B=>({...B,notes:I.target.value})),className:"uaf-input uaf-textarea",rows:3,placeholder:"Payment terms, special instructions, etc..."})]})}),u.jsxs("div",{className:"uaf-actions",children:[u.jsx("button",{type:"button",className:"uaf-btn uaf-btn-ghost",onClick:l,children:"Cancel"}),u.jsxs(Ti,{type:"submit",className:"uaf-btn uaf-btn-primary",isLoading:c||x,loadingText:r?"Updating...":"Creating...",disabled:b==="existing"&&e.addresses.length===0,children:[r?" Update":" Review & Create"," Arrangement"]})]}),F&&u.jsx("div",{className:"uaf-confirmation-overlay",onClick:()=>K(!1),children:u.jsxs("div",{className:"uaf-confirmation-modal",onClick:I=>I.stopPropagation(),children:[u.jsx("div",{className:"uaf-confirmation-header",children:u.jsx("h3",{children:" Confirm Arrangement Details"})}),u.jsxs("div",{className:"uaf-confirmation-body",children:[u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Address"}),u.jsx("div",{className:"uaf-confirmation-value",children:b==="existing"?e.addresses[S.addressIndex]?.address:S.manualAddress})]}),S.customerName&&u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Customer"}),u.jsx("div",{className:"uaf-confirmation-value",children:S.customerName})]}),u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Total Amount"}),u.jsxs("div",{className:"uaf-confirmation-value uaf-confirmation-amount",children:["",parseFloat(S.totalAmount||"0").toFixed(2)]})]}),ve&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Previous Payments"}),u.jsxs("div",{className:"uaf-confirmation-value",children:["",O.toFixed(2)," (",S.previousPayments.length," payment",S.previousPayments.length>1?"s":"",")"]})]}),u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Remaining Balance"}),u.jsxs("div",{className:"uaf-confirmation-value uaf-confirmation-highlight",children:["",ee.toFixed(2)]})]})]}),u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Payment Due"}),u.jsxs("div",{className:"uaf-confirmation-value",children:[rf(la(S.scheduledDate),"MMMM d, yyyy"),S.scheduledTime&&` at ${S.scheduledTime}`]})]}),S.isRecurring&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Payment Plan"}),u.jsxs("div",{className:"uaf-confirmation-value",children:[S.totalPayments," ",S.recurrenceType," payments of ",(ee/S.totalPayments).toFixed(2)]})]}),u.jsxs("div",{className:"uaf-confirmation-timeline",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Schedule:"}),u.jsxs("div",{className:"uaf-confirmation-dates",children:[ce.slice(0,3).map((I,B)=>u.jsx("span",{children:I},B)),ce.length>3&&u.jsxs("span",{children:["+ ",ce.length-3," more..."]})]})]})]}),S.notes&&u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:" Notes"}),u.jsx("div",{className:"uaf-confirmation-value",children:S.notes})]})]}),u.jsxs("div",{className:"uaf-confirmation-actions",children:[u.jsx("button",{type:"button",className:"uaf-btn uaf-btn-ghost",onClick:()=>K(!1),children:" Back to Edit"}),u.jsx(Ti,{type:"button",className:"uaf-btn uaf-btn-success",isLoading:x,loadingText:"Creating...",onClick:se,children:" Confirm & Create"})]})]})})]}),P=u.jsx("style",{children:`
        /* Unified Arrangement Form Styles */
        .uaf-container {
          background: var(--card-bg, white);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 12px;
          overflow: hidden;
        }

        .uaf-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 4000;
          display: flex;
          align-items: flex-start;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          overflow-y: auto;
          padding-top: 2rem;
        }

        .uaf-modal {
          background: var(--card-bg, white);
          border-radius: 16px;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
          width: 100%;
          max-width: 700px;
          max-height: 90vh;
          overflow-y: auto;
          margin: 0 auto;
        }

        .uaf-form {
          padding: 1.5rem;
          color: var(--text-primary);
        }

        .uaf-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 2rem;
          padding-bottom: 1rem;
          border-bottom: 1px solid var(--border, #e2e8f0);
        }

        .uaf-title {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          padding: 0.5rem;
          border-radius: 8px;
          cursor: pointer;
          color: var(--text-muted);
          line-height: 1;
        }

        .uaf-close:hover {
          background: var(--gray-100);
        }

        .uaf-section {
          margin-bottom: 1.5rem;
          padding: 0;
          background: transparent;
          border-radius: 0;
          border: none;
          border-bottom: 1px solid var(--border, #e2e8f0);
          padding-bottom: 1.5rem;
        }

        .uaf-section:last-of-type {
          border-bottom: none;
          padding-bottom: 0;
        }

        .uaf-section-title {
          margin: 0 0 1rem 0;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-section-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .uaf-field {
          margin-bottom: 1rem;
        }

        .uaf-field-actions {
          display: flex;
          align-items: flex-end;
        }

        .uaf-label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          margin-bottom: 0.5rem;
        }

        .uaf-input {
          width: 100%;
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
          padding: 0.75rem;
          font-size: 14px;
          background: var(--input-bg, white);
          color: var(--text-primary);
          transition: border-color 0.15s ease;
        }

        .uaf-input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14,165,233,0.1);
        }

        .uaf-input-error {
          border-color: var(--danger, #dc2626);
        }

        .uaf-textarea {
          resize: vertical;
          min-height: 80px;
        }

        .uaf-error {
          color: var(--danger, #dc2626);
          font-size: 0.8125rem;
          margin-top: 0.25rem;
        }

        .uaf-warning {
          padding: 0.75rem;
          background: var(--warning-light, #fef3c7);
          border: 1px solid var(--warning, #f59e0b);
          border-radius: 6px;
          color: var(--warning-dark, #92400e);
          font-size: 0.875rem;
        }

        .uaf-hint {
          font-size: 0.8125rem;
          color: var(--text-muted);
          margin-top: 0.25rem;
        }

        .uaf-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
          align-items: start;
        }

        .uaf-radio-group {
          display: flex;
          gap: 1rem;
          flex-wrap: wrap;
        }

        .uaf-radio-option {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          cursor: pointer;
          padding: 0.5rem 1rem;
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
          background: var(--input-bg, white);
          transition: all 0.15s ease;
        }

        .uaf-radio-option:hover {
          border-color: var(--primary, #0ea5e9);
        }

        .uaf-radio-option input[type="radio"] {
          margin: 0;
        }

        .uaf-radio-option input[type="radio"]:checked + span {
          font-weight: 600;
          color: var(--primary, #0ea5e9);
        }

        .uaf-payment-preview {
          padding: 0.75rem;
          background: var(--blue-50, #eff6ff);
          border: 1px solid var(--blue-200, #bfdbfe);
          border-radius: 6px;
          color: var(--blue-700, #1d4ed8);
          font-size: 0.875rem;
          font-weight: 500;
        }

        .uaf-empty {
          text-align: center;
          padding: 2rem;
          color: var(--text-muted);
          font-style: italic;
        }

        .uaf-payments-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .uaf-payment-item {
          padding: 1rem;
          background: var(--input-bg, white);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-payment-summary {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-summary-row {
          display: flex;
          justify-content: space-between;
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .uaf-summary-total {
          border-top: 1px solid var(--border, #e2e8f0);
          padding-top: 0.5rem;
          margin-top: 0.5rem;
          font-weight: 600;
          font-size: 1rem;
          color: var(--success-dark, #059669);
        }

        .uaf-actions {
          display: flex;
          gap: 0.75rem;
          justify-content: flex-end;
          padding-top: 1rem;
          border-top: 1px solid var(--border, #e2e8f0);
        }

        .uaf-btn {
          border-radius: 6px;
          padding: 0.75rem 1.5rem;
          font-weight: 500;
          border: 1px solid transparent;
          cursor: pointer;
          transition: all 0.15s ease;
          font-size: 14px;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
        }

        .uaf-btn-sm {
          padding: 0.5rem 1rem;
          font-size: 0.875rem;
        }

        .uaf-btn-ghost {
          background: var(--card-bg, white);
          border-color: var(--border, #e2e8f0);
          color: var(--text-primary);
        }

        .uaf-btn-ghost:hover {
          background: var(--gray-100, #f3f4f6);
        }

        .uaf-btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
          border-color: var(--primary, #0ea5e9);
        }

        .uaf-btn-primary:hover {
          background: var(--primary-dark, #0284c7);
        }

        .uaf-btn-outline {
          background: transparent;
          border-color: var(--primary, #0ea5e9);
          color: var(--primary, #0ea5e9);
        }

        .uaf-btn-outline:hover {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .uaf-btn-danger {
          background: var(--danger, #dc2626);
          color: white;
          border-color: var(--danger, #dc2626);
        }

        .uaf-btn-danger:hover {
          background: var(--danger-dark, #b91c1c);
        }

        .uaf-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .uaf-btn-success {
          background: var(--success, #10b981);
          color: white;
          border-color: var(--success, #10b981);
        }

        .uaf-btn-success:hover {
          background: var(--success-dark, #059669);
        }

        /* Collapsible Section Styles */
        .uaf-section-header-collapsible {
          cursor: pointer;
          user-select: none;
        }

        .uaf-section-header-collapsible:hover {
          background: var(--gray-50, #f9fafb);
          border-radius: 6px;
          margin: -0.5rem;
          padding: 0.5rem;
        }

        .uaf-collapse-icon {
          display: inline-block;
          margin-right: 0.5rem;
          font-size: 0.75rem;
          transition: transform 0.2s ease;
        }

        /* Amount Input with  Symbol */
        .uaf-amount-input-wrapper {
          position: relative;
          display: flex;
          align-items: center;
        }

        .uaf-amount-symbol {
          position: absolute;
          left: 0.75rem;
          font-size: 1.1rem;
          font-weight: 600;
          color: var(--success, #10b981);
          z-index: 1;
          pointer-events: none;
        }

        .uaf-amount-input {
          padding-left: 2rem !important;
          font-weight: 600;
          color: var(--success-dark, #059669);
          border-color: var(--success-light, #a7f3d0) !important;
          background: var(--success-lighter, #f0fdf4) !important;
        }

        .uaf-amount-input:focus {
          border-color: var(--success, #10b981) !important;
          box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1) !important;
        }

        /* Timeline Styles */
        .uaf-timeline {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-timeline-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-secondary);
          margin-bottom: 0.75rem;
        }

        .uaf-timeline-dates {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .uaf-timeline-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: 4px;
          border-left: 3px solid var(--primary, #0ea5e9);
        }

        .uaf-timeline-number {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 1.5rem;
          height: 1.5rem;
          background: var(--primary, #0ea5e9);
          color: white;
          border-radius: 50%;
          font-size: 0.75rem;
          font-weight: 600;
          flex-shrink: 0;
        }

        .uaf-timeline-date {
          flex: 1;
          font-size: 0.875rem;
          color: var(--text-primary);
        }

        .uaf-timeline-amount {
          font-weight: 600;
          color: var(--success-dark, #059669);
          font-size: 0.875rem;
        }

        /* Completion Progress Bar */
        .uaf-completion-progress {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--blue-50, #eff6ff);
          border: 1px solid var(--blue-200, #bfdbfe);
          border-radius: 6px;
        }

        .uaf-completion-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--blue-700, #1d4ed8);
        }

        .uaf-completion-text {
          font-size: 0.8125rem;
        }

        .uaf-completion-bar {
          width: 100%;
          height: 0.5rem;
          background: var(--blue-100, #dbeafe);
          border-radius: 1rem;
          overflow: hidden;
        }

        .uaf-completion-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--success, #10b981), var(--primary, #0ea5e9));
          transition: width 0.3s ease;
          border-radius: 1rem;
        }

        /* Confirmation Modal Styles */
        .uaf-confirmation-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.6);
          z-index: 5000;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        .uaf-confirmation-modal {
          background: var(--card-bg, white);
          border-radius: 16px;
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          width: 100%;
          max-width: 550px;
          max-height: 85vh;
          overflow-y: auto;
          animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .uaf-confirmation-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--border, #e2e8f0);
          background: var(--gray-50, #f9fafb);
        }

        .uaf-confirmation-header h3 {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-confirmation-body {
          padding: 1.5rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .uaf-confirmation-section {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .uaf-confirmation-label {
          font-size: 0.8125rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .uaf-confirmation-value {
          font-size: 1rem;
          color: var(--text-primary);
          font-weight: 500;
        }

        .uaf-confirmation-amount {
          font-size: 1.5rem;
          font-weight: 700;
          color: var(--success-dark, #059669);
        }

        .uaf-confirmation-highlight {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--primary, #0ea5e9);
        }

        .uaf-confirmation-timeline {
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border-radius: 6px;
          border: 1px solid var(--border, #e2e8f0);
        }

        .uaf-confirmation-dates {
          display: flex;
          flex-wrap: wrap;
          gap: 0.5rem;
          margin-top: 0.5rem;
        }

        .uaf-confirmation-dates span {
          padding: 0.25rem 0.75rem;
          background: var(--primary-light, #e0f2fe);
          color: var(--primary-dark, #0369a1);
          border-radius: 4px;
          font-size: 0.8125rem;
          font-weight: 500;
        }

        .uaf-confirmation-actions {
          display: flex;
          gap: 0.75rem;
          padding: 1.5rem;
          border-top: 1px solid var(--border, #e2e8f0);
          background: var(--gray-50, #f9fafb);
        }

        .uaf-confirmation-actions .uaf-btn {
          flex: 1;
        }

        /* Dark mode styles */
        .dark-mode .uaf-container,
        .dark-mode .uaf-modal {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-section {
          background: transparent;
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-summary {
          background: var(--gray-300);
          border-color: var(--gray-400);
        }

        .dark-mode .uaf-input {
          background: var(--gray-100);
          border-color: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .uaf-radio-option {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-preview {
          background: var(--blue-100);
          border-color: var(--blue-300);
          color: var(--blue-800);
        }

        .dark-mode .uaf-warning {
          background: var(--yellow-100);
          border-color: var(--yellow-400);
          color: var(--yellow-800);
        }

        /* Dark mode for new components */
        .dark-mode .uaf-amount-input {
          background: var(--success-lighter, #ecfdf5) !important;
          color: var(--success-dark, #065f46);
        }

        .dark-mode .uaf-amount-symbol {
          color: var(--success-dark, #065f46);
        }

        .dark-mode .uaf-timeline {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-timeline-item {
          background: var(--gray-100);
        }

        .dark-mode .uaf-completion-progress {
          background: var(--blue-100);
          border-color: var(--blue-300);
        }

        .dark-mode .uaf-confirmation-overlay {
          background: rgba(0, 0, 0, 0.75);
        }

        .dark-mode .uaf-confirmation-modal {
          background: var(--gray-100);
        }

        .dark-mode .uaf-confirmation-header {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-confirmation-header h3 {
          color: var(--gray-800);
        }

        .dark-mode .uaf-confirmation-label {
          color: var(--gray-600);
        }

        .dark-mode .uaf-confirmation-value {
          color: var(--gray-800);
        }

        .dark-mode .uaf-confirmation-timeline {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-confirmation-actions {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .uaf-modal {
            margin: 0.5rem;
            max-width: none;
          }

          .uaf-row {
            grid-template-columns: 1fr;
          }

          .uaf-radio-group {
            flex-direction: column;
          }

          .uaf-actions {
            flex-direction: column-reverse;
          }

          .uaf-btn {
            width: 100%;
          }
        }
      `});return m?u.jsxs(u.Fragment,{children:[u.jsx("div",{ref:g,className:"uaf-overlay",onClick:I=>{I.target===I.currentTarget&&l()},children:u.jsx("div",{className:"uaf-modal",children:D})}),P]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"uaf-container",children:D}),P]})}function Dy(e,r){const t=Y.useRef(r);Y.useEffect(function(){r!==t.current&&e.attributionControl!=null&&(t.current!=null&&e.attributionControl.removeAttribution(t.current),r!=null&&e.attributionControl.addAttribution(r)),t.current=r},[e,r])}var Iy=gx();const Q3=1;function e5(e){return Object.freeze({__version:Q3,map:e})}function Oy(e,r){return Object.freeze({...e,...r})}const jy=Y.createContext(null),Fy=jy.Provider;function hf(){const e=Y.useContext(jy);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Ly(e){function r(t,n){const{instance:a,context:l}=e(t).current;return Y.useImperativeHandle(n,()=>a),t.children==null?null:Wt.createElement(Fy,{value:l},t.children)}return Y.forwardRef(r)}function t5(e){function r(t,n){const[a,l]=Y.useState(!1),{instance:c}=e(t,l).current;Y.useImperativeHandle(n,()=>c),Y.useEffect(function(){a&&c.update()},[c,a,t.children]);const f=c._contentNode;return f?Iy.createPortal(t.children,f):null}return Y.forwardRef(r)}function r5(e){function r(t,n){const{instance:a}=e(t).current;return Y.useImperativeHandle(n,()=>a),null}return Y.forwardRef(r)}function Em(e,r){const t=Y.useRef();Y.useEffect(function(){return r!=null&&e.instance.on(r),t.current=r,function(){t.current!=null&&e.instance.off(t.current),t.current=null}},[e,r])}function mf(e,r){const t=e.pane??r.pane;return t?{...e,pane:t}:e}function n5(e,r){return function(n,a){const l=hf(),c=e(mf(n,l),l);return Dy(l.map,n.attribution),Em(c.current,n.eventHandlers),r(c.current,l,n,a),c}}var Ac={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var a5=Ac.exports,nx;function i5(){return nx||(nx=1,(function(e,r){(function(t,n){n(r)})(a5,(function(t){var n="1.9.4";function a(s){var d,p,_,A;for(p=1,_=arguments.length;p<_;p++){A=arguments[p];for(d in A)s[d]=A[d]}return s}var l=Object.create||(function(){function s(){}return function(d){return s.prototype=d,new s}})();function c(s,d){var p=Array.prototype.slice;if(s.bind)return s.bind.apply(s,p.call(arguments,1));var _=p.call(arguments,2);return function(){return s.apply(d,_.length?_.concat(p.call(arguments)):arguments)}}var f=0;function m(s){return"_leaflet_id"in s||(s._leaflet_id=++f),s._leaflet_id}function g(s,d,p){var _,A,Z,ue;return ue=function(){_=!1,A&&(Z.apply(p,A),A=!1)},Z=function(){_?A=arguments:(s.apply(p,arguments),setTimeout(ue,d),_=!0)},Z}function x(s,d,p){var _=d[1],A=d[0],Z=_-A;return s===_&&p?s:((s-A)%Z+Z)%Z+A}function y(){return!1}function b(s,d){if(d===!1)return s;var p=Math.pow(10,d===void 0?6:d);return Math.round(s*p)/p}function E(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function S(s){return E(s).split(/\s+/)}function k(s,d){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?l(s.options):{});for(var p in d)s.options[p]=d[p];return s.options}function C(s,d,p){var _=[];for(var A in s)_.push(encodeURIComponent(p?A.toUpperCase():A)+"="+encodeURIComponent(s[A]));return(!d||d.indexOf("?")===-1?"?":"&")+_.join("&")}var R=/\{ *([\w_ -]+) *\}/g;function j(s,d){return s.replace(R,function(p,_){var A=d[_];if(A===void 0)throw new Error("No value provided for variable "+p);return typeof A=="function"&&(A=A(d)),A})}var N=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function F(s,d){for(var p=0;p<s.length;p++)if(s[p]===d)return p;return-1}var K="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function z(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var O=0;function ne(s){var d=+new Date,p=Math.max(0,16-(d-O));return O=d+p,window.setTimeout(s,p)}var ee=window.requestAnimationFrame||z("RequestAnimationFrame")||ne,ve=window.cancelAnimationFrame||z("CancelAnimationFrame")||z("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function he(s,d,p){if(p&&ee===ne)s.call(d);else return ee.call(window,c(s,d))}function ce(s){s&&ve.call(window,s)}var Ne={__proto__:null,extend:a,create:l,bind:c,get lastId(){return f},stamp:m,throttle:g,wrapNum:x,falseFn:y,formatNum:b,trim:E,splitWords:S,setOptions:k,getParamString:C,template:j,isArray:N,indexOf:F,emptyImageUrl:K,requestFn:ee,cancelFn:ve,requestAnimFrame:he,cancelAnimFrame:ce};function xe(){}xe.extend=function(s){var d=function(){k(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=d.__super__=this.prototype,_=l(p);_.constructor=d,d.prototype=_;for(var A in this)Object.prototype.hasOwnProperty.call(this,A)&&A!=="prototype"&&A!=="__super__"&&(d[A]=this[A]);return s.statics&&a(d,s.statics),s.includes&&(le(s.includes),a.apply(null,[_].concat(s.includes))),a(_,s),delete _.statics,delete _.includes,_.options&&(_.options=p.options?l(p.options):{},a(_.options,s.options)),_._initHooks=[],_.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var Z=0,ue=_._initHooks.length;Z<ue;Z++)_._initHooks[Z].call(this)}},d},xe.include=function(s){var d=this.prototype.options;return a(this.prototype,s),s.options&&(this.prototype.options=d,this.mergeOptions(s.options)),this},xe.mergeOptions=function(s){return a(this.prototype.options,s),this},xe.addInitHook=function(s){var d=Array.prototype.slice.call(arguments,1),p=typeof s=="function"?s:function(){this[s].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function le(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=N(s)?s:[s];for(var d=0;d<s.length;d++)s[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Q={on:function(s,d,p){if(typeof s=="object")for(var _ in s)this._on(_,s[_],d);else{s=S(s);for(var A=0,Z=s.length;A<Z;A++)this._on(s[A],d,p)}return this},off:function(s,d,p){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var _ in s)this._off(_,s[_],d);else{s=S(s);for(var A=arguments.length===1,Z=0,ue=s.length;Z<ue;Z++)A?this._off(s[Z]):this._off(s[Z],d,p)}return this},_on:function(s,d,p,_){if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}if(this._listens(s,d,p)===!1){p===this&&(p=void 0);var A={fn:d,ctx:p};_&&(A.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(A)}},_off:function(s,d,p){var _,A,Z;if(this._events&&(_=this._events[s],!!_)){if(arguments.length===1){if(this._firingCount)for(A=0,Z=_.length;A<Z;A++)_[A].fn=y;delete this._events[s];return}if(typeof d!="function"){console.warn("wrong listener type: "+typeof d);return}var ue=this._listens(s,d,p);if(ue!==!1){var _e=_[ue];this._firingCount&&(_e.fn=y,this._events[s]=_=_.slice()),_.splice(ue,1)}}},fire:function(s,d,p){if(!this.listens(s,p))return this;var _=a({},d,{type:s,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var A=this._events[s];if(A){this._firingCount=this._firingCount+1||1;for(var Z=0,ue=A.length;Z<ue;Z++){var _e=A[Z],Ae=_e.fn;_e.once&&this.off(s,Ae,_e.ctx),Ae.call(_e.ctx||this,_)}this._firingCount--}}return p&&this._propagateEvent(_),this},listens:function(s,d,p,_){typeof s!="string"&&console.warn('"string" type argument expected');var A=d;typeof d!="function"&&(_=!!d,A=void 0,p=void 0);var Z=this._events&&this._events[s];if(Z&&Z.length&&this._listens(s,A,p)!==!1)return!0;if(_){for(var ue in this._eventParents)if(this._eventParents[ue].listens(s,d,p,_))return!0}return!1},_listens:function(s,d,p){if(!this._events)return!1;var _=this._events[s]||[];if(!d)return!!_.length;p===this&&(p=void 0);for(var A=0,Z=_.length;A<Z;A++)if(_[A].fn===d&&_[A].ctx===p)return A;return!1},once:function(s,d,p){if(typeof s=="object")for(var _ in s)this._on(_,s[_],d,!0);else{s=S(s);for(var A=0,Z=s.length;A<Z;A++)this._on(s[A],d,p,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[m(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[m(s)],this},_propagateEvent:function(s){for(var d in this._eventParents)this._eventParents[d].fire(s.type,a({layer:s.target,propagatedFrom:s.target},s),!0)}};Q.addEventListener=Q.on,Q.removeEventListener=Q.clearAllEventListeners=Q.off,Q.addOneTimeEventListener=Q.once,Q.fireEvent=Q.fire,Q.hasEventListeners=Q.listens;var M=xe.extend(Q);function V(s,d,p){this.x=p?Math.round(s):s,this.y=p?Math.round(d):d}var H=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};V.prototype={clone:function(){return new V(this.x,this.y)},add:function(s){return this.clone()._add(se(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(se(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new V(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new V(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=H(this.x),this.y=H(this.y),this},distanceTo:function(s){s=se(s);var d=s.x-this.x,p=s.y-this.y;return Math.sqrt(d*d+p*p)},equals:function(s){return s=se(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=se(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function se(s,d,p){return s instanceof V?s:N(s)?new V(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new V(s.x,s.y):new V(s,d,p)}function D(s,d){if(s)for(var p=d?[s,d]:s,_=0,A=p.length;_<A;_++)this.extend(p[_])}D.prototype={extend:function(s){var d,p;if(!s)return this;if(s instanceof V||typeof s[0]=="number"||"x"in s)d=p=se(s);else if(s=P(s),d=s.min,p=s.max,!d||!p)return this;return!this.min&&!this.max?(this.min=d.clone(),this.max=p.clone()):(this.min.x=Math.min(d.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(d.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(s){return se((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return se(this.min.x,this.max.y)},getTopRight:function(){return se(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var d,p;return typeof s[0]=="number"||s instanceof V?s=se(s):s=P(s),s instanceof D?(d=s.min,p=s.max):d=p=s,d.x>=this.min.x&&p.x<=this.max.x&&d.y>=this.min.y&&p.y<=this.max.y},intersects:function(s){s=P(s);var d=this.min,p=this.max,_=s.min,A=s.max,Z=A.x>=d.x&&_.x<=p.x,ue=A.y>=d.y&&_.y<=p.y;return Z&&ue},overlaps:function(s){s=P(s);var d=this.min,p=this.max,_=s.min,A=s.max,Z=A.x>d.x&&_.x<p.x,ue=A.y>d.y&&_.y<p.y;return Z&&ue},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var d=this.min,p=this.max,_=Math.abs(d.x-p.x)*s,A=Math.abs(d.y-p.y)*s;return P(se(d.x-_,d.y-A),se(p.x+_,p.y+A))},equals:function(s){return s?(s=P(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function P(s,d){return!s||s instanceof D?s:new D(s,d)}function I(s,d){if(s)for(var p=d?[s,d]:s,_=0,A=p.length;_<A;_++)this.extend(p[_])}I.prototype={extend:function(s){var d=this._southWest,p=this._northEast,_,A;if(s instanceof G)_=s,A=s;else if(s instanceof I){if(_=s._southWest,A=s._northEast,!_||!A)return this}else return s?this.extend(te(s)||B(s)):this;return!d&&!p?(this._southWest=new G(_.lat,_.lng),this._northEast=new G(A.lat,A.lng)):(d.lat=Math.min(_.lat,d.lat),d.lng=Math.min(_.lng,d.lng),p.lat=Math.max(A.lat,p.lat),p.lng=Math.max(A.lng,p.lng)),this},pad:function(s){var d=this._southWest,p=this._northEast,_=Math.abs(d.lat-p.lat)*s,A=Math.abs(d.lng-p.lng)*s;return new I(new G(d.lat-_,d.lng-A),new G(p.lat+_,p.lng+A))},getCenter:function(){return new G((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new G(this.getNorth(),this.getWest())},getSouthEast:function(){return new G(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof G||"lat"in s?s=te(s):s=B(s);var d=this._southWest,p=this._northEast,_,A;return s instanceof I?(_=s.getSouthWest(),A=s.getNorthEast()):_=A=s,_.lat>=d.lat&&A.lat<=p.lat&&_.lng>=d.lng&&A.lng<=p.lng},intersects:function(s){s=B(s);var d=this._southWest,p=this._northEast,_=s.getSouthWest(),A=s.getNorthEast(),Z=A.lat>=d.lat&&_.lat<=p.lat,ue=A.lng>=d.lng&&_.lng<=p.lng;return Z&&ue},overlaps:function(s){s=B(s);var d=this._southWest,p=this._northEast,_=s.getSouthWest(),A=s.getNorthEast(),Z=A.lat>d.lat&&_.lat<p.lat,ue=A.lng>d.lng&&_.lng<p.lng;return Z&&ue},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,d){return s?(s=B(s),this._southWest.equals(s.getSouthWest(),d)&&this._northEast.equals(s.getNorthEast(),d)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function B(s,d){return s instanceof I?s:new I(s,d)}function G(s,d,p){if(isNaN(s)||isNaN(d))throw new Error("Invalid LatLng object: ("+s+", "+d+")");this.lat=+s,this.lng=+d,p!==void 0&&(this.alt=+p)}G.prototype={equals:function(s,d){if(!s)return!1;s=te(s);var p=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return p<=(d===void 0?1e-9:d)},toString:function(s){return"LatLng("+b(this.lat,s)+", "+b(this.lng,s)+")"},distanceTo:function(s){return pe.distance(this,te(s))},wrap:function(){return pe.wrapLatLng(this)},toBounds:function(s){var d=180*s/40075017,p=d/Math.cos(Math.PI/180*this.lat);return B([this.lat-d,this.lng-p],[this.lat+d,this.lng+p])},clone:function(){return new G(this.lat,this.lng,this.alt)}};function te(s,d,p){return s instanceof G?s:N(s)&&typeof s[0]!="object"?s.length===3?new G(s[0],s[1],s[2]):s.length===2?new G(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new G(s.lat,"lng"in s?s.lng:s.lon,s.alt):d===void 0?null:new G(s,d,p)}var de={latLngToPoint:function(s,d){var p=this.projection.project(s),_=this.scale(d);return this.transformation._transform(p,_)},pointToLatLng:function(s,d){var p=this.scale(d),_=this.transformation.untransform(s,p);return this.projection.unproject(_)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var d=this.projection.bounds,p=this.scale(s),_=this.transformation.transform(d.min,p),A=this.transformation.transform(d.max,p);return new D(_,A)},infinite:!1,wrapLatLng:function(s){var d=this.wrapLng?x(s.lng,this.wrapLng,!0):s.lng,p=this.wrapLat?x(s.lat,this.wrapLat,!0):s.lat,_=s.alt;return new G(p,d,_)},wrapLatLngBounds:function(s){var d=s.getCenter(),p=this.wrapLatLng(d),_=d.lat-p.lat,A=d.lng-p.lng;if(_===0&&A===0)return s;var Z=s.getSouthWest(),ue=s.getNorthEast(),_e=new G(Z.lat-_,Z.lng-A),Ae=new G(ue.lat-_,ue.lng-A);return new I(_e,Ae)}},pe=a({},de,{wrapLng:[-180,180],R:6371e3,distance:function(s,d){var p=Math.PI/180,_=s.lat*p,A=d.lat*p,Z=Math.sin((d.lat-s.lat)*p/2),ue=Math.sin((d.lng-s.lng)*p/2),_e=Z*Z+Math.cos(_)*Math.cos(A)*ue*ue,Ae=2*Math.atan2(Math.sqrt(_e),Math.sqrt(1-_e));return this.R*Ae}}),me=6378137,ye={R:me,MAX_LATITUDE:85.0511287798,project:function(s){var d=Math.PI/180,p=this.MAX_LATITUDE,_=Math.max(Math.min(p,s.lat),-p),A=Math.sin(_*d);return new V(this.R*s.lng*d,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(s){var d=180/Math.PI;return new G((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*d,s.x*d/this.R)},bounds:(function(){var s=me*Math.PI;return new D([-s,-s],[s,s])})()};function Ke(s,d,p,_){if(N(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=d,this._c=p,this._d=_}Ke.prototype={transform:function(s,d){return this._transform(s.clone(),d)},_transform:function(s,d){return d=d||1,s.x=d*(this._a*s.x+this._b),s.y=d*(this._c*s.y+this._d),s},untransform:function(s,d){return d=d||1,new V((s.x/d-this._b)/this._a,(s.y/d-this._d)/this._c)}};function ae(s,d,p,_){return new Ke(s,d,p,_)}var at=a({},pe,{code:"EPSG:3857",projection:ye,transformation:(function(){var s=.5/(Math.PI*ye.R);return ae(s,.5,-s,.5)})()}),dt=a({},at,{code:"EPSG:900913"});function mt(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function st(s,d){var p="",_,A,Z,ue,_e,Ae;for(_=0,Z=s.length;_<Z;_++){for(_e=s[_],A=0,ue=_e.length;A<ue;A++)Ae=_e[A],p+=(A?"L":"M")+Ae.x+" "+Ae.y;p+=d?Oe.svg?"z":"x":""}return p||"M0 0"}var Le=document.documentElement.style,At="ActiveXObject"in window,dr=At&&!document.addEventListener,Yt="msLaunchUri"in navigator&&!("documentMode"in document),Qt=it("webkit"),_n=it("android"),br=it("android 2")||it("android 3"),er=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),kr=_n&&it("Google")&&er<537&&!("AudioNode"in window),fr=!!window.opera,Sr=!Yt&&it("chrome"),St=it("gecko")&&!Qt&&!fr&&!At,ir=!Sr&&it("safari"),ct=it("phantom"),Ge="OTransition"in Le,Tr=navigator.platform.indexOf("Win")===0,$t=At&&"transition"in Le,Gr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!br,sr="MozPerspective"in Le,ri=!window.L_DISABLE_3D&&($t||Gr||sr)&&!Ge&&!ct,ln=typeof orientation<"u"||it("mobile"),Fa=ln&&Qt,La=ln&&Gr,da=!window.PointerEvent&&window.MSPointerEvent,Dn=!!(window.PointerEvent||da),In="ontouchstart"in window||!!window.TouchEvent,fa=!window.L_NO_TOUCH&&(In||Dn),Di=ln&&fr,Ii=ln&&St,As=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ni=(function(){var s=!1;try{var d=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",y,d),window.removeEventListener("testPassiveEventSupport",y,d)}catch{}return s})(),Ie=(function(){return!!document.createElement("canvas").getContext})(),qe=!!(document.createElementNS&&mt("svg").createSVGRect),Je=!!qe&&(function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),He=!qe&&(function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var d=s.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch{return!1}})(),Qe=navigator.platform.indexOf("Mac")===0,ot=navigator.platform.indexOf("Linux")===0;function it(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var Oe={ie:At,ielt9:dr,edge:Yt,webkit:Qt,android:_n,android23:br,androidStock:kr,opera:fr,chrome:Sr,gecko:St,safari:ir,phantom:ct,opera12:Ge,win:Tr,ie3d:$t,webkit3d:Gr,gecko3d:sr,any3d:ri,mobile:ln,mobileWebkit:Fa,mobileWebkit3d:La,msPointer:da,pointer:Dn,touch:fa,touchNative:In,mobileOpera:Di,mobileGecko:Ii,retina:As,passiveEvents:ni,canvas:Ie,svg:qe,vml:He,inlineSvg:Je,mac:Qe,linux:ot},U=Oe.msPointer?"MSPointerDown":"pointerdown",re=Oe.msPointer?"MSPointerMove":"pointermove",q=Oe.msPointer?"MSPointerUp":"pointerup",X=Oe.msPointer?"MSPointerCancel":"pointercancel",J={touchstart:U,touchmove:re,touchend:q,touchcancel:X},ie={touchstart:Ue,touchmove:$e,touchend:$e,touchcancel:$e},ke={},De=!1;function Se(s,d,p){return d==="touchstart"&&Ye(),ie[d]?(p=ie[d].bind(this,p),s.addEventListener(J[d],p,!1),p):(console.warn("wrong event specified:",d),y)}function Ee(s,d,p){if(!J[d]){console.warn("wrong event specified:",d);return}s.removeEventListener(J[d],p,!1)}function Ce(s){ke[s.pointerId]=s}function Me(s){ke[s.pointerId]&&(ke[s.pointerId]=s)}function Ve(s){delete ke[s.pointerId]}function Ye(){De||(document.addEventListener(U,Ce,!0),document.addEventListener(re,Me,!0),document.addEventListener(q,Ve,!0),document.addEventListener(X,Ve,!0),De=!0)}function $e(s,d){if(d.pointerType!==(d.MSPOINTER_TYPE_MOUSE||"mouse")){d.touches=[];for(var p in ke)d.touches.push(ke[p]);d.changedTouches=[d],s(d)}}function Ue(s,d){d.MSPOINTER_TYPE_TOUCH&&d.pointerType===d.MSPOINTER_TYPE_TOUCH&&rr(d),$e(s,d)}function vt(s){var d={},p,_;for(_ in s)p=s[_],d[_]=p&&p.bind?p.bind(s):p;return s=d,d.type="dblclick",d.detail=2,d.isTrusted=!1,d._simulated=!0,d}var Rt=200;function Bt(s,d){s.addEventListener("dblclick",d);var p=0,_;function A(Z){if(Z.detail!==1){_=Z.detail;return}if(!(Z.pointerType==="mouse"||Z.sourceCapabilities&&!Z.sourceCapabilities.firesTouchEvents)){var ue=si(Z);if(!(ue.some(function(Ae){return Ae instanceof HTMLLabelElement&&Ae.attributes.for})&&!ue.some(function(Ae){return Ae instanceof HTMLInputElement||Ae instanceof HTMLSelectElement}))){var _e=Date.now();_e-p<=Rt?(_++,_===2&&d(vt(Z))):_=1,p=_e}}}return s.addEventListener("click",A),{dblclick:d,simDblclick:A}}function tr(s,d){s.removeEventListener("dblclick",d.dblclick),s.removeEventListener("click",d.simDblclick)}var ha=Fi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),wn=Fi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),On=wn==="webkitTransition"||wn==="OTransition"?wn+"End":"transitionend";function hr(s){return typeof s=="string"?document.getElementById(s):s}function ma(s,d){var p=s.style[d]||s.currentStyle&&s.currentStyle[d];if((!p||p==="auto")&&document.defaultView){var _=document.defaultView.getComputedStyle(s,null);p=_?_[d]:null}return p==="auto"?null:p}function lt(s,d,p){var _=document.createElement(s);return _.className=d||"",p&&p.appendChild(_),_}function Kt(s){var d=s.parentNode;d&&d.removeChild(s)}function wo(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Oi(s){var d=s.parentNode;d&&d.lastChild!==s&&d.appendChild(s)}function pa(s){var d=s.parentNode;d&&d.firstChild!==s&&d.insertBefore(s,d.firstChild)}function ji(s,d){if(s.classList!==void 0)return s.classList.contains(d);var p=bo(s);return p.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(p)}function yt(s,d){if(s.classList!==void 0)for(var p=S(d),_=0,A=p.length;_<A;_++)s.classList.add(p[_]);else if(!ji(s,d)){var Z=bo(s);Fl(s,(Z?Z+" ":"")+d)}}function Vt(s,d){s.classList!==void 0?s.classList.remove(d):Fl(s,E((" "+bo(s)+" ").replace(" "+d+" "," ")))}function Fl(s,d){s.className.baseVal===void 0?s.className=d:s.className.baseVal=d}function bo(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function Zr(s,d){"opacity"in s.style?s.style.opacity=d:"filter"in s.style&&cu(s,d)}function cu(s,d){var p=!1,_="DXImageTransform.Microsoft.Alpha";try{p=s.filters.item(_)}catch{if(d===1)return}d=Math.round(d*100),p?(p.Enabled=d!==100,p.Opacity=d):s.style.filter+=" progid:"+_+"(opacity="+d+")"}function Fi(s){for(var d=document.documentElement.style,p=0;p<s.length;p++)if(s[p]in d)return s[p];return!1}function jn(s,d,p){var _=d||new V(0,0);s.style[ha]=(Oe.ie3d?"translate("+_.x+"px,"+_.y+"px)":"translate3d("+_.x+"px,"+_.y+"px,0)")+(p?" scale("+p+")":"")}function or(s,d){s._leaflet_pos=d,Oe.any3d?jn(s,d):(s.style.left=d.x+"px",s.style.top=d.y+"px")}function ga(s){return s._leaflet_pos||new V(0,0)}var Pt,Li,ko;if("onselectstart"in document)Pt=function(){pt(window,"selectstart",rr)},Li=function(){zt(window,"selectstart",rr)};else{var ai=Fi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Pt=function(){if(ai){var s=document.documentElement.style;ko=s[ai],s[ai]="none"}},Li=function(){ai&&(document.documentElement.style[ai]=ko,ko=void 0)}}function So(){pt(window,"dragstart",rr)}function To(){zt(window,"dragstart",rr)}var Ps,Ns;function Ri(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Fn(),Ps=s,Ns=s.style.outlineStyle,s.style.outlineStyle="none",pt(window,"keydown",Fn))}function Fn(){Ps&&(Ps.style.outlineStyle=Ns,Ps=void 0,Ns=void 0,zt(window,"keydown",Fn))}function va(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Zn(s){var d=s.getBoundingClientRect();return{x:d.width/s.offsetWidth||1,y:d.height/s.offsetHeight||1,boundingClientRect:d}}var Ds={__proto__:null,TRANSFORM:ha,TRANSITION:wn,TRANSITION_END:On,get:hr,getStyle:ma,create:lt,remove:Kt,empty:wo,toFront:Oi,toBack:pa,hasClass:ji,addClass:yt,removeClass:Vt,setClass:Fl,getClass:bo,setOpacity:Zr,testProp:Fi,setTransform:jn,setPosition:or,getPosition:ga,get disableTextSelection(){return Pt},get enableTextSelection(){return Li},disableImageDrag:So,enableImageDrag:To,preventOutline:Ri,restoreOutline:Fn,getSizedParentNode:va,getScale:Zn};function pt(s,d,p,_){if(d&&typeof d=="object")for(var A in d)Rl(s,A,d[A],p);else{d=S(d);for(var Z=0,ue=d.length;Z<ue;Z++)Rl(s,d[Z],p,_)}return this}var Er="_leaflet_events";function zt(s,d,p,_){if(arguments.length===1)Ll(s),delete s[Er];else if(d&&typeof d=="object")for(var A in d)Eo(s,A,d[A],p);else if(d=S(d),arguments.length===2)Ll(s,function(_e){return F(d,_e)!==-1});else for(var Z=0,ue=d.length;Z<ue;Z++)Eo(s,d[Z],p,_);return this}function Ll(s,d){for(var p in s[Er]){var _=p.split(/\d/)[0];(!d||d(_))&&Eo(s,_,null,null,p)}}var ii={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Rl(s,d,p,_){var A=d+m(p)+(_?"_"+m(_):"");if(s[Er]&&s[Er][A])return this;var Z=function(_e){return p.call(_||s,_e||window.event)},ue=Z;!Oe.touchNative&&Oe.pointer&&d.indexOf("touch")===0?Z=Se(s,d,Z):Oe.touch&&d==="dblclick"?Z=Bt(s,Z):"addEventListener"in s?d==="touchstart"||d==="touchmove"||d==="wheel"||d==="mousewheel"?s.addEventListener(ii[d]||d,Z,Oe.passiveEvents?{passive:!1}:!1):d==="mouseenter"||d==="mouseleave"?(Z=function(_e){_e=_e||window.event,js(s,_e)&&ue(_e)},s.addEventListener(ii[d],Z,!1)):s.addEventListener(d,ue,!1):s.attachEvent("on"+d,Z),s[Er]=s[Er]||{},s[Er][A]=Z}function Eo(s,d,p,_,A){A=A||d+m(p)+(_?"_"+m(_):"");var Z=s[Er]&&s[Er][A];if(!Z)return this;!Oe.touchNative&&Oe.pointer&&d.indexOf("touch")===0?Ee(s,d,Z):Oe.touch&&d==="dblclick"?tr(s,Z):"removeEventListener"in s?s.removeEventListener(ii[d]||d,Z,!1):s.detachEvent("on"+d,Z),s[Er][A]=null}function Kn(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function Co(s){return Rl(s,"wheel",Kn),this}function Is(s){return pt(s,"mousedown touchstart dblclick contextmenu",Kn),s._leaflet_disable_click=!0,this}function rr(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function Ln(s){return rr(s),Kn(s),this}function si(s){if(s.composedPath)return s.composedPath();for(var d=[],p=s.target;p;)d.push(p),p=p.parentNode;return d}function Os(s,d){if(!d)return new V(s.clientX,s.clientY);var p=Zn(d),_=p.boundingClientRect;return new V((s.clientX-_.left)/p.x-d.clientLeft,(s.clientY-_.top)/p.y-d.clientTop)}var vf=Oe.linux&&Oe.chrome?window.devicePixelRatio:Oe.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function uu(s){return Oe.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/vf:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function js(s,d){var p=d.relatedTarget;if(!p)return!0;try{for(;p&&p!==s;)p=p.parentNode}catch{return!1}return p!==s}var Ao={__proto__:null,on:pt,off:zt,stopPropagation:Kn,disableScrollPropagation:Co,disableClickPropagation:Is,preventDefault:rr,stop:Ln,getPropagationPath:si,getMousePosition:Os,getWheelDelta:uu,isExternalTarget:js,addListener:pt,removeListener:zt},Po=M.extend({run:function(s,d,p,_){this.stop(),this._el=s,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(_||.5,.2),this._startPos=ga(s),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=he(this._animate,this),this._step()},_step:function(s){var d=+new Date-this._startTime,p=this._duration*1e3;d<p?this._runFrame(this._easeOut(d/p),s):(this._runFrame(1),this._complete())},_runFrame:function(s,d){var p=this._startPos.add(this._offset.multiplyBy(s));d&&p._round(),or(this._el,p),this.fire("step")},_complete:function(){ce(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Et=M.extend({options:{crs:at,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,d){d=k(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(te(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=wn&&Oe.any3d&&!Oe.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),pt(this._proxy,On,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,d,p){if(d=d===void 0?this._zoom:this._limitZoom(d),s=this._limitCenter(te(s),d,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=a({animate:p.animate},p.zoom),p.pan=a({animate:p.animate,duration:p.duration},p.pan));var _=this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,d,p.zoom):this._tryAnimatedPan(s,p.pan);if(_)return clearTimeout(this._sizeTimer),this}return this._resetView(s,d,p.pan&&p.pan.noMoveStart),this},setZoom:function(s,d){return this._loaded?this.setView(this.getCenter(),s,{zoom:d}):(this._zoom=s,this)},zoomIn:function(s,d){return s=s||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,d)},zoomOut:function(s,d){return s=s||(Oe.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,d)},setZoomAround:function(s,d,p){var _=this.getZoomScale(d),A=this.getSize().divideBy(2),Z=s instanceof V?s:this.latLngToContainerPoint(s),ue=Z.subtract(A).multiplyBy(1-1/_),_e=this.containerPointToLatLng(A.add(ue));return this.setView(_e,d,{zoom:p})},_getBoundsCenterZoom:function(s,d){d=d||{},s=s.getBounds?s.getBounds():B(s);var p=se(d.paddingTopLeft||d.padding||[0,0]),_=se(d.paddingBottomRight||d.padding||[0,0]),A=this.getBoundsZoom(s,!1,p.add(_));if(A=typeof d.maxZoom=="number"?Math.min(d.maxZoom,A):A,A===1/0)return{center:s.getCenter(),zoom:A};var Z=_.subtract(p).divideBy(2),ue=this.project(s.getSouthWest(),A),_e=this.project(s.getNorthEast(),A),Ae=this.unproject(ue.add(_e).divideBy(2).add(Z),A);return{center:Ae,zoom:A}},fitBounds:function(s,d){if(s=B(s),!s.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(s,d);return this.setView(p.center,p.zoom,d)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,d){return this.setView(s,this._zoom,{pan:d})},panBy:function(s,d){if(s=se(s).round(),d=d||{},!s.x&&!s.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Po,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){yt(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,p,d.duration||.25,d.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,d,p){if(p=p||{},p.animate===!1||!Oe.any3d)return this.setView(s,d,p);this._stop();var _=this.project(this.getCenter()),A=this.project(s),Z=this.getSize(),ue=this._zoom;s=te(s),d=d===void 0?ue:d;var _e=Math.max(Z.x,Z.y),Ae=_e*this.getZoomScale(ue,d),je=A.distanceTo(_)||1,Ze=1.42,ut=Ze*Ze;function wt(Lt){var Ji=Lt?-1:1,Df=Lt?Ae:_e,If=Ae*Ae-_e*_e+Ji*ut*ut*je*je,hi=2*Df*ut*je,mi=If/hi,pi=Math.sqrt(mi*mi+1)-mi,Wo=pi<1e-9?-18:Math.log(pi);return Wo}function Cr(Lt){return(Math.exp(Lt)-Math.exp(-Lt))/2}function gr(Lt){return(Math.exp(Lt)+Math.exp(-Lt))/2}function dn(Lt){return Cr(Lt)/gr(Lt)}var qr=wt(0);function Yi(Lt){return _e*(gr(qr)/gr(qr+Ze*Lt))}function ac(Lt){return _e*(gr(qr)*dn(qr+Ze*Lt)-Cr(qr))/ut}function Va(Lt){return 1-Math.pow(1-Lt,1.5)}var Du=Date.now(),fi=(wt(1)-qr)/Ze,Jn=p.duration?1e3*p.duration:1e3*fi*.8;function Xi(){var Lt=(Date.now()-Du)/Jn,Ji=Va(Lt)*fi;Lt<=1?(this._flyToFrame=he(Xi,this),this._move(this.unproject(_.add(A.subtract(_).multiplyBy(ac(Ji)/je)),ue),this.getScaleZoom(_e/Yi(Ji),ue),{flyTo:!0})):this._move(s,d)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),Xi.call(this),this},flyToBounds:function(s,d){var p=this._getBoundsCenterZoom(s,d);return this.flyTo(p.center,p.zoom,d)},setMaxBounds:function(s){return s=B(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var d=this.options.minZoom;return this.options.minZoom=s,this._loaded&&d!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var d=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&d!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,d){this._enforcingBounds=!0;var p=this.getCenter(),_=this._limitCenter(p,this._zoom,B(s));return p.equals(_)||this.panTo(_,d),this._enforcingBounds=!1,this},panInside:function(s,d){d=d||{};var p=se(d.paddingTopLeft||d.padding||[0,0]),_=se(d.paddingBottomRight||d.padding||[0,0]),A=this.project(this.getCenter()),Z=this.project(s),ue=this.getPixelBounds(),_e=P([ue.min.add(p),ue.max.subtract(_)]),Ae=_e.getSize();if(!_e.contains(Z)){this._enforcingBounds=!0;var je=Z.subtract(_e.getCenter()),Ze=_e.extend(Z).getSize().subtract(Ae);A.x+=je.x<0?-Ze.x:Ze.x,A.y+=je.y<0?-Ze.y:Ze.y,this.panTo(this.unproject(A),d),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=a({animate:!1,pan:!0},s===!0?{animate:!0}:s);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),_=d.divideBy(2).round(),A=p.divideBy(2).round(),Z=_.subtract(A);return!Z.x&&!Z.y?this:(s.animate&&s.pan?this.panBy(Z):(s.pan&&this._rawPanBy(Z),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=a({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=c(this._handleGeolocationResponse,this),p=c(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,p,s):navigator.geolocation.getCurrentPosition(d,p,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var d=s.code,p=s.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var d=s.coords.latitude,p=s.coords.longitude,_=new G(d,p),A=_.toBounds(s.coords.accuracy*2),Z=this._locateOptions;if(Z.setView){var ue=this.getBoundsZoom(A);this.setView(_,Z.maxZoom?Math.min(ue,Z.maxZoom):ue)}var _e={latlng:_,bounds:A,timestamp:s.timestamp};for(var Ae in s.coords)typeof s.coords[Ae]=="number"&&(_e[Ae]=s.coords[Ae]);this.fire("locationfound",_e)}},addHandler:function(s,d){if(!d)return this;var p=this[s]=new d(this);return this._handlers.push(p),this.options[s]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Kt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ce(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)Kt(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,d){var p="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),_=lt("div",p,d||this._mapPane);return s&&(this._panes[s]=_),_},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),d=this.unproject(s.getBottomLeft()),p=this.unproject(s.getTopRight());return new I(d,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,d,p){s=B(s),p=se(p||[0,0]);var _=this.getZoom()||0,A=this.getMinZoom(),Z=this.getMaxZoom(),ue=s.getNorthWest(),_e=s.getSouthEast(),Ae=this.getSize().subtract(p),je=P(this.project(_e,_),this.project(ue,_)).getSize(),Ze=Oe.any3d?this.options.zoomSnap:1,ut=Ae.x/je.x,wt=Ae.y/je.y,Cr=d?Math.max(ut,wt):Math.min(ut,wt);return _=this.getScaleZoom(Cr,_),Ze&&(_=Math.round(_/(Ze/100))*(Ze/100),_=d?Math.ceil(_/Ze)*Ze:Math.floor(_/Ze)*Ze),Math.max(A,Math.min(Z,_))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new V(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,d){var p=this._getTopLeftPoint(s,d);return new D(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,d){var p=this.options.crs;return d=d===void 0?this._zoom:d,p.scale(s)/p.scale(d)},getScaleZoom:function(s,d){var p=this.options.crs;d=d===void 0?this._zoom:d;var _=p.zoom(s*p.scale(d));return isNaN(_)?1/0:_},project:function(s,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(te(s),d)},unproject:function(s,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(se(s),d)},layerPointToLatLng:function(s){var d=se(s).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(s){var d=this.project(te(s))._round();return d._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(te(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(B(s))},distance:function(s,d){return this.options.crs.distance(te(s),te(d))},containerPointToLayerPoint:function(s){return se(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return se(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var d=this.containerPointToLayerPoint(se(s));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(te(s)))},mouseEventToContainerPoint:function(s){return Os(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var d=this._container=hr(s);if(d){if(d._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");pt(d,"scroll",this._onScroll,this),this._containerId=m(d)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&Oe.any3d,yt(s,"leaflet-container"+(Oe.touch?" leaflet-touch":"")+(Oe.retina?" leaflet-retina":"")+(Oe.ielt9?" leaflet-oldie":"")+(Oe.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=ma(s,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&d!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),or(this._mapPane,new V(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yt(s.markerPane,"leaflet-zoom-hide"),yt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,d,p){or(this._mapPane,new V(0,0));var _=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var A=this._zoom!==d;this._moveStart(A,p)._move(s,d)._moveEnd(A),this.fire("viewreset"),_&&this.fire("load")},_moveStart:function(s,d){return s&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(s,d,p,_){d===void 0&&(d=this._zoom);var A=this._zoom!==d;return this._zoom=d,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),_?p&&p.pinch&&this.fire("zoom",p):((A||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ce(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){or(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[m(this._container)]=this;var d=s?zt:pt;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),Oe.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ce(this._resizeRequest),this._resizeRequest=he(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,d){for(var p=[],_,A=d==="mouseout"||d==="mouseover",Z=s.target||s.srcElement,ue=!1;Z;){if(_=this._targets[m(Z)],_&&(d==="click"||d==="preclick")&&this._draggableMoved(_)){ue=!0;break}if(_&&_.listens(d,!0)&&(A&&!js(Z,s)||(p.push(_),A))||Z===this._container)break;Z=Z.parentNode}return!p.length&&!ue&&!A&&this.listens(d,!0)&&(p=[this]),p},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var d=s.target||s.srcElement;if(!(!this._loaded||d._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(d))){var p=s.type;p==="mousedown"&&Ri(d),this._fireDOMEvent(s,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,d,p){if(s.type==="click"){var _=a({},s);_.type="preclick",this._fireDOMEvent(_,_.type,p)}var A=this._findEventTargets(s,d);if(p){for(var Z=[],ue=0;ue<p.length;ue++)p[ue].listens(d,!0)&&Z.push(p[ue]);A=Z.concat(A)}if(A.length){d==="contextmenu"&&rr(s);var _e=A[0],Ae={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var je=_e.getLatLng&&(!_e._radius||_e._radius<=10);Ae.containerPoint=je?this.latLngToContainerPoint(_e.getLatLng()):this.mouseEventToContainerPoint(s),Ae.layerPoint=this.containerPointToLayerPoint(Ae.containerPoint),Ae.latlng=je?_e.getLatLng():this.layerPointToLatLng(Ae.layerPoint)}for(ue=0;ue<A.length;ue++)if(A[ue].fire(d,Ae,!0),Ae.originalEvent._stopped||A[ue].options.bubblingMouseEvents===!1&&F(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,d=this._handlers.length;s<d;s++)this._handlers[s].disable()},whenReady:function(s,d){return this._loaded?s.call(d||this,{target:this}):this.on("load",s,d),this},_getMapPanePos:function(){return ga(this._mapPane)||new V(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,d){var p=s&&d!==void 0?this._getNewPixelOrigin(s,d):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,d){var p=this.getSize()._divideBy(2);return this.project(s,d)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,d,p){var _=this._getNewPixelOrigin(p,d);return this.project(s,d)._subtract(_)},_latLngBoundsToNewLayerBounds:function(s,d,p){var _=this._getNewPixelOrigin(p,d);return P([this.project(s.getSouthWest(),d)._subtract(_),this.project(s.getNorthWest(),d)._subtract(_),this.project(s.getSouthEast(),d)._subtract(_),this.project(s.getNorthEast(),d)._subtract(_)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,d,p){if(!p)return s;var _=this.project(s,d),A=this.getSize().divideBy(2),Z=new D(_.subtract(A),_.add(A)),ue=this._getBoundsOffset(Z,p,d);return Math.abs(ue.x)<=1&&Math.abs(ue.y)<=1?s:this.unproject(_.add(ue),d)},_limitOffset:function(s,d){if(!d)return s;var p=this.getPixelBounds(),_=new D(p.min.add(s),p.max.add(s));return s.add(this._getBoundsOffset(_,d))},_getBoundsOffset:function(s,d,p){var _=P(this.project(d.getNorthEast(),p),this.project(d.getSouthWest(),p)),A=_.min.subtract(s.min),Z=_.max.subtract(s.max),ue=this._rebound(A.x,-Z.x),_e=this._rebound(A.y,-Z.y);return new V(ue,_e)},_rebound:function(s,d){return s+d>0?Math.round(s-d)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(d))},_limitZoom:function(s){var d=this.getMinZoom(),p=this.getMaxZoom(),_=Oe.any3d?this.options.zoomSnap:1;return _&&(s=Math.round(s/_)*_),Math.max(d,Math.min(p,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Vt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,d){var p=this._getCenterOffset(s)._trunc();return(d&&d.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,d),!0)},_createAnimProxy:function(){var s=this._proxy=lt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(d){var p=ha,_=this._proxy.style[p];jn(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),_===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Kt(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),d=this.getZoom();jn(this._proxy,this.project(s,d),this.getZoomScale(d,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,d,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var _=this.getZoomScale(d),A=this._getCenterOffset(s)._divideBy(1-1/_);return p.animate!==!0&&!this.getSize().contains(A)?!1:(he(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(s,d,!0)},this),!0)},_animateZoom:function(s,d,p,_){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=d,yt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:d,noUpdate:_}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Vt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ra(s,d){return new Et(s,d)}var cn=xe.extend({options:{position:"topright"},initialize:function(s){k(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var d=this._map;return d&&d.removeControl(this),this.options.position=s,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var d=this._container=this.onAdd(s),p=this.getPosition(),_=s._controlCorners[p];return yt(d,"leaflet-control"),p.indexOf("bottom")!==-1?_.insertBefore(d,_.firstChild):_.appendChild(d),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Kt(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Ma=function(s){return new cn(s)};Et.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},d="leaflet-",p=this._controlContainer=lt("div",d+"control-container",this._container);function _(A,Z){var ue=d+A+" "+d+Z;s[A+Z]=lt("div",ue,p)}_("top","left"),_("top","right"),_("bottom","left"),_("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)Kt(this._controlCorners[s]);Kt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ml=cn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,d,p,_){return p<_?-1:_<p?1:0}},initialize:function(s,d,p){k(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var _ in s)this._addLayer(s[_],_);for(_ in d)this._addLayer(d[_],_,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return cn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,d){return this._addLayer(s,d),this._map?this._update():this},addOverlay:function(s,d){return this._addLayer(s,d,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var d=this._getLayer(m(s));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){yt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(yt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Vt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Vt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",d=this._container=lt("div",s),p=this.options.collapsed;d.setAttribute("aria-haspopup",!0),Is(d),Co(d);var _=this._section=lt("section",s+"-list");p&&(this._map.on("click",this.collapse,this),pt(d,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var A=this._layersLink=lt("a",s+"-toggle",d);A.href="#",A.title="Layers",A.setAttribute("role","button"),pt(A,{keydown:function(Z){Z.keyCode===13&&this._expandSafely()},click:function(Z){rr(Z),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=lt("div",s+"-base",_),this._separator=lt("div",s+"-separator",_),this._overlaysList=lt("div",s+"-overlays",_),d.appendChild(_)},_getLayer:function(s){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&m(this._layers[d].layer)===s)return this._layers[d]},_addLayer:function(s,d,p){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:d,overlay:p}),this.options.sortLayers&&this._layers.sort(c(function(_,A){return this.options.sortFunction(_.layer,A.layer,_.name,A.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;wo(this._baseLayersList),wo(this._overlaysList),this._layerControlInputs=[];var s,d,p,_,A=0;for(p=0;p<this._layers.length;p++)_=this._layers[p],this._addItem(_),d=d||_.overlay,s=s||!_.overlay,A+=_.overlay?0:1;return this.options.hideSingleBase&&(s=s&&A>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=d&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var d=this._getLayer(m(s.target)),p=d.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;p&&this._map.fire(p,d)},_createRadioElement:function(s,d){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(d?' checked="checked"':"")+"/>",_=document.createElement("div");return _.innerHTML=p,_.firstChild},_addItem:function(s){var d=document.createElement("label"),p=this._map.hasLayer(s.layer),_;s.overlay?(_=document.createElement("input"),_.type="checkbox",_.className="leaflet-control-layers-selector",_.defaultChecked=p):_=this._createRadioElement("leaflet-base-layers_"+m(this),p),this._layerControlInputs.push(_),_.layerId=m(s.layer),pt(_,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+s.name;var Z=document.createElement("span");d.appendChild(Z),Z.appendChild(_),Z.appendChild(A);var ue=s.overlay?this._overlaysList:this._baseLayersList;return ue.appendChild(d),this._checkDisabledLayers(),d},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,d,p,_=[],A=[];this._handlingClick=!0;for(var Z=s.length-1;Z>=0;Z--)d=s[Z],p=this._getLayer(d.layerId).layer,d.checked?_.push(p):d.checked||A.push(p);for(Z=0;Z<A.length;Z++)this._map.hasLayer(A[Z])&&this._map.removeLayer(A[Z]);for(Z=0;Z<_.length;Z++)this._map.hasLayer(_[Z])||this._map.addLayer(_[Z]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,d,p,_=this._map.getZoom(),A=s.length-1;A>=0;A--)d=s[A],p=this._getLayer(d.layerId).layer,d.disabled=p.options.minZoom!==void 0&&_<p.options.minZoom||p.options.maxZoom!==void 0&&_>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,pt(s,"click",rr),this.expand();var d=this;setTimeout(function(){zt(s,"click",rr),d._preventClick=!1})}}),No=function(s,d,p){return new Ml(s,d,p)},Mi=cn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var d="leaflet-control-zoom",p=lt("div",d+" leaflet-bar"),_=this.options;return this._zoomInButton=this._createButton(_.zoomInText,_.zoomInTitle,d+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(_.zoomOutText,_.zoomOutTitle,d+"-out",p,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,d,p,_,A){var Z=lt("a",p,_);return Z.innerHTML=s,Z.href="#",Z.title=d,Z.setAttribute("role","button"),Z.setAttribute("aria-label",d),Is(Z),pt(Z,"click",Ln),pt(Z,"click",A,this),pt(Z,"click",this._refocusOnMap,this),Z},_updateDisabled:function(){var s=this._map,d="leaflet-disabled";Vt(this._zoomInButton,d),Vt(this._zoomOutButton,d),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(yt(this._zoomOutButton,d),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(yt(this._zoomInButton,d),this._zoomInButton.setAttribute("aria-disabled","true"))}});Et.mergeOptions({zoomControl:!0}),Et.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Mi,this.addControl(this.zoomControl))});var du=function(s){return new Mi(s)},Kr=cn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var d="leaflet-control-scale",p=lt("div",d),_=this.options;return this._addScales(_,d+"-line",p),s.on(_.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),p},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,d,p){s.metric&&(this._mScale=lt("div",d,p)),s.imperial&&(this._iScale=lt("div",d,p))},_update:function(){var s=this._map,d=s.getSize().y/2,p=s.distance(s.containerPointToLatLng([0,d]),s.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(p)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var d=this._getRoundNum(s),p=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,p,d/s)},_updateImperial:function(s){var d=s*3.2808399,p,_,A;d>5280?(p=d/5280,_=this._getRoundNum(p),this._updateScale(this._iScale,_+" mi",_/p)):(A=this._getRoundNum(d),this._updateScale(this._iScale,A+" ft",A/d))},_updateScale:function(s,d,p){s.style.width=Math.round(this.options.maxWidth*p)+"px",s.innerHTML=d},_getRoundNum:function(s){var d=Math.pow(10,(Math.floor(s)+"").length-1),p=s/d;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,d*p}}),Bi=function(s){return new Kr(s)},Bl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',oi=cn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Oe.inlineSvg?Bl+" ":"")+"Leaflet</a>"},initialize:function(s){k(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=lt("div","leaflet-control-attribution"),Is(this._container);for(var d in s._layers)s._layers[d].getAttribution&&this.addAttribution(s._layers[d].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var d in this._attributions)this._attributions[d]&&s.push(d);var p=[];this.options.prefix&&p.push(this.options.prefix),s.length&&p.push(s.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});Et.mergeOptions({attributionControl:!0}),Et.addInitHook(function(){this.options.attributionControl&&new oi().addTo(this)});var xf=function(s){return new oi(s)};cn.Layers=Ml,cn.Zoom=Mi,cn.Scale=Kr,cn.Attribution=oi,Ma.layers=No,Ma.zoom=du,Ma.scale=Bi,Ma.attribution=xf;var bn=xe.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});bn.addTo=function(s,d){return s.addHandler(d,this),this};var zl={Events:Q},zi=Oe.touch?"touchstart mousedown":"mousedown",Rn=M.extend({options:{clickTolerance:3},initialize:function(s,d,p,_){k(this,_),this._element=s,this._dragStartTarget=d||s,this._preventOutline=p},enable:function(){this._enabled||(pt(this._dragStartTarget,zi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Rn._dragging===this&&this.finishDrag(!0),zt(this._dragStartTarget,zi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!ji(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Rn._dragging===this&&this.finishDrag();return}if(!(Rn._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Rn._dragging=this,this._preventOutline&&Ri(this._element),So(),Pt(),!this._moving)){this.fire("down");var d=s.touches?s.touches[0]:s,p=va(this._element);this._startPoint=new V(d.clientX,d.clientY),this._startPos=ga(this._element),this._parentScale=Zn(p);var _=s.type==="mousedown";pt(document,_?"mousemove":"touchmove",this._onMove,this),pt(document,_?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var d=s.touches&&s.touches.length===1?s.touches[0]:s,p=new V(d.clientX,d.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,rr(s),this._moved||(this.fire("dragstart"),this._moved=!0,yt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),or(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Vt(document.body,"leaflet-dragging"),this._lastTarget&&(Vt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),zt(document,"mousemove touchmove",this._onMove,this),zt(document,"mouseup touchend touchcancel",this._onUp,this),To(),Li();var d=this._moved&&this._moving;this._moving=!1,Rn._dragging=!1,d&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Ul(s,d,p){var _,A=[1,4,2,8],Z,ue,_e,Ae,je,Ze,ut,wt;for(Z=0,Ze=s.length;Z<Ze;Z++)s[Z]._code=li(s[Z],d);for(_e=0;_e<4;_e++){for(ut=A[_e],_=[],Z=0,Ze=s.length,ue=Ze-1;Z<Ze;ue=Z++)Ae=s[Z],je=s[ue],Ae._code&ut?je._code&ut||(wt=Io(je,Ae,ut,d,p),wt._code=li(wt,d),_.push(wt)):(je._code&ut&&(wt=Io(je,Ae,ut,d,p),wt._code=li(wt,d),_.push(wt)),_.push(Ae));s=_}return s}function fu(s,d){var p,_,A,Z,ue,_e,Ae,je,Ze;if(!s||s.length===0)throw new Error("latlngs not passed");kn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var ut=te([0,0]),wt=B(s),Cr=wt.getNorthWest().distanceTo(wt.getSouthWest())*wt.getNorthEast().distanceTo(wt.getNorthWest());Cr<1700&&(ut=$l(s));var gr=s.length,dn=[];for(p=0;p<gr;p++){var qr=te(s[p]);dn.push(d.project(te([qr.lat-ut.lat,qr.lng-ut.lng])))}for(_e=Ae=je=0,p=0,_=gr-1;p<gr;_=p++)A=dn[p],Z=dn[_],ue=A.y*Z.x-Z.y*A.x,Ae+=(A.x+Z.x)*ue,je+=(A.y+Z.y)*ue,_e+=ue*3;_e===0?Ze=dn[0]:Ze=[Ae/_e,je/_e];var Yi=d.unproject(se(Ze));return te([Yi.lat+ut.lat,Yi.lng+ut.lng])}function $l(s){for(var d=0,p=0,_=0,A=0;A<s.length;A++){var Z=te(s[A]);d+=Z.lat,p+=Z.lng,_++}return te([d/_,p/_])}var yf={__proto__:null,clipPolygon:Ul,polygonCenter:fu,centroid:$l};function Do(s,d){if(!d||!s.length)return s.slice();var p=d*d;return s=bf(s,p),s=wf(s,p),s}function hu(s,d,p){return Math.sqrt(ci(s,d,p,!0))}function _f(s,d,p){return ci(s,d,p)}function wf(s,d){var p=s.length,_=typeof Uint8Array<"u"?Uint8Array:Array,A=new _(p);A[0]=A[p-1]=1,Wl(s,A,d,0,p-1);var Z,ue=[];for(Z=0;Z<p;Z++)A[Z]&&ue.push(s[Z]);return ue}function Wl(s,d,p,_,A){var Z=0,ue,_e,Ae;for(_e=_+1;_e<=A-1;_e++)Ae=ci(s[_e],s[_],s[A],!0),Ae>Z&&(ue=_e,Z=Ae);Z>p&&(d[ue]=1,Wl(s,d,p,_,ue),Wl(s,d,p,ue,A))}function bf(s,d){for(var p=[s[0]],_=1,A=0,Z=s.length;_<Z;_++)kf(s[_],s[A])>d&&(p.push(s[_]),A=_);return A<Z-1&&p.push(s[Z-1]),p}var Vl;function mu(s,d,p,_,A){var Z=_?Vl:li(s,p),ue=li(d,p),_e,Ae,je;for(Vl=ue;;){if(!(Z|ue))return[s,d];if(Z&ue)return!1;_e=Z||ue,Ae=Io(s,d,_e,p,A),je=li(Ae,p),_e===Z?(s=Ae,Z=je):(d=Ae,ue=je)}}function Io(s,d,p,_,A){var Z=d.x-s.x,ue=d.y-s.y,_e=_.min,Ae=_.max,je,Ze;return p&8?(je=s.x+Z*(Ae.y-s.y)/ue,Ze=Ae.y):p&4?(je=s.x+Z*(_e.y-s.y)/ue,Ze=_e.y):p&2?(je=Ae.x,Ze=s.y+ue*(Ae.x-s.x)/Z):p&1&&(je=_e.x,Ze=s.y+ue*(_e.x-s.x)/Z),new V(je,Ze,A)}function li(s,d){var p=0;return s.x<d.min.x?p|=1:s.x>d.max.x&&(p|=2),s.y<d.min.y?p|=4:s.y>d.max.y&&(p|=8),p}function kf(s,d){var p=d.x-s.x,_=d.y-s.y;return p*p+_*_}function ci(s,d,p,_){var A=d.x,Z=d.y,ue=p.x-A,_e=p.y-Z,Ae=ue*ue+_e*_e,je;return Ae>0&&(je=((s.x-A)*ue+(s.y-Z)*_e)/Ae,je>1?(A=p.x,Z=p.y):je>0&&(A+=ue*je,Z+=_e*je)),ue=s.x-A,_e=s.y-Z,_?ue*ue+_e*_e:new V(A,Z)}function kn(s){return!N(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function pu(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),kn(s)}function gu(s,d){var p,_,A,Z,ue,_e,Ae,je;if(!s||s.length===0)throw new Error("latlngs not passed");kn(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var Ze=te([0,0]),ut=B(s),wt=ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest());wt<1700&&(Ze=$l(s));var Cr=s.length,gr=[];for(p=0;p<Cr;p++){var dn=te(s[p]);gr.push(d.project(te([dn.lat-Ze.lat,dn.lng-Ze.lng])))}for(p=0,_=0;p<Cr-1;p++)_+=gr[p].distanceTo(gr[p+1])/2;if(_===0)je=gr[0];else for(p=0,Z=0;p<Cr-1;p++)if(ue=gr[p],_e=gr[p+1],A=ue.distanceTo(_e),Z+=A,Z>_){Ae=(Z-_)/A,je=[_e.x-Ae*(_e.x-ue.x),_e.y-Ae*(_e.y-ue.y)];break}var qr=d.unproject(se(je));return te([qr.lat+Ze.lat,qr.lng+Ze.lng])}var vu={__proto__:null,simplify:Do,pointToSegmentDistance:hu,closestPointOnSegment:_f,clipSegment:mu,_getEdgeIntersection:Io,_getBitCode:li,_sqClosestPointOnSegment:ci,isFlat:kn,_flat:pu,polylineCenter:gu},Hl={project:function(s){return new V(s.lng,s.lat)},unproject:function(s){return new G(s.y,s.x)},bounds:new D([-180,-90],[180,90])},Gl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new D([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var d=Math.PI/180,p=this.R,_=s.lat*d,A=this.R_MINOR/p,Z=Math.sqrt(1-A*A),ue=Z*Math.sin(_),_e=Math.tan(Math.PI/4-_/2)/Math.pow((1-ue)/(1+ue),Z/2);return _=-p*Math.log(Math.max(_e,1e-10)),new V(s.lng*d*p,_)},unproject:function(s){for(var d=180/Math.PI,p=this.R,_=this.R_MINOR/p,A=Math.sqrt(1-_*_),Z=Math.exp(-s.y/p),ue=Math.PI/2-2*Math.atan(Z),_e=0,Ae=.1,je;_e<15&&Math.abs(Ae)>1e-7;_e++)je=A*Math.sin(ue),je=Math.pow((1-je)/(1+je),A/2),Ae=Math.PI/2-2*Math.atan(Z*je)-ue,ue+=Ae;return new G(ue*d,s.x*d/p)}},Sf={__proto__:null,LonLat:Hl,Mercator:Gl,SphericalMercator:ye},Tf=a({},pe,{code:"EPSG:3395",projection:Gl,transformation:(function(){var s=.5/(Math.PI*Gl.R);return ae(s,.5,-s,.5)})()}),xu=a({},pe,{code:"EPSG:4326",projection:Hl,transformation:ae(1/180,1,-1/180,.5)}),Ef=a({},de,{projection:Hl,transformation:ae(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,d){var p=d.lng-s.lng,_=d.lat-s.lat;return Math.sqrt(p*p+_*_)},infinite:!0});de.Earth=pe,de.EPSG3395=Tf,de.EPSG3857=at,de.EPSG900913=dt,de.EPSG4326=xu,de.Simple=Ef;var Mn=M.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[m(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[m(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var d=s.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var p=this.getEvents();d.on(p,this),this.once("remove",function(){d.off(p,this)},this)}this.onAdd(d),this.fire("add"),d.fire("layeradd",{layer:this})}}});Et.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var d=m(s);return this._layers[d]?this:(this._layers[d]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var d=m(s);return this._layers[d]?(this._loaded&&s.onRemove(this),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return m(s)in this._layers},eachLayer:function(s,d){for(var p in this._layers)s.call(d,this._layers[p]);return this},_addLayers:function(s){s=s?N(s)?s:[s]:[];for(var d=0,p=s.length;d<p;d++)this.addLayer(s[d])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[m(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var d=m(s);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,d=-1/0,p=this._getZoomSpan();for(var _ in this._zoomBoundLayers){var A=this._zoomBoundLayers[_].options;s=A.minZoom===void 0?s:Math.min(s,A.minZoom),d=A.maxZoom===void 0?d:Math.max(d,A.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=s===1/0?void 0:s,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ba=Mn.extend({initialize:function(s,d){k(this,d),this._layers={};var p,_;if(s)for(p=0,_=s.length;p<_;p++)this.addLayer(s[p])},addLayer:function(s){var d=this.getLayerId(s);return this._layers[d]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var d=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(s){var d=typeof s=="number"?s:this.getLayerId(s);return d in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var d=Array.prototype.slice.call(arguments,1),p,_;for(p in this._layers)_=this._layers[p],_[s]&&_[s].apply(_,d);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,d){for(var p in this._layers)s.call(d,this._layers[p]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return m(s)}}),Fs=function(s,d){return new Ba(s,d)},xa=Ba.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Ba.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Ba.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new I;for(var d in this._layers){var p=this._layers[d];s.extend(p.getBounds?p.getBounds():p.getLatLng())}return s}}),yu=function(s,d){return new xa(s,d)},ui=xe.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){k(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,d){var p=this._getIconUrl(s);if(!p){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var _=this._createImg(p,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(_,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),_},_setIconStyles:function(s,d){var p=this.options,_=p[d+"Size"];typeof _=="number"&&(_=[_,_]);var A=se(_),Z=se(d==="shadow"&&p.shadowAnchor||p.iconAnchor||A&&A.divideBy(2,!0));s.className="leaflet-marker-"+d+" "+(p.className||""),Z&&(s.style.marginLeft=-Z.x+"px",s.style.marginTop=-Z.y+"px"),A&&(s.style.width=A.x+"px",s.style.height=A.y+"px")},_createImg:function(s,d){return d=d||document.createElement("img"),d.src=s,d},_getIconUrl:function(s){return Oe.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function _u(s){return new ui(s)}var Ui=ui.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof Ui.imagePath!="string"&&(Ui.imagePath=this._detectIconPath()),(this.options.imagePath||Ui.imagePath)+ui.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var d=function(p,_,A){var Z=_.exec(p);return Z&&Z[A]};return s=d(s,/^url\((['"])?(.+)\1\)$/,2),s&&d(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=lt("div","leaflet-default-icon-path",document.body),d=ma(s,"background-image")||ma(s,"backgroundImage");if(document.body.removeChild(s),d=this._stripUrl(d),d)return d;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Zl=bn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Rn(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Vt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var d=this._marker,p=d._map,_=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,Z=ga(d._icon),ue=p.getPixelBounds(),_e=p.getPixelOrigin(),Ae=P(ue.min._subtract(_e).add(A),ue.max._subtract(_e).subtract(A));if(!Ae.contains(Z)){var je=se((Math.max(Ae.max.x,Z.x)-Ae.max.x)/(ue.max.x-Ae.max.x)-(Math.min(Ae.min.x,Z.x)-Ae.min.x)/(ue.min.x-Ae.min.x),(Math.max(Ae.max.y,Z.y)-Ae.max.y)/(ue.max.y-Ae.max.y)-(Math.min(Ae.min.y,Z.y)-Ae.min.y)/(ue.min.y-Ae.min.y)).multiplyBy(_);p.panBy(je,{animate:!1}),this._draggable._newPos._add(je),this._draggable._startPos._add(je),or(d._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=he(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(ce(this._panRequest),this._panRequest=he(this._adjustPan.bind(this,s)))},_onDrag:function(s){var d=this._marker,p=d._shadow,_=ga(d._icon),A=d._map.layerPointToLatLng(_);p&&or(p,_),d._latlng=A,s.latlng=A,s.oldLatLng=this._oldLatLng,d.fire("move",s).fire("drag",s)},_onDragEnd:function(s){ce(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),ya=Mn.extend({options:{icon:new Ui,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,d){k(this,d),this._latlng=te(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var d=this._latlng;return this._latlng=te(s),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=s.icon.createIcon(this._icon),_=!1;p!==this._icon&&(this._icon&&this._removeIcon(),_=!0,s.title&&(p.title=s.title),p.tagName==="IMG"&&(p.alt=s.alt||"")),yt(p,d),s.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&pt(p,"focus",this._panOnFocus,this);var A=s.icon.createShadow(this._shadow),Z=!1;A!==this._shadow&&(this._removeShadow(),Z=!0),A&&(yt(A,d),A.alt=""),this._shadow=A,s.opacity<1&&this._updateOpacity(),_&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&Z&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&zt(this._icon,"focus",this._panOnFocus,this),Kt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Kt(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&or(this._icon,s),this._shadow&&or(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(yt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Zl)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Zl(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&Zr(this._icon,s),this._shadow&&Zr(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var d=this.options.icon.options,p=d.iconSize?se(d.iconSize):se(0,0),_=d.iconAnchor?se(d.iconAnchor):se(0,0);s.panInside(this._latlng,{paddingTopLeft:_,paddingBottomRight:p.subtract(_)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Cf(s,d){return new ya(s,d)}var za=Mn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return k(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Oo=za.extend({options:{fill:!0,radius:10},initialize:function(s,d){k(this,d),this._latlng=te(s),this._radius=this.options.radius},setLatLng:function(s){var d=this._latlng;return this._latlng=te(s),this.redraw(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var d=s&&s.radius||this._radius;return za.prototype.setStyle.call(this,s),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,d=this._radiusY||s,p=this._clickTolerance(),_=[s+p,d+p];this._pxBounds=new D(this._point.subtract(_),this._point.add(_))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function wu(s,d){return new Oo(s,d)}var jo=Oo.extend({initialize:function(s,d,p){if(typeof d=="number"&&(d=a({},p,{radius:d})),k(this,d),this._latlng=te(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new I(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:za.prototype.setStyle,_project:function(){var s=this._latlng.lng,d=this._latlng.lat,p=this._map,_=p.options.crs;if(_.distance===pe.distance){var A=Math.PI/180,Z=this._mRadius/pe.R/A,ue=p.project([d+Z,s]),_e=p.project([d-Z,s]),Ae=ue.add(_e).divideBy(2),je=p.unproject(Ae).lat,Ze=Math.acos((Math.cos(Z*A)-Math.sin(d*A)*Math.sin(je*A))/(Math.cos(d*A)*Math.cos(je*A)))/A;(isNaN(Ze)||Ze===0)&&(Ze=Z/Math.cos(Math.PI/180*d)),this._point=Ae.subtract(p.getPixelOrigin()),this._radius=isNaN(Ze)?0:Ae.x-p.project([je,s-Ze]).x,this._radiusY=Ae.y-ue.y}else{var ut=_.unproject(_.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(ut).x}this._updateBounds()}});function Ls(s,d,p){return new jo(s,d,p)}var un=za.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,d){k(this,d),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var d=1/0,p=null,_=ci,A,Z,ue=0,_e=this._parts.length;ue<_e;ue++)for(var Ae=this._parts[ue],je=1,Ze=Ae.length;je<Ze;je++){A=Ae[je-1],Z=Ae[je];var ut=_(s,A,Z,!0);ut<d&&(d=ut,p=_(s,A,Z))}return p&&(p.distance=Math.sqrt(d)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,d){return d=d||this._defaultShape(),s=te(s),d.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new I,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return kn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var d=[],p=kn(s),_=0,A=s.length;_<A;_++)p?(d[_]=te(s[_]),this._bounds.extend(d[_])):d[_]=this._convertLatLngs(s[_]);return d},_project:function(){var s=new D;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),d=new V(s,s);this._rawPxBounds&&(this._pxBounds=new D([this._rawPxBounds.min.subtract(d),this._rawPxBounds.max.add(d)]))},_projectLatlngs:function(s,d,p){var _=s[0]instanceof G,A=s.length,Z,ue;if(_){for(ue=[],Z=0;Z<A;Z++)ue[Z]=this._map.latLngToLayerPoint(s[Z]),p.extend(ue[Z]);d.push(ue)}else for(Z=0;Z<A;Z++)this._projectLatlngs(s[Z],d,p)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var d=this._parts,p,_,A,Z,ue,_e,Ae;for(p=0,A=0,Z=this._rings.length;p<Z;p++)for(Ae=this._rings[p],_=0,ue=Ae.length;_<ue-1;_++)_e=mu(Ae[_],Ae[_+1],s,_,!0),_e&&(d[A]=d[A]||[],d[A].push(_e[0]),(_e[1]!==Ae[_+1]||_===ue-2)&&(d[A].push(_e[1]),A++))}},_simplifyPoints:function(){for(var s=this._parts,d=this.options.smoothFactor,p=0,_=s.length;p<_;p++)s[p]=Do(s[p],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,d){var p,_,A,Z,ue,_e,Ae=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(p=0,Z=this._parts.length;p<Z;p++)for(_e=this._parts[p],_=0,ue=_e.length,A=ue-1;_<ue;A=_++)if(!(!d&&_===0)&&hu(s,_e[A],_e[_])<=Ae)return!0;return!1}});function Af(s,d){return new un(s,d)}un._flat=pu;var _a=un.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return fu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var d=un.prototype._convertLatLngs.call(this,s),p=d.length;return p>=2&&d[0]instanceof G&&d[0].equals(d[p-1])&&d.pop(),d},_setLatLngs:function(s){un.prototype._setLatLngs.call(this,s),kn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return kn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,d=this.options.weight,p=new V(d,d);if(s=new D(s.min.subtract(p),s.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var _=0,A=this._rings.length,Z;_<A;_++)Z=Ul(this._rings[_],s,!0),Z.length&&this._parts.push(Z)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var d=!1,p,_,A,Z,ue,_e,Ae,je;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(Z=0,Ae=this._parts.length;Z<Ae;Z++)for(p=this._parts[Z],ue=0,je=p.length,_e=je-1;ue<je;_e=ue++)_=p[ue],A=p[_e],_.y>s.y!=A.y>s.y&&s.x<(A.x-_.x)*(s.y-_.y)/(A.y-_.y)+_.x&&(d=!d);return d||un.prototype._containsPoint.call(this,s,!0)}});function Pf(s,d){return new _a(s,d)}var qn=xa.extend({initialize:function(s,d){k(this,d),this._layers={},s&&this.addData(s)},addData:function(s){var d=N(s)?s:s.features,p,_,A;if(d){for(p=0,_=d.length;p<_;p++)A=d[p],(A.geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var Z=this.options;if(Z.filter&&!Z.filter(s))return this;var ue=$i(s,Z);return ue?(ue.feature=Bo(s),ue.defaultOptions=ue.options,this.resetStyle(ue),Z.onEachFeature&&Z.onEachFeature(s,ue),this.addLayer(ue)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=a({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(d){this._setLayerStyle(d,s)},this)},_setLayerStyle:function(s,d){s.setStyle&&(typeof d=="function"&&(d=d(s.feature)),s.setStyle(d))}});function $i(s,d){var p=s.type==="Feature"?s.geometry:s,_=p?p.coordinates:null,A=[],Z=d&&d.pointToLayer,ue=d&&d.coordsToLatLng||Lo,_e,Ae,je,Ze;if(!_&&!p)return null;switch(p.type){case"Point":return _e=ue(_),Fo(Z,s,_e,d);case"MultiPoint":for(je=0,Ze=_.length;je<Ze;je++)_e=ue(_[je]),A.push(Fo(Z,s,_e,d));return new xa(A);case"LineString":case"MultiLineString":return Ae=Rs(_,p.type==="LineString"?0:1,ue),new un(Ae,d);case"Polygon":case"MultiPolygon":return Ae=Rs(_,p.type==="Polygon"?1:2,ue),new _a(Ae,d);case"GeometryCollection":for(je=0,Ze=p.geometries.length;je<Ze;je++){var ut=$i({geometry:p.geometries[je],type:"Feature",properties:s.properties},d);ut&&A.push(ut)}return new xa(A);case"FeatureCollection":for(je=0,Ze=p.features.length;je<Ze;je++){var wt=$i(p.features[je],d);wt&&A.push(wt)}return new xa(A);default:throw new Error("Invalid GeoJSON object.")}}function Fo(s,d,p,_){return s?s(d,p):new ya(p,_&&_.markersInheritOptions&&_)}function Lo(s){return new G(s[1],s[0],s[2])}function Rs(s,d,p){for(var _=[],A=0,Z=s.length,ue;A<Z;A++)ue=d?Rs(s[A],d-1,p):(p||Lo)(s[A]),_.push(ue);return _}function Ro(s,d){return s=te(s),s.alt!==void 0?[b(s.lng,d),b(s.lat,d),b(s.alt,d)]:[b(s.lng,d),b(s.lat,d)]}function Mo(s,d,p,_){for(var A=[],Z=0,ue=s.length;Z<ue;Z++)A.push(d?Mo(s[Z],kn(s[Z])?0:d-1,p,_):Ro(s[Z],_));return!d&&p&&A.length>0&&A.push(A[0].slice()),A}function Wi(s,d){return s.feature?a({},s.feature,{geometry:d}):Bo(d)}function Bo(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Kl={toGeoJSON:function(s){return Wi(this,{type:"Point",coordinates:Ro(this.getLatLng(),s)})}};ya.include(Kl),jo.include(Kl),Oo.include(Kl),un.include({toGeoJSON:function(s){var d=!kn(this._latlngs),p=Mo(this._latlngs,d?1:0,!1,s);return Wi(this,{type:(d?"Multi":"")+"LineString",coordinates:p})}}),_a.include({toGeoJSON:function(s){var d=!kn(this._latlngs),p=d&&!kn(this._latlngs[0]),_=Mo(this._latlngs,p?2:d?1:0,!0,s);return d||(_=[_]),Wi(this,{type:(p?"Multi":"")+"Polygon",coordinates:_})}}),Ba.include({toMultiPoint:function(s){var d=[];return this.eachLayer(function(p){d.push(p.toGeoJSON(s).geometry.coordinates)}),Wi(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(s){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(s);var p=d==="GeometryCollection",_=[];return this.eachLayer(function(A){if(A.toGeoJSON){var Z=A.toGeoJSON(s);if(p)_.push(Z.geometry);else{var ue=Bo(Z);ue.type==="FeatureCollection"?_.push.apply(_,ue.features):_.push(ue)}}}),p?Wi(this,{geometries:_,type:"GeometryCollection"}):{type:"FeatureCollection",features:_}}});function bu(s,d){return new qn(s,d)}var Bn=bu,Ua=Mn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,d,p){this._url=s,this._bounds=B(d),k(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Kt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Oi(this._image),this},bringToBack:function(){return this._map&&pa(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=B(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",d=this._image=s?this._url:lt("img");if(yt(d,"leaflet-image-layer"),this._zoomAnimated&&yt(d,"leaflet-zoom-animated"),this.options.className&&yt(d,this.options.className),d.onselectstart=y,d.onmousemove=y,d.onload=c(this.fire,this,"load"),d.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=d.src;return}d.src=this._url,d.alt=this.options.alt},_animateZoom:function(s){var d=this._map.getZoomScale(s.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;jn(this._image,p,d)},_reset:function(){var s=this._image,d=new D(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=d.getSize();or(s,d.min),s.style.width=p.x+"px",s.style.height=p.y+"px"},_updateOpacity:function(){Zr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),ku=function(s,d,p){return new Ua(s,d,p)},ql=Ua.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",d=this._image=s?this._url:lt("video");if(yt(d,"leaflet-image-layer"),this._zoomAnimated&&yt(d,"leaflet-zoom-animated"),this.options.className&&yt(d,this.options.className),d.onselectstart=y,d.onmousemove=y,d.onloadeddata=c(this.fire,this,"load"),s){for(var p=d.getElementsByTagName("source"),_=[],A=0;A<p.length;A++)_.push(p[A].src);this._url=p.length>0?_:[d.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(d.style,"objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop,d.muted=!!this.options.muted,d.playsInline=!!this.options.playsInline;for(var Z=0;Z<this._url.length;Z++){var ue=lt("source");ue.src=this._url[Z],d.appendChild(ue)}}});function Su(s,d,p){return new ql(s,d,p)}var Yl=Ua.extend({_initImage:function(){var s=this._image=this._url;yt(s,"leaflet-image-layer"),this._zoomAnimated&&yt(s,"leaflet-zoom-animated"),this.options.className&&yt(s,this.options.className),s.onselectstart=y,s.onmousemove=y}});function Xl(s,d,p){return new Yl(s,d,p)}var Yn=Mn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,d){s&&(s instanceof G||N(s))?(this._latlng=te(s),k(this,d)):(k(this,s),this._source=d),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&Zr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&Zr(this._container,1),this.bringToFront(),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(Zr(this._container,0),this._removeTimeout=setTimeout(c(Kt,void 0,this._container),200)):Kt(this._container),this.options.interactive&&(Vt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=te(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Oi(this._container),this},bringToBack:function(){return this._map&&pa(this._container),this},_prepareOpen:function(s){var d=this._source;if(!d._map)return!1;if(d instanceof xa){d=null;var p=this._source._layers;for(var _ in p)if(p[_]._map){d=p[_];break}if(!d)return!1;this._source=d}if(!s)if(d.getCenter)s=d.getCenter();else if(d.getLatLng)s=d.getLatLng();else if(d.getBounds)s=d.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")s.innerHTML=d;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),d=se(this.options.offset),p=this._getAnchor();this._zoomAnimated?or(this._container,s.add(p)):d=d.add(s).add(p);var _=this._containerBottom=-d.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=_+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}});Et.include({_initOverlay:function(s,d,p,_){var A=d;return A instanceof s||(A=new s(_).setContent(d)),p&&A.setLatLng(p),A}}),Mn.include({_initOverlay:function(s,d,p,_){var A=p;return A instanceof s?(k(A,_),A._source=this):(A=d&&!_?d:new s(_,this),A.setContent(p)),A}});var zo=Yn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,Yn.prototype.openOn.call(this,s)},onAdd:function(s){Yn.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof za||this._source.on("preclick",Kn))},onRemove:function(s){Yn.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof za||this._source.off("preclick",Kn))},getEvents:function(){var s=Yn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",d=this._container=lt("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=lt("div",s+"-content-wrapper",d);if(this._contentNode=lt("div",s+"-content",p),Is(d),Co(this._contentNode),pt(d,"contextmenu",Kn),this._tipContainer=lt("div",s+"-tip-container",d),this._tip=lt("div",s+"-tip",this._tipContainer),this.options.closeButton){var _=this._closeButton=lt("a",s+"-close-button",d);_.setAttribute("role","button"),_.setAttribute("aria-label","Close popup"),_.href="#close",_.innerHTML='<span aria-hidden="true">&#215;</span>',pt(_,"click",function(A){rr(A),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,d=s.style;d.width="",d.whiteSpace="nowrap";var p=s.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),d.width=p+1+"px",d.whiteSpace="",d.height="";var _=s.offsetHeight,A=this.options.maxHeight,Z="leaflet-popup-scrolled";A&&_>A?(d.height=A+"px",yt(s,Z)):Vt(s,Z),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),p=this._getAnchor();or(this._container,d.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,d=parseInt(ma(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+d,_=this._containerWidth,A=new V(this._containerLeft,-p-this._containerBottom);A._add(ga(this._container));var Z=s.layerPointToContainerPoint(A),ue=se(this.options.autoPanPadding),_e=se(this.options.autoPanPaddingTopLeft||ue),Ae=se(this.options.autoPanPaddingBottomRight||ue),je=s.getSize(),Ze=0,ut=0;Z.x+_+Ae.x>je.x&&(Ze=Z.x+_-je.x+Ae.x),Z.x-Ze-_e.x<0&&(Ze=Z.x-_e.x),Z.y+p+Ae.y>je.y&&(ut=Z.y+p-je.y+Ae.y),Z.y-ut-_e.y<0&&(ut=Z.y-_e.y),(Ze||ut)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([Ze,ut]))}},_getAnchor:function(){return se(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Vi=function(s,d){return new zo(s,d)};Et.mergeOptions({closePopupOnClick:!0}),Et.include({openPopup:function(s,d,p){return this._initOverlay(zo,s,d,p).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),Mn.include({bindPopup:function(s,d){return this._popup=this._initOverlay(zo,this._popup,s,d),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof xa||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){Ln(s);var d=s.layer||s.target;if(this._popup._source===d&&!(d instanceof za)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=d,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Hi=Yn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){Yn.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){Yn.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=Yn.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",d=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=lt("div",d),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+m(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var d,p,_=this._map,A=this._container,Z=_.latLngToContainerPoint(_.getCenter()),ue=_.layerPointToContainerPoint(s),_e=this.options.direction,Ae=A.offsetWidth,je=A.offsetHeight,Ze=se(this.options.offset),ut=this._getAnchor();_e==="top"?(d=Ae/2,p=je):_e==="bottom"?(d=Ae/2,p=0):_e==="center"?(d=Ae/2,p=je/2):_e==="right"?(d=0,p=je/2):_e==="left"?(d=Ae,p=je/2):ue.x<Z.x?(_e="right",d=0,p=je/2):(_e="left",d=Ae+(Ze.x+ut.x)*2,p=je/2),s=s.subtract(se(d,p,!0)).add(Ze).add(ut),Vt(A,"leaflet-tooltip-right"),Vt(A,"leaflet-tooltip-left"),Vt(A,"leaflet-tooltip-top"),Vt(A,"leaflet-tooltip-bottom"),yt(A,"leaflet-tooltip-"+_e),or(A,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&Zr(this._container,s)},_animateZoom:function(s){var d=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(d)},_getAnchor:function(){return se(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ms=function(s,d){return new Hi(s,d)};Et.include({openTooltip:function(s,d,p){return this._initOverlay(Hi,s,d,p).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),Mn.include({bindTooltip:function(s,d){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Hi,this._tooltip,s,d),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var d=s?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[d](p),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof xa||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var d=typeof s.getElement=="function"&&s.getElement();d&&(pt(d,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),pt(d,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var d=typeof s.getElement=="function"&&s.getElement();d&&d.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var d=this;this._map.once("moveend",function(){d._openOnceFlag=!1,d._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var d=s.latlng,p,_;this._tooltip.options.sticky&&s.originalEvent&&(p=this._map.mouseEventToContainerPoint(s.originalEvent),_=this._map.containerPointToLayerPoint(p),d=this._map.layerPointToLatLng(_)),this._tooltip.setLatLng(d)}});var Uo=ui.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var d=s&&s.tagName==="DIV"?s:document.createElement("div"),p=this.options;if(p.html instanceof Element?(wo(d),d.appendChild(p.html)):d.innerHTML=p.html!==!1?p.html:"",p.bgPos){var _=se(p.bgPos);d.style.backgroundPosition=-_.x+"px "+-_.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});function Tu(s){return new Uo(s)}ui.Default=Ui;var $a=Mn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Oe.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){k(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),Kt(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Oi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(pa(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=g(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof V?s:new V(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var d=this.getPane().children,p=-s(-1/0,1/0),_=0,A=d.length,Z;_<A;_++)Z=d[_].style.zIndex,d[_]!==this._container&&Z&&(p=s(p,+Z));isFinite(p)&&(this.options.zIndex=p+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Oe.ielt9){Zr(this._container,this.options.opacity);var s=+new Date,d=!1,p=!1;for(var _ in this._tiles){var A=this._tiles[_];if(!(!A.current||!A.loaded)){var Z=Math.min(1,(s-A.loaded)/200);Zr(A.el,Z),Z<1?d=!0:(A.active?p=!0:this._onOpaqueTile(A),A.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),d&&(ce(this._fadeFrame),this._fadeFrame=he(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=lt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,d=this.options.maxZoom;if(s!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===s?(this._levels[p].el.style.zIndex=d-Math.abs(s-p),this._onUpdateLevel(p)):(Kt(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var _=this._levels[s],A=this._map;return _||(_=this._levels[s]={},_.el=lt("div","leaflet-tile-container leaflet-zoom-animated",this._container),_.el.style.zIndex=d,_.origin=A.project(A.unproject(A.getPixelOrigin()),s).round(),_.zoom=s,this._setZoomTransform(_,A.getCenter(),A.getZoom()),y(_.el.offsetWidth),this._onCreateLevel(_)),this._level=_,_}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var s,d,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)d=this._tiles[s],d.retain=d.current;for(s in this._tiles)if(d=this._tiles[s],d.current&&!d.active){var _=d.coords;this._retainParent(_.x,_.y,_.z,_.z-5)||this._retainChildren(_.x,_.y,_.z,_.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var d in this._tiles)this._tiles[d].coords.z===s&&this._removeTile(d)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)Kt(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,d,p,_){var A=Math.floor(s/2),Z=Math.floor(d/2),ue=p-1,_e=new V(+A,+Z);_e.z=+ue;var Ae=this._tileCoordsToKey(_e),je=this._tiles[Ae];return je&&je.active?(je.retain=!0,!0):(je&&je.loaded&&(je.retain=!0),ue>_?this._retainParent(A,Z,ue,_):!1)},_retainChildren:function(s,d,p,_){for(var A=2*s;A<2*s+2;A++)for(var Z=2*d;Z<2*d+2;Z++){var ue=new V(A,Z);ue.z=p+1;var _e=this._tileCoordsToKey(ue),Ae=this._tiles[_e];if(Ae&&Ae.active){Ae.retain=!0;continue}else Ae&&Ae.loaded&&(Ae.retain=!0);p+1<_&&this._retainChildren(A,Z,p+1,_)}},_resetView:function(s){var d=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var d=this.options;return d.minNativeZoom!==void 0&&s<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<s?d.maxNativeZoom:s},_setView:function(s,d,p,_){var A=Math.round(d);this.options.maxZoom!==void 0&&A>this.options.maxZoom||this.options.minZoom!==void 0&&A<this.options.minZoom?A=void 0:A=this._clampZoom(A);var Z=this.options.updateWhenZooming&&A!==this._tileZoom;(!_||Z)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),A!==void 0&&this._update(s),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(s,d)},_setZoomTransforms:function(s,d){for(var p in this._levels)this._setZoomTransform(this._levels[p],s,d)},_setZoomTransform:function(s,d,p){var _=this._map.getZoomScale(p,s.zoom),A=s.origin.multiplyBy(_).subtract(this._map._getNewPixelOrigin(d,p)).round();Oe.any3d?jn(s.el,A,_):or(s.el,A)},_resetGrid:function(){var s=this._map,d=s.options.crs,p=this._tileSize=this.getTileSize(),_=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,d.wrapLng[0]],_).x/p.x),Math.ceil(s.project([0,d.wrapLng[1]],_).x/p.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([d.wrapLat[0],0],_).y/p.x),Math.ceil(s.project([d.wrapLat[1],0],_).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var d=this._map,p=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),_=d.getZoomScale(p,this._tileZoom),A=d.project(s,this._tileZoom).floor(),Z=d.getSize().divideBy(_*2);return new D(A.subtract(Z),A.add(Z))},_update:function(s){var d=this._map;if(d){var p=this._clampZoom(d.getZoom());if(s===void 0&&(s=d.getCenter()),this._tileZoom!==void 0){var _=this._getTiledPixelBounds(s),A=this._pxBoundsToTileRange(_),Z=A.getCenter(),ue=[],_e=this.options.keepBuffer,Ae=new D(A.getBottomLeft().subtract([_e,-_e]),A.getTopRight().add([_e,-_e]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var je in this._tiles){var Ze=this._tiles[je].coords;(Ze.z!==this._tileZoom||!Ae.contains(new V(Ze.x,Ze.y)))&&(this._tiles[je].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(s,p);return}for(var ut=A.min.y;ut<=A.max.y;ut++)for(var wt=A.min.x;wt<=A.max.x;wt++){var Cr=new V(wt,ut);if(Cr.z=this._tileZoom,!!this._isValidTile(Cr)){var gr=this._tiles[this._tileCoordsToKey(Cr)];gr?gr.current=!0:ue.push(Cr)}}if(ue.sort(function(qr,Yi){return qr.distanceTo(Z)-Yi.distanceTo(Z)}),ue.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var dn=document.createDocumentFragment();for(wt=0;wt<ue.length;wt++)this._addTile(ue[wt],dn);this._level.el.appendChild(dn)}}}},_isValidTile:function(s){var d=this._map.options.crs;if(!d.infinite){var p=this._globalTileRange;if(!d.wrapLng&&(s.x<p.min.x||s.x>p.max.x)||!d.wrapLat&&(s.y<p.min.y||s.y>p.max.y))return!1}if(!this.options.bounds)return!0;var _=this._tileCoordsToBounds(s);return B(this.options.bounds).overlaps(_)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var d=this._map,p=this.getTileSize(),_=s.scaleBy(p),A=_.add(p),Z=d.unproject(_,s.z),ue=d.unproject(A,s.z);return[Z,ue]},_tileCoordsToBounds:function(s){var d=this._tileCoordsToNwSe(s),p=new I(d[0],d[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var d=s.split(":"),p=new V(+d[0],+d[1]);return p.z=+d[2],p},_removeTile:function(s){var d=this._tiles[s];d&&(Kt(d.el),delete this._tiles[s],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){yt(s,"leaflet-tile");var d=this.getTileSize();s.style.width=d.x+"px",s.style.height=d.y+"px",s.onselectstart=y,s.onmousemove=y,Oe.ielt9&&this.options.opacity<1&&Zr(s,this.options.opacity)},_addTile:function(s,d){var p=this._getTilePos(s),_=this._tileCoordsToKey(s),A=this.createTile(this._wrapCoords(s),c(this._tileReady,this,s));this._initTile(A),this.createTile.length<2&&he(c(this._tileReady,this,s,null,A)),or(A,p),this._tiles[_]={el:A,coords:s,current:!0},d.appendChild(A),this.fire("tileloadstart",{tile:A,coords:s})},_tileReady:function(s,d,p){d&&this.fire("tileerror",{error:d,tile:p,coords:s});var _=this._tileCoordsToKey(s);p=this._tiles[_],p&&(p.loaded=+new Date,this._map._fadeAnimated?(Zr(p.el,0),ce(this._fadeFrame),this._fadeFrame=he(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),d||(yt(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Oe.ielt9||!this._map._fadeAnimated?he(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var d=new V(this._wrapX?x(s.x,this._wrapX):s.x,this._wrapY?x(s.y,this._wrapY):s.y);return d.z=s.z,d},_pxBoundsToTileRange:function(s){var d=this.getTileSize();return new D(s.min.unscaleBy(d).floor(),s.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function Gi(s){return new $a(s)}var Wa=$a.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,d){this._url=s,d=k(this,d),d.detectRetina&&Oe.retina&&d.maxZoom>0?(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom=Math.min(d.maxZoom,d.minZoom+1)):(d.zoomOffset++,d.maxZoom=Math.max(d.minZoom,d.maxZoom-1)),d.minZoom=Math.max(0,d.minZoom)):d.zoomReverse?d.minZoom=Math.min(d.maxZoom,d.minZoom):d.maxZoom=Math.max(d.minZoom,d.maxZoom),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,d){return this._url===s&&d===void 0&&(d=!0),this._url=s,d||this.redraw(),this},createTile:function(s,d){var p=document.createElement("img");return pt(p,"load",c(this._tileOnLoad,this,d,p)),pt(p,"error",c(this._tileOnError,this,d,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(s),p},getTileUrl:function(s){var d={r:Oe.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-s.y;this.options.tms&&(d.y=p),d["-y"]=p}return j(this._url,a(d,this.options))},_tileOnLoad:function(s,d){Oe.ielt9?setTimeout(c(s,this,null,d),0):s(null,d)},_tileOnError:function(s,d,p){var _=this.options.errorTileUrl;_&&d.getAttribute("src")!==_&&(d.src=_),s(p,d)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,d=this.options.maxZoom,p=this.options.zoomReverse,_=this.options.zoomOffset;return p&&(s=d-s),s+_},_getSubdomain:function(s){var d=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var s,d;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(d=this._tiles[s].el,d.onload=y,d.onerror=y,!d.complete)){d.src=K;var p=this._tiles[s].coords;Kt(d),delete this._tiles[s],this.fire("tileabort",{tile:d,coords:p})}},_removeTile:function(s){var d=this._tiles[s];if(d)return d.el.setAttribute("src",K),$a.prototype._removeTile.call(this,s)},_tileReady:function(s,d,p){if(!(!this._map||p&&p.getAttribute("src")===K))return $a.prototype._tileReady.call(this,s,d,p)}});function Jl(s,d){return new Wa(s,d)}var Bs=Wa.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,d){this._url=s;var p=a({},this.defaultWmsParams);for(var _ in d)_ in this.options||(p[_]=d[_]);d=k(this,d);var A=d.detectRetina&&Oe.retina?2:1,Z=this.getTileSize();p.width=Z.x*A,p.height=Z.y*A,this.wmsParams=p},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,Wa.prototype.onAdd.call(this,s)},getTileUrl:function(s){var d=this._tileCoordsToNwSe(s),p=this._crs,_=P(p.project(d[0]),p.project(d[1])),A=_.min,Z=_.max,ue=(this._wmsVersion>=1.3&&this._crs===xu?[A.y,A.x,Z.y,Z.x]:[A.x,A.y,Z.x,Z.y]).join(","),_e=Wa.prototype.getTileUrl.call(this,s);return _e+C(this.wmsParams,_e,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ue},setParams:function(s,d){return a(this.wmsParams,s),d||this.redraw(),this}});function Eu(s,d){return new Bs(s,d)}Wa.WMS=Bs,Jl.wms=Eu;var Xn=Mn.extend({options:{padding:.1},initialize:function(s){k(this,s),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,d){var p=this._map.getZoomScale(d,this._zoom),_=this._map.getSize().multiplyBy(.5+this.options.padding),A=this._map.project(this._center,d),Z=_.multiplyBy(-p).add(A).subtract(this._map._getNewPixelOrigin(s,d));Oe.any3d?jn(this._container,Z,p):or(this._container,Z)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,d=this._map.getSize(),p=this._map.containerPointToLayerPoint(d.multiplyBy(-s)).round();this._bounds=new D(p,p.add(d.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ql=Xn.extend({options:{tolerance:0},getEvents:function(){var s=Xn.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Xn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");pt(s,"mousemove",this._onMouseMove,this),pt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),pt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){ce(this._redrawRequest),delete this._ctx,Kt(this._container),zt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var d in this._layers)s=this._layers[d],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Xn.prototype._update.call(this);var s=this._bounds,d=this._container,p=s.getSize(),_=Oe.retina?2:1;or(d,s.min),d.width=_*p.x,d.height=_*p.y,d.style.width=p.x+"px",d.style.height=p.y+"px",Oe.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){Xn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[m(s)]=s;var d=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var d=s._order,p=d.next,_=d.prev;p?p.prev=_:this._drawLast=_,_?_.next=p:this._drawFirst=p,delete s._order,delete this._layers[m(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var d=s.options.dashArray.split(/[, ]+/),p=[],_,A;for(A=0;A<d.length;A++){if(_=Number(d[A]),isNaN(_))return;p.push(_)}s.options._dashArray=p}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||he(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var d=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new D,this._redrawBounds.extend(s._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(s._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var d=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,d.x,d.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,d=this._redrawBounds;if(this._ctx.save(),d){var p=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var _=this._drawFirst;_;_=_.next)s=_.layer,(!d||s._pxBounds&&s._pxBounds.intersects(d))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,d){if(this._drawing){var p,_,A,Z,ue=s._parts,_e=ue.length,Ae=this._ctx;if(_e){for(Ae.beginPath(),p=0;p<_e;p++){for(_=0,A=ue[p].length;_<A;_++)Z=ue[p][_],Ae[_?"lineTo":"moveTo"](Z.x,Z.y);d&&Ae.closePath()}this._fillStroke(Ae,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var d=s._point,p=this._ctx,_=Math.max(Math.round(s._radius),1),A=(Math.max(Math.round(s._radiusY),1)||_)/_;A!==1&&(p.save(),p.scale(1,A)),p.beginPath(),p.arc(d.x,d.y/A,_,0,Math.PI*2,!1),A!==1&&p.restore(),this._fillStroke(p,s)}},_fillStroke:function(s,d){var p=d.options;p.fill&&(s.globalAlpha=p.fillOpacity,s.fillStyle=p.fillColor||p.color,s.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(s.setLineDash&&s.setLineDash(d.options&&d.options._dashArray||[]),s.globalAlpha=p.opacity,s.lineWidth=p.weight,s.strokeStyle=p.color,s.lineCap=p.lineCap,s.lineJoin=p.lineJoin,s.stroke())},_onClick:function(s){for(var d=this._map.mouseEventToLayerPoint(s),p,_,A=this._drawFirst;A;A=A.next)p=A.layer,p.options.interactive&&p._containsPoint(d)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(p))&&(_=p);this._fireEvent(_?[_]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var d=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,d)}},_handleMouseOut:function(s){var d=this._hoveredLayer;d&&(Vt(this._container,"leaflet-interactive"),this._fireEvent([d],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,d){if(!this._mouseHoverThrottled){for(var p,_,A=this._drawFirst;A;A=A.next)p=A.layer,p.options.interactive&&p._containsPoint(d)&&(_=p);_!==this._hoveredLayer&&(this._handleMouseOut(s),_&&(yt(this._container,"leaflet-interactive"),this._fireEvent([_],s,"mouseover"),this._hoveredLayer=_)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,d,p){this._map._fireDOMEvent(d,p||d.type,s)},_bringToFront:function(s){var d=s._order;if(d){var p=d.next,_=d.prev;if(p)p.prev=_;else return;_?_.next=p:p&&(this._drawFirst=p),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(s)}},_bringToBack:function(s){var d=s._order;if(d){var p=d.next,_=d.prev;if(_)_.next=p;else return;p?p.prev=_:_&&(this._drawLast=_),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(s)}}});function ec(s){return Oe.canvas?new Ql(s):null}var Zi=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Cu={_initContainer:function(){this._container=lt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Xn.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var d=s._container=Zi("shape");yt(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",s._path=Zi("path"),d.appendChild(s._path),this._updateStyle(s),this._layers[m(s)]=s},_addPath:function(s){var d=s._container;this._container.appendChild(d),s.options.interactive&&s.addInteractiveTarget(d)},_removePath:function(s){var d=s._container;Kt(d),s.removeInteractiveTarget(d),delete this._layers[m(s)]},_updateStyle:function(s){var d=s._stroke,p=s._fill,_=s.options,A=s._container;A.stroked=!!_.stroke,A.filled=!!_.fill,_.stroke?(d||(d=s._stroke=Zi("stroke")),A.appendChild(d),d.weight=_.weight+"px",d.color=_.color,d.opacity=_.opacity,_.dashArray?d.dashStyle=N(_.dashArray)?_.dashArray.join(" "):_.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=_.lineCap.replace("butt","flat"),d.joinstyle=_.lineJoin):d&&(A.removeChild(d),s._stroke=null),_.fill?(p||(p=s._fill=Zi("fill")),A.appendChild(p),p.color=_.fillColor||_.color,p.opacity=_.fillOpacity):p&&(A.removeChild(p),s._fill=null)},_updateCircle:function(s){var d=s._point.round(),p=Math.round(s._radius),_=Math.round(s._radiusY||p);this._setPath(s,s._empty()?"M0 0":"AL "+d.x+","+d.y+" "+p+","+_+" 0,"+65535*360)},_setPath:function(s,d){s._path.v=d},_bringToFront:function(s){Oi(s._container)},_bringToBack:function(s){pa(s._container)}},zn=Oe.vml?Zi:mt,di=Xn.extend({_initContainer:function(){this._container=zn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=zn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Kt(this._container),zt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Xn.prototype._update.call(this);var s=this._bounds,d=s.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(d))&&(this._svgSize=d,p.setAttribute("width",d.x),p.setAttribute("height",d.y)),or(p,s.min),p.setAttribute("viewBox",[s.min.x,s.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(s){var d=s._path=zn("path");s.options.className&&yt(d,s.options.className),s.options.interactive&&yt(d,"leaflet-interactive"),this._updateStyle(s),this._layers[m(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){Kt(s._path),s.removeInteractiveTarget(s._path),delete this._layers[m(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var d=s._path,p=s.options;d&&(p.stroke?(d.setAttribute("stroke",p.color),d.setAttribute("stroke-opacity",p.opacity),d.setAttribute("stroke-width",p.weight),d.setAttribute("stroke-linecap",p.lineCap),d.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?d.setAttribute("stroke-dasharray",p.dashArray):d.removeAttribute("stroke-dasharray"),p.dashOffset?d.setAttribute("stroke-dashoffset",p.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),p.fill?(d.setAttribute("fill",p.fillColor||p.color),d.setAttribute("fill-opacity",p.fillOpacity),d.setAttribute("fill-rule",p.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(s,d){this._setPath(s,st(s._parts,d))},_updateCircle:function(s){var d=s._point,p=Math.max(Math.round(s._radius),1),_=Math.max(Math.round(s._radiusY),1)||p,A="a"+p+","+_+" 0 1,0 ",Z=s._empty()?"M0 0":"M"+(d.x-p)+","+d.y+A+p*2+",0 "+A+-p*2+",0 ";this._setPath(s,Z)},_setPath:function(s,d){s._path.setAttribute("d",d)},_bringToFront:function(s){Oi(s._path)},_bringToBack:function(s){pa(s._path)}});Oe.vml&&di.include(Cu);function $o(s){return Oe.svg||Oe.vml?new di(s):null}Et.include({getRenderer:function(s){var d=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var d=this._paneRenderers[s];return d===void 0&&(d=this._createRenderer({pane:s}),this._paneRenderers[s]=d),d},_createRenderer:function(s){return this.options.preferCanvas&&ec(s)||$o(s)}});var Au=_a.extend({initialize:function(s,d){_a.prototype.initialize.call(this,this._boundsToLatLngs(s),d)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=B(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Nf(s,d){return new Au(s,d)}di.create=zn,di.pointsToPath=st,qn.geometryToLayer=$i,qn.coordsToLatLng=Lo,qn.coordsToLatLngs=Rs,qn.latLngToCoords=Ro,qn.latLngsToCoords=Mo,qn.getFeature=Wi,qn.asFeature=Bo,Et.mergeOptions({boxZoom:!0});var Ki=bn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){pt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){zt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Kt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Pt(),So(),this._startPoint=this._map.mouseEventToContainerPoint(s),pt(document,{contextmenu:Ln,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=lt("div","leaflet-zoom-box",this._container),yt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var d=new D(this._point,this._startPoint),p=d.getSize();or(this._box,d.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(Kt(this._box),Vt(this._container,"leaflet-crosshair")),Li(),To(),zt(document,{contextmenu:Ln,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var d=new I(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Et.addInitHook("addHandler","boxZoom",Ki),Et.mergeOptions({doubleClickZoom:!0});var Pu=bn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var d=this._map,p=d.getZoom(),_=d.options.zoomDelta,A=s.originalEvent.shiftKey?p-_:p+_;d.options.doubleClickZoom==="center"?d.setZoom(A):d.setZoomAround(s.containerPoint,A)}});Et.addInitHook("addHandler","doubleClickZoom",Pu),Et.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var tc=bn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Rn(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}yt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Vt(this._map._container,"leaflet-grab"),Vt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=B(this._map.options.maxBounds);this._offsetLimit=P(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var d=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(d),this._prunePositions(d)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,d){return s-(s-d)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;s.x<d.min.x&&(s.x=this._viscousLimit(s.x,d.min.x)),s.y<d.min.y&&(s.y=this._viscousLimit(s.y,d.min.y)),s.x>d.max.x&&(s.x=this._viscousLimit(s.x,d.max.x)),s.y>d.max.y&&(s.y=this._viscousLimit(s.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,d=Math.round(s/2),p=this._initialWorldOffset,_=this._draggable._newPos.x,A=(_-d+p)%s+d-p,Z=(_+d+p)%s-d-p,ue=Math.abs(A+p)<Math.abs(Z+p)?A:Z;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ue},_onDragEnd:function(s){var d=this._map,p=d.options,_=!p.inertia||s.noInertia||this._times.length<2;if(d.fire("dragend",s),_)d.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),Z=(this._lastTime-this._times[0])/1e3,ue=p.easeLinearity,_e=A.multiplyBy(ue/Z),Ae=_e.distanceTo([0,0]),je=Math.min(p.inertiaMaxSpeed,Ae),Ze=_e.multiplyBy(je/Ae),ut=je/(p.inertiaDeceleration*ue),wt=Ze.multiplyBy(-ut/2).round();!wt.x&&!wt.y?d.fire("moveend"):(wt=d._limitOffset(wt,d.options.maxBounds),he(function(){d.panBy(wt,{duration:ut,easeLinearity:ue,noMoveStart:!0,animate:!0})}))}}});Et.addInitHook("addHandler","dragging",tc),Et.mergeOptions({keyboard:!0,keyboardPanDelta:80});var rc=bn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),pt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),zt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,d=document.documentElement,p=s.scrollTop||d.scrollTop,_=s.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(_,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var d=this._panKeys={},p=this.keyCodes,_,A;for(_=0,A=p.left.length;_<A;_++)d[p.left[_]]=[-1*s,0];for(_=0,A=p.right.length;_<A;_++)d[p.right[_]]=[s,0];for(_=0,A=p.down.length;_<A;_++)d[p.down[_]]=[0,s];for(_=0,A=p.up.length;_<A;_++)d[p.up[_]]=[0,-1*s]},_setZoomDelta:function(s){var d=this._zoomKeys={},p=this.keyCodes,_,A;for(_=0,A=p.zoomIn.length;_<A;_++)d[p.zoomIn[_]]=s;for(_=0,A=p.zoomOut.length;_<A;_++)d[p.zoomOut[_]]=-s},_addHooks:function(){pt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){zt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var d=s.keyCode,p=this._map,_;if(d in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(_=this._panKeys[d],s.shiftKey&&(_=se(_).multiplyBy(3)),p.options.maxBounds&&(_=p._limitOffset(se(_),p.options.maxBounds)),p.options.worldCopyJump){var A=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(_)));p.panTo(A)}else p.panBy(_)}else if(d in this._zoomKeys)p.setZoom(p.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[d]);else if(d===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;Ln(s)}}});Et.addInitHook("addHandler","keyboard",rc),Et.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ut=bn.extend({addHooks:function(){pt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){zt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var d=uu(s),p=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var _=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),_),Ln(s)},_performZoom:function(){var s=this._map,d=s.getZoom(),p=this._map.options.zoomSnap||0;s._stop();var _=this._delta/(this._map.options.wheelPxPerZoomLevel*4),A=4*Math.log(2/(1+Math.exp(-Math.abs(_))))/Math.LN2,Z=p?Math.ceil(A/p)*p:A,ue=s._limitZoom(d+(this._delta>0?Z:-Z))-d;this._delta=0,this._startTime=null,ue&&(s.options.scrollWheelZoom==="center"?s.setZoom(d+ue):s.setZoomAround(this._lastMousePos,d+ue))}});Et.addInitHook("addHandler","scrollWheelZoom",Ut);var nc=600;Et.mergeOptions({tapHold:Oe.touchNative&&Oe.safari&&Oe.mobile,tapTolerance:15});var zs=bn.extend({addHooks:function(){pt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){zt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var d=s.touches[0];this._startPos=this._newPos=new V(d.clientX,d.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(pt(document,"touchend",rr),pt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",d))},this),nc),pt(document,"touchend touchcancel contextmenu",this._cancel,this),pt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){zt(document,"touchend",rr),zt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),zt(document,"touchend touchcancel contextmenu",this._cancel,this),zt(document,"touchmove",this._onMove,this)},_onMove:function(s){var d=s.touches[0];this._newPos=new V(d.clientX,d.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,d){var p=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:d.screenX,screenY:d.screenY,clientX:d.clientX,clientY:d.clientY});p._simulated=!0,d.target.dispatchEvent(p)}});Et.addInitHook("addHandler","tapHold",zs),Et.mergeOptions({touchZoom:Oe.touch,bounceAtZoomLimits:!0});var qi=bn.extend({addHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),pt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Vt(this._map._container,"leaflet-touch-zoom"),zt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var d=this._map;if(!(!s.touches||s.touches.length!==2||d._animatingZoom||this._zooming)){var p=d.mouseEventToContainerPoint(s.touches[0]),_=d.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(p.add(_)._divideBy(2))),this._startDist=p.distanceTo(_),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),pt(document,"touchmove",this._onTouchMove,this),pt(document,"touchend touchcancel",this._onTouchEnd,this),rr(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var d=this._map,p=d.mouseEventToContainerPoint(s.touches[0]),_=d.mouseEventToContainerPoint(s.touches[1]),A=p.distanceTo(_)/this._startDist;if(this._zoom=d.getScaleZoom(A,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&A<1||this._zoom>d.getMaxZoom()&&A>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,A===1)return}else{var Z=p._add(_)._divideBy(2)._subtract(this._centerPoint);if(A===1&&Z.x===0&&Z.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(Z),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),ce(this._animRequest);var ue=c(d._move,d,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=he(ue,this,!0),rr(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ce(this._animRequest),zt(document,"touchmove",this._onTouchMove,this),zt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Et.addInitHook("addHandler","touchZoom",qi),Et.BoxZoom=Ki,Et.DoubleClickZoom=Pu,Et.Drag=tc,Et.Keyboard=rc,Et.ScrollWheelZoom=Ut,Et.TapHold=zs,Et.TouchZoom=qi,t.Bounds=D,t.Browser=Oe,t.CRS=de,t.Canvas=Ql,t.Circle=jo,t.CircleMarker=Oo,t.Class=xe,t.Control=cn,t.DivIcon=Uo,t.DivOverlay=Yn,t.DomEvent=Ao,t.DomUtil=Ds,t.Draggable=Rn,t.Evented=M,t.FeatureGroup=xa,t.GeoJSON=qn,t.GridLayer=$a,t.Handler=bn,t.Icon=ui,t.ImageOverlay=Ua,t.LatLng=G,t.LatLngBounds=I,t.Layer=Mn,t.LayerGroup=Ba,t.LineUtil=vu,t.Map=Et,t.Marker=ya,t.Mixin=zl,t.Path=za,t.Point=V,t.PolyUtil=yf,t.Polygon=_a,t.Polyline=un,t.Popup=zo,t.PosAnimation=Po,t.Projection=Sf,t.Rectangle=Au,t.Renderer=Xn,t.SVG=di,t.SVGOverlay=Yl,t.TileLayer=Wa,t.Tooltip=Hi,t.Transformation=Ke,t.Util=Ne,t.VideoOverlay=ql,t.bind=c,t.bounds=P,t.canvas=ec,t.circle=Ls,t.circleMarker=wu,t.control=Ma,t.divIcon=Tu,t.extend=a,t.featureGroup=yu,t.geoJSON=bu,t.geoJson=Bn,t.gridLayer=Gi,t.icon=_u,t.imageOverlay=ku,t.latLng=te,t.latLngBounds=B,t.layerGroup=Fs,t.map=Ra,t.marker=Cf,t.point=se,t.polygon=Pf,t.polyline=Af,t.popup=Vi,t.rectangle=Nf,t.setOptions=k,t.stamp=m,t.svg=$o,t.svgOverlay=Xl,t.tileLayer=Jl,t.tooltip=Ms,t.transformation=ae,t.version=n,t.videoOverlay=Su;var Nu=window.L;t.noConflict=function(){return window.L=Nu,this},window.L=t}))})(Ac,Ac.exports)),Ac.exports}var jl=i5();const Qc=sf(jl);function pf(e,r,t){return Object.freeze({instance:e,context:r,container:t})}function gf(e,r){return r==null?function(n,a){const l=Y.useRef();return l.current||(l.current=e(n,a)),l}:function(n,a){const l=Y.useRef();l.current||(l.current=e(n,a));const c=Y.useRef(n),{instance:f}=l.current;return Y.useEffect(function(){c.current!==n&&(r(f,n,c.current),c.current=n)},[f,n,a]),l}}function Ry(e,r){Y.useEffect(function(){return(r.layerContainer??r.map).addLayer(e.instance),function(){r.layerContainer?.removeLayer(e.instance),r.map.removeLayer(e.instance)}},[r,e])}function My(e){return function(t){const n=hf(),a=e(mf(t,n),n);return Dy(n.map,t.attribution),Em(a.current,t.eventHandlers),Ry(a.current,n),a}}function s5(e,r){const t=Y.useRef();Y.useEffect(function(){if(r.pathOptions!==t.current){const a=r.pathOptions??{};e.instance.setStyle(a),t.current=a}},[e,r])}function o5(e){return function(t){const n=hf(),a=e(mf(t,n),n);return Em(a.current,t.eventHandlers),Ry(a.current,n),s5(a.current,t),a}}function l5(e,r){const t=gf(e,r),n=My(t);return Ly(n)}function c5(e,r){const t=gf(e),n=n5(t,r);return t5(n)}function u5(e,r){const t=gf(e,r),n=o5(t);return Ly(n)}function d5(e,r){const t=gf(e,r),n=My(t);return r5(n)}function f5(e,r,t){const{opacity:n,zIndex:a}=r;n!=null&&n!==t.opacity&&e.setOpacity(n),a!=null&&a!==t.zIndex&&e.setZIndex(a)}function By(){return hf().map}function R0(){return R0=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},R0.apply(this,arguments)}function h5({bounds:e,boundsOptions:r,center:t,children:n,className:a,id:l,placeholder:c,style:f,whenReady:m,zoom:g,...x},y){const[b]=Y.useState({className:a,id:l,style:f}),[E,S]=Y.useState(null);Y.useImperativeHandle(y,()=>E?.map??null,[E]);const k=Y.useCallback(R=>{if(R!==null&&E===null){const j=new jl.Map(R,x);t!=null&&g!=null?j.setView(t,g):e!=null&&j.fitBounds(e,r),m!=null&&j.whenReady(m),S(e5(j))}},[]);Y.useEffect(()=>()=>{E?.map.remove()},[E]);const C=E?Wt.createElement(Fy,{value:E},n):c??null;return Wt.createElement("div",R0({},b,{ref:k}),C)}const zy=Y.forwardRef(h5),Uy=l5(function({position:r,...t},n){const a=new jl.Marker(r,t);return pf(a,Oy(n,{overlayContainer:a}))},function(r,t,n){t.position!==n.position&&r.setLatLng(t.position),t.icon!=null&&t.icon!==n.icon&&r.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==n.zIndexOffset&&r.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==n.opacity&&r.setOpacity(t.opacity),r.dragging!=null&&t.draggable!==n.draggable&&(t.draggable===!0?r.dragging.enable():r.dragging.disable())}),m5=u5(function({positions:r,...t},n){const a=new jl.Polyline(r,t);return pf(a,Oy(n,{overlayContainer:a}))},function(r,t,n){t.positions!==n.positions&&r.setLatLngs(t.positions)}),M0=c5(function(r,t){const n=new jl.Popup(r,t.overlayContainer);return pf(n,t)},function(r,t,{position:n},a){Y.useEffect(function(){const{instance:c}=r;function f(g){g.popup===c&&(c.update(),a(!0))}function m(g){g.popup===c&&a(!1)}return t.map.on({popupopen:f,popupclose:m}),t.overlayContainer==null?(n!=null&&c.setLatLng(n),c.openOn(t.map)):t.overlayContainer.bindPopup(c),function(){t.map.off({popupopen:f,popupclose:m}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(c)}},[r,t,a,n])}),$y=d5(function({url:r,...t},n){const a=new jl.TileLayer(r,mf(t,n));return pf(a,n)},function(r,t,n){f5(r,t,n);const{url:a}=t;a!=null&&a!==n.url&&r.setUrl(a)});function ax({startTime:e}){const[r,t]=Y.useState(0);if(Y.useEffect(()=>{if(!e)return;const l=()=>{const f=new Date(e).getTime(),m=Date.now();t(Math.floor((m-f)/1e3))};l();const c=setInterval(l,1e3);return()=>clearInterval(c)},[e]),!e)return null;const n=Math.floor(r/60),a=r%60;return u.jsxs("div",{className:"elapsed-timer",children:[u.jsx("span",{className:"timer-icon",children:""}),u.jsxs("span",{className:"timer-value",children:[n,":",a.toString().padStart(2,"0")]})]})}function p5({positions:e,resetTrigger:r}){const t=By(),n=Y.useRef(!1),a=Y.useRef(0);return Y.useEffect(()=>{if(!(e.length===0||!(!n.current||r&&r!==a.current)))if(n.current=!0,r&&(a.current=r),e.length===1)t.setView(e[0],15);else{const c=Qc.latLngBounds(e);t.fitBounds(c.pad(.1))}},[t,e,r]),null}function g5(e,r){return Qc.divIcon({className:"custom-numbered-marker",html:`<div class="marker-pin ${r?"marker-active":""}">
      <div class="marker-number">${e}</div>
    </div>`,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]})}function v5(e){return typeof e.lat=="number"&&typeof e.lng=="number"&&!Number.isNaN(e.lat)&&!Number.isNaN(e.lng)?`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(`${e.lat},${e.lng}`)}`:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e?.address??"")}`}const x5=function({state:r,setActive:t,cancelActive:n,onComplete:a,onAddArrangement:l,filterText:c}){const f=Array.isArray(r.addresses)?r.addresses:[],m=Array.isArray(r.completions)?r.completions:[],g=r.activeIndex,[x,y]=Y.useState(()=>{const Q=localStorage.getItem("navigator_address_view_mode");return Q==="map"||Q==="list"?Q:"list"}),[b,E]=Y.useState(0);Y.useEffect(()=>{localStorage.setItem("navigator_address_view_mode",x)},[x]);const S=Y.useMemo(()=>{const Q=new Set;return f.forEach((M,V)=>{if(!M.address)return;m.some(se=>se.index===V&&(se.listVersion||r.currentListVersion)===r.currentListVersion)&&Q.add(V)}),Q},[m,f,r.currentListVersion]),k=(c??"").trim().toLowerCase(),C=Y.useMemo(()=>f.map((Q,M)=>({a:Q,i:M})).filter(({a:Q})=>!k||(Q.address??"").toLowerCase().includes(k)).filter(({i:Q})=>!S.has(Q)),[f,k,S]),[R,j]=Y.useState(null),[N,F]=Y.useState(""),[K,z]=Y.useState(""),[O,ne]=Y.useState(null),[ee,ve]=Y.useState(null),he=Y.useRef(new Map),[ce,Ne]=Y.useState(null);Y.useEffect(()=>{g===null&&(j(null),F(""),z(""),ne(null),Ne(null),ve(null))},[g]);const xe=Y.useCallback(async(Q,M,V,H,se)=>{const D=he.current.get(Q);if(D){await D;return}const P=(async()=>{try{ve(Q),await a(Q,M,V,H,se),j(null)}catch(I){throw console.error("Completion failed:",I),I}finally{ve(null),he.current.delete(Q)}})();he.current.set(Q,P),await P},[a]),le=Y.useMemo(()=>C.filter(({a:Q})=>Q.lat&&Q.lng),[C]);return C.length===0?u.jsxs("div",{className:"empty-state",children:[u.jsx("div",{className:"empty-icon",children:""}),u.jsx("div",{className:"empty-title",children:"No Pending Addresses"}),u.jsx("div",{className:"empty-message",children:"Import an Excel file or add addresses manually to get started"})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"view-toggle-container",children:[u.jsxs("button",{className:`view-toggle-btn ${x==="list"?"active":""}`,onClick:()=>y("list"),children:[u.jsx("span",{children:""}),u.jsx("span",{children:"List"})]}),u.jsxs("button",{className:`view-toggle-btn ${x==="map"?"active":""}`,onClick:()=>y("map"),disabled:le.length===0,children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Map"}),le.length===0&&u.jsx("span",{className:"badge-warning",children:"(No coordinates)"})]})]}),x==="map"&&le.length>0&&u.jsxs("div",{className:"map-view-container",children:[u.jsx("button",{className:"map-reset-btn",onClick:()=>E(Date.now()),title:"Reset map view to show all addresses",children:" Reset View"}),u.jsxs(zy,{center:[51.5074,-.1278],zoom:10,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[u.jsx($y,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u.jsx(p5,{positions:le.map(({a:Q})=>[Q.lat,Q.lng]),resetTrigger:b}),le.map(({a:Q,i:M},V)=>{const H=g===M;return u.jsx(Uy,{position:[Q.lat,Q.lng],icon:g5(V+1,H),children:u.jsx(M0,{children:u.jsxs("div",{className:"map-popup",children:[u.jsxs("div",{className:"popup-header",children:[u.jsxs("span",{className:"popup-number",children:["#",V+1]}),u.jsx("span",{className:`popup-status ${H?"status-active":"status-pending"}`,children:H?"Active":"Pending"})]}),u.jsx("div",{className:"popup-address",children:Q.address}),!H&&u.jsx("button",{className:"popup-btn-start",onClick:()=>t(M),children:" Start"}),H&&u.jsxs("div",{className:"popup-active-info",children:[u.jsx(ax,{startTime:r.activeStartTime}),u.jsx("button",{className:"popup-btn-complete",onClick:()=>{y("list")},children:" Complete"})]})]})})},M)})]})]}),x==="list"&&u.jsx("div",{className:"address-list-modern",children:C.map(({a:Q,i:M},V)=>{const H=g===M,se=v5(Q);return u.jsxs("div",{className:`address-card-modern ${H?"active":""}`,children:[u.jsxs("div",{className:"address-header-modern",children:[u.jsxs("div",{className:"address-content",children:[u.jsx("div",{className:"address-number",children:V+1}),u.jsxs("div",{className:"address-info",children:[u.jsx("div",{className:"address-title",title:Q.address,children:Q.address}),u.jsxs("div",{className:"address-meta",children:[u.jsxs("div",{className:"address-meta-item",children:[u.jsx("span",{children:""}),u.jsxs("span",{children:["Index #",M+1]})]}),Q.lat&&Q.lng&&u.jsxs("div",{className:"address-meta-item",children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Coordinates ready"})]}),H&&r.activeStartTime&&u.jsx("div",{className:"address-meta-item",children:u.jsx(ax,{startTime:r.activeStartTime})})]})]})]}),u.jsxs("div",{className:`address-status-badge ${H?"status-active":"status-pending"}`,children:[H&&u.jsx("span",{children:""}),H?"Active":"Pending"]})]}),u.jsxs("div",{className:"address-actions-modern",children:[u.jsxs("a",{className:"action-btn-modern btn-navigate",href:se,target:"_blank",rel:"noreferrer",title:"Open in Google Maps",onClick:()=>{},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Navigate"})]}),H?u.jsxs(u.Fragment,{children:[u.jsxs("button",{className:"action-btn-modern btn-complete",onClick:()=>{j(R!==M?M:null),F(""),z(""),ne(null)},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Complete"})]}),u.jsxs("button",{className:"action-btn-modern",style:{background:"var(--gray-100)",color:"var(--gray-600)"},onClick:()=>{window.confirm("Are you sure you want to cancel? Any tracked time will be lost.")&&n()},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Cancel"})]})]}):u.jsxs("button",{className:"action-btn-modern btn-set-active",onClick:()=>t(M),children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Start"})]})]}),H&&R===M&&u.jsxs("div",{className:"outcome-panel-modern",children:[u.jsx("div",{className:"outcome-header",children:u.jsx("span",{className:"outcome-title",children:"Select Outcome"})}),u.jsxs("div",{className:"outcome-buttons",children:[u.jsxs("button",{className:"outcome-btn outcome-done",disabled:ee===M,onClick:()=>xe(M,"Done"),title:"Mark as Done",children:[u.jsx("span",{className:"outcome-icon",children:""}),u.jsx("span",{className:"outcome-label",children:"Done"})]}),u.jsxs("button",{className:"outcome-btn outcome-da",disabled:ee===M,onClick:()=>xe(M,"DA"),title:"Mark as DA",children:[u.jsx("span",{className:"outcome-icon",children:""}),u.jsx("span",{className:"outcome-label",children:"DA"})]}),u.jsxs("button",{className:"outcome-btn outcome-arr",onClick:()=>{j(null),Ne(M)},title:"Create arrangement",children:[u.jsx("span",{className:"outcome-icon",children:""}),u.jsx("span",{className:"outcome-label",children:"Arrangement"})]})]}),u.jsx("div",{className:"pif-section",children:u.jsxs("div",{className:"pif-input-group",children:[u.jsx("span",{className:"pif-label",children:" PIF Amount:"}),u.jsx("input",{id:`pif-amount-${M}`,name:`pifAmount-${M}`,type:"number",step:"0.01",min:"0",inputMode:"decimal",className:"pif-input",placeholder:"0.00",value:N,onChange:D=>F(D.target.value),autoComplete:"off",onKeyDown:D=>{if(D.key==="Enter"){const P=Number(N);if(!Number.isFinite(P)||P<=0){alert("Enter a valid PIF amount (e.g. 50)");return}ne(M)}}}),u.jsxs("button",{className:"outcome-btn outcome-pif",disabled:ee===M,onClick:()=>{const D=Number(N);if(!Number.isFinite(D)||D<=0){alert("Enter a valid PIF amount (e.g. 50)");return}ne(M)},children:[u.jsx("span",{className:"outcome-icon",children:""}),u.jsx("span",{className:"outcome-label",children:"Next"})]})]})}),ee===M&&u.jsxs("div",{className:"outcome-loading",children:[u.jsx("span",{className:"spinner-small"}),u.jsx("span",{children:"Processing..."})]})]})]},M)})}),ce!==null&&l&&f[ce]&&u.jsx(Tm,{state:r,preSelectedAddressIndex:ce,onSave:async Q=>{await l(Q),xe(ce,"ARR"),Ne(null)},onCancel:()=>Ne(null),onComplete:xe,fullscreen:!0}),O!==null&&u.jsx("div",{className:"case-ref-modal-overlay",onClick:()=>ne(null),children:u.jsxs("div",{className:"case-ref-modal",onClick:Q=>Q.stopPropagation(),children:[u.jsxs("div",{className:"case-ref-modal-header",children:[u.jsx("h3",{children:" Enter Case Reference"}),u.jsx("button",{className:"close-btn",onClick:()=>ne(null),children:""})]}),u.jsxs("div",{className:"case-ref-modal-body",children:[u.jsxs("p",{children:["PIF Amount: ",u.jsxs("strong",{children:["",Number(N).toFixed(2)]})]}),u.jsxs("div",{className:"case-ref-input-wrapper",children:[u.jsx("label",{htmlFor:"case-ref-input",children:"Case Reference Number"}),u.jsx("input",{id:"case-ref-input",type:"number",inputMode:"numeric",className:"case-ref-input",placeholder:"e.g. 123456",value:K,onChange:Q=>z(Q.target.value),autoComplete:"off",autoFocus:!0,onKeyDown:Q=>{if(Q.key==="Enter"){const M=Number(K);if(!K||!K.trim()){alert("Please enter a case reference number");return}if(!Number.isFinite(M)||M<=0||!Number.isInteger(M)){alert("Case reference must be a valid whole number");return}xe(O,"PIF",Number(N).toFixed(2),void 0,K.trim()),ne(null),z(""),F("")}}})]})]}),u.jsxs("div",{className:"case-ref-modal-footer",children:[u.jsx("button",{className:"modal-btn modal-btn-cancel",onClick:()=>{ne(null),z("")},children:"Cancel"}),u.jsx("button",{className:"modal-btn modal-btn-save",disabled:ee===O,onClick:()=>{const Q=Number(K);if(!K||!K.trim()){alert("Please enter a case reference number");return}if(!Number.isFinite(Q)||Q<=0||!Number.isInteger(Q)){alert("Case reference must be a valid whole number");return}xe(O,"PIF",Number(N).toFixed(2),void 0,K.trim()),ne(null),z(""),F("")},children:ee===O?"Saving...":"Save PIF"})]})]})}),u.jsx("style",{children:`
        /* Elapsed Timer Styles */
        .elapsed-timer {
          display: inline-flex;
          align-items: center;
          gap: 0.25rem;
          padding: 0.25rem 0.5rem;
          background: var(--primary);
          color: white;
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.875rem;
          animation: pulse 2s ease-in-out infinite;
        }

        .timer-icon {
          font-size: 1rem;
        }

        .timer-value {
          font-variant-numeric: tabular-nums;
          min-width: 3rem;
          text-align: center;
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.85;
          }
        }

        /* View Toggle Styles */
        .view-toggle-container {
          display: flex;
          gap: 0.5rem;
          padding: 0.75rem;
          margin-bottom: 1rem;
          background: var(--surface);
          border: 1px solid var(--border);
          border-radius: var(--radius-lg);
        }

        .view-toggle-btn {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem 1rem;
          border: 2px solid var(--border);
          border-radius: var(--radius-md);
          background: var(--surface);
          color: var(--text-secondary);
          font-weight: 600;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .view-toggle-btn:hover:not(:disabled) {
          background: var(--gray-50);
          border-color: var(--primary);
        }

        .view-toggle-btn.active {
          background: var(--primary);
          border-color: var(--primary);
          color: white;
        }

        .view-toggle-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .badge-warning {
          font-size: 0.65rem;
          color: var(--warning);
          font-weight: normal;
        }

        /* Map View Styles */
        .map-view-container {
          height: 600px;
          max-height: calc(100vh - 300px);
          position: relative;
          border-radius: var(--radius-lg);
          overflow: hidden;
          border: 1px solid var(--border);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* Ensure Leaflet map respects container */
        .map-view-container .leaflet-container {
          border-radius: var(--radius-lg);
        }

        /* Map Reset Button */
        .map-reset-btn {
          position: absolute;
          top: 10px;
          right: 10px;
          z-index: 1000;
          padding: 0.5rem 1rem;
          background: var(--surface);
          color: var(--text-primary);
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.875rem;
          cursor: pointer;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
          transition: all 0.2s ease;
        }

        .map-reset-btn:hover {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
          transform: translateY(-1px);
          box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        }

        .map-reset-btn:active {
          transform: translateY(0);
        }

        /* Custom Numbered Markers */
        .custom-numbered-marker {
          background: transparent;
          border: none;
        }

        .marker-pin {
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .marker-pin::before {
          content: '';
          position: absolute;
          width: 36px;
          height: 36px;
          background: var(--primary);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          border: 3px solid white;
        }

        .marker-pin.marker-active::before {
          background: var(--success);
          animation: markerPulse 2s ease-in-out infinite;
        }

        @keyframes markerPulse {
          0%, 100% {
            transform: rotate(-45deg) scale(1);
          }
          50% {
            transform: rotate(-45deg) scale(1.1);
          }
        }

        .marker-number {
          position: relative;
          z-index: 1;
          color: white;
          font-weight: bold;
          font-size: 0.875rem;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
          transform: translateY(-2px);
        }

        /* Leaflet Popup Override for Dark Mode */
        .leaflet-popup-content-wrapper {
          background: var(--surface) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--border) !important;
          box-shadow: 0 3px 14px rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-tip {
          background: var(--surface) !important;
          border: 1px solid var(--border) !important;
        }

        .leaflet-popup-close-button {
          color: var(--text-primary) !important;
        }

        .leaflet-popup-close-button:hover {
          color: var(--primary) !important;
        }

        /* Map Popup Styles */
        .map-popup {
          min-width: 200px;
          padding: 0.5rem;
        }

        .popup-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid var(--border);
        }

        .popup-number {
          font-weight: bold;
          color: var(--primary);
          font-size: 1rem;
        }

        .popup-status {
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          font-size: 0.75rem;
          font-weight: 600;
        }

        .popup-status.status-active {
          background: var(--success);
          color: white;
        }

        .popup-status.status-pending {
          background: var(--gray-700);
          color: var(--gray-100);
        }

        .popup-address {
          margin-bottom: 0.75rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .popup-btn-start,
        .popup-btn-complete {
          width: 100%;
          padding: 0.5rem 1rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .popup-btn-start {
          background: var(--primary);
          color: white;
        }

        .popup-btn-start:hover {
          background: var(--primary-dark);
        }

        .popup-btn-complete {
          background: var(--success);
          color: white;
          margin-top: 0.5rem;
        }

        .popup-btn-complete:hover {
          background: var(--success-dark);
        }

        .popup-active-info {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .popup-active-info .elapsed-timer {
          justify-content: center;
          margin-bottom: 0.25rem;
        }

        /* Modern Outcome Panel Styles */
        .outcome-panel-modern {
          background: var(--gray-50);
          border: 2px solid var(--primary);
          border-radius: var(--radius-lg);
          padding: 1rem;
          margin-top: 1rem;
          animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .outcome-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .outcome-title {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-buttons {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .outcome-btn {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 0.25rem;
          padding: 0.75rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: var(--transition-normal);
          position: relative;
          overflow: hidden;
        }

        .outcome-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(100%);
          transition: transform 0.3s ease;
        }

        .outcome-btn:hover::before {
          transform: translateY(0);
        }

        .outcome-btn:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .outcome-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .outcome-icon {
          font-size: 1.25rem;
        }

        .outcome-label {
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-done {
          background: var(--success);
          color: white;
        }

        .outcome-da {
          background: var(--danger);
          color: white;
        }

        .outcome-arr {
          background: var(--warning);
          color: white;
        }

        .outcome-pif {
          background: var(--primary);
          color: white;
        }

        .pif-section {
          padding-top: 1rem;
          border-top: 1px solid var(--gray-200);
        }

        .pif-input-group {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .pif-label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .pif-input {
          flex: 1;
          padding: 0.625rem 0.75rem;
          border: 2px solid var(--gray-200);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
          font-weight: 600;
          text-align: right;
          transition: var(--transition-normal);
        }

        .pif-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        .outcome-loading {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem;
          color: var(--gray-600);
          font-size: 0.875rem;
        }

        .spinner-small {
          width: 16px;
          height: 16px;
          border: 2px solid var(--gray-300);
          border-top-color: var(--primary);
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .outcome-buttons {
            grid-template-columns: 1fr;
          }

          .pif-input-group {
            flex-direction: column;
            align-items: stretch;
          }

          .outcome-btn {
            flex-direction: row;
            justify-content: center;
            gap: 0.5rem;
          }
        }

        /* Case Reference Modal Styles */
        .case-ref-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        .case-ref-modal {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
          width: 90%;
          max-width: 450px;
          animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .case-ref-modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
        }

        .case-ref-modal-header h3 {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--gray-800);
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: var(--gray-500);
          cursor: pointer;
          padding: 0.25rem;
          line-height: 1;
          transition: var(--transition-normal);
        }

        .close-btn:hover {
          color: var(--gray-700);
          transform: scale(1.1);
        }

        .case-ref-modal-body {
          padding: 1.5rem;
        }

        .case-ref-modal-body p {
          margin: 0 0 1.5rem 0;
          font-size: 1rem;
          color: var(--gray-600);
        }

        .case-ref-modal-body strong {
          color: var(--primary);
          font-size: 1.125rem;
        }

        .case-ref-input-wrapper {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .case-ref-input-wrapper label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .case-ref-input {
          padding: 0.875rem 1rem;
          border: 2px solid var(--gray-300);
          border-radius: var(--radius-md);
          font-size: 1rem;
          font-weight: 600;
          transition: var(--transition-normal);
        }

        .case-ref-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 4px var(--primary-light);
        }

        .case-ref-modal-footer {
          display: flex;
          gap: 0.75rem;
          padding: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .modal-btn {
          flex: 1;
          padding: 0.875rem 1.5rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.938rem;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .modal-btn-cancel {
          background: var(--gray-100);
          color: var(--gray-700);
        }

        .modal-btn-cancel:hover {
          background: var(--gray-200);
        }

        .modal-btn-save {
          background: var(--primary);
          color: white;
        }

        .modal-btn-save:hover:not(:disabled) {
          background: var(--primary-dark);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .modal-btn-save:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        @media (max-width: 768px) {
          .case-ref-modal {
            width: 95%;
            margin: 1rem;
          }

          .case-ref-modal-header,
          .case-ref-modal-body,
          .case-ref-modal-footer {
            padding: 1rem;
          }
        }
      `})]})},y5=Y.memo(x5),_5="Europe/London";function vs(e,r=_5){const t=e.toLocaleDateString("en-GB",{timeZone:r,year:"numeric"}),n=e.toLocaleDateString("en-GB",{timeZone:r,month:"2-digit"}),a=e.toLocaleDateString("en-GB",{timeZone:r,day:"2-digit"});return t+"-"+n+"-"+a}function B0(e){const r=e.split("-");return new Date(Number(r[0]),Number(r[1])-1,Number(r[2]))}function $d(e,r){const t=new Date(e.getTime());return t.setDate(t.getDate()+r),t}function Ld(e){return new Date(e.getFullYear(),e.getMonth(),1)}function c0(e,r){return e===r}function w5(e,r,t){return e>=r&&e<=t}function ix(e){return(e/3600).toFixed(2)}function b5(e){const r=e;if(typeof r.durationSeconds=="number")return Math.max(0,r.durationSeconds);if(e.start&&e.end)try{const t=new Date(e.start).getTime(),n=new Date(e.end).getTime();if(isFinite(t)&&isFinite(n)&&n>t)return Math.floor((n-t)/1e3)}catch(t){console.warn("Failed to calculate duration:",t)}return 0}function k5(e,r){if(!e||!r)return[];const t=B0(e),n=B0(r);if(!(t<=n))return[e];const a=[];let l=new Date(t.getTime());for(;l<=n;)a.push(vs(l)),l=$d(l,1);return a}function S5({startKey:e,endKey:r,onChange:t}){const n=B0(r||e||vs(new Date)),[a,l]=Y.useState(Ld(n)),[c,f]=Y.useState(!1);function m(R){const j=Ld(R),F=(j.getDay()+6)%7,K=$d(j,-F),z=[];for(let O=0;O<42;O++){const ne=$d(K,O);z.push({key:vs(ne),inMonth:ne.getMonth()===R.getMonth(),date:ne})}return z}const g=m(a),x=a.toLocaleDateString("en-GB",{month:"long"})+" "+String(a.getFullYear()),y=e<=r?e:r,b=e<=r?r:e,E=vs(new Date);function S(){l(new Date(a.getFullYear(),a.getMonth()-1,1))}function k(){l(new Date(a.getFullYear(),a.getMonth()+1,1))}function C(R){if(!c){t(R,R),f(!0);return}let j=e||R,N=R;if(N<j){const F=j;j=N,N=F}t(j,N),f(!1)}return u.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[u.jsx("button",{className:"btn btn-ghost",onClick:S,"aria-label":"Previous month",children:"Prev"}),u.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:x}),u.jsx("button",{className:"btn btn-ghost",onClick:k,"aria-label":"Next month",children:"Next"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,fontSize:12,color:"var(--text-secondary)",textAlign:"center",marginBottom:4},children:[u.jsx("div",{children:"Mon"}),u.jsx("div",{children:"Tue"}),u.jsx("div",{children:"Wed"}),u.jsx("div",{children:"Thu"}),u.jsx("div",{children:"Fri"}),u.jsx("div",{children:"Sat"}),u.jsx("div",{children:"Sun"})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:g.map(R=>{const j=w5(R.key,y,b),N=c0(R.key,e),F=c0(R.key,r),K=c0(R.key,E),z={padding:"0.5rem 0",borderRadius:8,border:"1px solid var(--border-light)",background:j?"var(--surface-strong)":"var(--surface)",textAlign:"center",cursor:"pointer",opacity:R.inMonth?1:.45,position:"relative",userSelect:"none"},O={position:"absolute",top:6,right:6,width:6,height:6,borderRadius:6,background:K?"currentColor":"transparent",opacity:K?.7:0},ne={position:"absolute",inset:0,borderRadius:8,border:N||F?"2px solid var(--primary, #4f46e5)":"2px solid transparent",pointerEvents:"none"};return u.jsxs("div",{style:z,title:R.key,onClick:()=>C(R.key),children:[u.jsx("div",{style:{fontWeight:N||F?700:500,color:"var(--text-primary)"},children:String(R.date.getDate())}),u.jsx("div",{style:O}),u.jsx("div",{style:ne})]},R.key)})}),u.jsxs("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:[u.jsx("button",{className:"btn btn-ghost",onClick:()=>{const R=vs(new Date);t(R,R),l(Ld(new Date)),f(!1)},children:"Today"}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>{const R=new Date,j=$d(new Date,-6);t(vs(j),vs(R)),l(Ld(R)),f(!1)},children:"Last 7 days"})]})]})}function T5(e,r){const t=e,n=[t.date,t.day,t.at,t.timestamp,t.completedAt,t.created_at];for(const l of n){if(!l)continue;const c=new Date(l);if(!Number.isNaN(c.getTime()))return c.toISOString().slice(0,10)}const a=new Set(r.map(l=>l.date));return a.size===1&&Array.from(a)[0]||null}const E5=function({state:r,onChangeOutcome:t,onAddArrangement:n,onComplete:a}){const{addresses:l,completions:c,daySessions:f,arrangements:m}=r,[g,x]=Y.useState(null),[y,b]=Y.useState(""),[E,S]=Y.useState(null),k=f.length>0?f[f.length-1].date:vs(new Date),[C,R]=Y.useState(k),[j,N]=Y.useState(k),[F,K]=Y.useState(!1),z=Y.useMemo(()=>{const Q=new Map;for(const M of f){const V=M.date;if(!V)continue;const H=Q.get(V)||0;Q.set(V,H+b5(M))}return Q},[f]),O=Y.useMemo(()=>{const Q=new Map;return c.forEach((M,V)=>{const H=T5(M,f);if(!H)return;const se=Q.get(H);se?se.push(V):Q.set(H,[V])}),Q},[c,f]),ne=k5(C,j);let ee=0,ve=0,he=0,ce=0;ne.forEach(Q=>{ee+=z.get(Q)||0;const M=O.get(Q)||[];ve+=M.length,he+=M.map(V=>c[V]).filter(V=>V.outcome==="PIF").length,ce+=M.map(V=>c[V]).filter(V=>V.outcome==="DA").length});const[Ne,xe]=Y.useState({});function le(Q){xe(M=>({...M,[Q]:!M[Q]}))}return u.jsxs("div",{children:[u.jsx("div",{style:{marginBottom:"0.9rem"},children:u.jsx(S5,{startKey:C,endKey:j,onChange:(Q,M)=>{R(Q),N(M)}})}),u.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"12px",padding:"1rem",boxShadow:"var(--shadow-sm)",marginBottom:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",marginBottom:8,flexWrap:"wrap"},children:[u.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:"Summary "+(C===j?"("+C+")":"("+C+" -> "+j+")")}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>K(Q=>!Q),children:F?"Hide details":"View details"})]}),u.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[u.jsxs("span",{className:"pill",children:["Hours ",ix(ee)]}),u.jsxs("span",{className:"pill pill-done",children:["Completed ",ve]}),u.jsxs("span",{className:"pill pill-pif",children:["PIF ",he]}),u.jsxs("span",{className:"pill pill-da",children:["DA ",ce]})]})]}),F&&u.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:ne.map(Q=>{const M=z.get(Q)||0,V=O.get(Q)||[],H=V.map(I=>c[I]).filter(I=>I.outcome==="PIF").length,se=V.map(I=>c[I]).filter(I=>I.outcome==="DA").length,D=V.map(I=>c[I]).filter(I=>I.outcome==="ARR").length,P=V.length;return u.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[u.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},children:[u.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",flexWrap:"wrap"},children:[u.jsx("strong",{children:Q}),u.jsxs("span",{className:"pill",children:["Hours ",ix(M)]}),u.jsxs("span",{className:"pill pill-done",children:["Completed ",P]}),u.jsxs("span",{className:"pill pill-pif",children:["PIF ",H]}),u.jsxs("span",{className:"pill pill-da",children:["DA ",se]}),D>0&&u.jsxs("span",{className:"pill pill-arr",children:["ARR ",D]})]}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>le(Q),children:Ne[Q]?"Hide":"View"})]}),Ne[Q]&&u.jsx("div",{style:{marginTop:"0.75rem"},children:V.length===0?u.jsx("div",{style:{fontSize:14,color:"var(--text-secondary)"},children:"No entries for this day."}):u.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:V.map(I=>{const B=c[I],G=l[B.index],te=G&&G.address||G&&G.name||(typeof B.index=="number"?"Address #"+B.index:"Address"),de=B.outcome,pe=B.arrangementId?m.find(me=>me.id===B.arrangementId):null;return u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",alignItems:"center",border:"1px dashed var(--border-light)",borderRadius:10,padding:"0.5rem 0.75rem"},children:[u.jsxs("div",{style:{minWidth:0},children:[u.jsx("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-primary)"},children:te}),u.jsxs("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:["Index "+String(B.index),B.outcome==="PIF"&&u.jsx("span",{style:{marginLeft:8,display:"inline-flex",alignItems:"center",gap:4},children:g===I?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:" "}),u.jsx("label",{htmlFor:`pif-amount-${I}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"PIF Amount"}),u.jsx("input",{id:`pif-amount-${I}`,name:"pifAmount",type:"number",step:"0.01",min:"0",inputMode:"decimal",style:{width:70,padding:"2px 4px",fontSize:12,border:"1px solid var(--border)",borderRadius:3,background:"var(--surface)"},value:y,onChange:me=>b(me.target.value),onKeyDown:me=>{if(me.key==="Enter"){const ye=parseFloat(y);isFinite(ye)&&ye>=0&&(t(I,"PIF",ye.toFixed(2)),x(null),b(""))}else me.key==="Escape"&&(x(null),b(""))},autoFocus:!0}),u.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--success)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{const me=parseFloat(y);isFinite(me)&&me>=0&&(t(I,"PIF",me.toFixed(2)),x(null),b(""))},children:""}),u.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--danger)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{x(null),b("")},children:""})]}):u.jsxs(u.Fragment,{children:[u.jsxs("span",{children:[" ",B.amount||"0.00"]}),u.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--primary)",color:"white",border:"none",borderRadius:3,cursor:"pointer",marginLeft:4},onClick:()=>{x(I),b(B.amount||"")},title:"Edit PIF amount",children:""}),B.caseReference&&u.jsxs("span",{style:{marginLeft:8},children:[" Ref: ",B.caseReference]})]})}),pe&&u.jsxs(u.Fragment,{children:[u.jsx("br",{}),u.jsxs("span",{style:{color:"var(--primary)",fontSize:"0.75rem"},children:[" From arrangement",pe.customerName&&` (${pe.customerName})`,B.outcome==="Done"&&"  Defaulted",B.outcome==="PIF"&&pe.recurrenceType&&pe.recurrenceType!=="none"&&`  ${pe.recurrenceType==="weekly"?"Weekly":"Monthly"} payment`]})]}),B.timeSpentSeconds!==void 0&&B.timeSpentSeconds>0&&u.jsxs(u.Fragment,{children:[!pe&&u.jsx("br",{}),u.jsxs("span",{style:{color:"var(--gray-600)",fontSize:"0.75rem",marginLeft:pe?8:0},children:[pe&&"  "," ",Math.floor(B.timeSpentSeconds/60),"m ",B.timeSpentSeconds%60,"s"]})]})]})]}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("label",{htmlFor:`outcome-${I}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"Outcome"}),u.jsxs("select",{id:`outcome-${I}`,name:`outcome-${I}`,value:de||"",onChange:me=>{const ye=me.target.value;ye==="ARR"&&n?S({completionIndex:I,addressIndex:B.index}):t(I,ye,B.amount)},className:"input",style:{padding:"0.25rem 0.5rem",height:32},children:[u.jsx("option",{value:"",children:"-"}),u.jsx("option",{value:"Done",children:pe?"Done (Defaulted)":"Done"}),u.jsx("option",{value:"PIF",children:pe?"PIF (Arrangement)":"PIF"}),u.jsx("option",{value:"DA",children:"DA"}),u.jsx("option",{value:"ARR",children:"ARR"})]})]})]},I)})})})]},Q)})}),E&&n&&a&&u.jsx(Tm,{state:r,preSelectedAddressIndex:E.addressIndex,onSave:async Q=>{await n(Q),t(E.completionIndex,"ARR"),S(null)},onCancel:()=>S(null),onComplete:a,fullscreen:!0})]})},C5=Y.memo(E5),A5=()=>{const[e,r]=Y.useState(!1),t=Y.useRef(null);return{isLoading:e,executeBackup:async l=>{if(e){console.warn("Backup already in progress, ignoring duplicate request");return}r(!0),t.current=setTimeout(()=>{console.error("Backup timeout reached - forcing reset"),r(!1)},6e4);try{await l(),console.log("Backup completed successfully")}catch(c){throw console.error("Backup failed:",c),c}finally{t.current&&(clearTimeout(t.current),t.current=null),r(!1)}},forceReset:()=>{console.warn("Force resetting backup loading state"),t.current&&(clearTimeout(t.current),t.current=null),r(!1)}}},Wy=["Reminder: Please arrange payment by end of day to avoid further action.","Friendly reminder: Your arrangement is due. Contact us to confirm.","Action required: Settle outstanding balance today for compliance.","Update: Payment arrangement needed. Reply to reschedule if required."],Rd={backupOnEndOfDay:!1,reminderText:Wy[0],darkMode:!1,pushNotifications:!0,autoSyncOnStart:!0},sx="navigator-web:settings",Vy=()=>{const[e,r]=Y.useState(()=>{if(typeof window<"u")try{const m=localStorage.getItem(sx);return m?{...Rd,...JSON.parse(m)}:Rd}catch{return Rd}return Rd});Y.useEffect(()=>{typeof window<"u"&&localStorage.setItem(sx,JSON.stringify(e))},[e]),Y.useEffect(()=>{e.darkMode?(document.documentElement.classList.add("dark-mode"),document.body.style.background="linear-gradient(135deg, #1f2937 0%, #111827 100%)"):(document.documentElement.classList.remove("dark-mode"),document.body.style.background="linear-gradient(135deg, #667eea 0%, #764ba2 100%)")},[e.darkMode]);const t=m=>{r(g=>({...g,...m}))};return{settings:e,updateSettings:t,toggleBackup:()=>t({backupOnEndOfDay:!e.backupOnEndOfDay}),toggleDarkMode:()=>t({darkMode:!e.darkMode}),togglePushNotifications:()=>t({pushNotifications:!e.pushNotifications}),toggleAutoSync:()=>t({autoSyncOnStart:!e.autoSyncOnStart}),updateReminderText:m=>t({reminderText:m}),predefinedReminders:Wy}};function ox(e,r){const[t,n,a]=e.split("-").map(Number),[l,c]=r.split(":").map(Number);try{return new Date(t,(n||1)-1,a||1,l||0,c||0).toISOString()}catch{return""}}function lx(e){if(!e)return"";try{return new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Europe/London"})}catch{return""}}function Md(e){if(!e)return"";try{const r=new Date(e),t=String(r.getHours()).padStart(2,"0"),n=String(r.getMinutes()).padStart(2,"0");return`${t}:${n}`}catch{return""}}function cx(e){if(!e)return"";try{const r=new Date(e),t=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${t}-${n}-${a}`}catch{return""}}const P5=function({sessions:r,completions:t,startDay:n,endDay:a,onEditStart:l,onEditEnd:c,onBackup:f}){const{settings:m}=Vy(),{isLoading:g,executeBackup:x,forceReset:y}=A5(),b=new Date().toISOString().slice(0,10),E=r.filter(V=>V.date===b),S=E.find(V=>!V.end)||null,k=S||E.slice().sort((V,H)=>{const se=new Date(V.start||V.date+"T00:00:00.000Z").getTime();return new Date(H.start||H.date+"T00:00:00.000Z").getTime()-se})[0],C=!!S,R=async()=>{try{m.backupOnEndOfDay&&f&&await x(f),a()}catch(V){console.error("Failed to complete backup during end day:",V),a()}},N=t.filter(V=>(V.timestamp||"").slice(0,10)===b).reduce((V,H)=>((H.outcome==="PIF"||H.outcome==="DA"||H.outcome==="Done"||H.outcome==="ARR")&&(V[H.outcome]+=1),V),{PIF:0,DA:0,Done:0,ARR:0}),[F,K]=Y.useState(!1),[z,O]=Y.useState(b),[ne,ee]=Y.useState(()=>{if(k?.start)return Md(k.start);const V=new Date;return`${String(V.getHours()).padStart(2,"0")}:${String(V.getMinutes()).padStart(2,"0")}`});Y.useEffect(()=>{if(k?.start)O(cx(k.start)||k.date),ee(Md(k.start));else{O(b);const V=new Date;ee(`${String(V.getHours()).padStart(2,"0")}:${String(V.getMinutes()).padStart(2,"0")}`)}},[k?.start,k?.date,b]);const ve=Y.useCallback(()=>{const V=ox(z,ne);V&&l(V),K(!1)},[z,ne,l]),[he,ce]=Y.useState(!1),[Ne,xe]=Y.useState(b),[le,Q]=Y.useState(()=>{if(k?.end)return Md(k.end);const V=new Date;return`${String(V.getHours()).padStart(2,"0")}:${String(V.getMinutes()).padStart(2,"0")}`});Y.useEffect(()=>{if(k?.end)xe(cx(k.end)||k.date),Q(Md(k.end));else{xe(b);const V=new Date;Q(`${String(V.getHours()).padStart(2,"0")}:${String(V.getMinutes()).padStart(2,"0")}`)}},[k?.end,k?.date,b]);const M=Y.useCallback(()=>{const V=ox(Ne,le);V&&c(V),ce(!1)},[Ne,le,c]);return u.jsxs("div",{className:`day-panel-modern ${C?"day-panel-active":""}`,children:[u.jsxs("div",{className:"day-panel-header",children:[u.jsxs("div",{className:"day-status",children:[u.jsx("div",{className:"day-status-icon",children:C?"":k?"":""}),u.jsxs("div",{className:"day-status-text",children:[u.jsx("div",{className:"day-status-title",children:C?"Day Running":k?"Day Completed":"No Session Today"}),u.jsx("div",{className:"day-status-subtitle",children:k?.start?u.jsxs(u.Fragment,{children:[lx(k.start),k?.end&&u.jsxs(u.Fragment,{children:["  ",lx(k.end)]}),C&&!k?.end&&u.jsxs(u.Fragment,{children:["  ",u.jsx("span",{style:{color:"var(--success)"},children:"Active"})]})]}):"Click 'Start Day' to begin tracking"})]})]}),u.jsxs("div",{className:"day-stats-modern",children:[u.jsxs("div",{className:"stat-pill stat-pill-pif",children:[u.jsx("span",{className:"stat-number",children:N.PIF}),u.jsx("span",{className:"stat-label",children:"PIF"})]}),u.jsxs("div",{className:"stat-pill stat-pill-done",children:[u.jsx("span",{className:"stat-number",children:N.Done}),u.jsx("span",{className:"stat-label",children:"Done"})]}),u.jsxs("div",{className:"stat-pill stat-pill-da",children:[u.jsx("span",{className:"stat-number",children:N.DA}),u.jsx("span",{className:"stat-label",children:"DA"})]}),u.jsxs("div",{className:"stat-pill stat-pill-arr",children:[u.jsx("span",{className:"stat-number",children:N.ARR}),u.jsx("span",{className:"stat-label",children:"ARR"})]})]})]}),u.jsxs("div",{className:"day-panel-actions",children:[u.jsx("div",{className:"primary-actions",children:C?u.jsxs("button",{className:"btn btn-danger btn-modern",onClick:R,disabled:g,children:[u.jsx("span",{className:"btn-icon",children:g?"":""}),g?"Ending Day...":"End Day"]}):u.jsxs("button",{className:"btn btn-primary btn-modern",onClick:n,children:[u.jsx("span",{className:"btn-icon",children:""}),"Start Day"]})}),u.jsxs("div",{className:"edit-actions",children:[F?u.jsxs("div",{className:"day-edit-group",children:[u.jsx("input",{id:"start-date",name:"startDate",type:"date",className:"input input-sm",value:z,onChange:V=>O(V.target.value),autoComplete:"off"}),u.jsx("input",{id:"start-time",name:"startTime",type:"time",className:"input input-sm",value:ne,onChange:V=>ee(V.target.value),autoComplete:"off"}),u.jsx("button",{className:"btn btn-primary btn-sm",onClick:ve,children:""}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>K(!1),children:""})]}):u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>K(!0),title:"Edit today's start time",children:" Edit start"}),he?u.jsxs("div",{className:"day-edit-group",children:[u.jsx("input",{id:"end-date",name:"endDate",type:"date",className:"input input-sm",value:Ne,onChange:V=>xe(V.target.value),autoComplete:"off"}),u.jsx("input",{id:"end-time",name:"endTime",type:"time",className:"input input-sm",value:le,onChange:V=>Q(V.target.value),autoComplete:"off"}),u.jsx("button",{className:"btn btn-primary btn-sm",onClick:M,children:""}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(!1),children:""})]}):u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(!0),title:"Edit today's finish time",children:" Edit finish"})]})]}),u.jsx(Sm,{isOpen:g,onClose:()=>{console.warn("Emergency backup escape triggered by user"),y()},title:"Backing up data",showCloseButton:!0,size:"sm",children:u.jsx("div",{className:"backup-loading-modal",children:u.jsxs("div",{className:"backup-loading-content",children:[u.jsx(VA,{size:"lg"}),u.jsx("h3",{className:"backup-loading-title",children:"Backing up data, please wait..."}),u.jsx("p",{className:"backup-loading-message",children:"This usually takes 5-15 seconds. If stuck for more than 20 seconds, you can close this dialog to continue."}),u.jsx("div",{className:"backup-loading-warning",style:{marginTop:"1rem",fontSize:"0.9rem",color:"var(--warning)",textAlign:"center"},children:" If backup appears stuck, click the  button to escape"})]})})})]})},N5=Y.memo(P5),D5=function({state:r,onAddArrangement:t,onUpdateArrangement:n,onDeleteArrangement:a,onAddAddress:l,onComplete:c,autoCreateForAddress:f,onAutoCreateHandled:m}){const[g,x]=Y.useState("thisWeek"),[y,b]=Y.useState(!1),[E,S]=Y.useState(null),[k,C]=Y.useState({saving:!1,updating:!1,deleting:new Set,markingPaid:new Set,markingDefaulted:new Set,sendingReminder:new Set}),[R,j]=Y.useState(new Set),N=le=>{if(!le)return"";let Q=le.replace(/[^\d+]/g,"");return Q.startsWith("0")||Q.startsWith("+44")||Q.startsWith("44")?Q:Q.length===10&&Q.startsWith("7")?"0"+Q:Q},F=async le=>{if(!le.phoneNumber){alert("No phone number available for this arrangement.");return}C(Q=>({...Q,sendingReminder:new Set([...Q.sendingReminder,le.id])}));try{const Q={id:"temp",arrangementId:le.id,type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},M=oy(le,Q,r.reminderSettings),H=`sms:${N(le.phoneNumber)}?body=${encodeURIComponent(M)}`;window.location.href=H;const se=new Date().toISOString();await n(le.id,{lastReminderSent:se,reminderCount:(le.reminderCount||0)+1,updatedAt:se}),j(D=>new Set([...D,le.id])),setTimeout(()=>{j(D=>{const P=new Set(D);return P.delete(le.id),P})},3e3)}catch(Q){console.error("Failed to send reminder:",Q),alert("Failed to update reminder information. Please try again.")}finally{C(Q=>({...Q,sendingReminder:new Set([...Q.sendingReminder].filter(M=>M!==le.id))}))}};Y.useEffect(()=>{f!=null&&(b(!0),m?.())},[f,m]);const K=Y.useMemo(()=>{const le=new Date,Q=Cl(le,{weekStartsOn:1}),M=iP(le,{weekStartsOn:1});let V=r.arrangements;return g==="thisWeek"?V=r.arrangements.filter(H=>{const se=la(H.scheduledDate);return sN(se,{start:Q,end:M})&&H.status!=="Completed"&&H.status!=="Cancelled"}):V=r.arrangements.filter(H=>H.status!=="Completed"&&H.status!=="Cancelled"),V.sort((H,se)=>{const D=la(H.scheduledDate).getTime(),P=la(se.scheduledDate).getTime();if(D!==P)return D-P;const I=H.scheduledTime||"00:00",B=se.scheduledTime||"00:00";return I.localeCompare(B)})},[r.arrangements,g]),z=Y.useMemo(()=>{const le=new Map;return K.forEach(Q=>{const M=Q.scheduledDate;le.has(M)||le.set(M,[]),le.get(M).push(Q)}),Array.from(le.entries()).sort((Q,M)=>Q[0].localeCompare(M[0]))},[K]),O=Y.useMemo(()=>{const le=K.length,Q=new Date().toISOString().slice(0,10),M=K.filter(se=>se.scheduledDate===Q).length,V=K.filter(se=>{const D=la(se.scheduledDate);return iN(D)&&se.status==="Scheduled"}).length,H=K.reduce((se,D)=>{if(D.amount&&D.status!=="Completed"){const P=parseFloat(D.amount);return se+(isNaN(P)?0:P)}return se},0);return{total:le,todayCount:M,overdue:V,totalAmountDue:H}},[K]),ne=le=>{switch(le){case"Scheduled":return"";case"Confirmed":return"";case"Completed":return"";case"Cancelled":return"";case"Missed":return""}},ee=le=>{const Q=la(le),M=new Date,V=xm(M,1);return kv(Q,M)?"Today":kv(Q,V)?"Tomorrow":rf(Q,"EEEE, d MMM yyyy")},ve=(le,Q,M=1)=>{const V=new Date(le);switch(Q){case"weekly":V.setDate(V.getDate()+7*M);break;case"biweekly":V.setDate(V.getDate()+14);break;case"monthly":V.setMonth(V.getMonth()+M);break;default:return le}return V.toISOString().slice(0,10)},he=async le=>{const Q=r.arrangements.find(M=>M.id===le);Q&&(n(le,{status:"Completed",updatedAt:new Date().toISOString()}),c(Q.addressIndex,"Done",void 0,Q.id))},ce=async(le,Q)=>{const M=r.arrangements.find(D=>D.id===le);if(!M)return;const V=(M.paymentsMade||0)+1,H=V>=(M.totalPayments||1),se=M.recurrenceType&&M.recurrenceType!=="none";if(n(le,{status:"Completed",amount:Q,paymentsMade:V,updatedAt:new Date().toISOString()}),c(M.addressIndex,"PIF",Q,M.id),se&&!H){const D=ve(M.scheduledDate,M.recurrenceType,M.recurrenceInterval||1),P=V+1,I={addressIndex:M.addressIndex,address:M.address,customerName:M.customerName,phoneNumber:M.phoneNumber,scheduledDate:D,scheduledTime:M.scheduledTime,status:"Scheduled",notes:M.notes?`${M.notes} (Payment ${P}/${M.totalPayments})`:`Payment ${P}/${M.totalPayments}`,amount:M.amount,recurrenceType:M.recurrenceType,recurrenceInterval:M.recurrenceInterval,totalPayments:M.totalPayments,paymentsMade:V,parentArrangementId:M.parentArrangementId||M.id};await t(I)}},Ne=async le=>{C(Q=>({...Q,saving:!0}));try{if(le.addressIndex<0||le.addressIndex>=r.addresses.length)throw new Error("Selected address is no longer valid. Please refresh and try again.");if(le.initialPaymentAmount&&parseFloat(le.initialPaymentAmount)>0){const M=await t(le);if(await new Promise(H=>setTimeout(H,100)),!r.arrangements.find(H=>H.id===M))throw new Error("Arrangement was created but not yet available. Please refresh and mark the payment manually.");await ce(M,le.initialPaymentAmount)}else{await t(le);try{c(le.addressIndex,"ARR")}catch(M){console.error("Error recording ARR completion:",M),alert("Arrangement created successfully, but there was an issue recording the completion. You may need to manually mark this address as ARR.")}}b(!1),S(null)}catch(Q){console.error("Error saving arrangement:",Q),alert(`Failed to save arrangement: ${Q instanceof Error?Q.message:"Please try again."}`)}finally{C(Q=>({...Q,saving:!1}))}},xe=async(le,Q)=>{C(M=>({...M,updating:!0}));try{await n(le,Q),S(null)}catch(M){console.error("Error updating arrangement:",M),alert("Failed to update arrangement. Please try again.")}finally{C(M=>({...M,updating:!1}))}};return u.jsxs("div",{className:"arrangements-wrap",children:[u.jsxs("div",{className:"top-row",children:[u.jsxs("div",{className:"stat-item",children:[u.jsx("div",{className:"stat-label",children:" Due"}),u.jsx("div",{className:"stat-value",children:O.total})]}),u.jsxs("div",{className:"stat-item",children:[u.jsx("div",{className:"stat-label",children:" Today"}),u.jsx("div",{className:"stat-value",style:{color:O.todayCount>0?"var(--warning)":"var(--text-primary)"},children:O.todayCount})]}),O.overdue>0&&u.jsxs("div",{className:"stat-item",children:[u.jsx("div",{className:"stat-label",children:" Overdue"}),u.jsx("div",{className:"stat-value",style:{color:"var(--danger)"},children:O.overdue})]}),O.totalAmountDue>0&&u.jsxs("div",{className:"stat-item",children:[u.jsx("div",{className:"stat-label",children:" Total Due"}),u.jsxs("div",{className:"stat-value",style:{color:"var(--success)"},children:["",O.totalAmountDue.toFixed(2)]})]}),u.jsx("div",{className:"stat-actions",children:u.jsxs("div",{className:"btn-group",children:[u.jsx("button",{className:`btn ${g==="thisWeek"?"btn-primary":"btn-ghost"}`,onClick:()=>x("thisWeek"),children:" This Week"}),u.jsx("button",{className:`btn ${g==="all"?"btn-primary":"btn-ghost"}`,onClick:()=>x("all"),children:" All Pending"}),u.jsx("button",{className:"btn btn-success",onClick:()=>b(!0),children:" Add Arrangement"})]})})]}),(y||E)&&u.jsx(Tm,{state:r,arrangement:E?r.arrangements.find(le=>le.id===E):void 0,preSelectedAddressIndex:f,onAddAddress:l,onSave:E?le=>xe(E,le):Ne,onCancel:()=>{b(!1),S(null)},isLoading:k.saving||k.updating,onComplete:c,fullscreen:!0}),u.jsx("div",{className:"days-list",children:z.length===0?u.jsxs("div",{className:"empty-box",children:[u.jsxs("div",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:[" No payment arrangements ",g==="thisWeek"?"due this week":"pending"]}),u.jsx("div",{style:{fontSize:"0.875rem",opacity:.75},children:g==="thisWeek"?"No payment arrangements are scheduled for this week":"No pending payment arrangements found"})]}):z.map(([le,Q])=>u.jsxs("div",{className:"day-card fade-in-up",children:[u.jsx("div",{className:"day-header",children:u.jsxs("div",{children:[u.jsx("div",{className:"day-title",children:ee(le)}),u.jsxs("div",{className:"muted",children:[Q.length," payment",Q.length===1?"":"s"," due",Q.some(M=>M.amount)&&u.jsxs(u.Fragment,{children:["  ",Q.reduce((M,V)=>{const H=parseFloat(V.amount||"0");return M+(isNaN(H)?0:H)},0).toFixed(2)," total"]})]})]})}),u.jsx("div",{className:"arrangements-list",children:Q.map(M=>u.jsxs("div",{className:"arrangement-card-modern",children:[u.jsxs("div",{className:"arrangement-card-header",children:[u.jsxs("div",{className:"arrangement-primary-info",children:[u.jsxs("div",{className:"arrangement-address-modern",children:[u.jsxs("span",{className:"address-index",children:["#",M.addressIndex+1]}),u.jsx("span",{className:"address-text",children:M.address})]}),M.customerName&&u.jsxs("div",{className:"arrangement-customer-modern",children:[u.jsx("span",{className:"customer-icon",children:""}),u.jsx("span",{className:"customer-name",children:M.customerName})]})]}),u.jsx("div",{className:"arrangement-status-modern",children:u.jsxs("span",{className:`status-badge-modern status-${M.status.toLowerCase()}`,children:[u.jsx("span",{className:"status-icon",children:ne(M.status)}),u.jsx("span",{className:"status-text",children:M.status})]})})]}),u.jsx("div",{className:"arrangement-card-body",children:u.jsxs("div",{className:"arrangement-details-grid",children:[u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:""}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Date"}),u.jsx("span",{className:"detail-value",children:M.scheduledDate})]})]}),M.scheduledTime&&u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:""}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Time"}),u.jsx("span",{className:"detail-value",children:M.scheduledTime})]})]}),M.amount&&u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:""}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Amount"}),u.jsxs("span",{className:"detail-value amount-value",children:["",M.amount]})]})]}),M.phoneNumber&&u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:""}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Phone"}),u.jsx("a",{href:`tel:${M.phoneNumber}`,className:"detail-value phone-link",children:M.phoneNumber})]})]}),M.notes&&u.jsxs("div",{className:"detail-item detail-notes",children:[u.jsx("span",{className:"detail-icon",children:""}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Notes"}),u.jsx("span",{className:"detail-value",children:M.notes})]})]}),M.recurrenceType&&M.recurrenceType!=="none"&&u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:""}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Recurrence"}),u.jsxs("span",{className:"detail-value",children:[M.recurrenceType==="weekly"?"Weekly":M.recurrenceType==="biweekly"?"Bi-weekly":M.recurrenceType==="monthly"?"Monthly":M.recurrenceType,M.recurrenceInterval&&M.recurrenceInterval>1&&M.recurrenceType!=="biweekly"&&` (every ${M.recurrenceInterval})`,u.jsxs("div",{className:"recurrence-progress",children:["Payment ",(M.paymentsMade||0)+1," of ",M.totalPayments||1]})]})]})]})]})}),u.jsxs("div",{className:"arrangement-actions",children:[M.status==="Scheduled"&&(!M.recurrenceType||M.recurrenceType==="none"||M.paymentsMade&&M.totalPayments&&M.paymentsMade>=M.totalPayments-1)&&u.jsx(Ti,{className:"btn btn-sm btn-success",isLoading:k.markingPaid.has(M.id),loadingText:"Processing...",onClick:async()=>{const V=window.prompt(`Payment received:

Expected: ${M.amount||"0.00"}
Enter actual amount received:`,M.amount||"");if(V!==null&&V.trim()){C(H=>({...H,markingPaid:new Set([...H.markingPaid,M.id])}));try{await ce(M.id,V.trim())}finally{C(H=>({...H,markingPaid:new Set([...H.markingPaid].filter(se=>se!==M.id))}))}}},children:" Confirm Payment"}),(M.status==="Scheduled"||M.status==="Confirmed")&&u.jsxs(u.Fragment,{children:[M.phoneNumber&&u.jsxs("div",{style:{position:"relative"},children:[u.jsx(Ti,{className:"btn btn-sm btn-primary",isLoading:k.sendingReminder.has(M.id),loadingText:"Opening...",onClick:()=>F(M),title:`Send SMS reminder to ${M.phoneNumber}`,children:" Send SMS"}),R.has(M.id)&&u.jsx("div",{className:"reminder-confirmation",style:{position:"absolute",top:"-35px",left:"0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"nowrap",zIndex:1e3,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:" SMS opened!"}),M.reminderCount&&M.reminderCount>0&&u.jsxs("div",{className:"reminder-history",children:[M.reminderCount," SMS reminder",M.reminderCount>1?"s":""," sent",M.lastReminderSent&&u.jsxs("span",{children:["  Last: ",rf(la(M.lastReminderSent),"MMM d, HH:mm")]})]})]}),M.recurrenceType&&M.recurrenceType!=="none"&&(!M.paymentsMade||!M.totalPayments||M.paymentsMade<M.totalPayments-1)&&u.jsx(Ti,{className:"btn btn-sm btn-success",isLoading:k.markingPaid.has(M.id),loadingText:"Processing...",onClick:async()=>{const V=window.prompt(`Continue with payment plan:

Expected: ${M.amount||"0.00"}
Enter actual amount received:`,M.amount||"");if(V!==null&&V.trim()){C(H=>({...H,markingPaid:new Set([...H.markingPaid,M.id])}));try{await ce(M.id,V.trim())}finally{C(H=>({...H,markingPaid:new Set([...H.markingPaid].filter(se=>se!==M.id))}))}}},children:" Continue Plan"}),u.jsx(Ti,{className:"btn btn-sm btn-warning",isLoading:k.markingDefaulted.has(M.id),loadingText:"Processing...",onClick:async()=>{if(confirm("Mark this arrangement as defaulted? This will complete the case as 'Done (Defaulted Arrangement)'.")){C(V=>({...V,markingDefaulted:new Set([...V.markingDefaulted,M.id])}));try{await he(M.id)}finally{C(V=>({...V,markingDefaulted:new Set([...V.markingDefaulted].filter(H=>H!==M.id))}))}}},children:" Defaulted"})]}),u.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>S(M.id),disabled:k.updating||k.saving,children:" Edit"}),u.jsx(Ti,{className:"btn btn-sm btn-danger",isLoading:k.deleting.has(M.id),loadingText:"Deleting...",onClick:async()=>{if(confirm("Are you sure you want to delete this arrangement?")){C(V=>({...V,deleting:new Set([...V.deleting,M.id])}));try{await a(M.id)}finally{C(V=>({...V,deleting:new Set([...V.deleting].filter(H=>H!==M.id))}))}}},children:" Delete"})]})]},M.id))})]},le))}),u.jsx("style",{children:`
        .arrangement-card-modern {
          background: linear-gradient(135deg, white 0%, var(--gray-50) 100%);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          padding: 1.5rem;
          margin-bottom: 1rem;
          box-shadow: var(--shadow-sm);
          transition: all 0.2s ease;
          position: relative;
          overflow: hidden;
        }

        .arrangement-card-modern:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
          border-color: var(--primary-light);
        }

        .arrangement-card-modern::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 3px;
          background: linear-gradient(90deg, var(--primary) 0%, var(--success) 100%);
        }

        .arrangement-card-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1.25rem;
          gap: 1rem;
        }

        .arrangement-primary-info {
          flex: 1;
        }

        .arrangement-address-modern {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          margin-bottom: 0.5rem;
        }

        .address-index {
          background: var(--primary);
          color: white;
          font-size: 0.75rem;
          font-weight: 600;
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          min-width: 2rem;
          text-align: center;
        }

        .address-text {
          font-weight: 600;
          font-size: 1.1rem;
          color: var(--text-primary);
          line-height: 1.2;
        }

        .arrangement-customer-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.9rem;
          color: var(--text-secondary);
        }

        .customer-icon {
          font-size: 1rem;
        }

        .customer-name {
          font-weight: 500;
        }

        .arrangement-status-modern {
          flex-shrink: 0;
        }

        .status-badge-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          border-radius: var(--radius-full);
          font-size: 0.875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          transition: all 0.2s ease;
        }

        .status-badge-modern.status-scheduled {
          background: linear-gradient(135deg, var(--blue-50) 0%, var(--blue-25) 100%);
          color: var(--blue-700);
          border: 1px solid var(--blue-200);
        }

        .status-badge-modern.status-confirmed {
          background: linear-gradient(135deg, var(--success-light) 0%, var(--success-lighter) 100%);
          color: var(--success-dark);
          border: 1px solid var(--success-border);
        }

        .status-badge-modern.status-completed {
          background: linear-gradient(135deg, var(--green-50) 0%, var(--green-25) 100%);
          color: var(--green-700);
          border: 1px solid var(--green-200);
        }

        .status-badge-modern.status-cancelled {
          background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-25) 100%);
          color: var(--gray-700);
          border: 1px solid var(--gray-200);
        }

        .status-badge-modern.status-missed {
          background: linear-gradient(135deg, var(--danger-light) 0%, var(--danger-lighter) 100%);
          color: var(--danger-dark);
          border: 1px solid var(--danger-border);
        }

        .status-icon {
          font-size: 0.875rem;
        }

        .arrangement-card-body {
          margin-bottom: 1.25rem;
        }

        .arrangement-details-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          padding: 0.75rem;
          background: var(--gray-25);
          border-radius: var(--radius-md);
          transition: all 0.2s ease;
        }

        .detail-item:hover {
          background: var(--gray-50);
        }

        .detail-notes {
          grid-column: 1 / -1;
        }

        /* Dark mode styles for arrangements */
        .dark-mode .arrangement-card-modern {
          background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-card-modern:hover {
          border-color: var(--primary);
          background: linear-gradient(135deg, var(--gray-200) 0%, var(--gray-300) 100%);
        }

        .dark-mode .address-text {
          color: var(--gray-800);
        }

        .dark-mode .customer-name {
          color: var(--gray-600);
        }

        .dark-mode .detail-item {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .detail-item:hover {
          background: var(--gray-300);
        }

        .dark-mode .detail-label {
          color: var(--gray-500);
        }

        .dark-mode .detail-value {
          color: var(--gray-800);
        }

        .dark-mode .phone-link {
          color: var(--primary) !important;
        }

        .dark-mode .recurrence-progress {
          color: var(--gray-500);
        }

        .dark-mode .reminder-confirmation {
          background: var(--gray-200) !important;
          color: var(--gray-800) !important;
        }

        .dark-mode .reminder-history {
          color: var(--gray-600) !important;
        }

        /* Basic card and form styles */
        .card {
          background: white;
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          overflow: hidden;
        }

        .card-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
          background: var(--gray-50);
        }

        .card-body {
          padding: 1.5rem;
        }

        .form-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 1rem;
        }

        .form-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .form-group-full {
          grid-column: 1 / -1;
        }

        .form-group label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .btn-row {
          display: flex;
          gap: 0.75rem;
          align-items: center;
          flex-wrap: wrap;
        }

        .btn-row-end {
          justify-content: flex-end;
        }

        .arrangements-wrap {
          max-width: none;
          width: 100%;
        }

        .top-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          margin-bottom: 2rem;
          flex-wrap: wrap;
        }

        .stat-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 0.75rem 1rem;
          background: white;
          border-radius: var(--radius-md);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          min-width: 80px;
        }

        .stat-label {
          font-size: 0.75rem;
          color: var(--gray-600);
          margin-bottom: 0.25rem;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--gray-800);
        }

        .stat-actions {
          display: flex;
          gap: 1rem;
          align-items: center;
        }

        .days-list {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .day-card {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          overflow: hidden;
        }

        .day-header {
          padding: 1.5rem;
          background: var(--gray-50);
          border-bottom: 1px solid var(--gray-200);
        }

        .day-title {
          font-size: 1.125rem;
          font-weight: 700;
          color: var(--gray-800);
          margin-bottom: 0.25rem;
        }

        .muted {
          font-size: 0.875rem;
          color: var(--gray-500);
        }

        .arrangements-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          padding: 1.5rem;
        }

        .empty-box {
          padding: 3rem;
          text-align: center;
          background: white;
          border-radius: var(--radius-lg);
          border: 2px dashed var(--gray-300);
          color: var(--gray-500);
        }

        .fade-in-up {
          animation: fadeInUp 0.3s ease-out;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        /* Dark mode for basic elements */
        .dark-mode .card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .card-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .form-group label {
          color: var(--gray-700);
        }

        .dark-mode .stat-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .stat-label {
          color: var(--gray-500);
        }

        .dark-mode .stat-value {
          color: var(--gray-800);
        }

        .dark-mode .day-card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .day-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .day-title {
          color: var(--gray-800);
        }

        .dark-mode .muted {
          color: var(--gray-500);
        }

        .dark-mode .empty-box {
          background: var(--gray-100);
          border-color: var(--gray-400);
          color: var(--gray-500);
        }

        /* Dark mode button styles */
        .dark-mode .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        /* Dark mode arrangement actions */
        .dark-mode .arrangement-actions .btn {
          background: var(--gray-200);
          color: var(--gray-700);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-actions .btn:hover {
          background: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .arrangement-actions .btn-success {
          background: var(--success);
          color: white;
          border-color: var(--success);
        }

        .dark-mode .arrangement-actions .btn-success:hover {
          background: var(--success-dark);
          border-color: var(--success-dark);
        }

        .dark-mode .arrangement-actions .btn-primary {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }

        .dark-mode .arrangement-actions .btn-primary:hover {
          background: var(--primary-hover);
          border-color: var(--primary-hover);
        }

        .dark-mode .arrangement-actions .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .arrangement-actions .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .arrangement-actions .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .arrangement-actions .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        .dark-mode .arrangement-actions .btn-ghost {
          background: transparent;
          color: var(--gray-600);
          border-color: var(--gray-400);
        }

        .dark-mode .arrangement-actions .btn-ghost:hover {
          background: var(--gray-200);
          color: var(--gray-800);
        }

        .detail-icon {
          font-size: 1.1rem;
          flex-shrink: 0;
          margin-top: 0.125rem;
        }

        .detail-content {
          flex: 1;
          min-width: 0;
        }

        .detail-label {
          display: block;
          font-size: 0.75rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
          margin-bottom: 0.25rem;
        }

        .detail-value {
          display: block;
          font-size: 0.9rem;
          color: var(--text-primary);
          font-weight: 500;
          word-break: break-word;
        }

        .amount-value {
          color: var(--success-dark);
          font-weight: 700;
          font-size: 1rem;
        }

        .phone-link {
          color: var(--primary) !important;
          text-decoration: none;
          transition: color 0.2s ease;
        }

        .phone-link:hover {
          color: var(--primary-dark) !important;
          text-decoration: underline;
        }

        .recurrence-progress {
          font-size: 0.8rem;
          color: var(--text-secondary);
          margin-top: 0.25rem;
          font-weight: 400;
        }

        .arrangement-actions {
          display: flex;
          gap: 0.75rem;
          flex-wrap: wrap;
          align-items: center;
          margin-top: 1.5rem;
          padding-top: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .dark-mode .arrangement-actions {
          border-top-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .arrangement-card-header {
            flex-direction: column;
            align-items: stretch;
          }

          .arrangement-details-grid {
            grid-template-columns: 1fr;
          }

          .detail-notes {
            grid-column: 1;
          }
        }
      `})]})},I5=Y.memo(D5);async function O5(e){const r=await e.text();return JSON.parse(r)}function j5({onAdd:e,inline:r}){const[t,n]=Y.useState(!1),[a,l]=Y.useState(""),[c,f]=Y.useState(""),[m,g]=Y.useState(""),[x,y]=Y.useState(!1),b=Y.useRef(!1),[E,S]=Y.useState(null),k=()=>{l(""),f(""),g(""),S(null)},C=async j=>{if(j?.preventDefault(),b.current)return;S(null);const N=a.trim();if(!N)return S("Address is required.");let F=null,K=null;if(c.trim()){const z=Number(c);if(Number.isNaN(z))return S("Latitude must be a number.");F=z}if(m.trim()){const z=Number(m);if(Number.isNaN(z))return S("Longitude must be a number.");K=z}b.current=!0,y(!0);try{await e({address:N,lat:F,lng:K}),k(),n(!1)}catch(z){S(z?.message||String(z))}finally{b.current=!1,y(!1)}},R=r?u.jsx("button",{type:"button",className:"btn",onClick:()=>n(!0),children:"+ Add address"}):u.jsx("button",{type:"button",onClick:()=>n(!0),"aria-label":"Add address",style:F5,className:"fab-add-address",children:"+"});return u.jsxs(u.Fragment,{children:[R,t&&Iy.createPortal(u.jsx("div",{style:L5,role:"dialog","aria-modal":"true",children:u.jsxs("div",{style:R5,children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("h3",{style:{margin:0},children:"Add Address"}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>{k(),n(!1)},disabled:x,"aria-label":"Close",children:""})]}),u.jsxs("form",{onSubmit:C,style:{marginTop:"0.5rem"},children:[u.jsx("label",{className:"label",htmlFor:"manual-address",children:"Address *"}),u.jsx("textarea",{id:"manual-address",value:a,onChange:j=>l(j.target.value),className:"input",rows:3,placeholder:"e.g. 10 Example St, City, POSTCODE",required:!0}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[u.jsxs("div",{style:{flex:1},children:[u.jsx("label",{className:"label",htmlFor:"manual-lat",children:"Lat (optional)"}),u.jsx("input",{id:"manual-lat",type:"text",inputMode:"decimal",value:c,onChange:j=>f(j.target.value),className:"input",placeholder:"51.5034"})]}),u.jsxs("div",{style:{flex:1},children:[u.jsx("label",{className:"label",htmlFor:"manual-lng",children:"Lng (optional)"}),u.jsx("input",{id:"manual-lng",type:"text",inputMode:"decimal",value:m,onChange:j=>g(j.target.value),className:"input",placeholder:"-0.1276"})]})]}),E&&u.jsx("div",{style:{color:"var(--danger)",fontSize:"0.875rem",marginTop:"0.5rem"},children:E}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem",justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>{k(),n(!1)},disabled:x,children:"Cancel"}),u.jsx("button",{type:"submit",className:"btn",disabled:x,children:x?"Adding...":"Add"})]})]})]})}),document.body)]})}const F5={position:"fixed",right:16,bottom:"calc(16px + env(safe-area-inset-bottom, 0))",width:56,height:56,borderRadius:"50%",border:"none",background:"var(--primary)",color:"#fff",fontSize:28,lineHeight:"56px",textAlign:"center",boxShadow:"0 6px 18px rgba(0,0,0,0.18)",cursor:"pointer",zIndex:4e3},L5={position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:12,zIndex:4100},R5={width:"100%",maxWidth:520,background:"var(--surface)",borderRadius:14,padding:14,border:"1px solid var(--border-light)",boxShadow:"var(--shadow-lg)"},M5=[{id:"enforcement_pro",name:"Enforcement Pro",price:2500,currency:"GBP",features:["Route optimization for 30+ addresses","Commission tracking & reporting","Payment arrangements with SMS reminders","Daily/weekly earnings reports","Unlimited cloud sync & backup","Priority customer support"],trialDays:14}];function B5(e){const r=new Date(e),t=new Date,n=r.getTime()-t.getTime();return Math.ceil(n/(1e3*60*60*24))}function z5(e){if(!e)return!1;const r=new Date,t=new Date(e.currentPeriodEnd);return(e.status==="active"||e.status==="trial")&&t>r}function U5(e){return e?e.status==="trial":!1}function $5(e){if(!e)return!0;const r=new Date,t=new Date(e.currentPeriodEnd);return e.status==="expired"||e.status==="cancelled"||t<=r}function Cm(e){const[r,t]=Y.useState(null),[n]=Y.useState(M5),[a,l]=Y.useState(!0),[c,f]=Y.useState(null),[m,g]=Y.useState(!1),[x,y]=Y.useState(!1),b=Y.useCallback(()=>f(null),[]);Y.useEffect(()=>{(async()=>{if(!e||!Be){g(!1);return}try{const{data:ne}=await Be.rpc("is_owner",{user_uuid:e.id});g(ne||!1)}catch{g(!1)}})()},[e]);const E=z5(r),S=U5(r),k=$5(r),C=r?B5(r.currentPeriodEnd):0,R=m||E&&!k||x,j=Y.useCallback(async()=>{if(!e||!Be){t(null),l(!1);return}try{l(!0),b();const{data:O,error:ne}=await Be.from("user_subscriptions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).maybeSingle();if(ne)throw ne;const ee=O?{id:O.id,userId:O.user_id,planId:O.plan_id,status:O.status,currentPeriodStart:O.current_period_start,currentPeriodEnd:O.current_period_end,trialStart:O.trial_start||void 0,trialEnd:O.trial_end||void 0,cancelledAt:O.cancelled_at||void 0,createdAt:O.created_at,updatedAt:O.updated_at,lastPaymentAt:O.last_payment_at||void 0,nextPaymentDue:O.next_payment_due||void 0}:null;t(ee)}catch(O){be.error("Failed to load subscription:",O),f(O?.message||"Failed to load subscription"),t(null)}finally{l(!1)}},[e,b]),N=Y.useCallback(async()=>{if(!Be){y(!1);return}try{const O=localStorage.getItem("navigator_trial_created"),ne=localStorage.getItem("navigator_trial_user_id");if(!O||!ne){y(!1);return}const ee=parseInt(O);if((Date.now()-ee)/(1e3*60*60)>25){console.log("Trial too old, clearing localStorage"),localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"),y(!1);return}const{data:he,error:ce}=await Be.rpc("check_trial_access",{target_user_id:ne});if(ce){console.warn("Server trial access check failed:",ce),y(!1);return}console.log("Server trial access result:",he),y(he?.hasAccess||!1),he?.hasAccess||(localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"))}catch(O){console.warn("Server trial access check error:",O),y(!1)}},[]);Y.useEffect(()=>{e?j():(t(null),l(!1)),N()},[e,j,N]);const F=Y.useCallback(async()=>{if(!e||!Be)throw new Error("User not authenticated");if(r)throw new Error("User already has a subscription");try{b(),l(!0);const O=n[0],ne=new Date,ee=new Date(ne);ee.setDate(ee.getDate()+O.trialDays);const ve={user_id:e.id,plan_id:O.id,status:"trial",current_period_start:ne.toISOString(),current_period_end:ee.toISOString(),trial_start:ne.toISOString(),trial_end:ee.toISOString(),created_at:ne.toISOString(),updated_at:ne.toISOString()},{error:he}=await Be.from("user_subscriptions").insert(ve);if(he)throw he;await j(),be.info("Trial started successfully")}catch(O){throw be.error("Failed to start trial:",O),f(O?.message||"Failed to start trial"),O}finally{l(!1)}},[e,r,n,b,j]),K=Y.useCallback(async O=>{if(!e||!Be)throw new Error("User not authenticated");if(!n.find(ee=>ee.id===O))throw new Error("Invalid plan selected");try{b(),l(!0);const ee=new Date,ve=new Date(ee);ve.setMonth(ve.getMonth()+1);const he=r?{status:"active",plan_id:O,current_period_start:ee.toISOString(),current_period_end:ve.toISOString(),last_payment_at:ee.toISOString(),next_payment_due:ve.toISOString(),updated_at:ee.toISOString()}:{user_id:e.id,plan_id:O,status:"active",current_period_start:ee.toISOString(),current_period_end:ve.toISOString(),last_payment_at:ee.toISOString(),next_payment_due:ve.toISOString(),created_at:ee.toISOString(),updated_at:ee.toISOString()};if(r){const{error:ce}=await Be.from("user_subscriptions").update(he).eq("id",r.id);if(ce)throw ce}else{const{error:ce}=await Be.from("user_subscriptions").insert(he);if(ce)throw ce}await j(),be.info("Subscription activated successfully")}catch(ee){throw be.error("Failed to subscribe:",ee),f(ee?.message||"Failed to subscribe"),ee}finally{l(!1)}},[e,r,n,b,j]),z=Y.useCallback(async()=>{if(!e||!Be||!r)throw new Error("No active subscription to cancel");try{b(),l(!0);const O=new Date,ne={status:"cancelled",cancelled_at:O.toISOString(),updated_at:O.toISOString()},{error:ee}=await Be.from("user_subscriptions").update(ne).eq("id",r.id);if(ee)throw ee;await j(),be.info("Subscription cancelled successfully")}catch(O){throw be.error("Failed to cancel subscription:",O),f(O?.message||"Failed to cancel subscription"),O}finally{l(!1)}},[e,r,b,j]);return{subscription:r,availablePlans:n,isLoading:a,error:c,isActive:E,isTrial:S,isExpired:k,daysRemaining:C,hasAccess:R,startTrial:F,subscribe:K,cancelSubscription:z,refreshSubscription:j,clearError:b}}function Hy(e){const[r,t]=Y.useState(!1),[n,a]=Y.useState(!1),[l,c]=Y.useState(null),[f,m]=Y.useState(!0),[g,x]=Y.useState(null),y=Y.useCallback(()=>x(null),[]),b=Y.useCallback(async()=>{if(!e||!Be){t(!1),a(!1),c(null),m(!1);return}try{m(!0),y();const{data:E,error:S}=await Be.rpc("is_admin",{user_uuid:e.id});if(S){t(!1),a(!1),c(null),m(!1);return}if(t(E||!1),E){const{data:k,error:C}=await Be.rpc("is_owner",{user_uuid:e.id});C?console.warn("Failed to check owner status:",C):a(k||!1);const{data:R,error:j}=await Be.from("admin_users").select("*").eq("user_id",e.id).single();j?console.warn("Failed to fetch admin user details:",j):c(R)}else a(!1),c(null)}catch(E){console.log("Admin check failed:",E.message),t(!1),a(!1),c(null)}finally{m(!1)}},[e,y]);return Y.useEffect(()=>{b()},[b]),{isAdmin:r,isOwner:n,adminUser:l,isLoading:f,error:g,refreshAdmin:b,clearError:y}}function W5(e,r){const t=e/100;return new Intl.NumberFormat("en-GB",{style:"currency",currency:r,minimumFractionDigits:0,maximumFractionDigits:2}).format(t)}function Bd(e){return new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})}function V5({user:e,onClose:r}){const{subscription:t,availablePlans:n,isLoading:a,error:l,isActive:c,isTrial:f,isExpired:m,daysRemaining:g,hasAccess:x,startTrial:y,subscribe:b,cancelSubscription:E,clearError:S}=Cm(e),{isOwner:k}=Hy(e),[C,R]=Y.useState(null),j=async()=>{try{R("trial"),await y()}catch{}finally{R(null)}},N=async K=>{try{R(`subscribe-${K}`),await b(K)}catch{}finally{R(null)}},F=async()=>{if(confirm("Are you sure you want to cancel your subscription? You will lose access at the end of your current billing period."))try{R("cancel"),await E()}catch{}finally{R(null)}};return a?u.jsx("div",{className:"subscription-manager",children:u.jsxs("div",{className:"subscription-loading",children:[u.jsx("div",{className:"spinner"}),u.jsx("p",{children:"Loading subscription..."})]})}):k?u.jsxs("div",{className:"subscription-manager",children:[u.jsxs("div",{className:"subscription-header",children:[u.jsx("h2",{children:"Owner Access"}),r&&u.jsx("button",{className:"close-button",onClick:r,"aria-label":"Close",children:""})]}),u.jsx("div",{className:"owner-status",children:u.jsxs("div",{className:"owner-card",children:[u.jsx("div",{className:"owner-badge",children:" OWNER"}),u.jsx("h3",{children:"Unlimited Access"}),u.jsx("p",{children:"As the owner, you have unrestricted access to all premium features:"}),u.jsx("div",{className:"owner-features",children:u.jsxs("ul",{children:[u.jsx("li",{children:" Route optimization for unlimited addresses"}),u.jsx("li",{children:" Commission tracking & reporting"}),u.jsx("li",{children:" Payment arrangements with SMS reminders"}),u.jsx("li",{children:" Daily/weekly earnings reports"}),u.jsx("li",{children:" Unlimited cloud sync & backup"}),u.jsx("li",{children:" Admin dashboard and user management"}),u.jsx("li",{children:" Priority customer support tools"})]})}),u.jsxs("div",{className:"owner-info",children:[u.jsx("h4",{children:"Business Status"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Plan:"})," Owner Access (No subscription required)"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Status:"})," ",u.jsx("span",{className:"status-active",children:"Active"})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Billing:"})," N/A - Owner account"]})]}),u.jsxs("div",{className:"owner-actions",children:[u.jsx("p",{children:u.jsx("strong",{children:"Need to manage customer subscriptions?"})}),u.jsx("button",{className:"btn-secondary",onClick:r,style:{marginRight:"8px"},children:"Close"}),u.jsx("button",{className:"btn-primary",onClick:()=>{console.log("Redirect to admin dashboard"),r&&r()},children:"Go to Admin Dashboard"})]})]})})]}):u.jsxs("div",{className:"subscription-manager",children:[u.jsxs("div",{className:"subscription-header",children:[u.jsx("h2",{children:"Subscription Management"}),r&&u.jsx("button",{className:"close-button",onClick:r,"aria-label":"Close",children:""})]}),l&&u.jsxs("div",{className:"error-banner",children:[u.jsx("p",{children:l}),u.jsx("button",{onClick:S,children:"Dismiss"})]}),t?u.jsxs("div",{className:"current-subscription",children:[u.jsx("h3",{children:"Current Subscription"}),u.jsxs("div",{className:"subscription-card",children:[u.jsxs("div",{className:"subscription-info",children:[u.jsx("div",{className:"plan-name",children:n.find(K=>K.id===t.planId)?.name||"Unknown Plan"}),u.jsxs("div",{className:"subscription-status",children:[u.jsx("span",{className:`status-badge ${t.status}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),f&&u.jsx("span",{className:"trial-badge",children:g>0?`${g} days remaining`:"Trial expired"})]})]}),u.jsxs("div",{className:"subscription-details",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Current Period:"})," ",Bd(t.currentPeriodStart)," - ",Bd(t.currentPeriodEnd)]}),t.nextPaymentDue&&c&&!f&&u.jsxs("p",{children:[u.jsx("strong",{children:"Next Payment:"})," ",Bd(t.nextPaymentDue)]}),t.cancelledAt&&u.jsxs("p",{children:[u.jsx("strong",{children:"Cancelled:"})," ",Bd(t.cancelledAt)]})]}),x&&u.jsxs("div",{className:"subscription-features",children:[u.jsx("h4",{children:"Your Features:"}),u.jsx("ul",{children:n.find(K=>K.id===t.planId)?.features.map((K,z)=>u.jsxs("li",{children:[" ",K]},z))})]}),u.jsxs("div",{className:"subscription-actions",children:[f&&g>0&&u.jsx("button",{className:"btn-primary",onClick:()=>N(t.planId),disabled:C!==null,children:C===`subscribe-${t.planId}`?"Processing...":"Upgrade to Paid"}),c&&!f&&u.jsx("button",{className:"btn-secondary",onClick:F,disabled:C!==null,children:C==="cancel"?"Processing...":"Cancel Subscription"})]})]})]}):u.jsxs("div",{className:"available-plans",children:[u.jsx("h3",{children:"Choose Your Plan"}),u.jsx("p",{className:"plans-intro",children:"Transform your enforcement work with our unified platform. Replace multiple expensive apps with one powerful solution."}),n.map(K=>u.jsxs("div",{className:"plan-card featured",children:[u.jsxs("div",{className:"plan-header",children:[u.jsx("h4",{children:K.name}),u.jsxs("div",{className:"plan-price",children:[u.jsx("span",{className:"price",children:W5(K.price,K.currency)}),u.jsx("span",{className:"period",children:"/month"})]})]}),u.jsx("div",{className:"plan-features",children:u.jsx("ul",{children:K.features.map((z,O)=>u.jsxs("li",{children:[" ",z]},O))})}),u.jsxs("div",{className:"plan-actions",children:[u.jsx("button",{className:"btn-primary full-width",onClick:j,disabled:C!==null,children:C==="trial"?"Starting Trial...":`Start ${K.trialDays}-Day Free Trial`}),u.jsx("p",{className:"trial-note",children:"No payment required  Cancel anytime  Full access during trial"})]})]},K.id)),u.jsxs("div",{className:"value-proposition",children:[u.jsx("h4",{children:"Why Enforcement Pro?"}),u.jsxs("div",{className:"comparison",children:[u.jsxs("div",{className:"comparison-item",children:[u.jsx("span",{className:"old-cost",children:"Route Planning App: 20-30/month"}),u.jsx("span",{className:"new-cost",children:" Included"})]}),u.jsxs("div",{className:"comparison-item",children:[u.jsx("span",{className:"old-cost",children:"SMS Service: 10-15/month"}),u.jsx("span",{className:"new-cost",children:" Included"})]}),u.jsxs("div",{className:"comparison-item",children:[u.jsx("span",{className:"old-cost",children:"Basic Tracking: 10-20/month"}),u.jsx("span",{className:"new-cost",children:" Included"})]}),u.jsx("div",{className:"total-savings",children:u.jsx("strong",{children:"Total Monthly Savings: 15-40"})})]})]})]}),m&&u.jsxs("div",{className:"access-warning",children:[u.jsx("h4",{children:" Subscription Expired"}),u.jsx("p",{children:"Your subscription has expired. Please renew to continue using premium features."}),u.jsx("button",{className:"btn-primary",onClick:()=>n[0]&&N(n[0].id),disabled:C!==null,children:"Renew Subscription"})]})]})}const H5=`
.subscription-manager {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  color: var(--text-color, #000);
}

.subscription-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  border-bottom: 1px solid var(--border-color, #e1e5e9);
  padding-bottom: 16px;
}

.subscription-header h2 {
  color: var(--text-color, #000);
  margin: 0;
}

.close-button {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  color: var(--text-color, #000);
}

.close-button:hover {
  background-color: var(--hover-bg, #f5f5f5);
}

.dark-mode .close-button:hover {
  background-color: var(--dark-hover-bg, #333);
}

.subscription-loading {
  text-align: center;
  padding: 40px;
  color: var(--text-color, #000);
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid var(--border-color, #f3f3f3);
  border-top: 4px solid #007bff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.error-banner {
  background-color: var(--error-bg, #fee);
  border: 1px solid var(--error-border, #fcc);
  border-radius: 4px;
  padding: 12px;
  margin-bottom: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: var(--error-text, #721c24);
}

.dark-mode .error-banner {
  background-color: var(--dark-error-bg, #4a1a1a);
  border-color: var(--dark-error-border, #8b2635);
  color: var(--dark-error-text, #ff6b6b);
}

.current-subscription, .available-plans {
  margin-bottom: 24px;
}

.current-subscription h3, .available-plans h3 {
  color: var(--text-color, #000);
  margin-bottom: 16px;
}

.subscription-card, .plan-card {
  border: 1px solid var(--border-color, #e1e5e9);
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 16px;
  background-color: var(--card-bg, #fff);
  color: var(--text-color, #000);
}

.dark-mode .subscription-card,
.dark-mode .plan-card {
  background-color: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.plan-card.featured {
  border-color: #007bff;
  position: relative;
  margin-top: 16px;
}

.plan-card.featured::before {
  content: 'Most Popular';
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  background: #007bff;
  color: white;
  padding: 6px 16px;
  font-size: 12px;
  font-weight: 600;
  border-radius: 16px;
  white-space: nowrap;
}

.status-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  text-transform: uppercase;
}

.status-badge.active { background: #d4edda; color: #155724; }
.status-badge.trial { background: #fff3cd; color: #856404; }
.status-badge.expired { background: #f8d7da; color: #721c24; }
.status-badge.cancelled { background: #e2e3e5; color: #6c757d; }

.trial-badge {
  margin-left: 8px;
  padding: 4px 8px;
  background: #e3f2fd;
  color: #1976d2;
  border-radius: 4px;
  font-size: 12px;
}

.dark-mode .trial-badge {
  background: var(--dark-secondary-bg, #2a4a5c);
  color: var(--dark-secondary-text, #87ceeb);
  border: 1px solid var(--dark-border-color, #444);
}

.plan-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 16px;
}

.plan-header h4 {
  color: var(--text-color, #000);
  margin: 0;
}

.plan-price .price {
  font-size: 24px;
  font-weight: bold;
  color: #007bff;
}

.plan-price .period {
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
}

.dark-mode .plan-price .period {
  color: var(--dark-secondary-text, #aaa);
}

.plan-features ul {
  list-style: none;
  padding: 0;
  margin: 16px 0;
}

.plan-features li {
  padding: 4px 0;
  color: #28a745;
}

.subscription-info .plan-name {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-color, #000);
  margin-bottom: 8px;
}

.subscription-details {
  margin: 16px 0;
  color: var(--text-color, #000);
}

.subscription-details p {
  margin: 8px 0;
  color: var(--text-color, #000);
}

.subscription-details strong {
  color: var(--text-color, #000);
}

.subscription-features h4 {
  color: var(--text-color, #000);
  margin: 16px 0 8px 0;
}

.subscription-actions, .plan-actions {
  margin-top: 20px;
}

.btn-primary, .btn-secondary {
  padding: 10px 20px;
  border-radius: 6px;
  border: none;
  font-weight: 500;
  cursor: pointer;
  margin-right: 8px;
  transition: background-color 0.2s;
}

.btn-primary {
  background: #007bff;
  color: white;
}

.btn-primary:hover:not(:disabled) {
  background: #0056b3;
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover:not(:disabled) {
  background: #545b62;
}

.btn-primary:disabled, .btn-secondary:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.full-width {
  width: 100%;
  margin-right: 0;
}

.trial-note {
  text-align: center;
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
  margin-top: 8px;
}

.dark-mode .trial-note {
  color: var(--dark-secondary-text, #aaa);
}

.comparison {
  background: var(--secondary-bg, #f8f9fa);
  padding: 16px;
  border-radius: 6px;
  margin-top: 12px;
  color: var(--text-color, #000);
}

.dark-mode .comparison {
  background: var(--dark-secondary-bg, #333);
}

.comparison-item {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
}

.old-cost {
  color: var(--secondary-text, #6c757d);
  text-decoration: line-through;
}

.dark-mode .old-cost {
  color: var(--dark-secondary-text, #aaa);
}

.new-cost {
  color: #28a745;
  font-weight: 500;
}

.total-savings {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--border-color, #dee2e6);
  text-align: center;
  color: #007bff;
}

.dark-mode .total-savings {
  border-top-color: var(--dark-border-color, #555);
}

.access-warning {
  background: var(--warning-bg, #fff3cd);
  border: 1px solid var(--warning-border, #ffeaa7);
  border-radius: 6px;
  padding: 16px;
  text-align: center;
  color: var(--warning-text, #856404);
}

.dark-mode .access-warning {
  background: var(--dark-warning-bg, #4a3c1a);
  border-color: var(--dark-warning-border, #8b7355);
  color: var(--dark-warning-text, #ffc107);
}

.access-warning h4 {
  color: var(--warning-text, #856404);
  margin: 0 0 8px 0;
}

.dark-mode .access-warning h4 {
  color: var(--dark-warning-text, #ffc107);
}

.value-proposition h4 {
  color: var(--text-color, #000);
  margin: 16px 0 12px 0;
}

.plans-intro {
  color: var(--text-color, #000);
  margin-bottom: 20px;
}

.owner-status {
  margin-bottom: 24px;
}

.owner-card {
  border: 2px solid #28a745;
  border-radius: 12px;
  padding: 24px;
  background: linear-gradient(135deg, #f8fff9 0%, #e8f5e8 100%);
  text-align: center;
}

.owner-badge {
  display: inline-block;
  background: #28a745;
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 16px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.owner-features {
  margin: 20px 0;
  text-align: left;
}

.owner-features ul {
  list-style: none;
  padding: 0;
  max-width: 400px;
  margin: 0 auto;
}

.owner-features li {
  padding: 6px 0;
  color: #28a745;
  font-weight: 500;
}

.owner-info {
  background: var(--card-bg, white);
  border-radius: 8px;
  padding: 16px;
  margin: 20px 0;
  border: 1px solid #d4edda;
  color: var(--text-color, #000);
}

.dark-mode .owner-info {
  background: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.owner-info h4 {
  margin: 0 0 12px 0;
  color: #28a745;
}

.owner-info p {
  margin: 8px 0;
  text-align: left;
  color: var(--text-color, #000);
}

.status-active {
  color: #28a745;
  font-weight: 600;
}

.owner-actions {
  margin-top: 24px;
}

.owner-actions p {
  margin-bottom: 16px;
  font-weight: 500;
  color: var(--text-color, #000);
}

.owner-card h3 {
  color: var(--text-color, #000);
  margin: 0 0 16px 0;
}

.owner-card p {
  color: var(--text-color, #000);
}

.dark-mode .owner-card {
  background: linear-gradient(135deg, #2a4a2a 0%, #1a3a1a 100%);
}
`;if(typeof document<"u"){const e=document.createElement("style");e.textContent=H5,document.head.appendChild(e)}const G5=function({user:r,onClose:t}){const[n,a]=Y.useState(null),[l,c]=Y.useState([]),[f,m]=Y.useState([]),[g,x]=Y.useState([]),[y,b]=Y.useState(!0),[E,S]=Y.useState(null),[k,C]=Y.useState("subscriptions"),[R,j]=Y.useState(""),[N,F]=Y.useState(1),[K,z]=Y.useState(7),[O,ne]=Y.useState(""),[ee,ve]=Y.useState(null);Y.useEffect(()=>{he()},[r]);const he=async()=>{if(!(!r||!Be))try{b(!0),S(null);const{data:M,error:V}=await Be.rpc("is_admin",{user_uuid:r.id});if(V)throw console.error("Admin check error:",V),V;if(!M)throw new Error("Access denied: Admin privileges required");const{data:H,error:se}=await Be.from("admin_users").select("*").eq("user_id",r.id).single();if(se)throw se;a(H);const{data:D,error:P}=await Be.rpc("get_admin_subscription_overview");if(P)throw console.error("Subscription overview error:",P),P;c(D||[]);let I=[];try{const{data:de,error:pe}=await Be.from("admin_actions").select(`
            id,
            action_type,
            target_user_id,
            performed_at,
            details,
            admin_users!inner(email)
          `).order("performed_at",{ascending:!1}).limit(20);pe?(console.warn("Admin actions table not found or error:",pe),I=[]):I=de||[]}catch(de){console.warn("Failed to load admin actions:",de),I=[]}const B=(I||[]).map(de=>({...de,admin_email:de.admin_users?.email||(Array.isArray(de.admin_users)?de.admin_users[0]?.email:null)}));m(B);const{data:G,error:te}=await Be.from("admin_upcoming_deletions").select("*").order("deletion_scheduled_for",{ascending:!0});te?console.warn("Failed to load upcoming deletions:",te):x(G||[])}catch(M){S(M.message||"Failed to load admin data")}finally{b(!1)}},ce=async()=>{if(!(!R||!Be))try{ve("grant");const{error:M}=await Be.rpc("admin_grant_subscription",{target_user_id:R,plan_id:"enforcement_pro",duration_months:N,admin_notes:O||`Granted ${N} month(s) by admin`});if(M)throw M;await he(),j(""),F(1),ne(""),alert("Subscription granted successfully!")}catch(M){alert("Failed to grant subscription: "+M.message)}finally{ve(null)}},Ne=async()=>{if(!(!R||!Be))try{ve("extend");const{error:M}=await Be.rpc("admin_extend_trial",{target_user_id:R,additional_days:K,admin_notes:O||`Extended trial by ${K} days`});if(M)throw M;await he(),j(""),z(7),ne(""),alert("Trial extended successfully!")}catch(M){alert("Failed to extend trial: "+M.message)}finally{ve(null)}},xe=async(M,V)=>{if(!(!Be||!confirm(`Cancel scheduled deletion for ${V}?`)))try{ve("cancel-deletion");const{error:se}=await Be.from("inactive_account_warnings").update({cancelled:!0,warning_acknowledged:!0}).eq("user_id",M).eq("cancelled",!1);if(se)throw se;await he(),alert(`Scheduled deletion cancelled for ${V}`)}catch(se){alert("Failed to cancel deletion: "+se.message)}finally{ve(null)}},le=M=>M?new Date(M).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",Q=M=>{const H={active_trial:{color:"#fff3cd",label:"Active Trial"},active_paid:{color:"#d4edda",label:"Active Paid"},expired:{color:"#f8d7da",label:"Expired"},cancelled:{color:"#e2e3e5",label:"Cancelled"}}[M]||{color:"#f8f9fa",label:M};return u.jsx("span",{style:{backgroundColor:H.color,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500"},children:H.label})};return y?u.jsx("div",{className:"admin-dashboard",children:u.jsx("div",{className:"loading",children:"Loading admin dashboard..."})}):E?u.jsx("div",{className:"admin-dashboard",children:u.jsxs("div",{className:"error",children:[u.jsx("h3",{children:"Access Denied"}),u.jsx("p",{children:E}),t&&u.jsx("button",{onClick:t,children:"Close"})]})}):u.jsxs("div",{className:"admin-dashboard",children:[u.jsxs("div",{className:"admin-header",children:[u.jsx("h2",{children:"Admin Dashboard"}),u.jsxs("div",{className:"admin-info",children:[u.jsxs("span",{children:["Role: ",u.jsx("strong",{children:n?.role})]}),t&&u.jsx("button",{className:"close-button",onClick:t,children:""})]})]}),u.jsxs("div",{className:"admin-tabs",children:[u.jsxs("button",{className:k==="subscriptions"?"active":"",onClick:()=>C("subscriptions"),children:["Subscriptions (",l.length,")"]}),u.jsxs("button",{className:k==="actions"?"active":"",onClick:()=>C("actions"),children:["Recent Actions (",f.length,")"]}),u.jsxs("button",{className:k==="inactive"?"active":"",onClick:()=>C("inactive"),children:["Inactive Accounts (",g.length,")"]}),u.jsx("button",{className:k==="settings"?"active":"",onClick:()=>C("settings"),children:"Settings"})]}),k==="subscriptions"&&u.jsxs("div",{className:"subscriptions-tab",children:[u.jsxs("div",{className:"stats-bar",children:[u.jsxs("div",{className:"stat",children:[u.jsx("strong",{children:l.filter(M=>M.subscription_status==="trial").length}),u.jsx("span",{children:"Active Trials"})]}),u.jsxs("div",{className:"stat",children:[u.jsx("strong",{children:l.filter(M=>M.subscription_status==="active").length}),u.jsx("span",{children:"Paid Subscriptions"})]}),u.jsxs("div",{className:"stat",children:[u.jsx("strong",{children:l.filter(M=>M.subscription_status==="expired").length}),u.jsx("span",{children:"Expired"})]}),u.jsxs("div",{className:"stat",children:[u.jsxs("strong",{children:["",l.filter(M=>M.subscription_status==="active").length*25]}),u.jsx("span",{children:"Monthly Revenue"})]})]}),u.jsxs("div",{className:"admin-actions-panel",children:[u.jsx("h3",{children:"Admin Actions"}),u.jsxs("div",{className:"admin-form",children:[u.jsxs("div",{className:"form-row",children:[u.jsx("label",{htmlFor:"selected-user-id",children:"Select User"}),u.jsxs("select",{id:"selected-user-id",name:"selectedUserId",value:R,onChange:M=>j(M.target.value),children:[u.jsx("option",{value:"",children:"Select User..."}),l.map(M=>u.jsxs("option",{value:M.user_email,children:[M.user_email," - ",Q(M.subscription_status).props.children]},M.user_email))]})]}),u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"action-group",children:u.jsxs("div",{className:"input-group",children:[u.jsx("label",{htmlFor:"grant-months",children:"Grant Subscription (months):"}),u.jsx("input",{id:"grant-months",name:"grantMonths",type:"number",min:"1",max:"12",value:N,onChange:M=>F(parseInt(M.target.value)||1)}),u.jsx("button",{onClick:ce,disabled:!R||ee!==null,children:ee==="grant"?"Granting...":"Grant"})]})}),u.jsx("div",{className:"action-group",children:u.jsxs("div",{className:"input-group",children:[u.jsx("label",{htmlFor:"extend-days",children:"Extend Trial (days):"}),u.jsx("input",{id:"extend-days",name:"extendDays",type:"number",min:"1",max:"90",value:K,onChange:M=>z(parseInt(M.target.value)||7)}),u.jsx("button",{onClick:Ne,disabled:!R||ee!==null,children:ee==="extend"?"Extending...":"Extend"})]})})]}),u.jsxs("div",{className:"form-row",children:[u.jsx("label",{htmlFor:"admin-notes",children:"Admin notes (optional)"}),u.jsx("textarea",{id:"admin-notes",name:"adminNotes",placeholder:"Admin notes (optional)",value:O,onChange:M=>ne(M.target.value),rows:2})]})]})]}),u.jsxs("div",{className:"subscriptions-table",children:[u.jsx("h3",{children:"All Subscriptions"}),u.jsxs("table",{children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"User Email"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Plan"}),u.jsx("th",{children:"API Requests"}),u.jsx("th",{children:"Created"}),u.jsx("th",{children:"Period End"})]})}),u.jsx("tbody",{children:l.map(M=>u.jsxs("tr",{children:[u.jsx("td",{children:M.user_email}),u.jsx("td",{children:Q(M.subscription_status)}),u.jsx("td",{children:M.subscription_plan||"No Plan"}),u.jsx("td",{children:M.total_api_requests||0}),u.jsx("td",{children:le(M.subscription_created_at)}),u.jsx("td",{children:le(M.current_period_end)})]},M.user_email))})]})]})]}),k==="actions"&&u.jsxs("div",{className:"actions-tab",children:[u.jsx("h3",{children:"Recent Admin Actions"}),u.jsx("div",{className:"actions-list",children:f.map(M=>u.jsxs("div",{className:"action-item",children:[u.jsxs("div",{className:"action-header",children:[u.jsx("strong",{children:M.action_type.replace("_"," ").toUpperCase()}),u.jsx("span",{className:"action-date",children:le(M.performed_at)})]}),u.jsxs("div",{className:"action-details",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Admin:"})," ",M.admin_email]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Target User:"})," ",M.target_user_id]}),M.details&&u.jsxs("div",{className:"action-notes",children:[u.jsx("strong",{children:"Details:"}),u.jsx("pre",{children:JSON.stringify(M.details,null,2)})]})]})]},M.id))})]}),k==="inactive"&&u.jsxs("div",{className:"inactive-tab",children:[u.jsx("h3",{children:"Upcoming Account Deletions (GDPR Compliance)"}),g.length===0?u.jsx("div",{className:"no-deletions",children:u.jsx("p",{children:"No accounts scheduled for deletion. All users are active! "})}):u.jsxs("div",{className:"deletions-table",children:[u.jsxs("table",{children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"User Email"}),u.jsx("th",{children:"Last Activity"}),u.jsx("th",{children:"Warning Sent"}),u.jsx("th",{children:"Deletion Date"}),u.jsx("th",{children:"Days Until"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:g.map(M=>u.jsxs("tr",{children:[u.jsx("td",{children:M.user_email}),u.jsx("td",{children:le(M.last_activity_at)}),u.jsx("td",{children:le(M.warning_sent_at)}),u.jsx("td",{children:le(M.deletion_scheduled_for)}),u.jsx("td",{children:u.jsxs("span",{style:{color:M.days_until_deletion<=7?"var(--danger)":"var(--text)",fontWeight:M.days_until_deletion<=7?"700":"400"},children:[M.days_until_deletion," days"]})}),u.jsx("td",{children:M.warning_acknowledged?u.jsx("span",{style:{color:"var(--primary)"},children:"Acknowledged"}):u.jsx("span",{style:{color:"var(--text-muted)"},children:"Pending"})}),u.jsx("td",{children:u.jsx("button",{className:"cancel-btn",onClick:()=>xe(M.user_id,M.user_email),disabled:ee!==null,style:{background:"var(--danger)",color:"white",border:"none",padding:"0.375rem 0.75rem",borderRadius:"var(--radius)",cursor:"pointer",fontSize:"0.625rem",fontWeight:"600",whiteSpace:"nowrap"},children:"Cancel Deletion"})})]},M.user_id))})]}),u.jsxs("div",{className:"deletion-info",style:{marginTop:"1rem",padding:"1rem",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",fontSize:"0.75rem",color:"var(--text-muted)"},children:[u.jsx("p",{children:u.jsx("strong",{children:"How it works:"})}),u.jsxs("ul",{style:{marginLeft:"1.5rem",marginTop:"0.5rem"},children:[u.jsx("li",{children:"Accounts inactive for 5 months receive a warning email"}),u.jsx("li",{children:"After 6 months of inactivity, account is automatically deleted"}),u.jsx("li",{children:"Users can prevent deletion by simply logging in or creating data"}),u.jsx("li",{children:"Active subscriptions are never deleted automatically"}),u.jsx("li",{children:"Admins can cancel scheduled deletions manually using the button above"})]})]})]})]}),k==="settings"&&u.jsxs("div",{className:"settings-tab",children:[u.jsx("h3",{children:"Admin Settings"}),u.jsxs("div",{className:"settings-info",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Your Role:"})," ",n?.role]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Permissions:"})," ",n?.permissions.join(", ")]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Account Created:"})," ",le(n?.created_at||"")]})]}),u.jsxs("div",{className:"quick-stats",children:[u.jsx("h4",{children:"Quick Stats"}),u.jsxs("ul",{children:[u.jsxs("li",{children:["Total Users: ",l.length]}),u.jsxs("li",{children:["Active Trials: ",l.filter(M=>M.subscription_status==="trial").length]}),u.jsxs("li",{children:["Paid Customers: ",l.filter(M=>M.subscription_status==="active").length]}),u.jsxs("li",{children:["Monthly Revenue: ",l.filter(M=>M.subscription_status==="active").length*25]}),u.jsxs("li",{children:["Total Actions Performed: ",f.length]})]})]})]})]})},Z5=Y.memo(G5),K5=`
/* ==== Admin Dashboard Modern Styles ==== */
.admin-dashboard {
  max-width: 1200px;
  margin: 0 auto;
  padding: 1rem;
  background: var(--background);
  min-height: 100vh;
  overflow-x: hidden;
  box-sizing: border-box;
}

.admin-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  background: var(--surface);
  padding: 1rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
}

.admin-header h2 {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--text);
  margin: 0;
}

.admin-info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--text-muted);
  font-size: 0.75rem;
}

.close-button {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-muted);
}

.close-button:hover {
  background: var(--background);
  color: var(--text);
}

.admin-tabs {
  display: flex;
  gap: 0.25rem;
  margin-bottom: 1rem;
  background: var(--surface);
  padding: 0.25rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
}

.admin-tabs button {
  flex: 1;
  padding: 0.5rem 0.75rem;
  border: none;
  background: transparent;
  cursor: pointer;
  border-radius: var(--radius);
  font-weight: 500;
  color: var(--text-muted);
  transition: all 0.2s ease;
  position: relative;
  font-size: 0.75rem;
  text-align: center;
}

.admin-tabs button:hover {
  background: var(--background);
  color: var(--text);
}

.admin-tabs button.active {
  background: var(--primary);
  color: white;
}

.stats-bar {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.stat {
  background: var(--surface);
  padding: 0.75rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
  text-align: center;
  transition: all 0.2s ease;
}

.stat:hover {
  transform: translateY(-1px);
}

.stat strong {
  display: block;
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 0.25rem;
}

.stat span {
  font-size: 0.625rem;
  color: var(--text-muted);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  line-height: 1.2;
}

.admin-actions-panel {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  padding: 1rem;
  margin-bottom: 1rem;
}

.admin-actions-panel h3 {
  margin: 0 0 1rem 0;
  font-size: 1rem;
  font-weight: 600;
  color: var(--text);
}

.admin-form .form-row {
  margin-bottom: 1rem;
}

.admin-form label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 500;
  color: var(--text);
  font-size: 0.75rem;
}

.admin-form select,
.admin-form input,
.admin-form textarea {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  font-size: 0.75rem;
  transition: all 0.2s ease;
  background: var(--background);
  color: var(--text);
  box-sizing: border-box;
}

.admin-form select:focus,
.admin-form input:focus,
.admin-form textarea:focus {
  outline: none;
  border-color: var(--primary);
}

.form-row .action-group {
  display: flex;
  gap: 0.5rem;
  align-items: end;
  flex-wrap: wrap;
}

.input-group {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  flex: 1;
  min-width: 0;
}

.input-group label {
  margin: 0;
  font-size: 0.625rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
}

.input-group input {
  width: 80px;
  min-width: 60px;
}

.input-group button {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: var(--radius);
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s ease;
  font-size: 0.75rem;
  white-space: nowrap;
}

.input-group button:hover {
  background: var(--primary-hover);
  transform: translateY(-1px);
}

.input-group button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.subscriptions-table {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  overflow: hidden;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

.subscriptions-table h3 {
  margin: 0;
  padding: 0.75rem 1rem;
  background: var(--background);
  border-bottom: 1px solid var(--border-light);
  font-size: 1rem;
  font-weight: 600;
  color: var(--text);
}

.subscriptions-table table {
  width: 100%;
  border-collapse: collapse;
  min-width: 600px;
}

.subscriptions-table th,
.subscriptions-table td {
  padding: 0.5rem 0.75rem;
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.subscriptions-table th {
  background: var(--background);
  font-weight: 600;
  font-size: 0.625rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  white-space: nowrap;
}

.subscriptions-table td {
  font-size: 0.75rem;
  color: var(--text);
  white-space: nowrap;
}

.actions-list {
  max-height: 400px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.action-item {
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  margin-bottom: 0.5rem;
  padding: 1rem;
  background: var(--surface);
  transition: all 0.2s ease;
}

.action-item:hover {
  transform: translateY(-1px);
}

.action-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0.75rem;
  gap: 0.5rem;
}

.action-header strong {
  color: var(--primary);
  font-weight: 600;
  font-size: 0.75rem;
  flex: 1;
}

.action-date {
  color: var(--text-muted);
  font-size: 0.625rem;
  font-weight: 500;
  white-space: nowrap;
}

.action-details p {
  margin: 0.25rem 0;
  font-size: 0.75rem;
  color: var(--text);
}

.action-notes {
  margin-top: 0.75rem;
}

.action-notes pre {
  background: var(--background);
  padding: 0.75rem;
  border-radius: var(--radius);
  font-size: 0.625rem;
  overflow-x: auto;
  border: 1px solid var(--border-light);
  color: var(--text);
  white-space: pre-wrap;
  word-break: break-word;
}

.settings-info,
.quick-stats {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  padding: 1rem;
  margin-bottom: 1rem;
}

.settings-info h4,
.quick-stats h4 {
  margin: 0 0 0.75rem 0;
  color: var(--text);
  font-weight: 600;
  font-size: 1rem;
}

.settings-info p {
  margin: 0.5rem 0;
  color: var(--text);
  font-size: 0.75rem;
}

.quick-stats ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.quick-stats li {
  padding: 0.5rem 0;
  border-bottom: 1px solid var(--border-light);
  color: var(--text);
  display: flex;
  justify-content: space-between;
  font-size: 0.75rem;
  gap: 1rem;
}

.quick-stats li:last-child {
  border-bottom: none;
}

.loading,
.error {
  text-align: center;
  padding: 2rem 1rem;
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  margin: 1rem;
}

.error h3 {
  color: var(--danger);
  margin-bottom: 1rem;
  font-size: 1rem;
}

.loading {
  color: var(--text-muted);
  font-size: 0.875rem;
}

/* CSS Variables handle dark mode automatically through the app's theme system */

/* ==== Responsive Design - Mobile First ==== */
@media (max-width: 480px) {
  .admin-dashboard {
    padding: 0.5rem;
    margin: 0;
  }

  .admin-header {
    flex-direction: column;
    gap: 0.5rem;
    text-align: center;
    padding: 0.75rem;
  }

  .admin-header h2 {
    font-size: 1.125rem;
  }

  .admin-info {
    flex-direction: column;
    gap: 0.25rem;
    font-size: 0.625rem;
  }

  .admin-tabs {
    flex-direction: column;
    gap: 0.125rem;
  }

  .admin-tabs button {
    padding: 0.5rem;
    font-size: 0.75rem;
  }

  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.25rem;
  }

  .stat {
    padding: 0.5rem;
  }

  .stat strong {
    font-size: 1rem;
    margin-bottom: 0.125rem;
  }

  .stat span {
    font-size: 0.5rem;
  }

  .admin-actions-panel {
    padding: 0.75rem;
  }

  .form-row .action-group {
    flex-direction: column;
    gap: 0.5rem;
    align-items: stretch;
  }

  .input-group {
    flex-direction: row;
    align-items: center;
    gap: 0.5rem;
  }

  .input-group label {
    margin: 0;
    min-width: 60px;
    text-align: left;
    font-size: 0.5rem;
  }

  .input-group input {
    width: 60px;
    min-width: 60px;
  }

  .input-group button {
    padding: 0.5rem 0.75rem;
    font-size: 0.625rem;
  }

  .subscriptions-table h3 {
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
  }

  .subscriptions-table th,
  .subscriptions-table td {
    padding: 0.375rem 0.5rem;
    font-size: 0.625rem;
  }

  .action-item {
    padding: 0.75rem;
  }

  .action-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.25rem;
  }

  .action-header strong {
    font-size: 0.625rem;
  }

  .action-date {
    font-size: 0.5rem;
  }

  .action-details p {
    font-size: 0.625rem;
    margin: 0.125rem 0;
  }

  .action-notes pre {
    padding: 0.5rem;
    font-size: 0.5rem;
  }

  .settings-info,
  .quick-stats {
    padding: 0.75rem;
  }

  .settings-info h4,
  .quick-stats h4 {
    font-size: 0.875rem;
  }

  .settings-info p,
  .quick-stats li {
    font-size: 0.625rem;
  }
}

@media (max-width: 360px) {
  .admin-dashboard {
    padding: 0.25rem;
  }

  .stats-bar {
    grid-template-columns: 1fr;
    gap: 0.25rem;
  }

  .stat strong {
    font-size: 0.875rem;
  }

  .stat span {
    font-size: 0.5rem;
  }

  .admin-tabs button {
    padding: 0.375rem;
    font-size: 0.625rem;
  }
}

/* Tablet optimizations */
@media (min-width: 481px) and (max-width: 768px) {
  .admin-dashboard {
    padding: 0.75rem;
  }

  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
  }

  .form-row .action-group {
    flex-wrap: wrap;
    gap: 0.75rem;
  }
}
`;if(typeof document<"u"&&!document.getElementById("admin-dashboard-styles")){const r=document.createElement("style");r.id="admin-dashboard-styles",r.textContent=K5,document.head.appendChild(r)}function q5({featureName:e,onUpgrade:r}){return u.jsxs("div",{className:"feature-locked",children:[u.jsx("div",{className:"lock-icon",children:""}),u.jsx("h3",{children:e}),u.jsx("p",{children:"This premium feature requires an active subscription."}),u.jsx("button",{className:"upgrade-button",onClick:r,children:"Upgrade to Enforcement Pro"})]})}function Gy({user:e,fallback:r,children:t}){const{hasAccess:n,isLoading:a}=Cm(e);return a?u.jsxs("div",{className:"subscription-loading",children:[u.jsx("div",{className:"spinner-small"}),u.jsx("span",{children:"Checking access..."})]}):n?u.jsx(u.Fragment,{children:t}):r?u.jsx(u.Fragment,{children:r}):u.jsx(q5,{featureName:"Premium Feature",onUpgrade:()=>{console.log("Upgrade clicked - implement subscription flow")}})}function Y5({state:e,user:r}){const[t,n]=Y.useState(()=>{const g=new Date;return g.setDate(1),g.toISOString().slice(0,10)}),[a,l]=Y.useState(()=>new Date().toISOString().slice(0,10)),c=Y.useMemo(()=>{const x=(e.completions||[]).filter(K=>{const z=K.timestamp.slice(0,10);return z>=t&&z<=a}),y=x.filter(K=>K.outcome==="PIF"),b=y.reduce((K,z)=>{const O=parseFloat(z.amount||"0");return K+(isNaN(O)?0:O)},0),E=x.length,S=y.length,k=x.filter(K=>K.outcome==="Done").length,C=x.filter(K=>K.outcome==="DA").length,R=x.filter(K=>K.outcome==="ARR").length,j=x.reduce((K,z)=>{const O=z.timestamp.slice(0,10);if(K[O]||(K[O]={date:O,pifs:0,total:0,fees:0}),K[O].total++,z.outcome==="PIF"){K[O].pifs++;const ne=parseFloat(z.amount||"0");isNaN(ne)||(K[O].fees+=ne)}return K},{}),N=Object.values(j).map(K=>({...K,bonus:Math.max(0,K.pifs*100-100)})),F=N.reduce((K,z)=>K+z.bonus,0);return{totalPifFees:b,totalAddresses:E,pifCount:S,doneCount:k,daCount:C,arrCount:R,totalBonus:F,dailyStats:N.sort((K,z)=>z.date.localeCompare(K.date))}},[e.completions,t,a]),f=g=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2}).format(g),m=()=>{const g=new Date(t).toLocaleDateString("en-GB"),x=new Date(a).toLocaleDateString("en-GB");return`${g} - ${x}`};return u.jsx(Gy,{user:r,fallback:u.jsx(X5,{}),children:u.jsxs("div",{className:"earnings-calendar",style:{padding:"1rem"},children:[u.jsx("h2",{children:"Earnings Overview"}),u.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",alignItems:"center",flexWrap:"wrap"},children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"start-date",style:{display:"block",marginBottom:"0.5rem"},children:"From:"}),u.jsx("input",{id:"start-date",type:"date",value:t,onChange:g=>n(g.target.value),className:"input"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"end-date",style:{display:"block",marginBottom:"0.5rem"},children:"To:"}),u.jsx("input",{id:"end-date",type:"date",value:a,onChange:g=>l(g.target.value),className:"input"})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[u.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--success)"},children:"Total PIF Fees"}),u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:f(c.totalPifFees)}),u.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[c.pifCount," PIF completions"]})]}),u.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Total Addresses"}),u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:c.totalAddresses}),u.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:m()})]}),u.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--primary)"},children:"Potential Bonus"}),u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:f(c.totalBonus)}),u.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"100/PIF - 100/day"})]}),u.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Breakdown"}),u.jsxs("div",{style:{fontSize:"0.875rem"},children:[u.jsxs("div",{children:["PIF: ",c.pifCount]}),u.jsxs("div",{children:["Done: ",c.doneCount]}),u.jsxs("div",{children:["DA: ",c.daCount]}),u.jsxs("div",{children:["ARR: ",c.arrCount]})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{children:"Daily Breakdown"}),c.dailyStats.length===0?u.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No completions found in selected date range"}):u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{background:"var(--background)"},children:[u.jsx("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid var(--border-light)"},children:"Date"}),u.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIFs"}),u.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Total Addresses"}),u.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIF Fees"}),u.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Bonus"})]})}),u.jsx("tbody",{children:c.dailyStats.map(g=>u.jsxs("tr",{children:[u.jsx("td",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border-light)"},children:new Date(g.date).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})}),u.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:g.pifs}),u.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:g.total}),u.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold"},children:f(g.fees)}),u.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold",color:g.bonus>0?"var(--primary)":"var(--text-muted)"},children:f(g.bonus)})]},g.date))})]})})]})]})})}function X5(){return u.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",margin:"1rem"},children:[u.jsx("h2",{children:"Earnings Tracking"}),u.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--text-muted)"},children:"Track your PIF fees and completion statistics with detailed date range analysis."}),u.jsx("div",{style:{marginBottom:"1rem"},children:u.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",fontSize:"0.875rem"},children:"Premium Feature"})}),u.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Start your free trial to access earnings tracking and reporting."})]})}class J5{currentToken=null;generateToken(){return this.currentToken="session_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36),this.currentToken}getToken(){return this.currentToken}clearToken(){this.currentToken=null}}const eu=new J5;async function Q5(e,r={}){const t="your-new-google-maps-api-key-here";if(!e.trim()||e.length<3)return[];try{const n=r.sessionToken||eu.generateToken(),a={input:e,sessionToken:n,...r.componentRestrictions&&{regionCode:r.componentRestrictions.country.toUpperCase()},...r.types&&r.types.length>0&&{includedPrimaryTypes:r.types}};console.log("Making Places API (New) autocomplete request:",a);const l=await fetch("https://places.googleapis.com/v1/places:autocomplete",{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":t,"X-Goog-FieldMask":"suggestions.placePrediction.place,suggestions.placePrediction.placeId,suggestions.placePrediction.text"},body:JSON.stringify(a)});if(!l.ok){const f=await l.text();throw console.error("Places API error:",l.status,f),new Error(`Places API error: ${l.status} - ${f}`)}const c=await l.json();return console.log("Places API response:",c),c.suggestions?c.suggestions.filter(f=>f.placePrediction).map(f=>({place_id:f.placePrediction.placeId,description:f.placePrediction.text?.text||"",structured_formatting:{main_text:f.placePrediction.structuredFormat?.mainText?.text||"",secondary_text:f.placePrediction.structuredFormat?.secondaryText?.text||""},types:f.placePrediction.types||[]})):[]}catch(n){throw console.error("Places API autocomplete failed:",n),n}}async function eD(e,r){const t="your-new-google-maps-api-key-here";try{console.log("Getting place details for:",e);const n=`https://places.googleapis.com/v1/places/${e}`,a=await fetch(n,{method:"GET",headers:{"X-Goog-Api-Key":t,"X-Goog-FieldMask":"id,displayName,formattedAddress,location,types"}});if(!a.ok){const c=await a.text();throw console.error("Place details API error:",a.status,c),new Error(`Place details API error: ${a.status} - ${c}`)}const l=await a.json();return console.log("Place details response:",l),r&&eu.clearToken(),l.id&&l.location?{place_id:l.id,name:l.displayName?.text||"",formatted_address:l.formattedAddress||"",geometry:{location:{lat:l.location.latitude,lng:l.location.longitude}},types:l.types||[]}:null}catch(n){throw console.error("Place details failed:",n),r&&eu.clearToken(),n}}function tD(){return eu.getToken()}function ux(){eu.clearToken()}function Zy(e){if(e<60)return`${Math.round(e)}s`;const r=Math.floor(e/60);if(r<60)return`${r}m`;const t=Math.floor(r/60),n=r%60;return n>0?`${t}h ${n}m`:`${t}h`}function Ky(e){if(e<1e3)return`${Math.round(e)}m`;const r=e/1e3;return r<10?`${r.toFixed(1)}km`:`${Math.round(r)}km`}function qy(e){return`${Math.round(e*100)}%`}const dx="geocode-cache",u0=720*60*60*1e3;class rD{cache={};isLoadingCache=!1;cacheLoadPromise=null;apiKey;constructor(r){this.apiKey=r,this.cacheLoadPromise=this.loadCache()}async loadCache(){if(this.isLoadingCache)return this.cacheLoadPromise||Promise.resolve();this.isLoadingCache=!0;try{const r=await gm(dx);r&&(this.cache={...r,...this.cache},this.cleanExpiredEntries())}catch(r){console.warn("Failed to load geocoding cache:",r)}finally{this.isLoadingCache=!1,this.cacheLoadPromise=null}}async saveCache(){try{await vm(dx,this.cache)}catch(r){console.warn("Failed to save geocoding cache:",r)}}cleanExpiredEntries(){const r=Date.now(),t=[];for(const[n,a]of Object.entries(this.cache))r-a.timestamp>u0&&t.push(n);for(const n of t)delete this.cache[n];t.length>0&&this.saveCache()}normalizeAddress(r){return r.trim().toLowerCase().replace(/\s+/g," ")}async geocodeAddressInternal(r){if(this.cacheLoadPromise&&await this.cacheLoadPromise,!this.apiKey)return{success:!1,address:r,originalAddress:r,error:"Google Maps API key not configured"};if(!r?.trim())return{success:!1,address:r,originalAddress:r,error:"Empty address provided"};const t=this.normalizeAddress(r),n=this.cache[t];if(n&&Date.now()-n.timestamp<u0)return n.result;try{console.log(`Geocoding with Google Maps SDK: "${r}"`);const{geocodeAddressSDK:a,isGoogleMapsSDKAvailable:l}=await Qa(async()=>{const{geocodeAddressSDK:c,isGoogleMapsSDKAvailable:f}=await import("./googleMapsSDK-CCdvlH9E.js");return{geocodeAddressSDK:c,isGoogleMapsSDKAvailable:f}},[]);if(l()){const c=await a(r);if(c.success)return this.cache[t]={result:c,timestamp:Date.now()},this.saveCache().catch(console.warn),c;this.cache[t]={result:c,timestamp:Date.now()},this.saveCache().catch(console.warn)}}catch(a){console.warn("JavaScript SDK geocoding failed, falling back to Supabase Edge Function:",a)}return{success:!1,address:r,originalAddress:r,error:"Google Maps direct geocoding not available"}}getCacheStats(){const r=Date.now();let t=0,n=0;for(const a of Object.values(this.cache))r-a.timestamp<u0?t++:n++;return{totalEntries:Object.keys(this.cache).length,validEntries:t,expiredEntries:n}}async clearCache(){this.cache={},await this.saveCache()}}let d0=null;function Am(){if(!d0){const e="your-new-google-maps-api-key-here";d0=new rD(e)}return d0}async function nD(e,r,t){const n=Am(),a=[],l=5;for(let f=0;f<e.length;f+=l){const m=e.slice(f,f+l),g=m.map(y=>n.geocodeAddressInternal(y)),x=await Promise.all(g);a.push(...x),t&&t(a.length,e.length,m[m.length-1]),f+l<e.length&&await new Promise(y=>setTimeout(y,200))}const c=a.filter(f=>!f.success).length;if(c>e.length*.5){console.warn(`${c}/${e.length} addresses failed with direct API, trying Supabase Edge Function...`);try{const{geocodeAddresses:f}=await Qa(async()=>{const{geocodeAddresses:g}=await Promise.resolve().then(()=>Yy);return{geocodeAddresses:g}},void 0),m=await f(e,t);return a.map((g,x)=>g.success?g:m[x])}catch(f){console.warn("Centralized batch geocoding also failed:",f)}}return a}async function aD(e,r,t="GB",n=5){if(!e.trim()||e.length<3)return[];try{console.log(`Searching addresses with Google Places API: "${e}"`);const l=await Q5(e,{componentRestrictions:{country:t.toLowerCase()},types:["street_address","route","premise"]});if(l.length>0)return l.slice(0,n).map(c=>({label:c.description,coordinates:[0,0],confidence:.9,placeId:c.place_id}))}catch(l){console.warn("Google Places API search failed, trying Supabase Edge Function:",l)}try{const{searchAddresses:l}=await Qa(async()=>{const{searchAddresses:f}=await Promise.resolve().then(()=>Yy);return{searchAddresses:f}},void 0),c=await l(e,t,n);if(c.length>0)return c}catch(l){console.warn("Centralized address search also failed:",l)}const a=Am();if(a.apiKey)try{const l=await a.geocodeAddressInternal(e);if(l.success&&l.lat&&l.lng)return[{label:l.formattedAddress||l.address,coordinates:[l.lng,l.lat],confidence:l.confidence||.7}]}catch(l){console.warn("Direct geocoding fallback also failed:",l)}return[]}async function iD(e){if(!e)return null;try{const t=tD()||void 0,n=await eD(e,t);if(ux(),n?.geometry?.location)return{lat:n.geometry.location.lat,lng:n.geometry.location.lng,formattedAddress:n.formatted_address||n.name||""}}catch(t){ux(),console.error("Failed to resolve place details with new API:",t)}const r=Am();if(r.apiKey)try{const t=await r.geocodeAddressInternal(e);if(t.success&&t.lat&&t.lng)return{lat:t.lat,lng:t.lng,formattedAddress:t.formattedAddress||t.address}}catch(t){console.warn("Geocoding fallback for place resolution failed:",t)}return null}async function sD(e,r){if(!Be)throw new Error("Supabase client not available");try{console.log(`Geocoding ${e.length} addresses via centralized service`);const t=[],n=10;for(let a=0;a<e.length;a+=n){const l=e.slice(a,a+n),{data:c,error:f}=await Be.functions.invoke("geocode",{body:{addresses:l,countryCode:"GB"}});if(f){console.error("Geocoding batch error:",f);const m=l.map(g=>({success:!1,address:g,originalAddress:g,error:f.message||"Geocoding service error"}));t.push(...m)}else if(c?.results)t.push(...c.results);else{console.error("Unexpected geocoding response:",c);const m=l.map(g=>({success:!1,address:g,originalAddress:g,error:"Unexpected service response"}));t.push(...m)}r&&r(t.length,e.length,l[l.length-1])}return console.log(`Geocoding completed: ${t.filter(a=>a.success).length}/${t.length} successful`),t}catch(t){return console.error("Geocoding service failed:",t),e.map(n=>({success:!1,address:n,originalAddress:n,error:t instanceof Error?t.message:"Service unavailable"}))}}async function oD(e,r="GB",t=5,n,a){if(!Be)return console.error("Supabase client not available for address search"),[];try{if(!e.trim()||e.length<3)return[];const{data:l,error:c}=await Be.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:r,limit:Math.min(t,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return c?(console.error("Address search error:",c),[]):l?.results||[]}catch(l){return console.error("Address search failed:",l),[]}}function z0(e){const r=e.lat!==null&&e.lat!==void 0&&e.lng!==null&&e.lng!==void 0&&!isNaN(e.lat)&&!isNaN(e.lng);return{success:r,address:e.address,originalAddress:e.address,lat:r&&e.lat!==null?e.lat:void 0,lng:r&&e.lng!==null?e.lng:void 0,confidence:r?1:void 0,error:r?void 0:"No coordinates available"}}function Wd(e){return{address:e.address,lat:e.success&&e.lat!==void 0?e.lat:null,lng:e.success&&e.lng!==void 0?e.lng:null}}const Yy=Object.freeze(Object.defineProperty({__proto__:null,addressRowToGeocodingResult:z0,formatConfidence:qy,formatDistance:Ky,formatDuration:Zy,geocodeAddresses:sD,geocodingResultToAddressRow:Wd,searchAddresses:oD},Symbol.toStringTag,{value:"Module"}));async function fx(e,r){console.log(`Geocoding ${e.length} addresses via Google Maps (hybrid service)`);try{const t=await nD(e,void 0,r);return console.log(`Google Maps geocoding completed: ${t.filter(n=>n.success).length}/${t.length} successful`),t}catch(t){return console.error("Google Maps geocoding service failed:",t),e.map(n=>({success:!1,address:n,originalAddress:n,error:t instanceof Error?t.message:"Google Maps service unavailable"}))}}async function lD(e,r="GB",t=5,n,a){try{const l=await aD(e);if(l.length>0)return l.slice(0,t)}catch(l){console.warn("Google Maps search failed, falling back to centralized service:",l)}if(!Be)return console.error("No search services available"),[];try{if(!e.trim()||e.length<3)return[];const{data:l,error:c}=await Be.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:r,limit:Math.min(t,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return c?(console.error("Address search error:",c),[]):l?.results||[]}catch(l){return console.error("Address search failed:",l),[]}}async function cD(e,r,t){if(!Be)throw new Error("Supabase client not available");try{const n=e.map((f,m)=>({...f,originalIndex:m})).filter(({lat:f,lng:m})=>f!=null&&m!==null&&m!==void 0&&!isNaN(f)&&!isNaN(m));if(n.length===0)return{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((f,m)=>m),error:"No addresses have valid coordinates for route optimization"};if(n.length===1)return{success:!0,optimizedOrder:[n[0].originalIndex],totalDistance:0,totalDuration:0,unassigned:[]};console.log(`Optimizing route for ${n.length} addresses via OpenRouteService (hybrid service)`);const a={addresses:n.map(f=>({address:f.address,lat:f.lat,lng:f.lng})),startLocation:r,endLocation:t};console.log("Route optimization request:",{addressCount:a.addresses.length,hasStartLocation:!!r,hasEndLocation:!!t,firstAddress:a.addresses[0]});let l=null,c=null;try{const f="https://eevfxrgemrtthxbcxtvq.supabase.co",m="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",g=`${f}/functions/v1/optimize-route`,x=(await Be.auth.getSession()).data.session?.access_token;console.log("Making direct request to Edge Function:",{url:g,hasAuthToken:!!x,requestBodySize:JSON.stringify(a).length});const y={"Content-Type":"application/json",apikey:m};x&&(y.Authorization=`Bearer ${x}`);const b=await fetch(g,{method:"POST",headers:y,body:JSON.stringify(a)});if(console.log("Edge Function response status:",{status:b.status,statusText:b.statusText,ok:b.ok,headers:Object.fromEntries(b.headers.entries())}),b.ok)l=await b.json();else{const E=await b.text();console.error("Edge Function error response:",{status:b.status,statusText:b.statusText,body:E});try{const S=JSON.parse(E);c=new Error(`Edge Function error (${b.status}): ${S.error||E}`)}catch{c=new Error(`Edge Function error (${b.status}): ${E}`)}}}catch(f){console.error("Failed to make direct request to Edge Function:",f);const m=await Be.functions.invoke("optimize-route",{body:a});l=m.data,c=m.error}if(c){console.error("Route optimization error details:",{error:c,errorMessage:c.message,errorName:c.name,errorStack:c.stack,data:l});let f=`Route optimization service error: ${c.message||"Unknown error"}`;return c.message?.includes("OpenRouteService API key")?f="Route optimization service not configured. Please contact support.":c.message?.includes("non-2xx status code")?f="Route optimization service is temporarily unavailable. Please try again later.":c.message?.includes("Unauthorized")?f="Authentication required. Please log in again.":c.message?.includes("Subscription required")?f="Route optimization requires an active subscription.":c.message?.includes("OpenRouteService API error")?f=`OpenRouteService API error: ${c.message.split("OpenRouteService API error: ")[1]||c.message}`:c.message?.includes("Maximum 100 addresses")?f="Too many addresses. Maximum 100 addresses allowed per optimization.":c.message?.includes("No addresses have valid coordinates")&&(f="No addresses have valid coordinates for route optimization."),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((m,g)=>g),error:f}}return console.log("Route optimization response received:",{hasData:!!l,dataKeys:l?Object.keys(l):null,success:l?.success}),l?(console.log(`Route optimization completed: ${l.optimizedOrder?.length||0} addresses optimized`),l):(console.error("Route optimization: No data received from Edge Function"),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((f,m)=>m),error:"No response from optimization service"})}catch(n){return console.error("Route optimization failed:",n),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((a,l)=>l),error:n instanceof Error?n.message:"Unknown error occurred"}}}async function uD(e,r,t){if(!Be)return{success:!1,routeSegments:[],error:"Supabase client not available"};try{const n=[];t&&n.push(t);for(const c of r){const f=e[c];f.lat&&f.lng&&n.push([f.lng,f.lat])}if(n.length<2)return{success:!1,routeSegments:[],error:"Need at least 2 waypoints to generate route"};const{data:a,error:l}=await Be.functions.invoke("get-route-directions",{body:{coordinates:n,profile:"driving-car"}});return l?(console.error("Route directions error:",l),{success:!1,routeSegments:[],error:l.message||"Failed to get route directions"}):{success:!0,routeSegments:a?.segments||[],error:void 0}}catch(n){return console.error("Failed to get route directions:",n),{success:!1,routeSegments:[],error:n instanceof Error?n.message:"Unknown error occurred"}}}function dD({id:e,value:r,onChange:t,onSelect:n,placeholder:a="Start typing an address...",disabled:l=!1,className:c="input"}){const[f,m]=Y.useState([]),[g,x]=Y.useState(!1),[y,b]=Y.useState(!1),[E,S]=Y.useState(-1),k=Y.useRef(null),C=Y.useRef(null),R=Y.useRef(),j=Y.useCallback(async O=>{if(!O.trim()||O.length<3){Y.startTransition(()=>{m([]),b(!1)});return}x(!0);try{const ne=await lD(O);Y.startTransition(()=>{m(ne),b(ne.length>0),S(-1)})}catch(ne){console.error("Address search failed:",ne),Y.startTransition(()=>{m([]),b(!1)})}finally{x(!1)}},[]),N=O=>{const ne=O.target.value;t(ne),R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{j(ne)},300)},F=async O=>{if(O.placeId){x(!0);try{const ne=await iD(O.placeId);ne?(t(O.label),n(O.label,ne.lat,ne.lng)):(t(O.label),n(O.label,0,0))}catch(ne){console.error("Failed to resolve place details:",ne),t(O.label),n(O.label,0,0)}finally{x(!1)}}else{const[ne,ee]=O.coordinates;t(O.label),n(O.label,ee,ne)}Y.startTransition(()=>{b(!1),S(-1),m([])}),setTimeout(()=>{k.current?.blur()},0)},K=O=>{if(!(!y||f.length===0))switch(O.key){case"ArrowDown":O.preventDefault(),S(ne=>ne<f.length-1?ne+1:ne);break;case"ArrowUp":O.preventDefault(),S(ne=>ne>0?ne-1:-1);break;case"Enter":O.preventDefault(),E>=0&&E<f.length&&F(f[E]);break;case"Escape":Y.startTransition(()=>{b(!1),S(-1)}),setTimeout(()=>{k.current?.blur()},0);break}};Y.useEffect(()=>{const O=ne=>{try{k.current&&!k.current.contains(ne.target)&&C.current&&!C.current.contains(ne.target)&&Y.startTransition(()=>{b(!1),S(-1)})}catch(ee){console.debug("Click outside detection error (ignoring):",ee)}};return document.addEventListener("mousedown",O),()=>{try{document.removeEventListener("mousedown",O)}catch(ne){console.debug("Event listener cleanup error (ignoring):",ne)}}},[]),Y.useEffect(()=>()=>{R.current&&clearTimeout(R.current)},[]);const z=O=>O>=.8?"var(--success)":O>=.5?"var(--warning)":"var(--danger)";return u.jsxs("div",{style:{position:"relative",width:"100%"},children:[u.jsxs("div",{style:{position:"relative"},children:[u.jsx("input",{id:e,ref:k,name:"address",type:"text",value:r,onChange:N,onKeyDown:K,onFocus:()=>{f.length>0&&b(!0)},placeholder:a,disabled:l,className:c,style:{width:"100%",paddingRight:g?"2.5rem":"1rem"},autoComplete:"off"}),g&&u.jsx("div",{style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem"},children:u.jsx("div",{className:"spinner",style:{width:"100%",height:"100%"}})})]}),y&&f.length>0&&u.jsx("div",{ref:C,style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",maxHeight:"300px",overflowY:"auto",marginTop:"0.25rem"},children:f.map((O,ne)=>u.jsxs("button",{onClick:()=>{setTimeout(()=>F(O),0)},style:{width:"100%",padding:"0.75rem 1rem",border:"none",background:E===ne?"var(--primary-light)":"transparent",color:E===ne?"var(--primary)":"var(--text-primary)",textAlign:"left",cursor:"pointer",borderBottom:ne<f.length-1?"1px solid var(--border-light)":"none",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem",lineHeight:"1.4"},onMouseEnter:()=>S(ne),children:[u.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis"},children:O.label}),u.jsxs("span",{style:{fontSize:"0.75rem",color:z(O.confidence),marginLeft:"0.5rem",flexShrink:0},title:`Confidence: ${Math.round(O.confidence*100)}%`,children:[Math.round(O.confidence*100),"%"]})]},`${O.label}-${ne}`))}),y&&f.length===0&&!g&&r.length>=3&&u.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",padding:"1rem",marginTop:"0.25rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.875rem"},children:/[A-Z]{1,2}[0-9]{1,2}\s?[0-9][A-Z]{2}/i.test(r)?"Address not found. Try removing the house number or use just the postcode.":'No addresses found. Try including the postcode (e.g., "High Street SW1A 1AA").'})]})}function fD(e,r,t,n){let a="marker-pin";return r?a+=" marker-start":t?n!==void 0&&(n<.5?a+=" marker-low-confidence":n<.8&&(a+=" marker-medium-confidence")):a+=" marker-not-geocoded",Qc.divIcon({className:"custom-numbered-marker",html:`<div class="${a}">
      <div class="marker-number">${r?"":e}</div>
    </div>`,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]})}function hD({pins:e}){const r=By();return Y.useEffect(()=>{if(e.length!==0)if(e.length===1){const t=e[0];r.setView([t.lat,t.lng],15)}else{const t=new Qc.FeatureGroup(e.map(n=>Qc.marker([n.lat,n.lng])));r.fitBounds(t.getBounds().pad(.1))}},[r,e.length]),null}function mD({addresses:e,startingPointIndex:r,onStartingPointChange:t,optimizedOrder:n,showRouteLines:a=!1,confidences:l}){const[c,f]=Y.useState([]),[m,g]=Y.useState(!1),b=e.map((j,N)=>({id:`pin-${N}`,address:j.address,lat:j.lat||0,lng:j.lng||0,isStart:N===r,isGeocoded:!!(j.lat&&j.lng),confidence:l?.[N]})).filter(j=>j.isGeocoded),E=Y.useRef("");Y.useEffect(()=>{async function j(){if(!a||!n||n.length<2){f([]),E.current="";return}const N=n.filter(K=>K<0||K>=e.length);if(N.length>0){console.error("Invalid optimizedOrder indices:",N),f([]);return}const F=`${n.join(",")}-${r}`;if(E.current!==F){g(!0);try{const K=r!==void 0&&e[r]?[e[r].lng,e[r].lat]:void 0,z=await uD(e,n,K);z.success?(f(z.routeSegments),E.current=F):(console.error("Route directions failed:",z.error),f([]))}catch(K){console.error("Route directions error:",K),f([])}finally{g(!1)}}}j()},[a,n,e.length,r]);const S=j=>{t(r===j?null:j)},k=(j,N)=>N<=1?"#3388ff":`hsl(${(1-j/(N-1))*120}, 70%, 50%)`,C=[54.5,-2];return u.jsxs("div",{style:{height:"100%",width:"100%"},children:[u.jsxs(zy,{center:C,zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[u.jsx($y,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u.jsx(hD,{pins:b}),b.map((j,N)=>{const F=e.findIndex(K=>K.lat===j.lat&&K.lng===j.lng&&K.address===j.address);return u.jsx(Uy,{position:[j.lat,j.lng],icon:fD(N+1,j.isStart,j.isGeocoded,j.confidence),children:u.jsx(M0,{children:u.jsxs("div",{style:{minWidth:"200px"},children:[u.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:j.address}),u.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.5rem"},children:["Lat: ",j.lat.toFixed(6),", Lng: ",j.lng.toFixed(6)]}),j.confidence&&u.jsxs("div",{style:{fontSize:"0.875rem",marginBottom:"0.5rem",color:j.confidence>=.8?"var(--success)":j.confidence>=.5?"var(--warning)":"var(--danger)"},children:["Confidence: ",Math.round(j.confidence*100),"%"]}),u.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:u.jsx("button",{onClick:()=>S(F),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:j.isStart?"var(--success)":"var(--primary)",color:"white",border:"none",borderRadius:"var(--radius)",cursor:"pointer"},children:j.isStart?" Starting Point":" Set as Start"})})]})})},j.id)}),a&&c.map((j,N)=>{const F=j.geometry.map(K=>[K[1],K[0]]);return u.jsx(m5,{positions:F,color:k(N,c.length),weight:4,opacity:.8,dashArray:N===0?void 0:"5, 5",children:u.jsx(M0,{children:u.jsxs("div",{children:[u.jsxs("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:["Route Segment ",N+1]}),u.jsxs("div",{style:{fontSize:"0.875rem"},children:["Distance: ",(j.distance/1e3).toFixed(1)," km",u.jsx("br",{}),"Duration: ",Math.round(j.duration/60)," min"]})]})})},`route-segment-${N}`)})]}),m&&u.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",background:"var(--surface)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",boxShadow:"var(--shadow)",fontSize:"0.875rem",zIndex:1e3},children:" Loading route directions..."}),u.jsx("style",{children:`
        /* Custom Numbered Markers */
        .custom-numbered-marker {
          background: transparent;
          border: none;
        }

        .marker-pin {
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .marker-pin::before {
          content: '';
          position: absolute;
          width: 36px;
          height: 36px;
          background: var(--primary);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          border: 3px solid white;
        }

        .marker-pin.marker-start::before {
          background: var(--success);
          animation: markerPulse 2s ease-in-out infinite;
        }

        .marker-pin.marker-not-geocoded::before {
          background: var(--gray-400);
        }

        .marker-pin.marker-low-confidence::before {
          background: var(--danger);
        }

        .marker-pin.marker-medium-confidence::before {
          background: var(--warning);
        }

        @keyframes markerPulse {
          0%, 100% {
            transform: rotate(-45deg) scale(1);
          }
          50% {
            transform: rotate(-45deg) scale(1.1);
          }
        }

        .marker-number {
          position: relative;
          z-index: 1;
          color: white;
          font-weight: bold;
          font-size: 0.875rem;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
          transform: translateY(-2px);
        }

        /* Leaflet Popup Override for Dark Mode */
        .leaflet-popup-content-wrapper {
          background: var(--surface) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--border) !important;
          box-shadow: 0 3px 14px rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-tip {
          background: var(--surface) !important;
          border: 1px solid var(--border) !important;
        }

        .leaflet-popup-close-button {
          color: var(--text-primary) !important;
        }

        .leaflet-popup-close-button:hover {
          color: var(--primary) !important;
        }
      `})]})}const pD=function({user:r,onAddressesReady:t}){const[n,a]=Y.useState([]),[l,c]=Y.useState(""),[f,m]=Y.useState(!1),[g,x]=Y.useState(!1),[y,b]=Y.useState(null),[E,S]=Y.useState(!0),[k,C]=Y.useState(!1),[R,j]=Y.useState(null),[N,F]=Y.useState(null),K=Y.useCallback(V=>{const H=V.map(z0);a(H),F(null),b(null)},[]),z=()=>{if(!l.trim())return;const V={success:!1,address:l.trim(),originalAddress:l.trim(),error:"Not geocoded yet"};Y.startTransition(()=>{a(H=>[...H,V]),c(""),F(null)})},O=(V,H,se)=>{const D={success:!0,address:V,originalAddress:V,lat:H,lng:se,confidence:1,formattedAddress:V};Y.startTransition(()=>{a(P=>[...P,D]),c(""),F(null)})},ne=V=>{Y.startTransition(()=>{a(H=>H.filter((se,D)=>D!==V)),F(null),y===V?b(null):y!==null&&y>V&&b(y-1)})},ee=(V,H)=>{Y.startTransition(()=>{a(se=>se.map((D,P)=>P===V?{...D,address:H,success:!1,error:"Modified - needs geocoding"}:D)),F(null)})},ve=async V=>{const H=n[V];if(!H.success)try{const se=await fx([H.address]),D=[...n];D[V]=se[0],a(D),F(null)}catch(se){console.error("Single geocoding failed:",se),alert("Geocoding failed. Please check your connection and subscription.")}},he=(V,H,se)=>{const D=[...n];D[V]={...D[V],lat:H,lng:se,success:H!==void 0&&se!==void 0,formattedAddress:D[V].formattedAddress||D[V].address,error:H!==void 0&&se!==void 0?void 0:"Manual coordinates incomplete"},a(D),F(null)},ce=async()=>{const V=n.map((H,se)=>({addr:H,index:se})).filter(({addr:H})=>!H.success);if(V.length===0){alert("All addresses are already geocoded!");return}x(!0),j({completed:0,total:V.length,current:""});try{const H=V.map(({addr:P})=>P.address),se=await fx(H,(P,I,B)=>{j({completed:P,total:I,current:B})}),D=[...n];V.forEach(({index:P},I)=>{D[P]=se[I]}),a(D),F(null)}catch(H){console.error("Batch geocoding failed:",H),alert("Geocoding failed. Please check your connection and subscription.")}finally{x(!1),j(null)}},Ne=async()=>{const V=n.filter(H=>H.success&&H.lat&&H.lng);if(V.length===0){alert("No addresses with valid coordinates available for optimization");return}if(V.length<n.length){const H=n.length-V.length;if(!confirm(`${H} addresses don't have coordinates and will be excluded from optimization. Continue?`))return}m(!0),F(null);try{const H=n.map(Wd);let se;if(y!==null&&y>=0){const P=n[y];P.success&&P.lat&&P.lng&&(se=[P.lng,P.lat])}const D=await cD(H,se);if(F({optimizedOrder:D.optimizedOrder,totalDistance:D.totalDistance,totalDuration:D.totalDuration,unassigned:D.unassigned,error:D.error}),D.success&&D.optimizedOrder.length>0){const P=D.optimizedOrder.map(I=>n[I]);if(a(P),F({optimizedOrder:P.map((I,B)=>B),totalDistance:D.totalDistance,totalDuration:D.totalDuration,unassigned:D.unassigned,error:D.error}),y!==null){const I=D.optimizedOrder.indexOf(y);b(I>=0?I:null)}}}catch(H){console.error("Route optimization failed:",H),F({optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:[],error:H instanceof Error?H.message:"Optimization failed"})}finally{m(!1)}},xe=()=>{const V=n.map(Wd);t(V),alert(`Exported ${V.length} addresses to your main address list!`)},le=()=>{confirm("Are you sure you want to clear all addresses?")&&(a([]),F(null),b(null))},Q=V=>{const H=V.map(z0);a(H),F(null)},M={total:n.length,geocoded:n.filter(V=>V.success).length,needsGeocoding:n.filter(V=>!V.success).length,highConfidence:n.filter(V=>V.success&&(V.confidence||0)>=.8).length,lowConfidence:n.filter(V=>V.success&&(V.confidence||0)<.5).length};return u.jsx(Gy,{user:r,fallback:u.jsx(gD,{}),children:u.jsxs("div",{className:"route-planning",style:{maxWidth:"100%",padding:"0"},children:[!1,n.length===0&&u.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)",overflow:"hidden"},children:[u.jsxs("button",{onClick:()=>C(!k),style:{width:"100%",padding:"1rem 1.5rem",background:"transparent",border:"none",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",color:"var(--text-primary)",fontSize:"1rem",fontWeight:"600"},children:[u.jsx("span",{children:" Import Excel File"}),u.jsx("span",{style:{fontSize:"1.25rem"},children:k?"":""})]}),k&&u.jsx("div",{style:{padding:"0 1.5rem 1.5rem 1.5rem"},children:u.jsx(X1,{onImported:K})})]}),n.length>0&&u.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[u.jsx("h3",{style:{margin:0,fontSize:"1.125rem",color:"var(--text-primary)"},children:" Map View"}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>S(!E),children:E?"Hide":"Show"})]}),E&&u.jsx("div",{style:{height:"400px",borderRadius:"var(--radius-md)",overflow:"hidden",border:"1px solid var(--border)"},children:u.jsx(mD,{addresses:n.map(Wd),onAddressesUpdate:Q,startingPointIndex:y??void 0,onStartingPointChange:b,optimizedOrder:N?.optimizedOrder,showRouteLines:!!N&&!N.error,confidences:n.map(V=>V.confidence)})})]}),u.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsx(dD,{id:"manual-address-input",value:l,onChange:c,onSelect:O,placeholder:"Type an address to add...",disabled:!1}),u.jsx("button",{className:"btn btn-primary",onClick:z,disabled:!l.trim(),style:{width:"100%",marginTop:"0.5rem",padding:"0.75rem",fontSize:"0.9375rem",fontWeight:"600"},children:"+ Add Address"})]}),N&&u.jsx("div",{style:{marginBottom:"1rem",padding:"1rem",background:"var(--surface)",border:N.error?"2px solid var(--danger)":"2px solid var(--success)",borderRadius:"var(--radius-md)",color:N.error?"var(--danger)":"var(--success)"},children:N.error?u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.25rem",fontSize:"0.9375rem"},children:" Optimization Failed"}),u.jsx("div",{style:{fontSize:"0.8125rem"},children:N.error})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem",fontSize:"0.9375rem"},children:" Route Optimized"}),u.jsxs("div",{style:{fontSize:"0.8125rem",lineHeight:"1.5"},children:[u.jsxs("div",{children:[" ",N.optimizedOrder.length," stops"]}),u.jsxs("div",{children:[" ",Zy(N.totalDuration)]}),u.jsxs("div",{children:[" ",Ky(N.totalDistance)]})]})]})}),n.length>0&&M.geocoded>=2&&u.jsx("button",{className:"btn btn-primary",onClick:Ne,disabled:f,style:{width:"100%",padding:"0.875rem",fontSize:"1rem",fontWeight:"600"},children:f?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"spinner",style:{display:"inline-block",width:"1rem",height:"1rem",marginRight:"0.5rem"}}),"Optimizing..."]}):` Optimize ${M.geocoded} Address${M.geocoded>1?"es":""}`})]}),n.length>0&&u.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsx("h3",{style:{margin:0,fontSize:"1.125rem",color:"var(--text-primary)"},children:N&&!N.error&&N.optimizedOrder.length>0?" Optimized Route":`Addresses (${n.length})`}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[M.needsGeocoding>0&&u.jsx("button",{className:"btn btn-primary btn-sm",onClick:ce,disabled:g,style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem",whiteSpace:"nowrap"},children:g?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"spinner",style:{display:"inline-block",width:"0.875rem",height:"0.875rem",marginRight:"0.25rem"}}),"Geocoding..."]}):` Geocode ${M.needsGeocoding}`}),y!==null&&u.jsxs("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-md)",fontSize:"0.75rem",fontWeight:"600"},children:["Start: #",y+1]})]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-around",gap:"0.5rem",padding:"0.75rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)",fontSize:"0.75rem"},children:[u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--primary)"},children:M.total}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Total"})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--success)"},children:M.geocoded}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Ready"})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--warning)"},children:M.needsGeocoding}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Pending"})]})]})]}),R&&u.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--primary-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--primary)"},children:[u.jsxs("div",{style:{marginBottom:"0.5rem",fontWeight:"600",color:"var(--primary)",fontSize:"0.875rem"},children:["Geocoding ",R.completed," of ",R.total]}),u.jsx("div",{style:{background:"var(--gray-200)",borderRadius:"999px",height:"0.375rem",overflow:"hidden"},children:u.jsx("div",{style:{background:"var(--primary)",height:"100%",width:`${R.completed/R.total*100}%`,transition:"width 0.3s ease",borderRadius:"999px"}})})]}),u.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",margin:"0 -1.5rem",padding:"0 1.5rem"},children:[...n].sort((V,H)=>!V.success&&H.success?-1:V.success&&!H.success?1:0).map(V=>{const H=n.indexOf(V);return u.jsxs("div",{style:{padding:"1rem",borderBottom:H<n.length-1?"1px solid var(--border-light)":"none",display:"flex",alignItems:"flex-start",gap:"0.75rem",background:H===y?"var(--primary-light)":"transparent",borderRadius:"var(--radius-md)",marginBottom:H<n.length-1?"0.5rem":"0"},children:[u.jsx("div",{style:{minWidth:"2rem",height:"2rem",borderRadius:"50%",background:H===y?"var(--primary)":V.success?"var(--success)":"var(--warning)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0,cursor:"pointer"},onClick:()=>b(H===y?null:H),title:H===y?"Remove as starting point":"Set as starting point",children:H===y?"":H+1}),u.jsxs("div",{style:{flex:1,minWidth:0},children:[u.jsx("input",{name:`address-${H}`,type:"text",value:V.address,onChange:se=>ee(H,se.target.value),className:"input",style:{width:"100%",marginBottom:"0.5rem",fontSize:"0.9375rem",padding:"0.5rem",border:"1px solid var(--border)"}}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",lineHeight:"1.4"},children:V.success?u.jsxs(u.Fragment,{children:[u.jsx("span",{style:{color:"var(--success)"},children:""})," ",V.formattedAddress||V.address,V.confidence&&u.jsx("span",{style:{display:"inline-block",marginLeft:"0.5rem",padding:"0.125rem 0.5rem",borderRadius:"999px",background:V.confidence>=.8?"var(--success-light)":V.confidence>=.5?"var(--warning-light)":"var(--danger-light)",color:V.confidence>=.8?"var(--success-dark)":V.confidence>=.5?"var(--warning-dark)":"var(--danger-dark)",fontSize:"0.75rem",fontWeight:"600"},children:qy(V.confidence)})]}):u.jsxs("span",{style:{color:"var(--warning)"},children:[" ",V.error]})}),!V.success&&u.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem",alignItems:"center"},children:[u.jsx("input",{type:"number",step:"any",placeholder:"Latitude",value:V.lat??"",onChange:se=>{const D=se.target.value?parseFloat(se.target.value):void 0;he(H,D,V.lng)},className:"input",style:{flex:1,fontSize:"0.75rem",padding:"0.375rem 0.5rem",border:"1px solid var(--border)"}}),u.jsx("input",{type:"number",step:"any",placeholder:"Longitude",value:V.lng??"",onChange:se=>{const D=se.target.value?parseFloat(se.target.value):void 0;he(H,V.lat,D)},className:"input",style:{flex:1,fontSize:"0.75rem",padding:"0.375rem 0.5rem",border:"1px solid var(--border)"}})]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.25rem",flexShrink:0},children:[!V.success&&u.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>ve(H),title:"Geocode this address",style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem",minWidth:"auto"},children:""}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ne(H),title:"Remove",style:{padding:"0.5rem",minWidth:"auto",fontSize:"1.125rem"},children:""})]})]},H)})})]}),n.length>0&&u.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginBottom:"1rem"},children:[u.jsx("button",{className:"btn btn-success",onClick:xe,style:{flex:1,padding:"0.875rem",fontSize:"1rem",fontWeight:"600"},children:" Export to Main List"}),u.jsx("button",{className:"btn btn-ghost",onClick:le,style:{padding:"0.875rem",fontSize:"1rem"},children:""})]}),n.length===0&&u.jsxs("div",{style:{textAlign:"center",padding:"3rem 1.5rem",background:"var(--surface)",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[u.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:""}),u.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--text-primary)"},children:"Start Planning Your Route"}),u.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem",fontSize:"0.9375rem"},children:"Import addresses from Excel or add them manually"})]})]})})};function gD(){return u.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--gray-100)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",boxShadow:"var(--shadow-sm)",color:"var(--gray-800)"},children:[u.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),u.jsx("h2",{children:"Route Planning"}),u.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--gray-500)"},children:"Plan your daily routes with intelligent address geocoding and route optimization."}),u.jsx("div",{style:{marginBottom:"1.5rem"},children:u.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius-md)",fontSize:"0.875rem"},children:"Premium Feature"})}),u.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--gray-500)",textAlign:"left",maxWidth:"400px",margin:"0 auto"},children:[u.jsx("div",{style:{marginBottom:"0.5rem"},children:" Import addresses from Excel"}),u.jsx("div",{style:{marginBottom:"0.5rem"},children:" Google-style address autocomplete"}),u.jsx("div",{style:{marginBottom:"0.5rem"},children:" Automatic geocoding with confidence scores"}),u.jsx("div",{style:{marginBottom:"0.5rem"},children:" Intelligent route optimization"}),u.jsx("div",{style:{marginBottom:"0.5rem"},children:" Manual address correction"}),u.jsx("div",{children:" Export to main address list"})]})]})}const vD=Y.memo(pD);function xD({onSetupComplete:e,onSkip:r,isOpen:t}){const[n,a]=Wt.useState(""),[l,c]=Wt.useState(""),[f,m]=Wt.useState(!1),[g,x]=Wt.useState("idle"),[y,b]=Wt.useState("");if(!t)return null;const E=async()=>{if(!n||!l){b("Please enter both URL and key");return}m(!0),x("idle"),b("");try{if(!new URL(n).hostname.includes("supabase"))throw new Error("URL should be a Supabase project URL (e.g., https://your-project.supabase.co)");const C=Cy(n,l),{data:R,error:j}=await C.auth.getSession();if(j&&j.message!=="Auth session missing!")throw j;x("success"),be.info("Supabase connection test successful")}catch(k){x("error"),b(k.message||"Connection failed"),be.error("Supabase connection test failed:",k)}finally{m(!1)}},S=()=>{g==="success"&&e(n,l)};return u.jsxs("div",{className:"modal-overlay",children:[u.jsxs("div",{className:"modal-content",style:{maxWidth:"600px"},children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{children:" Optional: Connect Your Own Cloud Storage"}),u.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem"},children:"Set up your own Supabase project for cloud backup and sync (completely optional)"})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--blue-50)",borderRadius:"var(--radius-md)",border:"1px solid var(--blue-200)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem",color:"var(--blue-700)"},children:" Quick Setup Instructions"}),u.jsxs("ol",{style:{margin:0,paddingLeft:"1.2rem",color:"var(--blue-600)",fontSize:"0.9rem"},children:[u.jsxs("li",{children:["Go to ",u.jsx("a",{href:"https://supabase.com",target:"_blank",rel:"noopener",children:"supabase.com"})," and create a free account"]}),u.jsx("li",{children:"Create a new project (choose any name/region)"}),u.jsx("li",{children:"Go to Settings  API in your project dashboard"}),u.jsx("li",{children:"Copy your Project URL and anon/public key below"})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"supabase-url",children:"Project URL *"}),u.jsx("input",{id:"supabase-url",type:"url",value:n,onChange:k=>a(k.target.value),placeholder:"https://your-project-id.supabase.co",style:{fontFamily:"monospace"}})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"supabase-key",children:"Anonymous/Public Key *"}),u.jsx("textarea",{id:"supabase-key",value:l,onChange:k=>c(k.target.value),placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",rows:3,style:{fontFamily:"monospace",fontSize:"0.85rem"}})]}),g==="success"&&u.jsx("div",{style:{padding:"0.75rem",background:"var(--green-50)",border:"1px solid var(--green-200)",borderRadius:"var(--radius-md)",color:"var(--green-700)"},children:" Connection successful! Your Supabase project is ready."}),g==="error"&&u.jsxs("div",{style:{padding:"0.75rem",background:"var(--red-50)",border:"1px solid var(--red-200)",borderRadius:"var(--radius-md)",color:"var(--red-700)"},children:[" ",y]}),u.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem"},children:" Privacy & Security"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--gray-600)"},children:[u.jsx("li",{children:"Your credentials are stored locally in your browser only"}),u.jsx("li",{children:"All data goes directly to YOUR Supabase project"}),u.jsx("li",{children:"We never see or access your data"}),u.jsx("li",{children:"You can disconnect at any time"})]})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Skip (Use Offline Only)"}),u.jsx("button",{className:"btn btn-primary",onClick:E,disabled:!n||!l||f,children:f?" Testing...":" Test Connection"}),u.jsx("button",{className:"btn btn-success",onClick:S,disabled:g!=="success",children:" Save & Connect"})]})]}),u.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: white;
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
          flex-wrap: wrap;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .form-group input,
        .form-group textarea {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-size: 0.9rem;
        }

        .form-group input:focus,
        .form-group textarea:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        @media (max-width: 640px) {
          .modal-footer {
            flex-direction: column;
          }

          .modal-footer button {
            width: 100%;
          }
        }
      `})]})}class Na{static BACKUP_KEY="navigator_local_backups";static MAX_BACKUPS=10;static downloadBackup(r,t){try{const n=new Date().toISOString().replace(/[:.]/g,"-"),a=t||`navigator-backup-${n}.json`,l=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),c=URL.createObjectURL(l),f=document.createElement("a");f.href=c,f.download=a,document.body.appendChild(f),f.click();try{f.parentNode===document.body&&document.body.removeChild(f)}catch(m){be.warn("Non-critical DOM cleanup error during backup download:",m)}URL.revokeObjectURL(c),be.info(`Backup downloaded: ${a} (${l.size} bytes)`)}catch(n){throw be.error("Failed to download backup:",n),n}}static storeLocalBackup(r){try{const t=this.getLocalBackups(),a={timestamp:new Date().toISOString(),data:r,size:JSON.stringify(r).length,version:r._schemaVersion||1};t.unshift(a);const l=t.slice(0,this.MAX_BACKUPS);localStorage.setItem(this.BACKUP_KEY,JSON.stringify(l)),be.info(`Local backup stored (${l.length}/${this.MAX_BACKUPS})`)}catch(t){be.error("Failed to store local backup:",t)}}static getLocalBackups(){try{const r=localStorage.getItem(this.BACKUP_KEY);return r?JSON.parse(r):[]}catch(r){return be.error("Failed to get local backups:",r),[]}}static restoreFromLocalBackup(r){const t=this.getLocalBackups();if(r<0||r>=t.length)throw new Error("Invalid backup index");return t[r].data}static async getStorageUsage(){if("storage"in navigator&&"estimate"in navigator.storage)try{const r=await navigator.storage.estimate(),t=r.usage||0,n=r.quota||0,a=n>0?t/n*100:0;return{used:t,quota:n,percentage:a}}catch(r){be.warn("Failed to get storage estimate:",r)}return{used:0,quota:0,percentage:0}}static async isStorageLow(){const{percentage:r}=await this.getStorageUsage();return r>80}static createComprehensiveBackup(r){return{version:"1.0",created:new Date().toISOString(),platform:navigator.platform,userAgent:navigator.userAgent.substring(0,100),app:{name:"Navigator Web",version:"1.0.0"},data:r,checksum:co(r)}}static verifyBackup(r){try{return!r.data||!r.checksum?!1:co(r.data)===r.checksum}catch(t){return be.error("Backup verification failed:",t),!1}}static async performCriticalBackup(r,t){try{if(be.info(`Performing critical backup: ${t}`),this.storeLocalBackup(r),this.shouldDownloadBackup(t)){const l=this.createComprehensiveBackup(r);this.downloadBackup(l,`navigator-critical-${t}-${Date.now()}.json`),be.info(`Backup file downloaded for critical event: ${t}`)}await this.isStorageLow()&&be.warn("Browser storage is running low!")}catch(n){throw be.error("Critical backup failed:",n),n}}static shouldDownloadBackup(r){return["manual","import","day-end","restore","data-loss-risk"].includes(r)}static cleanupOldBackups(){try{const r=this.getLocalBackups(),t=new Date;t.setDate(t.getDate()-30);const n=r.filter(a=>new Date(a.timestamp)>t);n.length!==r.length&&(localStorage.setItem(this.BACKUP_KEY,JSON.stringify(n)),be.info(`Cleaned up ${r.length-n.length} old backups`))}catch(r){be.error("Failed to cleanup old backups:",r)}}static getBackupStats(){const r=this.getLocalBackups(),t=r.reduce((l,c)=>l+(c.size||0),0),n=r.length>0?r[r.length-1].timestamp:null,a=r.length>0?r[0].timestamp:null;return{count:r.length,totalSize:t,oldestDate:n,newestDate:a}}}function yD({currentData:e,onRestore:r,isOpen:t,onClose:n}){const[a,l]=Wt.useState([]),[c,f]=Wt.useState({used:0,quota:0,percentage:0}),[m,g]=Wt.useState(!1);Wt.useEffect(()=>{t&&(x(),y())},[t]);const x=()=>{try{const j=Na.getLocalBackups();l(j)}catch(j){be.error("Failed to load backups:",j)}},y=async()=>{try{const j=await Na.getStorageUsage();f(j)}catch(j){be.error("Failed to load storage usage:",j)}},b=async()=>{g(!0);try{await Na.performCriticalBackup(e,"manual"),x(),be.info("Manual backup created successfully")}catch(j){be.error("Failed to create manual backup:",j)}finally{g(!1)}},E=j=>{try{const N=Na.restoreFromLocalBackup(j);r(N),n()}catch(N){be.error("Failed to restore from backup:",N)}},S=(j,N)=>{try{const F=new Date(j.timestamp).toISOString().replace(/[:.]/g,"-");Na.downloadBackup(j.data,`navigator-backup-${F}.json`)}catch(F){be.error("Failed to download backup:",F)}},k=j=>{if(j===0)return"0 B";const N=1024,F=["B","KB","MB","GB"],K=Math.floor(Math.log(j)/Math.log(N));return parseFloat((j/Math.pow(N,K)).toFixed(1))+" "+F[K]},C=j=>new Date(j).toLocaleString(),R=j=>j>80?"var(--danger)":j>60?"var(--warning)":"var(--success)";return t?u.jsxs("div",{className:"modal-overlay",children:[u.jsxs("div",{className:"modal-content",style:{maxWidth:"800px"},children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{children:" Backup Manager"}),u.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem",color:"var(--text-primary)"},children:"Local backups are automatically created and downloaded to prevent data loss"})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius-md)"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:" Storage Usage"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[u.jsx("div",{style:{flex:1,height:"8px",background:"var(--gray-200)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{height:"100%",background:R(c.percentage),width:`${Math.min(c.percentage,100)}%`,transition:"width 0.3s ease"}})}),u.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",minWidth:"60px"},children:[c.percentage.toFixed(1),"%"]})]}),u.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:[k(c.used)," of ",k(c.quota)," used",c.percentage>80&&u.jsx("span",{style:{color:"var(--danger)",fontWeight:500,marginLeft:"0.5rem"},children:" Storage running low!"})]})]}),u.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--info-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--info)"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--info-dark)"},children:" Create Manual Backup"}),u.jsx("p",{style:{margin:"0 0 1rem",fontSize:"0.85rem",color:"var(--info-dark)"},children:"Create an immediate backup and download it to your computer for safekeeping."}),u.jsx("button",{className:"btn btn-primary",onClick:b,disabled:m,children:m?" Creating...":" Create & Download Backup"})]}),u.jsxs("div",{children:[u.jsxs("h4",{style:{margin:"0 0 1rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:[" Local Backups (",a.length,")"]}),a.length===0?u.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"No local backups found. Create your first backup above!"}):u.jsx("div",{style:{maxHeight:"300px",overflow:"auto"},children:a.map((j,N)=>u.jsx("div",{style:{padding:"1rem",border:"1px solid var(--border-light)",borderRadius:"var(--radius-md)",marginBottom:"0.5rem",background:"var(--surface)"},children:u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:500,fontSize:"0.9rem",color:"var(--text-primary)"},children:C(j.timestamp)}),u.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:["Size: ",k(j.size||0),"  Version: ",j.version||1]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>S(j),title:"Download backup file",children:""}),u.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>E(N),title:"Restore from this backup",children:" Restore"})]})]})},N))})]}),u.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"var(--success-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--success)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem",color:"var(--success-dark)"},children:" Data Protection Features"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--success-dark)"},children:[u.jsx("li",{children:"Automatic backups every 5 minutes when data changes"}),u.jsx("li",{children:"Critical backups downloaded after completions"}),u.jsx("li",{children:"Local browser storage with 10 backup rotation"}),u.jsx("li",{children:"Storage monitoring and cleanup"}),u.jsx("li",{children:"Data integrity verification"})]})]})]}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Close"})})]}),u.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: var(--surface);
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border-light);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
        }

        .btn-sm {
          padding: 0.375rem 0.75rem;
          font-size: 0.8rem;
        }
      `})]}):null}function _D({settings:e,onUpdateSettings:r,onClose:t}){const[n,a]=Y.useState(e),[l,c]=Y.useState("templates"),[f,m]=Y.useState(null),[g,x]=Y.useState(""),[y,b]=Y.useState(!1),[E,S]=Y.useState(!1),k=async()=>{S(!0);try{if(!n.agentProfile.name.trim()){alert("Agent name is required");return}if(!n.agentProfile.signature.trim()){alert("Agent signature is required");return}if(n.messageTemplates.length===0){a(z=>({...z,messageTemplates:sy,activeTemplateId:"professional_standard"}));return}await r(n),t()}catch(z){console.error("Failed to save settings:",z),alert("Failed to save settings. Please try again.")}finally{S(!1)}},C=z=>{a(O=>({...O,agentProfile:{...O.agentProfile,...z}}))},R=(z,O)=>{a(ne=>({...ne,messageTemplates:ne.messageTemplates.map(ee=>ee.id===z?{...ee,...O}:ee)}))},j=()=>{const z={id:`custom_${Date.now()}`,name:"New Custom Template",template:"{greeting}Payment Reminder\\n\\n{refLine}Your payment is due {date}{time}.\\n\\nAmount: {amount}\\n\\n[Your custom message here]\\n\\n{signature}{contactInfo}",variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]};a(O=>({...O,messageTemplates:[...O.messageTemplates,z]})),m(z.id)},N=z=>{if(n.messageTemplates.length<=1){alert("You must have at least one message template");return}a(O=>{const ne=O.messageTemplates.filter(ve=>ve.id!==z),ee=O.activeTemplateId===z?ne[0]?.id||"professional_standard":O.activeTemplateId;return{...O,messageTemplates:ne,activeTemplateId:ee}})},F=()=>{try{const z={id:"preview",addressIndex:0,address:"123 Sample Street, London",customerName:"123456789 Smith",phoneNumber:"07123456789",scheduledDate:new Date(Date.now()+864e5).toISOString().slice(0,10),scheduledTime:"14:00",status:"Scheduled",amount:"125.00",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},O={id:"preview",arrangementId:"preview",type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},ne=oy(z,O,n);x(ne),b(!0)}catch(z){console.error("Preview failed:",z),alert("Failed to generate preview. Please check your template.")}},K=(z,O)=>{a(ne=>({...ne,customizableSchedule:{...ne.customizableSchedule,[z]:O}}))};return u.jsxs("div",{className:"modal-backdrop",onClick:z=>z.target===z.currentTarget&&t(),children:[u.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90vw",maxHeight:"90vh",overflow:"auto"},children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{style:{margin:0},children:" Reminder Settings"}),u.jsx("button",{className:"btn btn-ghost",onClick:t,children:""})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:"btn-group",style:{marginBottom:"1.5rem"},children:[u.jsx("button",{className:`btn ${l==="profile"?"btn-primary":"btn-ghost"}`,onClick:()=>c("profile"),children:" Agent Profile"}),u.jsx("button",{className:`btn ${l==="templates"?"btn-primary":"btn-ghost"}`,onClick:()=>c("templates"),children:" Message Templates"}),u.jsx("button",{className:`btn ${l==="schedule"?"btn-primary":"btn-ghost"}`,onClick:()=>c("schedule"),children:" Schedule Settings"})]}),l==="profile"&&u.jsxs("div",{className:"settings-tab",children:[u.jsx("h3",{children:"Agent Profile Information"}),u.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"This information will be used in your reminder messages and signature."}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"agent-name",children:" Agent Name *"}),u.jsx("input",{id:"agent-name",name:"agentName",type:"text",value:n.agentProfile.name,onChange:z=>C({name:z.target.value}),className:"input",placeholder:"Enter your full name",required:!0})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"agent-title",children:" Job Title *"}),u.jsxs("select",{id:"agent-title",name:"agentTitle",value:n.agentProfile.title,onChange:z=>C({title:z.target.value}),className:"input",children:[u.jsx("option",{value:"Enforcement Agent",children:"Enforcement Agent"}),u.jsx("option",{value:"Bailiff",children:"Bailiff"}),u.jsx("option",{value:"Recovery Officer",children:"Recovery Officer"}),u.jsx("option",{value:"Collection Agent",children:"Collection Agent"}),u.jsx("option",{value:"Senior Enforcement Agent",children:"Senior Enforcement Agent"}),u.jsx("option",{value:"Lead Bailiff",children:"Lead Bailiff"})]})]}),u.jsxs("div",{className:"form-group form-group-full",children:[u.jsx("label",{htmlFor:"agent-signature",children:" Message Signature *"}),u.jsx("input",{id:"agent-signature",name:"agentSignature",type:"text",value:n.agentProfile.signature,onChange:z=>C({signature:z.target.value}),className:"input",placeholder:"e.g., Enforcement Agent J. Smith",required:!0}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"This will appear at the end of your reminder messages"})]}),u.jsxs("div",{className:"form-group form-group-full",children:[u.jsx("label",{htmlFor:"agent-contact-info",children:" Contact Information (Optional)"}),u.jsx("input",{id:"agent-contact-info",name:"agentContactInfo",type:"text",value:n.agentProfile.contactInfo||"",onChange:z=>C({contactInfo:z.target.value}),className:"input",placeholder:"e.g., Tel: 01234 567890"}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Additional contact information to include in messages"})]})]})]}),l==="templates"&&u.jsxs("div",{className:"settings-tab",children:[u.jsxs("div",{style:{marginBottom:"1.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[u.jsx("h3",{children:"Message Templates"}),u.jsxs("div",{children:[u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:F,children:" Preview"}),u.jsx("button",{className:"btn btn-success btn-sm",onClick:j,children:" Add Template"})]})]}),u.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:["Create and customize SMS reminder messages. Use variables to automatically insert customer and payment details.",u.jsx("br",{}),u.jsx("strong",{children:" Click the  Edit button next to any template to see the enhanced editor with variable reference panel."})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"active-template",children:"Active Template"}),u.jsx("select",{id:"active-template",name:"activeTemplate",value:n.activeTemplateId,onChange:z=>a(O=>({...O,activeTemplateId:z.target.value})),className:"input",children:n.messageTemplates.map(z=>u.jsx("option",{value:z.id,children:z.name},z.id))})]}),u.jsx("div",{className:"templates-list",children:n.messageTemplates.map(z=>u.jsxs("div",{className:"template-item",children:[u.jsxs("div",{className:"template-header",children:[u.jsxs("div",{children:[u.jsx("strong",{children:z.name}),z.id===n.activeTemplateId&&u.jsx("span",{className:"pill",style:{backgroundColor:"var(--success)15",color:"var(--success)",marginLeft:"0.5rem"},children:"Active"})]}),u.jsxs("div",{children:[u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>m(f===z.id?null:z.id),children:f===z.id?"":""}),z.id.startsWith("custom_")&&u.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>N(z.id),children:""})]})]}),f===z.id&&u.jsxs("div",{className:"template-editor",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:`template-name-${z.id}`,children:"Template Name"}),u.jsx("input",{id:`template-name-${z.id}`,name:`templateName-${z.id}`,type:"text",value:z.name,onChange:O=>R(z.id,{name:O.target.value}),className:"input"})]}),u.jsxs("div",{className:"template-editor-layout",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:`template-content-${z.id}`,children:"Message Template"}),u.jsx("textarea",{id:`template-content-${z.id}`,name:`templateContent-${z.id}`,value:z.template,onChange:O=>R(z.id,{template:O.target.value}),className:"input",rows:12,style:{fontFamily:"monospace",fontSize:"0.875rem"}}),u.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Use variables like ","{greeting}"," and ","{amount}"," - see reference panel "]})]}),u.jsxs("div",{className:"variable-reference-panel",children:[u.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.875rem",color:"var(--text-primary)"},children:" Available Variables"}),u.jsxs("div",{className:"variable-group",children:[u.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Customer Info"}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{greeting}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Smart greeting: "Mr/Mrs Smith, "'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{refLine}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Reference line: "Reference: 123456789\\\\n\\\\n"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{customerName}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full name: "123456789 Smith"'})]})]}),u.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[u.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Payment Details"}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{amount}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Payment amount: "125.00"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{date}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Due date: "15/01/2025"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{time}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Time (if set): " at 14:00"'})]})]}),u.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[u.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Agent Info"}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{signature}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full signature: "Enforcement Agent J. Smith"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentName}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Name only: "J. Smith"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentTitle}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Job title: "Enforcement Agent"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{contactInfo}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Contact: "Tel: 01234 567890"'})]})]}),u.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"var(--blue-50)",borderRadius:"var(--radius-sm)",border:"1px solid var(--blue-200)"},children:[u.jsx("div",{style:{fontSize:"0.75rem",color:"var(--blue-700)",fontWeight:600,marginBottom:"0.25rem"},children:" Tips:"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1rem",fontSize:"0.75rem",color:"var(--blue-600)"},children:[u.jsx("li",{children:"Use \\\\n for line breaks"}),u.jsx("li",{children:"Variables are case-sensitive"}),u.jsx("li",{children:"Preview to test your template"}),u.jsx("li",{children:"Empty variables won't show"})]})]})]})]})]})]},z.id))})]}),l==="schedule"&&u.jsxs("div",{className:"settings-tab",children:[u.jsx("h3",{children:"Reminder Schedule"}),u.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Choose when reminder notifications should be sent before payment due dates."}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"globalEnabled",type:"checkbox",checked:n.globalEnabled,onChange:z=>a(O=>({...O,globalEnabled:z.target.checked}))}),"Enable automatic reminders"]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"smsEnabled",type:"checkbox",checked:n.smsEnabled,onChange:z=>a(O=>({...O,smsEnabled:z.target.checked})),disabled:!n.globalEnabled}),"Enable SMS reminders"]})}),u.jsx("hr",{style:{margin:"1.5rem 0"}}),u.jsx("h4",{children:"Reminder Timing"}),u.jsxs("div",{className:"schedule-options",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"threeDayReminder",type:"checkbox",checked:n.customizableSchedule.threeDayReminder,onChange:z=>K("threeDayReminder",z.target.checked),disabled:!n.globalEnabled}),"Send reminder 3 days before payment due"]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"oneDayReminder",type:"checkbox",checked:n.customizableSchedule.oneDayReminder,onChange:z=>K("oneDayReminder",z.target.checked),disabled:!n.globalEnabled}),"Send reminder 1 day before payment due"]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"dayOfReminder",type:"checkbox",checked:n.customizableSchedule.dayOfReminder,onChange:z=>K("dayOfReminder",z.target.checked),disabled:!n.globalEnabled}),"Send reminder on payment due date"]})})]}),u.jsxs("div",{className:"custom-days-section",children:[u.jsx("h4",{children:"Custom Reminder Days"}),u.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1rem"},children:"Add additional reminder days (e.g., 7 for weekly, 14 for bi-weekly)"}),u.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem"},children:n.customizableSchedule.customDays.map((z,O)=>u.jsxs("span",{className:"pill",style:{backgroundColor:"var(--primary)15",color:"var(--primary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[z," days before",u.jsx("button",{onClick:()=>{const ne=[...n.customizableSchedule.customDays];ne.splice(O,1),K("customDays",ne)},style:{background:"none",border:"none",color:"inherit",cursor:"pointer",padding:"0 0.25rem"},children:""})]},O))}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[u.jsx("input",{name:"customDayInput",type:"number",min:"1",max:"365",placeholder:"Days before",className:"input",style:{width:"120px"},onKeyPress:z=>{if(z.key==="Enter"){const O=z.target,ne=parseInt(O.value);ne&&ne>0&&!n.customizableSchedule.customDays.includes(ne)&&(K("customDays",[...n.customizableSchedule.customDays,ne]),O.value="")}}}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:z=>{const O=z.target.parentElement?.querySelector("input"),ne=parseInt(O.value);ne&&ne>0&&!n.customizableSchedule.customDays.includes(ne)&&(K("customDays",[...n.customizableSchedule.customDays,ne]),O.value="")},children:" Add"})]})]})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{className:"btn btn-ghost",onClick:t,children:"Cancel"}),u.jsx(Ti,{className:"btn btn-primary",onClick:k,isLoading:E,loadingText:"Saving...",children:" Save Settings"})]})]}),y&&u.jsx("div",{className:"modal-backdrop",onClick:()=>b(!1),children:u.jsxs("div",{className:"modal-content",onClick:z=>z.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{style:{margin:0},children:" Message Preview"}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>b(!1),children:""})]}),u.jsxs("div",{className:"modal-body",children:[u.jsx("div",{style:{padding:"1rem",backgroundColor:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:"pre-wrap",lineHeight:1.5},children:g}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"This is how your message will appear when sent to customers."})]}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{className:"btn btn-primary",onClick:()=>b(!1),children:"Close Preview"})})]})}),u.jsx("style",{children:`
        /* Modal Backdrop */
        .modal-backdrop {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        /* Modal Content */
        .modal-content {
          background: white;
          border-radius: var(--radius-lg, 12px);
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          max-width: 900px;
          width: 95vw;
          max-height: 95vh;
          overflow: hidden;
          display: flex;
          flex-direction: column;
        }

        @media (max-width: 480px) {
          .modal-content {
            width: 98vw;
            max-height: 98vh;
            border-radius: var(--radius-md, 8px);
            margin: 0 0.5rem;
          }
        }

        /* Modal Header */
        .modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem 2rem;
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-header {
            padding: 1rem 1.5rem;
          }

          .modal-header h2 {
            font-size: 1.25rem;
          }
        }

        .modal-header h2 {
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--gray-900, #111827);
          margin: 0;
        }

        .modal-header .btn {
          padding: 0.5rem;
          min-width: auto;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          font-size: 1rem;
        }

        /* Modal Body */
        .modal-body {
          padding: 2rem;
          overflow-y: auto;
          flex: 1;
        }

        /* Modal Footer */
        .modal-footer {
          padding: 1.5rem 2rem;
          border-top: 1px solid var(--gray-200, #e5e7eb);
          display: flex;
          justify-content: flex-end;
          gap: 1rem;
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-body {
            padding: 1.5rem;
          }

          .modal-footer {
            padding: 1rem 1.5rem;
            flex-direction: column-reverse;
            gap: 0.75rem;
          }

          .modal-footer .btn {
            width: 100%;
            justify-content: center;
          }
        }

        /* Template Editor Layout */
        .template-editor-layout {
          display: grid;
          grid-template-columns: 1fr 320px;
          gap: 1.5rem;
          min-height: 500px;
        }

        @media (max-width: 1024px) {
          .template-editor-layout {
            grid-template-columns: 1fr;
            gap: 1rem;
          }

          .variable-reference-panel {
            order: -1;
            max-height: 300px !important;
          }
        }

        /* Variable Reference Panel */
        .variable-reference-panel {
          background: var(--gray-50, #f8f9fa);
          border: 1px solid var(--gray-200, #e9ecef);
          border-radius: var(--radius-md, 8px);
          padding: 1.25rem;
          font-size: 0.875rem;
          max-height: 500px;
          overflow-y: auto;
          position: sticky;
          top: 0;
        }

        .variable-group {
          margin-bottom: 1.5rem;
        }

        .variable-group:last-child {
          margin-bottom: 0;
        }

        .variable-group h5 {
          margin: 0 0 0.75rem;
          font-size: 0.875rem;
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.025em;
        }

        .variable-item {
          margin-bottom: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: var(--radius-sm, 6px);
          border: 1px solid var(--gray-100, #f3f4f6);
        }

        .variable-item:last-child {
          margin-bottom: 0;
        }

        .variable-item code {
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          background: var(--primary-light, #e0f2fe);
          padding: 0.25rem 0.5rem;
          border-radius: 0.25rem;
          font-size: 0.8125rem;
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .variable-item div {
          color: var(--text-muted, #6b7280);
          font-size: 0.8125rem;
          margin-top: 0.375rem;
          line-height: 1.4;
        }

        /* Form Improvements */
        .form-group {
          margin-bottom: 1.5rem;
        }

        .form-group label {
          display: block;
          font-weight: 500;
          color: var(--gray-700, #374151);
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .form-group .input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--gray-300, #d1d5db);
          border-radius: var(--radius-md, 8px);
          font-size: 0.875rem;
          transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .form-group .input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }

        .form-group textarea.input {
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
          line-height: 1.5;
        }

        /* Button Group */
        .btn-group {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 2rem;
        }

        .btn-group .btn {
          flex: 1;
          text-align: center;
          font-size: 0.875rem;
          padding: 0.75rem 0.5rem;
        }

        /* Mobile-specific tab optimizations */
        @media (max-width: 480px) {
          .btn-group {
            gap: 0.25rem;
            margin-bottom: 1.5rem;
          }

          .btn-group .btn {
            font-size: 0.75rem;
            padding: 0.625rem 0.375rem;
            line-height: 1.2;
          }
        }

        @media (max-width: 360px) {
          .btn-group {
            flex-direction: column;
            gap: 0.5rem;
          }

          .btn-group .btn {
            flex: none;
            font-size: 0.875rem;
            padding: 0.75rem 1rem;
          }
        }

        /* Templates List */
        .templates-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .template-item {
          border: 1px solid var(--gray-200, #e5e7eb);
          border-radius: var(--radius-lg, 12px);
          overflow: hidden;
        }

        .template-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          background: var(--gray-50, #f9fafb);
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
        }

        .template-editor {
          padding: 1.5rem;
          background: white;
        }

        /* Dark Mode Support */
        .dark-mode .modal-content {
          background: var(--gray-800, #1f2937);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-header {
          border-bottom-color: var(--gray-700, #374151);
        }

        .dark-mode .modal-header h2 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-footer {
          border-top-color: var(--gray-700, #374151);
        }

        /* Form Elements Dark Mode */
        .dark-mode .form-group label {
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .form-group .input {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .form-group .input:focus {
          border-color: var(--primary, #0ea5e9);
          background: var(--gray-700, #374151);
        }

        .dark-mode .form-group .input::placeholder {
          color: var(--gray-400, #9ca3af);
        }

        /* Variable Reference Panel Dark Mode */
        .dark-mode .variable-reference-panel {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .variable-group h5 {
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item {
          background: var(--gray-800, #1f2937);
          border-color: var(--gray-600, #4b5563);
        }

        .dark-mode .variable-item code {
          background: var(--primary-dark, #0c4a6e);
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item div {
          color: var(--gray-300, #d1d5db);
        }

        /* Template Items Dark Mode */
        .dark-mode .template-item {
          border-color: var(--gray-600, #4b5563);
          background: var(--gray-800, #1f2937);
        }

        .dark-mode .template-header {
          background: var(--gray-700, #374151);
          border-bottom-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .template-editor {
          background: var(--gray-800, #1f2937);
        }

        /* Button Group Dark Mode */
        .dark-mode .btn-group .btn {
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .btn-group .btn.btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .dark-mode .btn-group .btn.btn-ghost {
          background: var(--gray-700, #374151);
        }

        .dark-mode .btn-group .btn.btn-ghost:hover {
          background: var(--gray-600, #4b5563);
        }

        /* Additional Text Elements */
        .dark-mode .settings-tab h3 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .settings-tab p {
          color: var(--gray-300, #d1d5db);
        }

        .dark-mode .setting-description {
          color: var(--gray-400, #9ca3af);
        }

        /* Tips Box Dark Mode */
        .dark-mode .variable-reference-panel div[style*="background: var(--blue-50)"] {
          background: var(--gray-600, #4b5563) !important;
          border-color: var(--gray-500, #6b7280) !important;
        }

        .dark-mode .variable-reference-panel div[style*="color: var(--blue-700)"] {
          color: var(--blue-300, #93c5fd) !important;
        }

        .dark-mode .variable-reference-panel ul {
          color: var(--gray-300, #d1d5db) !important;
        }

        /* Template List Dark Mode */
        .dark-mode .template-item strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .pill {
          background: var(--success-dark, #166534) !important;
          color: var(--success-light, #86efac) !important;
        }

        .dark-mode .template-header strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .template-header {
          color: var(--gray-100, #f3f4f6) !important;
        }
      `})]})}function wD(e,r){const t={exportedAt:new Date().toISOString(),exportedBy:r||"unknown",version:"1.0",dataController:"User (you are responsible for this data)",dataProcessor:"Navigator Web",addresses:e.addresses||[],completions:e.completions||[],arrangements:e.arrangements||[],daySessions:e.daySessions||[],currentListVersion:e.currentListVersion||1,subscription:e.subscription||null,privacyNotice:{message:"This export contains all your data stored in Navigator Web.",gdprRights:"You have the right to access, rectify, erase, restrict, port, and object to processing of this data.",dataController:"You are the data controller for customer/debtor information",contact:"For questions: See PRIVACY.md"}},n=JSON.stringify(t,null,2),a=new Blob([n],{type:"application/json"}),l=URL.createObjectURL(a),c=document.createElement("a");c.href=l,c.download=`navigator-data-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l)}function bD(e){const r=e.completions||[];if(r.length===0){alert("No completions to export");return}const t=["Date","Time","Address","Outcome","Amount","Case Reference","Time Spent (minutes)","Latitude","Longitude","List Version","Arrangement ID"],n=r.map(m=>{const g=new Date(m.timestamp),x=m.timeSpentSeconds?Math.round(m.timeSpentSeconds/60):"";return[g.toLocaleDateString(),g.toLocaleTimeString(),`"${(m.address||"").replace(/"/g,'""')}"`,m.outcome,m.amount||"",m.caseReference||"",x,m.lat||"",m.lng||"",m.listVersion||"",m.arrangementId||""].join(",")}),a=[t.join(","),...n].join(`
`),l=new Blob([a],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(l),f=document.createElement("a");f.href=c,f.download=`navigator-completions-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(c)}function kD(e){const r=e.arrangements||[];if(r.length===0){alert("No arrangements to export");return}const t=["ID","Customer Name","Phone Number","Address","Scheduled Date","Scheduled Time","Status","Amount","Initial Payment","Notes","Created At","Updated At","Recurrence Type","Total Payments","Payments Made"],n=r.map(m=>[m.id,`"${(m.customerName||"").replace(/"/g,'""')}"`,m.phoneNumber||"",`"${(m.address||"").replace(/"/g,'""')}"`,m.scheduledDate,m.scheduledTime||"",m.status,m.amount||"",m.initialPaymentAmount||"",`"${(m.notes||"").replace(/"/g,'""')}"`,m.createdAt,m.updatedAt,m.recurrenceType||"none",m.totalPayments||"",m.paymentsMade||""].join(",")),a=[t.join(","),...n].join(`
`),l=new Blob([a],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(l),f=document.createElement("a");f.href=c,f.download=`navigator-arrangements-export-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(c)}async function hx(){if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate(),r=e.usage||0,t=e.quota||0,n=t>0?Math.round(r/t*100):0;return{used:r,quota:t,percentage:n,usedMB:(r/1024/1024).toFixed(2),quotaMB:(t/1024/1024).toFixed(2)}}return{used:0,quota:0,percentage:0,usedMB:"0.00",quotaMB:"0.00"}}async function SD(){try{const e=Object.keys(localStorage).filter(r=>r.startsWith("geocoding_cache_"));if(e.forEach(r=>localStorage.removeItem(r)),"caches"in window){const t=(await caches.keys()).filter(n=>n.includes("map")||n.includes("tile"));await Promise.all(t.map(n=>caches.delete(n)))}console.log(`Cleared ${e.length} geocoding cache entries`),alert(`Cache cleared successfully!

Removed:
- ${e.length} geocoding entries
- Map tile caches`)}catch(e){console.error("Failed to clear caches:",e),alert("Failed to clear some caches. See console for details.")}}const TD=({trigger:e,reminderSettings:r,onUpdateReminderSettings:t,onChangePassword:n,onChangeEmail:a,onDeleteAccount:l,appState:c,userEmail:f})=>{const[m,g]=Y.useState(!1),[x,y]=Y.useState(!1),[b,E]=Y.useState(null),S=Y.useRef(null),{settings:k,toggleBackup:C,toggleDarkMode:R,togglePushNotifications:j,toggleAutoSync:N}=Vy();Y.useEffect(()=>{m&&!b&&hx().then(E)},[m,b]),Y.useEffect(()=>{const K=z=>{S.current&&!S.current.contains(z.target)&&g(!1)};return m&&document.addEventListener("mousedown",K),()=>{document.removeEventListener("mousedown",K)}},[m]),Y.useEffect(()=>{const K=z=>{z.key==="Escape"&&g(!1)};return m&&document.addEventListener("keydown",K),()=>{document.removeEventListener("keydown",K)}},[m]);const F=({checked:K,onChange:z,id:O})=>u.jsxs("div",{className:"toggle-switch",onClick:z,children:[u.jsx("input",{type:"checkbox",id:O,checked:K,onChange:z,className:"toggle-input"}),u.jsx("div",{className:`toggle-slider ${K?"checked":""}`,children:u.jsx("div",{className:"toggle-thumb"})})]});return u.jsxs("div",{className:"settings-dropdown",ref:S,children:[u.jsx("button",{className:"settings-trigger",onClick:()=>g(!m),"aria-expanded":m,"aria-haspopup":"true",children:e||u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"settings-icon",children:""}),u.jsx("span",{className:"settings-text",children:"Settings"})]})}),m&&u.jsxs("div",{className:"settings-dropdown-content",children:[u.jsxs("div",{className:"settings-header",children:[u.jsx("h3",{className:"settings-title",children:"App Settings"}),u.jsx("p",{className:"settings-subtitle",children:"Customize your experience"})]}),u.jsx("div",{className:"settings-section",children:u.jsxs("div",{className:"setting-item",children:[u.jsxs("div",{className:"setting-info",children:[u.jsx("label",{htmlFor:"backup-toggle",className:"setting-label",children:"Auto-download backup on end of day"}),u.jsx("p",{className:"setting-description",children:"Automatically download backup file when finishing the day."})]}),u.jsx(F,{id:"backup-toggle",checked:k.backupOnEndOfDay,onChange:C})]})}),u.jsx("div",{className:"settings-separator"}),u.jsx("div",{className:"settings-section",children:u.jsxs("button",{className:"sms-settings-button",onClick:()=>{y(!0),g(!1)},children:[u.jsx("span",{className:"sms-settings-icon",children:""}),u.jsxs("div",{className:"sms-settings-info",children:[u.jsx("div",{className:"sms-settings-title",children:"Reminder & SMS Settings"}),u.jsx("div",{className:"sms-settings-desc",children:"Message templates, scheduling, agent profile, and reminder preferences"})]}),u.jsx("span",{className:"sms-settings-arrow",children:""})]})}),u.jsx("div",{className:"settings-separator"}),u.jsxs("div",{className:"settings-section",children:[u.jsxs("div",{className:"setting-item",children:[u.jsx("div",{className:"setting-info",children:u.jsx("label",{htmlFor:"dark-mode",className:"setting-label",children:"Dark Mode"})}),u.jsx(F,{id:"dark-mode",checked:k.darkMode,onChange:R})]}),u.jsxs("div",{className:"setting-item",children:[u.jsx("div",{className:"setting-info",children:u.jsx("label",{htmlFor:"push-notifs",className:"setting-label",children:"Push Notifications"})}),u.jsx(F,{id:"push-notifs",checked:k.pushNotifications,onChange:j})]}),u.jsxs("div",{className:"setting-item",children:[u.jsx("div",{className:"setting-info",children:u.jsx("label",{htmlFor:"auto-sync",className:"setting-label",children:"Auto-sync on app start"})}),u.jsx(F,{id:"auto-sync",checked:k.autoSyncOnStart,onChange:N})]})]}),(n||a||l)&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"settings-separator"}),u.jsxs("div",{className:"settings-section",children:[u.jsx("h4",{className:"settings-section-title",style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-secondary)"},children:"Account Management"}),n&&u.jsxs("button",{className:"settings-action-button",onClick:()=>{n(),g(!1)},style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Change Password"})]}),a&&u.jsxs("button",{className:"settings-action-button",onClick:()=>{a(),g(!1)},style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Change Email"})]}),l&&u.jsxs("button",{className:"settings-action-button",onClick:()=>{l(),g(!1)},style:{width:"100%",padding:"0.75rem",background:"var(--danger-light)",border:"1px solid var(--danger)",borderRadius:"var(--radius)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.75rem",color:"var(--danger)"},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Delete Account"})]})]})]}),u.jsx("div",{className:"settings-separator"}),u.jsxs("div",{className:"settings-section",children:[u.jsx("h4",{className:"settings-section-title",style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.75rem",color:"var(--text-secondary)"},children:"Privacy & Data (GDPR)"}),b&&u.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"var(--radius)",marginBottom:"0.75rem",border:"1px solid var(--border-light)"},children:[u.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-secondary)",marginBottom:"0.25rem"},children:"Storage Usage"}),u.jsxs("div",{style:{fontSize:"0.875rem",fontWeight:600,marginBottom:"0.5rem"},children:[b.usedMB," MB / ",b.quotaMB," MB (",b.percentage,"%)"]}),u.jsx("div",{style:{height:"6px",background:"var(--gray-200)",borderRadius:"3px",overflow:"hidden"},children:u.jsx("div",{style:{width:`${b.percentage}%`,height:"100%",background:b.percentage>80?"var(--danger)":"var(--primary)",transition:"width 0.3s"}})})]}),c&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:()=>{wD(c,f),g(!1)},className:"settings-action-button",style:{width:"100%",padding:"0.75rem",background:"var(--primary-light)",border:"1px solid var(--primary)",borderRadius:"var(--radius)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.5rem",color:"var(--primary)"},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Export All Data (JSON)"})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:[u.jsx("button",{onClick:()=>{bD(c),g(!1)},style:{flex:1,padding:"0.625rem",background:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",cursor:"pointer",fontSize:"0.8125rem"},children:"Export Completions (CSV)"}),u.jsx("button",{onClick:()=>{kD(c),g(!1)},style:{flex:1,padding:"0.625rem",background:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",cursor:"pointer",fontSize:"0.8125rem"},children:"Export Arrangements (CSV)"})]})]}),u.jsxs("button",{onClick:async()=>{await SD(),E(null),setTimeout(()=>hx().then(E),500)},className:"settings-action-button",style:{width:"100%",padding:"0.75rem",background:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Clear Cache & Temporary Data"})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsxs("a",{href:"/PRIVACY.md",target:"_blank",rel:"noopener noreferrer",style:{flex:1,padding:"0.625rem",background:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",textDecoration:"none",color:"inherit",fontSize:"0.8125rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Privacy Policy"})]}),u.jsxs("a",{href:"/TERMS_OF_USE.md",target:"_blank",rel:"noopener noreferrer",style:{flex:1,padding:"0.625rem",background:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",textDecoration:"none",color:"inherit",fontSize:"0.8125rem"},children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Terms"})]})]})]}),u.jsxs("div",{className:"settings-footer",children:["Settings are saved locally and synced to cloud if configured.",u.jsx("br",{}),u.jsx("a",{href:"/PRIVACY.md",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary)",textDecoration:"underline",fontSize:"0.75rem"},children:"Your privacy rights"})]})]}),x&&u.jsx(_D,{settings:r||Il,onUpdateSettings:K=>{t&&t(K),y(!1)},onClose:()=>y(!1)}),u.jsx("style",{children:`
        .settings-dropdown {
          position: relative;
          display: inline-block;
        }

        .settings-trigger {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          background: var(--gray-100);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-md);
          color: var(--gray-700);
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .settings-trigger:hover {
          background: var(--gray-200);
          color: var(--gray-800);
        }

        .settings-icon {
          font-size: 1rem;
        }

        .settings-dropdown-content {
          position: absolute;
          top: 100%;
          right: 0;
          z-index: 10000;
          min-width: 320px;
          max-width: 400px;
          background: white;
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-xl);
          padding: 1.5rem;
          margin-top: 0.5rem;
          animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .settings-header {
          margin-bottom: 1.5rem;
        }

        .settings-title {
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--gray-800);
          margin: 0 0 0.25rem 0;
        }

        .settings-subtitle {
          font-size: 0.875rem;
          color: var(--gray-500);
          margin: 0;
        }

        .settings-section {
          margin-bottom: 1rem;
        }

        .settings-separator {
          height: 1px;
          background: var(--gray-200);
          margin: 1rem 0;
        }

        .setting-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          margin-bottom: 1rem;
        }

        .setting-item:last-child {
          margin-bottom: 0;
        }

        .setting-info {
          flex: 1;
        }

        .setting-label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--gray-700);
          margin-bottom: 0.25rem;
          cursor: pointer;
        }

        .setting-description {
          font-size: 0.75rem;
          color: var(--gray-500);
          margin: 0.25rem 0 0 0;
          line-height: 1.4;
        }

        .settings-select,
        .settings-input {
          width: 100%;
          padding: 0.5rem 0.75rem;
          border: 1px solid var(--gray-300);
          border-radius: var(--radius-sm);
          font-size: 0.875rem;
          background: white;
          transition: var(--transition-normal);
        }

        .settings-select:focus,
        .settings-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        .settings-input {
          margin-top: 0.5rem;
        }

        .toggle-switch {
          position: relative;
          display: inline-block;
          width: 44px;
          height: 24px;
          cursor: pointer;
        }

        .toggle-input {
          opacity: 0;
          width: 0;
          height: 0;
        }

        .toggle-slider {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: var(--gray-300);
          border-radius: 24px;
          transition: var(--transition-normal);
        }

        .toggle-slider.checked {
          background: var(--primary);
        }

        .toggle-thumb {
          position: absolute;
          content: "";
          height: 20px;
          width: 20px;
          left: 2px;
          bottom: 2px;
          background: white;
          border-radius: 50%;
          transition: var(--transition-normal);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-slider.checked .toggle-thumb {
          transform: translateX(20px);
        }

        .settings-footer {
          margin-top: 1.5rem;
          padding-top: 1rem;
          border-top: 1px solid var(--gray-200);
          font-size: 0.75rem;
          color: var(--gray-500);
          text-align: center;
        }

        /* Dark mode styles */
        .dark-mode .settings-dropdown-content {
          background: var(--gray-800);
          border-color: var(--gray-700);
          color: var(--gray-100);
        }

        .dark-mode .settings-title {
          color: var(--gray-100);
        }

        .dark-mode .settings-subtitle,
        .dark-mode .setting-description,
        .dark-mode .settings-footer {
          color: var(--gray-400);
        }

        .dark-mode .setting-label {
          color: var(--gray-200);
        }

        .dark-mode .settings-separator {
          background: var(--gray-700);
        }

        .dark-mode .settings-select,
        .dark-mode .settings-input {
          background: var(--gray-700);
          border-color: var(--gray-600);
          color: var(--gray-100);
        }

        .dark-mode .settings-select:focus,
        .dark-mode .settings-input:focus {
          border-color: var(--primary);
        }

        /* SMS Settings Button Styles */
        .sms-settings-button {
          width: 100%;
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.75rem;
          background: var(--gray-50);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-md);
          color: var(--gray-700);
          text-align: left;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .sms-settings-button:hover {
          background: var(--gray-100);
          border-color: var(--primary);
          color: var(--gray-800);
        }

        .sms-settings-icon {
          font-size: 1.25rem;
          flex-shrink: 0;
        }

        .sms-settings-info {
          flex: 1;
        }

        .sms-settings-title {
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--gray-800);
          margin-bottom: 0.125rem;
        }

        .sms-settings-desc {
          font-size: 0.75rem;
          color: var(--gray-500);
          line-height: 1.3;
        }

        .sms-settings-arrow {
          font-size: 0.875rem;
          color: var(--gray-400);
          flex-shrink: 0;
        }

        .dark-mode .sms-settings-button {
          background: var(--gray-700);
          border-color: var(--gray-600);
          color: var(--gray-200);
        }

        .dark-mode .sms-settings-button:hover {
          background: var(--gray-600);
          border-color: var(--primary);
          color: var(--gray-100);
        }

        .dark-mode .sms-settings-title {
          color: var(--gray-100);
        }

        .dark-mode .sms-settings-desc {
          color: var(--gray-400);
        }

        .dark-mode .sms-settings-arrow {
          color: var(--gray-500);
        }

        @media (max-width: 768px) {
          .settings-dropdown-content {
            position: fixed;
            top: 50%;
            left: 50%;
            right: auto;
            transform: translate(-50%, -50%);
            min-width: 280px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
          }
        }
      `})]})},ED=()=>{const[e,r]=Wt.useState([]);return Wt.useEffect(()=>Xc.subscribe(r),[]),e.length===0?null:u.jsxs("div",{className:"toast-container",children:[e.map(t=>u.jsx("div",{className:`toast toast-${t.type}`,onClick:()=>Xc.remove(t.id),children:u.jsxs("div",{className:"toast-content",children:[u.jsxs("span",{className:"toast-icon",children:[t.type==="success"&&"",t.type==="error"&&"",t.type==="warning"&&"",t.type==="info"&&""]}),u.jsx("span",{className:"toast-message",children:t.message})]})},t.id)),u.jsx("style",{children:`
        .toast-container {
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 9999;
          display: flex;
          flex-direction: column;
          gap: 8px;
          pointer-events: none;
        }

        .toast {
          pointer-events: auto;
          background: var(--card-bg, white);
          color: var(--text-primary, #374151);
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          border-left: 4px solid;
          min-width: 300px;
          max-width: 400px;
          padding: 12px 16px;
          cursor: pointer;
          transition: all 0.3s ease;
          animation: slideIn 0.3s ease-out;
        }

        .toast:hover {
          transform: translateY(-2px);
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .toast-success {
          border-left-color: #22c55e;
          background: #f0fdf4;
        }

        .toast-error {
          border-left-color: #ef4444;
          background: #fef2f2;
        }

        .toast-warning {
          border-left-color: #f59e0b;
          background: #fffbeb;
        }

        .toast-info {
          border-left-color: #3b82f6;
          background: #eff6ff;
        }

        .toast-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .toast-icon {
          font-size: 16px;
        }

        .toast-message {
          color: inherit;
          font-weight: 500;
          flex: 1;
          line-height: 1.4;
        }

        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateX(100%);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }

        @media (max-width: 768px) {
          .toast-container {
            top: 10px;
            right: 10px;
            left: 10px;
          }

          .toast {
            min-width: auto;
            max-width: none;
          }
        }
      `})]})},f0="navigator_privacy_consent",mx="v1.0_2025-01-06",CD=({onAccept:e})=>{const[r,t]=Y.useState(!1),[n,a]=Y.useState(!1);Y.useEffect(()=>{const f=localStorage.getItem(f0);(!f||f!==mx)&&t(!0)},[]);const l=()=>{localStorage.setItem(f0,mx),t(!1),e&&e()},c=()=>{window.confirm(`You can still use Navigator Web in offline mode (no cloud sync).

To use cloud sync and multi-device features, you must accept our privacy policy.

Click OK to use offline mode, or Cancel to review the privacy policy.`)&&(localStorage.setItem(f0,"offline_mode"),t(!1))};return r?u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1e5,backdropFilter:"blur(4px)"}}),u.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"white",borderTop:"3px solid var(--primary, #667eea)",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.15)",zIndex:100001,padding:"1.5rem",maxHeight:n?"80vh":"auto",overflowY:"auto"},children:u.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:n?u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[u.jsx("h3",{style:{margin:0,fontSize:"1.25rem",fontWeight:600,color:"#1a202c"},children:"Privacy & Cookie Policy"}),u.jsx("button",{onClick:()=>a(!1),style:{padding:"0.5rem",background:"transparent",border:"none",fontSize:"1.5rem",color:"#718096",cursor:"pointer",lineHeight:1},children:""})]}),u.jsxs("div",{style:{background:"#f7fafc",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #e2e8f0"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#2d3748"},children:"What We Collect"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#4a5568",lineHeight:"1.6"},children:[u.jsx("li",{children:"Your email address (for authentication)"}),u.jsx("li",{children:"Work data you enter (addresses, completions, arrangements)"}),u.jsx("li",{children:"Device identifiers (for multi-device sync)"}),u.jsx("li",{children:"Technical data (login times, browser info)"})]})]}),u.jsxs("div",{style:{background:"#f7fafc",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #e2e8f0"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#2d3748"},children:"How We Use It"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#4a5568",lineHeight:"1.6"},children:[u.jsx("li",{children:"Authenticate your account"}),u.jsx("li",{children:"Sync data across your devices"}),u.jsx("li",{children:"Provide route planning and geocoding"}),u.jsx("li",{children:"Enable backup and restore"})]}),u.jsx("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.875rem",color:"#718096",fontStyle:"italic"},children:"We do NOT analyze, share, or sell your data."})]}),u.jsxs("div",{style:{background:"#fff5f5",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #feb2b2"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#c53030"},children:" Your GDPR Responsibilities"}),u.jsxs("p",{style:{margin:0,fontSize:"0.875rem",color:"#742a2a",lineHeight:"1.6"},children:[u.jsx("strong",{children:"YOU are the Data Controller"})," for customer/debtor data you process. You must have lawful authority and comply with GDPR/UK DPA 2018. We are only the Data Processor providing infrastructure."]})]}),u.jsxs("div",{style:{background:"#f0fff4",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #9ae6b4"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#22543d"},children:" Your Rights"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#276749",lineHeight:"1.6"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Access:"})," Export all data (Settings  Export Data)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Delete:"})," Remove account permanently (Settings  Delete Account)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Rectify:"})," Edit any data directly in the app"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Portability:"})," Download in JSON/CSV format"]})]})]}),u.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"1px solid #e2e8f0"},children:[u.jsx("button",{onClick:c,style:{flex:1,padding:"0.75rem 1.5rem",background:"#e2e8f0",border:"none",borderRadius:"6px",color:"#2d3748",fontSize:"0.9375rem",fontWeight:500,cursor:"pointer"},children:"Decline (Offline Mode)"}),u.jsx("button",{onClick:l,style:{flex:1,padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",color:"white",fontSize:"0.9375rem",fontWeight:600,cursor:"pointer",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)"},children:"Accept & Continue"})]}),u.jsxs("p",{style:{margin:"1rem 0 0 0",fontSize:"0.75rem",color:"#718096",textAlign:"center"},children:["Read full"," ",u.jsx("a",{href:"/PRIVACY.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Privacy Policy"})," ","and"," ",u.jsx("a",{href:"/TERMS_OF_USE.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Terms of Use"})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"1.5rem",flexWrap:"wrap"},children:[u.jsxs("div",{style:{flex:1,minWidth:"300px"},children:[u.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1.125rem",fontWeight:600,color:"#1a202c"},children:" Privacy & Data Protection"}),u.jsxs("p",{style:{margin:0,fontSize:"0.875rem",lineHeight:"1.5",color:"#4a5568"},children:["We use cookies and cloud storage to sync your work data across devices. We are a ",u.jsx("strong",{children:"data processor"})," - you remain the ",u.jsx("strong",{children:"data controller"})," for any customer data you process."]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",flexWrap:"wrap"},children:[u.jsx("button",{onClick:()=>a(!0),style:{padding:"0.625rem 1.25rem",background:"transparent",border:"1px solid #cbd5e0",borderRadius:"6px",color:"#4a5568",fontSize:"0.875rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:f=>{f.currentTarget.style.background="#f7fafc",f.currentTarget.style.borderColor="#a0aec0"},onMouseLeave:f=>{f.currentTarget.style.background="transparent",f.currentTarget.style.borderColor="#cbd5e0"},children:"Learn More"}),u.jsx("button",{onClick:c,style:{padding:"0.625rem 1.25rem",background:"#e2e8f0",border:"none",borderRadius:"6px",color:"#2d3748",fontSize:"0.875rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:f=>{f.currentTarget.style.background="#cbd5e0"},onMouseLeave:f=>{f.currentTarget.style.background="#e2e8f0"},children:"Decline"}),u.jsx("button",{onClick:l,style:{padding:"0.625rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",color:"white",fontSize:"0.875rem",fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)"},onMouseEnter:f=>{f.currentTarget.style.transform="translateY(-1px)",f.currentTarget.style.boxShadow="0 4px 8px rgba(102, 126, 234, 0.4)"},onMouseLeave:f=>{f.currentTarget.style.transform="translateY(0)",f.currentTarget.style.boxShadow="0 2px 4px rgba(102, 126, 234, 0.3)"},children:"Accept & Continue"})]})]}),u.jsxs("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e2e8f0",fontSize:"0.75rem",color:"#718096"},children:['By clicking "Accept", you agree to our'," ",u.jsx("a",{href:"/PRIVACY.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Privacy Policy"})," ","and"," ",u.jsx("a",{href:"/TERMS_OF_USE.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Terms of Use"}),". This app is for professional enforcement use only."]})]})})}),u.jsx("style",{children:`
        @media (max-width: 768px) {
          .privacy-consent-banner {
            padding: 1rem !important;
          }
        }
      `})]}):null};async function h0(e,r,t){if(!(!e.user||!t)){if(_s("navigator_restore_in_progress")){be.info(" RESTORE PROTECTION: Skipping session reconciliation to prevent data loss");return}try{be.info("Post-restore: Reconciling session state with cloud...");const{data:n,error:a}=await t.from("navigator_state").select("data").eq("user_id",e.user.id).maybeSingle();if(a||!n?.data){be.warn("No cloud state found for session reconciliation");return}const c=Ud(n.data).daySessions||[];r(f=>({...f,daySessions:c})),be.info("Session state reconciled with cloud successfully")}catch(n){be.error("Failed to reconcile session state:",n)}}}class px extends Y.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,msg:String(r)}}render(){return this.state.hasError?u.jsxs("div",{className:"container",style:{paddingTop:"4rem"},children:[u.jsx("h2",{children:"Something went wrong"}),u.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:this.state.msg})]}):this.props.children}}async function ro(e,r="manual",t=0){if(!Be)throw be.error("Supabase not configured for backup"),new Error("Supabase not configured");const n=await Be.auth.getUser(),a=n&&n.data&&n.data.user?n.data.user.id:void 0;if(!a)throw be.error("User not authenticated for backup"),new Error("User not authenticated");const l="Europe/London",c=new Date,f=c.toLocaleDateString("en-GB",{timeZone:l,year:"numeric"}),m=c.toLocaleDateString("en-GB",{timeZone:l,month:"2-digit"}),g=c.toLocaleDateString("en-GB",{timeZone:l,day:"2-digit"}),x=`${f}-${m}-${g}`,y=c.toLocaleTimeString("en-GB",{timeZone:l,hour12:!1}).replace(/:/g,""),b="navigator-backups",E=`backup_${x}_${y}_${r}_retry${t}.json`,S=`${a}/${x}/${E}`;try{const k=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});be.info(`Uploading backup to ${S}, size: ${k.size} bytes`);const C=await Be.storage.from(b).upload(S,k,{upsert:!0,contentType:"application/json"});if(C.error)throw be.error("Backup upload failed:",C.error),new Error(C.error.message);be.info("Backup upload successful:",S);try{await Be.from("backups").insert({user_id:a,day_key:x,object_path:S,size_bytes:k.size}),be.info("Backup database record created")}catch(R){be.warn("Backups table insert failed (non-critical):",R instanceof Error?R.message:R)}return{objectPath:S,size:k.size}}catch(k){if(be.error(`Backup attempt ${t+1} failed:`,k),t<2){const C=Math.pow(2,t)*1e3;return be.info(`Retrying backup in ${C}ms...`),await new Promise(R=>setTimeout(R,C)),ro(e,r,t+1)}throw new Error(`Backup failed after ${t+1} attempts: ${k.message}`)}}function zd({title:e,value:r,change:t,changeType:n,icon:a,iconType:l}){return u.jsxs("div",{className:"stat-card-modern",children:[u.jsxs("div",{className:"stat-header",children:[u.jsx("div",{className:"stat-title",children:e}),u.jsx("div",{className:`stat-icon ${l}`,children:a})]}),u.jsx("div",{className:"stat-value",children:r}),t&&u.jsxs("div",{className:`stat-change ${n||"neutral"}`,children:[n==="positive"&&u.jsx("span",{children:""}),n==="negative"&&u.jsx("span",{children:""}),u.jsx("span",{children:t})]})]})}function AD(){const e=Py();return e.isLoading?u.jsx("div",{className:"app-wrapper",children:u.jsx("div",{className:"main-area",children:u.jsx("div",{className:"content-area",children:u.jsxs("div",{className:"loading",children:[u.jsx("div",{className:"spinner"}),"Analyzing session data..."]})})})}):e.user?u.jsx(px,{children:u.jsx(Y3,{children:u.jsx(PD,{})})}):u.jsx(px,{children:u.jsx(J3,{onSignIn:async(r,t)=>{await e.signIn(r,t)},onSignUp:async(r,t)=>{await e.signUp(r,t)},onResetPassword:async r=>{await e.resetPassword(r)},isLoading:e.isLoading,error:e.error,onClearError:e.clearError})})}function PD(){const{state:e,loading:r,setAddresses:t,addAddress:n,setActive:a,cancelActive:l,complete:c,undo:f,startDay:m,endDay:g,backupState:x,restoreState:y,addArrangement:b,updateArrangement:E,deleteArrangement:S,setState:k,setBaseState:C,deviceId:R,enqueueOp:j,updateReminderSettings:N}=BN(),F=Py(),{confirm:K,alert:z}=X3(),{hasAccess:O}=Cm(F.user),{isAdmin:ne,isOwner:ee}=Hy(F.user),[ve,he]=Y.useState(!1),[ce,Ne]=Y.useState(!1),[xe,le]=Y.useState(!1),[Q,M]=Y.useState(!1),[V,H]=Y.useState(!1),[se,D]=Y.useState(!1),[P,I]=Y.useState(!1),[B,G]=Y.useState(!1),[te,de]=Y.useState(!1),pe=()=>{const Ie=window.location.hash.slice(1);return["list","completed","arrangements","earnings","planning"].includes(Ie)?Ie:"list"},[me,ye]=Y.useState(pe),[Ke,ae]=Y.useState(""),[at,dt]=Y.useState(null),[mt,st]=Y.useState(!1),Le=Y.useRef(null);Y.useEffect(()=>{const Ie=()=>{const qe=pe();ye(qe)};return window.addEventListener("popstate",Ie),()=>window.removeEventListener("popstate",Ie)},[]);const At=Y.useCallback(Ie=>{Ie!==me&&(ye(Ie),window.history.pushState({tab:Ie},"",`#${Ie}`))},[me]),[dr,Yt]=Y.useState(!1),[Qt,_n]=Y.useState([]),[br,er]=Y.useState(!1),[kr,fr]=Y.useState(null),Sr=Array.isArray(e.addresses)?e.addresses:[],St=Array.isArray(e.completions)?e.completions:[],ir=Array.isArray(e.arrangements)?e.arrangements:[],ct=Array.isArray(e.daySessions)?e.daySessions:[],Ge=Y.useMemo(()=>({...e,addresses:Sr,completions:St,arrangements:ir,daySessions:ct}),[e,Sr,St,ir,ct]);function Tr(Ie,qe="Europe/London"){const Je=Ie.toLocaleDateString("en-GB",{timeZone:qe,year:"numeric"}),He=Ie.toLocaleDateString("en-GB",{timeZone:qe,month:"2-digit"}),Qe=Ie.toLocaleDateString("en-GB",{timeZone:qe,day:"2-digit"});return`${Je}-${He}-${Qe}`}const $t=Y.useCallback(async()=>{if(!Be){fr("Supabase not configured");return}er(!0),fr(null);try{const qe=(await Be.auth.getUser())?.data?.user?.id;if(!qe)throw new Error("Not authenticated");const Je=new Date,He=new Date;He.setDate(He.getDate()-6);const Qe=Tr(He),ot=Tr(Je),it=await Be.from("backups").select("object_path,size_bytes,created_at,day_key").eq("user_id",qe).gte("day_key",Qe).lte("day_key",ot).order("day_key",{ascending:!1}).order("created_at",{ascending:!1});if(it.error)throw it.error;const Oe=it.data??[];_n(Oe)}catch(Ie){fr(Ie?.message||String(Ie))}finally{er(!1)}},[]),Gr=Y.useCallback(async Ie=>{if(!Be){await z({title:"Configuration Error",message:"Supabase is not configured.",type:"error"});return}const qe=Ie.split("/").pop()||Ie;if(await K({title:"Restore from Cloud",message:`Restore "${qe}" from cloud?

This will overwrite your current data.`,confirmText:"Restore",cancelText:"Cancel",type:"warning"})){er(!0),fr(null);try{const Qe=await Be.storage.from("navigator-backups").download(Ie);if(Qe.error)throw Qe.error;const it=await Qe.data.text(),Oe=JSON.parse(it),U=t0(Oe),re=Ge.daySessions,q={...U,daySessions:re};y(q),setTimeout(async()=>{await F.syncData(q),Le.current=JSON.stringify(q)},31e3),await h0(F,k,Be),st(!0),await z({title:"Success",message:"Successfully restored from cloud",type:"success"}),Yt(!1)}catch(He){fr(He?.message||String(He))}finally{er(!1)}}},[F,y,z,K]);Y.useEffect(()=>{if(!F.user||r)return;if(!Be){st(!0);return}let Ie=!1,qe;return(async()=>{try{const He=(await Be.from("navigator_state").select("data, updated_at, version").eq("user_id",F.user.id).maybeSingle()).data;if(He&&He.data){const Qe=Ud(He.data);if(!Ie){if(Sr.length>0||St.length>0||ir.length>0||ct.length>0){const it=St.length,Oe=Qe.completions?.length||0,U=He.updated_at?new Date(He.updated_at):new Date(0),re=new Date(Date.now()-7200*1e3),q=St.some(X=>X.timestamp&&new Date(X.timestamp)>re);if(be.sync(" SESSION RESTORATION ANALYSIS:",{localCompletions:it,cloudCompletions:Oe,cloudLastUpdated:U.toISOString(),hasRecentLocalActivity:q,willMerge:it>0||q}),it>Oe||q){be.sync(" DATA PROTECTION: Local data appears newer, merging states to prevent loss");const J=Ay(Ge,Qe);k(J),Le.current=JSON.stringify(J),setTimeout(async()=>{try{await F.syncData(J),be.sync(" Synced merged state back to cloud")}catch(ie){be.error("Failed to sync merged state:",ie)}},1e3)}else be.sync(" Using cloud state (appears more complete)"),k(Qe),Le.current=JSON.stringify(Qe)}else be.sync(" No local data, using cloud state"),k(Qe),Le.current=JSON.stringify(Qe);st(!0),be.sync("Session restored, version:",He?.version)}}else if(Sr.length>0||St.length>0||ir.length>0||ct.length>0){be.info("Analyzing data ownership for current user...");try{let ot=null;try{const{data:Oe}=await Be.from("navigator_state").select("data").eq("user_id",F.user.id).maybeSingle();ot=Oe?.data}catch(Oe){be.warn("Could not fetch cloud data for analysis:",Oe)}const it=ps.analyzeDataOwnership(Ge,F.user,ot);switch(be.info("Data ownership analysis:",it),it.action){case"sync":be.sync("Syncing local data to cloud (ownership confirmed)"),await F.syncData(Ge),ps.storeDeviceContext(F.user),Ie||(Le.current=JSON.stringify(Ge),st(!0));break;case"backup_and_clear":be.warn("Creating safety backup before clearing (different user detected)");try{const Oe=`navigator_safety_backup_${Date.now()}_user_switch`,U={...Ge,_backup_timestamp:new Date().toISOString(),_backup_reason:"user_switch",_ownership_analysis:it};localStorage.setItem(Oe,JSON.stringify(U)),be.info(`Safety backup created: ${Oe}`),k({addresses:[],completions:[],arrangements:[],daySessions:[],activeIndex:null,currentListVersion:1}),ps.storeDeviceContext(F.user),Ie||st(!0)}catch(Oe){be.error("Backup failed - preserving data for safety:",Oe),await F.syncData(Ge),ps.storeDeviceContext(F.user),Ie||(Le.current=JSON.stringify(Ge),st(!0))}break;case"preserve_and_ask":default:be.info("Preserving local data (uncertain ownership) - user can decide later"),await F.syncData(Ge),ps.storeDeviceContext(F.user),Ie||(Le.current=JSON.stringify(Ge),st(!0));break}}catch(ot){be.error("User detection analysis failed - preserving data for safety:",ot),await F.syncData(Ge),ps.storeDeviceContext(F.user),Ie||(Le.current=JSON.stringify(Ge),st(!0))}}else ps.storeDeviceContext(F.user),Ie||st(!0);qe=F.subscribeToData(Qe=>{if(Qe){if(_s("navigator_restore_in_progress")){be.sync(" RESTORE PROTECTION: App.tsx subscription skipping cloud state update to prevent data loss");return}if(_s("navigator_import_in_progress")){be.sync(" IMPORT PROTECTION: App.tsx subscription skipping cloud state update to prevent import override");return}if(typeof Qe=="function")be.sync("Received cloud update (React updater)"),k(ot=>{const it=Qe(ot),Oe=Ud(it),U=JSON.stringify(Oe);return Le.current=U,Oe}),st(!0);else{const ot=JSON.stringify(Qe);if(ot===Le.current)return;const it=Ud(Qe);be.sync("Received cloud update (direct state)"),k(it),Le.current=ot,st(!0)}}})}catch(Je){be.error("Bootstrap sync failed:",Je),Ie||st(!0)}})(),()=>{Ie=!0,qe&&qe()}},[F.user,r]),Y.useEffect(()=>{if(!F.user||r||!mt)return;const Ie=JSON.stringify(Ge);if(Ie===Le.current)return;const qe=setTimeout(async()=>{try{if(_s("navigator_restore_in_progress")){be.sync(" RESTORE PROTECTION: Debounced sync skipping to prevent data loss");return}if(_s("navigator_import_in_progress",300)){be.sync(" IMPORT PROTECTION: Waiting 300ms for import state to settle before sync");return}be.sync("Syncing changes to cloud..."),Le.current=Ie,await F.syncData(Ge),be.sync("Sync completed successfully")}catch(Je){be.error("Sync failed:",Je),Le.current="";const He=5e3;be.sync(` Scheduling sync retry in ${He/1e3}s...`),setTimeout(async()=>{try{be.sync(" Attempting sync retry..."),await F.syncData(Ge),be.sync(" Sync retry successful"),Le.current=JSON.stringify(Ge)}catch(Qe){be.error("Sync retry also failed:",Qe)}},He)}},150);return()=>clearTimeout(qe)},[Ge,F,mt,r]),Y.useEffect(()=>{if(!F.user||r||!mt)return;let Ie=JSON.stringify(Ge);const qe=async()=>{const ot=JSON.stringify(Ge);if(ot!==Ie&&(Ge.completions.length>0||Ge.addresses.length>0))try{be.info("Performing periodic safety backup..."),await ro(Ge,"manual"),Ie=ot,be.info("Periodic backup successful")}catch(it){be.error("Periodic backup failed:",it)}},Je=setInterval(qe,3600*1e3),He=localStorage.getItem("last_backup_time"),Qe=Date.now();return(!He||Qe-parseInt(He)>3600*1e3)&&setTimeout(async()=>{await qe(),localStorage.setItem("last_backup_time",Qe.toString())},5e3),()=>clearInterval(Je)},[Ge,F.user,mt,r]),Y.useEffect(()=>{if(!F.user||r||!mt)return;const Ie=()=>{const Je=Ge.completions.length,He=Ge.addresses.length,Qe=localStorage.getItem("navigator_data_counts");if(Qe){const{completions:ot,addresses:it}=JSON.parse(Qe);if(F.isSyncing){be.info("Skipping data integrity check - cloud sync in progress");return}const Oe=120*1e3,re=(F.lastSyncTime?Date.now()-F.lastSyncTime.getTime():1/0)<Oe,q=re?50:10,X=re?200:50;Je<ot-q&&(be.error(`POTENTIAL DATA LOSS DETECTED: Completions dropped from ${ot} to ${Je}`),re?be.warn(`Large completion count change during recent sync (${ot}  ${Je}) - monitoring`):z({title:" POTENTIAL DATA LOSS",message:`Completions count dropped significantly (${ot}  ${Je}). Check cloud backups immediately!`,type:"error"})),He<it-X&&(be.error(`POTENTIAL DATA LOSS DETECTED: Addresses dropped from ${it} to ${He}`),re?be.warn(`Large address count change during recent sync (${it}  ${He}) - monitoring`):z({title:" POTENTIAL DATA LOSS",message:`Address count dropped significantly (${it}  ${He}). Check cloud backups immediately!`,type:"error"}))}localStorage.setItem("navigator_data_counts",JSON.stringify({completions:Je,addresses:He,timestamp:new Date().toISOString()}))},qe=setInterval(Ie,30*1e3);return setTimeout(Ie,3e3),()=>clearInterval(qe)},[Ge,F.user,F.isSyncing,F.lastSyncTime,mt,r]);const sr=Y.useMemo(()=>{const Ie=e.currentListVersion,qe=new Set(St.filter(J=>J.listVersion===Ie).map(J=>J.index)),Je=Sr.length,He=Je-qe.size,Qe=St.filter(J=>J.listVersion===Ie&&J.outcome==="PIF").length,ot=St.filter(J=>J.listVersion===Ie&&J.outcome==="Done").length,it=St.filter(J=>J.listVersion===Ie&&J.outcome==="DA").length,Oe=St.filter(J=>J.listVersion===Ie&&J.outcome==="ARR").length,U=qe.size,re=ir.filter(J=>J.status!=="Completed"&&J.status!=="Cancelled").length,q=new Date().toISOString().slice(0,10),X=St.filter(J=>J.outcome==="PIF"&&(J.timestamp||"").slice(0,10)===q).reduce((J,ie)=>J+parseFloat(ie.amount||"0"),0);return{total:Je,pending:He,completed:U,pifCount:Qe,doneCount:ot,daCount:it,arrCount:Oe,pendingArrangements:re,todaysPIF:X}},[Sr,St,ir,e.currentListVersion]),ri=Y.useCallback(Ie=>{be.info(`Importing ${Ie.length} addresses...`),t(Ie,!0)},[t]),ln=Y.useCallback(async(Ie,qe,Je,He,Qe)=>{try{await c(Ie,qe,Je,He,Qe);try{const ot=x();Be&&(await ro(ot,"manual"),be.info("Cloud backup after completion successful")),Na.storeLocalBackup(ot),be.info("Local storage backup after completion successful")}catch(ot){be.error("Backup failed after completion:",ot)}}catch(ot){be.error("Failed to complete address:",ot)}},[c,x]),Fa=Y.useCallback(Ie=>{const qe=typeof Ie=="string"?new Date(Ie):Ie;if(Number.isNaN(qe.getTime())){be.error("Invalid start date:",Ie);return}const Je=qe.toISOString(),He=Je.slice(0,10);C(Qe=>{const ot=Qe.daySessions.slice();let it=ot.findIndex(X=>X.date===He),Oe;if(it>=0?Oe={...ot[it],start:Je}:Oe={date:He,start:Je},Oe.end)try{const X=new Date(Je).getTime(),J=new Date(Oe.end).getTime();J>=X?Oe.durationSeconds=Math.floor((J-X)/1e3):(delete Oe.end,delete Oe.durationSeconds)}catch(X){be.error("Error calculating duration:",X)}const U=new Date().toISOString();Oe.updatedAt=U,Oe.updatedBy=R;const re=`edit_start_${He}_${Date.now()}`,q={...Oe,id:He,updatedAt:U,updatedBy:R};return j("session",it>=0?"update":"create",q,re),it>=0?ot[it]=Oe:ot.push(Oe),{...Qe,daySessions:ot}})},[C,R,j]),La=Y.useCallback(Ie=>{const qe=typeof Ie=="string"?new Date(Ie):Ie;if(Number.isNaN(qe.getTime())){be.error("Invalid end date:",Ie);return}const Je=qe.toISOString(),He=Je.slice(0,10);C(Qe=>{const ot=Qe.daySessions.slice();let it=ot.findIndex(X=>X.date===He),Oe;if(it>=0?Oe={...ot[it]}:Oe={date:He,start:Je},Oe.end=Je,Oe.start)try{const X=new Date(Oe.start).getTime(),J=new Date(Je).getTime();J>=X?Oe.durationSeconds=Math.floor((J-X)/1e3):(Oe.start=Je,Oe.durationSeconds=0)}catch(X){be.error("Error calculating duration:",X),Oe.durationSeconds=0}const U=new Date().toISOString();Oe.updatedAt=U,Oe.updatedBy=R;const re=`edit_end_${He}_${Date.now()}`,q={...Oe,id:He,updatedAt:U,updatedBy:R};return j("session",it>=0?"update":"create",q,re),it>=0?ot[it]=Oe:ot.push(Oe),{...Qe,daySessions:ot}})},[C,R,j]),da=async Ie=>{const qe=Ie.target.files?.[0];if(qe)try{const Je=await O5(qe),He=t0(Je),Qe=Ge.daySessions,ot={...He,daySessions:Qe};y(ot),setTimeout(async()=>{await F.syncData(ot),Le.current=JSON.stringify(ot)},31e3),await h0(F,k,Be),st(!0),await z({title:"Success",message:"Restore completed successfully!",type:"success"})}catch(Je){be.error("Restore failed:",Je),await z({title:"Error",message:"Restore failed: "+(Je?.message||Je),type:"error"})}finally{Ie.target.value=""}},Dn=Y.useCallback(async(Ie,qe,Je)=>{k(He=>{if(!Number.isInteger(Ie)||Ie<0||Ie>=He.completions.length)return He;const Qe=He.completions.slice();return Qe[Ie]={...Qe[Ie],outcome:qe,amount:Je},{...He,completions:Qe}});try{await new Promise(Qe=>setTimeout(Qe,100));const He=x();Be&&(await ro(He,"manual"),be.info("Cloud backup after outcome change successful")),Na.storeLocalBackup(He),be.info("Local storage backup after outcome change successful")}catch(He){be.error("Backup failed after outcome change:",He)}},[k,x]),In=Y.useCallback(async()=>{try{be.sync("Manual sync initiated...");const Ie=JSON.stringify(Ge);if(_s("navigator_restore_in_progress")){be.sync(" RESTORE PROTECTION: Manual sync blocked to prevent data loss"),await z({title:"Restore in Progress",message:"Please wait 30 seconds before manual sync to prevent data loss"});return}Le.current=Ie,await F.syncData(Ge),be.sync("Manual sync completed successfully");try{await ro(Ge,"manual"),be.info("Safety backup after manual sync completed")}catch(qe){be.warn("Safety backup after sync failed:",qe)}}catch(Ie){be.error("Manual sync failed:",Ie),Le.current=""}},[F,Ge]),fa=(Ie,qe)=>{localStorage.setItem("navigator_supabase_url",Ie),localStorage.setItem("navigator_supabase_key",qe),window.location.reload()},Di=()=>{localStorage.setItem("navigator_supabase_skipped","true"),H(!1)};Y.useEffect(()=>{if(!F.user||r)return;const Ie=!!Be,qe=localStorage.getItem("navigator_supabase_skipped");!Ie&&!qe&&H(!0)},[F.user,r]),Y.useEffect(()=>{if(!mt)return;let Ie=JSON.stringify(Ge);const qe=async()=>{const ot=JSON.stringify(Ge);if(ot!==Ie&&(Ge.completions.length>0||Ge.addresses.length>0))try{be.info("Performing periodic safety backup..."),F.user&&Be&&await ro(Ge,"periodic"),Na.storeLocalBackup(Ge),Ie=ot,be.info("Periodic backup successful")}catch(it){be.error("Periodic backup failed:",it)}},Je=setInterval(qe,3600*1e3),He=setInterval(()=>{Na.cleanupOldBackups()},10080*60*1e3),Qe=Na.getBackupStats();return(Qe.count===0||Ge.completions.length>0&&Qe.count<3)&&setTimeout(async()=>{await qe()},5e3),()=>{clearInterval(Je),clearInterval(He)}},[Ge,F.user,mt]);const Ii=()=>{const Ie=F.user?.email||"",qe=Ie.split("@")[0].split(".");return qe.length>=2?(qe[0][0]+qe[1][0]).toUpperCase():Ie.slice(0,2).toUpperCase()},ni=F.isSyncing?{text:"Syncing",color:"var(--warning)"}:F.isOnline?F.error?{text:"Sync Error",color:"var(--danger)"}:{text:"Online",color:"var(--success)"}:{text:"Offline",color:"var(--danger)"};return r?u.jsx("div",{className:"app-wrapper",children:u.jsx("div",{className:"main-area",children:u.jsx("div",{className:"content-area",children:u.jsxs("div",{className:"loading",children:[u.jsx("div",{className:"spinner"}),"Preparing your workspace..."]})})})}):u.jsxs("div",{className:"app-wrapper",children:[u.jsx(xD,{isOpen:V,onSetupComplete:fa,onSkip:Di}),u.jsx(yD,{isOpen:se,onClose:()=>D(!1),currentData:Ge,onRestore:Ie=>{const qe=t0(Ie),Je=Ge.daySessions,He={...qe,daySessions:Je};y(He),F.user&&Be&&(setTimeout(async()=>{await F.syncData(He)},31e3),h0(F,k,Be))}}),ce&&ne&&u.jsx(Z5,{user:F.user,onClose:()=>Ne(!1)}),ve&&u.jsx(V5,{user:F.user,onClose:()=>he(!1)}),u.jsxs("main",{className:"main-area",children:[u.jsxs("header",{className:"app-header-modern",children:[u.jsxs("div",{className:"header-left",children:[u.jsxs("div",{className:"logo-section",children:[u.jsx("div",{className:"logo-icon",children:""}),u.jsxs("div",{className:"logo-text",children:[u.jsx("div",{className:"logo-title",children:"Navigator"}),u.jsx("div",{className:"logo-subtitle",children:"Enforcement Pro"})]})]}),me==="list"&&u.jsxs("div",{className:"search-container-modern",children:[u.jsx("span",{className:"search-icon",children:""}),u.jsx("input",{id:"search-addresses",name:"searchAddresses",type:"search",className:"search-input-modern",placeholder:"Search addresses...",value:Ke,onChange:Ie=>ae(Ie.target.value)})]})]}),u.jsxs("div",{className:"header-center",children:[u.jsxs("div",{className:"sync-status",children:[u.jsx("div",{className:"sync-indicator",style:{background:ni.color}}),u.jsx("span",{children:ni.text}),F.lastSyncTime&&u.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:F.lastSyncTime.toLocaleTimeString()})]}),u.jsx(TD,{reminderSettings:e.reminderSettings,onUpdateReminderSettings:N,onChangePassword:()=>I(!0),onChangeEmail:()=>G(!0),onDeleteAccount:()=>de(!0),appState:e,userEmail:F.user?.email})]}),u.jsx("button",{className:"menu-toggle",onClick:()=>le(!xe),children:""})]}),u.jsxs("div",{className:"content-area",children:[Q&&me==="list"&&u.jsx("div",{style:{background:"var(--surface)",padding:"1rem",borderRadius:"var(--radius-lg)",marginBottom:"1.5rem",border:"1px solid var(--border-light)",boxShadow:"var(--shadow-sm)"},children:u.jsxs("div",{className:"btn-row",style:{gap:"0.75rem",flexWrap:"wrap",alignItems:"stretch"},children:[u.jsx(X1,{onImported:ri}),u.jsx("input",{type:"file",accept:"application/json",onChange:da,className:"file-input",id:"restore-input",style:{display:"none"}}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>document.getElementById("restore-input")?.click(),style:{whiteSpace:"nowrap"},children:" Restore Backup"}),u.jsx("button",{className:"btn btn-ghost",onClick:In,disabled:F.isSyncing,style:{whiteSpace:"nowrap"},children:F.isSyncing?" Syncing...":" Sync Now"})]})}),me==="list"&&u.jsxs(u.Fragment,{children:[u.jsx(N5,{sessions:ct,completions:St,startDay:m,endDay:g,onEditStart:Fa,onEditEnd:La,onBackup:async()=>{const Ie=x(),qe=Je=>new Promise((He,Qe)=>setTimeout(()=>Qe(new Error("Backup timeout")),Je));try{Be&&(await Promise.race([ro(Ie,"finish"),qe(3e4)]),be.info("Cloud backup at day end successful")),await Promise.race([Na.performCriticalBackup(Ie,"day-end"),qe(15e3)]),be.info("Local backup at day end successful")}catch(Je){throw be.error("Backup failed or timed out:",Je),Je}}}),u.jsxs("div",{className:"stats-grid",children:[u.jsx(zd,{title:"Pending Addresses",value:sr.pending,change:`${sr.completed} completed today`,changeType:"positive",icon:"",iconType:"info"}),u.jsx(zd,{title:"Today's Earnings",value:`${sr.todaysPIF.toFixed(0)}`,change:`${sr.pifCount} PIF today`,changeType:"positive",icon:"",iconType:"success"}),u.jsx(zd,{title:"Arrangements Due",value:sr.pendingArrangements,change:"Check arrangements tab",changeType:"neutral",icon:"",iconType:"warning"}),u.jsx(zd,{title:"Completion Rate",value:`${Math.round(sr.completed/Math.max(sr.total,1)*100)}%`,change:"Good performance",changeType:"positive",icon:"",iconType:"success"})]}),u.jsx(y5,{state:Ge,setActive:a,cancelActive:l,onComplete:ln,onAddArrangement:b,filterText:Ke}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",margin:"1.25rem 0 3rem",flexWrap:"wrap",alignItems:"center"},children:[u.jsx("button",{className:"btn btn-ghost",onClick:()=>f(-1),title:"Undo last completion",children:" Undo Last"}),u.jsxs("span",{className:"pill pill-pif",children:["PIF ",sr.pifCount]}),u.jsxs("span",{className:"pill pill-done",children:["Done ",sr.doneCount]}),u.jsxs("span",{className:"pill pill-da",children:["DA ",sr.daCount]}),u.jsxs("span",{className:"pill pill-active",children:["ARR ",sr.arrCount]})]})]}),me==="completed"&&u.jsx(C5,{state:Ge,onChangeOutcome:Dn,onAddArrangement:b,onComplete:ln}),me==="arrangements"&&u.jsx(I5,{state:Ge,onAddArrangement:b,onUpdateArrangement:E,onDeleteArrangement:S,onAddAddress:async Ie=>n(Ie),onComplete:ln,autoCreateForAddress:at,onAutoCreateHandled:()=>dt(null)}),me==="earnings"&&u.jsx(Y5,{state:Ge,user:F.user}),me==="planning"&&u.jsx(vD,{user:F.user,onAddressesReady:Ie=>{t(Ie,!1)}})]}),u.jsx(j5,{onAdd:n})]}),u.jsxs("aside",{className:`sidebar-right ${xe?"open":""}`,children:[u.jsx("div",{className:"sidebar-header",children:u.jsxs("div",{className:"user-profile-section",children:[u.jsx("div",{className:"user-avatar",children:Ii()}),u.jsxs("div",{className:"user-info",children:[u.jsx("div",{className:"user-name",children:F.user?.email?.split("@")[0]}),u.jsx("div",{className:"user-plan",children:ee?"Owner Access":O?"Premium Plan":"Free Trial"})]})]})}),u.jsxs("nav",{className:"nav-menu",children:[u.jsxs("div",{className:"nav-section",children:[u.jsx("div",{className:"nav-section-title",children:"Main"}),u.jsxs("div",{className:`nav-item ${me==="list"?"active":""}`,onClick:()=>{At("list"),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Address List"}),u.jsx("span",{className:"nav-badge",children:sr.pending})]}),u.jsxs("div",{className:`nav-item ${me==="completed"?"active":""}`,onClick:()=>{At("completed"),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Completed"}),u.jsx("span",{className:"nav-badge",children:sr.completed})]}),u.jsxs("div",{className:`nav-item ${me==="arrangements"?"active":""}`,onClick:()=>{At("arrangements"),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Arrangements"}),u.jsx("span",{className:"nav-badge",children:sr.pendingArrangements})]})]}),u.jsxs("div",{className:"nav-section",children:[u.jsx("div",{className:"nav-section-title",children:"Analytics"}),u.jsxs("div",{className:`nav-item ${me==="earnings"?"active":""}`,onClick:()=>{At("earnings"),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Earnings"})]}),u.jsxs("div",{className:`nav-item ${me==="planning"?"active":""}`,onClick:()=>{At("planning"),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Route Planning"})]})]}),u.jsxs("div",{className:"nav-section",children:[u.jsx("div",{className:"nav-section-title",children:"Tools"}),u.jsxs("div",{className:"nav-item",onClick:()=>{M(!Q),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Import/Export"})]}),u.jsxs("div",{className:"nav-item",onClick:()=>{D(!0),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Backup Manager"})]}),Be&&u.jsxs("div",{className:"nav-item",onClick:async()=>{Yt(!0),await $t(),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Cloud Backups"})]}),!Be&&u.jsxs("div",{className:"nav-item",onClick:()=>{H(!0),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Connect Cloud Storage"})]})]}),u.jsxs("div",{className:"nav-section",children:[u.jsx("div",{className:"nav-section-title",children:"Account"}),u.jsxs("div",{className:"nav-item",onClick:()=>{he(!0),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Subscription"})]}),ne&&u.jsxs("div",{className:"nav-item",onClick:()=>{Ne(!0),le(!1)},children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Admin Panel"})]}),u.jsxs("div",{className:"nav-item",onClick:F.signOut,children:[u.jsx("span",{className:"nav-icon",children:""}),u.jsx("span",{children:"Sign Out"})]})]})]})]}),u.jsx("div",{className:`sidebar-overlay ${xe?"active":""}`,onClick:()=>le(!1)}),dr&&u.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3,minWidth:320,maxWidth:500,maxHeight:"70vh",background:"white",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-2xl)",overflow:"hidden",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--gray-200)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("h3",{style:{margin:0},children:"Cloud Backups (Last 7 Days)"}),u.jsx("button",{className:"btn btn-ghost",style:{padding:"0.5rem"},onClick:()=>Yt(!1),children:""})]}),u.jsxs("div",{style:{flex:1,overflow:"auto",padding:"1rem"},children:[br&&u.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[u.jsx("div",{className:"spinner"}),u.jsx("p",{children:"Loading backups..."})]}),!br&&kr&&u.jsx("div",{style:{padding:"1rem",color:"var(--danger)"},children:kr}),!br&&!kr&&Qt.length===0&&u.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--gray-500)"},children:"No backups found"}),!br&&!kr&&Qt.map(Ie=>{const qe=Ie.object_path.split("/"),Je=qe[qe.length-1]||Ie.object_path,He=Ie.day_key||"",Qe=Ie.size_bytes?Math.round(Ie.size_bytes/1024)+" KB":"";return u.jsxs("button",{className:"btn btn-ghost",style:{width:"100%",justifyContent:"space-between",marginBottom:"0.5rem",padding:"1rem"},onClick:()=>Gr(Ie.object_path),children:[u.jsx("span",{style:{fontWeight:500},children:Je}),u.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--gray-500)"},children:[He,"  ",Qe]})]},Ie.object_path)})]})]}),dr&&u.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1999},onClick:()=>Yt(!1)}),F.error&&F.error!=="Auth session missing!"&&!F.isLoading&&u.jsxs("div",{style:{position:"fixed",bottom:"1rem",left:"50%",transform:"translateX(-50%)",background:"var(--danger-light)",border:"1px solid var(--danger)",borderRadius:"var(--radius-lg)",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",boxShadow:"var(--shadow-lg)",zIndex:1e3},children:[u.jsxs("span",{style:{color:"var(--danger)"},children:[" ",F.error]}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:F.clearError,children:"Dismiss"})]}),P&&u.jsx("div",{className:"modal-overlay",onClick:()=>I(!1),children:u.jsxs("div",{className:"modal-content",onClick:Ie=>Ie.stopPropagation(),style:{maxWidth:"400px"},children:[u.jsx("h2",{style:{marginBottom:"1rem"},children:"Change Password"}),u.jsxs("form",{onSubmit:async Ie=>{Ie.preventDefault();const qe=Ie.target,Je=qe.elements.namedItem("newPassword").value,He=qe.elements.namedItem("confirmPassword").value;if(Je!==He){window.alert("Passwords do not match");return}if(Je.length<6){window.alert("Password must be at least 6 characters");return}try{await F.updatePassword(Je),window.alert("Password updated successfully!"),I(!1)}catch(Qe){window.alert("Error: "+Qe.message)}},children:[u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"New Password"}),u.jsx("input",{type:"password",name:"newPassword",className:"input",required:!0,minLength:6})]}),u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"Confirm Password"}),u.jsx("input",{type:"password",name:"confirmPassword",className:"input",required:!0,minLength:6})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:1},children:"Update Password"}),u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>I(!1),children:"Cancel"})]})]})]})}),B&&u.jsx("div",{className:"modal-overlay",onClick:()=>G(!1),children:u.jsxs("div",{className:"modal-content",onClick:Ie=>Ie.stopPropagation(),style:{maxWidth:"400px"},children:[u.jsx("h2",{style:{marginBottom:"1rem"},children:"Change Email"}),u.jsx("p",{style:{marginBottom:"1rem",color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Note: You'll need to confirm your new email address."}),u.jsxs("form",{onSubmit:async Ie=>{Ie.preventDefault();const Je=Ie.target.elements.namedItem("newEmail").value;try{if(!Be)throw new Error("Supabase not configured");const{error:He}=await Be.auth.updateUser({email:Je});if(He)throw He;window.alert("Confirmation email sent! Please check your inbox."),G(!1)}catch(He){window.alert("Error: "+He.message)}},children:[u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"New Email"}),u.jsx("input",{type:"email",name:"newEmail",className:"input",required:!0})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:1},children:"Update Email"}),u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>G(!1),children:"Cancel"})]})]})]})}),te&&u.jsx("div",{className:"modal-overlay",onClick:()=>de(!1),children:u.jsxs("div",{className:"modal-content",onClick:Ie=>Ie.stopPropagation(),style:{maxWidth:"400px"},children:[u.jsx("h2",{style:{marginBottom:"1rem",color:"var(--danger)"},children:"Delete Account"}),u.jsx("p",{style:{marginBottom:"1rem"},children:" This action cannot be undone. All your data will be permanently deleted."}),u.jsxs("p",{style:{marginBottom:"1rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Type ",u.jsx("strong",{children:"DELETE"})," to confirm:"]}),u.jsxs("form",{onSubmit:async Ie=>{if(Ie.preventDefault(),Ie.target.elements.namedItem("confirmation").value!=="DELETE"){window.alert("Please type DELETE to confirm");return}try{if(!Be)throw new Error("Supabase not configured");const{error:He}=await Be.rpc("delete_user_account");if(He)throw He;await F.signOut(),window.alert("Account deleted successfully"),de(!1)}catch(He){window.alert("Error: "+He.message)}},children:[u.jsx("div",{style:{marginBottom:"1rem"},children:u.jsx("input",{type:"text",name:"confirmation",className:"input",required:!0,placeholder:"Type DELETE"})}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{type:"submit",className:"btn",style:{flex:1,background:"var(--danger)",color:"white"},children:"Delete Account"}),u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>de(!1),children:"Cancel"})]})]})]})}),u.jsx(ED,{}),u.jsx(CD,{})]})}const ND="https://eevfxrgemrtthxbcxtvq.supabase.co";try{const e=new URL(ND).origin;["preconnect","dns-prefetch"].forEach(r=>{const t=document.createElement("link");t.rel=r,t.href=e,r==="preconnect"&&(t.crossOrigin=""),document.head.appendChild(t)})}catch{}U_.createRoot(document.getElementById("root")).render(u.jsx(AD,{}));
