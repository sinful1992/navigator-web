(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=t(a);fetch(a.href,l)}})();function tf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function y_(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var r=e.default;if(typeof r=="function"){var t=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};t.prototype=r.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),t}var Oh={exports:{}},vc={},Ih={exports:{}},Et={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jp;function __(){if(Jp)return Et;Jp=1;var e=Symbol.for("react.element"),r=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),_=Symbol.iterator;function y(R){return R===null||typeof R!="object"?null:(R=_&&R[_]||R["@@iterator"],typeof R=="function"?R:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,b={};function E(R,P,W){this.props=R,this.context=P,this.refs=b,this.updater=W||S}E.prototype.isReactComponent={},E.prototype.setState=function(R,P){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,P,"setState")},E.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function D(){}D.prototype=E.prototype;function F(R,P,W){this.props=R,this.context=P,this.refs=b,this.updater=W||S}var O=F.prototype=new D;O.constructor=F,C(O,E.prototype),O.isPureReactComponent=!0;var M=Array.isArray,G=Object.prototype.hasOwnProperty,I={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function q(R,P,W){var U,H={},le=null,ge=null;if(P!=null)for(U in P.ref!==void 0&&(ge=P.ref),P.key!==void 0&&(le=""+P.key),P)G.call(P,U)&&!N.hasOwnProperty(U)&&(H[U]=P[U]);var Ce=arguments.length-2;if(Ce===1)H.children=W;else if(1<Ce){for(var ke=Array(Ce),xe=0;xe<Ce;xe++)ke[xe]=arguments[xe+2];H.children=ke}if(R&&R.defaultProps)for(U in Ce=R.defaultProps,Ce)H[U]===void 0&&(H[U]=Ce[U]);return{$$typeof:e,type:R,key:le,ref:ge,props:H,_owner:I.current}}function Z(R,P){return{$$typeof:e,type:R.type,key:P,ref:R.ref,props:R.props,_owner:R._owner}}function me(R){return typeof R=="object"&&R!==null&&R.$$typeof===e}function ue(R){var P={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(W){return P[W]})}var Y=/\/+/g;function se(R,P){return typeof R=="object"&&R!==null&&R.key!=null?ue(""+R.key):P.toString(36)}function ve(R,P,W,U,H){var le=typeof R;(le==="undefined"||le==="boolean")&&(R=null);var ge=!1;if(R===null)ge=!0;else switch(le){case"string":case"number":ge=!0;break;case"object":switch(R.$$typeof){case e:case r:ge=!0}}if(ge)return ge=R,H=H(ge),R=U===""?"."+se(ge,0):U,M(H)?(W="",R!=null&&(W=R.replace(Y,"$&/")+"/"),ve(H,P,W,"",function(xe){return xe})):H!=null&&(me(H)&&(H=Z(H,W+(!H.key||ge&&ge.key===H.key?"":(""+H.key).replace(Y,"$&/")+"/")+R)),P.push(H)),1;if(ge=0,U=U===""?".":U+":",M(R))for(var Ce=0;Ce<R.length;Ce++){le=R[Ce];var ke=U+se(le,Ce);ge+=ve(le,P,W,ke,H)}else if(ke=y(R),typeof ke=="function")for(R=ke.call(R),Ce=0;!(le=R.next()).done;)le=le.value,ke=U+se(le,Ce++),ge+=ve(le,P,W,ke,H);else if(le==="object")throw P=String(R),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.");return ge}function ee(R,P,W){if(R==null)return R;var U=[],H=0;return ve(R,U,"","",function(le){return P.call(W,le,H++)}),U}function ce(R){if(R._status===-1){var P=R._result;P=P(),P.then(function(W){(R._status===0||R._status===-1)&&(R._status=1,R._result=W)},function(W){(R._status===0||R._status===-1)&&(R._status=2,R._result=W)}),R._status===-1&&(R._status=0,R._result=P)}if(R._status===1)return R._result.default;throw R._result}var V={current:null},ie={transition:null},Q={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:ie,ReactCurrentOwner:I};function fe(){throw Error("act(...) is not supported in production builds of React.")}return Et.Children={map:ee,forEach:function(R,P,W){ee(R,function(){P.apply(this,arguments)},W)},count:function(R){var P=0;return ee(R,function(){P++}),P},toArray:function(R){return ee(R,function(P){return P})||[]},only:function(R){if(!me(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},Et.Component=E,Et.Fragment=t,Et.Profiler=a,Et.PureComponent=F,Et.StrictMode=n,Et.Suspense=m,Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,Et.act=fe,Et.cloneElement=function(R,P,W){if(R==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+R+".");var U=C({},R.props),H=R.key,le=R.ref,ge=R._owner;if(P!=null){if(P.ref!==void 0&&(le=P.ref,ge=I.current),P.key!==void 0&&(H=""+P.key),R.type&&R.type.defaultProps)var Ce=R.type.defaultProps;for(ke in P)G.call(P,ke)&&!N.hasOwnProperty(ke)&&(U[ke]=P[ke]===void 0&&Ce!==void 0?Ce[ke]:P[ke])}var ke=arguments.length-2;if(ke===1)U.children=W;else if(1<ke){Ce=Array(ke);for(var xe=0;xe<ke;xe++)Ce[xe]=arguments[xe+2];U.children=Ce}return{$$typeof:e,type:R.type,key:H,ref:le,props:U,_owner:ge}},Et.createContext=function(R){return R={$$typeof:c,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},R.Provider={$$typeof:l,_context:R},R.Consumer=R},Et.createElement=q,Et.createFactory=function(R){var P=q.bind(null,R);return P.type=R,P},Et.createRef=function(){return{current:null}},Et.forwardRef=function(R){return{$$typeof:d,render:R}},Et.isValidElement=me,Et.lazy=function(R){return{$$typeof:x,_payload:{_status:-1,_result:R},_init:ce}},Et.memo=function(R,P){return{$$typeof:g,type:R,compare:P===void 0?null:P}},Et.startTransition=function(R){var P=ie.transition;ie.transition={};try{R()}finally{ie.transition=P}},Et.unstable_act=fe,Et.useCallback=function(R,P){return V.current.useCallback(R,P)},Et.useContext=function(R){return V.current.useContext(R)},Et.useDebugValue=function(){},Et.useDeferredValue=function(R){return V.current.useDeferredValue(R)},Et.useEffect=function(R,P){return V.current.useEffect(R,P)},Et.useId=function(){return V.current.useId()},Et.useImperativeHandle=function(R,P,W){return V.current.useImperativeHandle(R,P,W)},Et.useInsertionEffect=function(R,P){return V.current.useInsertionEffect(R,P)},Et.useLayoutEffect=function(R,P){return V.current.useLayoutEffect(R,P)},Et.useMemo=function(R,P){return V.current.useMemo(R,P)},Et.useReducer=function(R,P,W){return V.current.useReducer(R,P,W)},Et.useRef=function(R){return V.current.useRef(R)},Et.useState=function(R){return V.current.useState(R)},Et.useSyncExternalStore=function(R,P,W){return V.current.useSyncExternalStore(R,P,W)},Et.useTransition=function(){return V.current.useTransition()},Et.version="18.3.1",Et}var Qp;function F0(){return Qp||(Qp=1,Ih.exports=__()),Ih.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eg;function w_(){if(eg)return vc;eg=1;var e=F0(),r=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(d,m,g){var x,_={},y=null,S=null;g!==void 0&&(y=""+g),m.key!==void 0&&(y=""+m.key),m.ref!==void 0&&(S=m.ref);for(x in m)n.call(m,x)&&!l.hasOwnProperty(x)&&(_[x]=m[x]);if(d&&d.defaultProps)for(x in m=d.defaultProps,m)_[x]===void 0&&(_[x]=m[x]);return{$$typeof:r,type:d,key:y,ref:S,props:_,_owner:a.current}}return vc.Fragment=t,vc.jsx=c,vc.jsxs=c,vc}var tg;function k_(){return tg||(tg=1,Oh.exports=w_()),Oh.exports}var h=k_(),fd={},Fh={exports:{}},Fn={},Lh={exports:{}},Rh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rg;function b_(){return rg||(rg=1,(function(e){function r(ie,Q){var fe=ie.length;ie.push(Q);e:for(;0<fe;){var R=fe-1>>>1,P=ie[R];if(0<a(P,Q))ie[R]=Q,ie[fe]=P,fe=R;else break e}}function t(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var Q=ie[0],fe=ie.pop();if(fe!==Q){ie[0]=fe;e:for(var R=0,P=ie.length,W=P>>>1;R<W;){var U=2*(R+1)-1,H=ie[U],le=U+1,ge=ie[le];if(0>a(H,fe))le<P&&0>a(ge,H)?(ie[R]=ge,ie[le]=fe,R=le):(ie[R]=H,ie[U]=fe,R=U);else if(le<P&&0>a(ge,fe))ie[R]=ge,ie[le]=fe,R=le;else break e}}return Q}function a(ie,Q){var fe=ie.sortIndex-Q.sortIndex;return fe!==0?fe:ie.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();e.unstable_now=function(){return c.now()-d}}var m=[],g=[],x=1,_=null,y=3,S=!1,C=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O(ie){for(var Q=t(g);Q!==null;){if(Q.callback===null)n(g);else if(Q.startTime<=ie)n(g),Q.sortIndex=Q.expirationTime,r(m,Q);else break;Q=t(g)}}function M(ie){if(b=!1,O(ie),!C)if(t(m)!==null)C=!0,ce(G);else{var Q=t(g);Q!==null&&V(M,Q.startTime-ie)}}function G(ie,Q){C=!1,b&&(b=!1,D(q),q=-1),S=!0;var fe=y;try{for(O(Q),_=t(m);_!==null&&(!(_.expirationTime>Q)||ie&&!ue());){var R=_.callback;if(typeof R=="function"){_.callback=null,y=_.priorityLevel;var P=R(_.expirationTime<=Q);Q=e.unstable_now(),typeof P=="function"?_.callback=P:_===t(m)&&n(m),O(Q)}else n(m);_=t(m)}if(_!==null)var W=!0;else{var U=t(g);U!==null&&V(M,U.startTime-Q),W=!1}return W}finally{_=null,y=fe,S=!1}}var I=!1,N=null,q=-1,Z=5,me=-1;function ue(){return!(e.unstable_now()-me<Z)}function Y(){if(N!==null){var ie=e.unstable_now();me=ie;var Q=!0;try{Q=N(!0,ie)}finally{Q?se():(I=!1,N=null)}}else I=!1}var se;if(typeof F=="function")se=function(){F(Y)};else if(typeof MessageChannel<"u"){var ve=new MessageChannel,ee=ve.port2;ve.port1.onmessage=Y,se=function(){ee.postMessage(null)}}else se=function(){E(Y,0)};function ce(ie){N=ie,I||(I=!0,se())}function V(ie,Q){q=E(function(){ie(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){C||S||(C=!0,ce(G))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return t(m)},e.unstable_next=function(ie){switch(y){case 1:case 2:case 3:var Q=3;break;default:Q=y}var fe=y;y=Q;try{return ie()}finally{y=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,Q){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var fe=y;y=ie;try{return Q()}finally{y=fe}},e.unstable_scheduleCallback=function(ie,Q,fe){var R=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?R+fe:R):fe=R,ie){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=fe+P,ie={id:x++,callback:Q,priorityLevel:ie,startTime:fe,expirationTime:P,sortIndex:-1},fe>R?(ie.sortIndex=fe,r(g,ie),t(m)===null&&ie===t(g)&&(b?(D(q),q=-1):b=!0,V(M,fe-R))):(ie.sortIndex=P,r(m,ie),C||S||(C=!0,ce(G))),ie},e.unstable_shouldYield=ue,e.unstable_wrapCallback=function(ie){var Q=y;return function(){var fe=y;y=Q;try{return ie.apply(this,arguments)}finally{y=fe}}}})(Rh)),Rh}var ng;function S_(){return ng||(ng=1,Lh.exports=b_()),Lh.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ag;function T_(){if(ag)return Fn;ag=1;var e=F0(),r=S_();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,f=1;f<arguments.length;f++)o+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function l(i,o){c(i,o),c(i+"Capture",o)}function c(i,o){for(a[i]=o,i=0;i<o.length;i++)n.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},_={};function y(i){return m.call(_,i)?!0:m.call(x,i)?!1:g.test(i)?_[i]=!0:(x[i]=!0,!1)}function S(i,o,f,v){if(f!==null&&f.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return v?!1:f!==null?!f.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function C(i,o,f,v){if(o===null||typeof o>"u"||S(i,o,f,v))return!0;if(v)return!1;if(f!==null)switch(f.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function b(i,o,f,v,k,T,j){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=v,this.attributeNamespace=k,this.mustUseProperty=f,this.propertyName=i,this.type=o,this.sanitizeURL=T,this.removeEmptyString=j}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){E[i]=new b(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];E[o]=new b(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){E[i]=new b(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){E[i]=new b(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){E[i]=new b(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){E[i]=new b(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){E[i]=new b(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){E[i]=new b(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){E[i]=new b(i,5,!1,i.toLowerCase(),null,!1,!1)});var D=/[\-:]([a-z])/g;function F(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(D,F);E[o]=new b(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(D,F);E[o]=new b(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(D,F);E[o]=new b(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){E[i]=new b(i,1,!1,i.toLowerCase(),null,!1,!1)}),E.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){E[i]=new b(i,1,!1,i.toLowerCase(),null,!0,!0)});function O(i,o,f,v){var k=E.hasOwnProperty(o)?E[o]:null;(k!==null?k.type!==0:v||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(C(o,f,k,v)&&(f=null),v||k===null?y(o)&&(f===null?i.removeAttribute(o):i.setAttribute(o,""+f)):k.mustUseProperty?i[k.propertyName]=f===null?k.type===3?!1:"":f:(o=k.attributeName,v=k.attributeNamespace,f===null?i.removeAttribute(o):(k=k.type,f=k===3||k===4&&f===!0?"":""+f,v?i.setAttributeNS(v,o,f):i.setAttribute(o,f))))}var M=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,G=Symbol.for("react.element"),I=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),Z=Symbol.for("react.profiler"),me=Symbol.for("react.provider"),ue=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),ve=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),ce=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),ie=Symbol.iterator;function Q(i){return i===null||typeof i!="object"?null:(i=ie&&i[ie]||i["@@iterator"],typeof i=="function"?i:null)}var fe=Object.assign,R;function P(i){if(R===void 0)try{throw Error()}catch(f){var o=f.stack.trim().match(/\n( *(at )?)/);R=o&&o[1]||""}return`
`+R+i}var W=!1;function U(i,o){if(!i||W)return"";W=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Pe){var v=Pe}Reflect.construct(i,[],o)}else{try{o.call()}catch(Pe){v=Pe}i.call(o.prototype)}else{try{throw Error()}catch(Pe){v=Pe}i()}}catch(Pe){if(Pe&&v&&typeof Pe.stack=="string"){for(var k=Pe.stack.split(`
`),T=v.stack.split(`
`),j=k.length-1,oe=T.length-1;1<=j&&0<=oe&&k[j]!==T[oe];)oe--;for(;1<=j&&0<=oe;j--,oe--)if(k[j]!==T[oe]){if(j!==1||oe!==1)do if(j--,oe--,0>oe||k[j]!==T[oe]){var he=`
`+k[j].replace(" at new "," at ");return i.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",i.displayName)),he}while(1<=j&&0<=oe);break}}}finally{W=!1,Error.prepareStackTrace=f}return(i=i?i.displayName||i.name:"")?P(i):""}function H(i){switch(i.tag){case 5:return P(i.type);case 16:return P("Lazy");case 13:return P("Suspense");case 19:return P("SuspenseList");case 0:case 2:case 15:return i=U(i.type,!1),i;case 11:return i=U(i.type.render,!1),i;case 1:return i=U(i.type,!0),i;default:return""}}function le(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case N:return"Fragment";case I:return"Portal";case Z:return"Profiler";case q:return"StrictMode";case se:return"Suspense";case ve:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case ue:return(i.displayName||"Context")+".Consumer";case me:return(i._context.displayName||"Context")+".Provider";case Y:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ee:return o=i.displayName||null,o!==null?o:le(i.type)||"Memo";case ce:o=i._payload,i=i._init;try{return le(i(o))}catch{}}return null}function ge(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(o);case 8:return o===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Ce(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ke(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function xe(i){var o=ke(i)?"checked":"value",f=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),v=""+i[o];if(!i.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var k=f.get,T=f.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return k.call(this)},set:function(j){v=""+j,T.call(this,j)}}),Object.defineProperty(i,o,{enumerable:f.enumerable}),{getValue:function(){return v},setValue:function(j){v=""+j},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Ke(i){i._valueTracker||(i._valueTracker=xe(i))}function te(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var f=o.getValue(),v="";return i&&(v=ke(i)?i.checked?"true":"false":i.value),i=v,i!==f?(o.setValue(i),!0):!1}function Tt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function bt(i,o){var f=o.checked;return fe({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??i._wrapperState.initialChecked})}function yt(i,o){var f=o.defaultValue==null?"":o.defaultValue,v=o.checked!=null?o.checked:o.defaultChecked;f=Ce(o.value!=null?o.value:f),i._wrapperState={initialChecked:v,initialValue:f,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ut(i,o){o=o.checked,o!=null&&O(i,"checked",o,!1)}function Ue(i,o){ut(i,o);var f=Ce(o.value),v=o.type;if(f!=null)v==="number"?(f===0&&i.value===""||i.value!=f)&&(i.value=""+f):i.value!==""+f&&(i.value=""+f);else if(v==="submit"||v==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?rr(i,o.type,f):o.hasOwnProperty("defaultValue")&&rr(i,o.type,Ce(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function Pt(i,o,f){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var v=o.type;if(!(v!=="submit"&&v!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,f||o===i.value||(i.value=o),i.defaultValue=o}f=i.name,f!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,f!==""&&(i.name=f)}function rr(i,o,f){(o!=="number"||Tt(i.ownerDocument)!==i)&&(f==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+f&&(i.defaultValue=""+f))}var Mt=Array.isArray;function Zt(i,o,f,v){if(i=i.options,o){o={};for(var k=0;k<f.length;k++)o["$"+f[k]]=!0;for(f=0;f<i.length;f++)k=o.hasOwnProperty("$"+i[f].value),i[f].selected!==k&&(i[f].selected=k),k&&v&&(i[f].defaultSelected=!0)}else{for(f=""+Ce(f),o=null,k=0;k<i.length;k++){if(i[k].value===f){i[k].selected=!0,v&&(i[k].defaultSelected=!0);return}o!==null||i[k].disabled||(o=i[k])}o!==null&&(o.selected=!0)}}function Vr(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return fe({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function at(i,o){var f=o.value;if(f==null){if(f=o.children,o=o.defaultValue,f!=null){if(o!=null)throw Error(t(92));if(Mt(f)){if(1<f.length)throw Error(t(93));f=f[0]}o=f}o==null&&(o=""),f=o}i._wrapperState={initialValue:Ce(f)}}function pr(i,o){var f=Ce(o.value),v=Ce(o.defaultValue);f!=null&&(f=""+f,f!==i.value&&(i.value=f),o.defaultValue==null&&i.defaultValue!==f&&(i.defaultValue=f)),v!=null&&(i.defaultValue=""+v)}function Jr(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function Gr(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vt(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?Gr(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Jt,Rr=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,f,v,k){MSApp.execUnsafeLocalFunction(function(){return i(o,f,v,k)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(Jt=Jt||document.createElement("div"),Jt.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Jt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function ct(i,o){if(o){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=o;return}}i.textContent=o}var Rt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jr=["Webkit","ms","Moz","O"];Object.keys(Rt).forEach(function(i){jr.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),Rt[o]=Rt[i]})});function Gt(i,o,f){return o==null||typeof o=="boolean"||o===""?"":f||typeof o!="number"||o===0||Rt.hasOwnProperty(i)&&Rt[i]?(""+o).trim():o+"px"}function Qr(i,o){i=i.style;for(var f in o)if(o.hasOwnProperty(f)){var v=f.indexOf("--")===0,k=Gt(f,o[f],v);f==="float"&&(f="cssFloat"),v?i.setProperty(f,k):i[f]=k}}var ri=fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ni(i,o){if(o){if(ri[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function Rn(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ai=null;function ma(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ie=null,Ye=null,Ge=null;function Ve(i){if(i=pi(i)){if(typeof Ie!="function")throw Error(t(280));var o=i.stateNode;o&&(o=Uo(o),Ie(i.stateNode,i.type,o))}}function Qe(i){Ye?Ge?Ge.push(i):Ge=[i]:Ye=i}function gt(){if(Ye){var i=Ye,o=Ge;if(Ge=Ye=null,Ve(i),o)for(i=0;i<o.length;i++)Ve(o[i])}}function ht(i,o){return i(o)}function nt(){}var ir=!1;function sr(i,o,f){if(ir)return i(o,f);ir=!0;try{return ht(i,o,f)}finally{ir=!1,(Ye!==null||Ge!==null)&&(nt(),gt())}}function gr(i,o){var f=i.stateNode;if(f===null)return null;var v=Uo(f);if(v===null)return null;f=v[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(i=i.type,v=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!v;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(t(231,o,typeof f));return f}var Qt=!1;if(d)try{var St={};Object.defineProperty(St,"passive",{get:function(){Qt=!0}}),window.addEventListener("test",St,St),window.removeEventListener("test",St,St)}catch{Qt=!1}function Cs(i,o,f,v,k,T,j,oe,he){var Pe=Array.prototype.slice.call(arguments,3);try{o.apply(f,Pe)}catch(Le){this.onError(Le)}}var Mr=!1,et=null,B=!1,re=null,K={onError:function(i){Mr=!0,et=i}};function X(i,o,f,v,k,T,j,oe,he){Mr=!1,et=null,Cs.apply(K,arguments)}function ne(i,o,f,v,k,T,j,oe,he){if(X.apply(this,arguments),Mr){if(Mr){var Pe=et;Mr=!1,et=null}else throw Error(t(198));B||(B=!0,re=Pe)}}function ae(i){var o=i,f=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(f=o.return),i=o.return;while(i)}return o.tag===3?f:null}function we(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function De(i){if(ae(i)!==i)throw Error(t(188))}function be(i){var o=i.alternate;if(!o){if(o=ae(i),o===null)throw Error(t(188));return o!==i?null:i}for(var f=i,v=o;;){var k=f.return;if(k===null)break;var T=k.alternate;if(T===null){if(v=k.return,v!==null){f=v;continue}break}if(k.child===T.child){for(T=k.child;T;){if(T===f)return De(k),i;if(T===v)return De(k),o;T=T.sibling}throw Error(t(188))}if(f.return!==v.return)f=k,v=T;else{for(var j=!1,oe=k.child;oe;){if(oe===f){j=!0,f=k,v=T;break}if(oe===v){j=!0,v=k,f=T;break}oe=oe.sibling}if(!j){for(oe=T.child;oe;){if(oe===f){j=!0,f=T,v=k;break}if(oe===v){j=!0,v=T,f=k;break}oe=oe.sibling}if(!j)throw Error(t(189))}}if(f.alternate!==v)throw Error(t(190))}if(f.tag!==3)throw Error(t(188));return f.stateNode.current===f?i:o}function Te(i){return i=be(i),i!==null?Ee(i):null}function Ee(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=Ee(i);if(o!==null)return o;i=i.sibling}return null}var Re=r.unstable_scheduleCallback,We=r.unstable_cancelCallback,Ze=r.unstable_shouldYield,Be=r.unstable_requestPaint,Me=r.unstable_now,mt=r.unstable_getCurrentPriorityLevel,zt=r.unstable_ImmediatePriority,$t=r.unstable_UserBlockingPriority,or=r.unstable_NormalPriority,pa=r.unstable_LowPriority,En=r.unstable_IdlePriority,jn=null,vr=null;function ga(i){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(jn,i,void 0,(i.current.flags&128)===128)}catch{}}var it=Math.clz32?Math.clz32:Oi,er=Math.log,yo=Math.LN2;function Oi(i){return i>>>=0,i===0?32:31-(er(i)/yo|0)|0}var va=64,Ii=4194304;function vt(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Kt(i,o){var f=i.pendingLanes;if(f===0)return 0;var v=0,k=i.suspendedLanes,T=i.pingedLanes,j=f&268435455;if(j!==0){var oe=j&~k;oe!==0?v=vt(oe):(T&=j,T!==0&&(v=vt(T)))}else j=f&~k,j!==0?v=vt(j):T!==0&&(v=vt(T));if(v===0)return 0;if(o!==0&&o!==v&&(o&k)===0&&(k=v&-v,T=o&-o,k>=T||k===16&&(T&4194240)!==0))return o;if((v&4)!==0&&(v|=f&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=v;0<o;)f=31-it(o),k=1<<f,v|=i[f],o&=~k;return v}function Il(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _o(i,o){for(var f=i.suspendedLanes,v=i.pingedLanes,k=i.expirationTimes,T=i.pendingLanes;0<T;){var j=31-it(T),oe=1<<j,he=k[j];he===-1?((oe&f)===0||(oe&v)!==0)&&(k[j]=Il(oe,o)):he<=o&&(i.expiredLanes|=oe),T&=~oe}}function en(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function iu(){var i=va;return va<<=1,(va&4194240)===0&&(va=64),i}function Fi(i){for(var o=[],f=0;31>f;f++)o.push(i);return o}function Mn(i,o,f){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-it(o),i[o]=f}function dr(i,o){var f=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var v=i.eventTimes;for(i=i.expirationTimes;0<f;){var k=31-it(f),T=1<<k;o[k]=0,v[k]=-1,i[k]=-1,f&=~T}}function xa(i,o){var f=i.entangledLanes|=o;for(i=i.entanglements;f;){var v=31-it(f),k=1<<v;k&o|i[v]&o&&(i[v]|=o),f&=~k}}var Nt=0;function Li(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var wo,ii,ko,bo,As,Ps=!1,Ri=[],Bn=null,ya=null,Xn=null,Ns=new Map,dt=new Map,Er=[],Wt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fl(i,o){switch(i){case"focusin":case"focusout":Bn=null;break;case"dragenter":case"dragleave":ya=null;break;case"mouseover":case"mouseout":Xn=null;break;case"pointerover":case"pointerout":Ns.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(o.pointerId)}}function si(i,o,f,v,k,T){return i===null||i.nativeEvent!==T?(i={blockedOn:o,domEventName:f,eventSystemFlags:v,nativeEvent:T,targetContainers:[k]},o!==null&&(o=pi(o),o!==null&&ii(o)),i):(i.eventSystemFlags|=v,o=i.targetContainers,k!==null&&o.indexOf(k)===-1&&o.push(k),i)}function Ll(i,o,f,v,k){switch(o){case"focusin":return Bn=si(Bn,i,o,f,v,k),!0;case"dragenter":return ya=si(ya,i,o,f,v,k),!0;case"mouseover":return Xn=si(Xn,i,o,f,v,k),!0;case"pointerover":var T=k.pointerId;return Ns.set(T,si(Ns.get(T)||null,i,o,f,v,k)),!0;case"gotpointercapture":return T=k.pointerId,dt.set(T,si(dt.get(T)||null,i,o,f,v,k)),!0}return!1}function So(i){var o=mi(i.target);if(o!==null){var f=ae(o);if(f!==null){if(o=f.tag,o===13){if(o=we(f),o!==null){i.blockedOn=o,As(i.priority,function(){ko(f)});return}}else if(o===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Jn(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var f=Co(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(f===null){f=i.nativeEvent;var v=new f.constructor(f.type,f);ai=v,f.target.dispatchEvent(v),ai=null}else return o=pi(f),o!==null&&ii(o),i.blockedOn=f,!1;o.shift()}return!0}function To(i,o,f){Jn(i)&&f.delete(o)}function Ds(){Ps=!1,Bn!==null&&Jn(Bn)&&(Bn=null),ya!==null&&Jn(ya)&&(ya=null),Xn!==null&&Jn(Xn)&&(Xn=null),Ns.forEach(To),dt.forEach(To)}function lr(i,o){i.blockedOn===o&&(i.blockedOn=null,Ps||(Ps=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,Ds)))}function zn(i){function o(k){return lr(k,i)}if(0<Ri.length){lr(Ri[0],i);for(var f=1;f<Ri.length;f++){var v=Ri[f];v.blockedOn===i&&(v.blockedOn=null)}}for(Bn!==null&&lr(Bn,i),ya!==null&&lr(ya,i),Xn!==null&&lr(Xn,i),Ns.forEach(o),dt.forEach(o),f=0;f<Er.length;f++)v=Er[f],v.blockedOn===i&&(v.blockedOn=null);for(;0<Er.length&&(f=Er[0],f.blockedOn===null);)So(f),f.blockedOn===null&&Er.shift()}var oi=M.ReactCurrentBatchConfig,Os=!0;function hf(i,o,f,v){var k=Nt,T=oi.transition;oi.transition=null;try{Nt=1,Is(i,o,f,v)}finally{Nt=k,oi.transition=T}}function su(i,o,f,v){var k=Nt,T=oi.transition;oi.transition=null;try{Nt=4,Is(i,o,f,v)}finally{Nt=k,oi.transition=T}}function Is(i,o,f,v){if(Os){var k=Co(i,o,f,v);if(k===null)s(i,o,v,Eo,f),Fl(i,v);else if(Ll(k,i,o,f,v))v.stopPropagation();else if(Fl(i,v),o&4&&-1<Wt.indexOf(i)){for(;k!==null;){var T=pi(k);if(T!==null&&wo(T),T=Co(i,o,f,v),T===null&&s(i,o,v,Eo,f),T===k)break;k=T}k!==null&&v.stopPropagation()}else s(i,o,v,null,f)}}var Eo=null;function Co(i,o,f,v){if(Eo=null,i=ma(v),i=mi(i),i!==null)if(o=ae(i),o===null)i=null;else if(f=o.tag,f===13){if(i=we(o),i!==null)return i;i=null}else if(f===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Eo=i,null}function Ct(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(mt()){case zt:return 1;case $t:return 4;case or:case pa:return 16;case En:return 536870912;default:return 16}default:return 16}}var ja=null,pn=null,Ma=null;function Rl(){if(Ma)return Ma;var i,o=pn,f=o.length,v,k="value"in ja?ja.value:ja.textContent,T=k.length;for(i=0;i<f&&o[i]===k[i];i++);var j=f-i;for(v=1;v<=j&&o[f-v]===k[T-v];v++);return Ma=k.slice(i,1<v?1-v:void 0)}function Ao(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function ji(){return!0}function ou(){return!1}function tn(i){function o(f,v,k,T,j){this._reactName=f,this._targetInst=k,this.type=v,this.nativeEvent=T,this.target=j,this.currentTarget=null;for(var oe in i)i.hasOwnProperty(oe)&&(f=i[oe],this[oe]=f?f(T):T[oe]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?ji:ou,this.isPropagationStopped=ou,this}return fe(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=ji)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=ji)},persist:function(){},isPersistent:ji}),o}var Mi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jl=tn(Mi),li=fe({},Mi,{view:0,detail:0}),mf=tn(li),Cn,Ml,Bi,Un=fe({},li,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ui,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Bi&&(Bi&&i.type==="mousemove"?(Cn=i.screenX-Bi.screenX,Ml=i.screenY-Bi.screenY):Ml=Cn=0,Bi=i),Cn)},movementY:function(i){return"movementY"in i?i.movementY:Ml}}),Bl=tn(Un),lu=fe({},Un,{dataTransfer:0}),zl=tn(lu),pf=fe({},li,{relatedTarget:0}),Po=tn(pf),cu=fe({},Mi,{animationName:0,elapsedTime:0,pseudoElement:0}),gf=tn(cu),vf=fe({},Mi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ul=tn(vf),xf=fe({},Mi,{data:0}),$l=tn(xf),uu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},No={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ci={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yf(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=ci[i])?!!o[i]:!1}function ui(){return yf}var An=fe({},li,{key:function(i){if(i.key){var o=uu[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Ao(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?No[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ui,charCode:function(i){return i.type==="keypress"?Ao(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ao(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),du=tn(An),fu=fe({},Un,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),hu=tn(fu),Wl=fe({},li,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ui}),Hl=tn(Wl),_f=fe({},Mi,{propertyName:0,elapsedTime:0,pseudoElement:0}),wf=tn(_f),mu=fe({},Un,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),kf=tn(mu),$n=[9,13,27,32],Ba=d&&"CompositionEvent"in window,Fs=null;d&&"documentMode"in document&&(Fs=document.documentMode);var _a=d&&"TextEvent"in window&&!Fs,pu=d&&(!Ba||Fs&&8<Fs&&11>=Fs),di=" ",gu=!1;function zi(i,o){switch(i){case"keyup":return $n.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vl(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var wa=!1;function bf(i,o){switch(i){case"compositionend":return Vl(o);case"keypress":return o.which!==32?null:(gu=!0,di);case"textInput":return i=o.data,i===di&&gu?null:i;default:return null}}function za(i,o){if(wa)return i==="compositionend"||!Ba&&zi(i,o)?(i=Rl(),Ma=pn=ja=null,wa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return pu&&o.locale!=="ko"?null:o.data;default:return null}}var Do={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vu(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!Do[i.type]:o==="textarea"}function Oo(i,o,f,v){Qe(v),o=p(o,"onChange"),0<o.length&&(f=new jl("onChange","change",null,f,v),i.push({event:f,listeners:o}))}var Ls=null,gn=null;function Sf(i){ec(i,0)}function ka(i){var o=gi(i);if(te(o))return i}function Tf(i,o){if(i==="change")return o}var Qn=!1;if(d){var Ui;if(d){var Io="oninput"in document;if(!Io){var Fo=document.createElement("div");Fo.setAttribute("oninput","return;"),Io=typeof Fo.oninput=="function"}Ui=Io}else Ui=!1;Qn=Ui&&(!document.documentMode||9<document.documentMode)}function Rs(){Ls&&(Ls.detachEvent("onpropertychange",Lo),gn=Ls=null)}function Lo(i){if(i.propertyName==="value"&&ka(gn)){var o=[];Oo(o,gn,i,ma(i)),sr(Sf,o)}}function Ro(i,o,f){i==="focusin"?(Rs(),Ls=o,gn=f,Ls.attachEvent("onpropertychange",Lo)):i==="focusout"&&Rs()}function $i(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ka(gn)}function jo(i,o){if(i==="click")return ka(o)}function Gl(i,o){if(i==="input"||i==="change")return ka(o)}function xu(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Wn=typeof Object.is=="function"?Object.is:xu;function Ua(i,o){if(Wn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var f=Object.keys(i),v=Object.keys(o);if(f.length!==v.length)return!1;for(v=0;v<f.length;v++){var k=f[v];if(!m.call(o,k)||!Wn(i[k],o[k]))return!1}return!0}function yu(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Zl(i,o){var f=yu(i);i=0;for(var v;f;){if(f.nodeType===3){if(v=i+f.textContent.length,i<=o&&v>=o)return{node:f,offset:o-i};i=v}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=yu(f)}}function _u(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?_u(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Kl(){for(var i=window,o=Tt();o instanceof i.HTMLIFrameElement;){try{var f=typeof o.contentWindow.location.href=="string"}catch{f=!1}if(f)i=o.contentWindow;else break;o=Tt(i.document)}return o}function ql(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function ea(i){var o=Kl(),f=i.focusedElem,v=i.selectionRange;if(o!==f&&f&&f.ownerDocument&&_u(f.ownerDocument.documentElement,f)){if(v!==null&&ql(f)){if(o=v.start,i=v.end,i===void 0&&(i=o),"selectionStart"in f)f.selectionStart=o,f.selectionEnd=Math.min(i,f.value.length);else if(i=(o=f.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var k=f.textContent.length,T=Math.min(v.start,k);v=v.end===void 0?T:Math.min(v.end,k),!i.extend&&T>v&&(k=v,v=T,T=k),k=Zl(f,T);var j=Zl(f,v);k&&j&&(i.rangeCount!==1||i.anchorNode!==k.node||i.anchorOffset!==k.offset||i.focusNode!==j.node||i.focusOffset!==j.offset)&&(o=o.createRange(),o.setStart(k.node,k.offset),i.removeAllRanges(),T>v?(i.addRange(o),i.extend(j.node,j.offset)):(o.setEnd(j.node,j.offset),i.addRange(o)))}}for(o=[],i=f;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<o.length;f++)i=o[f],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Mo=d&&"documentMode"in document&&11>=document.documentMode,Wi=null,Hi=null,js=null,Bo=!1;function wu(i,o,f){var v=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;Bo||Wi==null||Wi!==Tt(v)||(v=Wi,"selectionStart"in v&&ql(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),js&&Ua(js,v)||(js=v,v=p(Hi,"onSelect"),0<v.length&&(o=new jl("onSelect","select",null,o,f),i.push({event:o,listeners:v}),o.target=Wi)))}function $a(i,o){var f={};return f[i.toLowerCase()]=o.toLowerCase(),f["Webkit"+i]="webkit"+o,f["Moz"+i]="moz"+o,f}var Vi={animationend:$a("Animation","AnimationEnd"),animationiteration:$a("Animation","AnimationIteration"),animationstart:$a("Animation","AnimationStart"),transitionend:$a("Transition","TransitionEnd")},Wa={},Yl={};d&&(Yl=document.createElement("div").style,"AnimationEvent"in window||(delete Vi.animationend.animation,delete Vi.animationiteration.animation,delete Vi.animationstart.animation),"TransitionEvent"in window||delete Vi.transitionend.transition);function Ms(i){if(Wa[i])return Wa[i];if(!Vi[i])return i;var o=Vi[i],f;for(f in o)if(o.hasOwnProperty(f)&&f in Yl)return Wa[i]=o[f];return i}var ku=Ms("animationend"),ta=Ms("animationiteration"),Xl=Ms("animationstart"),Jl=Ms("transitionend"),Gi=new Map,bu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Hn(i,o){Gi.set(i,o),l(o,[i])}for(var fi=0;fi<bu.length;fi++){var zo=bu[fi],Su=zo.toLowerCase(),Ef=zo[0].toUpperCase()+zo.slice(1);Hn(Su,"on"+Ef)}Hn(ku,"onAnimationEnd"),Hn(ta,"onAnimationIteration"),Hn(Xl,"onAnimationStart"),Hn("dblclick","onDoubleClick"),Hn("focusin","onFocus"),Hn("focusout","onBlur"),Hn(Jl,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tu=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zi));function Ql(i,o,f){var v=i.type||"unknown-event";i.currentTarget=f,ne(v,o,void 0,i),i.currentTarget=null}function ec(i,o){o=(o&4)!==0;for(var f=0;f<i.length;f++){var v=i[f],k=v.event;v=v.listeners;e:{var T=void 0;if(o)for(var j=v.length-1;0<=j;j--){var oe=v[j],he=oe.instance,Pe=oe.currentTarget;if(oe=oe.listener,he!==T&&k.isPropagationStopped())break e;Ql(k,oe,Pe),T=he}else for(j=0;j<v.length;j++){if(oe=v[j],he=oe.instance,Pe=oe.currentTarget,oe=oe.listener,he!==T&&k.isPropagationStopped())break e;Ql(k,oe,Pe),T=he}}}if(B)throw i=re,B=!1,re=null,i}function Ht(i,o){var f=o[Xi];f===void 0&&(f=o[Xi]=new Set);var v=i+"__bubble";f.has(v)||(Eu(o,i,2,!1),f.add(v))}function tc(i,o,f){var v=0;o&&(v|=4),Eu(f,i,v,o)}var Bs="_reactListening"+Math.random().toString(36).slice(2);function Ki(i){if(!i[Bs]){i[Bs]=!0,n.forEach(function(f){f!=="selectionchange"&&(Tu.has(f)||tc(f,!1,i),tc(f,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Bs]||(o[Bs]=!0,tc("selectionchange",!1,o))}}function Eu(i,o,f,v){switch(Ct(o)){case 1:var k=hf;break;case 4:k=su;break;default:k=Is}f=k.bind(null,o,f,i),k=void 0,!Qt||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(k=!0),v?k!==void 0?i.addEventListener(o,f,{capture:!0,passive:k}):i.addEventListener(o,f,!0):k!==void 0?i.addEventListener(o,f,{passive:k}):i.addEventListener(o,f,!1)}function s(i,o,f,v,k){var T=v;if((o&1)===0&&(o&2)===0&&v!==null)e:for(;;){if(v===null)return;var j=v.tag;if(j===3||j===4){var oe=v.stateNode.containerInfo;if(oe===k||oe.nodeType===8&&oe.parentNode===k)break;if(j===4)for(j=v.return;j!==null;){var he=j.tag;if((he===3||he===4)&&(he=j.stateNode.containerInfo,he===k||he.nodeType===8&&he.parentNode===k))return;j=j.return}for(;oe!==null;){if(j=mi(oe),j===null)return;if(he=j.tag,he===5||he===6){v=T=j;continue e}oe=oe.parentNode}}v=v.return}sr(function(){var Pe=T,Le=ma(f),je=[];e:{var Fe=Gi.get(i);if(Fe!==void 0){var qe=jl,Je=i;switch(i){case"keypress":if(Ao(f)===0)break e;case"keydown":case"keyup":qe=du;break;case"focusin":Je="focus",qe=Po;break;case"focusout":Je="blur",qe=Po;break;case"beforeblur":case"afterblur":qe=Po;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=Bl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=zl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=Hl;break;case ku:case ta:case Xl:qe=gf;break;case Jl:qe=wf;break;case"scroll":qe=mf;break;case"wheel":qe=kf;break;case"copy":case"cut":case"paste":qe=Ul;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=hu}var tt=(o&4)!==0,xr=!tt&&i==="scroll",_e=tt?Fe!==null?Fe+"Capture":null:Fe;tt=[];for(var pe=Pe,Se;pe!==null;){Se=pe;var ze=Se.stateNode;if(Se.tag===5&&ze!==null&&(Se=ze,_e!==null&&(ze=gr(pe,_e),ze!=null&&tt.push(u(pe,ze,Se)))),xr)break;pe=pe.return}0<tt.length&&(Fe=new qe(Fe,Je,null,f,Le),je.push({event:Fe,listeners:tt}))}}if((o&7)===0){e:{if(Fe=i==="mouseover"||i==="pointerover",qe=i==="mouseout"||i==="pointerout",Fe&&f!==ai&&(Je=f.relatedTarget||f.fromElement)&&(mi(Je)||Je[Bt]))break e;if((qe||Fe)&&(Fe=Le.window===Le?Le:(Fe=Le.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,qe?(Je=f.relatedTarget||f.toElement,qe=Pe,Je=Je?mi(Je):null,Je!==null&&(xr=ae(Je),Je!==xr||Je.tag!==5&&Je.tag!==6)&&(Je=null)):(qe=null,Je=Pe),qe!==Je)){if(tt=Bl,ze="onMouseLeave",_e="onMouseEnter",pe="mouse",(i==="pointerout"||i==="pointerover")&&(tt=hu,ze="onPointerLeave",_e="onPointerEnter",pe="pointer"),xr=qe==null?Fe:gi(qe),Se=Je==null?Fe:gi(Je),Fe=new tt(ze,pe+"leave",qe,f,Le),Fe.target=xr,Fe.relatedTarget=Se,ze=null,mi(Le)===Pe&&(tt=new tt(_e,pe+"enter",Je,f,Le),tt.target=Se,tt.relatedTarget=xr,ze=tt),xr=ze,qe&&Je)t:{for(tt=qe,_e=Je,pe=0,Se=tt;Se;Se=w(Se))pe++;for(Se=0,ze=_e;ze;ze=w(ze))Se++;for(;0<pe-Se;)tt=w(tt),pe--;for(;0<Se-pe;)_e=w(_e),Se--;for(;pe--;){if(tt===_e||_e!==null&&tt===_e.alternate)break t;tt=w(tt),_e=w(_e)}tt=null}else tt=null;qe!==null&&A(je,Fe,qe,tt,!1),Je!==null&&xr!==null&&A(je,xr,Je,tt,!0)}}e:{if(Fe=Pe?gi(Pe):window,qe=Fe.nodeName&&Fe.nodeName.toLowerCase(),qe==="select"||qe==="input"&&Fe.type==="file")var rt=Tf;else if(vu(Fe))if(Qn)rt=Gl;else{rt=$i;var ot=Ro}else(qe=Fe.nodeName)&&qe.toLowerCase()==="input"&&(Fe.type==="checkbox"||Fe.type==="radio")&&(rt=jo);if(rt&&(rt=rt(i,Pe))){Oo(je,rt,f,Le);break e}ot&&ot(i,Fe,Pe),i==="focusout"&&(ot=Fe._wrapperState)&&ot.controlled&&Fe.type==="number"&&rr(Fe,"number",Fe.value)}switch(ot=Pe?gi(Pe):window,i){case"focusin":(vu(ot)||ot.contentEditable==="true")&&(Wi=ot,Hi=Pe,js=null);break;case"focusout":js=Hi=Wi=null;break;case"mousedown":Bo=!0;break;case"contextmenu":case"mouseup":case"dragend":Bo=!1,wu(je,f,Le);break;case"selectionchange":if(Mo)break;case"keydown":case"keyup":wu(je,f,Le)}var lt;if(Ba)e:{switch(i){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else wa?zi(i,f)&&(pt="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(pt="onCompositionStart");pt&&(pu&&f.locale!=="ko"&&(wa||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&wa&&(lt=Rl()):(ja=Le,pn="value"in ja?ja.value:ja.textContent,wa=!0)),ot=p(Pe,pt),0<ot.length&&(pt=new $l(pt,i,null,f,Le),je.push({event:pt,listeners:ot}),lt?pt.data=lt:(lt=Vl(f),lt!==null&&(pt.data=lt)))),(lt=_a?bf(i,f):za(i,f))&&(Pe=p(Pe,"onBeforeInput"),0<Pe.length&&(Le=new $l("onBeforeInput","beforeinput",null,f,Le),je.push({event:Le,listeners:Pe}),Le.data=lt))}ec(je,o)})}function u(i,o,f){return{instance:i,listener:o,currentTarget:f}}function p(i,o){for(var f=o+"Capture",v=[];i!==null;){var k=i,T=k.stateNode;k.tag===5&&T!==null&&(k=T,T=gr(i,f),T!=null&&v.unshift(u(i,T,k)),T=gr(i,o),T!=null&&v.push(u(i,T,k))),i=i.return}return v}function w(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function A(i,o,f,v,k){for(var T=o._reactName,j=[];f!==null&&f!==v;){var oe=f,he=oe.alternate,Pe=oe.stateNode;if(he!==null&&he===v)break;oe.tag===5&&Pe!==null&&(oe=Pe,k?(he=gr(f,T),he!=null&&j.unshift(u(f,he,oe))):k||(he=gr(f,T),he!=null&&j.push(u(f,he,oe)))),f=f.return}j.length!==0&&i.push({event:o,listeners:j})}var z=/\r\n?/g,de=/\u0000|\uFFFD/g;function ye(i){return(typeof i=="string"?i:""+i).replace(z,`
`).replace(de,"")}function Ae(i,o,f){if(o=ye(o),ye(i)!==o&&f)throw Error(t(425))}function Oe(){}var He=null,st=null;function _t(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Cr=typeof setTimeout=="function"?setTimeout:void 0,_r=typeof clearTimeout=="function"?clearTimeout:void 0,vn=typeof Promise=="function"?Promise:void 0,rn=typeof queueMicrotask=="function"?queueMicrotask:typeof vn<"u"?function(i){return vn.resolve(null).then(i).catch(qi)}:Cr;function qi(i){setTimeout(function(){throw i})}function rc(i,o){var f=o,v=0;do{var k=f.nextSibling;if(i.removeChild(f),k&&k.nodeType===8)if(f=k.data,f==="/$"){if(v===0){i.removeChild(k),zn(o);return}v--}else f!=="$"&&f!=="$?"&&f!=="$!"||v++;f=k}while(f);zn(o)}function Ha(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Cu(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"){if(o===0)return i;o--}else f==="/$"&&o++}i=i.previousSibling}return null}var hi=Math.random().toString(36).slice(2),ra="__reactFiber$"+hi,Yi="__reactProps$"+hi,Bt="__reactContainer$"+hi,Xi="__reactEvents$"+hi,Cf="__reactListeners$"+hi,Af="__reactHandles$"+hi;function mi(i){var o=i[ra];if(o)return o;for(var f=i.parentNode;f;){if(o=f[Bt]||f[ra]){if(f=o.alternate,o.child!==null||f!==null&&f.child!==null)for(i=Cu(i);i!==null;){if(f=i[ra])return f;i=Cu(i)}return o}i=f,f=i.parentNode}return null}function pi(i){return i=i[ra]||i[Bt],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function gi(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Uo(i){return i[Yi]||null}var Pf=[],$o=-1;function Ji(i){return{current:i}}function tr(i){0>$o||(i.current=Pf[$o],Pf[$o]=null,$o--)}function qt(i,o){$o++,Pf[$o]=i.current,i.current=o}var Qi={},nn=Ji(Qi),Pn=Ji(!1),zs=Qi;function Wo(i,o){var f=i.type.contextTypes;if(!f)return Qi;var v=i.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===o)return v.__reactInternalMemoizedMaskedChildContext;var k={},T;for(T in f)k[T]=o[T];return v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=k),k}function Nn(i){return i=i.childContextTypes,i!=null}function Au(){tr(Pn),tr(nn)}function _m(i,o,f){if(nn.current!==Qi)throw Error(t(168));qt(nn,o),qt(Pn,f)}function wm(i,o,f){var v=i.stateNode;if(o=o.childContextTypes,typeof v.getChildContext!="function")return f;v=v.getChildContext();for(var k in v)if(!(k in o))throw Error(t(108,ge(i)||"Unknown",k));return fe({},f,v)}function Pu(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Qi,zs=nn.current,qt(nn,i),qt(Pn,Pn.current),!0}function km(i,o,f){var v=i.stateNode;if(!v)throw Error(t(169));f?(i=wm(i,o,zs),v.__reactInternalMemoizedMergedChildContext=i,tr(Pn),tr(nn),qt(nn,i)):tr(Pn),qt(Pn,f)}var vi=null,Nu=!1,Nf=!1;function bm(i){vi===null?vi=[i]:vi.push(i)}function My(i){Nu=!0,bm(i)}function es(){if(!Nf&&vi!==null){Nf=!0;var i=0,o=Nt;try{var f=vi;for(Nt=1;i<f.length;i++){var v=f[i];do v=v(!0);while(v!==null)}vi=null,Nu=!1}catch(k){throw vi!==null&&(vi=vi.slice(i+1)),Re(zt,es),k}finally{Nt=o,Nf=!1}}return null}var Ho=[],Vo=0,Du=null,Ou=0,na=[],aa=0,Us=null,xi=1,yi="";function $s(i,o){Ho[Vo++]=Ou,Ho[Vo++]=Du,Du=i,Ou=o}function Sm(i,o,f){na[aa++]=xi,na[aa++]=yi,na[aa++]=Us,Us=i;var v=xi;i=yi;var k=32-it(v)-1;v&=~(1<<k),f+=1;var T=32-it(o)+k;if(30<T){var j=k-k%5;T=(v&(1<<j)-1).toString(32),v>>=j,k-=j,xi=1<<32-it(o)+k|f<<k|v,yi=T+i}else xi=1<<T|f<<k|v,yi=i}function Df(i){i.return!==null&&($s(i,1),Sm(i,1,0))}function Of(i){for(;i===Du;)Du=Ho[--Vo],Ho[Vo]=null,Ou=Ho[--Vo],Ho[Vo]=null;for(;i===Us;)Us=na[--aa],na[aa]=null,yi=na[--aa],na[aa]=null,xi=na[--aa],na[aa]=null}var Vn=null,Gn=null,nr=!1,ba=null;function Tm(i,o){var f=la(5,null,null,0);f.elementType="DELETED",f.stateNode=o,f.return=i,o=i.deletions,o===null?(i.deletions=[f],i.flags|=16):o.push(f)}function Em(i,o){switch(i.tag){case 5:var f=i.type;return o=o.nodeType!==1||f.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Vn=i,Gn=Ha(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Vn=i,Gn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(f=Us!==null?{id:xi,overflow:yi}:null,i.memoizedState={dehydrated:o,treeContext:f,retryLane:1073741824},f=la(18,null,null,0),f.stateNode=o,f.return=i,i.child=f,Vn=i,Gn=null,!0):!1;default:return!1}}function If(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Ff(i){if(nr){var o=Gn;if(o){var f=o;if(!Em(i,o)){if(If(i))throw Error(t(418));o=Ha(f.nextSibling);var v=Vn;o&&Em(i,o)?Tm(v,f):(i.flags=i.flags&-4097|2,nr=!1,Vn=i)}}else{if(If(i))throw Error(t(418));i.flags=i.flags&-4097|2,nr=!1,Vn=i}}}function Cm(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Vn=i}function Iu(i){if(i!==Vn)return!1;if(!nr)return Cm(i),nr=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!_t(i.type,i.memoizedProps)),o&&(o=Gn)){if(If(i))throw Am(),Error(t(418));for(;o;)Tm(i,o),o=Ha(o.nextSibling)}if(Cm(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"){if(o===0){Gn=Ha(i.nextSibling);break e}o--}else f!=="$"&&f!=="$!"&&f!=="$?"||o++}i=i.nextSibling}Gn=null}}else Gn=Vn?Ha(i.stateNode.nextSibling):null;return!0}function Am(){for(var i=Gn;i;)i=Ha(i.nextSibling)}function Go(){Gn=Vn=null,nr=!1}function Lf(i){ba===null?ba=[i]:ba.push(i)}var By=M.ReactCurrentBatchConfig;function nc(i,o,f){if(i=f.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(t(309));var v=f.stateNode}if(!v)throw Error(t(147,i));var k=v,T=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===T?o.ref:(o=function(j){var oe=k.refs;j===null?delete oe[T]:oe[T]=j},o._stringRef=T,o)}if(typeof i!="string")throw Error(t(284));if(!f._owner)throw Error(t(290,i))}return i}function Fu(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Pm(i){var o=i._init;return o(i._payload)}function Nm(i){function o(_e,pe){if(i){var Se=_e.deletions;Se===null?(_e.deletions=[pe],_e.flags|=16):Se.push(pe)}}function f(_e,pe){if(!i)return null;for(;pe!==null;)o(_e,pe),pe=pe.sibling;return null}function v(_e,pe){for(_e=new Map;pe!==null;)pe.key!==null?_e.set(pe.key,pe):_e.set(pe.index,pe),pe=pe.sibling;return _e}function k(_e,pe){return _e=ls(_e,pe),_e.index=0,_e.sibling=null,_e}function T(_e,pe,Se){return _e.index=Se,i?(Se=_e.alternate,Se!==null?(Se=Se.index,Se<pe?(_e.flags|=2,pe):Se):(_e.flags|=2,pe)):(_e.flags|=1048576,pe)}function j(_e){return i&&_e.alternate===null&&(_e.flags|=2),_e}function oe(_e,pe,Se,ze){return pe===null||pe.tag!==6?(pe=Eh(Se,_e.mode,ze),pe.return=_e,pe):(pe=k(pe,Se),pe.return=_e,pe)}function he(_e,pe,Se,ze){var rt=Se.type;return rt===N?Le(_e,pe,Se.props.children,ze,Se.key):pe!==null&&(pe.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===ce&&Pm(rt)===pe.type)?(ze=k(pe,Se.props),ze.ref=nc(_e,pe,Se),ze.return=_e,ze):(ze=ad(Se.type,Se.key,Se.props,null,_e.mode,ze),ze.ref=nc(_e,pe,Se),ze.return=_e,ze)}function Pe(_e,pe,Se,ze){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==Se.containerInfo||pe.stateNode.implementation!==Se.implementation?(pe=Ch(Se,_e.mode,ze),pe.return=_e,pe):(pe=k(pe,Se.children||[]),pe.return=_e,pe)}function Le(_e,pe,Se,ze,rt){return pe===null||pe.tag!==7?(pe=Ys(Se,_e.mode,ze,rt),pe.return=_e,pe):(pe=k(pe,Se),pe.return=_e,pe)}function je(_e,pe,Se){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return pe=Eh(""+pe,_e.mode,Se),pe.return=_e,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case G:return Se=ad(pe.type,pe.key,pe.props,null,_e.mode,Se),Se.ref=nc(_e,null,pe),Se.return=_e,Se;case I:return pe=Ch(pe,_e.mode,Se),pe.return=_e,pe;case ce:var ze=pe._init;return je(_e,ze(pe._payload),Se)}if(Mt(pe)||Q(pe))return pe=Ys(pe,_e.mode,Se,null),pe.return=_e,pe;Fu(_e,pe)}return null}function Fe(_e,pe,Se,ze){var rt=pe!==null?pe.key:null;if(typeof Se=="string"&&Se!==""||typeof Se=="number")return rt!==null?null:oe(_e,pe,""+Se,ze);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case G:return Se.key===rt?he(_e,pe,Se,ze):null;case I:return Se.key===rt?Pe(_e,pe,Se,ze):null;case ce:return rt=Se._init,Fe(_e,pe,rt(Se._payload),ze)}if(Mt(Se)||Q(Se))return rt!==null?null:Le(_e,pe,Se,ze,null);Fu(_e,Se)}return null}function qe(_e,pe,Se,ze,rt){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return _e=_e.get(Se)||null,oe(pe,_e,""+ze,rt);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case G:return _e=_e.get(ze.key===null?Se:ze.key)||null,he(pe,_e,ze,rt);case I:return _e=_e.get(ze.key===null?Se:ze.key)||null,Pe(pe,_e,ze,rt);case ce:var ot=ze._init;return qe(_e,pe,Se,ot(ze._payload),rt)}if(Mt(ze)||Q(ze))return _e=_e.get(Se)||null,Le(pe,_e,ze,rt,null);Fu(pe,ze)}return null}function Je(_e,pe,Se,ze){for(var rt=null,ot=null,lt=pe,pt=pe=0,Ur=null;lt!==null&&pt<Se.length;pt++){lt.index>pt?(Ur=lt,lt=null):Ur=lt.sibling;var jt=Fe(_e,lt,Se[pt],ze);if(jt===null){lt===null&&(lt=Ur);break}i&&lt&&jt.alternate===null&&o(_e,lt),pe=T(jt,pe,pt),ot===null?rt=jt:ot.sibling=jt,ot=jt,lt=Ur}if(pt===Se.length)return f(_e,lt),nr&&$s(_e,pt),rt;if(lt===null){for(;pt<Se.length;pt++)lt=je(_e,Se[pt],ze),lt!==null&&(pe=T(lt,pe,pt),ot===null?rt=lt:ot.sibling=lt,ot=lt);return nr&&$s(_e,pt),rt}for(lt=v(_e,lt);pt<Se.length;pt++)Ur=qe(lt,_e,pt,Se[pt],ze),Ur!==null&&(i&&Ur.alternate!==null&&lt.delete(Ur.key===null?pt:Ur.key),pe=T(Ur,pe,pt),ot===null?rt=Ur:ot.sibling=Ur,ot=Ur);return i&&lt.forEach(function(cs){return o(_e,cs)}),nr&&$s(_e,pt),rt}function tt(_e,pe,Se,ze){var rt=Q(Se);if(typeof rt!="function")throw Error(t(150));if(Se=rt.call(Se),Se==null)throw Error(t(151));for(var ot=rt=null,lt=pe,pt=pe=0,Ur=null,jt=Se.next();lt!==null&&!jt.done;pt++,jt=Se.next()){lt.index>pt?(Ur=lt,lt=null):Ur=lt.sibling;var cs=Fe(_e,lt,jt.value,ze);if(cs===null){lt===null&&(lt=Ur);break}i&&lt&&cs.alternate===null&&o(_e,lt),pe=T(cs,pe,pt),ot===null?rt=cs:ot.sibling=cs,ot=cs,lt=Ur}if(jt.done)return f(_e,lt),nr&&$s(_e,pt),rt;if(lt===null){for(;!jt.done;pt++,jt=Se.next())jt=je(_e,jt.value,ze),jt!==null&&(pe=T(jt,pe,pt),ot===null?rt=jt:ot.sibling=jt,ot=jt);return nr&&$s(_e,pt),rt}for(lt=v(_e,lt);!jt.done;pt++,jt=Se.next())jt=qe(lt,_e,pt,jt.value,ze),jt!==null&&(i&&jt.alternate!==null&&lt.delete(jt.key===null?pt:jt.key),pe=T(jt,pe,pt),ot===null?rt=jt:ot.sibling=jt,ot=jt);return i&&lt.forEach(function(x_){return o(_e,x_)}),nr&&$s(_e,pt),rt}function xr(_e,pe,Se,ze){if(typeof Se=="object"&&Se!==null&&Se.type===N&&Se.key===null&&(Se=Se.props.children),typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case G:e:{for(var rt=Se.key,ot=pe;ot!==null;){if(ot.key===rt){if(rt=Se.type,rt===N){if(ot.tag===7){f(_e,ot.sibling),pe=k(ot,Se.props.children),pe.return=_e,_e=pe;break e}}else if(ot.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===ce&&Pm(rt)===ot.type){f(_e,ot.sibling),pe=k(ot,Se.props),pe.ref=nc(_e,ot,Se),pe.return=_e,_e=pe;break e}f(_e,ot);break}else o(_e,ot);ot=ot.sibling}Se.type===N?(pe=Ys(Se.props.children,_e.mode,ze,Se.key),pe.return=_e,_e=pe):(ze=ad(Se.type,Se.key,Se.props,null,_e.mode,ze),ze.ref=nc(_e,pe,Se),ze.return=_e,_e=ze)}return j(_e);case I:e:{for(ot=Se.key;pe!==null;){if(pe.key===ot)if(pe.tag===4&&pe.stateNode.containerInfo===Se.containerInfo&&pe.stateNode.implementation===Se.implementation){f(_e,pe.sibling),pe=k(pe,Se.children||[]),pe.return=_e,_e=pe;break e}else{f(_e,pe);break}else o(_e,pe);pe=pe.sibling}pe=Ch(Se,_e.mode,ze),pe.return=_e,_e=pe}return j(_e);case ce:return ot=Se._init,xr(_e,pe,ot(Se._payload),ze)}if(Mt(Se))return Je(_e,pe,Se,ze);if(Q(Se))return tt(_e,pe,Se,ze);Fu(_e,Se)}return typeof Se=="string"&&Se!==""||typeof Se=="number"?(Se=""+Se,pe!==null&&pe.tag===6?(f(_e,pe.sibling),pe=k(pe,Se),pe.return=_e,_e=pe):(f(_e,pe),pe=Eh(Se,_e.mode,ze),pe.return=_e,_e=pe),j(_e)):f(_e,pe)}return xr}var Zo=Nm(!0),Dm=Nm(!1),Lu=Ji(null),Ru=null,Ko=null,Rf=null;function jf(){Rf=Ko=Ru=null}function Mf(i){var o=Lu.current;tr(Lu),i._currentValue=o}function Bf(i,o,f){for(;i!==null;){var v=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,v!==null&&(v.childLanes|=o)):v!==null&&(v.childLanes&o)!==o&&(v.childLanes|=o),i===f)break;i=i.return}}function qo(i,o){Ru=i,Rf=Ko=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(Dn=!0),i.firstContext=null)}function ia(i){var o=i._currentValue;if(Rf!==i)if(i={context:i,memoizedValue:o,next:null},Ko===null){if(Ru===null)throw Error(t(308));Ko=i,Ru.dependencies={lanes:0,firstContext:i}}else Ko=Ko.next=i;return o}var Ws=null;function zf(i){Ws===null?Ws=[i]:Ws.push(i)}function Om(i,o,f,v){var k=o.interleaved;return k===null?(f.next=f,zf(o)):(f.next=k.next,k.next=f),o.interleaved=f,_i(i,v)}function _i(i,o){i.lanes|=o;var f=i.alternate;for(f!==null&&(f.lanes|=o),f=i,i=i.return;i!==null;)i.childLanes|=o,f=i.alternate,f!==null&&(f.childLanes|=o),f=i,i=i.return;return f.tag===3?f.stateNode:null}var ts=!1;function Uf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Im(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function wi(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function rs(i,o,f){var v=i.updateQueue;if(v===null)return null;if(v=v.shared,(Ft&2)!==0){var k=v.pending;return k===null?o.next=o:(o.next=k.next,k.next=o),v.pending=o,_i(i,f)}return k=v.interleaved,k===null?(o.next=o,zf(v)):(o.next=k.next,k.next=o),v.interleaved=o,_i(i,f)}function ju(i,o,f){if(o=o.updateQueue,o!==null&&(o=o.shared,(f&4194240)!==0)){var v=o.lanes;v&=i.pendingLanes,f|=v,o.lanes=f,xa(i,f)}}function Fm(i,o){var f=i.updateQueue,v=i.alternate;if(v!==null&&(v=v.updateQueue,f===v)){var k=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var j={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};T===null?k=T=j:T=T.next=j,f=f.next}while(f!==null);T===null?k=T=o:T=T.next=o}else k=T=o;f={baseState:v.baseState,firstBaseUpdate:k,lastBaseUpdate:T,shared:v.shared,effects:v.effects},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=o:i.next=o,f.lastBaseUpdate=o}function Mu(i,o,f,v){var k=i.updateQueue;ts=!1;var T=k.firstBaseUpdate,j=k.lastBaseUpdate,oe=k.shared.pending;if(oe!==null){k.shared.pending=null;var he=oe,Pe=he.next;he.next=null,j===null?T=Pe:j.next=Pe,j=he;var Le=i.alternate;Le!==null&&(Le=Le.updateQueue,oe=Le.lastBaseUpdate,oe!==j&&(oe===null?Le.firstBaseUpdate=Pe:oe.next=Pe,Le.lastBaseUpdate=he))}if(T!==null){var je=k.baseState;j=0,Le=Pe=he=null,oe=T;do{var Fe=oe.lane,qe=oe.eventTime;if((v&Fe)===Fe){Le!==null&&(Le=Le.next={eventTime:qe,lane:0,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null});e:{var Je=i,tt=oe;switch(Fe=o,qe=f,tt.tag){case 1:if(Je=tt.payload,typeof Je=="function"){je=Je.call(qe,je,Fe);break e}je=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=tt.payload,Fe=typeof Je=="function"?Je.call(qe,je,Fe):Je,Fe==null)break e;je=fe({},je,Fe);break e;case 2:ts=!0}}oe.callback!==null&&oe.lane!==0&&(i.flags|=64,Fe=k.effects,Fe===null?k.effects=[oe]:Fe.push(oe))}else qe={eventTime:qe,lane:Fe,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null},Le===null?(Pe=Le=qe,he=je):Le=Le.next=qe,j|=Fe;if(oe=oe.next,oe===null){if(oe=k.shared.pending,oe===null)break;Fe=oe,oe=Fe.next,Fe.next=null,k.lastBaseUpdate=Fe,k.shared.pending=null}}while(!0);if(Le===null&&(he=je),k.baseState=he,k.firstBaseUpdate=Pe,k.lastBaseUpdate=Le,o=k.shared.interleaved,o!==null){k=o;do j|=k.lane,k=k.next;while(k!==o)}else T===null&&(k.shared.lanes=0);Gs|=j,i.lanes=j,i.memoizedState=je}}function Lm(i,o,f){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var v=i[o],k=v.callback;if(k!==null){if(v.callback=null,v=f,typeof k!="function")throw Error(t(191,k));k.call(v)}}}var ac={},Va=Ji(ac),ic=Ji(ac),sc=Ji(ac);function Hs(i){if(i===ac)throw Error(t(174));return i}function $f(i,o){switch(qt(sc,o),qt(ic,i),qt(Va,ac),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Vt(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Vt(o,i)}tr(Va),qt(Va,o)}function Yo(){tr(Va),tr(ic),tr(sc)}function Rm(i){Hs(sc.current);var o=Hs(Va.current),f=Vt(o,i.type);o!==f&&(qt(ic,i),qt(Va,f))}function Wf(i){ic.current===i&&(tr(Va),tr(ic))}var cr=Ji(0);function Bu(i){for(var o=i;o!==null;){if(o.tag===13){var f=o.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Hf=[];function Vf(){for(var i=0;i<Hf.length;i++)Hf[i]._workInProgressVersionPrimary=null;Hf.length=0}var zu=M.ReactCurrentDispatcher,Gf=M.ReactCurrentBatchConfig,Vs=0,ur=null,Ar=null,Br=null,Uu=!1,oc=!1,lc=0,zy=0;function an(){throw Error(t(321))}function Zf(i,o){if(o===null)return!1;for(var f=0;f<o.length&&f<i.length;f++)if(!Wn(i[f],o[f]))return!1;return!0}function Kf(i,o,f,v,k,T){if(Vs=T,ur=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,zu.current=i===null||i.memoizedState===null?Hy:Vy,i=f(v,k),oc){T=0;do{if(oc=!1,lc=0,25<=T)throw Error(t(301));T+=1,Br=Ar=null,o.updateQueue=null,zu.current=Gy,i=f(v,k)}while(oc)}if(zu.current=Hu,o=Ar!==null&&Ar.next!==null,Vs=0,Br=Ar=ur=null,Uu=!1,o)throw Error(t(300));return i}function qf(){var i=lc!==0;return lc=0,i}function Ga(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Br===null?ur.memoizedState=Br=i:Br=Br.next=i,Br}function sa(){if(Ar===null){var i=ur.alternate;i=i!==null?i.memoizedState:null}else i=Ar.next;var o=Br===null?ur.memoizedState:Br.next;if(o!==null)Br=o,Ar=i;else{if(i===null)throw Error(t(310));Ar=i,i={memoizedState:Ar.memoizedState,baseState:Ar.baseState,baseQueue:Ar.baseQueue,queue:Ar.queue,next:null},Br===null?ur.memoizedState=Br=i:Br=Br.next=i}return Br}function cc(i,o){return typeof o=="function"?o(i):o}function Yf(i){var o=sa(),f=o.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=i;var v=Ar,k=v.baseQueue,T=f.pending;if(T!==null){if(k!==null){var j=k.next;k.next=T.next,T.next=j}v.baseQueue=k=T,f.pending=null}if(k!==null){T=k.next,v=v.baseState;var oe=j=null,he=null,Pe=T;do{var Le=Pe.lane;if((Vs&Le)===Le)he!==null&&(he=he.next={lane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),v=Pe.hasEagerState?Pe.eagerState:i(v,Pe.action);else{var je={lane:Le,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null};he===null?(oe=he=je,j=v):he=he.next=je,ur.lanes|=Le,Gs|=Le}Pe=Pe.next}while(Pe!==null&&Pe!==T);he===null?j=v:he.next=oe,Wn(v,o.memoizedState)||(Dn=!0),o.memoizedState=v,o.baseState=j,o.baseQueue=he,f.lastRenderedState=v}if(i=f.interleaved,i!==null){k=i;do T=k.lane,ur.lanes|=T,Gs|=T,k=k.next;while(k!==i)}else k===null&&(f.lanes=0);return[o.memoizedState,f.dispatch]}function Xf(i){var o=sa(),f=o.queue;if(f===null)throw Error(t(311));f.lastRenderedReducer=i;var v=f.dispatch,k=f.pending,T=o.memoizedState;if(k!==null){f.pending=null;var j=k=k.next;do T=i(T,j.action),j=j.next;while(j!==k);Wn(T,o.memoizedState)||(Dn=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),f.lastRenderedState=T}return[T,v]}function jm(){}function Mm(i,o){var f=ur,v=sa(),k=o(),T=!Wn(v.memoizedState,k);if(T&&(v.memoizedState=k,Dn=!0),v=v.queue,Jf(Um.bind(null,f,v,i),[i]),v.getSnapshot!==o||T||Br!==null&&Br.memoizedState.tag&1){if(f.flags|=2048,uc(9,zm.bind(null,f,v,k,o),void 0,null),zr===null)throw Error(t(349));(Vs&30)!==0||Bm(f,o,k)}return k}function Bm(i,o,f){i.flags|=16384,i={getSnapshot:o,value:f},o=ur.updateQueue,o===null?(o={lastEffect:null,stores:null},ur.updateQueue=o,o.stores=[i]):(f=o.stores,f===null?o.stores=[i]:f.push(i))}function zm(i,o,f,v){o.value=f,o.getSnapshot=v,$m(o)&&Wm(i)}function Um(i,o,f){return f(function(){$m(o)&&Wm(i)})}function $m(i){var o=i.getSnapshot;i=i.value;try{var f=o();return!Wn(i,f)}catch{return!0}}function Wm(i){var o=_i(i,1);o!==null&&Ca(o,i,1,-1)}function Hm(i){var o=Ga();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cc,lastRenderedState:i},o.queue=i,i=i.dispatch=Wy.bind(null,ur,i),[o.memoizedState,i]}function uc(i,o,f,v){return i={tag:i,create:o,destroy:f,deps:v,next:null},o=ur.updateQueue,o===null?(o={lastEffect:null,stores:null},ur.updateQueue=o,o.lastEffect=i.next=i):(f=o.lastEffect,f===null?o.lastEffect=i.next=i:(v=f.next,f.next=i,i.next=v,o.lastEffect=i)),i}function Vm(){return sa().memoizedState}function $u(i,o,f,v){var k=Ga();ur.flags|=i,k.memoizedState=uc(1|o,f,void 0,v===void 0?null:v)}function Wu(i,o,f,v){var k=sa();v=v===void 0?null:v;var T=void 0;if(Ar!==null){var j=Ar.memoizedState;if(T=j.destroy,v!==null&&Zf(v,j.deps)){k.memoizedState=uc(o,f,T,v);return}}ur.flags|=i,k.memoizedState=uc(1|o,f,T,v)}function Gm(i,o){return $u(8390656,8,i,o)}function Jf(i,o){return Wu(2048,8,i,o)}function Zm(i,o){return Wu(4,2,i,o)}function Km(i,o){return Wu(4,4,i,o)}function qm(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Ym(i,o,f){return f=f!=null?f.concat([i]):null,Wu(4,4,qm.bind(null,o,i),f)}function Qf(){}function Xm(i,o){var f=sa();o=o===void 0?null:o;var v=f.memoizedState;return v!==null&&o!==null&&Zf(o,v[1])?v[0]:(f.memoizedState=[i,o],i)}function Jm(i,o){var f=sa();o=o===void 0?null:o;var v=f.memoizedState;return v!==null&&o!==null&&Zf(o,v[1])?v[0]:(i=i(),f.memoizedState=[i,o],i)}function Qm(i,o,f){return(Vs&21)===0?(i.baseState&&(i.baseState=!1,Dn=!0),i.memoizedState=f):(Wn(f,o)||(f=iu(),ur.lanes|=f,Gs|=f,i.baseState=!0),o)}function Uy(i,o){var f=Nt;Nt=f!==0&&4>f?f:4,i(!0);var v=Gf.transition;Gf.transition={};try{i(!1),o()}finally{Nt=f,Gf.transition=v}}function ep(){return sa().memoizedState}function $y(i,o,f){var v=ss(i);if(f={lane:v,action:f,hasEagerState:!1,eagerState:null,next:null},tp(i))rp(o,f);else if(f=Om(i,o,f,v),f!==null){var k=yn();Ca(f,i,v,k),np(f,o,v)}}function Wy(i,o,f){var v=ss(i),k={lane:v,action:f,hasEagerState:!1,eagerState:null,next:null};if(tp(i))rp(o,k);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=o.lastRenderedReducer,T!==null))try{var j=o.lastRenderedState,oe=T(j,f);if(k.hasEagerState=!0,k.eagerState=oe,Wn(oe,j)){var he=o.interleaved;he===null?(k.next=k,zf(o)):(k.next=he.next,he.next=k),o.interleaved=k;return}}catch{}finally{}f=Om(i,o,k,v),f!==null&&(k=yn(),Ca(f,i,v,k),np(f,o,v))}}function tp(i){var o=i.alternate;return i===ur||o!==null&&o===ur}function rp(i,o){oc=Uu=!0;var f=i.pending;f===null?o.next=o:(o.next=f.next,f.next=o),i.pending=o}function np(i,o,f){if((f&4194240)!==0){var v=o.lanes;v&=i.pendingLanes,f|=v,o.lanes=f,xa(i,f)}}var Hu={readContext:ia,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useInsertionEffect:an,useLayoutEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useMutableSource:an,useSyncExternalStore:an,useId:an,unstable_isNewReconciler:!1},Hy={readContext:ia,useCallback:function(i,o){return Ga().memoizedState=[i,o===void 0?null:o],i},useContext:ia,useEffect:Gm,useImperativeHandle:function(i,o,f){return f=f!=null?f.concat([i]):null,$u(4194308,4,qm.bind(null,o,i),f)},useLayoutEffect:function(i,o){return $u(4194308,4,i,o)},useInsertionEffect:function(i,o){return $u(4,2,i,o)},useMemo:function(i,o){var f=Ga();return o=o===void 0?null:o,i=i(),f.memoizedState=[i,o],i},useReducer:function(i,o,f){var v=Ga();return o=f!==void 0?f(o):o,v.memoizedState=v.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},v.queue=i,i=i.dispatch=$y.bind(null,ur,i),[v.memoizedState,i]},useRef:function(i){var o=Ga();return i={current:i},o.memoizedState=i},useState:Hm,useDebugValue:Qf,useDeferredValue:function(i){return Ga().memoizedState=i},useTransition:function(){var i=Hm(!1),o=i[0];return i=Uy.bind(null,i[1]),Ga().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,f){var v=ur,k=Ga();if(nr){if(f===void 0)throw Error(t(407));f=f()}else{if(f=o(),zr===null)throw Error(t(349));(Vs&30)!==0||Bm(v,o,f)}k.memoizedState=f;var T={value:f,getSnapshot:o};return k.queue=T,Gm(Um.bind(null,v,T,i),[i]),v.flags|=2048,uc(9,zm.bind(null,v,T,f,o),void 0,null),f},useId:function(){var i=Ga(),o=zr.identifierPrefix;if(nr){var f=yi,v=xi;f=(v&~(1<<32-it(v)-1)).toString(32)+f,o=":"+o+"R"+f,f=lc++,0<f&&(o+="H"+f.toString(32)),o+=":"}else f=zy++,o=":"+o+"r"+f.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},Vy={readContext:ia,useCallback:Xm,useContext:ia,useEffect:Jf,useImperativeHandle:Ym,useInsertionEffect:Zm,useLayoutEffect:Km,useMemo:Jm,useReducer:Yf,useRef:Vm,useState:function(){return Yf(cc)},useDebugValue:Qf,useDeferredValue:function(i){var o=sa();return Qm(o,Ar.memoizedState,i)},useTransition:function(){var i=Yf(cc)[0],o=sa().memoizedState;return[i,o]},useMutableSource:jm,useSyncExternalStore:Mm,useId:ep,unstable_isNewReconciler:!1},Gy={readContext:ia,useCallback:Xm,useContext:ia,useEffect:Jf,useImperativeHandle:Ym,useInsertionEffect:Zm,useLayoutEffect:Km,useMemo:Jm,useReducer:Xf,useRef:Vm,useState:function(){return Xf(cc)},useDebugValue:Qf,useDeferredValue:function(i){var o=sa();return Ar===null?o.memoizedState=i:Qm(o,Ar.memoizedState,i)},useTransition:function(){var i=Xf(cc)[0],o=sa().memoizedState;return[i,o]},useMutableSource:jm,useSyncExternalStore:Mm,useId:ep,unstable_isNewReconciler:!1};function Sa(i,o){if(i&&i.defaultProps){o=fe({},o),i=i.defaultProps;for(var f in i)o[f]===void 0&&(o[f]=i[f]);return o}return o}function eh(i,o,f,v){o=i.memoizedState,f=f(v,o),f=f==null?o:fe({},o,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Vu={isMounted:function(i){return(i=i._reactInternals)?ae(i)===i:!1},enqueueSetState:function(i,o,f){i=i._reactInternals;var v=yn(),k=ss(i),T=wi(v,k);T.payload=o,f!=null&&(T.callback=f),o=rs(i,T,k),o!==null&&(Ca(o,i,k,v),ju(o,i,k))},enqueueReplaceState:function(i,o,f){i=i._reactInternals;var v=yn(),k=ss(i),T=wi(v,k);T.tag=1,T.payload=o,f!=null&&(T.callback=f),o=rs(i,T,k),o!==null&&(Ca(o,i,k,v),ju(o,i,k))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var f=yn(),v=ss(i),k=wi(f,v);k.tag=2,o!=null&&(k.callback=o),o=rs(i,k,v),o!==null&&(Ca(o,i,v,f),ju(o,i,v))}};function ap(i,o,f,v,k,T,j){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(v,T,j):o.prototype&&o.prototype.isPureReactComponent?!Ua(f,v)||!Ua(k,T):!0}function ip(i,o,f){var v=!1,k=Qi,T=o.contextType;return typeof T=="object"&&T!==null?T=ia(T):(k=Nn(o)?zs:nn.current,v=o.contextTypes,T=(v=v!=null)?Wo(i,k):Qi),o=new o(f,T),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Vu,i.stateNode=o,o._reactInternals=i,v&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=k,i.__reactInternalMemoizedMaskedChildContext=T),o}function sp(i,o,f,v){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(f,v),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(f,v),o.state!==i&&Vu.enqueueReplaceState(o,o.state,null)}function th(i,o,f,v){var k=i.stateNode;k.props=f,k.state=i.memoizedState,k.refs={},Uf(i);var T=o.contextType;typeof T=="object"&&T!==null?k.context=ia(T):(T=Nn(o)?zs:nn.current,k.context=Wo(i,T)),k.state=i.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(eh(i,o,T,f),k.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(o=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),o!==k.state&&Vu.enqueueReplaceState(k,k.state,null),Mu(i,f,k,v),k.state=i.memoizedState),typeof k.componentDidMount=="function"&&(i.flags|=4194308)}function Xo(i,o){try{var f="",v=o;do f+=H(v),v=v.return;while(v);var k=f}catch(T){k=`
Error generating stack: `+T.message+`
`+T.stack}return{value:i,source:o,stack:k,digest:null}}function rh(i,o,f){return{value:i,source:null,stack:f??null,digest:o??null}}function nh(i,o){try{console.error(o.value)}catch(f){setTimeout(function(){throw f})}}var Zy=typeof WeakMap=="function"?WeakMap:Map;function op(i,o,f){f=wi(-1,f),f.tag=3,f.payload={element:null};var v=o.value;return f.callback=function(){Ju||(Ju=!0,xh=v),nh(i,o)},f}function lp(i,o,f){f=wi(-1,f),f.tag=3;var v=i.type.getDerivedStateFromError;if(typeof v=="function"){var k=o.value;f.payload=function(){return v(k)},f.callback=function(){nh(i,o)}}var T=i.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(f.callback=function(){nh(i,o),typeof v!="function"&&(as===null?as=new Set([this]):as.add(this));var j=o.stack;this.componentDidCatch(o.value,{componentStack:j!==null?j:""})}),f}function cp(i,o,f){var v=i.pingCache;if(v===null){v=i.pingCache=new Zy;var k=new Set;v.set(o,k)}else k=v.get(o),k===void 0&&(k=new Set,v.set(o,k));k.has(f)||(k.add(f),i=o_.bind(null,i,o,f),o.then(i,i))}function up(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function dp(i,o,f,v,k){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(o=wi(-1,1),o.tag=2,rs(f,o,1))),f.lanes|=1),i):(i.flags|=65536,i.lanes=k,i)}var Ky=M.ReactCurrentOwner,Dn=!1;function xn(i,o,f,v){o.child=i===null?Dm(o,null,f,v):Zo(o,i.child,f,v)}function fp(i,o,f,v,k){f=f.render;var T=o.ref;return qo(o,k),v=Kf(i,o,f,v,T,k),f=qf(),i!==null&&!Dn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~k,ki(i,o,k)):(nr&&f&&Df(o),o.flags|=1,xn(i,o,v,k),o.child)}function hp(i,o,f,v,k){if(i===null){var T=f.type;return typeof T=="function"&&!Th(T)&&T.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(o.tag=15,o.type=T,mp(i,o,T,v,k)):(i=ad(f.type,null,v,o,o.mode,k),i.ref=o.ref,i.return=o,o.child=i)}if(T=i.child,(i.lanes&k)===0){var j=T.memoizedProps;if(f=f.compare,f=f!==null?f:Ua,f(j,v)&&i.ref===o.ref)return ki(i,o,k)}return o.flags|=1,i=ls(T,v),i.ref=o.ref,i.return=o,o.child=i}function mp(i,o,f,v,k){if(i!==null){var T=i.memoizedProps;if(Ua(T,v)&&i.ref===o.ref)if(Dn=!1,o.pendingProps=v=T,(i.lanes&k)!==0)(i.flags&131072)!==0&&(Dn=!0);else return o.lanes=i.lanes,ki(i,o,k)}return ah(i,o,f,v,k)}function pp(i,o,f){var v=o.pendingProps,k=v.children,T=i!==null?i.memoizedState:null;if(v.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(Qo,Zn),Zn|=f;else{if((f&1073741824)===0)return i=T!==null?T.baseLanes|f:f,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,qt(Qo,Zn),Zn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=T!==null?T.baseLanes:f,qt(Qo,Zn),Zn|=v}else T!==null?(v=T.baseLanes|f,o.memoizedState=null):v=f,qt(Qo,Zn),Zn|=v;return xn(i,o,k,f),o.child}function gp(i,o){var f=o.ref;(i===null&&f!==null||i!==null&&i.ref!==f)&&(o.flags|=512,o.flags|=2097152)}function ah(i,o,f,v,k){var T=Nn(f)?zs:nn.current;return T=Wo(o,T),qo(o,k),f=Kf(i,o,f,v,T,k),v=qf(),i!==null&&!Dn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~k,ki(i,o,k)):(nr&&v&&Df(o),o.flags|=1,xn(i,o,f,k),o.child)}function vp(i,o,f,v,k){if(Nn(f)){var T=!0;Pu(o)}else T=!1;if(qo(o,k),o.stateNode===null)Zu(i,o),ip(o,f,v),th(o,f,v,k),v=!0;else if(i===null){var j=o.stateNode,oe=o.memoizedProps;j.props=oe;var he=j.context,Pe=f.contextType;typeof Pe=="object"&&Pe!==null?Pe=ia(Pe):(Pe=Nn(f)?zs:nn.current,Pe=Wo(o,Pe));var Le=f.getDerivedStateFromProps,je=typeof Le=="function"||typeof j.getSnapshotBeforeUpdate=="function";je||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(oe!==v||he!==Pe)&&sp(o,j,v,Pe),ts=!1;var Fe=o.memoizedState;j.state=Fe,Mu(o,v,j,k),he=o.memoizedState,oe!==v||Fe!==he||Pn.current||ts?(typeof Le=="function"&&(eh(o,f,Le,v),he=o.memoizedState),(oe=ts||ap(o,f,oe,v,Fe,he,Pe))?(je||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(o.flags|=4194308)):(typeof j.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=v,o.memoizedState=he),j.props=v,j.state=he,j.context=Pe,v=oe):(typeof j.componentDidMount=="function"&&(o.flags|=4194308),v=!1)}else{j=o.stateNode,Im(i,o),oe=o.memoizedProps,Pe=o.type===o.elementType?oe:Sa(o.type,oe),j.props=Pe,je=o.pendingProps,Fe=j.context,he=f.contextType,typeof he=="object"&&he!==null?he=ia(he):(he=Nn(f)?zs:nn.current,he=Wo(o,he));var qe=f.getDerivedStateFromProps;(Le=typeof qe=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(oe!==je||Fe!==he)&&sp(o,j,v,he),ts=!1,Fe=o.memoizedState,j.state=Fe,Mu(o,v,j,k);var Je=o.memoizedState;oe!==je||Fe!==Je||Pn.current||ts?(typeof qe=="function"&&(eh(o,f,qe,v),Je=o.memoizedState),(Pe=ts||ap(o,f,Pe,v,Fe,Je,he)||!1)?(Le||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(v,Je,he),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(v,Je,he)),typeof j.componentDidUpdate=="function"&&(o.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof j.componentDidUpdate!="function"||oe===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||oe===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=1024),o.memoizedProps=v,o.memoizedState=Je),j.props=v,j.state=Je,j.context=he,v=Pe):(typeof j.componentDidUpdate!="function"||oe===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||oe===i.memoizedProps&&Fe===i.memoizedState||(o.flags|=1024),v=!1)}return ih(i,o,f,v,T,k)}function ih(i,o,f,v,k,T){gp(i,o);var j=(o.flags&128)!==0;if(!v&&!j)return k&&km(o,f,!1),ki(i,o,T);v=o.stateNode,Ky.current=o;var oe=j&&typeof f.getDerivedStateFromError!="function"?null:v.render();return o.flags|=1,i!==null&&j?(o.child=Zo(o,i.child,null,T),o.child=Zo(o,null,oe,T)):xn(i,o,oe,T),o.memoizedState=v.state,k&&km(o,f,!0),o.child}function xp(i){var o=i.stateNode;o.pendingContext?_m(i,o.pendingContext,o.pendingContext!==o.context):o.context&&_m(i,o.context,!1),$f(i,o.containerInfo)}function yp(i,o,f,v,k){return Go(),Lf(k),o.flags|=256,xn(i,o,f,v),o.child}var sh={dehydrated:null,treeContext:null,retryLane:0};function oh(i){return{baseLanes:i,cachePool:null,transitions:null}}function _p(i,o,f){var v=o.pendingProps,k=cr.current,T=!1,j=(o.flags&128)!==0,oe;if((oe=j)||(oe=i!==null&&i.memoizedState===null?!1:(k&2)!==0),oe?(T=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(k|=1),qt(cr,k&1),i===null)return Ff(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(j=v.children,i=v.fallback,T?(v=o.mode,T=o.child,j={mode:"hidden",children:j},(v&1)===0&&T!==null?(T.childLanes=0,T.pendingProps=j):T=id(j,v,0,null),i=Ys(i,v,f,null),T.return=o,i.return=o,T.sibling=i,o.child=T,o.child.memoizedState=oh(f),o.memoizedState=sh,i):lh(o,j));if(k=i.memoizedState,k!==null&&(oe=k.dehydrated,oe!==null))return qy(i,o,j,v,oe,k,f);if(T){T=v.fallback,j=o.mode,k=i.child,oe=k.sibling;var he={mode:"hidden",children:v.children};return(j&1)===0&&o.child!==k?(v=o.child,v.childLanes=0,v.pendingProps=he,o.deletions=null):(v=ls(k,he),v.subtreeFlags=k.subtreeFlags&14680064),oe!==null?T=ls(oe,T):(T=Ys(T,j,f,null),T.flags|=2),T.return=o,v.return=o,v.sibling=T,o.child=v,v=T,T=o.child,j=i.child.memoizedState,j=j===null?oh(f):{baseLanes:j.baseLanes|f,cachePool:null,transitions:j.transitions},T.memoizedState=j,T.childLanes=i.childLanes&~f,o.memoizedState=sh,v}return T=i.child,i=T.sibling,v=ls(T,{mode:"visible",children:v.children}),(o.mode&1)===0&&(v.lanes=f),v.return=o,v.sibling=null,i!==null&&(f=o.deletions,f===null?(o.deletions=[i],o.flags|=16):f.push(i)),o.child=v,o.memoizedState=null,v}function lh(i,o){return o=id({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Gu(i,o,f,v){return v!==null&&Lf(v),Zo(o,i.child,null,f),i=lh(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function qy(i,o,f,v,k,T,j){if(f)return o.flags&256?(o.flags&=-257,v=rh(Error(t(422))),Gu(i,o,j,v)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(T=v.fallback,k=o.mode,v=id({mode:"visible",children:v.children},k,0,null),T=Ys(T,k,j,null),T.flags|=2,v.return=o,T.return=o,v.sibling=T,o.child=v,(o.mode&1)!==0&&Zo(o,i.child,null,j),o.child.memoizedState=oh(j),o.memoizedState=sh,T);if((o.mode&1)===0)return Gu(i,o,j,null);if(k.data==="$!"){if(v=k.nextSibling&&k.nextSibling.dataset,v)var oe=v.dgst;return v=oe,T=Error(t(419)),v=rh(T,v,void 0),Gu(i,o,j,v)}if(oe=(j&i.childLanes)!==0,Dn||oe){if(v=zr,v!==null){switch(j&-j){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(v.suspendedLanes|j))!==0?0:k,k!==0&&k!==T.retryLane&&(T.retryLane=k,_i(i,k),Ca(v,i,k,-1))}return Sh(),v=rh(Error(t(421))),Gu(i,o,j,v)}return k.data==="$?"?(o.flags|=128,o.child=i.child,o=l_.bind(null,i),k._reactRetry=o,null):(i=T.treeContext,Gn=Ha(k.nextSibling),Vn=o,nr=!0,ba=null,i!==null&&(na[aa++]=xi,na[aa++]=yi,na[aa++]=Us,xi=i.id,yi=i.overflow,Us=o),o=lh(o,v.children),o.flags|=4096,o)}function wp(i,o,f){i.lanes|=o;var v=i.alternate;v!==null&&(v.lanes|=o),Bf(i.return,o,f)}function ch(i,o,f,v,k){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:v,tail:f,tailMode:k}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=v,T.tail=f,T.tailMode=k)}function kp(i,o,f){var v=o.pendingProps,k=v.revealOrder,T=v.tail;if(xn(i,o,v.children,f),v=cr.current,(v&2)!==0)v=v&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&wp(i,f,o);else if(i.tag===19)wp(i,f,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}v&=1}if(qt(cr,v),(o.mode&1)===0)o.memoizedState=null;else switch(k){case"forwards":for(f=o.child,k=null;f!==null;)i=f.alternate,i!==null&&Bu(i)===null&&(k=f),f=f.sibling;f=k,f===null?(k=o.child,o.child=null):(k=f.sibling,f.sibling=null),ch(o,!1,k,f,T);break;case"backwards":for(f=null,k=o.child,o.child=null;k!==null;){if(i=k.alternate,i!==null&&Bu(i)===null){o.child=k;break}i=k.sibling,k.sibling=f,f=k,k=i}ch(o,!0,f,null,T);break;case"together":ch(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Zu(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function ki(i,o,f){if(i!==null&&(o.dependencies=i.dependencies),Gs|=o.lanes,(f&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,f=ls(i,i.pendingProps),o.child=f,f.return=o;i.sibling!==null;)i=i.sibling,f=f.sibling=ls(i,i.pendingProps),f.return=o;f.sibling=null}return o.child}function Yy(i,o,f){switch(o.tag){case 3:xp(o),Go();break;case 5:Rm(o);break;case 1:Nn(o.type)&&Pu(o);break;case 4:$f(o,o.stateNode.containerInfo);break;case 10:var v=o.type._context,k=o.memoizedProps.value;qt(Lu,v._currentValue),v._currentValue=k;break;case 13:if(v=o.memoizedState,v!==null)return v.dehydrated!==null?(qt(cr,cr.current&1),o.flags|=128,null):(f&o.child.childLanes)!==0?_p(i,o,f):(qt(cr,cr.current&1),i=ki(i,o,f),i!==null?i.sibling:null);qt(cr,cr.current&1);break;case 19:if(v=(f&o.childLanes)!==0,(i.flags&128)!==0){if(v)return kp(i,o,f);o.flags|=128}if(k=o.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),qt(cr,cr.current),v)break;return null;case 22:case 23:return o.lanes=0,pp(i,o,f)}return ki(i,o,f)}var bp,uh,Sp,Tp;bp=function(i,o){for(var f=o.child;f!==null;){if(f.tag===5||f.tag===6)i.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===o)break;for(;f.sibling===null;){if(f.return===null||f.return===o)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},uh=function(){},Sp=function(i,o,f,v){var k=i.memoizedProps;if(k!==v){i=o.stateNode,Hs(Va.current);var T=null;switch(f){case"input":k=bt(i,k),v=bt(i,v),T=[];break;case"select":k=fe({},k,{value:void 0}),v=fe({},v,{value:void 0}),T=[];break;case"textarea":k=Vr(i,k),v=Vr(i,v),T=[];break;default:typeof k.onClick!="function"&&typeof v.onClick=="function"&&(i.onclick=Oe)}ni(f,v);var j;f=null;for(Pe in k)if(!v.hasOwnProperty(Pe)&&k.hasOwnProperty(Pe)&&k[Pe]!=null)if(Pe==="style"){var oe=k[Pe];for(j in oe)oe.hasOwnProperty(j)&&(f||(f={}),f[j]="")}else Pe!=="dangerouslySetInnerHTML"&&Pe!=="children"&&Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&Pe!=="autoFocus"&&(a.hasOwnProperty(Pe)?T||(T=[]):(T=T||[]).push(Pe,null));for(Pe in v){var he=v[Pe];if(oe=k?.[Pe],v.hasOwnProperty(Pe)&&he!==oe&&(he!=null||oe!=null))if(Pe==="style")if(oe){for(j in oe)!oe.hasOwnProperty(j)||he&&he.hasOwnProperty(j)||(f||(f={}),f[j]="");for(j in he)he.hasOwnProperty(j)&&oe[j]!==he[j]&&(f||(f={}),f[j]=he[j])}else f||(T||(T=[]),T.push(Pe,f)),f=he;else Pe==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,oe=oe?oe.__html:void 0,he!=null&&oe!==he&&(T=T||[]).push(Pe,he)):Pe==="children"?typeof he!="string"&&typeof he!="number"||(T=T||[]).push(Pe,""+he):Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&(a.hasOwnProperty(Pe)?(he!=null&&Pe==="onScroll"&&Ht("scroll",i),T||oe===he||(T=[])):(T=T||[]).push(Pe,he))}f&&(T=T||[]).push("style",f);var Pe=T;(o.updateQueue=Pe)&&(o.flags|=4)}},Tp=function(i,o,f,v){f!==v&&(o.flags|=4)};function dc(i,o){if(!nr)switch(i.tailMode){case"hidden":o=i.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:v.sibling=null}}function sn(i){var o=i.alternate!==null&&i.alternate.child===i.child,f=0,v=0;if(o)for(var k=i.child;k!==null;)f|=k.lanes|k.childLanes,v|=k.subtreeFlags&14680064,v|=k.flags&14680064,k.return=i,k=k.sibling;else for(k=i.child;k!==null;)f|=k.lanes|k.childLanes,v|=k.subtreeFlags,v|=k.flags,k.return=i,k=k.sibling;return i.subtreeFlags|=v,i.childLanes=f,o}function Xy(i,o,f){var v=o.pendingProps;switch(Of(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sn(o),null;case 1:return Nn(o.type)&&Au(),sn(o),null;case 3:return v=o.stateNode,Yo(),tr(Pn),tr(nn),Vf(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(i===null||i.child===null)&&(Iu(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,ba!==null&&(wh(ba),ba=null))),uh(i,o),sn(o),null;case 5:Wf(o);var k=Hs(sc.current);if(f=o.type,i!==null&&o.stateNode!=null)Sp(i,o,f,v,k),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!v){if(o.stateNode===null)throw Error(t(166));return sn(o),null}if(i=Hs(Va.current),Iu(o)){v=o.stateNode,f=o.type;var T=o.memoizedProps;switch(v[ra]=o,v[Yi]=T,i=(o.mode&1)!==0,f){case"dialog":Ht("cancel",v),Ht("close",v);break;case"iframe":case"object":case"embed":Ht("load",v);break;case"video":case"audio":for(k=0;k<Zi.length;k++)Ht(Zi[k],v);break;case"source":Ht("error",v);break;case"img":case"image":case"link":Ht("error",v),Ht("load",v);break;case"details":Ht("toggle",v);break;case"input":yt(v,T),Ht("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!T.multiple},Ht("invalid",v);break;case"textarea":at(v,T),Ht("invalid",v)}ni(f,T),k=null;for(var j in T)if(T.hasOwnProperty(j)){var oe=T[j];j==="children"?typeof oe=="string"?v.textContent!==oe&&(T.suppressHydrationWarning!==!0&&Ae(v.textContent,oe,i),k=["children",oe]):typeof oe=="number"&&v.textContent!==""+oe&&(T.suppressHydrationWarning!==!0&&Ae(v.textContent,oe,i),k=["children",""+oe]):a.hasOwnProperty(j)&&oe!=null&&j==="onScroll"&&Ht("scroll",v)}switch(f){case"input":Ke(v),Pt(v,T,!0);break;case"textarea":Ke(v),Jr(v);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(v.onclick=Oe)}v=k,o.updateQueue=v,v!==null&&(o.flags|=4)}else{j=k.nodeType===9?k:k.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Gr(f)),i==="http://www.w3.org/1999/xhtml"?f==="script"?(i=j.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof v.is=="string"?i=j.createElement(f,{is:v.is}):(i=j.createElement(f),f==="select"&&(j=i,v.multiple?j.multiple=!0:v.size&&(j.size=v.size))):i=j.createElementNS(i,f),i[ra]=o,i[Yi]=v,bp(i,o,!1,!1),o.stateNode=i;e:{switch(j=Rn(f,v),f){case"dialog":Ht("cancel",i),Ht("close",i),k=v;break;case"iframe":case"object":case"embed":Ht("load",i),k=v;break;case"video":case"audio":for(k=0;k<Zi.length;k++)Ht(Zi[k],i);k=v;break;case"source":Ht("error",i),k=v;break;case"img":case"image":case"link":Ht("error",i),Ht("load",i),k=v;break;case"details":Ht("toggle",i),k=v;break;case"input":yt(i,v),k=bt(i,v),Ht("invalid",i);break;case"option":k=v;break;case"select":i._wrapperState={wasMultiple:!!v.multiple},k=fe({},v,{value:void 0}),Ht("invalid",i);break;case"textarea":at(i,v),k=Vr(i,v),Ht("invalid",i);break;default:k=v}ni(f,k),oe=k;for(T in oe)if(oe.hasOwnProperty(T)){var he=oe[T];T==="style"?Qr(i,he):T==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&Rr(i,he)):T==="children"?typeof he=="string"?(f!=="textarea"||he!=="")&&ct(i,he):typeof he=="number"&&ct(i,""+he):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(a.hasOwnProperty(T)?he!=null&&T==="onScroll"&&Ht("scroll",i):he!=null&&O(i,T,he,j))}switch(f){case"input":Ke(i),Pt(i,v,!1);break;case"textarea":Ke(i),Jr(i);break;case"option":v.value!=null&&i.setAttribute("value",""+Ce(v.value));break;case"select":i.multiple=!!v.multiple,T=v.value,T!=null?Zt(i,!!v.multiple,T,!1):v.defaultValue!=null&&Zt(i,!!v.multiple,v.defaultValue,!0);break;default:typeof k.onClick=="function"&&(i.onclick=Oe)}switch(f){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return sn(o),null;case 6:if(i&&o.stateNode!=null)Tp(i,o,i.memoizedProps,v);else{if(typeof v!="string"&&o.stateNode===null)throw Error(t(166));if(f=Hs(sc.current),Hs(Va.current),Iu(o)){if(v=o.stateNode,f=o.memoizedProps,v[ra]=o,(T=v.nodeValue!==f)&&(i=Vn,i!==null))switch(i.tag){case 3:Ae(v.nodeValue,f,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Ae(v.nodeValue,f,(i.mode&1)!==0)}T&&(o.flags|=4)}else v=(f.nodeType===9?f:f.ownerDocument).createTextNode(v),v[ra]=o,o.stateNode=v}return sn(o),null;case 13:if(tr(cr),v=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(nr&&Gn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Am(),Go(),o.flags|=98560,T=!1;else if(T=Iu(o),v!==null&&v.dehydrated!==null){if(i===null){if(!T)throw Error(t(318));if(T=o.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(t(317));T[ra]=o}else Go(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;sn(o),T=!1}else ba!==null&&(wh(ba),ba=null),T=!0;if(!T)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=f,o):(v=v!==null,v!==(i!==null&&i.memoizedState!==null)&&v&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(cr.current&1)!==0?Pr===0&&(Pr=3):Sh())),o.updateQueue!==null&&(o.flags|=4),sn(o),null);case 4:return Yo(),uh(i,o),i===null&&Ki(o.stateNode.containerInfo),sn(o),null;case 10:return Mf(o.type._context),sn(o),null;case 17:return Nn(o.type)&&Au(),sn(o),null;case 19:if(tr(cr),T=o.memoizedState,T===null)return sn(o),null;if(v=(o.flags&128)!==0,j=T.rendering,j===null)if(v)dc(T,!1);else{if(Pr!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(j=Bu(i),j!==null){for(o.flags|=128,dc(T,!1),v=j.updateQueue,v!==null&&(o.updateQueue=v,o.flags|=4),o.subtreeFlags=0,v=f,f=o.child;f!==null;)T=f,i=v,T.flags&=14680066,j=T.alternate,j===null?(T.childLanes=0,T.lanes=i,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=j.childLanes,T.lanes=j.lanes,T.child=j.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=j.memoizedProps,T.memoizedState=j.memoizedState,T.updateQueue=j.updateQueue,T.type=j.type,i=j.dependencies,T.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),f=f.sibling;return qt(cr,cr.current&1|2),o.child}i=i.sibling}T.tail!==null&&Me()>el&&(o.flags|=128,v=!0,dc(T,!1),o.lanes=4194304)}else{if(!v)if(i=Bu(j),i!==null){if(o.flags|=128,v=!0,f=i.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),dc(T,!0),T.tail===null&&T.tailMode==="hidden"&&!j.alternate&&!nr)return sn(o),null}else 2*Me()-T.renderingStartTime>el&&f!==1073741824&&(o.flags|=128,v=!0,dc(T,!1),o.lanes=4194304);T.isBackwards?(j.sibling=o.child,o.child=j):(f=T.last,f!==null?f.sibling=j:o.child=j,T.last=j)}return T.tail!==null?(o=T.tail,T.rendering=o,T.tail=o.sibling,T.renderingStartTime=Me(),o.sibling=null,f=cr.current,qt(cr,v?f&1|2:f&1),o):(sn(o),null);case 22:case 23:return bh(),v=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==v&&(o.flags|=8192),v&&(o.mode&1)!==0?(Zn&1073741824)!==0&&(sn(o),o.subtreeFlags&6&&(o.flags|=8192)):sn(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function Jy(i,o){switch(Of(o),o.tag){case 1:return Nn(o.type)&&Au(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Yo(),tr(Pn),tr(nn),Vf(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Wf(o),null;case 13:if(tr(cr),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));Go()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return tr(cr),null;case 4:return Yo(),null;case 10:return Mf(o.type._context),null;case 22:case 23:return bh(),null;case 24:return null;default:return null}}var Ku=!1,on=!1,Qy=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function Jo(i,o){var f=i.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(v){fr(i,o,v)}else f.current=null}function dh(i,o,f){try{f()}catch(v){fr(i,o,v)}}var Ep=!1;function e_(i,o){if(He=Os,i=Kl(),ql(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var v=f.getSelection&&f.getSelection();if(v&&v.rangeCount!==0){f=v.anchorNode;var k=v.anchorOffset,T=v.focusNode;v=v.focusOffset;try{f.nodeType,T.nodeType}catch{f=null;break e}var j=0,oe=-1,he=-1,Pe=0,Le=0,je=i,Fe=null;t:for(;;){for(var qe;je!==f||k!==0&&je.nodeType!==3||(oe=j+k),je!==T||v!==0&&je.nodeType!==3||(he=j+v),je.nodeType===3&&(j+=je.nodeValue.length),(qe=je.firstChild)!==null;)Fe=je,je=qe;for(;;){if(je===i)break t;if(Fe===f&&++Pe===k&&(oe=j),Fe===T&&++Le===v&&(he=j),(qe=je.nextSibling)!==null)break;je=Fe,Fe=je.parentNode}je=qe}f=oe===-1||he===-1?null:{start:oe,end:he}}else f=null}f=f||{start:0,end:0}}else f=null;for(st={focusedElem:i,selectionRange:f},Os=!1,Xe=o;Xe!==null;)if(o=Xe,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,Xe=i;else for(;Xe!==null;){o=Xe;try{var Je=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Je!==null){var tt=Je.memoizedProps,xr=Je.memoizedState,_e=o.stateNode,pe=_e.getSnapshotBeforeUpdate(o.elementType===o.type?tt:Sa(o.type,tt),xr);_e.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:var Se=o.stateNode.containerInfo;Se.nodeType===1?Se.textContent="":Se.nodeType===9&&Se.documentElement&&Se.removeChild(Se.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ze){fr(o,o.return,ze)}if(i=o.sibling,i!==null){i.return=o.return,Xe=i;break}Xe=o.return}return Je=Ep,Ep=!1,Je}function fc(i,o,f){var v=o.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var k=v=v.next;do{if((k.tag&i)===i){var T=k.destroy;k.destroy=void 0,T!==void 0&&dh(o,f,T)}k=k.next}while(k!==v)}}function qu(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var f=o=o.next;do{if((f.tag&i)===i){var v=f.create;f.destroy=v()}f=f.next}while(f!==o)}}function fh(i){var o=i.ref;if(o!==null){var f=i.stateNode;switch(i.tag){case 5:i=f;break;default:i=f}typeof o=="function"?o(i):o.current=i}}function Cp(i){var o=i.alternate;o!==null&&(i.alternate=null,Cp(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[ra],delete o[Yi],delete o[Xi],delete o[Cf],delete o[Af])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Ap(i){return i.tag===5||i.tag===3||i.tag===4}function Pp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Ap(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function hh(i,o,f){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?f.nodeType===8?f.parentNode.insertBefore(i,o):f.insertBefore(i,o):(f.nodeType===8?(o=f.parentNode,o.insertBefore(i,f)):(o=f,o.appendChild(i)),f=f._reactRootContainer,f!=null||o.onclick!==null||(o.onclick=Oe));else if(v!==4&&(i=i.child,i!==null))for(hh(i,o,f),i=i.sibling;i!==null;)hh(i,o,f),i=i.sibling}function mh(i,o,f){var v=i.tag;if(v===5||v===6)i=i.stateNode,o?f.insertBefore(i,o):f.appendChild(i);else if(v!==4&&(i=i.child,i!==null))for(mh(i,o,f),i=i.sibling;i!==null;)mh(i,o,f),i=i.sibling}var Zr=null,Ta=!1;function ns(i,o,f){for(f=f.child;f!==null;)Np(i,o,f),f=f.sibling}function Np(i,o,f){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(jn,f)}catch{}switch(f.tag){case 5:on||Jo(f,o);case 6:var v=Zr,k=Ta;Zr=null,ns(i,o,f),Zr=v,Ta=k,Zr!==null&&(Ta?(i=Zr,f=f.stateNode,i.nodeType===8?i.parentNode.removeChild(f):i.removeChild(f)):Zr.removeChild(f.stateNode));break;case 18:Zr!==null&&(Ta?(i=Zr,f=f.stateNode,i.nodeType===8?rc(i.parentNode,f):i.nodeType===1&&rc(i,f),zn(i)):rc(Zr,f.stateNode));break;case 4:v=Zr,k=Ta,Zr=f.stateNode.containerInfo,Ta=!0,ns(i,o,f),Zr=v,Ta=k;break;case 0:case 11:case 14:case 15:if(!on&&(v=f.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){k=v=v.next;do{var T=k,j=T.destroy;T=T.tag,j!==void 0&&((T&2)!==0||(T&4)!==0)&&dh(f,o,j),k=k.next}while(k!==v)}ns(i,o,f);break;case 1:if(!on&&(Jo(f,o),v=f.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=f.memoizedProps,v.state=f.memoizedState,v.componentWillUnmount()}catch(oe){fr(f,o,oe)}ns(i,o,f);break;case 21:ns(i,o,f);break;case 22:f.mode&1?(on=(v=on)||f.memoizedState!==null,ns(i,o,f),on=v):ns(i,o,f);break;default:ns(i,o,f)}}function Dp(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var f=i.stateNode;f===null&&(f=i.stateNode=new Qy),o.forEach(function(v){var k=c_.bind(null,i,v);f.has(v)||(f.add(v),v.then(k,k))})}}function Ea(i,o){var f=o.deletions;if(f!==null)for(var v=0;v<f.length;v++){var k=f[v];try{var T=i,j=o,oe=j;e:for(;oe!==null;){switch(oe.tag){case 5:Zr=oe.stateNode,Ta=!1;break e;case 3:Zr=oe.stateNode.containerInfo,Ta=!0;break e;case 4:Zr=oe.stateNode.containerInfo,Ta=!0;break e}oe=oe.return}if(Zr===null)throw Error(t(160));Np(T,j,k),Zr=null,Ta=!1;var he=k.alternate;he!==null&&(he.return=null),k.return=null}catch(Pe){fr(k,o,Pe)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Op(o,i),o=o.sibling}function Op(i,o){var f=i.alternate,v=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Ea(o,i),Za(i),v&4){try{fc(3,i,i.return),qu(3,i)}catch(tt){fr(i,i.return,tt)}try{fc(5,i,i.return)}catch(tt){fr(i,i.return,tt)}}break;case 1:Ea(o,i),Za(i),v&512&&f!==null&&Jo(f,f.return);break;case 5:if(Ea(o,i),Za(i),v&512&&f!==null&&Jo(f,f.return),i.flags&32){var k=i.stateNode;try{ct(k,"")}catch(tt){fr(i,i.return,tt)}}if(v&4&&(k=i.stateNode,k!=null)){var T=i.memoizedProps,j=f!==null?f.memoizedProps:T,oe=i.type,he=i.updateQueue;if(i.updateQueue=null,he!==null)try{oe==="input"&&T.type==="radio"&&T.name!=null&&ut(k,T),Rn(oe,j);var Pe=Rn(oe,T);for(j=0;j<he.length;j+=2){var Le=he[j],je=he[j+1];Le==="style"?Qr(k,je):Le==="dangerouslySetInnerHTML"?Rr(k,je):Le==="children"?ct(k,je):O(k,Le,je,Pe)}switch(oe){case"input":Ue(k,T);break;case"textarea":pr(k,T);break;case"select":var Fe=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!T.multiple;var qe=T.value;qe!=null?Zt(k,!!T.multiple,qe,!1):Fe!==!!T.multiple&&(T.defaultValue!=null?Zt(k,!!T.multiple,T.defaultValue,!0):Zt(k,!!T.multiple,T.multiple?[]:"",!1))}k[Yi]=T}catch(tt){fr(i,i.return,tt)}}break;case 6:if(Ea(o,i),Za(i),v&4){if(i.stateNode===null)throw Error(t(162));k=i.stateNode,T=i.memoizedProps;try{k.nodeValue=T}catch(tt){fr(i,i.return,tt)}}break;case 3:if(Ea(o,i),Za(i),v&4&&f!==null&&f.memoizedState.isDehydrated)try{zn(o.containerInfo)}catch(tt){fr(i,i.return,tt)}break;case 4:Ea(o,i),Za(i);break;case 13:Ea(o,i),Za(i),k=i.child,k.flags&8192&&(T=k.memoizedState!==null,k.stateNode.isHidden=T,!T||k.alternate!==null&&k.alternate.memoizedState!==null||(vh=Me())),v&4&&Dp(i);break;case 22:if(Le=f!==null&&f.memoizedState!==null,i.mode&1?(on=(Pe=on)||Le,Ea(o,i),on=Pe):Ea(o,i),Za(i),v&8192){if(Pe=i.memoizedState!==null,(i.stateNode.isHidden=Pe)&&!Le&&(i.mode&1)!==0)for(Xe=i,Le=i.child;Le!==null;){for(je=Xe=Le;Xe!==null;){switch(Fe=Xe,qe=Fe.child,Fe.tag){case 0:case 11:case 14:case 15:fc(4,Fe,Fe.return);break;case 1:Jo(Fe,Fe.return);var Je=Fe.stateNode;if(typeof Je.componentWillUnmount=="function"){v=Fe,f=Fe.return;try{o=v,Je.props=o.memoizedProps,Je.state=o.memoizedState,Je.componentWillUnmount()}catch(tt){fr(v,f,tt)}}break;case 5:Jo(Fe,Fe.return);break;case 22:if(Fe.memoizedState!==null){Lp(je);continue}}qe!==null?(qe.return=Fe,Xe=qe):Lp(je)}Le=Le.sibling}e:for(Le=null,je=i;;){if(je.tag===5){if(Le===null){Le=je;try{k=je.stateNode,Pe?(T=k.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(oe=je.stateNode,he=je.memoizedProps.style,j=he!=null&&he.hasOwnProperty("display")?he.display:null,oe.style.display=Gt("display",j))}catch(tt){fr(i,i.return,tt)}}}else if(je.tag===6){if(Le===null)try{je.stateNode.nodeValue=Pe?"":je.memoizedProps}catch(tt){fr(i,i.return,tt)}}else if((je.tag!==22&&je.tag!==23||je.memoizedState===null||je===i)&&je.child!==null){je.child.return=je,je=je.child;continue}if(je===i)break e;for(;je.sibling===null;){if(je.return===null||je.return===i)break e;Le===je&&(Le=null),je=je.return}Le===je&&(Le=null),je.sibling.return=je.return,je=je.sibling}}break;case 19:Ea(o,i),Za(i),v&4&&Dp(i);break;case 21:break;default:Ea(o,i),Za(i)}}function Za(i){var o=i.flags;if(o&2){try{e:{for(var f=i.return;f!==null;){if(Ap(f)){var v=f;break e}f=f.return}throw Error(t(160))}switch(v.tag){case 5:var k=v.stateNode;v.flags&32&&(ct(k,""),v.flags&=-33);var T=Pp(i);mh(i,T,k);break;case 3:case 4:var j=v.stateNode.containerInfo,oe=Pp(i);hh(i,oe,j);break;default:throw Error(t(161))}}catch(he){fr(i,i.return,he)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function t_(i,o,f){Xe=i,Ip(i)}function Ip(i,o,f){for(var v=(i.mode&1)!==0;Xe!==null;){var k=Xe,T=k.child;if(k.tag===22&&v){var j=k.memoizedState!==null||Ku;if(!j){var oe=k.alternate,he=oe!==null&&oe.memoizedState!==null||on;oe=Ku;var Pe=on;if(Ku=j,(on=he)&&!Pe)for(Xe=k;Xe!==null;)j=Xe,he=j.child,j.tag===22&&j.memoizedState!==null?Rp(k):he!==null?(he.return=j,Xe=he):Rp(k);for(;T!==null;)Xe=T,Ip(T),T=T.sibling;Xe=k,Ku=oe,on=Pe}Fp(i)}else(k.subtreeFlags&8772)!==0&&T!==null?(T.return=k,Xe=T):Fp(i)}}function Fp(i){for(;Xe!==null;){var o=Xe;if((o.flags&8772)!==0){var f=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:on||qu(5,o);break;case 1:var v=o.stateNode;if(o.flags&4&&!on)if(f===null)v.componentDidMount();else{var k=o.elementType===o.type?f.memoizedProps:Sa(o.type,f.memoizedProps);v.componentDidUpdate(k,f.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var T=o.updateQueue;T!==null&&Lm(o,T,v);break;case 3:var j=o.updateQueue;if(j!==null){if(f=null,o.child!==null)switch(o.child.tag){case 5:f=o.child.stateNode;break;case 1:f=o.child.stateNode}Lm(o,j,f)}break;case 5:var oe=o.stateNode;if(f===null&&o.flags&4){f=oe;var he=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&f.focus();break;case"img":he.src&&(f.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Pe=o.alternate;if(Pe!==null){var Le=Pe.memoizedState;if(Le!==null){var je=Le.dehydrated;je!==null&&zn(je)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}on||o.flags&512&&fh(o)}catch(Fe){fr(o,o.return,Fe)}}if(o===i){Xe=null;break}if(f=o.sibling,f!==null){f.return=o.return,Xe=f;break}Xe=o.return}}function Lp(i){for(;Xe!==null;){var o=Xe;if(o===i){Xe=null;break}var f=o.sibling;if(f!==null){f.return=o.return,Xe=f;break}Xe=o.return}}function Rp(i){for(;Xe!==null;){var o=Xe;try{switch(o.tag){case 0:case 11:case 15:var f=o.return;try{qu(4,o)}catch(he){fr(o,f,he)}break;case 1:var v=o.stateNode;if(typeof v.componentDidMount=="function"){var k=o.return;try{v.componentDidMount()}catch(he){fr(o,k,he)}}var T=o.return;try{fh(o)}catch(he){fr(o,T,he)}break;case 5:var j=o.return;try{fh(o)}catch(he){fr(o,j,he)}}}catch(he){fr(o,o.return,he)}if(o===i){Xe=null;break}var oe=o.sibling;if(oe!==null){oe.return=o.return,Xe=oe;break}Xe=o.return}}var r_=Math.ceil,Yu=M.ReactCurrentDispatcher,ph=M.ReactCurrentOwner,oa=M.ReactCurrentBatchConfig,Ft=0,zr=null,wr=null,Kr=0,Zn=0,Qo=Ji(0),Pr=0,hc=null,Gs=0,Xu=0,gh=0,mc=null,On=null,vh=0,el=1/0,bi=null,Ju=!1,xh=null,as=null,Qu=!1,is=null,ed=0,pc=0,yh=null,td=-1,rd=0;function yn(){return(Ft&6)!==0?Me():td!==-1?td:td=Me()}function ss(i){return(i.mode&1)===0?1:(Ft&2)!==0&&Kr!==0?Kr&-Kr:By.transition!==null?(rd===0&&(rd=iu()),rd):(i=Nt,i!==0||(i=window.event,i=i===void 0?16:Ct(i.type)),i)}function Ca(i,o,f,v){if(50<pc)throw pc=0,yh=null,Error(t(185));Mn(i,f,v),((Ft&2)===0||i!==zr)&&(i===zr&&((Ft&2)===0&&(Xu|=f),Pr===4&&os(i,Kr)),In(i,v),f===1&&Ft===0&&(o.mode&1)===0&&(el=Me()+500,Nu&&es()))}function In(i,o){var f=i.callbackNode;_o(i,o);var v=Kt(i,i===zr?Kr:0);if(v===0)f!==null&&We(f),i.callbackNode=null,i.callbackPriority=0;else if(o=v&-v,i.callbackPriority!==o){if(f!=null&&We(f),o===1)i.tag===0?My(Mp.bind(null,i)):bm(Mp.bind(null,i)),rn(function(){(Ft&6)===0&&es()}),f=null;else{switch(Li(v)){case 1:f=zt;break;case 4:f=$t;break;case 16:f=or;break;case 536870912:f=En;break;default:f=or}f=Gp(f,jp.bind(null,i))}i.callbackPriority=o,i.callbackNode=f}}function jp(i,o){if(td=-1,rd=0,(Ft&6)!==0)throw Error(t(327));var f=i.callbackNode;if(tl()&&i.callbackNode!==f)return null;var v=Kt(i,i===zr?Kr:0);if(v===0)return null;if((v&30)!==0||(v&i.expiredLanes)!==0||o)o=nd(i,v);else{o=v;var k=Ft;Ft|=2;var T=zp();(zr!==i||Kr!==o)&&(bi=null,el=Me()+500,Ks(i,o));do try{i_();break}catch(oe){Bp(i,oe)}while(!0);jf(),Yu.current=T,Ft=k,wr!==null?o=0:(zr=null,Kr=0,o=Pr)}if(o!==0){if(o===2&&(k=en(i),k!==0&&(v=k,o=_h(i,k))),o===1)throw f=hc,Ks(i,0),os(i,v),In(i,Me()),f;if(o===6)os(i,v);else{if(k=i.current.alternate,(v&30)===0&&!n_(k)&&(o=nd(i,v),o===2&&(T=en(i),T!==0&&(v=T,o=_h(i,T))),o===1))throw f=hc,Ks(i,0),os(i,v),In(i,Me()),f;switch(i.finishedWork=k,i.finishedLanes=v,o){case 0:case 1:throw Error(t(345));case 2:qs(i,On,bi);break;case 3:if(os(i,v),(v&130023424)===v&&(o=vh+500-Me(),10<o)){if(Kt(i,0)!==0)break;if(k=i.suspendedLanes,(k&v)!==v){yn(),i.pingedLanes|=i.suspendedLanes&k;break}i.timeoutHandle=Cr(qs.bind(null,i,On,bi),o);break}qs(i,On,bi);break;case 4:if(os(i,v),(v&4194240)===v)break;for(o=i.eventTimes,k=-1;0<v;){var j=31-it(v);T=1<<j,j=o[j],j>k&&(k=j),v&=~T}if(v=k,v=Me()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*r_(v/1960))-v,10<v){i.timeoutHandle=Cr(qs.bind(null,i,On,bi),v);break}qs(i,On,bi);break;case 5:qs(i,On,bi);break;default:throw Error(t(329))}}}return In(i,Me()),i.callbackNode===f?jp.bind(null,i):null}function _h(i,o){var f=mc;return i.current.memoizedState.isDehydrated&&(Ks(i,o).flags|=256),i=nd(i,o),i!==2&&(o=On,On=f,o!==null&&wh(o)),i}function wh(i){On===null?On=i:On.push.apply(On,i)}function n_(i){for(var o=i;;){if(o.flags&16384){var f=o.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var v=0;v<f.length;v++){var k=f[v],T=k.getSnapshot;k=k.value;try{if(!Wn(T(),k))return!1}catch{return!1}}}if(f=o.child,o.subtreeFlags&16384&&f!==null)f.return=o,o=f;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function os(i,o){for(o&=~gh,o&=~Xu,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var f=31-it(o),v=1<<f;i[f]=-1,o&=~v}}function Mp(i){if((Ft&6)!==0)throw Error(t(327));tl();var o=Kt(i,0);if((o&1)===0)return In(i,Me()),null;var f=nd(i,o);if(i.tag!==0&&f===2){var v=en(i);v!==0&&(o=v,f=_h(i,v))}if(f===1)throw f=hc,Ks(i,0),os(i,o),In(i,Me()),f;if(f===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,qs(i,On,bi),In(i,Me()),null}function kh(i,o){var f=Ft;Ft|=1;try{return i(o)}finally{Ft=f,Ft===0&&(el=Me()+500,Nu&&es())}}function Zs(i){is!==null&&is.tag===0&&(Ft&6)===0&&tl();var o=Ft;Ft|=1;var f=oa.transition,v=Nt;try{if(oa.transition=null,Nt=1,i)return i()}finally{Nt=v,oa.transition=f,Ft=o,(Ft&6)===0&&es()}}function bh(){Zn=Qo.current,tr(Qo)}function Ks(i,o){i.finishedWork=null,i.finishedLanes=0;var f=i.timeoutHandle;if(f!==-1&&(i.timeoutHandle=-1,_r(f)),wr!==null)for(f=wr.return;f!==null;){var v=f;switch(Of(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&Au();break;case 3:Yo(),tr(Pn),tr(nn),Vf();break;case 5:Wf(v);break;case 4:Yo();break;case 13:tr(cr);break;case 19:tr(cr);break;case 10:Mf(v.type._context);break;case 22:case 23:bh()}f=f.return}if(zr=i,wr=i=ls(i.current,null),Kr=Zn=o,Pr=0,hc=null,gh=Xu=Gs=0,On=mc=null,Ws!==null){for(o=0;o<Ws.length;o++)if(f=Ws[o],v=f.interleaved,v!==null){f.interleaved=null;var k=v.next,T=f.pending;if(T!==null){var j=T.next;T.next=k,v.next=j}f.pending=v}Ws=null}return i}function Bp(i,o){do{var f=wr;try{if(jf(),zu.current=Hu,Uu){for(var v=ur.memoizedState;v!==null;){var k=v.queue;k!==null&&(k.pending=null),v=v.next}Uu=!1}if(Vs=0,Br=Ar=ur=null,oc=!1,lc=0,ph.current=null,f===null||f.return===null){Pr=1,hc=o,wr=null;break}e:{var T=i,j=f.return,oe=f,he=o;if(o=Kr,oe.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var Pe=he,Le=oe,je=Le.tag;if((Le.mode&1)===0&&(je===0||je===11||je===15)){var Fe=Le.alternate;Fe?(Le.updateQueue=Fe.updateQueue,Le.memoizedState=Fe.memoizedState,Le.lanes=Fe.lanes):(Le.updateQueue=null,Le.memoizedState=null)}var qe=up(j);if(qe!==null){qe.flags&=-257,dp(qe,j,oe,T,o),qe.mode&1&&cp(T,Pe,o),o=qe,he=Pe;var Je=o.updateQueue;if(Je===null){var tt=new Set;tt.add(he),o.updateQueue=tt}else Je.add(he);break e}else{if((o&1)===0){cp(T,Pe,o),Sh();break e}he=Error(t(426))}}else if(nr&&oe.mode&1){var xr=up(j);if(xr!==null){(xr.flags&65536)===0&&(xr.flags|=256),dp(xr,j,oe,T,o),Lf(Xo(he,oe));break e}}T=he=Xo(he,oe),Pr!==4&&(Pr=2),mc===null?mc=[T]:mc.push(T),T=j;do{switch(T.tag){case 3:T.flags|=65536,o&=-o,T.lanes|=o;var _e=op(T,he,o);Fm(T,_e);break e;case 1:oe=he;var pe=T.type,Se=T.stateNode;if((T.flags&128)===0&&(typeof pe.getDerivedStateFromError=="function"||Se!==null&&typeof Se.componentDidCatch=="function"&&(as===null||!as.has(Se)))){T.flags|=65536,o&=-o,T.lanes|=o;var ze=lp(T,oe,o);Fm(T,ze);break e}}T=T.return}while(T!==null)}$p(f)}catch(rt){o=rt,wr===f&&f!==null&&(wr=f=f.return);continue}break}while(!0)}function zp(){var i=Yu.current;return Yu.current=Hu,i===null?Hu:i}function Sh(){(Pr===0||Pr===3||Pr===2)&&(Pr=4),zr===null||(Gs&268435455)===0&&(Xu&268435455)===0||os(zr,Kr)}function nd(i,o){var f=Ft;Ft|=2;var v=zp();(zr!==i||Kr!==o)&&(bi=null,Ks(i,o));do try{a_();break}catch(k){Bp(i,k)}while(!0);if(jf(),Ft=f,Yu.current=v,wr!==null)throw Error(t(261));return zr=null,Kr=0,Pr}function a_(){for(;wr!==null;)Up(wr)}function i_(){for(;wr!==null&&!Ze();)Up(wr)}function Up(i){var o=Vp(i.alternate,i,Zn);i.memoizedProps=i.pendingProps,o===null?$p(i):wr=o,ph.current=null}function $p(i){var o=i;do{var f=o.alternate;if(i=o.return,(o.flags&32768)===0){if(f=Xy(f,o,Zn),f!==null){wr=f;return}}else{if(f=Jy(f,o),f!==null){f.flags&=32767,wr=f;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Pr=6,wr=null;return}}if(o=o.sibling,o!==null){wr=o;return}wr=o=i}while(o!==null);Pr===0&&(Pr=5)}function qs(i,o,f){var v=Nt,k=oa.transition;try{oa.transition=null,Nt=1,s_(i,o,f,v)}finally{oa.transition=k,Nt=v}return null}function s_(i,o,f,v){do tl();while(is!==null);if((Ft&6)!==0)throw Error(t(327));f=i.finishedWork;var k=i.finishedLanes;if(f===null)return null;if(i.finishedWork=null,i.finishedLanes=0,f===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var T=f.lanes|f.childLanes;if(dr(i,T),i===zr&&(wr=zr=null,Kr=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||Qu||(Qu=!0,Gp(or,function(){return tl(),null})),T=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||T){T=oa.transition,oa.transition=null;var j=Nt;Nt=1;var oe=Ft;Ft|=4,ph.current=null,e_(i,f),Op(f,i),ea(st),Os=!!He,st=He=null,i.current=f,t_(f),Be(),Ft=oe,Nt=j,oa.transition=T}else i.current=f;if(Qu&&(Qu=!1,is=i,ed=k),T=i.pendingLanes,T===0&&(as=null),ga(f.stateNode),In(i,Me()),o!==null)for(v=i.onRecoverableError,f=0;f<o.length;f++)k=o[f],v(k.value,{componentStack:k.stack,digest:k.digest});if(Ju)throw Ju=!1,i=xh,xh=null,i;return(ed&1)!==0&&i.tag!==0&&tl(),T=i.pendingLanes,(T&1)!==0?i===yh?pc++:(pc=0,yh=i):pc=0,es(),null}function tl(){if(is!==null){var i=Li(ed),o=oa.transition,f=Nt;try{if(oa.transition=null,Nt=16>i?16:i,is===null)var v=!1;else{if(i=is,is=null,ed=0,(Ft&6)!==0)throw Error(t(331));var k=Ft;for(Ft|=4,Xe=i.current;Xe!==null;){var T=Xe,j=T.child;if((Xe.flags&16)!==0){var oe=T.deletions;if(oe!==null){for(var he=0;he<oe.length;he++){var Pe=oe[he];for(Xe=Pe;Xe!==null;){var Le=Xe;switch(Le.tag){case 0:case 11:case 15:fc(8,Le,T)}var je=Le.child;if(je!==null)je.return=Le,Xe=je;else for(;Xe!==null;){Le=Xe;var Fe=Le.sibling,qe=Le.return;if(Cp(Le),Le===Pe){Xe=null;break}if(Fe!==null){Fe.return=qe,Xe=Fe;break}Xe=qe}}}var Je=T.alternate;if(Je!==null){var tt=Je.child;if(tt!==null){Je.child=null;do{var xr=tt.sibling;tt.sibling=null,tt=xr}while(tt!==null)}}Xe=T}}if((T.subtreeFlags&2064)!==0&&j!==null)j.return=T,Xe=j;else e:for(;Xe!==null;){if(T=Xe,(T.flags&2048)!==0)switch(T.tag){case 0:case 11:case 15:fc(9,T,T.return)}var _e=T.sibling;if(_e!==null){_e.return=T.return,Xe=_e;break e}Xe=T.return}}var pe=i.current;for(Xe=pe;Xe!==null;){j=Xe;var Se=j.child;if((j.subtreeFlags&2064)!==0&&Se!==null)Se.return=j,Xe=Se;else e:for(j=pe;Xe!==null;){if(oe=Xe,(oe.flags&2048)!==0)try{switch(oe.tag){case 0:case 11:case 15:qu(9,oe)}}catch(rt){fr(oe,oe.return,rt)}if(oe===j){Xe=null;break e}var ze=oe.sibling;if(ze!==null){ze.return=oe.return,Xe=ze;break e}Xe=oe.return}}if(Ft=k,es(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(jn,i)}catch{}v=!0}return v}finally{Nt=f,oa.transition=o}}return!1}function Wp(i,o,f){o=Xo(f,o),o=op(i,o,1),i=rs(i,o,1),o=yn(),i!==null&&(Mn(i,1,o),In(i,o))}function fr(i,o,f){if(i.tag===3)Wp(i,i,f);else for(;o!==null;){if(o.tag===3){Wp(o,i,f);break}else if(o.tag===1){var v=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(as===null||!as.has(v))){i=Xo(f,i),i=lp(o,i,1),o=rs(o,i,1),i=yn(),o!==null&&(Mn(o,1,i),In(o,i));break}}o=o.return}}function o_(i,o,f){var v=i.pingCache;v!==null&&v.delete(o),o=yn(),i.pingedLanes|=i.suspendedLanes&f,zr===i&&(Kr&f)===f&&(Pr===4||Pr===3&&(Kr&130023424)===Kr&&500>Me()-vh?Ks(i,0):gh|=f),In(i,o)}function Hp(i,o){o===0&&((i.mode&1)===0?o=1:(o=Ii,Ii<<=1,(Ii&130023424)===0&&(Ii=4194304)));var f=yn();i=_i(i,o),i!==null&&(Mn(i,o,f),In(i,f))}function l_(i){var o=i.memoizedState,f=0;o!==null&&(f=o.retryLane),Hp(i,f)}function c_(i,o){var f=0;switch(i.tag){case 13:var v=i.stateNode,k=i.memoizedState;k!==null&&(f=k.retryLane);break;case 19:v=i.stateNode;break;default:throw Error(t(314))}v!==null&&v.delete(o),Hp(i,f)}var Vp;Vp=function(i,o,f){if(i!==null)if(i.memoizedProps!==o.pendingProps||Pn.current)Dn=!0;else{if((i.lanes&f)===0&&(o.flags&128)===0)return Dn=!1,Yy(i,o,f);Dn=(i.flags&131072)!==0}else Dn=!1,nr&&(o.flags&1048576)!==0&&Sm(o,Ou,o.index);switch(o.lanes=0,o.tag){case 2:var v=o.type;Zu(i,o),i=o.pendingProps;var k=Wo(o,nn.current);qo(o,f),k=Kf(null,o,v,i,k,f);var T=qf();return o.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Nn(v)?(T=!0,Pu(o)):T=!1,o.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,Uf(o),k.updater=Vu,o.stateNode=k,k._reactInternals=o,th(o,v,i,f),o=ih(null,o,v,!0,T,f)):(o.tag=0,nr&&T&&Df(o),xn(null,o,k,f),o=o.child),o;case 16:v=o.elementType;e:{switch(Zu(i,o),i=o.pendingProps,k=v._init,v=k(v._payload),o.type=v,k=o.tag=d_(v),i=Sa(v,i),k){case 0:o=ah(null,o,v,i,f);break e;case 1:o=vp(null,o,v,i,f);break e;case 11:o=fp(null,o,v,i,f);break e;case 14:o=hp(null,o,v,Sa(v.type,i),f);break e}throw Error(t(306,v,""))}return o;case 0:return v=o.type,k=o.pendingProps,k=o.elementType===v?k:Sa(v,k),ah(i,o,v,k,f);case 1:return v=o.type,k=o.pendingProps,k=o.elementType===v?k:Sa(v,k),vp(i,o,v,k,f);case 3:e:{if(xp(o),i===null)throw Error(t(387));v=o.pendingProps,T=o.memoizedState,k=T.element,Im(i,o),Mu(o,v,null,f);var j=o.memoizedState;if(v=j.element,T.isDehydrated)if(T={element:v,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},o.updateQueue.baseState=T,o.memoizedState=T,o.flags&256){k=Xo(Error(t(423)),o),o=yp(i,o,v,f,k);break e}else if(v!==k){k=Xo(Error(t(424)),o),o=yp(i,o,v,f,k);break e}else for(Gn=Ha(o.stateNode.containerInfo.firstChild),Vn=o,nr=!0,ba=null,f=Dm(o,null,v,f),o.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Go(),v===k){o=ki(i,o,f);break e}xn(i,o,v,f)}o=o.child}return o;case 5:return Rm(o),i===null&&Ff(o),v=o.type,k=o.pendingProps,T=i!==null?i.memoizedProps:null,j=k.children,_t(v,k)?j=null:T!==null&&_t(v,T)&&(o.flags|=32),gp(i,o),xn(i,o,j,f),o.child;case 6:return i===null&&Ff(o),null;case 13:return _p(i,o,f);case 4:return $f(o,o.stateNode.containerInfo),v=o.pendingProps,i===null?o.child=Zo(o,null,v,f):xn(i,o,v,f),o.child;case 11:return v=o.type,k=o.pendingProps,k=o.elementType===v?k:Sa(v,k),fp(i,o,v,k,f);case 7:return xn(i,o,o.pendingProps,f),o.child;case 8:return xn(i,o,o.pendingProps.children,f),o.child;case 12:return xn(i,o,o.pendingProps.children,f),o.child;case 10:e:{if(v=o.type._context,k=o.pendingProps,T=o.memoizedProps,j=k.value,qt(Lu,v._currentValue),v._currentValue=j,T!==null)if(Wn(T.value,j)){if(T.children===k.children&&!Pn.current){o=ki(i,o,f);break e}}else for(T=o.child,T!==null&&(T.return=o);T!==null;){var oe=T.dependencies;if(oe!==null){j=T.child;for(var he=oe.firstContext;he!==null;){if(he.context===v){if(T.tag===1){he=wi(-1,f&-f),he.tag=2;var Pe=T.updateQueue;if(Pe!==null){Pe=Pe.shared;var Le=Pe.pending;Le===null?he.next=he:(he.next=Le.next,Le.next=he),Pe.pending=he}}T.lanes|=f,he=T.alternate,he!==null&&(he.lanes|=f),Bf(T.return,f,o),oe.lanes|=f;break}he=he.next}}else if(T.tag===10)j=T.type===o.type?null:T.child;else if(T.tag===18){if(j=T.return,j===null)throw Error(t(341));j.lanes|=f,oe=j.alternate,oe!==null&&(oe.lanes|=f),Bf(j,f,o),j=T.sibling}else j=T.child;if(j!==null)j.return=T;else for(j=T;j!==null;){if(j===o){j=null;break}if(T=j.sibling,T!==null){T.return=j.return,j=T;break}j=j.return}T=j}xn(i,o,k.children,f),o=o.child}return o;case 9:return k=o.type,v=o.pendingProps.children,qo(o,f),k=ia(k),v=v(k),o.flags|=1,xn(i,o,v,f),o.child;case 14:return v=o.type,k=Sa(v,o.pendingProps),k=Sa(v.type,k),hp(i,o,v,k,f);case 15:return mp(i,o,o.type,o.pendingProps,f);case 17:return v=o.type,k=o.pendingProps,k=o.elementType===v?k:Sa(v,k),Zu(i,o),o.tag=1,Nn(v)?(i=!0,Pu(o)):i=!1,qo(o,f),ip(o,v,k),th(o,v,k,f),ih(null,o,v,!0,i,f);case 19:return kp(i,o,f);case 22:return pp(i,o,f)}throw Error(t(156,o.tag))};function Gp(i,o){return Re(i,o)}function u_(i,o,f,v){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function la(i,o,f,v){return new u_(i,o,f,v)}function Th(i){return i=i.prototype,!(!i||!i.isReactComponent)}function d_(i){if(typeof i=="function")return Th(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Y)return 11;if(i===ee)return 14}return 2}function ls(i,o){var f=i.alternate;return f===null?(f=la(i.tag,o,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=o,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&14680064,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,o=i.dependencies,f.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f}function ad(i,o,f,v,k,T){var j=2;if(v=i,typeof i=="function")Th(i)&&(j=1);else if(typeof i=="string")j=5;else e:switch(i){case N:return Ys(f.children,k,T,o);case q:j=8,k|=8;break;case Z:return i=la(12,f,o,k|2),i.elementType=Z,i.lanes=T,i;case se:return i=la(13,f,o,k),i.elementType=se,i.lanes=T,i;case ve:return i=la(19,f,o,k),i.elementType=ve,i.lanes=T,i;case V:return id(f,k,T,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case me:j=10;break e;case ue:j=9;break e;case Y:j=11;break e;case ee:j=14;break e;case ce:j=16,v=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=la(j,f,o,k),o.elementType=i,o.type=v,o.lanes=T,o}function Ys(i,o,f,v){return i=la(7,i,v,o),i.lanes=f,i}function id(i,o,f,v){return i=la(22,i,v,o),i.elementType=V,i.lanes=f,i.stateNode={isHidden:!1},i}function Eh(i,o,f){return i=la(6,i,null,o),i.lanes=f,i}function Ch(i,o,f){return o=la(4,i.children!==null?i.children:[],i.key,o),o.lanes=f,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function f_(i,o,f,v,k){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fi(0),this.expirationTimes=Fi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fi(0),this.identifierPrefix=v,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function Ah(i,o,f,v,k,T,j,oe,he){return i=new f_(i,o,f,oe,he),o===1?(o=1,T===!0&&(o|=8)):o=0,T=la(3,null,null,o),i.current=T,T.stateNode=i,T.memoizedState={element:v,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uf(T),i}function h_(i,o,f){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:v==null?null:""+v,children:i,containerInfo:o,implementation:f}}function Zp(i){if(!i)return Qi;i=i._reactInternals;e:{if(ae(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Nn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var f=i.type;if(Nn(f))return wm(i,f,o)}return o}function Kp(i,o,f,v,k,T,j,oe,he){return i=Ah(f,v,!0,i,k,T,j,oe,he),i.context=Zp(null),f=i.current,v=yn(),k=ss(f),T=wi(v,k),T.callback=o??null,rs(f,T,k),i.current.lanes=k,Mn(i,k,v),In(i,v),i}function sd(i,o,f,v){var k=o.current,T=yn(),j=ss(k);return f=Zp(f),o.context===null?o.context=f:o.pendingContext=f,o=wi(T,j),o.payload={element:i},v=v===void 0?null:v,v!==null&&(o.callback=v),i=rs(k,o,j),i!==null&&(Ca(i,k,j,T),ju(i,k,j)),j}function od(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function qp(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<o?f:o}}function Ph(i,o){qp(i,o),(i=i.alternate)&&qp(i,o)}function m_(){return null}var Yp=typeof reportError=="function"?reportError:function(i){console.error(i)};function Nh(i){this._internalRoot=i}ld.prototype.render=Nh.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));sd(i,o,null,null)},ld.prototype.unmount=Nh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Zs(function(){sd(null,i,null,null)}),o[Bt]=null}};function ld(i){this._internalRoot=i}ld.prototype.unstable_scheduleHydration=function(i){if(i){var o=bo();i={blockedOn:null,target:i,priority:o};for(var f=0;f<Er.length&&o!==0&&o<Er[f].priority;f++);Er.splice(f,0,i),f===0&&So(i)}};function Dh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function cd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Xp(){}function p_(i,o,f,v,k){if(k){if(typeof v=="function"){var T=v;v=function(){var Pe=od(j);T.call(Pe)}}var j=Kp(o,v,i,0,null,!1,!1,"",Xp);return i._reactRootContainer=j,i[Bt]=j.current,Ki(i.nodeType===8?i.parentNode:i),Zs(),j}for(;k=i.lastChild;)i.removeChild(k);if(typeof v=="function"){var oe=v;v=function(){var Pe=od(he);oe.call(Pe)}}var he=Ah(i,0,!1,null,null,!1,!1,"",Xp);return i._reactRootContainer=he,i[Bt]=he.current,Ki(i.nodeType===8?i.parentNode:i),Zs(function(){sd(o,he,f,v)}),he}function ud(i,o,f,v,k){var T=f._reactRootContainer;if(T){var j=T;if(typeof k=="function"){var oe=k;k=function(){var he=od(j);oe.call(he)}}sd(o,j,i,k)}else j=p_(f,o,i,k,v);return od(j)}wo=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var f=vt(o.pendingLanes);f!==0&&(xa(o,f|1),In(o,Me()),(Ft&6)===0&&(el=Me()+500,es()))}break;case 13:Zs(function(){var v=_i(i,1);if(v!==null){var k=yn();Ca(v,i,1,k)}}),Ph(i,1)}},ii=function(i){if(i.tag===13){var o=_i(i,134217728);if(o!==null){var f=yn();Ca(o,i,134217728,f)}Ph(i,134217728)}},ko=function(i){if(i.tag===13){var o=ss(i),f=_i(i,o);if(f!==null){var v=yn();Ca(f,i,o,v)}Ph(i,o)}},bo=function(){return Nt},As=function(i,o){var f=Nt;try{return Nt=i,o()}finally{Nt=f}},Ie=function(i,o,f){switch(o){case"input":if(Ue(i,f),o=f.name,f.type==="radio"&&o!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<f.length;o++){var v=f[o];if(v!==i&&v.form===i.form){var k=Uo(v);if(!k)throw Error(t(90));te(v),Ue(v,k)}}}break;case"textarea":pr(i,f);break;case"select":o=f.value,o!=null&&Zt(i,!!f.multiple,o,!1)}},ht=kh,nt=Zs;var g_={usingClientEntryPoint:!1,Events:[pi,gi,Uo,Qe,gt,kh]},gc={findFiberByHostInstance:mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},v_={bundleType:gc.bundleType,version:gc.version,rendererPackageName:gc.rendererPackageName,rendererConfig:gc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Te(i),i===null?null:i.stateNode},findFiberByHostInstance:gc.findFiberByHostInstance||m_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dd.isDisabled&&dd.supportsFiber)try{jn=dd.inject(v_),vr=dd}catch{}}return Fn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g_,Fn.createPortal=function(i,o){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dh(o))throw Error(t(200));return h_(i,o,null,f)},Fn.createRoot=function(i,o){if(!Dh(i))throw Error(t(299));var f=!1,v="",k=Yp;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onRecoverableError!==void 0&&(k=o.onRecoverableError)),o=Ah(i,1,!1,null,null,f,!1,v,k),i[Bt]=o.current,Ki(i.nodeType===8?i.parentNode:i),new Nh(o)},Fn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Te(o),i=i===null?null:i.stateNode,i},Fn.flushSync=function(i){return Zs(i)},Fn.hydrate=function(i,o,f){if(!cd(o))throw Error(t(200));return ud(null,i,o,!0,f)},Fn.hydrateRoot=function(i,o,f){if(!Dh(i))throw Error(t(405));var v=f!=null&&f.hydratedSources||null,k=!1,T="",j=Yp;if(f!=null&&(f.unstable_strictMode===!0&&(k=!0),f.identifierPrefix!==void 0&&(T=f.identifierPrefix),f.onRecoverableError!==void 0&&(j=f.onRecoverableError)),o=Kp(o,null,i,1,f??null,k,!1,T,j),i[Bt]=o.current,Ki(i),v)for(i=0;i<v.length;i++)f=v[i],k=f._getVersion,k=k(f._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[f,k]:o.mutableSourceEagerHydrationData.push(f,k);return new ld(o)},Fn.render=function(i,o,f){if(!cd(o))throw Error(t(200));return ud(null,i,o,!1,f)},Fn.unmountComponentAtNode=function(i){if(!cd(i))throw Error(t(40));return i._reactRootContainer?(Zs(function(){ud(null,null,i,!1,function(){i._reactRootContainer=null,i[Bt]=null})}),!0):!1},Fn.unstable_batchedUpdates=kh,Fn.unstable_renderSubtreeIntoContainer=function(i,o,f,v){if(!cd(f))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return ud(i,o,f,!1,v)},Fn.version="18.3.1-next-f1338f8080-20240426",Fn}var ig;function nx(){if(ig)return Fh.exports;ig=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r){console.error(r)}}return e(),Fh.exports=T_(),Fh.exports}var sg;function E_(){if(sg)return fd;sg=1;var e=nx();return fd.createRoot=e.createRoot,fd.hydrateRoot=e.hydrateRoot,fd}var C_=E_();const A_=tf(C_);var J=F0();const Tr=tf(J);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ax=1252,P_=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],L0={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},R0=function(e){P_.indexOf(e)!=-1&&(ax=L0[0]=e)};function N_(){R0(1252)}var Fa=function(e){R0(e)};function ix(){Fa(1200),N_()}function og(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function D_(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function sx(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var wc=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return r==255&&t==254?D_(e.slice(2)):r==254&&t==255?sx(e.slice(2)):r==65279?e.slice(1):e},hd=function(r){return String.fromCharCode(r)},lg=function(r){return String.fromCharCode(r)},Bc,ys="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function cg(e){for(var r="",t=0,n=0,a=0,l=0,c=0,d=0,m=0,g=0;g<e.length;)t=e.charCodeAt(g++),l=t>>2,n=e.charCodeAt(g++),c=(t&3)<<4|n>>4,a=e.charCodeAt(g++),d=(n&15)<<2|a>>6,m=a&63,isNaN(n)?d=m=64:isNaN(a)&&(m=64),r+=ys.charAt(l)+ys.charAt(c)+ys.charAt(d)+ys.charAt(m);return r}function Yn(e){var r="",t=0,n=0,a=0,l=0,c=0,d=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var g=0;g<e.length;)l=ys.indexOf(e.charAt(g++)),c=ys.indexOf(e.charAt(g++)),t=l<<2|c>>4,r+=String.fromCharCode(t),d=ys.indexOf(e.charAt(g++)),n=(c&15)<<4|d>>2,d!==64&&(r+=String.fromCharCode(n)),m=ys.indexOf(e.charAt(g++)),a=(d&3)<<6|m,m!==64&&(r+=String.fromCharCode(a));return r}var Dt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),fo=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})();function ks(e){return Dt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ug(e){return Dt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ia=function(r){return Dt?fo(r,"binary"):r.split("").map(function(t){return t.charCodeAt(0)&255})};function ho(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function j0(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return j0(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var vs=Dt?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:fo(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),a=0;for(r=0,t=0;r<e.length;t+=a,++r)if(a=e[r].length,e[r]instanceof Uint8Array)n.set(e[r],t);else{if(typeof e[r]=="string")throw"wtf";n.set(new Uint8Array(e[r]),t)}return n}return[].concat.apply([],e.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function O_(e){for(var r=[],t=0,n=e.length+250,a=ks(e.length+255),l=0;l<e.length;++l){var c=e.charCodeAt(l);if(c<128)a[t++]=c;else if(c<2048)a[t++]=192|c>>6&31,a[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var d=e.charCodeAt(++l)&1023;a[t++]=240|c>>8&7,a[t++]=128|c>>2&63,a[t++]=128|d>>6&15|(c&3)<<4,a[t++]=128|d&63}else a[t++]=224|c>>12&15,a[t++]=128|c>>6&63,a[t++]=128|c&63;t>n&&(r.push(a.slice(0,t)),t=0,a=ks(65535),n=65530)}return r.push(a.slice(0,t)),vs(r)}var Sn=/\u0000/g,kc=/[\u0001-\u0006]/g;function yl(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function La(e,r){var t=""+e;return t.length>=r?t:hr("0",r-t.length)+t}function M0(e,r){var t=""+e;return t.length>=r?t:hr(" ",r-t.length)+t}function zd(e,r){var t=""+e;return t.length>=r?t:t+hr(" ",r-t.length)}function I_(e,r){var t=""+Math.round(e);return t.length>=r?t:hr("0",r-t.length)+t}function F_(e,r){var t=""+e;return t.length>=r?t:hr("0",r-t.length)+t}var dg=Math.pow(2,32);function rl(e,r){if(e>dg||e<-dg)return I_(e,r);var t=Math.round(e);return F_(t,r)}function Ud(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var fg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],jh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function L_(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},hg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},R_={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $d(e,r,t){for(var n=e<0?-1:1,a=e*n,l=0,c=1,d=0,m=1,g=0,x=0,_=Math.floor(a);g<r&&(_=Math.floor(a),d=_*c+l,x=_*g+m,!(a-_<5e-8));)a=1/(a-_),l=c,c=d,m=g,g=x;if(x>r&&(g>r?(x=m,d=l):(x=g,d=c)),!t)return[0,n*d,x];var y=Math.floor(n*d/x);return[y,n*d-y*x,x]}function ao(e,r,t){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),l=0,c=[],d={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(n+=1462),d.u>.9999&&(d.u=0,++a==86400&&(d.T=a=0,++n,++d.D)),n===60)c=t?[1317,10,29]:[1900,2,29],l=3;else if(n===0)c=t?[1317,8,29]:[1900,1,0],l=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),c=[m.getFullYear(),m.getMonth()+1,m.getDate()],l=m.getDay(),n<60&&(l=(l+6)%7),t&&(l=$_(m,c))}return d.y=c[0],d.m=c[1],d.d=c[2],d.S=a%60,a=Math.floor(a/60),d.M=a%60,a=Math.floor(a/60),d.H=a,d.q=l,d}var ox=new Date(1899,11,31,0,0,0),j_=ox.getTime(),M_=new Date(1900,2,1,0,0,0);function lx(e,r){var t=e.getTime();return r?t-=1461*24*60*60*1e3:e>=M_&&(t+=1440*60*1e3),(t-(j_+(e.getTimezoneOffset()-ox.getTimezoneOffset())*6e4))/(1440*60*1e3)}function B0(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function B_(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function z_(e){var r=e<0?12:11,t=B0(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10),t.length<=r)?t:e.toExponential(5)}function U_(e){var r=B0(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function zc(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return r>=-4&&r<=-1?t=e.toPrecision(10+r):Math.abs(r)<=9?t=z_(e):r===10?t=e.toFixed(10).substr(0,12):t=U_(e),B0(B_(t.toUpperCase()))}function lo(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return fa(14,lx(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function $_(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function W_(e,r,t,n){var a="",l=0,c=0,d=t.y,m,g=0;switch(e){case 98:d=t.y+543;case 121:switch(r.length){case 1:case 2:m=d%100,g=2;break;default:m=d%1e4,g=4;break}break;case 109:switch(r.length){case 1:case 2:m=t.m,g=r.length;break;case 3:return jh[t.m-1][1];case 5:return jh[t.m-1][0];default:return jh[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:m=t.d,g=r.length;break;case 3:return fg[t.q][0];default:return fg[t.q][1]}break;case 104:switch(r.length){case 1:case 2:m=1+(t.H+11)%12,g=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:m=t.H,g=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:m=t.M,g=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return t.u===0&&(r=="s"||r=="ss")?La(t.S,r.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,l=Math.round(c*(t.S+t.u)),l>=60*c&&(l=0),r==="s"?l===0?"0":""+l/c:(a=La(l,2+n),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":m=t.D*24+t.H;break;case"[m]":case"[mm]":m=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":m=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}g=r.length===3?1:2;break;case 101:m=d,g=1;break}var x=g>0?La(m,g):"";return x}function _s(e){var r=3;if(e.length<=r)return e;for(var t=e.length%r,n=e.substr(0,t);t!=e.length;t+=r)n+=(n.length>0?",":"")+e.substr(t,r);return n}var cx=/%/g;function H_(e,r,t){var n=r.replace(cx,""),a=r.length-n.length;return Ai(e,n,t*Math.pow(10,2*a))+hr("%",a)}function V_(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Ai(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function ux(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+ux(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%a;if(l<0&&(l+=a),t=(r/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),t.indexOf("e")===-1){var c=Math.floor(Math.log(r)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,a)+"."+t.substr(2+a),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,g,x){return m+g+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var dx=/# (\?+)( ?)\/( ?)(\d+)/;function G_(e,r,t){var n=parseInt(e[4],10),a=Math.round(r*n),l=Math.floor(a/n),c=a-l*n,d=n;return t+(l===0?"":""+l)+" "+(c===0?hr(" ",e[1].length+1+e[4].length):M0(c,e[1].length)+e[2]+"/"+e[3]+La(d,e[4].length))}function Z_(e,r,t){return t+(r===0?"":""+r)+hr(" ",e[1].length+2+e[4].length)}var fx=/^#*0*\.([0#]+)/,hx=/\).*[0#]/,mx=/\(###\) ###\\?-####/;function wn(e){for(var r="",t,n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function mg(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function pg(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function K_(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function q_(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ua(e,r,t){if(e.charCodeAt(0)===40&&!r.match(hx)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ua("n",n,t):"("+ua("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return V_(e,r,t);if(r.indexOf("%")!==-1)return H_(e,r,t);if(r.indexOf("E")!==-1)return ux(r,t);if(r.charCodeAt(0)===36)return"$"+ua(e,r.substr(r.charAt(1)==" "?2:1),t);var a,l,c,d,m=Math.abs(t),g=t<0?"-":"";if(r.match(/^00+$/))return g+rl(m,r.length);if(r.match(/^[#?]+$/))return a=rl(t,0),a==="0"&&(a=""),a.length>r.length?a:wn(r.substr(0,r.length-a.length))+a;if(l=r.match(dx))return G_(l,m,g);if(r.match(/^#+0+$/))return g+rl(m,r.length-r.indexOf("0"));if(l=r.match(fx))return a=mg(t,l[1].length).replace(/^([^\.]+)$/,"$1."+wn(l[1])).replace(/\.$/,"."+wn(l[1])).replace(/\.(\d*)$/,function(C,b){return"."+b+hr("0",wn(l[1]).length-b.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return g+mg(m,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return g+_s(rl(m,0));if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ua(e,r,-t):_s(""+(Math.floor(t)+K_(t,l[1].length)))+"."+La(pg(t,l[1].length),l[1].length);if(l=r.match(/^#,#*,#0/))return ua(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=yl(ua(e,r.replace(/[\\-]/g,""),t)),c=0,yl(yl(r.replace(/\\/g,"")).replace(/[0#]/g,function(C){return c<a.length?a.charAt(c++):C==="0"?"0":""}));if(r.match(mx))return a=ua(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),d=$d(m,Math.pow(10,c)-1,!1),a=""+g,x=Ai("n",l[1],d[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=zd(d[2],c),x.length<l[4].length&&(x=wn(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),d=$d(m,Math.pow(10,c)-1,!0),g+(d[0]||(d[1]?"":"0"))+" "+(d[1]?M0(d[1],c)+l[2]+"/"+l[3]+zd(d[2],c):hr(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return a=rl(t,0),r.length<=a.length?a:wn(r.substr(0,r.length-a.length))+a;if(l=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var _=r.indexOf(".")-c,y=r.length-a.length-_;return wn(r.substr(0,_)+a+r.substr(r.length-y))}if(l=r.match(/^00,000\.([#0]*0)$/))return c=pg(t,l[1].length),t<0?"-"+ua(e,r,-t):_s(q_(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?La(0,3-C.length):"")+C})+"."+La(c,l[1].length);switch(r){case"###,##0.00":return ua(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var S=_s(rl(m,0));return S!=="0"?g+S:"";case"###,###.00":return ua(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return ua(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function Y_(e,r,t){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return Ai(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}function X_(e,r,t){var n=r.replace(cx,""),a=r.length-n.length;return Ai(e,n,t*Math.pow(10,2*a))+hr("%",a)}function px(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+px(e,-r);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var l=Math.floor(Math.log(r)*Math.LOG10E)%a;if(l<0&&(l+=a),t=(r/Math.pow(10,l)).toPrecision(n+1+(a+l)%a),!t.match(/[Ee]/)){var c=Math.floor(Math.log(r)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,g,x){return m+g+x.substr(0,(a+l)%a)+"."+x.substr(l)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function qa(e,r,t){if(e.charCodeAt(0)===40&&!r.match(hx)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?qa("n",n,t):"("+qa("n",n,-t)+")"}if(r.charCodeAt(r.length-1)===44)return Y_(e,r,t);if(r.indexOf("%")!==-1)return X_(e,r,t);if(r.indexOf("E")!==-1)return px(r,t);if(r.charCodeAt(0)===36)return"$"+qa(e,r.substr(r.charAt(1)==" "?2:1),t);var a,l,c,d,m=Math.abs(t),g=t<0?"-":"";if(r.match(/^00+$/))return g+La(m,r.length);if(r.match(/^[#?]+$/))return a=""+t,t===0&&(a=""),a.length>r.length?a:wn(r.substr(0,r.length-a.length))+a;if(l=r.match(dx))return Z_(l,m,g);if(r.match(/^#+0+$/))return g+La(m,r.length-r.indexOf("0"));if(l=r.match(fx))return a=(""+t).replace(/^([^\.]+)$/,"$1."+wn(l[1])).replace(/\.$/,"."+wn(l[1])),a=a.replace(/\.(\d*)$/,function(C,b){return"."+b+hr("0",wn(l[1]).length-b.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),l=r.match(/^(0*)\.(#*)$/))return g+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=r.match(/^#{1,3},##0(\.?)$/))return g+_s(""+m);if(l=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+qa(e,r,-t):_s(""+t)+"."+hr("0",l[1].length);if(l=r.match(/^#,#*,#0/))return qa(e,r.replace(/^#,#*,/,""),t);if(l=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=yl(qa(e,r.replace(/[\\-]/g,""),t)),c=0,yl(yl(r.replace(/\\/g,"")).replace(/[0#]/g,function(C){return c<a.length?a.charAt(c++):C==="0"?"0":""}));if(r.match(mx))return a=qa(e,"##########",t),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var x="";if(l=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),d=$d(m,Math.pow(10,c)-1,!1),a=""+g,x=Ai("n",l[1],d[1]),x.charAt(x.length-1)==" "&&(x=x.substr(0,x.length-1)+"0"),a+=x+l[2]+"/"+l[3],x=zd(d[2],c),x.length<l[4].length&&(x=wn(l[4].substr(l[4].length-x.length))+x),a+=x,a;if(l=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),d=$d(m,Math.pow(10,c)-1,!0),g+(d[0]||(d[1]?"":"0"))+" "+(d[1]?M0(d[1],c)+l[2]+"/"+l[3]+zd(d[2],c):hr(" ",2*c+1+l[2].length+l[3].length));if(l=r.match(/^[#0?]+$/))return a=""+t,r.length<=a.length?a:wn(r.substr(0,r.length-a.length))+a;if(l=r.match(/^([#0]+)\.([#0]+)$/)){a=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=a.indexOf(".");var _=r.indexOf(".")-c,y=r.length-a.length-_;return wn(r.substr(0,_)+a+r.substr(r.length-y))}if(l=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+qa(e,r,-t):_s(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?La(0,3-C.length):"")+C})+"."+La(0,l[1].length);switch(r){case"###,###":case"##,###":case"#,###":var S=_s(""+m);return S!=="0"?g+S:"";default:if(r.match(/\.[0#?]*$/))return qa(e,r.slice(0,r.lastIndexOf(".")),t)+wn(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Ai(e,r,t){return(t|0)===t?qa(e,r,t):ua(e,r,t)}function J_(e){for(var r=[],t=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(a,n-a),a=n+1}if(r[r.length]=e.substr(a),t===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var gx=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Cl(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":Ud(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(n=t;e.charAt(r++)!=="]"&&r<e.length;)n+=e.charAt(r);if(n.match(gx))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||t=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function Q_(e,r,t,n){for(var a=[],l="",c=0,d="",m="t",g,x,_,y="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!Ud(e,c))throw new Error("unrecognized character "+d+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(_=e.charCodeAt(++c))!==34&&c<e.length;)l+=String.fromCharCode(_);a[a.length]={t:"t",v:l},++c;break;case"\\":var S=e.charAt(++c),C=S==="("||S===")"?S:"t";a[a.length]={t:C,v:S},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:r},++c;break;case"B":case"b":if(e.charAt(c+1)==="1"||e.charAt(c+1)==="2"){if(g==null&&(g=ao(r,t,e.charAt(c+1)==="2"),g==null))return"";a[a.length]={t:"X",v:e.substr(c,2)},m=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||g==null&&(g=ao(r,t),g==null))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;d==="m"&&m.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=y),a[a.length]={t:d,v:l},m=d;break;case"A":case"a":case"":var b={t:d,v:d};if(g==null&&(g=ao(r,t)),e.substr(c,3).toUpperCase()==="A/P"?(g!=null&&(b.v=g.H>=12?"P":"A"),b.t="T",y="h",c+=3):e.substr(c,5).toUpperCase()==="AM/PM"?(g!=null&&(b.v=g.H>=12?"PM":"AM"),b.t="T",c+=5,y="h"):e.substr(c,5).toUpperCase()==="/"?(g!=null&&(b.v=g.H>=12?"":""),b.t="T",c+=5,y="h"):(b.t="t",++c),g==null&&b.t==="T")return"";a[a.length]=b,m=d;break;case"[":for(l=d;e.charAt(c++)!=="]"&&c<e.length;)l+=e.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(gx)){if(g==null&&(g=ao(r,t),g==null))return"";a[a.length]={t:"Z",v:l.toLowerCase()},m=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Cl(e)||(a[a.length]={t:"t",v:l}));break;case".":if(g!=null){for(l=d;++c<e.length&&(d=e.charAt(c))==="0";)l+=d;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;a[a.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;a[a.length]={t:d,v:l},m=d;break;case"*":++c,(e.charAt(c)==" "||e.charAt(c)=="*")&&++c;break;case"(":case")":a[a.length]={t:n===1?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:d,v:d},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);a[a.length]={t:"t",v:d},++c;break}var E=0,D=0,F;for(c=a.length-1,m="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=y,m="h",E<1&&(E=1);break;case"s":(F=a[c].v.match(/\.0+$/))&&(D=Math.max(D,F[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":m=a[c].t;break;case"m":m==="s"&&(a[c].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[c].v.match(/[Hh]/)&&(E=1),E<2&&a[c].v.match(/[Mm]/)&&(E=2),E<3&&a[c].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M),g.M>=60&&(g.M=0,++g.H);break;case 2:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M);break}var O="",M;for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=W_(a[c].t.charCodeAt(0),a[c].v,g,D),a[c].t="t";break;case"n":case"?":for(M=c+1;a[M]!=null&&((d=a[M].t)==="?"||d==="D"||(d===" "||d==="t")&&a[M+1]!=null&&(a[M+1].t==="?"||a[M+1].t==="t"&&a[M+1].v==="/")||a[c].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(a[M].v==="/"||a[M].v===" "&&a[M+1]!=null&&a[M+1].t=="?"));)a[c].v+=a[M].v,a[M]={v:"",t:";"},++M;O+=a[c].v,c=M-1;break;case"G":a[c].t="t",a[c].v=lo(r,t);break}var G="",I,N;if(O.length>0){O.charCodeAt(0)==40?(I=r<0&&O.charCodeAt(0)===45?-r:r,N=Ai("n",O,I)):(I=r<0&&n>1?-r:r,N=Ai("n",O,I),I<0&&a[0]&&a[0].t=="t"&&(N=N.substr(1),a[0].v="-"+a[0].v)),M=N.length-1;var q=a.length;for(c=0;c<a.length;++c)if(a[c]!=null&&a[c].t!="t"&&a[c].v.indexOf(".")>-1){q=c;break}var Z=a.length;if(q===a.length&&N.indexOf("E")===-1){for(c=a.length-1;c>=0;--c)a[c]==null||"n?".indexOf(a[c].t)===-1||(M>=a[c].v.length-1?(M-=a[c].v.length,a[c].v=N.substr(M+1,a[c].v.length)):M<0?a[c].v="":(a[c].v=N.substr(0,M+1),M=-1),a[c].t="t",Z=c);M>=0&&Z<a.length&&(a[Z].v=N.substr(0,M+1)+a[Z].v)}else if(q!==a.length&&N.indexOf("E")===-1){for(M=N.indexOf(".")-1,c=q;c>=0;--c)if(!(a[c]==null||"n?".indexOf(a[c].t)===-1)){for(x=a[c].v.indexOf(".")>-1&&c===q?a[c].v.indexOf(".")-1:a[c].v.length-1,G=a[c].v.substr(x+1);x>=0;--x)M>=0&&(a[c].v.charAt(x)==="0"||a[c].v.charAt(x)==="#")&&(G=N.charAt(M--)+G);a[c].v=G,a[c].t="t",Z=c}for(M>=0&&Z<a.length&&(a[Z].v=N.substr(0,M+1)+a[Z].v),M=N.indexOf(".")+1,c=q;c<a.length;++c)if(!(a[c]==null||"n?(".indexOf(a[c].t)===-1&&c!==q)){for(x=a[c].v.indexOf(".")>-1&&c===q?a[c].v.indexOf(".")+1:0,G=a[c].v.substr(0,x);x<a[c].v.length;++x)M<N.length&&(G+=N.charAt(M++));a[c].v=G,a[c].t="t",Z=c}}}for(c=0;c<a.length;++c)a[c]!=null&&"n?".indexOf(a[c].t)>-1&&(I=n>1&&r<0&&c>0&&a[c-1].v==="-"?-r:r,a[c].v=Ai(a[c].t,a[c].v,I),a[c].t="t");var me="";for(c=0;c!==a.length;++c)a[c]!=null&&(me+=a[c].v);return me}var gg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vg(e,r){if(r==null)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function ew(e,r){var t=J_(e),n=t.length,a=t[n-1].indexOf("@");if(n<4&&a>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof r!="number")return[4,t.length===4||a>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=a>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=a>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=a>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=r>0?t[0]:r<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[n,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(gg),d=t[1].match(gg);return vg(r,c)?[n,t[0]]:vg(r,d)?[n,t[1]]:[n,t[c!=null&&d!=null?2:1]]}return[n,l]}function fa(e,r,t){t==null&&(t={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?n=t.dateNF:n=e;break;case"number":e==14&&t.dateNF?n=t.dateNF:n=(t.table!=null?t.table:kt)[e],n==null&&(n=t.table&&t.table[hg[e]]||kt[hg[e]]),n==null&&(n=R_[e]||"General");break}if(Ud(n,0))return lo(r,t);r instanceof Date&&(r=lx(r,t.date1904));var a=ew(n,r);if(Ud(a[1]))return lo(r,t);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return Q_(a[1],r,t,a[0])}function io(e,r){if(typeof r!="number"){r=+r||-1;for(var t=0;t<392;++t){if(kt[t]==null){r<0&&(r=t);continue}if(kt[t]==e){r=t;break}}r<0&&(r=391)}return kt[r]=e,r}function vx(){kt=L_()}var tw={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},xx=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function rw(e){var r=typeof e=="number"?kt[e]:e;return r=r.replace(xx,"(\\d+)"),new RegExp("^"+r+"$")}function nw(e,r,t){var n=-1,a=-1,l=-1,c=-1,d=-1,m=-1;(r.match(xx)||[]).forEach(function(_,y){var S=parseInt(t[y+1],10);switch(_.toLowerCase().charAt(0)){case"y":n=S;break;case"d":l=S;break;case"h":c=S;break;case"s":m=S;break;case"m":c>=0?d=S:a=S;break}}),m>=0&&d==-1&&a>=0&&(d=a,a=-1);var g=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);g.length==7&&(g="0"+g),g.length==8&&(g="20"+g);var x=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return c==-1&&d==-1&&m==-1?g:n==-1&&a==-1&&l==-1?x:g+"T"+x}var aw=(function(){var e={};e.version="1.2.0";function r(){for(var N=0,q=new Array(256),Z=0;Z!=256;++Z)N=Z,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,q[Z]=N;return typeof Int32Array<"u"?new Int32Array(q):q}var t=r();function n(N){var q=0,Z=0,me=0,ue=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(me=0;me!=256;++me)ue[me]=N[me];for(me=0;me!=256;++me)for(Z=N[me],q=256+me;q<4096;q+=256)Z=ue[q]=Z>>>8^N[Z&255];var Y=[];for(me=1;me!=16;++me)Y[me-1]=typeof Int32Array<"u"?ue.subarray(me*256,me*256+256):ue.slice(me*256,me*256+256);return Y}var a=n(t),l=a[0],c=a[1],d=a[2],m=a[3],g=a[4],x=a[5],_=a[6],y=a[7],S=a[8],C=a[9],b=a[10],E=a[11],D=a[12],F=a[13],O=a[14];function M(N,q){for(var Z=q^-1,me=0,ue=N.length;me<ue;)Z=Z>>>8^t[(Z^N.charCodeAt(me++))&255];return~Z}function G(N,q){for(var Z=q^-1,me=N.length-15,ue=0;ue<me;)Z=O[N[ue++]^Z&255]^F[N[ue++]^Z>>8&255]^D[N[ue++]^Z>>16&255]^E[N[ue++]^Z>>>24]^b[N[ue++]]^C[N[ue++]]^S[N[ue++]]^y[N[ue++]]^_[N[ue++]]^x[N[ue++]]^g[N[ue++]]^m[N[ue++]]^d[N[ue++]]^c[N[ue++]]^l[N[ue++]]^t[N[ue++]];for(me+=15;ue<me;)Z=Z>>>8^t[(Z^N[ue++])&255];return~Z}function I(N,q){for(var Z=q^-1,me=0,ue=N.length,Y=0,se=0;me<ue;)Y=N.charCodeAt(me++),Y<128?Z=Z>>>8^t[(Z^Y)&255]:Y<2048?(Z=Z>>>8^t[(Z^(192|Y>>6&31))&255],Z=Z>>>8^t[(Z^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,se=N.charCodeAt(me++)&1023,Z=Z>>>8^t[(Z^(240|Y>>8&7))&255],Z=Z>>>8^t[(Z^(128|Y>>2&63))&255],Z=Z>>>8^t[(Z^(128|se>>6&15|(Y&3)<<4))&255],Z=Z>>>8^t[(Z^(128|se&63))&255]):(Z=Z>>>8^t[(Z^(224|Y>>12&15))&255],Z=Z>>>8^t[(Z^(128|Y>>6&63))&255],Z=Z>>>8^t[(Z^(128|Y&63))&255]);return~Z}return e.table=t,e.bstr=M,e.buf=G,e.str=I,e})(),Ot=(function(){var r={};r.version="1.2.1";function t(B,re){for(var K=B.split("/"),X=re.split("/"),ne=0,ae=0,we=Math.min(K.length,X.length);ne<we;++ne){if(ae=K[ne].length-X[ne].length)return ae;if(K[ne]!=X[ne])return K[ne]<X[ne]?-1:1}return K.length-X.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var re=B.lastIndexOf("/");return re===-1?B:B.slice(0,re+1)}function a(B){if(B.charAt(B.length-1)=="/")return a(B.slice(0,-1));var re=B.lastIndexOf("/");return re===-1?B:B.slice(re+1)}function l(B,re){typeof re=="string"&&(re=new Date(re));var K=re.getHours();K=K<<6|re.getMinutes(),K=K<<5|re.getSeconds()>>>1,B.write_shift(2,K);var X=re.getFullYear()-1980;X=X<<4|re.getMonth()+1,X=X<<5|re.getDate(),B.write_shift(2,X)}function c(B){var re=B.read_shift(2)&65535,K=B.read_shift(2)&65535,X=new Date,ne=K&31;K>>>=5;var ae=K&15;K>>>=4,X.setMilliseconds(0),X.setFullYear(K+1980),X.setMonth(ae-1),X.setDate(ne);var we=re&31;re>>>=5;var De=re&63;return re>>>=6,X.setHours(re),X.setMinutes(De),X.setSeconds(we<<1),X}function d(B){qr(B,0);for(var re={},K=0;B.l<=B.length-4;){var X=B.read_shift(2),ne=B.read_shift(2),ae=B.l+ne,we={};switch(X){case 21589:K=B.read_shift(1),K&1&&(we.mtime=B.read_shift(4)),ne>5&&(K&2&&(we.atime=B.read_shift(4)),K&4&&(we.ctime=B.read_shift(4))),we.mtime&&(we.mt=new Date(we.mtime*1e3));break}B.l=ae,re[X]=we}return re}var m;function g(){return m||(m={})}function x(B,re){if(B[0]==80&&B[1]==75)return Ie(B,re);if((B[0]|32)==109&&(B[1]|32)==105)return sr(B,re);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,X=512,ne=0,ae=0,we=0,De=0,be=0,Te=[],Ee=B.slice(0,512);qr(Ee,0);var Re=_(Ee);switch(K=Re[0],K){case 3:X=512;break;case 4:X=4096;break;case 0:if(Re[1]==0)return Ie(B,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}X!==512&&(Ee=B.slice(0,X),qr(Ee,28));var We=B.slice(0,X);y(Ee,K);var Ze=Ee.read_shift(4,"i");if(K===3&&Ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ze);Ee.l+=4,we=Ee.read_shift(4,"i"),Ee.l+=4,Ee.chk("00100000","Mini Stream Cutoff Size: "),De=Ee.read_shift(4,"i"),ne=Ee.read_shift(4,"i"),be=Ee.read_shift(4,"i"),ae=Ee.read_shift(4,"i");for(var Be=-1,Me=0;Me<109&&(Be=Ee.read_shift(4,"i"),!(Be<0));++Me)Te[Me]=Be;var mt=S(B,X);E(be,ae,mt,X,Te);var zt=F(mt,we,Te,X);zt[we].name="!Directory",ne>0&&De!==se&&(zt[De].name="!MiniFAT"),zt[Te[0]].name="!FAT",zt.fat_addrs=Te,zt.ssz=X;var $t={},or=[],pa=[],En=[];O(we,zt,mt,or,ne,$t,pa,De),C(pa,En,or),or.shift();var jn={FileIndex:pa,FullPaths:En};return re&&re.raw&&(jn.raw={header:We,sectors:mt}),jn}function _(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(ve,"Header Signature: "),B.l+=16;var re=B.read_shift(2,"u");return[B.read_shift(2,"u"),re]}function y(B,re){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function S(B,re){for(var K=Math.ceil(B.length/re)-1,X=[],ne=1;ne<K;++ne)X[ne-1]=B.slice(ne*re,(ne+1)*re);return X[K-1]=B.slice(K*re),X}function C(B,re,K){for(var X=0,ne=0,ae=0,we=0,De=0,be=K.length,Te=[],Ee=[];X<be;++X)Te[X]=Ee[X]=X,re[X]=K[X];for(;De<Ee.length;++De)X=Ee[De],ne=B[X].L,ae=B[X].R,we=B[X].C,Te[X]===X&&(ne!==-1&&Te[ne]!==ne&&(Te[X]=Te[ne]),ae!==-1&&Te[ae]!==ae&&(Te[X]=Te[ae])),we!==-1&&(Te[we]=X),ne!==-1&&X!=Te[X]&&(Te[ne]=Te[X],Ee.lastIndexOf(ne)<De&&Ee.push(ne)),ae!==-1&&X!=Te[X]&&(Te[ae]=Te[X],Ee.lastIndexOf(ae)<De&&Ee.push(ae));for(X=1;X<be;++X)Te[X]===X&&(ae!==-1&&Te[ae]!==ae?Te[X]=Te[ae]:ne!==-1&&Te[ne]!==ne&&(Te[X]=Te[ne]));for(X=1;X<be;++X)if(B[X].type!==0){if(De=X,De!=Te[De])do De=Te[De],re[X]=re[De]+"/"+re[X];while(De!==0&&Te[De]!==-1&&De!=Te[De]);Te[X]=-1}for(re[0]+="/",X=1;X<be;++X)B[X].type!==2&&(re[X]+="/")}function b(B,re,K){for(var X=B.start,ne=B.size,ae=[],we=X;K&&ne>0&&we>=0;)ae.push(re.slice(we*Y,we*Y+Y)),ne-=Y,we=ro(K,we*4);return ae.length===0?Or(0):vs(ae).slice(0,B.size)}function E(B,re,K,X,ne){var ae=se;if(B===se){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var we=K[B],De=(X>>>2)-1;if(!we)return;for(var be=0;be<De&&(ae=ro(we,be*4))!==se;++be)ne.push(ae);E(ro(we,X-4),re-1,K,X,ne)}}function D(B,re,K,X,ne){var ae=[],we=[];ne||(ne=[]);var De=X-1,be=0,Te=0;for(be=re;be>=0;){ne[be]=!0,ae[ae.length]=be,we.push(B[be]);var Ee=K[Math.floor(be*4/X)];if(Te=be*4&De,X<4+Te)throw new Error("FAT boundary crossed: "+be+" 4 "+X);if(!B[Ee])break;be=ro(B[Ee],Te)}return{nodes:ae,data:Cg([we])}}function F(B,re,K,X){var ne=B.length,ae=[],we=[],De=[],be=[],Te=X-1,Ee=0,Re=0,We=0,Ze=0;for(Ee=0;Ee<ne;++Ee)if(De=[],We=Ee+re,We>=ne&&(We-=ne),!we[We]){be=[];var Be=[];for(Re=We;Re>=0;){Be[Re]=!0,we[Re]=!0,De[De.length]=Re,be.push(B[Re]);var Me=K[Math.floor(Re*4/X)];if(Ze=Re*4&Te,X<4+Ze)throw new Error("FAT boundary crossed: "+Re+" 4 "+X);if(!B[Me]||(Re=ro(B[Me],Ze),Be[Re]))break}ae[We]={nodes:De,data:Cg([be])}}return ae}function O(B,re,K,X,ne,ae,we,De){for(var be=0,Te=X.length?2:0,Ee=re[B].data,Re=0,We=0,Ze;Re<Ee.length;Re+=128){var Be=Ee.slice(Re,Re+128);qr(Be,64),We=Be.read_shift(2),Ze=H0(Be,0,We-Te),X.push(Ze);var Me={name:Ze,type:Be.read_shift(1),color:Be.read_shift(1),L:Be.read_shift(4,"i"),R:Be.read_shift(4,"i"),C:Be.read_shift(4,"i"),clsid:Be.read_shift(16),state:Be.read_shift(4,"i"),start:0,size:0},mt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);mt!==0&&(Me.ct=M(Be,Be.l-8));var zt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);zt!==0&&(Me.mt=M(Be,Be.l-8)),Me.start=Be.read_shift(4,"i"),Me.size=Be.read_shift(4,"i"),Me.size<0&&Me.start<0&&(Me.size=Me.type=0,Me.start=se,Me.name=""),Me.type===5?(be=Me.start,ne>0&&be!==se&&(re[be].name="!StreamData")):Me.size>=4096?(Me.storage="fat",re[Me.start]===void 0&&(re[Me.start]=D(K,Me.start,re.fat_addrs,re.ssz)),re[Me.start].name=Me.name,Me.content=re[Me.start].data.slice(0,Me.size)):(Me.storage="minifat",Me.size<0?Me.size=0:be!==se&&Me.start!==se&&re[be]&&(Me.content=b(Me,re[be].data,(re[De]||{}).data))),Me.content&&qr(Me.content,0),ae[Ze]=Me,we.push(Me)}}function M(B,re){return new Date((Kn(B,re+4)/1e7*Math.pow(2,32)+Kn(B,re)/1e7-11644473600)*1e3)}function G(B,re){return g(),x(m.readFileSync(B),re)}function I(B,re){var K=re&&re.type;switch(K||Dt&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return G(B,re);case"base64":return x(Ia(Yn(B)),re);case"binary":return x(Ia(B),re)}return x(B,re)}function N(B,re){var K=re||{},X=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=X+"/",B.FileIndex[0]={name:X,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),q(B)}function q(B){var re="Sh33tJ5";if(!Ot.find(B,"/"+re)){var K=Or(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:re,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+re),Z(B)}}function Z(B,re){N(B);for(var K=!1,X=!1,ne=B.FullPaths.length-1;ne>=0;--ne){var ae=B.FileIndex[ne];switch(ae.type){case 0:X?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(ae.R*ae.L*ae.C)&&(K=!0),ae.R>-1&&ae.L>-1&&ae.R==ae.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!re)){var we=new Date(1987,1,19),De=0,be=Object.create?Object.create(null):{},Te=[];for(ne=0;ne<B.FullPaths.length;++ne)be[B.FullPaths[ne]]=!0,B.FileIndex[ne].type!==0&&Te.push([B.FullPaths[ne],B.FileIndex[ne]]);for(ne=0;ne<Te.length;++ne){var Ee=n(Te[ne][0]);X=be[Ee],X||(Te.push([Ee,{name:a(Ee).replace("/",""),type:1,clsid:ce,ct:we,mt:we,content:null}]),be[Ee]=!0)}for(Te.sort(function(Ze,Be){return t(Ze[0],Be[0])}),B.FullPaths=[],B.FileIndex=[],ne=0;ne<Te.length;++ne)B.FullPaths[ne]=Te[ne][0],B.FileIndex[ne]=Te[ne][1];for(ne=0;ne<Te.length;++ne){var Re=B.FileIndex[ne],We=B.FullPaths[ne];if(Re.name=a(We).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||ce,ne===0)Re.C=Te.length>1?1:-1,Re.size=0,Re.type=5;else if(We.slice(-1)=="/"){for(De=ne+1;De<Te.length&&n(B.FullPaths[De])!=We;++De);for(Re.C=De>=Te.length?-1:De,De=ne+1;De<Te.length&&n(B.FullPaths[De])!=n(We);++De);Re.R=De>=Te.length?-1:De,Re.type=1}else n(B.FullPaths[ne+1]||"")==n(We)&&(Re.R=ne+1),Re.type=2}}}function me(B,re){var K=re||{};if(K.fileType=="mad")return gr(B,K);switch(Z(B),K.fileType){case"zip":return Ge(B,K)}var X=(function(Ze){for(var Be=0,Me=0,mt=0;mt<Ze.FileIndex.length;++mt){var zt=Ze.FileIndex[mt];if(zt.content){var $t=zt.content.length;$t>0&&($t<4096?Be+=$t+63>>6:Me+=$t+511>>9)}}for(var or=Ze.FullPaths.length+3>>2,pa=Be+7>>3,En=Be+127>>7,jn=pa+Me+or+En,vr=jn+127>>7,ga=vr<=109?0:Math.ceil((vr-109)/127);jn+vr+ga+127>>7>vr;)ga=++vr<=109?0:Math.ceil((vr-109)/127);var it=[1,ga,vr,En,or,Me,Be,0];return Ze.FileIndex[0].size=Be<<6,it[7]=(Ze.FileIndex[0].start=it[0]+it[1]+it[2]+it[3]+it[4]+it[5])+(it[6]+7>>3),it})(B),ne=Or(X[7]<<9),ae=0,we=0;{for(ae=0;ae<8;++ae)ne.write_shift(1,ee[ae]);for(ae=0;ae<8;++ae)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),ae=0;ae<3;++ae)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,X[2]),ne.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:se),ne.write_shift(4,X[3]),ne.write_shift(-4,X[1]?X[0]-1:se),ne.write_shift(4,X[1]),ae=0;ae<109;++ae)ne.write_shift(-4,ae<X[2]?X[1]+ae:-1)}if(X[1])for(we=0;we<X[1];++we){for(;ae<236+we*127;++ae)ne.write_shift(-4,ae<X[2]?X[1]+ae:-1);ne.write_shift(-4,we===X[1]-1?se:we+1)}var De=function(Ze){for(we+=Ze;ae<we-1;++ae)ne.write_shift(-4,ae+1);Ze&&(++ae,ne.write_shift(-4,se))};for(we=ae=0,we+=X[1];ae<we;++ae)ne.write_shift(-4,V.DIFSECT);for(we+=X[2];ae<we;++ae)ne.write_shift(-4,V.FATSECT);De(X[3]),De(X[4]);for(var be=0,Te=0,Ee=B.FileIndex[0];be<B.FileIndex.length;++be)Ee=B.FileIndex[be],Ee.content&&(Te=Ee.content.length,!(Te<4096)&&(Ee.start=we,De(Te+511>>9)));for(De(X[6]+7>>3);ne.l&511;)ne.write_shift(-4,V.ENDOFCHAIN);for(we=ae=0,be=0;be<B.FileIndex.length;++be)Ee=B.FileIndex[be],Ee.content&&(Te=Ee.content.length,!(!Te||Te>=4096)&&(Ee.start=we,De(Te+63>>6)));for(;ne.l&511;)ne.write_shift(-4,V.ENDOFCHAIN);for(ae=0;ae<X[4]<<2;++ae){var Re=B.FullPaths[ae];if(!Re||Re.length===0){for(be=0;be<17;++be)ne.write_shift(4,0);for(be=0;be<3;++be)ne.write_shift(4,-1);for(be=0;be<12;++be)ne.write_shift(4,0);continue}Ee=B.FileIndex[ae],ae===0&&(Ee.start=Ee.size?Ee.start-1:se);var We=ae===0&&K.root||Ee.name;if(Te=2*(We.length+1),ne.write_shift(64,We,"utf16le"),ne.write_shift(2,Te),ne.write_shift(1,Ee.type),ne.write_shift(1,Ee.color),ne.write_shift(-4,Ee.L),ne.write_shift(-4,Ee.R),ne.write_shift(-4,Ee.C),Ee.clsid)ne.write_shift(16,Ee.clsid,"hex");else for(be=0;be<4;++be)ne.write_shift(4,0);ne.write_shift(4,Ee.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,Ee.start),ne.write_shift(4,Ee.size),ne.write_shift(4,0)}for(ae=1;ae<B.FileIndex.length;++ae)if(Ee=B.FileIndex[ae],Ee.size>=4096)if(ne.l=Ee.start+1<<9,Dt&&Buffer.isBuffer(Ee.content))Ee.content.copy(ne,ne.l,0,Ee.size),ne.l+=Ee.size+511&-512;else{for(be=0;be<Ee.size;++be)ne.write_shift(1,Ee.content[be]);for(;be&511;++be)ne.write_shift(1,0)}for(ae=1;ae<B.FileIndex.length;++ae)if(Ee=B.FileIndex[ae],Ee.size>0&&Ee.size<4096)if(Dt&&Buffer.isBuffer(Ee.content))Ee.content.copy(ne,ne.l,0,Ee.size),ne.l+=Ee.size+63&-64;else{for(be=0;be<Ee.size;++be)ne.write_shift(1,Ee.content[be]);for(;be&63;++be)ne.write_shift(1,0)}if(Dt)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function ue(B,re){var K=B.FullPaths.map(function(be){return be.toUpperCase()}),X=K.map(function(be){var Te=be.split("/");return Te[Te.length-(be.slice(-1)=="/"?2:1)]}),ne=!1;re.charCodeAt(0)===47?(ne=!0,re=K[0].slice(0,-1)+re):ne=re.indexOf("/")!==-1;var ae=re.toUpperCase(),we=ne===!0?K.indexOf(ae):X.indexOf(ae);if(we!==-1)return B.FileIndex[we];var De=!ae.match(kc);for(ae=ae.replace(Sn,""),De&&(ae=ae.replace(kc,"!")),we=0;we<K.length;++we)if((De?K[we].replace(kc,"!"):K[we]).replace(Sn,"")==ae||(De?X[we].replace(kc,"!"):X[we]).replace(Sn,"")==ae)return B.FileIndex[we];return null}var Y=64,se=-2,ve="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],ce="00000000000000000000000000000000",V={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:se,FREESECT:-1,HEADER_SIGNATURE:ve,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(B,re,K){g();var X=me(B,K);m.writeFileSync(re,X)}function Q(B){for(var re=new Array(B.length),K=0;K<B.length;++K)re[K]=String.fromCharCode(B[K]);return re.join("")}function fe(B,re){var K=me(B,re);switch(re&&re.type||"buffer"){case"file":return g(),m.writeFileSync(re.filename,K),K;case"binary":return typeof K=="string"?K:Q(K);case"base64":return cg(typeof K=="string"?K:Q(K));case"buffer":if(Dt)return Buffer.isBuffer(K)?K:fo(K);case"array":return typeof K=="string"?Ia(K):K}return K}var R;function P(B){try{var re=B.InflateRaw,K=new re;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)R=B;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function W(B,re){if(!R)return ai(B,re);var K=R.InflateRaw,X=new K,ne=X._processChunk(B.slice(B.l),X._finishFlushFlag);return B.l+=X.bytesRead,ne}function U(B){return R?R.deflateRawSync(B):ct(B)}var H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ge=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(B){var re=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(re>>16|re>>8|re)&255}for(var ke=typeof Uint8Array<"u",xe=ke?new Uint8Array(256):[],Ke=0;Ke<256;++Ke)xe[Ke]=Ce(Ke);function te(B,re){var K=xe[B&255];return re<=8?K>>>8-re:(K=K<<8|xe[B>>8&255],re<=16?K>>>16-re:(K=K<<8|xe[B>>16&255],K>>>24-re))}function Tt(B,re){var K=re&7,X=re>>>3;return(B[X]|(K<=6?0:B[X+1]<<8))>>>K&3}function bt(B,re){var K=re&7,X=re>>>3;return(B[X]|(K<=5?0:B[X+1]<<8))>>>K&7}function yt(B,re){var K=re&7,X=re>>>3;return(B[X]|(K<=4?0:B[X+1]<<8))>>>K&15}function ut(B,re){var K=re&7,X=re>>>3;return(B[X]|(K<=3?0:B[X+1]<<8))>>>K&31}function Ue(B,re){var K=re&7,X=re>>>3;return(B[X]|(K<=1?0:B[X+1]<<8))>>>K&127}function Pt(B,re,K){var X=re&7,ne=re>>>3,ae=(1<<K)-1,we=B[ne]>>>X;return K<8-X||(we|=B[ne+1]<<8-X,K<16-X)||(we|=B[ne+2]<<16-X,K<24-X)||(we|=B[ne+3]<<24-X),we&ae}function rr(B,re,K){var X=re&7,ne=re>>>3;return X<=5?B[ne]|=(K&7)<<X:(B[ne]|=K<<X&255,B[ne+1]=(K&7)>>8-X),re+3}function Mt(B,re,K){var X=re&7,ne=re>>>3;return K=(K&1)<<X,B[ne]|=K,re+1}function Zt(B,re,K){var X=re&7,ne=re>>>3;return K<<=X,B[ne]|=K&255,K>>>=8,B[ne+1]=K,re+8}function Vr(B,re,K){var X=re&7,ne=re>>>3;return K<<=X,B[ne]|=K&255,K>>>=8,B[ne+1]=K&255,B[ne+2]=K>>>8,re+16}function at(B,re){var K=B.length,X=2*K>re?2*K:re+5,ne=0;if(K>=re)return B;if(Dt){var ae=ug(X);if(B.copy)B.copy(ae);else for(;ne<B.length;++ne)ae[ne]=B[ne];return ae}else if(ke){var we=new Uint8Array(X);if(we.set)we.set(B);else for(;ne<K;++ne)we[ne]=B[ne];return we}return B.length=X,B}function pr(B){for(var re=new Array(B),K=0;K<B;++K)re[K]=0;return re}function Jr(B,re,K){var X=1,ne=0,ae=0,we=0,De=0,be=B.length,Te=ke?new Uint16Array(32):pr(32);for(ae=0;ae<32;++ae)Te[ae]=0;for(ae=be;ae<K;++ae)B[ae]=0;be=B.length;var Ee=ke?new Uint16Array(be):pr(be);for(ae=0;ae<be;++ae)Te[ne=B[ae]]++,X<ne&&(X=ne),Ee[ae]=0;for(Te[0]=0,ae=1;ae<=X;++ae)Te[ae+16]=De=De+Te[ae-1]<<1;for(ae=0;ae<be;++ae)De=B[ae],De!=0&&(Ee[ae]=Te[De+16]++);var Re=0;for(ae=0;ae<be;++ae)if(Re=B[ae],Re!=0)for(De=te(Ee[ae],X)>>X-Re,we=(1<<X+4-Re)-1;we>=0;--we)re[De|we<<Re]=Re&15|ae<<4;return X}var Gr=ke?new Uint16Array(512):pr(512),Vt=ke?new Uint16Array(32):pr(32);if(!ke){for(var Jt=0;Jt<512;++Jt)Gr[Jt]=0;for(Jt=0;Jt<32;++Jt)Vt[Jt]=0}(function(){for(var B=[],re=0;re<32;re++)B.push(5);Jr(B,Vt,32);var K=[];for(re=0;re<=143;re++)K.push(8);for(;re<=255;re++)K.push(9);for(;re<=279;re++)K.push(7);for(;re<=287;re++)K.push(8);Jr(K,Gr,288)})();var Rr=(function(){for(var re=ke?new Uint8Array(32768):[],K=0,X=0;K<ge.length-1;++K)for(;X<ge[K+1];++X)re[X]=K;for(;X<32768;++X)re[X]=29;var ne=ke?new Uint8Array(259):[];for(K=0,X=0;K<le.length-1;++K)for(;X<le[K+1];++X)ne[X]=K;function ae(De,be){for(var Te=0;Te<De.length;){var Ee=Math.min(65535,De.length-Te),Re=Te+Ee==De.length;for(be.write_shift(1,+Re),be.write_shift(2,Ee),be.write_shift(2,~Ee&65535);Ee-- >0;)be[be.l++]=De[Te++]}return be.l}function we(De,be){for(var Te=0,Ee=0,Re=ke?new Uint16Array(32768):[];Ee<De.length;){var We=Math.min(65535,De.length-Ee);if(We<10){for(Te=rr(be,Te,+(Ee+We==De.length)),Te&7&&(Te+=8-(Te&7)),be.l=Te/8|0,be.write_shift(2,We),be.write_shift(2,~We&65535);We-- >0;)be[be.l++]=De[Ee++];Te=be.l*8;continue}Te=rr(be,Te,+(Ee+We==De.length)+2);for(var Ze=0;We-- >0;){var Be=De[Ee];Ze=(Ze<<5^Be)&32767;var Me=-1,mt=0;if((Me=Re[Ze])&&(Me|=Ee&-32768,Me>Ee&&(Me-=32768),Me<Ee))for(;De[Me+mt]==De[Ee+mt]&&mt<250;)++mt;if(mt>2){Be=ne[mt],Be<=22?Te=Zt(be,Te,xe[Be+1]>>1)-1:(Zt(be,Te,3),Te+=5,Zt(be,Te,xe[Be-23]>>5),Te+=3);var zt=Be<8?0:Be-4>>2;zt>0&&(Vr(be,Te,mt-le[Be]),Te+=zt),Be=re[Ee-Me],Te=Zt(be,Te,xe[Be]>>3),Te-=3;var $t=Be<4?0:Be-2>>1;$t>0&&(Vr(be,Te,Ee-Me-ge[Be]),Te+=$t);for(var or=0;or<mt;++or)Re[Ze]=Ee&32767,Ze=(Ze<<5^De[Ee])&32767,++Ee;We-=mt-1}else Be<=143?Be=Be+48:Te=Mt(be,Te,1),Te=Zt(be,Te,xe[Be]),Re[Ze]=Ee&32767,++Ee}Te=Zt(be,Te,0)-1}return be.l=(Te+7)/8|0,be.l}return function(be,Te){return be.length<8?ae(be,Te):we(be,Te)}})();function ct(B){var re=Or(50+Math.floor(B.length*1.1)),K=Rr(B,re);return re.slice(0,K)}var Rt=ke?new Uint16Array(32768):pr(32768),jr=ke?new Uint16Array(32768):pr(32768),Gt=ke?new Uint16Array(128):pr(128),Qr=1,ri=1;function ni(B,re){var K=ut(B,re)+257;re+=5;var X=ut(B,re)+1;re+=5;var ne=yt(B,re)+4;re+=4;for(var ae=0,we=ke?new Uint8Array(19):pr(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],be=1,Te=ke?new Uint8Array(8):pr(8),Ee=ke?new Uint8Array(8):pr(8),Re=we.length,We=0;We<ne;++We)we[H[We]]=ae=bt(B,re),be<ae&&(be=ae),Te[ae]++,re+=3;var Ze=0;for(Te[0]=0,We=1;We<=be;++We)Ee[We]=Ze=Ze+Te[We-1]<<1;for(We=0;We<Re;++We)(Ze=we[We])!=0&&(De[We]=Ee[Ze]++);var Be=0;for(We=0;We<Re;++We)if(Be=we[We],Be!=0){Ze=xe[De[We]]>>8-Be;for(var Me=(1<<7-Be)-1;Me>=0;--Me)Gt[Ze|Me<<Be]=Be&7|We<<3}var mt=[];for(be=1;mt.length<K+X;)switch(Ze=Gt[Ue(B,re)],re+=Ze&7,Ze>>>=3){case 16:for(ae=3+Tt(B,re),re+=2,Ze=mt[mt.length-1];ae-- >0;)mt.push(Ze);break;case 17:for(ae=3+bt(B,re),re+=3;ae-- >0;)mt.push(0);break;case 18:for(ae=11+Ue(B,re),re+=7;ae-- >0;)mt.push(0);break;default:mt.push(Ze),be<Ze&&(be=Ze);break}var zt=mt.slice(0,K),$t=mt.slice(K);for(We=K;We<286;++We)zt[We]=0;for(We=X;We<30;++We)$t[We]=0;return Qr=Jr(zt,Rt,286),ri=Jr($t,jr,30),re}function Rn(B,re){if(B[0]==3&&!(B[1]&3))return[ks(re),2];for(var K=0,X=0,ne=ug(re||1<<18),ae=0,we=ne.length>>>0,De=0,be=0;(X&1)==0;){if(X=bt(B,K),K+=3,X>>>1)X>>1==1?(De=9,be=5):(K=ni(B,K),De=Qr,be=ri);else{K&7&&(K+=8-(K&7));var Te=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,Te>0)for(!re&&we<ae+Te&&(ne=at(ne,ae+Te),we=ne.length);Te-- >0;)ne[ae++]=B[K>>>3],K+=8;continue}for(;;){!re&&we<ae+32767&&(ne=at(ne,ae+32767),we=ne.length);var Ee=Pt(B,K,De),Re=X>>>1==1?Gr[Ee]:Rt[Ee];if(K+=Re&15,Re>>>=4,(Re>>>8&255)===0)ne[ae++]=Re;else{if(Re==256)break;Re-=257;var We=Re<8?0:Re-4>>2;We>5&&(We=0);var Ze=ae+le[Re];We>0&&(Ze+=Pt(B,K,We),K+=We),Ee=Pt(B,K,be),Re=X>>>1==1?Vt[Ee]:jr[Ee],K+=Re&15,Re>>>=4;var Be=Re<4?0:Re-2>>1,Me=ge[Re];for(Be>0&&(Me+=Pt(B,K,Be),K+=Be),!re&&we<Ze&&(ne=at(ne,Ze+100),we=ne.length);ae<Ze;)ne[ae]=ne[ae-Me],++ae}}}return re?[ne,K+7>>>3]:[ne.slice(0,ae),K+7>>>3]}function ai(B,re){var K=B.slice(B.l||0),X=Rn(K,re);return B.l+=X[1],X[0]}function ma(B,re){if(B)typeof console<"u"&&console.error(re);else throw new Error(re)}function Ie(B,re){var K=B;qr(K,0);var X=[],ne=[],ae={FileIndex:X,FullPaths:ne};N(ae,{root:re.root});for(var we=K.length-4;(K[we]!=80||K[we+1]!=75||K[we+2]!=5||K[we+3]!=6)&&we>=0;)--we;K.l=we+4,K.l+=4;var De=K.read_shift(2);K.l+=6;var be=K.read_shift(4);for(K.l=be,we=0;we<De;++we){K.l+=20;var Te=K.read_shift(4),Ee=K.read_shift(4),Re=K.read_shift(2),We=K.read_shift(2),Ze=K.read_shift(2);K.l+=8;var Be=K.read_shift(4),Me=d(K.slice(K.l+Re,K.l+Re+We));K.l+=Re+We+Ze;var mt=K.l;K.l=Be+4,Ye(K,Te,Ee,ae,Me),K.l=mt}return ae}function Ye(B,re,K,X,ne){B.l+=2;var ae=B.read_shift(2),we=B.read_shift(2),De=c(B);if(ae&8257)throw new Error("Unsupported ZIP encryption");for(var be=B.read_shift(4),Te=B.read_shift(4),Ee=B.read_shift(4),Re=B.read_shift(2),We=B.read_shift(2),Ze="",Be=0;Be<Re;++Be)Ze+=String.fromCharCode(B[B.l++]);if(We){var Me=d(B.slice(B.l,B.l+We));(Me[21589]||{}).mt&&(De=Me[21589].mt),((ne||{})[21589]||{}).mt&&(De=ne[21589].mt)}B.l+=We;var mt=B.slice(B.l,B.l+Te);switch(we){case 8:mt=W(B,Ee);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+we)}var zt=!1;ae&8&&(be=B.read_shift(4),be==134695760&&(be=B.read_shift(4),zt=!0),Te=B.read_shift(4),Ee=B.read_shift(4)),Te!=re&&ma(zt,"Bad compressed size: "+re+" != "+Te),Ee!=K&&ma(zt,"Bad uncompressed size: "+K+" != "+Ee),St(X,Ze,mt,{unsafe:!0,mt:De})}function Ge(B,re){var K=re||{},X=[],ne=[],ae=Or(1),we=K.compression?8:0,De=0,be=0,Te=0,Ee=0,Re=0,We=B.FullPaths[0],Ze=We,Be=B.FileIndex[0],Me=[],mt=0;for(be=1;be<B.FullPaths.length;++be)if(Ze=B.FullPaths[be].slice(We.length),Be=B.FileIndex[be],!(!Be.size||!Be.content||Ze=="Sh33tJ5")){var zt=Ee,$t=Or(Ze.length);for(Te=0;Te<Ze.length;++Te)$t.write_shift(1,Ze.charCodeAt(Te)&127);$t=$t.slice(0,$t.l),Me[Re]=aw.buf(Be.content,0);var or=Be.content;we==8&&(or=U(or)),ae=Or(30),ae.write_shift(4,67324752),ae.write_shift(2,20),ae.write_shift(2,De),ae.write_shift(2,we),Be.mt?l(ae,Be.mt):ae.write_shift(4,0),ae.write_shift(-4,Me[Re]),ae.write_shift(4,or.length),ae.write_shift(4,Be.content.length),ae.write_shift(2,$t.length),ae.write_shift(2,0),Ee+=ae.length,X.push(ae),Ee+=$t.length,X.push($t),Ee+=or.length,X.push(or),ae=Or(46),ae.write_shift(4,33639248),ae.write_shift(2,0),ae.write_shift(2,20),ae.write_shift(2,De),ae.write_shift(2,we),ae.write_shift(4,0),ae.write_shift(-4,Me[Re]),ae.write_shift(4,or.length),ae.write_shift(4,Be.content.length),ae.write_shift(2,$t.length),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(4,0),ae.write_shift(4,zt),mt+=ae.l,ne.push(ae),mt+=$t.length,ne.push($t),++Re}return ae=Or(22),ae.write_shift(4,101010256),ae.write_shift(2,0),ae.write_shift(2,0),ae.write_shift(2,Re),ae.write_shift(2,Re),ae.write_shift(4,mt),ae.write_shift(4,Ee),ae.write_shift(2,0),vs([vs(X),vs(ne),ae])}var Ve={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qe(B,re){if(B.ctype)return B.ctype;var K=B.name||"",X=K.match(/\.([^\.]+)$/);return X&&Ve[X[1]]||re&&(X=(K=re).match(/[\.\\]([^\.\\])+$/),X&&Ve[X[1]])?Ve[X[1]]:"application/octet-stream"}function gt(B){for(var re=cg(B),K=[],X=0;X<re.length;X+=76)K.push(re.slice(X,X+76));return K.join(`\r
`)+`\r
`}function ht(B){var re=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var Ee=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(Ee.length==1?"0"+Ee:Ee)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],X=re.split(`\r
`),ne=0;ne<X.length;++ne){var ae=X[ne];if(ae.length==0){K.push("");continue}for(var we=0;we<ae.length;){var De=76,be=ae.slice(we,we+De);be.charAt(De-1)=="="?De--:be.charAt(De-2)=="="?De-=2:be.charAt(De-3)=="="&&(De-=3),be=ae.slice(we,we+De),we+=De,we<ae.length&&(be+="="),K.push(be)}}return K.join(`\r
`)}function nt(B){for(var re=[],K=0;K<B.length;++K){for(var X=B[K];K<=B.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+B[++K];re.push(X)}for(var ne=0;ne<re.length;++ne)re[ne]=re[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(ae){return String.fromCharCode(parseInt(ae.slice(1),16))});return Ia(re.join(`\r
`))}function ir(B,re,K){for(var X="",ne="",ae="",we,De=0;De<10;++De){var be=re[De];if(!be||be.match(/^\s*$/))break;var Te=be.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":X=Te[2].trim();break;case"content-type":ae=Te[2].trim();break;case"content-transfer-encoding":ne=Te[2].trim();break}}switch(++De,ne.toLowerCase()){case"base64":we=Ia(Yn(re.slice(De).join("")));break;case"quoted-printable":we=nt(re.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var Ee=St(B,X.slice(K.length),we,{unsafe:!0});ae&&(Ee.ctype=ae)}function sr(B,re){if(Q(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=re&&re.root||"",X=(Dt&&Buffer.isBuffer(B)?B.toString("binary"):Q(B)).split(`\r
`),ne=0,ae="";for(ne=0;ne<X.length;++ne)if(ae=X[ne],!!/^Content-Location:/i.test(ae)&&(ae=ae.slice(ae.indexOf("file")),K||(K=ae.slice(0,ae.lastIndexOf("/")+1)),ae.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),ae.slice(0,K.length)!=K););var we=(X[1]||"").match(/boundary="(.*?)"/);if(!we)throw new Error("MAD cannot find boundary");var De="--"+(we[1]||""),be=[],Te=[],Ee={FileIndex:be,FullPaths:Te};N(Ee);var Re,We=0;for(ne=0;ne<X.length;++ne){var Ze=X[ne];Ze!==De&&Ze!==De+"--"||(We++&&ir(Ee,X.slice(Re,ne),K),Re=ne)}return Ee}function gr(B,re){var K=re||{},X=K.boundary||"SheetJS";X="------="+X;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],ae=B.FullPaths[0],we=ae,De=B.FileIndex[0],be=1;be<B.FullPaths.length;++be)if(we=B.FullPaths[be].slice(ae.length),De=B.FileIndex[be],!(!De.size||!De.content||we=="Sh33tJ5")){we=we.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(mt){return"_x"+mt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(mt){return"_u"+mt.charCodeAt(0).toString(16)+"_"});for(var Te=De.content,Ee=Dt&&Buffer.isBuffer(Te)?Te.toString("binary"):Q(Te),Re=0,We=Math.min(1024,Ee.length),Ze=0,Be=0;Be<=We;++Be)(Ze=Ee.charCodeAt(Be))>=32&&Ze<128&&++Re;var Me=Re>=We*4/5;ne.push(X),ne.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+we),ne.push("Content-Transfer-Encoding: "+(Me?"quoted-printable":"base64")),ne.push("Content-Type: "+Qe(De,we)),ne.push(""),ne.push(Me?ht(Ee):gt(Ee))}return ne.push(X+`--\r
`),ne.join(`\r
`)}function Qt(B){var re={};return N(re,B),re}function St(B,re,K,X){var ne=X&&X.unsafe;ne||N(B);var ae=!ne&&Ot.find(B,re);if(!ae){var we=B.FullPaths[0];re.slice(0,we.length)==we?we=re:(we.slice(-1)!="/"&&(we+="/"),we=(we+re).replace("//","/")),ae={name:a(re),type:2},B.FileIndex.push(ae),B.FullPaths.push(we),ne||Ot.utils.cfb_gc(B)}return ae.content=K,ae.size=K?K.length:0,X&&(X.CLSID&&(ae.clsid=X.CLSID),X.mt&&(ae.mt=X.mt),X.ct&&(ae.ct=X.ct)),ae}function Cs(B,re){N(B);var K=Ot.find(B,re);if(K){for(var X=0;X<B.FileIndex.length;++X)if(B.FileIndex[X]==K)return B.FileIndex.splice(X,1),B.FullPaths.splice(X,1),!0}return!1}function Mr(B,re,K){N(B);var X=Ot.find(B,re);if(X){for(var ne=0;ne<B.FileIndex.length;++ne)if(B.FileIndex[ne]==X)return B.FileIndex[ne].name=a(K),B.FullPaths[ne]=K,!0}return!1}function et(B){Z(B,!0)}return r.find=ue,r.read=I,r.parse=x,r.write=fe,r.writeFile=ie,r.utils={cfb_new:Qt,cfb_add:St,cfb_del:Cs,cfb_mov:Mr,cfb_gc:et,ReadShift:Cc,CheckField:zx,prep_blob:qr,bconcat:vs,use_zlib:P,_deflateRaw:ct,_inflateRaw:ai,consts:V},r})();function iw(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ja(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function z0(e){for(var r=[],t=Ja(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}var Wd=new Date(1899,11,30,0,0,0);function Tn(e,r){var t=e.getTime(),n=Wd.getTime()+(e.getTimezoneOffset()-Wd.getTimezoneOffset())*6e4;return(t-n)/(1440*60*1e3)}var yx=new Date,sw=Wd.getTime()+(yx.getTimezoneOffset()-Wd.getTimezoneOffset())*6e4,xg=yx.getTimezoneOffset();function rf(e){var r=new Date;return r.setTime(e*24*60*60*1e3+sw),r.getTimezoneOffset()!==xg&&r.setTime(r.getTime()+(r.getTimezoneOffset()-xg)*6e4),r}function ow(e){var r=0,t=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var l=1;l!=a.length;++l)if(a[l]){switch(t=1,l>3&&(n=!0),a[l].slice(a[l].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[l].slice(a[l].length-1));case"D":t*=24;case"H":t*=60;case"M":if(n)t*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=t*parseInt(a[l],10)}return r}var yg=new Date("2017-02-19T19:06:09.000Z"),_x=isNaN(yg.getFullYear())?new Date("2/19/17"):yg,lw=_x.getFullYear()==2017;function Hr(e,r){var t=new Date(e);if(lw)return r>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):r<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(_x.getFullYear()==1917&&!isNaN(t.getFullYear())){var n=t.getFullYear();return e.indexOf(""+n)>-1||t.setFullYear(t.getFullYear()+100),t}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function co(e,r){if(Dt&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return Sc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Sc(sx(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(e[0]==255&&e[1]==254)return Sc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Sc(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(l){return t[l]||l})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Yr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=Yr(e[t]));return r}function hr(e,r){for(var t="";t.length<r;)t+=e;return t}function Ra(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,l){return t=-t,l}),!isNaN(r=Number(n)))?r/t:r}var cw=["january","february","march","april","may","june","july","august","september","october","november","december"];function kl(e){var r=new Date(e),t=new Date(NaN),n=r.getYear(),a=r.getMonth(),l=r.getDate();if(isNaN(l))return t;var c=e.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&cw.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return n<0||n>8099?t:(a>0||l>1)&&n!=101?r:e.match(/[^-0-9:,\/\\]/)?t:r}var uw=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,n,a){if(e||typeof n=="string")return t.split(n);for(var l=t.split(n),c=[l[0]],d=1;d<l.length;++d)c.push(a),c.push(l[d]);return c}})();function wx(e){return e?e.content&&e.type?co(e.content,!0):e.data?wc(e.data):e.asNodeBuffer&&Dt?wc(e.asNodeBuffer().toString("binary")):e.asBinary?wc(e.asBinary()):e._data&&e._data.getContent?wc(co(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function kx(e){if(!e)return null;if(e.data)return og(e.data);if(e.asNodeBuffer&&Dt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?og(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function dw(e){return e&&e.name.slice(-4)===".bin"?kx(e):wx(e)}function da(e,r){for(var t=e.FullPaths||Ja(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),l=0;l<t.length;++l){var c=t[l].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||a==c)return e.files?e.files[t[l]]:e.FileIndex[l]}return null}function U0(e,r){var t=da(e,r);if(t==null)throw new Error("Cannot find file "+r+" in zip");return t}function br(e,r,t){if(!t)return dw(U0(e,r));if(!r)return null;try{return br(e,r)}catch{return null}}function qn(e,r,t){if(!t)return wx(U0(e,r));if(!r)return null;try{return qn(e,r)}catch{return null}}function fw(e,r,t){return kx(U0(e,r))}function _g(e){for(var r=e.FullPaths||Ja(e.files),t=[],n=0;n<r.length;++n)r[n].slice(-1)!="/"&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function hw(e,r,t){if(e.FullPaths){if(typeof t=="string"){var n;return Dt?n=fo(t):n=O_(t),Ot.utils.cfb_add(e,r,n)}Ot.utils.cfb_add(e,r,t)}else e.file(r,t)}function bx(e,r){switch(r.type){case"base64":return Ot.read(e,{type:"base64"});case"binary":return Ot.read(e,{type:"binary"});case"buffer":case"array":return Ot.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function bc(e,r){if(e.charAt(0)=="/")return e.slice(1);var t=r.split("/");r.slice(-1)!="/"&&t.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?t.pop():a!=="."&&t.push(a)}return t.join("/")}var Sx=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,mw=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,wg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,pw=/<[^>]*>/g,mn=Sx.match(wg)?wg:pw,gw=/<\w*:/,vw=/<(\/?)\w+:/;function ft(e,r,t){for(var n={},a=0,l=0;a!==e.length&&!((l=e.charCodeAt(a))===32||l===10||l===13);++a);if(r||(n[0]=e.slice(0,a)),a===e.length)return n;var c=e.match(mw),d=0,m="",g=0,x="",_="",y=1;if(c)for(g=0;g!=c.length;++g){for(_=c[g],l=0;l!=_.length&&_.charCodeAt(l)!==61;++l);for(x=_.slice(0,l).trim();_.charCodeAt(l+1)==32;)++l;for(y=(a=_.charCodeAt(l+1))==34||a==39?1:0,m=_.slice(l+1+y,_.length-y),d=0;d!=x.length&&x.charCodeAt(d)!==58;++d);if(d===x.length)x.indexOf("_")>0&&(x=x.slice(0,x.indexOf("_"))),n[x]=m,n[x.toLowerCase()]=m;else{var S=(d===5&&x.slice(0,5)==="xmlns"?"xmlns":"")+x.slice(d+1);if(n[S]&&x.slice(d-3,d)=="ext")continue;n[S]=m,n[S.toLowerCase()]=m}}return n}function ei(e){return e.replace(vw,"<$1")}var Tx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},xw=z0(Tx),Lt=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function t(n){var a=n+"",l=a.indexOf("<![CDATA[");if(l==-1)return a.replace(e,function(d,m){return Tx[d]||String.fromCharCode(parseInt(m,d.indexOf("x")>-1?16:10))||d}).replace(r,function(d,m){return String.fromCharCode(parseInt(m,16))});var c=a.indexOf("]]>");return t(a.slice(0,l))+a.slice(l+9,c)+t(a.slice(c+3))}})(),yw=/[&<>'"]/g,_w=/[\u0000-\u001f]/g;function $0(e){var r=e+"";return r.replace(yw,function(t){return xw[t]}).replace(/\n/g,"<br/>").replace(_w,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var kg=(function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}})();function ar(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Mh(e){for(var r="",t=0,n=0,a=0,l=0,c=0,d=0;t<e.length;){if(n=e.charCodeAt(t++),n<128){r+=String.fromCharCode(n);continue}if(a=e.charCodeAt(t++),n>191&&n<224){c=(n&31)<<6,c|=a&63,r+=String.fromCharCode(c);continue}if(l=e.charCodeAt(t++),n<240){r+=String.fromCharCode((n&15)<<12|(a&63)<<6|l&63);continue}c=e.charCodeAt(t++),d=((n&7)<<18|(a&63)<<12|(l&63)<<6|c&63)-65536,r+=String.fromCharCode(55296+(d>>>10&1023)),r+=String.fromCharCode(56320+(d&1023))}return r}function bg(e){var r=ks(2*e.length),t,n,a=1,l=0,c=0,d;for(n=0;n<e.length;n+=a)a=1,(d=e.charCodeAt(n))<128?t=d:d<224?(t=(d&31)*64+(e.charCodeAt(n+1)&63),a=2):d<240?(t=(d&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,t=(d&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(r[l++]=c&255,r[l++]=c>>>8,c=0),r[l++]=t%256,r[l++]=t>>>8;return r.slice(0,l).toString("ucs2")}function Sg(e){return fo(e,"binary").toString("utf8")}var md="foo bar baz",Xt=Dt&&(Sg(md)==Mh(md)&&Sg||bg(md)==Mh(md)&&bg)||Mh,Sc=Dt?function(e){return fo(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,a=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},Uc=(function(){var e={};return function(t,n){var a=t+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",n||"")}})(),Ex=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),ww=(function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}})(),kw=/<\/?(?:vt:)?variant>/g,bw=/<(?:vt:)([^>]*)>([\s\S]*)</;function Tg(e,r){var t=ft(e),n=e.match(ww(t.baseType))||[],a=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return a}return n.forEach(function(l){var c=l.replace(kw,"").match(bw);c&&a.push({v:Xt(c[2]),t:c[1]})}),a}var Sw=/(^\s|\s$|\n)/;function Tw(e){return Ja(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function Ew(e,r,t){return"<"+e+(t!=null?Tw(t):"")+(r!=null?(r.match(Sw)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function W0(e){if(Dt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Xt(ho(j0(e)));throw new Error("Bad input format: expected Buffer or string")}var $c=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Cw={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},Aw=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function Pw(e,r){for(var t=1-2*(e[r+7]>>>7),n=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),a=e[r+6]&15,l=5;l>=0;--l)a=a*256+e[r+l];return n==2047?a==0?t*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),t*Math.pow(2,n-52)*a)}function Nw(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,a=0,l=0,c=n?-r:r;isFinite(c)?c==0?a=l=0:(a=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-a),a<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?a=-1022:(l-=Math.pow(2,52),a+=1023)):(a=2047,l=isNaN(r)?26985:0);for(var d=0;d<=5;++d,l/=256)e[t+d]=l&255;e[t+6]=(a&15)<<4|l&15,e[t+7]=a>>4|n}var Eg=function(e){for(var r=[],t=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,l=e[0][n].length;a<l;a+=t)r.push.apply(r,e[0][n].slice(a,a+t));return r},Cg=Dt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:fo(r)})):Eg(e)}:Eg,Ag=function(e,r,t){for(var n=[],a=r;a<t;a+=2)n.push(String.fromCharCode(Ci(e,a)));return n.join("").replace(Sn,"")},H0=Dt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("utf16le",r,t).replace(Sn,""):Ag(e,r,t)}:Ag,Pg=function(e,r,t){for(var n=[],a=r;a<r+t;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},Cx=Dt?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Pg(e,r,t)}:Pg,Ng=function(e,r,t){for(var n=[],a=r;a<t;a++)n.push(String.fromCharCode(pl(e,a)));return n.join("")},Xc=Dt?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):Ng(r,t,n)}:Ng,Ax=function(e,r){var t=Kn(e,r);return t>0?Xc(e,r+4,r+4+t-1):""},Px=Ax,Nx=function(e,r){var t=Kn(e,r);return t>0?Xc(e,r+4,r+4+t-1):""},Dx=Nx,Ox=function(e,r){var t=2*Kn(e,r);return t>0?Xc(e,r+4,r+4+t-1):""},Ix=Ox,Fx=function(r,t){var n=Kn(r,t);return n>0?H0(r,t+4,t+4+n):""},Lx=Fx,Rx=function(e,r){var t=Kn(e,r);return t>0?Xc(e,r+4,r+4+t):""},jx=Rx,Mx=function(e,r){return Pw(e,r)},Hd=Mx,Bx=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Dt&&(Px=function(r,t){if(!Buffer.isBuffer(r))return Ax(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Dx=function(r,t){if(!Buffer.isBuffer(r))return Nx(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Ix=function(r,t){if(!Buffer.isBuffer(r))return Ox(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},Lx=function(r,t){if(!Buffer.isBuffer(r))return Fx(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},jx=function(r,t){if(!Buffer.isBuffer(r))return Rx(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},Hd=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):Mx(r,t)},Bx=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var pl=function(e,r){return e[r]},Ci=function(e,r){return e[r+1]*256+e[r]},Dw=function(e,r){var t=e[r+1]*256+e[r];return t<32768?t:(65535-t+1)*-1},Kn=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},ro=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Ow=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Cc(e,r){var t="",n,a,l=[],c,d,m,g;switch(r){case"dbcs":if(g=this.l,Dt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)t+=String.fromCharCode(Ci(this,g)),g+=2;e*=2;break;case"utf8":t=Xc(this,this.l,this.l+e);break;case"utf16le":e*=2,t=H0(this,this.l,this.l+e);break;case"wstr":return Cc.call(this,e,"dbcs");case"lpstr-ansi":t=Px(this,this.l),e=4+Kn(this,this.l);break;case"lpstr-cp":t=Dx(this,this.l),e=4+Kn(this,this.l);break;case"lpwstr":t=Ix(this,this.l),e=4+2*Kn(this,this.l);break;case"lpp4":e=4+Kn(this,this.l),t=Lx(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Kn(this,this.l),t=jx(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(c=pl(this,this.l+e++))!==0;)l.push(hd(c));t=l.join("");break;case"_wstr":for(e=0,t="";(c=Ci(this,this.l+e))!==0;)l.push(hd(c)),e+=2;e+=2,t=l.join("");break;case"dbcs-cont":for(t="",g=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return c=pl(this,g),this.l=g+1,d=Cc.call(this,e-m,c?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(hd(Ci(this,g))),g+=2}t=l.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(t="",g=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(g)!==-1)return c=pl(this,g),this.l=g+1,d=Cc.call(this,e-m,c?"dbcs-cont":"sbcs-cont"),l.join("")+d;l.push(hd(pl(this,g))),g+=1}t=l.join("");break;default:switch(e){case 1:return n=pl(this,this.l),this.l++,n;case 2:return n=(r==="i"?Dw:Ci)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(e>0?ro:Ow)(this,this.l),this.l+=4,n):(a=Kn(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return e==8?a=Hd(this,this.l):a=Hd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:t=Cx(this,this.l,e);break}}return this.l+=e,t}var Iw=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},Fw=function(e,r,t){e[t]=r&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},Lw=function(e,r,t){e[t]=r&255,e[t+1]=r>>>8&255};function Rw(e,r,t){var n=0,a=0;if(t==="dbcs"){for(a=0;a!=r.length;++a)Lw(this,r.charCodeAt(a),this.l+2*a);n=2*r.length}else if(t==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;n=r.length}else if(t==="hex"){for(;a<e;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+e,this.length);for(a=0;a<Math.min(r.length,e);++a){var c=r.charCodeAt(a);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,Iw(this,r,this.l);break;case 8:if(n=8,t==="f"){Nw(this,r,this.l);break}case 16:break;case-4:n=4,Fw(this,r,this.l);break}return this.l+=n,this}function zx(e,r){var t=Cx(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function qr(e,r){e.l=r,e.read_shift=Cc,e.chk=zx,e.write_shift=Rw}function hn(e,r){e.l+=r}function Or(e){var r=ks(e);return qr(r,0),r}function Di(e,r,t){if(e){var n,a,l;qr(e,e.l||0);for(var c=e.length,d=0,m=0;e.l<c;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var g=Yd[d]||Yd[65535];for(n=e.read_shift(1),l=n&127,a=1;a<4&&n&128;++a)l+=((n=e.read_shift(1))&127)<<7*a;m=e.l+l;var x=g.f&&g.f(e,l,t);if(e.l=m,r(x,g,d))return}}}function c0(){var e=[],r=Dt?256:2048,t=function(g){var x=Or(g);return qr(x,0),x},n=t(r),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},l=function(g){return n&&g<n.length-n.l?n:(a(),n=t(Math.max(g+1,r)))},c=function(){return a(),vs(e)},d=function(g){a(),n=g,n.l==null&&(n.l=n.length),l(r)};return{next:l,push:d,end:c,_bufs:e}}function Ac(e,r,t){var n=Yr(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Dg(e,r,t){var n=Yr(e);return n.s=Ac(n.s,r.s,t),n.e=Ac(n.e,r.s,t),n}function Pc(e,r){if(e.cRel&&e.c<0)for(e=Yr(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=Yr(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=xt(e);return!e.cRel&&e.cRel!=null&&(t=Bw(t)),!e.rRel&&e.rRel!=null&&(t=jw(t)),t}function Bh(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ir(e.s.c)+":"+(e.e.cRel?"":"$")+Ir(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xr(e.s.r)+":"+(e.e.rRel?"":"$")+Xr(e.e.r):Pc(e.s,r.biff)+":"+Pc(e.e,r.biff)}function V0(e){return parseInt(Mw(e),10)-1}function Xr(e){return""+(e+1)}function jw(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Mw(e){return e.replace(/\$(\d+)$/,"$1")}function G0(e){for(var r=zw(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function Ir(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Bw(e){return e.replace(/^([A-Z])/,"$$$1")}function zw(e){return e.replace(/^\$([A-Z])/,"$1")}function Uw(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bn(e){for(var r=0,t=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(t=26*t+(a-64))}return{c:t-1,r:r-1}}function xt(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Al(e){var r=e.indexOf(":");return r==-1?{s:bn(e),e:bn(e)}:{s:bn(e.slice(0,r)),e:bn(e.slice(r+1))}}function It(e,r){return typeof r>"u"||typeof r=="number"?It(e.s,e.e):(typeof e!="string"&&(e=xt(e)),typeof r!="string"&&(r=xt(r)),e==r?e:e+":"+r)}function mr(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,a=0,l=e.length;for(t=0;n<l&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.s.c=--t,t=0;n<l&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;if(r.s.r=--t,n===l||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=l&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)t=26*t+a;for(r.e.c=--t,t=0;n!=l&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)t=10*t+a;return r.e.r=--t,r}function Og(e,r){var t=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=fa(e.z,t?Tn(r):r)}catch{}try{return e.w=fa((e.XF||{}).numFmtId||(t?14:0),t?Tn(r):r)}catch{return""+r}}function Ni(e,r,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?go[e.v]||e.v:r==null?Og(e,e.v):Og(e,r))}function Ts(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function Ux(e,r,t){var n=t||{},a=e?Array.isArray(e):n.dense,l=e||(a?[]:{}),c=0,d=0;if(l&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var m=typeof n.origin=="string"?bn(n.origin):n.origin;c=m.r,d=m.c}l["!ref"]||(l["!ref"]="A1:A1")}var g={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var x=mr(l["!ref"]);g.s.c=x.s.c,g.s.r=x.s.r,g.e.c=Math.max(g.e.c,x.e.c),g.e.r=Math.max(g.e.r,x.e.r),c==-1&&(g.e.r=c=x.e.r+1)}for(var _=0;_!=r.length;++_)if(r[_]){if(!Array.isArray(r[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var y=0;y!=r[_].length;++y)if(!(typeof r[_][y]>"u")){var S={v:r[_][y]},C=c+_,b=d+y;if(g.s.r>C&&(g.s.r=C),g.s.c>b&&(g.s.c=b),g.e.r<C&&(g.e.r=C),g.e.c<b&&(g.e.c=b),r[_][y]&&typeof r[_][y]=="object"&&!Array.isArray(r[_][y])&&!(r[_][y]instanceof Date))S=r[_][y];else if(Array.isArray(S.v)&&(S.f=r[_][y][1],S.v=S.v[0]),S.v===null)if(S.f)S.t="n";else if(n.nullError)S.t="e",S.v=0;else if(n.sheetStubs)S.t="z";else continue;else typeof S.v=="number"?S.t="n":typeof S.v=="boolean"?S.t="b":S.v instanceof Date?(S.z=n.dateNF||kt[14],n.cellDates?(S.t="d",S.w=fa(S.z,Tn(S.v))):(S.t="n",S.v=Tn(S.v),S.w=fa(S.z,S.v))):S.t="s";if(a)l[C]||(l[C]=[]),l[C][b]&&l[C][b].z&&(S.z=l[C][b].z),l[C][b]=S;else{var E=xt({c:b,r:C});l[E]&&l[E].z&&(S.z=l[E].z),l[E]=S}}}return g.s.c<1e7&&(l["!ref"]=It(g)),l}function Pl(e,r){return Ux(null,e,r)}function $w(e){return e.read_shift(4,"i")}function fn(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function Ww(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Z0(e,r){var t=e.l,n=e.read_shift(1),a=fn(e),l=[],c={t:a,h:a};if((n&1)!==0){for(var d=e.read_shift(4),m=0;m!=d;++m)l.push(Ww(e));c.r=l}else c.r=[{ich:0,ifnt:0}];return e.l=t+r,c}var Hw=Z0;function ha(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function mo(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var Vw=fn;function K0(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var Gw=fn,u0=K0;function q0(e){var r=e.slice(e.l,e.l+4),t=r[0]&1,n=r[0]&2;e.l+=4;var a=n===0?Hd([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):ro(r,0)>>2;return t?a/100:a}function $x(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var po=$x;function un(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zw(e){var r={},t=e.read_shift(1),n=t>>>1,a=e.read_shift(1),l=e.read_shift(2,"i"),c=e.read_shift(1),d=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=a;var g=so[a];g&&(r.rgb=Hc(g));break;case 2:r.rgb=Hc([c,d,m]);break;case 3:r.theme=a;break}return l!=0&&(r.tint=l>0?l/32767:l/32768),r}function Kw(e){var r=e.read_shift(1);e.l++;var t={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return t}function Wx(e,r){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function qw(e){return Wx(e,1)}function Yw(e){return Wx(e,2)}var Y0=2,Ln=3,pd=11,Ig=12,Vd=19,gd=64,Xw=65,Jw=71,Qw=4108,ek=4126,Wr=80,Hx=81,tk=[Wr,Hx],rk={1:{n:"CodePage",t:Y0},2:{n:"Category",t:Wr},3:{n:"PresentationFormat",t:Wr},4:{n:"ByteCount",t:Ln},5:{n:"LineCount",t:Ln},6:{n:"ParagraphCount",t:Ln},7:{n:"SlideCount",t:Ln},8:{n:"NoteCount",t:Ln},9:{n:"HiddenCount",t:Ln},10:{n:"MultimediaClipCount",t:Ln},11:{n:"ScaleCrop",t:pd},12:{n:"HeadingPairs",t:Qw},13:{n:"TitlesOfParts",t:ek},14:{n:"Manager",t:Wr},15:{n:"Company",t:Wr},16:{n:"LinksUpToDate",t:pd},17:{n:"CharacterCount",t:Ln},19:{n:"SharedDoc",t:pd},22:{n:"HyperlinksChanged",t:pd},23:{n:"AppVersion",t:Ln,p:"version"},24:{n:"DigSig",t:Xw},26:{n:"ContentType",t:Wr},27:{n:"ContentStatus",t:Wr},28:{n:"Language",t:Wr},29:{n:"Version",t:Wr},255:{},2147483648:{n:"Locale",t:Vd},2147483651:{n:"Behavior",t:Vd},1919054434:{}},nk={1:{n:"CodePage",t:Y0},2:{n:"Title",t:Wr},3:{n:"Subject",t:Wr},4:{n:"Author",t:Wr},5:{n:"Keywords",t:Wr},6:{n:"Comments",t:Wr},7:{n:"Template",t:Wr},8:{n:"LastAuthor",t:Wr},9:{n:"RevNumber",t:Wr},10:{n:"EditTime",t:gd},11:{n:"LastPrinted",t:gd},12:{n:"CreatedDate",t:gd},13:{n:"ModifiedDate",t:gd},14:{n:"PageCount",t:Ln},15:{n:"WordCount",t:Ln},16:{n:"CharCount",t:Ln},17:{n:"Thumbnail",t:Jw},18:{n:"Application",t:Wr},19:{n:"DocSecurity",t:Ln},255:{},2147483648:{n:"Locale",t:Vd},2147483651:{n:"Behavior",t:Vd},1919054434:{}},Fg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ak=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ik(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var sk=ik([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),so=Yr(sk),go={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Vx={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Lg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function ok(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lk(e){var r=ok();if(!e||!e.match)return r;var t={};if((e.match(mn)||[]).forEach(function(n){var a=ft(n);switch(a[0].replace(gw,"<")){case"<?xml":break;case"<Types":r.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":r[Lg[a.ContentType]]!==void 0&&r[Lg[a.ContentType]].push(a.PartName);break}}),r.xmlns!==Cw.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}var xl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function d0(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function Nc(e,r){var t={"!id":{}};if(!e)return t;r.charAt(0)!=="/"&&(r="/"+r);var n={};return(e.match(mn)||[]).forEach(function(a){var l=ft(a);if(l[0]==="<Relationship"){var c={};c.Type=l.Type,c.Target=l.Target,c.Id=l.Id,l.TargetMode&&(c.TargetMode=l.TargetMode);var d=l.TargetMode==="External"?l.Target:bc(l.Target,r);t[d]=c,n[l.Id]=c}}),t["!id"]=n,t}var ck="application/vnd.oasis.opendocument.spreadsheet";function uk(e,r){for(var t=W0(e),n,a;n=$c.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if(a=ft(n[0],!1),a.path=="/"&&a.type!==ck)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}var Dc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],dk=(function(){for(var e=new Array(Dc.length),r=0;r<Dc.length;++r){var t=Dc[r],n="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[r]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function Gx(e){var r={};e=Xt(e);for(var t=0;t<Dc.length;++t){var n=Dc[t],a=e.match(dk[t]);a!=null&&a.length>0&&(r[n[1]]=Lt(a[1])),n[2]==="date"&&r[n[1]]&&(r[n[1]]=Hr(r[n[1]]))}return r}var fk=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Zx(e,r,t,n){var a=[];if(typeof e=="string")a=Tg(e,n);else for(var l=0;l<e.length;++l)a=a.concat(e[l].map(function(x){return{v:x}}));var c=typeof r=="string"?Tg(r,n).map(function(x){return x.v}):r,d=0,m=0;if(c.length>0)for(var g=0;g!==a.length;g+=2){switch(m=+a[g+1].v,a[g].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":t.Worksheets=m,t.SheetNames=c.slice(d,d+m);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":t.NamedRanges=m,t.DefinedNames=c.slice(d,d+m);break;case"Charts":case"Diagramme":t.Chartsheets=m,t.ChartNames=c.slice(d,d+m);break}d+=m}}function hk(e,r,t){var n={};return r||(r={}),e=Xt(e),fk.forEach(function(a){var l=(e.match(Uc(a[0]))||[])[1];switch(a[2]){case"string":l&&(r[a[1]]=Lt(l));break;case"bool":r[a[1]]=l==="true";break;case"raw":var c=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));c&&c.length>0&&(n[a[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Zx(n.HeadingPairs,n.TitlesOfParts,r,t),r}var mk=/<[^>]+>[^<]*/g;function pk(e,r){var t={},n="",a=e.match(mk);if(a)for(var l=0;l!=a.length;++l){var c=a[l],d=ft(c);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Lt(d.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var m=c.split(">"),g=m[0].slice(4),x=m[1];switch(g){case"lpstr":case"bstr":case"lpwstr":t[n]=Lt(x);break;case"bool":t[n]=ar(x);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(x,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(x);break;case"filetime":case"date":t[n]=Hr(x);break;case"cy":case"error":t[n]=Lt(x);break;default:if(g.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",c,g,m)}}else if(c.slice(0,2)!=="</"){if(r.WTF)throw new Error(c)}}}return t}var gk={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},zh;function vk(e,r,t){zh||(zh=z0(gk)),r=zh[r]||r,e[r]=t}function X0(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Kx(e,r,t){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return a}function qx(e,r,t){var n=e.read_shift(0,"lpwstr");return n}function Yx(e,r,t){return r===31?qx(e):Kx(e,r,t)}function f0(e,r,t){return Yx(e,r,t===!1?0:4)}function xk(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Yx(e,r,0)}function yk(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var a=e.l;t[n]=e.read_shift(0,"lpwstr").replace(Sn,""),e.l-a&2&&(e.l+=2)}return t}function _k(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(Sn,"");return t}function wk(e){var r=e.l,t=Gd(e,Hx);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var n=Gd(e,Ln);return[t,n]}function kk(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(wk(e));return t}function Rg(e,r){for(var t=e.read_shift(4),n={},a=0;a!=t;++a){var l=e.read_shift(4),c=e.read_shift(4);n[l]=e.read_shift(c,r===1200?"utf16le":"utf8").replace(Sn,"").replace(kc,"!"),r===1200&&c%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Xx(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),t}function bk(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function Gd(e,r,t){var n=e.read_shift(2),a,l=t||{};if(e.l+=2,r!==Ig&&n!==r&&tk.indexOf(r)===-1&&!((r&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+r+" saw "+n);switch(r===Ig?n:r){case 2:return a=e.read_shift(2,"i"),l.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Kx(e,n,4).replace(Sn,"");case 31:return qx(e);case 64:return X0(e);case 65:return Xx(e);case 71:return bk(e);case 80:return f0(e,n,!l.raw).replace(Sn,"");case 81:return xk(e,n).replace(Sn,"");case 4108:return kk(e);case 4126:case 4127:return n==4127?yk(e):_k(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function jg(e,r){var t=e.l,n=e.read_shift(4),a=e.read_shift(4),l=[],c=0,d=0,m=-1,g={};for(c=0;c!=a;++c){var x=e.read_shift(4),_=e.read_shift(4);l[c]=[x,_+t]}l.sort(function(F,O){return F[1]-O[1]});var y={};for(c=0;c!=a;++c){if(e.l!==l[c][1]){var S=!0;if(c>0&&r)switch(r[l[c-1][0]].t){case 2:e.l+2===l[c][1]&&(e.l+=2,S=!1);break;case 80:e.l<=l[c][1]&&(e.l=l[c][1],S=!1);break;case 4108:e.l<=l[c][1]&&(e.l=l[c][1],S=!1);break}if((!r||c==0)&&e.l<=l[c][1]&&(S=!1,e.l=l[c][1]),S)throw new Error("Read Error: Expected address "+l[c][1]+" at "+e.l+" :"+c)}if(r){var C=r[l[c][0]];if(y[C.n]=Gd(e,C.t,{raw:!0}),C.p==="version"&&(y[C.n]=String(y[C.n]>>16)+"."+("0000"+String(y[C.n]&65535)).slice(-4)),C.n=="CodePage")switch(y[C.n]){case 0:y[C.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Fa(d=y[C.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+y[C.n])}}else if(l[c][0]===1){if(d=y.CodePage=Gd(e,Y0),Fa(d),m!==-1){var b=e.l;e.l=l[m][1],g=Rg(e,d),e.l=b}}else if(l[c][0]===0){if(d===0){m=c,e.l=l[c+1][1];continue}g=Rg(e,d)}else{var E=g[l[c][0]],D;switch(e[e.l]){case 65:e.l+=4,D=Xx(e);break;case 30:e.l+=4,D=f0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,D=f0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,D=e.read_shift(4,"i");break;case 19:e.l+=4,D=e.read_shift(4);break;case 5:e.l+=4,D=e.read_shift(8,"f");break;case 11:e.l+=4,D=yr(e,4);break;case 64:e.l+=4,D=Hr(X0(e));break;default:throw new Error("unparsed value: "+e[e.l])}y[E]=D}}return e.l=t+n,y}function Mg(e,r,t){var n=e.content;if(!n)return{};qr(n,0);var a,l,c,d,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var g=n.read_shift(4),x=n.read_shift(16);if(x!==Ot.utils.consts.HEADER_CLSID&&x!==t)throw new Error("Bad PropertySet CLSID "+x);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(l=n.read_shift(16),d=n.read_shift(4),a===1&&d!==n.l)throw new Error("Length mismatch: "+d+" !== "+n.l);a===2&&(c=n.read_shift(16),m=n.read_shift(4));var _=jg(n,r),y={SystemIdentifier:g};for(var S in _)y[S]=_[S];if(y.FMTID=l,a===1)return y;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var C;try{C=jg(n,null)}catch{}for(S in C)y[S]=C[S];return y.FMTID=[l,c],y}function us(e,r){return e.read_shift(r),null}function Sk(e,r,t){for(var n=[],a=e.l+r;e.l<a;)n.push(t(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function yr(e,r){return e.read_shift(r)===1}function Sr(e){return e.read_shift(2,"u")}function Jx(e,r){return Sk(e,r,Sr)}function Tk(e){var r=e.read_shift(1),t=e.read_shift(1);return t===1?r:r===1}function Jc(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),a="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=e.read_shift(1);l&&(a="dbcs-cont")}else t.biff==12&&(a="wstr");t.biff>=2&&t.biff<=5&&(a="cpstr");var c=n?e.read_shift(n,a):"";return c}function Ek(e){var r=e.read_shift(2),t=e.read_shift(1),n=t&4,a=t&8,l=1+(t&1),c=0,d,m={};a&&(c=e.read_shift(2)),n&&(d=e.read_shift(4));var g=l==2?"dbcs-cont":"sbcs-cont",x=r===0?"":e.read_shift(r,g);return a&&(e.l+=4*c),n&&(e.l+=d),m.t=x,a||(m.raw="<t>"+m.t+"</t>",m.r=m.t),m}function uo(e,r,t){var n;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(r,"sbcs-cont"):n=e.read_shift(r,"dbcs-cont"),n}function Qc(e,r,t){var n=e.read_shift(t&&t.biff==2?1:2);return n===0?(e.l++,""):uo(e,n,t)}function vo(e,r,t){if(t.biff>5)return Qc(e,r,t);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Ck(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[r,t]}function Ak(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=t);var a=e.read_shift((n?r-24:r)>>1,"utf16le").replace(Sn,"");return n&&(e.l+=24),a}function Pk(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return t+n.replace(/\\/g,"/");var l=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=e.read_shift(l>>1,"utf16le").replace(Sn,"");return t+c}function Nk(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return Ak(e);case"0303000000000000c000000000000046":return Pk(e);default:throw new Error("Unsupported Moniker "+t)}}function vd(e){var r=e.read_shift(4),t=r>0?e.read_shift(r,"utf16le").replace(Sn,""):"";return t}function Dk(e,r){var t=e.l+r,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var l,c,d,m,g="",x,_;a&16&&(l=vd(e,t-e.l)),a&128&&(c=vd(e,t-e.l)),(a&257)===257&&(d=vd(e,t-e.l)),(a&257)===1&&(m=Nk(e,t-e.l)),a&8&&(g=vd(e,t-e.l)),a&32&&(x=e.read_shift(16)),a&64&&(_=X0(e)),e.l=t;var y=c||d||m||"";y&&g&&(y+="#"+g),y||(y="#"+g),a&2&&y.charAt(0)=="/"&&y.charAt(1)!="/"&&(y="file://"+y);var S={Target:y};return x&&(S.guid=x),_&&(S.time=_),l&&(S.Tooltip=l),S}function Qx(e){var r=e.read_shift(1),t=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[r,t,n,a]}function e1(e,r){var t=Qx(e);return t[3]=0,t}function ti(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return{r,c:t,ixfe:n}}function Ok(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}function Ik(e,r,t){return r===0?"":vo(e,r,t)}function Fk(e,r,t){var n=t.biff>8?4:2,a=e.read_shift(n),l=e.read_shift(n,"i"),c=e.read_shift(n,"i");return[a,l,c]}function t1(e){var r=e.read_shift(2),t=q0(e);return[r,t]}function Lk(e,r,t){e.l+=4,r-=4;var n=e.l+r,a=Jc(e,r,t),l=e.read_shift(2);if(n-=e.l,l!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+l);return e.l+=l,a}function nf(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r},e:{c:a,r:t}}}function r1(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r},e:{c:a,r:t}}}var Rk=r1;function n1(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function jk(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function Mk(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function ln(e){e.l+=2,e.l+=e.read_shift(2)}var Bk={0:ln,4:ln,5:ln,6:ln,7:Mk,8:ln,9:ln,10:ln,11:ln,12:ln,13:jk,14:ln,15:ln,16:ln,17:ln,18:ln,19:ln,20:ln,21:n1};function zk(e,r){for(var t=e.l+r,n=[];e.l<t;){var a=e.read_shift(2);e.l-=2;try{n.push(Bk[a](e,t-e.l))}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}function xd(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),r-=2,r>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Uk(e,r){return r===0||e.read_shift(2),1200}function $k(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,a=vo(e,0,t);return e.read_shift(r+n-e.l),a}function Wk(e,r,t){var n=t&&t.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Hk(e,r,t){var n=e.read_shift(4),a=e.read_shift(1)&3,l=e.read_shift(1);switch(l){case 0:l="Worksheet";break;case 1:l="Macrosheet";break;case 2:l="Chartsheet";break;case 6:l="VBAModule";break}var c=Jc(e,0,t);return c.length===0&&(c="Sheet1"),{pos:n,hs:a,dt:l,name:c}}function Vk(e,r){for(var t=e.l+r,n=e.read_shift(4),a=e.read_shift(4),l=[],c=0;c!=a&&e.l<t;++c)l.push(Ek(e));return l.Count=n,l.Unique=a,l}function Gk(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}function Zk(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(r.level=n&7),n&32&&(r.hidden=!0),n&64&&(r.hpt=t/20),r}function Kk(e){var r=Ok(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var t=e.read_shift(4);return t!==0}function qk(e){return e.read_shift(2),e.read_shift(4)}function Bg(e,r,t){var n=0;t&&t.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);t&&t.biff==2&&(n=1-(a>>15),a&=32767);var l={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[l,a]}function Yk(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2),m=e.read_shift(2),g=e.read_shift(2);return{Pos:[r,t],Dim:[n,a],Flags:l,CurTab:c,FirstTab:d,Selected:m,TabRatio:g}}function Xk(e,r,t){if(t&&t.biff>=2&&t.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Jk(){}function Qk(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Jc(e,0,t),n}function eb(e){var r=ti(e);return r.isst=e.read_shift(4),r}function tb(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=e.l+r,a=ti(e);t.biff==2&&e.l++;var l=Qc(e,n-e.l,t);return a.val=l,a}function rb(e,r,t){var n=e.read_shift(2),a=vo(e,0,t);return[n,a]}var nb=vo;function zg(e,r,t){var n=e.l+r,a=t.biff==8||!t.biff?4:2,l=e.read_shift(a),c=e.read_shift(a),d=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:l,c:d},e:{r:c,c:m}}}function ab(e){var r=e.read_shift(2),t=e.read_shift(2),n=t1(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}function ib(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),l=[];e.l<t;)l.push(t1(e));if(e.l!==t)throw new Error("MulRK read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:c,rkrec:l}}function sb(e,r){for(var t=e.l+r-2,n=e.read_shift(2),a=e.read_shift(2),l=[];e.l<t;)l.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var c=e.read_shift(2);if(l.length!=c-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:c,ixfe:l}}function ob(e,r,t,n){var a={},l=e.read_shift(4),c=e.read_shift(4),d=e.read_shift(4),m=e.read_shift(2);return a.patternType=ak[d>>26],n.cellStyles&&(a.alc=l&7,a.fWrap=l>>3&1,a.alcV=l>>4&7,a.fJustLast=l>>7&1,a.trot=l>>8&255,a.cIndent=l>>16&15,a.fShrinkToFit=l>>20&1,a.iReadOrder=l>>22&2,a.fAtrNum=l>>26&1,a.fAtrFnt=l>>27&1,a.fAtrAlc=l>>28&1,a.fAtrBdr=l>>29&1,a.fAtrPat=l>>30&1,a.fAtrProt=l>>31&1,a.dgLeft=c&15,a.dgRight=c>>4&15,a.dgTop=c>>8&15,a.dgBottom=c>>12&15,a.icvLeft=c>>16&127,a.icvRight=c>>23&127,a.grbitDiag=c>>30&3,a.icvTop=d&127,a.icvBottom=d>>7&127,a.icvDiag=d>>14&127,a.dgDiag=d>>21&15,a.icvFore=m&127,a.icvBack=m>>7&127,a.fsxButton=m>>14&1),a}function lb(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,r-=6,n.data=ob(e,r,n.fStyle,t),n}function cb(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function Ug(e,r,t){var n=ti(e);(t.biff==2||r==9)&&++e.l;var a=Tk(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function ub(e,r,t){t.biffguess&&t.biff==2&&(t.biff=5);var n=ti(e),a=un(e);return n.val=a,n}var $g=Ik;function db(e,r,t){var n=e.l+r,a=e.read_shift(2),l=e.read_shift(2);if(t.sbcch=l,l==1025||l==14849)return[l,a];if(l<1||l>255)throw new Error("Unexpected SupBook type: "+l);for(var c=uo(e,l),d=[];n>e.l;)d.push(Qc(e));return[l,a,c,d]}function Wg(e,r,t){var n=e.read_shift(2),a,l={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return t.sbcch===14849&&(a=Lk(e,r-2,t)),l.body=a||e.read_shift(r-2),typeof a=="string"&&(l.Name=a),l}var fb=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Hg(e,r,t){var n=e.l+r,a=e.read_shift(2),l=e.read_shift(1),c=e.read_shift(1),d=e.read_shift(t&&t.biff==2?1:2),m=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),m=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var g=uo(e,c,t);a&32&&(g=fb[g.charCodeAt(0)]);var x=n-e.l;t&&t.biff==2&&--x;var _=n==e.l||d===0||!(x>0)?[]:ZT(e,x,t,d);return{chKey:l,Name:g,itab:m,rgce:_}}function a1(e,r,t){if(t.biff<8)return hb(e,r,t);for(var n=[],a=e.l+r,l=e.read_shift(t.biff>8?4:2);l--!==0;)n.push(Fk(e,t.biff>8?12:6,t));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function hb(e,r,t){e[e.l+1]==3&&e[e.l]++;var n=Jc(e,r,t);return n.charCodeAt(0)==3?n.slice(1):n}function mb(e,r,t){if(t.biff<8){e.l+=r;return}var n=e.read_shift(2),a=e.read_shift(2),l=uo(e,n,t),c=uo(e,a,t);return[l,c]}function pb(e,r,t){var n=r1(e);e.l++;var a=e.read_shift(1);return r-=8,[KT(e,r,t),a,n]}function Vg(e,r,t){var n=Rk(e);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,VT(e,r,t)]}function gb(e){var r=e.read_shift(4)!==0,t=e.read_shift(4)!==0,n=e.read_shift(4);return[r,t,n]}function vb(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),d=vo(e,0,t);return t.biff<8&&e.read_shift(1),[{r:n,c:a},d,c,l]}}function xb(e,r,t){return vb(e,r,t)}function yb(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(nf(e));return t}function _b(e,r,t){if(t&&t.biff<8)return kb(e,r,t);var n=n1(e),a=zk(e,r-22,n[1]);return{cmo:n,ft:a}}var wb={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=t,{fmt:n}}};function kb(e,r,t){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var c=[];return c.push((wb[n]||hn)(e,r,t)),{cmo:[a,n,l],ft:c}}function bb(e,r,t){var n=e.l,a="";try{e.l+=4;var l=(t.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(l)==-1?e.l+=6:c=Ck(e,6,t);var d=e.read_shift(2);e.read_shift(2),Sr(e,2);var m=e.read_shift(2);e.l+=m;for(var g=1;g<e.lens.length-1;++g){if(e.l-n!=e.lens[g])throw new Error("TxO: bad continue record");var x=e[e.l],_=uo(e,e.lens[g+1]-e.lens[g]-1);if(a+=_,a.length>=(x?d:2*d))break}if(a.length!==d&&a.length!==d*2)throw new Error("cchText: "+d+" != "+a.length);return e.l=n+r,{t:a}}catch{return e.l=n+r,{t:a}}}function Sb(e,r){var t=nf(e);e.l+=16;var n=Dk(e,r-24);return[t,n]}function Tb(e,r){e.read_shift(2);var t=nf(e),n=e.read_shift((r-10)/2,"dbcs-cont");return n=n.replace(Sn,""),[t,n]}function Eb(e){var r=[0,0],t;return t=e.read_shift(2),r[0]=Fg[t]||t,t=e.read_shift(2),r[1]=Fg[t]||t,r}function Cb(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(e1(e));return t}function Ab(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(e1(e));return t}function Pb(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function i1(e,r,t){if(!t.cellStyles)return hn(e,r);var n=t&&t.biff>=12?4:2,a=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),d=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var g={s:a,e:l,w:c,ixfe:d,flags:m};return(t.biff>=5||!t.biff)&&(g.level=m>>8&7),g}function Nb(e,r){var t={};return r<32||(e.l+=16,t.header=un(e),t.footer=un(e),e.l+=2),t}function Db(e,r,t){var n={area:!1};if(t.biff!=5)return e.l+=r,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var Ob=ti,Ib=Jx,Fb=Qc;function Lb(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function Rb(e,r,t){t.biffguess&&t.biff==5&&(t.biff=2);var n=ti(e);++e.l;var a=vo(e,r-7,t);return n.t="str",n.val=a,n}function jb(e){var r=ti(e);++e.l;var t=un(e);return r.t="n",r.val=t,r}function Mb(e){var r=ti(e);++e.l;var t=e.read_shift(2);return r.t="n",r.val=t,r}function Bb(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function zb(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function Ub(e,r,t){var n=e.l+r,a=ti(e),l=e.read_shift(2),c=uo(e,l,t);return e.l=n,a.t="str",a.val=c,a}var $b=[2,3,48,49,131,139,140,245],Gg=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=z0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(d,m){var g=[],x=ks(1);switch(m.type){case"base64":x=Ia(Yn(d));break;case"binary":x=Ia(d);break;case"buffer":case"array":x=d;break}qr(x,0);var _=x.read_shift(1),y=!!(_&136),S=!1,C=!1;switch(_){case 2:break;case 3:break;case 48:S=!0,y=!0;break;case 49:S=!0,y=!0;break;case 131:break;case 139:break;case 140:C=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+_.toString(16))}var b=0,E=521;_==2&&(b=x.read_shift(2)),x.l+=3,_!=2&&(b=x.read_shift(4)),b>1048576&&(b=1e6),_!=2&&(E=x.read_shift(2));var D=x.read_shift(2),F=m.codepage||1252;_!=2&&(x.l+=16,x.read_shift(1),x[x.l]!==0&&(F=e[x[x.l]]),x.l+=1,x.l+=2),C&&(x.l+=36);for(var O=[],M={},G=Math.min(x.length,_==2?521:E-10-(S?264:0)),I=C?32:11;x.l<G&&x[x.l]!=13;)switch(M={},M.name=Bc.utils.decode(F,x.slice(x.l,x.l+I)).replace(/[\u0000\r\n].*$/g,""),x.l+=I,M.type=String.fromCharCode(x.read_shift(1)),_!=2&&!C&&(M.offset=x.read_shift(4)),M.len=x.read_shift(1),_==2&&(M.offset=x.read_shift(2)),M.dec=x.read_shift(1),M.name.length&&O.push(M),_!=2&&(x.l+=C?13:14),M.type){case"B":(!S||M.len!=8)&&m.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(x[x.l]!==13&&(x.l=E-1),x.read_shift(1)!==13)throw new Error("DBF Terminator not found "+x.l+" "+x[x.l]);x.l=E;var N=0,q=0;for(g[0]=[],q=0;q!=O.length;++q)g[0][q]=O[q].name;for(;b-- >0;){if(x[x.l]===42){x.l+=D;continue}for(++x.l,g[++N]=[],q=0,q=0;q!=O.length;++q){var Z=x.slice(x.l,x.l+O[q].len);x.l+=O[q].len,qr(Z,0);var me=Bc.utils.decode(F,Z);switch(O[q].type){case"C":me.trim().length&&(g[N][q]=me.replace(/\s+$/,""));break;case"D":me.length===8?g[N][q]=new Date(+me.slice(0,4),+me.slice(4,6)-1,+me.slice(6,8)):g[N][q]=me;break;case"F":g[N][q]=parseFloat(me.trim());break;case"+":case"I":g[N][q]=C?Z.read_shift(-4,"i")^2147483648:Z.read_shift(4,"i");break;case"L":switch(me.trim().toUpperCase()){case"Y":case"T":g[N][q]=!0;break;case"N":case"F":g[N][q]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+me+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+_.toString(16));g[N][q]="##MEMO##"+(C?parseInt(me.trim(),10):Z.read_shift(4));break;case"N":me=me.replace(/\u0000/g,"").trim(),me&&me!="."&&(g[N][q]=+me||0);break;case"@":g[N][q]=new Date(Z.read_shift(-8,"f")-621356832e5);break;case"T":g[N][q]=new Date((Z.read_shift(4)-2440588)*864e5+Z.read_shift(4));break;case"Y":g[N][q]=Z.read_shift(4,"i")/1e4+Z.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[N][q]=-Z.read_shift(-8,"f");break;case"B":if(S&&O[q].len==8){g[N][q]=Z.read_shift(8,"f");break}case"G":case"P":Z.l+=O[q].len;break;case"0":if(O[q].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[q].type)}}}if(_!=2&&x.l<x.length&&x[x.l++]!=26)throw new Error("DBF EOF Marker missing "+(x.l-1)+" of "+x.length+" "+x[x.l-1].toString(16));return m&&m.sheetRows&&(g=g.slice(0,m.sheetRows)),m.DBF=O,g}function n(d,m){var g=m||{};g.dateNF||(g.dateNF="yyyymmdd");var x=Pl(t(d,g),g);return x["!cols"]=g.DBF.map(function(_){return{wch:_.len,DBF:_}}),delete g.DBF,x}function a(d,m){try{return Ts(n(d,m),m)}catch(g){if(m&&m.WTF)throw g}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(d,m){var g=m||{};if(+g.codepage>=0&&Fa(+g.codepage),g.type=="string")throw new Error("Cannot write DBF to JS string");var x=c0(),_=y0(d,{header:1,raw:!0,cellDates:!0}),y=_[0],S=_.slice(1),C=d["!cols"]||[],b=0,E=0,D=0,F=1;for(b=0;b<y.length;++b){if(((C[b]||{}).DBF||{}).name){y[b]=C[b].DBF.name,++D;continue}if(y[b]!=null){if(++D,typeof y[b]=="number"&&(y[b]=y[b].toString(10)),typeof y[b]!="string")throw new Error("DBF Invalid column name "+y[b]+" |"+typeof y[b]+"|");if(y.indexOf(y[b])!==b){for(E=0;E<1024;++E)if(y.indexOf(y[b]+"_"+E)==-1){y[b]+="_"+E;break}}}}var O=mr(d["!ref"]),M=[],G=[],I=[];for(b=0;b<=O.e.c-O.s.c;++b){var N="",q="",Z=0,me=[];for(E=0;E<S.length;++E)S[E][b]!=null&&me.push(S[E][b]);if(me.length==0||y[b]==null){M[b]="?";continue}for(E=0;E<me.length;++E){switch(typeof me[E]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=me[E]instanceof Date?"D":"C";break;default:q="C"}Z=Math.max(Z,String(me[E]).length),N=N&&N!=q?"C":q}Z>250&&(Z=250),q=((C[b]||{}).DBF||{}).type,q=="C"&&C[b].DBF.len>Z&&(Z=C[b].DBF.len),N=="B"&&q=="N"&&(N="N",I[b]=C[b].DBF.dec,Z=C[b].DBF.len),G[b]=N=="C"||q=="N"?Z:l[N]||0,F+=G[b],M[b]=N}var ue=x.next(32);for(ue.write_shift(4,318902576),ue.write_shift(4,S.length),ue.write_shift(2,296+32*D),ue.write_shift(2,F),b=0;b<4;++b)ue.write_shift(4,0);for(ue.write_shift(4,0|(+r[ax]||3)<<8),b=0,E=0;b<y.length;++b)if(y[b]!=null){var Y=x.next(32),se=(y[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,se,"sbcs"),Y.write_shift(1,M[b]=="?"?"C":M[b],"sbcs"),Y.write_shift(4,E),Y.write_shift(1,G[b]||l[M[b]]||0),Y.write_shift(1,I[b]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),E+=G[b]||l[M[b]]||0}var ve=x.next(264);for(ve.write_shift(4,13),b=0;b<65;++b)ve.write_shift(4,0);for(b=0;b<S.length;++b){var ee=x.next(F);for(ee.write_shift(1,0),E=0;E<y.length;++E)if(y[E]!=null)switch(M[E]){case"L":ee.write_shift(1,S[b][E]==null?63:S[b][E]?84:70);break;case"B":ee.write_shift(8,S[b][E]||0,"f");break;case"N":var ce="0";for(typeof S[b][E]=="number"&&(ce=S[b][E].toFixed(I[E]||0)),D=0;D<G[E]-ce.length;++D)ee.write_shift(1,32);ee.write_shift(1,ce,"sbcs");break;case"D":S[b][E]?(ee.write_shift(4,("0000"+S[b][E].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(S[b][E].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+S[b][E].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var V=String(S[b][E]!=null?S[b][E]:"").slice(0,G[E]);for(ee.write_shift(1,V,"sbcs"),D=0;D<G[E]-V.length;++D)ee.write_shift(1,32);break}}return x.next(1).write_shift(1,26),x.end()}return{to_workbook:a,to_sheet:n,from_sheet:c}})(),Wb=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+Ja(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(y,S){var C=e[S];return typeof C=="number"?lg(C):C},n=function(y,S,C){var b=S.charCodeAt(0)-32<<4|C.charCodeAt(0)-48;return b==59?y:lg(b)};e["|"]=254;function a(y,S){switch(S.type){case"base64":return l(Yn(y),S);case"binary":return l(y,S);case"buffer":return l(Dt&&Buffer.isBuffer(y)?y.toString("binary"):ho(y),S);case"array":return l(co(y),S)}throw new Error("Unrecognized type "+S.type)}function l(y,S){var C=y.split(/[\n\r]+/),b=-1,E=-1,D=0,F=0,O=[],M=[],G=null,I={},N=[],q=[],Z=[],me=0,ue;for(+S.codepage>=0&&Fa(+S.codepage);D!==C.length;++D){me=0;var Y=C[D].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),se=Y.replace(/;;/g,"\0").split(";").map(function(H){return H.replace(/\u0000/g,";")}),ve=se[0],ee;if(Y.length>0)switch(ve){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":se[1].charAt(0)=="P"&&M.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var ce=!1,V=!1,ie=!1,Q=!1,fe=-1,R=-1;for(F=1;F<se.length;++F)switch(se[F].charAt(0)){case"A":break;case"X":E=parseInt(se[F].slice(1))-1,V=!0;break;case"Y":for(b=parseInt(se[F].slice(1))-1,V||(E=0),ue=O.length;ue<=b;++ue)O[ue]=[];break;case"K":ee=se[F].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(Ra(ee))?isNaN(kl(ee).getDate())||(ee=Hr(ee)):(ee=Ra(ee),G!==null&&Cl(G)&&(ee=rf(ee))),ce=!0;break;case"E":Q=!0;var P=_l(se[F].slice(1),{r:b,c:E});O[b][E]=[O[b][E],P];break;case"S":ie=!0,O[b][E]=[O[b][E],"S5S"];break;case"G":break;case"R":fe=parseInt(se[F].slice(1))-1;break;case"C":R=parseInt(se[F].slice(1))-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+Y)}if(ce&&(O[b][E]&&O[b][E].length==2?O[b][E][0]=ee:O[b][E]=ee,G=null),ie){if(Q)throw new Error("SYLK shared formula cannot have own formula");var W=fe>-1&&O[fe][R];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");O[b][E][1]=p1(W[1],{r:b-fe,c:E-R})}break;case"F":var U=0;for(F=1;F<se.length;++F)switch(se[F].charAt(0)){case"X":E=parseInt(se[F].slice(1))-1,++U;break;case"Y":for(b=parseInt(se[F].slice(1))-1,ue=O.length;ue<=b;++ue)O[ue]=[];break;case"M":me=parseInt(se[F].slice(1))/20;break;case"F":break;case"G":break;case"P":G=M[parseInt(se[F].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(Z=se[F].slice(1).split(" "),ue=parseInt(Z[0],10);ue<=parseInt(Z[1],10);++ue)me=parseInt(Z[2],10),q[ue-1]=me===0?{hidden:!0}:{wch:me},bl(q[ue-1]);break;case"C":E=parseInt(se[F].slice(1))-1,q[E]||(q[E]={});break;case"R":b=parseInt(se[F].slice(1))-1,N[b]||(N[b]={}),me>0?(N[b].hpt=me,N[b].hpx=Vc(me)):me===0&&(N[b].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+Y)}U<1&&(G=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+Y)}}return N.length>0&&(I["!rows"]=N),q.length>0&&(I["!cols"]=q),S&&S.sheetRows&&(O=O.slice(0,S.sheetRows)),[O,I]}function c(y,S){var C=a(y,S),b=C[0],E=C[1],D=Pl(b,S);return Ja(E).forEach(function(F){D[F]=E[F]}),D}function d(y,S){return Ts(c(y,S),S)}function m(y,S,C,b){var E="C;Y"+(C+1)+";X"+(b+1)+";K";switch(y.t){case"n":E+=y.v||0,y.f&&!y.F&&(E+=";E"+P2(y.f,{r:C,c:b}));break;case"b":E+=y.v?"TRUE":"FALSE";break;case"e":E+=y.w||y.v;break;case"d":E+='"'+(y.w||y.v)+'"';break;case"s":E+='"'+y.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function g(y,S){S.forEach(function(C,b){var E="F;W"+(b+1)+" "+(b+1)+" ";C.hidden?E+="0":(typeof C.width=="number"&&!C.wpx&&(C.wpx=Kd(C.width)),typeof C.wpx=="number"&&!C.wch&&(C.wch=qd(C.wpx)),typeof C.wch=="number"&&(E+=Math.round(C.wch))),E.charAt(E.length-1)!=" "&&y.push(E)})}function x(y,S){S.forEach(function(C,b){var E="F;";C.hidden?E+="M0;":C.hpt?E+="M"+20*C.hpt+";":C.hpx&&(E+="M"+20*f1(C.hpx)+";"),E.length>2&&y.push(E+"R"+(b+1))})}function _(y,S){var C=["ID;PWXL;N;E"],b=[],E=mr(y["!ref"]),D,F=Array.isArray(y),O=`\r
`;C.push("P;PGeneral"),C.push("F;P0;DG0G8;M255"),y["!cols"]&&g(C,y["!cols"]),y["!rows"]&&x(C,y["!rows"]),C.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var M=E.s.r;M<=E.e.r;++M)for(var G=E.s.c;G<=E.e.c;++G){var I=xt({r:M,c:G});D=F?(y[M]||[])[G]:y[I],!(!D||D.v==null&&(!D.f||D.F))&&b.push(m(D,y,M,G))}return C.join(O)+O+b.join(O)+O+"E"+O}return{to_workbook:d,to_sheet:c,from_sheet:_}})(),Hb=(function(){function e(l,c){switch(c.type){case"base64":return r(Yn(l),c);case"binary":return r(l,c);case"buffer":return r(Dt&&Buffer.isBuffer(l)?l.toString("binary"):ho(l),c);case"array":return r(co(l),c)}throw new Error("Unrecognized type "+c.type)}function r(l,c){for(var d=l.split(`
`),m=-1,g=-1,x=0,_=[];x!==d.length;++x){if(d[x].trim()==="BOT"){_[++m]=[],g=0;continue}if(!(m<0)){var y=d[x].trim().split(","),S=y[0],C=y[1];++x;for(var b=d[x]||"";(b.match(/["]/g)||[]).length&1&&x<d.length-1;)b+=`
`+d[++x];switch(b=b.trim(),+S){case-1:if(b==="BOT"){_[++m]=[],g=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?_[m][g]=!0:b==="FALSE"?_[m][g]=!1:isNaN(Ra(C))?isNaN(kl(C).getDate())?_[m][g]=C:_[m][g]=Hr(C):_[m][g]=Ra(C),++g;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),_[m][g++]=b!==""?b:null;break}if(b==="EOD")break}}return c&&c.sheetRows&&(_=_.slice(0,c.sheetRows)),_}function t(l,c){return Pl(e(l,c),c)}function n(l,c){return Ts(t(l,c),c)}var a=(function(){var l=function(m,g,x,_,y){m.push(g),m.push(x+","+_),m.push('"'+y.replace(/"/g,'""')+'"')},c=function(m,g,x,_){m.push(g+","+x),m.push(g==1?'"'+_.replace(/"/g,'""')+'"':_)};return function(m){var g=[],x=mr(m["!ref"]),_,y=Array.isArray(m);l(g,"TABLE",0,1,"sheetjs"),l(g,"VECTORS",0,x.e.r-x.s.r+1,""),l(g,"TUPLES",0,x.e.c-x.s.c+1,""),l(g,"DATA",0,0,"");for(var S=x.s.r;S<=x.e.r;++S){c(g,-1,0,"BOT");for(var C=x.s.c;C<=x.e.c;++C){var b=xt({r:S,c:C});if(_=y?(m[S]||[])[C]:m[b],!_){c(g,1,0,"");continue}switch(_.t){case"n":var E=_.w;!E&&_.v!=null&&(E=_.v),E==null?_.f&&!_.F?c(g,1,0,"="+_.f):c(g,1,0,""):c(g,0,E,"V");break;case"b":c(g,0,_.v?1:0,_.v?"TRUE":"FALSE");break;case"s":c(g,1,0,isNaN(_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=fa(_.z||kt[14],Tn(Hr(_.v)))),c(g,0,_.w,"V");break;default:c(g,1,0,"")}}}c(g,-1,0,"EOD");var D=`\r
`,F=g.join(D);return F}})();return{to_workbook:n,to_sheet:t,from_sheet:a}})(),Vb=(function(){function e(_){return _.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(_){return _.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(_,y){for(var S=_.split(`
`),C=-1,b=-1,E=0,D=[];E!==S.length;++E){var F=S[E].trim().split(":");if(F[0]==="cell"){var O=bn(F[1]);if(D.length<=O.r)for(C=D.length;C<=O.r;++C)D[C]||(D[C]=[]);switch(C=O.r,b=O.c,F[2]){case"t":D[C][b]=e(F[3]);break;case"v":D[C][b]=+F[3];break;case"vtf":var M=F[F.length-1];case"vtc":switch(F[3]){case"nl":D[C][b]=!!+F[4];break;default:D[C][b]=+F[4];break}F[2]=="vtf"&&(D[C][b]=[D[C][b],M])}}}return y&&y.sheetRows&&(D=D.slice(0,y.sheetRows)),D}function n(_,y){return Pl(t(_,y),y)}function a(_,y){return Ts(n(_,y),y)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function g(_){if(!_||!_["!ref"])return"";for(var y=[],S=[],C,b="",E=Al(_["!ref"]),D=Array.isArray(_),F=E.s.r;F<=E.e.r;++F)for(var O=E.s.c;O<=E.e.c;++O)if(b=xt({r:F,c:O}),C=D?(_[F]||[])[O]:_[b],!(!C||C.v==null||C.t==="z")){switch(S=["cell",b,"t"],C.t){case"s":case"str":S.push(r(C.v));break;case"n":C.f?(S[2]="vtf",S[3]="n",S[4]=C.v,S[5]=r(C.f)):(S[2]="v",S[3]=C.v);break;case"b":S[2]="vt"+(C.f?"f":"c"),S[3]="nl",S[4]=C.v?"1":"0",S[5]=r(C.f||(C.v?"TRUE":"FALSE"));break;case"d":var M=Tn(Hr(C.v));S[2]="vtc",S[3]="nd",S[4]=""+M,S[5]=C.w||fa(C.z||kt[14],M);break;case"e":continue}y.push(S.join(":"))}return y.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function x(_){return[l,c,d,c,g(_),m].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:x}})(),Wc=(function(){function e(x,_,y,S,C){C.raw?_[y][S]=x:x===""||(x==="TRUE"?_[y][S]=!0:x==="FALSE"?_[y][S]=!1:isNaN(Ra(x))?isNaN(kl(x).getDate())?_[y][S]=x:_[y][S]=Hr(x):_[y][S]=Ra(x))}function r(x,_){var y=_||{},S=[];if(!x||x.length===0)return S;for(var C=x.split(/[\r\n]/),b=C.length-1;b>=0&&C[b].length===0;)--b;for(var E=10,D=0,F=0;F<=b;++F)D=C[F].indexOf(" "),D==-1?D=C[F].length:D++,E=Math.max(E,D);for(F=0;F<=b;++F){S[F]=[];var O=0;for(e(C[F].slice(0,E).trim(),S,F,O,y),O=1;O<=(C[F].length-E)/10+1;++O)e(C[F].slice(E+(O-1)*10,E+O*10).trim(),S,F,O,y)}return y.sheetRows&&(S=S.slice(0,y.sheetRows)),S}var t={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(x){for(var _={},y=!1,S=0,C=0;S<x.length;++S)(C=x.charCodeAt(S))==34?y=!y:!y&&C in t&&(_[C]=(_[C]||0)+1);C=[];for(S in _)Object.prototype.hasOwnProperty.call(_,S)&&C.push([_[S],S]);if(!C.length){_=n;for(S in _)Object.prototype.hasOwnProperty.call(_,S)&&C.push([_[S],S])}return C.sort(function(b,E){return b[0]-E[0]||n[b[1]]-n[E[1]]}),t[C.pop()[1]]||44}function l(x,_){var y=_||{},S="",C=y.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};x.slice(0,4)=="sep="?x.charCodeAt(5)==13&&x.charCodeAt(6)==10?(S=x.charAt(4),x=x.slice(7)):x.charCodeAt(5)==13||x.charCodeAt(5)==10?(S=x.charAt(4),x=x.slice(6)):S=a(x.slice(0,1024)):y&&y.FS?S=y.FS:S=a(x.slice(0,1024));var E=0,D=0,F=0,O=0,M=0,G=S.charCodeAt(0),I=!1,N=0,q=x.charCodeAt(0);x=x.replace(/\r\n/mg,`
`);var Z=y.dateNF!=null?rw(y.dateNF):null;function me(){var ue=x.slice(O,M),Y={};if(ue.charAt(0)=='"'&&ue.charAt(ue.length-1)=='"'&&(ue=ue.slice(1,-1).replace(/""/g,'"')),ue.length===0)Y.t="z";else if(y.raw)Y.t="s",Y.v=ue;else if(ue.trim().length===0)Y.t="s",Y.v=ue;else if(ue.charCodeAt(0)==61)ue.charCodeAt(1)==34&&ue.charCodeAt(ue.length-1)==34?(Y.t="s",Y.v=ue.slice(2,-1).replace(/""/g,'"')):D2(ue)?(Y.t="n",Y.f=ue.slice(1)):(Y.t="s",Y.v=ue);else if(ue=="TRUE")Y.t="b",Y.v=!0;else if(ue=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(F=Ra(ue)))Y.t="n",y.cellText!==!1&&(Y.w=ue),Y.v=F;else if(!isNaN(kl(ue).getDate())||Z&&ue.match(Z)){Y.z=y.dateNF||kt[14];var se=0;Z&&ue.match(Z)&&(ue=nw(ue,y.dateNF,ue.match(Z)||[]),se=1),y.cellDates?(Y.t="d",Y.v=Hr(ue,se)):(Y.t="n",Y.v=Tn(Hr(ue,se))),y.cellText!==!1&&(Y.w=fa(Y.z,Y.v instanceof Date?Tn(Y.v):Y.v)),y.cellNF||delete Y.z}else Y.t="s",Y.v=ue;if(Y.t=="z"||(y.dense?(C[E]||(C[E]=[]),C[E][D]=Y):C[xt({c:D,r:E})]=Y),O=M+1,q=x.charCodeAt(O),b.e.c<D&&(b.e.c=D),b.e.r<E&&(b.e.r=E),N==G)++D;else if(D=0,++E,y.sheetRows&&y.sheetRows<=E)return!0}e:for(;M<x.length;++M)switch(N=x.charCodeAt(M)){case 34:q===34&&(I=!I);break;case G:case 10:case 13:if(!I&&me())break e;break}return M-O>0&&me(),C["!ref"]=It(b),C}function c(x,_){return!(_&&_.PRN)||_.FS||x.slice(0,4)=="sep="||x.indexOf("	")>=0||x.indexOf(",")>=0||x.indexOf(";")>=0?l(x,_):Pl(r(x,_),_)}function d(x,_){var y="",S=_.type=="string"?[0,0,0,0]:im(x,_);switch(_.type){case"base64":y=Yn(x);break;case"binary":y=x;break;case"buffer":_.codepage==65001?y=x.toString("utf8"):_.codepage&&typeof Bc<"u"||(y=Dt&&Buffer.isBuffer(x)?x.toString("binary"):ho(x));break;case"array":y=co(x);break;case"string":y=x;break;default:throw new Error("Unrecognized type "+_.type)}return S[0]==239&&S[1]==187&&S[2]==191?y=Xt(y.slice(3)):_.type!="string"&&_.type!="buffer"&&_.codepage==65001?y=Xt(y):_.type=="binary"&&typeof Bc<"u",y.slice(0,19)=="socialcalc:version:"?Vb.to_sheet(_.type=="string"?y:Xt(y),_):c(y,_)}function m(x,_){return Ts(d(x,_),_)}function g(x){for(var _=[],y=mr(x["!ref"]),S,C=Array.isArray(x),b=y.s.r;b<=y.e.r;++b){for(var E=[],D=y.s.c;D<=y.e.c;++D){var F=xt({r:b,c:D});if(S=C?(x[b]||[])[D]:x[F],!S||S.v==null){E.push("          ");continue}for(var O=(S.w||(Ni(S),S.w)||"").slice(0,10);O.length<10;)O+=" ";E.push(O+(D===0?" ":""))}_.push(E.join(""))}return _.join(`
`)}return{to_workbook:m,to_sheet:d,from_sheet:g}})();function Gb(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var a=Wb.to_workbook(e,t);return t.WTF=n,a}catch(l){if(t.WTF=n,!l.message.match(/SYLK bad record ID/)&&n)throw l;return Wc.to_workbook(e,r)}}var Oc=(function(){function e(P,W,U){if(P){qr(P,P.l||0);for(var H=U.Enum||fe;P.l<P.length;){var le=P.read_shift(2),ge=H[le]||H[65535],Ce=P.read_shift(2),ke=P.l+Ce,xe=ge.f&&ge.f(P,Ce,U);if(P.l=ke,W(xe,ge,le))return}}}function r(P,W){switch(W.type){case"base64":return t(Ia(Yn(P)),W);case"binary":return t(Ia(P),W);case"buffer":case"array":return t(P,W)}throw"Unsupported type "+W.type}function t(P,W){if(!P)return P;var U=W||{},H=U.dense?[]:{},le="Sheet1",ge="",Ce=0,ke={},xe=[],Ke=[],te={s:{r:0,c:0},e:{r:0,c:0}},Tt=U.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)U.Enum=fe,e(P,function(Ue,Pt,rr){switch(rr){case 0:U.vers=Ue,Ue>=4096&&(U.qpro=!0);break;case 6:te=Ue;break;case 204:Ue&&(ge=Ue);break;case 222:ge=Ue;break;case 15:case 51:U.qpro||(Ue[1].v=Ue[1].v.slice(1));case 13:case 14:case 16:rr==14&&(Ue[2]&112)==112&&(Ue[2]&15)>1&&(Ue[2]&15)<15&&(Ue[1].z=U.dateNF||kt[14],U.cellDates&&(Ue[1].t="d",Ue[1].v=rf(Ue[1].v))),U.qpro&&Ue[3]>Ce&&(H["!ref"]=It(te),ke[le]=H,xe.push(le),H=U.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ue[3],le=ge||"Sheet"+(Ce+1),ge="");var Mt=U.dense?(H[Ue[0].r]||[])[Ue[0].c]:H[xt(Ue[0])];if(Mt){Mt.t=Ue[1].t,Mt.v=Ue[1].v,Ue[1].z!=null&&(Mt.z=Ue[1].z),Ue[1].f!=null&&(Mt.f=Ue[1].f);break}U.dense?(H[Ue[0].r]||(H[Ue[0].r]=[]),H[Ue[0].r][Ue[0].c]=Ue[1]):H[xt(Ue[0])]=Ue[1];break}},U);else if(P[2]==26||P[2]==14)U.Enum=R,P[2]==14&&(U.qpro=!0,P.l=0),e(P,function(Ue,Pt,rr){switch(rr){case 204:le=Ue;break;case 22:Ue[1].v=Ue[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ue[3]>Ce&&(H["!ref"]=It(te),ke[le]=H,xe.push(le),H=U.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},Ce=Ue[3],le="Sheet"+(Ce+1)),Tt>0&&Ue[0].r>=Tt)break;U.dense?(H[Ue[0].r]||(H[Ue[0].r]=[]),H[Ue[0].r][Ue[0].c]=Ue[1]):H[xt(Ue[0])]=Ue[1],te.e.c<Ue[0].c&&(te.e.c=Ue[0].c),te.e.r<Ue[0].r&&(te.e.r=Ue[0].r);break;case 27:Ue[14e3]&&(Ke[Ue[14e3][0]]=Ue[14e3][1]);break;case 1537:Ke[Ue[0]]=Ue[1],Ue[0]==Ce&&(le=Ue[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(H["!ref"]=It(te),ke[ge||le]=H,xe.push(ge||le),!Ke.length)return{SheetNames:xe,Sheets:ke};for(var bt={},yt=[],ut=0;ut<Ke.length;++ut)ke[xe[ut]]?(yt.push(Ke[ut]||xe[ut]),bt[Ke[ut]]=ke[Ke[ut]]||ke[xe[ut]]):(yt.push(Ke[ut]),bt[Ke[ut]]={"!ref":"A1"});return{SheetNames:yt,Sheets:bt}}function n(P,W){var U=W||{};if(+U.codepage>=0&&Fa(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var H=c0(),le=mr(P["!ref"]),ge=Array.isArray(P),Ce=[];Pa(H,0,l(1030)),Pa(H,6,m(le));for(var ke=Math.min(le.e.r,8191),xe=le.s.r;xe<=ke;++xe)for(var Ke=Xr(xe),te=le.s.c;te<=le.e.c;++te){xe===le.s.r&&(Ce[te]=Ir(te));var Tt=Ce[te]+Ke,bt=ge?(P[xe]||[])[te]:P[Tt];if(!(!bt||bt.t=="z"))if(bt.t=="n")(bt.v|0)==bt.v&&bt.v>=-32768&&bt.v<=32767?Pa(H,13,S(xe,te,bt.v)):Pa(H,14,b(xe,te,bt.v));else{var yt=Ni(bt);Pa(H,15,_(xe,te,yt.slice(0,239)))}}return Pa(H,1),H.end()}function a(P,W){var U=W||{};if(+U.codepage>=0&&Fa(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var H=c0();Pa(H,0,c(P));for(var le=0,ge=0;le<P.SheetNames.length;++le)(P.Sheets[P.SheetNames[le]]||{})["!ref"]&&Pa(H,27,Q(P.SheetNames[le],ge++));var Ce=0;for(le=0;le<P.SheetNames.length;++le){var ke=P.Sheets[P.SheetNames[le]];if(!(!ke||!ke["!ref"])){for(var xe=mr(ke["!ref"]),Ke=Array.isArray(ke),te=[],Tt=Math.min(xe.e.r,8191),bt=xe.s.r;bt<=Tt;++bt)for(var yt=Xr(bt),ut=xe.s.c;ut<=xe.e.c;++ut){bt===xe.s.r&&(te[ut]=Ir(ut));var Ue=te[ut]+yt,Pt=Ke?(ke[bt]||[])[ut]:ke[Ue];if(!(!Pt||Pt.t=="z"))if(Pt.t=="n")Pa(H,23,me(bt,ut,Ce,Pt.v));else{var rr=Ni(Pt);Pa(H,22,N(bt,ut,Ce,rr.slice(0,239)))}}++Ce}}return Pa(H,1),H.end()}function l(P){var W=Or(2);return W.write_shift(2,P),W}function c(P){var W=Or(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var U=0,H=0,le=0,ge=0;ge<P.SheetNames.length;++ge){var Ce=P.SheetNames[ge],ke=P.Sheets[Ce];if(!(!ke||!ke["!ref"])){++le;var xe=Al(ke["!ref"]);U<xe.e.r&&(U=xe.e.r),H<xe.e.c&&(H=xe.e.c)}}return U>8191&&(U=8191),W.write_shift(2,U),W.write_shift(1,le),W.write_shift(1,H),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function d(P,W,U){var H={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&U.qpro?(H.s.c=P.read_shift(1),P.l++,H.s.r=P.read_shift(2),H.e.c=P.read_shift(1),P.l++,H.e.r=P.read_shift(2),H):(H.s.c=P.read_shift(2),H.s.r=P.read_shift(2),W==12&&U.qpro&&(P.l+=2),H.e.c=P.read_shift(2),H.e.r=P.read_shift(2),W==12&&U.qpro&&(P.l+=2),H.s.c==65535&&(H.s.c=H.e.c=H.s.r=H.e.r=0),H)}function m(P){var W=Or(8);return W.write_shift(2,P.s.c),W.write_shift(2,P.s.r),W.write_shift(2,P.e.c),W.write_shift(2,P.e.r),W}function g(P,W,U){var H=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(H[0].c=P.read_shift(1),H[3]=P.read_shift(1),H[0].r=P.read_shift(2),P.l+=2):(H[2]=P.read_shift(1),H[0].c=P.read_shift(2),H[0].r=P.read_shift(2)),H}function x(P,W,U){var H=P.l+W,le=g(P,W,U);if(le[1].t="s",U.vers==20768){P.l++;var ge=P.read_shift(1);return le[1].v=P.read_shift(ge,"utf8"),le}return U.qpro&&P.l++,le[1].v=P.read_shift(H-P.l,"cstr"),le}function _(P,W,U){var H=Or(7+U.length);H.write_shift(1,255),H.write_shift(2,W),H.write_shift(2,P),H.write_shift(1,39);for(var le=0;le<H.length;++le){var ge=U.charCodeAt(le);H.write_shift(1,ge>=128?95:ge)}return H.write_shift(1,0),H}function y(P,W,U){var H=g(P,W,U);return H[1].v=P.read_shift(2,"i"),H}function S(P,W,U){var H=Or(7);return H.write_shift(1,255),H.write_shift(2,W),H.write_shift(2,P),H.write_shift(2,U,"i"),H}function C(P,W,U){var H=g(P,W,U);return H[1].v=P.read_shift(8,"f"),H}function b(P,W,U){var H=Or(13);return H.write_shift(1,255),H.write_shift(2,W),H.write_shift(2,P),H.write_shift(8,U,"f"),H}function E(P,W,U){var H=P.l+W,le=g(P,W,U);if(le[1].v=P.read_shift(8,"f"),U.qpro)P.l=H;else{var ge=P.read_shift(2);M(P.slice(P.l,P.l+ge),le),P.l+=ge}return le}function D(P,W,U){var H=W&32768;return W&=-32769,W=(H?P:0)+(W>=8192?W-16384:W),(H?"":"$")+(U?Ir(W):Xr(W))}var F={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},O=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(P,W){qr(P,0);for(var U=[],H=0,le="",ge="",Ce="",ke="";P.l<P.length;){var xe=P[P.l++];switch(xe){case 0:U.push(P.read_shift(8,"f"));break;case 1:ge=D(W[0].c,P.read_shift(2),!0),le=D(W[0].r,P.read_shift(2),!1),U.push(ge+le);break;case 2:{var Ke=D(W[0].c,P.read_shift(2),!0),te=D(W[0].r,P.read_shift(2),!1);ge=D(W[0].c,P.read_shift(2),!0),le=D(W[0].r,P.read_shift(2),!1),U.push(Ke+te+":"+ge+le)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(P.read_shift(2));break;case 6:{for(var Tt="";xe=P[P.l++];)Tt+=String.fromCharCode(xe);U.push('"'+Tt.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:ke=U.pop(),Ce=U.pop(),U.push(["AND","OR"][xe-20]+"("+Ce+","+ke+")");break;default:if(xe<32&&O[xe])ke=U.pop(),Ce=U.pop(),U.push(Ce+O[xe]+ke);else if(F[xe]){if(H=F[xe][1],H==69&&(H=P[P.l++]),H>U.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+U.join("|")+"|");return}var bt=U.slice(-H);U.length-=H,U.push(F[xe][0]+"("+bt.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}U.length==1?W[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function G(P){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=P.read_shift(2),W[3]=P[P.l++],W[0].c=P[P.l++],W}function I(P,W){var U=G(P);return U[1].t="s",U[1].v=P.read_shift(W-4,"cstr"),U}function N(P,W,U,H){var le=Or(6+H.length);le.write_shift(2,P),le.write_shift(1,U),le.write_shift(1,W),le.write_shift(1,39);for(var ge=0;ge<H.length;++ge){var Ce=H.charCodeAt(ge);le.write_shift(1,Ce>=128?95:Ce)}return le.write_shift(1,0),le}function q(P,W){var U=G(P);U[1].v=P.read_shift(2);var H=U[1].v>>1;if(U[1].v&1)switch(H&7){case 0:H=(H>>3)*5e3;break;case 1:H=(H>>3)*500;break;case 2:H=(H>>3)/20;break;case 3:H=(H>>3)/200;break;case 4:H=(H>>3)/2e3;break;case 5:H=(H>>3)/2e4;break;case 6:H=(H>>3)/16;break;case 7:H=(H>>3)/64;break}return U[1].v=H,U}function Z(P,W){var U=G(P),H=P.read_shift(4),le=P.read_shift(4),ge=P.read_shift(2);if(ge==65535)return H===0&&le===3221225472?(U[1].t="e",U[1].v=15):H===0&&le===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var Ce=ge&32768;return ge=(ge&32767)-16446,U[1].v=(1-Ce*2)*(le*Math.pow(2,ge+32)+H*Math.pow(2,ge)),U}function me(P,W,U,H){var le=Or(14);if(le.write_shift(2,P),le.write_shift(1,U),le.write_shift(1,W),H==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var ge=0,Ce=0,ke=0,xe=0;return H<0&&(ge=1,H=-H),Ce=Math.log2(H)|0,H/=Math.pow(2,Ce-31),xe=H>>>0,(xe&2147483648)==0&&(H/=2,++Ce,xe=H>>>0),H-=xe,xe|=2147483648,xe>>>=0,H*=Math.pow(2,32),ke=H>>>0,le.write_shift(4,ke),le.write_shift(4,xe),Ce+=16383+(ge?32768:0),le.write_shift(2,Ce),le}function ue(P,W){var U=Z(P);return P.l+=W-14,U}function Y(P,W){var U=G(P),H=P.read_shift(4);return U[1].v=H>>6,U}function se(P,W){var U=G(P),H=P.read_shift(8,"f");return U[1].v=H,U}function ve(P,W){var U=se(P);return P.l+=W-10,U}function ee(P,W){return P[P.l+W-1]==0?P.read_shift(W,"cstr"):""}function ce(P,W){var U=P[P.l++];U>W-1&&(U=W-1);for(var H="";H.length<U;)H+=String.fromCharCode(P[P.l++]);return H}function V(P,W,U){if(!(!U.qpro||W<21)){var H=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var le=P.read_shift(W-21,"cstr");return[H,le]}}function ie(P,W){for(var U={},H=P.l+W;P.l<H;){var le=P.read_shift(2);if(le==14e3){for(U[le]=[0,""],U[le][0]=P.read_shift(2);P[P.l];)U[le][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return U}function Q(P,W){var U=Or(5+P.length);U.write_shift(2,14e3),U.write_shift(2,W);for(var H=0;H<P.length;++H){var le=P.charCodeAt(H);U[U.l++]=le>127?95:le}return U[U.l++]=0,U}var fe={0:{n:"BOF",f:Sr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:y},14:{n:"NUMBER",f:C},15:{n:"LABEL",f:x},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:x},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:ce},65535:{n:""}},R={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:Z},24:{n:"NUMBER18",f:q},25:{n:"FORMULA19",f:ue},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:se},40:{n:"FORMULA28",f:ve},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:V},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:r}})();function Zb(e){var r={},t=e.match(mn),n=0,a=!1;if(t)for(;n!=t.length;++n){var l=ft(t[n]);switch(l[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!l.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(l.val=="1")break;r.cp=L0[parseInt(l.val,10)];break;case"<outline":if(!l.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=l.val;break;case"<sz":r.sz=l.val;break;case"<strike":if(!l.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!l.val)break;switch(l.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(l.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(l.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":l.rgb&&(r.color=l.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=l.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=l.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(l[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+l[0])}}return r}var Kb=(function(){var e=Uc("t"),r=Uc("rPr");function t(l){var c=l.match(e);if(!c)return{t:"s",v:""};var d={t:"s",v:Lt(c[1])},m=l.match(r);return m&&(d.s=Zb(m[1])),d}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(a).map(t).filter(function(d){return d.v})}})(),qb=(function(){var r=/(\r\n|\n)/g;function t(a,l,c){var d=[];a.u&&d.push("text-decoration: underline;"),a.uval&&d.push("text-underline-style:"+a.uval+";"),a.sz&&d.push("font-size:"+a.sz+"pt;"),a.outline&&d.push("text-effect: outline;"),a.shadow&&d.push("text-shadow: auto;"),l.push('<span style="'+d.join("")+'">'),a.b&&(l.push("<b>"),c.push("</b>")),a.i&&(l.push("<i>"),c.push("</i>")),a.strike&&(l.push("<s>"),c.push("</s>"));var m=a.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(l.push("<"+m+">"),c.push("</"+m+">")),c.push("</span>"),a}function n(a){var l=[[],a.v,[]];return a.v?(a.s&&t(a.s,l[0],l[2]),l[0].join("")+l[1].replace(r,"<br/>")+l[2].join("")):""}return function(l){return l.map(n).join("")}})(),Yb=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Xb=/<(?:\w+:)?r>/,Jb=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function J0(e,r){var t=r?r.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Lt(Xt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Xt(e),t&&(n.h=$0(n.t))):e.match(Xb)&&(n.r=Xt(e),n.t=Lt(Xt((e.replace(Jb,"").match(Yb)||[]).join("").replace(mn,""))),t&&(n.h=qb(Kb(n.r)))),n):{t:""}}var Qb=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,eS=/<(?:\w+:)?(?:si|sstItem)>/g,tS=/<\/(?:\w+:)?(?:si|sstItem)>/;function rS(e,r){var t=[],n="";if(!e)return t;var a=e.match(Qb);if(a){n=a[2].replace(eS,"").split(tS);for(var l=0;l!=n.length;++l){var c=J0(n[l].trim(),r);c!=null&&(t[t.length]=c)}a=ft(a[1]),t.Count=a.count,t.Unique=a.uniqueCount}return t}function nS(e){return[e.read_shift(4),e.read_shift(4)]}function aS(e,r){var t=[],n=!1;return Di(e,function(l,c,d){switch(d){case 159:t.Count=l[0],t.Unique=l[1];break;case 19:t.push(l);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||r.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),t}function s1(e){for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function Pi(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function iS(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=Pi(e,4),r.U=Pi(e,4),r.W=Pi(e,4),r}function sS(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},a=e.read_shift(4),l=[];a-- >0;)l.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=l,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function oS(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(sS(e));return r}function lS(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function cS(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=Pi(e,4),r.U=Pi(e,4),r.W=Pi(e,4),r}function uS(e){var r=cS(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function o1(e,r){var t=e.l+r,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function l1(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function dS(e){var r=Pi(e);switch(r.Minor){case 2:return[r.Minor,fS(e)];case 3:return[r.Minor,hS()];case 4:return[r.Minor,mS(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function fS(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),n=o1(e,t),a=l1(e,e.length-e.l);return{t:"Std",h:n,v:a}}function hS(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mS(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(mn,function(l){var c=ft(l);switch(ei(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(d){n[d]=c[d]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function pS(e,r){var t={},n=t.EncryptionVersionInfo=Pi(e,4);if(r-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var a=e.read_shift(4);return r-=4,t.EncryptionHeader=o1(e,a),r-=a,t.EncryptionVerifier=l1(e,r),t}function gS(e){var r={},t=r.EncryptionVersionInfo=Pi(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function vS(e){var r=0,t,n=s1(e),a=n.length+1,l,c,d,m,g;for(t=ks(a),t[0]=n.length,l=1;l!=a;++l)t[l]=n[l-1];for(l=a-1;l>=0;--l)c=t[l],d=(r&16384)===0?0:1,m=r<<1&32767,g=d|m,r=g^c;return r^52811}var c1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},a=function(c,d){return n(c^d)},l=function(c){for(var d=r[c.length-1],m=104,g=c.length-1;g>=0;--g)for(var x=c[g],_=0;_!=7;++_)x&64&&(d^=t[m]),x*=2,--m;return d};return function(c){for(var d=s1(c),m=l(d),g=d.length,x=ks(16),_=0;_!=16;++_)x[_]=0;var y,S,C;for((g&1)===1&&(y=m>>8,x[g]=a(e[0],y),--g,y=m&255,S=d[d.length-1],x[g]=a(S,y));g>0;)--g,y=m>>8,x[g]=a(d[g],y),--g,y=m&255,x[g]=a(d[g],y);for(g=15,C=15-d.length;C>0;)y=m>>8,x[g]=a(e[C],y),--g,--C,y=m&255,x[g]=a(d[g],y),--g,--C;return x}})(),xS=function(e,r,t,n,a){a||(a=r),n||(n=c1(e));var l,c;for(l=0;l!=r.length;++l)c=r[l],c^=n[t],c=(c>>5|c<<3)&255,a[l]=c,++t;return[a,t,n]},yS=function(e){var r=0,t=c1(e);return function(n){var a=xS("",n,r,t);return r=a[1],a[0]}};function _S(e,r,t,n){var a={key:Sr(e),verificationBytes:Sr(e)};return t.password&&(a.verifier=vS(t.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=yS(t.password)),a}function wS(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=gS(e):n.Data=pS(e,r),n}function kS(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?wS(e,r-2,n):_S(e,t.biff>=8?r:r-2,t,n),n}var bS=(function(){function e(a,l){switch(l.type){case"base64":return r(Yn(a),l);case"binary":return r(a,l);case"buffer":return r(Dt&&Buffer.isBuffer(a)?a.toString("binary"):ho(a),l);case"array":return r(co(a),l)}throw new Error("Unrecognized type "+l.type)}function r(a,l){var c=l||{},d=c.dense?[]:{},m=a.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(x,_){Array.isArray(d)&&(d[_]=[]);for(var y=/\\\w+\b/g,S=0,C,b=-1;C=y.exec(x);){switch(C[0]){case"\\cell":var E=x.slice(S,y.lastIndex-C[0].length);if(E[0]==" "&&(E=E.slice(1)),++b,E.length){var D={v:E,t:"s"};Array.isArray(d)?d[_][b]=D:d[xt({r:_,c:b})]=D}break}S=y.lastIndex}b>g.e.c&&(g.e.c=b)}),d["!ref"]=It(g),d}function t(a,l){return Ts(e(a,l),l)}function n(a){for(var l=["{\\rtf1\\ansi"],c=mr(a["!ref"]),d,m=Array.isArray(a),g=c.s.r;g<=c.e.r;++g){l.push("\\trowd\\trautofit1");for(var x=c.s.c;x<=c.e.c;++x)l.push("\\cellx"+(x+1));for(l.push("\\pard\\intbl"),x=c.s.c;x<=c.e.c;++x){var _=xt({r:g,c:x});d=m?(a[g]||[])[x]:a[_],!(!d||d.v==null&&(!d.f||d.F))&&(l.push(" "+(d.w||(Ni(d),d.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:n}})();function SS(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Hc(e){for(var r=0,t=1;r!=3;++r)t=t*256+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function TS(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,a=Math.max(r,t,n),l=Math.min(r,t,n),c=a-l;if(c===0)return[0,0,r];var d=0,m=0,g=a+l;switch(m=c/(g>1?2-g:g),a){case r:d=((t-n)/c+6)%6;break;case t:d=(n-r)/c+2;break;case n:d=(r-t)/c+4;break}return[d/6,m,g/2]}function ES(e){var r=e[0],t=e[1],n=e[2],a=t*2*(n<.5?n:1-n),l=n-a/2,c=[l,l,l],d=6*r,m;if(t!==0)switch(d|0){case 0:case 6:m=a*d,c[0]+=a,c[1]+=m;break;case 1:m=a*(2-d),c[0]+=m,c[1]+=a;break;case 2:m=a*(d-2),c[1]+=a,c[2]+=m;break;case 3:m=a*(4-d),c[1]+=m,c[2]+=a;break;case 4:m=a*(d-4),c[2]+=a,c[0]+=m;break;case 5:m=a*(6-d),c[2]+=m,c[0]+=a;break}for(var g=0;g!=3;++g)c[g]=Math.round(c[g]*255);return c}function Zd(e,r){if(r===0)return e;var t=TS(SS(e));return r<0?t[2]=t[2]*(1+r):t[2]=1-(1-t[2])*(1-r),Hc(ES(t))}var u1=6,CS=15,AS=1,kn=u1;function Kd(e){return Math.floor((e+Math.round(128/kn)/256)*kn)}function qd(e){return Math.floor((e-5)/kn*100+.5)/100}function h0(e){return Math.round((e*kn+5)/kn*256)/256}function Uh(e){return h0(qd(Kd(e)))}function Q0(e){var r=Math.abs(e-Uh(e)),t=kn;if(r>.005)for(kn=AS;kn<CS;++kn)Math.abs(e-Uh(e))<=r&&(r=Math.abs(e-Uh(e)),t=kn);kn=t}function bl(e){e.width?(e.wpx=Kd(e.width),e.wch=qd(e.wpx),e.MDW=kn):e.wpx?(e.wch=qd(e.wpx),e.width=h0(e.wch),e.MDW=kn):typeof e.wch=="number"&&(e.width=h0(e.wch),e.wpx=Kd(e.width),e.MDW=kn),e.customWidth&&delete e.customWidth}var PS=96,d1=PS;function f1(e){return e*96/d1}function Vc(e){return e*d1/96}var NS={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function DS(e,r,t,n){r.Borders=[];var a={},l=!1;(e[0].match(mn)||[]).forEach(function(c){var d=ft(c);switch(ei(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},d.diagonalUp&&(a.diagonalUp=ar(d.diagonalUp)),d.diagonalDown&&(a.diagonalDown=ar(d.diagonalDown)),r.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+d[0]+" in borders")}})}function OS(e,r,t,n){r.Fills=[];var a={},l=!1;(e[0].match(mn)||[]).forEach(function(c){var d=ft(c);switch(ei(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},r.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":d.patternType&&(a.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),d.indexed&&(a.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(a.bgColor.theme=parseInt(d.theme,10)),d.tint&&(a.bgColor.tint=parseFloat(d.tint)),d.rgb&&(a.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),d.theme&&(a.fgColor.theme=parseInt(d.theme,10)),d.tint&&(a.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(a.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fills")}})}function IS(e,r,t,n){r.Fonts=[];var a={},l=!1;(e[0].match(mn)||[]).forEach(function(c){var d=ft(c);switch(ei(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(a),a={};break;case"<name":d.val&&(a.name=Xt(d.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=d.val?ar(d.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=d.val?ar(d.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(d.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=d.val?ar(d.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=d.val?ar(d.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=d.val?ar(d.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=d.val?ar(d.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=d.val?ar(d.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":d.val&&(a.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(a.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(a.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(a.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=L0[parseInt(d.val,10)];break;case"<color":if(a.color||(a.color={}),d.auto&&(a.color.auto=ar(d.auto)),d.rgb)a.color.rgb=d.rgb.slice(-6);else if(d.indexed){a.color.index=parseInt(d.indexed,10);var m=so[a.color.index];a.color.index==81&&(m=so[1]),m||(m=so[1]),a.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else d.theme&&(a.color.theme=parseInt(d.theme,10),d.tint&&(a.color.tint=parseFloat(d.tint)),d.theme&&t.themeElements&&t.themeElements.clrScheme&&(a.color.rgb=Zd(t.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":l=!0;break;case"</AlternateContent>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(n&&n.WTF&&!l)throw new Error("unrecognized "+d[0]+" in fonts")}})}function FS(e,r,t){r.NumberFmt=[];for(var n=Ja(kt),a=0;a<n.length;++a)r.NumberFmt[n[a]]=kt[n[a]];var l=e[0].match(mn);if(l)for(a=0;a<l.length;++a){var c=ft(l[a]);switch(ei(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=Lt(Xt(c.formatCode)),m=parseInt(c.numFmtId,10);if(r.NumberFmt[m]=d,m>0){if(m>392){for(m=392;m>60&&r.NumberFmt[m]!=null;--m);r.NumberFmt[m]=d}io(d,m)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var yd=["numFmtId","fillId","fontId","borderId","xfId"],_d=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function LS(e,r,t){r.CellXf=[];var n,a=!1;(e[0].match(mn)||[]).forEach(function(l){var c=ft(l),d=0;switch(ei(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],d=0;d<yd.length;++d)n[yd[d]]&&(n[yd[d]]=parseInt(n[yd[d]],10));for(d=0;d<_d.length;++d)n[_d[d]]&&(n[_d[d]]=ar(n[_d[d]]));if(r.NumberFmt&&n.numFmtId>392){for(d=392;d>60;--d)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[d]){n.numFmtId=d;break}}r.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};c.vertical&&(m.vertical=c.vertical),c.horizontal&&(m.horizontal=c.horizontal),c.textRotation!=null&&(m.textRotation=c.textRotation),c.indent&&(m.indent=c.indent),c.wrapText&&(m.wrapText=ar(c.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(t&&t.WTF&&!a)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var RS=(function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,l=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,m,g){var x={};if(!d)return x;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var _;return(_=d.match(r))&&FS(_,x,g),(_=d.match(a))&&IS(_,x,m,g),(_=d.match(n))&&OS(_,x,m,g),(_=d.match(l))&&DS(_,x,m,g),(_=d.match(t))&&LS(_,x,g),x}})();function jS(e,r){var t=e.read_shift(2),n=fn(e);return[t,n]}function MS(e,r,t){var n={};n.sz=e.read_shift(2)/20;var a=Kw(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var l=e.read_shift(2);switch(l===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=e.read_shift(1);c!=0&&(n.underline=c);var d=e.read_shift(1);d>0&&(n.family=d);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=Zw(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=fn(e),n}var BS=hn;function zS(e,r){var t=e.l+r,n=e.read_shift(2),a=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:a}}var US=hn;function $S(e,r,t){var n={};n.NumberFmt=[];for(var a in kt)n.NumberFmt[a]=kt[a];n.CellXf=[],n.Fonts=[];var l=[],c=!1;return Di(e,function(m,g,x){switch(x){case 44:n.NumberFmt[m[0]]=m[1],io(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(m.color.rgb=Zd(r.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:l[l.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:l.push(x),c=!0;break;case 38:l.pop(),c=!1;break;default:if(g.T>0)l.push(x);else if(g.T<0)l.pop();else if(!c||t.WTF&&l[l.length-1]!=37)throw new Error("Unexpected record 0x"+x.toString(16))}}),n}var WS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function HS(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(mn)||[]).forEach(function(a){var l=ft(a);switch(l[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=l.val;break;case"<a:sysClr":n.rgb=l.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":l[0].charAt(1)==="/"?(r.themeElements.clrScheme[WS.indexOf(l[0])]=n,n={}):n.name=l[0].slice(3,l[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+l[0]+" in clrScheme")}})}function VS(){}function GS(){}var ZS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,KS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,qS=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function YS(e,r,t){r.themeElements={};var n;[["clrScheme",ZS,HS],["fontScheme",KS,VS],["fmtScheme",qS,GS]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,r,t)})}var XS=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function h1(e,r){(!e||e.length===0)&&(e=JS());var t,n={};if(!(t=e.match(XS)))throw new Error("themeElements not found in theme");return YS(t[0],n,r),n.raw=e,n}function JS(e,r){var t=[Sx];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface=" "/>',t[t.length]='<a:font script="Hang" typeface=" "/>',t[t.length]='<a:font script="Hans" typeface=""/>',t[t.length]='<a:font script="Hant" typeface=""/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function QS(e,r,t){var n=e.l+r,a=e.read_shift(4);if(a!==124226){if(!t.cellStyles){e.l=n;return}var l=e.slice(e.l);e.l=n;var c;try{c=bx(l,{type:"array"})}catch{return}var d=qn(c,"theme/theme/theme1.xml",!0);if(d)return h1(d,t)}}function e2(e){return e.read_shift(4)}function t2(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=r2(e,4);break;case 2:r.xclrValue=Qx(e);break;case 3:r.xclrValue=e2(e);break;case 4:e.l+=4;break}return e.l+=8,r}function r2(e,r){return hn(e,r)}function n2(e,r){return hn(e,r)}function a2(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=t2(e);break;case 6:n[1]=n2(e,t);break;case 14:case 15:n[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function i2(e,r){var t=e.l+r;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),l=[];a-- >0;)l.push(a2(e,t-e.l));return{ixfe:n,ext:l}}function s2(e,r){r.forEach(function(t){t[0]})}function o2(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:fn(e)}}function l2(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function c2(e){return e.l+=4,e.read_shift(4)!=0}function u2(e,r,t){var n={Types:[],Cell:[],Value:[]},a=t||{},l=[],c=!1,d=2;return Di(e,function(m,g,x){switch(x){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(_){d==1?n.Cell.push({type:n.Types[_[0]-1].name,index:_[1]}):d==0&&n.Value.push({type:n.Types[_[0]-1].name,index:_[1]})});break;case 337:d=m?1:0;break;case 338:d=2;break;case 35:l.push(x),c=!0;break;case 36:l.pop(),c=!1;break;default:if(!g.T){if(!c||a.WTF&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}}),n}function d2(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,l=2,c;return e.replace(mn,function(d){var m=ft(d);switch(ei(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var g=0;g<n.Types.length;++g)n.Types[g].name==m.name&&(c=n.Types[g]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":l==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):l==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":l=1;break;case"</cellMetadata>":l=2;break;case"<valueMetadata":l=0;break;case"</valueMetadata>":l=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+m.i);break;default:if(!a&&t.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return d}),n}function f2(e){var r=[];if(!e)return r;var t=1;return(e.match(mn)||[]).forEach(function(n){var a=ft(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,r.push(a);break}}),r}function h2(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=xt(t);var n=e.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function m2(e,r,t){var n=[];return Di(e,function(l,c,d){switch(d){case 63:n.push(l);break;default:if(!c.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function p2(e,r,t,n){if(!e)return e;var a=n||{},l=!1;Di(e,function(d,m,g){switch(g){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:l=!0;break;case 36:l=!1;break;default:if(!m.T){if(!l||a.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}},a)}function g2(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][t].Target}function Zg(e,r,t,n){var a=Array.isArray(e),l;r.forEach(function(c){var d=bn(c.ref);if(a?(e[d.r]||(e[d.r]=[]),l=e[d.r][d.c]):l=e[c.ref],!l){l={t:"z"},a?e[d.r][d.c]=l:e[c.ref]=l;var m=mr(e["!ref"]||"BDWGO1000001:A1");m.s.r>d.r&&(m.s.r=d.r),m.e.r<d.r&&(m.e.r=d.r),m.s.c>d.c&&(m.s.c=d.c),m.e.c<d.c&&(m.e.c=d.c);var g=It(m);g!==e["!ref"]&&(e["!ref"]=g)}l.c||(l.c=[]);var x={a:c.author,t:c.t,r:c.r,T:t};c.h&&(x.h=c.h);for(var _=l.c.length-1;_>=0;--_){if(!t&&l.c[_].T)return;t&&!l.c[_].T&&l.c.splice(_,1)}if(t&&n){for(_=0;_<n.length;++_)if(x.a==n[_].id){x.a=n[_].name||x.a;break}}l.c.push(x)})}function v2(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var d=c.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&t.push(d[1])}});var l=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return l&&l[1]&&l[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var d=c.match(/<(?:\w+:)?comment[^>]*>/);if(d){var m=ft(d[0]),g={author:m.authorId&&t[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},x=bn(m.ref);if(!(r.sheetRows&&r.sheetRows<=x.r)){var _=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),y=!!_&&!!_[1]&&J0(_[1])||{r:"",t:"",h:""};g.r=y.r,y.r=="<t></t>"&&(y.t=y.h=""),g.t=(y.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(g.h=y.h),n.push(g)}}}}),n}function x2(e,r){var t=[],n=!1,a={},l=0;return e.replace(mn,function(d,m){var g=ft(d);switch(ei(g[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:g.personId,guid:g.id,ref:g.ref,T:1};break;case"</threadedComment>":a.t!=null&&t.push(a);break;case"<text>":case"<text":l=m+d.length;break;case"</text>":a.t=e.slice(l,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+g[0]+" in threaded comments")}return d}),t}function y2(e,r){var t=[],n=!1;return e.replace(mn,function(l){var c=ft(l);switch(ei(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return l}),t}function _2(e){var r={};r.iauthor=e.read_shift(4);var t=po(e);return r.rfx=t.s,r.ref=xt(t.s),e.l+=16,r}var w2=fn;function k2(e,r){var t=[],n=[],a={},l=!1;return Di(e,function(d,m,g){switch(g){case 632:n.push(d);break;case 635:a=d;break;case 637:a.t=d.t,a.h=d.h,a.r=d.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,r.sheetRows&&a.rfx&&r.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,t.push(a);break;case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!l||r.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}),t}var b2="application/vnd.ms-office.vbaProject";function S2(e){var r=Ot.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var a=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ot.utils.cfb_add(r,a,e.FileIndex[n].content)}}),Ot.write(r)}function T2(){return{"!type":"dialog"}}function E2(){return{"!type":"dialog"}}function C2(){return{"!type":"macro"}}function A2(){return{"!type":"macro"}}var _l=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,a,l,c){var d=!1,m=!1;l.length==0?m=!0:l.charAt(0)=="["&&(m=!0,l=l.slice(1,-1)),c.length==0?d=!0:c.charAt(0)=="["&&(d=!0,c=c.slice(1,-1));var g=l.length>0?parseInt(l,10)|0:0,x=c.length>0?parseInt(c,10)|0:0;return d?x+=r.c:--x,m?g+=r.r:--g,a+(d?"":"$")+Ir(x)+(m?"":"$")+Xr(g)}return function(a,l){return r=l,a.replace(e,t)}})(),m1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,P2=(function(){return function(r,t){return r.replace(m1,function(n,a,l,c,d,m){var g=G0(c)-(l?0:t.c),x=V0(m)-(d?0:t.r),_=x==0?"":d?x+1:"["+x+"]",y=g==0?"":l?g+1:"["+g+"]";return a+"R"+_+"C"+y})}})();function p1(e,r){return e.replace(m1,function(t,n,a,l,c,d){return n+(a=="$"?a+l:Ir(G0(l)+r.c))+(c=="$"?c+d:Xr(V0(d)+r.r))})}function N2(e,r,t){var n=Al(r),a=n.s,l=bn(t),c={r:l.r-a.r,c:l.c-a.c};return p1(e,c)}function D2(e){return e.length!=1}function Kg(e){return e.replace(/_xlfn\./g,"")}function kr(e){e.l+=1}function bs(e,r){var t=e.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function g1(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return v1(e);t.biff==12&&(n=4)}var a=e.read_shift(n),l=e.read_shift(n),c=bs(e),d=bs(e);return{s:{r:a,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:d[0],cRel:d[1],rRel:d[2]}}}function v1(e){var r=bs(e),t=bs(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:a,cRel:t[1],rRel:t[2]}}}function O2(e,r,t){if(t.biff<8)return v1(e);var n=e.read_shift(t.biff==12?4:2),a=e.read_shift(t.biff==12?4:2),l=bs(e),c=bs(e);return{s:{r:n,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function x1(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return I2(e);var n=e.read_shift(t&&t.biff==12?4:2),a=bs(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function I2(e){var r=bs(e),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}function F2(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function L2(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return R2(e);var a=e.read_shift(n>=12?4:2),l=e.read_shift(2),c=(l&16384)>>14,d=(l&32768)>>15;if(l&=16383,d==1)for(;a>524287;)a-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:a,c:l,cRel:c,rRel:d}}function R2(e){var r=e.read_shift(2),t=e.read_shift(1),n=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),a==1&&t>=128&&(t=t-256),{r,c:t,cRel:a,rRel:n}}function j2(e,r,t){var n=(e[e.l++]&96)>>5,a=g1(e,t.biff>=2&&t.biff<=5?6:8,t);return[n,a]}function M2(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}var c=g1(e,l,t);return[n,a,c]}function B2(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}function z2(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),l=8;if(t)switch(t.biff){case 5:e.l+=12,l=6;break;case 12:l=12;break}return e.l+=l,[n,a]}function U2(e,r,t){var n=(e[e.l++]&96)>>5,a=O2(e,r-1,t);return[n,a]}function $2(e,r,t){var n=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[n]}function qg(e){var r=e[e.l+1]&1,t=1;return e.l+=4,[r,t]}function W2(e,r,t){e.l+=2;for(var n=e.read_shift(t&&t.biff==2?1:2),a=[],l=0;l<=n;++l)a.push(e.read_shift(t&&t.biff==2?1:2));return a}function H2(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function V2(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(t&&t.biff==2?1:2)]}function G2(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function Z2(e,r,t){var n=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[n]}function y1(e){var r=e.read_shift(1),t=e.read_shift(1);return[r,t]}function K2(e){return e.read_shift(2),y1(e)}function q2(e){return e.read_shift(2),y1(e)}function Y2(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=x1(e,0,t);return[n,a]}function X2(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=L2(e,0,t);return[n,a]}function J2(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var l=x1(e,0,t);return[n,a,l]}function Q2(e,r,t){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(t&&t.biff<=3?1:2);return[eE[a],k1[a],n]}function eT(e,r,t){var n=e[e.l++],a=e.read_shift(1),l=t&&t.biff<=3?[n==88?-1:0,e.read_shift(1)]:tT(e);return[a,(l[0]===0?k1:QT)[l[1]]]}function tT(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function rT(e,r,t){e.l+=t&&t.biff==2?3:4}function nT(e,r,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function aT(e){return e.l++,go[e.read_shift(1)]}function iT(e){return e.l++,e.read_shift(2)}function sT(e){return e.l++,e.read_shift(1)!==0}function oT(e){return e.l++,un(e)}function lT(e,r,t){return e.l++,Jc(e,r-1,t)}function cT(e,r){var t=[e.read_shift(1)];if(r==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=yr(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:t[1]=go[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=un(e);break;case 2:t[1]=vo(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function uT(e,r,t){for(var n=e.read_shift(t.biff==12?4:2),a=[],l=0;l!=n;++l)a.push((t.biff==12?po:nf)(e));return a}function dT(e,r,t){var n=0,a=0;t.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,--a==0&&(a=256));for(var l=0,c=[];l!=n&&(c[l]=[]);++l)for(var d=0;d!=a;++d)c[l][d]=cT(e,t.biff);return c}function fT(e,r,t){var n=e.read_shift(1)>>>5&3,a=!t||t.biff>=8?4:2,l=e.read_shift(a);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,l]}function hT(e,r,t){if(t.biff==5)return mT(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),l=e.read_shift(4);return[n,a,l]}function mT(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}function pT(e,r,t){var n=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function gT(e,r,t){var n=e.read_shift(1)>>>5&3,a=e.read_shift(t&&t.biff==2?1:2);return[n,a]}function vT(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[n]}function xT(e,r,t){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return e.l+=l,[n,a]}var yT=hn,_T=hn,wT=hn;function eu(e,r,t){return e.l+=2,[F2(e)]}function em(e){return e.l+=6,[]}var kT=eu,bT=em,ST=em,TT=eu;function _1(e){return e.l+=2,[Sr(e),e.read_shift(2)&1]}var ET=eu,CT=_1,AT=em,PT=eu,NT=eu,DT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function OT(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),l=e.read_shift(2),c=DT[t>>2&31];return{ixti:r,coltype:t&3,rt:c,idx:n,c:a,C:l}}function IT(e){return e.l+=2,[e.read_shift(4)]}function FT(e,r,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function LT(e,r,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function RT(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function jT(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[r,t]}function MT(e){return e.l+=4,[0,0]}var Yg={1:{n:"PtgExp",f:nT},2:{n:"PtgTbl",f:wT},3:{n:"PtgAdd",f:kr},4:{n:"PtgSub",f:kr},5:{n:"PtgMul",f:kr},6:{n:"PtgDiv",f:kr},7:{n:"PtgPower",f:kr},8:{n:"PtgConcat",f:kr},9:{n:"PtgLt",f:kr},10:{n:"PtgLe",f:kr},11:{n:"PtgEq",f:kr},12:{n:"PtgGe",f:kr},13:{n:"PtgGt",f:kr},14:{n:"PtgNe",f:kr},15:{n:"PtgIsect",f:kr},16:{n:"PtgUnion",f:kr},17:{n:"PtgRange",f:kr},18:{n:"PtgUplus",f:kr},19:{n:"PtgUminus",f:kr},20:{n:"PtgPercent",f:kr},21:{n:"PtgParen",f:kr},22:{n:"PtgMissArg",f:kr},23:{n:"PtgStr",f:lT},26:{n:"PtgSheet",f:FT},27:{n:"PtgEndSheet",f:LT},28:{n:"PtgErr",f:aT},29:{n:"PtgBool",f:sT},30:{n:"PtgInt",f:iT},31:{n:"PtgNum",f:oT},32:{n:"PtgArray",f:$2},33:{n:"PtgFunc",f:Q2},34:{n:"PtgFuncVar",f:eT},35:{n:"PtgName",f:fT},36:{n:"PtgRef",f:Y2},37:{n:"PtgArea",f:j2},38:{n:"PtgMemArea",f:pT},39:{n:"PtgMemErr",f:yT},40:{n:"PtgMemNoMem",f:_T},41:{n:"PtgMemFunc",f:gT},42:{n:"PtgRefErr",f:vT},43:{n:"PtgAreaErr",f:B2},44:{n:"PtgRefN",f:X2},45:{n:"PtgAreaN",f:U2},46:{n:"PtgMemAreaN",f:RT},47:{n:"PtgMemNoMemN",f:jT},57:{n:"PtgNameX",f:hT},58:{n:"PtgRef3d",f:J2},59:{n:"PtgArea3d",f:M2},60:{n:"PtgRefErr3d",f:xT},61:{n:"PtgAreaErr3d",f:z2},255:{}},BT={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},zT={1:{n:"PtgElfLel",f:_1},2:{n:"PtgElfRw",f:PT},3:{n:"PtgElfCol",f:kT},6:{n:"PtgElfRwV",f:NT},7:{n:"PtgElfColV",f:TT},10:{n:"PtgElfRadical",f:ET},11:{n:"PtgElfRadicalS",f:AT},13:{n:"PtgElfColS",f:bT},15:{n:"PtgElfColSV",f:ST},16:{n:"PtgElfRadicalLel",f:CT},25:{n:"PtgList",f:OT},29:{n:"PtgSxName",f:IT},255:{}},UT={0:{n:"PtgAttrNoop",f:MT},1:{n:"PtgAttrSemi",f:Z2},2:{n:"PtgAttrIf",f:V2},4:{n:"PtgAttrChoose",f:W2},8:{n:"PtgAttrGoto",f:H2},16:{n:"PtgAttrSum",f:rT},32:{n:"PtgAttrBaxcel",f:qg},33:{n:"PtgAttrBaxcel",f:qg},64:{n:"PtgAttrSpace",f:K2},65:{n:"PtgAttrSpaceSemi",f:q2},128:{n:"PtgAttrIfError",f:G2},255:{}};function tu(e,r,t,n){if(n.biff<8)return hn(e,r);for(var a=e.l+r,l=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=dT(e,0,n),l.push(t[c][1]);break;case"PtgMemArea":t[c][2]=uT(e,t[c][1],n),l.push(t[c][2]);break;case"PtgExp":n&&n.biff==12&&(t[c][1][1]=e.read_shift(4),l.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return r=a-e.l,r!==0&&l.push(hn(e,r)),l}function ru(e,r,t){for(var n=e.l+r,a,l,c=[];n!=e.l;)r=n-e.l,l=e[e.l],a=Yg[l]||Yg[BT[l]],(l===24||l===25)&&(a=(l===24?zT:UT)[e[e.l+1]]),!a||!a.f?hn(e,r):c.push([a.n,a.f(e,r,t)]);return c}function $T(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],a=[],l=0;l<n.length;++l){var c=n[l];if(c)switch(c[0]){case 2:a.push('"'+c[1].replace(/"/g,'""')+'"');break;default:a.push(c[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var WT={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function HT(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function w1(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var a="";if(t.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Xg(e,r,t){var n=w1(e,r,t);return n=="#REF"?n:HT(n,t)}function cn(e,r,t,n,a){var l=a&&a.biff||8,c={s:{c:0,r:0}},d=[],m,g,x,_=0,y=0,S,C="";if(!e[0]||!e[0][0])return"";for(var b=-1,E="",D=0,F=e[0].length;D<F;++D){var O=e[0][D];switch(O[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=d.pop(),g=d.pop(),b>=0){switch(e[0][b][1][0]){case 0:E=hr(" ",e[0][b][1][1]);break;case 1:E=hr("\r",e[0][b][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}g=g+E,b=-1}d.push(g+WT[O[0]]+m);break;case"PtgIsect":m=d.pop(),g=d.pop(),d.push(g+" "+m);break;case"PtgUnion":m=d.pop(),g=d.pop(),d.push(g+","+m);break;case"PtgRange":m=d.pop(),g=d.pop(),d.push(g+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":x=Ac(O[1][1],c,a),d.push(Pc(x,l));break;case"PtgRefN":x=t?Ac(O[1][1],t,a):O[1][1],d.push(Pc(x,l));break;case"PtgRef3d":_=O[1][1],x=Ac(O[1][2],c,a),C=Xg(n,_,a),d.push(C+"!"+Pc(x,l));break;case"PtgFunc":case"PtgFuncVar":var M=O[1][0],G=O[1][1];M||(M=0),M&=127;var I=M==0?[]:d.slice(-M);d.length-=M,G==="User"&&(G=I.shift()),d.push(G+"("+I.join(",")+")");break;case"PtgBool":d.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(O[1]);break;case"PtgNum":d.push(String(O[1]));break;case"PtgStr":d.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(O[1]);break;case"PtgAreaN":S=Dg(O[1][1],t?{s:t}:c,a),d.push(Bh(S,a));break;case"PtgArea":S=Dg(O[1][1],c,a),d.push(Bh(S,a));break;case"PtgArea3d":_=O[1][1],S=O[1][2],C=Xg(n,_,a),d.push(C+"!"+Bh(S,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=O[1][2];var N=(n.names||[])[y-1]||(n[0]||[])[y],q=N?N.Name:"SH33TJSNAME"+String(y);q&&q.slice(0,6)=="_xlfn."&&!a.xlfn&&(q=q.slice(6)),d.push(q);break;case"PtgNameX":var Z=O[1][1];y=O[1][2];var me;if(a.biff<=5)Z<0&&(Z=-Z),n[Z]&&(me=n[Z][y]);else{var ue="";if(((n[Z]||[])[0]||[])[0]==14849||(((n[Z]||[])[0]||[])[0]==1025?n[Z][y]&&n[Z][y].itab>0&&(ue=n.SheetNames[n[Z][y].itab-1]+"!"):ue=n.SheetNames[y-1]+"!"),n[Z]&&n[Z][y])ue+=n[Z][y].Name;else if(n[0]&&n[0][y])ue+=n[0][y].Name;else{var Y=(w1(n,Z,a)||"").split(";;");Y[y-1]?ue=Y[y-1]:ue+="SH33TJSERRX"}d.push(ue);break}me||(me={Name:"SH33TJSERRY"}),d.push(me.Name);break;case"PtgParen":var se="(",ve=")";if(b>=0){switch(E="",e[0][b][1][0]){case 2:se=hr(" ",e[0][b][1][1])+se;break;case 3:se=hr("\r",e[0][b][1][1])+se;break;case 4:ve=hr(" ",e[0][b][1][1])+ve;break;case 5:ve=hr("\r",e[0][b][1][1])+ve;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}d.push(se+d.pop()+ve);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":x={c:O[1][1],r:O[1][0]};var ee={c:t.c,r:t.r};if(n.sharedf[xt(x)]){var ce=n.sharedf[xt(x)];d.push(cn(ce,c,ee,n,a))}else{var V=!1;for(m=0;m!=n.arrayf.length;++m)if(g=n.arrayf[m],!(x.c<g[0].s.c||x.c>g[0].e.c)&&!(x.r<g[0].s.r||x.r>g[0].e.r)){d.push(cn(g[1],c,ee,n,a)),V=!0;break}V||d.push(O[1])}break;case"PtgArray":d.push("{"+$T(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=D;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&ie.indexOf(e[0][D][0])==-1){O=e[0][b];var Q=!0;switch(O[1][0]){case 4:Q=!1;case 0:E=hr(" ",O[1][1]);break;case 5:Q=!1;case 1:E=hr("\r",O[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}d.push((Q?E:"")+d.pop()+(Q?"":E)),b=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return d[0]}function VT(e,r,t){var n=e.l+r,a=t.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],hn(e,r-2)];var d=ru(e,c,t);return r!==c+a&&(l=tu(e,r-c-a,d,t)),e.l=n,[d,l]}function GT(e,r,t){var n=e.l+r,a=t.biff==2?1:2,l,c=e.read_shift(a);if(c==65535)return[[],hn(e,r-2)];var d=ru(e,c,t);return r!==c+a&&(l=tu(e,r-c-a,d,t)),e.l=n,[d,l]}function ZT(e,r,t,n){var a=e.l+r,l=ru(e,n,t),c;return a!==e.l&&(c=tu(e,a-e.l,l,t)),[l,c]}function KT(e,r,t){var n=e.l+r,a,l=e.read_shift(2),c=ru(e,l,t);return l==65535?[[],hn(e,r-2)]:(r!==l+2&&(a=tu(e,n-l-2,c,t)),[c,a])}function qT(e){var r;if(Ci(e,e.l+6)!==65535)return[un(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function $h(e,r,t){var n=e.l+r,a=ti(e);t.biff==2&&++e.l;var l=qT(e),c=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var d=GT(e,n-e.l,t);return{cell:a,val:l[0],formula:d,shared:c>>3&1,tt:l[1]}}function af(e,r,t){var n=e.read_shift(4),a=ru(e,n,t),l=e.read_shift(4),c=l>0?tu(e,l,a,t):null;return[a,c]}var YT=af,sf=af,XT=af,JT=af,QT={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},k1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},eE={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Jg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Wh(e){var r=e.split(":"),t=r[0].split(".")[0];return[t,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var Ic={},wl={};function Fc(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function b1(e,r,t,n,a,l){try{n.cellNF&&(e.z=kt[r])}catch(d){if(n.WTF)throw d}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Hr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(kt[r]==null&&io(tw[r]||"General",r),e.t==="e")e.w=e.w||go[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zc(e.v);else if(e.t==="d"){var c=Tn(e.v);(c|0)===c?e.w=c.toString(10):e.w=zc(c)}else{if(e.v===void 0)return"";e.w=lo(e.v,wl)}else e.t==="d"?e.w=fa(r,Tn(e.v),wl):e.w=fa(r,e.v,wl)}catch(d){if(n.WTF)throw d}if(n.cellStyles&&t!=null)try{e.s=l.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Zd(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Zd(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(n.WTF&&l.Fills)throw d}}}function tE(e,r){var t=mr(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=It(t))}var rE=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,nE=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,aE=/<(?:\w:)?hyperlink [^>]*>/mg,iE=/"(\w*:\w*)"/,sE=/<(?:\w:)?col\b[^>]*[\/]?>/g,oE=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,lE=/<(?:\w:)?pageMargins[^>]*\/>/g,S1=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,cE=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,uE=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function dE(e,r,t,n,a,l,c){if(!e)return e;n||(n={"!id":{}});var d=r.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},g="",x="",_=e.match(nE);_?(g=e.slice(0,_.index),x=e.slice(_.index+_[0].length)):g=x=e;var y=g.match(S1);y?tm(y[0],d,a,t):(y=g.match(cE))&&fE(y[0],y[1]||"",d,a,t);var S=(g.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(S>0){var C=g.slice(S,S+50).match(iE);C&&tE(d,C[1])}var b=g.match(uE);b&&b[1]&&xE(b[1],a);var E=[];if(r.cellStyles){var D=g.match(sE);D&&pE(E,D)}_&&yE(_[1],d,r,m,l,c);var F=x.match(oE);F&&(d["!autofilter"]=gE(F[0]));var O=[],M=x.match(rE);if(M)for(S=0;S!=M.length;++S)O[S]=mr(M[S].slice(M[S].indexOf('"')+1));var G=x.match(aE);G&&hE(d,G,n);var I=x.match(lE);if(I&&(d["!margins"]=mE(ft(I[0]))),!d["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(d["!ref"]=It(m)),r.sheetRows>0&&d["!ref"]){var N=mr(d["!ref"]);r.sheetRows<=+N.e.r&&(N.e.r=r.sheetRows-1,N.e.r>m.e.r&&(N.e.r=m.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>m.e.c&&(N.e.c=m.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),d["!fullref"]=d["!ref"],d["!ref"]=It(N))}return E.length>0&&(d["!cols"]=E),O.length>0&&(d["!merges"]=O),d}function tm(e,r,t,n){var a=ft(e);t.Sheets[n]||(t.Sheets[n]={}),a.codeName&&(t.Sheets[n].CodeName=Lt(Xt(a.codeName)))}function fE(e,r,t,n,a){tm(e.slice(0,e.indexOf(">")),t,n,a)}function hE(e,r,t){for(var n=Array.isArray(e),a=0;a!=r.length;++a){var l=ft(Xt(r[a]),!0);if(!l.ref)return;var c=((t||{})["!id"]||[])[l.id];c?(l.Target=c.Target,l.location&&(l.Target+="#"+Lt(l.location))):(l.Target="#"+Lt(l.location),c={Target:l.Target,TargetMode:"Internal"}),l.Rel=c,l.tooltip&&(l.Tooltip=l.tooltip,delete l.tooltip);for(var d=mr(l.ref),m=d.s.r;m<=d.e.r;++m)for(var g=d.s.c;g<=d.e.c;++g){var x=xt({c:g,r:m});n?(e[m]||(e[m]=[]),e[m][g]||(e[m][g]={t:"z",v:void 0}),e[m][g].l=l):(e[x]||(e[x]={t:"z",v:void 0}),e[x].l=l)}}}function mE(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}function pE(e,r){for(var t=!1,n=0;n!=r.length;++n){var a=ft(r[n],!0);a.hidden&&(a.hidden=ar(a.hidden));var l=parseInt(a.min,10)-1,c=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!t&&a.width&&(t=!0,Q0(a.width)),bl(a);l<=c;)e[l++]=Yr(a)}}function gE(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var vE=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function xE(e,r){r.Views||(r.Views=[{}]),(e.match(vE)||[]).forEach(function(t,n){var a=ft(t);r.Views[n]||(r.Views[n]={}),+a.zoomScale&&(r.Views[n].zoom=+a.zoomScale),ar(a.rightToLeft)&&(r.Views[n].RTL=!0)})}var yE=(function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,l=Uc("v"),c=Uc("f");return function(m,g,x,_,y,S){for(var C=0,b="",E=[],D=[],F=0,O=0,M=0,G="",I,N,q=0,Z=0,me,ue,Y=0,se=0,ve=Array.isArray(S.CellXf),ee,ce=[],V=[],ie=Array.isArray(g),Q=[],fe={},R=!1,P=!!x.sheetStubs,W=m.split(r),U=0,H=W.length;U!=H;++U){b=W[U].trim();var le=b.length;if(le!==0){var ge=0;e:for(C=0;C<le;++C)switch(b[C]){case">":if(b[C-1]!="/"){++C;break e}if(x&&x.cellStyles){if(N=ft(b.slice(ge,C),!0),q=N.r!=null?parseInt(N.r,10):q+1,Z=-1,x.sheetRows&&x.sheetRows<q)continue;fe={},R=!1,N.ht&&(R=!0,fe.hpt=parseFloat(N.ht),fe.hpx=Vc(fe.hpt)),N.hidden=="1"&&(R=!0,fe.hidden=!0),N.outlineLevel!=null&&(R=!0,fe.level=+N.outlineLevel),R&&(Q[q-1]=fe)}break;case"<":ge=C;break}if(ge>=C)break;if(N=ft(b.slice(ge,C),!0),q=N.r!=null?parseInt(N.r,10):q+1,Z=-1,!(x.sheetRows&&x.sheetRows<q)){_.s.r>q-1&&(_.s.r=q-1),_.e.r<q-1&&(_.e.r=q-1),x&&x.cellStyles&&(fe={},R=!1,N.ht&&(R=!0,fe.hpt=parseFloat(N.ht),fe.hpx=Vc(fe.hpt)),N.hidden=="1"&&(R=!0,fe.hidden=!0),N.outlineLevel!=null&&(R=!0,fe.level=+N.outlineLevel),R&&(Q[q-1]=fe)),E=b.slice(C).split(e);for(var Ce=0;Ce!=E.length&&E[Ce].trim().charAt(0)=="<";++Ce);for(E=E.slice(Ce),C=0;C!=E.length;++C)if(b=E[C].trim(),b.length!==0){if(D=b.match(t),F=C,O=0,M=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,D!=null&&D.length===2){for(F=0,G=D[1],O=0;O!=G.length&&!((M=G.charCodeAt(O)-64)<1||M>26);++O)F=26*F+M;--F,Z=F}else++Z;for(O=0;O!=b.length&&b.charCodeAt(O)!==62;++O);if(++O,N=ft(b.slice(0,O),!0),N.r||(N.r=xt({r:q-1,c:Z})),G=b.slice(O),I={t:""},(D=G.match(l))!=null&&D[1]!==""&&(I.v=Lt(D[1])),x.cellFormula){if((D=G.match(c))!=null&&D[1]!==""){if(I.f=Lt(Xt(D[1])).replace(/\r\n/g,`
`),x.xlfn||(I.f=Kg(I.f)),D[0].indexOf('t="array"')>-1)I.F=(G.match(a)||[])[1],I.F.indexOf(":")>-1&&ce.push([mr(I.F),I.F]);else if(D[0].indexOf('t="shared"')>-1){ue=ft(D[0]);var ke=Lt(Xt(D[1]));x.xlfn||(ke=Kg(ke)),V[parseInt(ue.si,10)]=[ue,ke,N.r]}}else(D=G.match(/<f[^>]*\/>/))&&(ue=ft(D[0]),V[ue.si]&&(I.f=N2(V[ue.si][1],V[ue.si][2],N.r)));var xe=bn(N.r);for(O=0;O<ce.length;++O)xe.r>=ce[O][0].s.r&&xe.r<=ce[O][0].e.r&&xe.c>=ce[O][0].s.c&&xe.c<=ce[O][0].e.c&&(I.F=ce[O][1])}if(N.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(P)I.t="z";else continue;else I.t=N.t||"n";switch(_.s.c>Z&&(_.s.c=Z),_.e.c<Z&&(_.e.c=Z),I.t){case"n":if(I.v==""||I.v==null){if(!P)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!P)continue;I.t="z"}else me=Ic[parseInt(I.v,10)],I.v=me.t,I.r=me.r,x.cellHTML&&(I.h=me.h);break;case"str":I.t="s",I.v=I.v!=null?Xt(I.v):"",x.cellHTML&&(I.h=$0(I.v));break;case"inlineStr":D=G.match(n),I.t="s",D!=null&&(me=J0(D[1]))?(I.v=me.t,x.cellHTML&&(I.h=me.h)):I.v="";break;case"b":I.v=ar(I.v);break;case"d":x.cellDates?I.v=Hr(I.v,1):(I.v=Tn(Hr(I.v,1)),I.t="n");break;case"e":(!x||x.cellText!==!1)&&(I.w=I.v),I.v=Vx[I.v];break}if(Y=se=0,ee=null,ve&&N.s!==void 0&&(ee=S.CellXf[N.s],ee!=null&&(ee.numFmtId!=null&&(Y=ee.numFmtId),x.cellStyles&&ee.fillId!=null&&(se=ee.fillId))),b1(I,Y,se,x,y,S),x.cellDates&&ve&&I.t=="n"&&Cl(kt[Y])&&(I.t="d",I.v=rf(I.v)),N.cm&&x.xlmeta){var Ke=(x.xlmeta.Cell||[])[+N.cm-1];Ke&&Ke.type=="XLDAPR"&&(I.D=!0)}if(ie){var te=bn(N.r);g[te.r]||(g[te.r]=[]),g[te.r][te.c]=I}else g[N.r]=I}}}}Q.length>0&&(g["!rows"]=Q)}})();function _E(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var l=e.read_shift(1);return e.l=n,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=a/20),t}var wE=po;function kE(){}function bE(e,r){var t={},n=e[e.l];return++e.l,t.above=!(n&64),t.left=!(n&128),e.l+=18,t.name=Vw(e),t}function SE(e){var r=ha(e);return[r]}function TE(e){var r=mo(e);return[r]}function EE(e){var r=ha(e),t=e.read_shift(1);return[r,t,"b"]}function CE(e){var r=mo(e),t=e.read_shift(1);return[r,t,"b"]}function AE(e){var r=ha(e),t=e.read_shift(1);return[r,t,"e"]}function PE(e){var r=mo(e),t=e.read_shift(1);return[r,t,"e"]}function NE(e){var r=ha(e),t=e.read_shift(4);return[r,t,"s"]}function DE(e){var r=mo(e),t=e.read_shift(4);return[r,t,"s"]}function OE(e){var r=ha(e),t=un(e);return[r,t,"n"]}function T1(e){var r=mo(e),t=un(e);return[r,t,"n"]}function IE(e){var r=ha(e),t=q0(e);return[r,t,"n"]}function FE(e){var r=mo(e),t=q0(e);return[r,t,"n"]}function LE(e){var r=ha(e),t=Z0(e);return[r,t,"is"]}function RE(e){var r=ha(e),t=fn(e);return[r,t,"str"]}function jE(e){var r=mo(e),t=fn(e);return[r,t,"str"]}function ME(e,r,t){var n=e.l+r,a=ha(e);a.r=t["!row"];var l=e.read_shift(1),c=[a,l,"b"];if(t.cellFormula){e.l+=2;var d=sf(e,n-e.l,t);c[3]=cn(d,null,a,t.supbooks,t)}else e.l=n;return c}function BE(e,r,t){var n=e.l+r,a=ha(e);a.r=t["!row"];var l=e.read_shift(1),c=[a,l,"e"];if(t.cellFormula){e.l+=2;var d=sf(e,n-e.l,t);c[3]=cn(d,null,a,t.supbooks,t)}else e.l=n;return c}function zE(e,r,t){var n=e.l+r,a=ha(e);a.r=t["!row"];var l=un(e),c=[a,l,"n"];if(t.cellFormula){e.l+=2;var d=sf(e,n-e.l,t);c[3]=cn(d,null,a,t.supbooks,t)}else e.l=n;return c}function UE(e,r,t){var n=e.l+r,a=ha(e);a.r=t["!row"];var l=fn(e),c=[a,l,"str"];if(t.cellFormula){e.l+=2;var d=sf(e,n-e.l,t);c[3]=cn(d,null,a,t.supbooks,t)}else e.l=n;return c}var $E=po;function WE(e,r){var t=e.l+r,n=po(e),a=K0(e),l=fn(e),c=fn(e),d=fn(e);e.l=t;var m={rfx:n,relId:a,loc:l,display:d};return c&&(m.Tooltip=c),m}function HE(){}function VE(e,r,t){var n=e.l+r,a=$x(e),l=e.read_shift(1),c=[a];if(c[2]=l,t.cellFormula){var d=YT(e,n-e.l,t);c[1]=d}else e.l=n;return c}function GE(e,r,t){var n=e.l+r,a=po(e),l=[a];if(t.cellFormula){var c=JT(e,n-e.l,t);l[1]=c,e.l=n}else e.l=n;return l}var ZE=["left","right","top","bottom","header","footer"];function KE(e){var r={};return ZE.forEach(function(t){r[t]=un(e)}),r}function qE(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function YE(){}function XE(){}function JE(e,r,t,n,a,l,c){if(!e)return e;var d=r||{};n||(n={"!id":{}});var m=d.dense?[]:{},g,x={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,y=!1,S,C,b,E,D,F,O,M,G,I=[];d.biff=12,d["!row"]=0;var N=0,q=!1,Z=[],me={},ue=d.supbooks||a.supbooks||[[]];if(ue.sharedf=me,ue.arrayf=Z,ue.SheetNames=a.SheetNames||a.Sheets.map(function(ie){return ie.name}),!d.supbooks&&(d.supbooks=ue,a.Names))for(var Y=0;Y<a.Names.length;++Y)ue[0][Y+1]=a.Names[Y];var se=[],ve=[],ee=!1;Yd[16]={n:"BrtShortReal",f:T1};var ce;if(Di(e,function(Q,fe,R){if(!y)switch(R){case 148:g=Q;break;case 0:S=Q,d.sheetRows&&d.sheetRows<=S.r&&(y=!0),M=Xr(E=S.r),d["!row"]=S.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=Vc(Q.hpt)),ve[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(C={t:Q[2]},Q[2]){case"n":C.v=Q[1];break;case"s":O=Ic[Q[1]],C.v=O.t,C.r=O.r;break;case"b":C.v=!!Q[1];break;case"e":C.v=Q[1],d.cellText!==!1&&(C.w=go[C.v]);break;case"str":C.t="s",C.v=Q[1];break;case"is":C.t="s",C.v=Q[1].t;break}if((b=c.CellXf[Q[0].iStyleRef])&&b1(C,b.numFmtId,null,d,l,c),D=Q[0].c==-1?D+1:Q[0].c,d.dense?(m[E]||(m[E]=[]),m[E][D]=C):m[Ir(D)+M]=C,d.cellFormula){for(q=!1,N=0;N<Z.length;++N){var P=Z[N];S.r>=P[0].s.r&&S.r<=P[0].e.r&&D>=P[0].s.c&&D<=P[0].e.c&&(C.F=It(P[0]),q=!0)}!q&&Q.length>3&&(C.f=Q[3])}if(x.s.r>S.r&&(x.s.r=S.r),x.s.c>D&&(x.s.c=D),x.e.r<S.r&&(x.e.r=S.r),x.e.c<D&&(x.e.c=D),d.cellDates&&b&&C.t=="n"&&Cl(kt[b.numFmtId])){var W=ao(C.v);W&&(C.t="d",C.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}ce&&(ce.type=="XLDAPR"&&(C.D=!0),ce=void 0);break;case 1:case 12:if(!d.sheetStubs||_)break;C={t:"z",v:void 0},D=Q[0].c==-1?D+1:Q[0].c,d.dense?(m[E]||(m[E]=[]),m[E][D]=C):m[Ir(D)+M]=C,x.s.r>S.r&&(x.s.r=S.r),x.s.c>D&&(x.s.c=D),x.e.r<S.r&&(x.e.r=S.r),x.e.c<D&&(x.e.c=D),ce&&(ce.type=="XLDAPR"&&(C.D=!0),ce=void 0);break;case 176:I.push(Q);break;case 49:ce=((d.xlmeta||{}).Cell||[])[Q-1];break;case 494:var U=n["!id"][Q.relId];for(U?(Q.Target=U.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=U):Q.relId==""&&(Q.Target="#"+Q.loc),E=Q.rfx.s.r;E<=Q.rfx.e.r;++E)for(D=Q.rfx.s.c;D<=Q.rfx.e.c;++D)d.dense?(m[E]||(m[E]=[]),m[E][D]||(m[E][D]={t:"z",v:void 0}),m[E][D].l=Q):(F=xt({c:D,r:E}),m[F]||(m[F]={t:"z",v:void 0}),m[F].l=Q);break;case 426:if(!d.cellFormula)break;Z.push(Q),G=d.dense?m[E][D]:m[Ir(D)+M],G.f=cn(Q[1],x,{r:S.r,c:D},ue,d),G.F=It(Q[0]);break;case 427:if(!d.cellFormula)break;me[xt(Q[0].s)]=Q[1],G=d.dense?m[E][D]:m[Ir(D)+M],G.f=cn(Q[1],x,{r:S.r,c:D},ue,d);break;case 60:if(!d.cellStyles)break;for(;Q.e>=Q.s;)se[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},ee||(ee=!0,Q0(Q.w/256)),bl(se[Q.e+1]);break;case 161:m["!autofilter"]={ref:It(Q)};break;case 476:m["!margins"]=Q;break;case 147:a.Sheets[t]||(a.Sheets[t]={}),Q.name&&(a.Sheets[t].CodeName=Q.name),(Q.above||Q.left)&&(m["!outline"]={above:Q.above,left:Q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:_=!0;break;case 38:_=!1;break;default:if(!fe.T){if(!_||d.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}},d),delete d.supbooks,delete d["!row"],!m["!ref"]&&(x.s.r<2e6||g&&(g.e.r>0||g.e.c>0||g.s.r>0||g.s.c>0))&&(m["!ref"]=It(g||x)),d.sheetRows&&m["!ref"]){var V=mr(m["!ref"]);d.sheetRows<=+V.e.r&&(V.e.r=d.sheetRows-1,V.e.r>x.e.r&&(V.e.r=x.e.r),V.e.r<V.s.r&&(V.s.r=V.e.r),V.e.c>x.e.c&&(V.e.c=x.e.c),V.e.c<V.s.c&&(V.s.c=V.e.c),m["!fullref"]=m["!ref"],m["!ref"]=It(V))}return I.length>0&&(m["!merges"]=I),se.length>0&&(m["!cols"]=se),ve.length>0&&(m["!rows"]=ve),m}function QE(e){var r=[],t=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(l){var c=l.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(r[+c[1]]=t?+c[2]:c[2])});var a=Lt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(l){n=l.replace(/<.*?>/g,"")}),[r,a,n]}function eC(e,r,t,n,a,l){var c=l||{"!type":"chart"};if(!e)return l;var d=0,m=0,g="A",x={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var y=QE(_);x.s.r=x.s.c=0,x.e.c=d,g=Ir(d),y[0].forEach(function(S,C){c[g+Xr(C)]={t:"n",v:S,z:y[1]},m=C}),x.e.r<m&&(x.e.r=m),++d}),d>0&&(c["!ref"]=It(x)),c}function tC(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c,d=e.match(S1);return d&&tm(d[0],l,a,t),(c=e.match(/drawing r:id="(.*?)"/))&&(l["!rel"]=c[1]),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}function rC(e,r){e.l+=10;var t=fn(e);return{name:t}}function nC(e,r,t,n,a){if(!e)return e;n||(n={"!id":{}});var l={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Di(e,function(m,g,x){switch(x){case 550:l["!rel"]=m;break;case 651:a.Sheets[t]||(a.Sheets[t]={}),m.name&&(a.Sheets[t].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(g.T>0)){if(!(g.T<0)){if(!c||r.WTF)throw new Error("Unexpected record 0x"+x.toString(16))}}}},r),n["!id"][l["!rel"]]&&(l["!drawel"]=n["!id"][l["!rel"]]),l}var E1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aC=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],iC=[],sC=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Qg(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],a=0;a!=r.length;++a){var l=r[a];if(n[l[0]]==null)n[l[0]]=l[1];else switch(l[2]){case"bool":typeof n[l[0]]=="string"&&(n[l[0]]=ar(n[l[0]]));break;case"int":typeof n[l[0]]=="string"&&(n[l[0]]=parseInt(n[l[0]],10));break}}}function ev(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ar(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function C1(e){ev(e.WBProps,E1),ev(e.CalcPr,sC),Qg(e.WBView,aC),Qg(e.Sheets,iC),wl.date1904=ar(e.WBProps.date1904)}var oC="][*?/\\".split("");function lC(e,r){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return oC.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}var cC=/<\w+:workbook/;function uC(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",l={},c=0;if(e.replace(mn,function(m,g){var x=ft(m);switch(ei(x[0])){case"<?xml":break;case"<workbook":m.match(cC)&&(a="xmlns"+m.match(/<(\w+):/)[1]),t.xmlns=x[a];break;case"</workbook>":break;case"<fileVersion":delete x[0],t.AppVersion=x;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":E1.forEach(function(_){if(x[_[0]]!=null)switch(_[2]){case"bool":t.WBProps[_[0]]=ar(x[_[0]]);break;case"int":t.WBProps[_[0]]=parseInt(x[_[0]],10);break;default:t.WBProps[_[0]]=x[_[0]]}}),x.codeName&&(t.WBProps.CodeName=Xt(x.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete x[0],t.WBView.push(x);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(x.state){case"hidden":x.Hidden=1;break;case"veryHidden":x.Hidden=2;break;default:x.Hidden=0}delete x.state,x.name=Lt(Xt(x.name)),delete x[0],t.Sheets.push(x);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":l={},l.Name=Xt(x.name),x.comment&&(l.Comment=x.comment),x.localSheetId&&(l.Sheet=+x.localSheetId),ar(x.hidden||"0")&&(l.Hidden=!0),c=g+m.length;break;case"</definedName>":l.Ref=Lt(Xt(e.slice(c,g))),t.Names.push(l);break;case"<definedName/>":break;case"<calcPr":delete x[0],t.CalcPr=x;break;case"<calcPr/>":delete x[0],t.CalcPr=x;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&r.WTF)throw new Error("unrecognized "+x[0]+" in workbook")}return m}),Aw.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return C1(t),t}function dC(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=u0(e),t.name=fn(e),t}function fC(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var a=r>8?fn(e):"";return a.length>0&&(t.CodeName=a),t.autoCompressPictures=!!(n&65536),t.backupFile=!!(n&64),t.checkCompatibility=!!(n&4096),t.date1904=!!(n&1),t.filterPrivacy=!!(n&8),t.hidePivotFieldList=!!(n&1024),t.promptedSolutions=!!(n&16),t.publishItems=!!(n&2048),t.refreshAllConnections=!!(n&262144),t.saveExternalLinkValues=!!(n&128),t.showBorderUnselectedTables=!!(n&4),t.showInkAnnotation=!!(n&32),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(n&32768),t.updateLinks=["userSet","never","always"][n>>8&3],t}function hC(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function mC(e,r,t){var n=e.l+r;e.l+=4,e.l+=1;var a=e.read_shift(4),l=Gw(e),c=XT(e,0,t),d=K0(e);e.l=n;var m={Name:l,Ptg:c};return a<268435455&&(m.Sheet=a),d&&(m.Comment=d),m}function pC(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;r||(r={}),r.biff=12;var l=[],c=[[]];return c.SheetNames=[],c.XTI=[],Yd[16]={n:"BrtFRTArchID$",f:hC},Di(e,function(m,g,x){switch(x){case 156:c.SheetNames.push(m.name),t.Sheets.push(m);break;case 153:t.WBProps=m;break;case 39:m.Sheet!=null&&(r.SID=m.Sheet),m.Ref=cn(m.Ptg,null,null,c,r),delete r.SID,delete m.Ptg,l.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([x,m]):c[0]=[x,m],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(m),c.XTI=c.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(x),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(x),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!g.T){if(!a||r.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+x.toString(16))}}},r),C1(t),t.Names=l,t.supbooks=c,t}function gC(e,r,t){return r.slice(-4)===".bin"?pC(e,t):uC(e,t)}function vC(e,r,t,n,a,l,c,d){return r.slice(-4)===".bin"?JE(e,n,t,a,l,c,d):dE(e,n,t,a,l,c,d)}function xC(e,r,t,n,a,l,c,d){return r.slice(-4)===".bin"?nC(e,n,t,a,l):tC(e,n,t,a,l)}function yC(e,r,t,n,a,l,c,d){return r.slice(-4)===".bin"?C2():A2()}function _C(e,r,t,n,a,l,c,d){return r.slice(-4)===".bin"?T2():E2()}function wC(e,r,t,n){return r.slice(-4)===".bin"?$S(e,t,n):RS(e,t,n)}function kC(e,r,t){return h1(e,t)}function bC(e,r,t){return r.slice(-4)===".bin"?aS(e,t):rS(e,t)}function SC(e,r,t){return r.slice(-4)===".bin"?k2(e,t):v2(e,t)}function TC(e,r,t){return r.slice(-4)===".bin"?m2(e):f2(e)}function EC(e,r,t,n){return t.slice(-4)===".bin"?p2(e,r,t,n):void 0}function CC(e,r,t){return r.slice(-4)===".bin"?u2(e,r,t):d2(e,r,t)}var A1=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,P1=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Aa(e,r){var t=e.split(/\s+/),n=[];if(n[0]=t[0],t.length===1)return n;var a=e.match(A1),l,c,d,m;if(a)for(m=0;m!=a.length;++m)l=a[m].match(P1),(c=l[1].indexOf(":"))===-1?n[l[1]]=l[2].slice(1,l[2].length-1):(l[1].slice(0,6)==="xmlns:"?d="xmlns"+l[1].slice(6):d=l[1].slice(c+1),n[d]=l[2].slice(1,l[2].length-1));return n}function AC(e){var r=e.split(/\s+/),t={};if(r.length===1)return t;var n=e.match(A1),a,l,c,d;if(n)for(d=0;d!=n.length;++d)a=n[d].match(P1),(l=a[1].indexOf(":"))===-1?t[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(l+1),t[c]=a[2].slice(1,a[2].length-1));return t}var Lc;function PC(e,r){var t=Lc[e]||Lt(e);return t==="General"?lo(r):fa(t,r)}function NC(e,r,t,n){var a=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ar(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Hr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[Lt(r)]=a}function DC(e,r,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||go[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zc(e.v):e.w=lo(e.v):e.w=PC(r||"General",e.v)}catch(l){if(t.WTF)throw l}try{var n=Lc[r]||r||"General";if(t.cellNF&&(e.z=n),t.cellDates&&e.t=="n"&&Cl(n)){var a=ao(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(l){if(t.WTF)throw l}}}function OC(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=NS[n.Pattern]||n.Pattern)}e[r.ID]=r}function IC(e,r,t,n,a,l,c,d,m,g){var x="General",_=n.StyleID,y={};g=g||{};var S=[],C=0;for(_===void 0&&d&&(_=d.StyleID),_===void 0&&c&&(_=c.StyleID);l[_]!==void 0&&(l[_].nf&&(x=l[_].nf),l[_].Interior&&S.push(l[_].Interior),!!l[_].Parent);)_=l[_].Parent;switch(t.Type){case"Boolean":n.t="b",n.v=ar(e);break;case"String":n.t="s",n.r=kg(Lt(e)),n.v=e.indexOf("<")>-1?Lt(r||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Hr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Lt(e):n.v<60&&(n.v=n.v-1),(!x||x=="General")&&(x="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Vx[e],g.cellText!==!1&&(n.w=e);break;default:e==""&&r==""?n.t="z":(n.t="s",n.v=kg(r||e));break}if(DC(n,x,g),g.cellFormula!==!1)if(n.Formula){var b=Lt(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=_l(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=_l("RC:RC",a):n.ArrayRange&&(n.F=_l(n.ArrayRange,a),m.push([mr(n.F),n.F]))}else for(C=0;C<m.length;++C)a.r>=m[C][0].s.r&&a.r<=m[C][0].e.r&&a.c>=m[C][0].s.c&&a.c<=m[C][0].e.c&&(n.F=m[C][1]);g.cellStyles&&(S.forEach(function(E){!y.patternType&&E.patternType&&(y.patternType=E.patternType)}),n.s=y),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function FC(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Hh(e,r){var t=r||{};vx();var n=wc(W0(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(n=Xt(n));var a=n.slice(0,1024).toLowerCase(),l=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var c=Yr(t);return c.type="string",Wc.to_workbook(n,c)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Pt){a.indexOf("<"+Pt)>=0&&(l=!0)}),l)return WC(n,t);Lc={"General Number":"General","General Date":kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kt[15],"Short Date":kt[14],"Long Time":kt[19],"Medium Time":kt[18],"Short Time":kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kt[2],Standard:kt[4],Percent:kt[10],Scientific:kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,m=[],g,x={},_=[],y=t.dense?[]:{},S="",C={},b={},E=Aa('<Data ss:Type="String">'),D=0,F=0,O=0,M={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},I={},N="",q=0,Z=[],me={},ue={},Y=0,se=[],ve=[],ee={},ce=[],V,ie=!1,Q=[],fe=[],R={},P=0,W=0,U={Sheets:[],WBProps:{date1904:!1}},H={};$c.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";d=$c.exec(n);)switch(d[3]=(le=d[3]).toLowerCase()){case"data":if(le=="data"){if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break}if(m[m.length-1][1])break;d[1]==="/"?IC(n.slice(D,d.index),N,E,m[m.length-1][0]=="comment"?ee:C,{c:F,r:O},G,ce[F],b,Q,t):(N="",E=Aa(d[0]),D=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(ve.length>0&&(C.c=ve),(!t.sheetRows||t.sheetRows>O)&&C.v!==void 0&&(t.dense?(y[O]||(y[O]=[]),y[O][F]=C):y[Ir(F)+Xr(O)]=C),C.HRef&&(C.l={Target:Lt(C.HRef)},C.HRefScreenTip&&(C.l.Tooltip=C.HRefScreenTip),delete C.HRef,delete C.HRefScreenTip),(C.MergeAcross||C.MergeDown)&&(P=F+(parseInt(C.MergeAcross,10)|0),W=O+(parseInt(C.MergeDown,10)|0),Z.push({s:{c:F,r:O},e:{c:P,r:W}})),!t.sheetStubs)C.MergeAcross?F=P+1:++F;else if(C.MergeAcross||C.MergeDown){for(var ge=F;ge<=P;++ge)for(var Ce=O;Ce<=W;++Ce)(ge>F||Ce>O)&&(t.dense?(y[Ce]||(y[Ce]=[]),y[Ce][ge]={t:"z"}):y[Ir(ge)+Xr(Ce)]={t:"z"});F=P+1}else++F;else C=AC(d[0]),C.Index&&(F=+C.Index-1),F<M.s.c&&(M.s.c=F),F>M.e.c&&(M.e.c=F),d[0].slice(-2)==="/>"&&++F,ve=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(O<M.s.r&&(M.s.r=O),O>M.e.r&&(M.e.r=O),d[0].slice(-2)==="/>"&&(b=Aa(d[0]),b.Index&&(O=+b.Index-1)),F=0,++O):(b=Aa(d[0]),b.Index&&(O=+b.Index-1),R={},(b.AutoFitHeight=="0"||b.Height)&&(R.hpx=parseInt(b.Height,10),R.hpt=f1(R.hpx),fe[O]=R),b.Hidden=="1"&&(R.hidden=!0,fe[O]=R));break;case"worksheet":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"));_.push(S),M.s.r<=M.e.r&&M.s.c<=M.e.c&&(y["!ref"]=It(M),t.sheetRows&&t.sheetRows<=M.e.r&&(y["!fullref"]=y["!ref"],M.e.r=t.sheetRows-1,y["!ref"]=It(M))),Z.length&&(y["!merges"]=Z),ce.length>0&&(y["!cols"]=ce),fe.length>0&&(y["!rows"]=fe),x[S]=y}else M={s:{r:2e6,c:2e6},e:{r:0,c:0}},O=F=0,m.push([d[3],!1]),g=Aa(d[0]),S=Lt(g.Name),y=t.dense?[]:{},Z=[],Q=[],fe=[],H={name:S,Hidden:0},U.Sheets.push(H);break;case"table":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else{if(d[0].slice(-2)=="/>")break;m.push([d[3],!1]),ce=[],ie=!1}break;case"style":d[1]==="/"?OC(G,I,t):I=Aa(d[0]);break;case"numberformat":I.nf=Lt(Aa(d[0]).Format||"General"),Lc[I.nf]&&(I.nf=Lc[I.nf]);for(var ke=0;ke!=392&&kt[ke]!=I.nf;++ke);if(ke==392){for(ke=57;ke!=392;++ke)if(kt[ke]==null){io(I.nf,ke);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(V=Aa(d[0]),V.Hidden&&(V.hidden=!0,delete V.Hidden),V.Width&&(V.wpx=parseInt(V.Width,10)),!ie&&V.wpx>10){ie=!0,kn=u1;for(var xe=0;xe<ce.length;++xe)ce[xe]&&bl(ce[xe])}ie&&bl(V),ce[V.Index-1||ce.length]=V;for(var Ke=0;Ke<+V.Span;++Ke)ce[ce.length]=Yr(V);break;case"namedrange":if(d[1]==="/")break;U.Names||(U.Names=[]);var te=ft(d[0]),Tt={Name:te.Name,Ref:_l(te.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Tt.Sheet=U.Sheets.length-1),U.Names.push(Tt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?N+=n.slice(q,d.index):q=d.index+d[0].length;break;case"interior":if(!t.cellStyles)break;I.Interior=Aa(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?vk(me,le,n.slice(Y,d.index)):Y=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else m.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"));FC(ee),ve.push(ee)}else m.push([d[3],!1]),g=Aa(d[0]),ee={a:g.Author};break;case"autofilter":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var bt=Aa(d[0]);y["!autofilter"]={ref:_l(bt.Range).replace(/\$/g,"")},m.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((g=m.pop())[0]!==d[3])throw new Error("Bad state: "+g.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"null":break;default:if(m.length==0&&d[3]=="document"||m.length==0&&d[3]=="uof")return sv(n,t);var yt=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:yt=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:yt=!1}break;case"excelworkbook":switch(d[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:yt=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:yt=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(n.slice(Y,d.index)){case"SheetHidden":H.Hidden=1;break;case"SheetVeryHidden":H.Hidden=2;break}else Y=d.index+d[0].length;break;case"header":y["!margins"]||Fc(y["!margins"]={},"xlml"),isNaN(+ft(d[0]).Margin)||(y["!margins"].header=+ft(d[0]).Margin);break;case"footer":y["!margins"]||Fc(y["!margins"]={},"xlml"),isNaN(+ft(d[0]).Margin)||(y["!margins"].footer=+ft(d[0]).Margin);break;case"pagemargins":var ut=ft(d[0]);y["!margins"]||Fc(y["!margins"]={},"xlml"),isNaN(+ut.Top)||(y["!margins"].top=+ut.Top),isNaN(+ut.Left)||(y["!margins"].left=+ut.Left),isNaN(+ut.Right)||(y["!margins"].right=+ut.Right),isNaN(+ut.Bottom)||(y["!margins"].bottom=+ut.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":y["!outline"]||(y["!outline"]={}),y["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:yt=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:yt=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:yt=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:yt=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:yt=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:yt=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:yt=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:yt=!1}break;case"smarttags":break;default:yt=!1;break}if(yt||d[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?NC(ue,le,se,n.slice(Y,d.index)):(se=d,Y=d.index+d[0].length);break}if(t.WTF)throw"Unrecognized tag: "+d[3]+"|"+m.join("|")}var Ue={};return!t.bookSheets&&!t.bookProps&&(Ue.Sheets=x),Ue.SheetNames=_,Ue.Workbook=U,Ue.SSF=Yr(kt),Ue.Props=me,Ue.Custprops=ue,Ue}function m0(e,r){switch(am(r=r||{}),r.type||"base64"){case"base64":return Hh(Yn(e),r);case"binary":case"buffer":case"file":return Hh(e,r);case"array":return Hh(ho(e),r)}}function LC(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=qw(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(n==0||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(n=t.read_shift(4),n!==1907505652)||(r.UnicodeClipboardFormat=Yw(t),n=t.read_shift(4),n==0||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}var RC=[60,1084,2066,2165,2175];function jC(e,r,t,n,a){var l=n,c=[],d=t.slice(t.l,t.l+l);if(a&&a.enc&&a.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(d)}c.push(d),t.l+=l;for(var m=Ci(t,t.l),g=p0[m],x=0;g!=null&&RC.indexOf(m)>-1;)l=Ci(t,t.l+2),x=t.l+4,m==2066?x+=4:(m==2165||m==2175)&&(x+=12),d=t.slice(x,t.l+4+l),c.push(d),t.l+=4+l,g=p0[m=Ci(t,t.l)];var _=vs(c);qr(_,0);var y=0;_.lens=[];for(var S=0;S<c.length;++S)_.lens.push(y),y+=c[S].length;if(_.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+_.length+" < "+n;return r.f(_,_.length,a)}function Ka(e,r,t){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=kt[n])}catch(l){if(r.WTF)throw l}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||go[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zc(e.v):e.w=lo(e.v):e.w=fa(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(l){if(r.WTF)throw l}if(r.cellDates&&n&&e.t=="n"&&Cl(kt[n]||String(n))){var a=ao(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function wd(e,r,t){return{v:e,ixfe:r,t}}function MC(e,r){var t={opts:{}},n={},a=r.dense?[]:{},l={},c={},d=null,m=[],g="",x={},_,y="",S,C,b,E,D={},F=[],O,M,G=[],I=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},q={},Z=function(ct){return ct<8?so[ct]:ct<64&&I[ct-8]||so[ct]},me=function(ct,Rt,jr){var Gt=Rt.XF.data;if(!(!Gt||!Gt.patternType||!jr||!jr.cellStyles)){Rt.s={},Rt.s.patternType=Gt.patternType;var Qr;(Qr=Hc(Z(Gt.icvFore)))&&(Rt.s.fgColor={rgb:Qr}),(Qr=Hc(Z(Gt.icvBack)))&&(Rt.s.bgColor={rgb:Qr})}},ue=function(ct,Rt,jr){if(!(R>1)&&!(jr.sheetRows&&ct.r>=jr.sheetRows)){if(jr.cellStyles&&Rt.XF&&Rt.XF.data&&me(ct,Rt,jr),delete Rt.ixfe,delete Rt.XF,_=ct,y=xt(ct),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),ct.r<c.s.r&&(c.s.r=ct.r),ct.c<c.s.c&&(c.s.c=ct.c),ct.r+1>c.e.r&&(c.e.r=ct.r+1),ct.c+1>c.e.c&&(c.e.c=ct.c+1),jr.cellFormula&&Rt.f){for(var Gt=0;Gt<F.length;++Gt)if(!(F[Gt][0].s.c>ct.c||F[Gt][0].s.r>ct.r)&&!(F[Gt][0].e.c<ct.c||F[Gt][0].e.r<ct.r)){Rt.F=It(F[Gt][0]),(F[Gt][0].s.c!=ct.c||F[Gt][0].s.r!=ct.r)&&delete Rt.f,Rt.f&&(Rt.f=""+cn(F[Gt][1],c,ct,Q,Y));break}}jr.dense?(a[ct.r]||(a[ct.r]=[]),a[ct.r][ct.c]=Rt):a[y]=Rt}},Y={enc:!1,sbcch:0,snames:[],sharedf:D,arrayf:F,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(Y.password=r.password);var se,ve=[],ee=[],ce=[],V=[],ie=!1,Q=[];Q.SheetNames=Y.snames,Q.sharedf=Y.sharedf,Q.arrayf=Y.arrayf,Q.names=[],Q.XTI=[];var fe=0,R=0,P=0,W=[],U=[],H;Y.codepage=1200,Fa(1200);for(var le=!1;e.l<e.length-1;){var ge=e.l,Ce=e.read_shift(2);if(Ce===0&&fe===10)break;var ke=e.l===e.length?0:e.read_shift(2),xe=p0[Ce];if(xe&&xe.f){if(r.bookSheets&&fe===133&&Ce!==133)break;if(fe=Ce,xe.r===2||xe.r==12){var Ke=e.read_shift(2);if(ke-=2,!Y.enc&&Ke!==Ce&&((Ke&255)<<8|Ke>>8)!==Ce)throw new Error("rt mismatch: "+Ke+"!="+Ce);xe.r==12&&(e.l+=10,ke-=10)}var te={};if(Ce===10?te=xe.f(e,ke,Y):te=jC(Ce,xe,e,ke,Y),R==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(Ce){case 34:t.opts.Date1904=N.WBProps.date1904=te;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=te,!r.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=te;break;case 66:var Tt=Number(te);switch(Tt){case 21010:Tt=1200;break;case 32768:Tt=1e4;break;case 32769:Tt=1252;break}Fa(Y.codepage=Tt),le=!0;break;case 317:Y.rrtabid=te;break;case 25:Y.winlocked=te;break;case 439:t.opts.RefreshAll=te;break;case 12:t.opts.CalcCount=te;break;case 16:t.opts.CalcDelta=te;break;case 17:t.opts.CalcIter=te;break;case 13:t.opts.CalcMode=te;break;case 14:t.opts.CalcPrecision=te;break;case 95:t.opts.CalcSaveRecalc=te;break;case 15:Y.CalcRefMode=te;break;case 2211:t.opts.FullCalc=te;break;case 129:te.fDialog&&(a["!type"]="dialog"),te.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),te.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:G.push(te);break;case 430:Q.push([te]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(te);break;case 24:case 536:H={Name:te.Name,Ref:cn(te.rgce,c,null,Q,Y)},te.itab>0&&(H.Sheet=te.itab-1),Q.names.push(H),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(U[te.itab-1]={ref:It(te.rgce[0][0][1][2])});break;case 22:Y.ExternCount=te;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(te),Q.XTI=Q.XTI.concat(te);break;case 2196:if(Y.biff<8)break;H!=null&&(H.Comment=te[1]);break;case 18:a["!protect"]=te;break;case 19:te!==0&&Y.WTF&&console.error("Password verifier: "+te);break;case 133:l[te.pos]=te,Y.snames.push(te.name);break;case 10:{if(--R)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,a["!ref"]=It(c),r.sheetRows&&r.sheetRows<=c.e.r){var bt=c.e.r;c.e.r=r.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=It(c),c.e.r=bt}c.e.r++,c.e.c++}ve.length>0&&(a["!merges"]=ve),ee.length>0&&(a["!objects"]=ee),ce.length>0&&(a["!cols"]=ce),V.length>0&&(a["!rows"]=V),N.Sheets.push(q)}g===""?x=a:n[g]=a,a=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),Y.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(Y.biff=5,le=!0,Fa(Y.codepage=28591)),Y.biff==8&&te.BIFFVer==0&&te.dt==16&&(Y.biff=2),R++)break;if(a=r.dense?[]:{},Y.biff<8&&!le&&(le=!0,Fa(Y.codepage=r.codepage||1252)),Y.biff<5||te.BIFFVer==0&&te.dt==4096){g===""&&(g="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var yt={pos:e.l-ke,name:g};l[yt.pos]=yt,Y.snames.push(g)}else g=(l[ge]||{name:""}).name;te.dt==32&&(a["!type"]="chart"),te.dt==64&&(a["!type"]="macro"),ve=[],ee=[],Y.arrayf=F=[],ce=[],V=[],ie=!1,q={Hidden:(l[ge]||{hs:0}).hs,name:g}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(r.dense?(a[te.r]||[])[te.c]:a[xt({c:te.c,r:te.r})])&&++te.c,O={ixfe:te.ixfe,XF:G[te.ixfe]||{},v:te.val,t:"n"},P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue({c:te.c,r:te.r},O,r);break;case 5:case 517:O={ixfe:te.ixfe,XF:G[te.ixfe],v:te.val,t:te.t},P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue({c:te.c,r:te.r},O,r);break;case 638:O={ixfe:te.ixfe,XF:G[te.ixfe],v:te.rknum,t:"n"},P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue({c:te.c,r:te.r},O,r);break;case 189:for(var ut=te.c;ut<=te.C;++ut){var Ue=te.rkrec[ut-te.c][0];O={ixfe:Ue,XF:G[Ue],v:te.rkrec[ut-te.c][1],t:"n"},P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue({c:ut,r:te.r},O,r)}break;case 6:case 518:case 1030:{if(te.val=="String"){d=te;break}if(O=wd(te.val,te.cell.ixfe,te.tt),O.XF=G[O.ixfe],r.cellFormula){var Pt=te.formula;if(Pt&&Pt[0]&&Pt[0][0]&&Pt[0][0][0]=="PtgExp"){var rr=Pt[0][0][1][0],Mt=Pt[0][0][1][1],Zt=xt({r:rr,c:Mt});D[Zt]?O.f=""+cn(te.formula,c,te.cell,Q,Y):O.F=((r.dense?(a[rr]||[])[Mt]:a[Zt])||{}).F}else O.f=""+cn(te.formula,c,te.cell,Q,Y)}P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue(te.cell,O,r),d=te}break;case 7:case 519:if(d)d.val=te,O=wd(te,d.cell.ixfe,"s"),O.XF=G[O.ixfe],r.cellFormula&&(O.f=""+cn(d.formula,c,d.cell,Q,Y)),P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue(d.cell,O,r),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{F.push(te);var Vr=xt(te[0].s);if(S=r.dense?(a[te[0].s.r]||[])[te[0].s.c]:a[Vr],r.cellFormula&&S){if(!d||!Vr||!S)break;S.f=""+cn(te[1],c,te[0],Q,Y),S.F=It(te[0])}}break;case 1212:{if(!r.cellFormula)break;if(y){if(!d)break;D[xt(d.cell)]=te[0],S=r.dense?(a[d.cell.r]||[])[d.cell.c]:a[xt(d.cell)],(S||{}).f=""+cn(te[0],c,_,Q,Y)}}break;case 253:O=wd(m[te.isst].t,te.ixfe,"s"),m[te.isst].h&&(O.h=m[te.isst].h),O.XF=G[O.ixfe],P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue({c:te.c,r:te.r},O,r);break;case 513:r.sheetStubs&&(O={ixfe:te.ixfe,XF:G[te.ixfe],t:"z"},P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue({c:te.c,r:te.r},O,r));break;case 190:if(r.sheetStubs)for(var at=te.c;at<=te.C;++at){var pr=te.ixfe[at-te.c];O={ixfe:pr,XF:G[pr],t:"z"},P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue({c:at,r:te.r},O,r)}break;case 214:case 516:case 4:O=wd(te.val,te.ixfe,"s"),O.XF=G[O.ixfe],P>0&&(O.z=W[O.ixfe>>8&63]),Ka(O,r,t.opts.Date1904),ue({c:te.c,r:te.r},O,r);break;case 0:case 512:R===1&&(c=te);break;case 252:m=te;break;case 1054:if(Y.biff==4){W[P++]=te[1];for(var Jr=0;Jr<P+163&&kt[Jr]!=te[1];++Jr);Jr>=163&&io(te[1],P+163)}else io(te[1],te[0]);break;case 30:{W[P++]=te;for(var Gr=0;Gr<P+163&&kt[Gr]!=te;++Gr);Gr>=163&&io(te,P+163)}break;case 229:ve=ve.concat(te);break;case 93:ee[te.cmo[0]]=Y.lastobj=te;break;case 438:Y.lastobj.TxO=te;break;case 127:Y.lastobj.ImData=te;break;case 440:for(E=te[0].s.r;E<=te[0].e.r;++E)for(b=te[0].s.c;b<=te[0].e.c;++b)S=r.dense?(a[E]||[])[b]:a[xt({c:b,r:E})],S&&(S.l=te[1]);break;case 2048:for(E=te[0].s.r;E<=te[0].e.r;++E)for(b=te[0].s.c;b<=te[0].e.c;++b)S=r.dense?(a[E]||[])[b]:a[xt({c:b,r:E})],S&&S.l&&(S.l.Tooltip=te[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;S=r.dense?(a[te[0].r]||[])[te[0].c]:a[xt(te[0])];var Vt=ee[te[2]];S||(r.dense?(a[te[0].r]||(a[te[0].r]=[]),S=a[te[0].r][te[0].c]={t:"z"}):S=a[xt(te[0])]={t:"z"},c.e.r=Math.max(c.e.r,te[0].r),c.s.r=Math.min(c.s.r,te[0].r),c.e.c=Math.max(c.e.c,te[0].c),c.s.c=Math.min(c.s.c,te[0].c)),S.c||(S.c=[]),C={a:te[1],t:Vt.TxO.t},S.c.push(C)}break;case 2173:s2(G[te.ixfe],te.ext);break;case 125:{if(!Y.cellStyles)break;for(;te.e>=te.s;)ce[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},ie||(ie=!0,Q0(te.w/256)),bl(ce[te.e+1])}break;case 520:{var Jt={};te.level!=null&&(V[te.r]=Jt,Jt.level=te.level),te.hidden&&(V[te.r]=Jt,Jt.hidden=!0),te.hpt&&(V[te.r]=Jt,Jt.hpt=te.hpt,Jt.hpx=Vc(te.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Fc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=te;break;case 161:a["!margins"]||Fc(a["!margins"]={}),a["!margins"].header=te.header,a["!margins"].footer=te.footer;break;case 574:te.RTL&&(N.Views[0].RTL=!0);break;case 146:I=te;break;case 2198:se=te;break;case 140:M=te;break;case 442:g?q.CodeName=te||q.name:N.WBProps.CodeName=te||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),e.l+=ke}return t.SheetNames=Ja(l).sort(function(Rr,ct){return Number(Rr)-Number(ct)}).map(function(Rr){return l[Rr].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&x["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=x)):t.Preamble=x,t.Sheets&&U.forEach(function(Rr,ct){t.Sheets[t.SheetNames[ct]]["!autofilter"]=Rr}),t.Strings=m,t.SSF=Yr(kt),Y.enc&&(t.Encryption=Y.enc),se&&(t.Themes=se),t.Metadata={},M!==void 0&&(t.Metadata.Country=M),Q.names.length>0&&(N.Names=Q.names),t.Workbook=N,t}var tv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function BC(e,r,t){var n=Ot.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Mg(n,rk,tv.DSI);for(var l in a)r[l]=a[l]}catch(g){if(t.WTF)throw g}var c=Ot.find(e,"/!SummaryInformation");if(c&&c.size>0)try{var d=Mg(c,nk,tv.SI);for(var m in d)r[m]==null&&(r[m]=d[m])}catch(g){if(t.WTF)throw g}r.HeadingPairs&&r.TitlesOfParts&&(Zx(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}function N1(e,r){r||(r={}),am(r),ix(),r.codepage&&R0(r.codepage);var t,n;if(e.FullPaths){if(Ot.find(e,"/encryption"))throw new Error("File is password-protected");t=Ot.find(e,"!CompObj"),n=Ot.find(e,"/Workbook")||Ot.find(e,"/Book")}else{switch(r.type){case"base64":e=Ia(Yn(e));break;case"binary":e=Ia(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}qr(e,0),n={content:e}}var a,l;if(t&&LC(t),r.bookProps&&!r.bookSheets)a={};else{var c=Dt?"buffer":"array";if(n&&n.content)a=MC(n.content,r);else if((l=Ot.find(e,"PerfectOffice_MAIN"))&&l.content)a=Oc.to_workbook(l.content,(r.type=c,r));else if((l=Ot.find(e,"NativeContent_MAIN"))&&l.content)a=Oc.to_workbook(l.content,(r.type=c,r));else throw(l=Ot.find(e,"MN0"))&&l.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&Ot.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=S2(e))}var d={};return e.FullPaths&&BC(e,d,r),a.Props=a.Custprops=d,r.bookFiles&&(a.cfb=e),a}var Yd={0:{f:_E},1:{f:SE},2:{f:IE},3:{f:AE},4:{f:EE},5:{f:OE},6:{f:RE},7:{f:NE},8:{f:UE},9:{f:zE},10:{f:ME},11:{f:BE},12:{f:TE},13:{f:FE},14:{f:PE},15:{f:CE},16:{f:T1},17:{f:jE},18:{f:DE},19:{f:Z0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:mC},40:{},42:{},43:{f:MS},44:{f:jS},45:{f:BS},46:{f:US},47:{f:zS},48:{},49:{f:$w},50:{},51:{f:l2},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:i1},62:{f:LE},63:{f:h2},64:{f:YE},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:qE},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:bE},148:{f:wE,p:16},151:{f:HE},152:{},153:{f:fC},154:{},155:{},156:{f:dC},157:{},158:{},159:{T:1,f:nS},160:{T:-1},161:{T:1,f:po},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$E},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:o2},336:{T:-1},337:{f:c2,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:u0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:a1},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:VE},427:{f:GE},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:KE},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:kE},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:WE},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:u0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:w2},633:{T:1},634:{T:-1},635:{T:1,f:_2},636:{T:-1},637:{f:Hw},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:rC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:XE},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},p0={6:{f:$h},10:{f:us},12:{f:Sr},13:{f:Sr},14:{f:yr},15:{f:yr},16:{f:un},17:{f:yr},18:{f:yr},19:{f:Sr},20:{f:$g},21:{f:$g},23:{f:a1},24:{f:Hg},25:{f:yr},26:{},27:{},28:{f:xb},29:{},34:{f:yr},35:{f:Wg},38:{f:un},39:{f:un},40:{f:un},41:{f:un},42:{f:yr},43:{f:yr},47:{f:kS},49:{f:Qk},51:{f:Sr},60:{},61:{f:Yk},64:{f:yr},65:{f:Jk},66:{f:Sr},77:{},80:{},81:{},82:{},85:{f:Sr},89:{},90:{},91:{},92:{f:$k},93:{f:_b},94:{},95:{f:yr},96:{},97:{},99:{f:yr},125:{f:i1},128:{f:cb},129:{f:Wk},130:{f:Sr},131:{f:yr},132:{f:yr},133:{f:Hk},134:{},140:{f:Eb},141:{f:Sr},144:{},146:{f:Ab},151:{},152:{},153:{},154:{},155:{},156:{f:Sr},157:{},158:{},160:{f:Ib},161:{f:Nb},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ib},190:{f:sb},193:{f:us},197:{},198:{},199:{},200:{},201:{},202:{f:yr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Sr},220:{},221:{f:yr},222:{},224:{f:lb},225:{f:Uk},226:{f:us},227:{},229:{f:yb},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Vk},253:{f:eb},255:{f:Gk},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Jx},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yr},353:{f:us},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:db},431:{f:yr},432:{},433:{},434:{},437:{},438:{f:bb},439:{f:yr},440:{f:Sb},441:{},442:{f:Qc},443:{},444:{f:Sr},445:{},446:{},448:{f:us},449:{f:qk,r:2},450:{f:us},512:{f:zg},513:{f:Ob},515:{f:ub},516:{f:tb},517:{f:Ug},519:{f:Fb},520:{f:Zk},523:{},545:{f:Vg},549:{f:Bg},566:{},574:{f:Xk},638:{f:ab},659:{},1048:{},1054:{f:rb},1084:{},1212:{f:pb},2048:{f:Tb},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:xd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:us},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Pb,r:12},2173:{f:i2,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:mb,r:12},2197:{},2198:{f:QS,r:12},2199:{},2200:{},2201:{},2202:{f:gb,r:12},2203:{f:us},2204:{},2205:{},2206:{},2207:{},2211:{f:Kk},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Sr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Db},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Cb},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:zg},1:{},2:{f:Mb},3:{f:jb},4:{f:Rb},5:{f:Ug},7:{f:Bb},8:{},9:{f:xd},11:{},22:{f:Sr},30:{f:nb},31:{},32:{},33:{f:Vg},36:{},37:{f:Bg},50:{f:zb},62:{},52:{},67:{},68:{f:Sr},69:{},86:{},126:{},127:{f:Lb},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ub},223:{},234:{},354:{},421:{},518:{f:$h},521:{f:xd},536:{f:Hg},547:{f:Wg},561:{},579:{},1030:{f:$h},1033:{f:xd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Pa(e,r,t,n){var a=r;if(!isNaN(a)){var l=(t||[]).length||0,c=e.next(4);c.write_shift(2,a),c.write_shift(2,l),l>0&&Bx(t)&&e.push(t)}}function rv(e,r){var t=r||{},n=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var l=e.match(/<\/table/i),c=a.index,d=l&&l.index||e.length,m=uw(e.slice(c,d),/(:?<tr[^>]*>)/i,"<tr>"),g=-1,x=0,_=0,y=0,S={s:{r:1e7,c:1e7},e:{r:0,c:0}},C=[];for(c=0;c<m.length;++c){var b=m[c].trim(),E=b.slice(0,3).toLowerCase();if(E=="<tr"){if(++g,t.sheetRows&&t.sheetRows<=g){--g;break}x=0;continue}if(!(E!="<td"&&E!="<th")){var D=b.split(/<\/t[dh]>/i);for(d=0;d<D.length;++d){var F=D[d].trim();if(F.match(/<t[dh]/i)){for(var O=F,M=0;O.charAt(0)=="<"&&(M=O.indexOf(">"))>-1;)O=O.slice(M+1);for(var G=0;G<C.length;++G){var I=C[G];I.s.c==x&&I.s.r<g&&g<=I.e.r&&(x=I.e.c+1,G=-1)}var N=ft(F.slice(0,F.indexOf(">")));y=N.colspan?+N.colspan:1,((_=+N.rowspan)>1||y>1)&&C.push({s:{r:g,c:x},e:{r:g+(_||1)-1,c:x+y-1}});var q=N.t||N["data-t"]||"";if(!O.length){x+=y;continue}if(O=Ex(O),S.s.r>g&&(S.s.r=g),S.e.r<g&&(S.e.r=g),S.s.c>x&&(S.s.c=x),S.e.c<x&&(S.e.c=x),!O.length){x+=y;continue}var Z={t:"s",v:O};t.raw||!O.trim().length||q=="s"||(O==="TRUE"?Z={t:"b",v:!0}:O==="FALSE"?Z={t:"b",v:!1}:isNaN(Ra(O))?isNaN(kl(O).getDate())||(Z={t:"d",v:Hr(O)},t.cellDates||(Z={t:"n",v:Tn(Z.v)}),Z.z=t.dateNF||kt[14]):Z={t:"n",v:Ra(O)}),t.dense?(n[g]||(n[g]=[]),n[g][x]=Z):n[xt({r:g,c:x})]=Z,x+=y}}}}return n["!ref"]=It(S),C.length&&(n["!merges"]=C),n}function zC(e,r,t,n){for(var a=e["!merges"]||[],l=[],c=r.s.c;c<=r.e.c;++c){for(var d=0,m=0,g=0;g<a.length;++g)if(!(a[g].s.r>t||a[g].s.c>c)&&!(a[g].e.r<t||a[g].e.c<c)){if(a[g].s.r<t||a[g].s.c<c){d=-1;break}d=a[g].e.r-a[g].s.r+1,m=a[g].e.c-a[g].s.c+1;break}if(!(d<0)){var x=xt({r:t,c}),_=n.dense?(e[t]||[])[c]:e[x],y=_&&_.v!=null&&(_.h||$0(_.w||(Ni(_),_.w)||""))||"",S={};d>1&&(S.rowspan=d),m>1&&(S.colspan=m),n.editable?y='<span contenteditable="true">'+y+"</span>":_&&(S["data-t"]=_&&_.t||"z",_.v!=null&&(S["data-v"]=_.v),_.z!=null&&(S["data-z"]=_.z),_.l&&(_.l.Target||"#").charAt(0)!="#"&&(y='<a href="'+_.l.Target+'">'+y+"</a>")),S.id=(n.id||"sjs")+"-"+x,l.push(Ew("td",y,S))}}var C="<tr>";return C+l.join("")+"</tr>"}var UC='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',$C="</body></html>";function WC(e,r){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Ts(rv(t[0],r),r);var n=sm();return t.forEach(function(a,l){om(n,rv(a,r),"Sheet"+(l+1))}),n}function HC(e,r,t){var n=[];return n.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function VC(e,r){var t=r||{},n=t.header!=null?t.header:UC,a=t.footer!=null?t.footer:$C,l=[n],c=Al(e["!ref"]);t.dense=Array.isArray(e),l.push(HC(e,c,t));for(var d=c.s.r;d<=c.e.r;++d)l.push(zC(e,c,d,t));return l.push("</table>"+a),l.join("")}function D1(e,r,t){var n=t||{},a=0,l=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?bn(n.origin):n.origin;a=c.r,l=c.c}var d=r.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,d.length),g={s:{r:0,c:0},e:{r:a,c:l}};if(e["!ref"]){var x=Al(e["!ref"]);g.s.r=Math.min(g.s.r,x.s.r),g.s.c=Math.min(g.s.c,x.s.c),g.e.r=Math.max(g.e.r,x.e.r),g.e.c=Math.max(g.e.c,x.e.c),a==-1&&(g.e.r=a=x.e.r+1)}var _=[],y=0,S=e["!rows"]||(e["!rows"]=[]),C=0,b=0,E=0,D=0,F=0,O=0;for(e["!cols"]||(e["!cols"]=[]);C<d.length&&b<m;++C){var M=d[C];if(nv(M)){if(n.display)continue;S[b]={hidden:!0}}var G=M.children;for(E=D=0;E<G.length;++E){var I=G[E];if(!(n.display&&nv(I))){var N=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):Ex(I.innerHTML),q=I.getAttribute("data-z")||I.getAttribute("z");for(y=0;y<_.length;++y){var Z=_[y];Z.s.c==D+l&&Z.s.r<b+a&&b+a<=Z.e.r&&(D=Z.e.c+1-l,y=-1)}O=+I.getAttribute("colspan")||1,((F=+I.getAttribute("rowspan")||1)>1||O>1)&&_.push({s:{r:b+a,c:D+l},e:{r:b+a+(F||1)-1,c:D+l+(O||1)-1}});var me={t:"s",v:N},ue=I.getAttribute("data-t")||I.getAttribute("t")||"";N!=null&&(N.length==0?me.t=ue||"z":n.raw||N.trim().length==0||ue=="s"||(N==="TRUE"?me={t:"b",v:!0}:N==="FALSE"?me={t:"b",v:!1}:isNaN(Ra(N))?isNaN(kl(N).getDate())||(me={t:"d",v:Hr(N)},n.cellDates||(me={t:"n",v:Tn(me.v)}),me.z=n.dateNF||kt[14]):me={t:"n",v:Ra(N)})),me.z===void 0&&q!=null&&(me.z=q);var Y="",se=I.getElementsByTagName("A");if(se&&se.length)for(var ve=0;ve<se.length&&!(se[ve].hasAttribute("href")&&(Y=se[ve].getAttribute("href"),Y.charAt(0)!="#"));++ve);Y&&Y.charAt(0)!="#"&&(me.l={Target:Y}),n.dense?(e[b+a]||(e[b+a]=[]),e[b+a][D+l]=me):e[xt({c:D+l,r:b+a})]=me,g.e.c<D+l&&(g.e.c=D+l),D+=O}}++b}return _.length&&(e["!merges"]=(e["!merges"]||[]).concat(_)),g.e.r=Math.max(g.e.r,b-1+a),e["!ref"]=It(g),b>=m&&(e["!fullref"]=It((g.e.r=d.length-C+b-1+a,g))),e}function O1(e,r){var t=r||{},n=t.dense?[]:{};return D1(n,e,r)}function GC(e,r){return Ts(O1(e,r),r)}function nv(e){var r="",t=ZC(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function ZC(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function KC(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=Lt(r.replace(/<[^>]*>/g,""));return[t]}var av={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function I1(e,r){var t=r||{},n=W0(e),a=[],l,c,d={name:""},m="",g=0,x,_,y={},S=[],C=t.dense?[]:{},b,E,D={value:""},F="",O=0,M=[],G=-1,I=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},q=0,Z={},me=[],ue={},Y=0,se=0,ve=[],ee=1,ce=1,V=[],ie={Names:[]},Q={},fe=["",""],R=[],P={},W="",U=0,H=!1,le=!1,ge=0;for($c.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=$c.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?C["!ref"]=It(N):C["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=N.e.r&&(C["!fullref"]=C["!ref"],N.e.r=t.sheetRows-1,C["!ref"]=It(N)),me.length&&(C["!merges"]=me),ve.length&&(C["!rows"]=ve),x.name=x.||x.name,typeof JSON<"u"&&JSON.stringify(x),S.push(x.name),y[x.name]=C,le=!1):b[0].charAt(b[0].length-2)!=="/"&&(x=ft(b[0],!1),G=I=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,C=t.dense?[]:{},me=[],ve=[],le=!0);break;case"table-row-group":b[1]==="/"?--q:++q;break;case"table-row":case"":if(b[1]==="/"){G+=ee,ee=1;break}if(_=ft(b[0],!1),_.?G=_.-1:G==-1&&(G=0),ee=+_["number-rows-repeated"]||1,ee<10)for(ge=0;ge<ee;++ge)q>0&&(ve[G+ge]={level:q});I=-1;break;case"covered-table-cell":b[1]!=="/"&&++I,t.sheetStubs&&(t.dense?(C[G]||(C[G]=[]),C[G][I]={t:"z"}):C[xt({r:G,c:I})]={t:"z"}),F="",M=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++I,D=ft(b[0],!1),ce=parseInt(D["number-columns-repeated"]||"1",10),E={t:"z",v:null},D.formula&&t.cellFormula!=!1&&(E.f=Jg(Lt(D.formula))),(D.||D["value-type"])=="string"&&(E.t="s",E.v=Lt(D["string-value"]||""),t.dense?(C[G]||(C[G]=[]),C[G][I]=E):C[xt({r:G,c:I})]=E),I+=ce-1;else if(b[1]!=="/"){++I,F="",O=0,M=[],ce=1;var Ce=ee?G+ee-1:G;if(I>N.e.c&&(N.e.c=I),I<N.s.c&&(N.s.c=I),G<N.s.r&&(N.s.r=G),Ce>N.e.r&&(N.e.r=Ce),D=ft(b[0],!1),R=[],P={},E={t:D.||D["value-type"],v:null},t.cellFormula)if(D.formula&&(D.formula=Lt(D.formula)),D["number-matrix-columns-spanned"]&&D["number-matrix-rows-spanned"]&&(Y=parseInt(D["number-matrix-rows-spanned"],10)||0,se=parseInt(D["number-matrix-columns-spanned"],10)||0,ue={s:{r:G,c:I},e:{r:G+Y-1,c:I+se-1}},E.F=It(ue),V.push([ue,E.F])),D.formula)E.f=Jg(D.formula);else for(ge=0;ge<V.length;++ge)G>=V[ge][0].s.r&&G<=V[ge][0].e.r&&I>=V[ge][0].s.c&&I<=V[ge][0].e.c&&(E.F=V[ge][1]);switch((D["number-columns-spanned"]||D["number-rows-spanned"])&&(Y=parseInt(D["number-rows-spanned"],10)||0,se=parseInt(D["number-columns-spanned"],10)||0,ue={s:{r:G,c:I},e:{r:G+Y-1,c:I+se-1}},me.push(ue)),D["number-columns-repeated"]&&(ce=parseInt(D["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=ar(D["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(D.value);break;case"percentage":E.t="n",E.v=parseFloat(D.value);break;case"currency":E.t="n",E.v=parseFloat(D.value);break;case"date":E.t="d",E.v=Hr(D["date-value"]),t.cellDates||(E.t="n",E.v=Tn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=ow(D["time-value"])/86400,t.cellDates&&(E.t="d",E.v=rf(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(D.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",D["string-value"]!=null&&(F=Lt(D["string-value"]),M=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(H=!1,E.t==="s"&&(E.v=F||"",M.length&&(E.R=M),H=O==0),Q.Target&&(E.l=Q),R.length>0&&(E.c=R,R=[]),F&&t.cellText!==!1&&(E.w=F),H&&(E.t="z",delete E.v),(!H||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=G))for(var ke=0;ke<ee;++ke){if(ce=parseInt(D["number-columns-repeated"]||"1",10),t.dense)for(C[G+ke]||(C[G+ke]=[]),C[G+ke][I]=ke==0?E:Yr(E);--ce>0;)C[G+ke][I+ce]=Yr(E);else for(C[xt({r:G+ke,c:I})]=E;--ce>0;)C[xt({r:G+ke,c:I+ce})]=Yr(E);N.e.c<=I&&(N.e.c=I)}ce=parseInt(D["number-columns-repeated"]||"1",10),I+=ce-1,ce=0,E={},F="",M=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((l=a.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((l=a.pop())[0]!==b[3])throw"Bad state: "+l;P.t=F,M.length&&(P.R=M),P.a=W,R.push(P)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);W="",U=0,F="",O=0,M=[];break;case"creator":b[1]==="/"?W=n.slice(U,b.index):U=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((l=a.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);F="",O=0,M=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(Z[d.name]=m,(l=a.pop())[0]!==b[3])throw"Bad state: "+l}else b[0].charAt(b[0].length-2)!=="/"&&(m="",d=ft(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":c=ft(b[0],!1),m+=av[b[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":c=ft(b[0],!1),m+=av[b[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(g,b.index);break}else g=b.index+b[0].length;break;case"named-range":c=ft(b[0],!1),fe=Wh(c["cell-range-address"]);var xe={Name:c.name,Ref:fe[0]+"!"+fe[1]};le&&(xe.Sheet=S.length),ie.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!D||!D["string-value"])){var Ke=KC(n.slice(O,b.index));F=(F.length>0?F+`
`:"")+Ke[0]}else ft(b[0],!1),O=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{fe=Wh(ft(b[0])["target-range-address"]),y[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(Q=ft(b[0],!1),!Q.href)break;Q.Target=Lt(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(fe=Wh(Q.Target.slice(1)),Q.Target="#"+fe[0]+"!"+fe[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(t.WTF)throw new Error(b)}}var te={Sheets:y,SheetNames:S,Workbook:ie};return t.bookSheets&&delete te.Sheets,te}function iv(e,r){r=r||{},da(e,"META-INF/manifest.xml")&&uk(br(e,"META-INF/manifest.xml"),r);var t=qn(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var n=I1(Xt(t),r);return da(e,"meta.xml")&&(n.Props=Gx(br(e,"meta.xml"))),n}function sv(e,r){return I1(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function rm(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function g0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Xt(ho(e))}function v0(e){var r=e.reduce(function(a,l){return a+l.length},0),t=new Uint8Array(r),n=0;return e.forEach(function(a){t.set(a,n),n+=a.length}),t}function ov(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function qC(e,r){for(var t=(e[r+15]&127)<<7|e[r+14]>>1,n=e[r+14]&1,a=r+13;a>=r;--a)n=n*256+e[a];return(e[r+15]&128?-n:n)*Math.pow(10,t-6176)}function Gc(e,r){var t=r?r[0]:0,n=e[t]&127;e:if(e[t++]>=128&&(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(n+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return r&&(r[0]=t),n}function Fr(e){var r=0,t=e[r]&127;e:if(e[r++]>=128){if(t|=(e[r]&127)<<7,e[r++]<128||(t|=(e[r]&127)<<14,e[r++]<128)||(t|=(e[r]&127)<<21,e[r++]<128))break e;t|=(e[r]&127)<<28}return t}function dn(e){for(var r=[],t=[0];t[0]<e.length;){var n=t[0],a=Gc(e,t),l=a&7;a=Math.floor(a/8);var c=0,d;if(a==0)break;switch(l){case 0:{for(var m=t[0];e[t[0]++]>=128;);d=e.slice(m,t[0])}break;case 5:c=4,d=e.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,d=e.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=Gc(e,t),d=e.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(a," at offset ").concat(n))}var g={data:d,type:l};r[a]==null?r[a]=[g]:r[a].push(g)}return r}function nm(e,r){return e?.map(function(t){return r(t.data)})||[]}function YC(e){for(var r,t=[],n=[0];n[0]<e.length;){var a=Gc(e,n),l=dn(e.slice(n[0],n[0]+a));n[0]+=a;var c={id:Fr(l[1][0].data),messages:[]};l[2].forEach(function(d){var m=dn(d.data),g=Fr(m[3][0].data);c.messages.push({meta:m,data:e.slice(n[0],n[0]+g)}),n[0]+=g}),(r=l[3])!=null&&r[0]&&(c.merge=Fr(l[3][0].data)>>>0>0),t.push(c)}return t}function XC(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],n=Gc(r,t),a=[];t[0]<r.length;){var l=r[t[0]]&3;if(l==0){var c=r[t[0]++]>>2;if(c<60)++c;else{var d=c-59;c=r[t[0]],d>1&&(c|=r[t[0]+1]<<8),d>2&&(c|=r[t[0]+2]<<16),d>3&&(c|=r[t[0]+3]<<24),c>>>=0,c++,t[0]+=d}a.push(r.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var m=0,g=0;if(l==1?(g=(r[t[0]]>>2&7)+4,m=(r[t[0]++]&224)<<3,m|=r[t[0]++]):(g=(r[t[0]++]>>2)+1,l==2?(m=r[t[0]]|r[t[0]+1]<<8,t[0]+=2):(m=(r[t[0]]|r[t[0]+1]<<8|r[t[0]+2]<<16|r[t[0]+3]<<24)>>>0,t[0]+=4)),a=[v0(a)],m==0)throw new Error("Invalid offset 0");if(m>a[0].length)throw new Error("Invalid offset beyond length");if(g>=m)for(a.push(a[0].slice(-m)),g-=m;g>=a[a.length-1].length;)a.push(a[a.length-1]),g-=a[a.length-1].length;a.push(a[0].slice(-m,-m+g))}}var x=v0(a);if(x.length!=n)throw new Error("Unexpected length: ".concat(x.length," != ").concat(n));return x}function JC(e){for(var r=[],t=0;t<e.length;){var n=e[t++],a=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,r.push(XC(n,e.slice(t,t+a))),t+=a}if(t!==e.length)throw new Error("data is not a valid framed stream!");return v0(r)}function QC(e,r,t,n){var a=rm(e),l=a.getUint32(4,!0),c=(n>1?12:8)+ov(l&(n>1?3470:398))*4,d=-1,m=-1,g=NaN,x=new Date(2001,0,1);l&512&&(d=a.getUint32(c,!0),c+=4),c+=ov(l&(n>1?12288:4096))*4,l&16&&(m=a.getUint32(c,!0),c+=4),l&32&&(g=a.getFloat64(c,!0),c+=8),l&64&&(x.setTime(x.getTime()+a.getFloat64(c,!0)*1e3),c+=8);var _;switch(e[2]){case 0:break;case 2:_={t:"n",v:g};break;case 3:_={t:"s",v:r[m]};break;case 5:_={t:"d",v:x};break;case 6:_={t:"b",v:g>0};break;case 7:_={t:"n",v:g/86400};break;case 8:_={t:"e",v:0};break;case 9:if(d>-1)_={t:"s",v:t[d]};else if(m>-1)_={t:"s",v:r[m]};else if(!isNaN(g))_={t:"n",v:g};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return _}function eA(e,r,t){var n=rm(e),a=n.getUint32(8,!0),l=12,c=-1,d=-1,m=NaN,g=NaN,x=new Date(2001,0,1);a&1&&(m=qC(e,l),l+=16),a&2&&(g=n.getFloat64(l,!0),l+=8),a&4&&(x.setTime(x.getTime()+n.getFloat64(l,!0)*1e3),l+=8),a&8&&(d=n.getUint32(l,!0),l+=4),a&16&&(c=n.getUint32(l,!0),l+=4);var _;switch(e[1]){case 0:break;case 2:_={t:"n",v:m};break;case 3:_={t:"s",v:r[d]};break;case 5:_={t:"d",v:x};break;case 6:_={t:"b",v:g>0};break;case 7:_={t:"n",v:g/86400};break;case 8:_={t:"e",v:0};break;case 9:if(c>-1)_={t:"s",v:t[c]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:_={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return _}function tA(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:return QC(e,r,t,e[0]);case 5:return eA(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ws(e){var r=dn(e);return Gc(r[1][0].data)}function lv(e,r){var t=dn(r.data),n=Fr(t[1][0].data),a=t[3],l=[];return(a||[]).forEach(function(c){var d=dn(c.data),m=Fr(d[1][0].data)>>>0;switch(n){case 1:l[m]=g0(d[3][0].data);break;case 8:{var g=e[ws(d[9][0].data)][0],x=dn(g.data),_=e[ws(x[1][0].data)][0],y=Fr(_.meta[1][0].data);if(y!=2001)throw new Error("2000 unexpected reference to ".concat(y));var S=dn(_.data);l[m]=S[3].map(function(C){return g0(C.data)}).join("")}break}}),l}function rA(e,r){var t,n,a,l,c,d,m,g,x,_,y,S,C,b,E=dn(e),D=Fr(E[1][0].data)>>>0,F=Fr(E[2][0].data)>>>0,O=((n=(t=E[8])==null?void 0:t[0])==null?void 0:n.data)&&Fr(E[8][0].data)>0||!1,M,G;if((l=(a=E[7])==null?void 0:a[0])!=null&&l.data&&r!=0)M=(d=(c=E[7])==null?void 0:c[0])==null?void 0:d.data,G=(g=(m=E[6])==null?void 0:m[0])==null?void 0:g.data;else if((_=(x=E[4])==null?void 0:x[0])!=null&&_.data&&r!=1)M=(S=(y=E[4])==null?void 0:y[0])==null?void 0:S.data,G=(b=(C=E[3])==null?void 0:C[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var I=O?4:1,N=rm(M),q=[],Z=0;Z<M.length/2;++Z){var me=N.getUint16(Z*2,!0);me<65535&&q.push([Z,me])}if(q.length!=F)throw"Expected ".concat(F," cells, found ").concat(q.length);var ue=[];for(Z=0;Z<q.length-1;++Z)ue[q[Z][0]]=G.subarray(q[Z][1]*I,q[Z+1][1]*I);return q.length>=1&&(ue[q[q.length-1][0]]=G.subarray(q[q.length-1][1]*I)),{R:D,cells:ue}}function nA(e,r){var t,n=dn(r.data),a=(t=n?.[7])!=null&&t[0]?Fr(n[7][0].data)>>>0>0?1:0:-1,l=nm(n[5],function(c){return rA(c,a)});return{nrows:Fr(n[4][0].data)>>>0,data:l.reduce(function(c,d){return c[d.R]||(c[d.R]=[]),d.cells.forEach(function(m,g){if(c[d.R][g])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(g));c[d.R][g]=m}),c},[])}}function aA(e,r,t){var n,a=dn(r.data),l={s:{r:0,c:0},e:{r:0,c:0}};if(l.e.r=(Fr(a[6][0].data)>>>0)-1,l.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(l.e.c=(Fr(a[7][0].data)>>>0)-1,l.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));t["!ref"]=It(l);var c=dn(a[4][0].data),d=lv(e,e[ws(c[4][0].data)][0]),m=(n=c[17])!=null&&n[0]?lv(e,e[ws(c[17][0].data)][0]):[],g=dn(c[3][0].data),x=0;g[1].forEach(function(_){var y=dn(_.data),S=e[ws(y[2][0].data)][0],C=Fr(S.meta[1][0].data);if(C!=6002)throw new Error("6001 unexpected reference to ".concat(C));var b=nA(e,S);b.data.forEach(function(E,D){E.forEach(function(F,O){var M=xt({r:x+D,c:O}),G=tA(F,d,m);G&&(t[M]=G)})}),x+=b.nrows})}function iA(e,r){var t=dn(r.data),n={"!ref":"A1"},a=e[ws(t[2][0].data)],l=Fr(a[0].meta[1][0].data);if(l!=6001)throw new Error("6000 unexpected reference to ".concat(l));return aA(e,a[0],n),n}function sA(e,r){var t,n=dn(r.data),a={name:(t=n[1])!=null&&t[0]?g0(n[1][0].data):"",sheets:[]},l=nm(n[2],ws);return l.forEach(function(c){e[c].forEach(function(d){var m=Fr(d.meta[1][0].data);m==6e3&&a.sheets.push(iA(e,d))})}),a}function oA(e,r){var t=sm(),n=dn(r.data),a=nm(n[1],ws);if(a.forEach(function(l){e[l].forEach(function(c){var d=Fr(c.meta[1][0].data);if(d==2){var m=sA(e,c);m.sheets.forEach(function(g,x){om(t,g,x==0?m.name:m.name+"_"+x,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function Vh(e){var r,t,n,a,l={},c=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var g;try{g=JC(m.content)}catch(_){return console.log("?? "+m.content.length+" "+(_.message||_))}var x;try{x=YC(g)}catch(_){return console.log("## "+(_.message||_))}x.forEach(function(_){l[_.id]=_.messages,c.push(_.id)})}}),!c.length)throw new Error("File has no messages");var d=((a=(n=(t=(r=l?.[1])==null?void 0:r[0])==null?void 0:t.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Fr(l[1][0].meta[1][0].data)==1&&l[1][0];if(d||c.forEach(function(m){l[m].forEach(function(g){var x=Fr(g.meta[1][0].data)>>>0;if(x==1)if(!d)d=g;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return oA(l,d)}function lA(e){return function(t){for(var n=0;n!=e.length;++n){var a=e[n];t[a[0]]===void 0&&(t[a[0]]=a[1]),a[2]==="n"&&(t[a[0]]=Number(t[a[0]]))}}}function am(e){lA([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function cA(e){return xl.WS.indexOf(e)>-1?"sheet":e==xl.CS?"chart":e==xl.DS?"dialog":e==xl.MS?"macro":e&&e.length?e:"sheet"}function uA(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,cA(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function dA(e,r,t,n,a,l,c,d,m,g,x,_){try{l[n]=Nc(qn(e,t,!0),r);var y=br(e,r),S;switch(d){case"sheet":S=vC(y,r,a,m,l[n],g,x,_);break;case"chart":if(S=xC(y,r,a,m,l[n],g,x,_),!S||!S["!drawel"])break;var C=bc(S["!drawel"].Target,r),b=d0(C),E=g2(qn(e,C,!0),Nc(qn(e,b,!0),C)),D=bc(E,C),F=d0(D);S=eC(qn(e,D,!0),D,m,Nc(qn(e,F,!0),D),g,S);break;case"macro":S=yC(y,r,a,m,l[n],g,x,_);break;case"dialog":S=_C(y,r,a,m,l[n],g,x,_);break;default:throw new Error("Unrecognized sheet type "+d)}c[n]=S;var O=[];l&&l[n]&&Ja(l[n]).forEach(function(M){var G="";if(l[n][M].Type==xl.CMNT){G=bc(l[n][M].Target,r);var I=SC(br(e,G,!0),G,m);if(!I||!I.length)return;Zg(S,I,!1)}l[n][M].Type==xl.TCMNT&&(G=bc(l[n][M].Target,r),O=O.concat(x2(br(e,G,!0),m)))}),O&&O.length&&Zg(S,O,!0,m.people||[])}catch(M){if(m.WTF)throw M}}function ca(e){return e.charAt(0)=="/"?e.slice(1):e}function fA(e,r){if(vx(),r=r||{},am(r),da(e,"META-INF/manifest.xml")||da(e,"objectdata.xml"))return iv(e,r);if(da(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Vh<"u"){if(e.FileIndex)return Vh(e);var t=Ot.utils.cfb_new();return _g(e).forEach(function(ve){hw(t,ve,fw(e,ve))}),Vh(t)}throw new Error("Unsupported NUMBERS file")}if(!da(e,"[Content_Types].xml"))throw da(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):da(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=_g(e),a=lk(qn(e,"[Content_Types].xml")),l=!1,c,d;if(a.workbooks.length===0&&(d="xl/workbook.xml",br(e,d,!0)&&a.workbooks.push(d)),a.workbooks.length===0){if(d="xl/workbook.bin",!br(e,d,!0))throw new Error("Could not find workbook");a.workbooks.push(d),l=!0}a.workbooks[0].slice(-3)=="bin"&&(l=!0);var m={},g={};if(!r.bookSheets&&!r.bookProps){if(Ic=[],a.sst)try{Ic=bC(br(e,ca(a.sst)),a.sst,r)}catch(ve){if(r.WTF)throw ve}r.cellStyles&&a.themes.length&&(m=kC(qn(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],r)),a.style&&(g=wC(br(e,ca(a.style)),a.style,m,r))}a.links.map(function(ve){try{var ee=Nc(qn(e,d0(ca(ve))),ve);return EC(br(e,ca(ve)),ee,ve,r)}catch{}});var x=gC(br(e,ca(a.workbooks[0])),a.workbooks[0],r),_={},y="";a.coreprops.length&&(y=br(e,ca(a.coreprops[0]),!0),y&&(_=Gx(y)),a.extprops.length!==0&&(y=br(e,ca(a.extprops[0]),!0),y&&hk(y,_,r)));var S={};(!r.bookSheets||r.bookProps)&&a.custprops.length!==0&&(y=qn(e,ca(a.custprops[0]),!0),y&&(S=pk(y,r)));var C={};if((r.bookSheets||r.bookProps)&&(x.Sheets?c=x.Sheets.map(function(ee){return ee.name}):_.Worksheets&&_.SheetNames.length>0&&(c=_.SheetNames),r.bookProps&&(C.Props=_,C.Custprops=S),r.bookSheets&&typeof c<"u"&&(C.SheetNames=c),r.bookSheets?C.SheetNames:r.bookProps))return C;c={};var b={};r.bookDeps&&a.calcchain&&(b=TC(br(e,ca(a.calcchain)),a.calcchain));var E=0,D={},F,O;{var M=x.Sheets;_.Worksheets=M.length,_.SheetNames=[];for(var G=0;G!=M.length;++G)_.SheetNames[G]=M[G].name}var I=l?"bin":"xml",N=a.workbooks[0].lastIndexOf("/"),q=(a.workbooks[0].slice(0,N+1)+"_rels/"+a.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");da(e,q)||(q="xl/_rels/workbook."+I+".rels");var Z=Nc(qn(e,q,!0),q.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(r.xlmeta=CC(br(e,ca(a.metadata[0])),a.metadata[0],r)),(a.people||[]).length>=1&&(r.people=y2(br(e,ca(a.people[0])),r)),Z&&(Z=uA(Z,x.Sheets));var me=br(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=_.Worksheets;++E){var ue="sheet";if(Z&&Z[E]?(F="xl/"+Z[E][1].replace(/[\/]?xl\//,""),da(e,F)||(F=Z[E][1]),da(e,F)||(F=q.replace(/_rels\/.*$/,"")+Z[E][1]),ue=Z[E][2]):(F="xl/worksheets/sheet"+(E+1-me)+"."+I,F=F.replace(/sheet0\./,"sheet.")),O=F.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(E!=r.sheets)continue e;break;case"string":if(_.SheetNames[E].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var Y=!1,se=0;se!=r.sheets.length;++se)typeof r.sheets[se]=="number"&&r.sheets[se]==E&&(Y=1),typeof r.sheets[se]=="string"&&r.sheets[se].toLowerCase()==_.SheetNames[E].toLowerCase()&&(Y=1);if(!Y)continue e}}dA(e,F,O,_.SheetNames[E],E,D,c,ue,r,x,m,g)}return C={Directory:a,Workbook:x,Props:_,Custprops:S,Deps:b,Sheets:c,SheetNames:_.SheetNames,Strings:Ic,Styles:g,Themes:m,SSF:Yr(kt)},r&&r.bookFiles&&(e.files?(C.keys=n,C.files=e.files):(C.keys=[],C.files={},e.FullPaths.forEach(function(ve,ee){ve=ve.replace(/^Root Entry[\/]/,""),C.keys.push(ve),C.files[ve]=e.FileIndex[ee]}))),r&&r.bookVBA&&(a.vba.length>0?C.vbaraw=br(e,ca(a.vba[0]),!0):a.defaults&&a.defaults.bin===b2&&(C.vbaraw=br(e,"xl/vbaProject.bin",!0))),C}function hA(e,r){var t=r||{},n="Workbook",a=Ot.find(e,n);try{if(n="/!DataSpaces/Version",a=Ot.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(iS(a.content),n="/!DataSpaces/DataSpaceMap",a=Ot.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=oS(a.content);if(l.length!==1||l[0].comps.length!==1||l[0].comps[0].t!==0||l[0].name!=="StrongEncryptionDataSpace"||l[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ot.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=lS(a.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ot.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);uS(a.content)}catch{}if(n="/EncryptionInfo",a=Ot.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var d=dS(a.content);if(n="/EncryptedPackage",a=Ot.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],a.content,t.password||"",t);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],a.content,t.password||"",t);throw new Error("File is password-protected")}function im(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Yn(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function mA(e,r){return Ot.find(e,"EncryptedPackage")?hA(e,r):N1(e,r)}function pA(e,r){var t,n=e,a=r||{};return a.type||(a.type=Dt&&Buffer.isBuffer(e)?"buffer":"base64"),t=bx(n,a),fA(t,a)}function F1(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return m0(e.slice(t),r);default:break e}return Wc.to_workbook(e,r)}function gA(e,r){var t="",n=im(e,r);switch(r.type){case"base64":t=Yn(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=co(e);break;default:throw new Error("Unrecognized type "+r.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(t=Xt(t)),r.type="binary",F1(t,r)}function vA(e,r){var t=e;return r.type=="base64"&&(t=Yn(t)),t=Bc.utils.decode(1200,t.slice(2),"str"),r.type="binary",F1(t,r)}function xA(e){return e.match(/[^\x00-\x7F]/)?Sc(e):e}function Gh(e,r,t,n){return n?(t.type="string",Wc.to_workbook(e,t)):Wc.to_workbook(r,t)}function x0(e,r){ix();var t=r||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return x0(new Uint8Array(e),(t=Yr(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],l=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),wl={},t.dateNF&&(wl.dateNF=t.dateNF),t.type||(t.type=Dt&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=Dt?"buffer":"binary",n=iw(e),typeof Uint8Array<"u"&&!Dt&&(t.type="array")),t.type=="string"&&(l=!0,t.type="binary",t.codepage=65001,n=xA(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),d=new Uint8Array(c);if(d.foo="bar",!d.foo)return t=Yr(t),t.type="array",x0(j0(n),t)}switch((a=im(n,t))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return mA(Ot.read(n,t),t);break;case 9:if(a[1]<=8)return N1(n,t);break;case 60:return m0(n,t);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Gb(n,t);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Hb.to_workbook(n,t);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?pA(n,t):Gh(e,n,t,l);case 239:return a[3]===60?m0(n,t):Gh(e,n,t,l);case 255:if(a[1]===254)return vA(n,t);if(a[1]===0&&a[2]===2&&a[3]===0)return Oc.to_workbook(n,t);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Oc.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return Gg.to_workbook(n,t);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return bS.to_workbook(n,t);break;case 10:case 13:case 32:return gA(n,t);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return $b.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Gg.to_workbook(n,t):Gh(e,n,t,l)}function yA(e,r,t,n,a,l,c,d){var m=Xr(t),g=d.defval,x=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),_=!0,y=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:t,enumerable:!1})}catch{y.__rowNum__=t}else y.__rowNum__=t;if(!c||e[t])for(var S=r.s.c;S<=r.e.c;++S){var C=c?e[t][S]:e[n[S]+m];if(C===void 0||C.t===void 0){if(g===void 0)continue;l[S]!=null&&(y[l[S]]=g);continue}var b=C.v;switch(C.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+C.t)}if(l[S]!=null){if(b==null)if(C.t=="e"&&b===null)y[l[S]]=null;else if(g!==void 0)y[l[S]]=g;else if(x&&b===null)y[l[S]]=null;else continue;else y[l[S]]=x&&(C.t!=="n"||C.t==="n"&&d.rawNumbers!==!1)?b:Ni(C,b,d);b!=null&&(_=!1)}}return{row:y,isempty:_}}function y0(e,r){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},n=0,a=1,l=[],c=0,d="",m={s:{r:0,c:0},e:{r:0,c:0}},g=r||{},x=g.range!=null?g.range:e["!ref"];switch(g.header===1?n=1:g.header==="A"?n=2:Array.isArray(g.header)?n=3:g.header==null&&(n=0),typeof x){case"string":m=mr(x);break;case"number":m=mr(e["!ref"]),m.s.r=x;break;default:m=x}n>0&&(a=0);var _=Xr(m.s.r),y=[],S=[],C=0,b=0,E=Array.isArray(e),D=m.s.r,F=0,O={};E&&!e[D]&&(e[D]=[]);var M=g.skipHidden&&e["!cols"]||[],G=g.skipHidden&&e["!rows"]||[];for(F=m.s.c;F<=m.e.c;++F)if(!(M[F]||{}).hidden)switch(y[F]=Ir(F),t=E?e[D][F]:e[y[F]+_],n){case 1:l[F]=F-m.s.c;break;case 2:l[F]=y[F];break;case 3:l[F]=g.header[F-m.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),d=c=Ni(t,null,g),b=O[c]||0,!b)O[c]=1;else{do d=c+"_"+b++;while(O[d]);O[c]=b,O[d]=1}l[F]=d}for(D=m.s.r+a;D<=m.e.r;++D)if(!(G[D]||{}).hidden){var I=yA(e,m,D,y,n,l,E,g);(I.isempty===!1||(n===1?g.blankrows!==!1:g.blankrows))&&(S[C++]=I.row)}return S.length=C,S}var cv=/"/g;function _A(e,r,t,n,a,l,c,d){for(var m=!0,g=[],x="",_=Xr(t),y=r.s.c;y<=r.e.c;++y)if(n[y]){var S=d.dense?(e[t]||[])[y]:e[n[y]+_];if(S==null)x="";else if(S.v!=null){m=!1,x=""+(d.rawNumbers&&S.t=="n"?S.v:Ni(S,null,d));for(var C=0,b=0;C!==x.length;++C)if((b=x.charCodeAt(C))===a||b===l||b===34||d.forceQuotes){x='"'+x.replace(cv,'""')+'"';break}x=="ID"&&(x='"ID"')}else S.f!=null&&!S.F?(m=!1,x="="+S.f,x.indexOf(",")>=0&&(x='"'+x.replace(cv,'""')+'"')):x="";g.push(x)}return d.blankrows===!1&&m?null:g.join(c)}function L1(e,r){var t=[],n=r??{};if(e==null||e["!ref"]==null)return"";var a=mr(e["!ref"]),l=n.FS!==void 0?n.FS:",",c=l.charCodeAt(0),d=n.RS!==void 0?n.RS:`
`,m=d.charCodeAt(0),g=new RegExp((l=="|"?"\\|":l)+"+$"),x="",_=[];n.dense=Array.isArray(e);for(var y=n.skipHidden&&e["!cols"]||[],S=n.skipHidden&&e["!rows"]||[],C=a.s.c;C<=a.e.c;++C)(y[C]||{}).hidden||(_[C]=Ir(C));for(var b=0,E=a.s.r;E<=a.e.r;++E)(S[E]||{}).hidden||(x=_A(e,a,E,_,c,m,l,n),x!=null&&(n.strip&&(x=x.replace(g,"")),(x||n.blankrows!==!1)&&t.push((b++?d:"")+x)));return delete n.dense,t.join("")}function wA(e,r){r||(r={}),r.FS="	",r.RS=`
`;var t=L1(e,r);return t}function kA(e){var r="",t,n="";if(e==null||e["!ref"]==null)return[];var a=mr(e["!ref"]),l="",c=[],d,m=[],g=Array.isArray(e);for(d=a.s.c;d<=a.e.c;++d)c[d]=Ir(d);for(var x=a.s.r;x<=a.e.r;++x)for(l=Xr(x),d=a.s.c;d<=a.e.c;++d)if(r=c[d]+l,t=g?(e[x]||[])[d]:e[r],n="",t!==void 0){if(t.F!=null){if(r=t.F,!t.f)continue;n=t.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(t.f!=null)n=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)n=""+t.v;else if(t.t=="b")n=t.v?"TRUE":"FALSE";else if(t.w!==void 0)n="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?n="'"+t.v:n=""+t.v}}m[m.length]=r+"="+n}return m}function R1(e,r,t){var n=t||{},a=+!n.skipHeader,l=e||{},c=0,d=0;if(l&&n.origin!=null)if(typeof n.origin=="number")c=n.origin;else{var m=typeof n.origin=="string"?bn(n.origin):n.origin;c=m.r,d=m.c}var g,x={s:{c:0,r:0},e:{c:d,r:c+r.length-1+a}};if(l["!ref"]){var _=mr(l["!ref"]);x.e.c=Math.max(x.e.c,_.e.c),x.e.r=Math.max(x.e.r,_.e.r),c==-1&&(c=_.e.r+1,x.e.r=c+r.length-1+a)}else c==-1&&(c=0,x.e.r=r.length-1+a);var y=n.header||[],S=0;r.forEach(function(b,E){Ja(b).forEach(function(D){(S=y.indexOf(D))==-1&&(y[S=y.length]=D);var F=b[D],O="z",M="",G=xt({c:d+S,r:c+E+a});g=Zc(l,G),F&&typeof F=="object"&&!(F instanceof Date)?l[G]=F:(typeof F=="number"?O="n":typeof F=="boolean"?O="b":typeof F=="string"?O="s":F instanceof Date?(O="d",n.cellDates||(O="n",F=Tn(F)),M=n.dateNF||kt[14]):F===null&&n.nullError&&(O="e",F=0),g?(g.t=O,g.v=F,delete g.w,delete g.R,M&&(g.z=M)):l[G]=g={t:O,v:F},M&&(g.z=M))})}),x.e.c=Math.max(x.e.c,d+y.length-1);var C=Xr(c);if(a)for(S=0;S<y.length;++S)l[Ir(S+d)+C]={t:"s",v:y[S]};return l["!ref"]=It(x),l}function bA(e,r){return R1(null,e,r)}function Zc(e,r,t){if(typeof r=="string"){if(Array.isArray(e)){var n=bn(r);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Zc(e,xt(r)):Zc(e,xt({r,c:t||0}))}function SA(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function sm(){return{SheetNames:[],Sheets:{}}}function om(e,r,t,n){var a=1;if(!t)for(;a<=65535&&e.SheetNames.indexOf(t="Sheet"+a)!=-1;++a,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);a=l&&+l[2]||0;var c=l&&l[1]||t;for(++a;a<=65535&&e.SheetNames.indexOf(t=c+a)!=-1;++a);}if(lC(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function TA(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=SA(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t}function EA(e,r){return e.z=r,e}function j1(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}function CA(e,r,t){return j1(e,"#"+r,t)}function AA(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})}function PA(e,r,t,n){for(var a=typeof r!="string"?r:mr(r),l=typeof r=="string"?r:It(r),c=a.s.r;c<=a.e.r;++c)for(var d=a.s.c;d<=a.e.c;++d){var m=Zc(e,c,d);m.t="n",m.F=l,delete m.v,c==a.s.r&&d==a.s.c&&(m.f=t,n&&(m.D=!0))}return e}var NA={encode_col:Ir,encode_row:Xr,encode_cell:xt,encode_range:It,decode_col:G0,decode_row:V0,split_cell:Uw,decode_cell:bn,decode_range:Al,format_cell:Ni,sheet_add_aoa:Ux,sheet_add_json:R1,sheet_add_dom:D1,aoa_to_sheet:Pl,json_to_sheet:bA,table_to_sheet:O1,table_to_book:GC,sheet_to_csv:L1,sheet_to_txt:wA,sheet_to_json:y0,sheet_to_html:VC,sheet_to_formulae:kA,sheet_to_row_object_array:y0,sheet_get_cell:Zc,book_new:sm,book_append_sheet:om,book_set_sheet_visibility:TA,cell_set_number_format:EA,cell_set_hyperlink:j1,cell_set_internal_link:CA,cell_add_comment:AA,sheet_set_array_formula:PA,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Ei({isLoading:e=!1,loadingText:r="Loading...",children:t,disabled:n,...a}){return h.jsxs("button",{...a,disabled:n||e,className:`${a.className||""} ${e?"btn-loading":""}`.trim(),children:[e&&h.jsx("span",{className:"loading-spinner","aria-hidden":"true",children:h.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"spinner-icon",children:h.jsx("circle",{cx:"8",cy:"8",r:"6",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"37.7",strokeDashoffset:"37.7"})})}),h.jsx("span",{className:e?"loading-text":"",children:e?r:t})]})}function DA({size:e="md",text:r,className:t=""}){const a={sm:"16",md:"24",lg:"32"}[e];return h.jsxs("div",{className:`loading-spinner-container ${t}`,children:[h.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",className:"loading-spinner-icon",children:h.jsx("circle",{cx:"12",cy:"12",r:"9",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"56.5",strokeDashoffset:"56.5"})}),r&&h.jsx("span",{className:"loading-text",children:r})]})}function M1({onImported:e}){const[r,t]=J.useState(!1),[n,a]=J.useState(!1),l=J.useRef(null),c=J.useRef(!1),d=async _=>{if(!(!_||c.current)){c.current=!0,t(!0);try{const y=await _.arrayBuffer(),S=x0(y,{type:"array"}),C=S.Sheets[S.SheetNames[0]],b=NA.sheet_to_json(C,{header:1});if(!b.length){alert(" File appears to be empty. Please check your Excel file.");return}const E=(b[0]||[]).map(Z=>String(Z??"").trim().toLowerCase());let D=E.findIndex(Z=>Z.includes("address"));D===-1&&(D=0);const F=E.findIndex(Z=>Z==="lat"||Z.includes("latitude")),O=E.findIndex(Z=>Z==="lng"||Z==="lon"||Z.includes("longitude")),M=F===-1?void 0:F,G=O===-1?void 0:O,I=[];for(let Z=1;Z<b.length;Z++){const me=b[Z]||[],ue=String(me[D]??"").trim();if(!ue)continue;const Y=M!==void 0&&me[M]!=null&&me[M]!==""?uv(me[M]):void 0,se=G!==void 0&&me[G]!=null&&me[G]!==""?uv(me[G]):void 0;I.push({address:ue,lat:Y,lng:se})}if(I.length===0){alert(" No valid addresses found in the file. Please check the format.");return}e(I);const N=I.some(Z=>Z.lat!=null&&Z.lng!=null),q=` Successfully imported ${I.length} address${I.length===1?"":"es"}${N?" with GPS coordinates":""}!`;console.log(q)}catch(y){console.error(y),alert(" Failed to read Excel file. Please ensure it's a valid .xlsx or .xls file.")}finally{c.current=!1,t(!1),l.current&&(l.current.value="")}}},m=async _=>{if(c.current)return;const y=_.target.files?.[0];y&&await d(y)},g=_=>{_.preventDefault(),_.stopPropagation(),_.type==="dragenter"||_.type==="dragover"?a(!0):_.type==="dragleave"&&a(!1)},x=async _=>{if(_.preventDefault(),_.stopPropagation(),c.current)return;a(!1);const S=Array.from(_.dataTransfer.files).find(C=>C.name.endsWith(".xlsx")||C.name.endsWith(".xls")||C.type.includes("spreadsheet"));S?await d(S):alert(" Please drop an Excel file (.xlsx or .xls)")};return h.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:"0.75rem",flex:1},children:[h.jsx("input",{ref:l,type:"file",accept:".xlsx,.xls",onChange:m,className:"file-input",id:"excel-input",disabled:r,style:{display:"none"}}),h.jsx(Ei,{className:"btn btn-primary",onClick:()=>l.current?.click(),isLoading:r,loadingText:"Processing...",disabled:r,style:{whiteSpace:"nowrap"},children:" Import Excel"}),h.jsx("div",{onDragEnter:g,onDragLeave:g,onDragOver:g,onDrop:x,className:"btn btn-ghost",style:{border:`2px dashed ${n?"var(--primary)":"var(--border-light)"}`,background:n?"var(--primary-light)":"transparent",color:n?"var(--primary-dark)":"var(--text-muted)",fontSize:"0.875rem",textAlign:"center",cursor:"pointer",transition:"all var(--transition-fast)",userSelect:"none",minWidth:"140px",flex:1,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>l.current?.click(),children:n?h.jsx("span",{children:" Drop Excel file here"}):h.jsx("span",{children:" Or drag & drop Excel"})})]})}function uv(e){const r=Number(e);return Number.isFinite(r)?r:void 0}function nu(e){return new Promise((r,t)=>{e.oncomplete=e.onsuccess=()=>r(e.result),e.onabort=e.onerror=()=>t(e.error)})}function B1(e,r){let t;const n=()=>{if(t)return t;const a=indexedDB.open(e);return a.onupgradeneeded=()=>a.result.createObjectStore(r),t=nu(a),t.then(l=>{l.onclose=()=>t=void 0},()=>{}),t};return(a,l)=>n().then(c=>l(c.transaction(r,a).objectStore(r)))}let Zh;function lm(){return Zh||(Zh=B1("keyval-store","keyval")),Zh}function cm(e,r=lm()){return r("readonly",t=>nu(t.get(e)))}function um(e,r,t=lm()){return t("readwrite",n=>(n.put(r,e),nu(n.transaction)))}function OA(e=lm()){return e("readwrite",r=>(r.clear(),nu(r.transaction)))}const IA=Object.freeze(Object.defineProperty({__proto__:null,clear:OA,createStore:B1,get:cm,promisifyRequest:nu,set:um},Symbol.toStringTag,{value:"Module"})),Ne={debug:(e,...r)=>{},info:(e,...r)=>{},warn:(e,...r)=>{console.warn(`[WARN] ${e}`,...r)},error:(e,...r)=>{console.error(`[ERROR] ${e}`,...r)},success:(e,...r)=>{},sync:(e,...r)=>{},time:e=>{},timeEnd:e=>{},group:e=>{},groupEnd:()=>{}};class FA{queue=[];processing=!1;persistenceGranted=!1;constructor(){this.initializePersistence()}async initializePersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const r=await navigator.storage.persist();if(this.persistenceGranted=r,r?Ne.info(" Persistent storage granted - data protected from eviction"):Ne.warn(" Persistent storage denied - data may be evicted by browser"),"estimate"in navigator.storage){const t=await navigator.storage.estimate(),n=Math.round((t.usage||0)/1024/1024),a=Math.round((t.quota||0)/1024/1024);Ne.info(` Storage: ${n}MB used / ${a}MB quota`),t.usage&&t.quota&&t.usage>t.quota*.8&&Ne.warn(" Storage quota 80% full - may cause data loss")}}else Ne.warn(" Storage persistence API not available")}catch(r){Ne.error("Failed to initialize storage persistence:",r)}}async queuedSet(r,t){return new Promise((n,a)=>{this.queue.push({key:r,data:t,resolve:n,reject:a}),this.processQueue()})}async processQueue(){if(!(this.processing||this.queue.length===0)){for(this.processing=!0;this.queue.length>0;){const r=this.queue.shift();try{let t=3,n;for(;t>0;)try{await um(r.key,r.data),r.resolve(void 0);break}catch(a){n=a,t--,t>0&&(Ne.warn(`IndexedDB write failed, retrying... (${3-t}/3)`,a),await new Promise(l=>setTimeout(l,100*(4-t))))}t===0&&(Ne.error("IndexedDB write failed after 3 retries:",n),r.reject(n))}catch(t){Ne.error("Storage queue operation failed:",t),r.reject(t)}}this.processing=!1}}async queuedGet(r){try{return await this.checkStorageHealth(),await cm(r)}catch(t){throw Ne.error("IndexedDB read failed:",t),t}}async checkStorageHealth(){try{if("storage"in navigator&&"estimate"in navigator.storage){const r=await navigator.storage.estimate();if(r.usage&&r.quota&&r.usage>r.quota*.95)throw Ne.error(" CRITICAL: Storage quota 95% full - immediate data loss risk"),new Error("Storage quota exhausted")}}catch(r){Ne.warn("Storage health check failed:",r)}}async requestPersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const r=await navigator.storage.persist();return this.persistenceGranted=r,r}}catch(r){Ne.error("Failed to request storage persistence:",r)}return!1}get isPersistent(){return this.persistenceGranted}}const kd=new FA;class LA{toasts=[];listeners=[];timeouts=new Map;show(r,t="info",n=4e3){const a={id:`toast_${Date.now()}_${Math.random().toString(36).slice(2)}`,message:r,type:t,timestamp:Date.now(),duration:n};if(this.toasts.push(a),this.notifyListeners(),n>0){const l=setTimeout(()=>{this.remove(a.id)},n);this.timeouts.set(a.id,l)}return a.id}remove(r){const t=this.timeouts.get(r);t&&(clearTimeout(t),this.timeouts.delete(r)),this.toasts=this.toasts.filter(n=>n.id!==r),this.notifyListeners()}clear(){this.timeouts.forEach(r=>clearTimeout(r)),this.timeouts.clear(),this.toasts=[],this.notifyListeners()}getToasts(){return[...this.toasts]}subscribe(r){return this.listeners.push(r),()=>{this.listeners=this.listeners.filter(t=>t!==r)}}notifyListeners(){this.listeners.forEach(r=>r([...this.toasts]))}}const Xd=new LA,dv=(e,r)=>Xd.show(e,"warning",r),RA=(e,r)=>Xd.show(e,"info",r);function Lr(e){const r=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&r==="[object Date]"?new e.constructor(+e):typeof e=="number"||r==="[object Number]"||typeof e=="string"||r==="[object String]"?new Date(e):new Date(NaN)}function Ss(e,r){return e instanceof Date?new e.constructor(r):new Date(r)}function z1(e,r){const t=Lr(e);return isNaN(r)?Ss(e,NaN):(r&&t.setDate(t.getDate()+r),t)}const U1=6048e5,jA=864e5,$1=6e4,W1=36e5;let MA={};function of(){return MA}function Sl(e,r){const t=of(),n=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,a=Lr(e),l=a.getDay(),c=(l<n?7:0)+l-n;return a.setDate(a.getDate()-c),a.setHours(0,0,0,0),a}function Jd(e){return Sl(e,{weekStartsOn:1})}function H1(e){const r=Lr(e),t=r.getFullYear(),n=Ss(e,0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);const a=Jd(n),l=Ss(e,0);l.setFullYear(t,0,4),l.setHours(0,0,0,0);const c=Jd(l);return r.getTime()>=a.getTime()?t+1:r.getTime()>=c.getTime()?t:t-1}function oo(e){const r=Lr(e);return r.setHours(0,0,0,0),r}function fv(e){const r=Lr(e),t=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return t.setUTCFullYear(r.getFullYear()),+e-+t}function BA(e,r){const t=oo(e),n=oo(r),a=+t-fv(t),l=+n-fv(n);return Math.round((a-l)/jA)}function zA(e){const r=H1(e),t=Ss(e,0);return t.setFullYear(r,0,4),t.setHours(0,0,0,0),Jd(t)}function hv(e,r){const t=oo(e),n=oo(r);return+t==+n}function UA(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function $A(e){if(!UA(e)&&typeof e!="number")return!1;const r=Lr(e);return!isNaN(Number(r))}function WA(e){const r=Lr(e),t=Ss(e,0);return t.setFullYear(r.getFullYear(),0,1),t.setHours(0,0,0,0),t}function HA(e,r){const t=r?.weekStartsOn,n=Lr(e),a=n.getDay(),l=(a<t?-7:0)+6-(a-t);return n.setDate(n.getDate()+l),n.setHours(23,59,59,999),n}const VA={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},GA=(e,r,t)=>{let n;const a=VA[e];return typeof a=="string"?n=a:r===1?n=a.one:n=a.other.replace("{{count}}",r.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function Kh(e){return(r={})=>{const t=r.width?String(r.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const ZA={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},KA={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},qA={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},YA={date:Kh({formats:ZA,defaultWidth:"full"}),time:Kh({formats:KA,defaultWidth:"full"}),dateTime:Kh({formats:qA,defaultWidth:"full"})},XA={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},JA=(e,r,t,n)=>XA[e];function xc(e){return(r,t)=>{const n=t?.context?String(t.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const c=e.defaultFormattingWidth||e.defaultWidth,d=t?.width?String(t.width):c;a=e.formattingValues[d]||e.formattingValues[c]}else{const c=e.defaultWidth,d=t?.width?String(t.width):e.defaultWidth;a=e.values[d]||e.values[c]}const l=e.argumentCallback?e.argumentCallback(r):r;return a[l]}}const QA={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},eP={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},tP={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},rP={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},nP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},aP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},iP=(e,r)=>{const t=Number(e),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},sP={ordinalNumber:iP,era:xc({values:QA,defaultWidth:"wide"}),quarter:xc({values:eP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:xc({values:tP,defaultWidth:"wide"}),day:xc({values:rP,defaultWidth:"wide"}),dayPeriod:xc({values:nP,defaultWidth:"wide",formattingValues:aP,defaultFormattingWidth:"wide"})};function yc(e){return(r,t={})=>{const n=t.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],l=r.match(a);if(!l)return null;const c=l[0],d=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],m=Array.isArray(d)?lP(d,_=>_.test(c)):oP(d,_=>_.test(c));let g;g=e.valueCallback?e.valueCallback(m):m,g=t.valueCallback?t.valueCallback(g):g;const x=r.slice(c.length);return{value:g,rest:x}}}function oP(e,r){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&r(e[t]))return t}function lP(e,r){for(let t=0;t<e.length;t++)if(r(e[t]))return t}function cP(e){return(r,t={})=>{const n=r.match(e.matchPattern);if(!n)return null;const a=n[0],l=r.match(e.parsePattern);if(!l)return null;let c=e.valueCallback?e.valueCallback(l[0]):l[0];c=t.valueCallback?t.valueCallback(c):c;const d=r.slice(a.length);return{value:c,rest:d}}}const uP=/^(\d+)(th|st|nd|rd)?/i,dP=/\d+/i,fP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},hP={any:[/^b/i,/^(a|c)/i]},mP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},pP={any:[/1/i,/2/i,/3/i,/4/i]},gP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},vP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},xP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},yP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},_P={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},wP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},kP={ordinalNumber:cP({matchPattern:uP,parsePattern:dP,valueCallback:e=>parseInt(e,10)}),era:yc({matchPatterns:fP,defaultMatchWidth:"wide",parsePatterns:hP,defaultParseWidth:"any"}),quarter:yc({matchPatterns:mP,defaultMatchWidth:"wide",parsePatterns:pP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:yc({matchPatterns:gP,defaultMatchWidth:"wide",parsePatterns:vP,defaultParseWidth:"any"}),day:yc({matchPatterns:xP,defaultMatchWidth:"wide",parsePatterns:yP,defaultParseWidth:"any"}),dayPeriod:yc({matchPatterns:_P,defaultMatchWidth:"any",parsePatterns:wP,defaultParseWidth:"any"})},bP={code:"en-US",formatDistance:GA,formatLong:YA,formatRelative:JA,localize:sP,match:kP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function SP(e){const r=Lr(e);return BA(r,WA(r))+1}function TP(e){const r=Lr(e),t=+Jd(r)-+zA(r);return Math.round(t/U1)+1}function V1(e,r){const t=Lr(e),n=t.getFullYear(),a=of(),l=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,c=Ss(e,0);c.setFullYear(n+1,0,l),c.setHours(0,0,0,0);const d=Sl(c,r),m=Ss(e,0);m.setFullYear(n,0,l),m.setHours(0,0,0,0);const g=Sl(m,r);return t.getTime()>=d.getTime()?n+1:t.getTime()>=g.getTime()?n:n-1}function EP(e,r){const t=of(),n=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,a=V1(e,r),l=Ss(e,0);return l.setFullYear(a,0,n),l.setHours(0,0,0,0),Sl(l,r)}function CP(e,r){const t=Lr(e),n=+Sl(t,r)-+EP(t,r);return Math.round(n/U1)+1}function Ut(e,r){const t=e<0?"-":"",n=Math.abs(e).toString().padStart(r,"0");return t+n}const ds={y(e,r){const t=e.getFullYear(),n=t>0?t:1-t;return Ut(r==="yy"?n%100:n,r.length)},M(e,r){const t=e.getMonth();return r==="M"?String(t+1):Ut(t+1,2)},d(e,r){return Ut(e.getDate(),r.length)},a(e,r){const t=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(e,r){return Ut(e.getHours()%12||12,r.length)},H(e,r){return Ut(e.getHours(),r.length)},m(e,r){return Ut(e.getMinutes(),r.length)},s(e,r){return Ut(e.getSeconds(),r.length)},S(e,r){const t=r.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,t-3));return Ut(a,r.length)}},nl={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},mv={G:function(e,r,t){const n=e.getFullYear()>0?1:0;switch(r){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(e,r,t){if(r==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return t.ordinalNumber(a,{unit:"year"})}return ds.y(e,r)},Y:function(e,r,t,n){const a=V1(e,n),l=a>0?a:1-a;if(r==="YY"){const c=l%100;return Ut(c,2)}return r==="Yo"?t.ordinalNumber(l,{unit:"year"}):Ut(l,r.length)},R:function(e,r){const t=H1(e);return Ut(t,r.length)},u:function(e,r){const t=e.getFullYear();return Ut(t,r.length)},Q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"Q":return String(n);case"QQ":return Ut(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,r,t){const n=Math.ceil((e.getMonth()+1)/3);switch(r){case"q":return String(n);case"qq":return Ut(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,r,t){const n=e.getMonth();switch(r){case"M":case"MM":return ds.M(e,r);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(e,r,t){const n=e.getMonth();switch(r){case"L":return String(n+1);case"LL":return Ut(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(e,r,t,n){const a=CP(e,n);return r==="wo"?t.ordinalNumber(a,{unit:"week"}):Ut(a,r.length)},I:function(e,r,t){const n=TP(e);return r==="Io"?t.ordinalNumber(n,{unit:"week"}):Ut(n,r.length)},d:function(e,r,t){return r==="do"?t.ordinalNumber(e.getDate(),{unit:"date"}):ds.d(e,r)},D:function(e,r,t){const n=SP(e);return r==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):Ut(n,r.length)},E:function(e,r,t){const n=e.getDay();switch(r){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(e,r,t,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(r){case"e":return String(l);case"ee":return Ut(l,2);case"eo":return t.ordinalNumber(l,{unit:"day"});case"eee":return t.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(a,{width:"short",context:"formatting"});case"eeee":default:return t.day(a,{width:"wide",context:"formatting"})}},c:function(e,r,t,n){const a=e.getDay(),l=(a-n.weekStartsOn+8)%7||7;switch(r){case"c":return String(l);case"cc":return Ut(l,r.length);case"co":return t.ordinalNumber(l,{unit:"day"});case"ccc":return t.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(a,{width:"narrow",context:"standalone"});case"cccccc":return t.day(a,{width:"short",context:"standalone"});case"cccc":default:return t.day(a,{width:"wide",context:"standalone"})}},i:function(e,r,t){const n=e.getDay(),a=n===0?7:n;switch(r){case"i":return String(a);case"ii":return Ut(a,r.length);case"io":return t.ordinalNumber(a,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(e,r,t){const a=e.getHours()/12>=1?"pm":"am";switch(r){case"a":case"aa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,r,t){const n=e.getHours();let a;switch(n===12?a=nl.noon:n===0?a=nl.midnight:a=n/12>=1?"pm":"am",r){case"b":case"bb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,r,t){const n=e.getHours();let a;switch(n>=17?a=nl.evening:n>=12?a=nl.afternoon:n>=4?a=nl.morning:a=nl.night,r){case"B":case"BB":case"BBB":return t.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,r,t){if(r==="ho"){let n=e.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return ds.h(e,r)},H:function(e,r,t){return r==="Ho"?t.ordinalNumber(e.getHours(),{unit:"hour"}):ds.H(e,r)},K:function(e,r,t){const n=e.getHours()%12;return r==="Ko"?t.ordinalNumber(n,{unit:"hour"}):Ut(n,r.length)},k:function(e,r,t){let n=e.getHours();return n===0&&(n=24),r==="ko"?t.ordinalNumber(n,{unit:"hour"}):Ut(n,r.length)},m:function(e,r,t){return r==="mo"?t.ordinalNumber(e.getMinutes(),{unit:"minute"}):ds.m(e,r)},s:function(e,r,t){return r==="so"?t.ordinalNumber(e.getSeconds(),{unit:"second"}):ds.s(e,r)},S:function(e,r){return ds.S(e,r)},X:function(e,r,t){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(r){case"X":return gv(n);case"XXXX":case"XX":return Qs(n);case"XXXXX":case"XXX":default:return Qs(n,":")}},x:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"x":return gv(n);case"xxxx":case"xx":return Qs(n);case"xxxxx":case"xxx":default:return Qs(n,":")}},O:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"O":case"OO":case"OOO":return"GMT"+pv(n,":");case"OOOO":default:return"GMT"+Qs(n,":")}},z:function(e,r,t){const n=e.getTimezoneOffset();switch(r){case"z":case"zz":case"zzz":return"GMT"+pv(n,":");case"zzzz":default:return"GMT"+Qs(n,":")}},t:function(e,r,t){const n=Math.trunc(e.getTime()/1e3);return Ut(n,r.length)},T:function(e,r,t){const n=e.getTime();return Ut(n,r.length)}};function pv(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),l=n%60;return l===0?t+String(a):t+String(a)+r+Ut(l,2)}function gv(e,r){return e%60===0?(e>0?"-":"+")+Ut(Math.abs(e)/60,2):Qs(e,r)}function Qs(e,r=""){const t=e>0?"-":"+",n=Math.abs(e),a=Ut(Math.trunc(n/60),2),l=Ut(n%60,2);return t+a+r+l}const vv=(e,r)=>{switch(e){case"P":return r.date({width:"short"});case"PP":return r.date({width:"medium"});case"PPP":return r.date({width:"long"});case"PPPP":default:return r.date({width:"full"})}},G1=(e,r)=>{switch(e){case"p":return r.time({width:"short"});case"pp":return r.time({width:"medium"});case"ppp":return r.time({width:"long"});case"pppp":default:return r.time({width:"full"})}},AP=(e,r)=>{const t=e.match(/(P+)(p+)?/)||[],n=t[1],a=t[2];if(!a)return vv(e,r);let l;switch(n){case"P":l=r.dateTime({width:"short"});break;case"PP":l=r.dateTime({width:"medium"});break;case"PPP":l=r.dateTime({width:"long"});break;case"PPPP":default:l=r.dateTime({width:"full"});break}return l.replace("{{date}}",vv(n,r)).replace("{{time}}",G1(a,r))},PP={p:G1,P:AP},NP=/^D+$/,DP=/^Y+$/,OP=["D","DD","YY","YYYY"];function IP(e){return NP.test(e)}function FP(e){return DP.test(e)}function LP(e,r,t){const n=RP(e,r,t);if(console.warn(n),OP.includes(e))throw new RangeError(n)}function RP(e,r,t){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${r}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const jP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,MP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,BP=/^'([^]*?)'?$/,zP=/''/g,UP=/[a-zA-Z]/;function xv(e,r,t){const n=of(),a=n.locale??bP,l=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,c=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,d=Lr(e);if(!$A(d))throw new RangeError("Invalid time value");let m=r.match(MP).map(x=>{const _=x[0];if(_==="p"||_==="P"){const y=PP[_];return y(x,a.formatLong)}return x}).join("").match(jP).map(x=>{if(x==="''")return{isToken:!1,value:"'"};const _=x[0];if(_==="'")return{isToken:!1,value:$P(x)};if(mv[_])return{isToken:!0,value:x};if(_.match(UP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+_+"`");return{isToken:!1,value:x}});a.localize.preprocessor&&(m=a.localize.preprocessor(d,m));const g={firstWeekContainsDate:l,weekStartsOn:c,locale:a};return m.map(x=>{if(!x.isToken)return x.value;const _=x.value;(FP(_)||IP(_))&&LP(_,r,String(e));const y=mv[_[0]];return y(d,_,a.localize,g)}).join("")}function $P(e){const r=e.match(BP);return r?r[1].replace(zP,"'"):e}function WP(e,r){const t=Lr(e),n=Lr(r);return t.getTime()>n.getTime()}function HP(e){return+Lr(e)<Date.now()}function VP(e,r){const t=+Lr(e),[n,a]=[+Lr(r.start),+Lr(r.end)].sort((l,c)=>l-c);return t>=n&&t<=a}function GP(e,r){return z1(e,-r)}function Xa(e,r){const n=YP(e);let a;if(n.date){const m=XP(n.date,2);a=JP(m.restDateString,m.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const l=a.getTime();let c=0,d;if(n.time&&(c=QP(n.time),isNaN(c)))return new Date(NaN);if(n.timezone){if(d=eN(n.timezone),isNaN(d))return new Date(NaN)}else{const m=new Date(l+c),g=new Date(0);return g.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),g.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),g}return new Date(l+c+d)}const bd={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},ZP=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,KP=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,qP=/^([+-])(\d{2})(?::?(\d{2}))?$/;function YP(e){const r={},t=e.split(bd.dateTimeDelimiter);let n;if(t.length>2)return r;if(/:/.test(t[0])?n=t[0]:(r.date=t[0],n=t[1],bd.timeZoneDelimiter.test(r.date)&&(r.date=e.split(bd.timeZoneDelimiter)[0],n=e.substr(r.date.length,e.length))),n){const a=bd.timezone.exec(n);a?(r.time=n.replace(a[1],""),r.timezone=a[1]):r.time=n}return r}function XP(e,r){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+r)+"})|(\\d{2}|[+-]\\d{"+(2+r)+"})$)"),n=e.match(t);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,l=n[2]?parseInt(n[2]):null;return{year:l===null?a:l*100,restDateString:e.slice((n[1]||n[2]).length)}}function JP(e,r){if(r===null)return new Date(NaN);const t=e.match(ZP);if(!t)return new Date(NaN);const n=!!t[4],a=_c(t[1]),l=_c(t[2])-1,c=_c(t[3]),d=_c(t[4]),m=_c(t[5])-1;if(n)return iN(r,d,m)?tN(r,d,m):new Date(NaN);{const g=new Date(0);return!nN(r,l,c)||!aN(r,a)?new Date(NaN):(g.setUTCFullYear(r,l,Math.max(a,c)),g)}}function _c(e){return e?parseInt(e):1}function QP(e){const r=e.match(KP);if(!r)return NaN;const t=qh(r[1]),n=qh(r[2]),a=qh(r[3]);return sN(t,n,a)?t*W1+n*$1+a*1e3:NaN}function qh(e){return e&&parseFloat(e.replace(",","."))||0}function eN(e){if(e==="Z")return 0;const r=e.match(qP);if(!r)return 0;const t=r[1]==="+"?-1:1,n=parseInt(r[2]),a=r[3]&&parseInt(r[3])||0;return oN(n,a)?t*(n*W1+a*$1):NaN}function tN(e,r,t){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,l=(r-1)*7+t+1-a;return n.setUTCDate(n.getUTCDate()+l),n}const rN=[31,null,31,30,31,30,31,31,30,31,30,31];function Z1(e){return e%400===0||e%4===0&&e%100!==0}function nN(e,r,t){return r>=0&&r<=11&&t>=1&&t<=(rN[r]||(Z1(e)?29:28))}function aN(e,r){return r>=1&&r<=(Z1(e)?366:365)}function iN(e,r,t){return r>=1&&r<=53&&t>=0&&t<=6}function sN(e,r,t){return e===24?r===0&&t===0:t>=0&&t<60&&r>=0&&r<60&&e>=0&&e<25}function oN(e,r){return r>=0&&r<=59}const lN={name:"[Agent Name]",title:"Enforcement Agent",signature:"Enforcement Agent [Agent Name]",contactInfo:void 0},K1=[{id:"professional_standard",name:"Professional Standard",template:`{greeting}PAYMENT REMINDER

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: {amount}

Payment must be made as agreed. Failure to comply may result in further enforcement action.

Contact immediately if unable to pay as arranged.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"friendly_reminder",name:"Friendly Reminder",template:`{greeting}Payment Reminder

{refLine}This is a friendly reminder that your payment arrangement is due {date}{time}.

Amount: {amount}

Please ensure payment is made as agreed. If you need to discuss this arrangement, please contact us immediately.

Thank you,
{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"urgent_notice",name:"Urgent Notice",template:`{greeting}URGENT: PAYMENT DUE

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: {amount}

IMPORTANT: Payment must be made TODAY as agreed. Failure to comply will result in immediate further enforcement action.

Contact us NOW if unable to pay.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"payment_plan_reminder",name:"Payment Plan Reminder",template:`{greeting}Payment Plan Reminder

{refLine}Your next payment is due {date}{time}.

Payment Amount: {amount}

This is part of your agreed payment plan. Please ensure this payment is made on time to keep your arrangement active.

If you have any questions about your payment plan, please contact us.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"custom",name:"Custom Template",template:`{greeting}Payment Reminder

{refLine}Your payment is due {date}{time}.

Amount: {amount}

[Customize this message]

{signature}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]}],cN={daysBeforePayment:[3,1,0],enabled:!0,autoSend:!1},Nl={defaultSchedule:cN,globalEnabled:!0,smsEnabled:!0,agentProfile:lN,messageTemplates:K1,activeTemplateId:"professional_standard",customizableSchedule:{threeDayReminder:!0,oneDayReminder:!0,dayOfReminder:!0,customDays:[]}};function uN(e,r=Nl){const t=e.reminderSchedule||r.defaultSchedule;if(!t.enabled||!r.globalEnabled)return[];const n=Xa(e.scheduledDate);let a=[];return t.daysBeforePayment&&t.daysBeforePayment.length>0?a=[...t.daysBeforePayment]:(r.customizableSchedule.threeDayReminder&&a.push(3),r.customizableSchedule.oneDayReminder&&a.push(1),r.customizableSchedule.dayOfReminder&&a.push(0),a.push(...r.customizableSchedule.customDays)),[...new Set(a)].sort((c,d)=>d-c).map(c=>GP(n,c).toISOString())}function dN(e,r=Nl){const t=uN(e,r),n=new Date().toISOString();return t.map((a,l)=>({id:`${e.id}_reminder_${l}`,arrangementId:e.id,type:fN(e,a),scheduledDate:a,status:"pending",createdAt:n,updatedAt:n}))}function fN(e,r){const t=oo(Xa(e.scheduledDate)),n=oo(Xa(r)),a=oo(new Date);return n.getTime()===t.getTime()?"payment_due":WP(a,t)?"overdue":"custom"}function hN(e){const r=e.reminderSettings||Nl;if(!r.globalEnabled)return e.reminderNotifications||[];const t=e.reminderNotifications||[],n=[];return e.arrangements.filter(a=>a.status!=="Completed"&&a.status!=="Cancelled").forEach(a=>{if(!t.some(c=>c.arrangementId===a.id)){const c=dN(a,r);n.push(...c)}}),[...t,...n]}function mN(e,r,t,n){return e.map(a=>a.id===r?{...a,status:t,message:n||a.message,updatedAt:new Date().toISOString()}:a)}function pN(e,r){const t=new Set(r.filter(n=>n.status!=="Completed"&&n.status!=="Cancelled").map(n=>n.id));return e.filter(n=>t.has(n.arrangementId))}function q1(e,r,t=Nl){const n=t.messageTemplates.find(b=>b.id===t.activeTemplateId)||t.messageTemplates[0],a=e.customerName||"",l=e.amount||"the arranged amount",c=Xa(e.scheduledDate);let d="",m="";if(a){const b=a.trim().split(/\s+/);b.length>=2?(m=b[0],d=`Mr/Mrs ${b.slice(1).join(" ")}, `):d=`${a}, `}const g=m?`Reference: ${m}

`:"",x=e.scheduledTime?` at ${e.scheduledTime}`:"",_=c.toLocaleDateString("en-GB");let y=n.template;const S=t.agentProfile.contactInfo?`
${t.agentProfile.contactInfo}`:"",C={greeting:d,refLine:g,date:_,time:x,amount:l,signature:t.agentProfile.signature,customerName:a,referenceNumber:m||"",agentName:t.agentProfile.name,agentTitle:t.agentProfile.title,contactInfo:S};return Object.entries(C).forEach(([b,E])=>{const D=new RegExp(`\\{${b}\\}`,"g");y=y.replace(D,E)}),y}const Sd="navigator_state_v5",al=5,Td={addresses:[],activeIndex:null,completions:[],daySessions:[],arrangements:[],currentListVersion:1,subscription:null,reminderSettings:Nl,reminderNotifications:[],lastReminderProcessed:void 0};function gN(e){try{if(typeof structuredClone<"u")return structuredClone(e);const r=JSON.stringify(e),t=JSON.parse(r);if(typeof e=="object"&&e!==null&&"addresses"in e){const n=e,a=t;Array.isArray(n.addresses)&&!Array.isArray(a.addresses)&&(Ne.error("Deep copy corrupted addresses array, falling back to original"),a.addresses=n.addresses),Array.isArray(n.completions)&&!Array.isArray(a.completions)&&(Ne.error("Deep copy corrupted completions array, falling back to original"),a.completions=n.completions)}return t}catch(r){return Ne.error("Deep copy failed, returning original object:",r),e}}function vN(e){return e&&typeof e.index=="number"&&typeof e.address=="string"&&typeof e.outcome=="string"&&["PIF","DA","Done","ARR"].includes(e.outcome)&&typeof e.timestamp=="string"&&!isNaN(new Date(e.timestamp).getTime())}function Yh(e){return e&&typeof e.address=="string"&&e.address.trim().length>0}function xN(e){return e&&Array.isArray(e.addresses)&&Array.isArray(e.completions)&&Array.isArray(e.daySessions)&&Array.isArray(e.arrangements)&&(e.activeIndex===null||typeof e.activeIndex=="number")&&typeof e.currentListVersion=="number"}function yv(e,r){return(Array.isArray(e)?e:[]).filter(vN).map(n=>({...n,listVersion:typeof n?.listVersion=="number"?n.listVersion:r}))}function fs(e,r,t){const n=`${e}_${r}_${JSON.stringify(t).slice(0,50)}_${Date.now()}`,a=encodeURIComponent(n);return btoa(a).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}function Y1(e,r){const t={...e,end:r.toISOString()},n=Date.parse(e.start),a=r.getTime();if(!Number.isNaN(n)&&!Number.isNaN(a)){const l=a-n;t.durationSeconds=l>=0?Math.floor(l/1e3):void 0}else t.durationSeconds=void 0;return t}function yN(e,r){const t=r.getTime(),n=Date.parse(e.start);let a=Date.parse(`${e.date}T23:59:59.999Z`);return Number.isNaN(a)&&(a=t),!Number.isNaN(n)&&a<n&&(a=n),a>t&&(a=t),Number.isNaN(a)&&(a=Number.isNaN(n)?t:n),Y1(e,new Date(a))}function _N(e,r,t){const n=[],a=[];for(const l of e)if(!l.end&&l.date<r){const c=yN(l,t);n.push(c),a.push(c)}else n.push(l);return{sanitizedSessions:n,closedSessions:a}}function wN(e,r){for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(n.date===r&&!n.end)return t}return-1}function kN(e,r,t){const{sanitizedSessions:n,closedSessions:a}=_N(e,r,t),l=wN(n,r);if(l===-1)return{updatedSessions:n,closedSessions:a};const c=n.slice(),d=Y1(c[l],t);return c[l]=d,{updatedSessions:c,closedSessions:a,endedSession:d}}const _v="navigator_device_id";function bN(){try{const e=localStorage.getItem(_v);if(e)return e;const r=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():"dev_"+Math.random().toString(36).slice(2);return localStorage.setItem(_v,r),r}catch{return"dev_"+Math.random().toString(36).slice(2)}}function SN(e,r){if(r.size===0)return e;try{let t=gN(e);if(!t.addresses||!Array.isArray(t.addresses))return Ne.error("State copy failed - addresses corrupted, using base state"),e;const n=Array.from(r.values()).sort((c,d)=>new Date(c.timestamp).getTime()-new Date(d.timestamp).getTime());let a=!1,l=!1;for(const c of n)if(c.type!=="reverted")try{switch(c.entity){case"completion":if(l=!0,c.operation==="create"){if(!c.data||typeof c.data.index!="number"||!c.data.outcome){Ne.warn("Invalid completion data in optimistic update:",c.data);continue}t.completions.some(m=>m.index===c.data.index&&m.outcome===c.data.outcome&&Math.abs(new Date(m.timestamp).getTime()-new Date(c.data.timestamp).getTime())<1e3)||(t.completions=[c.data,...t.completions])}else c.operation==="update"?t.completions=t.completions.map(d=>d.timestamp===c.data.originalTimestamp?{...d,...c.data}:d):c.operation==="delete"&&(t.completions=t.completions.filter(d=>d.timestamp!==c.data.timestamp));break;case"arrangement":c.operation==="create"?t.arrangements=[...t.arrangements,c.data]:c.operation==="update"?t.arrangements=t.arrangements.map(d=>d.id===c.data.id?{...d,...c.data,updatedAt:c.timestamp}:d):c.operation==="delete"&&(t.arrangements=t.arrangements.filter(d=>d.id!==c.data.id));break;case"address":if(a=!0,c.operation==="create")t.addresses=[...t.addresses,c.data];else if(c.operation==="update"&&c.data?.addresses&&(t.addresses=Array.isArray(c.data.addresses)?c.data.addresses:t.addresses,c.data.bumpVersion)){const d=typeof t.currentListVersion=="number"?t.currentListVersion:1;t.currentListVersion=d+1,c.data.preserveCompletions||(t.completions=[]),t.activeIndex=null}break;case"session":c.operation==="create"?c.data&&c.data.date&&c.data.start?t.daySessions=[...t.daySessions,c.data]:Ne.warn("Invalid session data in optimistic update:",c.data):c.operation==="update"&&(t.daySessions=t.daySessions.map(d=>d.date===c.data.date?{...d,...c.data}:d));break;default:Ne.warn(`Unknown entity type in optimistic update: ${c.entity}`,c);break}}catch(d){Ne.error(`Failed to apply optimistic update for ${c.entity}:`,d)}return a&&(!t.addresses||!Array.isArray(t.addresses))?(Ne.error("Optimistic updates corrupted addresses, reverting to base state"),e):l&&(!t.completions||!Array.isArray(t.completions))?(Ne.error("Optimistic updates corrupted completions, reverting to base state"),e):t}catch(t){return Ne.error("Failed to apply optimistic updates, returning base state:",t),e}}function TN(){const[e,r]=J.useState(Td),[t,n]=J.useState({updates:new Map,pendingOperations:new Set}),[a,l]=J.useState(!0),c=J.useMemo(()=>bN(),[]),d=J.useMemo(()=>SN(e,t.updates),[e,t.updates]),[m,g]=J.useState(new Map);J.useEffect(()=>{let R=!0;return(async()=>{try{const P=await kd.queuedGet(Sd);if(!R)return;if(P){if(!xN(P)){Ne.warn("Loaded data failed validation, using initial state"),r({...Td,_schemaVersion:al});return}const W=typeof P.currentListVersion=="number"?P.currentListVersion:1,U={addresses:P.addresses.filter(Yh),activeIndex:typeof P.activeIndex=="number"?P.activeIndex:null,completions:yv(P.completions,W),daySessions:Array.isArray(P.daySessions)?P.daySessions:[],arrangements:Array.isArray(P.arrangements)?P.arrangements:[],currentListVersion:W,subscription:P.subscription||null,_schemaVersion:al};r(U)}else r({...Td,_schemaVersion:al})}catch(P){Ne.error("Failed to load state from IndexedDB:",P),r({...Td,_schemaVersion:al})}finally{R&&l(!1)}})(),()=>{R=!1}},[]),J.useEffect(()=>{if(a)return;const R=setTimeout(async()=>{try{const P={...e,_schemaVersion:al};await kd.queuedSet(Sd,P)}catch(P){Ne.error("Failed to persist state to IndexedDB:",P)}},150);return()=>clearTimeout(R)},[e,a]);const x=J.useCallback((R,P,W,U)=>{const H=U||fs(R,P,W),le=new Date().toISOString(),ge={id:H,timestamp:le,type:"optimistic",operation:R,entity:P,data:W};return n(Ce=>{const ke=new Map(Ce.updates);return ke.set(H,ge),{updates:ke,pendingOperations:new Set([...Ce.pendingOperations,H])}}),H},[]),_=J.useCallback((R,P)=>{n(W=>{const U=new Map(W.updates),H=new Set(W.pendingOperations),le=U.get(R);return le&&U.set(R,{...le,type:"confirmed",data:P||le.data}),H.delete(R),{updates:U,pendingOperations:H}}),setTimeout(()=>{n(W=>{const U=new Map(W.updates);return U.delete(R),{...W,updates:U}})},5e3)},[]),y=J.useCallback((R,P)=>{Ne.debug(`Reverting optimistic update ${R}:`,P),n(W=>{const U=new Map(W.updates),H=new Set(W.pendingOperations),le=U.get(R);return le&&U.set(R,{...le,type:"reverted"}),H.delete(R),{updates:U,pendingOperations:H}}),setTimeout(()=>{n(W=>{const U=new Map(W.updates);return U.delete(R),{...W,updates:U}})},1e3)},[]),S=J.useCallback(()=>{n({updates:new Map,pendingOperations:new Set})},[]),C=J.useCallback((R,P=!0)=>{const W=fs("update","address",{type:"bulk_import",count:R.length,preserve:P}),U=Array.isArray(R)?R.filter(Yh):[];if(U.length===0){Ne.warn("No valid addresses to import");return}x("update","address",{addresses:U,bumpVersion:!0,preserveCompletions:P},W),r(H=>({...H,addresses:U,activeIndex:null,currentListVersion:(typeof H.currentListVersion=="number"?H.currentListVersion:1)+1,completions:P?H.completions:[]})),_(W)},[x,_]),b=J.useCallback(R=>new Promise(P=>{if(!Yh(R)){P(-1);return}const W=fs("create","address",R);x("create","address",R,W),r(U=>{const H=[...U.addresses,R],le=H.length-1;return _(W),P(le),{...U,addresses:H}})}),[x,_]),E=J.useCallback(R=>{r(P=>{const W=P.addresses[R];return W&&P.completions.some(H=>H.address===W.address&&(H.listVersion||P.currentListVersion)===P.currentListVersion)?(Ne.warn(`Cannot set active - address "${W.address}" is already completed`),dv(`Address "${W.address}" is already completed on another device`),P):(Ne.info(` SETTING ACTIVE: Address #${R} "${W?.address}" - will auto-sync to all devices`),{...P,activeIndex:R})})},[]),D=J.useCallback(()=>{r(R=>(Ne.info(" CANCELING ACTIVE: Clearing active state - will auto-sync to all devices"),{...R,activeIndex:null}))},[]),[,F]=J.useState(new Set),O=J.useRef(new Set),M=J.useRef(new Map),G=J.useCallback(async(R,P,W,U)=>{if(O.current.has(R))throw new Error(`Completion already pending for index ${R}`);const H=e,le=H.addresses[R];if(!le)throw new Error(`Address at index ${R} not found`);const ge=H.completions.find(Ke=>Ke.address===le.address&&Ke.listVersion===H.currentListVersion);if(ge){const Ke=new Date(ge.timestamp).getTime(),Tt=Date.now()-Ke;if(Tt<3e4)return dv(`Address "${le.address}" was already completed ${Math.round(Tt/1e3)} seconds ago`),Promise.reject();console.log(` RE-COMPLETING: Address "${le.address}" was previously completed ${new Date(ge.timestamp).toLocaleString()}, allowing new completion`)}const Ce=new Date().toISOString(),ke={index:R,address:le.address,lat:le.lat??null,lng:le.lng??null,outcome:P,amount:W,timestamp:Ce,listVersion:H.currentListVersion,arrangementId:U},xe=fs("create","completion",ke);try{O.current.add(R),F(new Set(O.current));const Ke=`${R}_${P}_${H.currentListVersion}`;return M.current.set(Ke,{timestamp:Date.now(),completion:ke}),x("create","completion",ke,xe),r(te=>({...te,completions:[ke,...te.completions],activeIndex:te.activeIndex===R?null:te.activeIndex})),xe}finally{O.current.delete(R),F(new Set(O.current))}},[e,x]),I=J.useCallback(R=>{r(P=>{const W=P.completions.slice();let U=-1,H=0;for(let le=0;le<W.length;le++){const ge=W[le];if(Number(ge.index)===Number(R)&&ge.listVersion===P.currentListVersion){const Ce=new Date(ge.timestamp).getTime();Ce>H&&(H=Ce,U=le)}}if(U>=0){const le=W[U],ge=fs("delete","completion",le);x("delete","completion",le,ge),W.splice(U,1),setTimeout(()=>_(ge),0)}return{...P,completions:W}})},[x,_]),N=J.useCallback(()=>{const R=new Date,P=R.toISOString().slice(0,10);r(W=>{if(W.daySessions.find(ge=>ge.date===P&&!ge.end))return Ne.info("Day already active for today, skipping start"),W;const H=W.daySessions.map(ge=>ge.date<P&&!ge.end?(Ne.info("Auto-closing stale session from previous day:",ge),{...ge,end:new Date(ge.date+"T23:59:59.999Z").toISOString(),durationSeconds:Math.floor((new Date(ge.date+"T23:59:59.999Z").getTime()-new Date(ge.start).getTime())/1e3)}):ge),le={date:P,start:R.toISOString()};return Ne.info("Starting new day session:",le),{...W,daySessions:[...H,le]}})},[]),q=J.useCallback(()=>{const R=new Date,P=R.toISOString().slice(0,10);r(W=>{const{updatedSessions:U,closedSessions:H,endedSession:le}=kN(W.daySessions,P,R);return H.forEach(ge=>Ne.info("Auto-closing stale day session before ending today",ge)),le?(Ne.info("Ending day session:",le),{...W,daySessions:U}):(Ne.info("No active session to end for today"),H.length>0?{...W,daySessions:U}:W)})},[]),Z=J.useCallback(R=>new Promise(P=>{const W=new Date().toISOString(),U=`arr_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,H={...R,id:U,createdAt:W,updatedAt:W},le=fs("create","arrangement",H);x("create","arrangement",H,le),r(ge=>(setTimeout(()=>{_(le),P(U)},0),{...ge,arrangements:[...ge.arrangements,H]}))}),[x,_]),me=J.useCallback((R,P)=>new Promise(W=>{const U=fs("update","arrangement",{id:R,...P});r(H=>{const le={...P,id:R,updatedAt:new Date().toISOString()};x("update","arrangement",le,U);const ge=H.arrangements.map(Ce=>Ce.id===R?{...Ce,...P,updatedAt:new Date().toISOString()}:Ce);return setTimeout(()=>{_(U),W()},0),{...H,arrangements:ge}})}),[x,_]),ue=J.useCallback(R=>new Promise(P=>{r(W=>{const U=W.arrangements.find(ge=>ge.id===R);if(!U)return P(),W;const H=fs("delete","arrangement",U);x("delete","arrangement",{id:R},H);const le=W.arrangements.filter(ge=>ge.id!==R);return setTimeout(()=>{_(H),P()},0),{...W,arrangements:le}})}),[x,_]),Y=J.useCallback(R=>{r(P=>({...P,subscription:R}))},[]),se=J.useCallback(R=>{r(P=>({...P,reminderSettings:R}))},[]),ve=J.useCallback((R,P,W)=>{r(U=>({...U,reminderNotifications:mN(U.reminderNotifications||[],R,P,W)}))},[]),ee=J.useCallback(()=>{r(R=>{const P=hN(R),W=pN(P,R.arrangements);return{...R,reminderNotifications:W,lastReminderProcessed:new Date().toISOString()}})},[]);J.useEffect(()=>{const R=setInterval(()=>{a||ee()},6e4);return()=>clearInterval(R)},[a,ee]);function ce(R){return R&&typeof R=="object"&&Array.isArray(R.addresses)&&Array.isArray(R.completions)&&"activeIndex"in R&&Array.isArray(R.daySessions)}const V=J.useCallback(()=>({addresses:e.addresses,completions:e.completions,activeIndex:e.activeIndex,daySessions:e.daySessions,arrangements:e.arrangements,currentListVersion:e.currentListVersion}),[e]),ie=J.useCallback(async(R,P="replace")=>{if(!ce(R))throw console.error(" RESTORE VALIDATION FAILED:",{hasObj:!!R,type:typeof R,hasAddresses:R&&Array.isArray(R.addresses),hasCompletions:R&&Array.isArray(R.completions),hasActiveIndex:R&&"activeIndex"in R,hasDaySessions:R&&Array.isArray(R.daySessions),objKeys:R?Object.keys(R):null}),new Error("Invalid backup file format");const W=typeof R.currentListVersion=="number"?R.currentListVersion:1,U=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),H="ontouchstart"in window||navigator.maxTouchPoints>0;console.log(" RESTORE DATA ANALYSIS:",{addressCount:R.addresses.length,completionCount:R.completions.length,arrangementCount:R.arrangements?.length||0,daySessionCount:R.daySessions?.length||0,activeIndex:R.activeIndex,listVersion:W,mergeStrategy:P,isMobile:U,isTouch:H,userAgent:navigator.userAgent.substring(0,50)});const le={addresses:R.addresses,completions:yv(R.completions,W),activeIndex:R.activeIndex??null,daySessions:R.daySessions??[],arrangements:R.arrangements??[],currentListVersion:W};console.log(" RESTORED STATE PREPARED:",{addressCount:le.addresses.length,completionCount:le.completions.length,arrangementCount:le.arrangements.length,daySessionCount:le.daySessions.length,activeIndex:le.activeIndex,listVersion:le.currentListVersion}),r(P==="merge"?ge=>({addresses:le.currentListVersion>=ge.currentListVersion?le.addresses:ge.addresses,currentListVersion:Math.max(le.currentListVersion,ge.currentListVersion),completions:[...ge.completions,...le.completions.filter(ke=>!ge.completions.some(xe=>xe.timestamp===ke.timestamp&&xe.index===ke.index&&xe.outcome===ke.outcome))].sort((ke,xe)=>new Date(xe.timestamp).getTime()-new Date(ke.timestamp).getTime()),arrangements:Array.from(new Map([...ge.arrangements.map(ke=>[ke.id,ke]),...le.arrangements.map(ke=>[ke.id,ke])].sort(([,ke],[,xe])=>new Date(xe.updatedAt).getTime()-new Date(ke.updatedAt).getTime())).values()),daySessions:Array.from(new Map([...ge.daySessions.map(ke=>[ke.date,ke]),...le.daySessions.map(ke=>[ke.date,ke])]).values()),activeIndex:le.activeIndex??ge.activeIndex}):le),S();try{const ge={...le,_schemaVersion:al};if(console.log(" PERSISTING RESTORED STATE:",{addressCount:ge.addresses.length,completionCount:ge.completions.length,arrangementCount:ge.arrangements.length,daySessionCount:ge.daySessions.length,activeIndex:ge.activeIndex,listVersion:ge.currentListVersion,schemaVersion:ge._schemaVersion}),"storage"in navigator&&"persist"in navigator.storage)try{const xe=await navigator.storage.persist();console.log(" PERSISTENT STORAGE:",xe?"GRANTED":"DENIED")}catch(xe){console.warn(" PERSISTENT STORAGE REQUEST FAILED:",xe)}if(await kd.queuedSet(Sd,ge),console.log(" RESTORED STATE PERSISTED TO INDEXEDDB"),"storage"in navigator&&"estimate"in navigator.storage)try{const xe=await navigator.storage.estimate(),Ke=xe.usage&&xe.quota?Math.round(xe.usage/xe.quota*100):"unknown";console.log(" STORAGE QUOTA:",{used:xe.usage?`${Math.round(xe.usage/1024/1024)}MB`:"unknown",total:xe.quota?`${Math.round(xe.quota/1024/1024)}MB`:"unknown",percentUsed:`${Ke}%`})}catch(xe){console.warn(" STORAGE QUOTA CHECK FAILED:",xe)}const Ce=await kd.queuedGet(Sd);console.log(" VERIFICATION READ FROM INDEXEDDB:",{success:!!Ce,addressCount:Ce?.addresses?.length||0,completionCount:Ce?.completions?.length||0,arrangementCount:Ce?.arrangements?.length||0});const ke=Date.now();localStorage.setItem("navigator_restore_in_progress",ke.toString()),console.log(" RESTORE PROTECTION ACTIVATED:",new Date(ke).toISOString()),localStorage.setItem("navigator_last_restore",ke.toString())}catch(ge){throw Ne.error("Failed to persist restored state:",ge),new Error("Restore failed: Could not save data")}},[S]),Q=J.useCallback(R=>{const P=localStorage.getItem("navigator_last_restore");if(P){const W=Date.now()-parseInt(P);W<36e5&&console.log(" STATE CHANGE AFTER RESTORE:",{timeSinceRestore:`${Math.round(W/1e3)}s`,newStateType:typeof R,isFunction:typeof R=="function",timestamp:new Date().toISOString()})}r(W=>{const U=typeof R=="function"?R(W):R,H=[...U.completions];let le=!1;const ge=Date.now()-3e4;for(const[xe,Ke]of M.current.entries())Ke.timestamp<ge&&M.current.delete(xe);for(const[xe,Ke]of M.current.entries()){const{completion:te,timestamp:Tt}=Ke;Date.now()-Tt<3e4&&(H.some(yt=>yt.index===te.index&&yt.outcome===te.outcome&&yt.listVersion===te.listVersion&&Math.abs(new Date(yt.timestamp).getTime()-new Date(te.timestamp).getTime())<1e3)||(Ne.info(` PROTECTING RECENT COMPLETION: index=${te.index}, outcome=${te.outcome}`),H.unshift(te),le=!0))}let Ce=le?{...U,completions:H.sort((xe,Ke)=>new Date(Ke.timestamp).getTime()-new Date(xe.timestamp).getTime())}:U;if(Ce.activeIndex!==null&&typeof Ce.activeIndex=="number"){const xe=Ce.addresses[Ce.activeIndex];xe&&Ce.completions.some(te=>te.address===xe.address&&(te.listVersion||Ce.currentListVersion)===Ce.currentListVersion)&&(Ne.info(` CLEARING ACTIVE INDEX: Address "${xe.address}" was completed on another device`),RA(`Address "${xe.address}" was completed on another device`),Ce={...Ce,activeIndex:null})}const ke=new Map;return Ce.completions.forEach(xe=>{const Ke=W.completions.find(te=>te.index===xe.index&&te.outcome===xe.outcome&&Math.abs(new Date(te.timestamp).getTime()-new Date(xe.timestamp).getTime())<5e3);Ke&&Ke.timestamp!==xe.timestamp&&ke.set(`completion_${xe.timestamp}`,{type:"completion",incoming:xe,existing:Ke,resolution:"prefer_incoming"})}),Ce.arrangements.forEach(xe=>{const Ke=W.arrangements.find(te=>te.id===xe.id);if(Ke&&Ke.updatedAt!==xe.updatedAt){const te=new Date(xe.updatedAt).getTime(),Tt=new Date(Ke.updatedAt).getTime();ke.set(`arrangement_${xe.id}`,{type:"arrangement",incoming:xe,existing:Ke,resolution:te>Tt?"prefer_incoming":"prefer_existing"})}}),ke.size>0&&(Ne.debug("Detected state conflicts:",ke.size),g(ke)),Ce}),S()},[S]),fe=J.useCallback((R,P,W,U)=>x(P,R,W,U),[x]);return{state:d,baseState:e,loading:a,setState:Q,setBaseState:r,deviceId:c,enqueueOp:fe,optimisticUpdates:t.updates,pendingOperations:t.pendingOperations,confirmOptimisticUpdate:_,revertOptimisticUpdate:y,clearOptimisticUpdates:S,conflicts:m,resolveConflict:(R,P)=>{g(W=>{const U=new Map(W);return U.delete(R),U})},setAddresses:C,addAddress:b,setActive:E,cancelActive:D,complete:G,undo:I,startDay:N,endDay:q,addArrangement:Z,updateArrangement:me,deleteArrangement:ue,setSubscription:Y,backupState:V,restoreState:ie,updateReminderSettings:se,updateReminderNotification:ve,processReminders:ee}}function jd(e){const r=e??{},t=typeof r.currentListVersion=="number"?r.currentListVersion:1;return{...r,addresses:Array.isArray(r.addresses)?r.addresses:[],completions:Array.isArray(r.completions)?r.completions:[],arrangements:Array.isArray(r.arrangements)?r.arrangements:[],daySessions:Array.isArray(r.daySessions)?r.daySessions:[],activeIndex:typeof r.activeIndex=="number"?r.activeIndex:null,currentListVersion:t}}function Xh(e){const r=e??{};return{addresses:Array.isArray(r.addresses)?r.addresses:[],completions:Array.isArray(r.completions)?r.completions:[],arrangements:Array.isArray(r.arrangements)?r.arrangements:[],activeIndex:typeof r.activeIndex=="number"?r.activeIndex:null,currentListVersion:typeof r.currentListVersion=="number"?r.currentListVersion:1}}function Tl(e){const r=a=>{if(!a||typeof a!="object"||Array.isArray(a))return!1;const l=Object.getPrototypeOf(a);return l===Object.prototype||l===null},t=JSON.stringify(e,(a,l)=>{if(!l||typeof l!="object")return l;if(l instanceof Date)return l.toISOString();if(typeof l.toJSON=="function"&&!r(l))return l.toJSON(a);if(r(l)){const c={};return Object.keys(l).sort().forEach(d=>{c[d]=l[d]}),c}return l});let n=0;for(let a=0;a<t.length;a++){const l=t.charCodeAt(a);n=(n<<5)-n+l,n=n&n}return n.toString()}class ms{static generateDeviceFingerprint(){try{const r=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.hardwareConcurrency||"unknown"];return`device_${btoa(r.join("|")).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}_${Date.now()}`}catch{return`device_fallback_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}}static analyzeDataOwnership(r,t,n){const a={hasLocalData:this.hasSignificantLocalData(r),hasCloudData:n?this.hasSignificantLocalData(n):!1,localDataAge:this.estimateDataAge(r),userInLocalData:this.findUserSignalsInData(r,t),cloudUserMatch:n?this.findUserSignalsInData(n,t):null};return Ne.info("User detection signals:",a),a.hasCloudData&&a.cloudUserMatch?a.hasLocalData?a.userInLocalData?{isOwner:!0,confidence:"high",reason:"Both local and cloud data belong to user",action:"sync"}:{isOwner:!0,confidence:"medium",reason:"Cloud data belongs to user, local data unclear",action:"preserve_and_ask"}:{isOwner:!0,confidence:"high",reason:"Cloud data exists for user, no local conflict",action:"sync"}:a.hasLocalData&&a.userInLocalData?{isOwner:!0,confidence:"medium",reason:"Local data appears to belong to current user",action:"sync"}:a.hasLocalData&&!a.userInLocalData&&!a.hasCloudData?{isOwner:!1,confidence:"low",reason:"Local data has no user identification",action:"preserve_and_ask"}:{isOwner:!0,confidence:"low",reason:"Unclear ownership - preserving data for safety",action:"preserve_and_ask"}}static hasSignificantLocalData(r){const t=Array.isArray(r.addresses)?r.addresses.length:0,n=Array.isArray(r.completions)?r.completions.length:0,a=Array.isArray(r.arrangements)?r.arrangements.length:0;return t>5||n>0||a>0}static estimateDataAge(r){try{const t=Array.isArray(r.completions)?r.completions:[],n=Array.isArray(r.arrangements)?r.arrangements:[],a=[...t.map(d=>d.timestamp),...n.map(d=>d.updatedAt||d.createdAt)].filter(Boolean);if(a.length===0)return"unknown";const l=Math.max(...a.map(d=>new Date(d).getTime())),c=(Date.now()-l)/(1e3*60*60);return c<24?"recent":(c<168,"old")}catch{return"unknown"}}static findUserSignalsInData(r,t){try{const n=Array.isArray(r.arrangements)?r.arrangements:[],a=t.email?.toLowerCase();return a&&n.some(m=>m.customerName?.toLowerCase().includes(a)||m.notes?.toLowerCase().includes(a))?!0:(Array.isArray(r.completions)?r.completions:[]).filter(d=>(Date.now()-new Date(d.timestamp).getTime())/36e5<24).length>0}catch{return!1}}static storeDeviceContext(r){try{const t={userId:r.id,email:r.email||void 0,deviceId:this.generateDeviceFingerprint(),sessionStart:new Date().toISOString()};localStorage.setItem("navigator_device_context",JSON.stringify(t));const n=Tl(t);localStorage.setItem("navigator_device_context_checksum",n),Ne.info("Device context stored:",{userId:t.userId,deviceId:t.deviceId})}catch(t){Ne.error("Failed to store device context:",t)}}static getDeviceContext(){try{const r=localStorage.getItem("navigator_device_context"),t=localStorage.getItem("navigator_device_context_checksum");if(!r)return null;const n=JSON.parse(r);return t&&Tl(n)!==t?(Ne.warn("Device context checksum mismatch - data may be corrupted"),null):n}catch(r){return Ne.error("Failed to get device context:",r),null}}static clearDeviceContext(){try{localStorage.removeItem("navigator_device_context"),localStorage.removeItem("navigator_device_context_checksum")}catch(r){Ne.error("Failed to clear device context:",r)}}}const EN=Object.freeze(Object.defineProperty({__proto__:null,SmartUserDetection:ms},Symbol.toStringTag,{value:"Module"})),CN="modulepreload",AN=function(e){return"/navigator-web/"+e},wv={},Qa=function(r,t,n){let a=Promise.resolve();if(t&&t.length>0){let g=function(x){return Promise.all(x.map(_=>Promise.resolve(_).then(y=>({status:"fulfilled",value:y}),y=>({status:"rejected",reason:y}))))};var c=g;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),m=d?.nonce||d?.getAttribute("nonce");a=g(t.map(x=>{if(x=AN(x),x in wv)return;wv[x]=!0;const _=x.endsWith(".css"),y=_?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${x}"]${y}`))return;const S=document.createElement("link");if(S.rel=_?"stylesheet":CN,_||(S.as="script"),S.crossOrigin="",S.href=x,m&&S.setAttribute("nonce",m),document.head.appendChild(S),_)return new Promise((C,b)=>{S.addEventListener("load",C),S.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${x}`)))})}))}function l(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return a.then(d=>{for(const m of d||[])m.status==="rejected"&&l(m.reason);return r().catch(l)})},PN=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Qa(async()=>{const{default:n}=await Promise.resolve().then(()=>Dl);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)};class dm extends Error{constructor(r,t="FunctionsError",n){super(r),this.name=t,this.context=n}}class NN extends dm{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class kv extends dm{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class bv extends dm{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var _0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(_0||(_0={}));var DN=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{g(n.next(x))}catch(_){c(_)}}function m(x){try{g(n.throw(x))}catch(_){c(_)}}function g(x){x.done?l(x.value):a(x.value).then(d,m)}g((n=n.apply(e,r||[])).next())})};class ON{constructor(r,{headers:t={},customFetch:n,region:a=_0.Any}={}){this.url=r,this.headers=t,this.region=a,this.fetch=PN(n)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,t={}){var n;return DN(this,void 0,void 0,function*(){try{const{headers:a,method:l,body:c}=t;let d={},{region:m}=t;m||(m=this.region);const g=new URL(`${this.url}/${r}`);m&&m!=="any"&&(d["x-region"]=m,g.searchParams.set("forceFunctionRegion",m));let x;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",x=c):typeof c=="string"?(d["Content-Type"]="text/plain",x=c):typeof FormData<"u"&&c instanceof FormData?x=c:(d["Content-Type"]="application/json",x=JSON.stringify(c)));const _=yield this.fetch(g.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),a),body:x}).catch(b=>{throw new NN(b)}),y=_.headers.get("x-relay-error");if(y&&y==="true")throw new kv(_);if(!_.ok)throw new bv(_);let S=((n=_.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),C;return S==="application/json"?C=yield _.json():S==="application/octet-stream"?C=yield _.blob():S==="text/event-stream"?C=_:S==="multipart/form-data"?C=yield _.formData():C=yield _.text(),{data:C,error:null,response:_}}catch(a){return{data:null,error:a,response:a instanceof bv||a instanceof kv?a.context:void 0}}})}}var $r={},il={},sl={},ol={},ll={},cl={},IN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},El=IN();const FN=El.fetch,X1=El.fetch.bind(El),J1=El.Headers,LN=El.Request,RN=El.Response,Dl=Object.freeze(Object.defineProperty({__proto__:null,Headers:J1,Request:LN,Response:RN,default:X1,fetch:FN},Symbol.toStringTag,{value:"Module"})),jN=y_(Dl);var Ed={},Sv;function Q1(){if(Sv)return Ed;Sv=1,Object.defineProperty(Ed,"__esModule",{value:!0});class e extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Ed.default=e,Ed}var Tv;function ey(){if(Tv)return cl;Tv=1;var e=cl&&cl.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(cl,"__esModule",{value:!0});const r=e(jN),t=e(Q1());class n{constructor(l){var c,d;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(d=l.isMaybeSingle)!==null&&d!==void 0?d:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=r.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let m=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async g=>{var x,_,y,S;let C=null,b=null,E=null,D=g.status,F=g.statusText;if(g.ok){if(this.method!=="HEAD"){const I=await g.text();I===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((x=this.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?b=I:b=JSON.parse(I))}const M=(_=this.headers.get("Prefer"))===null||_===void 0?void 0:_.match(/count=(exact|planned|estimated)/),G=(y=g.headers.get("content-range"))===null||y===void 0?void 0:y.split("/");M&&G&&G.length>1&&(E=parseInt(G[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(C={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,E=null,D=406,F="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const M=await g.text();try{C=JSON.parse(M),Array.isArray(C)&&g.status===404&&(b=[],C=null,D=200,F="OK")}catch{g.status===404&&M===""?(D=204,F="No Content"):C={message:M}}if(C&&this.isMaybeSingle&&(!((S=C?.details)===null||S===void 0)&&S.includes("0 rows"))&&(C=null,D=200,F="OK"),C&&this.shouldThrowOnError)throw new t.default(C)}return{error:C,data:b,count:E,status:D,statusText:F}});return this.shouldThrowOnError||(m=m.catch(g=>{var x,_,y;return{error:{message:`${(x=g?.name)!==null&&x!==void 0?x:"FetchError"}: ${g?.message}`,details:`${(_=g?.stack)!==null&&_!==void 0?_:""}`,hint:"",code:`${(y=g?.code)!==null&&y!==void 0?y:""}`},data:null,count:null,status:0,statusText:""}})),m.then(l,c)}returns(){return this}overrideTypes(){return this}}return cl.default=n,cl}var Ev;function ty(){if(Ev)return ll;Ev=1;var e=ll&&ll.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ll,"__esModule",{value:!0});const r=e(ey());class t extends r.default{select(a){let l=!1;const c=(a??"*").split("").map(d=>/\s/.test(d)&&!l?"":(d==='"'&&(l=!l),d)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:l=!0,nullsFirst:c,foreignTable:d,referencedTable:m=d}={}){const g=m?`${m}.order`:"order",x=this.url.searchParams.get(g);return this.url.searchParams.set(g,`${x?`${x},`:""}${a}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:l,referencedTable:c=l}={}){const d=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,l,{foreignTable:c,referencedTable:d=c}={}){const m=typeof d>"u"?"offset":`${d}.offset`,g=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(m,`${a}`),this.url.searchParams.set(g,`${l-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:l=!1,settings:c=!1,buffers:d=!1,wal:m=!1,format:g="text"}={}){var x;const _=[a?"analyze":null,l?"verbose":null,c?"settings":null,d?"buffers":null,m?"wal":null].filter(Boolean).join("|"),y=(x=this.headers.get("Accept"))!==null&&x!==void 0?x:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${g}; for="${y}"; options=${_};`),g==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return ll.default=t,ll}var Cv;function fm(){if(Cv)return ol;Cv=1;var e=ol&&ol.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ol,"__esModule",{value:!0});const r=e(ty());class t extends r.default{eq(a,l){return this.url.searchParams.append(a,`eq.${l}`),this}neq(a,l){return this.url.searchParams.append(a,`neq.${l}`),this}gt(a,l){return this.url.searchParams.append(a,`gt.${l}`),this}gte(a,l){return this.url.searchParams.append(a,`gte.${l}`),this}lt(a,l){return this.url.searchParams.append(a,`lt.${l}`),this}lte(a,l){return this.url.searchParams.append(a,`lte.${l}`),this}like(a,l){return this.url.searchParams.append(a,`like.${l}`),this}likeAllOf(a,l){return this.url.searchParams.append(a,`like(all).{${l.join(",")}}`),this}likeAnyOf(a,l){return this.url.searchParams.append(a,`like(any).{${l.join(",")}}`),this}ilike(a,l){return this.url.searchParams.append(a,`ilike.${l}`),this}ilikeAllOf(a,l){return this.url.searchParams.append(a,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(a,l){return this.url.searchParams.append(a,`ilike(any).{${l.join(",")}}`),this}is(a,l){return this.url.searchParams.append(a,`is.${l}`),this}in(a,l){const c=Array.from(new Set(l)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(a,`in.(${c})`),this}contains(a,l){return typeof l=="string"?this.url.searchParams.append(a,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(a,`cs.{${l.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(l)}`),this}containedBy(a,l){return typeof l=="string"?this.url.searchParams.append(a,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(a,`cd.{${l.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(l)}`),this}rangeGt(a,l){return this.url.searchParams.append(a,`sr.${l}`),this}rangeGte(a,l){return this.url.searchParams.append(a,`nxl.${l}`),this}rangeLt(a,l){return this.url.searchParams.append(a,`sl.${l}`),this}rangeLte(a,l){return this.url.searchParams.append(a,`nxr.${l}`),this}rangeAdjacent(a,l){return this.url.searchParams.append(a,`adj.${l}`),this}overlaps(a,l){return typeof l=="string"?this.url.searchParams.append(a,`ov.${l}`):this.url.searchParams.append(a,`ov.{${l.join(",")}}`),this}textSearch(a,l,{config:c,type:d}={}){let m="";d==="plain"?m="pl":d==="phrase"?m="ph":d==="websearch"&&(m="w");const g=c===void 0?"":`(${c})`;return this.url.searchParams.append(a,`${m}fts${g}.${l}`),this}match(a){return Object.entries(a).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(a,l,c){return this.url.searchParams.append(a,`not.${l}.${c}`),this}or(a,{foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,l,c){return this.url.searchParams.append(a,`${l}.${c}`),this}}return ol.default=t,ol}var Av;function ry(){if(Av)return sl;Av=1;var e=sl&&sl.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(sl,"__esModule",{value:!0});const r=e(fm());class t{constructor(a,{headers:l={},schema:c,fetch:d}){this.url=a,this.headers=new Headers(l),this.schema=c,this.fetch=d}select(a,{head:l=!1,count:c}={}){const d=l?"HEAD":"GET";let m=!1;const g=(a??"*").split("").map(x=>/\s/.test(x)&&!m?"":(x==='"'&&(m=!m),x)).join("");return this.url.searchParams.set("select",g),c&&this.headers.append("Prefer",`count=${c}`),new r.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:l,defaultToNull:c=!0}={}){var d;const m="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const g=a.reduce((x,_)=>x.concat(Object.keys(_)),[]);if(g.length>0){const x=[...new Set(g)].map(_=>`"${_}"`);this.url.searchParams.set("columns",x.join(","))}}return new r.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:l,ignoreDuplicates:c=!1,count:d,defaultToNull:m=!0}={}){var g;const x="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),d&&this.headers.append("Prefer",`count=${d}`),m||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const _=a.reduce((y,S)=>y.concat(Object.keys(S)),[]);if(_.length>0){const y=[...new Set(_)].map(S=>`"${S}"`);this.url.searchParams.set("columns",y.join(","))}}return new r.default({method:x,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}update(a,{count:l}={}){var c;const d="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new r.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:a}={}){var l;const c="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new r.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return sl.default=t,sl}var Pv;function MN(){if(Pv)return il;Pv=1;var e=il&&il.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(il,"__esModule",{value:!0});const r=e(ry()),t=e(fm());class n{constructor(l,{headers:c={},schema:d,fetch:m}={}){this.url=l,this.headers=new Headers(c),this.schemaName=d,this.fetch=m}from(l){const c=new URL(`${this.url}/${l}`);return new r.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new n(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:d=!1,get:m=!1,count:g}={}){var x;let _;const y=new URL(`${this.url}/rpc/${l}`);let S;d||m?(_=d?"HEAD":"GET",Object.entries(c).filter(([b,E])=>E!==void 0).map(([b,E])=>[b,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([b,E])=>{y.searchParams.append(b,E)})):(_="POST",S=c);const C=new Headers(this.headers);return g&&C.set("Prefer",`count=${g}`),new t.default({method:_,url:y,headers:C,schema:this.schemaName,body:S,fetch:(x=this.fetch)!==null&&x!==void 0?x:fetch})}}return il.default=n,il}var Nv;function BN(){if(Nv)return $r;Nv=1;var e=$r&&$r.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty($r,"__esModule",{value:!0}),$r.PostgrestError=$r.PostgrestBuilder=$r.PostgrestTransformBuilder=$r.PostgrestFilterBuilder=$r.PostgrestQueryBuilder=$r.PostgrestClient=void 0;const r=e(MN());$r.PostgrestClient=r.default;const t=e(ry());$r.PostgrestQueryBuilder=t.default;const n=e(fm());$r.PostgrestFilterBuilder=n.default;const a=e(ty());$r.PostgrestTransformBuilder=a.default;const l=e(ey());$r.PostgrestBuilder=l.default;const c=e(Q1());return $r.PostgrestError=c.default,$r.default={PostgrestClient:r.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:l.default,PostgrestError:c.default},$r}var zN=BN();const UN=tf(zN),{PostgrestClient:$N,PostgrestQueryBuilder:dO,PostgrestFilterBuilder:fO,PostgrestTransformBuilder:hO,PostgrestBuilder:mO,PostgrestError:pO}=UN;class WN{static detectEnvironment(){var r;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((r=navigator.userAgent)===null||r===void 0)&&r.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const t=parseInt(process.versions.node.split(".")[0]);return t>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const r=this.detectEnvironment();if(r.constructor)return r.constructor;let t=r.error||"WebSocket not supported in this environment.";throw r.workaround&&(t+=`

Suggested solution: ${r.workaround}`),new Error(t)}static createWebSocket(r,t){const n=this.getWebSocketConstructor();return new n(r,t)}static isWebSocketSupported(){try{const r=this.detectEnvironment();return r.type==="native"||r.type==="ws"}catch{return!1}}}const HN="2.15.1",VN=`realtime-js/${HN}`,GN="1.0.0",w0=1e4,ZN=1e3,KN=100;var Rc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Rc||(Rc={}));var Nr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Nr||(Nr={}));var Da;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Da||(Da={}));var k0;(function(e){e.websocket="websocket"})(k0||(k0={}));var no;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(no||(no={}));class qN{constructor(){this.HEADER_LENGTH=1}decode(r,t){return r.constructor===ArrayBuffer?t(this._binaryDecode(r)):t(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const t=new DataView(r),n=new TextDecoder;return this._decodeBroadcast(r,t,n)}_decodeBroadcast(r,t,n){const a=t.getUint8(1),l=t.getUint8(2);let c=this.HEADER_LENGTH+2;const d=n.decode(r.slice(c,c+a));c=c+a;const m=n.decode(r.slice(c,c+l));c=c+l;const g=JSON.parse(n.decode(r.slice(c,r.byteLength)));return{ref:null,topic:d,event:m,payload:g}}}class ny{constructor(r,t){this.callback=r,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Yt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Yt||(Yt={}));const Dv=(e,r,t={})=>{var n;const a=(n=t.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(r).reduce((l,c)=>(l[c]=YN(c,e,r,a),l),{})},YN=(e,r,t,n)=>{const a=r.find(d=>d.name===e),l=a?.type,c=t[e];return l&&!n.includes(l)?ay(l,c):b0(c)},ay=(e,r)=>{if(e.charAt(0)==="_"){const t=e.slice(1,e.length);return e4(r,t)}switch(e){case Yt.bool:return XN(r);case Yt.float4:case Yt.float8:case Yt.int2:case Yt.int4:case Yt.int8:case Yt.numeric:case Yt.oid:return JN(r);case Yt.json:case Yt.jsonb:return QN(r);case Yt.timestamp:return t4(r);case Yt.abstime:case Yt.date:case Yt.daterange:case Yt.int4range:case Yt.int8range:case Yt.money:case Yt.reltime:case Yt.text:case Yt.time:case Yt.timestamptz:case Yt.timetz:case Yt.tsrange:case Yt.tstzrange:return b0(r);default:return b0(r)}},b0=e=>e,XN=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},JN=e=>{if(typeof e=="string"){const r=parseFloat(e);if(!Number.isNaN(r))return r}return e},QN=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(r){return console.log(`JSON parse error: ${r}`),e}return e},e4=(e,r)=>{if(typeof e!="string")return e;const t=e.length-1,n=e[t];if(e[0]==="{"&&n==="}"){let l;const c=e.slice(1,t);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(d=>ay(r,d))}return e},t4=e=>typeof e=="string"?e.replace(" ","T"):e,iy=e=>{let r=e;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")+"/api/broadcast"};class Jh{constructor(r,t,n={},a=w0){this.channel=r,this.event=t,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,t){var n;return this._hasReceived(r)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:r,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const r=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:t}){this.recHooks.filter(n=>n.status===r).forEach(n=>n.callback(t))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}var Ov;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ov||(Ov={}));class jc{constructor(r,t){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=jc.syncState(this.state,a,l,c),this.pendingDiffs.forEach(m=>{this.state=jc.syncDiff(this.state,m,l,c)}),this.pendingDiffs=[],d()}),this.channel._on(n.diff,{},a=>{const{onJoin:l,onLeave:c,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=jc.syncDiff(this.state,a,l,c),d())}),this.onJoin((a,l,c)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:l,newPresences:c})}),this.onLeave((a,l,c)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,t,n,a){const l=this.cloneDeep(r),c=this.transformState(t),d={},m={};return this.map(l,(g,x)=>{c[g]||(m[g]=x)}),this.map(c,(g,x)=>{const _=l[g];if(_){const y=x.map(E=>E.presence_ref),S=_.map(E=>E.presence_ref),C=x.filter(E=>S.indexOf(E.presence_ref)<0),b=_.filter(E=>y.indexOf(E.presence_ref)<0);C.length>0&&(d[g]=C),b.length>0&&(m[g]=b)}else d[g]=x}),this.syncDiff(l,{joins:d,leaves:m},n,a)}static syncDiff(r,t,n,a){const{joins:l,leaves:c}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(l,(d,m)=>{var g;const x=(g=r[d])!==null&&g!==void 0?g:[];if(r[d]=this.cloneDeep(m),x.length>0){const _=r[d].map(S=>S.presence_ref),y=x.filter(S=>_.indexOf(S.presence_ref)<0);r[d].unshift(...y)}n(d,x,m)}),this.map(c,(d,m)=>{let g=r[d];if(!g)return;const x=m.map(_=>_.presence_ref);g=g.filter(_=>x.indexOf(_.presence_ref)<0),r[d]=g,a(d,g,m),g.length===0&&delete r[d]}),r}static map(r,t){return Object.getOwnPropertyNames(r).map(n=>t(n,r[n]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((t,n)=>{const a=r[n];return"metas"in a?t[n]=a.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):t[n]=a,t},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Iv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Iv||(Iv={}));var Mc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Mc||(Mc={}));var Ti;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ti||(Ti={}));class hm{constructor(r,t={config:{}},n){this.topic=r,this.params=t,this.socket=n,this.bindings={},this.state=Nr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Jh(this,Da.join,this.params,this.timeout),this.rejoinTimer=new ny(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Nr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Nr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Nr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Da.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new jc(this),this.broadcastEndpointURL=iy(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(r,t=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Nr.closed){const{config:{broadcast:l,presence:c,private:d}}=this.params,m=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(y=>y.filter))!==null&&a!==void 0?a:[],g=!!this.bindings[Mc.PRESENCE]&&this.bindings[Mc.PRESENCE].length>0,x={},_={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:g}),postgres_changes:m,private:d};this.socket.accessTokenValue&&(x.access_token=this.socket.accessTokenValue),this._onError(y=>r?.(Ti.CHANNEL_ERROR,y)),this._onClose(()=>r?.(Ti.CLOSED)),this.updateJoinPayload(Object.assign({config:_},x)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:y})=>{var S;if(this.socket.setAuth(),y===void 0){r?.(Ti.SUBSCRIBED);return}else{const C=this.bindings.postgres_changes,b=(S=C?.length)!==null&&S!==void 0?S:0,E=[];for(let D=0;D<b;D++){const F=C[D],{filter:{event:O,schema:M,table:G,filter:I}}=F,N=y&&y[D];if(N&&N.event===O&&N.schema===M&&N.table===G&&N.filter===I)E.push(Object.assign(Object.assign({},F),{id:N.id}));else{this.unsubscribe(),this.state=Nr.errored,r?.(Ti.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,r&&r(Ti.SUBSCRIBED);return}}).receive("error",y=>{this.state=Nr.errored,r?.(Ti.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{r?.(Ti.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(r,t={}){return await this.send({type:"presence",event:"track",payload:r},t.timeout||this.timeout)}async untrack(r={}){return await this.send({type:"presence",event:"untrack"},r)}on(r,t,n){return this.state===Nr.joined&&r===Mc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(r,t,n)}async send(r,t={}){var n,a;if(!this._canPush()&&r.type==="broadcast"){const{event:l,payload:c}=r,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const g=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=g.body)===null||a===void 0?void 0:a.cancel()),g.ok?"ok":"error"}catch(g){return g.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,d,m;const g=this._push(r.type,r,t.timeout||this.timeout);r.type==="broadcast"&&!(!((m=(d=(c=this.params)===null||c===void 0?void 0:c.config)===null||d===void 0?void 0:d.broadcast)===null||m===void 0)&&m.ack)&&l("ok"),g.receive("ok",()=>l("ok")),g.receive("error",()=>l("error")),g.receive("timeout",()=>l("timed out"))})}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=Nr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Da.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Jh(this,Da.leave,{},r),n.receive("ok",()=>{t(),a("ok")}).receive("timeout",()=>{t(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Nr.closed,this.bindings={}}async _fetchWithTimeout(r,t,n){const a=new AbortController,l=setTimeout(()=>a.abort(),n),c=await this.socket.fetch(r,Object.assign(Object.assign({},t),{signal:a.signal}));return clearTimeout(l),c}_push(r,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Jh(this,r,t,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(r){if(r.startTimeout(),this.pushBuffer.push(r),this.pushBuffer.length>KN){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(r,t,n){return t}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,t,n){var a,l;const c=r.toLocaleLowerCase(),{close:d,error:m,leave:g,join:x}=Da;if(n&&[d,m,g,x].indexOf(c)>=0&&n!==this._joinRef())return;let y=this._onMessage(c,t,n);if(t&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(S=>{var C,b,E;return((C=S.filter)===null||C===void 0?void 0:C.event)==="*"||((E=(b=S.filter)===null||b===void 0?void 0:b.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===c}).map(S=>S.callback(y,n)):(l=this.bindings[c])===null||l===void 0||l.filter(S=>{var C,b,E,D,F,O;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in S){const M=S.id,G=(C=S.filter)===null||C===void 0?void 0:C.event;return M&&((b=t.ids)===null||b===void 0?void 0:b.includes(M))&&(G==="*"||G?.toLocaleLowerCase()===((E=t.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const M=(F=(D=S?.filter)===null||D===void 0?void 0:D.event)===null||F===void 0?void 0:F.toLocaleLowerCase();return M==="*"||M===((O=t?.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return S.type.toLocaleLowerCase()===c}).map(S=>{if(typeof y=="object"&&"ids"in y){const C=y.data,{schema:b,table:E,commit_timestamp:D,type:F,errors:O}=C;y=Object.assign(Object.assign({},{schema:b,table:E,commit_timestamp:D,eventType:F,new:{},old:{},errors:O}),this._getPayloadRecords(C))}S.callback(y,n)})}_isClosed(){return this.state===Nr.closed}_isJoined(){return this.state===Nr.joined}_isJoining(){return this.state===Nr.joining}_isLeaving(){return this.state===Nr.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,t,n){const a=r.toLocaleLowerCase(),l={type:a,filter:t,callback:n};return this.bindings[a]?this.bindings[a].push(l):this.bindings[a]=[l],this}_off(r,t){const n=r.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var l;return!(((l=a.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===n&&hm.isEqual(a.filter,t))})),this}static isEqual(r,t){if(Object.keys(r).length!==Object.keys(t).length)return!1;for(const n in r)if(r[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(Da.close,{},r)}_onError(r){this._on(Da.error,{},t=>r(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Nr.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const t={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(t.new=Dv(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(t.old=Dv(r.columns,r.old_record)),t}}const Fv=()=>{},Cd={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},r4=[1e3,2e3,5e3,1e4],n4=1e4,a4=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class i4{constructor(r,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=w0,this.transport=null,this.heartbeatIntervalMs=Cd.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Fv,this.ref=0,this.reconnectTimer=null,this.logger=Fv,this.conn=null,this.sendBuffer=[],this.serializer=new qN,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let l;return a?l=a:typeof fetch>"u"?l=(...c)=>Qa(async()=>{const{default:d}=await Promise.resolve().then(()=>Dl);return{default:d}},void 0).then(({default:d})=>d(...c)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${r}/${k0.websocket}`,this.httpEndpoint=iy(r),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=WN.createWebSocket(this.endpointURL())}catch(r){this._setConnectionState("disconnected");const t=r.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:GN}))}disconnect(r,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},r?this.conn.close(r,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(r){const t=await r.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const r=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),r}log(r,t,n){this.logger(r,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Rc.connecting:return no.Connecting;case Rc.open:return no.Open;case Rc.closing:return no.Closing;default:return no.Closed}}isConnected(){return this.connectionState()===no.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(r,t={config:{}}){const n=`realtime:${r}`,a=this.getChannels().find(l=>l.topic===n);if(a)return a;{const l=new hm(`realtime:${r}`,t,this);return this.channels.push(l),l}}push(r){const{topic:t,event:n,payload:a,ref:l}=r,c=()=>{this.encode(r,d=>{var m;(m=this.conn)===null||m===void 0||m.send(d)})};this.log("push",`${t} ${n} (${l})`,a),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(r=null){this._authPromise=this._performAuth(r);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var r;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(r=this.conn)===null||r===void 0||r.close(ZN,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Cd.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}_leaveOpenTopic(r){let t=this.channels.find(n=>n.topic===r&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${r}"`),t.unsubscribe())}_remove(r){this.channels=this.channels.filter(t=>t.topic!==r.topic)}_onConnMessage(r){this.decode(r.data,t=>{t.topic==="phoenix"&&t.event==="phx_reply"&&this.heartbeatCallback(t.payload.status==="ok"?"ok":"error"),t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:l,ref:c}=t,d=c?`(${c})`:"",m=l.status||"";this.log("receive",`${m} ${n} ${a} ${d}`.trim(),l),this.channels.filter(g=>g._isMember(n)).forEach(g=>g._trigger(a,l,c)),this._triggerStateCallbacks("message",t)})}_clearTimer(r){var t;r==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):r==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(r=>r.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){var t;this._setConnectionState("disconnected"),this.log("transport","close",r),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",r)}_onConnError(r){this._setConnectionState("disconnected"),this.log("transport",`${r}`),this._triggerChanError(),this._triggerStateCallbacks("error",r)}_triggerChanError(){this.channels.forEach(r=>r._trigger(Da.error))}_appendParams(r,t){if(Object.keys(t).length===0)return r;const n=r.match(/\?/)?"&":"?",a=new URLSearchParams(t);return`${r}${n}${a}`}_workerObjectUrl(r){let t;if(r)t=r;else{const n=new Blob([a4],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(r,t=!1){this._connectionState=r,r==="connecting"?this._wasManualDisconnect=!1:r==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(r=null){let t;r?t=r:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const a={access_token:t,version:VN};t&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Da.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(r="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${r}`,t)})}_triggerStateCallbacks(r,t){try{this.stateChangeCallbacks[r].forEach(n=>{try{n(t)}catch(a){this.log("error",`error in ${r} callback`,a)}})}catch(n){this.log("error",`error triggering ${r} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new ny(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Cd.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(r){var t,n,a,l,c,d,m,g;if(this.transport=(t=r?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=r?.timeout)!==null&&n!==void 0?n:w0,this.heartbeatIntervalMs=(a=r?.heartbeatIntervalMs)!==null&&a!==void 0?a:Cd.HEARTBEAT_INTERVAL,this.worker=(l=r?.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=r?.accessToken)!==null&&c!==void 0?c:null,r?.params&&(this.params=r.params),r?.logger&&(this.logger=r.logger),(r?.logLevel||r?.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=r?.reconnectAfterMs)!==null&&d!==void 0?d:(x=>r4[x-1]||n4),this.encode=(m=r?.encode)!==null&&m!==void 0?m:((x,_)=>_(JSON.stringify(x))),this.decode=(g=r?.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=r?.workerUrl}}}class mm extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function Dr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class s4 extends mm{constructor(r,t,n){super(r),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class S0 extends mm{constructor(r,t){super(r),this.name="StorageUnknownError",this.originalError=t}}var o4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{g(n.next(x))}catch(_){c(_)}}function m(x){try{g(n.throw(x))}catch(_){c(_)}}function g(x){x.done?l(x.value):a(x.value).then(d,m)}g((n=n.apply(e,r||[])).next())})};const sy=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Qa(async()=>{const{default:n}=await Promise.resolve().then(()=>Dl);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},l4=()=>o4(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Qa(()=>Promise.resolve().then(()=>Dl),void 0)).Response:Response}),T0=e=>{if(Array.isArray(e))return e.map(t=>T0(t));if(typeof e=="function"||e!==Object(e))return e;const r={};return Object.entries(e).forEach(([t,n])=>{const a=t.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));r[a]=T0(n)}),r},c4=e=>{if(typeof e!="object"||e===null)return!1;const r=Object.getPrototypeOf(e);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var xo=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{g(n.next(x))}catch(_){c(_)}}function m(x){try{g(n.throw(x))}catch(_){c(_)}}function g(x){x.done?l(x.value):a(x.value).then(d,m)}g((n=n.apply(e,r||[])).next())})};const Qh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),u4=(e,r,t)=>xo(void 0,void 0,void 0,function*(){const n=yield l4();e instanceof n&&!t?.noResolveJson?e.json().then(a=>{const l=e.status||500,c=a?.statusCode||l+"";r(new s4(Qh(a),l,c))}).catch(a=>{r(new S0(Qh(a),a))}):r(new S0(Qh(e),e))}),d4=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return e==="GET"||!n?a:(c4(n)?(a.headers=Object.assign({"Content-Type":"application/json"},r?.headers),a.body=JSON.stringify(n)):a.body=n,r?.duplex&&(a.duplex=r.duplex),Object.assign(Object.assign({},a),t))};function au(e,r,t,n,a,l){return xo(this,void 0,void 0,function*(){return new Promise((c,d)=>{e(t,d4(r,n,a,l)).then(m=>{if(!m.ok)throw m;return n?.noResolveJson?m:m.json()}).then(m=>c(m)).catch(m=>u4(m,d,n))})})}function Qd(e,r,t,n){return xo(this,void 0,void 0,function*(){return au(e,"GET",r,t,n)})}function Ya(e,r,t,n,a){return xo(this,void 0,void 0,function*(){return au(e,"POST",r,n,a,t)})}function E0(e,r,t,n,a){return xo(this,void 0,void 0,function*(){return au(e,"PUT",r,n,a,t)})}function f4(e,r,t,n){return xo(this,void 0,void 0,function*(){return au(e,"HEAD",r,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function oy(e,r,t,n,a){return xo(this,void 0,void 0,function*(){return au(e,"DELETE",r,n,a,t)})}var _n=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{g(n.next(x))}catch(_){c(_)}}function m(x){try{g(n.throw(x))}catch(_){c(_)}}function g(x){x.done?l(x.value):a(x.value).then(d,m)}g((n=n.apply(e,r||[])).next())})};const h4={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Lv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class m4{constructor(r,t={},n,a){this.url=r,this.headers=t,this.bucketId=n,this.fetch=sy(a)}uploadOrUpdate(r,t,n,a){return _n(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Lv),a);let d=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(c.upsert)});const m=c.metadata;typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m)),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl),m&&l.append("metadata",this.encodeMetadata(m))):(l=n,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType,m&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),a?.headers&&(d=Object.assign(Object.assign({},d),a.headers));const g=this._removeEmptyFolders(t),x=this._getFinalPath(g),_=yield(r=="PUT"?E0:Ya)(this.fetch,`${this.url}/object/${x}`,l,Object.assign({headers:d},c?.duplex?{duplex:c.duplex}:{}));return{data:{path:g,id:_.Id,fullPath:_.Key},error:null}}catch(l){if(Dr(l))return{data:null,error:l};throw l}})}upload(r,t,n){return _n(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,t,n)})}uploadToSignedUrl(r,t,n,a){return _n(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(r),c=this._getFinalPath(l),d=new URL(this.url+`/object/upload/sign/${c}`);d.searchParams.set("token",t);try{let m;const g=Object.assign({upsert:Lv.upsert},a),x=Object.assign(Object.assign({},this.headers),{"x-upsert":String(g.upsert)});typeof Blob<"u"&&n instanceof Blob?(m=new FormData,m.append("cacheControl",g.cacheControl),m.append("",n)):typeof FormData<"u"&&n instanceof FormData?(m=n,m.append("cacheControl",g.cacheControl)):(m=n,x["cache-control"]=`max-age=${g.cacheControl}`,x["content-type"]=g.contentType);const _=yield E0(this.fetch,d.toString(),m,{headers:x});return{data:{path:l,fullPath:_.Key},error:null}}catch(m){if(Dr(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(r,t){return _n(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r);const a=Object.assign({},this.headers);t?.upsert&&(a["x-upsert"]="true");const l=yield Ya(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),c=new URL(this.url+l.url),d=c.searchParams.get("token");if(!d)throw new mm("No token returned by API");return{data:{signedUrl:c.toString(),path:r,token:d},error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}update(r,t,n){return _n(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,t,n)})}move(r,t,n){return _n(this,void 0,void 0,function*(){try{return{data:yield Ya(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}copy(r,t,n){return _n(this,void 0,void 0,function*(){try{return{data:{path:(yield Ya(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}createSignedUrl(r,t,n){return _n(this,void 0,void 0,function*(){try{let a=this._getFinalPath(r),l=yield Ya(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const c=n?.download?`&download=${n.download===!0?"":n.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}createSignedUrls(r,t,n){return _n(this,void 0,void 0,function*(){try{const a=yield Ya(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:r},{headers:this.headers}),l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}download(r,t){return _n(this,void 0,void 0,function*(){const a=typeof t?.transform<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString(t?.transform||{}),c=l?`?${l}`:"";try{const d=this._getFinalPath(r);return{data:yield(yield Qd(this.fetch,`${this.url}/${a}/${d}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(Dr(d))return{data:null,error:d};throw d}})}info(r){return _n(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{const n=yield Qd(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:T0(n),error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}exists(r){return _n(this,void 0,void 0,function*(){const t=this._getFinalPath(r);try{return yield f4(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Dr(n)&&n instanceof S0){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(r,t){const n=this._getFinalPath(r),a=[],l=t?.download?`download=${t.download===!0?"":t.download}`:"";l!==""&&a.push(l);const d=typeof t?.transform<"u"?"render/image":"object",m=this.transformOptsToQueryString(t?.transform||{});m!==""&&a.push(m);let g=a.join("&");return g!==""&&(g=`?${g}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${n}${g}`)}}}remove(r){return _n(this,void 0,void 0,function*(){try{return{data:yield oy(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(t){if(Dr(t))return{data:null,error:t};throw t}})}list(r,t,n){return _n(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},h4),t),{prefix:r||""});return{data:yield Ya(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Dr(a))return{data:null,error:a};throw a}})}listV2(r,t){return _n(this,void 0,void 0,function*(){try{const n=Object.assign({},r);return{data:yield Ya(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r.replace(/^\/+/,"")}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const t=[];return r.width&&t.push(`width=${r.width}`),r.height&&t.push(`height=${r.height}`),r.resize&&t.push(`resize=${r.resize}`),r.format&&t.push(`format=${r.format}`),r.quality&&t.push(`quality=${r.quality}`),t.join("&")}}const p4="2.11.0",g4={"X-Client-Info":`storage-js/${p4}`};var ul=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{g(n.next(x))}catch(_){c(_)}}function m(x){try{g(n.throw(x))}catch(_){c(_)}}function g(x){x.done?l(x.value):a(x.value).then(d,m)}g((n=n.apply(e,r||[])).next())})};class v4{constructor(r,t={},n,a){const l=new URL(r);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},g4),t),this.fetch=sy(n)}listBuckets(){return ul(this,void 0,void 0,function*(){try{return{data:yield Qd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(Dr(r))return{data:null,error:r};throw r}})}getBucket(r){return ul(this,void 0,void 0,function*(){try{return{data:yield Qd(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(t){if(Dr(t))return{data:null,error:t};throw t}})}createBucket(r,t={public:!1}){return ul(this,void 0,void 0,function*(){try{return{data:yield Ya(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}updateBucket(r,t){return ul(this,void 0,void 0,function*(){try{return{data:yield E0(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Dr(n))return{data:null,error:n};throw n}})}emptyBucket(r){return ul(this,void 0,void 0,function*(){try{return{data:yield Ya(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(Dr(t))return{data:null,error:t};throw t}})}deleteBucket(r){return ul(this,void 0,void 0,function*(){try{return{data:yield oy(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(t){if(Dr(t))return{data:null,error:t};throw t}})}}class x4 extends v4{constructor(r,t={},n,a){super(r,t,n,a)}from(r){return new m4(this.url,this.headers,r,this.fetch)}}const y4="2.56.0";let Tc="";typeof Deno<"u"?Tc="deno":typeof document<"u"?Tc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Tc="react-native":Tc="node";const _4={"X-Client-Info":`supabase-js-${Tc}/${y4}`},w4={headers:_4},k4={schema:"public"},b4={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},S4={};var T4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{g(n.next(x))}catch(_){c(_)}}function m(x){try{g(n.throw(x))}catch(_){c(_)}}function g(x){x.done?l(x.value):a(x.value).then(d,m)}g((n=n.apply(e,r||[])).next())})};const E4=e=>{let r;return e?r=e:typeof fetch>"u"?r=X1:r=fetch,(...t)=>r(...t)},C4=()=>typeof Headers>"u"?J1:Headers,A4=(e,r,t)=>{const n=E4(t),a=C4();return(l,c)=>T4(void 0,void 0,void 0,function*(){var d;const m=(d=yield r())!==null&&d!==void 0?d:e;let g=new a(c?.headers);return g.has("apikey")||g.set("apikey",e),g.has("Authorization")||g.set("Authorization",`Bearer ${m}`),n(l,Object.assign(Object.assign({},c),{headers:g}))})};var P4=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{g(n.next(x))}catch(_){c(_)}}function m(x){try{g(n.throw(x))}catch(_){c(_)}}function g(x){x.done?l(x.value):a(x.value).then(d,m)}g((n=n.apply(e,r||[])).next())})};function N4(e){return e.endsWith("/")?e:e+"/"}function D4(e,r){var t,n;const{db:a,auth:l,realtime:c,global:d}=e,{db:m,auth:g,realtime:x,global:_}=r,y={db:Object.assign(Object.assign({},m),a),auth:Object.assign(Object.assign({},g),l),realtime:Object.assign(Object.assign({},x),c),storage:{},global:Object.assign(Object.assign(Object.assign({},_),d),{headers:Object.assign(Object.assign({},(t=_?.headers)!==null&&t!==void 0?t:{}),(n=d?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>P4(this,void 0,void 0,function*(){return""})};return e.accessToken?y.accessToken=e.accessToken:delete y.accessToken,y}const ly="2.71.1",gl=30*1e3,C0=3,e0=C0*gl,O4="http://localhost:9999",I4="supabase.auth.token",F4={"X-Client-Info":`gotrue-js/${ly}`},A0="X-Supabase-Api-Version",cy={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},L4=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,R4=600*1e3;class pm extends Error{constructor(r,t,n){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function wt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class j4 extends pm{constructor(r,t,n){super(r,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function M4(e){return wt(e)&&e.name==="AuthApiError"}class uy extends pm{constructor(r,t){super(r),this.name="AuthUnknownError",this.originalError=t}}class Es extends pm{constructor(r,t,n,a){super(r,n,a),this.name=t,this.status=n}}class ps extends Es{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function B4(e){return wt(e)&&e.name==="AuthSessionMissingError"}class Ad extends Es{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pd extends Es{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class Nd extends Es{constructor(r,t=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function z4(e){return wt(e)&&e.name==="AuthImplicitGrantRedirectError"}class Rv extends Es{constructor(r,t=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class P0 extends Es{constructor(r,t){super(r,"AuthRetryableFetchError",t,void 0)}}function t0(e){return wt(e)&&e.name==="AuthRetryableFetchError"}class jv extends Es{constructor(r,t,n){super(r,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class N0 extends Es{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const ef="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Mv=` 	
\r=`.split(""),U4=(()=>{const e=new Array(128);for(let r=0;r<e.length;r+=1)e[r]=-1;for(let r=0;r<Mv.length;r+=1)e[Mv[r].charCodeAt(0)]=-2;for(let r=0;r<ef.length;r+=1)e[ef[r].charCodeAt(0)]=r;return e})();function Bv(e,r,t){if(e!==null)for(r.queue=r.queue<<8|e,r.queuedBits+=8;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(ef[n]),r.queuedBits-=6}else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;){const n=r.queue>>r.queuedBits-6&63;t(ef[n]),r.queuedBits-=6}}function dy(e,r,t){const n=U4[e];if(n>-1)for(r.queue=r.queue<<6|n,r.queuedBits+=6;r.queuedBits>=8;)t(r.queue>>r.queuedBits-8&255),r.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function zv(e){const r=[],t=c=>{r.push(String.fromCodePoint(c))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},l=c=>{H4(c,n,t)};for(let c=0;c<e.length;c+=1)dy(e.charCodeAt(c),a,l);return r.join("")}function $4(e,r){if(e<=127){r(e);return}else if(e<=2047){r(192|e>>6),r(128|e&63);return}else if(e<=65535){r(224|e>>12),r(128|e>>6&63),r(128|e&63);return}else if(e<=1114111){r(240|e>>18),r(128|e>>12&63),r(128|e>>6&63),r(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function W4(e,r){for(let t=0;t<e.length;t+=1){let n=e.charCodeAt(t);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(t+1)-56320&65535|a)+65536,t+=1}$4(n,r)}}function H4(e,r,t){if(r.utf8seq===0){if(e<=127){t(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){r.utf8seq=n;break}if(r.utf8seq===2)r.codepoint=e&31;else if(r.utf8seq===3)r.codepoint=e&15;else if(r.utf8seq===4)r.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");r.utf8seq-=1}else if(r.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|e&63,r.utf8seq-=1,r.utf8seq===0&&t(r.codepoint)}}function V4(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};for(let a=0;a<e.length;a+=1)dy(e.charCodeAt(a),t,n);return new Uint8Array(r)}function G4(e){const r=[];return W4(e,t=>r.push(t)),new Uint8Array(r)}function Z4(e){const r=[],t={queue:0,queuedBits:0},n=a=>{r.push(a)};return e.forEach(a=>Bv(a,t,n)),Bv(null,t,n),r.join("")}function K4(e){return Math.round(Date.now()/1e3)+e}function q4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e=="x"?r:r&3|8).toString(16)})}const Na=()=>typeof window<"u"&&typeof document<"u",Xs={tested:!1,writable:!1},fy=()=>{if(!Na())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Xs.tested)return Xs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Xs.tested=!0,Xs.writable=!0}catch{Xs.tested=!0,Xs.writable=!1}return Xs.writable};function Y4(e){const r={},t=new URL(e);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((a,l)=>{r[l]=a})}catch{}return t.searchParams.forEach((n,a)=>{r[a]=n}),r}const hy=e=>{let r;return e?r=e:typeof fetch>"u"?r=(...t)=>Qa(async()=>{const{default:n}=await Promise.resolve().then(()=>Dl);return{default:n}},void 0).then(({default:n})=>n(...t)):r=fetch,(...t)=>r(...t)},X4=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",vl=async(e,r,t)=>{await e.setItem(r,JSON.stringify(t))},Js=async(e,r)=>{const t=await e.getItem(r);if(!t)return null;try{return JSON.parse(t)}catch{return t}},hs=async(e,r)=>{await e.removeItem(r)};class lf{constructor(){this.promise=new lf.promiseConstructor((r,t)=>{this.resolve=r,this.reject=t})}}lf.promiseConstructor=Promise;function r0(e){const r=e.split(".");if(r.length!==3)throw new N0("Invalid JWT structure");for(let n=0;n<r.length;n++)if(!L4.test(r[n]))throw new N0("JWT not in base64url format");return{header:JSON.parse(zv(r[0])),payload:JSON.parse(zv(r[1])),signature:V4(r[2]),raw:{header:r[0],payload:r[1]}}}async function J4(e){return await new Promise(r=>{setTimeout(()=>r(null),e)})}function Q4(e,r){return new Promise((n,a)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await e(l);if(!r(l,null,c)){n(c);return}}catch(c){if(!r(l,c)){a(c);return}}})()})}function e3(e){return("0"+e.toString(16)).substr(-2)}function t3(){const r=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let a="";for(let l=0;l<56;l++)a+=t.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(r),Array.from(r,e3).join("")}async function r3(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t),a=new Uint8Array(n);return Array.from(a).map(l=>String.fromCharCode(l)).join("")}async function n3(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await r3(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function dl(e,r,t=!1){const n=t3();let a=n;t&&(a+="/PASSWORD_RECOVERY"),await vl(e,`${r}-code-verifier`,a);const l=await n3(n);return[l,n===l?"plain":"s256"]}const a3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function i3(e){const r=e.headers.get(A0);if(!r||!r.match(a3))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}function s3(e){if(!e)throw new Error("Missing exp claim");const r=Math.floor(Date.now()/1e3);if(e<=r)throw new Error("JWT has expired")}function o3(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const l3=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function fl(e){if(!l3.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function n0(){const e={};return new Proxy(e,{get:(r,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(r,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Uv(e){return JSON.parse(JSON.stringify(e))}var c3=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};const eo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),u3=[502,503,504];async function $v(e){var r;if(!X4(e))throw new P0(eo(e),0);if(u3.includes(e.status))throw new P0(eo(e),e.status);let t;try{t=await e.json()}catch(l){throw new uy(eo(l),l)}let n;const a=i3(e);if(a&&a.getTime()>=cy["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new jv(eo(t),e.status,((r=t.weak_password)===null||r===void 0?void 0:r.reasons)||[]);if(n==="session_not_found")throw new ps}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new jv(eo(t),e.status,t.weak_password.reasons);throw new j4(eo(t),e.status||500,n)}const d3=(e,r,t,n)=>{const a={method:e,headers:r?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),t))};async function At(e,r,t,n){var a;const l=Object.assign({},n?.headers);l[A0]||(l[A0]=cy["2024-01-01"].name),n?.jwt&&(l.Authorization=`Bearer ${n.jwt}`);const c=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(c.redirect_to=n.redirectTo);const d=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",m=await f3(e,r,t+d,{headers:l,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(m):{data:Object.assign({},m),error:null}}async function f3(e,r,t,n,a,l){const c=d3(r,n,a,l);let d;try{d=await e(t,Object.assign({},c))}catch(m){throw console.error(m),new P0(eo(m),0)}if(d.ok||await $v(d),n?.noResolveJson)return d;try{return await d.json()}catch(m){await $v(m)}}function Si(e){var r;let t=null;g3(e)&&(t=Object.assign({},e),e.expires_at||(t.expires_at=K4(e.expires_in)));const n=(r=e.user)!==null&&r!==void 0?r:e;return{data:{session:t,user:n},error:null}}function Wv(e){const r=Si(e);return!r.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(r.data.weak_password=e.weak_password),r}function xs(e){var r;return{data:{user:(r=e.user)!==null&&r!==void 0?r:e},error:null}}function h3(e){return{data:e,error:null}}function m3(e){const{action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:l}=e,c=c3(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:r,email_otp:t,hashed_token:n,redirect_to:a,verification_type:l},m=Object.assign({},c);return{data:{properties:d,user:m},error:null}}function p3(e){return e}function g3(e){return e.access_token&&e.refresh_token&&e.expires_in}const a0=["global","local","others"];var v3=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};class x3{constructor({url:r="",headers:t={},fetch:n}){this.url=r,this.headers=t,this.fetch=hy(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(r,t=a0[0]){if(a0.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${a0.join(", ")}`);try{return await At(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:r,noResolveJson:!0}),{data:null,error:null}}catch(n){if(wt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(r,t={}){try{return await At(this.fetch,"POST",`${this.url}/invite`,{body:{email:r,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:xs})}catch(n){if(wt(n))return{data:{user:null},error:n};throw n}}async generateLink(r){try{const{options:t}=r,n=v3(r,["options"]),a=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await At(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:m3,redirectTo:t?.redirectTo})}catch(t){if(wt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(r){try{return await At(this.fetch,"POST",`${this.url}/admin/users`,{body:r,headers:this.headers,xform:xs})}catch(t){if(wt(t))return{data:{user:null},error:t};throw t}}async listUsers(r){var t,n,a,l,c,d,m;try{const g={nextPage:null,lastPage:0,total:0},x=await At(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=r?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(l=(a=r?.perPage)===null||a===void 0?void 0:a.toString())!==null&&l!==void 0?l:""},xform:p3});if(x.error)throw x.error;const _=await x.json(),y=(c=x.headers.get("x-total-count"))!==null&&c!==void 0?c:0,S=(m=(d=x.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&m!==void 0?m:[];return S.length>0&&(S.forEach(C=>{const b=parseInt(C.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(C.split(";")[1].split("=")[1]);g[`${E}Page`]=b}),g.total=parseInt(y)),{data:Object.assign(Object.assign({},_),g),error:null}}catch(g){if(wt(g))return{data:{users:[]},error:g};throw g}}async getUserById(r){fl(r);try{return await At(this.fetch,"GET",`${this.url}/admin/users/${r}`,{headers:this.headers,xform:xs})}catch(t){if(wt(t))return{data:{user:null},error:t};throw t}}async updateUserById(r,t){fl(r);try{return await At(this.fetch,"PUT",`${this.url}/admin/users/${r}`,{body:t,headers:this.headers,xform:xs})}catch(n){if(wt(n))return{data:{user:null},error:n};throw n}}async deleteUser(r,t=!1){fl(r);try{return await At(this.fetch,"DELETE",`${this.url}/admin/users/${r}`,{headers:this.headers,body:{should_soft_delete:t},xform:xs})}catch(n){if(wt(n))return{data:{user:null},error:n};throw n}}async _listFactors(r){fl(r.userId);try{const{data:t,error:n}=await At(this.fetch,"GET",`${this.url}/admin/users/${r.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:t,error:n}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _deleteFactor(r){fl(r.userId),fl(r.id);try{return{data:await At(this.fetch,"DELETE",`${this.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:this.headers}),error:null}}catch(t){if(wt(t))return{data:null,error:t};throw t}}}function Hv(e={}){return{getItem:r=>e[r]||null,setItem:(r,t)=>{e[r]=t},removeItem:r=>{delete e[r]}}}function y3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const hl={debug:!!(globalThis&&fy()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class my extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class _3 extends my{}async function w3(e,r,t){hl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,r);const n=new globalThis.AbortController;return r>0&&setTimeout(()=>{n.abort(),hl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},r),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,r===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){hl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await t()}finally{hl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(r===0)throw hl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new _3(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(hl.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}y3();const k3={url:O4,storageKey:I4,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:F4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Vv(e,r,t){return await t()}const ml={};class Kc{constructor(r){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Kc.nextInstanceID,Kc.nextInstanceID+=1,this.instanceID>0&&Na()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},k3),r);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new x3({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=hy(a.fetch),this.lock=a.lock||Vv,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:Na()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=w3:this.lock=Vv,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:fy()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Hv(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Hv(this.memoryStorage)),Na()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var r,t;return(t=(r=ml[this.storageKey])===null||r===void 0?void 0:r.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(r){ml[this.storageKey]=Object.assign(Object.assign({},ml[this.storageKey]),{jwks:r})}get jwks_cached_at(){var r,t;return(t=(r=ml[this.storageKey])===null||r===void 0?void 0:r.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(r){ml[this.storageKey]=Object.assign(Object.assign({},ml[this.storageKey]),{cachedAt:r})}_debug(...r){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ly}) ${new Date().toISOString()}`,...r),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var r;try{const t=Y4(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),Na()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:l}=await this._getSessionFromURL(t,n);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),z4(l)){const m=(r=l.details)===null||r===void 0?void 0:r.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",c,"redirect type",d),await this._saveSession(c),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return wt(t)?{error:t}:{error:new uy("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(r){var t,n,a;try{const l=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=r?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=r?.options)===null||a===void 0?void 0:a.captchaToken}},xform:Si}),{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const m=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:g,session:m},error:null}}catch(l){if(wt(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(r){var t,n,a;try{let l;if("email"in r){const{email:x,password:_,options:y}=r;let S=null,C=null;this.flowType==="pkce"&&([S,C]=await dl(this.storage,this.storageKey)),l=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:y?.emailRedirectTo,body:{email:x,password:_,data:(t=y?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:y?.captchaToken},code_challenge:S,code_challenge_method:C},xform:Si})}else if("phone"in r){const{phone:x,password:_,options:y}=r;l=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:x,password:_,data:(n=y?.data)!==null&&n!==void 0?n:{},channel:(a=y?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:y?.captchaToken}},xform:Si})}else throw new Pd("You must provide either an email or phone number and a password");const{data:c,error:d}=l;if(d||!c)return{data:{user:null,session:null},error:d};const m=c.session,g=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:g,session:m},error:null}}catch(l){if(wt(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(r){try{let t;if("email"in r){const{email:l,password:c,options:d}=r;t=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Wv})}else if("phone"in r){const{phone:l,password:c,options:d}=r;t=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Wv})}else throw new Pd("You must provide either an email or phone number and a password");const{data:n,error:a}=t;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ad}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(t){if(wt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(r){var t,n,a,l;return await this._handleProviderSignIn(r.provider,{redirectTo:(t=r.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=r.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=r.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(l=r.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(r){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(r))}async signInWithWeb3(r){const{chain:t}=r;if(t==="solana")return await this.signInWithSolana(r);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(r){var t,n,a,l,c,d,m,g,x,_,y,S;let C,b;if("message"in r)C=r.message,b=r.signature;else{const{chain:E,wallet:D,statement:F,options:O}=r;let M;if(Na())if(typeof D=="object")M=D;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))M=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof D!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=D}const G=new URL((t=O?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in M&&M.signIn){const I=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O?.signInWithSolana),{version:"1",domain:G.host,uri:G.href}),F?{statement:F}:null));let N;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")N=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)N=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)C=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),b=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");C=[`${G.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...F?["",F,""]:[""],"Version: 1",`URI: ${G.href}`,`Issued At: ${(a=(n=O?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((l=O?.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((c=O?.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((d=O?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((m=O?.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((g=O?.signInWithSolana)===null||g===void 0)&&g.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((_=(x=O?.signInWithSolana)===null||x===void 0?void 0:x.resources)===null||_===void 0)&&_.length?["Resources",...O.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const I=await M.signMessage(new TextEncoder().encode(C),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=I}}try{const{data:E,error:D}=await At(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:C,signature:Z4(b)},!((y=r.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(S=r.options)===null||S===void 0?void 0:S.captchaToken}}:null),xform:Si});if(D)throw D;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new Ad}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:D})}catch(E){if(wt(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(r){const t=await Js(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(t??"").split("/");try{const{data:l,error:c}=await At(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:r,code_verifier:n},xform:Si});if(await hs(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new Ad}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:a??null}),error:c})}catch(l){if(wt(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(r){try{const{options:t,provider:n,token:a,access_token:l,nonce:c}=r,d=await At(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Si}),{data:m,error:g}=d;return g?{data:{user:null,session:null},error:g}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new Ad}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:g})}catch(t){if(wt(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(r){var t,n,a,l,c;try{if("email"in r){const{email:d,options:m}=r;let g=null,x=null;this.flowType==="pkce"&&([g,x]=await dl(this.storage,this.storageKey));const{error:_}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(t=m?.data)!==null&&t!==void 0?t:{},create_user:(n=m?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:g,code_challenge_method:x},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:_}}if("phone"in r){const{phone:d,options:m}=r,{data:g,error:x}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=m?.data)!==null&&a!==void 0?a:{},create_user:(l=m?.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},channel:(c=m?.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:g?.message_id},error:x}}throw new Pd("You must provide either an email or phone number.")}catch(d){if(wt(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(r){var t,n;try{let a,l;"options"in r&&(a=(t=r.options)===null||t===void 0?void 0:t.redirectTo,l=(n=r.options)===null||n===void 0?void 0:n.captchaToken);const{data:c,error:d}=await At(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},r),{gotrue_meta_security:{captcha_token:l}}),redirectTo:a,xform:Si});if(d)throw d;if(!c)throw new Error("An error occurred on token verification.");const m=c.session,g=c.user;return m?.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(r.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:g,session:m},error:null}}catch(a){if(wt(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(r){var t,n,a;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await dl(this.storage,this.storageKey)),await At(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in r?{provider_id:r.providerId}:null),"domain"in r?{domain:r.domain}:null),{redirect_to:(n=(t=r.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=r?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:r.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:h3})}catch(l){if(wt(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async r=>{const{data:{session:t},error:n}=r;if(n)throw n;if(!t)throw new ps;const{error:a}=await At(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:a}})}catch(r){if(wt(r))return{data:{user:null,session:null},error:r};throw r}}async resend(r){try{const t=`${this.url}/resend`;if("email"in r){const{email:n,type:a,options:l}=r,{error:c}=await At(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in r){const{phone:n,type:a,options:l}=r,{data:c,error:d}=await At(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:l?.captchaToken}}});return{data:{user:null,session:null,messageId:c?.message_id},error:d}}throw new Pd("You must provide either an email or phone number and a type")}catch(t){if(wt(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(r,t){this._debug("#_acquireLock","begin",r);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,r,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(r){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await r(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let r=null;const t=await Js(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?r=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!r)return{data:{session:null},error:null};const n=r.expires_at?r.expires_at*1e3-Date.now()<e0:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",r.expires_at),!n){if(this.userStorage){const c=await Js(this.userStorage,this.storageKey+"-user");c?.user?r.user=c.user:r.user=n0()}if(this.storage.isServer&&r.user){let c=this.suppressGetSessionWarning;r=new Proxy(r,{get:(m,g,x)=>(!c&&g==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,g,x))})}return{data:{session:r},error:null}}const{session:a,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{session:null},error:l}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(r){return r?await this._getUser(r):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(r){try{return r?await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:r,xform:xs}):await this._useSession(async t=>{var n,a,l;const{data:c,error:d}=t;if(d)throw d;return!(!((n=c.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ps}:await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(a=c.session)===null||a===void 0?void 0:a.access_token)!==null&&l!==void 0?l:void 0,xform:xs})})}catch(t){if(wt(t))return B4(t)&&(await this._removeSession(),await hs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(r,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(r,t))}async _updateUser(r,t={}){try{return await this._useSession(async n=>{const{data:a,error:l}=n;if(l)throw l;if(!a.session)throw new ps;const c=a.session;let d=null,m=null;this.flowType==="pkce"&&r.email!=null&&([d,m]=await dl(this.storage,this.storageKey));const{data:g,error:x}=await At(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},r),{code_challenge:d,code_challenge_method:m}),jwt:c.access_token,xform:xs});if(x)throw x;return c.user=g.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(n){if(wt(n))return{data:{user:null},error:n};throw n}}async setSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(r))}async _setSession(r){try{if(!r.access_token||!r.refresh_token)throw new ps;const t=Date.now()/1e3;let n=t,a=!0,l=null;const{payload:c}=r0(r.access_token);if(c.exp&&(n=c.exp,a=n<=t),a){const{session:d,error:m}=await this._callRefreshToken(r.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!d)return{data:{user:null,session:null},error:null};l=d}else{const{data:d,error:m}=await this._getUser(r.access_token);if(m)throw m;l={access_token:r.access_token,refresh_token:r.refresh_token,user:d.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(t){if(wt(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(r){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(r))}async _refreshSession(r){try{return await this._useSession(async t=>{var n;if(!r){const{data:c,error:d}=t;if(d)throw d;r=(n=c.session)!==null&&n!==void 0?n:void 0}if(!r?.refresh_token)throw new ps;const{session:a,error:l}=await this._callRefreshToken(r.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(wt(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(r,t){try{if(!Na())throw new Nd("No browser detected.");if(r.error||r.error_description||r.error_code)throw new Nd(r.error_description||"Error in URL with unspecified error_description",{error:r.error||"unspecified_error",code:r.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Rv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Nd("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!r.code)throw new Rv("No code detected.");const{data:F,error:O}=await this._exchangeCodeForSession(r.code);if(O)throw O;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:F.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:l,refresh_token:c,expires_in:d,expires_at:m,token_type:g}=r;if(!l||!d||!c||!g)throw new Nd("No session defined in URL");const x=Math.round(Date.now()/1e3),_=parseInt(d);let y=x+_;m&&(y=parseInt(m));const S=y-x;S*1e3<=gl&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${S}s, should have been closer to ${_}s`);const C=y-_;x-C>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",C,y,x):x-C<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",C,y,x);const{data:b,error:E}=await this._getUser(l);if(E)throw E;const D={provider_token:n,provider_refresh_token:a,access_token:l,expires_in:_,expires_at:y,refresh_token:c,token_type:g,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:D,redirectType:r.type},error:null}}catch(n){if(wt(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(r){return!!(r.access_token||r.error_description)}async _isPKCECallback(r){const t=await Js(this.storage,`${this.storageKey}-code-verifier`);return!!(r.code&&t)}async signOut(r={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(r))}async _signOut({scope:r}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return{error:l};const c=(n=a.session)===null||n===void 0?void 0:n.access_token;if(c){const{error:d}=await this.admin.signOut(c,r);if(d&&!(M4(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return r!=="others"&&(await this._removeSession(),await hs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(r){const t=q4(),n={id:t,callback:r,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(r){return await this._useSession(async t=>{var n,a;try{const{data:{session:l},error:c}=t;if(c)throw c;await((n=this.stateChangeEmitters.get(r))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",r,"session",l)}catch(l){await((a=this.stateChangeEmitters.get(r))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",r,"error",l),console.error(l)}})}async resetPasswordForEmail(r,t={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await dl(this.storage,this.storageKey,!0));try{return await At(this.fetch,"POST",`${this.url}/recover`,{body:{email:r,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(l){if(wt(l))return{data:null,error:l};throw l}}async getUserIdentities(){var r;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(r=t.user.identities)!==null&&r!==void 0?r:[]},error:null}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async linkIdentity(r){var t;try{const{data:n,error:a}=await this._useSession(async l=>{var c,d,m,g,x;const{data:_,error:y}=l;if(y)throw y;const S=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,r.provider,{redirectTo:(c=r.options)===null||c===void 0?void 0:c.redirectTo,scopes:(d=r.options)===null||d===void 0?void 0:d.scopes,queryParams:(m=r.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await At(this.fetch,"GET",S,{headers:this.headers,jwt:(x=(g=_.session)===null||g===void 0?void 0:g.access_token)!==null&&x!==void 0?x:void 0})});if(a)throw a;return Na()&&!(!((t=r.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:r.provider,url:n?.url},error:null}}catch(n){if(wt(n))return{data:{provider:r.provider,url:null},error:n};throw n}}async unlinkIdentity(r){try{return await this._useSession(async t=>{var n,a;const{data:l,error:c}=t;if(c)throw c;return await At(this.fetch,"DELETE",`${this.url}/user/identities/${r.identity_id}`,{headers:this.headers,jwt:(a=(n=l.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _refreshAccessToken(r){const t=`#_refreshAccessToken(${r.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await Q4(async a=>(a>0&&await J4(200*Math.pow(2,a-1)),this._debug(t,"refreshing attempt",a),await At(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:r},headers:this.headers,xform:Si})),(a,l)=>{const c=200*Math.pow(2,a);return l&&t0(l)&&Date.now()+c-n<gl})}catch(n){if(this._debug(t,"error",n),wt(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(r){return typeof r=="object"&&r!==null&&"access_token"in r&&"refresh_token"in r&&"expires_at"in r}async _handleProviderSignIn(r,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,r,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",r,"options",t,"url",n),Na()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:r,url:n},error:null}}async _recoverAndRefresh(){var r,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Js(this.storage,this.storageKey);if(a&&this.userStorage){let c=await Js(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:a.user},await vl(this.userStorage,this.storageKey+"-user",c)),a.user=(r=c?.user)!==null&&r!==void 0?r:n0()}else if(a&&!a.user&&!a.user){const c=await Js(this.storage,this.storageKey+"-user");c&&c?.user?(a.user=c.user,await hs(this.storage,this.storageKey+"-user"),await vl(this.storage,this.storageKey,a)):a.user=n0()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const l=((t=a.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<e0;if(this._debug(n,`session has${l?"":" not"} expired with margin of ${e0}s`),l){if(this.autoRefreshToken&&a.refresh_token){const{error:c}=await this._callRefreshToken(a.refresh_token);c&&(console.error(c),t0(c)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:d}=await this._getUser(a.access_token);!d&&c?.user?(a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(n,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(r){var t,n;if(!r)throw new ps;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${r.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new lf;const{data:l,error:c}=await this._refreshAccessToken(r);if(c)throw c;if(!l.session)throw new ps;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const d={session:l.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(l){if(this._debug(a,"error",l),wt(l)){const c={session:null,error:l};return t0(l)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(c),c}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(l),l}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(r,t,n=!0){const a=`#_notifyAllSubscribers(${r})`;this._debug(a,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:r,session:t});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(r,t)}catch(m){l.push(m)}});if(await Promise.all(c),l.length>0){for(let d=0;d<l.length;d+=1)console.error(l[d]);throw l[0]}}finally{this._debug(a,"end")}}async _saveSession(r){this._debug("#_saveSession()",r),this.suppressGetSessionWarning=!0;const t=Object.assign({},r),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await vl(this.userStorage,this.storageKey+"-user",{user:t.user});const a=Object.assign({},t);delete a.user;const l=Uv(a);await vl(this.storage,this.storageKey,l)}else{const a=Uv(t);await vl(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await hs(this.storage,this.storageKey),await hs(this.storage,this.storageKey+"-code-verifier"),await hs(this.storage,this.storageKey+"-user"),this.userStorage&&await hs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const r=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{r&&Na()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",r)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const r=setInterval(()=>this._autoRefreshTokenTick(),gl);this.autoRefreshTicker=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const r=this.autoRefreshTicker;this.autoRefreshTicker=null,r&&clearInterval(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const r=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-r)/gl);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${gl}ms, refresh threshold is ${C0} ticks`),a<=C0&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(r){if(r.isAcquireTimeout||r instanceof my)this._debug("auto refresh token tick lock not available");else throw r}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Na()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(r){console.error("_handleVisibilityChange",r)}}async _onVisibilityChanged(r){const t=`#_onVisibilityChanged(${r})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),r||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(r,t,n){const a=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[l,c]=await dl(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});a.push(d.toString())}if(n?.queryParams){const l=new URLSearchParams(n.queryParams);a.push(l.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${r}?${a.join("&")}`}async _unenroll(r){try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;return l?{data:null,error:l}:await At(this.fetch,"DELETE",`${this.url}/factors/${r.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _enroll(r){try{return await this._useSession(async t=>{var n,a;const{data:l,error:c}=t;if(c)return{data:null,error:c};const d=Object.assign({friendly_name:r.friendlyName,factor_type:r.factorType},r.factorType==="phone"?{phone:r.phone}:{issuer:r.issuer}),{data:m,error:g}=await At(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(n=l?.session)===null||n===void 0?void 0:n.access_token});return g?{data:null,error:g}:(r.factorType==="totp"&&(!((a=m?.totp)===null||a===void 0)&&a.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _verify(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;if(l)return{data:null,error:l};const{data:c,error:d}=await At(this.fetch,"POST",`${this.url}/factors/${r.factorId}/verify`,{body:{code:r.code,challenge_id:r.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:d})})}catch(t){if(wt(t))return{data:null,error:t};throw t}})}async _challenge(r){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:a,error:l}=t;return l?{data:null,error:l}:await At(this.fetch,"POST",`${this.url}/factors/${r.factorId}/challenge`,{body:{channel:r.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(wt(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(r){const{data:t,error:n}=await this._challenge({factorId:r.factorId});return n?{data:null,error:n}:await this._verify({factorId:r.factorId,challengeId:t.id,code:r.code})}async _listFactors(){const{data:{user:r},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=r?.factors||[],a=n.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=n.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:n,totp:a,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async r=>{var t,n;const{data:{session:a},error:l}=r;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=r0(a.access_token);let d=null;c.aal&&(d=c.aal);let m=d;((n=(t=a.user.factors)===null||t===void 0?void 0:t.filter(_=>_.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const x=c.amr||[];return{data:{currentLevel:d,nextLevel:m,currentAuthenticationMethods:x},error:null}}))}async fetchJwk(r,t={keys:[]}){let n=t.keys.find(d=>d.kid===r);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(d=>d.kid===r),n&&this.jwks_cached_at+R4>a)return n;const{data:l,error:c}=await At(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=a,n=l.keys.find(d=>d.kid===r),!n)?null:n}async getClaims(r,t={}){try{let n=r;if(!n){const{data:S,error:C}=await this.getSession();if(C||!S.session)return{data:null,error:C};n=S.session.access_token}const{header:a,payload:l,signature:c,raw:{header:d,payload:m}}=r0(n);t?.allowExpired||s3(l.exp);const g=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!g){const{error:S}=await this.getUser(n);if(S)throw S;return{data:{claims:l,header:a,signature:c},error:null}}const x=o3(a.alg),_=await crypto.subtle.importKey("jwk",g,x,!0,["verify"]);if(!await crypto.subtle.verify(x,_,c,G4(`${d}.${m}`)))throw new N0("Invalid JWT signature");return{data:{claims:l,header:a,signature:c},error:null}}catch(n){if(wt(n))return{data:null,error:n};throw n}}}Kc.nextInstanceID=0;const b3=Kc;class S3 extends b3{constructor(r){super(r)}}var T3=function(e,r,t,n){function a(l){return l instanceof t?l:new t(function(c){c(l)})}return new(t||(t=Promise))(function(l,c){function d(x){try{g(n.next(x))}catch(_){c(_)}}function m(x){try{g(n.throw(x))}catch(_){c(_)}}function g(x){x.done?l(x.value):a(x.value).then(d,m)}g((n=n.apply(e,r||[])).next())})};class E3{constructor(r,t,n){var a,l,c;if(this.supabaseUrl=r,this.supabaseKey=t,!r)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const d=N4(r),m=new URL(d);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const g=`sb-${m.hostname.split(".")[0]}-auth-token`,x={db:k4,realtime:S4,auth:Object.assign(Object.assign({},b4),{storageKey:g}),global:w4},_=D4(n??{},x);this.storageKey=(a=_.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(l=_.global.headers)!==null&&l!==void 0?l:{},_.accessToken?(this.accessToken=_.accessToken,this.auth=new Proxy({},{get:(y,S)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(S)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=_.auth)!==null&&c!==void 0?c:{},this.headers,_.global.fetch),this.fetch=A4(t,this._getAccessToken.bind(this),_.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},_.realtime)),this.rest=new $N(new URL("rest/v1",m).href,{headers:this.headers,schema:_.db.schema,fetch:this.fetch}),this.storage=new x4(this.storageUrl.href,this.headers,this.fetch,n?.storage),_.accessToken||this._listenForAuthEvents()}get functions(){return new ON(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,t={},n={}){return this.rest.rpc(r,t,n)}channel(r,t={config:{}}){return this.realtime.channel(r,t)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,t;return T3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:a,storageKey:l,flowType:c,lock:d,debug:m},g,x){const _={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new S3({url:this.authUrl.href,headers:Object.assign(Object.assign({},_),g),storageKey:l,autoRefreshToken:r,persistSession:t,detectSessionInUrl:n,storage:a,flowType:c,lock:d,debug:m,fetch:x,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new i4(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},r?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(r,t,n){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:r==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const py=(e,r,t)=>new E3(e,r,t);function C3(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const r=e.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}C3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const A3="https://eevfxrgemrtthxbcxtvq.supabase.co",P3="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",$e=py(A3,P3,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"navigator-supabase-auth-token",debug:!1},realtime:{params:{eventsPerSecond:5}}});async function N3(e){if(!$e)throw new Error("Supabase not configured");const{data:r,error:t}=await $e.rpc("create_trial_subscription",{target_user_id:e});if(console.log("Trial subscription creation result:",{data:r,error:t}),t)throw console.error("Failed to create trial subscription:",t),t;if(r&&!r.success)throw console.error("Trial subscription creation failed:",r.message),new Error(r.message);console.log("Trial subscription created successfully:",r)}function Gv(){let e=localStorage.getItem("navigator_device_id");return e||(e=`device_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,localStorage.setItem("navigator_device_id",e)),e}function D3(e,r){const t=typeof e.currentListVersion=="number"?e.currentListVersion:1,n=typeof r.currentListVersion=="number"?r.currentListVersion:1,a=D=>typeof D=="number"?D:Math.max(t,n),l=new Map,c=D=>{if(!D||typeof D.index!="number"||typeof D.timestamp!="string"||!D.outcome)return;const F={...D,listVersion:a(D.listVersion)},O=`${F.timestamp}_${F.index}_${F.outcome}`,M=l.get(O);if(!M){l.set(O,F);return}const G=new Date(M.timestamp).getTime();if(new Date(F.timestamp).getTime()>G){l.set(O,{...M,...F});return}l.set(O,{...F,...M})};r.completions?.forEach(c),e.completions?.forEach(c);const d=Array.from(l.values()).sort((D,F)=>new Date(F.timestamp).getTime()-new Date(D.timestamp).getTime()),m=()=>{const D=Array.isArray(e.addresses)?e.addresses:[],F=Array.isArray(r.addresses)?r.addresses:[],O=N=>N.some(q=>q.address?.trim()),M=O(F),G=O(D);return n>t?!M&&G?{addresses:D,listVersion:t}:{addresses:F,listVersion:n}:t>n?!G&&M?{addresses:F,listVersion:t}:{addresses:D,listVersion:t}:M&&!G?{addresses:F,listVersion:n}:!M&&G?{addresses:D,listVersion:t}:{addresses:F.length>=D.length?F:D,listVersion:n}},{addresses:g,listVersion:x}=m(),_=new Map,y=D=>{if(!D?.id)return;const F=_.get(D.id);if(!F){_.set(D.id,D);return}const O=new Date(F.updatedAt).getTime();new Date(D.updatedAt).getTime()>O&&_.set(D.id,D)};e.arrangements?.forEach(y),r.arrangements?.forEach(y);const S=new Map,C=D=>{if(!D?.date)return;const F=S.get(D.date);if(!F){S.set(D.date,D);return}const O=!!F.end,M=!!D.end;if(!O&&M){S.set(D.date,D);return}if(O&&M){const G=new Date(F.end??F.start).getTime();new Date(D.end??D.start).getTime()>G&&S.set(D.date,D)}};e.daySessions?.forEach(C),r.daySessions?.forEach(C);const b=Array.from(S.values()),E=Array.from(_.values());return{...r,addresses:g,completions:d,arrangements:E,daySessions:b,currentListVersion:x,activeIndex:r.activeIndex??e.activeIndex??null}}function gy(){const[e,r]=J.useState(null),[t,n]=J.useState(!0),[a,l]=J.useState(!1),[c,d]=J.useState(typeof navigator<"u"?navigator.onLine:!0),[m,g]=J.useState(null),[x,_]=J.useState(null),y=J.useRef({lastSyncAt:"",deviceId:Gv(),version:0,checksum:""}),S=J.useRef([]),C=J.useRef(!1),b=J.useRef(null),E=J.useRef(""),D=J.useRef(null),F=J.useCallback(()=>g(null),[]),O=J.useCallback(async()=>{if(!e||!$e||!c||C.current||S.current.length===0)return;C.current=!0,l(!0);const Y=S.current.slice(0,10),se=new Set;try{for(const ve of Y)try{const{operation:ee}=ve,{error:ce}=await $e.from("navigator_operations").insert({user_id:e.id,operation_id:ee.id,type:ee.type,entity:ee.entity,entity_id:ee.entityId,data:ee.data,device_id:y.current.deviceId,timestamp:ee.timestamp,local_timestamp:ee.localTimestamp});if(ce&&ce.code!=="23505")throw ce;se.add(ve.operation.id),ve.resolve(ee)}catch(ee){ve.operation.retries+=1,ve.operation.retries<3?console.log(`Retrying operation ${ve.operation.id}, attempt ${ve.operation.retries}`):(console.warn(`Operation ${ve.operation.id} failed after max retries:`,ee),se.add(ve.operation.id),ve.reject(ee))}S.current=S.current.filter(ve=>!se.has(ve.operation.id))}catch(ve){console.error("Sync batch error:",ve),g(ve?.message||"Sync batch failed")}finally{C.current=!1,l(S.current.length>0),S.current.length>0&&(b.current=setTimeout(O,1e3))}},[e,c]),M=J.useCallback(async Y=>new Promise((se,ve)=>{const ee=JSON.stringify(Y.data),ce=`${Y.type}_${Y.entity}_${Y.entityId}_${ee}`;if(S.current.some(R=>{const P=JSON.stringify(R.operation.data);return`${R.operation.type}_${R.operation.entity}_${R.operation.entityId}_${P}`===ce&&R.operation.retries<3})){console.log(`Skipping exact duplicate operation: ${ce}`),se();return}const ie=new Date().toISOString(),fe={operation:{...Y,id:`op_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,timestamp:ie,localTimestamp:ie,retries:0},resolve:se,reject:ve};S.current.push(fe),S.current.length>1e3&&(console.warn("Sync queue size limit reached, removing oldest entries"),S.current.splice(0,100).forEach(P=>{P.reject(new Error("Queue overflow - operation cancelled"))})),c&&O()}),[c,O]);J.useEffect(()=>{let Y=!0;if((async()=>{try{if(!$e){Y&&(g("Supabase not configured"),n(!1));return}const{data:ve,error:ee}=await $e.auth.getUser();if(ee)throw ee;Y&&r(ve.user??null)}catch(ve){Y&&g(ve?.message||String(ve))}finally{Y&&n(!1)}})(),!$e)return()=>{Y=!1};const{data:se}=$e.auth.onAuthStateChange((ve,ee)=>{Y&&r(ee?.user??null)});return()=>{Y=!1,se.subscription.unsubscribe()}},[]),J.useEffect(()=>{if(typeof window>"u")return;const Y=()=>{d(!0),b.current=setTimeout(O,100)},se=()=>{d(!1)};return window.addEventListener("online",Y),window.addEventListener("offline",se),()=>{window.removeEventListener("online",Y),window.removeEventListener("offline",se)}},[O]);const G=J.useCallback(async(Y,se)=>{if(F(),!$e)throw new Error("Supabase not configured");const{data:ve,error:ee}=await $e.auth.signInWithPassword({email:Y,password:se});if(ee)throw g(ee.message),ee;localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id");const{SmartUserDetection:ce}=await Qa(async()=>{const{SmartUserDetection:V}=await Promise.resolve().then(()=>EN);return{SmartUserDetection:V}},void 0);return ce.storeDeviceContext(ve.user),r(ve.user),{user:ve.user}},[F]),I=J.useCallback(async(Y,se)=>{if(F(),!$e)throw new Error("Supabase not configured");try{localStorage.removeItem("navigator-supabase-auth-token"),localStorage.removeItem("supabase.auth.token"),sessionStorage.clear(),await $e.auth.signOut(),r(null),await new Promise(V=>setTimeout(V,1e3));const{data:ce}=await $e.auth.getSession();ce.session&&(console.warn("Session still exists after cleanup, forcing removal..."),await $e.auth.signOut(),await new Promise(V=>setTimeout(V,500)))}catch(ce){console.warn("Error during pre-signup signout:",ce)}const{data:ve,error:ee}=await $e.auth.signUp({email:Y,password:se,options:{data:{signup_source:"navigator_web"},emailRedirectTo:void 0}});if(ee)throw g(ee.message),ee;if(ve.user){try{await N3(ve.user.id),localStorage.setItem("navigator_trial_created",Date.now().toString()),localStorage.setItem("navigator_trial_user_id",ve.user.id)}catch(ce){console.error("Failed to initialize new user:",ce)}if(!ve.session)try{const{data:ce,error:V}=await $e.auth.signInWithPassword({email:Y,password:se});if(V)console.warn("Immediate signin failed:",V);else return r(ce.user),{user:ce.user}}catch(ce){console.warn("Immediate signin error:",ce)}r(ve.user)}return{user:ve.user}},[F]),N=J.useCallback(async()=>{if(F(),D.current&&(D.current(),D.current=null),!$e)return;const{error:Y}=await $e.auth.signOut();if(Y)throw g(Y.message),Y;try{const{clear:se}=await Qa(async()=>{const{clear:ee}=await Promise.resolve().then(()=>IA);return{clear:ee}},void 0);await se(),["navigator_trial_created","navigator_trial_user_id","navigator_last_user_id","navigator_device_context","navigator_device_context_checksum","navigator_supabase_url","navigator_supabase_key","navigator_supabase_skipped","navigator_data_counts","last_backup_time"].forEach(ee=>localStorage.removeItem(ee)),sessionStorage.clear(),console.log("Cleared all navigator data on signout")}catch(se){console.warn("Error clearing local data:",se)}r(null),_(null),y.current={lastSyncAt:"",deviceId:Gv(),version:0,checksum:""},S.current=[],C.current=!1,E.current="",b.current&&(clearTimeout(b.current),b.current=null)},[F]),q=J.useCallback(async Y=>{if(!e||!$e){g(e?"Supabase not configured":"Not authenticated");return}if(JSON.stringify(Y)!==E.current)try{F(),l(!0);const ve=new Date().toISOString(),{data:ee,error:ce}=await $e.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle();if(ce)throw ce;let V=Y,ie=y.current.version+1;if(ee&&ee.updated_at>y.current.lastSyncAt){console.log("Conflict detected, resolving...");const P=ee.data;V=await Z(Y,P),ie=(ee.version||0)+1}const Q=Tl(V),{data:fe,error:R}=await $e.from("navigator_state").upsert({user_id:e.id,data:V,updated_at:ve,version:ie,checksum:Q,device_id:y.current.deviceId},{onConflict:"user_id"}).select("updated_at, version, checksum").single();if(R)throw console.error("Cloud sync database error:",R),R.code==="23505"||R.message?.includes("conflict")?(console.log("Detected sync conflict, attempting resolution..."),y.current.lastSyncAt="",y.current.version=0,new Error("Sync conflict detected - will retry with fresh data")):R;y.current={lastSyncAt:fe?.updated_at??ve,deviceId:y.current.deviceId,version:fe?.version??ie,checksum:fe?.checksum??Q},E.current=JSON.stringify(V),_(new Date(fe?.updated_at??ve))}catch(ve){g(ve?.message||String(ve)),console.error("Sync failed:",ve)}finally{l(!1)}},[e,F]),Z=J.useCallback(async(Y,se)=>{console.log("Resolving conflicts between local and server state");const ve=localStorage.getItem("navigator_restore_in_progress");if(ve){const P=parseInt(ve),W=Date.now()-P;if(W<3e4){console.log(" RESTORE PROTECTION: Preferring local state to prevent data loss",{timeSinceRestore:`${Math.round(W/1e3)}s`,restoreTime:new Date(P).toISOString()});const U=typeof Y.currentListVersion=="number"?Y.currentListVersion:1,H=typeof se.currentListVersion=="number"?se.currentListVersion:1;return{...Y,currentListVersion:Math.max(U,H)}}else localStorage.removeItem("navigator_restore_in_progress")}const ee={...Y},ce=[...Y.completions,...se.completions],V=new Map;ce.forEach(P=>{if(!P.address||!P.timestamp)return;const W=`${P.address}_v${P.listVersion||1}`,U=V.get(W);if(!U){V.set(W,P);return}const H=new Date(U.timestamp).getTime(),le=new Date(P.timestamp).getTime();!isNaN(le)&&(isNaN(H)||le>H)&&V.set(W,P)}),ee.completions=Array.from(V.values()).sort((P,W)=>new Date(W.timestamp).getTime()-new Date(P.timestamp).getTime()),console.log(`Merged completions: local=${Y.completions.length}, server=${se.completions.length}, resolved=${ee.completions.length}`);const ie=[...Y.arrangements,...se.arrangements],Q=new Map;ie.forEach(P=>{const W=Q.get(P.id);(!W||new Date(P.updatedAt)>new Date(W.updatedAt))&&Q.set(P.id,P)}),ee.arrangements=Array.from(Q.values());const fe=[...Y.daySessions,...se.daySessions],R=new Map;if(fe.forEach(P=>{const W=R.get(P.date);(!W||P.end&&!W.end)&&R.set(P.date,P)}),ee.daySessions=Array.from(R.values()),se.addresses.length>Y.addresses.length){ee.addresses=se.addresses;const P=typeof Y.currentListVersion=="number"?Y.currentListVersion:1,W=typeof se.currentListVersion=="number"?se.currentListVersion:1;ee.currentListVersion=Math.max(P,W)}else{const P=typeof Y.currentListVersion=="number"?Y.currentListVersion:1;ee.currentListVersion=P}return ee.activeIndex=Y.activeIndex??se.activeIndex??null,ee},[]),me=J.useCallback(async()=>{if(E.current="",y.current.lastSyncAt="",y.current.version=0,e&&$e)try{const{data:Y,error:se}=await $e.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle();!se&&Y&&console.log(" FORCE SYNC: Fetched latest state from server")}catch(Y){console.warn("Force sync failed:",Y)}},[e]),ue=J.useCallback(Y=>{if(!e||!$e)return()=>{};F();const se=$e,ve=se.channel("navigator_state_"+e.id);ve.on("postgres_changes",{event:"*",schema:"public",table:"navigator_state",filter:`user_id=eq.${e.id}`},async ce=>{try{const V=ce?.new??ce?.old??null;if(!V)return;const ie=V.updated_at,Q=V.data,fe=V.version||0,R=V.checksum||"";if(V.device_id===y.current.deviceId||fe<=y.current.version)return;const P=Tl(Q);if(R&&R!==P){console.warn("Checksum mismatch, requesting full sync");return}y.current.lastSyncAt=ie,y.current.version=fe,y.current.checksum=R;const W=localStorage.getItem("navigator_restore_in_progress");if(W){const U=parseInt(W),H=Date.now()-U;if(H<3e4){console.log(" RESTORE PROTECTION: Skipping cloud state update to prevent data loss",{timeSinceRestore:`${Math.round(H/1e3)}s`,restoreTime:new Date(U).toISOString()});return}else console.log(" RESTORE PROTECTION: Timeout reached, clearing flag"),localStorage.removeItem("navigator_restore_in_progress")}console.log(" FORCE UPDATE: Applying cloud state update from another device"),typeof Y=="function"?Y(U=>{const H=D3(U,Q),le=H.completions.filter(ge=>!U.completions.some(Ce=>Ce.timestamp===ge.timestamp&&Ce.address===ge.address));return le.length>0&&(console.log(` NEW COMPLETIONS DETECTED: ${le.length} new completion(s) from other device(s)`),le.forEach(ge=>{console.log(`    "${ge.address}" completed at ${new Date(ge.timestamp).toLocaleString()}`)})),E.current=JSON.stringify(H),H}):E.current=JSON.stringify(Q),_(new Date(ie))}catch(V){console.warn("subscribeToData handler error:",V?.message||V),g("Sync error: "+(V?.message||V))}}),ve.subscribe();const ee=()=>{try{se.removeChannel(ve)}catch{}};return D.current=ee,ee},[e,F]);return J.useMemo(()=>({user:e,isLoading:t,isOnline:c,isSyncing:a,error:m,lastSyncTime:x,clearError:F,signIn:G,signUp:I,signOut:N,syncData:q,subscribeToData:ue,queueOperation:M,forceFullSync:me}),[e,t,c,a,m,x,F,G,I,N,q,ue,M,me])}function gm({isOpen:e,onClose:r,title:t,children:n,size:a="md",showCloseButton:l=!0}){J.useEffect(()=>{const m=g=>{g.key==="Escape"&&r()};return e&&(document.addEventListener("keydown",m),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",m),document.body.style.overflow=""}},[e,r]);const c=J.useRef(null);if(J.useEffect(()=>{if(e&&c.current){const g=c.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];g&&g.focus()}},[e]),!e)return null;const d={sm:"modal-sm",md:"modal-md",lg:"modal-lg"};return h.jsx("div",{className:"modal-overlay",onClick:r,children:h.jsxs("div",{ref:c,className:`modal-content ${d[a]}`,onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[t&&h.jsxs("div",{className:"modal-header",children:[h.jsx("h2",{id:"modal-title",className:"modal-title",children:t}),l&&h.jsx("button",{className:"modal-close-btn",onClick:r,"aria-label":"Close modal",children:""})]}),h.jsx("div",{className:"modal-body",children:n})]})})}function O3({isOpen:e,onClose:r,title:t,message:n,type:a="info"}){const c={info:{icon:"",className:"alert-info"},success:{icon:"",className:"alert-success"},warning:{icon:"",className:"alert-warning"},error:{icon:"",className:"alert-error"}}[a];return J.useEffect(()=>{const d=m=>{m.key==="Escape"&&r()};return e&&(document.addEventListener("keydown",d),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",d),document.body.style.overflow=""}},[e,r]),e?h.jsx("div",{className:"modal-overlay",onClick:r,children:h.jsxs("div",{className:`modal-content modal-sm alert-modal ${c.className}`,onClick:d=>d.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[t&&h.jsxs("div",{className:"modal-header",children:[h.jsx("h2",{id:"modal-title",className:"modal-title",children:t}),h.jsx("button",{className:"modal-close-btn",onClick:r,"aria-label":"Close modal",children:""})]}),h.jsxs("div",{className:"modal-body",children:[h.jsxs("div",{className:"alert-content",children:[h.jsx("div",{className:"alert-icon",children:c.icon}),h.jsx("div",{className:"alert-message",children:n})]}),h.jsx("div",{className:"modal-actions",children:h.jsx("button",{className:"btn btn-primary",onClick:r,children:"OK"})})]})]})}):null}function I3({isOpen:e,onConfirm:r,onCancel:t,title:n,message:a,confirmText:l="Confirm",cancelText:c="Cancel",type:d="info"}){const g={danger:{icon:"",confirmClass:"btn-danger"},warning:{icon:"",confirmClass:"btn-warning"},info:{icon:"",confirmClass:"btn-primary"}}[d],x=()=>{r(),t()};return h.jsx(gm,{isOpen:e,onClose:t,title:n,size:"sm",children:h.jsxs("div",{className:"confirm-modal",children:[h.jsxs("div",{className:"confirm-content",children:[h.jsx("div",{className:"confirm-icon",children:g.icon}),h.jsx("div",{className:"confirm-message",children:a})]}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{className:"btn btn-ghost",onClick:t,children:c}),h.jsx("button",{className:`btn ${g.confirmClass}`,onClick:x,children:l})]})]})})}function F3({isOpen:e,onSubmit:r,onCancel:t,title:n,message:a,placeholder:l,defaultValue:c="",inputType:d="text",submitText:m="Submit",cancelText:g="Cancel"}){const[x,_]=J.useState(c);J.useEffect(()=>{e&&_(c)},[e,c]);const y=S=>{S.preventDefault(),x.trim()&&(r(x.trim()),t())};return h.jsx(gm,{isOpen:e,onClose:t,title:n,size:"sm",children:h.jsx("form",{onSubmit:y,children:h.jsxs("div",{className:"prompt-modal",children:[h.jsx("div",{className:"prompt-message",children:a}),h.jsx("input",{name:"modalInput",type:d,value:x,onChange:S=>_(S.target.value),placeholder:l,className:"input",autoFocus:!0,required:!0}),h.jsxs("div",{className:"modal-actions",children:[h.jsx("button",{type:"button",className:"btn btn-ghost",onClick:t,children:g}),h.jsx("button",{type:"submit",className:"btn btn-primary",children:m})]})]})})})}const Dd={alert:{isOpen:!1,options:{message:""}},confirm:{isOpen:!1,options:{message:""}},prompt:{isOpen:!1,options:{message:""}}};function L3(){const[e,r]=J.useState(Dd),t=J.useCallback(m=>new Promise(g=>{r(x=>({...x,alert:{isOpen:!0,options:m,resolve:g}}))}),[]),n=J.useCallback(m=>new Promise(g=>{r(x=>({...x,confirm:{isOpen:!0,options:m,resolve:g}}))}),[]),a=J.useCallback(m=>new Promise(g=>{r(x=>({...x,prompt:{isOpen:!0,options:m,resolve:g}}))}),[]),l=J.useCallback(()=>{r(m=>(m.alert.resolve&&m.alert.resolve(),{...m,alert:{...Dd.alert}}))},[]),c=J.useCallback((m=!1)=>{r(g=>(g.confirm.resolve&&g.confirm.resolve(m),{...g,confirm:{...Dd.confirm}}))},[]),d=J.useCallback((m=null)=>{r(g=>(g.prompt.resolve&&g.prompt.resolve(m),{...g,prompt:{...Dd.prompt}}))},[]);return{alertModal:e.alert,confirmModal:e.confirm,promptModal:e.prompt,alert:t,confirm:n,prompt:a,closeAlert:l,closeConfirm:c,closePrompt:d}}const vy=J.createContext(null);function R3({children:e}){const r=L3();return h.jsxs(vy.Provider,{value:r,children:[e,h.jsx(O3,{isOpen:r.alertModal.isOpen,onClose:r.closeAlert,title:r.alertModal.options.title,message:r.alertModal.options.message,type:r.alertModal.options.type}),h.jsx(I3,{isOpen:r.confirmModal.isOpen,onConfirm:()=>r.closeConfirm(!0),onCancel:()=>r.closeConfirm(!1),title:r.confirmModal.options.title,message:r.confirmModal.options.message,confirmText:r.confirmModal.options.confirmText,cancelText:r.confirmModal.options.cancelText,type:r.confirmModal.options.type}),h.jsx(F3,{isOpen:r.promptModal.isOpen,onSubmit:t=>r.closePrompt(t),onCancel:()=>r.closePrompt(null),title:r.promptModal.options.title,message:r.promptModal.options.message,placeholder:r.promptModal.options.placeholder,defaultValue:r.promptModal.options.defaultValue,inputType:r.promptModal.options.inputType,submitText:r.promptModal.options.submitText,cancelText:r.promptModal.options.cancelText})]})}function j3(){const e=J.useContext(vy);if(!e)throw new Error("useModalContext must be used within a ModalProvider");return e}function M3({onSignIn:e,onSignUp:r,onForceSignOut:t,isLoading:n,error:a,onClearError:l}){const[c,d]=J.useState("signin"),[m,g]=J.useState(""),[x,_]=J.useState(""),[y,S]=J.useState(""),C=async b=>{if(b.preventDefault(),!n){if(!m||!x){alert("Please enter email and password");return}if(c==="signup"&&x!==y){alert("Passwords do not match");return}try{c==="signin"?await e(m,x):await r(m,x)}catch{}}};return J.useEffect(()=>{if(a){const b=setTimeout(()=>{l()},5e3);return()=>clearTimeout(b)}},[a,l]),h.jsx("div",{className:"container",children:h.jsxs("div",{style:{maxWidth:"400px",margin:"2rem auto",padding:"2rem",background:"var(--surface)",borderRadius:"var(--radius-lg)",border:"1px solid var(--border-light)",boxShadow:"var(--shadow-lg)"},children:[h.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem"},children:[h.jsx("h1",{style:{margin:"0 0 0.5rem 0",fontSize:"1.75rem",background:"linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:" Address Navigator"}),h.jsx("p",{style:{margin:0,color:"var(--text-secondary)",fontSize:"0.875rem"},children:c==="signin"?"Sign in to sync across devices":"Create account to get started"})]}),a&&h.jsxs("div",{style:{padding:"0.75rem",marginBottom:"1rem",background:"var(--danger-light)",border:"1px solid var(--danger)",borderRadius:"var(--radius)",color:"var(--danger)",fontSize:"0.875rem"},children:[" ",a]}),h.jsxs("div",{style:{padding:"0.75rem",marginBottom:"1.5rem",background:"var(--primary-light)",border:"1px solid var(--primary)",borderRadius:"var(--radius)",color:"var(--primary-dark)",fontSize:"0.8125rem",textAlign:"center"},children:[" ",h.jsx("strong",{children:"Demo Mode:"})," Use any email/password (6+ chars). Data syncs across browser tabs."]}),h.jsx("div",{style:{marginBottom:"1rem",textAlign:"center"},children:h.jsx("button",{type:"button",onClick:async()=>{try{await t(),l(),g(""),_(""),S("")}catch(b){console.error("Force signout error:",b)}},style:{background:"none",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"0.5rem 1rem",fontSize:"0.75rem",color:"var(--text-secondary)",cursor:"pointer"},children:" Clear Session"})}),h.jsx("form",{onSubmit:C,children:h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"email",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)"},children:" Email"}),h.jsx("input",{id:"email",name:"email",type:"email",value:m,onChange:b=>g(b.target.value),className:"input",placeholder:"your@email.com",disabled:n,required:!0,autoComplete:"email"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"password",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)"},children:" Password"}),h.jsx("input",{id:"password",name:"password",type:"password",value:x,onChange:b=>_(b.target.value),className:"input",placeholder:"Password (6+ characters)",disabled:n,minLength:6,required:!0,autoComplete:c==="signup"?"new-password":"current-password"})]}),c==="signup"&&h.jsxs("div",{children:[h.jsx("label",{htmlFor:"confirmPassword",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:600,color:"var(--text-secondary)"},children:" Confirm Password"}),h.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:y,onChange:b=>S(b.target.value),className:"input",placeholder:"Confirm password",disabled:n,minLength:6,required:!0,autoComplete:"new-password"})]}),h.jsx("button",{type:"submit",className:`btn btn-primary ${n?"pulse":""}`,disabled:n,style:{marginTop:"0.5rem"},children:n?h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"spinner"}),c==="signin"?"Signing in...":"Creating account..."]}):h.jsx(h.Fragment,{children:c==="signin"?" Sign In":" Create Account"})})]})}),h.jsxs("div",{style:{textAlign:"center",marginTop:"1.5rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:[c==="signin"?"Don't have an account?":"Already have an account?"," ",h.jsx("button",{type:"button",onClick:()=>{d(c==="signin"?"signup":"signin"),l()},style:{background:"none",border:"none",color:"var(--primary)",textDecoration:"underline",cursor:"pointer",fontSize:"inherit"},children:c==="signin"?"Sign up":"Sign in"})]}),h.jsxs("div",{style:{marginTop:"1.5rem",padding:"0.75rem",background:"var(--bg-tertiary)",borderRadius:"var(--radius)",fontSize:"0.8125rem",color:"var(--text-muted)",textAlign:"center"},children:[" ",h.jsx("strong",{children:"Tip:"})," The app works offline. Data will sync when you're back online."]})]})})}function B3({address:e,addressIndex:r,onSave:t,onCancel:n}){const a=Tr.useRef(null),[l,c]=Tr.useState(!1),[d,m]=Tr.useState({customerName:"",phoneNumber:"",scheduledDate:new Date().toISOString().slice(0,10),scheduledTime:"",amount:"",notes:""}),[g,x]=Tr.useState({}),_=Tr.useRef(null);Tr.useEffect(()=>{const E=F=>{F.key==="Escape"&&n()};document.addEventListener("keydown",E);try{a.current?.getBoundingClientRect()}catch{}return!(typeof window<"u"&&window.matchMedia&&window.matchMedia("(pointer: coarse)").matches)&&_.current&&setTimeout(()=>_.current?.focus(),120),()=>document.removeEventListener("keydown",E)},[n]);const y=E=>E.replace(/,/g,".").trim(),S=E=>{const D=parseFloat(y(E)||"0");return!E||Number.isNaN(D)||D<=0?(x(F=>({...F,amount:"Please enter a valid payment amount"})),!1):(x(F=>({...F,amount:void 0})),!0)},C=E=>{m(D=>({...D,amount:E})),E?S(E):x(D=>({...D,amount:void 0}))},b=async E=>{if(E&&E.preventDefault(),!l){if(!S(d.amount)){_.current?.focus();return}c(!0);try{const D={addressIndex:r,address:e,customerName:d.customerName,phoneNumber:d.phoneNumber,scheduledDate:d.scheduledDate,scheduledTime:d.scheduledTime,amount:y(d.amount),notes:d.notes,status:"Scheduled"};await t(D)}catch(D){console.error("Error saving arrangement:",D),alert(`Failed to save arrangement: ${D instanceof Error?D.message:"Please try again."}`)}finally{c(!1)}}};return h.jsxs("div",{ref:a,className:"fsaf-overlay",role:"dialog","aria-modal":"true",onClick:E=>{E.target===E.currentTarget&&n()},children:[h.jsxs("div",{className:"fsaf-modal",children:[h.jsxs("header",{className:"fsaf-header",children:[h.jsx("h2",{className:"fsaf-title",children:"Create Payment Arrangement"}),h.jsx("button",{type:"button",className:"fsaf-close","aria-label":"Close",onClick:n,title:"Close (Esc)",children:""})]}),h.jsx("div",{className:"fsaf-subtitle",children:e}),h.jsxs("form",{className:"fsaf-body",onSubmit:b,children:[h.jsxs("div",{className:"fsaf-form-section",children:[h.jsxs("div",{className:"fsaf-field",children:[h.jsx("label",{className:"fsaf-label",htmlFor:"fsaf-amount",children:"Payment Amount *"}),h.jsx("input",{ref:_,id:"fsaf-amount",name:"fsafAmount",type:"text",inputMode:"decimal",pattern:"[0-9]*[.,]?[0-9]*",value:d.amount,onChange:E=>C(E.target.value),onFocus:E=>{try{window.matchMedia&&window.matchMedia("(pointer: coarse)").matches&&setTimeout(()=>E.currentTarget.scrollIntoView({block:"center",behavior:"smooth"}),50)}catch{}},className:`fsaf-input ${g.amount?"fsaf-input-error":""}`,placeholder:"0.00",required:!0,"aria-describedby":g.amount?"amount-error":void 0,autoComplete:"off"}),g.amount&&h.jsx("div",{id:"amount-error",className:"fsaf-error",role:"alert",children:g.amount})]}),h.jsxs("div",{className:"fsaf-row",children:[h.jsxs("div",{className:"fsaf-field",children:[h.jsx("label",{className:"fsaf-label",htmlFor:"fsaf-customer-name",children:"Customer Name"}),h.jsx("input",{id:"fsaf-customer-name",name:"fsafCustomerName",type:"text",value:d.customerName,onChange:E=>m(D=>({...D,customerName:E.target.value})),className:"fsaf-input",placeholder:"Customer name",autoComplete:"name"})]}),h.jsxs("div",{className:"fsaf-field",children:[h.jsx("label",{className:"fsaf-label",htmlFor:"fsaf-phone-number",children:"Phone Number"}),h.jsx("input",{id:"fsaf-phone-number",name:"fsafPhoneNumber",type:"tel",value:d.phoneNumber,onChange:E=>m(D=>({...D,phoneNumber:E.target.value})),className:"fsaf-input",placeholder:"Phone number",autoComplete:"tel"})]})]}),h.jsxs("div",{className:"fsaf-row",children:[h.jsxs("div",{className:"fsaf-field",children:[h.jsx("label",{className:"fsaf-label",htmlFor:"fsaf-scheduled-date",children:"Payment Due Date *"}),h.jsx("input",{id:"fsaf-scheduled-date",name:"fsafScheduledDate",type:"date",value:d.scheduledDate,onChange:E=>m(D=>({...D,scheduledDate:E.target.value})),className:"fsaf-input",required:!0,autoComplete:"off"})]}),h.jsxs("div",{className:"fsaf-field",children:[h.jsx("label",{className:"fsaf-label",htmlFor:"fsaf-scheduled-time",children:"Time"}),h.jsx("input",{id:"fsaf-scheduled-time",name:"fsafScheduledTime",type:"time",value:d.scheduledTime,onChange:E=>m(D=>({...D,scheduledTime:E.target.value})),className:"fsaf-input",autoComplete:"off"})]})]}),h.jsxs("div",{className:"fsaf-field",children:[h.jsx("label",{className:"fsaf-label",htmlFor:"fsaf-notes",children:"Notes"}),h.jsx("textarea",{id:"fsaf-notes",value:d.notes,onChange:E=>m(D=>({...D,notes:E.target.value})),className:"fsaf-input fsaf-textarea",rows:4,placeholder:"Payment terms, special instructions, etc..."})]})]}),h.jsxs("div",{className:"fsaf-actions",children:[h.jsx("button",{type:"button",className:"fsaf-btn fsaf-btn-ghost",onClick:n,children:"Cancel"}),h.jsx(Ei,{type:"submit",className:"fsaf-btn fsaf-btn-primary",isLoading:l,loadingText:"Creating...",disabled:!!g.amount,children:"Create Arrangement"})]})]})]}),h.jsx("style",{children:`
        .fsaf-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 4000;
          display: flex;
          align-items: flex-start;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          overflow-y: auto;
          padding-top: 2rem;
        }
        
        .fsaf-modal {
          background: var(--surface, #ffffff);
          border-radius: 16px;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
          width: 100%;
          max-width: 500px;
          max-height: 90vh;
          display: flex;
          flex-direction: column;
          color: var(--text-primary, #1e293b);
          overflow: hidden;
          margin: 0 auto;
          position: relative;
        }
        
        .fsaf-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem 1.5rem 0.75rem;
          border-bottom: 1px solid var(--border-light, #e2e8f0);
        }
        
        .fsaf-title {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary, #1e293b);
        }
        
        .fsaf-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          padding: 0.5rem;
          border-radius: 8px;
          cursor: pointer;
          color: var(--text-muted, #64748b);
          line-height: 1;
        }
        .fsaf-close:hover {
          background: var(--bg-secondary, #f1f5f9);
        }
        
        .fsaf-subtitle {
          padding: 0 1.5rem 0.75rem;
          font-size: 0.9rem;
          color: var(--text-secondary, #64748b);
          border-bottom: 1px solid var(--border-light, #e2e8f0);
        }

        .fsaf-body {
          padding: 1.5rem;
          overflow-y: auto;
          flex: 1 1 auto;
        }
        
        .fsaf-form-section {
          display: grid;
          gap: 1rem;
        }
        
        .fsaf-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
          align-items: start;
        }
        
        .fsaf-field {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }
        
        .fsaf-label {
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary, #64748b);
        }
        
        .fsaf-input {
          border: 1px solid var(--border-light, #e2e8f0);
          border-radius: 8px;
          padding: 0.75rem;
          font: inherit;
          font-size: 14px;
          background: var(--surface, #fff);
          transition: box-shadow .15s ease, border-color .15s ease;
        }
        
        .fsaf-input::placeholder {
          color: #94a3b8;
        }
        
        .fsaf-input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14,165,233,0.15);
        }
        
        .fsaf-textarea {
          resize: vertical;
          min-height: 80px;
        }
        
        .fsaf-input-error {
          border-color: var(--danger, #dc2626);
        }
        
        .fsaf-error {
          color: var(--danger, #dc2626);
          font-size: 0.8125rem;
          margin-top: 0.25rem;
        }

        .fsaf-actions {
          display: flex;
          gap: 0.75rem;
          justify-content: flex-end;
          padding-top: 1rem;
          border-top: 1px solid var(--border-light, #e2e8f0);
        }
        
        .fsaf-btn {
          border-radius: 8px;
          min-height: 40px;
          padding: 0.75rem 1.5rem;
          font-weight: 600;
          border: 1px solid transparent;
          cursor: pointer;
          transition: all .15s ease;
          font-size: 14px;
        }
        
        .fsaf-btn-ghost {
          background: #ffffff;
          border-color: var(--border-light, #e2e8f0);
          color: var(--text-primary, #1e293b);
        }
        .fsaf-btn-ghost:hover {
          background: var(--bg-secondary, #f1f5f9);
        }
        
        .fsaf-btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
          box-shadow: 0 4px 12px -4px rgba(14,165,233,0.4);
        }
        .fsaf-btn-primary:hover {
          background: #0284c7;
          box-shadow: 0 6px 16px -4px rgba(14,165,233,0.5);
        }
        
        .fsaf-btn:active {
          transform: translateY(1px);
        }

        @media (max-width: 640px) {
          .fsaf-modal {
            margin: 0.5rem;
            max-width: none;
          }
          
          .fsaf-row {
            grid-template-columns: 1fr;
          }
          
          .fsaf-actions {
            flex-direction: column-reverse;
          }
          
          .fsaf-btn {
            width: 100%;
            justify-content: center;
          }
        }
      `})]})}function z3(e){return typeof e.lat=="number"&&typeof e.lng=="number"&&!Number.isNaN(e.lat)&&!Number.isNaN(e.lng)?`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(`${e.lat},${e.lng}`)}`:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e?.address??"")}`}const U3=function({state:r,setActive:t,cancelActive:n,onComplete:a,onAddArrangement:l,filterText:c}){const d=Array.isArray(r.addresses)?r.addresses:[],m=Array.isArray(r.completions)?r.completions:[],g=r.activeIndex,x=J.useMemo(()=>{const Z=new Set;return d.forEach((me,ue)=>{if(!me.address)return;m.some(se=>se.address===me.address&&(se.listVersion||r.currentListVersion)===r.currentListVersion)&&Z.add(ue)}),Z},[m,d,r.currentListVersion]),_=(c??"").trim().toLowerCase(),y=J.useMemo(()=>d.map((Z,me)=>({a:Z,i:me})).filter(({a:Z})=>!_||(Z.address??"").toLowerCase().includes(_)).filter(({i:Z})=>!x.has(Z)),[d,_,x]),[S,C]=J.useState(null),[b,E]=J.useState(""),[D,F]=J.useState(null),O=J.useRef(null),[M,G]=J.useState(null),[I,N]=J.useState(null);J.useEffect(()=>{g===null&&(C(null),E(""),N(null),F(null))},[g]);const q=J.useCallback(async(Z,me,ue,Y)=>{if(O.current===Z)return;const se=Date.now();if(!(M&&M.index===Z&&M.outcome===me&&se-M.timestamp<2e3))try{O.current=Z,F(Z),G({index:Z,outcome:me,timestamp:se}),await a(Z,me,ue,Y),C(null)}catch(ve){console.error("Completion failed:",ve)}finally{O.current=null,F(null)}},[M,a]);return y.length===0?h.jsxs("div",{className:"empty-state",children:[h.jsx("div",{className:"empty-icon",children:""}),h.jsx("div",{className:"empty-title",children:"No Pending Addresses"}),h.jsx("div",{className:"empty-message",children:"Import an Excel file or add addresses manually to get started"})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{className:"address-list-modern",children:y.map(({a:Z,i:me},ue)=>{const Y=g===me,se=z3(Z);return h.jsxs("div",{className:`address-card-modern ${Y?"active":""}`,children:[h.jsxs("div",{className:"address-header-modern",children:[h.jsxs("div",{className:"address-content",children:[h.jsx("div",{className:"address-number",children:ue+1}),h.jsxs("div",{className:"address-info",children:[h.jsx("div",{className:"address-title",title:Z.address,children:Z.address}),h.jsxs("div",{className:"address-meta",children:[h.jsxs("div",{className:"address-meta-item",children:[h.jsx("span",{children:""}),h.jsxs("span",{children:["Index #",me+1]})]}),Z.lat&&Z.lng&&h.jsxs("div",{className:"address-meta-item",children:[h.jsx("span",{children:""}),h.jsx("span",{children:"Coordinates ready"})]})]})]})]}),h.jsxs("div",{className:`address-status-badge ${Y?"status-active":"status-pending"}`,children:[Y&&h.jsx("span",{children:""}),Y?"Active":"Pending"]})]}),h.jsxs("div",{className:"address-actions-modern",children:[h.jsxs("a",{className:"action-btn-modern btn-navigate",href:se,target:"_blank",rel:"noreferrer",title:"Open in Google Maps",onClick:()=>{},children:[h.jsx("span",{children:""}),h.jsx("span",{children:"Navigate"})]}),Y?h.jsxs(h.Fragment,{children:[h.jsxs("button",{className:"action-btn-modern btn-complete",onClick:()=>{C(S!==me?me:null),E("")},children:[h.jsx("span",{children:""}),h.jsx("span",{children:"Complete"})]}),h.jsxs("button",{className:"action-btn-modern",style:{background:"var(--gray-100)",color:"var(--gray-600)"},onClick:n,children:[h.jsx("span",{children:""}),h.jsx("span",{children:"Cancel"})]})]}):h.jsxs("button",{className:"action-btn-modern btn-set-active",onClick:()=>t(me),children:[h.jsx("span",{children:""}),h.jsx("span",{children:"Set Active"})]})]}),Y&&S===me&&h.jsxs("div",{className:"outcome-panel-modern",children:[h.jsx("div",{className:"outcome-header",children:h.jsx("span",{className:"outcome-title",children:"Select Outcome"})}),h.jsxs("div",{className:"outcome-buttons",children:[h.jsxs("button",{className:"outcome-btn outcome-done",disabled:D===me,onClick:()=>q(me,"Done"),title:"Mark as Done",children:[h.jsx("span",{className:"outcome-icon",children:""}),h.jsx("span",{className:"outcome-label",children:"Done"})]}),h.jsxs("button",{className:"outcome-btn outcome-da",disabled:D===me,onClick:()=>q(me,"DA"),title:"Mark as DA",children:[h.jsx("span",{className:"outcome-icon",children:""}),h.jsx("span",{className:"outcome-label",children:"DA"})]}),h.jsxs("button",{className:"outcome-btn outcome-arr",onClick:()=>{C(null),N(me)},title:"Create arrangement",children:[h.jsx("span",{className:"outcome-icon",children:""}),h.jsx("span",{className:"outcome-label",children:"Arrangement"})]})]}),h.jsx("div",{className:"pif-section",children:h.jsxs("div",{className:"pif-input-group",children:[h.jsx("span",{className:"pif-label",children:" PIF Amount:"}),h.jsx("input",{id:`pif-amount-${me}`,name:`pifAmount-${me}`,type:"number",step:"0.01",min:"0",inputMode:"decimal",className:"pif-input",placeholder:"0.00",value:b,onChange:ve=>E(ve.target.value),autoComplete:"off"}),h.jsxs("button",{className:"outcome-btn outcome-pif",disabled:D===me,onClick:()=>{const ve=Number(b);if(!Number.isFinite(ve)||ve<=0){alert("Enter a valid PIF amount (e.g. 50)");return}q(me,"PIF",ve.toFixed(2))},children:[h.jsx("span",{className:"outcome-icon",children:""}),h.jsx("span",{className:"outcome-label",children:"Save PIF"})]})]})}),D===me&&h.jsxs("div",{className:"outcome-loading",children:[h.jsx("span",{className:"spinner-small"}),h.jsx("span",{children:"Processing..."})]})]})]},me)})}),I!==null&&l&&d[I]&&h.jsx(B3,{address:d[I].address,addressIndex:I,onSave:async Z=>{await l(Z),q(I,"ARR"),N(null)},onCancel:()=>N(null)}),h.jsx("style",{children:`
        /* Modern Outcome Panel Styles */
        .outcome-panel-modern {
          background: var(--gray-50);
          border: 2px solid var(--primary);
          border-radius: var(--radius-lg);
          padding: 1rem;
          margin-top: 1rem;
          animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .outcome-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .outcome-title {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-buttons {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .outcome-btn {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 0.25rem;
          padding: 0.75rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: var(--transition-normal);
          position: relative;
          overflow: hidden;
        }

        .outcome-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(100%);
          transition: transform 0.3s ease;
        }

        .outcome-btn:hover::before {
          transform: translateY(0);
        }

        .outcome-btn:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .outcome-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .outcome-icon {
          font-size: 1.25rem;
        }

        .outcome-label {
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-done {
          background: var(--success);
          color: white;
        }

        .outcome-da {
          background: var(--danger);
          color: white;
        }

        .outcome-arr {
          background: var(--warning);
          color: white;
        }

        .outcome-pif {
          background: var(--primary);
          color: white;
        }

        .pif-section {
          padding-top: 1rem;
          border-top: 1px solid var(--gray-200);
        }

        .pif-input-group {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .pif-label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .pif-input {
          flex: 1;
          padding: 0.625rem 0.75rem;
          border: 2px solid var(--gray-200);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
          font-weight: 600;
          text-align: right;
          transition: var(--transition-normal);
        }

        .pif-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        .outcome-loading {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem;
          color: var(--gray-600);
          font-size: 0.875rem;
        }

        .spinner-small {
          width: 16px;
          height: 16px;
          border: 2px solid var(--gray-300);
          border-top-color: var(--primary);
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .outcome-buttons {
            grid-template-columns: 1fr;
          }

          .pif-input-group {
            flex-direction: column;
            align-items: stretch;
          }

          .outcome-btn {
            flex-direction: row;
            justify-content: center;
            gap: 0.5rem;
          }
        }
      `})]})},$3=J.memo(U3),W3="Europe/London";function gs(e,r=W3){const t=e.toLocaleDateString("en-GB",{timeZone:r,year:"numeric"}),n=e.toLocaleDateString("en-GB",{timeZone:r,month:"2-digit"}),a=e.toLocaleDateString("en-GB",{timeZone:r,day:"2-digit"});return t+"-"+n+"-"+a}function D0(e){const r=e.split("-");return new Date(Number(r[0]),Number(r[1])-1,Number(r[2]))}function Md(e,r){const t=new Date(e.getTime());return t.setDate(t.getDate()+r),t}function Od(e){return new Date(e.getFullYear(),e.getMonth(),1)}function i0(e,r){return e===r}function H3(e,r,t){return e>=r&&e<=t}function Zv(e){return(e/3600).toFixed(2)}function V3(e){const r=e;if(typeof r.durationSeconds=="number")return Math.max(0,r.durationSeconds);if(e.start&&e.end)try{const t=new Date(e.start).getTime(),n=new Date(e.end).getTime();if(isFinite(t)&&isFinite(n)&&n>t)return Math.floor((n-t)/1e3)}catch{}return 0}function G3(e,r){if(!e||!r)return[];const t=D0(e),n=D0(r);if(!(t<=n))return[e];const a=[];let l=new Date(t.getTime());for(;l<=n;)a.push(gs(l)),l=Md(l,1);return a}function Z3({startKey:e,endKey:r,onChange:t}){const n=D0(r||e||gs(new Date)),[a,l]=J.useState(Od(n)),[c,d]=J.useState(!1);function m(D){const F=Od(D),M=(F.getDay()+6)%7,G=Md(F,-M),I=[];for(let N=0;N<42;N++){const q=Md(G,N);I.push({key:gs(q),inMonth:q.getMonth()===D.getMonth(),date:q})}return I}const g=m(a),x=a.toLocaleDateString("en-GB",{month:"long"})+" "+String(a.getFullYear()),_=e<=r?e:r,y=e<=r?r:e,S=gs(new Date);function C(){l(new Date(a.getFullYear(),a.getMonth()-1,1))}function b(){l(new Date(a.getFullYear(),a.getMonth()+1,1))}function E(D){if(!c){t(D,D),d(!0);return}let F=e||D,O=D;if(O<F){const M=F;F=O,O=M}t(F,O),d(!1)}return h.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[h.jsx("button",{className:"btn btn-ghost",onClick:C,"aria-label":"Previous month",children:"Prev"}),h.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:x}),h.jsx("button",{className:"btn btn-ghost",onClick:b,"aria-label":"Next month",children:"Next"})]}),h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,fontSize:12,color:"var(--text-secondary)",textAlign:"center",marginBottom:4},children:[h.jsx("div",{children:"Mon"}),h.jsx("div",{children:"Tue"}),h.jsx("div",{children:"Wed"}),h.jsx("div",{children:"Thu"}),h.jsx("div",{children:"Fri"}),h.jsx("div",{children:"Sat"}),h.jsx("div",{children:"Sun"})]}),h.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:g.map(D=>{const F=H3(D.key,_,y),O=i0(D.key,e),M=i0(D.key,r),G=i0(D.key,S),I={padding:"0.5rem 0",borderRadius:8,border:"1px solid var(--border-light)",background:F?"var(--surface-strong)":"var(--surface)",textAlign:"center",cursor:"pointer",opacity:D.inMonth?1:.45,position:"relative",userSelect:"none"},N={position:"absolute",top:6,right:6,width:6,height:6,borderRadius:6,background:G?"currentColor":"transparent",opacity:G?.7:0},q={position:"absolute",inset:0,borderRadius:8,border:O||M?"2px solid var(--primary, #4f46e5)":"2px solid transparent",pointerEvents:"none"};return h.jsxs("div",{style:I,title:D.key,onClick:()=>E(D.key),children:[h.jsx("div",{style:{fontWeight:O||M?700:500,color:"var(--text-primary)"},children:String(D.date.getDate())}),h.jsx("div",{style:N}),h.jsx("div",{style:q})]},D.key)})}),h.jsxs("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:[h.jsx("button",{className:"btn btn-ghost",onClick:()=>{const D=gs(new Date);t(D,D),l(Od(new Date)),d(!1)},children:"Today"}),h.jsx("button",{className:"btn btn-ghost",onClick:()=>{const D=new Date,F=Md(new Date,-6);t(gs(F),gs(D)),l(Od(D)),d(!1)},children:"Last 7 days"})]})]})}function K3(e,r){const t=e,n=[t.date,t.day,t.at,t.timestamp,t.completedAt,t.created_at];for(const l of n){if(!l)continue;const c=new Date(l);if(!Number.isNaN(c.getTime()))return c.toISOString().slice(0,10)}const a=new Set(r.map(l=>l.date));return a.size===1&&Array.from(a)[0]||null}function q3({state:e,onChangeOutcome:r}){const{addresses:t,completions:n,daySessions:a,arrangements:l}=e,[c,d]=J.useState(null),[m,g]=J.useState(""),x=a.length>0?a[a.length-1].date:gs(new Date),[_,y]=J.useState(x),[S,C]=J.useState(x),[b,E]=J.useState(!1),D=J.useMemo(()=>{const ue=new Map;for(const Y of a){const se=Y.date;if(!se)continue;const ve=ue.get(se)||0;ue.set(se,ve+V3(Y))}return ue},[a]),F=J.useMemo(()=>{const ue=new Map;return n.forEach((Y,se)=>{const ve=K3(Y,a);if(!ve)return;const ee=ue.get(ve);ee?ee.push(se):ue.set(ve,[se])}),ue},[n,a]),O=G3(_,S);let M=0,G=0,I=0,N=0;O.forEach(ue=>{M+=D.get(ue)||0;const Y=F.get(ue)||[];G+=Y.length,I+=Y.map(se=>n[se]).filter(se=>se.outcome==="PIF").length,N+=Y.map(se=>n[se]).filter(se=>se.outcome==="DA").length});const[q,Z]=J.useState({});function me(ue){Z(Y=>({...Y,[ue]:!Y[ue]}))}return h.jsxs("div",{children:[h.jsx("div",{style:{marginBottom:"0.9rem"},children:h.jsx(Z3,{startKey:_,endKey:S,onChange:(ue,Y)=>{y(ue),C(Y)}})}),h.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"12px",padding:"1rem",boxShadow:"var(--shadow-sm)",marginBottom:"1rem"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",marginBottom:8,flexWrap:"wrap"},children:[h.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:"Summary "+(_===S?"("+_+")":"("+_+" -> "+S+")")}),h.jsx("button",{className:"btn btn-ghost",onClick:()=>E(ue=>!ue),children:b?"Hide details":"View details"})]}),h.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[h.jsxs("span",{className:"pill",children:["Hours ",Zv(M)]}),h.jsxs("span",{className:"pill pill-done",children:["Completed ",G]}),h.jsxs("span",{className:"pill pill-pif",children:["PIF ",I]}),h.jsxs("span",{className:"pill pill-da",children:["DA ",N]})]})]}),b&&h.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:O.map(ue=>{const Y=D.get(ue)||0,se=F.get(ue)||[],ve=se.map(ie=>n[ie]).filter(ie=>ie.outcome==="PIF").length,ee=se.map(ie=>n[ie]).filter(ie=>ie.outcome==="DA").length,ce=se.map(ie=>n[ie]).filter(ie=>ie.outcome==="ARR").length,V=se.length;return h.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[h.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},children:[h.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",flexWrap:"wrap"},children:[h.jsx("strong",{children:ue}),h.jsxs("span",{className:"pill",children:["Hours ",Zv(Y)]}),h.jsxs("span",{className:"pill pill-done",children:["Completed ",V]}),h.jsxs("span",{className:"pill pill-pif",children:["PIF ",ve]}),h.jsxs("span",{className:"pill pill-da",children:["DA ",ee]}),ce>0&&h.jsxs("span",{className:"pill pill-arr",children:["ARR ",ce]})]}),h.jsx("button",{className:"btn btn-ghost",onClick:()=>me(ue),children:q[ue]?"Hide":"View"})]}),q[ue]&&h.jsx("div",{style:{marginTop:"0.75rem"},children:se.length===0?h.jsx("div",{style:{fontSize:14,color:"var(--text-secondary)"},children:"No entries for this day."}):h.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:se.map(ie=>{const Q=n[ie],fe=t[Q.index],R=fe&&fe.address||fe&&fe.name||(typeof Q.index=="number"?"Address #"+Q.index:"Address"),P=Q.outcome,W=Q.arrangementId?l.find(U=>U.id===Q.arrangementId):null;return h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",alignItems:"center",border:"1px dashed var(--border-light)",borderRadius:10,padding:"0.5rem 0.75rem"},children:[h.jsxs("div",{style:{minWidth:0},children:[h.jsx("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-primary)"},children:R}),h.jsxs("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:["Index "+String(Q.index),Q.outcome==="PIF"&&h.jsx("span",{style:{marginLeft:8,display:"inline-flex",alignItems:"center",gap:4},children:c===ie?h.jsxs(h.Fragment,{children:[h.jsx("span",{children:" "}),h.jsx("label",{htmlFor:`pif-amount-${ie}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"PIF Amount"}),h.jsx("input",{id:`pif-amount-${ie}`,name:"pifAmount",type:"number",step:"0.01",min:"0",inputMode:"decimal",style:{width:70,padding:"2px 4px",fontSize:12,border:"1px solid var(--border)",borderRadius:3,background:"var(--surface)"},value:m,onChange:U=>g(U.target.value),onKeyDown:U=>{if(U.key==="Enter"){const H=parseFloat(m);isFinite(H)&&H>=0&&(r(ie,"PIF",H.toFixed(2)),d(null),g(""))}else U.key==="Escape"&&(d(null),g(""))},autoFocus:!0}),h.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--success)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{const U=parseFloat(m);isFinite(U)&&U>=0&&(r(ie,"PIF",U.toFixed(2)),d(null),g(""))},children:""}),h.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--danger)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{d(null),g("")},children:""})]}):h.jsxs(h.Fragment,{children:[h.jsxs("span",{children:[" ",Q.amount||"0.00"]}),h.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--primary)",color:"white",border:"none",borderRadius:3,cursor:"pointer",marginLeft:4},onClick:()=>{d(ie),g(Q.amount||"")},title:"Edit PIF amount",children:""})]})}),W&&h.jsxs(h.Fragment,{children:[h.jsx("br",{}),h.jsxs("span",{style:{color:"var(--primary)",fontSize:"0.75rem"},children:[" From arrangement",W.customerName&&` (${W.customerName})`,Q.outcome==="Done"&&"  Defaulted",Q.outcome==="PIF"&&W.recurrenceType&&W.recurrenceType!=="none"&&`  ${W.recurrenceType==="weekly"?"Weekly":"Monthly"} payment`]})]})]})]}),h.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[h.jsx("label",{htmlFor:`outcome-${ie}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"Outcome"}),h.jsxs("select",{id:`outcome-${ie}`,name:`outcome-${ie}`,value:P||"",onChange:U=>r(ie,U.target.value,Q.amount),className:"input",style:{padding:"0.25rem 0.5rem",height:32},children:[h.jsx("option",{value:"",children:"-"}),h.jsx("option",{value:"Done",children:W?"Done (Defaulted)":"Done"}),h.jsx("option",{value:"PIF",children:W?"PIF (Arrangement)":"PIF"}),h.jsx("option",{value:"DA",children:"DA"}),h.jsx("option",{value:"ARR",children:"ARR"})]})]})]},ie)})})})]},ue)})})]})}const Y3=()=>{const[e,r]=J.useState(!1),t=J.useRef(null);return{isLoading:e,executeBackup:async l=>{if(e){console.warn("Backup already in progress, ignoring duplicate request");return}r(!0),t.current=setTimeout(()=>{console.error("Backup timeout reached - forcing reset"),r(!1)},6e4);try{await l(),console.log("Backup completed successfully")}catch(c){throw console.error("Backup failed:",c),c}finally{t.current&&(clearTimeout(t.current),t.current=null),r(!1)}},forceReset:()=>{console.warn("Force resetting backup loading state"),t.current&&(clearTimeout(t.current),t.current=null),r(!1)}}},xy=["Reminder: Please arrange payment by end of day to avoid further action.","Friendly reminder: Your arrangement is due. Contact us to confirm.","Action required: Settle outstanding balance today for compliance.","Update: Payment arrangement needed. Reply to reschedule if required."],Id={backupOnEndOfDay:!1,reminderText:xy[0],darkMode:!1,pushNotifications:!0,autoSyncOnStart:!0},Kv="navigator-web:settings",yy=()=>{const[e,r]=J.useState(()=>{if(typeof window<"u")try{const m=localStorage.getItem(Kv);return m?{...Id,...JSON.parse(m)}:Id}catch{return Id}return Id});J.useEffect(()=>{typeof window<"u"&&localStorage.setItem(Kv,JSON.stringify(e))},[e]),J.useEffect(()=>{e.darkMode?(document.documentElement.classList.add("dark-mode"),document.body.style.background="linear-gradient(135deg, #1f2937 0%, #111827 100%)"):(document.documentElement.classList.remove("dark-mode"),document.body.style.background="linear-gradient(135deg, #667eea 0%, #764ba2 100%)")},[e.darkMode]);const t=m=>{r(g=>({...g,...m}))};return{settings:e,updateSettings:t,toggleBackup:()=>t({backupOnEndOfDay:!e.backupOnEndOfDay}),toggleDarkMode:()=>t({darkMode:!e.darkMode}),togglePushNotifications:()=>t({pushNotifications:!e.pushNotifications}),toggleAutoSync:()=>t({autoSyncOnStart:!e.autoSyncOnStart}),updateReminderText:m=>t({reminderText:m}),predefinedReminders:xy}};function qv(e,r){const[t,n,a]=e.split("-").map(Number),[l,c]=r.split(":").map(Number);try{return new Date(t,(n||1)-1,a||1,l||0,c||0).toISOString()}catch{return""}}function Yv(e){if(!e)return"";try{return new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Europe/London"})}catch{return""}}function Fd(e){if(!e)return"";try{const r=new Date(e),t=String(r.getHours()).padStart(2,"0"),n=String(r.getMinutes()).padStart(2,"0");return`${t}:${n}`}catch{return""}}function Xv(e){if(!e)return"";try{const r=new Date(e),t=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${t}-${n}-${a}`}catch{return""}}function X3({sessions:e,completions:r,startDay:t,endDay:n,onEditStart:a,onEditEnd:l,onBackup:c}){const{settings:d}=yy(),{isLoading:m,executeBackup:g,forceReset:x}=Y3(),_=new Date().toISOString().slice(0,10),y=e.filter(V=>V.date===_),S=y.find(V=>!V.end)||null,C=S||y.slice().sort((V,ie)=>{const Q=new Date(V.start||V.date+"T00:00:00.000Z").getTime();return new Date(ie.start||ie.date+"T00:00:00.000Z").getTime()-Q})[0],b=!!S,E=async()=>{try{d.backupOnEndOfDay&&c&&await g(c),n()}catch(V){console.error("Failed to complete backup during end day:",V),n()}},F=r.filter(V=>(V.timestamp||"").slice(0,10)===_).reduce((V,ie)=>((ie.outcome==="PIF"||ie.outcome==="DA"||ie.outcome==="Done"||ie.outcome==="ARR")&&(V[ie.outcome]+=1),V),{PIF:0,DA:0,Done:0,ARR:0}),[O,M]=J.useState(!1),[G,I]=J.useState(_),[N,q]=J.useState(()=>{if(C?.start)return Fd(C.start);const V=new Date;return`${String(V.getHours()).padStart(2,"0")}:${String(V.getMinutes()).padStart(2,"0")}`});J.useEffect(()=>{if(C?.start)I(Xv(C.start)||C.date),q(Fd(C.start));else{I(_);const V=new Date;q(`${String(V.getHours()).padStart(2,"0")}:${String(V.getMinutes()).padStart(2,"0")}`)}},[C?.start,C?.date,_]);const Z=J.useCallback(()=>{const V=qv(G,N);V&&a(V),M(!1)},[G,N,a]),[me,ue]=J.useState(!1),[Y,se]=J.useState(_),[ve,ee]=J.useState(()=>{if(C?.end)return Fd(C.end);const V=new Date;return`${String(V.getHours()).padStart(2,"0")}:${String(V.getMinutes()).padStart(2,"0")}`});J.useEffect(()=>{if(C?.end)se(Xv(C.end)||C.date),ee(Fd(C.end));else{se(_);const V=new Date;ee(`${String(V.getHours()).padStart(2,"0")}:${String(V.getMinutes()).padStart(2,"0")}`)}},[C?.end,C?.date,_]);const ce=J.useCallback(()=>{const V=qv(Y,ve);V&&l(V),ue(!1)},[Y,ve,l]);return h.jsxs("div",{className:`day-panel-modern ${b?"day-panel-active":""}`,children:[h.jsxs("div",{className:"day-panel-header",children:[h.jsxs("div",{className:"day-status",children:[h.jsx("div",{className:"day-status-icon",children:b?"":C?"":""}),h.jsxs("div",{className:"day-status-text",children:[h.jsx("div",{className:"day-status-title",children:b?"Day Running":C?"Day Completed":"No Session Today"}),h.jsx("div",{className:"day-status-subtitle",children:C?.start?h.jsxs(h.Fragment,{children:[Yv(C.start),C?.end&&h.jsxs(h.Fragment,{children:["  ",Yv(C.end)]}),b&&!C?.end&&h.jsxs(h.Fragment,{children:["  ",h.jsx("span",{style:{color:"var(--success)"},children:"Active"})]})]}):"Click 'Start Day' to begin tracking"})]})]}),h.jsxs("div",{className:"day-stats-modern",children:[h.jsxs("div",{className:"stat-pill stat-pill-pif",children:[h.jsx("span",{className:"stat-number",children:F.PIF}),h.jsx("span",{className:"stat-label",children:"PIF"})]}),h.jsxs("div",{className:"stat-pill stat-pill-done",children:[h.jsx("span",{className:"stat-number",children:F.Done}),h.jsx("span",{className:"stat-label",children:"Done"})]}),h.jsxs("div",{className:"stat-pill stat-pill-da",children:[h.jsx("span",{className:"stat-number",children:F.DA}),h.jsx("span",{className:"stat-label",children:"DA"})]}),h.jsxs("div",{className:"stat-pill stat-pill-arr",children:[h.jsx("span",{className:"stat-number",children:F.ARR}),h.jsx("span",{className:"stat-label",children:"ARR"})]})]})]}),h.jsxs("div",{className:"day-panel-actions",children:[h.jsx("div",{className:"primary-actions",children:b?h.jsxs("button",{className:"btn btn-danger btn-modern",onClick:E,disabled:m,children:[h.jsx("span",{className:"btn-icon",children:m?"":""}),m?"Ending Day...":"End Day"]}):h.jsxs("button",{className:"btn btn-primary btn-modern",onClick:t,children:[h.jsx("span",{className:"btn-icon",children:""}),"Start Day"]})}),h.jsxs("div",{className:"edit-actions",children:[O?h.jsxs("div",{className:"day-edit-group",children:[h.jsx("input",{id:"start-date",name:"startDate",type:"date",className:"input input-sm",value:G,onChange:V=>I(V.target.value),autoComplete:"off"}),h.jsx("input",{id:"start-time",name:"startTime",type:"time",className:"input input-sm",value:N,onChange:V=>q(V.target.value),autoComplete:"off"}),h.jsx("button",{className:"btn btn-primary btn-sm",onClick:Z,children:""}),h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>M(!1),children:""})]}):h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>M(!0),title:"Edit today's start time",children:" Edit start"}),me?h.jsxs("div",{className:"day-edit-group",children:[h.jsx("input",{id:"end-date",name:"endDate",type:"date",className:"input input-sm",value:Y,onChange:V=>se(V.target.value),autoComplete:"off"}),h.jsx("input",{id:"end-time",name:"endTime",type:"time",className:"input input-sm",value:ve,onChange:V=>ee(V.target.value),autoComplete:"off"}),h.jsx("button",{className:"btn btn-primary btn-sm",onClick:ce,children:""}),h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ue(!1),children:""})]}):h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ue(!0),title:"Edit today's finish time",children:" Edit finish"})]})]}),h.jsx(gm,{isOpen:m,onClose:()=>{console.warn("Emergency backup escape triggered by user"),x()},title:"Backing up data",showCloseButton:!0,size:"sm",children:h.jsx("div",{className:"backup-loading-modal",children:h.jsxs("div",{className:"backup-loading-content",children:[h.jsx(DA,{size:"lg"}),h.jsx("h3",{className:"backup-loading-title",children:"Backing up data, please wait..."}),h.jsx("p",{className:"backup-loading-message",children:"This usually takes 5-15 seconds. If stuck for more than 20 seconds, you can close this dialog to continue."}),h.jsx("div",{className:"backup-loading-warning",style:{marginTop:"1rem",fontSize:"0.9rem",color:"var(--warning)",textAlign:"center"},children:" If backup appears stuck, click the  button to escape"})]})})})]})}const J3=function({state:r,onAddArrangement:t,onUpdateArrangement:n,onDeleteArrangement:a,onAddAddress:l,onComplete:c,autoCreateForAddress:d,onAutoCreateHandled:m}){const[g,x]=J.useState("thisWeek"),[_,y]=J.useState(!1),[S,C]=J.useState(null),[b,E]=J.useState({saving:!1,updating:!1,deleting:new Set,markingPaid:new Set,markingDefaulted:new Set,sendingReminder:new Set}),[D,F]=J.useState(new Set),O=ee=>{if(!ee)return"";let ce=ee.replace(/[^\d+]/g,"");return ce.startsWith("0")||ce.startsWith("+44")||ce.startsWith("44")?ce:ce.length===10&&ce.startsWith("7")?"0"+ce:ce},M=async ee=>{if(!ee.phoneNumber){alert("No phone number available for this arrangement.");return}E(ce=>({...ce,sendingReminder:new Set([...ce.sendingReminder,ee.id])}));try{const ce={id:"temp",arrangementId:ee.id,type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},V=q1(ee,ce,r.reminderSettings),Q=`sms:${O(ee.phoneNumber)}?body=${encodeURIComponent(V)}`;window.location.href=Q;const fe=new Date().toISOString();await n(ee.id,{lastReminderSent:fe,reminderCount:(ee.reminderCount||0)+1,updatedAt:fe}),F(R=>new Set([...R,ee.id])),setTimeout(()=>{F(R=>{const P=new Set(R);return P.delete(ee.id),P})},3e3)}catch(ce){console.error("Failed to send reminder:",ce),alert("Failed to update reminder information. Please try again.")}finally{E(ce=>({...ce,sendingReminder:new Set([...ce.sendingReminder].filter(V=>V!==ee.id))}))}};J.useEffect(()=>{d!=null&&(y(!0),m?.())},[d,m]);const G=J.useMemo(()=>{const ee=new Date,ce=Sl(ee,{weekStartsOn:1}),V=HA(ee,{weekStartsOn:1});let ie=r.arrangements;return g==="thisWeek"?ie=r.arrangements.filter(Q=>{const fe=Xa(Q.scheduledDate);return VP(fe,{start:ce,end:V})&&Q.status!=="Completed"&&Q.status!=="Cancelled"}):ie=r.arrangements.filter(Q=>Q.status!=="Completed"&&Q.status!=="Cancelled"),ie.sort((Q,fe)=>{const R=Xa(Q.scheduledDate).getTime(),P=Xa(fe.scheduledDate).getTime();if(R!==P)return R-P;const W=Q.scheduledTime||"00:00",U=fe.scheduledTime||"00:00";return W.localeCompare(U)})},[r.arrangements,g]),I=J.useMemo(()=>{const ee=new Map;return G.forEach(ce=>{const V=ce.scheduledDate;ee.has(V)||ee.set(V,[]),ee.get(V).push(ce)}),Array.from(ee.entries()).sort((ce,V)=>ce[0].localeCompare(V[0]))},[G]),N=J.useMemo(()=>{const ee=G.length,ce=new Date().toISOString().slice(0,10),V=G.filter(fe=>fe.scheduledDate===ce).length,ie=G.filter(fe=>{const R=Xa(fe.scheduledDate);return HP(R)&&fe.status==="Scheduled"}).length,Q=G.reduce((fe,R)=>{if(R.amount&&R.status!=="Completed"){const P=parseFloat(R.amount);return fe+(isNaN(P)?0:P)}return fe},0);return{total:ee,todayCount:V,overdue:ie,totalAmountDue:Q}},[G]),q=ee=>{switch(ee){case"Scheduled":return"";case"Confirmed":return"";case"Completed":return"";case"Cancelled":return"";case"Missed":return""}},Z=ee=>{const ce=Xa(ee),V=new Date,ie=z1(V,1);return hv(ce,V)?"Today":hv(ce,ie)?"Tomorrow":xv(ce,"EEEE, d MMM yyyy")},me=(ee,ce,V=1)=>{const ie=new Date(ee);switch(ce){case"weekly":ie.setDate(ie.getDate()+7*V);break;case"monthly":ie.setMonth(ie.getMonth()+V);break;default:return ee}return ie.toISOString().slice(0,10)},ue=async ee=>{const ce=r.arrangements.find(V=>V.id===ee);ce&&(n(ee,{status:"Completed",updatedAt:new Date().toISOString()}),c(ce.addressIndex,"Done",void 0,ce.id))},Y=async(ee,ce)=>{const V=r.arrangements.find(R=>R.id===ee);if(!V)return;const ie=(V.paymentsMade||0)+1,Q=ie>=(V.totalPayments||1),fe=V.recurrenceType&&V.recurrenceType!=="none";if(n(ee,{status:"Completed",amount:ce,paymentsMade:ie,updatedAt:new Date().toISOString()}),c(V.addressIndex,"PIF",ce,V.id),fe&&!Q){const R=me(V.scheduledDate,V.recurrenceType,V.recurrenceInterval||1),P=ie+1,W={addressIndex:V.addressIndex,address:V.address,customerName:V.customerName,phoneNumber:V.phoneNumber,scheduledDate:R,scheduledTime:V.scheduledTime,status:"Scheduled",notes:V.notes?`${V.notes} (Payment ${P}/${V.totalPayments})`:`Payment ${P}/${V.totalPayments}`,amount:V.amount,recurrenceType:V.recurrenceType,recurrenceInterval:V.recurrenceInterval,totalPayments:V.totalPayments,paymentsMade:ie,parentArrangementId:V.parentArrangementId||V.id};await t(W)}},se=async ee=>{E(ce=>({...ce,saving:!0}));try{if(ee.addressIndex<0||ee.addressIndex>=r.addresses.length)throw new Error("Selected address is no longer valid. Please refresh and try again.");await t(ee);try{c(ee.addressIndex,"ARR")}catch(ce){console.error("Error recording ARR completion:",ce),alert("Arrangement created successfully, but there was an issue recording the completion. You may need to manually mark this address as ARR.")}y(!1),C(null)}catch(ce){console.error("Error saving arrangement:",ce),alert(`Failed to save arrangement: ${ce instanceof Error?ce.message:"Please try again."}`)}finally{E(ce=>({...ce,saving:!1}))}},ve=async(ee,ce)=>{E(V=>({...V,updating:!0}));try{await n(ee,ce),C(null)}catch(V){console.error("Error updating arrangement:",V),alert("Failed to update arrangement. Please try again.")}finally{E(V=>({...V,updating:!1}))}};return h.jsxs("div",{className:"arrangements-wrap",children:[h.jsxs("div",{className:"top-row",children:[h.jsxs("div",{className:"stat-item",children:[h.jsx("div",{className:"stat-label",children:" Due"}),h.jsx("div",{className:"stat-value",children:N.total})]}),h.jsxs("div",{className:"stat-item",children:[h.jsx("div",{className:"stat-label",children:" Today"}),h.jsx("div",{className:"stat-value",style:{color:N.todayCount>0?"var(--warning)":"var(--text-primary)"},children:N.todayCount})]}),N.overdue>0&&h.jsxs("div",{className:"stat-item",children:[h.jsx("div",{className:"stat-label",children:" Overdue"}),h.jsx("div",{className:"stat-value",style:{color:"var(--danger)"},children:N.overdue})]}),N.totalAmountDue>0&&h.jsxs("div",{className:"stat-item",children:[h.jsx("div",{className:"stat-label",children:" Total Due"}),h.jsxs("div",{className:"stat-value",style:{color:"var(--success)"},children:["",N.totalAmountDue.toFixed(2)]})]}),h.jsx("div",{className:"stat-actions",children:h.jsxs("div",{className:"btn-group",children:[h.jsx("button",{className:`btn ${g==="thisWeek"?"btn-primary":"btn-ghost"}`,onClick:()=>x("thisWeek"),children:" This Week"}),h.jsx("button",{className:`btn ${g==="all"?"btn-primary":"btn-ghost"}`,onClick:()=>x("all"),children:" All Pending"}),h.jsx("button",{className:"btn btn-success",onClick:()=>y(!0),children:" Add Arrangement"})]})})]}),(_||S)&&h.jsx(eD,{state:r,arrangement:S?r.arrangements.find(ee=>ee.id===S):void 0,preSelectedAddressIndex:d,onAddAddress:l,onSave:S?ee=>ve(S,ee):se,onCancel:()=>{y(!1),C(null)},isLoading:b.saving||b.updating,onComplete:c}),h.jsx("div",{className:"days-list",children:I.length===0?h.jsxs("div",{className:"empty-box",children:[h.jsxs("div",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:[" No payment arrangements ",g==="thisWeek"?"due this week":"pending"]}),h.jsx("div",{style:{fontSize:"0.875rem",opacity:.75},children:g==="thisWeek"?"No payment arrangements are scheduled for this week":"No pending payment arrangements found"})]}):I.map(([ee,ce])=>h.jsxs("div",{className:"day-card fade-in-up",children:[h.jsx("div",{className:"day-header",children:h.jsxs("div",{children:[h.jsx("div",{className:"day-title",children:Z(ee)}),h.jsxs("div",{className:"muted",children:[ce.length," payment",ce.length===1?"":"s"," due",ce.some(V=>V.amount)&&h.jsxs(h.Fragment,{children:["  ",ce.reduce((V,ie)=>{const Q=parseFloat(ie.amount||"0");return V+(isNaN(Q)?0:Q)},0).toFixed(2)," total"]})]})]})}),h.jsx("div",{className:"arrangements-list",children:ce.map(V=>h.jsxs("div",{className:"arrangement-card-modern",children:[h.jsxs("div",{className:"arrangement-card-header",children:[h.jsxs("div",{className:"arrangement-primary-info",children:[h.jsxs("div",{className:"arrangement-address-modern",children:[h.jsxs("span",{className:"address-index",children:["#",V.addressIndex+1]}),h.jsx("span",{className:"address-text",children:V.address})]}),V.customerName&&h.jsxs("div",{className:"arrangement-customer-modern",children:[h.jsx("span",{className:"customer-icon",children:""}),h.jsx("span",{className:"customer-name",children:V.customerName})]})]}),h.jsx("div",{className:"arrangement-status-modern",children:h.jsxs("span",{className:`status-badge-modern status-${V.status.toLowerCase()}`,children:[h.jsx("span",{className:"status-icon",children:q(V.status)}),h.jsx("span",{className:"status-text",children:V.status})]})})]}),h.jsx("div",{className:"arrangement-card-body",children:h.jsxs("div",{className:"arrangement-details-grid",children:[h.jsxs("div",{className:"detail-item",children:[h.jsx("span",{className:"detail-icon",children:""}),h.jsxs("div",{className:"detail-content",children:[h.jsx("span",{className:"detail-label",children:"Date"}),h.jsx("span",{className:"detail-value",children:V.scheduledDate})]})]}),V.scheduledTime&&h.jsxs("div",{className:"detail-item",children:[h.jsx("span",{className:"detail-icon",children:""}),h.jsxs("div",{className:"detail-content",children:[h.jsx("span",{className:"detail-label",children:"Time"}),h.jsx("span",{className:"detail-value",children:V.scheduledTime})]})]}),V.amount&&h.jsxs("div",{className:"detail-item",children:[h.jsx("span",{className:"detail-icon",children:""}),h.jsxs("div",{className:"detail-content",children:[h.jsx("span",{className:"detail-label",children:"Amount"}),h.jsxs("span",{className:"detail-value amount-value",children:["",V.amount]})]})]}),V.phoneNumber&&h.jsxs("div",{className:"detail-item",children:[h.jsx("span",{className:"detail-icon",children:""}),h.jsxs("div",{className:"detail-content",children:[h.jsx("span",{className:"detail-label",children:"Phone"}),h.jsx("a",{href:`tel:${V.phoneNumber}`,className:"detail-value phone-link",children:V.phoneNumber})]})]}),V.notes&&h.jsxs("div",{className:"detail-item detail-notes",children:[h.jsx("span",{className:"detail-icon",children:""}),h.jsxs("div",{className:"detail-content",children:[h.jsx("span",{className:"detail-label",children:"Notes"}),h.jsx("span",{className:"detail-value",children:V.notes})]})]}),V.recurrenceType&&V.recurrenceType!=="none"&&h.jsxs("div",{className:"detail-item",children:[h.jsx("span",{className:"detail-icon",children:""}),h.jsxs("div",{className:"detail-content",children:[h.jsx("span",{className:"detail-label",children:"Recurrence"}),h.jsxs("span",{className:"detail-value",children:[V.recurrenceType==="weekly"?"Weekly":"Monthly",V.recurrenceInterval&&V.recurrenceInterval>1&&` (every ${V.recurrenceInterval})`,h.jsxs("div",{className:"recurrence-progress",children:["Payment ",(V.paymentsMade||0)+1," of ",V.totalPayments||1]})]})]})]})]})}),h.jsxs("div",{className:"arrangement-actions",children:[V.status==="Scheduled"&&h.jsx(Ei,{className:"btn btn-sm btn-success",isLoading:b.markingPaid.has(V.id),loadingText:"Processing...",onClick:async()=>{const ie=window.prompt(`Payment received:

Expected: ${V.amount||"0.00"}
Enter actual amount received:`,V.amount||"");if(ie!==null&&ie.trim()){E(Q=>({...Q,markingPaid:new Set([...Q.markingPaid,V.id])}));try{await Y(V.id,ie.trim())}finally{E(Q=>({...Q,markingPaid:new Set([...Q.markingPaid].filter(fe=>fe!==V.id))}))}}},children:" Confirm Payment"}),(V.status==="Scheduled"||V.status==="Confirmed")&&h.jsxs(h.Fragment,{children:[V.phoneNumber&&h.jsxs("div",{style:{position:"relative"},children:[h.jsx(Ei,{className:"btn btn-sm btn-primary",isLoading:b.sendingReminder.has(V.id),loadingText:"Opening...",onClick:()=>M(V),title:`Send SMS reminder to ${V.phoneNumber}`,children:" Send SMS"}),D.has(V.id)&&h.jsx("div",{className:"reminder-confirmation",style:{position:"absolute",top:"-35px",left:"0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"nowrap",zIndex:1e3,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:" SMS opened!"}),V.reminderCount&&V.reminderCount>0&&h.jsxs("div",{className:"reminder-history",children:[V.reminderCount," SMS reminder",V.reminderCount>1?"s":""," sent",V.lastReminderSent&&h.jsxs("span",{children:["  Last: ",xv(Xa(V.lastReminderSent),"MMM d, HH:mm")]})]})]}),h.jsx(Ei,{className:"btn btn-sm btn-success",isLoading:b.markingPaid.has(V.id),loadingText:"Processing...",onClick:async()=>{const ie=window.prompt(`Continue with payment plan:

Expected: ${V.amount||"0.00"}
Enter actual amount received:`,V.amount||"");if(ie!==null&&ie.trim()){E(Q=>({...Q,markingPaid:new Set([...Q.markingPaid,V.id])}));try{await Y(V.id,ie.trim())}finally{E(Q=>({...Q,markingPaid:new Set([...Q.markingPaid].filter(fe=>fe!==V.id))}))}}},children:" Continue Plan"}),h.jsx(Ei,{className:"btn btn-sm btn-warning",isLoading:b.markingDefaulted.has(V.id),loadingText:"Processing...",onClick:async()=>{if(confirm("Mark this arrangement as defaulted? This will complete the case as 'Done (Defaulted Arrangement)'.")){E(ie=>({...ie,markingDefaulted:new Set([...ie.markingDefaulted,V.id])}));try{await ue(V.id)}finally{E(ie=>({...ie,markingDefaulted:new Set([...ie.markingDefaulted].filter(Q=>Q!==V.id))}))}}},children:" Defaulted"})]}),h.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>C(V.id),disabled:b.updating||b.saving,children:" Edit"}),h.jsx(Ei,{className:"btn btn-sm btn-danger",isLoading:b.deleting.has(V.id),loadingText:"Deleting...",onClick:async()=>{if(confirm("Are you sure you want to delete this arrangement?")){E(ie=>({...ie,deleting:new Set([...ie.deleting,V.id])}));try{await a(V.id)}finally{E(ie=>({...ie,deleting:new Set([...ie.deleting].filter(Q=>Q!==V.id))}))}}},children:" Delete"})]})]},V.id))})]},ee))}),h.jsx("style",{children:`
        .arrangement-card-modern {
          background: linear-gradient(135deg, white 0%, var(--gray-50) 100%);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          padding: 1.5rem;
          margin-bottom: 1rem;
          box-shadow: var(--shadow-sm);
          transition: all 0.2s ease;
          position: relative;
          overflow: hidden;
        }

        .arrangement-card-modern:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
          border-color: var(--primary-light);
        }

        .arrangement-card-modern::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 3px;
          background: linear-gradient(90deg, var(--primary) 0%, var(--success) 100%);
        }

        .arrangement-card-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1.25rem;
          gap: 1rem;
        }

        .arrangement-primary-info {
          flex: 1;
        }

        .arrangement-address-modern {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          margin-bottom: 0.5rem;
        }

        .address-index {
          background: var(--primary);
          color: white;
          font-size: 0.75rem;
          font-weight: 600;
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          min-width: 2rem;
          text-align: center;
        }

        .address-text {
          font-weight: 600;
          font-size: 1.1rem;
          color: var(--text-primary);
          line-height: 1.2;
        }

        .arrangement-customer-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.9rem;
          color: var(--text-secondary);
        }

        .customer-icon {
          font-size: 1rem;
        }

        .customer-name {
          font-weight: 500;
        }

        .arrangement-status-modern {
          flex-shrink: 0;
        }

        .status-badge-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          border-radius: var(--radius-full);
          font-size: 0.875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          transition: all 0.2s ease;
        }

        .status-badge-modern.status-scheduled {
          background: linear-gradient(135deg, var(--blue-50) 0%, var(--blue-25) 100%);
          color: var(--blue-700);
          border: 1px solid var(--blue-200);
        }

        .status-badge-modern.status-confirmed {
          background: linear-gradient(135deg, var(--success-light) 0%, var(--success-lighter) 100%);
          color: var(--success-dark);
          border: 1px solid var(--success-border);
        }

        .status-badge-modern.status-completed {
          background: linear-gradient(135deg, var(--green-50) 0%, var(--green-25) 100%);
          color: var(--green-700);
          border: 1px solid var(--green-200);
        }

        .status-badge-modern.status-cancelled {
          background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-25) 100%);
          color: var(--gray-700);
          border: 1px solid var(--gray-200);
        }

        .status-badge-modern.status-missed {
          background: linear-gradient(135deg, var(--danger-light) 0%, var(--danger-lighter) 100%);
          color: var(--danger-dark);
          border: 1px solid var(--danger-border);
        }

        .status-icon {
          font-size: 0.875rem;
        }

        .arrangement-card-body {
          margin-bottom: 1.25rem;
        }

        .arrangement-details-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          padding: 0.75rem;
          background: var(--gray-25);
          border-radius: var(--radius-md);
          transition: all 0.2s ease;
        }

        .detail-item:hover {
          background: var(--gray-50);
        }

        .detail-notes {
          grid-column: 1 / -1;
        }

        /* Dark mode styles for arrangements */
        .dark-mode .arrangement-card-modern {
          background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-card-modern:hover {
          border-color: var(--primary);
          background: linear-gradient(135deg, var(--gray-200) 0%, var(--gray-300) 100%);
        }

        .dark-mode .address-text {
          color: var(--gray-800);
        }

        .dark-mode .customer-name {
          color: var(--gray-600);
        }

        .dark-mode .detail-item {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .detail-item:hover {
          background: var(--gray-300);
        }

        .dark-mode .detail-label {
          color: var(--gray-500);
        }

        .dark-mode .detail-value {
          color: var(--gray-800);
        }

        .dark-mode .phone-link {
          color: var(--primary) !important;
        }

        .dark-mode .recurrence-progress {
          color: var(--gray-500);
        }

        .dark-mode .reminder-confirmation {
          background: var(--gray-200) !important;
          color: var(--gray-800) !important;
        }

        .dark-mode .reminder-history {
          color: var(--gray-600) !important;
        }

        /* Basic card and form styles */
        .card {
          background: white;
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          overflow: hidden;
        }

        .card-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
          background: var(--gray-50);
        }

        .card-body {
          padding: 1.5rem;
        }

        .form-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 1rem;
        }

        .form-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .form-group-full {
          grid-column: 1 / -1;
        }

        .form-group label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .btn-row {
          display: flex;
          gap: 0.75rem;
          align-items: center;
          flex-wrap: wrap;
        }

        .btn-row-end {
          justify-content: flex-end;
        }

        .arrangements-wrap {
          max-width: none;
          width: 100%;
        }

        .top-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          margin-bottom: 2rem;
          flex-wrap: wrap;
        }

        .stat-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 0.75rem 1rem;
          background: white;
          border-radius: var(--radius-md);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          min-width: 80px;
        }

        .stat-label {
          font-size: 0.75rem;
          color: var(--gray-600);
          margin-bottom: 0.25rem;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--gray-800);
        }

        .stat-actions {
          display: flex;
          gap: 1rem;
          align-items: center;
        }

        .days-list {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .day-card {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          overflow: hidden;
        }

        .day-header {
          padding: 1.5rem;
          background: var(--gray-50);
          border-bottom: 1px solid var(--gray-200);
        }

        .day-title {
          font-size: 1.125rem;
          font-weight: 700;
          color: var(--gray-800);
          margin-bottom: 0.25rem;
        }

        .muted {
          font-size: 0.875rem;
          color: var(--gray-500);
        }

        .arrangements-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          padding: 1.5rem;
        }

        .empty-box {
          padding: 3rem;
          text-align: center;
          background: white;
          border-radius: var(--radius-lg);
          border: 2px dashed var(--gray-300);
          color: var(--gray-500);
        }

        .fade-in-up {
          animation: fadeInUp 0.3s ease-out;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        /* Dark mode for basic elements */
        .dark-mode .card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .card-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .form-group label {
          color: var(--gray-700);
        }

        .dark-mode .stat-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .stat-label {
          color: var(--gray-500);
        }

        .dark-mode .stat-value {
          color: var(--gray-800);
        }

        .dark-mode .day-card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .day-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .day-title {
          color: var(--gray-800);
        }

        .dark-mode .muted {
          color: var(--gray-500);
        }

        .dark-mode .empty-box {
          background: var(--gray-100);
          border-color: var(--gray-400);
          color: var(--gray-500);
        }

        /* Dark mode button styles */
        .dark-mode .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        /* Dark mode arrangement actions */
        .dark-mode .arrangement-actions .btn {
          background: var(--gray-200);
          color: var(--gray-700);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-actions .btn:hover {
          background: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .arrangement-actions .btn-success {
          background: var(--success);
          color: white;
          border-color: var(--success);
        }

        .dark-mode .arrangement-actions .btn-success:hover {
          background: var(--success-dark);
          border-color: var(--success-dark);
        }

        .dark-mode .arrangement-actions .btn-primary {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }

        .dark-mode .arrangement-actions .btn-primary:hover {
          background: var(--primary-hover);
          border-color: var(--primary-hover);
        }

        .dark-mode .arrangement-actions .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .arrangement-actions .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .arrangement-actions .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .arrangement-actions .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        .dark-mode .arrangement-actions .btn-ghost {
          background: transparent;
          color: var(--gray-600);
          border-color: var(--gray-400);
        }

        .dark-mode .arrangement-actions .btn-ghost:hover {
          background: var(--gray-200);
          color: var(--gray-800);
        }

        .detail-icon {
          font-size: 1.1rem;
          flex-shrink: 0;
          margin-top: 0.125rem;
        }

        .detail-content {
          flex: 1;
          min-width: 0;
        }

        .detail-label {
          display: block;
          font-size: 0.75rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
          margin-bottom: 0.25rem;
        }

        .detail-value {
          display: block;
          font-size: 0.9rem;
          color: var(--text-primary);
          font-weight: 500;
          word-break: break-word;
        }

        .amount-value {
          color: var(--success-dark);
          font-weight: 700;
          font-size: 1rem;
        }

        .phone-link {
          color: var(--primary) !important;
          text-decoration: none;
          transition: color 0.2s ease;
        }

        .phone-link:hover {
          color: var(--primary-dark) !important;
          text-decoration: underline;
        }

        .recurrence-progress {
          font-size: 0.8rem;
          color: var(--text-secondary);
          margin-top: 0.25rem;
          font-weight: 400;
        }

        .arrangement-actions {
          display: flex;
          gap: 0.75rem;
          flex-wrap: wrap;
          align-items: center;
          margin-top: 1.5rem;
          padding-top: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .dark-mode .arrangement-actions {
          border-top-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .arrangement-card-header {
            flex-direction: column;
            align-items: stretch;
          }

          .arrangement-details-grid {
            grid-template-columns: 1fr;
          }

          .detail-notes {
            grid-column: 1;
          }
        }
      `})]})},Q3=J.memo(J3);function eD({state:e,arrangement:r,preSelectedAddressIndex:t,onAddAddress:n,onSave:a,onCancel:l,isLoading:c=!1,onComplete:d}){const[m,g]=J.useState((t!=null,"existing")),[x,_]=J.useState(!1),[y,S]=J.useState({addressIndex:r?.addressIndex??t??0,manualAddress:"",customerName:r?.customerName??"",phoneNumber:r?.phoneNumber??"",scheduledDate:r?.scheduledDate??new Date().toISOString().slice(0,10),scheduledTime:r?.scheduledTime??"",amount:r?.amount??"",notes:r?.notes??"",status:r?.status??"Scheduled",recurrenceType:r?.recurrenceType??"none",recurrenceInterval:r?.recurrenceInterval??1,totalPayments:r?.totalPayments??void 0,paymentType:"full_balance",totalBalance:"",initialPayment:"",remainingPaymentSchedule:"single"});J.useEffect(()=>{if(r){const E=r.addressIndex>=0&&r.addressIndex<e.addresses.length,D=E?e.addresses[r.addressIndex]?.address:null,F=r.address;!E||!(D===F)?(g("manual"),S({addressIndex:0,manualAddress:F,customerName:r.customerName??"",phoneNumber:r.phoneNumber??"",scheduledDate:r.scheduledDate,scheduledTime:r.scheduledTime??"",amount:r.amount??"",notes:r.notes??"",status:r.status,recurrenceType:r.recurrenceType??"none",recurrenceInterval:r.recurrenceInterval??1,totalPayments:r.totalPayments??void 0,paymentType:"full_balance",totalBalance:r.amount??"",initialPayment:"",remainingPaymentSchedule:"single"})):(g("existing"),S({addressIndex:r.addressIndex,manualAddress:"",customerName:r.customerName??"",phoneNumber:r.phoneNumber??"",scheduledDate:r.scheduledDate,scheduledTime:r.scheduledTime??"",amount:r.amount??"",notes:r.notes??"",status:r.status,recurrenceType:r.recurrenceType??"none",recurrenceInterval:r.recurrenceInterval??1,totalPayments:r.totalPayments??void 0,paymentType:"full_balance",totalBalance:r.amount??"",initialPayment:"",remainingPaymentSchedule:"single"}))}},[r,e.addresses]);const C=m==="existing"?e.addresses[y.addressIndex]:null,b=async E=>{if(E&&E.preventDefault(),x||c)return;_(!0);let D=null;try{if(y.paymentType==="full_balance"){const G=parseFloat(y.amount||"0");if(!y.amount||isNaN(G)||G<=0){alert("Please enter a valid payment amount (numbers only, greater than 0)");return}}else{const G=parseFloat(y.totalBalance||"0"),I=parseFloat(y.initialPayment||"0");if(!y.totalBalance||isNaN(G)||G<=0){alert("Please enter a valid total balance amount");return}if(!y.initialPayment||isNaN(I)||I<=0){alert("Please enter a valid initial payment amount");return}if(I>=G){alert("Initial payment must be less than the total balance");return}}if(y.paymentType==="full_balance"){if(y.recurrenceType!=="none"){if(!y.totalPayments||y.totalPayments<2){alert("Please specify the total number of payments (minimum 2) for recurring arrangements");return}}else if(!y.totalPayments||y.totalPayments<1){alert("Please specify the number of payments");return}}else if(y.remainingPaymentSchedule!=="single"){if(!y.totalPayments||y.totalPayments<1){alert("Please specify the total number of remaining payments");return}}let F=y.addressIndex,O="";if(m==="existing"){if(!C){alert("Please select a valid address");return}if(y.addressIndex<0||y.addressIndex>=e.addresses.length){alert("Selected address is no longer valid. Please refresh the page and try again.");return}O=C.address}else{if(!y.manualAddress.trim()){alert("Please enter an address");return}const G=e.addresses.findIndex(I=>(I.address||"").toLowerCase().trim()===y.manualAddress.toLowerCase().trim());if(G>=0)F=G,O=e.addresses[G].address;else{if(!n){alert("Cannot add new addresses - missing onAddAddress handler");return}try{const I={address:y.manualAddress.trim(),lat:null,lng:null};F=await n(I),D=F,O=I.address}catch(I){console.error("Error adding address:",I),alert("Failed to add new address. Please try again.");return}}}let M;if(y.paymentType==="full_balance")M={addressIndex:F,address:O,customerName:y.customerName,phoneNumber:y.phoneNumber,scheduledDate:y.scheduledDate,scheduledTime:y.scheduledTime,amount:y.amount,notes:y.notes,status:y.status,recurrenceType:y.recurrenceType,recurrenceInterval:y.recurrenceType!=="none"?y.recurrenceInterval:void 0,totalPayments:y.recurrenceType!=="none"?y.totalPayments:1,paymentsMade:r?.paymentsMade??0};else{const G=parseFloat(y.totalBalance),I=parseFloat(y.initialPayment),N=G-I;let q="none",Z=1,me=1;y.remainingPaymentSchedule==="weekly"?(q="weekly",me=y.totalPayments||1):y.remainingPaymentSchedule==="4weekly"?(q="weekly",Z=4,me=y.totalPayments||1):y.remainingPaymentSchedule==="monthly"&&(q="monthly",me=y.totalPayments||1);const ue=me>1?(N/me).toFixed(2):N.toFixed(2);M={addressIndex:F,address:O,customerName:y.customerName,phoneNumber:y.phoneNumber,scheduledDate:y.scheduledDate,scheduledTime:y.scheduledTime,amount:ue,notes:`${y.notes}${y.notes?`
`:""}Total Balance: ${y.totalBalance}, Initial Payment: ${y.initialPayment}, Remaining: ${N.toFixed(2)}`,status:y.status,recurrenceType:q,recurrenceInterval:q!=="none"?Z:void 0,totalPayments:me,paymentsMade:r?.paymentsMade??0}}if(await a(M),y.paymentType==="initial_plus_balance")try{d(F,"PIF",y.initialPayment)}catch(G){console.error("Error recording initial payment completion:",G),alert("Arrangement created successfully, but there was an issue recording the initial payment. You may need to manually mark this address as PIF.")}}catch(F){throw console.error("Error in form submission:",F),D!==null&&console.warn(`New address was added at index ${D} but arrangement creation failed. Manual cleanup may be needed.`),F}finally{_(!1)}};return h.jsxs("div",{className:"card arrangement-form",children:[h.jsx("div",{className:"card-header",children:h.jsx("h3",{style:{margin:0},children:r?" Edit Payment Arrangement":" Create Payment Arrangement"})}),h.jsx("div",{className:"card-body",children:h.jsxs("form",{onSubmit:b,className:"form-grid",children:[!r&&h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("div",{children:" Address Source"}),h.jsxs("div",{className:"btn-group",children:[h.jsx("button",{type:"button",className:`btn ${m==="existing"?"btn-primary":"btn-ghost"}`,onClick:()=>g("existing"),children:" From List"}),h.jsx("button",{type:"button",className:`btn ${m==="manual"?"btn-primary":"btn-ghost"}`,onClick:()=>g("manual"),children:" Enter Manually"})]})]}),m==="existing"?h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("label",{htmlFor:"address-index",children:" Address *"}),e.addresses.length===0?h.jsx("div",{style:{padding:"0.75rem",backgroundColor:"var(--warning-light)",border:"1px solid var(--warning)",borderRadius:"var(--radius)",color:"var(--warning)",fontSize:"0.875rem"},children:' No addresses in your list. Switch to "Enter Manually" to add a new address.'}):h.jsx("select",{id:"address-index",name:"addressIndex",value:y.addressIndex,onChange:E=>S(D=>({...D,addressIndex:parseInt(E.target.value)})),className:"input",required:!0,children:e.addresses.map((E,D)=>h.jsxs("option",{value:D,children:["#",D+1," - ",E.address]},D))})]}):h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("label",{htmlFor:"manual-address",children:" Address *"}),h.jsx("input",{id:"manual-address",name:"manualAddress",type:"text",value:y.manualAddress,onChange:E=>S(D=>({...D,manualAddress:E.target.value})),className:"input",placeholder:"Enter full address",required:!0,autoComplete:"street-address"}),h.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:" If this address doesn't exist in your list, it will be automatically added."})]}),h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("label",{children:" Payment Setup"}),h.jsxs("div",{className:"btn-group",children:[h.jsx("button",{type:"button",className:`btn ${y.paymentType==="full_balance"?"btn-primary":"btn-ghost"}`,onClick:()=>S(E=>({...E,paymentType:"full_balance"})),children:" Full Balance Payment"}),h.jsx("button",{type:"button",className:`btn ${y.paymentType==="initial_plus_balance"?"btn-primary":"btn-ghost"}`,onClick:()=>S(E=>({...E,paymentType:"initial_plus_balance"})),children:" Initial Payment + Schedule"})]})]}),y.paymentType==="full_balance"?h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"payment-amount",children:" Payment Amount *"}),h.jsx("input",{id:"payment-amount",name:"paymentAmount",type:"number",step:"0.01",min:"0",value:y.amount,onChange:E=>S(D=>({...D,amount:E.target.value})),className:"input",placeholder:"0.00",required:!0,autoComplete:"off"})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"total-balance",children:" Total Balance *"}),h.jsx("input",{id:"total-balance",name:"totalBalance",type:"number",step:"0.01",min:"0",value:y.totalBalance,onChange:E=>S(D=>({...D,totalBalance:E.target.value})),className:"input",placeholder:"0.00",required:!0,autoComplete:"off"})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"initial-payment",children:" Initial Payment (Today) *"}),h.jsx("input",{id:"initial-payment",name:"initialPayment",type:"number",step:"0.01",min:"0",value:y.initialPayment,onChange:E=>S(D=>({...D,initialPayment:E.target.value})),className:"input",placeholder:"0.00",required:!0,autoComplete:"off"}),y.totalBalance&&y.initialPayment&&h.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[" Remaining balance: ",(parseFloat(y.totalBalance||"0")-parseFloat(y.initialPayment||"0")).toFixed(2)]})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"customer-name",children:" Customer Name"}),h.jsx("input",{id:"customer-name",name:"customerName",type:"text",value:y.customerName,onChange:E=>S(D=>({...D,customerName:E.target.value})),className:"input",placeholder:"Customer name",autoComplete:"name"})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"phone-number",children:" Phone Number"}),h.jsx("input",{id:"phone-number",name:"phoneNumber",type:"tel",value:y.phoneNumber,onChange:E=>S(D=>({...D,phoneNumber:E.target.value})),className:"input",placeholder:"Phone number",autoComplete:"tel"})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"scheduled-date",children:" Payment Due Date *"}),h.jsx("input",{id:"scheduled-date",name:"scheduledDate",type:"date",value:y.scheduledDate,onChange:E=>S(D=>({...D,scheduledDate:E.target.value})),className:"input",required:!0,autoComplete:"off"})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"scheduled-time",children:" Preferred Time"}),h.jsx("input",{id:"scheduled-time",name:"scheduledTime",type:"time",value:y.scheduledTime,onChange:E=>S(D=>({...D,scheduledTime:E.target.value})),className:"input",autoComplete:"off"})]}),y.paymentType==="full_balance"?h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("label",{htmlFor:"recurrence-type",children:" Payment Schedule"}),h.jsxs("select",{id:"recurrence-type",name:"recurrenceType",value:y.recurrenceType,onChange:E=>S(D=>({...D,recurrenceType:E.target.value,recurrenceInterval:1,totalPayments:void 0})),className:"input",children:[h.jsx("option",{value:"none",children:"One-time payment"}),h.jsx("option",{value:"weekly",children:"Weekly"}),h.jsx("option",{value:"monthly",children:"Monthly"})]})]}):h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("label",{htmlFor:"remaining-schedule",children:" Remaining Balance Schedule"}),h.jsxs("select",{id:"remaining-schedule",name:"remainingSchedule",value:y.remainingPaymentSchedule,onChange:E=>S(D=>({...D,remainingPaymentSchedule:E.target.value,totalPayments:E.target.value==="single"?1:void 0})),className:"input",children:[h.jsx("option",{value:"single",children:"Single payment (specific date)"}),h.jsx("option",{value:"weekly",children:"Weekly payments"}),h.jsx("option",{value:"4weekly",children:"4-weekly payments"}),h.jsx("option",{value:"monthly",children:"Monthly payments"})]})]}),(y.paymentType==="full_balance"&&y.recurrenceType!=="none"||y.paymentType==="initial_plus_balance"&&y.remainingPaymentSchedule!=="single")&&h.jsxs("div",{className:"form-group",children:[h.jsxs("label",{htmlFor:"total-payments",children:[" ",y.paymentType==="initial_plus_balance"?"Remaining Payments":"Total Payments"," *"]}),h.jsx("input",{id:"total-payments",name:"totalPayments",type:"number",min:"1",value:y.totalPayments||"",onChange:E=>S(D=>({...D,totalPayments:E.target.value?parseInt(E.target.value):void 0})),className:"input",placeholder:"Number of payments",required:!0,autoComplete:"off"}),y.paymentType==="initial_plus_balance"&&y.totalPayments&&y.totalBalance&&y.initialPayment&&h.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[" ",((parseFloat(y.totalBalance)-parseFloat(y.initialPayment))/y.totalPayments).toFixed(2)," per payment"]})]}),y.paymentType==="full_balance"&&y.recurrenceType!=="none"&&h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"recurrence-interval",children:" Interval"}),h.jsxs("select",{id:"recurrence-interval",name:"recurrenceInterval",value:y.recurrenceInterval,onChange:E=>S(D=>({...D,recurrenceInterval:parseInt(E.target.value)})),className:"input",children:[h.jsxs("option",{value:1,children:["Every ",y.recurrenceType==="weekly"?"week":"month"]}),h.jsxs("option",{value:2,children:["Every 2 ",y.recurrenceType==="weekly"?"weeks":"months"]}),h.jsxs("option",{value:3,children:["Every 3 ",y.recurrenceType==="weekly"?"weeks":"months"]}),h.jsxs("option",{value:4,children:["Every 4 ",y.recurrenceType==="weekly"?"weeks":"months"]})]})]}),h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("label",{htmlFor:"notes",children:" Notes"}),h.jsx("textarea",{id:"notes",name:"notes",value:y.notes,onChange:E=>S(D=>({...D,notes:E.target.value})),className:"input",rows:3,placeholder:"Payment terms, special instructions, etc..."})]}),y.paymentType==="initial_plus_balance"&&y.totalBalance&&y.initialPayment&&h.jsx("div",{className:"form-group form-group-full",children:h.jsxs("div",{style:{padding:"1rem",backgroundColor:"var(--gray-50)",borderRadius:"var(--radius-md)",border:"1px solid var(--gray-200)"},children:[h.jsx("div",{style:{fontWeight:600,marginBottom:"0.5rem",color:"var(--text-primary)"},children:" Payment Summary"}),h.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)",lineHeight:1.5},children:[h.jsxs("div",{children:[" Total Balance: ",y.totalBalance]}),h.jsxs("div",{children:[" Initial Payment (Today): ",y.initialPayment]}),h.jsxs("div",{children:[" Remaining Balance: ",(parseFloat(y.totalBalance)-parseFloat(y.initialPayment)).toFixed(2)]}),y.remainingPaymentSchedule==="single"?h.jsxs("div",{children:[" Single payment: ",(parseFloat(y.totalBalance)-parseFloat(y.initialPayment)).toFixed(2)]}):y.totalPayments&&y.totalPayments>0?h.jsxs("div",{children:[" ",y.totalPayments,"  ",((parseFloat(y.totalBalance)-parseFloat(y.initialPayment))/y.totalPayments).toFixed(2)," ",y.remainingPaymentSchedule==="weekly"?"weekly":y.remainingPaymentSchedule==="4weekly"?"every 4 weeks":y.remainingPaymentSchedule==="monthly"?"monthly":""]}):h.jsx("div",{children:" Payment amount: Enter number of payments above"}),h.jsxs("div",{children:[" Schedule: ",y.remainingPaymentSchedule==="single"?"Single payment":y.remainingPaymentSchedule==="4weekly"?"Every 4 weeks":y.remainingPaymentSchedule.charAt(0).toUpperCase()+y.remainingPaymentSchedule.slice(1)]})]})]})}),h.jsx("div",{className:"form-group form-group-full",children:h.jsxs("div",{className:"btn-row btn-row-end",style:{marginTop:"1rem"},children:[h.jsx("button",{type:"button",className:"btn btn-ghost",onClick:l,children:"Cancel"}),h.jsxs(Ei,{type:"submit",className:"btn btn-primary",isLoading:c||x,loadingText:r?"Updating...":"Creating...",disabled:m==="existing"&&e.addresses.length===0,children:[r?" Update":" Create"," Arrangement"]})]})})]})})]})}async function tD(e){const r=await e.text();return JSON.parse(r)}var _y=nx();function rD({onAdd:e,inline:r}){const[t,n]=J.useState(!1),[a,l]=J.useState(""),[c,d]=J.useState(""),[m,g]=J.useState(""),[x,_]=J.useState(!1),y=J.useRef(!1),[S,C]=J.useState(null),b=()=>{l(""),d(""),g(""),C(null)},E=async F=>{if(F?.preventDefault(),y.current)return;C(null);const O=a.trim();if(!O)return C("Address is required.");let M=null,G=null;if(c.trim()){const I=Number(c);if(Number.isNaN(I))return C("Latitude must be a number.");M=I}if(m.trim()){const I=Number(m);if(Number.isNaN(I))return C("Longitude must be a number.");G=I}y.current=!0,_(!0);try{await e({address:O,lat:M,lng:G}),b(),n(!1)}catch(I){C(I?.message||String(I))}finally{y.current=!1,_(!1)}},D=r?h.jsx("button",{type:"button",className:"btn",onClick:()=>n(!0),children:"+ Add address"}):h.jsx("button",{type:"button",onClick:()=>n(!0),"aria-label":"Add address",style:nD,className:"fab-add-address",children:"+"});return h.jsxs(h.Fragment,{children:[D,t&&_y.createPortal(h.jsx("div",{style:aD,role:"dialog","aria-modal":"true",children:h.jsxs("div",{style:iD,children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("h3",{style:{margin:0},children:"Add Address"}),h.jsx("button",{className:"btn btn-ghost",onClick:()=>{b(),n(!1)},disabled:x,"aria-label":"Close",children:""})]}),h.jsxs("form",{onSubmit:E,style:{marginTop:"0.5rem"},children:[h.jsx("label",{className:"label",htmlFor:"manual-address",children:"Address *"}),h.jsx("textarea",{id:"manual-address",value:a,onChange:F=>l(F.target.value),className:"input",rows:3,placeholder:"e.g. 10 Example St, City, POSTCODE",required:!0}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsx("label",{className:"label",htmlFor:"manual-lat",children:"Lat (optional)"}),h.jsx("input",{id:"manual-lat",type:"text",inputMode:"decimal",value:c,onChange:F=>d(F.target.value),className:"input",placeholder:"51.5034"})]}),h.jsxs("div",{style:{flex:1},children:[h.jsx("label",{className:"label",htmlFor:"manual-lng",children:"Lng (optional)"}),h.jsx("input",{id:"manual-lng",type:"text",inputMode:"decimal",value:m,onChange:F=>g(F.target.value),className:"input",placeholder:"-0.1276"})]})]}),S&&h.jsx("div",{style:{color:"var(--danger)",fontSize:"0.875rem",marginTop:"0.5rem"},children:S}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem",justifyContent:"flex-end"},children:[h.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>{b(),n(!1)},disabled:x,children:"Cancel"}),h.jsx("button",{type:"submit",className:"btn",disabled:x,children:x?"Adding...":"Add"})]})]})]})}),document.body)]})}const nD={position:"fixed",right:16,bottom:"calc(16px + env(safe-area-inset-bottom, 0))",width:56,height:56,borderRadius:"50%",border:"none",background:"var(--primary)",color:"#fff",fontSize:28,lineHeight:"56px",textAlign:"center",boxShadow:"0 6px 18px rgba(0,0,0,0.18)",cursor:"pointer",zIndex:4e3},aD={position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:12,zIndex:4100},iD={width:"100%",maxWidth:520,background:"var(--surface)",borderRadius:14,padding:14,border:"1px solid var(--border-light)",boxShadow:"var(--shadow-lg)"},sD=[{id:"enforcement_pro",name:"Enforcement Pro",price:2500,currency:"GBP",features:["Route optimization for 30+ addresses","Commission tracking & reporting","Payment arrangements with SMS reminders","Daily/weekly earnings reports","Unlimited cloud sync & backup","Priority customer support"],trialDays:14}];function oD(e){const r=new Date(e),t=new Date,n=r.getTime()-t.getTime();return Math.ceil(n/(1e3*60*60*24))}function lD(e){if(!e)return!1;const r=new Date,t=new Date(e.currentPeriodEnd);return(e.status==="active"||e.status==="trial")&&t>r}function cD(e){return e?e.status==="trial":!1}function uD(e){if(!e)return!0;const r=new Date,t=new Date(e.currentPeriodEnd);return e.status==="expired"||e.status==="cancelled"||t<=r}function vm(e){const[r,t]=J.useState(null),[n]=J.useState(sD),[a,l]=J.useState(!0),[c,d]=J.useState(null),[m,g]=J.useState(!1),[x,_]=J.useState(!1),y=J.useCallback(()=>d(null),[]);J.useEffect(()=>{(async()=>{if(!e||!$e){g(!1);return}try{const{data:q}=await $e.rpc("is_owner",{user_uuid:e.id});g(q||!1)}catch{g(!1)}})()},[e]);const S=lD(r),C=cD(r),b=uD(r),E=r?oD(r.currentPeriodEnd):0,D=m||S&&!b||x,F=J.useCallback(async()=>{if(!e||!$e){t(null),l(!1);return}try{l(!0),y();const{data:N,error:q}=await $e.from("user_subscriptions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).maybeSingle();if(console.log("Subscription query result:",{data:N,error:q}),q)throw q;const Z=N?{id:N.id,userId:N.user_id,planId:N.plan_id,status:N.status,currentPeriodStart:N.current_period_start,currentPeriodEnd:N.current_period_end,trialStart:N.trial_start||void 0,trialEnd:N.trial_end||void 0,cancelledAt:N.cancelled_at||void 0,createdAt:N.created_at,updatedAt:N.updated_at,lastPaymentAt:N.last_payment_at||void 0,nextPaymentDue:N.next_payment_due||void 0}:null;t(Z),console.log("Subscription set:",Z)}catch(N){Ne.error("Failed to load subscription:",N),d(N?.message||"Failed to load subscription"),t(null),console.log("Subscription error:",N)}finally{l(!1)}},[e,y]),O=J.useCallback(async()=>{if(!$e){_(!1);return}try{const N=localStorage.getItem("navigator_trial_created"),q=localStorage.getItem("navigator_trial_user_id");if(!N||!q){_(!1);return}const Z=parseInt(N);if((Date.now()-Z)/(1e3*60*60)>25){console.log("Trial too old, clearing localStorage"),localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"),_(!1);return}const{data:ue,error:Y}=await $e.rpc("check_trial_access",{target_user_id:q});if(Y){console.warn("Server trial access check failed:",Y),_(!1);return}console.log("Server trial access result:",ue),_(ue?.hasAccess||!1),ue?.hasAccess||(localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"))}catch(N){console.warn("Server trial access check error:",N),_(!1)}},[]);J.useEffect(()=>{e?F():(t(null),l(!1)),O()},[e,F,O]);const M=J.useCallback(async()=>{if(!e||!$e)throw new Error("User not authenticated");if(r)throw new Error("User already has a subscription");try{y(),l(!0);const N=n[0],q=new Date,Z=new Date(q);Z.setDate(Z.getDate()+N.trialDays);const me={user_id:e.id,plan_id:N.id,status:"trial",current_period_start:q.toISOString(),current_period_end:Z.toISOString(),trial_start:q.toISOString(),trial_end:Z.toISOString(),created_at:q.toISOString(),updated_at:q.toISOString()},{error:ue}=await $e.from("user_subscriptions").insert(me);if(ue)throw ue;await F(),Ne.info("Trial started successfully")}catch(N){throw Ne.error("Failed to start trial:",N),d(N?.message||"Failed to start trial"),N}finally{l(!1)}},[e,r,n,y,F]),G=J.useCallback(async N=>{if(!e||!$e)throw new Error("User not authenticated");if(!n.find(Z=>Z.id===N))throw new Error("Invalid plan selected");try{y(),l(!0);const Z=new Date,me=new Date(Z);me.setMonth(me.getMonth()+1);const ue=r?{status:"active",plan_id:N,current_period_start:Z.toISOString(),current_period_end:me.toISOString(),last_payment_at:Z.toISOString(),next_payment_due:me.toISOString(),updated_at:Z.toISOString()}:{user_id:e.id,plan_id:N,status:"active",current_period_start:Z.toISOString(),current_period_end:me.toISOString(),last_payment_at:Z.toISOString(),next_payment_due:me.toISOString(),created_at:Z.toISOString(),updated_at:Z.toISOString()};if(r){const{error:Y}=await $e.from("user_subscriptions").update(ue).eq("id",r.id);if(Y)throw Y}else{const{error:Y}=await $e.from("user_subscriptions").insert(ue);if(Y)throw Y}await F(),Ne.info("Subscription activated successfully")}catch(Z){throw Ne.error("Failed to subscribe:",Z),d(Z?.message||"Failed to subscribe"),Z}finally{l(!1)}},[e,r,n,y,F]),I=J.useCallback(async()=>{if(!e||!$e||!r)throw new Error("No active subscription to cancel");try{y(),l(!0);const N=new Date,q={status:"cancelled",cancelled_at:N.toISOString(),updated_at:N.toISOString()},{error:Z}=await $e.from("user_subscriptions").update(q).eq("id",r.id);if(Z)throw Z;await F(),Ne.info("Subscription cancelled successfully")}catch(N){throw Ne.error("Failed to cancel subscription:",N),d(N?.message||"Failed to cancel subscription"),N}finally{l(!1)}},[e,r,y,F]);return{subscription:r,availablePlans:n,isLoading:a,error:c,isActive:S,isTrial:C,isExpired:b,daysRemaining:E,hasAccess:D,startTrial:M,subscribe:G,cancelSubscription:I,refreshSubscription:F,clearError:y}}function wy(e){const[r,t]=J.useState(!1),[n,a]=J.useState(!1),[l,c]=J.useState(null),[d,m]=J.useState(!0),[g,x]=J.useState(null),_=J.useCallback(()=>x(null),[]),y=J.useCallback(async()=>{if(!e||!$e){t(!1),a(!1),c(null),m(!1);return}try{m(!0),_();const{data:S,error:C}=await $e.rpc("is_admin",{user_uuid:e.id});if(C){t(!1),a(!1),c(null),m(!1);return}if(t(S||!1),S){const{data:b,error:E}=await $e.rpc("is_owner",{user_uuid:e.id});E?console.warn("Failed to check owner status:",E):a(b||!1);const{data:D,error:F}=await $e.from("admin_users").select("*").eq("user_id",e.id).single();F?console.warn("Failed to fetch admin user details:",F):c(D)}else a(!1),c(null)}catch(S){console.log("Admin check failed:",S.message),t(!1),a(!1),c(null)}finally{m(!1)}},[e,_]);return J.useEffect(()=>{y()},[y]),{isAdmin:r,isOwner:n,adminUser:l,isLoading:d,error:g,refreshAdmin:y,clearError:_}}function dD(e,r){const t=e/100;return new Intl.NumberFormat("en-GB",{style:"currency",currency:r,minimumFractionDigits:0,maximumFractionDigits:2}).format(t)}function Ld(e){return new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})}function fD({user:e,onClose:r}){const{subscription:t,availablePlans:n,isLoading:a,error:l,isActive:c,isTrial:d,isExpired:m,daysRemaining:g,hasAccess:x,startTrial:_,subscribe:y,cancelSubscription:S,clearError:C}=vm(e),{isOwner:b}=wy(e),[E,D]=J.useState(null),F=async()=>{try{D("trial"),await _()}catch{}finally{D(null)}},O=async G=>{try{D(`subscribe-${G}`),await y(G)}catch{}finally{D(null)}},M=async()=>{if(confirm("Are you sure you want to cancel your subscription? You will lose access at the end of your current billing period."))try{D("cancel"),await S()}catch{}finally{D(null)}};return a?h.jsx("div",{className:"subscription-manager",children:h.jsxs("div",{className:"subscription-loading",children:[h.jsx("div",{className:"spinner"}),h.jsx("p",{children:"Loading subscription..."})]})}):b?h.jsxs("div",{className:"subscription-manager",children:[h.jsxs("div",{className:"subscription-header",children:[h.jsx("h2",{children:"Owner Access"}),r&&h.jsx("button",{className:"close-button",onClick:r,"aria-label":"Close",children:""})]}),h.jsx("div",{className:"owner-status",children:h.jsxs("div",{className:"owner-card",children:[h.jsx("div",{className:"owner-badge",children:" OWNER"}),h.jsx("h3",{children:"Unlimited Access"}),h.jsx("p",{children:"As the owner, you have unrestricted access to all premium features:"}),h.jsx("div",{className:"owner-features",children:h.jsxs("ul",{children:[h.jsx("li",{children:" Route optimization for unlimited addresses"}),h.jsx("li",{children:" Commission tracking & reporting"}),h.jsx("li",{children:" Payment arrangements with SMS reminders"}),h.jsx("li",{children:" Daily/weekly earnings reports"}),h.jsx("li",{children:" Unlimited cloud sync & backup"}),h.jsx("li",{children:" Admin dashboard and user management"}),h.jsx("li",{children:" Priority customer support tools"})]})}),h.jsxs("div",{className:"owner-info",children:[h.jsx("h4",{children:"Business Status"}),h.jsxs("p",{children:[h.jsx("strong",{children:"Plan:"})," Owner Access (No subscription required)"]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Status:"})," ",h.jsx("span",{className:"status-active",children:"Active"})]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Billing:"})," N/A - Owner account"]})]}),h.jsxs("div",{className:"owner-actions",children:[h.jsx("p",{children:h.jsx("strong",{children:"Need to manage customer subscriptions?"})}),h.jsx("button",{className:"btn-secondary",onClick:r,style:{marginRight:"8px"},children:"Close"}),h.jsx("button",{className:"btn-primary",onClick:()=>{console.log("Redirect to admin dashboard"),r&&r()},children:"Go to Admin Dashboard"})]})]})})]}):h.jsxs("div",{className:"subscription-manager",children:[h.jsxs("div",{className:"subscription-header",children:[h.jsx("h2",{children:"Subscription Management"}),r&&h.jsx("button",{className:"close-button",onClick:r,"aria-label":"Close",children:""})]}),l&&h.jsxs("div",{className:"error-banner",children:[h.jsx("p",{children:l}),h.jsx("button",{onClick:C,children:"Dismiss"})]}),t?h.jsxs("div",{className:"current-subscription",children:[h.jsx("h3",{children:"Current Subscription"}),h.jsxs("div",{className:"subscription-card",children:[h.jsxs("div",{className:"subscription-info",children:[h.jsx("div",{className:"plan-name",children:n.find(G=>G.id===t.planId)?.name||"Unknown Plan"}),h.jsxs("div",{className:"subscription-status",children:[h.jsx("span",{className:`status-badge ${t.status}`,children:t.status.charAt(0).toUpperCase()+t.status.slice(1)}),d&&h.jsx("span",{className:"trial-badge",children:g>0?`${g} days remaining`:"Trial expired"})]})]}),h.jsxs("div",{className:"subscription-details",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Current Period:"})," ",Ld(t.currentPeriodStart)," - ",Ld(t.currentPeriodEnd)]}),t.nextPaymentDue&&c&&!d&&h.jsxs("p",{children:[h.jsx("strong",{children:"Next Payment:"})," ",Ld(t.nextPaymentDue)]}),t.cancelledAt&&h.jsxs("p",{children:[h.jsx("strong",{children:"Cancelled:"})," ",Ld(t.cancelledAt)]})]}),x&&h.jsxs("div",{className:"subscription-features",children:[h.jsx("h4",{children:"Your Features:"}),h.jsx("ul",{children:n.find(G=>G.id===t.planId)?.features.map((G,I)=>h.jsxs("li",{children:[" ",G]},I))})]}),h.jsxs("div",{className:"subscription-actions",children:[d&&g>0&&h.jsx("button",{className:"btn-primary",onClick:()=>O(t.planId),disabled:E!==null,children:E===`subscribe-${t.planId}`?"Processing...":"Upgrade to Paid"}),c&&!d&&h.jsx("button",{className:"btn-secondary",onClick:M,disabled:E!==null,children:E==="cancel"?"Processing...":"Cancel Subscription"})]})]})]}):h.jsxs("div",{className:"available-plans",children:[h.jsx("h3",{children:"Choose Your Plan"}),h.jsx("p",{className:"plans-intro",children:"Transform your enforcement work with our unified platform. Replace multiple expensive apps with one powerful solution."}),n.map(G=>h.jsxs("div",{className:"plan-card featured",children:[h.jsxs("div",{className:"plan-header",children:[h.jsx("h4",{children:G.name}),h.jsxs("div",{className:"plan-price",children:[h.jsx("span",{className:"price",children:dD(G.price,G.currency)}),h.jsx("span",{className:"period",children:"/month"})]})]}),h.jsx("div",{className:"plan-features",children:h.jsx("ul",{children:G.features.map((I,N)=>h.jsxs("li",{children:[" ",I]},N))})}),h.jsxs("div",{className:"plan-actions",children:[h.jsx("button",{className:"btn-primary full-width",onClick:F,disabled:E!==null,children:E==="trial"?"Starting Trial...":`Start ${G.trialDays}-Day Free Trial`}),h.jsx("p",{className:"trial-note",children:"No payment required  Cancel anytime  Full access during trial"})]})]},G.id)),h.jsxs("div",{className:"value-proposition",children:[h.jsx("h4",{children:"Why Enforcement Pro?"}),h.jsxs("div",{className:"comparison",children:[h.jsxs("div",{className:"comparison-item",children:[h.jsx("span",{className:"old-cost",children:"Route Planning App: 20-30/month"}),h.jsx("span",{className:"new-cost",children:" Included"})]}),h.jsxs("div",{className:"comparison-item",children:[h.jsx("span",{className:"old-cost",children:"SMS Service: 10-15/month"}),h.jsx("span",{className:"new-cost",children:" Included"})]}),h.jsxs("div",{className:"comparison-item",children:[h.jsx("span",{className:"old-cost",children:"Basic Tracking: 10-20/month"}),h.jsx("span",{className:"new-cost",children:" Included"})]}),h.jsx("div",{className:"total-savings",children:h.jsx("strong",{children:"Total Monthly Savings: 15-40"})})]})]})]}),m&&h.jsxs("div",{className:"access-warning",children:[h.jsx("h4",{children:" Subscription Expired"}),h.jsx("p",{children:"Your subscription has expired. Please renew to continue using premium features."}),h.jsx("button",{className:"btn-primary",onClick:()=>n[0]&&O(n[0].id),disabled:E!==null,children:"Renew Subscription"})]})]})}const hD=`
.subscription-manager {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  color: var(--text-color, #000);
}

.subscription-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  border-bottom: 1px solid var(--border-color, #e1e5e9);
  padding-bottom: 16px;
}

.subscription-header h2 {
  color: var(--text-color, #000);
  margin: 0;
}

.close-button {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  color: var(--text-color, #000);
}

.close-button:hover {
  background-color: var(--hover-bg, #f5f5f5);
}

.dark-mode .close-button:hover {
  background-color: var(--dark-hover-bg, #333);
}

.subscription-loading {
  text-align: center;
  padding: 40px;
  color: var(--text-color, #000);
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid var(--border-color, #f3f3f3);
  border-top: 4px solid #007bff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.error-banner {
  background-color: var(--error-bg, #fee);
  border: 1px solid var(--error-border, #fcc);
  border-radius: 4px;
  padding: 12px;
  margin-bottom: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: var(--error-text, #721c24);
}

.dark-mode .error-banner {
  background-color: var(--dark-error-bg, #4a1a1a);
  border-color: var(--dark-error-border, #8b2635);
  color: var(--dark-error-text, #ff6b6b);
}

.current-subscription, .available-plans {
  margin-bottom: 24px;
}

.current-subscription h3, .available-plans h3 {
  color: var(--text-color, #000);
  margin-bottom: 16px;
}

.subscription-card, .plan-card {
  border: 1px solid var(--border-color, #e1e5e9);
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 16px;
  background-color: var(--card-bg, #fff);
  color: var(--text-color, #000);
}

.dark-mode .subscription-card,
.dark-mode .plan-card {
  background-color: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.plan-card.featured {
  border-color: #007bff;
  position: relative;
  margin-top: 16px;
}

.plan-card.featured::before {
  content: 'Most Popular';
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  background: #007bff;
  color: white;
  padding: 6px 16px;
  font-size: 12px;
  font-weight: 600;
  border-radius: 16px;
  white-space: nowrap;
}

.status-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  text-transform: uppercase;
}

.status-badge.active { background: #d4edda; color: #155724; }
.status-badge.trial { background: #fff3cd; color: #856404; }
.status-badge.expired { background: #f8d7da; color: #721c24; }
.status-badge.cancelled { background: #e2e3e5; color: #6c757d; }

.trial-badge {
  margin-left: 8px;
  padding: 4px 8px;
  background: #e3f2fd;
  color: #1976d2;
  border-radius: 4px;
  font-size: 12px;
}

.dark-mode .trial-badge {
  background: var(--dark-secondary-bg, #2a4a5c);
  color: var(--dark-secondary-text, #87ceeb);
  border: 1px solid var(--dark-border-color, #444);
}

.plan-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 16px;
}

.plan-header h4 {
  color: var(--text-color, #000);
  margin: 0;
}

.plan-price .price {
  font-size: 24px;
  font-weight: bold;
  color: #007bff;
}

.plan-price .period {
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
}

.dark-mode .plan-price .period {
  color: var(--dark-secondary-text, #aaa);
}

.plan-features ul {
  list-style: none;
  padding: 0;
  margin: 16px 0;
}

.plan-features li {
  padding: 4px 0;
  color: #28a745;
}

.subscription-info .plan-name {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-color, #000);
  margin-bottom: 8px;
}

.subscription-details {
  margin: 16px 0;
  color: var(--text-color, #000);
}

.subscription-details p {
  margin: 8px 0;
  color: var(--text-color, #000);
}

.subscription-details strong {
  color: var(--text-color, #000);
}

.subscription-features h4 {
  color: var(--text-color, #000);
  margin: 16px 0 8px 0;
}

.subscription-actions, .plan-actions {
  margin-top: 20px;
}

.btn-primary, .btn-secondary {
  padding: 10px 20px;
  border-radius: 6px;
  border: none;
  font-weight: 500;
  cursor: pointer;
  margin-right: 8px;
  transition: background-color 0.2s;
}

.btn-primary {
  background: #007bff;
  color: white;
}

.btn-primary:hover:not(:disabled) {
  background: #0056b3;
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover:not(:disabled) {
  background: #545b62;
}

.btn-primary:disabled, .btn-secondary:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.full-width {
  width: 100%;
  margin-right: 0;
}

.trial-note {
  text-align: center;
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
  margin-top: 8px;
}

.dark-mode .trial-note {
  color: var(--dark-secondary-text, #aaa);
}

.comparison {
  background: var(--secondary-bg, #f8f9fa);
  padding: 16px;
  border-radius: 6px;
  margin-top: 12px;
  color: var(--text-color, #000);
}

.dark-mode .comparison {
  background: var(--dark-secondary-bg, #333);
}

.comparison-item {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
}

.old-cost {
  color: var(--secondary-text, #6c757d);
  text-decoration: line-through;
}

.dark-mode .old-cost {
  color: var(--dark-secondary-text, #aaa);
}

.new-cost {
  color: #28a745;
  font-weight: 500;
}

.total-savings {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--border-color, #dee2e6);
  text-align: center;
  color: #007bff;
}

.dark-mode .total-savings {
  border-top-color: var(--dark-border-color, #555);
}

.access-warning {
  background: var(--warning-bg, #fff3cd);
  border: 1px solid var(--warning-border, #ffeaa7);
  border-radius: 6px;
  padding: 16px;
  text-align: center;
  color: var(--warning-text, #856404);
}

.dark-mode .access-warning {
  background: var(--dark-warning-bg, #4a3c1a);
  border-color: var(--dark-warning-border, #8b7355);
  color: var(--dark-warning-text, #ffc107);
}

.access-warning h4 {
  color: var(--warning-text, #856404);
  margin: 0 0 8px 0;
}

.dark-mode .access-warning h4 {
  color: var(--dark-warning-text, #ffc107);
}

.value-proposition h4 {
  color: var(--text-color, #000);
  margin: 16px 0 12px 0;
}

.plans-intro {
  color: var(--text-color, #000);
  margin-bottom: 20px;
}

.owner-status {
  margin-bottom: 24px;
}

.owner-card {
  border: 2px solid #28a745;
  border-radius: 12px;
  padding: 24px;
  background: linear-gradient(135deg, #f8fff9 0%, #e8f5e8 100%);
  text-align: center;
}

.owner-badge {
  display: inline-block;
  background: #28a745;
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 16px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.owner-features {
  margin: 20px 0;
  text-align: left;
}

.owner-features ul {
  list-style: none;
  padding: 0;
  max-width: 400px;
  margin: 0 auto;
}

.owner-features li {
  padding: 6px 0;
  color: #28a745;
  font-weight: 500;
}

.owner-info {
  background: var(--card-bg, white);
  border-radius: 8px;
  padding: 16px;
  margin: 20px 0;
  border: 1px solid #d4edda;
  color: var(--text-color, #000);
}

.dark-mode .owner-info {
  background: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.owner-info h4 {
  margin: 0 0 12px 0;
  color: #28a745;
}

.owner-info p {
  margin: 8px 0;
  text-align: left;
  color: var(--text-color, #000);
}

.status-active {
  color: #28a745;
  font-weight: 600;
}

.owner-actions {
  margin-top: 24px;
}

.owner-actions p {
  margin-bottom: 16px;
  font-weight: 500;
  color: var(--text-color, #000);
}

.owner-card h3 {
  color: var(--text-color, #000);
  margin: 0 0 16px 0;
}

.owner-card p {
  color: var(--text-color, #000);
}

.dark-mode .owner-card {
  background: linear-gradient(135deg, #2a4a2a 0%, #1a3a1a 100%);
}
`;if(typeof document<"u"){const e=document.createElement("style");e.textContent=hD,document.head.appendChild(e)}function mD({user:e,onClose:r}){const[t,n]=J.useState(null),[a,l]=J.useState([]),[c,d]=J.useState([]),[m,g]=J.useState(!0),[x,_]=J.useState(null),[y,S]=J.useState("subscriptions"),[C,b]=J.useState(""),[E,D]=J.useState(1),[F,O]=J.useState(7),[M,G]=J.useState(""),[I,N]=J.useState(null);J.useEffect(()=>{q()},[e]);const q=async()=>{if(!(!e||!$e))try{g(!0),_(null);const{data:se,error:ve}=await $e.rpc("is_admin",{user_uuid:e.id});if(ve)throw console.error("Admin check error:",ve),ve;if(!se)throw new Error("Access denied: Admin privileges required");const{data:ee,error:ce}=await $e.from("admin_users").select("*").eq("user_id",e.id).single();if(ce)throw ce;n(ee);const{data:V,error:ie}=await $e.rpc("get_admin_subscription_overview");if(ie)throw console.error("Subscription overview error:",ie),ie;l(V||[]);let Q=[];try{const{data:R,error:P}=await $e.from("admin_actions").select(`
            id,
            action_type,
            target_user_id,
            performed_at,
            details,
            admin_users!inner(email)
          `).order("performed_at",{ascending:!1}).limit(20);P?(console.warn("Admin actions table not found or error:",P),Q=[]):Q=R||[]}catch(R){console.warn("Failed to load admin actions:",R),Q=[]}const fe=(Q||[]).map(R=>({...R,admin_email:R.admin_users?.email||(Array.isArray(R.admin_users)?R.admin_users[0]?.email:null)}));d(fe)}catch(se){_(se.message||"Failed to load admin data")}finally{g(!1)}},Z=async()=>{if(!(!C||!$e))try{N("grant");const{error:se}=await $e.rpc("admin_grant_subscription",{target_user_id:C,plan_id:"enforcement_pro",duration_months:E,admin_notes:M||`Granted ${E} month(s) by admin`});if(se)throw se;await q(),b(""),D(1),G(""),alert("Subscription granted successfully!")}catch(se){alert("Failed to grant subscription: "+se.message)}finally{N(null)}},me=async()=>{if(!(!C||!$e))try{N("extend");const{error:se}=await $e.rpc("admin_extend_trial",{target_user_id:C,additional_days:F,admin_notes:M||`Extended trial by ${F} days`});if(se)throw se;await q(),b(""),O(7),G(""),alert("Trial extended successfully!")}catch(se){alert("Failed to extend trial: "+se.message)}finally{N(null)}},ue=se=>se?new Date(se).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",Y=se=>{const ee={active_trial:{color:"#fff3cd",label:"Active Trial"},active_paid:{color:"#d4edda",label:"Active Paid"},expired:{color:"#f8d7da",label:"Expired"},cancelled:{color:"#e2e3e5",label:"Cancelled"}}[se]||{color:"#f8f9fa",label:se};return h.jsx("span",{style:{backgroundColor:ee.color,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500"},children:ee.label})};return m?h.jsx("div",{className:"admin-dashboard",children:h.jsx("div",{className:"loading",children:"Loading admin dashboard..."})}):x?h.jsx("div",{className:"admin-dashboard",children:h.jsxs("div",{className:"error",children:[h.jsx("h3",{children:"Access Denied"}),h.jsx("p",{children:x}),r&&h.jsx("button",{onClick:r,children:"Close"})]})}):h.jsxs("div",{className:"admin-dashboard",children:[h.jsxs("div",{className:"admin-header",children:[h.jsx("h2",{children:"Admin Dashboard"}),h.jsxs("div",{className:"admin-info",children:[h.jsxs("span",{children:["Role: ",h.jsx("strong",{children:t?.role})]}),r&&h.jsx("button",{className:"close-button",onClick:r,children:""})]})]}),h.jsxs("div",{className:"admin-tabs",children:[h.jsxs("button",{className:y==="subscriptions"?"active":"",onClick:()=>S("subscriptions"),children:["Subscriptions (",a.length,")"]}),h.jsxs("button",{className:y==="actions"?"active":"",onClick:()=>S("actions"),children:["Recent Actions (",c.length,")"]}),h.jsx("button",{className:y==="settings"?"active":"",onClick:()=>S("settings"),children:"Settings"})]}),y==="subscriptions"&&h.jsxs("div",{className:"subscriptions-tab",children:[h.jsxs("div",{className:"stats-bar",children:[h.jsxs("div",{className:"stat",children:[h.jsx("strong",{children:a.filter(se=>se.subscription_status==="trial").length}),h.jsx("span",{children:"Active Trials"})]}),h.jsxs("div",{className:"stat",children:[h.jsx("strong",{children:a.filter(se=>se.subscription_status==="active").length}),h.jsx("span",{children:"Paid Subscriptions"})]}),h.jsxs("div",{className:"stat",children:[h.jsx("strong",{children:a.filter(se=>se.subscription_status==="expired").length}),h.jsx("span",{children:"Expired"})]}),h.jsxs("div",{className:"stat",children:[h.jsxs("strong",{children:["",a.filter(se=>se.subscription_status==="active").length*25]}),h.jsx("span",{children:"Monthly Revenue"})]})]}),h.jsxs("div",{className:"admin-actions-panel",children:[h.jsx("h3",{children:"Admin Actions"}),h.jsxs("div",{className:"admin-form",children:[h.jsxs("div",{className:"form-row",children:[h.jsx("label",{htmlFor:"selected-user-id",children:"Select User"}),h.jsxs("select",{id:"selected-user-id",name:"selectedUserId",value:C,onChange:se=>b(se.target.value),children:[h.jsx("option",{value:"",children:"Select User..."}),a.map(se=>h.jsxs("option",{value:se.user_email,children:[se.user_email," - ",Y(se.subscription_status).props.children]},se.user_email))]})]}),h.jsxs("div",{className:"form-row",children:[h.jsx("div",{className:"action-group",children:h.jsxs("div",{className:"input-group",children:[h.jsx("label",{htmlFor:"grant-months",children:"Grant Subscription (months):"}),h.jsx("input",{id:"grant-months",name:"grantMonths",type:"number",min:"1",max:"12",value:E,onChange:se=>D(parseInt(se.target.value)||1)}),h.jsx("button",{onClick:Z,disabled:!C||I!==null,children:I==="grant"?"Granting...":"Grant"})]})}),h.jsx("div",{className:"action-group",children:h.jsxs("div",{className:"input-group",children:[h.jsx("label",{htmlFor:"extend-days",children:"Extend Trial (days):"}),h.jsx("input",{id:"extend-days",name:"extendDays",type:"number",min:"1",max:"90",value:F,onChange:se=>O(parseInt(se.target.value)||7)}),h.jsx("button",{onClick:me,disabled:!C||I!==null,children:I==="extend"?"Extending...":"Extend"})]})})]}),h.jsxs("div",{className:"form-row",children:[h.jsx("label",{htmlFor:"admin-notes",children:"Admin notes (optional)"}),h.jsx("textarea",{id:"admin-notes",name:"adminNotes",placeholder:"Admin notes (optional)",value:M,onChange:se=>G(se.target.value),rows:2})]})]})]}),h.jsxs("div",{className:"subscriptions-table",children:[h.jsx("h3",{children:"All Subscriptions"}),h.jsxs("table",{children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"User Email"}),h.jsx("th",{children:"Status"}),h.jsx("th",{children:"Plan"}),h.jsx("th",{children:"API Requests"}),h.jsx("th",{children:"Created"}),h.jsx("th",{children:"Period End"})]})}),h.jsx("tbody",{children:a.map(se=>h.jsxs("tr",{children:[h.jsx("td",{children:se.user_email}),h.jsx("td",{children:Y(se.subscription_status)}),h.jsx("td",{children:se.subscription_plan||"No Plan"}),h.jsx("td",{children:se.total_api_requests||0}),h.jsx("td",{children:ue(se.subscription_created_at)}),h.jsx("td",{children:ue(se.current_period_end)})]},se.user_email))})]})]})]}),y==="actions"&&h.jsxs("div",{className:"actions-tab",children:[h.jsx("h3",{children:"Recent Admin Actions"}),h.jsx("div",{className:"actions-list",children:c.map(se=>h.jsxs("div",{className:"action-item",children:[h.jsxs("div",{className:"action-header",children:[h.jsx("strong",{children:se.action_type.replace("_"," ").toUpperCase()}),h.jsx("span",{className:"action-date",children:ue(se.performed_at)})]}),h.jsxs("div",{className:"action-details",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Admin:"})," ",se.admin_email]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Target User:"})," ",se.target_user_id]}),se.details&&h.jsxs("div",{className:"action-notes",children:[h.jsx("strong",{children:"Details:"}),h.jsx("pre",{children:JSON.stringify(se.details,null,2)})]})]})]},se.id))})]}),y==="settings"&&h.jsxs("div",{className:"settings-tab",children:[h.jsx("h3",{children:"Admin Settings"}),h.jsxs("div",{className:"settings-info",children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Your Role:"})," ",t?.role]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Permissions:"})," ",t?.permissions.join(", ")]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Account Created:"})," ",ue(t?.created_at||"")]})]}),h.jsxs("div",{className:"quick-stats",children:[h.jsx("h4",{children:"Quick Stats"}),h.jsxs("ul",{children:[h.jsxs("li",{children:["Total Users: ",a.length]}),h.jsxs("li",{children:["Active Trials: ",a.filter(se=>se.subscription_status==="trial").length]}),h.jsxs("li",{children:["Paid Customers: ",a.filter(se=>se.subscription_status==="active").length]}),h.jsxs("li",{children:["Monthly Revenue: ",a.filter(se=>se.subscription_status==="active").length*25]}),h.jsxs("li",{children:["Total Actions Performed: ",c.length]})]})]})]})]})}const pD=`
/* ==== Admin Dashboard Modern Styles ==== */
.admin-dashboard {
  max-width: 1200px;
  margin: 0 auto;
  padding: 1rem;
  background: var(--background);
  min-height: 100vh;
  overflow-x: hidden;
  box-sizing: border-box;
}

.admin-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  background: var(--surface);
  padding: 1rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
}

.admin-header h2 {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--text);
  margin: 0;
}

.admin-info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--text-muted);
  font-size: 0.75rem;
}

.close-button {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-muted);
}

.close-button:hover {
  background: var(--background);
  color: var(--text);
}

.admin-tabs {
  display: flex;
  gap: 0.25rem;
  margin-bottom: 1rem;
  background: var(--surface);
  padding: 0.25rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
}

.admin-tabs button {
  flex: 1;
  padding: 0.5rem 0.75rem;
  border: none;
  background: transparent;
  cursor: pointer;
  border-radius: var(--radius);
  font-weight: 500;
  color: var(--text-muted);
  transition: all 0.2s ease;
  position: relative;
  font-size: 0.75rem;
  text-align: center;
}

.admin-tabs button:hover {
  background: var(--background);
  color: var(--text);
}

.admin-tabs button.active {
  background: var(--primary);
  color: white;
}

.stats-bar {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.stat {
  background: var(--surface);
  padding: 0.75rem;
  border-radius: var(--radius);
  border: 1px solid var(--border-light);
  text-align: center;
  transition: all 0.2s ease;
}

.stat:hover {
  transform: translateY(-1px);
}

.stat strong {
  display: block;
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 0.25rem;
}

.stat span {
  font-size: 0.625rem;
  color: var(--text-muted);
  font-weight: 500;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  line-height: 1.2;
}

.admin-actions-panel {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  padding: 1rem;
  margin-bottom: 1rem;
}

.admin-actions-panel h3 {
  margin: 0 0 1rem 0;
  font-size: 1rem;
  font-weight: 600;
  color: var(--text);
}

.admin-form .form-row {
  margin-bottom: 1rem;
}

.admin-form label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 500;
  color: var(--text);
  font-size: 0.75rem;
}

.admin-form select,
.admin-form input,
.admin-form textarea {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  font-size: 0.75rem;
  transition: all 0.2s ease;
  background: var(--background);
  color: var(--text);
  box-sizing: border-box;
}

.admin-form select:focus,
.admin-form input:focus,
.admin-form textarea:focus {
  outline: none;
  border-color: var(--primary);
}

.form-row .action-group {
  display: flex;
  gap: 0.5rem;
  align-items: end;
  flex-wrap: wrap;
}

.input-group {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  flex: 1;
  min-width: 0;
}

.input-group label {
  margin: 0;
  font-size: 0.625rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-muted);
}

.input-group input {
  width: 80px;
  min-width: 60px;
}

.input-group button {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: var(--radius);
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s ease;
  font-size: 0.75rem;
  white-space: nowrap;
}

.input-group button:hover {
  background: var(--primary-hover);
  transform: translateY(-1px);
}

.input-group button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.subscriptions-table {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  overflow: hidden;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

.subscriptions-table h3 {
  margin: 0;
  padding: 0.75rem 1rem;
  background: var(--background);
  border-bottom: 1px solid var(--border-light);
  font-size: 1rem;
  font-weight: 600;
  color: var(--text);
}

.subscriptions-table table {
  width: 100%;
  border-collapse: collapse;
  min-width: 600px;
}

.subscriptions-table th,
.subscriptions-table td {
  padding: 0.5rem 0.75rem;
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.subscriptions-table th {
  background: var(--background);
  font-weight: 600;
  font-size: 0.625rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  white-space: nowrap;
}

.subscriptions-table td {
  font-size: 0.75rem;
  color: var(--text);
  white-space: nowrap;
}

.actions-list {
  max-height: 400px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
}

.action-item {
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  margin-bottom: 0.5rem;
  padding: 1rem;
  background: var(--surface);
  transition: all 0.2s ease;
}

.action-item:hover {
  transform: translateY(-1px);
}

.action-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 0.75rem;
  gap: 0.5rem;
}

.action-header strong {
  color: var(--primary);
  font-weight: 600;
  font-size: 0.75rem;
  flex: 1;
}

.action-date {
  color: var(--text-muted);
  font-size: 0.625rem;
  font-weight: 500;
  white-space: nowrap;
}

.action-details p {
  margin: 0.25rem 0;
  font-size: 0.75rem;
  color: var(--text);
}

.action-notes {
  margin-top: 0.75rem;
}

.action-notes pre {
  background: var(--background);
  padding: 0.75rem;
  border-radius: var(--radius);
  font-size: 0.625rem;
  overflow-x: auto;
  border: 1px solid var(--border-light);
  color: var(--text);
  white-space: pre-wrap;
  word-break: break-word;
}

.settings-info,
.quick-stats {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  padding: 1rem;
  margin-bottom: 1rem;
}

.settings-info h4,
.quick-stats h4 {
  margin: 0 0 0.75rem 0;
  color: var(--text);
  font-weight: 600;
  font-size: 1rem;
}

.settings-info p {
  margin: 0.5rem 0;
  color: var(--text);
  font-size: 0.75rem;
}

.quick-stats ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.quick-stats li {
  padding: 0.5rem 0;
  border-bottom: 1px solid var(--border-light);
  color: var(--text);
  display: flex;
  justify-content: space-between;
  font-size: 0.75rem;
  gap: 1rem;
}

.quick-stats li:last-child {
  border-bottom: none;
}

.loading,
.error {
  text-align: center;
  padding: 2rem 1rem;
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  margin: 1rem;
}

.error h3 {
  color: var(--danger);
  margin-bottom: 1rem;
  font-size: 1rem;
}

.loading {
  color: var(--text-muted);
  font-size: 0.875rem;
}

/* CSS Variables handle dark mode automatically through the app's theme system */

/* ==== Responsive Design - Mobile First ==== */
@media (max-width: 480px) {
  .admin-dashboard {
    padding: 0.5rem;
    margin: 0;
  }

  .admin-header {
    flex-direction: column;
    gap: 0.5rem;
    text-align: center;
    padding: 0.75rem;
  }

  .admin-header h2 {
    font-size: 1.125rem;
  }

  .admin-info {
    flex-direction: column;
    gap: 0.25rem;
    font-size: 0.625rem;
  }

  .admin-tabs {
    flex-direction: column;
    gap: 0.125rem;
  }

  .admin-tabs button {
    padding: 0.5rem;
    font-size: 0.75rem;
  }

  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.25rem;
  }

  .stat {
    padding: 0.5rem;
  }

  .stat strong {
    font-size: 1rem;
    margin-bottom: 0.125rem;
  }

  .stat span {
    font-size: 0.5rem;
  }

  .admin-actions-panel {
    padding: 0.75rem;
  }

  .form-row .action-group {
    flex-direction: column;
    gap: 0.5rem;
    align-items: stretch;
  }

  .input-group {
    flex-direction: row;
    align-items: center;
    gap: 0.5rem;
  }

  .input-group label {
    margin: 0;
    min-width: 60px;
    text-align: left;
    font-size: 0.5rem;
  }

  .input-group input {
    width: 60px;
    min-width: 60px;
  }

  .input-group button {
    padding: 0.5rem 0.75rem;
    font-size: 0.625rem;
  }

  .subscriptions-table h3 {
    padding: 0.5rem 0.75rem;
    font-size: 0.875rem;
  }

  .subscriptions-table th,
  .subscriptions-table td {
    padding: 0.375rem 0.5rem;
    font-size: 0.625rem;
  }

  .action-item {
    padding: 0.75rem;
  }

  .action-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.25rem;
  }

  .action-header strong {
    font-size: 0.625rem;
  }

  .action-date {
    font-size: 0.5rem;
  }

  .action-details p {
    font-size: 0.625rem;
    margin: 0.125rem 0;
  }

  .action-notes pre {
    padding: 0.5rem;
    font-size: 0.5rem;
  }

  .settings-info,
  .quick-stats {
    padding: 0.75rem;
  }

  .settings-info h4,
  .quick-stats h4 {
    font-size: 0.875rem;
  }

  .settings-info p,
  .quick-stats li {
    font-size: 0.625rem;
  }
}

@media (max-width: 360px) {
  .admin-dashboard {
    padding: 0.25rem;
  }

  .stats-bar {
    grid-template-columns: 1fr;
    gap: 0.25rem;
  }

  .stat strong {
    font-size: 0.875rem;
  }

  .stat span {
    font-size: 0.5rem;
  }

  .admin-tabs button {
    padding: 0.375rem;
    font-size: 0.625rem;
  }
}

/* Tablet optimizations */
@media (min-width: 481px) and (max-width: 768px) {
  .admin-dashboard {
    padding: 0.75rem;
  }

  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
  }

  .form-row .action-group {
    flex-wrap: wrap;
    gap: 0.75rem;
  }
}
`;if(typeof document<"u"&&!document.getElementById("admin-dashboard-styles")){const r=document.createElement("style");r.id="admin-dashboard-styles",r.textContent=pD,document.head.appendChild(r)}function gD({featureName:e,onUpgrade:r}){return h.jsxs("div",{className:"feature-locked",children:[h.jsx("div",{className:"lock-icon",children:""}),h.jsx("h3",{children:e}),h.jsx("p",{children:"This premium feature requires an active subscription."}),h.jsx("button",{className:"upgrade-button",onClick:r,children:"Upgrade to Enforcement Pro"})]})}function ky({user:e,fallback:r,children:t}){const{hasAccess:n,isLoading:a}=vm(e);return a?h.jsxs("div",{className:"subscription-loading",children:[h.jsx("div",{className:"spinner-small"}),h.jsx("span",{children:"Checking access..."})]}):n?h.jsx(h.Fragment,{children:t}):r?h.jsx(h.Fragment,{children:r}):h.jsx(gD,{featureName:"Premium Feature",onUpgrade:()=>{console.log("Upgrade clicked - implement subscription flow")}})}function vD({state:e,user:r}){const[t,n]=J.useState(()=>{const g=new Date;return g.setDate(1),g.toISOString().slice(0,10)}),[a,l]=J.useState(()=>new Date().toISOString().slice(0,10)),c=J.useMemo(()=>{const x=(e.completions||[]).filter(G=>{const I=G.timestamp.slice(0,10);return I>=t&&I<=a}),_=x.filter(G=>G.outcome==="PIF"),y=_.reduce((G,I)=>{const N=parseFloat(I.amount||"0");return G+(isNaN(N)?0:N)},0),S=x.length,C=_.length,b=x.filter(G=>G.outcome==="Done").length,E=x.filter(G=>G.outcome==="DA").length,D=x.filter(G=>G.outcome==="ARR").length,F=x.reduce((G,I)=>{const N=I.timestamp.slice(0,10);if(G[N]||(G[N]={date:N,pifs:0,total:0,fees:0}),G[N].total++,I.outcome==="PIF"){G[N].pifs++;const q=parseFloat(I.amount||"0");isNaN(q)||(G[N].fees+=q)}return G},{}),O=Object.values(F).map(G=>({...G,bonus:Math.max(0,G.pifs*100-100)})),M=O.reduce((G,I)=>G+I.bonus,0);return{totalPifFees:y,totalAddresses:S,pifCount:C,doneCount:b,daCount:E,arrCount:D,totalBonus:M,dailyStats:O.sort((G,I)=>I.date.localeCompare(G.date))}},[e.completions,t,a]),d=g=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2}).format(g),m=()=>{const g=new Date(t).toLocaleDateString("en-GB"),x=new Date(a).toLocaleDateString("en-GB");return`${g} - ${x}`};return h.jsx(ky,{user:r,fallback:h.jsx(xD,{}),children:h.jsxs("div",{className:"earnings-calendar",style:{padding:"1rem"},children:[h.jsx("h2",{children:"Earnings Overview"}),h.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",alignItems:"center",flexWrap:"wrap"},children:[h.jsxs("div",{children:[h.jsx("label",{htmlFor:"start-date",style:{display:"block",marginBottom:"0.5rem"},children:"From:"}),h.jsx("input",{id:"start-date",type:"date",value:t,onChange:g=>n(g.target.value),className:"input"})]}),h.jsxs("div",{children:[h.jsx("label",{htmlFor:"end-date",style:{display:"block",marginBottom:"0.5rem"},children:"To:"}),h.jsx("input",{id:"end-date",type:"date",value:a,onChange:g=>l(g.target.value),className:"input"})]})]}),h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[h.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[h.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--success)"},children:"Total PIF Fees"}),h.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:d(c.totalPifFees)}),h.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[c.pifCount," PIF completions"]})]}),h.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[h.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Total Addresses"}),h.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:c.totalAddresses}),h.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:m()})]}),h.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[h.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--primary)"},children:"Potential Bonus"}),h.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:d(c.totalBonus)}),h.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"100/PIF - 100/day"})]}),h.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[h.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Breakdown"}),h.jsxs("div",{style:{fontSize:"0.875rem"},children:[h.jsxs("div",{children:["PIF: ",c.pifCount]}),h.jsxs("div",{children:["Done: ",c.doneCount]}),h.jsxs("div",{children:["DA: ",c.daCount]}),h.jsxs("div",{children:["ARR: ",c.arrCount]})]})]})]}),h.jsxs("div",{children:[h.jsx("h3",{children:"Daily Breakdown"}),c.dailyStats.length===0?h.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No completions found in selected date range"}):h.jsx("div",{style:{overflowX:"auto"},children:h.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)"},children:[h.jsx("thead",{children:h.jsxs("tr",{style:{background:"var(--background)"},children:[h.jsx("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid var(--border-light)"},children:"Date"}),h.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIFs"}),h.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Total Addresses"}),h.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIF Fees"}),h.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Bonus"})]})}),h.jsx("tbody",{children:c.dailyStats.map(g=>h.jsxs("tr",{children:[h.jsx("td",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border-light)"},children:new Date(g.date).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})}),h.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:g.pifs}),h.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:g.total}),h.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold"},children:d(g.fees)}),h.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold",color:g.bonus>0?"var(--primary)":"var(--text-muted)"},children:d(g.bonus)})]},g.date))})]})})]})]})})}function xD(){return h.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",margin:"1rem"},children:[h.jsx("h2",{children:"Earnings Tracking"}),h.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--text-muted)"},children:"Track your PIF fees and completion statistics with detailed date range analysis."}),h.jsx("div",{style:{marginBottom:"1rem"},children:h.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",fontSize:"0.875rem"},children:"Premium Feature"})}),h.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Start your free trial to access earnings tracking and reporting."})]})}class yD{currentToken=null;generateToken(){return this.currentToken="session_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36),this.currentToken}getToken(){return this.currentToken}clearToken(){this.currentToken=null}}const qc=new yD;async function _D(e,r={}){const t="your-new-google-maps-api-key-here";if(!e.trim()||e.length<3)return[];try{const n=r.sessionToken||qc.generateToken(),a={input:e,sessionToken:n,...r.componentRestrictions&&{regionCode:r.componentRestrictions.country.toUpperCase()},...r.types&&r.types.length>0&&{includedPrimaryTypes:r.types}};console.log("Making Places API (New) autocomplete request:",a);const l=await fetch("https://places.googleapis.com/v1/places:autocomplete",{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":t,"X-Goog-FieldMask":"suggestions.placePrediction.place,suggestions.placePrediction.placeId,suggestions.placePrediction.text"},body:JSON.stringify(a)});if(!l.ok){const d=await l.text();throw console.error("Places API error:",l.status,d),new Error(`Places API error: ${l.status} - ${d}`)}const c=await l.json();return console.log("Places API response:",c),c.suggestions?c.suggestions.filter(d=>d.placePrediction).map(d=>({place_id:d.placePrediction.placeId,description:d.placePrediction.text?.text||"",structured_formatting:{main_text:d.placePrediction.structuredFormat?.mainText?.text||"",secondary_text:d.placePrediction.structuredFormat?.secondaryText?.text||""},types:d.placePrediction.types||[]})):[]}catch(n){throw console.error("Places API autocomplete failed:",n),n}}async function wD(e,r){const t="your-new-google-maps-api-key-here";try{console.log("Getting place details for:",e);const n=`https://places.googleapis.com/v1/places/${e}`,a=await fetch(n,{method:"GET",headers:{"X-Goog-Api-Key":t,"X-Goog-FieldMask":"id,displayName,formattedAddress,location,types"}});if(!a.ok){const c=await a.text();throw console.error("Place details API error:",a.status,c),new Error(`Place details API error: ${a.status} - ${c}`)}const l=await a.json();return console.log("Place details response:",l),r&&qc.clearToken(),l.id&&l.location?{place_id:l.id,name:l.displayName?.text||"",formatted_address:l.formattedAddress||"",geometry:{location:{lat:l.location.latitude,lng:l.location.longitude}},types:l.types||[]}:null}catch(n){throw console.error("Place details failed:",n),r&&qc.clearToken(),n}}function kD(){return qc.getToken()}function Jv(){qc.clearToken()}function by(e){if(e<60)return`${Math.round(e)}s`;const r=Math.floor(e/60);if(r<60)return`${r}m`;const t=Math.floor(r/60),n=r%60;return n>0?`${t}h ${n}m`:`${t}h`}function Sy(e){if(e<1e3)return`${Math.round(e)}m`;const r=e/1e3;return r<10?`${r.toFixed(1)}km`:`${Math.round(r)}km`}function Ty(e){return`${Math.round(e*100)}%`}const Qv="geocode-cache",s0=720*60*60*1e3;class bD{cache={};isLoadingCache=!1;cacheLoadPromise=null;apiKey;constructor(r){this.apiKey=r,this.cacheLoadPromise=this.loadCache()}async loadCache(){if(this.isLoadingCache)return this.cacheLoadPromise||Promise.resolve();this.isLoadingCache=!0;try{const r=await cm(Qv);r&&(this.cache={...r,...this.cache},this.cleanExpiredEntries())}catch(r){console.warn("Failed to load geocoding cache:",r)}finally{this.isLoadingCache=!1,this.cacheLoadPromise=null}}async saveCache(){try{await um(Qv,this.cache)}catch(r){console.warn("Failed to save geocoding cache:",r)}}cleanExpiredEntries(){const r=Date.now(),t=[];for(const[n,a]of Object.entries(this.cache))r-a.timestamp>s0&&t.push(n);for(const n of t)delete this.cache[n];t.length>0&&this.saveCache()}normalizeAddress(r){return r.trim().toLowerCase().replace(/\s+/g," ")}async geocodeAddressInternal(r){if(this.cacheLoadPromise&&await this.cacheLoadPromise,!this.apiKey)return{success:!1,address:r,originalAddress:r,error:"Google Maps API key not configured"};if(!r?.trim())return{success:!1,address:r,originalAddress:r,error:"Empty address provided"};const t=this.normalizeAddress(r),n=this.cache[t];if(n&&Date.now()-n.timestamp<s0)return n.result;try{console.log(`Geocoding with Google Maps SDK: "${r}"`);const{geocodeAddressSDK:a,isGoogleMapsSDKAvailable:l}=await Qa(async()=>{const{geocodeAddressSDK:c,isGoogleMapsSDKAvailable:d}=await import("./googleMapsSDK-CCdvlH9E.js");return{geocodeAddressSDK:c,isGoogleMapsSDKAvailable:d}},[]);if(l()){const c=await a(r);if(c.success)return this.cache[t]={result:c,timestamp:Date.now()},this.saveCache().catch(console.warn),c;this.cache[t]={result:c,timestamp:Date.now()},this.saveCache().catch(console.warn)}}catch(a){console.warn("JavaScript SDK geocoding failed, falling back to Supabase Edge Function:",a)}return{success:!1,address:r,originalAddress:r,error:"Google Maps direct geocoding not available"}}getCacheStats(){const r=Date.now();let t=0,n=0;for(const a of Object.values(this.cache))r-a.timestamp<s0?t++:n++;return{totalEntries:Object.keys(this.cache).length,validEntries:t,expiredEntries:n}}async clearCache(){this.cache={},await this.saveCache()}}let o0=null;function xm(){if(!o0){const e="your-new-google-maps-api-key-here";o0=new bD(e)}return o0}async function SD(e,r,t){const n=xm(),a=[],l=5;for(let d=0;d<e.length;d+=l){const m=e.slice(d,d+l),g=m.map(_=>n.geocodeAddressInternal(_)),x=await Promise.all(g);a.push(...x),t&&t(a.length,e.length,m[m.length-1]),d+l<e.length&&await new Promise(_=>setTimeout(_,200))}const c=a.filter(d=>!d.success).length;if(c>e.length*.5){console.warn(`${c}/${e.length} addresses failed with direct API, trying Supabase Edge Function...`);try{const{geocodeAddresses:d}=await Qa(async()=>{const{geocodeAddresses:g}=await Promise.resolve().then(()=>Ey);return{geocodeAddresses:g}},void 0),m=await d(e,t);return a.map((g,x)=>g.success?g:m[x])}catch(d){console.warn("Centralized batch geocoding also failed:",d)}}return a}async function TD(e,r,t="GB",n=5){if(!e.trim()||e.length<3)return[];try{console.log(`Searching addresses with Google Places API: "${e}"`);const l=await _D(e,{componentRestrictions:{country:t.toLowerCase()},types:["street_address","route","premise"]});if(l.length>0)return l.slice(0,n).map(c=>({label:c.description,coordinates:[0,0],confidence:.9,placeId:c.place_id}))}catch(l){console.warn("Google Places API search failed, trying Supabase Edge Function:",l)}try{const{searchAddresses:l}=await Qa(async()=>{const{searchAddresses:d}=await Promise.resolve().then(()=>Ey);return{searchAddresses:d}},void 0),c=await l(e,t,n);if(c.length>0)return c}catch(l){console.warn("Centralized address search also failed:",l)}const a=xm();if(a.apiKey)try{const l=await a.geocodeAddressInternal(e);if(l.success&&l.lat&&l.lng)return[{label:l.formattedAddress||l.address,coordinates:[l.lng,l.lat],confidence:l.confidence||.7}]}catch(l){console.warn("Direct geocoding fallback also failed:",l)}return[]}async function ED(e){if(!e)return null;try{const t=kD()||void 0,n=await wD(e,t);if(Jv(),n?.geometry?.location)return{lat:n.geometry.location.lat,lng:n.geometry.location.lng,formattedAddress:n.formatted_address||n.name||""}}catch(t){Jv(),console.error("Failed to resolve place details with new API:",t)}const r=xm();if(r.apiKey)try{const t=await r.geocodeAddressInternal(e);if(t.success&&t.lat&&t.lng)return{lat:t.lat,lng:t.lng,formattedAddress:t.formattedAddress||t.address}}catch(t){console.warn("Geocoding fallback for place resolution failed:",t)}return null}async function CD(e,r){if(!$e)throw new Error("Supabase client not available");try{console.log(`Geocoding ${e.length} addresses via centralized service`);const t=[],n=10;for(let a=0;a<e.length;a+=n){const l=e.slice(a,a+n),{data:c,error:d}=await $e.functions.invoke("geocode",{body:{addresses:l,countryCode:"GB"}});if(d){console.error("Geocoding batch error:",d);const m=l.map(g=>({success:!1,address:g,originalAddress:g,error:d.message||"Geocoding service error"}));t.push(...m)}else if(c?.results)t.push(...c.results);else{console.error("Unexpected geocoding response:",c);const m=l.map(g=>({success:!1,address:g,originalAddress:g,error:"Unexpected service response"}));t.push(...m)}r&&r(t.length,e.length,l[l.length-1])}return console.log(`Geocoding completed: ${t.filter(a=>a.success).length}/${t.length} successful`),t}catch(t){return console.error("Geocoding service failed:",t),e.map(n=>({success:!1,address:n,originalAddress:n,error:t instanceof Error?t.message:"Service unavailable"}))}}async function AD(e,r="GB",t=5,n,a){if(!$e)return console.error("Supabase client not available for address search"),[];try{if(!e.trim()||e.length<3)return[];const{data:l,error:c}=await $e.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:r,limit:Math.min(t,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return c?(console.error("Address search error:",c),[]):l?.results||[]}catch(l){return console.error("Address search failed:",l),[]}}function O0(e){const r=e.lat!==null&&e.lat!==void 0&&e.lng!==null&&e.lng!==void 0&&!isNaN(e.lat)&&!isNaN(e.lng);return{success:r,address:e.address,originalAddress:e.address,lat:r&&e.lat!==null?e.lat:void 0,lng:r&&e.lng!==null?e.lng:void 0,confidence:r?1:void 0,error:r?void 0:"No coordinates available"}}function Bd(e){return{address:e.address,lat:e.success&&e.lat!==void 0?e.lat:null,lng:e.success&&e.lng!==void 0?e.lng:null}}const Ey=Object.freeze(Object.defineProperty({__proto__:null,addressRowToGeocodingResult:O0,formatConfidence:Ty,formatDistance:Sy,formatDuration:by,geocodeAddresses:CD,geocodingResultToAddressRow:Bd,searchAddresses:AD},Symbol.toStringTag,{value:"Module"}));async function Cy(e,r){console.log(`Geocoding ${e.length} addresses via Google Maps (hybrid service)`);try{const t=await SD(e,void 0,r);return console.log(`Google Maps geocoding completed: ${t.filter(n=>n.success).length}/${t.length} successful`),t}catch(t){return console.error("Google Maps geocoding service failed:",t),e.map(n=>({success:!1,address:n,originalAddress:n,error:t instanceof Error?t.message:"Google Maps service unavailable"}))}}async function PD(e,r="GB",t=5,n,a){try{const l=await TD(e);if(l.length>0)return l.slice(0,t)}catch(l){console.warn("Google Maps search failed, falling back to centralized service:",l)}if(!$e)return console.error("No search services available"),[];try{if(!e.trim()||e.length<3)return[];const{data:l,error:c}=await $e.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:r,limit:Math.min(t,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return c?(console.error("Address search error:",c),[]):l?.results||[]}catch(l){return console.error("Address search failed:",l),[]}}async function ND(e,r,t){if(!$e)throw new Error("Supabase client not available");try{const n=e.map((d,m)=>({...d,originalIndex:m})).filter(({lat:d,lng:m})=>d!=null&&m!==null&&m!==void 0&&!isNaN(d)&&!isNaN(m));if(n.length===0)return{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((d,m)=>m),error:"No addresses have valid coordinates for route optimization"};if(n.length===1)return{success:!0,optimizedOrder:[n[0].originalIndex],totalDistance:0,totalDuration:0,unassigned:[]};console.log(`Optimizing route for ${n.length} addresses via OpenRouteService (hybrid service)`);const a={addresses:n.map(d=>({address:d.address,lat:d.lat,lng:d.lng})),startLocation:r,endLocation:t};console.log("Route optimization request:",{addressCount:a.addresses.length,hasStartLocation:!!r,hasEndLocation:!!t,firstAddress:a.addresses[0]});let l=null,c=null;try{const d="https://eevfxrgemrtthxbcxtvq.supabase.co",m="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",g=`${d}/functions/v1/optimize-route`,x=(await $e.auth.getSession()).data.session?.access_token;console.log("Making direct request to Edge Function:",{url:g,hasAuthToken:!!x,requestBodySize:JSON.stringify(a).length});const _={"Content-Type":"application/json",apikey:m};x&&(_.Authorization=`Bearer ${x}`);const y=await fetch(g,{method:"POST",headers:_,body:JSON.stringify(a)});if(console.log("Edge Function response status:",{status:y.status,statusText:y.statusText,ok:y.ok,headers:Object.fromEntries(y.headers.entries())}),y.ok)l=await y.json();else{const S=await y.text();console.error("Edge Function error response:",{status:y.status,statusText:y.statusText,body:S});try{const C=JSON.parse(S);c=new Error(`Edge Function error (${y.status}): ${C.error||S}`)}catch{c=new Error(`Edge Function error (${y.status}): ${S}`)}}}catch(d){console.error("Failed to make direct request to Edge Function:",d);const m=await $e.functions.invoke("optimize-route",{body:a});l=m.data,c=m.error}if(c){console.error("Route optimization error details:",{error:c,errorMessage:c.message,errorName:c.name,errorStack:c.stack,data:l});let d="Route optimization service error";return c.message?.includes("OpenRouteService API key")?d="Route optimization service not configured. Please contact support.":c.message?.includes("non-2xx status code")?d="Route optimization service is temporarily unavailable. Please try again later.":c.message?.includes("Unauthorized")?d="Authentication required. Please log in again.":c.message?.includes("Subscription required")&&(d="Route optimization requires an active subscription."),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((m,g)=>g),error:d}}return console.log("Route optimization response received:",{hasData:!!l,dataKeys:l?Object.keys(l):null,success:l?.success}),l?(console.log(`Route optimization completed: ${l.optimizedOrder?.length||0} addresses optimized`),l):(console.error("Route optimization: No data received from Edge Function"),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((d,m)=>m),error:"No response from optimization service"})}catch(n){return console.error("Route optimization failed:",n),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((a,l)=>l),error:n instanceof Error?n.message:"Unknown error occurred"}}}async function DD(e,r,t){if(!$e)return{success:!1,routeSegments:[],error:"Supabase client not available"};try{const n=[];t&&n.push(t);for(const c of r){const d=e[c];d.lat&&d.lng&&n.push([d.lng,d.lat])}if(n.length<2)return{success:!1,routeSegments:[],error:"Need at least 2 waypoints to generate route"};const{data:a,error:l}=await $e.functions.invoke("get-route-directions",{body:{coordinates:n,profile:"driving-car"}});return l?(console.error("Route directions error:",l),{success:!1,routeSegments:[],error:l.message||"Failed to get route directions"}):{success:!0,routeSegments:a?.segments||[],error:void 0}}catch(n){return console.error("Failed to get route directions:",n),{success:!1,routeSegments:[],error:n instanceof Error?n.message:"Unknown error occurred"}}}function OD({id:e,value:r,onChange:t,onSelect:n,placeholder:a="Start typing an address...",disabled:l=!1,className:c="input"}){const[d,m]=J.useState([]),[g,x]=J.useState(!1),[_,y]=J.useState(!1),[S,C]=J.useState(-1),b=J.useRef(null),E=J.useRef(null),D=J.useRef(),F=J.useCallback(async N=>{if(!N.trim()||N.length<3){J.startTransition(()=>{m([]),y(!1)});return}x(!0);try{const q=await PD(N);J.startTransition(()=>{m(q),y(q.length>0),C(-1)})}catch(q){console.error("Address search failed:",q),J.startTransition(()=>{m([]),y(!1)})}finally{x(!1)}},[]),O=N=>{const q=N.target.value;t(q),D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{F(q)},300)},M=async N=>{if(N.placeId){x(!0);try{const q=await ED(N.placeId);q?(t(N.label),n(N.label,q.lat,q.lng)):(t(N.label),n(N.label,0,0))}catch(q){console.error("Failed to resolve place details:",q),t(N.label),n(N.label,0,0)}finally{x(!1)}}else{const[q,Z]=N.coordinates;t(N.label),n(N.label,Z,q)}J.startTransition(()=>{y(!1),C(-1),m([])}),setTimeout(()=>{b.current?.blur()},0)},G=N=>{if(!(!_||d.length===0))switch(N.key){case"ArrowDown":N.preventDefault(),C(q=>q<d.length-1?q+1:q);break;case"ArrowUp":N.preventDefault(),C(q=>q>0?q-1:-1);break;case"Enter":N.preventDefault(),S>=0&&S<d.length&&M(d[S]);break;case"Escape":J.startTransition(()=>{y(!1),C(-1)}),setTimeout(()=>{b.current?.blur()},0);break}};J.useEffect(()=>{const N=q=>{try{b.current&&!b.current.contains(q.target)&&E.current&&!E.current.contains(q.target)&&J.startTransition(()=>{y(!1),C(-1)})}catch(Z){console.debug("Click outside detection error (ignoring):",Z)}};return document.addEventListener("mousedown",N),()=>{try{document.removeEventListener("mousedown",N)}catch(q){console.debug("Event listener cleanup error (ignoring):",q)}}},[]),J.useEffect(()=>()=>{D.current&&clearTimeout(D.current)},[]);const I=N=>N>=.8?"var(--success)":N>=.5?"var(--warning)":"var(--danger)";return h.jsxs("div",{style:{position:"relative",width:"100%"},children:[h.jsxs("div",{style:{position:"relative"},children:[h.jsx("input",{id:e,ref:b,name:"address",type:"text",value:r,onChange:O,onKeyDown:G,onFocus:()=>{d.length>0&&y(!0)},placeholder:a,disabled:l,className:c,style:{width:"100%",paddingRight:g?"2.5rem":"1rem"},autoComplete:"off"}),g&&h.jsx("div",{style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem"},children:h.jsx("div",{className:"spinner",style:{width:"100%",height:"100%"}})})]}),_&&d.length>0&&h.jsx("div",{ref:E,style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",maxHeight:"300px",overflowY:"auto",marginTop:"0.25rem"},children:d.map((N,q)=>h.jsxs("button",{onClick:()=>{setTimeout(()=>M(N),0)},style:{width:"100%",padding:"0.75rem 1rem",border:"none",background:S===q?"var(--primary-light)":"transparent",color:S===q?"var(--primary)":"var(--text-primary)",textAlign:"left",cursor:"pointer",borderBottom:q<d.length-1?"1px solid var(--border-light)":"none",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem",lineHeight:"1.4"},onMouseEnter:()=>C(q),children:[h.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis"},children:N.label}),h.jsxs("span",{style:{fontSize:"0.75rem",color:I(N.confidence),marginLeft:"0.5rem",flexShrink:0},title:`Confidence: ${Math.round(N.confidence*100)}%`,children:[Math.round(N.confidence*100),"%"]})]},`${N.label}-${q}`))}),_&&d.length===0&&!g&&r.length>=3&&h.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",padding:"1rem",marginTop:"0.25rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.875rem"},children:/[A-Z]{1,2}[0-9]{1,2}\s?[0-9][A-Z]{2}/i.test(r)?"Address not found. Try removing the house number or use just the postcode.":'No addresses found. Try including the postcode (e.g., "High Street SW1A 1AA").'})]})}function Ay(e,r){const t=J.useRef(r);J.useEffect(function(){r!==t.current&&e.attributionControl!=null&&(t.current!=null&&e.attributionControl.removeAttribution(t.current),r!=null&&e.attributionControl.addAttribution(r)),t.current=r},[e,r])}const ID=1;function FD(e){return Object.freeze({__version:ID,map:e})}function Py(e,r){return Object.freeze({...e,...r})}const Ny=J.createContext(null),Dy=Ny.Provider;function cf(){const e=J.useContext(Ny);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function Oy(e){function r(t,n){const{instance:a,context:l}=e(t).current;return J.useImperativeHandle(n,()=>a),t.children==null?null:Tr.createElement(Dy,{value:l},t.children)}return J.forwardRef(r)}function LD(e){function r(t,n){const[a,l]=J.useState(!1),{instance:c}=e(t,l).current;J.useImperativeHandle(n,()=>c),J.useEffect(function(){a&&c.update()},[c,a,t.children]);const d=c._contentNode;return d?_y.createPortal(t.children,d):null}return J.forwardRef(r)}function RD(e){function r(t,n){const{instance:a}=e(t).current;return J.useImperativeHandle(n,()=>a),null}return J.forwardRef(r)}function ym(e,r){const t=J.useRef();J.useEffect(function(){return r!=null&&e.instance.on(r),t.current=r,function(){t.current!=null&&e.instance.off(t.current),t.current=null}},[e,r])}function uf(e,r){const t=e.pane??r.pane;return t?{...e,pane:t}:e}function jD(e,r){return function(n,a){const l=cf(),c=e(uf(n,l),l);return Ay(l.map,n.attribution),ym(c.current,n.eventHandlers),r(c.current,l,n,a),c}}var Ec={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var MD=Ec.exports,ex;function BD(){return ex||(ex=1,(function(e,r){(function(t,n){n(r)})(MD,(function(t){var n="1.9.4";function a(s){var u,p,w,A;for(p=1,w=arguments.length;p<w;p++){A=arguments[p];for(u in A)s[u]=A[u]}return s}var l=Object.create||(function(){function s(){}return function(u){return s.prototype=u,new s}})();function c(s,u){var p=Array.prototype.slice;if(s.bind)return s.bind.apply(s,p.call(arguments,1));var w=p.call(arguments,2);return function(){return s.apply(u,w.length?w.concat(p.call(arguments)):arguments)}}var d=0;function m(s){return"_leaflet_id"in s||(s._leaflet_id=++d),s._leaflet_id}function g(s,u,p){var w,A,z,de;return de=function(){w=!1,A&&(z.apply(p,A),A=!1)},z=function(){w?A=arguments:(s.apply(p,arguments),setTimeout(de,u),w=!0)},z}function x(s,u,p){var w=u[1],A=u[0],z=w-A;return s===w&&p?s:((s-A)%z+z)%z+A}function _(){return!1}function y(s,u){if(u===!1)return s;var p=Math.pow(10,u===void 0?6:u);return Math.round(s*p)/p}function S(s){return s.trim?s.trim():s.replace(/^\s+|\s+$/g,"")}function C(s){return S(s).split(/\s+/)}function b(s,u){Object.prototype.hasOwnProperty.call(s,"options")||(s.options=s.options?l(s.options):{});for(var p in u)s.options[p]=u[p];return s.options}function E(s,u,p){var w=[];for(var A in s)w.push(encodeURIComponent(p?A.toUpperCase():A)+"="+encodeURIComponent(s[A]));return(!u||u.indexOf("?")===-1?"?":"&")+w.join("&")}var D=/\{ *([\w_ -]+) *\}/g;function F(s,u){return s.replace(D,function(p,w){var A=u[w];if(A===void 0)throw new Error("No value provided for variable "+p);return typeof A=="function"&&(A=A(u)),A})}var O=Array.isArray||function(s){return Object.prototype.toString.call(s)==="[object Array]"};function M(s,u){for(var p=0;p<s.length;p++)if(s[p]===u)return p;return-1}var G="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function I(s){return window["webkit"+s]||window["moz"+s]||window["ms"+s]}var N=0;function q(s){var u=+new Date,p=Math.max(0,16-(u-N));return N=u+p,window.setTimeout(s,p)}var Z=window.requestAnimationFrame||I("RequestAnimationFrame")||q,me=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(s){window.clearTimeout(s)};function ue(s,u,p){if(p&&Z===q)s.call(u);else return Z.call(window,c(s,u))}function Y(s){s&&me.call(window,s)}var se={__proto__:null,extend:a,create:l,bind:c,get lastId(){return d},stamp:m,throttle:g,wrapNum:x,falseFn:_,formatNum:y,trim:S,splitWords:C,setOptions:b,getParamString:E,template:F,isArray:O,indexOf:M,emptyImageUrl:G,requestFn:Z,cancelFn:me,requestAnimFrame:ue,cancelAnimFrame:Y};function ve(){}ve.extend=function(s){var u=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},p=u.__super__=this.prototype,w=l(p);w.constructor=u,u.prototype=w;for(var A in this)Object.prototype.hasOwnProperty.call(this,A)&&A!=="prototype"&&A!=="__super__"&&(u[A]=this[A]);return s.statics&&a(u,s.statics),s.includes&&(ee(s.includes),a.apply(null,[w].concat(s.includes))),a(w,s),delete w.statics,delete w.includes,w.options&&(w.options=p.options?l(p.options):{},a(w.options,s.options)),w._initHooks=[],w.callInitHooks=function(){if(!this._initHooksCalled){p.callInitHooks&&p.callInitHooks.call(this),this._initHooksCalled=!0;for(var z=0,de=w._initHooks.length;z<de;z++)w._initHooks[z].call(this)}},u},ve.include=function(s){var u=this.prototype.options;return a(this.prototype,s),s.options&&(this.prototype.options=u,this.mergeOptions(s.options)),this},ve.mergeOptions=function(s){return a(this.prototype.options,s),this},ve.addInitHook=function(s){var u=Array.prototype.slice.call(arguments,1),p=typeof s=="function"?s:function(){this[s].apply(this,u)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(p),this};function ee(s){if(!(typeof L>"u"||!L||!L.Mixin)){s=O(s)?s:[s];for(var u=0;u<s.length;u++)s[u]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ce={on:function(s,u,p){if(typeof s=="object")for(var w in s)this._on(w,s[w],u);else{s=C(s);for(var A=0,z=s.length;A<z;A++)this._on(s[A],u,p)}return this},off:function(s,u,p){if(!arguments.length)delete this._events;else if(typeof s=="object")for(var w in s)this._off(w,s[w],u);else{s=C(s);for(var A=arguments.length===1,z=0,de=s.length;z<de;z++)A?this._off(s[z]):this._off(s[z],u,p)}return this},_on:function(s,u,p,w){if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}if(this._listens(s,u,p)===!1){p===this&&(p=void 0);var A={fn:u,ctx:p};w&&(A.once=!0),this._events=this._events||{},this._events[s]=this._events[s]||[],this._events[s].push(A)}},_off:function(s,u,p){var w,A,z;if(this._events&&(w=this._events[s],!!w)){if(arguments.length===1){if(this._firingCount)for(A=0,z=w.length;A<z;A++)w[A].fn=_;delete this._events[s];return}if(typeof u!="function"){console.warn("wrong listener type: "+typeof u);return}var de=this._listens(s,u,p);if(de!==!1){var ye=w[de];this._firingCount&&(ye.fn=_,this._events[s]=w=w.slice()),w.splice(de,1)}}},fire:function(s,u,p){if(!this.listens(s,p))return this;var w=a({},u,{type:s,target:this,sourceTarget:u&&u.sourceTarget||this});if(this._events){var A=this._events[s];if(A){this._firingCount=this._firingCount+1||1;for(var z=0,de=A.length;z<de;z++){var ye=A[z],Ae=ye.fn;ye.once&&this.off(s,Ae,ye.ctx),Ae.call(ye.ctx||this,w)}this._firingCount--}}return p&&this._propagateEvent(w),this},listens:function(s,u,p,w){typeof s!="string"&&console.warn('"string" type argument expected');var A=u;typeof u!="function"&&(w=!!u,A=void 0,p=void 0);var z=this._events&&this._events[s];if(z&&z.length&&this._listens(s,A,p)!==!1)return!0;if(w){for(var de in this._eventParents)if(this._eventParents[de].listens(s,u,p,w))return!0}return!1},_listens:function(s,u,p){if(!this._events)return!1;var w=this._events[s]||[];if(!u)return!!w.length;p===this&&(p=void 0);for(var A=0,z=w.length;A<z;A++)if(w[A].fn===u&&w[A].ctx===p)return A;return!1},once:function(s,u,p){if(typeof s=="object")for(var w in s)this._on(w,s[w],u,!0);else{s=C(s);for(var A=0,z=s.length;A<z;A++)this._on(s[A],u,p,!0)}return this},addEventParent:function(s){return this._eventParents=this._eventParents||{},this._eventParents[m(s)]=s,this},removeEventParent:function(s){return this._eventParents&&delete this._eventParents[m(s)],this},_propagateEvent:function(s){for(var u in this._eventParents)this._eventParents[u].fire(s.type,a({layer:s.target,propagatedFrom:s.target},s),!0)}};ce.addEventListener=ce.on,ce.removeEventListener=ce.clearAllEventListeners=ce.off,ce.addOneTimeEventListener=ce.once,ce.fireEvent=ce.fire,ce.hasEventListeners=ce.listens;var V=ve.extend(ce);function ie(s,u,p){this.x=p?Math.round(s):s,this.y=p?Math.round(u):u}var Q=Math.trunc||function(s){return s>0?Math.floor(s):Math.ceil(s)};ie.prototype={clone:function(){return new ie(this.x,this.y)},add:function(s){return this.clone()._add(fe(s))},_add:function(s){return this.x+=s.x,this.y+=s.y,this},subtract:function(s){return this.clone()._subtract(fe(s))},_subtract:function(s){return this.x-=s.x,this.y-=s.y,this},divideBy:function(s){return this.clone()._divideBy(s)},_divideBy:function(s){return this.x/=s,this.y/=s,this},multiplyBy:function(s){return this.clone()._multiplyBy(s)},_multiplyBy:function(s){return this.x*=s,this.y*=s,this},scaleBy:function(s){return new ie(this.x*s.x,this.y*s.y)},unscaleBy:function(s){return new ie(this.x/s.x,this.y/s.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Q(this.x),this.y=Q(this.y),this},distanceTo:function(s){s=fe(s);var u=s.x-this.x,p=s.y-this.y;return Math.sqrt(u*u+p*p)},equals:function(s){return s=fe(s),s.x===this.x&&s.y===this.y},contains:function(s){return s=fe(s),Math.abs(s.x)<=Math.abs(this.x)&&Math.abs(s.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function fe(s,u,p){return s instanceof ie?s:O(s)?new ie(s[0],s[1]):s==null?s:typeof s=="object"&&"x"in s&&"y"in s?new ie(s.x,s.y):new ie(s,u,p)}function R(s,u){if(s)for(var p=u?[s,u]:s,w=0,A=p.length;w<A;w++)this.extend(p[w])}R.prototype={extend:function(s){var u,p;if(!s)return this;if(s instanceof ie||typeof s[0]=="number"||"x"in s)u=p=fe(s);else if(s=P(s),u=s.min,p=s.max,!u||!p)return this;return!this.min&&!this.max?(this.min=u.clone(),this.max=p.clone()):(this.min.x=Math.min(u.x,this.min.x),this.max.x=Math.max(p.x,this.max.x),this.min.y=Math.min(u.y,this.min.y),this.max.y=Math.max(p.y,this.max.y)),this},getCenter:function(s){return fe((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,s)},getBottomLeft:function(){return fe(this.min.x,this.max.y)},getTopRight:function(){return fe(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(s){var u,p;return typeof s[0]=="number"||s instanceof ie?s=fe(s):s=P(s),s instanceof R?(u=s.min,p=s.max):u=p=s,u.x>=this.min.x&&p.x<=this.max.x&&u.y>=this.min.y&&p.y<=this.max.y},intersects:function(s){s=P(s);var u=this.min,p=this.max,w=s.min,A=s.max,z=A.x>=u.x&&w.x<=p.x,de=A.y>=u.y&&w.y<=p.y;return z&&de},overlaps:function(s){s=P(s);var u=this.min,p=this.max,w=s.min,A=s.max,z=A.x>u.x&&w.x<p.x,de=A.y>u.y&&w.y<p.y;return z&&de},isValid:function(){return!!(this.min&&this.max)},pad:function(s){var u=this.min,p=this.max,w=Math.abs(u.x-p.x)*s,A=Math.abs(u.y-p.y)*s;return P(fe(u.x-w,u.y-A),fe(p.x+w,p.y+A))},equals:function(s){return s?(s=P(s),this.min.equals(s.getTopLeft())&&this.max.equals(s.getBottomRight())):!1}};function P(s,u){return!s||s instanceof R?s:new R(s,u)}function W(s,u){if(s)for(var p=u?[s,u]:s,w=0,A=p.length;w<A;w++)this.extend(p[w])}W.prototype={extend:function(s){var u=this._southWest,p=this._northEast,w,A;if(s instanceof H)w=s,A=s;else if(s instanceof W){if(w=s._southWest,A=s._northEast,!w||!A)return this}else return s?this.extend(le(s)||U(s)):this;return!u&&!p?(this._southWest=new H(w.lat,w.lng),this._northEast=new H(A.lat,A.lng)):(u.lat=Math.min(w.lat,u.lat),u.lng=Math.min(w.lng,u.lng),p.lat=Math.max(A.lat,p.lat),p.lng=Math.max(A.lng,p.lng)),this},pad:function(s){var u=this._southWest,p=this._northEast,w=Math.abs(u.lat-p.lat)*s,A=Math.abs(u.lng-p.lng)*s;return new W(new H(u.lat-w,u.lng-A),new H(p.lat+w,p.lng+A))},getCenter:function(){return new H((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new H(this.getNorth(),this.getWest())},getSouthEast:function(){return new H(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(s){typeof s[0]=="number"||s instanceof H||"lat"in s?s=le(s):s=U(s);var u=this._southWest,p=this._northEast,w,A;return s instanceof W?(w=s.getSouthWest(),A=s.getNorthEast()):w=A=s,w.lat>=u.lat&&A.lat<=p.lat&&w.lng>=u.lng&&A.lng<=p.lng},intersects:function(s){s=U(s);var u=this._southWest,p=this._northEast,w=s.getSouthWest(),A=s.getNorthEast(),z=A.lat>=u.lat&&w.lat<=p.lat,de=A.lng>=u.lng&&w.lng<=p.lng;return z&&de},overlaps:function(s){s=U(s);var u=this._southWest,p=this._northEast,w=s.getSouthWest(),A=s.getNorthEast(),z=A.lat>u.lat&&w.lat<p.lat,de=A.lng>u.lng&&w.lng<p.lng;return z&&de},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(s,u){return s?(s=U(s),this._southWest.equals(s.getSouthWest(),u)&&this._northEast.equals(s.getNorthEast(),u)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function U(s,u){return s instanceof W?s:new W(s,u)}function H(s,u,p){if(isNaN(s)||isNaN(u))throw new Error("Invalid LatLng object: ("+s+", "+u+")");this.lat=+s,this.lng=+u,p!==void 0&&(this.alt=+p)}H.prototype={equals:function(s,u){if(!s)return!1;s=le(s);var p=Math.max(Math.abs(this.lat-s.lat),Math.abs(this.lng-s.lng));return p<=(u===void 0?1e-9:u)},toString:function(s){return"LatLng("+y(this.lat,s)+", "+y(this.lng,s)+")"},distanceTo:function(s){return Ce.distance(this,le(s))},wrap:function(){return Ce.wrapLatLng(this)},toBounds:function(s){var u=180*s/40075017,p=u/Math.cos(Math.PI/180*this.lat);return U([this.lat-u,this.lng-p],[this.lat+u,this.lng+p])},clone:function(){return new H(this.lat,this.lng,this.alt)}};function le(s,u,p){return s instanceof H?s:O(s)&&typeof s[0]!="object"?s.length===3?new H(s[0],s[1],s[2]):s.length===2?new H(s[0],s[1]):null:s==null?s:typeof s=="object"&&"lat"in s?new H(s.lat,"lng"in s?s.lng:s.lon,s.alt):u===void 0?null:new H(s,u,p)}var ge={latLngToPoint:function(s,u){var p=this.projection.project(s),w=this.scale(u);return this.transformation._transform(p,w)},pointToLatLng:function(s,u){var p=this.scale(u),w=this.transformation.untransform(s,p);return this.projection.unproject(w)},project:function(s){return this.projection.project(s)},unproject:function(s){return this.projection.unproject(s)},scale:function(s){return 256*Math.pow(2,s)},zoom:function(s){return Math.log(s/256)/Math.LN2},getProjectedBounds:function(s){if(this.infinite)return null;var u=this.projection.bounds,p=this.scale(s),w=this.transformation.transform(u.min,p),A=this.transformation.transform(u.max,p);return new R(w,A)},infinite:!1,wrapLatLng:function(s){var u=this.wrapLng?x(s.lng,this.wrapLng,!0):s.lng,p=this.wrapLat?x(s.lat,this.wrapLat,!0):s.lat,w=s.alt;return new H(p,u,w)},wrapLatLngBounds:function(s){var u=s.getCenter(),p=this.wrapLatLng(u),w=u.lat-p.lat,A=u.lng-p.lng;if(w===0&&A===0)return s;var z=s.getSouthWest(),de=s.getNorthEast(),ye=new H(z.lat-w,z.lng-A),Ae=new H(de.lat-w,de.lng-A);return new W(ye,Ae)}},Ce=a({},ge,{wrapLng:[-180,180],R:6371e3,distance:function(s,u){var p=Math.PI/180,w=s.lat*p,A=u.lat*p,z=Math.sin((u.lat-s.lat)*p/2),de=Math.sin((u.lng-s.lng)*p/2),ye=z*z+Math.cos(w)*Math.cos(A)*de*de,Ae=2*Math.atan2(Math.sqrt(ye),Math.sqrt(1-ye));return this.R*Ae}}),ke=6378137,xe={R:ke,MAX_LATITUDE:85.0511287798,project:function(s){var u=Math.PI/180,p=this.MAX_LATITUDE,w=Math.max(Math.min(p,s.lat),-p),A=Math.sin(w*u);return new ie(this.R*s.lng*u,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(s){var u=180/Math.PI;return new H((2*Math.atan(Math.exp(s.y/this.R))-Math.PI/2)*u,s.x*u/this.R)},bounds:(function(){var s=ke*Math.PI;return new R([-s,-s],[s,s])})()};function Ke(s,u,p,w){if(O(s)){this._a=s[0],this._b=s[1],this._c=s[2],this._d=s[3];return}this._a=s,this._b=u,this._c=p,this._d=w}Ke.prototype={transform:function(s,u){return this._transform(s.clone(),u)},_transform:function(s,u){return u=u||1,s.x=u*(this._a*s.x+this._b),s.y=u*(this._c*s.y+this._d),s},untransform:function(s,u){return u=u||1,new ie((s.x/u-this._b)/this._a,(s.y/u-this._d)/this._c)}};function te(s,u,p,w){return new Ke(s,u,p,w)}var Tt=a({},Ce,{code:"EPSG:3857",projection:xe,transformation:(function(){var s=.5/(Math.PI*xe.R);return te(s,.5,-s,.5)})()}),bt=a({},Tt,{code:"EPSG:900913"});function yt(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function ut(s,u){var p="",w,A,z,de,ye,Ae;for(w=0,z=s.length;w<z;w++){for(ye=s[w],A=0,de=ye.length;A<de;A++)Ae=ye[A],p+=(A?"L":"M")+Ae.x+" "+Ae.y;p+=u?et.svg?"z":"x":""}return p||"M0 0"}var Ue=document.documentElement.style,Pt="ActiveXObject"in window,rr=Pt&&!document.addEventListener,Mt="msLaunchUri"in navigator&&!("documentMode"in document),Zt=Mr("webkit"),Vr=Mr("android"),at=Mr("android 2")||Mr("android 3"),pr=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Jr=Vr&&Mr("Google")&&pr<537&&!("AudioNode"in window),Gr=!!window.opera,Vt=!Mt&&Mr("chrome"),Jt=Mr("gecko")&&!Zt&&!Gr&&!Pt,Rr=!Vt&&Mr("safari"),ct=Mr("phantom"),Rt="OTransition"in Ue,jr=navigator.platform.indexOf("Win")===0,Gt=Pt&&"transition"in Ue,Qr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!at,ri="MozPerspective"in Ue,ni=!window.L_DISABLE_3D&&(Gt||Qr||ri)&&!Rt&&!ct,Rn=typeof orientation<"u"||Mr("mobile"),ai=Rn&&Zt,ma=Rn&&Qr,Ie=!window.PointerEvent&&window.MSPointerEvent,Ye=!!(window.PointerEvent||Ie),Ge="ontouchstart"in window||!!window.TouchEvent,Ve=!window.L_NO_TOUCH&&(Ge||Ye),Qe=Rn&&Gr,gt=Rn&&Jt,ht=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,nt=(function(){var s=!1;try{var u=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("testPassiveEventSupport",_,u),window.removeEventListener("testPassiveEventSupport",_,u)}catch{}return s})(),ir=(function(){return!!document.createElement("canvas").getContext})(),sr=!!(document.createElementNS&&yt("svg").createSVGRect),gr=!!sr&&(function(){var s=document.createElement("div");return s.innerHTML="<svg/>",(s.firstChild&&s.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Qt=!sr&&(function(){try{var s=document.createElement("div");s.innerHTML='<v:shape adj="1"/>';var u=s.firstChild;return u.style.behavior="url(#default#VML)",u&&typeof u.adj=="object"}catch{return!1}})(),St=navigator.platform.indexOf("Mac")===0,Cs=navigator.platform.indexOf("Linux")===0;function Mr(s){return navigator.userAgent.toLowerCase().indexOf(s)>=0}var et={ie:Pt,ielt9:rr,edge:Mt,webkit:Zt,android:Vr,android23:at,androidStock:Jr,opera:Gr,chrome:Vt,gecko:Jt,safari:Rr,phantom:ct,opera12:Rt,win:jr,ie3d:Gt,webkit3d:Qr,gecko3d:ri,any3d:ni,mobile:Rn,mobileWebkit:ai,mobileWebkit3d:ma,msPointer:Ie,pointer:Ye,touch:Ve,touchNative:Ge,mobileOpera:Qe,mobileGecko:gt,retina:ht,passiveEvents:nt,canvas:ir,svg:sr,vml:Qt,inlineSvg:gr,mac:St,linux:Cs},B=et.msPointer?"MSPointerDown":"pointerdown",re=et.msPointer?"MSPointerMove":"pointermove",K=et.msPointer?"MSPointerUp":"pointerup",X=et.msPointer?"MSPointerCancel":"pointercancel",ne={touchstart:B,touchmove:re,touchend:K,touchcancel:X},ae={touchstart:Me,touchmove:Be,touchend:Be,touchcancel:Be},we={},De=!1;function be(s,u,p){return u==="touchstart"&&Ze(),ae[u]?(p=ae[u].bind(this,p),s.addEventListener(ne[u],p,!1),p):(console.warn("wrong event specified:",u),_)}function Te(s,u,p){if(!ne[u]){console.warn("wrong event specified:",u);return}s.removeEventListener(ne[u],p,!1)}function Ee(s){we[s.pointerId]=s}function Re(s){we[s.pointerId]&&(we[s.pointerId]=s)}function We(s){delete we[s.pointerId]}function Ze(){De||(document.addEventListener(B,Ee,!0),document.addEventListener(re,Re,!0),document.addEventListener(K,We,!0),document.addEventListener(X,We,!0),De=!0)}function Be(s,u){if(u.pointerType!==(u.MSPOINTER_TYPE_MOUSE||"mouse")){u.touches=[];for(var p in we)u.touches.push(we[p]);u.changedTouches=[u],s(u)}}function Me(s,u){u.MSPOINTER_TYPE_TOUCH&&u.pointerType===u.MSPOINTER_TYPE_TOUCH&&lr(u),Be(s,u)}function mt(s){var u={},p,w;for(w in s)p=s[w],u[w]=p&&p.bind?p.bind(s):p;return s=u,u.type="dblclick",u.detail=2,u.isTrusted=!1,u._simulated=!0,u}var zt=200;function $t(s,u){s.addEventListener("dblclick",u);var p=0,w;function A(z){if(z.detail!==1){w=z.detail;return}if(!(z.pointerType==="mouse"||z.sourceCapabilities&&!z.sourceCapabilities.firesTouchEvents)){var de=oi(z);if(!(de.some(function(Ae){return Ae instanceof HTMLLabelElement&&Ae.attributes.for})&&!de.some(function(Ae){return Ae instanceof HTMLInputElement||Ae instanceof HTMLSelectElement}))){var ye=Date.now();ye-p<=zt?(w++,w===2&&u(mt(z))):w=1,p=ye}}}return s.addEventListener("click",A),{dblclick:u,simDblclick:A}}function or(s,u){s.removeEventListener("dblclick",u.dblclick),s.removeEventListener("click",u.simDblclick)}var pa=Fi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),En=Fi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),jn=En==="webkitTransition"||En==="OTransition"?En+"End":"transitionend";function vr(s){return typeof s=="string"?document.getElementById(s):s}function ga(s,u){var p=s.style[u]||s.currentStyle&&s.currentStyle[u];if((!p||p==="auto")&&document.defaultView){var w=document.defaultView.getComputedStyle(s,null);p=w?w[u]:null}return p==="auto"?null:p}function it(s,u,p){var w=document.createElement(s);return w.className=u||"",p&&p.appendChild(w),w}function er(s){var u=s.parentNode;u&&u.removeChild(s)}function yo(s){for(;s.firstChild;)s.removeChild(s.firstChild)}function Oi(s){var u=s.parentNode;u&&u.lastChild!==s&&u.appendChild(s)}function va(s){var u=s.parentNode;u&&u.firstChild!==s&&u.insertBefore(s,u.firstChild)}function Ii(s,u){if(s.classList!==void 0)return s.classList.contains(u);var p=_o(s);return p.length>0&&new RegExp("(^|\\s)"+u+"(\\s|$)").test(p)}function vt(s,u){if(s.classList!==void 0)for(var p=C(u),w=0,A=p.length;w<A;w++)s.classList.add(p[w]);else if(!Ii(s,u)){var z=_o(s);Il(s,(z?z+" ":"")+u)}}function Kt(s,u){s.classList!==void 0?s.classList.remove(u):Il(s,S((" "+_o(s)+" ").replace(" "+u+" "," ")))}function Il(s,u){s.className.baseVal===void 0?s.className=u:s.className.baseVal=u}function _o(s){return s.correspondingElement&&(s=s.correspondingElement),s.className.baseVal===void 0?s.className:s.className.baseVal}function en(s,u){"opacity"in s.style?s.style.opacity=u:"filter"in s.style&&iu(s,u)}function iu(s,u){var p=!1,w="DXImageTransform.Microsoft.Alpha";try{p=s.filters.item(w)}catch{if(u===1)return}u=Math.round(u*100),p?(p.Enabled=u!==100,p.Opacity=u):s.style.filter+=" progid:"+w+"(opacity="+u+")"}function Fi(s){for(var u=document.documentElement.style,p=0;p<s.length;p++)if(s[p]in u)return s[p];return!1}function Mn(s,u,p){var w=u||new ie(0,0);s.style[pa]=(et.ie3d?"translate("+w.x+"px,"+w.y+"px)":"translate3d("+w.x+"px,"+w.y+"px,0)")+(p?" scale("+p+")":"")}function dr(s,u){s._leaflet_pos=u,et.any3d?Mn(s,u):(s.style.left=u.x+"px",s.style.top=u.y+"px")}function xa(s){return s._leaflet_pos||new ie(0,0)}var Nt,Li,wo;if("onselectstart"in document)Nt=function(){dt(window,"selectstart",lr)},Li=function(){Wt(window,"selectstart",lr)};else{var ii=Fi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Nt=function(){if(ii){var s=document.documentElement.style;wo=s[ii],s[ii]="none"}},Li=function(){ii&&(document.documentElement.style[ii]=wo,wo=void 0)}}function ko(){dt(window,"dragstart",lr)}function bo(){Wt(window,"dragstart",lr)}var As,Ps;function Ri(s){for(;s.tabIndex===-1;)s=s.parentNode;s.style&&(Bn(),As=s,Ps=s.style.outlineStyle,s.style.outlineStyle="none",dt(window,"keydown",Bn))}function Bn(){As&&(As.style.outlineStyle=Ps,As=void 0,Ps=void 0,Wt(window,"keydown",Bn))}function ya(s){do s=s.parentNode;while((!s.offsetWidth||!s.offsetHeight)&&s!==document.body);return s}function Xn(s){var u=s.getBoundingClientRect();return{x:u.width/s.offsetWidth||1,y:u.height/s.offsetHeight||1,boundingClientRect:u}}var Ns={__proto__:null,TRANSFORM:pa,TRANSITION:En,TRANSITION_END:jn,get:vr,getStyle:ga,create:it,remove:er,empty:yo,toFront:Oi,toBack:va,hasClass:Ii,addClass:vt,removeClass:Kt,setClass:Il,getClass:_o,setOpacity:en,testProp:Fi,setTransform:Mn,setPosition:dr,getPosition:xa,get disableTextSelection(){return Nt},get enableTextSelection(){return Li},disableImageDrag:ko,enableImageDrag:bo,preventOutline:Ri,restoreOutline:Bn,getSizedParentNode:ya,getScale:Xn};function dt(s,u,p,w){if(u&&typeof u=="object")for(var A in u)Ll(s,A,u[A],p);else{u=C(u);for(var z=0,de=u.length;z<de;z++)Ll(s,u[z],p,w)}return this}var Er="_leaflet_events";function Wt(s,u,p,w){if(arguments.length===1)Fl(s),delete s[Er];else if(u&&typeof u=="object")for(var A in u)So(s,A,u[A],p);else if(u=C(u),arguments.length===2)Fl(s,function(ye){return M(u,ye)!==-1});else for(var z=0,de=u.length;z<de;z++)So(s,u[z],p,w);return this}function Fl(s,u){for(var p in s[Er]){var w=p.split(/\d/)[0];(!u||u(w))&&So(s,w,null,null,p)}}var si={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ll(s,u,p,w){var A=u+m(p)+(w?"_"+m(w):"");if(s[Er]&&s[Er][A])return this;var z=function(ye){return p.call(w||s,ye||window.event)},de=z;!et.touchNative&&et.pointer&&u.indexOf("touch")===0?z=be(s,u,z):et.touch&&u==="dblclick"?z=$t(s,z):"addEventListener"in s?u==="touchstart"||u==="touchmove"||u==="wheel"||u==="mousewheel"?s.addEventListener(si[u]||u,z,et.passiveEvents?{passive:!1}:!1):u==="mouseenter"||u==="mouseleave"?(z=function(ye){ye=ye||window.event,Is(s,ye)&&de(ye)},s.addEventListener(si[u],z,!1)):s.addEventListener(u,de,!1):s.attachEvent("on"+u,z),s[Er]=s[Er]||{},s[Er][A]=z}function So(s,u,p,w,A){A=A||u+m(p)+(w?"_"+m(w):"");var z=s[Er]&&s[Er][A];if(!z)return this;!et.touchNative&&et.pointer&&u.indexOf("touch")===0?Te(s,u,z):et.touch&&u==="dblclick"?or(s,z):"removeEventListener"in s?s.removeEventListener(si[u]||u,z,!1):s.detachEvent("on"+u,z),s[Er][A]=null}function Jn(s){return s.stopPropagation?s.stopPropagation():s.originalEvent?s.originalEvent._stopped=!0:s.cancelBubble=!0,this}function To(s){return Ll(s,"wheel",Jn),this}function Ds(s){return dt(s,"mousedown touchstart dblclick contextmenu",Jn),s._leaflet_disable_click=!0,this}function lr(s){return s.preventDefault?s.preventDefault():s.returnValue=!1,this}function zn(s){return lr(s),Jn(s),this}function oi(s){if(s.composedPath)return s.composedPath();for(var u=[],p=s.target;p;)u.push(p),p=p.parentNode;return u}function Os(s,u){if(!u)return new ie(s.clientX,s.clientY);var p=Xn(u),w=p.boundingClientRect;return new ie((s.clientX-w.left)/p.x-u.clientLeft,(s.clientY-w.top)/p.y-u.clientTop)}var hf=et.linux&&et.chrome?window.devicePixelRatio:et.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function su(s){return et.edge?s.wheelDeltaY/2:s.deltaY&&s.deltaMode===0?-s.deltaY/hf:s.deltaY&&s.deltaMode===1?-s.deltaY*20:s.deltaY&&s.deltaMode===2?-s.deltaY*60:s.deltaX||s.deltaZ?0:s.wheelDelta?(s.wheelDeltaY||s.wheelDelta)/2:s.detail&&Math.abs(s.detail)<32765?-s.detail*20:s.detail?s.detail/-32765*60:0}function Is(s,u){var p=u.relatedTarget;if(!p)return!0;try{for(;p&&p!==s;)p=p.parentNode}catch{return!1}return p!==s}var Eo={__proto__:null,on:dt,off:Wt,stopPropagation:Jn,disableScrollPropagation:To,disableClickPropagation:Ds,preventDefault:lr,stop:zn,getPropagationPath:oi,getMousePosition:Os,getWheelDelta:su,isExternalTarget:Is,addListener:dt,removeListener:Wt},Co=V.extend({run:function(s,u,p,w){this.stop(),this._el=s,this._inProgress=!0,this._duration=p||.25,this._easeOutPower=1/Math.max(w||.5,.2),this._startPos=xa(s),this._offset=u.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ue(this._animate,this),this._step()},_step:function(s){var u=+new Date-this._startTime,p=this._duration*1e3;u<p?this._runFrame(this._easeOut(u/p),s):(this._runFrame(1),this._complete())},_runFrame:function(s,u){var p=this._startPos.add(this._offset.multiplyBy(s));u&&p._round(),dr(this._el,p),this.fire("step")},_complete:function(){Y(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(s){return 1-Math.pow(1-s,this._easeOutPower)}}),Ct=V.extend({options:{crs:Tt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(s,u){u=b(this,u),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(s),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),u.maxBounds&&this.setMaxBounds(u.maxBounds),u.zoom!==void 0&&(this._zoom=this._limitZoom(u.zoom)),u.center&&u.zoom!==void 0&&this.setView(le(u.center),u.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=En&&et.any3d&&!et.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),dt(this._proxy,jn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(s,u,p){if(u=u===void 0?this._zoom:this._limitZoom(u),s=this._limitCenter(le(s),u,this.options.maxBounds),p=p||{},this._stop(),this._loaded&&!p.reset&&p!==!0){p.animate!==void 0&&(p.zoom=a({animate:p.animate},p.zoom),p.pan=a({animate:p.animate,duration:p.duration},p.pan));var w=this._zoom!==u?this._tryAnimatedZoom&&this._tryAnimatedZoom(s,u,p.zoom):this._tryAnimatedPan(s,p.pan);if(w)return clearTimeout(this._sizeTimer),this}return this._resetView(s,u,p.pan&&p.pan.noMoveStart),this},setZoom:function(s,u){return this._loaded?this.setView(this.getCenter(),s,{zoom:u}):(this._zoom=s,this)},zoomIn:function(s,u){return s=s||(et.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+s,u)},zoomOut:function(s,u){return s=s||(et.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-s,u)},setZoomAround:function(s,u,p){var w=this.getZoomScale(u),A=this.getSize().divideBy(2),z=s instanceof ie?s:this.latLngToContainerPoint(s),de=z.subtract(A).multiplyBy(1-1/w),ye=this.containerPointToLatLng(A.add(de));return this.setView(ye,u,{zoom:p})},_getBoundsCenterZoom:function(s,u){u=u||{},s=s.getBounds?s.getBounds():U(s);var p=fe(u.paddingTopLeft||u.padding||[0,0]),w=fe(u.paddingBottomRight||u.padding||[0,0]),A=this.getBoundsZoom(s,!1,p.add(w));if(A=typeof u.maxZoom=="number"?Math.min(u.maxZoom,A):A,A===1/0)return{center:s.getCenter(),zoom:A};var z=w.subtract(p).divideBy(2),de=this.project(s.getSouthWest(),A),ye=this.project(s.getNorthEast(),A),Ae=this.unproject(de.add(ye).divideBy(2).add(z),A);return{center:Ae,zoom:A}},fitBounds:function(s,u){if(s=U(s),!s.isValid())throw new Error("Bounds are not valid.");var p=this._getBoundsCenterZoom(s,u);return this.setView(p.center,p.zoom,u)},fitWorld:function(s){return this.fitBounds([[-90,-180],[90,180]],s)},panTo:function(s,u){return this.setView(s,this._zoom,{pan:u})},panBy:function(s,u){if(s=fe(s).round(),u=u||{},!s.x&&!s.y)return this.fire("moveend");if(u.animate!==!0&&!this.getSize().contains(s))return this._resetView(this.unproject(this.project(this.getCenter()).add(s)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Co,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),u.noMoveStart||this.fire("movestart"),u.animate!==!1){vt(this._mapPane,"leaflet-pan-anim");var p=this._getMapPanePos().subtract(s).round();this._panAnim.run(this._mapPane,p,u.duration||.25,u.easeLinearity)}else this._rawPanBy(s),this.fire("move").fire("moveend");return this},flyTo:function(s,u,p){if(p=p||{},p.animate===!1||!et.any3d)return this.setView(s,u,p);this._stop();var w=this.project(this.getCenter()),A=this.project(s),z=this.getSize(),de=this._zoom;s=le(s),u=u===void 0?de:u;var ye=Math.max(z.x,z.y),Ae=ye*this.getZoomScale(de,u),Oe=A.distanceTo(w)||1,He=1.42,st=He*He;function _t(Bt){var Xi=Bt?-1:1,Cf=Bt?Ae:ye,Af=Ae*Ae-ye*ye+Xi*st*st*Oe*Oe,mi=2*Cf*st*Oe,pi=Af/mi,gi=Math.sqrt(pi*pi+1)-pi,Uo=gi<1e-9?-18:Math.log(gi);return Uo}function Cr(Bt){return(Math.exp(Bt)-Math.exp(-Bt))/2}function _r(Bt){return(Math.exp(Bt)+Math.exp(-Bt))/2}function vn(Bt){return Cr(Bt)/_r(Bt)}var rn=_t(0);function qi(Bt){return ye*(_r(rn)/_r(rn+He*Bt))}function rc(Bt){return ye*(_r(rn)*vn(rn+He*Bt)-Cr(rn))/st}function Ha(Bt){return 1-Math.pow(1-Bt,1.5)}var Cu=Date.now(),hi=(_t(1)-rn)/He,ra=p.duration?1e3*p.duration:1e3*hi*.8;function Yi(){var Bt=(Date.now()-Cu)/ra,Xi=Ha(Bt)*hi;Bt<=1?(this._flyToFrame=ue(Yi,this),this._move(this.unproject(w.add(A.subtract(w).multiplyBy(rc(Xi)/Oe)),de),this.getScaleZoom(ye/qi(Xi),de),{flyTo:!0})):this._move(s,u)._moveEnd(!0)}return this._moveStart(!0,p.noMoveStart),Yi.call(this),this},flyToBounds:function(s,u){var p=this._getBoundsCenterZoom(s,u);return this.flyTo(p.center,p.zoom,u)},setMaxBounds:function(s){return s=U(s),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),s.isValid()?(this.options.maxBounds=s,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(s){var u=this.options.minZoom;return this.options.minZoom=s,this._loaded&&u!==s&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(s):this},setMaxZoom:function(s){var u=this.options.maxZoom;return this.options.maxZoom=s,this._loaded&&u!==s&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(s):this},panInsideBounds:function(s,u){this._enforcingBounds=!0;var p=this.getCenter(),w=this._limitCenter(p,this._zoom,U(s));return p.equals(w)||this.panTo(w,u),this._enforcingBounds=!1,this},panInside:function(s,u){u=u||{};var p=fe(u.paddingTopLeft||u.padding||[0,0]),w=fe(u.paddingBottomRight||u.padding||[0,0]),A=this.project(this.getCenter()),z=this.project(s),de=this.getPixelBounds(),ye=P([de.min.add(p),de.max.subtract(w)]),Ae=ye.getSize();if(!ye.contains(z)){this._enforcingBounds=!0;var Oe=z.subtract(ye.getCenter()),He=ye.extend(z).getSize().subtract(Ae);A.x+=Oe.x<0?-He.x:He.x,A.y+=Oe.y<0?-He.y:He.y,this.panTo(this.unproject(A),u),this._enforcingBounds=!1}return this},invalidateSize:function(s){if(!this._loaded)return this;s=a({animate:!1,pan:!0},s===!0?{animate:!0}:s);var u=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var p=this.getSize(),w=u.divideBy(2).round(),A=p.divideBy(2).round(),z=w.subtract(A);return!z.x&&!z.y?this:(s.animate&&s.pan?this.panBy(z):(s.pan&&this._rawPanBy(z),this.fire("move"),s.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:u,newSize:p}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(s){if(s=this._locateOptions=a({timeout:1e4,watch:!1},s),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var u=c(this._handleGeolocationResponse,this),p=c(this._handleGeolocationError,this);return s.watch?this._locationWatchId=navigator.geolocation.watchPosition(u,p,s):navigator.geolocation.getCurrentPosition(u,p,s),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(s){if(this._container._leaflet_id){var u=s.code,p=s.message||(u===1?"permission denied":u===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:u,message:"Geolocation error: "+p+"."})}},_handleGeolocationResponse:function(s){if(this._container._leaflet_id){var u=s.coords.latitude,p=s.coords.longitude,w=new H(u,p),A=w.toBounds(s.coords.accuracy*2),z=this._locateOptions;if(z.setView){var de=this.getBoundsZoom(A);this.setView(w,z.maxZoom?Math.min(de,z.maxZoom):de)}var ye={latlng:w,bounds:A,timestamp:s.timestamp};for(var Ae in s.coords)typeof s.coords[Ae]=="number"&&(ye[Ae]=s.coords[Ae]);this.fire("locationfound",ye)}},addHandler:function(s,u){if(!u)return this;var p=this[s]=new u(this);return this._handlers.push(p),this.options[s]&&p.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),er(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Y(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var s;for(s in this._layers)this._layers[s].remove();for(s in this._panes)er(this._panes[s]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(s,u){var p="leaflet-pane"+(s?" leaflet-"+s.replace("Pane","")+"-pane":""),w=it("div",p,u||this._mapPane);return s&&(this._panes[s]=w),w},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var s=this.getPixelBounds(),u=this.unproject(s.getBottomLeft()),p=this.unproject(s.getTopRight());return new W(u,p)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(s,u,p){s=U(s),p=fe(p||[0,0]);var w=this.getZoom()||0,A=this.getMinZoom(),z=this.getMaxZoom(),de=s.getNorthWest(),ye=s.getSouthEast(),Ae=this.getSize().subtract(p),Oe=P(this.project(ye,w),this.project(de,w)).getSize(),He=et.any3d?this.options.zoomSnap:1,st=Ae.x/Oe.x,_t=Ae.y/Oe.y,Cr=u?Math.max(st,_t):Math.min(st,_t);return w=this.getScaleZoom(Cr,w),He&&(w=Math.round(w/(He/100))*(He/100),w=u?Math.ceil(w/He)*He:Math.floor(w/He)*He),Math.max(A,Math.min(z,w))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ie(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(s,u){var p=this._getTopLeftPoint(s,u);return new R(p,p.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(s){return this.options.crs.getProjectedBounds(s===void 0?this.getZoom():s)},getPane:function(s){return typeof s=="string"?this._panes[s]:s},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(s,u){var p=this.options.crs;return u=u===void 0?this._zoom:u,p.scale(s)/p.scale(u)},getScaleZoom:function(s,u){var p=this.options.crs;u=u===void 0?this._zoom:u;var w=p.zoom(s*p.scale(u));return isNaN(w)?1/0:w},project:function(s,u){return u=u===void 0?this._zoom:u,this.options.crs.latLngToPoint(le(s),u)},unproject:function(s,u){return u=u===void 0?this._zoom:u,this.options.crs.pointToLatLng(fe(s),u)},layerPointToLatLng:function(s){var u=fe(s).add(this.getPixelOrigin());return this.unproject(u)},latLngToLayerPoint:function(s){var u=this.project(le(s))._round();return u._subtract(this.getPixelOrigin())},wrapLatLng:function(s){return this.options.crs.wrapLatLng(le(s))},wrapLatLngBounds:function(s){return this.options.crs.wrapLatLngBounds(U(s))},distance:function(s,u){return this.options.crs.distance(le(s),le(u))},containerPointToLayerPoint:function(s){return fe(s).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(s){return fe(s).add(this._getMapPanePos())},containerPointToLatLng:function(s){var u=this.containerPointToLayerPoint(fe(s));return this.layerPointToLatLng(u)},latLngToContainerPoint:function(s){return this.layerPointToContainerPoint(this.latLngToLayerPoint(le(s)))},mouseEventToContainerPoint:function(s){return Os(s,this._container)},mouseEventToLayerPoint:function(s){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(s))},mouseEventToLatLng:function(s){return this.layerPointToLatLng(this.mouseEventToLayerPoint(s))},_initContainer:function(s){var u=this._container=vr(s);if(u){if(u._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");dt(u,"scroll",this._onScroll,this),this._containerId=m(u)},_initLayout:function(){var s=this._container;this._fadeAnimated=this.options.fadeAnimation&&et.any3d,vt(s,"leaflet-container"+(et.touch?" leaflet-touch":"")+(et.retina?" leaflet-retina":"")+(et.ielt9?" leaflet-oldie":"")+(et.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var u=ga(s,"position");u!=="absolute"&&u!=="relative"&&u!=="fixed"&&u!=="sticky"&&(s.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var s=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),dr(this._mapPane,new ie(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(vt(s.markerPane,"leaflet-zoom-hide"),vt(s.shadowPane,"leaflet-zoom-hide"))},_resetView:function(s,u,p){dr(this._mapPane,new ie(0,0));var w=!this._loaded;this._loaded=!0,u=this._limitZoom(u),this.fire("viewprereset");var A=this._zoom!==u;this._moveStart(A,p)._move(s,u)._moveEnd(A),this.fire("viewreset"),w&&this.fire("load")},_moveStart:function(s,u){return s&&this.fire("zoomstart"),u||this.fire("movestart"),this},_move:function(s,u,p,w){u===void 0&&(u=this._zoom);var A=this._zoom!==u;return this._zoom=u,this._lastCenter=s,this._pixelOrigin=this._getNewPixelOrigin(s),w?p&&p.pinch&&this.fire("zoom",p):((A||p&&p.pinch)&&this.fire("zoom",p),this.fire("move",p)),this},_moveEnd:function(s){return s&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Y(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(s){dr(this._mapPane,this._getMapPanePos().subtract(s))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(s){this._targets={},this._targets[m(this._container)]=this;var u=s?Wt:dt;u(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&u(window,"resize",this._onResize,this),et.any3d&&this.options.transform3DLimit&&(s?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Y(this._resizeRequest),this._resizeRequest=ue(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var s=this._getMapPanePos();Math.max(Math.abs(s.x),Math.abs(s.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(s,u){for(var p=[],w,A=u==="mouseout"||u==="mouseover",z=s.target||s.srcElement,de=!1;z;){if(w=this._targets[m(z)],w&&(u==="click"||u==="preclick")&&this._draggableMoved(w)){de=!0;break}if(w&&w.listens(u,!0)&&(A&&!Is(z,s)||(p.push(w),A))||z===this._container)break;z=z.parentNode}return!p.length&&!de&&!A&&this.listens(u,!0)&&(p=[this]),p},_isClickDisabled:function(s){for(;s&&s!==this._container;){if(s._leaflet_disable_click)return!0;s=s.parentNode}},_handleDOMEvent:function(s){var u=s.target||s.srcElement;if(!(!this._loaded||u._leaflet_disable_events||s.type==="click"&&this._isClickDisabled(u))){var p=s.type;p==="mousedown"&&Ri(u),this._fireDOMEvent(s,p)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(s,u,p){if(s.type==="click"){var w=a({},s);w.type="preclick",this._fireDOMEvent(w,w.type,p)}var A=this._findEventTargets(s,u);if(p){for(var z=[],de=0;de<p.length;de++)p[de].listens(u,!0)&&z.push(p[de]);A=z.concat(A)}if(A.length){u==="contextmenu"&&lr(s);var ye=A[0],Ae={originalEvent:s};if(s.type!=="keypress"&&s.type!=="keydown"&&s.type!=="keyup"){var Oe=ye.getLatLng&&(!ye._radius||ye._radius<=10);Ae.containerPoint=Oe?this.latLngToContainerPoint(ye.getLatLng()):this.mouseEventToContainerPoint(s),Ae.layerPoint=this.containerPointToLayerPoint(Ae.containerPoint),Ae.latlng=Oe?ye.getLatLng():this.layerPointToLatLng(Ae.layerPoint)}for(de=0;de<A.length;de++)if(A[de].fire(u,Ae,!0),Ae.originalEvent._stopped||A[de].options.bubblingMouseEvents===!1&&M(this._mouseEvents,u)!==-1)return}},_draggableMoved:function(s){return s=s.dragging&&s.dragging.enabled()?s:this,s.dragging&&s.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var s=0,u=this._handlers.length;s<u;s++)this._handlers[s].disable()},whenReady:function(s,u){return this._loaded?s.call(u||this,{target:this}):this.on("load",s,u),this},_getMapPanePos:function(){return xa(this._mapPane)||new ie(0,0)},_moved:function(){var s=this._getMapPanePos();return s&&!s.equals([0,0])},_getTopLeftPoint:function(s,u){var p=s&&u!==void 0?this._getNewPixelOrigin(s,u):this.getPixelOrigin();return p.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(s,u){var p=this.getSize()._divideBy(2);return this.project(s,u)._subtract(p)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(s,u,p){var w=this._getNewPixelOrigin(p,u);return this.project(s,u)._subtract(w)},_latLngBoundsToNewLayerBounds:function(s,u,p){var w=this._getNewPixelOrigin(p,u);return P([this.project(s.getSouthWest(),u)._subtract(w),this.project(s.getNorthWest(),u)._subtract(w),this.project(s.getSouthEast(),u)._subtract(w),this.project(s.getNorthEast(),u)._subtract(w)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(s){return this.latLngToLayerPoint(s).subtract(this._getCenterLayerPoint())},_limitCenter:function(s,u,p){if(!p)return s;var w=this.project(s,u),A=this.getSize().divideBy(2),z=new R(w.subtract(A),w.add(A)),de=this._getBoundsOffset(z,p,u);return Math.abs(de.x)<=1&&Math.abs(de.y)<=1?s:this.unproject(w.add(de),u)},_limitOffset:function(s,u){if(!u)return s;var p=this.getPixelBounds(),w=new R(p.min.add(s),p.max.add(s));return s.add(this._getBoundsOffset(w,u))},_getBoundsOffset:function(s,u,p){var w=P(this.project(u.getNorthEast(),p),this.project(u.getSouthWest(),p)),A=w.min.subtract(s.min),z=w.max.subtract(s.max),de=this._rebound(A.x,-z.x),ye=this._rebound(A.y,-z.y);return new ie(de,ye)},_rebound:function(s,u){return s+u>0?Math.round(s-u)/2:Math.max(0,Math.ceil(s))-Math.max(0,Math.floor(u))},_limitZoom:function(s){var u=this.getMinZoom(),p=this.getMaxZoom(),w=et.any3d?this.options.zoomSnap:1;return w&&(s=Math.round(s/w)*w),Math.max(u,Math.min(p,s))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Kt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(s,u){var p=this._getCenterOffset(s)._trunc();return(u&&u.animate)!==!0&&!this.getSize().contains(p)?!1:(this.panBy(p,u),!0)},_createAnimProxy:function(){var s=this._proxy=it("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(s),this.on("zoomanim",function(u){var p=pa,w=this._proxy.style[p];Mn(this._proxy,this.project(u.center,u.zoom),this.getZoomScale(u.zoom,1)),w===this._proxy.style[p]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){er(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var s=this.getCenter(),u=this.getZoom();Mn(this._proxy,this.project(s,u),this.getZoomScale(u,1))},_catchTransitionEnd:function(s){this._animatingZoom&&s.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(s,u,p){if(this._animatingZoom)return!0;if(p=p||{},!this._zoomAnimated||p.animate===!1||this._nothingToAnimate()||Math.abs(u-this._zoom)>this.options.zoomAnimationThreshold)return!1;var w=this.getZoomScale(u),A=this._getCenterOffset(s)._divideBy(1-1/w);return p.animate!==!0&&!this.getSize().contains(A)?!1:(ue(function(){this._moveStart(!0,p.noMoveStart||!1)._animateZoom(s,u,!0)},this),!0)},_animateZoom:function(s,u,p,w){this._mapPane&&(p&&(this._animatingZoom=!0,this._animateToCenter=s,this._animateToZoom=u,vt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:s,zoom:u,noUpdate:w}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Kt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ja(s,u){return new Ct(s,u)}var pn=ve.extend({options:{position:"topright"},initialize:function(s){b(this,s)},getPosition:function(){return this.options.position},setPosition:function(s){var u=this._map;return u&&u.removeControl(this),this.options.position=s,u&&u.addControl(this),this},getContainer:function(){return this._container},addTo:function(s){this.remove(),this._map=s;var u=this._container=this.onAdd(s),p=this.getPosition(),w=s._controlCorners[p];return vt(u,"leaflet-control"),p.indexOf("bottom")!==-1?w.insertBefore(u,w.firstChild):w.appendChild(u),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(er(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(s){this._map&&s&&s.screenX>0&&s.screenY>0&&this._map.getContainer().focus()}}),Ma=function(s){return new pn(s)};Ct.include({addControl:function(s){return s.addTo(this),this},removeControl:function(s){return s.remove(),this},_initControlPos:function(){var s=this._controlCorners={},u="leaflet-",p=this._controlContainer=it("div",u+"control-container",this._container);function w(A,z){var de=u+A+" "+u+z;s[A+z]=it("div",de,p)}w("top","left"),w("top","right"),w("bottom","left"),w("bottom","right")},_clearControlPos:function(){for(var s in this._controlCorners)er(this._controlCorners[s]);er(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Rl=pn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(s,u,p,w){return p<w?-1:w<p?1:0}},initialize:function(s,u,p){b(this,p),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var w in s)this._addLayer(s[w],w);for(w in u)this._addLayer(u[w],w,!0)},onAdd:function(s){this._initLayout(),this._update(),this._map=s,s.on("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(s){return pn.prototype.addTo.call(this,s),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(s,u){return this._addLayer(s,u),this._map?this._update():this},addOverlay:function(s,u){return this._addLayer(s,u,!0),this._map?this._update():this},removeLayer:function(s){s.off("add remove",this._onLayerChange,this);var u=this._getLayer(m(s));return u&&this._layers.splice(this._layers.indexOf(u),1),this._map?this._update():this},expand:function(){vt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var s=this._map.getSize().y-(this._container.offsetTop+50);return s<this._section.clientHeight?(vt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=s+"px"):Kt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Kt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var s="leaflet-control-layers",u=this._container=it("div",s),p=this.options.collapsed;u.setAttribute("aria-haspopup",!0),Ds(u),To(u);var w=this._section=it("section",s+"-list");p&&(this._map.on("click",this.collapse,this),dt(u,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var A=this._layersLink=it("a",s+"-toggle",u);A.href="#",A.title="Layers",A.setAttribute("role","button"),dt(A,{keydown:function(z){z.keyCode===13&&this._expandSafely()},click:function(z){lr(z),this._expandSafely()}},this),p||this.expand(),this._baseLayersList=it("div",s+"-base",w),this._separator=it("div",s+"-separator",w),this._overlaysList=it("div",s+"-overlays",w),u.appendChild(w)},_getLayer:function(s){for(var u=0;u<this._layers.length;u++)if(this._layers[u]&&m(this._layers[u].layer)===s)return this._layers[u]},_addLayer:function(s,u,p){this._map&&s.on("add remove",this._onLayerChange,this),this._layers.push({layer:s,name:u,overlay:p}),this.options.sortLayers&&this._layers.sort(c(function(w,A){return this.options.sortFunction(w.layer,A.layer,w.name,A.name)},this)),this.options.autoZIndex&&s.setZIndex&&(this._lastZIndex++,s.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;yo(this._baseLayersList),yo(this._overlaysList),this._layerControlInputs=[];var s,u,p,w,A=0;for(p=0;p<this._layers.length;p++)w=this._layers[p],this._addItem(w),u=u||w.overlay,s=s||!w.overlay,A+=w.overlay?0:1;return this.options.hideSingleBase&&(s=s&&A>1,this._baseLayersList.style.display=s?"":"none"),this._separator.style.display=u&&s?"":"none",this},_onLayerChange:function(s){this._handlingClick||this._update();var u=this._getLayer(m(s.target)),p=u.overlay?s.type==="add"?"overlayadd":"overlayremove":s.type==="add"?"baselayerchange":null;p&&this._map.fire(p,u)},_createRadioElement:function(s,u){var p='<input type="radio" class="leaflet-control-layers-selector" name="'+s+'"'+(u?' checked="checked"':"")+"/>",w=document.createElement("div");return w.innerHTML=p,w.firstChild},_addItem:function(s){var u=document.createElement("label"),p=this._map.hasLayer(s.layer),w;s.overlay?(w=document.createElement("input"),w.type="checkbox",w.className="leaflet-control-layers-selector",w.defaultChecked=p):w=this._createRadioElement("leaflet-base-layers_"+m(this),p),this._layerControlInputs.push(w),w.layerId=m(s.layer),dt(w,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+s.name;var z=document.createElement("span");u.appendChild(z),z.appendChild(w),z.appendChild(A);var de=s.overlay?this._overlaysList:this._baseLayersList;return de.appendChild(u),this._checkDisabledLayers(),u},_onInputClick:function(){if(!this._preventClick){var s=this._layerControlInputs,u,p,w=[],A=[];this._handlingClick=!0;for(var z=s.length-1;z>=0;z--)u=s[z],p=this._getLayer(u.layerId).layer,u.checked?w.push(p):u.checked||A.push(p);for(z=0;z<A.length;z++)this._map.hasLayer(A[z])&&this._map.removeLayer(A[z]);for(z=0;z<w.length;z++)this._map.hasLayer(w[z])||this._map.addLayer(w[z]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var s=this._layerControlInputs,u,p,w=this._map.getZoom(),A=s.length-1;A>=0;A--)u=s[A],p=this._getLayer(u.layerId).layer,u.disabled=p.options.minZoom!==void 0&&w<p.options.minZoom||p.options.maxZoom!==void 0&&w>p.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var s=this._section;this._preventClick=!0,dt(s,"click",lr),this.expand();var u=this;setTimeout(function(){Wt(s,"click",lr),u._preventClick=!1})}}),Ao=function(s,u,p){return new Rl(s,u,p)},ji=pn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(s){var u="leaflet-control-zoom",p=it("div",u+" leaflet-bar"),w=this.options;return this._zoomInButton=this._createButton(w.zoomInText,w.zoomInTitle,u+"-in",p,this._zoomIn),this._zoomOutButton=this._createButton(w.zoomOutText,w.zoomOutTitle,u+"-out",p,this._zoomOut),this._updateDisabled(),s.on("zoomend zoomlevelschange",this._updateDisabled,this),p},onRemove:function(s){s.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(s){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(s.shiftKey?3:1))},_zoomOut:function(s){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(s.shiftKey?3:1))},_createButton:function(s,u,p,w,A){var z=it("a",p,w);return z.innerHTML=s,z.href="#",z.title=u,z.setAttribute("role","button"),z.setAttribute("aria-label",u),Ds(z),dt(z,"click",zn),dt(z,"click",A,this),dt(z,"click",this._refocusOnMap,this),z},_updateDisabled:function(){var s=this._map,u="leaflet-disabled";Kt(this._zoomInButton,u),Kt(this._zoomOutButton,u),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||s._zoom===s.getMinZoom())&&(vt(this._zoomOutButton,u),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||s._zoom===s.getMaxZoom())&&(vt(this._zoomInButton,u),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ct.mergeOptions({zoomControl:!0}),Ct.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ji,this.addControl(this.zoomControl))});var ou=function(s){return new ji(s)},tn=pn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(s){var u="leaflet-control-scale",p=it("div",u),w=this.options;return this._addScales(w,u+"-line",p),s.on(w.updateWhenIdle?"moveend":"move",this._update,this),s.whenReady(this._update,this),p},onRemove:function(s){s.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(s,u,p){s.metric&&(this._mScale=it("div",u,p)),s.imperial&&(this._iScale=it("div",u,p))},_update:function(){var s=this._map,u=s.getSize().y/2,p=s.distance(s.containerPointToLatLng([0,u]),s.containerPointToLatLng([this.options.maxWidth,u]));this._updateScales(p)},_updateScales:function(s){this.options.metric&&s&&this._updateMetric(s),this.options.imperial&&s&&this._updateImperial(s)},_updateMetric:function(s){var u=this._getRoundNum(s),p=u<1e3?u+" m":u/1e3+" km";this._updateScale(this._mScale,p,u/s)},_updateImperial:function(s){var u=s*3.2808399,p,w,A;u>5280?(p=u/5280,w=this._getRoundNum(p),this._updateScale(this._iScale,w+" mi",w/p)):(A=this._getRoundNum(u),this._updateScale(this._iScale,A+" ft",A/u))},_updateScale:function(s,u,p){s.style.width=Math.round(this.options.maxWidth*p)+"px",s.innerHTML=u},_getRoundNum:function(s){var u=Math.pow(10,(Math.floor(s)+"").length-1),p=s/u;return p=p>=10?10:p>=5?5:p>=3?3:p>=2?2:1,u*p}}),Mi=function(s){return new tn(s)},jl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',li=pn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(et.inlineSvg?jl+" ":"")+"Leaflet</a>"},initialize:function(s){b(this,s),this._attributions={}},onAdd:function(s){s.attributionControl=this,this._container=it("div","leaflet-control-attribution"),Ds(this._container);for(var u in s._layers)s._layers[u].getAttribution&&this.addAttribution(s._layers[u].getAttribution());return this._update(),s.on("layeradd",this._addAttribution,this),this._container},onRemove:function(s){s.off("layeradd",this._addAttribution,this)},_addAttribution:function(s){s.layer.getAttribution&&(this.addAttribution(s.layer.getAttribution()),s.layer.once("remove",function(){this.removeAttribution(s.layer.getAttribution())},this))},setPrefix:function(s){return this.options.prefix=s,this._update(),this},addAttribution:function(s){return s?(this._attributions[s]||(this._attributions[s]=0),this._attributions[s]++,this._update(),this):this},removeAttribution:function(s){return s?(this._attributions[s]&&(this._attributions[s]--,this._update()),this):this},_update:function(){if(this._map){var s=[];for(var u in this._attributions)this._attributions[u]&&s.push(u);var p=[];this.options.prefix&&p.push(this.options.prefix),s.length&&p.push(s.join(", ")),this._container.innerHTML=p.join(' <span aria-hidden="true">|</span> ')}}});Ct.mergeOptions({attributionControl:!0}),Ct.addInitHook(function(){this.options.attributionControl&&new li().addTo(this)});var mf=function(s){return new li(s)};pn.Layers=Rl,pn.Zoom=ji,pn.Scale=tn,pn.Attribution=li,Ma.layers=Ao,Ma.zoom=ou,Ma.scale=Mi,Ma.attribution=mf;var Cn=ve.extend({initialize:function(s){this._map=s},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Cn.addTo=function(s,u){return s.addHandler(u,this),this};var Ml={Events:ce},Bi=et.touch?"touchstart mousedown":"mousedown",Un=V.extend({options:{clickTolerance:3},initialize:function(s,u,p,w){b(this,w),this._element=s,this._dragStartTarget=u||s,this._preventOutline=p},enable:function(){this._enabled||(dt(this._dragStartTarget,Bi,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Un._dragging===this&&this.finishDrag(!0),Wt(this._dragStartTarget,Bi,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(s){if(this._enabled&&(this._moved=!1,!Ii(this._element,"leaflet-zoom-anim"))){if(s.touches&&s.touches.length!==1){Un._dragging===this&&this.finishDrag();return}if(!(Un._dragging||s.shiftKey||s.which!==1&&s.button!==1&&!s.touches)&&(Un._dragging=this,this._preventOutline&&Ri(this._element),ko(),Nt(),!this._moving)){this.fire("down");var u=s.touches?s.touches[0]:s,p=ya(this._element);this._startPoint=new ie(u.clientX,u.clientY),this._startPos=xa(this._element),this._parentScale=Xn(p);var w=s.type==="mousedown";dt(document,w?"mousemove":"touchmove",this._onMove,this),dt(document,w?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(s){if(this._enabled){if(s.touches&&s.touches.length>1){this._moved=!0;return}var u=s.touches&&s.touches.length===1?s.touches[0]:s,p=new ie(u.clientX,u.clientY)._subtract(this._startPoint);!p.x&&!p.y||Math.abs(p.x)+Math.abs(p.y)<this.options.clickTolerance||(p.x/=this._parentScale.x,p.y/=this._parentScale.y,lr(s),this._moved||(this.fire("dragstart"),this._moved=!0,vt(document.body,"leaflet-dragging"),this._lastTarget=s.target||s.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),vt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(p),this._moving=!0,this._lastEvent=s,this._updatePosition())}},_updatePosition:function(){var s={originalEvent:this._lastEvent};this.fire("predrag",s),dr(this._element,this._newPos),this.fire("drag",s)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(s){Kt(document.body,"leaflet-dragging"),this._lastTarget&&(Kt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Wt(document,"mousemove touchmove",this._onMove,this),Wt(document,"mouseup touchend touchcancel",this._onUp,this),bo(),Li();var u=this._moved&&this._moving;this._moving=!1,Un._dragging=!1,u&&this.fire("dragend",{noInertia:s,distance:this._newPos.distanceTo(this._startPos)})}});function Bl(s,u,p){var w,A=[1,4,2,8],z,de,ye,Ae,Oe,He,st,_t;for(z=0,He=s.length;z<He;z++)s[z]._code=ci(s[z],u);for(ye=0;ye<4;ye++){for(st=A[ye],w=[],z=0,He=s.length,de=He-1;z<He;de=z++)Ae=s[z],Oe=s[de],Ae._code&st?Oe._code&st||(_t=No(Oe,Ae,st,u,p),_t._code=ci(_t,u),w.push(_t)):(Oe._code&st&&(_t=No(Oe,Ae,st,u,p),_t._code=ci(_t,u),w.push(_t)),w.push(Ae));s=w}return s}function lu(s,u){var p,w,A,z,de,ye,Ae,Oe,He;if(!s||s.length===0)throw new Error("latlngs not passed");An(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var st=le([0,0]),_t=U(s),Cr=_t.getNorthWest().distanceTo(_t.getSouthWest())*_t.getNorthEast().distanceTo(_t.getNorthWest());Cr<1700&&(st=zl(s));var _r=s.length,vn=[];for(p=0;p<_r;p++){var rn=le(s[p]);vn.push(u.project(le([rn.lat-st.lat,rn.lng-st.lng])))}for(ye=Ae=Oe=0,p=0,w=_r-1;p<_r;w=p++)A=vn[p],z=vn[w],de=A.y*z.x-z.y*A.x,Ae+=(A.x+z.x)*de,Oe+=(A.y+z.y)*de,ye+=de*3;ye===0?He=vn[0]:He=[Ae/ye,Oe/ye];var qi=u.unproject(fe(He));return le([qi.lat+st.lat,qi.lng+st.lng])}function zl(s){for(var u=0,p=0,w=0,A=0;A<s.length;A++){var z=le(s[A]);u+=z.lat,p+=z.lng,w++}return le([u/w,p/w])}var pf={__proto__:null,clipPolygon:Bl,polygonCenter:lu,centroid:zl};function Po(s,u){if(!u||!s.length)return s.slice();var p=u*u;return s=xf(s,p),s=vf(s,p),s}function cu(s,u,p){return Math.sqrt(ui(s,u,p,!0))}function gf(s,u,p){return ui(s,u,p)}function vf(s,u){var p=s.length,w=typeof Uint8Array<"u"?Uint8Array:Array,A=new w(p);A[0]=A[p-1]=1,Ul(s,A,u,0,p-1);var z,de=[];for(z=0;z<p;z++)A[z]&&de.push(s[z]);return de}function Ul(s,u,p,w,A){var z=0,de,ye,Ae;for(ye=w+1;ye<=A-1;ye++)Ae=ui(s[ye],s[w],s[A],!0),Ae>z&&(de=ye,z=Ae);z>p&&(u[de]=1,Ul(s,u,p,w,de),Ul(s,u,p,de,A))}function xf(s,u){for(var p=[s[0]],w=1,A=0,z=s.length;w<z;w++)yf(s[w],s[A])>u&&(p.push(s[w]),A=w);return A<z-1&&p.push(s[z-1]),p}var $l;function uu(s,u,p,w,A){var z=w?$l:ci(s,p),de=ci(u,p),ye,Ae,Oe;for($l=de;;){if(!(z|de))return[s,u];if(z&de)return!1;ye=z||de,Ae=No(s,u,ye,p,A),Oe=ci(Ae,p),ye===z?(s=Ae,z=Oe):(u=Ae,de=Oe)}}function No(s,u,p,w,A){var z=u.x-s.x,de=u.y-s.y,ye=w.min,Ae=w.max,Oe,He;return p&8?(Oe=s.x+z*(Ae.y-s.y)/de,He=Ae.y):p&4?(Oe=s.x+z*(ye.y-s.y)/de,He=ye.y):p&2?(Oe=Ae.x,He=s.y+de*(Ae.x-s.x)/z):p&1&&(Oe=ye.x,He=s.y+de*(ye.x-s.x)/z),new ie(Oe,He,A)}function ci(s,u){var p=0;return s.x<u.min.x?p|=1:s.x>u.max.x&&(p|=2),s.y<u.min.y?p|=4:s.y>u.max.y&&(p|=8),p}function yf(s,u){var p=u.x-s.x,w=u.y-s.y;return p*p+w*w}function ui(s,u,p,w){var A=u.x,z=u.y,de=p.x-A,ye=p.y-z,Ae=de*de+ye*ye,Oe;return Ae>0&&(Oe=((s.x-A)*de+(s.y-z)*ye)/Ae,Oe>1?(A=p.x,z=p.y):Oe>0&&(A+=de*Oe,z+=ye*Oe)),de=s.x-A,ye=s.y-z,w?de*de+ye*ye:new ie(A,z)}function An(s){return!O(s[0])||typeof s[0][0]!="object"&&typeof s[0][0]<"u"}function du(s){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),An(s)}function fu(s,u){var p,w,A,z,de,ye,Ae,Oe;if(!s||s.length===0)throw new Error("latlngs not passed");An(s)||(console.warn("latlngs are not flat! Only the first ring will be used"),s=s[0]);var He=le([0,0]),st=U(s),_t=st.getNorthWest().distanceTo(st.getSouthWest())*st.getNorthEast().distanceTo(st.getNorthWest());_t<1700&&(He=zl(s));var Cr=s.length,_r=[];for(p=0;p<Cr;p++){var vn=le(s[p]);_r.push(u.project(le([vn.lat-He.lat,vn.lng-He.lng])))}for(p=0,w=0;p<Cr-1;p++)w+=_r[p].distanceTo(_r[p+1])/2;if(w===0)Oe=_r[0];else for(p=0,z=0;p<Cr-1;p++)if(de=_r[p],ye=_r[p+1],A=de.distanceTo(ye),z+=A,z>w){Ae=(z-w)/A,Oe=[ye.x-Ae*(ye.x-de.x),ye.y-Ae*(ye.y-de.y)];break}var rn=u.unproject(fe(Oe));return le([rn.lat+He.lat,rn.lng+He.lng])}var hu={__proto__:null,simplify:Po,pointToSegmentDistance:cu,closestPointOnSegment:gf,clipSegment:uu,_getEdgeIntersection:No,_getBitCode:ci,_sqClosestPointOnSegment:ui,isFlat:An,_flat:du,polylineCenter:fu},Wl={project:function(s){return new ie(s.lng,s.lat)},unproject:function(s){return new H(s.y,s.x)},bounds:new R([-180,-90],[180,90])},Hl={R:6378137,R_MINOR:6356752314245179e-9,bounds:new R([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(s){var u=Math.PI/180,p=this.R,w=s.lat*u,A=this.R_MINOR/p,z=Math.sqrt(1-A*A),de=z*Math.sin(w),ye=Math.tan(Math.PI/4-w/2)/Math.pow((1-de)/(1+de),z/2);return w=-p*Math.log(Math.max(ye,1e-10)),new ie(s.lng*u*p,w)},unproject:function(s){for(var u=180/Math.PI,p=this.R,w=this.R_MINOR/p,A=Math.sqrt(1-w*w),z=Math.exp(-s.y/p),de=Math.PI/2-2*Math.atan(z),ye=0,Ae=.1,Oe;ye<15&&Math.abs(Ae)>1e-7;ye++)Oe=A*Math.sin(de),Oe=Math.pow((1-Oe)/(1+Oe),A/2),Ae=Math.PI/2-2*Math.atan(z*Oe)-de,de+=Ae;return new H(de*u,s.x*u/p)}},_f={__proto__:null,LonLat:Wl,Mercator:Hl,SphericalMercator:xe},wf=a({},Ce,{code:"EPSG:3395",projection:Hl,transformation:(function(){var s=.5/(Math.PI*Hl.R);return te(s,.5,-s,.5)})()}),mu=a({},Ce,{code:"EPSG:4326",projection:Wl,transformation:te(1/180,1,-1/180,.5)}),kf=a({},ge,{projection:Wl,transformation:te(1,0,-1,0),scale:function(s){return Math.pow(2,s)},zoom:function(s){return Math.log(s)/Math.LN2},distance:function(s,u){var p=u.lng-s.lng,w=u.lat-s.lat;return Math.sqrt(p*p+w*w)},infinite:!0});ge.Earth=Ce,ge.EPSG3395=wf,ge.EPSG3857=Tt,ge.EPSG900913=bt,ge.EPSG4326=mu,ge.Simple=kf;var $n=V.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(s){return s.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(s){return s&&s.removeLayer(this),this},getPane:function(s){return this._map.getPane(s?this.options[s]||s:this.options.pane)},addInteractiveTarget:function(s){return this._map._targets[m(s)]=this,this},removeInteractiveTarget:function(s){return delete this._map._targets[m(s)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(s){var u=s.target;if(u.hasLayer(this)){if(this._map=u,this._zoomAnimated=u._zoomAnimated,this.getEvents){var p=this.getEvents();u.on(p,this),this.once("remove",function(){u.off(p,this)},this)}this.onAdd(u),this.fire("add"),u.fire("layeradd",{layer:this})}}});Ct.include({addLayer:function(s){if(!s._layerAdd)throw new Error("The provided object is not a Layer.");var u=m(s);return this._layers[u]?this:(this._layers[u]=s,s._mapToAdd=this,s.beforeAdd&&s.beforeAdd(this),this.whenReady(s._layerAdd,s),this)},removeLayer:function(s){var u=m(s);return this._layers[u]?(this._loaded&&s.onRemove(this),delete this._layers[u],this._loaded&&(this.fire("layerremove",{layer:s}),s.fire("remove")),s._map=s._mapToAdd=null,this):this},hasLayer:function(s){return m(s)in this._layers},eachLayer:function(s,u){for(var p in this._layers)s.call(u,this._layers[p]);return this},_addLayers:function(s){s=s?O(s)?s:[s]:[];for(var u=0,p=s.length;u<p;u++)this.addLayer(s[u])},_addZoomLimit:function(s){(!isNaN(s.options.maxZoom)||!isNaN(s.options.minZoom))&&(this._zoomBoundLayers[m(s)]=s,this._updateZoomLevels())},_removeZoomLimit:function(s){var u=m(s);this._zoomBoundLayers[u]&&(delete this._zoomBoundLayers[u],this._updateZoomLevels())},_updateZoomLevels:function(){var s=1/0,u=-1/0,p=this._getZoomSpan();for(var w in this._zoomBoundLayers){var A=this._zoomBoundLayers[w].options;s=A.minZoom===void 0?s:Math.min(s,A.minZoom),u=A.maxZoom===void 0?u:Math.max(u,A.maxZoom)}this._layersMaxZoom=u===-1/0?void 0:u,this._layersMinZoom=s===1/0?void 0:s,p!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ba=$n.extend({initialize:function(s,u){b(this,u),this._layers={};var p,w;if(s)for(p=0,w=s.length;p<w;p++)this.addLayer(s[p])},addLayer:function(s){var u=this.getLayerId(s);return this._layers[u]=s,this._map&&this._map.addLayer(s),this},removeLayer:function(s){var u=s in this._layers?s:this.getLayerId(s);return this._map&&this._layers[u]&&this._map.removeLayer(this._layers[u]),delete this._layers[u],this},hasLayer:function(s){var u=typeof s=="number"?s:this.getLayerId(s);return u in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(s){var u=Array.prototype.slice.call(arguments,1),p,w;for(p in this._layers)w=this._layers[p],w[s]&&w[s].apply(w,u);return this},onAdd:function(s){this.eachLayer(s.addLayer,s)},onRemove:function(s){this.eachLayer(s.removeLayer,s)},eachLayer:function(s,u){for(var p in this._layers)s.call(u,this._layers[p]);return this},getLayer:function(s){return this._layers[s]},getLayers:function(){var s=[];return this.eachLayer(s.push,s),s},setZIndex:function(s){return this.invoke("setZIndex",s)},getLayerId:function(s){return m(s)}}),Fs=function(s,u){return new Ba(s,u)},_a=Ba.extend({addLayer:function(s){return this.hasLayer(s)?this:(s.addEventParent(this),Ba.prototype.addLayer.call(this,s),this.fire("layeradd",{layer:s}))},removeLayer:function(s){return this.hasLayer(s)?(s in this._layers&&(s=this._layers[s]),s.removeEventParent(this),Ba.prototype.removeLayer.call(this,s),this.fire("layerremove",{layer:s})):this},setStyle:function(s){return this.invoke("setStyle",s)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var s=new W;for(var u in this._layers){var p=this._layers[u];s.extend(p.getBounds?p.getBounds():p.getLatLng())}return s}}),pu=function(s,u){return new _a(s,u)},di=ve.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(s){b(this,s)},createIcon:function(s){return this._createIcon("icon",s)},createShadow:function(s){return this._createIcon("shadow",s)},_createIcon:function(s,u){var p=this._getIconUrl(s);if(!p){if(s==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var w=this._createImg(p,u&&u.tagName==="IMG"?u:null);return this._setIconStyles(w,s),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),w},_setIconStyles:function(s,u){var p=this.options,w=p[u+"Size"];typeof w=="number"&&(w=[w,w]);var A=fe(w),z=fe(u==="shadow"&&p.shadowAnchor||p.iconAnchor||A&&A.divideBy(2,!0));s.className="leaflet-marker-"+u+" "+(p.className||""),z&&(s.style.marginLeft=-z.x+"px",s.style.marginTop=-z.y+"px"),A&&(s.style.width=A.x+"px",s.style.height=A.y+"px")},_createImg:function(s,u){return u=u||document.createElement("img"),u.src=s,u},_getIconUrl:function(s){return et.retina&&this.options[s+"RetinaUrl"]||this.options[s+"Url"]}});function gu(s){return new di(s)}var zi=di.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(s){return typeof zi.imagePath!="string"&&(zi.imagePath=this._detectIconPath()),(this.options.imagePath||zi.imagePath)+di.prototype._getIconUrl.call(this,s)},_stripUrl:function(s){var u=function(p,w,A){var z=w.exec(p);return z&&z[A]};return s=u(s,/^url\((['"])?(.+)\1\)$/,2),s&&u(s,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var s=it("div","leaflet-default-icon-path",document.body),u=ga(s,"background-image")||ga(s,"backgroundImage");if(document.body.removeChild(s),u=this._stripUrl(u),u)return u;var p=document.querySelector('link[href$="leaflet.css"]');return p?p.href.substring(0,p.href.length-11-1):""}}),Vl=Cn.extend({initialize:function(s){this._marker=s},addHooks:function(){var s=this._marker._icon;this._draggable||(this._draggable=new Un(s,s,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),vt(s,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Kt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(s){var u=this._marker,p=u._map,w=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,z=xa(u._icon),de=p.getPixelBounds(),ye=p.getPixelOrigin(),Ae=P(de.min._subtract(ye).add(A),de.max._subtract(ye).subtract(A));if(!Ae.contains(z)){var Oe=fe((Math.max(Ae.max.x,z.x)-Ae.max.x)/(de.max.x-Ae.max.x)-(Math.min(Ae.min.x,z.x)-Ae.min.x)/(de.min.x-Ae.min.x),(Math.max(Ae.max.y,z.y)-Ae.max.y)/(de.max.y-Ae.max.y)-(Math.min(Ae.min.y,z.y)-Ae.min.y)/(de.min.y-Ae.min.y)).multiplyBy(w);p.panBy(Oe,{animate:!1}),this._draggable._newPos._add(Oe),this._draggable._startPos._add(Oe),dr(u._icon,this._draggable._newPos),this._onDrag(s),this._panRequest=ue(this._adjustPan.bind(this,s))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(s){this._marker.options.autoPan&&(Y(this._panRequest),this._panRequest=ue(this._adjustPan.bind(this,s)))},_onDrag:function(s){var u=this._marker,p=u._shadow,w=xa(u._icon),A=u._map.layerPointToLatLng(w);p&&dr(p,w),u._latlng=A,s.latlng=A,s.oldLatLng=this._oldLatLng,u.fire("move",s).fire("drag",s)},_onDragEnd:function(s){Y(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",s)}}),wa=$n.extend({options:{icon:new zi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(s,u){b(this,u),this._latlng=le(s)},onAdd:function(s){this._zoomAnimated=this._zoomAnimated&&s.options.markerZoomAnimation,this._zoomAnimated&&s.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(s){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&s.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(s){var u=this._latlng;return this._latlng=le(s),this.update(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},setZIndexOffset:function(s){return this.options.zIndexOffset=s,this.update()},getIcon:function(){return this.options.icon},setIcon:function(s){return this.options.icon=s,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var s=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(s)}return this},_initIcon:function(){var s=this.options,u="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),p=s.icon.createIcon(this._icon),w=!1;p!==this._icon&&(this._icon&&this._removeIcon(),w=!0,s.title&&(p.title=s.title),p.tagName==="IMG"&&(p.alt=s.alt||"")),vt(p,u),s.keyboard&&(p.tabIndex="0",p.setAttribute("role","button")),this._icon=p,s.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&dt(p,"focus",this._panOnFocus,this);var A=s.icon.createShadow(this._shadow),z=!1;A!==this._shadow&&(this._removeShadow(),z=!0),A&&(vt(A,u),A.alt=""),this._shadow=A,s.opacity<1&&this._updateOpacity(),w&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&z&&this.getPane(s.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Wt(this._icon,"focus",this._panOnFocus,this),er(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&er(this._shadow),this._shadow=null},_setPos:function(s){this._icon&&dr(this._icon,s),this._shadow&&dr(this._shadow,s),this._zIndex=s.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(s){this._icon&&(this._icon.style.zIndex=this._zIndex+s)},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center).round();this._setPos(u)},_initInteraction:function(){if(this.options.interactive&&(vt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Vl)){var s=this.options.draggable;this.dragging&&(s=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Vl(this),s&&this.dragging.enable()}},setOpacity:function(s){return this.options.opacity=s,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var s=this.options.opacity;this._icon&&en(this._icon,s),this._shadow&&en(this._shadow,s)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var s=this._map;if(s){var u=this.options.icon.options,p=u.iconSize?fe(u.iconSize):fe(0,0),w=u.iconAnchor?fe(u.iconAnchor):fe(0,0);s.panInside(this._latlng,{paddingTopLeft:w,paddingBottomRight:p.subtract(w)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function bf(s,u){return new wa(s,u)}var za=$n.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(s){this._renderer=s.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(s){return b(this,s),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&s&&Object.prototype.hasOwnProperty.call(s,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Do=za.extend({options:{fill:!0,radius:10},initialize:function(s,u){b(this,u),this._latlng=le(s),this._radius=this.options.radius},setLatLng:function(s){var u=this._latlng;return this._latlng=le(s),this.redraw(),this.fire("move",{oldLatLng:u,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(s){return this.options.radius=this._radius=s,this.redraw()},getRadius:function(){return this._radius},setStyle:function(s){var u=s&&s.radius||this._radius;return za.prototype.setStyle.call(this,s),this.setRadius(u),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var s=this._radius,u=this._radiusY||s,p=this._clickTolerance(),w=[s+p,u+p];this._pxBounds=new R(this._point.subtract(w),this._point.add(w))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(s){return s.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function vu(s,u){return new Do(s,u)}var Oo=Do.extend({initialize:function(s,u,p){if(typeof u=="number"&&(u=a({},p,{radius:u})),b(this,u),this._latlng=le(s),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(s){return this._mRadius=s,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var s=[this._radius,this._radiusY||this._radius];return new W(this._map.layerPointToLatLng(this._point.subtract(s)),this._map.layerPointToLatLng(this._point.add(s)))},setStyle:za.prototype.setStyle,_project:function(){var s=this._latlng.lng,u=this._latlng.lat,p=this._map,w=p.options.crs;if(w.distance===Ce.distance){var A=Math.PI/180,z=this._mRadius/Ce.R/A,de=p.project([u+z,s]),ye=p.project([u-z,s]),Ae=de.add(ye).divideBy(2),Oe=p.unproject(Ae).lat,He=Math.acos((Math.cos(z*A)-Math.sin(u*A)*Math.sin(Oe*A))/(Math.cos(u*A)*Math.cos(Oe*A)))/A;(isNaN(He)||He===0)&&(He=z/Math.cos(Math.PI/180*u)),this._point=Ae.subtract(p.getPixelOrigin()),this._radius=isNaN(He)?0:Ae.x-p.project([Oe,s-He]).x,this._radiusY=Ae.y-de.y}else{var st=w.unproject(w.project(this._latlng).subtract([this._mRadius,0]));this._point=p.latLngToLayerPoint(this._latlng),this._radius=this._point.x-p.latLngToLayerPoint(st).x}this._updateBounds()}});function Ls(s,u,p){return new Oo(s,u,p)}var gn=za.extend({options:{smoothFactor:1,noClip:!1},initialize:function(s,u){b(this,u),this._setLatLngs(s)},getLatLngs:function(){return this._latlngs},setLatLngs:function(s){return this._setLatLngs(s),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(s){for(var u=1/0,p=null,w=ui,A,z,de=0,ye=this._parts.length;de<ye;de++)for(var Ae=this._parts[de],Oe=1,He=Ae.length;Oe<He;Oe++){A=Ae[Oe-1],z=Ae[Oe];var st=w(s,A,z,!0);st<u&&(u=st,p=w(s,A,z))}return p&&(p.distance=Math.sqrt(u)),p},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return fu(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(s,u){return u=u||this._defaultShape(),s=le(s),u.push(s),this._bounds.extend(s),this.redraw()},_setLatLngs:function(s){this._bounds=new W,this._latlngs=this._convertLatLngs(s)},_defaultShape:function(){return An(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(s){for(var u=[],p=An(s),w=0,A=s.length;w<A;w++)p?(u[w]=le(s[w]),this._bounds.extend(u[w])):u[w]=this._convertLatLngs(s[w]);return u},_project:function(){var s=new R;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,s),this._bounds.isValid()&&s.isValid()&&(this._rawPxBounds=s,this._updateBounds())},_updateBounds:function(){var s=this._clickTolerance(),u=new ie(s,s);this._rawPxBounds&&(this._pxBounds=new R([this._rawPxBounds.min.subtract(u),this._rawPxBounds.max.add(u)]))},_projectLatlngs:function(s,u,p){var w=s[0]instanceof H,A=s.length,z,de;if(w){for(de=[],z=0;z<A;z++)de[z]=this._map.latLngToLayerPoint(s[z]),p.extend(de[z]);u.push(de)}else for(z=0;z<A;z++)this._projectLatlngs(s[z],u,p)},_clipPoints:function(){var s=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}var u=this._parts,p,w,A,z,de,ye,Ae;for(p=0,A=0,z=this._rings.length;p<z;p++)for(Ae=this._rings[p],w=0,de=Ae.length;w<de-1;w++)ye=uu(Ae[w],Ae[w+1],s,w,!0),ye&&(u[A]=u[A]||[],u[A].push(ye[0]),(ye[1]!==Ae[w+1]||w===de-2)&&(u[A].push(ye[1]),A++))}},_simplifyPoints:function(){for(var s=this._parts,u=this.options.smoothFactor,p=0,w=s.length;p<w;p++)s[p]=Po(s[p],u)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(s,u){var p,w,A,z,de,ye,Ae=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(p=0,z=this._parts.length;p<z;p++)for(ye=this._parts[p],w=0,de=ye.length,A=de-1;w<de;A=w++)if(!(!u&&w===0)&&cu(s,ye[A],ye[w])<=Ae)return!0;return!1}});function Sf(s,u){return new gn(s,u)}gn._flat=du;var ka=gn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return lu(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(s){var u=gn.prototype._convertLatLngs.call(this,s),p=u.length;return p>=2&&u[0]instanceof H&&u[0].equals(u[p-1])&&u.pop(),u},_setLatLngs:function(s){gn.prototype._setLatLngs.call(this,s),An(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return An(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var s=this._renderer._bounds,u=this.options.weight,p=new ie(u,u);if(s=new R(s.min.subtract(p),s.max.add(p)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(s))){if(this.options.noClip){this._parts=this._rings;return}for(var w=0,A=this._rings.length,z;w<A;w++)z=Bl(this._rings[w],s,!0),z.length&&this._parts.push(z)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(s){var u=!1,p,w,A,z,de,ye,Ae,Oe;if(!this._pxBounds||!this._pxBounds.contains(s))return!1;for(z=0,Ae=this._parts.length;z<Ae;z++)for(p=this._parts[z],de=0,Oe=p.length,ye=Oe-1;de<Oe;ye=de++)w=p[de],A=p[ye],w.y>s.y!=A.y>s.y&&s.x<(A.x-w.x)*(s.y-w.y)/(A.y-w.y)+w.x&&(u=!u);return u||gn.prototype._containsPoint.call(this,s,!0)}});function Tf(s,u){return new ka(s,u)}var Qn=_a.extend({initialize:function(s,u){b(this,u),this._layers={},s&&this.addData(s)},addData:function(s){var u=O(s)?s:s.features,p,w,A;if(u){for(p=0,w=u.length;p<w;p++)A=u[p],(A.geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var z=this.options;if(z.filter&&!z.filter(s))return this;var de=Ui(s,z);return de?(de.feature=jo(s),de.defaultOptions=de.options,this.resetStyle(de),z.onEachFeature&&z.onEachFeature(s,de),this.addLayer(de)):this},resetStyle:function(s){return s===void 0?this.eachLayer(this.resetStyle,this):(s.options=a({},s.defaultOptions),this._setLayerStyle(s,this.options.style),this)},setStyle:function(s){return this.eachLayer(function(u){this._setLayerStyle(u,s)},this)},_setLayerStyle:function(s,u){s.setStyle&&(typeof u=="function"&&(u=u(s.feature)),s.setStyle(u))}});function Ui(s,u){var p=s.type==="Feature"?s.geometry:s,w=p?p.coordinates:null,A=[],z=u&&u.pointToLayer,de=u&&u.coordsToLatLng||Fo,ye,Ae,Oe,He;if(!w&&!p)return null;switch(p.type){case"Point":return ye=de(w),Io(z,s,ye,u);case"MultiPoint":for(Oe=0,He=w.length;Oe<He;Oe++)ye=de(w[Oe]),A.push(Io(z,s,ye,u));return new _a(A);case"LineString":case"MultiLineString":return Ae=Rs(w,p.type==="LineString"?0:1,de),new gn(Ae,u);case"Polygon":case"MultiPolygon":return Ae=Rs(w,p.type==="Polygon"?1:2,de),new ka(Ae,u);case"GeometryCollection":for(Oe=0,He=p.geometries.length;Oe<He;Oe++){var st=Ui({geometry:p.geometries[Oe],type:"Feature",properties:s.properties},u);st&&A.push(st)}return new _a(A);case"FeatureCollection":for(Oe=0,He=p.features.length;Oe<He;Oe++){var _t=Ui(p.features[Oe],u);_t&&A.push(_t)}return new _a(A);default:throw new Error("Invalid GeoJSON object.")}}function Io(s,u,p,w){return s?s(u,p):new wa(p,w&&w.markersInheritOptions&&w)}function Fo(s){return new H(s[1],s[0],s[2])}function Rs(s,u,p){for(var w=[],A=0,z=s.length,de;A<z;A++)de=u?Rs(s[A],u-1,p):(p||Fo)(s[A]),w.push(de);return w}function Lo(s,u){return s=le(s),s.alt!==void 0?[y(s.lng,u),y(s.lat,u),y(s.alt,u)]:[y(s.lng,u),y(s.lat,u)]}function Ro(s,u,p,w){for(var A=[],z=0,de=s.length;z<de;z++)A.push(u?Ro(s[z],An(s[z])?0:u-1,p,w):Lo(s[z],w));return!u&&p&&A.length>0&&A.push(A[0].slice()),A}function $i(s,u){return s.feature?a({},s.feature,{geometry:u}):jo(u)}function jo(s){return s.type==="Feature"||s.type==="FeatureCollection"?s:{type:"Feature",properties:{},geometry:s}}var Gl={toGeoJSON:function(s){return $i(this,{type:"Point",coordinates:Lo(this.getLatLng(),s)})}};wa.include(Gl),Oo.include(Gl),Do.include(Gl),gn.include({toGeoJSON:function(s){var u=!An(this._latlngs),p=Ro(this._latlngs,u?1:0,!1,s);return $i(this,{type:(u?"Multi":"")+"LineString",coordinates:p})}}),ka.include({toGeoJSON:function(s){var u=!An(this._latlngs),p=u&&!An(this._latlngs[0]),w=Ro(this._latlngs,p?2:u?1:0,!0,s);return u||(w=[w]),$i(this,{type:(p?"Multi":"")+"Polygon",coordinates:w})}}),Ba.include({toMultiPoint:function(s){var u=[];return this.eachLayer(function(p){u.push(p.toGeoJSON(s).geometry.coordinates)}),$i(this,{type:"MultiPoint",coordinates:u})},toGeoJSON:function(s){var u=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(u==="MultiPoint")return this.toMultiPoint(s);var p=u==="GeometryCollection",w=[];return this.eachLayer(function(A){if(A.toGeoJSON){var z=A.toGeoJSON(s);if(p)w.push(z.geometry);else{var de=jo(z);de.type==="FeatureCollection"?w.push.apply(w,de.features):w.push(de)}}}),p?$i(this,{geometries:w,type:"GeometryCollection"}):{type:"FeatureCollection",features:w}}});function xu(s,u){return new Qn(s,u)}var Wn=xu,Ua=$n.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(s,u,p){this._url=s,this._bounds=U(u),b(this,p)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(vt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){er(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(s){return this.options.opacity=s,this._image&&this._updateOpacity(),this},setStyle:function(s){return s.opacity&&this.setOpacity(s.opacity),this},bringToFront:function(){return this._map&&Oi(this._image),this},bringToBack:function(){return this._map&&va(this._image),this},setUrl:function(s){return this._url=s,this._image&&(this._image.src=s),this},setBounds:function(s){return this._bounds=U(s),this._map&&this._reset(),this},getEvents:function(){var s={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var s=this._url.tagName==="IMG",u=this._image=s?this._url:it("img");if(vt(u,"leaflet-image-layer"),this._zoomAnimated&&vt(u,"leaflet-zoom-animated"),this.options.className&&vt(u,this.options.className),u.onselectstart=_,u.onmousemove=_,u.onload=c(this.fire,this,"load"),u.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(u.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),s){this._url=u.src;return}u.src=this._url,u.alt=this.options.alt},_animateZoom:function(s){var u=this._map.getZoomScale(s.zoom),p=this._map._latLngBoundsToNewLayerBounds(this._bounds,s.zoom,s.center).min;Mn(this._image,p,u)},_reset:function(){var s=this._image,u=new R(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),p=u.getSize();dr(s,u.min),s.style.width=p.x+"px",s.style.height=p.y+"px"},_updateOpacity:function(){en(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var s=this.options.errorOverlayUrl;s&&this._url!==s&&(this._url=s,this._image.src=s)},getCenter:function(){return this._bounds.getCenter()}}),yu=function(s,u,p){return new Ua(s,u,p)},Zl=Ua.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var s=this._url.tagName==="VIDEO",u=this._image=s?this._url:it("video");if(vt(u,"leaflet-image-layer"),this._zoomAnimated&&vt(u,"leaflet-zoom-animated"),this.options.className&&vt(u,this.options.className),u.onselectstart=_,u.onmousemove=_,u.onloadeddata=c(this.fire,this,"load"),s){for(var p=u.getElementsByTagName("source"),w=[],A=0;A<p.length;A++)w.push(p[A].src);this._url=p.length>0?w:[u.src];return}O(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(u.style,"objectFit")&&(u.style.objectFit="fill"),u.autoplay=!!this.options.autoplay,u.loop=!!this.options.loop,u.muted=!!this.options.muted,u.playsInline=!!this.options.playsInline;for(var z=0;z<this._url.length;z++){var de=it("source");de.src=this._url[z],u.appendChild(de)}}});function _u(s,u,p){return new Zl(s,u,p)}var Kl=Ua.extend({_initImage:function(){var s=this._image=this._url;vt(s,"leaflet-image-layer"),this._zoomAnimated&&vt(s,"leaflet-zoom-animated"),this.options.className&&vt(s,this.options.className),s.onselectstart=_,s.onmousemove=_}});function ql(s,u,p){return new Kl(s,u,p)}var ea=$n.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(s,u){s&&(s instanceof H||O(s))?(this._latlng=le(s),b(this,u)):(b(this,s),this._source=u),this.options.content&&(this._content=this.options.content)},openOn:function(s){return s=arguments.length?s:this._source._map,s.hasLayer(this)||s.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(s){return this._map?this.close():(arguments.length?this._source=s:s=this._source,this._prepareOpen(),this.openOn(s._map)),this},onAdd:function(s){this._zoomAnimated=s._zoomAnimated,this._container||this._initLayout(),s._fadeAnimated&&en(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),s._fadeAnimated&&en(this._container,1),this.bringToFront(),this.options.interactive&&(vt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(s){s._fadeAnimated?(en(this._container,0),this._removeTimeout=setTimeout(c(er,void 0,this._container),200)):er(this._container),this.options.interactive&&(Kt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(s){return this._latlng=le(s),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(s){return this._content=s,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var s={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Oi(this._container),this},bringToBack:function(){return this._map&&va(this._container),this},_prepareOpen:function(s){var u=this._source;if(!u._map)return!1;if(u instanceof _a){u=null;var p=this._source._layers;for(var w in p)if(p[w]._map){u=p[w];break}if(!u)return!1;this._source=u}if(!s)if(u.getCenter)s=u.getCenter();else if(u.getLatLng)s=u.getLatLng();else if(u.getBounds)s=u.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(s),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var s=this._contentNode,u=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof u=="string")s.innerHTML=u;else{for(;s.hasChildNodes();)s.removeChild(s.firstChild);s.appendChild(u)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var s=this._map.latLngToLayerPoint(this._latlng),u=fe(this.options.offset),p=this._getAnchor();this._zoomAnimated?dr(this._container,s.add(p)):u=u.add(s).add(p);var w=this._containerBottom=-u.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+u.x;this._container.style.bottom=w+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}});Ct.include({_initOverlay:function(s,u,p,w){var A=u;return A instanceof s||(A=new s(w).setContent(u)),p&&A.setLatLng(p),A}}),$n.include({_initOverlay:function(s,u,p,w){var A=p;return A instanceof s?(b(A,w),A._source=this):(A=u&&!w?u:new s(w,this),A.setContent(p)),A}});var Mo=ea.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(s){return s=arguments.length?s:this._source._map,!s.hasLayer(this)&&s._popup&&s._popup.options.autoClose&&s.removeLayer(s._popup),s._popup=this,ea.prototype.openOn.call(this,s)},onAdd:function(s){ea.prototype.onAdd.call(this,s),s.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof za||this._source.on("preclick",Jn))},onRemove:function(s){ea.prototype.onRemove.call(this,s),s.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof za||this._source.off("preclick",Jn))},getEvents:function(){var s=ea.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(s.preclick=this.close),this.options.keepInView&&(s.moveend=this._adjustPan),s},_initLayout:function(){var s="leaflet-popup",u=this._container=it("div",s+" "+(this.options.className||"")+" leaflet-zoom-animated"),p=this._wrapper=it("div",s+"-content-wrapper",u);if(this._contentNode=it("div",s+"-content",p),Ds(u),To(this._contentNode),dt(u,"contextmenu",Jn),this._tipContainer=it("div",s+"-tip-container",u),this._tip=it("div",s+"-tip",this._tipContainer),this.options.closeButton){var w=this._closeButton=it("a",s+"-close-button",u);w.setAttribute("role","button"),w.setAttribute("aria-label","Close popup"),w.href="#close",w.innerHTML='<span aria-hidden="true">&#215;</span>',dt(w,"click",function(A){lr(A),this.close()},this)}},_updateLayout:function(){var s=this._contentNode,u=s.style;u.width="",u.whiteSpace="nowrap";var p=s.offsetWidth;p=Math.min(p,this.options.maxWidth),p=Math.max(p,this.options.minWidth),u.width=p+1+"px",u.whiteSpace="",u.height="";var w=s.offsetHeight,A=this.options.maxHeight,z="leaflet-popup-scrolled";A&&w>A?(u.height=A+"px",vt(s,z)):Kt(s,z),this._containerWidth=this._container.offsetWidth},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center),p=this._getAnchor();dr(this._container,u.add(p))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var s=this._map,u=parseInt(ga(this._container,"marginBottom"),10)||0,p=this._container.offsetHeight+u,w=this._containerWidth,A=new ie(this._containerLeft,-p-this._containerBottom);A._add(xa(this._container));var z=s.layerPointToContainerPoint(A),de=fe(this.options.autoPanPadding),ye=fe(this.options.autoPanPaddingTopLeft||de),Ae=fe(this.options.autoPanPaddingBottomRight||de),Oe=s.getSize(),He=0,st=0;z.x+w+Ae.x>Oe.x&&(He=z.x+w-Oe.x+Ae.x),z.x-He-ye.x<0&&(He=z.x-ye.x),z.y+p+Ae.y>Oe.y&&(st=z.y+p-Oe.y+Ae.y),z.y-st-ye.y<0&&(st=z.y-ye.y),(He||st)&&(this.options.keepInView&&(this._autopanning=!0),s.fire("autopanstart").panBy([He,st]))}},_getAnchor:function(){return fe(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Wi=function(s,u){return new Mo(s,u)};Ct.mergeOptions({closePopupOnClick:!0}),Ct.include({openPopup:function(s,u,p){return this._initOverlay(Mo,s,u,p).openOn(this),this},closePopup:function(s){return s=arguments.length?s:this._popup,s&&s.close(),this}}),$n.include({bindPopup:function(s,u){return this._popup=this._initOverlay(Mo,this._popup,s,u),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(s){return this._popup&&(this instanceof _a||(this._popup._source=this),this._popup._prepareOpen(s||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(s){return this._popup&&this._popup.setContent(s),this},getPopup:function(){return this._popup},_openPopup:function(s){if(!(!this._popup||!this._map)){zn(s);var u=s.layer||s.target;if(this._popup._source===u&&!(u instanceof za)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(s.latlng);return}this._popup._source=u,this.openPopup(s.latlng)}},_movePopup:function(s){this._popup.setLatLng(s.latlng)},_onKeyPress:function(s){s.originalEvent.keyCode===13&&this._openPopup(s)}});var Hi=ea.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(s){ea.prototype.onAdd.call(this,s),this.setOpacity(this.options.opacity),s.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(s){ea.prototype.onRemove.call(this,s),s.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var s=ea.prototype.getEvents.call(this);return this.options.permanent||(s.preclick=this.close),s},_initLayout:function(){var s="leaflet-tooltip",u=s+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=it("div",u),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+m(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(s){var u,p,w=this._map,A=this._container,z=w.latLngToContainerPoint(w.getCenter()),de=w.layerPointToContainerPoint(s),ye=this.options.direction,Ae=A.offsetWidth,Oe=A.offsetHeight,He=fe(this.options.offset),st=this._getAnchor();ye==="top"?(u=Ae/2,p=Oe):ye==="bottom"?(u=Ae/2,p=0):ye==="center"?(u=Ae/2,p=Oe/2):ye==="right"?(u=0,p=Oe/2):ye==="left"?(u=Ae,p=Oe/2):de.x<z.x?(ye="right",u=0,p=Oe/2):(ye="left",u=Ae+(He.x+st.x)*2,p=Oe/2),s=s.subtract(fe(u,p,!0)).add(He).add(st),Kt(A,"leaflet-tooltip-right"),Kt(A,"leaflet-tooltip-left"),Kt(A,"leaflet-tooltip-top"),Kt(A,"leaflet-tooltip-bottom"),vt(A,"leaflet-tooltip-"+ye),dr(A,s)},_updatePosition:function(){var s=this._map.latLngToLayerPoint(this._latlng);this._setPosition(s)},setOpacity:function(s){this.options.opacity=s,this._container&&en(this._container,s)},_animateZoom:function(s){var u=this._map._latLngToNewLayerPoint(this._latlng,s.zoom,s.center);this._setPosition(u)},_getAnchor:function(){return fe(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),js=function(s,u){return new Hi(s,u)};Ct.include({openTooltip:function(s,u,p){return this._initOverlay(Hi,s,u,p).openOn(this),this},closeTooltip:function(s){return s.close(),this}}),$n.include({bindTooltip:function(s,u){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Hi,this._tooltip,s,u),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(s){if(!(!s&&this._tooltipHandlersAdded)){var u=s?"off":"on",p={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?p.add=this._openTooltip:(p.mouseover=this._openTooltip,p.mouseout=this.closeTooltip,p.click=this._openTooltip,this._map?this._addFocusListeners():p.add=this._addFocusListeners),this._tooltip.options.sticky&&(p.mousemove=this._moveTooltip),this[u](p),this._tooltipHandlersAdded=!s}},openTooltip:function(s){return this._tooltip&&(this instanceof _a||(this._tooltip._source=this),this._tooltip._prepareOpen(s)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(s){return this._tooltip&&this._tooltip.setContent(s),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(s){var u=typeof s.getElement=="function"&&s.getElement();u&&(dt(u,"focus",function(){this._tooltip._source=s,this.openTooltip()},this),dt(u,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(s){var u=typeof s.getElement=="function"&&s.getElement();u&&u.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(s){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var u=this;this._map.once("moveend",function(){u._openOnceFlag=!1,u._openTooltip(s)});return}this._tooltip._source=s.layer||s.target,this.openTooltip(this._tooltip.options.sticky?s.latlng:void 0)}},_moveTooltip:function(s){var u=s.latlng,p,w;this._tooltip.options.sticky&&s.originalEvent&&(p=this._map.mouseEventToContainerPoint(s.originalEvent),w=this._map.containerPointToLayerPoint(p),u=this._map.layerPointToLatLng(w)),this._tooltip.setLatLng(u)}});var Bo=di.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(s){var u=s&&s.tagName==="DIV"?s:document.createElement("div"),p=this.options;if(p.html instanceof Element?(yo(u),u.appendChild(p.html)):u.innerHTML=p.html!==!1?p.html:"",p.bgPos){var w=fe(p.bgPos);u.style.backgroundPosition=-w.x+"px "+-w.y+"px"}return this._setIconStyles(u,"icon"),u},createShadow:function(){return null}});function wu(s){return new Bo(s)}di.Default=zi;var $a=$n.extend({options:{tileSize:256,opacity:1,updateWhenIdle:et.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(s){b(this,s)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(s){s._addZoomLimit(this)},onRemove:function(s){this._removeAllTiles(),er(this._container),s._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Oi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(va(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(s){return this.options.opacity=s,this._updateOpacity(),this},setZIndex:function(s){return this.options.zIndex=s,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var s=this._clampZoom(this._map.getZoom());s!==this._tileZoom&&(this._tileZoom=s,this._updateLevels()),this._update()}return this},getEvents:function(){var s={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=g(this._onMoveEnd,this.options.updateInterval,this)),s.move=this._onMove),this._zoomAnimated&&(s.zoomanim=this._animateZoom),s},createTile:function(){return document.createElement("div")},getTileSize:function(){var s=this.options.tileSize;return s instanceof ie?s:new ie(s,s)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(s){for(var u=this.getPane().children,p=-s(-1/0,1/0),w=0,A=u.length,z;w<A;w++)z=u[w].style.zIndex,u[w]!==this._container&&z&&(p=s(p,+z));isFinite(p)&&(this.options.zIndex=p+s(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!et.ielt9){en(this._container,this.options.opacity);var s=+new Date,u=!1,p=!1;for(var w in this._tiles){var A=this._tiles[w];if(!(!A.current||!A.loaded)){var z=Math.min(1,(s-A.loaded)/200);en(A.el,z),z<1?u=!0:(A.active?p=!0:this._onOpaqueTile(A),A.active=!0)}}p&&!this._noPrune&&this._pruneTiles(),u&&(Y(this._fadeFrame),this._fadeFrame=ue(this._updateOpacity,this))}},_onOpaqueTile:_,_initContainer:function(){this._container||(this._container=it("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var s=this._tileZoom,u=this.options.maxZoom;if(s!==void 0){for(var p in this._levels)p=Number(p),this._levels[p].el.children.length||p===s?(this._levels[p].el.style.zIndex=u-Math.abs(s-p),this._onUpdateLevel(p)):(er(this._levels[p].el),this._removeTilesAtZoom(p),this._onRemoveLevel(p),delete this._levels[p]);var w=this._levels[s],A=this._map;return w||(w=this._levels[s]={},w.el=it("div","leaflet-tile-container leaflet-zoom-animated",this._container),w.el.style.zIndex=u,w.origin=A.project(A.unproject(A.getPixelOrigin()),s).round(),w.zoom=s,this._setZoomTransform(w,A.getCenter(),A.getZoom()),_(w.el.offsetWidth),this._onCreateLevel(w)),this._level=w,w}},_onUpdateLevel:_,_onRemoveLevel:_,_onCreateLevel:_,_pruneTiles:function(){if(this._map){var s,u,p=this._map.getZoom();if(p>this.options.maxZoom||p<this.options.minZoom){this._removeAllTiles();return}for(s in this._tiles)u=this._tiles[s],u.retain=u.current;for(s in this._tiles)if(u=this._tiles[s],u.current&&!u.active){var w=u.coords;this._retainParent(w.x,w.y,w.z,w.z-5)||this._retainChildren(w.x,w.y,w.z,w.z+2)}for(s in this._tiles)this._tiles[s].retain||this._removeTile(s)}},_removeTilesAtZoom:function(s){for(var u in this._tiles)this._tiles[u].coords.z===s&&this._removeTile(u)},_removeAllTiles:function(){for(var s in this._tiles)this._removeTile(s)},_invalidateAll:function(){for(var s in this._levels)er(this._levels[s].el),this._onRemoveLevel(Number(s)),delete this._levels[s];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(s,u,p,w){var A=Math.floor(s/2),z=Math.floor(u/2),de=p-1,ye=new ie(+A,+z);ye.z=+de;var Ae=this._tileCoordsToKey(ye),Oe=this._tiles[Ae];return Oe&&Oe.active?(Oe.retain=!0,!0):(Oe&&Oe.loaded&&(Oe.retain=!0),de>w?this._retainParent(A,z,de,w):!1)},_retainChildren:function(s,u,p,w){for(var A=2*s;A<2*s+2;A++)for(var z=2*u;z<2*u+2;z++){var de=new ie(A,z);de.z=p+1;var ye=this._tileCoordsToKey(de),Ae=this._tiles[ye];if(Ae&&Ae.active){Ae.retain=!0;continue}else Ae&&Ae.loaded&&(Ae.retain=!0);p+1<w&&this._retainChildren(A,z,p+1,w)}},_resetView:function(s){var u=s&&(s.pinch||s.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),u,u)},_animateZoom:function(s){this._setView(s.center,s.zoom,!0,s.noUpdate)},_clampZoom:function(s){var u=this.options;return u.minNativeZoom!==void 0&&s<u.minNativeZoom?u.minNativeZoom:u.maxNativeZoom!==void 0&&u.maxNativeZoom<s?u.maxNativeZoom:s},_setView:function(s,u,p,w){var A=Math.round(u);this.options.maxZoom!==void 0&&A>this.options.maxZoom||this.options.minZoom!==void 0&&A<this.options.minZoom?A=void 0:A=this._clampZoom(A);var z=this.options.updateWhenZooming&&A!==this._tileZoom;(!w||z)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),A!==void 0&&this._update(s),p||this._pruneTiles(),this._noPrune=!!p),this._setZoomTransforms(s,u)},_setZoomTransforms:function(s,u){for(var p in this._levels)this._setZoomTransform(this._levels[p],s,u)},_setZoomTransform:function(s,u,p){var w=this._map.getZoomScale(p,s.zoom),A=s.origin.multiplyBy(w).subtract(this._map._getNewPixelOrigin(u,p)).round();et.any3d?Mn(s.el,A,w):dr(s.el,A)},_resetGrid:function(){var s=this._map,u=s.options.crs,p=this._tileSize=this.getTileSize(),w=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=u.wrapLng&&!this.options.noWrap&&[Math.floor(s.project([0,u.wrapLng[0]],w).x/p.x),Math.ceil(s.project([0,u.wrapLng[1]],w).x/p.y)],this._wrapY=u.wrapLat&&!this.options.noWrap&&[Math.floor(s.project([u.wrapLat[0],0],w).y/p.x),Math.ceil(s.project([u.wrapLat[1],0],w).y/p.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(s){var u=this._map,p=u._animatingZoom?Math.max(u._animateToZoom,u.getZoom()):u.getZoom(),w=u.getZoomScale(p,this._tileZoom),A=u.project(s,this._tileZoom).floor(),z=u.getSize().divideBy(w*2);return new R(A.subtract(z),A.add(z))},_update:function(s){var u=this._map;if(u){var p=this._clampZoom(u.getZoom());if(s===void 0&&(s=u.getCenter()),this._tileZoom!==void 0){var w=this._getTiledPixelBounds(s),A=this._pxBoundsToTileRange(w),z=A.getCenter(),de=[],ye=this.options.keepBuffer,Ae=new R(A.getBottomLeft().subtract([ye,-ye]),A.getTopRight().add([ye,-ye]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Oe in this._tiles){var He=this._tiles[Oe].coords;(He.z!==this._tileZoom||!Ae.contains(new ie(He.x,He.y)))&&(this._tiles[Oe].current=!1)}if(Math.abs(p-this._tileZoom)>1){this._setView(s,p);return}for(var st=A.min.y;st<=A.max.y;st++)for(var _t=A.min.x;_t<=A.max.x;_t++){var Cr=new ie(_t,st);if(Cr.z=this._tileZoom,!!this._isValidTile(Cr)){var _r=this._tiles[this._tileCoordsToKey(Cr)];_r?_r.current=!0:de.push(Cr)}}if(de.sort(function(rn,qi){return rn.distanceTo(z)-qi.distanceTo(z)}),de.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var vn=document.createDocumentFragment();for(_t=0;_t<de.length;_t++)this._addTile(de[_t],vn);this._level.el.appendChild(vn)}}}},_isValidTile:function(s){var u=this._map.options.crs;if(!u.infinite){var p=this._globalTileRange;if(!u.wrapLng&&(s.x<p.min.x||s.x>p.max.x)||!u.wrapLat&&(s.y<p.min.y||s.y>p.max.y))return!1}if(!this.options.bounds)return!0;var w=this._tileCoordsToBounds(s);return U(this.options.bounds).overlaps(w)},_keyToBounds:function(s){return this._tileCoordsToBounds(this._keyToTileCoords(s))},_tileCoordsToNwSe:function(s){var u=this._map,p=this.getTileSize(),w=s.scaleBy(p),A=w.add(p),z=u.unproject(w,s.z),de=u.unproject(A,s.z);return[z,de]},_tileCoordsToBounds:function(s){var u=this._tileCoordsToNwSe(s),p=new W(u[0],u[1]);return this.options.noWrap||(p=this._map.wrapLatLngBounds(p)),p},_tileCoordsToKey:function(s){return s.x+":"+s.y+":"+s.z},_keyToTileCoords:function(s){var u=s.split(":"),p=new ie(+u[0],+u[1]);return p.z=+u[2],p},_removeTile:function(s){var u=this._tiles[s];u&&(er(u.el),delete this._tiles[s],this.fire("tileunload",{tile:u.el,coords:this._keyToTileCoords(s)}))},_initTile:function(s){vt(s,"leaflet-tile");var u=this.getTileSize();s.style.width=u.x+"px",s.style.height=u.y+"px",s.onselectstart=_,s.onmousemove=_,et.ielt9&&this.options.opacity<1&&en(s,this.options.opacity)},_addTile:function(s,u){var p=this._getTilePos(s),w=this._tileCoordsToKey(s),A=this.createTile(this._wrapCoords(s),c(this._tileReady,this,s));this._initTile(A),this.createTile.length<2&&ue(c(this._tileReady,this,s,null,A)),dr(A,p),this._tiles[w]={el:A,coords:s,current:!0},u.appendChild(A),this.fire("tileloadstart",{tile:A,coords:s})},_tileReady:function(s,u,p){u&&this.fire("tileerror",{error:u,tile:p,coords:s});var w=this._tileCoordsToKey(s);p=this._tiles[w],p&&(p.loaded=+new Date,this._map._fadeAnimated?(en(p.el,0),Y(this._fadeFrame),this._fadeFrame=ue(this._updateOpacity,this)):(p.active=!0,this._pruneTiles()),u||(vt(p.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:p.el,coords:s})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),et.ielt9||!this._map._fadeAnimated?ue(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(s){return s.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(s){var u=new ie(this._wrapX?x(s.x,this._wrapX):s.x,this._wrapY?x(s.y,this._wrapY):s.y);return u.z=s.z,u},_pxBoundsToTileRange:function(s){var u=this.getTileSize();return new R(s.min.unscaleBy(u).floor(),s.max.unscaleBy(u).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var s in this._tiles)if(!this._tiles[s].loaded)return!1;return!0}});function Vi(s){return new $a(s)}var Wa=$a.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(s,u){this._url=s,u=b(this,u),u.detectRetina&&et.retina&&u.maxZoom>0?(u.tileSize=Math.floor(u.tileSize/2),u.zoomReverse?(u.zoomOffset--,u.minZoom=Math.min(u.maxZoom,u.minZoom+1)):(u.zoomOffset++,u.maxZoom=Math.max(u.minZoom,u.maxZoom-1)),u.minZoom=Math.max(0,u.minZoom)):u.zoomReverse?u.minZoom=Math.min(u.maxZoom,u.minZoom):u.maxZoom=Math.max(u.minZoom,u.maxZoom),typeof u.subdomains=="string"&&(u.subdomains=u.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(s,u){return this._url===s&&u===void 0&&(u=!0),this._url=s,u||this.redraw(),this},createTile:function(s,u){var p=document.createElement("img");return dt(p,"load",c(this._tileOnLoad,this,u,p)),dt(p,"error",c(this._tileOnError,this,u,p)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(p.referrerPolicy=this.options.referrerPolicy),p.alt="",p.src=this.getTileUrl(s),p},getTileUrl:function(s){var u={r:et.retina?"@2x":"",s:this._getSubdomain(s),x:s.x,y:s.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var p=this._globalTileRange.max.y-s.y;this.options.tms&&(u.y=p),u["-y"]=p}return F(this._url,a(u,this.options))},_tileOnLoad:function(s,u){et.ielt9?setTimeout(c(s,this,null,u),0):s(null,u)},_tileOnError:function(s,u,p){var w=this.options.errorTileUrl;w&&u.getAttribute("src")!==w&&(u.src=w),s(p,u)},_onTileRemove:function(s){s.tile.onload=null},_getZoomForUrl:function(){var s=this._tileZoom,u=this.options.maxZoom,p=this.options.zoomReverse,w=this.options.zoomOffset;return p&&(s=u-s),s+w},_getSubdomain:function(s){var u=Math.abs(s.x+s.y)%this.options.subdomains.length;return this.options.subdomains[u]},_abortLoading:function(){var s,u;for(s in this._tiles)if(this._tiles[s].coords.z!==this._tileZoom&&(u=this._tiles[s].el,u.onload=_,u.onerror=_,!u.complete)){u.src=G;var p=this._tiles[s].coords;er(u),delete this._tiles[s],this.fire("tileabort",{tile:u,coords:p})}},_removeTile:function(s){var u=this._tiles[s];if(u)return u.el.setAttribute("src",G),$a.prototype._removeTile.call(this,s)},_tileReady:function(s,u,p){if(!(!this._map||p&&p.getAttribute("src")===G))return $a.prototype._tileReady.call(this,s,u,p)}});function Yl(s,u){return new Wa(s,u)}var Ms=Wa.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(s,u){this._url=s;var p=a({},this.defaultWmsParams);for(var w in u)w in this.options||(p[w]=u[w]);u=b(this,u);var A=u.detectRetina&&et.retina?2:1,z=this.getTileSize();p.width=z.x*A,p.height=z.y*A,this.wmsParams=p},onAdd:function(s){this._crs=this.options.crs||s.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var u=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[u]=this._crs.code,Wa.prototype.onAdd.call(this,s)},getTileUrl:function(s){var u=this._tileCoordsToNwSe(s),p=this._crs,w=P(p.project(u[0]),p.project(u[1])),A=w.min,z=w.max,de=(this._wmsVersion>=1.3&&this._crs===mu?[A.y,A.x,z.y,z.x]:[A.x,A.y,z.x,z.y]).join(","),ye=Wa.prototype.getTileUrl.call(this,s);return ye+E(this.wmsParams,ye,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+de},setParams:function(s,u){return a(this.wmsParams,s),u||this.redraw(),this}});function ku(s,u){return new Ms(s,u)}Wa.WMS=Ms,Yl.wms=ku;var ta=$n.extend({options:{padding:.1},initialize:function(s){b(this,s),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),vt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var s={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(s.zoomanim=this._onAnimZoom),s},_onAnimZoom:function(s){this._updateTransform(s.center,s.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(s,u){var p=this._map.getZoomScale(u,this._zoom),w=this._map.getSize().multiplyBy(.5+this.options.padding),A=this._map.project(this._center,u),z=w.multiplyBy(-p).add(A).subtract(this._map._getNewPixelOrigin(s,u));et.any3d?Mn(this._container,z,p):dr(this._container,z)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var s in this._layers)this._layers[s]._reset()},_onZoomEnd:function(){for(var s in this._layers)this._layers[s]._project()},_updatePaths:function(){for(var s in this._layers)this._layers[s]._update()},_update:function(){var s=this.options.padding,u=this._map.getSize(),p=this._map.containerPointToLayerPoint(u.multiplyBy(-s)).round();this._bounds=new R(p,p.add(u.multiplyBy(1+s*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Xl=ta.extend({options:{tolerance:0},getEvents:function(){var s=ta.prototype.getEvents.call(this);return s.viewprereset=this._onViewPreReset,s},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ta.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var s=this._container=document.createElement("canvas");dt(s,"mousemove",this._onMouseMove,this),dt(s,"click dblclick mousedown mouseup contextmenu",this._onClick,this),dt(s,"mouseout",this._handleMouseOut,this),s._leaflet_disable_events=!0,this._ctx=s.getContext("2d")},_destroyContainer:function(){Y(this._redrawRequest),delete this._ctx,er(this._container),Wt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var s;this._redrawBounds=null;for(var u in this._layers)s=this._layers[u],s._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ta.prototype._update.call(this);var s=this._bounds,u=this._container,p=s.getSize(),w=et.retina?2:1;dr(u,s.min),u.width=w*p.x,u.height=w*p.y,u.style.width=p.x+"px",u.style.height=p.y+"px",et.retina&&this._ctx.scale(2,2),this._ctx.translate(-s.min.x,-s.min.y),this.fire("update")}},_reset:function(){ta.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(s){this._updateDashArray(s),this._layers[m(s)]=s;var u=s._order={layer:s,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=u),this._drawLast=u,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(s){this._requestRedraw(s)},_removePath:function(s){var u=s._order,p=u.next,w=u.prev;p?p.prev=w:this._drawLast=w,w?w.next=p:this._drawFirst=p,delete s._order,delete this._layers[m(s)],this._requestRedraw(s)},_updatePath:function(s){this._extendRedrawBounds(s),s._project(),s._update(),this._requestRedraw(s)},_updateStyle:function(s){this._updateDashArray(s),this._requestRedraw(s)},_updateDashArray:function(s){if(typeof s.options.dashArray=="string"){var u=s.options.dashArray.split(/[, ]+/),p=[],w,A;for(A=0;A<u.length;A++){if(w=Number(u[A]),isNaN(w))return;p.push(w)}s.options._dashArray=p}else s.options._dashArray=s.options.dashArray},_requestRedraw:function(s){this._map&&(this._extendRedrawBounds(s),this._redrawRequest=this._redrawRequest||ue(this._redraw,this))},_extendRedrawBounds:function(s){if(s._pxBounds){var u=(s.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new R,this._redrawBounds.extend(s._pxBounds.min.subtract([u,u])),this._redrawBounds.extend(s._pxBounds.max.add([u,u]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var s=this._redrawBounds;if(s){var u=s.getSize();this._ctx.clearRect(s.min.x,s.min.y,u.x,u.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var s,u=this._redrawBounds;if(this._ctx.save(),u){var p=u.getSize();this._ctx.beginPath(),this._ctx.rect(u.min.x,u.min.y,p.x,p.y),this._ctx.clip()}this._drawing=!0;for(var w=this._drawFirst;w;w=w.next)s=w.layer,(!u||s._pxBounds&&s._pxBounds.intersects(u))&&s._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(s,u){if(this._drawing){var p,w,A,z,de=s._parts,ye=de.length,Ae=this._ctx;if(ye){for(Ae.beginPath(),p=0;p<ye;p++){for(w=0,A=de[p].length;w<A;w++)z=de[p][w],Ae[w?"lineTo":"moveTo"](z.x,z.y);u&&Ae.closePath()}this._fillStroke(Ae,s)}}},_updateCircle:function(s){if(!(!this._drawing||s._empty())){var u=s._point,p=this._ctx,w=Math.max(Math.round(s._radius),1),A=(Math.max(Math.round(s._radiusY),1)||w)/w;A!==1&&(p.save(),p.scale(1,A)),p.beginPath(),p.arc(u.x,u.y/A,w,0,Math.PI*2,!1),A!==1&&p.restore(),this._fillStroke(p,s)}},_fillStroke:function(s,u){var p=u.options;p.fill&&(s.globalAlpha=p.fillOpacity,s.fillStyle=p.fillColor||p.color,s.fill(p.fillRule||"evenodd")),p.stroke&&p.weight!==0&&(s.setLineDash&&s.setLineDash(u.options&&u.options._dashArray||[]),s.globalAlpha=p.opacity,s.lineWidth=p.weight,s.strokeStyle=p.color,s.lineCap=p.lineCap,s.lineJoin=p.lineJoin,s.stroke())},_onClick:function(s){for(var u=this._map.mouseEventToLayerPoint(s),p,w,A=this._drawFirst;A;A=A.next)p=A.layer,p.options.interactive&&p._containsPoint(u)&&(!(s.type==="click"||s.type==="preclick")||!this._map._draggableMoved(p))&&(w=p);this._fireEvent(w?[w]:!1,s)},_onMouseMove:function(s){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var u=this._map.mouseEventToLayerPoint(s);this._handleMouseHover(s,u)}},_handleMouseOut:function(s){var u=this._hoveredLayer;u&&(Kt(this._container,"leaflet-interactive"),this._fireEvent([u],s,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(s,u){if(!this._mouseHoverThrottled){for(var p,w,A=this._drawFirst;A;A=A.next)p=A.layer,p.options.interactive&&p._containsPoint(u)&&(w=p);w!==this._hoveredLayer&&(this._handleMouseOut(s),w&&(vt(this._container,"leaflet-interactive"),this._fireEvent([w],s,"mouseover"),this._hoveredLayer=w)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,s),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(s,u,p){this._map._fireDOMEvent(u,p||u.type,s)},_bringToFront:function(s){var u=s._order;if(u){var p=u.next,w=u.prev;if(p)p.prev=w;else return;w?w.next=p:p&&(this._drawFirst=p),u.prev=this._drawLast,this._drawLast.next=u,u.next=null,this._drawLast=u,this._requestRedraw(s)}},_bringToBack:function(s){var u=s._order;if(u){var p=u.next,w=u.prev;if(w)w.next=p;else return;p?p.prev=w:w&&(this._drawLast=w),u.prev=null,u.next=this._drawFirst,this._drawFirst.prev=u,this._drawFirst=u,this._requestRedraw(s)}}});function Jl(s){return et.canvas?new Xl(s):null}var Gi=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(s){return document.createElement("<lvml:"+s+' class="lvml">')}}catch{}return function(s){return document.createElement("<"+s+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),bu={_initContainer:function(){this._container=it("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ta.prototype._update.call(this),this.fire("update"))},_initPath:function(s){var u=s._container=Gi("shape");vt(u,"leaflet-vml-shape "+(this.options.className||"")),u.coordsize="1 1",s._path=Gi("path"),u.appendChild(s._path),this._updateStyle(s),this._layers[m(s)]=s},_addPath:function(s){var u=s._container;this._container.appendChild(u),s.options.interactive&&s.addInteractiveTarget(u)},_removePath:function(s){var u=s._container;er(u),s.removeInteractiveTarget(u),delete this._layers[m(s)]},_updateStyle:function(s){var u=s._stroke,p=s._fill,w=s.options,A=s._container;A.stroked=!!w.stroke,A.filled=!!w.fill,w.stroke?(u||(u=s._stroke=Gi("stroke")),A.appendChild(u),u.weight=w.weight+"px",u.color=w.color,u.opacity=w.opacity,w.dashArray?u.dashStyle=O(w.dashArray)?w.dashArray.join(" "):w.dashArray.replace(/( *, *)/g," "):u.dashStyle="",u.endcap=w.lineCap.replace("butt","flat"),u.joinstyle=w.lineJoin):u&&(A.removeChild(u),s._stroke=null),w.fill?(p||(p=s._fill=Gi("fill")),A.appendChild(p),p.color=w.fillColor||w.color,p.opacity=w.fillOpacity):p&&(A.removeChild(p),s._fill=null)},_updateCircle:function(s){var u=s._point.round(),p=Math.round(s._radius),w=Math.round(s._radiusY||p);this._setPath(s,s._empty()?"M0 0":"AL "+u.x+","+u.y+" "+p+","+w+" 0,"+65535*360)},_setPath:function(s,u){s._path.v=u},_bringToFront:function(s){Oi(s._container)},_bringToBack:function(s){va(s._container)}},Hn=et.vml?Gi:yt,fi=ta.extend({_initContainer:function(){this._container=Hn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Hn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){er(this._container),Wt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ta.prototype._update.call(this);var s=this._bounds,u=s.getSize(),p=this._container;(!this._svgSize||!this._svgSize.equals(u))&&(this._svgSize=u,p.setAttribute("width",u.x),p.setAttribute("height",u.y)),dr(p,s.min),p.setAttribute("viewBox",[s.min.x,s.min.y,u.x,u.y].join(" ")),this.fire("update")}},_initPath:function(s){var u=s._path=Hn("path");s.options.className&&vt(u,s.options.className),s.options.interactive&&vt(u,"leaflet-interactive"),this._updateStyle(s),this._layers[m(s)]=s},_addPath:function(s){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(s._path),s.addInteractiveTarget(s._path)},_removePath:function(s){er(s._path),s.removeInteractiveTarget(s._path),delete this._layers[m(s)]},_updatePath:function(s){s._project(),s._update()},_updateStyle:function(s){var u=s._path,p=s.options;u&&(p.stroke?(u.setAttribute("stroke",p.color),u.setAttribute("stroke-opacity",p.opacity),u.setAttribute("stroke-width",p.weight),u.setAttribute("stroke-linecap",p.lineCap),u.setAttribute("stroke-linejoin",p.lineJoin),p.dashArray?u.setAttribute("stroke-dasharray",p.dashArray):u.removeAttribute("stroke-dasharray"),p.dashOffset?u.setAttribute("stroke-dashoffset",p.dashOffset):u.removeAttribute("stroke-dashoffset")):u.setAttribute("stroke","none"),p.fill?(u.setAttribute("fill",p.fillColor||p.color),u.setAttribute("fill-opacity",p.fillOpacity),u.setAttribute("fill-rule",p.fillRule||"evenodd")):u.setAttribute("fill","none"))},_updatePoly:function(s,u){this._setPath(s,ut(s._parts,u))},_updateCircle:function(s){var u=s._point,p=Math.max(Math.round(s._radius),1),w=Math.max(Math.round(s._radiusY),1)||p,A="a"+p+","+w+" 0 1,0 ",z=s._empty()?"M0 0":"M"+(u.x-p)+","+u.y+A+p*2+",0 "+A+-p*2+",0 ";this._setPath(s,z)},_setPath:function(s,u){s._path.setAttribute("d",u)},_bringToFront:function(s){Oi(s._path)},_bringToBack:function(s){va(s._path)}});et.vml&&fi.include(bu);function zo(s){return et.svg||et.vml?new fi(s):null}Ct.include({getRenderer:function(s){var u=s.options.renderer||this._getPaneRenderer(s.options.pane)||this.options.renderer||this._renderer;return u||(u=this._renderer=this._createRenderer()),this.hasLayer(u)||this.addLayer(u),u},_getPaneRenderer:function(s){if(s==="overlayPane"||s===void 0)return!1;var u=this._paneRenderers[s];return u===void 0&&(u=this._createRenderer({pane:s}),this._paneRenderers[s]=u),u},_createRenderer:function(s){return this.options.preferCanvas&&Jl(s)||zo(s)}});var Su=ka.extend({initialize:function(s,u){ka.prototype.initialize.call(this,this._boundsToLatLngs(s),u)},setBounds:function(s){return this.setLatLngs(this._boundsToLatLngs(s))},_boundsToLatLngs:function(s){return s=U(s),[s.getSouthWest(),s.getNorthWest(),s.getNorthEast(),s.getSouthEast()]}});function Ef(s,u){return new Su(s,u)}fi.create=Hn,fi.pointsToPath=ut,Qn.geometryToLayer=Ui,Qn.coordsToLatLng=Fo,Qn.coordsToLatLngs=Rs,Qn.latLngToCoords=Lo,Qn.latLngsToCoords=Ro,Qn.getFeature=$i,Qn.asFeature=jo,Ct.mergeOptions({boxZoom:!0});var Zi=Cn.extend({initialize:function(s){this._map=s,this._container=s._container,this._pane=s._panes.overlayPane,this._resetStateTimeout=0,s.on("unload",this._destroy,this)},addHooks:function(){dt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Wt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){er(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(s){if(!s.shiftKey||s.which!==1&&s.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Nt(),ko(),this._startPoint=this._map.mouseEventToContainerPoint(s),dt(document,{contextmenu:zn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(s){this._moved||(this._moved=!0,this._box=it("div","leaflet-zoom-box",this._container),vt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(s);var u=new R(this._point,this._startPoint),p=u.getSize();dr(this._box,u.min),this._box.style.width=p.x+"px",this._box.style.height=p.y+"px"},_finish:function(){this._moved&&(er(this._box),Kt(this._container,"leaflet-crosshair")),Li(),bo(),Wt(document,{contextmenu:zn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(s){if(!(s.which!==1&&s.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var u=new W(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(u).fire("boxzoomend",{boxZoomBounds:u})}},_onKeyDown:function(s){s.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ct.addInitHook("addHandler","boxZoom",Zi),Ct.mergeOptions({doubleClickZoom:!0});var Tu=Cn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(s){var u=this._map,p=u.getZoom(),w=u.options.zoomDelta,A=s.originalEvent.shiftKey?p-w:p+w;u.options.doubleClickZoom==="center"?u.setZoom(A):u.setZoomAround(s.containerPoint,A)}});Ct.addInitHook("addHandler","doubleClickZoom",Tu),Ct.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ql=Cn.extend({addHooks:function(){if(!this._draggable){var s=this._map;this._draggable=new Un(s._mapPane,s._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),s.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),s.on("zoomend",this._onZoomEnd,this),s.whenReady(this._onZoomEnd,this))}vt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Kt(this._map._container,"leaflet-grab"),Kt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var s=this._map;if(s._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var u=U(this._map.options.maxBounds);this._offsetLimit=P(this._map.latLngToContainerPoint(u.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(u.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;s.fire("movestart").fire("dragstart"),s.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(s){if(this._map.options.inertia){var u=this._lastTime=+new Date,p=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(p),this._times.push(u),this._prunePositions(u)}this._map.fire("move",s).fire("drag",s)},_prunePositions:function(s){for(;this._positions.length>1&&s-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var s=this._map.getSize().divideBy(2),u=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=u.subtract(s).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(s,u){return s-(s-u)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var s=this._draggable._newPos.subtract(this._draggable._startPos),u=this._offsetLimit;s.x<u.min.x&&(s.x=this._viscousLimit(s.x,u.min.x)),s.y<u.min.y&&(s.y=this._viscousLimit(s.y,u.min.y)),s.x>u.max.x&&(s.x=this._viscousLimit(s.x,u.max.x)),s.y>u.max.y&&(s.y=this._viscousLimit(s.y,u.max.y)),this._draggable._newPos=this._draggable._startPos.add(s)}},_onPreDragWrap:function(){var s=this._worldWidth,u=Math.round(s/2),p=this._initialWorldOffset,w=this._draggable._newPos.x,A=(w-u+p)%s+u-p,z=(w+u+p)%s-u-p,de=Math.abs(A+p)<Math.abs(z+p)?A:z;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=de},_onDragEnd:function(s){var u=this._map,p=u.options,w=!p.inertia||s.noInertia||this._times.length<2;if(u.fire("dragend",s),w)u.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),z=(this._lastTime-this._times[0])/1e3,de=p.easeLinearity,ye=A.multiplyBy(de/z),Ae=ye.distanceTo([0,0]),Oe=Math.min(p.inertiaMaxSpeed,Ae),He=ye.multiplyBy(Oe/Ae),st=Oe/(p.inertiaDeceleration*de),_t=He.multiplyBy(-st/2).round();!_t.x&&!_t.y?u.fire("moveend"):(_t=u._limitOffset(_t,u.options.maxBounds),ue(function(){u.panBy(_t,{duration:st,easeLinearity:de,noMoveStart:!0,animate:!0})}))}}});Ct.addInitHook("addHandler","dragging",Ql),Ct.mergeOptions({keyboard:!0,keyboardPanDelta:80});var ec=Cn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(s){this._map=s,this._setPanDelta(s.options.keyboardPanDelta),this._setZoomDelta(s.options.zoomDelta)},addHooks:function(){var s=this._map._container;s.tabIndex<=0&&(s.tabIndex="0"),dt(s,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Wt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var s=document.body,u=document.documentElement,p=s.scrollTop||u.scrollTop,w=s.scrollLeft||u.scrollLeft;this._map._container.focus(),window.scrollTo(w,p)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(s){var u=this._panKeys={},p=this.keyCodes,w,A;for(w=0,A=p.left.length;w<A;w++)u[p.left[w]]=[-1*s,0];for(w=0,A=p.right.length;w<A;w++)u[p.right[w]]=[s,0];for(w=0,A=p.down.length;w<A;w++)u[p.down[w]]=[0,s];for(w=0,A=p.up.length;w<A;w++)u[p.up[w]]=[0,-1*s]},_setZoomDelta:function(s){var u=this._zoomKeys={},p=this.keyCodes,w,A;for(w=0,A=p.zoomIn.length;w<A;w++)u[p.zoomIn[w]]=s;for(w=0,A=p.zoomOut.length;w<A;w++)u[p.zoomOut[w]]=-s},_addHooks:function(){dt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Wt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(s){if(!(s.altKey||s.ctrlKey||s.metaKey)){var u=s.keyCode,p=this._map,w;if(u in this._panKeys){if(!p._panAnim||!p._panAnim._inProgress)if(w=this._panKeys[u],s.shiftKey&&(w=fe(w).multiplyBy(3)),p.options.maxBounds&&(w=p._limitOffset(fe(w),p.options.maxBounds)),p.options.worldCopyJump){var A=p.wrapLatLng(p.unproject(p.project(p.getCenter()).add(w)));p.panTo(A)}else p.panBy(w)}else if(u in this._zoomKeys)p.setZoom(p.getZoom()+(s.shiftKey?3:1)*this._zoomKeys[u]);else if(u===27&&p._popup&&p._popup.options.closeOnEscapeKey)p.closePopup();else return;zn(s)}}});Ct.addInitHook("addHandler","keyboard",ec),Ct.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Ht=Cn.extend({addHooks:function(){dt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Wt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(s){var u=su(s),p=this._map.options.wheelDebounceTime;this._delta+=u,this._lastMousePos=this._map.mouseEventToContainerPoint(s),this._startTime||(this._startTime=+new Date);var w=Math.max(p-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),w),zn(s)},_performZoom:function(){var s=this._map,u=s.getZoom(),p=this._map.options.zoomSnap||0;s._stop();var w=this._delta/(this._map.options.wheelPxPerZoomLevel*4),A=4*Math.log(2/(1+Math.exp(-Math.abs(w))))/Math.LN2,z=p?Math.ceil(A/p)*p:A,de=s._limitZoom(u+(this._delta>0?z:-z))-u;this._delta=0,this._startTime=null,de&&(s.options.scrollWheelZoom==="center"?s.setZoom(u+de):s.setZoomAround(this._lastMousePos,u+de))}});Ct.addInitHook("addHandler","scrollWheelZoom",Ht);var tc=600;Ct.mergeOptions({tapHold:et.touchNative&&et.safari&&et.mobile,tapTolerance:15});var Bs=Cn.extend({addHooks:function(){dt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Wt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(s){if(clearTimeout(this._holdTimeout),s.touches.length===1){var u=s.touches[0];this._startPos=this._newPos=new ie(u.clientX,u.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(dt(document,"touchend",lr),dt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",u))},this),tc),dt(document,"touchend touchcancel contextmenu",this._cancel,this),dt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function s(){Wt(document,"touchend",lr),Wt(document,"touchend touchcancel",s)},_cancel:function(){clearTimeout(this._holdTimeout),Wt(document,"touchend touchcancel contextmenu",this._cancel,this),Wt(document,"touchmove",this._onMove,this)},_onMove:function(s){var u=s.touches[0];this._newPos=new ie(u.clientX,u.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(s,u){var p=new MouseEvent(s,{bubbles:!0,cancelable:!0,view:window,screenX:u.screenX,screenY:u.screenY,clientX:u.clientX,clientY:u.clientY});p._simulated=!0,u.target.dispatchEvent(p)}});Ct.addInitHook("addHandler","tapHold",Bs),Ct.mergeOptions({touchZoom:et.touch,bounceAtZoomLimits:!0});var Ki=Cn.extend({addHooks:function(){vt(this._map._container,"leaflet-touch-zoom"),dt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Kt(this._map._container,"leaflet-touch-zoom"),Wt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(s){var u=this._map;if(!(!s.touches||s.touches.length!==2||u._animatingZoom||this._zooming)){var p=u.mouseEventToContainerPoint(s.touches[0]),w=u.mouseEventToContainerPoint(s.touches[1]);this._centerPoint=u.getSize()._divideBy(2),this._startLatLng=u.containerPointToLatLng(this._centerPoint),u.options.touchZoom!=="center"&&(this._pinchStartLatLng=u.containerPointToLatLng(p.add(w)._divideBy(2))),this._startDist=p.distanceTo(w),this._startZoom=u.getZoom(),this._moved=!1,this._zooming=!0,u._stop(),dt(document,"touchmove",this._onTouchMove,this),dt(document,"touchend touchcancel",this._onTouchEnd,this),lr(s)}},_onTouchMove:function(s){if(!(!s.touches||s.touches.length!==2||!this._zooming)){var u=this._map,p=u.mouseEventToContainerPoint(s.touches[0]),w=u.mouseEventToContainerPoint(s.touches[1]),A=p.distanceTo(w)/this._startDist;if(this._zoom=u.getScaleZoom(A,this._startZoom),!u.options.bounceAtZoomLimits&&(this._zoom<u.getMinZoom()&&A<1||this._zoom>u.getMaxZoom()&&A>1)&&(this._zoom=u._limitZoom(this._zoom)),u.options.touchZoom==="center"){if(this._center=this._startLatLng,A===1)return}else{var z=p._add(w)._divideBy(2)._subtract(this._centerPoint);if(A===1&&z.x===0&&z.y===0)return;this._center=u.unproject(u.project(this._pinchStartLatLng,this._zoom).subtract(z),this._zoom)}this._moved||(u._moveStart(!0,!1),this._moved=!0),Y(this._animRequest);var de=c(u._move,u,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ue(de,this,!0),lr(s)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Y(this._animRequest),Wt(document,"touchmove",this._onTouchMove,this),Wt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ct.addInitHook("addHandler","touchZoom",Ki),Ct.BoxZoom=Zi,Ct.DoubleClickZoom=Tu,Ct.Drag=Ql,Ct.Keyboard=ec,Ct.ScrollWheelZoom=Ht,Ct.TapHold=Bs,Ct.TouchZoom=Ki,t.Bounds=R,t.Browser=et,t.CRS=ge,t.Canvas=Xl,t.Circle=Oo,t.CircleMarker=Do,t.Class=ve,t.Control=pn,t.DivIcon=Bo,t.DivOverlay=ea,t.DomEvent=Eo,t.DomUtil=Ns,t.Draggable=Un,t.Evented=V,t.FeatureGroup=_a,t.GeoJSON=Qn,t.GridLayer=$a,t.Handler=Cn,t.Icon=di,t.ImageOverlay=Ua,t.LatLng=H,t.LatLngBounds=W,t.Layer=$n,t.LayerGroup=Ba,t.LineUtil=hu,t.Map=Ct,t.Marker=wa,t.Mixin=Ml,t.Path=za,t.Point=ie,t.PolyUtil=pf,t.Polygon=ka,t.Polyline=gn,t.Popup=Mo,t.PosAnimation=Co,t.Projection=_f,t.Rectangle=Su,t.Renderer=ta,t.SVG=fi,t.SVGOverlay=Kl,t.TileLayer=Wa,t.Tooltip=Hi,t.Transformation=Ke,t.Util=se,t.VideoOverlay=Zl,t.bind=c,t.bounds=P,t.canvas=Jl,t.circle=Ls,t.circleMarker=vu,t.control=Ma,t.divIcon=wu,t.extend=a,t.featureGroup=pu,t.geoJSON=xu,t.geoJson=Wn,t.gridLayer=Vi,t.icon=gu,t.imageOverlay=yu,t.latLng=le,t.latLngBounds=U,t.layerGroup=Fs,t.map=ja,t.marker=bf,t.point=fe,t.polygon=Tf,t.polyline=Sf,t.popup=Wi,t.rectangle=Ef,t.setOptions=b,t.stamp=m,t.svg=zo,t.svgOverlay=ql,t.tileLayer=Yl,t.tooltip=js,t.transformation=te,t.version=n,t.videoOverlay=_u;var Eu=window.L;t.noConflict=function(){return window.L=Eu,this},window.L=t}))})(Ec,Ec.exports)),Ec.exports}var Ol=BD();const Yc=tf(Ol);function df(e,r,t){return Object.freeze({instance:e,context:r,container:t})}function ff(e,r){return r==null?function(n,a){const l=J.useRef();return l.current||(l.current=e(n,a)),l}:function(n,a){const l=J.useRef();l.current||(l.current=e(n,a));const c=J.useRef(n),{instance:d}=l.current;return J.useEffect(function(){c.current!==n&&(r(d,n,c.current),c.current=n)},[d,n,a]),l}}function Iy(e,r){J.useEffect(function(){return(r.layerContainer??r.map).addLayer(e.instance),function(){r.layerContainer?.removeLayer(e.instance),r.map.removeLayer(e.instance)}},[r,e])}function Fy(e){return function(t){const n=cf(),a=e(uf(t,n),n);return Ay(n.map,t.attribution),ym(a.current,t.eventHandlers),Iy(a.current,n),a}}function zD(e,r){const t=J.useRef();J.useEffect(function(){if(r.pathOptions!==t.current){const a=r.pathOptions??{};e.instance.setStyle(a),t.current=a}},[e,r])}function UD(e){return function(t){const n=cf(),a=e(uf(t,n),n);return ym(a.current,t.eventHandlers),Iy(a.current,n),zD(a.current,t),a}}function $D(e,r){const t=ff(e,r),n=Fy(t);return Oy(n)}function WD(e,r){const t=ff(e),n=jD(t,r);return LD(n)}function HD(e,r){const t=ff(e,r),n=UD(t);return Oy(n)}function VD(e,r){const t=ff(e,r),n=Fy(t);return RD(n)}function GD(e,r,t){const{opacity:n,zIndex:a}=r;n!=null&&n!==t.opacity&&e.setOpacity(n),a!=null&&a!==t.zIndex&&e.setZIndex(a)}function ZD(){return cf().map}function I0(){return I0=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},I0.apply(this,arguments)}function KD({bounds:e,boundsOptions:r,center:t,children:n,className:a,id:l,placeholder:c,style:d,whenReady:m,zoom:g,...x},_){const[y]=J.useState({className:a,id:l,style:d}),[S,C]=J.useState(null);J.useImperativeHandle(_,()=>S?.map??null,[S]);const b=J.useCallback(D=>{if(D!==null&&S===null){const F=new Ol.Map(D,x);t!=null&&g!=null?F.setView(t,g):e!=null&&F.fitBounds(e,r),m!=null&&F.whenReady(m),C(FD(F))}},[]);J.useEffect(()=>()=>{S?.map.remove()},[S]);const E=S?Tr.createElement(Dy,{value:S},n):c??null;return Tr.createElement("div",I0({},y,{ref:b}),E)}const qD=J.forwardRef(KD),YD=$D(function({position:r,...t},n){const a=new Ol.Marker(r,t);return df(a,Py(n,{overlayContainer:a}))},function(r,t,n){t.position!==n.position&&r.setLatLng(t.position),t.icon!=null&&t.icon!==n.icon&&r.setIcon(t.icon),t.zIndexOffset!=null&&t.zIndexOffset!==n.zIndexOffset&&r.setZIndexOffset(t.zIndexOffset),t.opacity!=null&&t.opacity!==n.opacity&&r.setOpacity(t.opacity),r.dragging!=null&&t.draggable!==n.draggable&&(t.draggable===!0?r.dragging.enable():r.dragging.disable())}),XD=HD(function({positions:r,...t},n){const a=new Ol.Polyline(r,t);return df(a,Py(n,{overlayContainer:a}))},function(r,t,n){t.positions!==n.positions&&r.setLatLngs(t.positions)}),tx=WD(function(r,t){const n=new Ol.Popup(r,t.overlayContainer);return df(n,t)},function(r,t,{position:n},a){J.useEffect(function(){const{instance:c}=r;function d(g){g.popup===c&&(c.update(),a(!0))}function m(g){g.popup===c&&a(!1)}return t.map.on({popupopen:d,popupclose:m}),t.overlayContainer==null?(n!=null&&c.setLatLng(n),c.openOn(t.map)):t.overlayContainer.bindPopup(c),function(){t.map.off({popupopen:d,popupclose:m}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(c)}},[r,t,a,n])}),JD=VD(function({url:r,...t},n){const a=new Ol.TileLayer(r,uf(t,n));return df(a,n)},function(r,t,n){GD(r,t,n);const{url:a}=t;a!=null&&a!==n.url&&r.setUrl(a)}),Ly="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7cua5gzeKg8hJo3grY4g7c3grU0gLI2frE0daAubJc2gbQwd6QzeKk2gLMtd5sxdKIua5g1frA2f7IydaM0e6w2fq41fK01eqo3grgubJgta5cxdKI1f7AydaQydaMxc6EubJgvbJkwcZ4ubZkwcJwubZgubJcydqUydKIxapgubJctbJcubZcubJcvbJYubJcvbZkubJctbJctbZcubJg2f7AubJcrbZcubJcubJcua5g3grY0fq8ubJcubJdEkdEwhsw6i88vhswuhcsuhMtBjMgthMsrg8srgss6is8qgcs8i9A9iMYtg8spgcoogMo7hcMngMonf8olfso4gr8kfck5iM8jfMk4iM8he8k1fro7itAgesk2hs8eecgzfLcofssdeMg0hc4cd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqhUndROmdM1fK0wcZ8vb5w0eqpQm9MzeKhXoNVcpdYydKNWn9VZotVKltJFjsIwcJ1Rms9OlslLmtH///8+kc9epdYzd6dbo9VHkMM2f7FHmNBClM8ydqVcpNY9hro3gLM9hLczealQmcw3fa46f7A8gLMxc6I3eagyc6FIldJMl9JSnNRSntNNl9JPnNJFi75UnM9ZodVKksg8kM45jc09e6ZHltFBk883gbRBh7pDk9EwcaBzn784g7dKkcY2i81Om9M7j85Llc81is09g7Q4grY/j9A0eqxKmdFFltBEjcXf6fFImdBCiLxJl9FGlNFBi78yiMxVndEvbpo6js74+vx+psPP3+o/ks5HkcpGmNCjwdZCkNDM3ehYoNJEls+lxNkxh8xHks0+jdC1zd5Lg6r+/v/H2ufz9/o3jM3t8/edvdM/k89Th61OiLBSjbZklbaTt9BfptdjmL1AicBHj8hGk9FAgK1dkLNTjLRekrdClc/k7fM0icy0y9tgp9c4jc2NtM9Dlc8zicxeXZn3AAAAQ3RSTlMAHDdTb4yPA+LtnEQmC4L2EmHqB7XA0d0sr478x4/Yd5i1zOfyPkf1sLVq4Nh3FvjxopQ2/STNuFzUwFIwxKaejILpIBEV9wAABhVJREFUeF6s1NdyFEcYBeBeoQIhRAkLlRDGrhIgY3BJL8CVeKzuyXFzzjkn5ZxzzuScg3PO8cKzu70JkO0LfxdTU//pM9vTu7Xgf6KqOVTb9X7toRrVEfBf1HTVjZccrT/2by1VV928Yty9ZbVuucdz90frG8DBjl9pVApbOstvmMuvVgaNXSfAAd6pGxpy6yxf5ph43pS/4f3uoaGm2rdu72S9xzOvMymkZFq/ptDrk90mhW7e4zl7HLzhxGWPR20xmSxJ/VqldG5m9XhaVOA1DadsNh3Pu5L2N6QtPO/32JpqQBVVk20oy/Pi2s23WEvyfHbe1thadVQttvm7Llf65gGmXK67XtupyoM7HQhmXdLS8oGWJNeOJ3C5fG5XCEJnkez3/oFdsvgJ4l2ANZwhrJKk/7OSXa+3Vw2WJMlKnGkobouYk6T0TyX30klOUnTD9HJ5qpckL3EW/w4XF3Xd0FGywXUrstrclVsqz5Pd/sXFYyDnPdrLcQODmGOK47IZb4CmibmMn+MYRzFZ5jg33ZL/EJrWcszHmANy3ARBK/IXtciJy8VsitPSdE3uuHxzougojcUdr8/32atnz/ev3f/K5wtpxUTpcaI45zusVDpYtZi+jg0oU9b3x74h7+n9ABvYEZeKaVq0sh0AtLKsFtqNBdeT0MrSzwwlq9+x6xAO4tgOtSzbCjrNQQiNvQUbUEubvzBUeGw26yDCsRHCoLkTHDa7IdOLIThs/gHvChszh2CimE8peRs47cxANI0lYNB5y1DljpOF0IhzBDPOZnDOqYYbeGKECbPzWnXludPphw5c2YBq5zlwXphIbO4VDCZ0gnPfUO1TwZoYwAs2ExPCedAu9DAjfQUjzITQb3jNj0KG2Sgt6BHaQUdYzWz+XmBktOHwanXjaSTcwwziBcuMOtwBmqPrTOxFQR/DRKKPqyur0aiW6cULYsx6tBm0jXpR/AUWR6HRq9WVW6MRhIq5jLyjbaCTDCijyYJNpCajdyobP/eTw0iexBAKkJ3gA5KcQb2zBXsIBckn+xVv8jkZSaEFHE+jFEleAEfayRU0MouNoBmB/L50Ai/HSLIHxcrpCvnhSQAuakKp2C/YbCylJjXRVy/z3+Kv/RrNcCo+WUzlVEhzKffnTQnxeN9fWF88fiNCUdSTsaufaChKWInHeysygfpIqagoakW+vV20J8uyl6TyNKEZWV4oRSPyCkWpgOLSbkCObT8o2r6tlG58HQquf6O0v50tB7JM7F4EORd2dx/K0w/KHsVkLPaoYrwgP/y7krr3SSMA4zj+OBgmjYkxcdIJQyQRKgg2viX9Hddi9UBb29LrKR7CVVEEEXWojUkXNyfTNDE14W9gbHJNuhjDettN3ZvbOvdOqCD3Jp/9l+/wJE+9PkYGjx/fqkys3S2rMozM/o2106rfMUINo6hVqz+eu/hd1c4xTg0TAfy5kV+4UG6+IthHTU9woWmxuKNbTfuCSfovBCxq7EtHqvYL4Sm6F8GVxsSXHMQ07TOi1DKtZxjWaaIyi4CXWjxPccUw8WVbMYY5wxC1mzEyXMJWkllpRloi+Kkoq69sxBTlElF6aAxYUbjXNlhlDZilDnM4U5SlN5biRsRHnbx3mbeWjEh4mEyiuJDl5XcWVmX5GvNkFgLWZM5qwsop4/AWfLhU1cR7k1VVvcYCWRkOI6Xy5gmnphCYIkvzuNYzHzosq2oNk2RtSs8khfUOfHIDgR6ysYBaMpl4uEgk2U/oJTs9AaTSwma7dT69geAE2ZpEjUsn2ieJNHeKfrI3EcAGJ2ZaNgVuC8EBctCLc57P5u5led6IOBkIYkuQMrmmjChs4VkfOerHqSBkPzZlhe06RslZ3zMjk2sscqKwY0RcjKK+LWbzd7KiHhkncs/siFJ+V5eXxD34B8nVuJEpGJNmxN2gH3vSvp7J70tF+D1Ej8qUJD1TkErAND2GZwTFg/LubvmgiBG3SOvdlsqFQrkEzJCL1rstlnVFROixZoDDSuXQFHESwVGlcuQcMb/b42NgjLowh5MTDFE3vNB5qStRIErdCQEh6pLPR92anSUb/wAIhldAaDMpGgAAAABJRU5ErkJggg==",Ry="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",jy="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC";delete Yc.Icon.Default.prototype._getIconUrl;Yc.Icon.Default.mergeOptions({iconUrl:Ry,iconRetinaUrl:Ly,shadowUrl:jy});function QD({pins:e}){const r=ZD();return J.useEffect(()=>{if(e.length!==0)if(e.length===1){const t=e[0];r.setView([t.lat,t.lng],15)}else{const t=new Yc.FeatureGroup(e.map(n=>Yc.marker([n.lat,n.lng])));r.fitBounds(t.getBounds().pad(.1))}},[r,e]),null}function eO({addresses:e,onAddressesUpdate:r,startingPointIndex:t,onStartingPointChange:n,optimizedOrder:a,showRouteLines:l=!1}){const[c,d]=J.useState(!1),[m,g]=J.useState([]),[x,_]=J.useState(!1),C=e.map((I,N)=>({id:`pin-${N}`,address:I.address,lat:I.lat||0,lng:I.lng||0,isStart:N===t,isGeocoded:!!(I.lat&&I.lng),confidence:.8})).filter(I=>I.isGeocoded);J.useEffect(()=>{async function I(){if(console.log("Route directions effect triggered:",{showRouteLines:l,optimizedOrder:a,optimizedOrderLength:a?.length}),!l||!a||a.length<2){console.log("Route directions skipped:",{showRouteLines:l,hasOptimizedOrder:!!a,orderLength:a?.length}),g([]);return}_(!0);try{const N=t!==void 0&&e[t]?[e[t].lng,e[t].lat]:void 0,q=await DD(e,a,N);q.success?g(q.routeSegments):(console.error("Failed to load route directions:",q.error),g([]))}catch(N){console.error("Error loading route directions:",N),g([])}finally{_(!1)}}I()},[l,a,e,t]);const b=async I=>{const N=e[I];if(!(!N||c)){d(!0);try{const q=await Cy([N.address]);if(q.length>0&&q[0].success){const Z=[...e];Z[I]={...Z[I],lat:q[0].lat,lng:q[0].lng},r(Z)}}catch(q){console.error("Failed to geocode address:",q)}finally{d(!1)}}},E=(I,N)=>{const Z=N.target.getLatLng(),me=[...e];me[I]={...me[I],lat:Z.lat,lng:Z.lng},r(me)},D=I=>{n(t===I?null:I)},F=I=>{let N="#3388ff";return I.isStart?N="#28a745":I.confidence&&I.confidence<.5?N="#dc3545":I.confidence&&I.confidence<.8&&(N="#ffc107"),new Yc.Icon({iconUrl:Ry,iconRetinaUrl:Ly,shadowUrl:jy,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],className:`marker-${N.replace("#","")}`})},O=(I,N)=>N<=1?"#3388ff":`hsl(${(1-I/(N-1))*120}, 70%, 50%)`,M=[54.5,-2];return h.jsxs("div",{style:{height:"100%",width:"100%"},children:[h.jsxs(qD,{center:M,zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[h.jsx(JD,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),h.jsx(QD,{pins:C}),C.map(I=>{const N=e.findIndex(q=>q.lat===I.lat&&q.lng===I.lng&&q.address===I.address);return h.jsx(YD,{position:[I.lat,I.lng],icon:F(I),draggable:!0,eventHandlers:{dragend:q=>E(N,q)},children:h.jsx(tx,{children:h.jsxs("div",{style:{minWidth:"200px"},children:[h.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:I.address}),h.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.5rem"},children:["Lat: ",I.lat.toFixed(6),", Lng: ",I.lng.toFixed(6)]}),I.confidence&&h.jsxs("div",{style:{fontSize:"0.875rem",marginBottom:"0.5rem",color:I.confidence>=.8?"var(--success)":I.confidence>=.5?"var(--warning)":"var(--danger)"},children:["Confidence: ",Math.round(I.confidence*100),"%"]}),h.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:h.jsx("button",{onClick:()=>D(N),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:I.isStart?"var(--success)":"var(--primary)",color:"white",border:"none",borderRadius:"var(--radius)",cursor:"pointer"},children:I.isStart?" Starting Point":" Set as Start"})})]})})},I.id)}),l&&m.map((I,N)=>{const q=I.geometry.map(Z=>[Z[1],Z[0]]);return h.jsx(XD,{positions:q,color:O(N,m.length),weight:4,opacity:.8,dashArray:N===0?void 0:"5, 5",children:h.jsx(tx,{children:h.jsxs("div",{children:[h.jsxs("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:["Route Segment ",N+1]}),h.jsxs("div",{style:{fontSize:"0.875rem"},children:["Distance: ",(I.distance/1e3).toFixed(1)," km",h.jsx("br",{}),"Duration: ",Math.round(I.duration/60)," min"]})]})})},`route-segment-${N}`)})]}),c&&h.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",background:"var(--surface)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",boxShadow:"var(--shadow)",fontSize:"0.875rem",zIndex:1e3},children:" Geocoding address..."}),x&&h.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",background:"var(--surface)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",boxShadow:"var(--shadow)",fontSize:"0.875rem",zIndex:1e3},children:" Loading route directions..."}),e.some(I=>!I.lat||!I.lng)&&h.jsxs("div",{style:{position:"absolute",bottom:"10px",left:"10px",background:"var(--surface)",padding:"1rem",borderRadius:"var(--radius)",boxShadow:"var(--shadow)",maxWidth:"300px",zIndex:1e3},children:[h.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:"Addresses need geocoding:"}),e.map((I,N)=>I.lat&&I.lng?null:h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.25rem",fontSize:"0.875rem"},children:[h.jsxs("span",{style:{flex:1,marginRight:"0.5rem"},children:[I.address.substring(0,30),"..."]}),h.jsx("button",{onClick:()=>b(N),disabled:c,style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:"var(--primary)",color:"white",border:"none",borderRadius:"var(--radius)",cursor:c?"not-allowed":"pointer",opacity:c?.6:1},children:" Find"})]},N))]})]})}function tO({user:e,onAddressesReady:r}){const[t,n]=J.useState([]),[a,l]=J.useState(""),[c,d]=J.useState(!1),[m,g]=J.useState(!1),[x,_]=J.useState(null),[y,S]=J.useState(!0),[C,b]=J.useState(null),[E,D]=J.useState(!1);J.useEffect(()=>{const ee=()=>{D(window.innerWidth<768)};return ee(),window.addEventListener("resize",ee),()=>window.removeEventListener("resize",ee)},[]);const[F,O]=J.useState(null),M=J.useCallback(ee=>{const ce=ee.map(O0);n(ce),O(null),_(null)},[]),G=()=>{if(!a.trim())return;const ee={success:!1,address:a.trim(),originalAddress:a.trim(),error:"Not geocoded yet"};J.startTransition(()=>{n(ce=>[...ce,ee]),l(""),O(null)})},I=(ee,ce,V)=>{const ie={success:!0,address:ee,originalAddress:ee,lat:ce,lng:V,confidence:1,formattedAddress:ee};J.startTransition(()=>{n(Q=>[...Q,ie]),l(""),O(null)})},N=ee=>{J.startTransition(()=>{n(ce=>ce.filter((V,ie)=>ie!==ee)),O(null),x===ee?_(null):x!==null&&x>ee&&_(x-1)})},q=(ee,ce)=>{J.startTransition(()=>{n(V=>V.map((ie,Q)=>Q===ee?{...ie,address:ce,success:!1,error:"Modified - needs geocoding"}:ie)),O(null)})},Z=async()=>{const ee=t.map((ce,V)=>({addr:ce,index:V})).filter(({addr:ce})=>!ce.success);if(ee.length===0){alert("All addresses are already geocoded!");return}d(!0),b({completed:0,total:ee.length,current:""});try{const ce=ee.map(({addr:Q})=>Q.address),V=await Cy(ce,(Q,fe,R)=>{b({completed:Q,total:fe,current:R})}),ie=[...t];ee.forEach(({index:Q},fe)=>{ie[Q]=V[fe]}),n(ie),O(null)}catch(ce){console.error("Batch geocoding failed:",ce),alert("Geocoding failed. Please check your connection and subscription.")}finally{d(!1),b(null)}},me=async()=>{const ee=t.filter(ce=>ce.success&&ce.lat&&ce.lng);if(ee.length===0){alert("No addresses with valid coordinates available for optimization");return}if(ee.length<t.length){const ce=t.length-ee.length;if(!confirm(`${ce} addresses don't have coordinates and will be excluded from optimization. Continue?`))return}g(!0),O(null);try{const ce=t.map(Bd);let V;if(x!==null&&x>=0){const Q=t[x];Q.success&&Q.lat&&Q.lng&&(V=[Q.lng,Q.lat])}const ie=await ND(ce,V);if(O({optimizedOrder:ie.optimizedOrder,totalDistance:ie.totalDistance,totalDuration:ie.totalDuration,unassigned:ie.unassigned,error:ie.error}),ie.success&&ie.optimizedOrder.length>0){const Q=ie.optimizedOrder.map(fe=>t[fe]);if(n(Q),x!==null){const fe=ie.optimizedOrder.indexOf(x);_(fe>=0?fe:null)}}}catch(ce){console.error("Route optimization failed:",ce),O({optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:[],error:ce instanceof Error?ce.message:"Optimization failed"})}finally{g(!1)}},ue=()=>{const ee=t.map(Bd);r(ee),alert(`Exported ${ee.length} addresses to your main address list!`)},Y=()=>{confirm("Are you sure you want to clear all addresses?")&&(n([]),O(null),_(null))},se=ee=>{const ce=ee.map(O0);n(ce),O(null)},ve={total:t.length,geocoded:t.filter(ee=>ee.success).length,needsGeocoding:t.filter(ee=>!ee.success).length,highConfidence:t.filter(ee=>ee.success&&(ee.confidence||0)>=.8).length,lowConfidence:t.filter(ee=>ee.success&&(ee.confidence||0)<.5).length};return h.jsx(ky,{user:e,fallback:h.jsx(rO,{}),children:h.jsxs("div",{className:"route-planning",children:[h.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:h.jsx("h2",{children:" Route Planning"})}),!1,h.jsxs("div",{style:{background:"var(--gray-100)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",padding:"1rem",marginBottom:"1.5rem",boxShadow:"var(--shadow-sm)",color:"var(--gray-800)"},children:[h.jsx("h3",{style:{margin:"0 0 1rem 0"},children:"Add Addresses"}),h.jsx("div",{style:{marginBottom:"1rem"},children:h.jsx(M1,{onImported:M})}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"flex-end"},children:[h.jsxs("div",{style:{flex:1},children:[h.jsx("label",{htmlFor:"manual-address-input",style:{display:"block",marginBottom:"0.25rem",fontSize:"0.875rem"},children:"Or add addresses manually:"}),h.jsx(OD,{id:"manual-address-input",value:a,onChange:l,onSelect:I,placeholder:"Start typing an address...",disabled:!1})]}),h.jsx("button",{className:"btn btn-primary",onClick:G,disabled:!a.trim(),style:{minWidth:"80px"},children:"Add"})]})]}),t.length>0&&h.jsxs("div",{style:{background:"var(--gray-100)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",padding:"1rem",marginBottom:"1.5rem",boxShadow:"var(--shadow-sm)",color:"var(--gray-800)"},children:[h.jsx("h3",{style:{margin:"0 0 1rem 0"},children:"Address Status"}),h.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem"},children:[h.jsxs("div",{style:{textAlign:"center"},children:[h.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--primary)"},children:ve.total}),h.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Total Addresses"})]}),h.jsxs("div",{style:{textAlign:"center"},children:[h.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--success)"},children:ve.geocoded}),h.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Geocoded"})]}),h.jsxs("div",{style:{textAlign:"center"},children:[h.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--warning)"},children:ve.needsGeocoding}),h.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"Need Geocoding"})]}),h.jsxs("div",{style:{textAlign:"center"},children:[h.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"var(--success)"},children:ve.highConfidence}),h.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:"High Confidence"})]})]})]}),t.length>0&&h.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:[h.jsx("button",{className:"btn btn-primary",onClick:Z,disabled:c||ve.needsGeocoding===0,children:c?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"spinner",style:{display:"inline-block",width:"1rem",height:"1rem",marginRight:"0.5rem"}}),"Geocoding..."]}):` Geocode All (${ve.needsGeocoding})`}),h.jsx("button",{className:"btn btn-primary",onClick:me,disabled:m||ve.geocoded<2,children:m?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"spinner",style:{display:"inline-block",width:"1rem",height:"1rem",marginRight:"0.5rem"}}),"Optimizing..."]}):` Optimize Route (${ve.geocoded})`}),h.jsx("button",{className:"btn btn-primary",onClick:()=>S(!y),disabled:t.length===0,children:y?" Hide Map":" Show Map"}),h.jsx("button",{className:"btn btn-success",onClick:ue,disabled:t.length===0,children:" Export to Main List"}),h.jsx("button",{className:"btn btn-ghost",onClick:Y,disabled:t.length===0,children:" Clear All"})]}),C&&h.jsxs("div",{style:{background:"var(--primary-light)",border:"1px solid var(--primary)",borderRadius:"var(--radius-md)",padding:"1rem",marginBottom:"1.5rem"},children:[h.jsxs("div",{style:{marginBottom:"0.5rem"},children:["Geocoding: ",C.completed,"/",C.total]}),h.jsx("div",{style:{background:"var(--gray-200)",borderRadius:"var(--radius-md)",height:"0.5rem",overflow:"hidden",marginBottom:"0.5rem"},children:h.jsx("div",{style:{background:"var(--primary)",height:"100%",width:`${C.completed/C.total*100}%`,transition:"width 0.3s ease"}})}),h.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:["Currently: ",C.current]})]}),F&&h.jsx("div",{style:{background:F.error?"var(--danger-light)":"var(--success-light)",border:`1px solid ${F.error?"var(--danger)":"var(--success)"}`,borderRadius:"var(--radius-md)",padding:"1rem",marginBottom:"1.5rem"},children:F.error?h.jsxs("div",{children:[h.jsx("div",{style:{fontWeight:"bold",color:"var(--danger)",marginBottom:"0.5rem"},children:" Route Optimization Failed"}),h.jsx("div",{style:{fontSize:"0.875rem",color:"var(--danger)"},children:F.error})]}):h.jsxs("div",{children:[h.jsx("div",{style:{fontWeight:"bold",color:"var(--success)",marginBottom:"0.5rem"},children:" Route Optimized Successfully!"}),h.jsxs("div",{style:{fontSize:"0.875rem"},children:[h.jsxs("div",{children:[" ",F.optimizedOrder.length," addresses in optimized order"]}),h.jsxs("div",{children:[" Estimated time: ",by(F.totalDuration)]}),h.jsxs("div",{children:[" Estimated distance: ",Sy(F.totalDistance)]}),F.unassigned.length>0&&h.jsxs("div",{style:{color:"var(--warning)"},children:[" ",F.unassigned.length," addresses couldn't be included"]})]})]})}),t.length>0&&h.jsxs("div",{style:{display:"flex",gap:"1rem",flexDirection:E?"column":"row"},children:[h.jsx("div",{style:{flex:y?"1":"2",minWidth:"300px"},children:h.jsxs("div",{style:{background:"var(--gray-100)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",overflow:"hidden",boxShadow:"var(--shadow-sm)",color:"var(--gray-800)"},children:[h.jsxs("div",{style:{padding:"1rem",borderBottom:"1px solid var(--gray-200)",background:"var(--gray-50)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsxs("h3",{style:{margin:0},children:["Addresses (",t.length,")"]}),x!==null&&h.jsxs("div",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-md)",fontSize:"0.875rem"},children:[" Start: #",x+1]})]}),h.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:t.map((ee,ce)=>h.jsxs("div",{style:{padding:"0.75rem 1rem",borderBottom:ce<t.length-1?"1px solid var(--gray-200)":"none",display:"flex",alignItems:"center",gap:"0.75rem",background:ce===x?"var(--primary-light)":"transparent"},children:[h.jsx("div",{style:{width:"1.5rem",height:"1.5rem",borderRadius:"50%",background:ce===x?"var(--primary)":ee.success?"var(--success)":"var(--warning)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold",flexShrink:0,cursor:"pointer"},onClick:()=>_(ce===x?null:ce),title:ce===x?"Remove as starting point":"Set as starting point",children:ce===x?"":ce+1}),h.jsxs("div",{style:{flex:1,minWidth:0},children:[h.jsx("input",{name:`address-${ce}`,type:"text",value:ee.address,onChange:V=>q(ce,V.target.value),className:"input",style:{width:"100%",marginBottom:"0.25rem",fontSize:"0.875rem"}}),h.jsx("div",{style:{fontSize:"0.75rem",color:"var(--gray-500)"},children:ee.success?h.jsxs(h.Fragment,{children:[" ",ee.formattedAddress||ee.address,ee.confidence&&h.jsxs("span",{style:{marginLeft:"0.5rem",color:ee.confidence>=.8?"var(--success)":ee.confidence>=.5?"var(--warning)":"var(--danger)"},children:[Ty(ee.confidence)," confidence"]})]}):h.jsxs("span",{style:{color:"var(--warning)"},children:[" ",ee.error]})})]}),h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>N(ce),title:"Remove address",style:{flexShrink:0},children:""})]},ce))})]})}),y&&h.jsx("div",{style:{flex:"1",minWidth:"400px"},children:h.jsx(eO,{addresses:t.map(Bd),onAddressesUpdate:se,startingPointIndex:x??void 0,onStartingPointChange:_,optimizedOrder:F?.optimizedOrder,showRouteLines:!!F&&!F.error})})]}),t.length===0&&h.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem",color:"var(--gray-500)"},children:[h.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),h.jsx("h3",{style:{marginBottom:"0.5rem"},children:"No addresses yet"}),h.jsx("p",{style:{marginBottom:"1.5rem"},children:"Import an Excel file or add addresses manually to get started with route planning."})]})]})})}function rO(){return h.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--gray-100)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",boxShadow:"var(--shadow-sm)",color:"var(--gray-800)"},children:[h.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),h.jsx("h2",{children:"Route Planning"}),h.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--gray-500)"},children:"Plan your daily routes with intelligent address geocoding and route optimization."}),h.jsx("div",{style:{marginBottom:"1.5rem"},children:h.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius-md)",fontSize:"0.875rem"},children:"Premium Feature"})}),h.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--gray-500)",textAlign:"left",maxWidth:"400px",margin:"0 auto"},children:[h.jsx("div",{style:{marginBottom:"0.5rem"},children:" Import addresses from Excel"}),h.jsx("div",{style:{marginBottom:"0.5rem"},children:" Google-style address autocomplete"}),h.jsx("div",{style:{marginBottom:"0.5rem"},children:" Automatic geocoding with confidence scores"}),h.jsx("div",{style:{marginBottom:"0.5rem"},children:" Intelligent route optimization"}),h.jsx("div",{style:{marginBottom:"0.5rem"},children:" Manual address correction"}),h.jsx("div",{children:" Export to main address list"})]})]})}function nO({onSetupComplete:e,onSkip:r,isOpen:t}){const[n,a]=Tr.useState(""),[l,c]=Tr.useState(""),[d,m]=Tr.useState(!1),[g,x]=Tr.useState("idle"),[_,y]=Tr.useState("");if(!t)return null;const S=async()=>{if(!n||!l){y("Please enter both URL and key");return}m(!0),x("idle"),y("");try{if(!new URL(n).hostname.includes("supabase"))throw new Error("URL should be a Supabase project URL (e.g., https://your-project.supabase.co)");const E=py(n,l),{data:D,error:F}=await E.auth.getSession();if(F&&F.message!=="Auth session missing!")throw F;x("success"),Ne.info("Supabase connection test successful")}catch(b){x("error"),y(b.message||"Connection failed"),Ne.error("Supabase connection test failed:",b)}finally{m(!1)}},C=()=>{g==="success"&&e(n,l)};return h.jsxs("div",{className:"modal-overlay",children:[h.jsxs("div",{className:"modal-content",style:{maxWidth:"600px"},children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h2",{children:" Optional: Connect Your Own Cloud Storage"}),h.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem"},children:"Set up your own Supabase project for cloud backup and sync (completely optional)"})]}),h.jsxs("div",{className:"modal-body",children:[h.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--blue-50)",borderRadius:"var(--radius-md)",border:"1px solid var(--blue-200)"},children:[h.jsx("h4",{style:{margin:"0 0 0.5rem",color:"var(--blue-700)"},children:" Quick Setup Instructions"}),h.jsxs("ol",{style:{margin:0,paddingLeft:"1.2rem",color:"var(--blue-600)",fontSize:"0.9rem"},children:[h.jsxs("li",{children:["Go to ",h.jsx("a",{href:"https://supabase.com",target:"_blank",rel:"noopener",children:"supabase.com"})," and create a free account"]}),h.jsx("li",{children:"Create a new project (choose any name/region)"}),h.jsx("li",{children:"Go to Settings  API in your project dashboard"}),h.jsx("li",{children:"Copy your Project URL and anon/public key below"})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"supabase-url",children:"Project URL *"}),h.jsx("input",{id:"supabase-url",type:"url",value:n,onChange:b=>a(b.target.value),placeholder:"https://your-project-id.supabase.co",style:{fontFamily:"monospace"}})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"supabase-key",children:"Anonymous/Public Key *"}),h.jsx("textarea",{id:"supabase-key",value:l,onChange:b=>c(b.target.value),placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",rows:3,style:{fontFamily:"monospace",fontSize:"0.85rem"}})]}),g==="success"&&h.jsx("div",{style:{padding:"0.75rem",background:"var(--green-50)",border:"1px solid var(--green-200)",borderRadius:"var(--radius-md)",color:"var(--green-700)"},children:" Connection successful! Your Supabase project is ready."}),g==="error"&&h.jsxs("div",{style:{padding:"0.75rem",background:"var(--red-50)",border:"1px solid var(--red-200)",borderRadius:"var(--radius-md)",color:"var(--red-700)"},children:[" ",_]}),h.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[h.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem"},children:" Privacy & Security"}),h.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--gray-600)"},children:[h.jsx("li",{children:"Your credentials are stored locally in your browser only"}),h.jsx("li",{children:"All data goes directly to YOUR Supabase project"}),h.jsx("li",{children:"We never see or access your data"}),h.jsx("li",{children:"You can disconnect at any time"})]})]})]}),h.jsxs("div",{className:"modal-footer",children:[h.jsx("button",{className:"btn btn-secondary",onClick:r,children:"Skip (Use Offline Only)"}),h.jsx("button",{className:"btn btn-primary",onClick:S,disabled:!n||!l||d,children:d?" Testing...":" Test Connection"}),h.jsx("button",{className:"btn btn-success",onClick:C,disabled:g!=="success",children:" Save & Connect"})]})]}),h.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: white;
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
          flex-wrap: wrap;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .form-group input,
        .form-group textarea {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-size: 0.9rem;
        }

        .form-group input:focus,
        .form-group textarea:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        @media (max-width: 640px) {
          .modal-footer {
            flex-direction: column;
          }

          .modal-footer button {
            width: 100%;
          }
        }
      `})]})}class Oa{static BACKUP_KEY="navigator_local_backups";static MAX_BACKUPS=10;static downloadBackup(r,t){try{const n=new Date().toISOString().replace(/[:.]/g,"-"),a=t||`navigator-backup-${n}.json`,l=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),c=URL.createObjectURL(l),d=document.createElement("a");d.href=c,d.download=a,document.body.appendChild(d),d.click();try{d.parentNode===document.body&&document.body.removeChild(d)}catch(m){Ne.warn("Non-critical DOM cleanup error during backup download:",m)}URL.revokeObjectURL(c),Ne.info(`Backup downloaded: ${a} (${l.size} bytes)`)}catch(n){throw Ne.error("Failed to download backup:",n),n}}static storeLocalBackup(r){try{const t=this.getLocalBackups(),a={timestamp:new Date().toISOString(),data:r,size:JSON.stringify(r).length,version:r._schemaVersion||1};t.unshift(a);const l=t.slice(0,this.MAX_BACKUPS);localStorage.setItem(this.BACKUP_KEY,JSON.stringify(l)),Ne.info(`Local backup stored (${l.length}/${this.MAX_BACKUPS})`)}catch(t){Ne.error("Failed to store local backup:",t)}}static getLocalBackups(){try{const r=localStorage.getItem(this.BACKUP_KEY);return r?JSON.parse(r):[]}catch(r){return Ne.error("Failed to get local backups:",r),[]}}static restoreFromLocalBackup(r){const t=this.getLocalBackups();if(r<0||r>=t.length)throw new Error("Invalid backup index");return t[r].data}static async getStorageUsage(){if("storage"in navigator&&"estimate"in navigator.storage)try{const r=await navigator.storage.estimate(),t=r.usage||0,n=r.quota||0,a=n>0?t/n*100:0;return{used:t,quota:n,percentage:a}}catch(r){Ne.warn("Failed to get storage estimate:",r)}return{used:0,quota:0,percentage:0}}static async isStorageLow(){const{percentage:r}=await this.getStorageUsage();return r>80}static createComprehensiveBackup(r){return{version:"1.0",created:new Date().toISOString(),platform:navigator.platform,userAgent:navigator.userAgent.substring(0,100),app:{name:"Navigator Web",version:"1.0.0"},data:r,checksum:Tl(r)}}static verifyBackup(r){try{return!r.data||!r.checksum?!1:Tl(r.data)===r.checksum}catch(t){return Ne.error("Backup verification failed:",t),!1}}static async performCriticalBackup(r,t){try{if(Ne.info(`Performing critical backup: ${t}`),this.storeLocalBackup(r),this.shouldDownloadBackup(t)){const l=this.createComprehensiveBackup(r);this.downloadBackup(l,`navigator-critical-${t}-${Date.now()}.json`),Ne.info(`Backup file downloaded for critical event: ${t}`)}await this.isStorageLow()&&Ne.warn("Browser storage is running low!")}catch(n){throw Ne.error("Critical backup failed:",n),n}}static shouldDownloadBackup(r){return["manual","import","day-end","restore","data-loss-risk"].includes(r)}static cleanupOldBackups(){try{const r=this.getLocalBackups(),t=new Date;t.setDate(t.getDate()-30);const n=r.filter(a=>new Date(a.timestamp)>t);n.length!==r.length&&(localStorage.setItem(this.BACKUP_KEY,JSON.stringify(n)),Ne.info(`Cleaned up ${r.length-n.length} old backups`))}catch(r){Ne.error("Failed to cleanup old backups:",r)}}static getBackupStats(){const r=this.getLocalBackups(),t=r.reduce((l,c)=>l+(c.size||0),0),n=r.length>0?r[r.length-1].timestamp:null,a=r.length>0?r[0].timestamp:null;return{count:r.length,totalSize:t,oldestDate:n,newestDate:a}}}function aO({currentData:e,onRestore:r,isOpen:t,onClose:n}){const[a,l]=Tr.useState([]),[c,d]=Tr.useState({used:0,quota:0,percentage:0}),[m,g]=Tr.useState(!1);Tr.useEffect(()=>{t&&(x(),_())},[t]);const x=()=>{try{const F=Oa.getLocalBackups();l(F)}catch(F){Ne.error("Failed to load backups:",F)}},_=async()=>{try{const F=await Oa.getStorageUsage();d(F)}catch(F){Ne.error("Failed to load storage usage:",F)}},y=async()=>{g(!0);try{await Oa.performCriticalBackup(e,"manual"),x(),Ne.info("Manual backup created successfully")}catch(F){Ne.error("Failed to create manual backup:",F)}finally{g(!1)}},S=F=>{try{const O=Oa.restoreFromLocalBackup(F);r(O),n()}catch(O){Ne.error("Failed to restore from backup:",O)}},C=(F,O)=>{try{const M=new Date(F.timestamp).toISOString().replace(/[:.]/g,"-");Oa.downloadBackup(F.data,`navigator-backup-${M}.json`)}catch(M){Ne.error("Failed to download backup:",M)}},b=F=>{if(F===0)return"0 B";const O=1024,M=["B","KB","MB","GB"],G=Math.floor(Math.log(F)/Math.log(O));return parseFloat((F/Math.pow(O,G)).toFixed(1))+" "+M[G]},E=F=>new Date(F).toLocaleString(),D=F=>F>80?"var(--danger)":F>60?"var(--warning)":"var(--success)";return t?h.jsxs("div",{className:"modal-overlay",children:[h.jsxs("div",{className:"modal-content",style:{maxWidth:"800px"},children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h2",{children:" Backup Manager"}),h.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem",color:"var(--text-primary)"},children:"Local backups are automatically created and downloaded to prevent data loss"})]}),h.jsxs("div",{className:"modal-body",children:[h.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius-md)"},children:[h.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:" Storage Usage"}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[h.jsx("div",{style:{flex:1,height:"8px",background:"var(--gray-200)",borderRadius:"4px",overflow:"hidden"},children:h.jsx("div",{style:{height:"100%",background:D(c.percentage),width:`${Math.min(c.percentage,100)}%`,transition:"width 0.3s ease"}})}),h.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",minWidth:"60px"},children:[c.percentage.toFixed(1),"%"]})]}),h.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:[b(c.used)," of ",b(c.quota)," used",c.percentage>80&&h.jsx("span",{style:{color:"var(--danger)",fontWeight:500,marginLeft:"0.5rem"},children:" Storage running low!"})]})]}),h.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--info-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--info)"},children:[h.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--info-dark)"},children:" Create Manual Backup"}),h.jsx("p",{style:{margin:"0 0 1rem",fontSize:"0.85rem",color:"var(--info-dark)"},children:"Create an immediate backup and download it to your computer for safekeeping."}),h.jsx("button",{className:"btn btn-primary",onClick:y,disabled:m,children:m?" Creating...":" Create & Download Backup"})]}),h.jsxs("div",{children:[h.jsxs("h4",{style:{margin:"0 0 1rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:[" Local Backups (",a.length,")"]}),a.length===0?h.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"No local backups found. Create your first backup above!"}):h.jsx("div",{style:{maxHeight:"300px",overflow:"auto"},children:a.map((F,O)=>h.jsx("div",{style:{padding:"1rem",border:"1px solid var(--border-light)",borderRadius:"var(--radius-md)",marginBottom:"0.5rem",background:"var(--surface)"},children:h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[h.jsxs("div",{children:[h.jsx("div",{style:{fontWeight:500,fontSize:"0.9rem",color:"var(--text-primary)"},children:E(F.timestamp)}),h.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:["Size: ",b(F.size||0),"  Version: ",F.version||1]})]}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[h.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>C(F),title:"Download backup file",children:""}),h.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>S(O),title:"Restore from this backup",children:" Restore"})]})]})},O))})]}),h.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"var(--success-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--success)"},children:[h.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem",color:"var(--success-dark)"},children:" Data Protection Features"}),h.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--success-dark)"},children:[h.jsx("li",{children:"Automatic backups every 5 minutes when data changes"}),h.jsx("li",{children:"Critical backups downloaded after completions"}),h.jsx("li",{children:"Local browser storage with 10 backup rotation"}),h.jsx("li",{children:"Storage monitoring and cleanup"}),h.jsx("li",{children:"Data integrity verification"})]})]})]}),h.jsx("div",{className:"modal-footer",children:h.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Close"})})]}),h.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: var(--surface);
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border-light);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
        }

        .btn-sm {
          padding: 0.375rem 0.75rem;
          font-size: 0.8rem;
        }
      `})]}):null}function iO({settings:e,onUpdateSettings:r,onClose:t}){const[n,a]=J.useState(e),[l,c]=J.useState("templates"),[d,m]=J.useState(null),[g,x]=J.useState(""),[_,y]=J.useState(!1),[S,C]=J.useState(!1),b=async()=>{C(!0);try{if(!n.agentProfile.name.trim()){alert("Agent name is required");return}if(!n.agentProfile.signature.trim()){alert("Agent signature is required");return}if(n.messageTemplates.length===0){a(I=>({...I,messageTemplates:K1,activeTemplateId:"professional_standard"}));return}await r(n),t()}catch(I){console.error("Failed to save settings:",I),alert("Failed to save settings. Please try again.")}finally{C(!1)}},E=I=>{a(N=>({...N,agentProfile:{...N.agentProfile,...I}}))},D=(I,N)=>{a(q=>({...q,messageTemplates:q.messageTemplates.map(Z=>Z.id===I?{...Z,...N}:Z)}))},F=()=>{const I={id:`custom_${Date.now()}`,name:"New Custom Template",template:"{greeting}Payment Reminder\\n\\n{refLine}Your payment is due {date}{time}.\\n\\nAmount: {amount}\\n\\n[Your custom message here]\\n\\n{signature}{contactInfo}",variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]};a(N=>({...N,messageTemplates:[...N.messageTemplates,I]})),m(I.id)},O=I=>{if(n.messageTemplates.length<=1){alert("You must have at least one message template");return}a(N=>{const q=N.messageTemplates.filter(me=>me.id!==I),Z=N.activeTemplateId===I?q[0]?.id||"professional_standard":N.activeTemplateId;return{...N,messageTemplates:q,activeTemplateId:Z}})},M=()=>{try{const I={id:"preview",addressIndex:0,address:"123 Sample Street, London",customerName:"123456789 Smith",phoneNumber:"07123456789",scheduledDate:new Date(Date.now()+864e5).toISOString().slice(0,10),scheduledTime:"14:00",status:"Scheduled",amount:"125.00",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},N={id:"preview",arrangementId:"preview",type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},q=q1(I,N,n);x(q),y(!0)}catch(I){console.error("Preview failed:",I),alert("Failed to generate preview. Please check your template.")}},G=(I,N)=>{a(q=>({...q,customizableSchedule:{...q.customizableSchedule,[I]:N}}))};return h.jsxs("div",{className:"modal-backdrop",onClick:I=>I.target===I.currentTarget&&t(),children:[h.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90vw",maxHeight:"90vh",overflow:"auto"},children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h2",{style:{margin:0},children:" Reminder Settings"}),h.jsx("button",{className:"btn btn-ghost",onClick:t,children:""})]}),h.jsxs("div",{className:"modal-body",children:[h.jsxs("div",{className:"btn-group",style:{marginBottom:"1.5rem"},children:[h.jsx("button",{className:`btn ${l==="profile"?"btn-primary":"btn-ghost"}`,onClick:()=>c("profile"),children:" Agent Profile"}),h.jsx("button",{className:`btn ${l==="templates"?"btn-primary":"btn-ghost"}`,onClick:()=>c("templates"),children:" Message Templates"}),h.jsx("button",{className:`btn ${l==="schedule"?"btn-primary":"btn-ghost"}`,onClick:()=>c("schedule"),children:" Schedule Settings"})]}),l==="profile"&&h.jsxs("div",{className:"settings-tab",children:[h.jsx("h3",{children:"Agent Profile Information"}),h.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"This information will be used in your reminder messages and signature."}),h.jsxs("div",{className:"form-grid",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"agent-name",children:" Agent Name *"}),h.jsx("input",{id:"agent-name",name:"agentName",type:"text",value:n.agentProfile.name,onChange:I=>E({name:I.target.value}),className:"input",placeholder:"Enter your full name",required:!0})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"agent-title",children:" Job Title *"}),h.jsxs("select",{id:"agent-title",name:"agentTitle",value:n.agentProfile.title,onChange:I=>E({title:I.target.value}),className:"input",children:[h.jsx("option",{value:"Enforcement Agent",children:"Enforcement Agent"}),h.jsx("option",{value:"Bailiff",children:"Bailiff"}),h.jsx("option",{value:"Recovery Officer",children:"Recovery Officer"}),h.jsx("option",{value:"Collection Agent",children:"Collection Agent"}),h.jsx("option",{value:"Senior Enforcement Agent",children:"Senior Enforcement Agent"}),h.jsx("option",{value:"Lead Bailiff",children:"Lead Bailiff"})]})]}),h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("label",{htmlFor:"agent-signature",children:" Message Signature *"}),h.jsx("input",{id:"agent-signature",name:"agentSignature",type:"text",value:n.agentProfile.signature,onChange:I=>E({signature:I.target.value}),className:"input",placeholder:"e.g., Enforcement Agent J. Smith",required:!0}),h.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"This will appear at the end of your reminder messages"})]}),h.jsxs("div",{className:"form-group form-group-full",children:[h.jsx("label",{htmlFor:"agent-contact-info",children:" Contact Information (Optional)"}),h.jsx("input",{id:"agent-contact-info",name:"agentContactInfo",type:"text",value:n.agentProfile.contactInfo||"",onChange:I=>E({contactInfo:I.target.value}),className:"input",placeholder:"e.g., Tel: 01234 567890"}),h.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Additional contact information to include in messages"})]})]})]}),l==="templates"&&h.jsxs("div",{className:"settings-tab",children:[h.jsxs("div",{style:{marginBottom:"1.5rem"},children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[h.jsx("h3",{children:"Message Templates"}),h.jsxs("div",{children:[h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:M,children:" Preview"}),h.jsx("button",{className:"btn btn-success btn-sm",onClick:F,children:" Add Template"})]})]}),h.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:["Create and customize SMS reminder messages. Use variables to automatically insert customer and payment details.",h.jsx("br",{}),h.jsx("strong",{children:" Click the  Edit button next to any template to see the enhanced editor with variable reference panel."})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:"active-template",children:"Active Template"}),h.jsx("select",{id:"active-template",name:"activeTemplate",value:n.activeTemplateId,onChange:I=>a(N=>({...N,activeTemplateId:I.target.value})),className:"input",children:n.messageTemplates.map(I=>h.jsx("option",{value:I.id,children:I.name},I.id))})]}),h.jsx("div",{className:"templates-list",children:n.messageTemplates.map(I=>h.jsxs("div",{className:"template-item",children:[h.jsxs("div",{className:"template-header",children:[h.jsxs("div",{children:[h.jsx("strong",{children:I.name}),I.id===n.activeTemplateId&&h.jsx("span",{className:"pill",style:{backgroundColor:"var(--success)15",color:"var(--success)",marginLeft:"0.5rem"},children:"Active"})]}),h.jsxs("div",{children:[h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>m(d===I.id?null:I.id),children:d===I.id?"":""}),I.id.startsWith("custom_")&&h.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>O(I.id),children:""})]})]}),d===I.id&&h.jsxs("div",{className:"template-editor",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:`template-name-${I.id}`,children:"Template Name"}),h.jsx("input",{id:`template-name-${I.id}`,name:`templateName-${I.id}`,type:"text",value:I.name,onChange:N=>D(I.id,{name:N.target.value}),className:"input"})]}),h.jsxs("div",{className:"template-editor-layout",children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{htmlFor:`template-content-${I.id}`,children:"Message Template"}),h.jsx("textarea",{id:`template-content-${I.id}`,name:`templateContent-${I.id}`,value:I.template,onChange:N=>D(I.id,{template:N.target.value}),className:"input",rows:12,style:{fontFamily:"monospace",fontSize:"0.875rem"}}),h.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Use variables like ","{greeting}"," and ","{amount}"," - see reference panel "]})]}),h.jsxs("div",{className:"variable-reference-panel",children:[h.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.875rem",color:"var(--text-primary)"},children:" Available Variables"}),h.jsxs("div",{className:"variable-group",children:[h.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Customer Info"}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{greeting}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Smart greeting: "Mr/Mrs Smith, "'})]}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{refLine}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Reference line: "Reference: 123456789\\\\n\\\\n"'})]}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{customerName}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full name: "123456789 Smith"'})]})]}),h.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[h.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Payment Details"}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{amount}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Payment amount: "125.00"'})]}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{date}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Due date: "15/01/2025"'})]}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{time}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Time (if set): " at 14:00"'})]})]}),h.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[h.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Agent Info"}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{signature}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full signature: "Enforcement Agent J. Smith"'})]}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentName}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Name only: "J. Smith"'})]}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentTitle}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Job title: "Enforcement Agent"'})]}),h.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[h.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{contactInfo}"}),h.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Contact: "Tel: 01234 567890"'})]})]}),h.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"var(--blue-50)",borderRadius:"var(--radius-sm)",border:"1px solid var(--blue-200)"},children:[h.jsx("div",{style:{fontSize:"0.75rem",color:"var(--blue-700)",fontWeight:600,marginBottom:"0.25rem"},children:" Tips:"}),h.jsxs("ul",{style:{margin:0,paddingLeft:"1rem",fontSize:"0.75rem",color:"var(--blue-600)"},children:[h.jsx("li",{children:"Use \\\\n for line breaks"}),h.jsx("li",{children:"Variables are case-sensitive"}),h.jsx("li",{children:"Preview to test your template"}),h.jsx("li",{children:"Empty variables won't show"})]})]})]})]})]})]},I.id))})]}),l==="schedule"&&h.jsxs("div",{className:"settings-tab",children:[h.jsx("h3",{children:"Reminder Schedule"}),h.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Choose when reminder notifications should be sent before payment due dates."}),h.jsx("div",{className:"form-group",children:h.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("input",{name:"globalEnabled",type:"checkbox",checked:n.globalEnabled,onChange:I=>a(N=>({...N,globalEnabled:I.target.checked}))}),"Enable automatic reminders"]})}),h.jsx("div",{className:"form-group",children:h.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("input",{name:"smsEnabled",type:"checkbox",checked:n.smsEnabled,onChange:I=>a(N=>({...N,smsEnabled:I.target.checked})),disabled:!n.globalEnabled}),"Enable SMS reminders"]})}),h.jsx("hr",{style:{margin:"1.5rem 0"}}),h.jsx("h4",{children:"Reminder Timing"}),h.jsxs("div",{className:"schedule-options",children:[h.jsx("div",{className:"form-group",children:h.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("input",{name:"threeDayReminder",type:"checkbox",checked:n.customizableSchedule.threeDayReminder,onChange:I=>G("threeDayReminder",I.target.checked),disabled:!n.globalEnabled}),"Send reminder 3 days before payment due"]})}),h.jsx("div",{className:"form-group",children:h.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("input",{name:"oneDayReminder",type:"checkbox",checked:n.customizableSchedule.oneDayReminder,onChange:I=>G("oneDayReminder",I.target.checked),disabled:!n.globalEnabled}),"Send reminder 1 day before payment due"]})}),h.jsx("div",{className:"form-group",children:h.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[h.jsx("input",{name:"dayOfReminder",type:"checkbox",checked:n.customizableSchedule.dayOfReminder,onChange:I=>G("dayOfReminder",I.target.checked),disabled:!n.globalEnabled}),"Send reminder on payment due date"]})})]}),h.jsxs("div",{className:"custom-days-section",children:[h.jsx("h4",{children:"Custom Reminder Days"}),h.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1rem"},children:"Add additional reminder days (e.g., 7 for weekly, 14 for bi-weekly)"}),h.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem"},children:n.customizableSchedule.customDays.map((I,N)=>h.jsxs("span",{className:"pill",style:{backgroundColor:"var(--primary)15",color:"var(--primary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[I," days before",h.jsx("button",{onClick:()=>{const q=[...n.customizableSchedule.customDays];q.splice(N,1),G("customDays",q)},style:{background:"none",border:"none",color:"inherit",cursor:"pointer",padding:"0 0.25rem"},children:""})]},N))}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[h.jsx("input",{name:"customDayInput",type:"number",min:"1",max:"365",placeholder:"Days before",className:"input",style:{width:"120px"},onKeyPress:I=>{if(I.key==="Enter"){const N=I.target,q=parseInt(N.value);q&&q>0&&!n.customizableSchedule.customDays.includes(q)&&(G("customDays",[...n.customizableSchedule.customDays,q]),N.value="")}}}),h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:I=>{const N=I.target.parentElement?.querySelector("input"),q=parseInt(N.value);q&&q>0&&!n.customizableSchedule.customDays.includes(q)&&(G("customDays",[...n.customizableSchedule.customDays,q]),N.value="")},children:" Add"})]})]})]})]}),h.jsxs("div",{className:"modal-footer",children:[h.jsx("button",{className:"btn btn-ghost",onClick:t,children:"Cancel"}),h.jsx(Ei,{className:"btn btn-primary",onClick:b,isLoading:S,loadingText:"Saving...",children:" Save Settings"})]})]}),_&&h.jsx("div",{className:"modal-backdrop",onClick:()=>y(!1),children:h.jsxs("div",{className:"modal-content",onClick:I=>I.stopPropagation(),children:[h.jsxs("div",{className:"modal-header",children:[h.jsx("h3",{style:{margin:0},children:" Message Preview"}),h.jsx("button",{className:"btn btn-ghost",onClick:()=>y(!1),children:""})]}),h.jsxs("div",{className:"modal-body",children:[h.jsx("div",{style:{padding:"1rem",backgroundColor:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:"pre-wrap",lineHeight:1.5},children:g}),h.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"This is how your message will appear when sent to customers."})]}),h.jsx("div",{className:"modal-footer",children:h.jsx("button",{className:"btn btn-primary",onClick:()=>y(!1),children:"Close Preview"})})]})}),h.jsx("style",{children:`
        /* Modal Backdrop */
        .modal-backdrop {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        /* Modal Content */
        .modal-content {
          background: white;
          border-radius: var(--radius-lg, 12px);
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          max-width: 900px;
          width: 95vw;
          max-height: 95vh;
          overflow: hidden;
          display: flex;
          flex-direction: column;
        }

        @media (max-width: 480px) {
          .modal-content {
            width: 98vw;
            max-height: 98vh;
            border-radius: var(--radius-md, 8px);
            margin: 0 0.5rem;
          }
        }

        /* Modal Header */
        .modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem 2rem;
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-header {
            padding: 1rem 1.5rem;
          }

          .modal-header h2 {
            font-size: 1.25rem;
          }
        }

        .modal-header h2 {
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--gray-900, #111827);
          margin: 0;
        }

        .modal-header .btn {
          padding: 0.5rem;
          min-width: auto;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          font-size: 1rem;
        }

        /* Modal Body */
        .modal-body {
          padding: 2rem;
          overflow-y: auto;
          flex: 1;
        }

        /* Modal Footer */
        .modal-footer {
          padding: 1.5rem 2rem;
          border-top: 1px solid var(--gray-200, #e5e7eb);
          display: flex;
          justify-content: flex-end;
          gap: 1rem;
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-body {
            padding: 1.5rem;
          }

          .modal-footer {
            padding: 1rem 1.5rem;
            flex-direction: column-reverse;
            gap: 0.75rem;
          }

          .modal-footer .btn {
            width: 100%;
            justify-content: center;
          }
        }

        /* Template Editor Layout */
        .template-editor-layout {
          display: grid;
          grid-template-columns: 1fr 320px;
          gap: 1.5rem;
          min-height: 500px;
        }

        @media (max-width: 1024px) {
          .template-editor-layout {
            grid-template-columns: 1fr;
            gap: 1rem;
          }

          .variable-reference-panel {
            order: -1;
            max-height: 300px !important;
          }
        }

        /* Variable Reference Panel */
        .variable-reference-panel {
          background: var(--gray-50, #f8f9fa);
          border: 1px solid var(--gray-200, #e9ecef);
          border-radius: var(--radius-md, 8px);
          padding: 1.25rem;
          font-size: 0.875rem;
          max-height: 500px;
          overflow-y: auto;
          position: sticky;
          top: 0;
        }

        .variable-group {
          margin-bottom: 1.5rem;
        }

        .variable-group:last-child {
          margin-bottom: 0;
        }

        .variable-group h5 {
          margin: 0 0 0.75rem;
          font-size: 0.875rem;
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.025em;
        }

        .variable-item {
          margin-bottom: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: var(--radius-sm, 6px);
          border: 1px solid var(--gray-100, #f3f4f6);
        }

        .variable-item:last-child {
          margin-bottom: 0;
        }

        .variable-item code {
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          background: var(--primary-light, #e0f2fe);
          padding: 0.25rem 0.5rem;
          border-radius: 0.25rem;
          font-size: 0.8125rem;
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .variable-item div {
          color: var(--text-muted, #6b7280);
          font-size: 0.8125rem;
          margin-top: 0.375rem;
          line-height: 1.4;
        }

        /* Form Improvements */
        .form-group {
          margin-bottom: 1.5rem;
        }

        .form-group label {
          display: block;
          font-weight: 500;
          color: var(--gray-700, #374151);
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .form-group .input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--gray-300, #d1d5db);
          border-radius: var(--radius-md, 8px);
          font-size: 0.875rem;
          transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .form-group .input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }

        .form-group textarea.input {
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
          line-height: 1.5;
        }

        /* Button Group */
        .btn-group {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 2rem;
        }

        .btn-group .btn {
          flex: 1;
          text-align: center;
          font-size: 0.875rem;
          padding: 0.75rem 0.5rem;
        }

        /* Mobile-specific tab optimizations */
        @media (max-width: 480px) {
          .btn-group {
            gap: 0.25rem;
            margin-bottom: 1.5rem;
          }

          .btn-group .btn {
            font-size: 0.75rem;
            padding: 0.625rem 0.375rem;
            line-height: 1.2;
          }
        }

        @media (max-width: 360px) {
          .btn-group {
            flex-direction: column;
            gap: 0.5rem;
          }

          .btn-group .btn {
            flex: none;
            font-size: 0.875rem;
            padding: 0.75rem 1rem;
          }
        }

        /* Templates List */
        .templates-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .template-item {
          border: 1px solid var(--gray-200, #e5e7eb);
          border-radius: var(--radius-lg, 12px);
          overflow: hidden;
        }

        .template-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          background: var(--gray-50, #f9fafb);
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
        }

        .template-editor {
          padding: 1.5rem;
          background: white;
        }

        /* Dark Mode Support */
        .dark-mode .modal-content {
          background: var(--gray-800, #1f2937);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-header {
          border-bottom-color: var(--gray-700, #374151);
        }

        .dark-mode .modal-header h2 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-footer {
          border-top-color: var(--gray-700, #374151);
        }

        /* Form Elements Dark Mode */
        .dark-mode .form-group label {
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .form-group .input {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .form-group .input:focus {
          border-color: var(--primary, #0ea5e9);
          background: var(--gray-700, #374151);
        }

        .dark-mode .form-group .input::placeholder {
          color: var(--gray-400, #9ca3af);
        }

        /* Variable Reference Panel Dark Mode */
        .dark-mode .variable-reference-panel {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .variable-group h5 {
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item {
          background: var(--gray-800, #1f2937);
          border-color: var(--gray-600, #4b5563);
        }

        .dark-mode .variable-item code {
          background: var(--primary-dark, #0c4a6e);
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item div {
          color: var(--gray-300, #d1d5db);
        }

        /* Template Items Dark Mode */
        .dark-mode .template-item {
          border-color: var(--gray-600, #4b5563);
          background: var(--gray-800, #1f2937);
        }

        .dark-mode .template-header {
          background: var(--gray-700, #374151);
          border-bottom-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .template-editor {
          background: var(--gray-800, #1f2937);
        }

        /* Button Group Dark Mode */
        .dark-mode .btn-group .btn {
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .btn-group .btn.btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .dark-mode .btn-group .btn.btn-ghost {
          background: var(--gray-700, #374151);
        }

        .dark-mode .btn-group .btn.btn-ghost:hover {
          background: var(--gray-600, #4b5563);
        }

        /* Additional Text Elements */
        .dark-mode .settings-tab h3 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .settings-tab p {
          color: var(--gray-300, #d1d5db);
        }

        .dark-mode .setting-description {
          color: var(--gray-400, #9ca3af);
        }

        /* Tips Box Dark Mode */
        .dark-mode .variable-reference-panel div[style*="background: var(--blue-50)"] {
          background: var(--gray-600, #4b5563) !important;
          border-color: var(--gray-500, #6b7280) !important;
        }

        .dark-mode .variable-reference-panel div[style*="color: var(--blue-700)"] {
          color: var(--blue-300, #93c5fd) !important;
        }

        .dark-mode .variable-reference-panel ul {
          color: var(--gray-300, #d1d5db) !important;
        }

        /* Template List Dark Mode */
        .dark-mode .template-item strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .pill {
          background: var(--success-dark, #166534) !important;
          color: var(--success-light, #86efac) !important;
        }

        .dark-mode .template-header strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .template-header {
          color: var(--gray-100, #f3f4f6) !important;
        }
      `})]})}const sO=({trigger:e,reminderSettings:r,onUpdateReminderSettings:t})=>{const[n,a]=J.useState(!1),[l,c]=J.useState(!1),d=J.useRef(null),{settings:m,toggleBackup:g,toggleDarkMode:x,togglePushNotifications:_,toggleAutoSync:y}=yy();J.useEffect(()=>{const C=b=>{d.current&&!d.current.contains(b.target)&&a(!1)};return n&&document.addEventListener("mousedown",C),()=>{document.removeEventListener("mousedown",C)}},[n]),J.useEffect(()=>{const C=b=>{b.key==="Escape"&&a(!1)};return n&&document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C)}},[n]);const S=({checked:C,onChange:b,id:E})=>h.jsxs("div",{className:"toggle-switch",onClick:b,children:[h.jsx("input",{type:"checkbox",id:E,checked:C,onChange:b,className:"toggle-input"}),h.jsx("div",{className:`toggle-slider ${C?"checked":""}`,children:h.jsx("div",{className:"toggle-thumb"})})]});return h.jsxs("div",{className:"settings-dropdown",ref:d,children:[h.jsx("button",{className:"settings-trigger",onClick:()=>a(!n),"aria-expanded":n,"aria-haspopup":"true",children:e||h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"settings-icon",children:""}),h.jsx("span",{className:"settings-text",children:"Settings"})]})}),n&&h.jsxs("div",{className:"settings-dropdown-content",children:[h.jsxs("div",{className:"settings-header",children:[h.jsx("h3",{className:"settings-title",children:"App Settings"}),h.jsx("p",{className:"settings-subtitle",children:"Customize your experience"})]}),h.jsx("div",{className:"settings-section",children:h.jsxs("div",{className:"setting-item",children:[h.jsxs("div",{className:"setting-info",children:[h.jsx("label",{htmlFor:"backup-toggle",className:"setting-label",children:"Auto-download backup on end of day"}),h.jsx("p",{className:"setting-description",children:"Automatically download backup file when finishing the day."})]}),h.jsx(S,{id:"backup-toggle",checked:m.backupOnEndOfDay,onChange:g})]})}),h.jsx("div",{className:"settings-separator"}),h.jsx("div",{className:"settings-section",children:h.jsxs("button",{className:"sms-settings-button",onClick:()=>{c(!0),a(!1)},children:[h.jsx("span",{className:"sms-settings-icon",children:""}),h.jsxs("div",{className:"sms-settings-info",children:[h.jsx("div",{className:"sms-settings-title",children:"Reminder & SMS Settings"}),h.jsx("div",{className:"sms-settings-desc",children:"Message templates, scheduling, agent profile, and reminder preferences"})]}),h.jsx("span",{className:"sms-settings-arrow",children:""})]})}),h.jsx("div",{className:"settings-separator"}),h.jsxs("div",{className:"settings-section",children:[h.jsxs("div",{className:"setting-item",children:[h.jsx("div",{className:"setting-info",children:h.jsx("label",{htmlFor:"dark-mode",className:"setting-label",children:"Dark Mode"})}),h.jsx(S,{id:"dark-mode",checked:m.darkMode,onChange:x})]}),h.jsxs("div",{className:"setting-item",children:[h.jsx("div",{className:"setting-info",children:h.jsx("label",{htmlFor:"push-notifs",className:"setting-label",children:"Push Notifications"})}),h.jsx(S,{id:"push-notifs",checked:m.pushNotifications,onChange:_})]}),h.jsxs("div",{className:"setting-item",children:[h.jsx("div",{className:"setting-info",children:h.jsx("label",{htmlFor:"auto-sync",className:"setting-label",children:"Auto-sync on app start"})}),h.jsx(S,{id:"auto-sync",checked:m.autoSyncOnStart,onChange:y})]})]}),h.jsx("div",{className:"settings-footer",children:"Settings are saved locally and synced to cloud if configured."})]}),l&&h.jsx(iO,{settings:r||Nl,onUpdateSettings:C=>{t&&t(C),c(!1)},onClose:()=>c(!1)}),h.jsx("style",{children:`
        .settings-dropdown {
          position: relative;
          display: inline-block;
        }

        .settings-trigger {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          background: var(--gray-100);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-md);
          color: var(--gray-700);
          font-size: 0.875rem;
          font-weight: 500;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .settings-trigger:hover {
          background: var(--gray-200);
          color: var(--gray-800);
        }

        .settings-icon {
          font-size: 1rem;
        }

        .settings-dropdown-content {
          position: absolute;
          top: 100%;
          right: 0;
          z-index: 1000;
          min-width: 320px;
          max-width: 400px;
          background: white;
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-xl);
          padding: 1.5rem;
          margin-top: 0.5rem;
          animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .settings-header {
          margin-bottom: 1.5rem;
        }

        .settings-title {
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--gray-800);
          margin: 0 0 0.25rem 0;
        }

        .settings-subtitle {
          font-size: 0.875rem;
          color: var(--gray-500);
          margin: 0;
        }

        .settings-section {
          margin-bottom: 1rem;
        }

        .settings-separator {
          height: 1px;
          background: var(--gray-200);
          margin: 1rem 0;
        }

        .setting-item {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          margin-bottom: 1rem;
        }

        .setting-item:last-child {
          margin-bottom: 0;
        }

        .setting-info {
          flex: 1;
        }

        .setting-label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--gray-700);
          margin-bottom: 0.25rem;
          cursor: pointer;
        }

        .setting-description {
          font-size: 0.75rem;
          color: var(--gray-500);
          margin: 0.25rem 0 0 0;
          line-height: 1.4;
        }

        .settings-select,
        .settings-input {
          width: 100%;
          padding: 0.5rem 0.75rem;
          border: 1px solid var(--gray-300);
          border-radius: var(--radius-sm);
          font-size: 0.875rem;
          background: white;
          transition: var(--transition-normal);
        }

        .settings-select:focus,
        .settings-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        .settings-input {
          margin-top: 0.5rem;
        }

        .toggle-switch {
          position: relative;
          display: inline-block;
          width: 44px;
          height: 24px;
          cursor: pointer;
        }

        .toggle-input {
          opacity: 0;
          width: 0;
          height: 0;
        }

        .toggle-slider {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: var(--gray-300);
          border-radius: 24px;
          transition: var(--transition-normal);
        }

        .toggle-slider.checked {
          background: var(--primary);
        }

        .toggle-thumb {
          position: absolute;
          content: "";
          height: 20px;
          width: 20px;
          left: 2px;
          bottom: 2px;
          background: white;
          border-radius: 50%;
          transition: var(--transition-normal);
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-slider.checked .toggle-thumb {
          transform: translateX(20px);
        }

        .settings-footer {
          margin-top: 1.5rem;
          padding-top: 1rem;
          border-top: 1px solid var(--gray-200);
          font-size: 0.75rem;
          color: var(--gray-500);
          text-align: center;
        }

        /* Dark mode styles */
        .dark-mode .settings-dropdown-content {
          background: var(--gray-800);
          border-color: var(--gray-700);
          color: var(--gray-100);
        }

        .dark-mode .settings-title {
          color: var(--gray-100);
        }

        .dark-mode .settings-subtitle,
        .dark-mode .setting-description,
        .dark-mode .settings-footer {
          color: var(--gray-400);
        }

        .dark-mode .setting-label {
          color: var(--gray-200);
        }

        .dark-mode .settings-separator {
          background: var(--gray-700);
        }

        .dark-mode .settings-select,
        .dark-mode .settings-input {
          background: var(--gray-700);
          border-color: var(--gray-600);
          color: var(--gray-100);
        }

        .dark-mode .settings-select:focus,
        .dark-mode .settings-input:focus {
          border-color: var(--primary);
        }

        /* SMS Settings Button Styles */
        .sms-settings-button {
          width: 100%;
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.75rem;
          background: var(--gray-50);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-md);
          color: var(--gray-700);
          text-align: left;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .sms-settings-button:hover {
          background: var(--gray-100);
          border-color: var(--primary);
          color: var(--gray-800);
        }

        .sms-settings-icon {
          font-size: 1.25rem;
          flex-shrink: 0;
        }

        .sms-settings-info {
          flex: 1;
        }

        .sms-settings-title {
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--gray-800);
          margin-bottom: 0.125rem;
        }

        .sms-settings-desc {
          font-size: 0.75rem;
          color: var(--gray-500);
          line-height: 1.3;
        }

        .sms-settings-arrow {
          font-size: 0.875rem;
          color: var(--gray-400);
          flex-shrink: 0;
        }

        .dark-mode .sms-settings-button {
          background: var(--gray-700);
          border-color: var(--gray-600);
          color: var(--gray-200);
        }

        .dark-mode .sms-settings-button:hover {
          background: var(--gray-600);
          border-color: var(--primary);
          color: var(--gray-100);
        }

        .dark-mode .sms-settings-title {
          color: var(--gray-100);
        }

        .dark-mode .sms-settings-desc {
          color: var(--gray-400);
        }

        .dark-mode .sms-settings-arrow {
          color: var(--gray-500);
        }

        @media (max-width: 768px) {
          .settings-dropdown-content {
            position: fixed;
            top: 50%;
            left: 50%;
            right: auto;
            transform: translate(-50%, -50%);
            min-width: 280px;
            max-width: 90vw;
            max-height: 90vh;
            overflow-y: auto;
          }
        }
      `})]})},oO=()=>{const[e,r]=Tr.useState([]);return Tr.useEffect(()=>Xd.subscribe(r),[]),e.length===0?null:h.jsxs("div",{className:"toast-container",children:[e.map(t=>h.jsx("div",{className:`toast toast-${t.type}`,onClick:()=>Xd.remove(t.id),children:h.jsxs("div",{className:"toast-content",children:[h.jsxs("span",{className:"toast-icon",children:[t.type==="success"&&"",t.type==="error"&&"",t.type==="warning"&&"",t.type==="info"&&""]}),h.jsx("span",{className:"toast-message",children:t.message})]})},t.id)),h.jsx("style",{children:`
        .toast-container {
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 9999;
          display: flex;
          flex-direction: column;
          gap: 8px;
          pointer-events: none;
        }

        .toast {
          pointer-events: auto;
          background: white;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          border-left: 4px solid;
          min-width: 300px;
          max-width: 400px;
          padding: 12px 16px;
          cursor: pointer;
          transition: all 0.3s ease;
          animation: slideIn 0.3s ease-out;
        }

        .toast:hover {
          transform: translateY(-2px);
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .toast-success {
          border-left-color: #22c55e;
          background: #f0fdf4;
        }

        .toast-error {
          border-left-color: #ef4444;
          background: #fef2f2;
        }

        .toast-warning {
          border-left-color: #f59e0b;
          background: #fffbeb;
        }

        .toast-info {
          border-left-color: #3b82f6;
          background: #eff6ff;
        }

        .toast-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .toast-icon {
          font-size: 16px;
        }

        .toast-message {
          color: #374151;
          font-weight: 500;
          flex: 1;
          line-height: 1.4;
        }

        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateX(100%);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }

        @media (max-width: 768px) {
          .toast-container {
            top: 10px;
            right: 10px;
            left: 10px;
          }

          .toast {
            min-width: auto;
            max-width: none;
          }
        }
      `})]})};async function l0(e,r,t){if(!e.user||!t)return;const n=localStorage.getItem("navigator_restore_in_progress");if(n){const a=parseInt(n),l=Date.now()-a;if(l<3e4){Ne.info(" RESTORE PROTECTION: Skipping session reconciliation to prevent data loss",{timeSinceRestore:`${Math.round(l/1e3)}s`,restoreTime:new Date(a).toISOString()});return}else Ne.info(" RESTORE PROTECTION: Session reconciliation timeout reached, clearing flag"),localStorage.removeItem("navigator_restore_in_progress")}try{Ne.info("Post-restore: Reconciling session state with cloud...");const{data:a,error:l}=await t.from("navigator_state").select("data").eq("user_id",e.user.id).maybeSingle();if(l||!a?.data){Ne.warn("No cloud state found for session reconciliation");return}const d=jd(a.data).daySessions||[];r(m=>({...m,daySessions:d})),Ne.info("Session state reconciled with cloud successfully")}catch(a){Ne.error("Failed to reconcile session state:",a)}}class rx extends J.Component{constructor(r){super(r),this.state={hasError:!1}}static getDerivedStateFromError(r){return{hasError:!0,msg:String(r)}}render(){return this.state.hasError?h.jsxs("div",{className:"container",style:{paddingTop:"4rem"},children:[h.jsx("h2",{children:"Something went wrong"}),h.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:this.state.msg})]}):this.props.children}}async function to(e,r="manual",t=0){if(!$e)throw Ne.error("Supabase not configured for backup"),new Error("Supabase not configured");const n=await $e.auth.getUser(),a=n&&n.data&&n.data.user?n.data.user.id:void 0;if(!a)throw Ne.error("User not authenticated for backup"),new Error("User not authenticated");const l="Europe/London",c=new Date,d=c.toLocaleDateString("en-GB",{timeZone:l,year:"numeric"}),m=c.toLocaleDateString("en-GB",{timeZone:l,month:"2-digit"}),g=c.toLocaleDateString("en-GB",{timeZone:l,day:"2-digit"}),x=`${d}-${m}-${g}`,_=c.toLocaleTimeString("en-GB",{timeZone:l,hour12:!1}).replace(/:/g,""),y="navigator-backups",S=`backup_${x}_${_}_${r}_retry${t}.json`,C=`${a}/${x}/${S}`;try{const b=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});Ne.info(`Uploading backup to ${C}, size: ${b.size} bytes`);const E=await $e.storage.from(y).upload(C,b,{upsert:!0,contentType:"application/json"});if(E.error)throw Ne.error("Backup upload failed:",E.error),new Error(E.error.message);Ne.info("Backup upload successful:",C);try{await $e.from("backups").insert({user_id:a,day_key:x,object_path:C,size_bytes:b.size}),Ne.info("Backup database record created")}catch(D){Ne.warn("Backups table insert failed (non-critical):",D instanceof Error?D.message:D)}return{objectPath:C,size:b.size}}catch(b){if(Ne.error(`Backup attempt ${t+1} failed:`,b),t<2){const E=Math.pow(2,t)*1e3;return Ne.info(`Retrying backup in ${E}ms...`),await new Promise(D=>setTimeout(D,E)),to(e,r,t+1)}throw new Error(`Backup failed after ${t+1} attempts: ${b.message}`)}}function Rd({title:e,value:r,change:t,changeType:n,icon:a,iconType:l}){return h.jsxs("div",{className:"stat-card-modern",children:[h.jsxs("div",{className:"stat-header",children:[h.jsx("div",{className:"stat-title",children:e}),h.jsx("div",{className:`stat-icon ${l}`,children:a})]}),h.jsx("div",{className:"stat-value",children:r}),t&&h.jsxs("div",{className:`stat-change ${n||"neutral"}`,children:[n==="positive"&&h.jsx("span",{children:""}),n==="negative"&&h.jsx("span",{children:""}),h.jsx("span",{children:t})]})]})}function lO(){const e=gy();return e.isLoading?h.jsx("div",{className:"app-wrapper",children:h.jsx("div",{className:"main-area",children:h.jsx("div",{className:"content-area",children:h.jsxs("div",{className:"loading",children:[h.jsx("div",{className:"spinner"}),"Restoring session..."]})})})}):e.user?h.jsx(rx,{children:h.jsx(R3,{children:h.jsx(cO,{})})}):h.jsx(rx,{children:h.jsx(M3,{onSignIn:async(r,t)=>{await e.signIn(r,t)},onSignUp:async(r,t)=>{await e.signUp(r,t)},onForceSignOut:async()=>{await e.signOut()},isLoading:e.isLoading,error:e.error,onClearError:e.clearError})})}function cO(){const{state:e,loading:r,setAddresses:t,addAddress:n,setActive:a,cancelActive:l,complete:c,undo:d,startDay:m,endDay:g,backupState:x,restoreState:_,addArrangement:y,updateArrangement:S,deleteArrangement:C,setState:b,setBaseState:E,deviceId:D,enqueueOp:F,updateReminderSettings:O}=TN(),M=gy(),{confirm:G,alert:I}=j3(),{hasAccess:N}=vm(M.user),{isAdmin:q,isOwner:Z}=wy(M.user),[me,ue]=J.useState(!1),[Y,se]=J.useState(!1),[ve,ee]=J.useState(!1),[ce,V]=J.useState(!1),[ie,Q]=J.useState(!1),[fe,R]=J.useState(!1),[P,W]=J.useState("list"),[U,H]=J.useState(""),[le,ge]=J.useState(null),[Ce,ke]=J.useState(!1),xe=J.useRef(null),[Ke,te]=J.useState(!1),[Tt,bt]=J.useState([]),[yt,ut]=J.useState(!1),[Ue,Pt]=J.useState(null),rr=Array.isArray(e.addresses)?e.addresses:[],Mt=Array.isArray(e.completions)?e.completions:[],Zt=Array.isArray(e.arrangements)?e.arrangements:[],Vr=Array.isArray(e.daySessions)?e.daySessions:[],at=J.useMemo(()=>({...e,addresses:rr,completions:Mt,arrangements:Zt,daySessions:Vr}),[e,rr,Mt,Zt,Vr]);function pr(Ie,Ye="Europe/London"){const Ge=Ie.toLocaleDateString("en-GB",{timeZone:Ye,year:"numeric"}),Ve=Ie.toLocaleDateString("en-GB",{timeZone:Ye,month:"2-digit"}),Qe=Ie.toLocaleDateString("en-GB",{timeZone:Ye,day:"2-digit"});return`${Ge}-${Ve}-${Qe}`}const Jr=J.useCallback(async()=>{if(!$e){Pt("Supabase not configured");return}ut(!0),Pt(null);try{const Ye=(await $e.auth.getUser())?.data?.user?.id;if(!Ye)throw new Error("Not authenticated");const Ge=new Date,Ve=new Date;Ve.setDate(Ve.getDate()-6);const Qe=pr(Ve),gt=pr(Ge),ht=await $e.from("backups").select("object_path,size_bytes,created_at,day_key").eq("user_id",Ye).gte("day_key",Qe).lte("day_key",gt).order("day_key",{ascending:!1}).order("created_at",{ascending:!1});if(ht.error)throw ht.error;const nt=ht.data??[];bt(nt)}catch(Ie){Pt(Ie?.message||String(Ie))}finally{ut(!1)}},[]),Gr=J.useCallback(async Ie=>{if(!$e){await I({title:"Configuration Error",message:"Supabase is not configured.",type:"error"});return}const Ye=Ie.split("/").pop()||Ie;if(await G({title:"Restore from Cloud",message:`Restore "${Ye}" from cloud?

This will overwrite your current data.`,confirmText:"Restore",cancelText:"Cancel",type:"warning"})){ut(!0),Pt(null);try{const Qe=await $e.storage.from("navigator-backups").download(Ie);if(Qe.error)throw Qe.error;const ht=await Qe.data.text(),nt=JSON.parse(ht),ir=Xh(nt),sr=at.daySessions,gr={...ir,daySessions:sr};_(gr),setTimeout(async()=>{await M.syncData(gr),xe.current=JSON.stringify(gr)},31e3),await l0(M,b,$e),ke(!0),await I({title:"Success",message:"Successfully restored from cloud",type:"success"}),te(!1)}catch(Ve){Pt(Ve?.message||String(Ve))}finally{ut(!1)}}},[M,_,I,G]);J.useEffect(()=>{if(!M.user||r)return;if(!$e){ke(!0);return}let Ie=!1,Ye;return(async()=>{try{const Ve=(await $e.from("navigator_state").select("data, updated_at, version").eq("user_id",M.user.id).maybeSingle()).data;if(Ve&&Ve.data){const Qe=jd(Ve.data);Ie||(b(Qe),xe.current=JSON.stringify(Qe),ke(!0),Ne.sync("Restored from cloud, version:",Ve?.version))}else if(rr.length>0||Mt.length>0||Zt.length>0||Vr.length>0){Ne.info("Analyzing data ownership for current user...");try{let gt=null;try{const{data:nt}=await $e.from("navigator_state").select("data").eq("user_id",M.user.id).maybeSingle();gt=nt?.data}catch(nt){Ne.warn("Could not fetch cloud data for analysis:",nt)}const ht=ms.analyzeDataOwnership(at,M.user,gt);switch(Ne.info("Data ownership analysis:",ht),ht.action){case"sync":Ne.sync("Syncing local data to cloud (ownership confirmed)"),await M.syncData(at),ms.storeDeviceContext(M.user),Ie||(xe.current=JSON.stringify(at),ke(!0));break;case"backup_and_clear":Ne.warn("Creating safety backup before clearing (different user detected)");try{const nt=`navigator_safety_backup_${Date.now()}_user_switch`,ir={...at,_backup_timestamp:new Date().toISOString(),_backup_reason:"user_switch",_ownership_analysis:ht};localStorage.setItem(nt,JSON.stringify(ir)),Ne.info(`Safety backup created: ${nt}`),b({addresses:[],completions:[],arrangements:[],daySessions:[],activeIndex:null,currentListVersion:1}),ms.storeDeviceContext(M.user),Ie||ke(!0)}catch(nt){Ne.error("Backup failed - preserving data for safety:",nt),await M.syncData(at),ms.storeDeviceContext(M.user),Ie||(xe.current=JSON.stringify(at),ke(!0))}break;case"preserve_and_ask":default:Ne.info("Preserving local data (uncertain ownership) - user can decide later"),await M.syncData(at),ms.storeDeviceContext(M.user),Ie||(xe.current=JSON.stringify(at),ke(!0));break}}catch(gt){Ne.error("User detection analysis failed - preserving data for safety:",gt),await M.syncData(at),ms.storeDeviceContext(M.user),Ie||(xe.current=JSON.stringify(at),ke(!0))}}else ms.storeDeviceContext(M.user),Ie||ke(!0);Ye=M.subscribeToData(Qe=>{if(!Qe)return;const gt=localStorage.getItem("navigator_restore_in_progress");if(gt){const ht=parseInt(gt),nt=Date.now()-ht;if(nt<3e4){Ne.sync(" RESTORE PROTECTION: App.tsx subscription skipping cloud state update to prevent data loss",{timeSinceRestore:`${Math.round(nt/1e3)}s`,restoreTime:new Date(ht).toISOString()});return}else Ne.sync(" RESTORE PROTECTION: App.tsx subscription timeout reached, clearing flag"),localStorage.removeItem("navigator_restore_in_progress")}if(typeof Qe=="function")Ne.sync("Received cloud update (React updater)"),b(ht=>{const nt=Qe(ht),ir=jd(nt),sr=JSON.stringify(ir);return xe.current=sr,ir}),ke(!0);else{const ht=JSON.stringify(Qe);if(ht===xe.current)return;const nt=jd(Qe);Ne.sync("Received cloud update (direct state)"),b(nt),xe.current=ht,ke(!0)}})}catch(Ge){Ne.error("Bootstrap sync failed:",Ge),Ie||ke(!0)}})(),()=>{Ie=!0,Ye&&Ye()}},[M.user,r]),J.useEffect(()=>{if(!M.user||r||!Ce)return;const Ie=JSON.stringify(at);if(Ie===xe.current)return;const Ye=setTimeout(async()=>{try{const Ge=localStorage.getItem("navigator_restore_in_progress");if(Ge){const Ve=parseInt(Ge),Qe=Date.now()-Ve;if(Qe<3e4){Ne.sync(" RESTORE PROTECTION: Debounced sync skipping to prevent data loss",{timeSinceRestore:`${Math.round(Qe/1e3)}s`,restoreTime:new Date(Ve).toISOString()});return}else Ne.sync(" RESTORE PROTECTION: Debounced sync timeout reached, clearing flag"),localStorage.removeItem("navigator_restore_in_progress")}Ne.sync("Syncing changes to cloud..."),xe.current=Ie,await M.syncData(at),Ne.sync("Sync completed successfully")}catch(Ge){Ne.error("Sync failed:",Ge),xe.current=""}},150);return()=>clearTimeout(Ye)},[at,M,Ce,r]),J.useEffect(()=>{if(!M.user||r||!Ce)return;let Ie=JSON.stringify(at);const Ye=async()=>{const gt=JSON.stringify(at);if(gt!==Ie&&(at.completions.length>0||at.addresses.length>0))try{Ne.info("Performing periodic safety backup..."),await to(at,"manual"),Ie=gt,Ne.info("Periodic backup successful")}catch(ht){Ne.error("Periodic backup failed:",ht)}},Ge=setInterval(Ye,3600*1e3),Ve=localStorage.getItem("last_backup_time"),Qe=Date.now();return(!Ve||Qe-parseInt(Ve)>3600*1e3)&&setTimeout(async()=>{await Ye(),localStorage.setItem("last_backup_time",Qe.toString())},5e3),()=>clearInterval(Ge)},[at,M.user,Ce,r]),J.useEffect(()=>{if(!M.user||r||!Ce)return;const Ie=()=>{const Ge=at.completions.length,Ve=at.addresses.length,Qe=localStorage.getItem("navigator_data_counts");if(Qe){const{completions:gt,addresses:ht}=JSON.parse(Qe);if(M.isSyncing){Ne.info("Skipping data integrity check - cloud sync in progress");return}const nt=120*1e3,sr=(M.lastSyncTime?Date.now()-M.lastSyncTime.getTime():1/0)<nt,gr=sr?50:10,Qt=sr?200:50;Ge<gt-gr&&(Ne.error(`POTENTIAL DATA LOSS DETECTED: Completions dropped from ${gt} to ${Ge}`),sr?Ne.warn(`Large completion count change during recent sync (${gt}  ${Ge}) - monitoring`):I({title:" POTENTIAL DATA LOSS",message:`Completions count dropped significantly (${gt}  ${Ge}). Check cloud backups immediately!`,type:"error"})),Ve<ht-Qt&&(Ne.error(`POTENTIAL DATA LOSS DETECTED: Addresses dropped from ${ht} to ${Ve}`),sr?Ne.warn(`Large address count change during recent sync (${ht}  ${Ve}) - monitoring`):I({title:" POTENTIAL DATA LOSS",message:`Address count dropped significantly (${ht}  ${Ve}). Check cloud backups immediately!`,type:"error"}))}localStorage.setItem("navigator_data_counts",JSON.stringify({completions:Ge,addresses:Ve,timestamp:new Date().toISOString()}))},Ye=setInterval(Ie,30*1e3);return setTimeout(Ie,3e3),()=>clearInterval(Ye)},[at,M.user,M.isSyncing,M.lastSyncTime,Ce,r]);const Vt=J.useMemo(()=>{const Ie=e.currentListVersion,Ye=new Set(Mt.filter(St=>St.listVersion===Ie).map(St=>St.index)),Ge=rr.length,Ve=Ge-Ye.size,Qe=Mt.filter(St=>St.listVersion===Ie&&St.outcome==="PIF").length,gt=Mt.filter(St=>St.listVersion===Ie&&St.outcome==="Done").length,ht=Mt.filter(St=>St.listVersion===Ie&&St.outcome==="DA").length,nt=Mt.filter(St=>St.listVersion===Ie&&St.outcome==="ARR").length,ir=Ye.size,sr=Zt.filter(St=>St.status!=="Completed"&&St.status!=="Cancelled").length,gr=new Date().toISOString().slice(0,10),Qt=Mt.filter(St=>St.outcome==="PIF"&&(St.timestamp||"").slice(0,10)===gr).reduce((St,Cs)=>St+parseFloat(Cs.amount||"0"),0);return{total:Ge,pending:Ve,completed:ir,pifCount:Qe,doneCount:gt,daCount:ht,arrCount:nt,pendingArrangements:sr,todaysPIF:Qt}},[rr,Mt,Zt,e.currentListVersion]),Jt=J.useCallback(Ie=>{Ne.info(`Importing ${Ie.length} addresses...`),t(Ie,!0)},[t]),Rr=J.useCallback(async(Ie,Ye,Ge,Ve)=>{try{await c(Ie,Ye,Ge,Ve);try{const Qe=x();$e&&(await to(Qe,"manual"),Ne.info("Cloud backup after completion successful")),Oa.storeLocalBackup(Qe),Ne.info("Local storage backup after completion successful")}catch(Qe){Ne.error("Backup failed after completion:",Qe)}}catch(Qe){Ne.error("Failed to complete address:",Qe)}},[c,x]),ct=J.useCallback(Ie=>{const Ye=typeof Ie=="string"?new Date(Ie):Ie;if(Number.isNaN(Ye.getTime())){Ne.error("Invalid start date:",Ie);return}const Ge=Ye.toISOString(),Ve=Ge.slice(0,10);E(Qe=>{const gt=Qe.daySessions.slice();let ht=gt.findIndex(Qt=>Qt.date===Ve),nt;if(ht>=0?nt={...gt[ht],start:Ge}:nt={date:Ve,start:Ge},nt.end)try{const Qt=new Date(Ge).getTime(),St=new Date(nt.end).getTime();St>=Qt?nt.durationSeconds=Math.floor((St-Qt)/1e3):(delete nt.end,delete nt.durationSeconds)}catch(Qt){Ne.error("Error calculating duration:",Qt)}const ir=new Date().toISOString();nt.updatedAt=ir,nt.updatedBy=D;const sr=`edit_start_${Ve}_${Date.now()}`,gr={...nt,id:Ve,updatedAt:ir,updatedBy:D};return F("session",ht>=0?"update":"create",gr,sr),ht>=0?gt[ht]=nt:gt.push(nt),{...Qe,daySessions:gt}})},[E,D,F]),Rt=J.useCallback(Ie=>{const Ye=typeof Ie=="string"?new Date(Ie):Ie;if(Number.isNaN(Ye.getTime())){Ne.error("Invalid end date:",Ie);return}const Ge=Ye.toISOString(),Ve=Ge.slice(0,10);E(Qe=>{const gt=Qe.daySessions.slice();let ht=gt.findIndex(Qt=>Qt.date===Ve),nt;if(ht>=0?nt={...gt[ht]}:nt={date:Ve,start:Ge},nt.end=Ge,nt.start)try{const Qt=new Date(nt.start).getTime(),St=new Date(Ge).getTime();St>=Qt?nt.durationSeconds=Math.floor((St-Qt)/1e3):(nt.start=Ge,nt.durationSeconds=0)}catch(Qt){Ne.error("Error calculating duration:",Qt),nt.durationSeconds=0}const ir=new Date().toISOString();nt.updatedAt=ir,nt.updatedBy=D;const sr=`edit_end_${Ve}_${Date.now()}`,gr={...nt,id:Ve,updatedAt:ir,updatedBy:D};return F("session",ht>=0?"update":"create",gr,sr),ht>=0?gt[ht]=nt:gt.push(nt),{...Qe,daySessions:gt}})},[E,D,F]),jr=async Ie=>{const Ye=Ie.target.files?.[0];if(Ye)try{const Ge=await tD(Ye),Ve=Xh(Ge),Qe=at.daySessions,gt={...Ve,daySessions:Qe};_(gt),setTimeout(async()=>{await M.syncData(gt),xe.current=JSON.stringify(gt)},31e3),await l0(M,b,$e),ke(!0),await I({title:"Success",message:"Restore completed successfully!",type:"success"})}catch(Ge){Ne.error("Restore failed:",Ge),await I({title:"Error",message:"Restore failed: "+(Ge?.message||Ge),type:"error"})}finally{Ie.target.value=""}},Gt=J.useCallback(async(Ie,Ye,Ge)=>{b(Ve=>{if(!Number.isInteger(Ie)||Ie<0||Ie>=Ve.completions.length)return Ve;const Qe=Ve.completions.slice();return Qe[Ie]={...Qe[Ie],outcome:Ye,amount:Ge},{...Ve,completions:Qe}});try{await new Promise(Qe=>setTimeout(Qe,100));const Ve=x();$e&&(await to(Ve,"manual"),Ne.info("Cloud backup after outcome change successful")),Oa.storeLocalBackup(Ve),Ne.info("Local storage backup after outcome change successful")}catch(Ve){Ne.error("Backup failed after outcome change:",Ve)}},[b,x]),Qr=J.useCallback(async()=>{try{Ne.sync("Manual sync initiated...");const Ie=JSON.stringify(at),Ye=localStorage.getItem("navigator_restore_in_progress");if(Ye){const Ge=parseInt(Ye),Ve=Date.now()-Ge;if(Ve<3e4){Ne.sync(" RESTORE PROTECTION: Manual sync blocked to prevent data loss",{timeSinceRestore:`${Math.round(Ve/1e3)}s`,restoreTime:new Date(Ge).toISOString()}),await I({title:"Restore in Progress",message:"Please wait 30 seconds before manual sync to prevent data loss"});return}else localStorage.removeItem("navigator_restore_in_progress")}xe.current=Ie,await M.syncData(at),Ne.sync("Manual sync completed successfully");try{await to(at,"manual"),Ne.info("Safety backup after manual sync completed")}catch(Ge){Ne.warn("Safety backup after sync failed:",Ge)}}catch(Ie){Ne.error("Manual sync failed:",Ie),xe.current=""}},[M,at]),ri=(Ie,Ye)=>{localStorage.setItem("navigator_supabase_url",Ie),localStorage.setItem("navigator_supabase_key",Ye),window.location.reload()},ni=()=>{localStorage.setItem("navigator_supabase_skipped","true"),Q(!1)};J.useEffect(()=>{if(!M.user||r)return;const Ie=!!$e,Ye=localStorage.getItem("navigator_supabase_skipped");!Ie&&!Ye&&Q(!0)},[M.user,r]),J.useEffect(()=>{if(!Ce)return;let Ie=JSON.stringify(at);const Ye=async()=>{const gt=JSON.stringify(at);if(gt!==Ie&&(at.completions.length>0||at.addresses.length>0))try{Ne.info("Performing periodic safety backup..."),M.user&&$e&&await to(at,"periodic"),Oa.storeLocalBackup(at),Ie=gt,Ne.info("Periodic backup successful")}catch(ht){Ne.error("Periodic backup failed:",ht)}},Ge=setInterval(Ye,3600*1e3),Ve=setInterval(()=>{Oa.cleanupOldBackups()},10080*60*1e3),Qe=Oa.getBackupStats();return(Qe.count===0||at.completions.length>0&&Qe.count<3)&&setTimeout(async()=>{await Ye()},5e3),()=>{clearInterval(Ge),clearInterval(Ve)}},[at,M.user,Ce]);const Rn=()=>{const Ie=M.user?.email||"",Ye=Ie.split("@")[0].split(".");return Ye.length>=2?(Ye[0][0]+Ye[1][0]).toUpperCase():Ie.slice(0,2).toUpperCase()},ma=M.isSyncing?{text:"Syncing",color:"var(--warning)"}:M.isOnline?M.error?{text:"Sync Error",color:"var(--danger)"}:{text:"Online",color:"var(--success)"}:{text:"Offline",color:"var(--danger)"};return r?h.jsx("div",{className:"app-wrapper",children:h.jsx("div",{className:"main-area",children:h.jsx("div",{className:"content-area",children:h.jsxs("div",{className:"loading",children:[h.jsx("div",{className:"spinner"}),"Preparing your workspace..."]})})})}):h.jsxs("div",{className:"app-wrapper",children:[h.jsx(nO,{isOpen:ie,onSetupComplete:ri,onSkip:ni}),h.jsx(aO,{isOpen:fe,onClose:()=>R(!1),currentData:at,onRestore:Ie=>{const Ye=Xh(Ie),Ge=at.daySessions,Ve={...Ye,daySessions:Ge};_(Ve),M.user&&$e&&(setTimeout(async()=>{await M.syncData(Ve)},31e3),l0(M,b,$e))}}),Y&&q&&h.jsx(mD,{user:M.user,onClose:()=>se(!1)}),me&&h.jsx(fD,{user:M.user,onClose:()=>ue(!1)}),h.jsxs("main",{className:"main-area",children:[h.jsxs("header",{className:"app-header-modern",children:[h.jsxs("div",{className:"header-left",children:[h.jsxs("div",{className:"logo-section",children:[h.jsx("div",{className:"logo-icon",children:""}),h.jsxs("div",{className:"logo-text",children:[h.jsx("div",{className:"logo-title",children:"Navigator"}),h.jsx("div",{className:"logo-subtitle",children:"Enforcement Pro"})]})]}),P==="list"&&h.jsxs("div",{className:"search-container-modern",children:[h.jsx("span",{className:"search-icon",children:""}),h.jsx("input",{id:"search-addresses",name:"searchAddresses",type:"search",className:"search-input-modern",placeholder:"Search addresses...",value:U,onChange:Ie=>H(Ie.target.value)})]})]}),h.jsxs("div",{className:"header-center",children:[h.jsxs("div",{className:"sync-status",children:[h.jsx("div",{className:"sync-indicator",style:{background:ma.color}}),h.jsx("span",{children:ma.text}),M.lastSyncTime&&h.jsx("span",{style:{fontSize:"0.75rem",opacity:.8},children:M.lastSyncTime.toLocaleTimeString()})]}),h.jsx(sO,{reminderSettings:e.reminderSettings,onUpdateReminderSettings:O})]}),h.jsx("button",{className:"menu-toggle",onClick:()=>ee(!ve),children:""})]}),h.jsxs("div",{className:"content-area",children:[ce&&P==="list"&&h.jsx("div",{style:{background:"var(--surface)",padding:"1rem",borderRadius:"var(--radius-lg)",marginBottom:"1.5rem",border:"1px solid var(--border-light)",boxShadow:"var(--shadow-sm)"},children:h.jsxs("div",{className:"btn-row",style:{gap:"0.75rem",flexWrap:"wrap",alignItems:"stretch"},children:[h.jsx(M1,{onImported:Jt}),h.jsx("input",{type:"file",accept:"application/json",onChange:jr,className:"file-input",id:"restore-input",style:{display:"none"}}),h.jsx("button",{className:"btn btn-ghost",onClick:()=>document.getElementById("restore-input")?.click(),style:{whiteSpace:"nowrap"},children:" Restore Backup"}),h.jsx("button",{className:"btn btn-ghost",onClick:Qr,disabled:M.isSyncing,style:{whiteSpace:"nowrap"},children:M.isSyncing?" Syncing...":" Sync Now"})]})}),P==="list"&&h.jsxs(h.Fragment,{children:[h.jsx(X3,{sessions:Vr,completions:Mt,startDay:m,endDay:g,onEditStart:ct,onEditEnd:Rt,onBackup:async()=>{const Ie=x(),Ye=Ge=>new Promise((Ve,Qe)=>setTimeout(()=>Qe(new Error("Backup timeout")),Ge));try{$e&&(await Promise.race([to(Ie,"finish"),Ye(3e4)]),Ne.info("Cloud backup at day end successful")),await Promise.race([Oa.performCriticalBackup(Ie,"day-end"),Ye(15e3)]),Ne.info("Local backup at day end successful")}catch(Ge){throw Ne.error("Backup failed or timed out:",Ge),Ge}}}),h.jsxs("div",{className:"stats-grid",children:[h.jsx(Rd,{title:"Pending Addresses",value:Vt.pending,change:`${Vt.completed} completed today`,changeType:"positive",icon:"",iconType:"info"}),h.jsx(Rd,{title:"Today's Earnings",value:`${Vt.todaysPIF.toFixed(0)}`,change:`${Vt.pifCount} PIF today`,changeType:"positive",icon:"",iconType:"success"}),h.jsx(Rd,{title:"Arrangements Due",value:Vt.pendingArrangements,change:"Check arrangements tab",changeType:"neutral",icon:"",iconType:"warning"}),h.jsx(Rd,{title:"Completion Rate",value:`${Math.round(Vt.completed/Math.max(Vt.total,1)*100)}%`,change:"Good performance",changeType:"positive",icon:"",iconType:"success"})]}),h.jsx($3,{state:at,setActive:a,cancelActive:l,onComplete:Rr,onAddArrangement:y,filterText:U}),h.jsxs("div",{style:{display:"flex",gap:"0.5rem",margin:"1.25rem 0 3rem",flexWrap:"wrap",alignItems:"center"},children:[h.jsx("button",{className:"btn btn-ghost",onClick:()=>d(-1),title:"Undo last completion",children:" Undo Last"}),h.jsxs("span",{className:"pill pill-pif",children:["PIF ",Vt.pifCount]}),h.jsxs("span",{className:"pill pill-done",children:["Done ",Vt.doneCount]}),h.jsxs("span",{className:"pill pill-da",children:["DA ",Vt.daCount]}),h.jsxs("span",{className:"pill pill-active",children:["ARR ",Vt.arrCount]})]})]}),P==="completed"&&h.jsx(q3,{state:at,onChangeOutcome:Gt}),P==="arrangements"&&h.jsx(Q3,{state:at,onAddArrangement:y,onUpdateArrangement:S,onDeleteArrangement:C,onAddAddress:async Ie=>n(Ie),onComplete:Rr,autoCreateForAddress:le,onAutoCreateHandled:()=>ge(null)}),P==="earnings"&&h.jsx(vD,{state:at,user:M.user}),P==="planning"&&h.jsx(tO,{user:M.user,onAddressesReady:Ie=>{t(Ie,!1)}})]}),h.jsx(rD,{onAdd:n})]}),h.jsxs("aside",{className:`sidebar-right ${ve?"open":""}`,children:[h.jsx("div",{className:"sidebar-header",children:h.jsxs("div",{className:"user-profile-section",children:[h.jsx("div",{className:"user-avatar",children:Rn()}),h.jsxs("div",{className:"user-info",children:[h.jsx("div",{className:"user-name",children:M.user?.email?.split("@")[0]}),h.jsx("div",{className:"user-plan",children:Z?"Owner Access":N?"Premium Plan":"Free Trial"})]})]})}),h.jsxs("nav",{className:"nav-menu",children:[h.jsxs("div",{className:"nav-section",children:[h.jsx("div",{className:"nav-section-title",children:"Main"}),h.jsxs("div",{className:`nav-item ${P==="list"?"active":""}`,onClick:()=>{W("list"),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Address List"}),h.jsx("span",{className:"nav-badge",children:Vt.pending})]}),h.jsxs("div",{className:`nav-item ${P==="completed"?"active":""}`,onClick:()=>{W("completed"),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Completed"}),h.jsx("span",{className:"nav-badge",children:Vt.completed})]}),h.jsxs("div",{className:`nav-item ${P==="arrangements"?"active":""}`,onClick:()=>{W("arrangements"),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Arrangements"}),h.jsx("span",{className:"nav-badge",children:Vt.pendingArrangements})]})]}),h.jsxs("div",{className:"nav-section",children:[h.jsx("div",{className:"nav-section-title",children:"Analytics"}),h.jsxs("div",{className:`nav-item ${P==="earnings"?"active":""}`,onClick:()=>{W("earnings"),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Earnings"})]}),h.jsxs("div",{className:`nav-item ${P==="planning"?"active":""}`,onClick:()=>{W("planning"),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Route Planning"})]})]}),h.jsxs("div",{className:"nav-section",children:[h.jsx("div",{className:"nav-section-title",children:"Tools"}),h.jsxs("div",{className:"nav-item",onClick:()=>{V(!ce),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Import/Export"})]}),h.jsxs("div",{className:"nav-item",onClick:()=>{R(!0),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Backup Manager"})]}),$e&&h.jsxs("div",{className:"nav-item",onClick:async()=>{te(!0),await Jr(),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Cloud Backups"})]}),!$e&&h.jsxs("div",{className:"nav-item",onClick:()=>{Q(!0),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Connect Cloud Storage"})]})]}),h.jsxs("div",{className:"nav-section",children:[h.jsx("div",{className:"nav-section-title",children:"Account"}),h.jsxs("div",{className:"nav-item",onClick:()=>{ue(!0),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Subscription"})]}),q&&h.jsxs("div",{className:"nav-item",onClick:()=>{se(!0),ee(!1)},children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Admin Panel"})]}),h.jsxs("div",{className:"nav-item",onClick:M.signOut,children:[h.jsx("span",{className:"nav-icon",children:""}),h.jsx("span",{children:"Sign Out"})]})]})]})]}),h.jsx("div",{className:`sidebar-overlay ${ve?"active":""}`,onClick:()=>ee(!1)}),Ke&&h.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3,minWidth:320,maxWidth:500,maxHeight:"70vh",background:"white",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-2xl)",overflow:"hidden",display:"flex",flexDirection:"column"},children:[h.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--gray-200)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("h3",{style:{margin:0},children:"Cloud Backups (Last 7 Days)"}),h.jsx("button",{className:"btn btn-ghost",style:{padding:"0.5rem"},onClick:()=>te(!1),children:""})]}),h.jsxs("div",{style:{flex:1,overflow:"auto",padding:"1rem"},children:[yt&&h.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[h.jsx("div",{className:"spinner"}),h.jsx("p",{children:"Loading backups..."})]}),!yt&&Ue&&h.jsx("div",{style:{padding:"1rem",color:"var(--danger)"},children:Ue}),!yt&&!Ue&&Tt.length===0&&h.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--gray-500)"},children:"No backups found"}),!yt&&!Ue&&Tt.map(Ie=>{const Ye=Ie.object_path.split("/"),Ge=Ye[Ye.length-1]||Ie.object_path,Ve=Ie.day_key||"",Qe=Ie.size_bytes?Math.round(Ie.size_bytes/1024)+" KB":"";return h.jsxs("button",{className:"btn btn-ghost",style:{width:"100%",justifyContent:"space-between",marginBottom:"0.5rem",padding:"1rem"},onClick:()=>Gr(Ie.object_path),children:[h.jsx("span",{style:{fontWeight:500},children:Ge}),h.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--gray-500)"},children:[Ve,"  ",Qe]})]},Ie.object_path)})]})]}),Ke&&h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1999},onClick:()=>te(!1)}),M.error&&h.jsxs("div",{style:{position:"fixed",bottom:"1rem",left:"50%",transform:"translateX(-50%)",background:"var(--danger-light)",border:"1px solid var(--danger)",borderRadius:"var(--radius-lg)",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",boxShadow:"var(--shadow-lg)",zIndex:1e3},children:[h.jsxs("span",{style:{color:"var(--danger)"},children:[" ",M.error]}),h.jsx("button",{className:"btn btn-ghost btn-sm",onClick:M.clearError,children:"Dismiss"})]}),h.jsx(oO,{})]})}const uO="https://eevfxrgemrtthxbcxtvq.supabase.co";try{const e=new URL(uO).origin;["preconnect","dns-prefetch"].forEach(r=>{const t=document.createElement("link");t.rel=r,t.href=e,r==="preconnect"&&(t.crossOrigin=""),document.head.appendChild(t)})}catch{}A_.createRoot(document.getElementById("root")).render(h.jsx(lO,{}));
