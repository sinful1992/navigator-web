(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();function Ph(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function jk(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var pm={exports:{}},ku={},gm={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ux;function Ok(){if(ux)return It;ux=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function _(Y){return Y===null||typeof Y!="object"?null:(Y=y&&Y[y]||Y["@@iterator"],typeof Y=="function"?Y:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,w={};function E(Y,R,z){this.props=Y,this.context=R,this.refs=w,this.updater=z||T}E.prototype.isReactComponent={},E.prototype.setState=function(Y,R){if(typeof Y!="object"&&typeof Y!="function"&&Y!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Y,R,"setState")},E.prototype.forceUpdate=function(Y){this.updater.enqueueForceUpdate(this,Y,"forceUpdate")};function P(){}P.prototype=E.prototype;function D(Y,R,z){this.props=Y,this.context=R,this.refs=w,this.updater=z||T}var A=D.prototype=new P;A.constructor=D,S(A,E.prototype),A.isPureReactComponent=!0;var H=Array.isArray,J=Object.prototype.hasOwnProperty,B={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function ee(Y,R,z){var U,te={},W=null,ae=null;if(R!=null)for(U in R.ref!==void 0&&(ae=R.ref),R.key!==void 0&&(W=""+R.key),R)J.call(R,U)&&!I.hasOwnProperty(U)&&(te[U]=R[U]);var oe=arguments.length-2;if(oe===1)te.children=z;else if(1<oe){for(var de=Array(oe),ge=0;ge<oe;ge++)de[ge]=arguments[ge+2];te.children=de}if(Y&&Y.defaultProps)for(U in oe=Y.defaultProps,oe)te[U]===void 0&&(te[U]=oe[U]);return{$$typeof:e,type:Y,key:W,ref:ae,props:te,_owner:B.current}}function re(Y,R){return{$$typeof:e,type:Y.type,key:R,ref:Y.ref,props:Y.props,_owner:Y._owner}}function ye(Y){return typeof Y=="object"&&Y!==null&&Y.$$typeof===e}function he(Y){var R={"=":"=0",":":"=2"};return"$"+Y.replace(/[=:]/g,function(z){return R[z]})}var ce=/\/+/g;function Ee(Y,R){return typeof Y=="object"&&Y!==null&&Y.key!=null?he(""+Y.key):R.toString(36)}function je(Y,R,z,U,te){var W=typeof Y;(W==="undefined"||W==="boolean")&&(Y=null);var ae=!1;if(Y===null)ae=!0;else switch(W){case"string":case"number":ae=!0;break;case"object":switch(Y.$$typeof){case e:case t:ae=!0}}if(ae)return ae=Y,te=te(ae),Y=U===""?"."+Ee(ae,0):U,H(te)?(z="",Y!=null&&(z=Y.replace(ce,"$&/")+"/"),je(te,R,z,"",function(ge){return ge})):te!=null&&(ye(te)&&(te=re(te,z+(!te.key||ae&&ae.key===te.key?"":(""+te.key).replace(ce,"$&/")+"/")+Y)),R.push(te)),1;if(ae=0,U=U===""?".":U+":",H(Y))for(var oe=0;oe<Y.length;oe++){W=Y[oe];var de=U+Ee(W,oe);ae+=je(W,R,z,de,te)}else if(de=_(Y),typeof de=="function")for(Y=de.call(Y),oe=0;!(W=Y.next()).done;)W=W.value,de=U+Ee(W,oe++),ae+=je(W,R,z,de,te);else if(W==="object")throw R=String(Y),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(Y).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.");return ae}function fe(Y,R,z){if(Y==null)return Y;var U=[],te=0;return je(Y,U,"","",function(W){return R.call(z,W,te++)}),U}function ue(Y){if(Y._status===-1){var R=Y._result;R=R(),R.then(function(z){(Y._status===0||Y._status===-1)&&(Y._status=1,Y._result=z)},function(z){(Y._status===0||Y._status===-1)&&(Y._status=2,Y._result=z)}),Y._status===-1&&(Y._status=0,Y._result=R)}if(Y._status===1)return Y._result.default;throw Y._result}var O={current:null},F={transition:null},M={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:F,ReactCurrentOwner:B};function ie(){throw Error("act(...) is not supported in production builds of React.")}return It.Children={map:fe,forEach:function(Y,R,z){fe(Y,function(){R.apply(this,arguments)},z)},count:function(Y){var R=0;return fe(Y,function(){R++}),R},toArray:function(Y){return fe(Y,function(R){return R})||[]},only:function(Y){if(!ye(Y))throw Error("React.Children.only expected to receive a single React element child.");return Y}},It.Component=E,It.Fragment=r,It.Profiler=a,It.PureComponent=D,It.StrictMode=n,It.Suspense=m,It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,It.act=ie,It.cloneElement=function(Y,R,z){if(Y==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+Y+".");var U=S({},Y.props),te=Y.key,W=Y.ref,ae=Y._owner;if(R!=null){if(R.ref!==void 0&&(W=R.ref,ae=B.current),R.key!==void 0&&(te=""+R.key),Y.type&&Y.type.defaultProps)var oe=Y.type.defaultProps;for(de in R)J.call(R,de)&&!I.hasOwnProperty(de)&&(U[de]=R[de]===void 0&&oe!==void 0?oe[de]:R[de])}var de=arguments.length-2;if(de===1)U.children=z;else if(1<de){oe=Array(de);for(var ge=0;ge<de;ge++)oe[ge]=arguments[ge+2];U.children=oe}return{$$typeof:e,type:Y.type,key:te,ref:W,props:U,_owner:ae}},It.createContext=function(Y){return Y={$$typeof:l,_currentValue:Y,_currentValue2:Y,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},Y.Provider={$$typeof:s,_context:Y},Y.Consumer=Y},It.createElement=ee,It.createFactory=function(Y){var R=ee.bind(null,Y);return R.type=Y,R},It.createRef=function(){return{current:null}},It.forwardRef=function(Y){return{$$typeof:d,render:Y}},It.isValidElement=ye,It.lazy=function(Y){return{$$typeof:g,_payload:{_status:-1,_result:Y},_init:ue}},It.memo=function(Y,R){return{$$typeof:p,type:Y,compare:R===void 0?null:R}},It.startTransition=function(Y){var R=F.transition;F.transition={};try{Y()}finally{F.transition=R}},It.unstable_act=ie,It.useCallback=function(Y,R){return O.current.useCallback(Y,R)},It.useContext=function(Y){return O.current.useContext(Y)},It.useDebugValue=function(){},It.useDeferredValue=function(Y){return O.current.useDeferredValue(Y)},It.useEffect=function(Y,R){return O.current.useEffect(Y,R)},It.useId=function(){return O.current.useId()},It.useImperativeHandle=function(Y,R,z){return O.current.useImperativeHandle(Y,R,z)},It.useInsertionEffect=function(Y,R){return O.current.useInsertionEffect(Y,R)},It.useLayoutEffect=function(Y,R){return O.current.useLayoutEffect(Y,R)},It.useMemo=function(Y,R){return O.current.useMemo(Y,R)},It.useReducer=function(Y,R,z){return O.current.useReducer(Y,R,z)},It.useRef=function(Y){return O.current.useRef(Y)},It.useState=function(Y){return O.current.useState(Y)},It.useSyncExternalStore=function(Y,R,z){return O.current.useSyncExternalStore(Y,R,z)},It.useTransition=function(){return O.current.useTransition()},It.version="18.3.1",It}var dx;function Tp(){return dx||(dx=1,gm.exports=Ok()),gm.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fx;function Rk(){if(fx)return ku;fx=1;var e=Tp(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,a=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function l(d,m,p){var g,y={},_=null,T=null;p!==void 0&&(_=""+p),m.key!==void 0&&(_=""+m.key),m.ref!==void 0&&(T=m.ref);for(g in m)n.call(m,g)&&!s.hasOwnProperty(g)&&(y[g]=m[g]);if(d&&d.defaultProps)for(g in m=d.defaultProps,m)y[g]===void 0&&(y[g]=m[g]);return{$$typeof:t,type:d,key:_,ref:T,props:y,_owner:a.current}}return ku.Fragment=r,ku.jsx=l,ku.jsxs=l,ku}var hx;function Lk(){return hx||(hx=1,pm.exports=Rk()),pm.exports}var u=Lk(),Rf={},vm={exports:{}},Xn={},xm={exports:{}},ym={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mx;function Mk(){return mx||(mx=1,(function(e){function t(F,M){var ie=F.length;F.push(M);e:for(;0<ie;){var Y=ie-1>>>1,R=F[Y];if(0<a(R,M))F[Y]=M,F[ie]=R,ie=Y;else break e}}function r(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var M=F[0],ie=F.pop();if(ie!==M){F[0]=ie;e:for(var Y=0,R=F.length,z=R>>>1;Y<z;){var U=2*(Y+1)-1,te=F[U],W=U+1,ae=F[W];if(0>a(te,ie))W<R&&0>a(ae,te)?(F[Y]=ae,F[W]=ie,Y=W):(F[Y]=te,F[U]=ie,Y=U);else if(W<R&&0>a(ae,ie))F[Y]=ae,F[W]=ie,Y=W;else break e}}return M}function a(F,M){var ie=F.sortIndex-M.sortIndex;return ie!==0?ie:F.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var l=Date,d=l.now();e.unstable_now=function(){return l.now()-d}}var m=[],p=[],g=1,y=null,_=3,T=!1,S=!1,w=!1,E=typeof setTimeout=="function"?setTimeout:null,P=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(F){for(var M=r(p);M!==null;){if(M.callback===null)n(p);else if(M.startTime<=F)n(p),M.sortIndex=M.expirationTime,t(m,M);else break;M=r(p)}}function H(F){if(w=!1,A(F),!S)if(r(m)!==null)S=!0,ue(J);else{var M=r(p);M!==null&&O(H,M.startTime-F)}}function J(F,M){S=!1,w&&(w=!1,P(ee),ee=-1),T=!0;var ie=_;try{for(A(M),y=r(m);y!==null&&(!(y.expirationTime>M)||F&&!he());){var Y=y.callback;if(typeof Y=="function"){y.callback=null,_=y.priorityLevel;var R=Y(y.expirationTime<=M);M=e.unstable_now(),typeof R=="function"?y.callback=R:y===r(m)&&n(m),A(M)}else n(m);y=r(m)}if(y!==null)var z=!0;else{var U=r(p);U!==null&&O(H,U.startTime-M),z=!1}return z}finally{y=null,_=ie,T=!1}}var B=!1,I=null,ee=-1,re=5,ye=-1;function he(){return!(e.unstable_now()-ye<re)}function ce(){if(I!==null){var F=e.unstable_now();ye=F;var M=!0;try{M=I(!0,F)}finally{M?Ee():(B=!1,I=null)}}else B=!1}var Ee;if(typeof D=="function")Ee=function(){D(ce)};else if(typeof MessageChannel<"u"){var je=new MessageChannel,fe=je.port2;je.port1.onmessage=ce,Ee=function(){fe.postMessage(null)}}else Ee=function(){E(ce,0)};function ue(F){I=F,B||(B=!0,Ee())}function O(F,M){ee=E(function(){F(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){S||T||(S=!0,ue(J))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):re=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return r(m)},e.unstable_next=function(F){switch(_){case 1:case 2:case 3:var M=3;break;default:M=_}var ie=_;_=M;try{return F()}finally{_=ie}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,M){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var ie=_;_=F;try{return M()}finally{_=ie}},e.unstable_scheduleCallback=function(F,M,ie){var Y=e.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?Y+ie:Y):ie=Y,F){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=ie+R,F={id:g++,callback:M,priorityLevel:F,startTime:ie,expirationTime:R,sortIndex:-1},ie>Y?(F.sortIndex=ie,t(p,F),r(m)===null&&F===r(p)&&(w?(P(ee),ee=-1):w=!0,O(H,ie-Y))):(F.sortIndex=R,t(m,F),S||T||(S=!0,ue(J))),F},e.unstable_shouldYield=he,e.unstable_wrapCallback=function(F){var M=_;return function(){var ie=_;_=M;try{return F.apply(this,arguments)}finally{_=ie}}}})(ym)),ym}var px;function Bk(){return px||(px=1,xm.exports=Mk()),xm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gx;function zk(){if(gx)return Xn;gx=1;var e=Tp(),t=Bk();function r(i){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+i,h=1;h<arguments.length;h++)c+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+i+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,a={};function s(i,c){l(i,c),l(i+"Capture",c)}function l(i,c){for(a[i]=c,i=0;i<c.length;i++)n.add(c[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},y={};function _(i){return m.call(y,i)?!0:m.call(g,i)?!1:p.test(i)?y[i]=!0:(g[i]=!0,!1)}function T(i,c,h,x){if(h!==null&&h.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return x?!1:h!==null?!h.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function S(i,c,h,x){if(c===null||typeof c>"u"||T(i,c,h,x))return!0;if(x)return!1;if(h!==null)switch(h.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function w(i,c,h,x,k,C,V){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=x,this.attributeNamespace=k,this.mustUseProperty=h,this.propertyName=i,this.type=c,this.sanitizeURL=C,this.removeEmptyString=V}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){E[i]=new w(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var c=i[0];E[c]=new w(c,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){E[i]=new w(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){E[i]=new w(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){E[i]=new w(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){E[i]=new w(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){E[i]=new w(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){E[i]=new w(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){E[i]=new w(i,5,!1,i.toLowerCase(),null,!1,!1)});var P=/[\-:]([a-z])/g;function D(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var c=i.replace(P,D);E[c]=new w(c,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var c=i.replace(P,D);E[c]=new w(c,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var c=i.replace(P,D);E[c]=new w(c,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){E[i]=new w(i,1,!1,i.toLowerCase(),null,!1,!1)}),E.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){E[i]=new w(i,1,!1,i.toLowerCase(),null,!0,!0)});function A(i,c,h,x){var k=E.hasOwnProperty(c)?E[c]:null;(k!==null?k.type!==0:x||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(S(c,h,k,x)&&(h=null),x||k===null?_(c)&&(h===null?i.removeAttribute(c):i.setAttribute(c,""+h)):k.mustUseProperty?i[k.propertyName]=h===null?k.type===3?!1:"":h:(c=k.attributeName,x=k.attributeNamespace,h===null?i.removeAttribute(c):(k=k.type,h=k===3||k===4&&h===!0?"":""+h,x?i.setAttributeNS(x,c,h):i.setAttribute(c,h))))}var H=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,J=Symbol.for("react.element"),B=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),ee=Symbol.for("react.strict_mode"),re=Symbol.for("react.profiler"),ye=Symbol.for("react.provider"),he=Symbol.for("react.context"),ce=Symbol.for("react.forward_ref"),Ee=Symbol.for("react.suspense"),je=Symbol.for("react.suspense_list"),fe=Symbol.for("react.memo"),ue=Symbol.for("react.lazy"),O=Symbol.for("react.offscreen"),F=Symbol.iterator;function M(i){return i===null||typeof i!="object"?null:(i=F&&i[F]||i["@@iterator"],typeof i=="function"?i:null)}var ie=Object.assign,Y;function R(i){if(Y===void 0)try{throw Error()}catch(h){var c=h.stack.trim().match(/\n( *(at )?)/);Y=c&&c[1]||""}return`
`+Y+i}var z=!1;function U(i,c){if(!i||z)return"";z=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(Pe){var x=Pe}Reflect.construct(i,[],c)}else{try{c.call()}catch(Pe){x=Pe}i.call(c.prototype)}else{try{throw Error()}catch(Pe){x=Pe}i()}}catch(Pe){if(Pe&&x&&typeof Pe.stack=="string"){for(var k=Pe.stack.split(`
`),C=x.stack.split(`
`),V=k.length-1,me=C.length-1;1<=V&&0<=me&&k[V]!==C[me];)me--;for(;1<=V&&0<=me;V--,me--)if(k[V]!==C[me]){if(V!==1||me!==1)do if(V--,me--,0>me||k[V]!==C[me]){var ve=`
`+k[V].replace(" at new "," at ");return i.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",i.displayName)),ve}while(1<=V&&0<=me);break}}}finally{z=!1,Error.prepareStackTrace=h}return(i=i?i.displayName||i.name:"")?R(i):""}function te(i){switch(i.tag){case 5:return R(i.type);case 16:return R("Lazy");case 13:return R("Suspense");case 19:return R("SuspenseList");case 0:case 2:case 15:return i=U(i.type,!1),i;case 11:return i=U(i.type.render,!1),i;case 1:return i=U(i.type,!0),i;default:return""}}function W(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case I:return"Fragment";case B:return"Portal";case re:return"Profiler";case ee:return"StrictMode";case Ee:return"Suspense";case je:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case he:return(i.displayName||"Context")+".Consumer";case ye:return(i._context.displayName||"Context")+".Provider";case ce:var c=i.render;return i=i.displayName,i||(i=c.displayName||c.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case fe:return c=i.displayName||null,c!==null?c:W(i.type)||"Memo";case ue:c=i._payload,i=i._init;try{return W(i(c))}catch{}}return null}function ae(i){var c=i.type;switch(i.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=c.render,i=i.displayName||i.name||"",c.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(c);case 8:return c===ee?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function oe(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function de(i){var c=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ge(i){var c=de(i)?"checked":"value",h=Object.getOwnPropertyDescriptor(i.constructor.prototype,c),x=""+i[c];if(!i.hasOwnProperty(c)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var k=h.get,C=h.set;return Object.defineProperty(i,c,{configurable:!0,get:function(){return k.call(this)},set:function(V){x=""+V,C.call(this,V)}}),Object.defineProperty(i,c,{enumerable:h.enumerable}),{getValue:function(){return x},setValue:function(V){x=""+V},stopTracking:function(){i._valueTracker=null,delete i[c]}}}}function Oe(i){i._valueTracker||(i._valueTracker=ge(i))}function q(i){if(!i)return!1;var c=i._valueTracker;if(!c)return!0;var h=c.getValue(),x="";return i&&(x=de(i)?i.checked?"true":"false":i.value),i=x,i!==h?(c.setValue(i),!0):!1}function Ze(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Je(i,c){var h=c.checked;return ie({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:h??i._wrapperState.initialChecked})}function Ye(i,c){var h=c.defaultValue==null?"":c.defaultValue,x=c.checked!=null?c.checked:c.defaultChecked;h=oe(c.value!=null?c.value:h),i._wrapperState={initialChecked:x,initialValue:h,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function nt(i,c){c=c.checked,c!=null&&A(i,"checked",c,!1)}function Be(i,c){nt(i,c);var h=oe(c.value),x=c.type;if(h!=null)x==="number"?(h===0&&i.value===""||i.value!=h)&&(i.value=""+h):i.value!==""+h&&(i.value=""+h);else if(x==="submit"||x==="reset"){i.removeAttribute("value");return}c.hasOwnProperty("value")?dt(i,c.type,h):c.hasOwnProperty("defaultValue")&&dt(i,c.type,oe(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(i.defaultChecked=!!c.defaultChecked)}function bt(i,c,h){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var x=c.type;if(!(x!=="submit"&&x!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+i._wrapperState.initialValue,h||c===i.value||(i.value=c),i.defaultValue=c}h=i.name,h!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,h!==""&&(i.name=h)}function dt(i,c,h){(c!=="number"||Ze(i.ownerDocument)!==i)&&(h==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+h&&(i.defaultValue=""+h))}var ht=Array.isArray;function Kt(i,c,h,x){if(i=i.options,c){c={};for(var k=0;k<h.length;k++)c["$"+h[k]]=!0;for(h=0;h<i.length;h++)k=c.hasOwnProperty("$"+i[h].value),i[h].selected!==k&&(i[h].selected=k),k&&x&&(i[h].defaultSelected=!0)}else{for(h=""+oe(h),c=null,k=0;k<i.length;k++){if(i[k].value===h){i[k].selected=!0,x&&(i[k].defaultSelected=!0);return}c!==null||i[k].disabled||(c=i[k])}c!==null&&(c.selected=!0)}}function In(i,c){if(c.dangerouslySetInnerHTML!=null)throw Error(r(91));return ie({},c,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function zr(i,c){var h=c.value;if(h==null){if(h=c.children,c=c.defaultValue,h!=null){if(c!=null)throw Error(r(92));if(ht(h)){if(1<h.length)throw Error(r(93));h=h[0]}c=h}c==null&&(c=""),h=c}i._wrapperState={initialValue:oe(h)}}function Er(i,c){var h=oe(c.value),x=oe(c.defaultValue);h!=null&&(h=""+h,h!==i.value&&(i.value=h),c.defaultValue==null&&i.defaultValue!==h&&(i.defaultValue=h)),x!=null&&(i.defaultValue=""+x)}function fn(i){var c=i.textContent;c===i._wrapperState.initialValue&&c!==""&&c!==null&&(i.value=c)}function Fr(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sn(i,c){return i==null||i==="http://www.w3.org/1999/xhtml"?Fr(c):i==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Qt,Cr=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,h,x,k){MSApp.execUnsafeLocalFunction(function(){return i(c,h,x,k)})}:i})(function(i,c){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=c;else{for(Qt=Qt||document.createElement("div"),Qt.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=Qt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;c.firstChild;)i.appendChild(c.firstChild)}});function pt(i,c){if(c){var h=i.firstChild;if(h&&h===i.lastChild&&h.nodeType===3){h.nodeValue=c;return}}i.textContent=c}var At={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ar=["Webkit","ms","Moz","O"];Object.keys(At).forEach(function(i){Ar.forEach(function(c){c=c+i.charAt(0).toUpperCase()+i.substring(1),At[c]=At[i]})});function Zt(i,c,h){return c==null||typeof c=="boolean"||c===""?"":h||typeof c!="number"||c===0||At.hasOwnProperty(i)&&At[i]?(""+c).trim():c+"px"}function ct(i,c){i=i.style;for(var h in c)if(c.hasOwnProperty(h)){var x=h.indexOf("--")===0,k=Zt(h,c[h],x);h==="float"&&(h="cssFloat"),x?i.setProperty(h,k):i[h]=k}}var li=ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ci(i,c){if(c){if(li[i]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(r(137,i));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(r(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(r(61))}if(c.style!=null&&typeof c.style!="object")throw Error(r(62))}}function Wn(i,c){if(i.indexOf("-")===-1)return typeof c.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ui=null;function di(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var va=null,hn=null,sr=null;function za(i){if(i=Zi(i)){if(typeof va!="function")throw Error(r(280));var c=i.stateNode;c&&(c=zl(c),va(i.stateNode,i.type,c))}}function fi(i){hn?sr?sr.push(i):sr=[i]:hn=i}function ms(){if(hn){var i=hn,c=sr;if(sr=hn=null,za(i),c)for(i=0;i<c.length;i++)za(c[i])}}function ps(i,c){return i(c)}function gs(){}var Ri=!1;function hi(i,c,h){if(Ri)return i(c,h);Ri=!0;try{return ps(i,c,h)}finally{Ri=!1,(hn!==null||sr!==null)&&(gs(),ms())}}function Ua(i,c){var h=i.stateNode;if(h===null)return null;var x=zl(h);if(x===null)return null;h=x[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(i=i.type,x=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!x;break e;default:i=!1}if(i)return null;if(h&&typeof h!="function")throw Error(r(231,c,typeof h));return h}var Li=!1;if(d)try{var ea={};Object.defineProperty(ea,"passive",{get:function(){Li=!0}}),window.addEventListener("test",ea,ea),window.removeEventListener("test",ea,ea)}catch{Li=!1}function Ie(i,c,h,x,k,C,V,me,ve){var Pe=Array.prototype.slice.call(arguments,3);try{c.apply(h,Pe)}catch(He){this.onError(He)}}var Le=!1,De=null,j=!1,Q=null,K={onError:function(i){Le=!0,De=i}};function X(i,c,h,x,k,C,V,me,ve){Le=!1,De=null,Ie.apply(K,arguments)}function ne(i,c,h,x,k,C,V,me,ve){if(X.apply(this,arguments),Le){if(Le){var Pe=De;Le=!1,De=null}else throw Error(r(198));j||(j=!0,Q=Pe)}}function se(i){var c=i,h=i;if(i.alternate)for(;c.return;)c=c.return;else{i=c;do c=i,(c.flags&4098)!==0&&(h=c.return),i=c.return;while(i)}return c.tag===3?h:null}function be(i){if(i.tag===13){var c=i.memoizedState;if(c===null&&(i=i.alternate,i!==null&&(c=i.memoizedState)),c!==null)return c.dehydrated}return null}function Ce(i){if(se(i)!==i)throw Error(r(188))}function _e(i){var c=i.alternate;if(!c){if(c=se(i),c===null)throw Error(r(188));return c!==i?null:i}for(var h=i,x=c;;){var k=h.return;if(k===null)break;var C=k.alternate;if(C===null){if(x=k.return,x!==null){h=x;continue}break}if(k.child===C.child){for(C=k.child;C;){if(C===h)return Ce(k),i;if(C===x)return Ce(k),c;C=C.sibling}throw Error(r(188))}if(h.return!==x.return)h=k,x=C;else{for(var V=!1,me=k.child;me;){if(me===h){V=!0,h=k,x=C;break}if(me===x){V=!0,x=k,h=C;break}me=me.sibling}if(!V){for(me=C.child;me;){if(me===h){V=!0,h=C,x=k;break}if(me===x){V=!0,x=C,h=k;break}me=me.sibling}if(!V)throw Error(r(189))}}if(h.alternate!==x)throw Error(r(190))}if(h.tag!==3)throw Error(r(188));return h.stateNode.current===h?i:c}function xe(i){return i=_e(i),i!==null?ke(i):null}function ke(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var c=ke(i);if(c!==null)return c;i=i.sibling}return null}var Re=t.unstable_scheduleCallback,Ke=t.unstable_cancelCallback,et=t.unstable_shouldYield,We=t.unstable_requestPaint,Ue=t.unstable_now,st=t.unstable_getCurrentPriorityLevel,$t=t.unstable_ImmediatePriority,Wt=t.unstable_UserBlockingPriority,ar=t.unstable_NormalPriority,mn=t.unstable_LowPriority,Yr=t.unstable_IdlePriority,Dn=null,Nr=null;function $a(i){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Dn,i,void 0,(i.current.flags&128)===128)}catch{}}var ft=Math.clz32?Math.clz32:vs,ur=Math.log,xl=Math.LN2;function vs(i){return i>>>=0,i===0?32:31-(ur(i)/xl|0)|0}var Wa=64,xs=4194304;function St(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function or(i,c){var h=i.pendingLanes;if(h===0)return 0;var x=0,k=i.suspendedLanes,C=i.pingedLanes,V=h&268435455;if(V!==0){var me=V&~k;me!==0?x=St(me):(C&=V,C!==0&&(x=St(C)))}else V=h&~k,V!==0?x=St(V):C!==0&&(x=St(C));if(x===0)return 0;if(c!==0&&c!==x&&(c&k)===0&&(k=x&-x,C=c&-c,k>=C||k===16&&(C&4194240)!==0))return c;if((x&4)!==0&&(x|=h&16),c=i.entangledLanes,c!==0)for(i=i.entanglements,c&=x;0<c;)h=31-ft(c),k=1<<h,x|=i[h],c&=~k;return x}function Bc(i,c){switch(i){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yl(i,c){for(var h=i.suspendedLanes,x=i.pingedLanes,k=i.expirationTimes,C=i.pendingLanes;0<C;){var V=31-ft(C),me=1<<V,ve=k[V];ve===-1?((me&h)===0||(me&x)!==0)&&(k[V]=Bc(me,c)):ve<=c&&(i.expiredLanes|=me),C&=~me}}function pn(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Ad(){var i=Wa;return Wa<<=1,(Wa&4194240)===0&&(Wa=64),i}function ys(i){for(var c=[],h=0;31>h;h++)c.push(i);return c}function ta(i,c,h){i.pendingLanes|=c,c!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,c=31-ft(c),i[c]=h}function _r(i,c){var h=i.pendingLanes&~c;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=c,i.mutableReadLanes&=c,i.entangledLanes&=c,c=i.entanglements;var x=i.eventTimes;for(i=i.expirationTimes;0<h;){var k=31-ft(h),C=1<<k;c[k]=0,x[k]=-1,i[k]=-1,h&=~C}}function Ha(i,c){var h=i.entangledLanes|=c;for(i=i.entanglements;h;){var x=31-ft(h),k=1<<x;k&c|i[x]&c&&(i[x]|=c),h&=~k}}var Rt=0;function _s(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var _l,Mi,wl,bl,go,vo=!1,ws=[],ra=null,Va=null,xa=null,xo=new Map,_t=new Map,Ur=[],er="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zc(i,c){switch(i){case"focusin":case"focusout":ra=null;break;case"dragenter":case"dragleave":Va=null;break;case"mouseover":case"mouseout":xa=null;break;case"pointerover":case"pointerout":xo.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":_t.delete(c.pointerId)}}function Bi(i,c,h,x,k,C){return i===null||i.nativeEvent!==C?(i={blockedOn:c,domEventName:h,eventSystemFlags:x,nativeEvent:C,targetContainers:[k]},c!==null&&(c=Zi(c),c!==null&&Mi(c)),i):(i.eventSystemFlags|=x,c=i.targetContainers,k!==null&&c.indexOf(k)===-1&&c.push(k),i)}function Uc(i,c,h,x,k){switch(c){case"focusin":return ra=Bi(ra,i,c,h,x,k),!0;case"dragenter":return Va=Bi(Va,i,c,h,x,k),!0;case"mouseover":return xa=Bi(xa,i,c,h,x,k),!0;case"pointerover":var C=k.pointerId;return xo.set(C,Bi(xo.get(C)||null,i,c,h,x,k)),!0;case"gotpointercapture":return C=k.pointerId,_t.set(C,Bi(_t.get(C)||null,i,c,h,x,k)),!0}return!1}function kl(i){var c=Ki(i.target);if(c!==null){var h=se(c);if(h!==null){if(c=h.tag,c===13){if(c=be(h),c!==null){i.blockedOn=c,go(i.priority,function(){wl(h)});return}}else if(c===3&&h.stateNode.current.memoizedState.isDehydrated){i.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ya(i){if(i.blockedOn!==null)return!1;for(var c=i.targetContainers;0<c.length;){var h=El(i.domEventName,i.eventSystemFlags,c[0],i.nativeEvent);if(h===null){h=i.nativeEvent;var x=new h.constructor(h.type,h);ui=x,h.target.dispatchEvent(x),ui=null}else return c=Zi(h),c!==null&&Mi(c),i.blockedOn=h,!1;c.shift()}return!0}function Sl(i,c,h){ya(i)&&h.delete(c)}function yo(){vo=!1,ra!==null&&ya(ra)&&(ra=null),Va!==null&&ya(Va)&&(Va=null),xa!==null&&ya(xa)&&(xa=null),xo.forEach(Sl),_t.forEach(Sl)}function gr(i,c){i.blockedOn===c&&(i.blockedOn=null,vo||(vo=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,yo)))}function na(i){function c(k){return gr(k,i)}if(0<ws.length){gr(ws[0],i);for(var h=1;h<ws.length;h++){var x=ws[h];x.blockedOn===i&&(x.blockedOn=null)}}for(ra!==null&&gr(ra,i),Va!==null&&gr(Va,i),xa!==null&&gr(xa,i),xo.forEach(c),_t.forEach(c),h=0;h<Ur.length;h++)x=Ur[h],x.blockedOn===i&&(x.blockedOn=null);for(;0<Ur.length&&(h=Ur[0],h.blockedOn===null);)kl(h),h.blockedOn===null&&Ur.shift()}var zi=H.ReactCurrentBatchConfig,_o=!0;function qh(i,c,h,x){var k=Rt,C=zi.transition;zi.transition=null;try{Rt=1,wo(i,c,h,x)}finally{Rt=k,zi.transition=C}}function Nd(i,c,h,x){var k=Rt,C=zi.transition;zi.transition=null;try{Rt=4,wo(i,c,h,x)}finally{Rt=k,zi.transition=C}}function wo(i,c,h,x){if(_o){var k=El(i,c,h,x);if(k===null)o(i,c,x,Tl,h),zc(i,x);else if(Uc(k,i,c,h,x))x.stopPropagation();else if(zc(i,x),c&4&&-1<er.indexOf(i)){for(;k!==null;){var C=Zi(k);if(C!==null&&_l(C),C=El(i,c,h,x),C===null&&o(i,c,x,Tl,h),C===k)break;k=C}k!==null&&x.stopPropagation()}else o(i,c,x,null,h)}}var Tl=null;function El(i,c,h,x){if(Tl=null,i=di(x),i=Ki(i),i!==null)if(c=se(i),c===null)i=null;else if(h=c.tag,h===13){if(i=be(c),i!==null)return i;i=null}else if(h===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;i=null}else c!==i&&(i=null);return Tl=i,null}function Ft(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(st()){case $t:return 1;case Wt:return 4;case ar:case mn:return 16;case Yr:return 536870912;default:return 16}default:return 16}}var mi=null,Fn=null,pi=null;function $c(){if(pi)return pi;var i,c=Fn,h=c.length,x,k="value"in mi?mi.value:mi.textContent,C=k.length;for(i=0;i<h&&c[i]===k[i];i++);var V=h-i;for(x=1;x<=V&&c[h-x]===k[C-x];x++);return pi=k.slice(i,1<x?1-x:void 0)}function Cl(i){var c=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&c===13&&(i=13)):i=c,i===10&&(i=13),32<=i||i===13?i:0}function bs(){return!0}function Pd(){return!1}function gn(i){function c(h,x,k,C,V){this._reactName=h,this._targetInst=k,this.type=x,this.nativeEvent=C,this.target=V,this.currentTarget=null;for(var me in i)i.hasOwnProperty(me)&&(h=i[me],this[me]=h?h(C):C[me]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?bs:Pd,this.isPropagationStopped=Pd,this}return ie(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),c}var ks={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wc=gn(ks),Ui=ie({},ks,{view:0,detail:0}),Xh=gn(Ui),Hn,Hc,Ss,aa=ie({},Ui,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wi,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ss&&(Ss&&i.type==="mousemove"?(Hn=i.screenX-Ss.screenX,Hc=i.screenY-Ss.screenY):Hc=Hn=0,Ss=i),Hn)},movementY:function(i){return"movementY"in i?i.movementY:Hc}}),Vc=gn(aa),Id=ie({},aa,{dataTransfer:0}),Gc=gn(Id),Jh=ie({},Ui,{relatedTarget:0}),Al=gn(Jh),Dd=ie({},ks,{animationName:0,elapsedTime:0,pseudoElement:0}),Qh=gn(Dd),e0=ie({},ks,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Kc=gn(e0),t0=ie({},ks,{data:0}),Zc=gn(t0),Fd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$i={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r0(i){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(i):(i=$i[i])?!!c[i]:!1}function Wi(){return r0}var Vn=ie({},Ui,{key:function(i){if(i.key){var c=Fd[i.key]||i.key;if(c!=="Unidentified")return c}return i.type==="keypress"?(i=Cl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Nl[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wi,charCode:function(i){return i.type==="keypress"?Cl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Cl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),jd=gn(Vn),Od=ie({},aa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rd=gn(Od),Yc=ie({},Ui,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wi}),qc=gn(Yc),n0=ie({},ks,{propertyName:0,elapsedTime:0,pseudoElement:0}),a0=gn(n0),Ld=ie({},aa,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),i0=gn(Ld),ia=[9,13,27,32],gi=d&&"CompositionEvent"in window,bo=null;d&&"documentMode"in document&&(bo=document.documentMode);var Ga=d&&"TextEvent"in window&&!bo,Md=d&&(!gi||bo&&8<bo&&11>=bo),Hi=" ",Bd=!1;function Ts(i,c){switch(i){case"keyup":return ia.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xc(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ka=!1;function s0(i,c){switch(i){case"compositionend":return Xc(c);case"keypress":return c.which!==32?null:(Bd=!0,Hi);case"textInput":return i=c.data,i===Hi&&Bd?null:i;default:return null}}function vi(i,c){if(Ka)return i==="compositionend"||!gi&&Ts(i,c)?(i=$c(),pi=Fn=mi=null,Ka=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return Md&&c.locale!=="ko"?null:c.data;default:return null}}var Pl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zd(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c==="input"?!!Pl[i.type]:c==="textarea"}function Il(i,c,h,x){fi(x),c=v(c,"onChange"),0<c.length&&(h=new Wc("onChange","change",null,h,x),i.push({event:h,listeners:c}))}var ko=null,jn=null;function o0(i){su(i,0)}function Za(i){var c=Yi(i);if(q(c))return i}function l0(i,c){if(i==="change")return c}var _a=!1;if(d){var Es;if(d){var Dl="oninput"in document;if(!Dl){var Fl=document.createElement("div");Fl.setAttribute("oninput","return;"),Dl=typeof Fl.oninput=="function"}Es=Dl}else Es=!1;_a=Es&&(!document.documentMode||9<document.documentMode)}function So(){ko&&(ko.detachEvent("onpropertychange",jl),jn=ko=null)}function jl(i){if(i.propertyName==="value"&&Za(jn)){var c=[];Il(c,jn,i,di(i)),hi(o0,c)}}function Ol(i,c,h){i==="focusin"?(So(),ko=c,jn=h,ko.attachEvent("onpropertychange",jl)):i==="focusout"&&So()}function Cs(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Za(jn)}function Rl(i,c){if(i==="click")return Za(c)}function Jc(i,c){if(i==="input"||i==="change")return Za(c)}function Ud(i,c){return i===c&&(i!==0||1/i===1/c)||i!==i&&c!==c}var sa=typeof Object.is=="function"?Object.is:Ud;function xi(i,c){if(sa(i,c))return!0;if(typeof i!="object"||i===null||typeof c!="object"||c===null)return!1;var h=Object.keys(i),x=Object.keys(c);if(h.length!==x.length)return!1;for(x=0;x<h.length;x++){var k=h[x];if(!m.call(c,k)||!sa(i[k],c[k]))return!1}return!0}function $d(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Qc(i,c){var h=$d(i);i=0;for(var x;h;){if(h.nodeType===3){if(x=i+h.textContent.length,i<=c&&x>=c)return{node:h,offset:c-i};i=x}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=$d(h)}}function Wd(i,c){return i&&c?i===c?!0:i&&i.nodeType===3?!1:c&&c.nodeType===3?Wd(i,c.parentNode):"contains"in i?i.contains(c):i.compareDocumentPosition?!!(i.compareDocumentPosition(c)&16):!1:!1}function eu(){for(var i=window,c=Ze();c instanceof i.HTMLIFrameElement;){try{var h=typeof c.contentWindow.location.href=="string"}catch{h=!1}if(h)i=c.contentWindow;else break;c=Ze(i.document)}return c}function tu(i){var c=i&&i.nodeName&&i.nodeName.toLowerCase();return c&&(c==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||c==="textarea"||i.contentEditable==="true")}function wa(i){var c=eu(),h=i.focusedElem,x=i.selectionRange;if(c!==h&&h&&h.ownerDocument&&Wd(h.ownerDocument.documentElement,h)){if(x!==null&&tu(h)){if(c=x.start,i=x.end,i===void 0&&(i=c),"selectionStart"in h)h.selectionStart=c,h.selectionEnd=Math.min(i,h.value.length);else if(i=(c=h.ownerDocument||document)&&c.defaultView||window,i.getSelection){i=i.getSelection();var k=h.textContent.length,C=Math.min(x.start,k);x=x.end===void 0?C:Math.min(x.end,k),!i.extend&&C>x&&(k=x,x=C,C=k),k=Qc(h,C);var V=Qc(h,x);k&&V&&(i.rangeCount!==1||i.anchorNode!==k.node||i.anchorOffset!==k.offset||i.focusNode!==V.node||i.focusOffset!==V.offset)&&(c=c.createRange(),c.setStart(k.node,k.offset),i.removeAllRanges(),C>x?(i.addRange(c),i.extend(V.node,V.offset)):(c.setEnd(V.node,V.offset),i.addRange(c)))}}for(c=[],i=h;i=i.parentNode;)i.nodeType===1&&c.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof h.focus=="function"&&h.focus(),h=0;h<c.length;h++)i=c[h],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var Ll=d&&"documentMode"in document&&11>=document.documentMode,As=null,Ns=null,To=null,Ml=!1;function Hd(i,c,h){var x=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Ml||As==null||As!==Ze(x)||(x=As,"selectionStart"in x&&tu(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),To&&xi(To,x)||(To=x,x=v(Ns,"onSelect"),0<x.length&&(c=new Wc("onSelect","select",null,c,h),i.push({event:c,listeners:x}),c.target=As)))}function yi(i,c){var h={};return h[i.toLowerCase()]=c.toLowerCase(),h["Webkit"+i]="webkit"+c,h["Moz"+i]="moz"+c,h}var Ps={animationend:yi("Animation","AnimationEnd"),animationiteration:yi("Animation","AnimationIteration"),animationstart:yi("Animation","AnimationStart"),transitionend:yi("Transition","TransitionEnd")},_i={},ru={};d&&(ru=document.createElement("div").style,"AnimationEvent"in window||(delete Ps.animationend.animation,delete Ps.animationiteration.animation,delete Ps.animationstart.animation),"TransitionEvent"in window||delete Ps.transitionend.transition);function Eo(i){if(_i[i])return _i[i];if(!Ps[i])return i;var c=Ps[i],h;for(h in c)if(c.hasOwnProperty(h)&&h in ru)return _i[i]=c[h];return i}var Vd=Eo("animationend"),ba=Eo("animationiteration"),nu=Eo("animationstart"),au=Eo("transitionend"),Is=new Map,Gd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oa(i,c){Is.set(i,c),s(c,[i])}for(var Vi=0;Vi<Gd.length;Vi++){var Bl=Gd[Vi],Kd=Bl.toLowerCase(),c0=Bl[0].toUpperCase()+Bl.slice(1);oa(Kd,"on"+c0)}oa(Vd,"onAnimationEnd"),oa(ba,"onAnimationIteration"),oa(nu,"onAnimationStart"),oa("dblclick","onDoubleClick"),oa("focusin","onFocus"),oa("focusout","onBlur"),oa(au,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ds="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Zd=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ds));function iu(i,c,h){var x=i.type||"unknown-event";i.currentTarget=h,ne(x,c,void 0,i),i.currentTarget=null}function su(i,c){c=(c&4)!==0;for(var h=0;h<i.length;h++){var x=i[h],k=x.event;x=x.listeners;e:{var C=void 0;if(c)for(var V=x.length-1;0<=V;V--){var me=x[V],ve=me.instance,Pe=me.currentTarget;if(me=me.listener,ve!==C&&k.isPropagationStopped())break e;iu(k,me,Pe),C=ve}else for(V=0;V<x.length;V++){if(me=x[V],ve=me.instance,Pe=me.currentTarget,me=me.listener,ve!==C&&k.isPropagationStopped())break e;iu(k,me,Pe),C=ve}}}if(j)throw i=Q,j=!1,Q=null,i}function tr(i,c){var h=c[Rs];h===void 0&&(h=c[Rs]=new Set);var x=i+"__bubble";h.has(x)||(Yd(c,i,2,!1),h.add(x))}function ou(i,c,h){var x=0;c&&(x|=4),Yd(h,i,x,c)}var Co="_reactListening"+Math.random().toString(36).slice(2);function Fs(i){if(!i[Co]){i[Co]=!0,n.forEach(function(h){h!=="selectionchange"&&(Zd.has(h)||ou(h,!1,i),ou(h,!0,i))});var c=i.nodeType===9?i:i.ownerDocument;c===null||c[Co]||(c[Co]=!0,ou("selectionchange",!1,c))}}function Yd(i,c,h,x){switch(Ft(c)){case 1:var k=qh;break;case 4:k=Nd;break;default:k=wo}h=k.bind(null,c,h,i),k=void 0,!Li||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||(k=!0),x?k!==void 0?i.addEventListener(c,h,{capture:!0,passive:k}):i.addEventListener(c,h,!0):k!==void 0?i.addEventListener(c,h,{passive:k}):i.addEventListener(c,h,!1)}function o(i,c,h,x,k){var C=x;if((c&1)===0&&(c&2)===0&&x!==null)e:for(;;){if(x===null)return;var V=x.tag;if(V===3||V===4){var me=x.stateNode.containerInfo;if(me===k||me.nodeType===8&&me.parentNode===k)break;if(V===4)for(V=x.return;V!==null;){var ve=V.tag;if((ve===3||ve===4)&&(ve=V.stateNode.containerInfo,ve===k||ve.nodeType===8&&ve.parentNode===k))return;V=V.return}for(;me!==null;){if(V=Ki(me),V===null)return;if(ve=V.tag,ve===5||ve===6){x=C=V;continue e}me=me.parentNode}}x=x.return}hi(function(){var Pe=C,He=di(h),Ge=[];e:{var $e=Is.get(i);if($e!==void 0){var rt=Wc,it=i;switch(i){case"keypress":if(Cl(h)===0)break e;case"keydown":case"keyup":rt=jd;break;case"focusin":it="focus",rt=Al;break;case"focusout":it="blur",rt=Al;break;case"beforeblur":case"afterblur":rt=Al;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rt=Vc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rt=Gc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rt=qc;break;case Vd:case ba:case nu:rt=Qh;break;case au:rt=a0;break;case"scroll":rt=Xh;break;case"wheel":rt=i0;break;case"copy":case"cut":case"paste":rt=Kc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rt=Rd}var ot=(c&4)!==0,Pr=!ot&&i==="scroll",Te=ot?$e!==null?$e+"Capture":null:$e;ot=[];for(var we=Pe,Ae;we!==null;){Ae=we;var qe=Ae.stateNode;if(Ae.tag===5&&qe!==null&&(Ae=qe,Te!==null&&(qe=Ua(we,Te),qe!=null&&ot.push(f(we,qe,Ae)))),Pr)break;we=we.return}0<ot.length&&($e=new rt($e,it,null,h,He),Ge.push({event:$e,listeners:ot}))}}if((c&7)===0){e:{if($e=i==="mouseover"||i==="pointerover",rt=i==="mouseout"||i==="pointerout",$e&&h!==ui&&(it=h.relatedTarget||h.fromElement)&&(Ki(it)||it[Gt]))break e;if((rt||$e)&&($e=He.window===He?He:($e=He.ownerDocument)?$e.defaultView||$e.parentWindow:window,rt?(it=h.relatedTarget||h.toElement,rt=Pe,it=it?Ki(it):null,it!==null&&(Pr=se(it),it!==Pr||it.tag!==5&&it.tag!==6)&&(it=null)):(rt=null,it=Pe),rt!==it)){if(ot=Vc,qe="onMouseLeave",Te="onMouseEnter",we="mouse",(i==="pointerout"||i==="pointerover")&&(ot=Rd,qe="onPointerLeave",Te="onPointerEnter",we="pointer"),Pr=rt==null?$e:Yi(rt),Ae=it==null?$e:Yi(it),$e=new ot(qe,we+"leave",rt,h,He),$e.target=Pr,$e.relatedTarget=Ae,qe=null,Ki(He)===Pe&&(ot=new ot(Te,we+"enter",it,h,He),ot.target=Ae,ot.relatedTarget=Pr,qe=ot),Pr=qe,rt&&it)t:{for(ot=rt,Te=it,we=0,Ae=ot;Ae;Ae=b(Ae))we++;for(Ae=0,qe=Te;qe;qe=b(qe))Ae++;for(;0<we-Ae;)ot=b(ot),we--;for(;0<Ae-we;)Te=b(Te),Ae--;for(;we--;){if(ot===Te||Te!==null&&ot===Te.alternate)break t;ot=b(ot),Te=b(Te)}ot=null}else ot=null;rt!==null&&N(Ge,$e,rt,ot,!1),it!==null&&Pr!==null&&N(Ge,Pr,it,ot,!0)}}e:{if($e=Pe?Yi(Pe):window,rt=$e.nodeName&&$e.nodeName.toLowerCase(),rt==="select"||rt==="input"&&$e.type==="file")var lt=l0;else if(zd($e))if(_a)lt=Jc;else{lt=Cs;var gt=Ol}else(rt=$e.nodeName)&&rt.toLowerCase()==="input"&&($e.type==="checkbox"||$e.type==="radio")&&(lt=Rl);if(lt&&(lt=lt(i,Pe))){Il(Ge,lt,h,He);break e}gt&&gt(i,$e,Pe),i==="focusout"&&(gt=$e._wrapperState)&&gt.controlled&&$e.type==="number"&&dt($e,"number",$e.value)}switch(gt=Pe?Yi(Pe):window,i){case"focusin":(zd(gt)||gt.contentEditable==="true")&&(As=gt,Ns=Pe,To=null);break;case"focusout":To=Ns=As=null;break;case"mousedown":Ml=!0;break;case"contextmenu":case"mouseup":case"dragend":Ml=!1,Hd(Ge,h,He);break;case"selectionchange":if(Ll)break;case"keydown":case"keyup":Hd(Ge,h,He)}var vt;if(gi)e:{switch(i){case"compositionstart":var kt="onCompositionStart";break e;case"compositionend":kt="onCompositionEnd";break e;case"compositionupdate":kt="onCompositionUpdate";break e}kt=void 0}else Ka?Ts(i,h)&&(kt="onCompositionEnd"):i==="keydown"&&h.keyCode===229&&(kt="onCompositionStart");kt&&(Md&&h.locale!=="ko"&&(Ka||kt!=="onCompositionStart"?kt==="onCompositionEnd"&&Ka&&(vt=$c()):(mi=He,Fn="value"in mi?mi.value:mi.textContent,Ka=!0)),gt=v(Pe,kt),0<gt.length&&(kt=new Zc(kt,i,null,h,He),Ge.push({event:kt,listeners:gt}),vt?kt.data=vt:(vt=Xc(h),vt!==null&&(kt.data=vt)))),(vt=Ga?s0(i,h):vi(i,h))&&(Pe=v(Pe,"onBeforeInput"),0<Pe.length&&(He=new Zc("onBeforeInput","beforeinput",null,h,He),Ge.push({event:He,listeners:Pe}),He.data=vt))}su(Ge,c)})}function f(i,c,h){return{instance:i,listener:c,currentTarget:h}}function v(i,c){for(var h=c+"Capture",x=[];i!==null;){var k=i,C=k.stateNode;k.tag===5&&C!==null&&(k=C,C=Ua(i,h),C!=null&&x.unshift(f(i,C,k)),C=Ua(i,c),C!=null&&x.push(f(i,C,k))),i=i.return}return x}function b(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function N(i,c,h,x,k){for(var C=c._reactName,V=[];h!==null&&h!==x;){var me=h,ve=me.alternate,Pe=me.stateNode;if(ve!==null&&ve===x)break;me.tag===5&&Pe!==null&&(me=Pe,k?(ve=Ua(h,C),ve!=null&&V.unshift(f(h,ve,me))):k||(ve=Ua(h,C),ve!=null&&V.push(f(h,ve,me)))),h=h.return}V.length!==0&&i.push({event:c,listeners:V})}var G=/\r\n?/g,pe=/\u0000|\uFFFD/g;function Se(i){return(typeof i=="string"?i:""+i).replace(G,`
`).replace(pe,"")}function Ne(i,c,h){if(c=Se(c),Se(i)!==c&&h)throw Error(r(425))}function Me(){}var tt=null,mt=null;function Tt(i,c){return i==="textarea"||i==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var $r=typeof setTimeout=="function"?setTimeout:void 0,jr=typeof clearTimeout=="function"?clearTimeout:void 0,On=typeof Promise=="function"?Promise:void 0,vn=typeof queueMicrotask=="function"?queueMicrotask:typeof On<"u"?function(i){return On.resolve(null).then(i).catch(js)}:$r;function js(i){setTimeout(function(){throw i})}function lu(i,c){var h=c,x=0;do{var k=h.nextSibling;if(i.removeChild(h),k&&k.nodeType===8)if(h=k.data,h==="/$"){if(x===0){i.removeChild(k),na(c);return}x--}else h!=="$"&&h!=="$?"&&h!=="$!"||x++;h=k}while(h);na(c)}function wi(i){for(;i!=null;i=i.nextSibling){var c=i.nodeType;if(c===1||c===3)break;if(c===8){if(c=i.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return i}function qd(i){i=i.previousSibling;for(var c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="$"||h==="$!"||h==="$?"){if(c===0)return i;c--}else h==="/$"&&c++}i=i.previousSibling}return null}var Gi=Math.random().toString(36).slice(2),ka="__reactFiber$"+Gi,Os="__reactProps$"+Gi,Gt="__reactContainer$"+Gi,Rs="__reactEvents$"+Gi,u0="__reactListeners$"+Gi,d0="__reactHandles$"+Gi;function Ki(i){var c=i[ka];if(c)return c;for(var h=i.parentNode;h;){if(c=h[Gt]||h[ka]){if(h=c.alternate,c.child!==null||h!==null&&h.child!==null)for(i=qd(i);i!==null;){if(h=i[ka])return h;i=qd(i)}return c}i=h,h=i.parentNode}return null}function Zi(i){return i=i[ka]||i[Gt],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Yi(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(r(33))}function zl(i){return i[Os]||null}var f0=[],Ul=-1;function Ls(i){return{current:i}}function dr(i){0>Ul||(i.current=f0[Ul],f0[Ul]=null,Ul--)}function lr(i,c){Ul++,f0[Ul]=i.current,i.current=c}var Ms={},xn=Ls(Ms),Gn=Ls(!1),Ao=Ms;function $l(i,c){var h=i.type.contextTypes;if(!h)return Ms;var x=i.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===c)return x.__reactInternalMemoizedMaskedChildContext;var k={},C;for(C in h)k[C]=c[C];return x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=c,i.__reactInternalMemoizedMaskedChildContext=k),k}function Kn(i){return i=i.childContextTypes,i!=null}function Xd(){dr(Gn),dr(xn)}function Dg(i,c,h){if(xn.current!==Ms)throw Error(r(168));lr(xn,c),lr(Gn,h)}function Fg(i,c,h){var x=i.stateNode;if(c=c.childContextTypes,typeof x.getChildContext!="function")return h;x=x.getChildContext();for(var k in x)if(!(k in c))throw Error(r(108,ae(i)||"Unknown",k));return ie({},h,x)}function Jd(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Ms,Ao=xn.current,lr(xn,i),lr(Gn,Gn.current),!0}function jg(i,c,h){var x=i.stateNode;if(!x)throw Error(r(169));h?(i=Fg(i,c,Ao),x.__reactInternalMemoizedMergedChildContext=i,dr(Gn),dr(xn),lr(xn,i)):dr(Gn),lr(Gn,h)}var qi=null,Qd=!1,h0=!1;function Og(i){qi===null?qi=[i]:qi.push(i)}function Qb(i){Qd=!0,Og(i)}function Bs(){if(!h0&&qi!==null){h0=!0;var i=0,c=Rt;try{var h=qi;for(Rt=1;i<h.length;i++){var x=h[i];do x=x(!0);while(x!==null)}qi=null,Qd=!1}catch(k){throw qi!==null&&(qi=qi.slice(i+1)),Re($t,Bs),k}finally{Rt=c,h0=!1}}return null}var Wl=[],Hl=0,ef=null,tf=0,Sa=[],Ta=0,No=null,Xi=1,Ji="";function Po(i,c){Wl[Hl++]=tf,Wl[Hl++]=ef,ef=i,tf=c}function Rg(i,c,h){Sa[Ta++]=Xi,Sa[Ta++]=Ji,Sa[Ta++]=No,No=i;var x=Xi;i=Ji;var k=32-ft(x)-1;x&=~(1<<k),h+=1;var C=32-ft(c)+k;if(30<C){var V=k-k%5;C=(x&(1<<V)-1).toString(32),x>>=V,k-=V,Xi=1<<32-ft(c)+k|h<<k|x,Ji=C+i}else Xi=1<<C|h<<k|x,Ji=i}function m0(i){i.return!==null&&(Po(i,1),Rg(i,1,0))}function p0(i){for(;i===ef;)ef=Wl[--Hl],Wl[Hl]=null,tf=Wl[--Hl],Wl[Hl]=null;for(;i===No;)No=Sa[--Ta],Sa[Ta]=null,Ji=Sa[--Ta],Sa[Ta]=null,Xi=Sa[--Ta],Sa[Ta]=null}var la=null,ca=null,pr=!1,Ya=null;function Lg(i,c){var h=Na(5,null,null,0);h.elementType="DELETED",h.stateNode=c,h.return=i,c=i.deletions,c===null?(i.deletions=[h],i.flags|=16):c.push(h)}function Mg(i,c){switch(i.tag){case 5:var h=i.type;return c=c.nodeType!==1||h.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(i.stateNode=c,la=i,ca=wi(c.firstChild),!0):!1;case 6:return c=i.pendingProps===""||c.nodeType!==3?null:c,c!==null?(i.stateNode=c,la=i,ca=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(h=No!==null?{id:Xi,overflow:Ji}:null,i.memoizedState={dehydrated:c,treeContext:h,retryLane:1073741824},h=Na(18,null,null,0),h.stateNode=c,h.return=i,i.child=h,la=i,ca=null,!0):!1;default:return!1}}function g0(i){return(i.mode&1)!==0&&(i.flags&128)===0}function v0(i){if(pr){var c=ca;if(c){var h=c;if(!Mg(i,c)){if(g0(i))throw Error(r(418));c=wi(h.nextSibling);var x=la;c&&Mg(i,c)?Lg(x,h):(i.flags=i.flags&-4097|2,pr=!1,la=i)}}else{if(g0(i))throw Error(r(418));i.flags=i.flags&-4097|2,pr=!1,la=i}}}function Bg(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;la=i}function rf(i){if(i!==la)return!1;if(!pr)return Bg(i),pr=!0,!1;var c;if((c=i.tag!==3)&&!(c=i.tag!==5)&&(c=i.type,c=c!=="head"&&c!=="body"&&!Tt(i.type,i.memoizedProps)),c&&(c=ca)){if(g0(i))throw zg(),Error(r(418));for(;c;)Lg(i,c),c=wi(c.nextSibling)}if(Bg(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,c=0;i;){if(i.nodeType===8){var h=i.data;if(h==="/$"){if(c===0){ca=wi(i.nextSibling);break e}c--}else h!=="$"&&h!=="$!"&&h!=="$?"||c++}i=i.nextSibling}ca=null}}else ca=la?wi(i.stateNode.nextSibling):null;return!0}function zg(){for(var i=ca;i;)i=wi(i.nextSibling)}function Vl(){ca=la=null,pr=!1}function x0(i){Ya===null?Ya=[i]:Ya.push(i)}var ek=H.ReactCurrentBatchConfig;function cu(i,c,h){if(i=h.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(r(309));var x=h.stateNode}if(!x)throw Error(r(147,i));var k=x,C=""+i;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===C?c.ref:(c=function(V){var me=k.refs;V===null?delete me[C]:me[C]=V},c._stringRef=C,c)}if(typeof i!="string")throw Error(r(284));if(!h._owner)throw Error(r(290,i))}return i}function nf(i,c){throw i=Object.prototype.toString.call(c),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":i))}function Ug(i){var c=i._init;return c(i._payload)}function $g(i){function c(Te,we){if(i){var Ae=Te.deletions;Ae===null?(Te.deletions=[we],Te.flags|=16):Ae.push(we)}}function h(Te,we){if(!i)return null;for(;we!==null;)c(Te,we),we=we.sibling;return null}function x(Te,we){for(Te=new Map;we!==null;)we.key!==null?Te.set(we.key,we):Te.set(we.index,we),we=we.sibling;return Te}function k(Te,we){return Te=Ks(Te,we),Te.index=0,Te.sibling=null,Te}function C(Te,we,Ae){return Te.index=Ae,i?(Ae=Te.alternate,Ae!==null?(Ae=Ae.index,Ae<we?(Te.flags|=2,we):Ae):(Te.flags|=2,we)):(Te.flags|=1048576,we)}function V(Te){return i&&Te.alternate===null&&(Te.flags|=2),Te}function me(Te,we,Ae,qe){return we===null||we.tag!==6?(we=cm(Ae,Te.mode,qe),we.return=Te,we):(we=k(we,Ae),we.return=Te,we)}function ve(Te,we,Ae,qe){var lt=Ae.type;return lt===I?He(Te,we,Ae.props.children,qe,Ae.key):we!==null&&(we.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===ue&&Ug(lt)===we.type)?(qe=k(we,Ae.props),qe.ref=cu(Te,we,Ae),qe.return=Te,qe):(qe=Af(Ae.type,Ae.key,Ae.props,null,Te.mode,qe),qe.ref=cu(Te,we,Ae),qe.return=Te,qe)}function Pe(Te,we,Ae,qe){return we===null||we.tag!==4||we.stateNode.containerInfo!==Ae.containerInfo||we.stateNode.implementation!==Ae.implementation?(we=um(Ae,Te.mode,qe),we.return=Te,we):(we=k(we,Ae.children||[]),we.return=Te,we)}function He(Te,we,Ae,qe,lt){return we===null||we.tag!==7?(we=Mo(Ae,Te.mode,qe,lt),we.return=Te,we):(we=k(we,Ae),we.return=Te,we)}function Ge(Te,we,Ae){if(typeof we=="string"&&we!==""||typeof we=="number")return we=cm(""+we,Te.mode,Ae),we.return=Te,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case J:return Ae=Af(we.type,we.key,we.props,null,Te.mode,Ae),Ae.ref=cu(Te,null,we),Ae.return=Te,Ae;case B:return we=um(we,Te.mode,Ae),we.return=Te,we;case ue:var qe=we._init;return Ge(Te,qe(we._payload),Ae)}if(ht(we)||M(we))return we=Mo(we,Te.mode,Ae,null),we.return=Te,we;nf(Te,we)}return null}function $e(Te,we,Ae,qe){var lt=we!==null?we.key:null;if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number")return lt!==null?null:me(Te,we,""+Ae,qe);if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case J:return Ae.key===lt?ve(Te,we,Ae,qe):null;case B:return Ae.key===lt?Pe(Te,we,Ae,qe):null;case ue:return lt=Ae._init,$e(Te,we,lt(Ae._payload),qe)}if(ht(Ae)||M(Ae))return lt!==null?null:He(Te,we,Ae,qe,null);nf(Te,Ae)}return null}function rt(Te,we,Ae,qe,lt){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return Te=Te.get(Ae)||null,me(we,Te,""+qe,lt);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case J:return Te=Te.get(qe.key===null?Ae:qe.key)||null,ve(we,Te,qe,lt);case B:return Te=Te.get(qe.key===null?Ae:qe.key)||null,Pe(we,Te,qe,lt);case ue:var gt=qe._init;return rt(Te,we,Ae,gt(qe._payload),lt)}if(ht(qe)||M(qe))return Te=Te.get(Ae)||null,He(we,Te,qe,lt,null);nf(we,qe)}return null}function it(Te,we,Ae,qe){for(var lt=null,gt=null,vt=we,kt=we=0,Jr=null;vt!==null&&kt<Ae.length;kt++){vt.index>kt?(Jr=vt,vt=null):Jr=vt.sibling;var Ht=$e(Te,vt,Ae[kt],qe);if(Ht===null){vt===null&&(vt=Jr);break}i&&vt&&Ht.alternate===null&&c(Te,vt),we=C(Ht,we,kt),gt===null?lt=Ht:gt.sibling=Ht,gt=Ht,vt=Jr}if(kt===Ae.length)return h(Te,vt),pr&&Po(Te,kt),lt;if(vt===null){for(;kt<Ae.length;kt++)vt=Ge(Te,Ae[kt],qe),vt!==null&&(we=C(vt,we,kt),gt===null?lt=vt:gt.sibling=vt,gt=vt);return pr&&Po(Te,kt),lt}for(vt=x(Te,vt);kt<Ae.length;kt++)Jr=rt(vt,Te,kt,Ae[kt],qe),Jr!==null&&(i&&Jr.alternate!==null&&vt.delete(Jr.key===null?kt:Jr.key),we=C(Jr,we,kt),gt===null?lt=Jr:gt.sibling=Jr,gt=Jr);return i&&vt.forEach(function(Zs){return c(Te,Zs)}),pr&&Po(Te,kt),lt}function ot(Te,we,Ae,qe){var lt=M(Ae);if(typeof lt!="function")throw Error(r(150));if(Ae=lt.call(Ae),Ae==null)throw Error(r(151));for(var gt=lt=null,vt=we,kt=we=0,Jr=null,Ht=Ae.next();vt!==null&&!Ht.done;kt++,Ht=Ae.next()){vt.index>kt?(Jr=vt,vt=null):Jr=vt.sibling;var Zs=$e(Te,vt,Ht.value,qe);if(Zs===null){vt===null&&(vt=Jr);break}i&&vt&&Zs.alternate===null&&c(Te,vt),we=C(Zs,we,kt),gt===null?lt=Zs:gt.sibling=Zs,gt=Zs,vt=Jr}if(Ht.done)return h(Te,vt),pr&&Po(Te,kt),lt;if(vt===null){for(;!Ht.done;kt++,Ht=Ae.next())Ht=Ge(Te,Ht.value,qe),Ht!==null&&(we=C(Ht,we,kt),gt===null?lt=Ht:gt.sibling=Ht,gt=Ht);return pr&&Po(Te,kt),lt}for(vt=x(Te,vt);!Ht.done;kt++,Ht=Ae.next())Ht=rt(vt,Te,kt,Ht.value,qe),Ht!==null&&(i&&Ht.alternate!==null&&vt.delete(Ht.key===null?kt:Ht.key),we=C(Ht,we,kt),gt===null?lt=Ht:gt.sibling=Ht,gt=Ht);return i&&vt.forEach(function(Fk){return c(Te,Fk)}),pr&&Po(Te,kt),lt}function Pr(Te,we,Ae,qe){if(typeof Ae=="object"&&Ae!==null&&Ae.type===I&&Ae.key===null&&(Ae=Ae.props.children),typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case J:e:{for(var lt=Ae.key,gt=we;gt!==null;){if(gt.key===lt){if(lt=Ae.type,lt===I){if(gt.tag===7){h(Te,gt.sibling),we=k(gt,Ae.props.children),we.return=Te,Te=we;break e}}else if(gt.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===ue&&Ug(lt)===gt.type){h(Te,gt.sibling),we=k(gt,Ae.props),we.ref=cu(Te,gt,Ae),we.return=Te,Te=we;break e}h(Te,gt);break}else c(Te,gt);gt=gt.sibling}Ae.type===I?(we=Mo(Ae.props.children,Te.mode,qe,Ae.key),we.return=Te,Te=we):(qe=Af(Ae.type,Ae.key,Ae.props,null,Te.mode,qe),qe.ref=cu(Te,we,Ae),qe.return=Te,Te=qe)}return V(Te);case B:e:{for(gt=Ae.key;we!==null;){if(we.key===gt)if(we.tag===4&&we.stateNode.containerInfo===Ae.containerInfo&&we.stateNode.implementation===Ae.implementation){h(Te,we.sibling),we=k(we,Ae.children||[]),we.return=Te,Te=we;break e}else{h(Te,we);break}else c(Te,we);we=we.sibling}we=um(Ae,Te.mode,qe),we.return=Te,Te=we}return V(Te);case ue:return gt=Ae._init,Pr(Te,we,gt(Ae._payload),qe)}if(ht(Ae))return it(Te,we,Ae,qe);if(M(Ae))return ot(Te,we,Ae,qe);nf(Te,Ae)}return typeof Ae=="string"&&Ae!==""||typeof Ae=="number"?(Ae=""+Ae,we!==null&&we.tag===6?(h(Te,we.sibling),we=k(we,Ae),we.return=Te,Te=we):(h(Te,we),we=cm(Ae,Te.mode,qe),we.return=Te,Te=we),V(Te)):h(Te,we)}return Pr}var Gl=$g(!0),Wg=$g(!1),af=Ls(null),sf=null,Kl=null,y0=null;function _0(){y0=Kl=sf=null}function w0(i){var c=af.current;dr(af),i._currentValue=c}function b0(i,c,h){for(;i!==null;){var x=i.alternate;if((i.childLanes&c)!==c?(i.childLanes|=c,x!==null&&(x.childLanes|=c)):x!==null&&(x.childLanes&c)!==c&&(x.childLanes|=c),i===h)break;i=i.return}}function Zl(i,c){sf=i,y0=Kl=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&c)!==0&&(Zn=!0),i.firstContext=null)}function Ea(i){var c=i._currentValue;if(y0!==i)if(i={context:i,memoizedValue:c,next:null},Kl===null){if(sf===null)throw Error(r(308));Kl=i,sf.dependencies={lanes:0,firstContext:i}}else Kl=Kl.next=i;return c}var Io=null;function k0(i){Io===null?Io=[i]:Io.push(i)}function Hg(i,c,h,x){var k=c.interleaved;return k===null?(h.next=h,k0(c)):(h.next=k.next,k.next=h),c.interleaved=h,Qi(i,x)}function Qi(i,c){i.lanes|=c;var h=i.alternate;for(h!==null&&(h.lanes|=c),h=i,i=i.return;i!==null;)i.childLanes|=c,h=i.alternate,h!==null&&(h.childLanes|=c),h=i,i=i.return;return h.tag===3?h.stateNode:null}var zs=!1;function S0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vg(i,c){i=i.updateQueue,c.updateQueue===i&&(c.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function es(i,c){return{eventTime:i,lane:c,tag:0,payload:null,callback:null,next:null}}function Us(i,c,h){var x=i.updateQueue;if(x===null)return null;if(x=x.shared,(zt&2)!==0){var k=x.pending;return k===null?c.next=c:(c.next=k.next,k.next=c),x.pending=c,Qi(i,h)}return k=x.interleaved,k===null?(c.next=c,k0(x)):(c.next=k.next,k.next=c),x.interleaved=c,Qi(i,h)}function of(i,c,h){if(c=c.updateQueue,c!==null&&(c=c.shared,(h&4194240)!==0)){var x=c.lanes;x&=i.pendingLanes,h|=x,c.lanes=h,Ha(i,h)}}function Gg(i,c){var h=i.updateQueue,x=i.alternate;if(x!==null&&(x=x.updateQueue,h===x)){var k=null,C=null;if(h=h.firstBaseUpdate,h!==null){do{var V={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};C===null?k=C=V:C=C.next=V,h=h.next}while(h!==null);C===null?k=C=c:C=C.next=c}else k=C=c;h={baseState:x.baseState,firstBaseUpdate:k,lastBaseUpdate:C,shared:x.shared,effects:x.effects},i.updateQueue=h;return}i=h.lastBaseUpdate,i===null?h.firstBaseUpdate=c:i.next=c,h.lastBaseUpdate=c}function lf(i,c,h,x){var k=i.updateQueue;zs=!1;var C=k.firstBaseUpdate,V=k.lastBaseUpdate,me=k.shared.pending;if(me!==null){k.shared.pending=null;var ve=me,Pe=ve.next;ve.next=null,V===null?C=Pe:V.next=Pe,V=ve;var He=i.alternate;He!==null&&(He=He.updateQueue,me=He.lastBaseUpdate,me!==V&&(me===null?He.firstBaseUpdate=Pe:me.next=Pe,He.lastBaseUpdate=ve))}if(C!==null){var Ge=k.baseState;V=0,He=Pe=ve=null,me=C;do{var $e=me.lane,rt=me.eventTime;if((x&$e)===$e){He!==null&&(He=He.next={eventTime:rt,lane:0,tag:me.tag,payload:me.payload,callback:me.callback,next:null});e:{var it=i,ot=me;switch($e=c,rt=h,ot.tag){case 1:if(it=ot.payload,typeof it=="function"){Ge=it.call(rt,Ge,$e);break e}Ge=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=ot.payload,$e=typeof it=="function"?it.call(rt,Ge,$e):it,$e==null)break e;Ge=ie({},Ge,$e);break e;case 2:zs=!0}}me.callback!==null&&me.lane!==0&&(i.flags|=64,$e=k.effects,$e===null?k.effects=[me]:$e.push(me))}else rt={eventTime:rt,lane:$e,tag:me.tag,payload:me.payload,callback:me.callback,next:null},He===null?(Pe=He=rt,ve=Ge):He=He.next=rt,V|=$e;if(me=me.next,me===null){if(me=k.shared.pending,me===null)break;$e=me,me=$e.next,$e.next=null,k.lastBaseUpdate=$e,k.shared.pending=null}}while(!0);if(He===null&&(ve=Ge),k.baseState=ve,k.firstBaseUpdate=Pe,k.lastBaseUpdate=He,c=k.shared.interleaved,c!==null){k=c;do V|=k.lane,k=k.next;while(k!==c)}else C===null&&(k.shared.lanes=0);jo|=V,i.lanes=V,i.memoizedState=Ge}}function Kg(i,c,h){if(i=c.effects,c.effects=null,i!==null)for(c=0;c<i.length;c++){var x=i[c],k=x.callback;if(k!==null){if(x.callback=null,x=h,typeof k!="function")throw Error(r(191,k));k.call(x)}}}var uu={},bi=Ls(uu),du=Ls(uu),fu=Ls(uu);function Do(i){if(i===uu)throw Error(r(174));return i}function T0(i,c){switch(lr(fu,c),lr(du,i),lr(bi,uu),i=c.nodeType,i){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:sn(null,"");break;default:i=i===8?c.parentNode:c,c=i.namespaceURI||null,i=i.tagName,c=sn(c,i)}dr(bi),lr(bi,c)}function Yl(){dr(bi),dr(du),dr(fu)}function Zg(i){Do(fu.current);var c=Do(bi.current),h=sn(c,i.type);c!==h&&(lr(du,i),lr(bi,h))}function E0(i){du.current===i&&(dr(bi),dr(du))}var vr=Ls(0);function cf(i){for(var c=i;c!==null;){if(c.tag===13){var h=c.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||h.data==="$?"||h.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if((c.flags&128)!==0)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var C0=[];function A0(){for(var i=0;i<C0.length;i++)C0[i]._workInProgressVersionPrimary=null;C0.length=0}var uf=H.ReactCurrentDispatcher,N0=H.ReactCurrentBatchConfig,Fo=0,xr=null,Wr=null,qr=null,df=!1,hu=!1,mu=0,tk=0;function yn(){throw Error(r(321))}function P0(i,c){if(c===null)return!1;for(var h=0;h<c.length&&h<i.length;h++)if(!sa(i[h],c[h]))return!1;return!0}function I0(i,c,h,x,k,C){if(Fo=C,xr=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,uf.current=i===null||i.memoizedState===null?ik:sk,i=h(x,k),hu){C=0;do{if(hu=!1,mu=0,25<=C)throw Error(r(301));C+=1,qr=Wr=null,c.updateQueue=null,uf.current=ok,i=h(x,k)}while(hu)}if(uf.current=mf,c=Wr!==null&&Wr.next!==null,Fo=0,qr=Wr=xr=null,df=!1,c)throw Error(r(300));return i}function D0(){var i=mu!==0;return mu=0,i}function ki(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qr===null?xr.memoizedState=qr=i:qr=qr.next=i,qr}function Ca(){if(Wr===null){var i=xr.alternate;i=i!==null?i.memoizedState:null}else i=Wr.next;var c=qr===null?xr.memoizedState:qr.next;if(c!==null)qr=c,Wr=i;else{if(i===null)throw Error(r(310));Wr=i,i={memoizedState:Wr.memoizedState,baseState:Wr.baseState,baseQueue:Wr.baseQueue,queue:Wr.queue,next:null},qr===null?xr.memoizedState=qr=i:qr=qr.next=i}return qr}function pu(i,c){return typeof c=="function"?c(i):c}function F0(i){var c=Ca(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var x=Wr,k=x.baseQueue,C=h.pending;if(C!==null){if(k!==null){var V=k.next;k.next=C.next,C.next=V}x.baseQueue=k=C,h.pending=null}if(k!==null){C=k.next,x=x.baseState;var me=V=null,ve=null,Pe=C;do{var He=Pe.lane;if((Fo&He)===He)ve!==null&&(ve=ve.next={lane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),x=Pe.hasEagerState?Pe.eagerState:i(x,Pe.action);else{var Ge={lane:He,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null};ve===null?(me=ve=Ge,V=x):ve=ve.next=Ge,xr.lanes|=He,jo|=He}Pe=Pe.next}while(Pe!==null&&Pe!==C);ve===null?V=x:ve.next=me,sa(x,c.memoizedState)||(Zn=!0),c.memoizedState=x,c.baseState=V,c.baseQueue=ve,h.lastRenderedState=x}if(i=h.interleaved,i!==null){k=i;do C=k.lane,xr.lanes|=C,jo|=C,k=k.next;while(k!==i)}else k===null&&(h.lanes=0);return[c.memoizedState,h.dispatch]}function j0(i){var c=Ca(),h=c.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=i;var x=h.dispatch,k=h.pending,C=c.memoizedState;if(k!==null){h.pending=null;var V=k=k.next;do C=i(C,V.action),V=V.next;while(V!==k);sa(C,c.memoizedState)||(Zn=!0),c.memoizedState=C,c.baseQueue===null&&(c.baseState=C),h.lastRenderedState=C}return[C,x]}function Yg(){}function qg(i,c){var h=xr,x=Ca(),k=c(),C=!sa(x.memoizedState,k);if(C&&(x.memoizedState=k,Zn=!0),x=x.queue,O0(Qg.bind(null,h,x,i),[i]),x.getSnapshot!==c||C||qr!==null&&qr.memoizedState.tag&1){if(h.flags|=2048,gu(9,Jg.bind(null,h,x,k,c),void 0,null),Xr===null)throw Error(r(349));(Fo&30)!==0||Xg(h,c,k)}return k}function Xg(i,c,h){i.flags|=16384,i={getSnapshot:c,value:h},c=xr.updateQueue,c===null?(c={lastEffect:null,stores:null},xr.updateQueue=c,c.stores=[i]):(h=c.stores,h===null?c.stores=[i]:h.push(i))}function Jg(i,c,h,x){c.value=h,c.getSnapshot=x,ev(c)&&tv(i)}function Qg(i,c,h){return h(function(){ev(c)&&tv(i)})}function ev(i){var c=i.getSnapshot;i=i.value;try{var h=c();return!sa(i,h)}catch{return!0}}function tv(i){var c=Qi(i,1);c!==null&&Qa(c,i,1,-1)}function rv(i){var c=ki();return typeof i=="function"&&(i=i()),c.memoizedState=c.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pu,lastRenderedState:i},c.queue=i,i=i.dispatch=ak.bind(null,xr,i),[c.memoizedState,i]}function gu(i,c,h,x){return i={tag:i,create:c,destroy:h,deps:x,next:null},c=xr.updateQueue,c===null?(c={lastEffect:null,stores:null},xr.updateQueue=c,c.lastEffect=i.next=i):(h=c.lastEffect,h===null?c.lastEffect=i.next=i:(x=h.next,h.next=i,i.next=x,c.lastEffect=i)),i}function nv(){return Ca().memoizedState}function ff(i,c,h,x){var k=ki();xr.flags|=i,k.memoizedState=gu(1|c,h,void 0,x===void 0?null:x)}function hf(i,c,h,x){var k=Ca();x=x===void 0?null:x;var C=void 0;if(Wr!==null){var V=Wr.memoizedState;if(C=V.destroy,x!==null&&P0(x,V.deps)){k.memoizedState=gu(c,h,C,x);return}}xr.flags|=i,k.memoizedState=gu(1|c,h,C,x)}function av(i,c){return ff(8390656,8,i,c)}function O0(i,c){return hf(2048,8,i,c)}function iv(i,c){return hf(4,2,i,c)}function sv(i,c){return hf(4,4,i,c)}function ov(i,c){if(typeof c=="function")return i=i(),c(i),function(){c(null)};if(c!=null)return i=i(),c.current=i,function(){c.current=null}}function lv(i,c,h){return h=h!=null?h.concat([i]):null,hf(4,4,ov.bind(null,c,i),h)}function R0(){}function cv(i,c){var h=Ca();c=c===void 0?null:c;var x=h.memoizedState;return x!==null&&c!==null&&P0(c,x[1])?x[0]:(h.memoizedState=[i,c],i)}function uv(i,c){var h=Ca();c=c===void 0?null:c;var x=h.memoizedState;return x!==null&&c!==null&&P0(c,x[1])?x[0]:(i=i(),h.memoizedState=[i,c],i)}function dv(i,c,h){return(Fo&21)===0?(i.baseState&&(i.baseState=!1,Zn=!0),i.memoizedState=h):(sa(h,c)||(h=Ad(),xr.lanes|=h,jo|=h,i.baseState=!0),c)}function rk(i,c){var h=Rt;Rt=h!==0&&4>h?h:4,i(!0);var x=N0.transition;N0.transition={};try{i(!1),c()}finally{Rt=h,N0.transition=x}}function fv(){return Ca().memoizedState}function nk(i,c,h){var x=Vs(i);if(h={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null},hv(i))mv(c,h);else if(h=Hg(i,c,h,x),h!==null){var k=Ln();Qa(h,i,x,k),pv(h,c,x)}}function ak(i,c,h){var x=Vs(i),k={lane:x,action:h,hasEagerState:!1,eagerState:null,next:null};if(hv(i))mv(c,k);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=c.lastRenderedReducer,C!==null))try{var V=c.lastRenderedState,me=C(V,h);if(k.hasEagerState=!0,k.eagerState=me,sa(me,V)){var ve=c.interleaved;ve===null?(k.next=k,k0(c)):(k.next=ve.next,ve.next=k),c.interleaved=k;return}}catch{}finally{}h=Hg(i,c,k,x),h!==null&&(k=Ln(),Qa(h,i,x,k),pv(h,c,x))}}function hv(i){var c=i.alternate;return i===xr||c!==null&&c===xr}function mv(i,c){hu=df=!0;var h=i.pending;h===null?c.next=c:(c.next=h.next,h.next=c),i.pending=c}function pv(i,c,h){if((h&4194240)!==0){var x=c.lanes;x&=i.pendingLanes,h|=x,c.lanes=h,Ha(i,h)}}var mf={readContext:Ea,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useInsertionEffect:yn,useLayoutEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useMutableSource:yn,useSyncExternalStore:yn,useId:yn,unstable_isNewReconciler:!1},ik={readContext:Ea,useCallback:function(i,c){return ki().memoizedState=[i,c===void 0?null:c],i},useContext:Ea,useEffect:av,useImperativeHandle:function(i,c,h){return h=h!=null?h.concat([i]):null,ff(4194308,4,ov.bind(null,c,i),h)},useLayoutEffect:function(i,c){return ff(4194308,4,i,c)},useInsertionEffect:function(i,c){return ff(4,2,i,c)},useMemo:function(i,c){var h=ki();return c=c===void 0?null:c,i=i(),h.memoizedState=[i,c],i},useReducer:function(i,c,h){var x=ki();return c=h!==void 0?h(c):c,x.memoizedState=x.baseState=c,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:c},x.queue=i,i=i.dispatch=nk.bind(null,xr,i),[x.memoizedState,i]},useRef:function(i){var c=ki();return i={current:i},c.memoizedState=i},useState:rv,useDebugValue:R0,useDeferredValue:function(i){return ki().memoizedState=i},useTransition:function(){var i=rv(!1),c=i[0];return i=rk.bind(null,i[1]),ki().memoizedState=i,[c,i]},useMutableSource:function(){},useSyncExternalStore:function(i,c,h){var x=xr,k=ki();if(pr){if(h===void 0)throw Error(r(407));h=h()}else{if(h=c(),Xr===null)throw Error(r(349));(Fo&30)!==0||Xg(x,c,h)}k.memoizedState=h;var C={value:h,getSnapshot:c};return k.queue=C,av(Qg.bind(null,x,C,i),[i]),x.flags|=2048,gu(9,Jg.bind(null,x,C,h,c),void 0,null),h},useId:function(){var i=ki(),c=Xr.identifierPrefix;if(pr){var h=Ji,x=Xi;h=(x&~(1<<32-ft(x)-1)).toString(32)+h,c=":"+c+"R"+h,h=mu++,0<h&&(c+="H"+h.toString(32)),c+=":"}else h=tk++,c=":"+c+"r"+h.toString(32)+":";return i.memoizedState=c},unstable_isNewReconciler:!1},sk={readContext:Ea,useCallback:cv,useContext:Ea,useEffect:O0,useImperativeHandle:lv,useInsertionEffect:iv,useLayoutEffect:sv,useMemo:uv,useReducer:F0,useRef:nv,useState:function(){return F0(pu)},useDebugValue:R0,useDeferredValue:function(i){var c=Ca();return dv(c,Wr.memoizedState,i)},useTransition:function(){var i=F0(pu)[0],c=Ca().memoizedState;return[i,c]},useMutableSource:Yg,useSyncExternalStore:qg,useId:fv,unstable_isNewReconciler:!1},ok={readContext:Ea,useCallback:cv,useContext:Ea,useEffect:O0,useImperativeHandle:lv,useInsertionEffect:iv,useLayoutEffect:sv,useMemo:uv,useReducer:j0,useRef:nv,useState:function(){return j0(pu)},useDebugValue:R0,useDeferredValue:function(i){var c=Ca();return Wr===null?c.memoizedState=i:dv(c,Wr.memoizedState,i)},useTransition:function(){var i=j0(pu)[0],c=Ca().memoizedState;return[i,c]},useMutableSource:Yg,useSyncExternalStore:qg,useId:fv,unstable_isNewReconciler:!1};function qa(i,c){if(i&&i.defaultProps){c=ie({},c),i=i.defaultProps;for(var h in i)c[h]===void 0&&(c[h]=i[h]);return c}return c}function L0(i,c,h,x){c=i.memoizedState,h=h(x,c),h=h==null?c:ie({},c,h),i.memoizedState=h,i.lanes===0&&(i.updateQueue.baseState=h)}var pf={isMounted:function(i){return(i=i._reactInternals)?se(i)===i:!1},enqueueSetState:function(i,c,h){i=i._reactInternals;var x=Ln(),k=Vs(i),C=es(x,k);C.payload=c,h!=null&&(C.callback=h),c=Us(i,C,k),c!==null&&(Qa(c,i,k,x),of(c,i,k))},enqueueReplaceState:function(i,c,h){i=i._reactInternals;var x=Ln(),k=Vs(i),C=es(x,k);C.tag=1,C.payload=c,h!=null&&(C.callback=h),c=Us(i,C,k),c!==null&&(Qa(c,i,k,x),of(c,i,k))},enqueueForceUpdate:function(i,c){i=i._reactInternals;var h=Ln(),x=Vs(i),k=es(h,x);k.tag=2,c!=null&&(k.callback=c),c=Us(i,k,x),c!==null&&(Qa(c,i,x,h),of(c,i,x))}};function gv(i,c,h,x,k,C,V){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(x,C,V):c.prototype&&c.prototype.isPureReactComponent?!xi(h,x)||!xi(k,C):!0}function vv(i,c,h){var x=!1,k=Ms,C=c.contextType;return typeof C=="object"&&C!==null?C=Ea(C):(k=Kn(c)?Ao:xn.current,x=c.contextTypes,C=(x=x!=null)?$l(i,k):Ms),c=new c(h,C),i.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=pf,i.stateNode=c,c._reactInternals=i,x&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=k,i.__reactInternalMemoizedMaskedChildContext=C),c}function xv(i,c,h,x){i=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(h,x),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(h,x),c.state!==i&&pf.enqueueReplaceState(c,c.state,null)}function M0(i,c,h,x){var k=i.stateNode;k.props=h,k.state=i.memoizedState,k.refs={},S0(i);var C=c.contextType;typeof C=="object"&&C!==null?k.context=Ea(C):(C=Kn(c)?Ao:xn.current,k.context=$l(i,C)),k.state=i.memoizedState,C=c.getDerivedStateFromProps,typeof C=="function"&&(L0(i,c,C,h),k.state=i.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(c=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),c!==k.state&&pf.enqueueReplaceState(k,k.state,null),lf(i,h,k,x),k.state=i.memoizedState),typeof k.componentDidMount=="function"&&(i.flags|=4194308)}function ql(i,c){try{var h="",x=c;do h+=te(x),x=x.return;while(x);var k=h}catch(C){k=`
Error generating stack: `+C.message+`
`+C.stack}return{value:i,source:c,stack:k,digest:null}}function B0(i,c,h){return{value:i,source:null,stack:h??null,digest:c??null}}function z0(i,c){try{console.error(c.value)}catch(h){setTimeout(function(){throw h})}}var lk=typeof WeakMap=="function"?WeakMap:Map;function yv(i,c,h){h=es(-1,h),h.tag=3,h.payload={element:null};var x=c.value;return h.callback=function(){bf||(bf=!0,tm=x),z0(i,c)},h}function _v(i,c,h){h=es(-1,h),h.tag=3;var x=i.type.getDerivedStateFromError;if(typeof x=="function"){var k=c.value;h.payload=function(){return x(k)},h.callback=function(){z0(i,c)}}var C=i.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(h.callback=function(){z0(i,c),typeof x!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var V=c.stack;this.componentDidCatch(c.value,{componentStack:V!==null?V:""})}),h}function wv(i,c,h){var x=i.pingCache;if(x===null){x=i.pingCache=new lk;var k=new Set;x.set(c,k)}else k=x.get(c),k===void 0&&(k=new Set,x.set(c,k));k.has(h)||(k.add(h),i=bk.bind(null,i,c,h),c.then(i,i))}function bv(i){do{var c;if((c=i.tag===13)&&(c=i.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return i;i=i.return}while(i!==null);return null}function kv(i,c,h,x,k){return(i.mode&1)===0?(i===c?i.flags|=65536:(i.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(c=es(-1,1),c.tag=2,Us(h,c,1))),h.lanes|=1),i):(i.flags|=65536,i.lanes=k,i)}var ck=H.ReactCurrentOwner,Zn=!1;function Rn(i,c,h,x){c.child=i===null?Wg(c,null,h,x):Gl(c,i.child,h,x)}function Sv(i,c,h,x,k){h=h.render;var C=c.ref;return Zl(c,k),x=I0(i,c,h,x,C,k),h=D0(),i!==null&&!Zn?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~k,ts(i,c,k)):(pr&&h&&m0(c),c.flags|=1,Rn(i,c,x,k),c.child)}function Tv(i,c,h,x,k){if(i===null){var C=h.type;return typeof C=="function"&&!lm(C)&&C.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(c.tag=15,c.type=C,Ev(i,c,C,x,k)):(i=Af(h.type,null,x,c,c.mode,k),i.ref=c.ref,i.return=c,c.child=i)}if(C=i.child,(i.lanes&k)===0){var V=C.memoizedProps;if(h=h.compare,h=h!==null?h:xi,h(V,x)&&i.ref===c.ref)return ts(i,c,k)}return c.flags|=1,i=Ks(C,x),i.ref=c.ref,i.return=c,c.child=i}function Ev(i,c,h,x,k){if(i!==null){var C=i.memoizedProps;if(xi(C,x)&&i.ref===c.ref)if(Zn=!1,c.pendingProps=x=C,(i.lanes&k)!==0)(i.flags&131072)!==0&&(Zn=!0);else return c.lanes=i.lanes,ts(i,c,k)}return U0(i,c,h,x,k)}function Cv(i,c,h){var x=c.pendingProps,k=x.children,C=i!==null?i.memoizedState:null;if(x.mode==="hidden")if((c.mode&1)===0)c.memoizedState={baseLanes:0,cachePool:null,transitions:null},lr(Jl,ua),ua|=h;else{if((h&1073741824)===0)return i=C!==null?C.baseLanes|h:h,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:i,cachePool:null,transitions:null},c.updateQueue=null,lr(Jl,ua),ua|=i,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=C!==null?C.baseLanes:h,lr(Jl,ua),ua|=x}else C!==null?(x=C.baseLanes|h,c.memoizedState=null):x=h,lr(Jl,ua),ua|=x;return Rn(i,c,k,h),c.child}function Av(i,c){var h=c.ref;(i===null&&h!==null||i!==null&&i.ref!==h)&&(c.flags|=512,c.flags|=2097152)}function U0(i,c,h,x,k){var C=Kn(h)?Ao:xn.current;return C=$l(c,C),Zl(c,k),h=I0(i,c,h,x,C,k),x=D0(),i!==null&&!Zn?(c.updateQueue=i.updateQueue,c.flags&=-2053,i.lanes&=~k,ts(i,c,k)):(pr&&x&&m0(c),c.flags|=1,Rn(i,c,h,k),c.child)}function Nv(i,c,h,x,k){if(Kn(h)){var C=!0;Jd(c)}else C=!1;if(Zl(c,k),c.stateNode===null)vf(i,c),vv(c,h,x),M0(c,h,x,k),x=!0;else if(i===null){var V=c.stateNode,me=c.memoizedProps;V.props=me;var ve=V.context,Pe=h.contextType;typeof Pe=="object"&&Pe!==null?Pe=Ea(Pe):(Pe=Kn(h)?Ao:xn.current,Pe=$l(c,Pe));var He=h.getDerivedStateFromProps,Ge=typeof He=="function"||typeof V.getSnapshotBeforeUpdate=="function";Ge||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(me!==x||ve!==Pe)&&xv(c,V,x,Pe),zs=!1;var $e=c.memoizedState;V.state=$e,lf(c,x,V,k),ve=c.memoizedState,me!==x||$e!==ve||Gn.current||zs?(typeof He=="function"&&(L0(c,h,He,x),ve=c.memoizedState),(me=zs||gv(c,h,me,x,$e,ve,Pe))?(Ge||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount()),typeof V.componentDidMount=="function"&&(c.flags|=4194308)):(typeof V.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=x,c.memoizedState=ve),V.props=x,V.state=ve,V.context=Pe,x=me):(typeof V.componentDidMount=="function"&&(c.flags|=4194308),x=!1)}else{V=c.stateNode,Vg(i,c),me=c.memoizedProps,Pe=c.type===c.elementType?me:qa(c.type,me),V.props=Pe,Ge=c.pendingProps,$e=V.context,ve=h.contextType,typeof ve=="object"&&ve!==null?ve=Ea(ve):(ve=Kn(h)?Ao:xn.current,ve=$l(c,ve));var rt=h.getDerivedStateFromProps;(He=typeof rt=="function"||typeof V.getSnapshotBeforeUpdate=="function")||typeof V.UNSAFE_componentWillReceiveProps!="function"&&typeof V.componentWillReceiveProps!="function"||(me!==Ge||$e!==ve)&&xv(c,V,x,ve),zs=!1,$e=c.memoizedState,V.state=$e,lf(c,x,V,k);var it=c.memoizedState;me!==Ge||$e!==it||Gn.current||zs?(typeof rt=="function"&&(L0(c,h,rt,x),it=c.memoizedState),(Pe=zs||gv(c,h,Pe,x,$e,it,ve)||!1)?(He||typeof V.UNSAFE_componentWillUpdate!="function"&&typeof V.componentWillUpdate!="function"||(typeof V.componentWillUpdate=="function"&&V.componentWillUpdate(x,it,ve),typeof V.UNSAFE_componentWillUpdate=="function"&&V.UNSAFE_componentWillUpdate(x,it,ve)),typeof V.componentDidUpdate=="function"&&(c.flags|=4),typeof V.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof V.componentDidUpdate!="function"||me===i.memoizedProps&&$e===i.memoizedState||(c.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||me===i.memoizedProps&&$e===i.memoizedState||(c.flags|=1024),c.memoizedProps=x,c.memoizedState=it),V.props=x,V.state=it,V.context=ve,x=Pe):(typeof V.componentDidUpdate!="function"||me===i.memoizedProps&&$e===i.memoizedState||(c.flags|=4),typeof V.getSnapshotBeforeUpdate!="function"||me===i.memoizedProps&&$e===i.memoizedState||(c.flags|=1024),x=!1)}return $0(i,c,h,x,C,k)}function $0(i,c,h,x,k,C){Av(i,c);var V=(c.flags&128)!==0;if(!x&&!V)return k&&jg(c,h,!1),ts(i,c,C);x=c.stateNode,ck.current=c;var me=V&&typeof h.getDerivedStateFromError!="function"?null:x.render();return c.flags|=1,i!==null&&V?(c.child=Gl(c,i.child,null,C),c.child=Gl(c,null,me,C)):Rn(i,c,me,C),c.memoizedState=x.state,k&&jg(c,h,!0),c.child}function Pv(i){var c=i.stateNode;c.pendingContext?Dg(i,c.pendingContext,c.pendingContext!==c.context):c.context&&Dg(i,c.context,!1),T0(i,c.containerInfo)}function Iv(i,c,h,x,k){return Vl(),x0(k),c.flags|=256,Rn(i,c,h,x),c.child}var W0={dehydrated:null,treeContext:null,retryLane:0};function H0(i){return{baseLanes:i,cachePool:null,transitions:null}}function Dv(i,c,h){var x=c.pendingProps,k=vr.current,C=!1,V=(c.flags&128)!==0,me;if((me=V)||(me=i!==null&&i.memoizedState===null?!1:(k&2)!==0),me?(C=!0,c.flags&=-129):(i===null||i.memoizedState!==null)&&(k|=1),lr(vr,k&1),i===null)return v0(c),i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((c.mode&1)===0?c.lanes=1:i.data==="$!"?c.lanes=8:c.lanes=1073741824,null):(V=x.children,i=x.fallback,C?(x=c.mode,C=c.child,V={mode:"hidden",children:V},(x&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=V):C=Nf(V,x,0,null),i=Mo(i,x,h,null),C.return=c,i.return=c,C.sibling=i,c.child=C,c.child.memoizedState=H0(h),c.memoizedState=W0,i):V0(c,V));if(k=i.memoizedState,k!==null&&(me=k.dehydrated,me!==null))return uk(i,c,V,x,me,k,h);if(C){C=x.fallback,V=c.mode,k=i.child,me=k.sibling;var ve={mode:"hidden",children:x.children};return(V&1)===0&&c.child!==k?(x=c.child,x.childLanes=0,x.pendingProps=ve,c.deletions=null):(x=Ks(k,ve),x.subtreeFlags=k.subtreeFlags&14680064),me!==null?C=Ks(me,C):(C=Mo(C,V,h,null),C.flags|=2),C.return=c,x.return=c,x.sibling=C,c.child=x,x=C,C=c.child,V=i.child.memoizedState,V=V===null?H0(h):{baseLanes:V.baseLanes|h,cachePool:null,transitions:V.transitions},C.memoizedState=V,C.childLanes=i.childLanes&~h,c.memoizedState=W0,x}return C=i.child,i=C.sibling,x=Ks(C,{mode:"visible",children:x.children}),(c.mode&1)===0&&(x.lanes=h),x.return=c,x.sibling=null,i!==null&&(h=c.deletions,h===null?(c.deletions=[i],c.flags|=16):h.push(i)),c.child=x,c.memoizedState=null,x}function V0(i,c){return c=Nf({mode:"visible",children:c},i.mode,0,null),c.return=i,i.child=c}function gf(i,c,h,x){return x!==null&&x0(x),Gl(c,i.child,null,h),i=V0(c,c.pendingProps.children),i.flags|=2,c.memoizedState=null,i}function uk(i,c,h,x,k,C,V){if(h)return c.flags&256?(c.flags&=-257,x=B0(Error(r(422))),gf(i,c,V,x)):c.memoizedState!==null?(c.child=i.child,c.flags|=128,null):(C=x.fallback,k=c.mode,x=Nf({mode:"visible",children:x.children},k,0,null),C=Mo(C,k,V,null),C.flags|=2,x.return=c,C.return=c,x.sibling=C,c.child=x,(c.mode&1)!==0&&Gl(c,i.child,null,V),c.child.memoizedState=H0(V),c.memoizedState=W0,C);if((c.mode&1)===0)return gf(i,c,V,null);if(k.data==="$!"){if(x=k.nextSibling&&k.nextSibling.dataset,x)var me=x.dgst;return x=me,C=Error(r(419)),x=B0(C,x,void 0),gf(i,c,V,x)}if(me=(V&i.childLanes)!==0,Zn||me){if(x=Xr,x!==null){switch(V&-V){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(x.suspendedLanes|V))!==0?0:k,k!==0&&k!==C.retryLane&&(C.retryLane=k,Qi(i,k),Qa(x,i,k,-1))}return om(),x=B0(Error(r(421))),gf(i,c,V,x)}return k.data==="$?"?(c.flags|=128,c.child=i.child,c=kk.bind(null,i),k._reactRetry=c,null):(i=C.treeContext,ca=wi(k.nextSibling),la=c,pr=!0,Ya=null,i!==null&&(Sa[Ta++]=Xi,Sa[Ta++]=Ji,Sa[Ta++]=No,Xi=i.id,Ji=i.overflow,No=c),c=V0(c,x.children),c.flags|=4096,c)}function Fv(i,c,h){i.lanes|=c;var x=i.alternate;x!==null&&(x.lanes|=c),b0(i.return,c,h)}function G0(i,c,h,x,k){var C=i.memoizedState;C===null?i.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:x,tail:h,tailMode:k}:(C.isBackwards=c,C.rendering=null,C.renderingStartTime=0,C.last=x,C.tail=h,C.tailMode=k)}function jv(i,c,h){var x=c.pendingProps,k=x.revealOrder,C=x.tail;if(Rn(i,c,x.children,h),x=vr.current,(x&2)!==0)x=x&1|2,c.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=c.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Fv(i,h,c);else if(i.tag===19)Fv(i,h,c);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===c)break e;for(;i.sibling===null;){if(i.return===null||i.return===c)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}x&=1}if(lr(vr,x),(c.mode&1)===0)c.memoizedState=null;else switch(k){case"forwards":for(h=c.child,k=null;h!==null;)i=h.alternate,i!==null&&cf(i)===null&&(k=h),h=h.sibling;h=k,h===null?(k=c.child,c.child=null):(k=h.sibling,h.sibling=null),G0(c,!1,k,h,C);break;case"backwards":for(h=null,k=c.child,c.child=null;k!==null;){if(i=k.alternate,i!==null&&cf(i)===null){c.child=k;break}i=k.sibling,k.sibling=h,h=k,k=i}G0(c,!0,h,null,C);break;case"together":G0(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function vf(i,c){(c.mode&1)===0&&i!==null&&(i.alternate=null,c.alternate=null,c.flags|=2)}function ts(i,c,h){if(i!==null&&(c.dependencies=i.dependencies),jo|=c.lanes,(h&c.childLanes)===0)return null;if(i!==null&&c.child!==i.child)throw Error(r(153));if(c.child!==null){for(i=c.child,h=Ks(i,i.pendingProps),c.child=h,h.return=c;i.sibling!==null;)i=i.sibling,h=h.sibling=Ks(i,i.pendingProps),h.return=c;h.sibling=null}return c.child}function dk(i,c,h){switch(c.tag){case 3:Pv(c),Vl();break;case 5:Zg(c);break;case 1:Kn(c.type)&&Jd(c);break;case 4:T0(c,c.stateNode.containerInfo);break;case 10:var x=c.type._context,k=c.memoizedProps.value;lr(af,x._currentValue),x._currentValue=k;break;case 13:if(x=c.memoizedState,x!==null)return x.dehydrated!==null?(lr(vr,vr.current&1),c.flags|=128,null):(h&c.child.childLanes)!==0?Dv(i,c,h):(lr(vr,vr.current&1),i=ts(i,c,h),i!==null?i.sibling:null);lr(vr,vr.current&1);break;case 19:if(x=(h&c.childLanes)!==0,(i.flags&128)!==0){if(x)return jv(i,c,h);c.flags|=128}if(k=c.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),lr(vr,vr.current),x)break;return null;case 22:case 23:return c.lanes=0,Cv(i,c,h)}return ts(i,c,h)}var Ov,K0,Rv,Lv;Ov=function(i,c){for(var h=c.child;h!==null;){if(h.tag===5||h.tag===6)i.appendChild(h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},K0=function(){},Rv=function(i,c,h,x){var k=i.memoizedProps;if(k!==x){i=c.stateNode,Do(bi.current);var C=null;switch(h){case"input":k=Je(i,k),x=Je(i,x),C=[];break;case"select":k=ie({},k,{value:void 0}),x=ie({},x,{value:void 0}),C=[];break;case"textarea":k=In(i,k),x=In(i,x),C=[];break;default:typeof k.onClick!="function"&&typeof x.onClick=="function"&&(i.onclick=Me)}ci(h,x);var V;h=null;for(Pe in k)if(!x.hasOwnProperty(Pe)&&k.hasOwnProperty(Pe)&&k[Pe]!=null)if(Pe==="style"){var me=k[Pe];for(V in me)me.hasOwnProperty(V)&&(h||(h={}),h[V]="")}else Pe!=="dangerouslySetInnerHTML"&&Pe!=="children"&&Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&Pe!=="autoFocus"&&(a.hasOwnProperty(Pe)?C||(C=[]):(C=C||[]).push(Pe,null));for(Pe in x){var ve=x[Pe];if(me=k?.[Pe],x.hasOwnProperty(Pe)&&ve!==me&&(ve!=null||me!=null))if(Pe==="style")if(me){for(V in me)!me.hasOwnProperty(V)||ve&&ve.hasOwnProperty(V)||(h||(h={}),h[V]="");for(V in ve)ve.hasOwnProperty(V)&&me[V]!==ve[V]&&(h||(h={}),h[V]=ve[V])}else h||(C||(C=[]),C.push(Pe,h)),h=ve;else Pe==="dangerouslySetInnerHTML"?(ve=ve?ve.__html:void 0,me=me?me.__html:void 0,ve!=null&&me!==ve&&(C=C||[]).push(Pe,ve)):Pe==="children"?typeof ve!="string"&&typeof ve!="number"||(C=C||[]).push(Pe,""+ve):Pe!=="suppressContentEditableWarning"&&Pe!=="suppressHydrationWarning"&&(a.hasOwnProperty(Pe)?(ve!=null&&Pe==="onScroll"&&tr("scroll",i),C||me===ve||(C=[])):(C=C||[]).push(Pe,ve))}h&&(C=C||[]).push("style",h);var Pe=C;(c.updateQueue=Pe)&&(c.flags|=4)}},Lv=function(i,c,h,x){h!==x&&(c.flags|=4)};function vu(i,c){if(!pr)switch(i.tailMode){case"hidden":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?i.tail=null:h.sibling=null;break;case"collapsed":h=i.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c||i.tail===null?i.tail=null:i.tail.sibling=null:x.sibling=null}}function _n(i){var c=i.alternate!==null&&i.alternate.child===i.child,h=0,x=0;if(c)for(var k=i.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags&14680064,x|=k.flags&14680064,k.return=i,k=k.sibling;else for(k=i.child;k!==null;)h|=k.lanes|k.childLanes,x|=k.subtreeFlags,x|=k.flags,k.return=i,k=k.sibling;return i.subtreeFlags|=x,i.childLanes=h,c}function fk(i,c,h){var x=c.pendingProps;switch(p0(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _n(c),null;case 1:return Kn(c.type)&&Xd(),_n(c),null;case 3:return x=c.stateNode,Yl(),dr(Gn),dr(xn),A0(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(i===null||i.child===null)&&(rf(c)?c.flags|=4:i===null||i.memoizedState.isDehydrated&&(c.flags&256)===0||(c.flags|=1024,Ya!==null&&(am(Ya),Ya=null))),K0(i,c),_n(c),null;case 5:E0(c);var k=Do(fu.current);if(h=c.type,i!==null&&c.stateNode!=null)Rv(i,c,h,x,k),i.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!x){if(c.stateNode===null)throw Error(r(166));return _n(c),null}if(i=Do(bi.current),rf(c)){x=c.stateNode,h=c.type;var C=c.memoizedProps;switch(x[ka]=c,x[Os]=C,i=(c.mode&1)!==0,h){case"dialog":tr("cancel",x),tr("close",x);break;case"iframe":case"object":case"embed":tr("load",x);break;case"video":case"audio":for(k=0;k<Ds.length;k++)tr(Ds[k],x);break;case"source":tr("error",x);break;case"img":case"image":case"link":tr("error",x),tr("load",x);break;case"details":tr("toggle",x);break;case"input":Ye(x,C),tr("invalid",x);break;case"select":x._wrapperState={wasMultiple:!!C.multiple},tr("invalid",x);break;case"textarea":zr(x,C),tr("invalid",x)}ci(h,C),k=null;for(var V in C)if(C.hasOwnProperty(V)){var me=C[V];V==="children"?typeof me=="string"?x.textContent!==me&&(C.suppressHydrationWarning!==!0&&Ne(x.textContent,me,i),k=["children",me]):typeof me=="number"&&x.textContent!==""+me&&(C.suppressHydrationWarning!==!0&&Ne(x.textContent,me,i),k=["children",""+me]):a.hasOwnProperty(V)&&me!=null&&V==="onScroll"&&tr("scroll",x)}switch(h){case"input":Oe(x),bt(x,C,!0);break;case"textarea":Oe(x),fn(x);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(x.onclick=Me)}x=k,c.updateQueue=x,x!==null&&(c.flags|=4)}else{V=k.nodeType===9?k:k.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Fr(h)),i==="http://www.w3.org/1999/xhtml"?h==="script"?(i=V.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof x.is=="string"?i=V.createElement(h,{is:x.is}):(i=V.createElement(h),h==="select"&&(V=i,x.multiple?V.multiple=!0:x.size&&(V.size=x.size))):i=V.createElementNS(i,h),i[ka]=c,i[Os]=x,Ov(i,c,!1,!1),c.stateNode=i;e:{switch(V=Wn(h,x),h){case"dialog":tr("cancel",i),tr("close",i),k=x;break;case"iframe":case"object":case"embed":tr("load",i),k=x;break;case"video":case"audio":for(k=0;k<Ds.length;k++)tr(Ds[k],i);k=x;break;case"source":tr("error",i),k=x;break;case"img":case"image":case"link":tr("error",i),tr("load",i),k=x;break;case"details":tr("toggle",i),k=x;break;case"input":Ye(i,x),k=Je(i,x),tr("invalid",i);break;case"option":k=x;break;case"select":i._wrapperState={wasMultiple:!!x.multiple},k=ie({},x,{value:void 0}),tr("invalid",i);break;case"textarea":zr(i,x),k=In(i,x),tr("invalid",i);break;default:k=x}ci(h,k),me=k;for(C in me)if(me.hasOwnProperty(C)){var ve=me[C];C==="style"?ct(i,ve):C==="dangerouslySetInnerHTML"?(ve=ve?ve.__html:void 0,ve!=null&&Cr(i,ve)):C==="children"?typeof ve=="string"?(h!=="textarea"||ve!=="")&&pt(i,ve):typeof ve=="number"&&pt(i,""+ve):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(a.hasOwnProperty(C)?ve!=null&&C==="onScroll"&&tr("scroll",i):ve!=null&&A(i,C,ve,V))}switch(h){case"input":Oe(i),bt(i,x,!1);break;case"textarea":Oe(i),fn(i);break;case"option":x.value!=null&&i.setAttribute("value",""+oe(x.value));break;case"select":i.multiple=!!x.multiple,C=x.value,C!=null?Kt(i,!!x.multiple,C,!1):x.defaultValue!=null&&Kt(i,!!x.multiple,x.defaultValue,!0);break;default:typeof k.onClick=="function"&&(i.onclick=Me)}switch(h){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}}x&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return _n(c),null;case 6:if(i&&c.stateNode!=null)Lv(i,c,i.memoizedProps,x);else{if(typeof x!="string"&&c.stateNode===null)throw Error(r(166));if(h=Do(fu.current),Do(bi.current),rf(c)){if(x=c.stateNode,h=c.memoizedProps,x[ka]=c,(C=x.nodeValue!==h)&&(i=la,i!==null))switch(i.tag){case 3:Ne(x.nodeValue,h,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Ne(x.nodeValue,h,(i.mode&1)!==0)}C&&(c.flags|=4)}else x=(h.nodeType===9?h:h.ownerDocument).createTextNode(x),x[ka]=c,c.stateNode=x}return _n(c),null;case 13:if(dr(vr),x=c.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(pr&&ca!==null&&(c.mode&1)!==0&&(c.flags&128)===0)zg(),Vl(),c.flags|=98560,C=!1;else if(C=rf(c),x!==null&&x.dehydrated!==null){if(i===null){if(!C)throw Error(r(318));if(C=c.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(r(317));C[ka]=c}else Vl(),(c.flags&128)===0&&(c.memoizedState=null),c.flags|=4;_n(c),C=!1}else Ya!==null&&(am(Ya),Ya=null),C=!0;if(!C)return c.flags&65536?c:null}return(c.flags&128)!==0?(c.lanes=h,c):(x=x!==null,x!==(i!==null&&i.memoizedState!==null)&&x&&(c.child.flags|=8192,(c.mode&1)!==0&&(i===null||(vr.current&1)!==0?Hr===0&&(Hr=3):om())),c.updateQueue!==null&&(c.flags|=4),_n(c),null);case 4:return Yl(),K0(i,c),i===null&&Fs(c.stateNode.containerInfo),_n(c),null;case 10:return w0(c.type._context),_n(c),null;case 17:return Kn(c.type)&&Xd(),_n(c),null;case 19:if(dr(vr),C=c.memoizedState,C===null)return _n(c),null;if(x=(c.flags&128)!==0,V=C.rendering,V===null)if(x)vu(C,!1);else{if(Hr!==0||i!==null&&(i.flags&128)!==0)for(i=c.child;i!==null;){if(V=cf(i),V!==null){for(c.flags|=128,vu(C,!1),x=V.updateQueue,x!==null&&(c.updateQueue=x,c.flags|=4),c.subtreeFlags=0,x=h,h=c.child;h!==null;)C=h,i=x,C.flags&=14680066,V=C.alternate,V===null?(C.childLanes=0,C.lanes=i,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=V.childLanes,C.lanes=V.lanes,C.child=V.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=V.memoizedProps,C.memoizedState=V.memoizedState,C.updateQueue=V.updateQueue,C.type=V.type,i=V.dependencies,C.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),h=h.sibling;return lr(vr,vr.current&1|2),c.child}i=i.sibling}C.tail!==null&&Ue()>Ql&&(c.flags|=128,x=!0,vu(C,!1),c.lanes=4194304)}else{if(!x)if(i=cf(V),i!==null){if(c.flags|=128,x=!0,h=i.updateQueue,h!==null&&(c.updateQueue=h,c.flags|=4),vu(C,!0),C.tail===null&&C.tailMode==="hidden"&&!V.alternate&&!pr)return _n(c),null}else 2*Ue()-C.renderingStartTime>Ql&&h!==1073741824&&(c.flags|=128,x=!0,vu(C,!1),c.lanes=4194304);C.isBackwards?(V.sibling=c.child,c.child=V):(h=C.last,h!==null?h.sibling=V:c.child=V,C.last=V)}return C.tail!==null?(c=C.tail,C.rendering=c,C.tail=c.sibling,C.renderingStartTime=Ue(),c.sibling=null,h=vr.current,lr(vr,x?h&1|2:h&1),c):(_n(c),null);case 22:case 23:return sm(),x=c.memoizedState!==null,i!==null&&i.memoizedState!==null!==x&&(c.flags|=8192),x&&(c.mode&1)!==0?(ua&1073741824)!==0&&(_n(c),c.subtreeFlags&6&&(c.flags|=8192)):_n(c),null;case 24:return null;case 25:return null}throw Error(r(156,c.tag))}function hk(i,c){switch(p0(c),c.tag){case 1:return Kn(c.type)&&Xd(),i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 3:return Yl(),dr(Gn),dr(xn),A0(),i=c.flags,(i&65536)!==0&&(i&128)===0?(c.flags=i&-65537|128,c):null;case 5:return E0(c),null;case 13:if(dr(vr),i=c.memoizedState,i!==null&&i.dehydrated!==null){if(c.alternate===null)throw Error(r(340));Vl()}return i=c.flags,i&65536?(c.flags=i&-65537|128,c):null;case 19:return dr(vr),null;case 4:return Yl(),null;case 10:return w0(c.type._context),null;case 22:case 23:return sm(),null;case 24:return null;default:return null}}var xf=!1,wn=!1,mk=typeof WeakSet=="function"?WeakSet:Set,at=null;function Xl(i,c){var h=i.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(x){wr(i,c,x)}else h.current=null}function Z0(i,c,h){try{h()}catch(x){wr(i,c,x)}}var Mv=!1;function pk(i,c){if(tt=_o,i=eu(),tu(i)){if("selectionStart"in i)var h={start:i.selectionStart,end:i.selectionEnd};else e:{h=(h=i.ownerDocument)&&h.defaultView||window;var x=h.getSelection&&h.getSelection();if(x&&x.rangeCount!==0){h=x.anchorNode;var k=x.anchorOffset,C=x.focusNode;x=x.focusOffset;try{h.nodeType,C.nodeType}catch{h=null;break e}var V=0,me=-1,ve=-1,Pe=0,He=0,Ge=i,$e=null;t:for(;;){for(var rt;Ge!==h||k!==0&&Ge.nodeType!==3||(me=V+k),Ge!==C||x!==0&&Ge.nodeType!==3||(ve=V+x),Ge.nodeType===3&&(V+=Ge.nodeValue.length),(rt=Ge.firstChild)!==null;)$e=Ge,Ge=rt;for(;;){if(Ge===i)break t;if($e===h&&++Pe===k&&(me=V),$e===C&&++He===x&&(ve=V),(rt=Ge.nextSibling)!==null)break;Ge=$e,$e=Ge.parentNode}Ge=rt}h=me===-1||ve===-1?null:{start:me,end:ve}}else h=null}h=h||{start:0,end:0}}else h=null;for(mt={focusedElem:i,selectionRange:h},_o=!1,at=c;at!==null;)if(c=at,i=c.child,(c.subtreeFlags&1028)!==0&&i!==null)i.return=c,at=i;else for(;at!==null;){c=at;try{var it=c.alternate;if((c.flags&1024)!==0)switch(c.tag){case 0:case 11:case 15:break;case 1:if(it!==null){var ot=it.memoizedProps,Pr=it.memoizedState,Te=c.stateNode,we=Te.getSnapshotBeforeUpdate(c.elementType===c.type?ot:qa(c.type,ot),Pr);Te.__reactInternalSnapshotBeforeUpdate=we}break;case 3:var Ae=c.stateNode.containerInfo;Ae.nodeType===1?Ae.textContent="":Ae.nodeType===9&&Ae.documentElement&&Ae.removeChild(Ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(qe){wr(c,c.return,qe)}if(i=c.sibling,i!==null){i.return=c.return,at=i;break}at=c.return}return it=Mv,Mv=!1,it}function xu(i,c,h){var x=c.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var k=x=x.next;do{if((k.tag&i)===i){var C=k.destroy;k.destroy=void 0,C!==void 0&&Z0(c,h,C)}k=k.next}while(k!==x)}}function yf(i,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var h=c=c.next;do{if((h.tag&i)===i){var x=h.create;h.destroy=x()}h=h.next}while(h!==c)}}function Y0(i){var c=i.ref;if(c!==null){var h=i.stateNode;switch(i.tag){case 5:i=h;break;default:i=h}typeof c=="function"?c(i):c.current=i}}function Bv(i){var c=i.alternate;c!==null&&(i.alternate=null,Bv(c)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(c=i.stateNode,c!==null&&(delete c[ka],delete c[Os],delete c[Rs],delete c[u0],delete c[d0])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function zv(i){return i.tag===5||i.tag===3||i.tag===4}function Uv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||zv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function q0(i,c,h){var x=i.tag;if(x===5||x===6)i=i.stateNode,c?h.nodeType===8?h.parentNode.insertBefore(i,c):h.insertBefore(i,c):(h.nodeType===8?(c=h.parentNode,c.insertBefore(i,h)):(c=h,c.appendChild(i)),h=h._reactRootContainer,h!=null||c.onclick!==null||(c.onclick=Me));else if(x!==4&&(i=i.child,i!==null))for(q0(i,c,h),i=i.sibling;i!==null;)q0(i,c,h),i=i.sibling}function X0(i,c,h){var x=i.tag;if(x===5||x===6)i=i.stateNode,c?h.insertBefore(i,c):h.appendChild(i);else if(x!==4&&(i=i.child,i!==null))for(X0(i,c,h),i=i.sibling;i!==null;)X0(i,c,h),i=i.sibling}var on=null,Xa=!1;function $s(i,c,h){for(h=h.child;h!==null;)$v(i,c,h),h=h.sibling}function $v(i,c,h){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Dn,h)}catch{}switch(h.tag){case 5:wn||Xl(h,c);case 6:var x=on,k=Xa;on=null,$s(i,c,h),on=x,Xa=k,on!==null&&(Xa?(i=on,h=h.stateNode,i.nodeType===8?i.parentNode.removeChild(h):i.removeChild(h)):on.removeChild(h.stateNode));break;case 18:on!==null&&(Xa?(i=on,h=h.stateNode,i.nodeType===8?lu(i.parentNode,h):i.nodeType===1&&lu(i,h),na(i)):lu(on,h.stateNode));break;case 4:x=on,k=Xa,on=h.stateNode.containerInfo,Xa=!0,$s(i,c,h),on=x,Xa=k;break;case 0:case 11:case 14:case 15:if(!wn&&(x=h.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){k=x=x.next;do{var C=k,V=C.destroy;C=C.tag,V!==void 0&&((C&2)!==0||(C&4)!==0)&&Z0(h,c,V),k=k.next}while(k!==x)}$s(i,c,h);break;case 1:if(!wn&&(Xl(h,c),x=h.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=h.memoizedProps,x.state=h.memoizedState,x.componentWillUnmount()}catch(me){wr(h,c,me)}$s(i,c,h);break;case 21:$s(i,c,h);break;case 22:h.mode&1?(wn=(x=wn)||h.memoizedState!==null,$s(i,c,h),wn=x):$s(i,c,h);break;default:$s(i,c,h)}}function Wv(i){var c=i.updateQueue;if(c!==null){i.updateQueue=null;var h=i.stateNode;h===null&&(h=i.stateNode=new mk),c.forEach(function(x){var k=Sk.bind(null,i,x);h.has(x)||(h.add(x),x.then(k,k))})}}function Ja(i,c){var h=c.deletions;if(h!==null)for(var x=0;x<h.length;x++){var k=h[x];try{var C=i,V=c,me=V;e:for(;me!==null;){switch(me.tag){case 5:on=me.stateNode,Xa=!1;break e;case 3:on=me.stateNode.containerInfo,Xa=!0;break e;case 4:on=me.stateNode.containerInfo,Xa=!0;break e}me=me.return}if(on===null)throw Error(r(160));$v(C,V,k),on=null,Xa=!1;var ve=k.alternate;ve!==null&&(ve.return=null),k.return=null}catch(Pe){wr(k,c,Pe)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)Hv(c,i),c=c.sibling}function Hv(i,c){var h=i.alternate,x=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Ja(c,i),Si(i),x&4){try{xu(3,i,i.return),yf(3,i)}catch(ot){wr(i,i.return,ot)}try{xu(5,i,i.return)}catch(ot){wr(i,i.return,ot)}}break;case 1:Ja(c,i),Si(i),x&512&&h!==null&&Xl(h,h.return);break;case 5:if(Ja(c,i),Si(i),x&512&&h!==null&&Xl(h,h.return),i.flags&32){var k=i.stateNode;try{pt(k,"")}catch(ot){wr(i,i.return,ot)}}if(x&4&&(k=i.stateNode,k!=null)){var C=i.memoizedProps,V=h!==null?h.memoizedProps:C,me=i.type,ve=i.updateQueue;if(i.updateQueue=null,ve!==null)try{me==="input"&&C.type==="radio"&&C.name!=null&&nt(k,C),Wn(me,V);var Pe=Wn(me,C);for(V=0;V<ve.length;V+=2){var He=ve[V],Ge=ve[V+1];He==="style"?ct(k,Ge):He==="dangerouslySetInnerHTML"?Cr(k,Ge):He==="children"?pt(k,Ge):A(k,He,Ge,Pe)}switch(me){case"input":Be(k,C);break;case"textarea":Er(k,C);break;case"select":var $e=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!C.multiple;var rt=C.value;rt!=null?Kt(k,!!C.multiple,rt,!1):$e!==!!C.multiple&&(C.defaultValue!=null?Kt(k,!!C.multiple,C.defaultValue,!0):Kt(k,!!C.multiple,C.multiple?[]:"",!1))}k[Os]=C}catch(ot){wr(i,i.return,ot)}}break;case 6:if(Ja(c,i),Si(i),x&4){if(i.stateNode===null)throw Error(r(162));k=i.stateNode,C=i.memoizedProps;try{k.nodeValue=C}catch(ot){wr(i,i.return,ot)}}break;case 3:if(Ja(c,i),Si(i),x&4&&h!==null&&h.memoizedState.isDehydrated)try{na(c.containerInfo)}catch(ot){wr(i,i.return,ot)}break;case 4:Ja(c,i),Si(i);break;case 13:Ja(c,i),Si(i),k=i.child,k.flags&8192&&(C=k.memoizedState!==null,k.stateNode.isHidden=C,!C||k.alternate!==null&&k.alternate.memoizedState!==null||(em=Ue())),x&4&&Wv(i);break;case 22:if(He=h!==null&&h.memoizedState!==null,i.mode&1?(wn=(Pe=wn)||He,Ja(c,i),wn=Pe):Ja(c,i),Si(i),x&8192){if(Pe=i.memoizedState!==null,(i.stateNode.isHidden=Pe)&&!He&&(i.mode&1)!==0)for(at=i,He=i.child;He!==null;){for(Ge=at=He;at!==null;){switch($e=at,rt=$e.child,$e.tag){case 0:case 11:case 14:case 15:xu(4,$e,$e.return);break;case 1:Xl($e,$e.return);var it=$e.stateNode;if(typeof it.componentWillUnmount=="function"){x=$e,h=$e.return;try{c=x,it.props=c.memoizedProps,it.state=c.memoizedState,it.componentWillUnmount()}catch(ot){wr(x,h,ot)}}break;case 5:Xl($e,$e.return);break;case 22:if($e.memoizedState!==null){Kv(Ge);continue}}rt!==null?(rt.return=$e,at=rt):Kv(Ge)}He=He.sibling}e:for(He=null,Ge=i;;){if(Ge.tag===5){if(He===null){He=Ge;try{k=Ge.stateNode,Pe?(C=k.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(me=Ge.stateNode,ve=Ge.memoizedProps.style,V=ve!=null&&ve.hasOwnProperty("display")?ve.display:null,me.style.display=Zt("display",V))}catch(ot){wr(i,i.return,ot)}}}else if(Ge.tag===6){if(He===null)try{Ge.stateNode.nodeValue=Pe?"":Ge.memoizedProps}catch(ot){wr(i,i.return,ot)}}else if((Ge.tag!==22&&Ge.tag!==23||Ge.memoizedState===null||Ge===i)&&Ge.child!==null){Ge.child.return=Ge,Ge=Ge.child;continue}if(Ge===i)break e;for(;Ge.sibling===null;){if(Ge.return===null||Ge.return===i)break e;He===Ge&&(He=null),Ge=Ge.return}He===Ge&&(He=null),Ge.sibling.return=Ge.return,Ge=Ge.sibling}}break;case 19:Ja(c,i),Si(i),x&4&&Wv(i);break;case 21:break;default:Ja(c,i),Si(i)}}function Si(i){var c=i.flags;if(c&2){try{e:{for(var h=i.return;h!==null;){if(zv(h)){var x=h;break e}h=h.return}throw Error(r(160))}switch(x.tag){case 5:var k=x.stateNode;x.flags&32&&(pt(k,""),x.flags&=-33);var C=Uv(i);X0(i,C,k);break;case 3:case 4:var V=x.stateNode.containerInfo,me=Uv(i);q0(i,me,V);break;default:throw Error(r(161))}}catch(ve){wr(i,i.return,ve)}i.flags&=-3}c&4096&&(i.flags&=-4097)}function gk(i,c,h){at=i,Vv(i)}function Vv(i,c,h){for(var x=(i.mode&1)!==0;at!==null;){var k=at,C=k.child;if(k.tag===22&&x){var V=k.memoizedState!==null||xf;if(!V){var me=k.alternate,ve=me!==null&&me.memoizedState!==null||wn;me=xf;var Pe=wn;if(xf=V,(wn=ve)&&!Pe)for(at=k;at!==null;)V=at,ve=V.child,V.tag===22&&V.memoizedState!==null?Zv(k):ve!==null?(ve.return=V,at=ve):Zv(k);for(;C!==null;)at=C,Vv(C),C=C.sibling;at=k,xf=me,wn=Pe}Gv(i)}else(k.subtreeFlags&8772)!==0&&C!==null?(C.return=k,at=C):Gv(i)}}function Gv(i){for(;at!==null;){var c=at;if((c.flags&8772)!==0){var h=c.alternate;try{if((c.flags&8772)!==0)switch(c.tag){case 0:case 11:case 15:wn||yf(5,c);break;case 1:var x=c.stateNode;if(c.flags&4&&!wn)if(h===null)x.componentDidMount();else{var k=c.elementType===c.type?h.memoizedProps:qa(c.type,h.memoizedProps);x.componentDidUpdate(k,h.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var C=c.updateQueue;C!==null&&Kg(c,C,x);break;case 3:var V=c.updateQueue;if(V!==null){if(h=null,c.child!==null)switch(c.child.tag){case 5:h=c.child.stateNode;break;case 1:h=c.child.stateNode}Kg(c,V,h)}break;case 5:var me=c.stateNode;if(h===null&&c.flags&4){h=me;var ve=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":ve.autoFocus&&h.focus();break;case"img":ve.src&&(h.src=ve.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var Pe=c.alternate;if(Pe!==null){var He=Pe.memoizedState;if(He!==null){var Ge=He.dehydrated;Ge!==null&&na(Ge)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}wn||c.flags&512&&Y0(c)}catch($e){wr(c,c.return,$e)}}if(c===i){at=null;break}if(h=c.sibling,h!==null){h.return=c.return,at=h;break}at=c.return}}function Kv(i){for(;at!==null;){var c=at;if(c===i){at=null;break}var h=c.sibling;if(h!==null){h.return=c.return,at=h;break}at=c.return}}function Zv(i){for(;at!==null;){var c=at;try{switch(c.tag){case 0:case 11:case 15:var h=c.return;try{yf(4,c)}catch(ve){wr(c,h,ve)}break;case 1:var x=c.stateNode;if(typeof x.componentDidMount=="function"){var k=c.return;try{x.componentDidMount()}catch(ve){wr(c,k,ve)}}var C=c.return;try{Y0(c)}catch(ve){wr(c,C,ve)}break;case 5:var V=c.return;try{Y0(c)}catch(ve){wr(c,V,ve)}}}catch(ve){wr(c,c.return,ve)}if(c===i){at=null;break}var me=c.sibling;if(me!==null){me.return=c.return,at=me;break}at=c.return}}var vk=Math.ceil,_f=H.ReactCurrentDispatcher,J0=H.ReactCurrentOwner,Aa=H.ReactCurrentBatchConfig,zt=0,Xr=null,Or=null,ln=0,ua=0,Jl=Ls(0),Hr=0,yu=null,jo=0,wf=0,Q0=0,_u=null,Yn=null,em=0,Ql=1/0,rs=null,bf=!1,tm=null,Ws=null,kf=!1,Hs=null,Sf=0,wu=0,rm=null,Tf=-1,Ef=0;function Ln(){return(zt&6)!==0?Ue():Tf!==-1?Tf:Tf=Ue()}function Vs(i){return(i.mode&1)===0?1:(zt&2)!==0&&ln!==0?ln&-ln:ek.transition!==null?(Ef===0&&(Ef=Ad()),Ef):(i=Rt,i!==0||(i=window.event,i=i===void 0?16:Ft(i.type)),i)}function Qa(i,c,h,x){if(50<wu)throw wu=0,rm=null,Error(r(185));ta(i,h,x),((zt&2)===0||i!==Xr)&&(i===Xr&&((zt&2)===0&&(wf|=h),Hr===4&&Gs(i,ln)),qn(i,x),h===1&&zt===0&&(c.mode&1)===0&&(Ql=Ue()+500,Qd&&Bs()))}function qn(i,c){var h=i.callbackNode;yl(i,c);var x=or(i,i===Xr?ln:0);if(x===0)h!==null&&Ke(h),i.callbackNode=null,i.callbackPriority=0;else if(c=x&-x,i.callbackPriority!==c){if(h!=null&&Ke(h),c===1)i.tag===0?Qb(qv.bind(null,i)):Og(qv.bind(null,i)),vn(function(){(zt&6)===0&&Bs()}),h=null;else{switch(_s(x)){case 1:h=$t;break;case 4:h=Wt;break;case 16:h=ar;break;case 536870912:h=Yr;break;default:h=ar}h=ax(h,Yv.bind(null,i))}i.callbackPriority=c,i.callbackNode=h}}function Yv(i,c){if(Tf=-1,Ef=0,(zt&6)!==0)throw Error(r(327));var h=i.callbackNode;if(ec()&&i.callbackNode!==h)return null;var x=or(i,i===Xr?ln:0);if(x===0)return null;if((x&30)!==0||(x&i.expiredLanes)!==0||c)c=Cf(i,x);else{c=x;var k=zt;zt|=2;var C=Jv();(Xr!==i||ln!==c)&&(rs=null,Ql=Ue()+500,Ro(i,c));do try{_k();break}catch(me){Xv(i,me)}while(!0);_0(),_f.current=C,zt=k,Or!==null?c=0:(Xr=null,ln=0,c=Hr)}if(c!==0){if(c===2&&(k=pn(i),k!==0&&(x=k,c=nm(i,k))),c===1)throw h=yu,Ro(i,0),Gs(i,x),qn(i,Ue()),h;if(c===6)Gs(i,x);else{if(k=i.current.alternate,(x&30)===0&&!xk(k)&&(c=Cf(i,x),c===2&&(C=pn(i),C!==0&&(x=C,c=nm(i,C))),c===1))throw h=yu,Ro(i,0),Gs(i,x),qn(i,Ue()),h;switch(i.finishedWork=k,i.finishedLanes=x,c){case 0:case 1:throw Error(r(345));case 2:Lo(i,Yn,rs);break;case 3:if(Gs(i,x),(x&130023424)===x&&(c=em+500-Ue(),10<c)){if(or(i,0)!==0)break;if(k=i.suspendedLanes,(k&x)!==x){Ln(),i.pingedLanes|=i.suspendedLanes&k;break}i.timeoutHandle=$r(Lo.bind(null,i,Yn,rs),c);break}Lo(i,Yn,rs);break;case 4:if(Gs(i,x),(x&4194240)===x)break;for(c=i.eventTimes,k=-1;0<x;){var V=31-ft(x);C=1<<V,V=c[V],V>k&&(k=V),x&=~C}if(x=k,x=Ue()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*vk(x/1960))-x,10<x){i.timeoutHandle=$r(Lo.bind(null,i,Yn,rs),x);break}Lo(i,Yn,rs);break;case 5:Lo(i,Yn,rs);break;default:throw Error(r(329))}}}return qn(i,Ue()),i.callbackNode===h?Yv.bind(null,i):null}function nm(i,c){var h=_u;return i.current.memoizedState.isDehydrated&&(Ro(i,c).flags|=256),i=Cf(i,c),i!==2&&(c=Yn,Yn=h,c!==null&&am(c)),i}function am(i){Yn===null?Yn=i:Yn.push.apply(Yn,i)}function xk(i){for(var c=i;;){if(c.flags&16384){var h=c.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var x=0;x<h.length;x++){var k=h[x],C=k.getSnapshot;k=k.value;try{if(!sa(C(),k))return!1}catch{return!1}}}if(h=c.child,c.subtreeFlags&16384&&h!==null)h.return=c,c=h;else{if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function Gs(i,c){for(c&=~Q0,c&=~wf,i.suspendedLanes|=c,i.pingedLanes&=~c,i=i.expirationTimes;0<c;){var h=31-ft(c),x=1<<h;i[h]=-1,c&=~x}}function qv(i){if((zt&6)!==0)throw Error(r(327));ec();var c=or(i,0);if((c&1)===0)return qn(i,Ue()),null;var h=Cf(i,c);if(i.tag!==0&&h===2){var x=pn(i);x!==0&&(c=x,h=nm(i,x))}if(h===1)throw h=yu,Ro(i,0),Gs(i,c),qn(i,Ue()),h;if(h===6)throw Error(r(345));return i.finishedWork=i.current.alternate,i.finishedLanes=c,Lo(i,Yn,rs),qn(i,Ue()),null}function im(i,c){var h=zt;zt|=1;try{return i(c)}finally{zt=h,zt===0&&(Ql=Ue()+500,Qd&&Bs())}}function Oo(i){Hs!==null&&Hs.tag===0&&(zt&6)===0&&ec();var c=zt;zt|=1;var h=Aa.transition,x=Rt;try{if(Aa.transition=null,Rt=1,i)return i()}finally{Rt=x,Aa.transition=h,zt=c,(zt&6)===0&&Bs()}}function sm(){ua=Jl.current,dr(Jl)}function Ro(i,c){i.finishedWork=null,i.finishedLanes=0;var h=i.timeoutHandle;if(h!==-1&&(i.timeoutHandle=-1,jr(h)),Or!==null)for(h=Or.return;h!==null;){var x=h;switch(p0(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&Xd();break;case 3:Yl(),dr(Gn),dr(xn),A0();break;case 5:E0(x);break;case 4:Yl();break;case 13:dr(vr);break;case 19:dr(vr);break;case 10:w0(x.type._context);break;case 22:case 23:sm()}h=h.return}if(Xr=i,Or=i=Ks(i.current,null),ln=ua=c,Hr=0,yu=null,Q0=wf=jo=0,Yn=_u=null,Io!==null){for(c=0;c<Io.length;c++)if(h=Io[c],x=h.interleaved,x!==null){h.interleaved=null;var k=x.next,C=h.pending;if(C!==null){var V=C.next;C.next=k,x.next=V}h.pending=x}Io=null}return i}function Xv(i,c){do{var h=Or;try{if(_0(),uf.current=mf,df){for(var x=xr.memoizedState;x!==null;){var k=x.queue;k!==null&&(k.pending=null),x=x.next}df=!1}if(Fo=0,qr=Wr=xr=null,hu=!1,mu=0,J0.current=null,h===null||h.return===null){Hr=1,yu=c,Or=null;break}e:{var C=i,V=h.return,me=h,ve=c;if(c=ln,me.flags|=32768,ve!==null&&typeof ve=="object"&&typeof ve.then=="function"){var Pe=ve,He=me,Ge=He.tag;if((He.mode&1)===0&&(Ge===0||Ge===11||Ge===15)){var $e=He.alternate;$e?(He.updateQueue=$e.updateQueue,He.memoizedState=$e.memoizedState,He.lanes=$e.lanes):(He.updateQueue=null,He.memoizedState=null)}var rt=bv(V);if(rt!==null){rt.flags&=-257,kv(rt,V,me,C,c),rt.mode&1&&wv(C,Pe,c),c=rt,ve=Pe;var it=c.updateQueue;if(it===null){var ot=new Set;ot.add(ve),c.updateQueue=ot}else it.add(ve);break e}else{if((c&1)===0){wv(C,Pe,c),om();break e}ve=Error(r(426))}}else if(pr&&me.mode&1){var Pr=bv(V);if(Pr!==null){(Pr.flags&65536)===0&&(Pr.flags|=256),kv(Pr,V,me,C,c),x0(ql(ve,me));break e}}C=ve=ql(ve,me),Hr!==4&&(Hr=2),_u===null?_u=[C]:_u.push(C),C=V;do{switch(C.tag){case 3:C.flags|=65536,c&=-c,C.lanes|=c;var Te=yv(C,ve,c);Gg(C,Te);break e;case 1:me=ve;var we=C.type,Ae=C.stateNode;if((C.flags&128)===0&&(typeof we.getDerivedStateFromError=="function"||Ae!==null&&typeof Ae.componentDidCatch=="function"&&(Ws===null||!Ws.has(Ae)))){C.flags|=65536,c&=-c,C.lanes|=c;var qe=_v(C,me,c);Gg(C,qe);break e}}C=C.return}while(C!==null)}ex(h)}catch(lt){c=lt,Or===h&&h!==null&&(Or=h=h.return);continue}break}while(!0)}function Jv(){var i=_f.current;return _f.current=mf,i===null?mf:i}function om(){(Hr===0||Hr===3||Hr===2)&&(Hr=4),Xr===null||(jo&268435455)===0&&(wf&268435455)===0||Gs(Xr,ln)}function Cf(i,c){var h=zt;zt|=2;var x=Jv();(Xr!==i||ln!==c)&&(rs=null,Ro(i,c));do try{yk();break}catch(k){Xv(i,k)}while(!0);if(_0(),zt=h,_f.current=x,Or!==null)throw Error(r(261));return Xr=null,ln=0,Hr}function yk(){for(;Or!==null;)Qv(Or)}function _k(){for(;Or!==null&&!et();)Qv(Or)}function Qv(i){var c=nx(i.alternate,i,ua);i.memoizedProps=i.pendingProps,c===null?ex(i):Or=c,J0.current=null}function ex(i){var c=i;do{var h=c.alternate;if(i=c.return,(c.flags&32768)===0){if(h=fk(h,c,ua),h!==null){Or=h;return}}else{if(h=hk(h,c),h!==null){h.flags&=32767,Or=h;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Hr=6,Or=null;return}}if(c=c.sibling,c!==null){Or=c;return}Or=c=i}while(c!==null);Hr===0&&(Hr=5)}function Lo(i,c,h){var x=Rt,k=Aa.transition;try{Aa.transition=null,Rt=1,wk(i,c,h,x)}finally{Aa.transition=k,Rt=x}return null}function wk(i,c,h,x){do ec();while(Hs!==null);if((zt&6)!==0)throw Error(r(327));h=i.finishedWork;var k=i.finishedLanes;if(h===null)return null;if(i.finishedWork=null,i.finishedLanes=0,h===i.current)throw Error(r(177));i.callbackNode=null,i.callbackPriority=0;var C=h.lanes|h.childLanes;if(_r(i,C),i===Xr&&(Or=Xr=null,ln=0),(h.subtreeFlags&2064)===0&&(h.flags&2064)===0||kf||(kf=!0,ax(ar,function(){return ec(),null})),C=(h.flags&15990)!==0,(h.subtreeFlags&15990)!==0||C){C=Aa.transition,Aa.transition=null;var V=Rt;Rt=1;var me=zt;zt|=4,J0.current=null,pk(i,h),Hv(h,i),wa(mt),_o=!!tt,mt=tt=null,i.current=h,gk(h),We(),zt=me,Rt=V,Aa.transition=C}else i.current=h;if(kf&&(kf=!1,Hs=i,Sf=k),C=i.pendingLanes,C===0&&(Ws=null),$a(h.stateNode),qn(i,Ue()),c!==null)for(x=i.onRecoverableError,h=0;h<c.length;h++)k=c[h],x(k.value,{componentStack:k.stack,digest:k.digest});if(bf)throw bf=!1,i=tm,tm=null,i;return(Sf&1)!==0&&i.tag!==0&&ec(),C=i.pendingLanes,(C&1)!==0?i===rm?wu++:(wu=0,rm=i):wu=0,Bs(),null}function ec(){if(Hs!==null){var i=_s(Sf),c=Aa.transition,h=Rt;try{if(Aa.transition=null,Rt=16>i?16:i,Hs===null)var x=!1;else{if(i=Hs,Hs=null,Sf=0,(zt&6)!==0)throw Error(r(331));var k=zt;for(zt|=4,at=i.current;at!==null;){var C=at,V=C.child;if((at.flags&16)!==0){var me=C.deletions;if(me!==null){for(var ve=0;ve<me.length;ve++){var Pe=me[ve];for(at=Pe;at!==null;){var He=at;switch(He.tag){case 0:case 11:case 15:xu(8,He,C)}var Ge=He.child;if(Ge!==null)Ge.return=He,at=Ge;else for(;at!==null;){He=at;var $e=He.sibling,rt=He.return;if(Bv(He),He===Pe){at=null;break}if($e!==null){$e.return=rt,at=$e;break}at=rt}}}var it=C.alternate;if(it!==null){var ot=it.child;if(ot!==null){it.child=null;do{var Pr=ot.sibling;ot.sibling=null,ot=Pr}while(ot!==null)}}at=C}}if((C.subtreeFlags&2064)!==0&&V!==null)V.return=C,at=V;else e:for(;at!==null;){if(C=at,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:xu(9,C,C.return)}var Te=C.sibling;if(Te!==null){Te.return=C.return,at=Te;break e}at=C.return}}var we=i.current;for(at=we;at!==null;){V=at;var Ae=V.child;if((V.subtreeFlags&2064)!==0&&Ae!==null)Ae.return=V,at=Ae;else e:for(V=we;at!==null;){if(me=at,(me.flags&2048)!==0)try{switch(me.tag){case 0:case 11:case 15:yf(9,me)}}catch(lt){wr(me,me.return,lt)}if(me===V){at=null;break e}var qe=me.sibling;if(qe!==null){qe.return=me.return,at=qe;break e}at=me.return}}if(zt=k,Bs(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Dn,i)}catch{}x=!0}return x}finally{Rt=h,Aa.transition=c}}return!1}function tx(i,c,h){c=ql(h,c),c=yv(i,c,1),i=Us(i,c,1),c=Ln(),i!==null&&(ta(i,1,c),qn(i,c))}function wr(i,c,h){if(i.tag===3)tx(i,i,h);else for(;c!==null;){if(c.tag===3){tx(c,i,h);break}else if(c.tag===1){var x=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Ws===null||!Ws.has(x))){i=ql(h,i),i=_v(c,i,1),c=Us(c,i,1),i=Ln(),c!==null&&(ta(c,1,i),qn(c,i));break}}c=c.return}}function bk(i,c,h){var x=i.pingCache;x!==null&&x.delete(c),c=Ln(),i.pingedLanes|=i.suspendedLanes&h,Xr===i&&(ln&h)===h&&(Hr===4||Hr===3&&(ln&130023424)===ln&&500>Ue()-em?Ro(i,0):Q0|=h),qn(i,c)}function rx(i,c){c===0&&((i.mode&1)===0?c=1:(c=xs,xs<<=1,(xs&130023424)===0&&(xs=4194304)));var h=Ln();i=Qi(i,c),i!==null&&(ta(i,c,h),qn(i,h))}function kk(i){var c=i.memoizedState,h=0;c!==null&&(h=c.retryLane),rx(i,h)}function Sk(i,c){var h=0;switch(i.tag){case 13:var x=i.stateNode,k=i.memoizedState;k!==null&&(h=k.retryLane);break;case 19:x=i.stateNode;break;default:throw Error(r(314))}x!==null&&x.delete(c),rx(i,h)}var nx;nx=function(i,c,h){if(i!==null)if(i.memoizedProps!==c.pendingProps||Gn.current)Zn=!0;else{if((i.lanes&h)===0&&(c.flags&128)===0)return Zn=!1,dk(i,c,h);Zn=(i.flags&131072)!==0}else Zn=!1,pr&&(c.flags&1048576)!==0&&Rg(c,tf,c.index);switch(c.lanes=0,c.tag){case 2:var x=c.type;vf(i,c),i=c.pendingProps;var k=$l(c,xn.current);Zl(c,h),k=I0(null,c,x,i,k,h);var C=D0();return c.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,Kn(x)?(C=!0,Jd(c)):C=!1,c.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,S0(c),k.updater=pf,c.stateNode=k,k._reactInternals=c,M0(c,x,i,h),c=$0(null,c,x,!0,C,h)):(c.tag=0,pr&&C&&m0(c),Rn(null,c,k,h),c=c.child),c;case 16:x=c.elementType;e:{switch(vf(i,c),i=c.pendingProps,k=x._init,x=k(x._payload),c.type=x,k=c.tag=Ek(x),i=qa(x,i),k){case 0:c=U0(null,c,x,i,h);break e;case 1:c=Nv(null,c,x,i,h);break e;case 11:c=Sv(null,c,x,i,h);break e;case 14:c=Tv(null,c,x,qa(x.type,i),h);break e}throw Error(r(306,x,""))}return c;case 0:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:qa(x,k),U0(i,c,x,k,h);case 1:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:qa(x,k),Nv(i,c,x,k,h);case 3:e:{if(Pv(c),i===null)throw Error(r(387));x=c.pendingProps,C=c.memoizedState,k=C.element,Vg(i,c),lf(c,x,null,h);var V=c.memoizedState;if(x=V.element,C.isDehydrated)if(C={element:x,isDehydrated:!1,cache:V.cache,pendingSuspenseBoundaries:V.pendingSuspenseBoundaries,transitions:V.transitions},c.updateQueue.baseState=C,c.memoizedState=C,c.flags&256){k=ql(Error(r(423)),c),c=Iv(i,c,x,h,k);break e}else if(x!==k){k=ql(Error(r(424)),c),c=Iv(i,c,x,h,k);break e}else for(ca=wi(c.stateNode.containerInfo.firstChild),la=c,pr=!0,Ya=null,h=Wg(c,null,x,h),c.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(Vl(),x===k){c=ts(i,c,h);break e}Rn(i,c,x,h)}c=c.child}return c;case 5:return Zg(c),i===null&&v0(c),x=c.type,k=c.pendingProps,C=i!==null?i.memoizedProps:null,V=k.children,Tt(x,k)?V=null:C!==null&&Tt(x,C)&&(c.flags|=32),Av(i,c),Rn(i,c,V,h),c.child;case 6:return i===null&&v0(c),null;case 13:return Dv(i,c,h);case 4:return T0(c,c.stateNode.containerInfo),x=c.pendingProps,i===null?c.child=Gl(c,null,x,h):Rn(i,c,x,h),c.child;case 11:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:qa(x,k),Sv(i,c,x,k,h);case 7:return Rn(i,c,c.pendingProps,h),c.child;case 8:return Rn(i,c,c.pendingProps.children,h),c.child;case 12:return Rn(i,c,c.pendingProps.children,h),c.child;case 10:e:{if(x=c.type._context,k=c.pendingProps,C=c.memoizedProps,V=k.value,lr(af,x._currentValue),x._currentValue=V,C!==null)if(sa(C.value,V)){if(C.children===k.children&&!Gn.current){c=ts(i,c,h);break e}}else for(C=c.child,C!==null&&(C.return=c);C!==null;){var me=C.dependencies;if(me!==null){V=C.child;for(var ve=me.firstContext;ve!==null;){if(ve.context===x){if(C.tag===1){ve=es(-1,h&-h),ve.tag=2;var Pe=C.updateQueue;if(Pe!==null){Pe=Pe.shared;var He=Pe.pending;He===null?ve.next=ve:(ve.next=He.next,He.next=ve),Pe.pending=ve}}C.lanes|=h,ve=C.alternate,ve!==null&&(ve.lanes|=h),b0(C.return,h,c),me.lanes|=h;break}ve=ve.next}}else if(C.tag===10)V=C.type===c.type?null:C.child;else if(C.tag===18){if(V=C.return,V===null)throw Error(r(341));V.lanes|=h,me=V.alternate,me!==null&&(me.lanes|=h),b0(V,h,c),V=C.sibling}else V=C.child;if(V!==null)V.return=C;else for(V=C;V!==null;){if(V===c){V=null;break}if(C=V.sibling,C!==null){C.return=V.return,V=C;break}V=V.return}C=V}Rn(i,c,k.children,h),c=c.child}return c;case 9:return k=c.type,x=c.pendingProps.children,Zl(c,h),k=Ea(k),x=x(k),c.flags|=1,Rn(i,c,x,h),c.child;case 14:return x=c.type,k=qa(x,c.pendingProps),k=qa(x.type,k),Tv(i,c,x,k,h);case 15:return Ev(i,c,c.type,c.pendingProps,h);case 17:return x=c.type,k=c.pendingProps,k=c.elementType===x?k:qa(x,k),vf(i,c),c.tag=1,Kn(x)?(i=!0,Jd(c)):i=!1,Zl(c,h),vv(c,x,k),M0(c,x,k,h),$0(null,c,x,!0,i,h);case 19:return jv(i,c,h);case 22:return Cv(i,c,h)}throw Error(r(156,c.tag))};function ax(i,c){return Re(i,c)}function Tk(i,c,h,x){this.tag=i,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Na(i,c,h,x){return new Tk(i,c,h,x)}function lm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Ek(i){if(typeof i=="function")return lm(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ce)return 11;if(i===fe)return 14}return 2}function Ks(i,c){var h=i.alternate;return h===null?(h=Na(i.tag,c,i.key,i.mode),h.elementType=i.elementType,h.type=i.type,h.stateNode=i.stateNode,h.alternate=i,i.alternate=h):(h.pendingProps=c,h.type=i.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=i.flags&14680064,h.childLanes=i.childLanes,h.lanes=i.lanes,h.child=i.child,h.memoizedProps=i.memoizedProps,h.memoizedState=i.memoizedState,h.updateQueue=i.updateQueue,c=i.dependencies,h.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},h.sibling=i.sibling,h.index=i.index,h.ref=i.ref,h}function Af(i,c,h,x,k,C){var V=2;if(x=i,typeof i=="function")lm(i)&&(V=1);else if(typeof i=="string")V=5;else e:switch(i){case I:return Mo(h.children,k,C,c);case ee:V=8,k|=8;break;case re:return i=Na(12,h,c,k|2),i.elementType=re,i.lanes=C,i;case Ee:return i=Na(13,h,c,k),i.elementType=Ee,i.lanes=C,i;case je:return i=Na(19,h,c,k),i.elementType=je,i.lanes=C,i;case O:return Nf(h,k,C,c);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case ye:V=10;break e;case he:V=9;break e;case ce:V=11;break e;case fe:V=14;break e;case ue:V=16,x=null;break e}throw Error(r(130,i==null?i:typeof i,""))}return c=Na(V,h,c,k),c.elementType=i,c.type=x,c.lanes=C,c}function Mo(i,c,h,x){return i=Na(7,i,x,c),i.lanes=h,i}function Nf(i,c,h,x){return i=Na(22,i,x,c),i.elementType=O,i.lanes=h,i.stateNode={isHidden:!1},i}function cm(i,c,h){return i=Na(6,i,null,c),i.lanes=h,i}function um(i,c,h){return c=Na(4,i.children!==null?i.children:[],i.key,c),c.lanes=h,c.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},c}function Ck(i,c,h,x,k){this.tag=c,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ys(0),this.expirationTimes=ys(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ys(0),this.identifierPrefix=x,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function dm(i,c,h,x,k,C,V,me,ve){return i=new Ck(i,c,h,me,ve),c===1?(c=1,C===!0&&(c|=8)):c=0,C=Na(3,null,null,c),i.current=C,C.stateNode=i,C.memoizedState={element:x,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},S0(C),i}function Ak(i,c,h){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:x==null?null:""+x,children:i,containerInfo:c,implementation:h}}function ix(i){if(!i)return Ms;i=i._reactInternals;e:{if(se(i)!==i||i.tag!==1)throw Error(r(170));var c=i;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(Kn(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(r(171))}if(i.tag===1){var h=i.type;if(Kn(h))return Fg(i,h,c)}return c}function sx(i,c,h,x,k,C,V,me,ve){return i=dm(h,x,!0,i,k,C,V,me,ve),i.context=ix(null),h=i.current,x=Ln(),k=Vs(h),C=es(x,k),C.callback=c??null,Us(h,C,k),i.current.lanes=k,ta(i,k,x),qn(i,x),i}function Pf(i,c,h,x){var k=c.current,C=Ln(),V=Vs(k);return h=ix(h),c.context===null?c.context=h:c.pendingContext=h,c=es(C,V),c.payload={element:i},x=x===void 0?null:x,x!==null&&(c.callback=x),i=Us(k,c,V),i!==null&&(Qa(i,k,V,C),of(i,k,V)),V}function If(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function ox(i,c){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var h=i.retryLane;i.retryLane=h!==0&&h<c?h:c}}function fm(i,c){ox(i,c),(i=i.alternate)&&ox(i,c)}function Nk(){return null}var lx=typeof reportError=="function"?reportError:function(i){console.error(i)};function hm(i){this._internalRoot=i}Df.prototype.render=hm.prototype.render=function(i){var c=this._internalRoot;if(c===null)throw Error(r(409));Pf(i,c,null,null)},Df.prototype.unmount=hm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var c=i.containerInfo;Oo(function(){Pf(null,i,null,null)}),c[Gt]=null}};function Df(i){this._internalRoot=i}Df.prototype.unstable_scheduleHydration=function(i){if(i){var c=bl();i={blockedOn:null,target:i,priority:c};for(var h=0;h<Ur.length&&c!==0&&c<Ur[h].priority;h++);Ur.splice(h,0,i),h===0&&kl(i)}};function mm(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Ff(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function cx(){}function Pk(i,c,h,x,k){if(k){if(typeof x=="function"){var C=x;x=function(){var Pe=If(V);C.call(Pe)}}var V=sx(c,x,i,0,null,!1,!1,"",cx);return i._reactRootContainer=V,i[Gt]=V.current,Fs(i.nodeType===8?i.parentNode:i),Oo(),V}for(;k=i.lastChild;)i.removeChild(k);if(typeof x=="function"){var me=x;x=function(){var Pe=If(ve);me.call(Pe)}}var ve=dm(i,0,!1,null,null,!1,!1,"",cx);return i._reactRootContainer=ve,i[Gt]=ve.current,Fs(i.nodeType===8?i.parentNode:i),Oo(function(){Pf(c,ve,h,x)}),ve}function jf(i,c,h,x,k){var C=h._reactRootContainer;if(C){var V=C;if(typeof k=="function"){var me=k;k=function(){var ve=If(V);me.call(ve)}}Pf(c,V,i,k)}else V=Pk(h,c,i,k,x);return If(V)}_l=function(i){switch(i.tag){case 3:var c=i.stateNode;if(c.current.memoizedState.isDehydrated){var h=St(c.pendingLanes);h!==0&&(Ha(c,h|1),qn(c,Ue()),(zt&6)===0&&(Ql=Ue()+500,Bs()))}break;case 13:Oo(function(){var x=Qi(i,1);if(x!==null){var k=Ln();Qa(x,i,1,k)}}),fm(i,1)}},Mi=function(i){if(i.tag===13){var c=Qi(i,134217728);if(c!==null){var h=Ln();Qa(c,i,134217728,h)}fm(i,134217728)}},wl=function(i){if(i.tag===13){var c=Vs(i),h=Qi(i,c);if(h!==null){var x=Ln();Qa(h,i,c,x)}fm(i,c)}},bl=function(){return Rt},go=function(i,c){var h=Rt;try{return Rt=i,c()}finally{Rt=h}},va=function(i,c,h){switch(c){case"input":if(Be(i,h),c=h.name,h.type==="radio"&&c!=null){for(h=i;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<h.length;c++){var x=h[c];if(x!==i&&x.form===i.form){var k=zl(x);if(!k)throw Error(r(90));q(x),Be(x,k)}}}break;case"textarea":Er(i,h);break;case"select":c=h.value,c!=null&&Kt(i,!!h.multiple,c,!1)}},ps=im,gs=Oo;var Ik={usingClientEntryPoint:!1,Events:[Zi,Yi,zl,fi,ms,im]},bu={findFiberByHostInstance:Ki,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Dk={bundleType:bu.bundleType,version:bu.version,rendererPackageName:bu.rendererPackageName,rendererConfig:bu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:H.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=xe(i),i===null?null:i.stateNode},findFiberByHostInstance:bu.findFiberByHostInstance||Nk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Of=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Of.isDisabled&&Of.supportsFiber)try{Dn=Of.inject(Dk),Nr=Of}catch{}}return Xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ik,Xn.createPortal=function(i,c){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!mm(c))throw Error(r(200));return Ak(i,c,null,h)},Xn.createRoot=function(i,c){if(!mm(i))throw Error(r(299));var h=!1,x="",k=lx;return c!=null&&(c.unstable_strictMode===!0&&(h=!0),c.identifierPrefix!==void 0&&(x=c.identifierPrefix),c.onRecoverableError!==void 0&&(k=c.onRecoverableError)),c=dm(i,1,!1,null,null,h,!1,x,k),i[Gt]=c.current,Fs(i.nodeType===8?i.parentNode:i),new hm(c)},Xn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var c=i._reactInternals;if(c===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=xe(c),i=i===null?null:i.stateNode,i},Xn.flushSync=function(i){return Oo(i)},Xn.hydrate=function(i,c,h){if(!Ff(c))throw Error(r(200));return jf(null,i,c,!0,h)},Xn.hydrateRoot=function(i,c,h){if(!mm(i))throw Error(r(405));var x=h!=null&&h.hydratedSources||null,k=!1,C="",V=lx;if(h!=null&&(h.unstable_strictMode===!0&&(k=!0),h.identifierPrefix!==void 0&&(C=h.identifierPrefix),h.onRecoverableError!==void 0&&(V=h.onRecoverableError)),c=sx(c,null,i,1,h??null,k,!1,C,V),i[Gt]=c.current,Fs(i),x)for(i=0;i<x.length;i++)h=x[i],k=h._getVersion,k=k(h._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[h,k]:c.mutableSourceEagerHydrationData.push(h,k);return new Df(c)},Xn.render=function(i,c,h){if(!Ff(c))throw Error(r(200));return jf(null,i,c,!1,h)},Xn.unmountComponentAtNode=function(i){if(!Ff(i))throw Error(r(40));return i._reactRootContainer?(Oo(function(){jf(null,null,i,!1,function(){i._reactRootContainer=null,i[Gt]=null})}),!0):!1},Xn.unstable_batchedUpdates=im,Xn.unstable_renderSubtreeIntoContainer=function(i,c,h,x){if(!Ff(h))throw Error(r(200));if(i==null||i._reactInternals===void 0)throw Error(r(38));return jf(i,c,h,!1,x)},Xn.version="18.3.1-next-f1338f8080-20240426",Xn}var vx;function Iy(){if(vx)return vm.exports;vx=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),vm.exports=zk(),vm.exports}var xx;function Uk(){if(xx)return Rf;xx=1;var e=Iy();return Rf.createRoot=e.createRoot,Rf.hydrateRoot=e.hydrateRoot,Rf}var $k=Uk();const Wk=Ph($k),Hk="modulepreload",Vk=function(e){return"/"+e},yx={},oi=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){let p=function(g){return Promise.all(g.map(y=>Promise.resolve(y).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};var l=p;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),m=d?.nonce||d?.getAttribute("nonce");a=p(r.map(g=>{if(g=Vk(g),g in yx)return;yx[g]=!0;const y=g.endsWith(".css"),_=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${_}`))return;const T=document.createElement("link");if(T.rel=y?"stylesheet":Hk,y||(T.as="script"),T.crossOrigin="",T.href=g,m&&T.setAttribute("nonce",m),document.head.appendChild(T),y)return new Promise((S,w)=>{T.addEventListener("load",S),T.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${g}`)))})}))}function s(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return a.then(d=>{for(const m of d||[])m.status==="rejected"&&s(m.reason);return t().catch(s)})};var Z=Tp();const rr=Ph(Z);function us(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function Dy(e,t){let r;const n=()=>{if(r)return r;const a=indexedDB.open(e);return a.onupgradeneeded=()=>a.result.createObjectStore(t),r=us(a),r.then(s=>{s.onclose=()=>r=void 0},()=>{}),r};return(a,s)=>n().then(l=>s(l.transaction(t,a).objectStore(t)))}let _m;function vd(){return _m||(_m=Dy("keyval-store","keyval")),_m}function Xu(e,t=vd()){return t("readonly",r=>us(r.get(e)))}function wc(e,t,r=vd()){return r("readwrite",n=>(n.put(t,e),us(n.transaction)))}function ih(e,t=vd()){return t("readwrite",r=>(r.delete(e),us(r.transaction)))}function Gk(e=vd()){return e("readwrite",t=>(t.clear(),us(t.transaction)))}function Kk(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},us(e.transaction)}function Du(e=vd()){return e("readonly",t=>{if(t.getAll&&t.getAllKeys)return Promise.all([us(t.getAllKeys()),us(t.getAll())]).then(([n,a])=>n.map((s,l)=>[s,a[l]]));const r=[];return e("readonly",n=>Kk(n,a=>r.push([a.key,a.value])).then(()=>r))})}const Zk=Object.freeze(Object.defineProperty({__proto__:null,clear:Gk,createStore:Dy,del:ih,entries:Du,get:Xu,promisifyRequest:us,set:wc},Symbol.toStringTag,{value:"Module"})),Yk=["password","token","secret","apiKey","api_key","accessToken","refreshToken","sessionId","ssn","creditCard","cvv","pin","privateKey"];function Xm(e){if(e==null||typeof e!="object")return e;if(Array.isArray(e))return e.map(r=>Xm(r));const t={};for(const[r,n]of Object.entries(e)){const a=r.toLowerCase();Yk.some(l=>a.includes(l.toLowerCase()))?t[r]="[REDACTED]":typeof n=="object"&&n!==null?t[r]=Xm(n):t[r]=n}return t}function _x(e){return e.map(t=>typeof t=="object"&&t!==null?Xm(t):t)}const le={debug:(e,...t)=>{},info:(e,...t)=>{},warn:(e,...t)=>{console.warn(`[WARN] ${e}`,..._x(t))},error:(e,...t)=>{console.error(`[ERROR] ${e}`,..._x(t))},success:(e,...t)=>{},sync:(e,...t)=>{},time:e=>{},timeEnd:e=>{},group:e=>{},groupEnd:()=>{}};class qk{toasts=[];listeners=[];timeouts=new Map;show(t,r="info",n=4e3){const a={id:`toast_${Date.now()}_${Math.random().toString(36).slice(2)}`,message:t,type:r,timestamp:Date.now(),duration:n};if(this.toasts.push(a),this.notifyListeners(),n>0){const s=setTimeout(()=>{this.remove(a.id)},n);this.timeouts.set(a.id,s)}return a.id}remove(t){const r=this.timeouts.get(t);r&&(clearTimeout(r),this.timeouts.delete(t)),this.toasts=this.toasts.filter(n=>n.id!==t),this.notifyListeners()}clear(){this.timeouts.forEach(t=>clearTimeout(t)),this.timeouts.clear(),this.toasts=[],this.notifyListeners()}getToasts(){return[...this.toasts]}subscribe(t){return this.listeners.push(t),()=>{this.listeners=this.listeners.filter(r=>r!==t)}}notifyListeners(){this.listeners.forEach(t=>t([...this.toasts]))}}const Ju=new qk,bc=(e,t)=>Ju.show(e,"error",t),Mu=(e,t)=>Ju.show(e,"warning",t),Xk=(e,t)=>Ju.show(e,"info",t);class Jk{queue=[];processing=!1;persistenceGranted=!1;constructor(){this.initializePersistence()}async initializePersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const t=await navigator.storage.persist();if(this.persistenceGranted=t,t?le.info("✅ Persistent storage granted - data protected from eviction"):(le.warn("⚠️ Persistent storage denied - data may be evicted by browser"),Mu("Storage persistence not granted. Your data may be lost if browser storage is full.",8e3)),"estimate"in navigator.storage){const r=await navigator.storage.estimate(),n=Math.round((r.usage||0)/1024/1024),a=Math.round((r.quota||0)/1024/1024);le.info(`📊 Storage: ${n}MB used / ${a}MB quota`),r.usage&&r.quota&&r.usage>r.quota*.8&&(le.warn("⚠️ Storage quota 80% full - may cause data loss"),Mu("Storage is 80% full. Consider clearing old data to prevent loss.",1e4))}}else le.warn("🚫 Storage persistence API not available")}catch(t){le.error("Failed to initialize storage persistence:",t)}}async queuedSet(t,r){return new Promise((n,a)=>{this.queue.push({key:t,data:r,resolve:n,reject:a}),this.processQueue()})}async processQueue(){if(!(this.processing||this.queue.length===0)){for(this.processing=!0;this.queue.length>0;){const t=this.queue.shift();try{let r=3,n;for(;r>0;)try{await wc(t.key,t.data),t.resolve(void 0);break}catch(a){n=a,r--,r>0&&(le.warn(`IndexedDB write failed, retrying... (${3-r}/3)`,a),await new Promise(s=>setTimeout(s,100*(4-r))))}r===0&&(le.error("IndexedDB write failed after 3 retries:",n),bc("Failed to save data. Please check your browser storage settings.",1e4),t.reject(n))}catch(r){le.error("Storage queue operation failed:",r),t.reject(r)}}this.processing=!1}}async queuedGet(t){try{return await this.checkStorageHealth(),await Xu(t)}catch(r){throw le.error("IndexedDB read failed:",r),bc("Failed to load data from storage. Please refresh the page.",1e4),r}}async checkStorageHealth(){try{if("storage"in navigator&&"estimate"in navigator.storage){const t=await navigator.storage.estimate();if(t.usage&&t.quota&&t.usage>t.quota*.95)throw le.error("🚨 CRITICAL: Storage quota 95% full - immediate data loss risk"),bc("CRITICAL: Storage almost full! Clear browser data immediately to prevent loss.",15e3),new Error("Storage quota exhausted")}}catch(t){le.warn("Storage health check failed:",t)}}async requestPersistence(){try{if("storage"in navigator&&"persist"in navigator.storage){const t=await navigator.storage.persist();return this.persistenceGranted=t,t}}catch(t){le.error("Failed to request storage persistence:",t)}return!1}get isPersistent(){return this.persistenceGranted}}const Su=new Jk;function Br(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Di(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ep(e,t){const r=Br(e);return isNaN(t)?Di(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Qk(e,t){const r=Br(e);if(isNaN(t))return Di(e,NaN);if(!t)return r;const n=r.getDate(),a=Di(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const s=a.getDate();return n>=s?a:(r.setFullYear(a.getFullYear(),a.getMonth(),n),r)}const Fy=6048e5,eS=864e5,jy=6e4,Oy=36e5;let tS={};function Ih(){return tS}function Ac(e,t){const r=Ih(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=Br(e),s=a.getDay(),l=(s<n?7:0)+s-n;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function dh(e){return Ac(e,{weekStartsOn:1})}function Ry(e){const t=Br(e),r=t.getFullYear(),n=Di(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=dh(n),s=Di(e,0);s.setFullYear(r,0,4),s.setHours(0,0,0,0);const l=dh(s);return t.getTime()>=a.getTime()?r+1:t.getTime()>=l.getTime()?r:r-1}function Yo(e){const t=Br(e);return t.setHours(0,0,0,0),t}function wx(e){const t=Br(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function rS(e,t){const r=Yo(e),n=Yo(t),a=+r-wx(r),s=+n-wx(n);return Math.round((a-s)/eS)}function nS(e){const t=Ry(e),r=Di(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),dh(r)}function bx(e,t){const r=t*7;return Ep(e,r)}function kx(e,t){const r=Yo(e),n=Yo(t);return+r==+n}function aS(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function iS(e){if(!aS(e)&&typeof e!="number")return!1;const t=Br(e);return!isNaN(Number(t))}function sS(e){const t=Br(e),r=Di(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function oS(e,t){const r=t?.weekStartsOn,n=Br(e),a=n.getDay(),s=(a<r?-7:0)+6-(a-r);return n.setDate(n.getDate()+s),n.setHours(23,59,59,999),n}const lS={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},cS=(e,t,r)=>{let n;const a=lS[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function wm(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const uS={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},dS={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},fS={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hS={date:wm({formats:uS,defaultWidth:"full"}),time:wm({formats:dS,defaultWidth:"full"}),dateTime:wm({formats:fS,defaultWidth:"full"})},mS={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},pS=(e,t,r,n)=>mS[e];function Tu(e){return(t,r)=>{const n=r?.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,d=r?.width?String(r.width):l;a=e.formattingValues[d]||e.formattingValues[l]}else{const l=e.defaultWidth,d=r?.width?String(r.width):e.defaultWidth;a=e.values[d]||e.values[l]}const s=e.argumentCallback?e.argumentCallback(t):t;return a[s]}}const gS={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},vS={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},xS={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},yS={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},_S={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},wS={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bS=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},kS={ordinalNumber:bS,era:Tu({values:gS,defaultWidth:"wide"}),quarter:Tu({values:vS,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Tu({values:xS,defaultWidth:"wide"}),day:Tu({values:yS,defaultWidth:"wide"}),dayPeriod:Tu({values:_S,defaultWidth:"wide",formattingValues:wS,defaultFormattingWidth:"wide"})};function Eu(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(a);if(!s)return null;const l=s[0],d=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],m=Array.isArray(d)?TS(d,y=>y.test(l)):SS(d,y=>y.test(l));let p;p=e.valueCallback?e.valueCallback(m):m,p=r.valueCallback?r.valueCallback(p):p;const g=t.slice(l.length);return{value:p,rest:g}}}function SS(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function TS(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function ES(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],s=t.match(e.parsePattern);if(!s)return null;let l=e.valueCallback?e.valueCallback(s[0]):s[0];l=r.valueCallback?r.valueCallback(l):l;const d=t.slice(a.length);return{value:l,rest:d}}}const CS=/^(\d+)(th|st|nd|rd)?/i,AS=/\d+/i,NS={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},PS={any:[/^b/i,/^(a|c)/i]},IS={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},DS={any:[/1/i,/2/i,/3/i,/4/i]},FS={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},jS={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},OS={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},RS={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},LS={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},MS={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},BS={ordinalNumber:ES({matchPattern:CS,parsePattern:AS,valueCallback:e=>parseInt(e,10)}),era:Eu({matchPatterns:NS,defaultMatchWidth:"wide",parsePatterns:PS,defaultParseWidth:"any"}),quarter:Eu({matchPatterns:IS,defaultMatchWidth:"wide",parsePatterns:DS,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Eu({matchPatterns:FS,defaultMatchWidth:"wide",parsePatterns:jS,defaultParseWidth:"any"}),day:Eu({matchPatterns:OS,defaultMatchWidth:"wide",parsePatterns:RS,defaultParseWidth:"any"}),dayPeriod:Eu({matchPatterns:LS,defaultMatchWidth:"any",parsePatterns:MS,defaultParseWidth:"any"})},zS={code:"en-US",formatDistance:cS,formatLong:hS,formatRelative:pS,localize:kS,match:BS,options:{weekStartsOn:0,firstWeekContainsDate:1}};function US(e){const t=Br(e);return rS(t,sS(t))+1}function $S(e){const t=Br(e),r=+dh(t)-+nS(t);return Math.round(r/Fy)+1}function Ly(e,t){const r=Br(e),n=r.getFullYear(),a=Ih(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=Di(e,0);l.setFullYear(n+1,0,s),l.setHours(0,0,0,0);const d=Ac(l,t),m=Di(e,0);m.setFullYear(n,0,s),m.setHours(0,0,0,0);const p=Ac(m,t);return r.getTime()>=d.getTime()?n+1:r.getTime()>=p.getTime()?n:n-1}function WS(e,t){const r=Ih(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,a=Ly(e,t),s=Di(e,0);return s.setFullYear(a,0,n),s.setHours(0,0,0,0),Ac(s,t)}function HS(e,t){const r=Br(e),n=+Ac(r,t)-+WS(r,t);return Math.round(n/Fy)+1}function qt(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Ys={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return qt(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):qt(r+1,2)},d(e,t){return qt(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return qt(e.getHours()%12||12,t.length)},H(e,t){return qt(e.getHours(),t.length)},m(e,t){return qt(e.getMinutes(),t.length)},s(e,t){return qt(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return qt(a,t.length)}},tc={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Sx={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return Ys.y(e,t)},Y:function(e,t,r,n){const a=Ly(e,n),s=a>0?a:1-a;if(t==="YY"){const l=s%100;return qt(l,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):qt(s,t.length)},R:function(e,t){const r=Ry(e);return qt(r,t.length)},u:function(e,t){const r=e.getFullYear();return qt(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return qt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return qt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Ys.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return qt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const a=HS(e,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):qt(a,t.length)},I:function(e,t,r){const n=$S(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):qt(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Ys.d(e,t)},D:function(e,t,r){const n=US(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):qt(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return qt(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const a=e.getDay(),s=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return qt(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return qt(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let a;switch(n===12?a=tc.noon:n===0?a=tc.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let a;switch(n>=17?a=tc.evening:n>=12?a=tc.afternoon:n>=4?a=tc.morning:a=tc.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Ys.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Ys.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):qt(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):qt(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ys.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Ys.s(e,t)},S:function(e,t){return Ys.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return Ex(n);case"XXXX":case"XX":return Wo(n);case"XXXXX":case"XXX":default:return Wo(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return Ex(n);case"xxxx":case"xx":return Wo(n);case"xxxxx":case"xxx":default:return Wo(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Tx(n,":");case"OOOO":default:return"GMT"+Wo(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Tx(n,":");case"zzzz":default:return"GMT"+Wo(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return qt(n,t.length)},T:function(e,t,r){const n=e.getTime();return qt(n,t.length)}};function Tx(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=Math.trunc(n/60),s=n%60;return s===0?r+String(a):r+String(a)+t+qt(s,2)}function Ex(e,t){return e%60===0?(e>0?"-":"+")+qt(Math.abs(e)/60,2):Wo(e,t)}function Wo(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),a=qt(Math.trunc(n/60),2),s=qt(n%60,2);return r+a+t+s}const Cx=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},My=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},VS=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return Cx(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;case"PPPP":default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",Cx(n,t)).replace("{{time}}",My(a,t))},GS={p:My,P:VS},KS=/^D+$/,ZS=/^Y+$/,YS=["D","DD","YY","YYYY"];function qS(e){return KS.test(e)}function XS(e){return ZS.test(e)}function JS(e,t,r){const n=QS(e,t,r);if(console.warn(n),YS.includes(e))throw new RangeError(n)}function QS(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const e2=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,t2=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,r2=/^'([^]*?)'?$/,n2=/''/g,a2=/[a-zA-Z]/;function fh(e,t,r){const n=Ih(),a=n.locale??zS,s=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,l=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,d=Br(e);if(!iS(d))throw new RangeError("Invalid time value");let m=t.match(t2).map(g=>{const y=g[0];if(y==="p"||y==="P"){const _=GS[y];return _(g,a.formatLong)}return g}).join("").match(e2).map(g=>{if(g==="''")return{isToken:!1,value:"'"};const y=g[0];if(y==="'")return{isToken:!1,value:i2(g)};if(Sx[y])return{isToken:!0,value:g};if(y.match(a2))throw new RangeError("Format string contains an unescaped latin alphabet character `"+y+"`");return{isToken:!1,value:g}});a.localize.preprocessor&&(m=a.localize.preprocessor(d,m));const p={firstWeekContainsDate:s,weekStartsOn:l,locale:a};return m.map(g=>{if(!g.isToken)return g.value;const y=g.value;(XS(y)||qS(y))&&JS(y,t,String(e));const _=Sx[y[0]];return _(d,y,a.localize,p)}).join("")}function i2(e){const t=e.match(r2);return t?t[1].replace(n2,"'"):e}function s2(e,t){const r=Br(e),n=Br(t);return r.getTime()>n.getTime()}function o2(e){return+Br(e)<Date.now()}function l2(e,t){const r=+Br(e),[n,a]=[+Br(t.start),+Br(t.end)].sort((s,l)=>s-l);return r>=n&&r<=a}function c2(e,t){return Ep(e,-t)}function Ra(e,t){const n=h2(e);let a;if(n.date){const m=m2(n.date,2);a=p2(m.restDateString,m.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const s=a.getTime();let l=0,d;if(n.time&&(l=g2(n.time),isNaN(l)))return new Date(NaN);if(n.timezone){if(d=v2(n.timezone),isNaN(d))return new Date(NaN)}else{const m=new Date(s+l),p=new Date(0);return p.setFullYear(m.getUTCFullYear(),m.getUTCMonth(),m.getUTCDate()),p.setHours(m.getUTCHours(),m.getUTCMinutes(),m.getUTCSeconds(),m.getUTCMilliseconds()),p}return new Date(s+l+d)}const Lf={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},u2=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,d2=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,f2=/^([+-])(\d{2})(?::?(\d{2}))?$/;function h2(e){const t={},r=e.split(Lf.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Lf.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Lf.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const a=Lf.timezone.exec(n);a?(t.time=n.replace(a[1],""),t.timezone=a[1]):t.time=n}return t}function m2(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const a=n[1]?parseInt(n[1]):null,s=n[2]?parseInt(n[2]):null;return{year:s===null?a:s*100,restDateString:e.slice((n[1]||n[2]).length)}}function p2(e,t){if(t===null)return new Date(NaN);const r=e.match(u2);if(!r)return new Date(NaN);const n=!!r[4],a=Cu(r[1]),s=Cu(r[2])-1,l=Cu(r[3]),d=Cu(r[4]),m=Cu(r[5])-1;if(n)return b2(t,d,m)?x2(t,d,m):new Date(NaN);{const p=new Date(0);return!_2(t,s,l)||!w2(t,a)?new Date(NaN):(p.setUTCFullYear(t,s,Math.max(a,l)),p)}}function Cu(e){return e?parseInt(e):1}function g2(e){const t=e.match(d2);if(!t)return NaN;const r=bm(t[1]),n=bm(t[2]),a=bm(t[3]);return k2(r,n,a)?r*Oy+n*jy+a*1e3:NaN}function bm(e){return e&&parseFloat(e.replace(",","."))||0}function v2(e){if(e==="Z")return 0;const t=e.match(f2);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return S2(n,a)?r*(n*Oy+a*jy):NaN}function x2(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const a=n.getUTCDay()||7,s=(t-1)*7+r+1-a;return n.setUTCDate(n.getUTCDate()+s),n}const y2=[31,null,31,30,31,30,31,31,30,31,30,31];function By(e){return e%400===0||e%4===0&&e%100!==0}function _2(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(y2[t]||(By(e)?29:28))}function w2(e,t){return t>=1&&t<=(By(e)?366:365)}function b2(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function k2(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function S2(e,t){return t>=0&&t<=59}const T2={name:"[Agent Name]",title:"Enforcement Agent",signature:"Enforcement Agent [Agent Name]",contactInfo:void 0},zy=[{id:"professional_standard",name:"Professional Standard",template:`{greeting}PAYMENT REMINDER

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: £{amount}

Payment must be made as agreed. Failure to comply may result in further enforcement action.

Contact immediately if unable to pay as arranged.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"friendly_reminder",name:"Friendly Reminder",template:`{greeting}Payment Reminder

{refLine}This is a friendly reminder that your payment arrangement is due {date}{time}.

Amount: £{amount}

Please ensure payment is made as agreed. If you need to discuss this arrangement, please contact us immediately.

Thank you,
{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"urgent_notice",name:"Urgent Notice",template:`{greeting}URGENT: PAYMENT DUE

{refLine}Your payment arrangement is due {date}{time}.

Amount Due: £{amount}

IMPORTANT: Payment must be made TODAY as agreed. Failure to comply will result in immediate further enforcement action.

Contact us NOW if unable to pay.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"payment_plan_reminder",name:"Payment Plan Reminder",template:`{greeting}Payment Plan Reminder

{refLine}Your next payment is due {date}{time}.

Payment Amount: £{amount}

This is part of your agreed payment plan. Please ensure this payment is made on time to keep your arrangement active.

If you have any questions about your payment plan, please contact us.

{signature}{contactInfo}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]},{id:"custom",name:"Custom Template",template:`{greeting}Payment Reminder

{refLine}Your payment is due {date}{time}.

Amount: £{amount}

[Customize this message]

{signature}`,variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]}],E2={daysBeforePayment:[3,1,0],enabled:!0,autoSend:!1},cl={defaultSchedule:E2,globalEnabled:!0,smsEnabled:!0,agentProfile:T2,messageTemplates:zy,activeTemplateId:"professional_standard",customizableSchedule:{threeDayReminder:!0,oneDayReminder:!0,dayOfReminder:!0,customDays:[]}};function C2(e,t=cl){const r=e.reminderSchedule||t.defaultSchedule;if(!r.enabled||!t.globalEnabled)return[];const n=Ra(e.scheduledDate);let a=[];return r.daysBeforePayment&&r.daysBeforePayment.length>0?a=[...r.daysBeforePayment]:(t.customizableSchedule.threeDayReminder&&a.push(3),t.customizableSchedule.oneDayReminder&&a.push(1),t.customizableSchedule.dayOfReminder&&a.push(0),a.push(...t.customizableSchedule.customDays)),[...new Set(a)].sort((l,d)=>d-l).map(l=>c2(n,l).toISOString())}function A2(e,t=cl){const r=C2(e,t),n=new Date().toISOString();return r.map((a,s)=>({id:`${e.id}_reminder_${s}`,arrangementId:e.id,type:N2(e,a),scheduledDate:a,status:"pending",createdAt:n,updatedAt:n}))}function N2(e,t){const r=Yo(Ra(e.scheduledDate)),n=Yo(Ra(t)),a=Yo(new Date);return n.getTime()===r.getTime()?"payment_due":s2(a,r)?"overdue":"custom"}function P2(e){const t=e.reminderSettings||cl;if(!t.globalEnabled)return e.reminderNotifications||[];const r=e.reminderNotifications||[],n=[];return e.arrangements.filter(a=>a.status!=="Completed"&&a.status!=="Cancelled").forEach(a=>{if(!r.some(l=>l.arrangementId===a.id)){const l=A2(a,t);n.push(...l)}}),[...r,...n]}function I2(e,t,r,n){return e.map(a=>a.id===t?{...a,status:r,message:n||a.message,updatedAt:new Date().toISOString()}:a)}function D2(e,t){const r=new Set(t.filter(n=>n.status!=="Completed"&&n.status!=="Cancelled").map(n=>n.id));return e.filter(n=>r.has(n.arrangementId))}function Uy(e,t,r=cl){const n=r.messageTemplates.find(w=>w.id===r.activeTemplateId)||r.messageTemplates[0],a=e.customerName||"",s=e.amount||"the arranged amount",l=Ra(e.scheduledDate);let d="",m="";if(a){const w=a.trim().split(/\s+/);w.length>=2?(m=w[0],d=`Mr/Mrs ${w.slice(1).join(" ")}, `):d=`${a}, `}const p=m?`Reference: ${m}

`:"",g=e.scheduledTime?` at ${e.scheduledTime}`:"",y=l.toLocaleDateString("en-GB");let _=n.template;const T=r.agentProfile.contactInfo?`
${r.agentProfile.contactInfo}`:"",S={greeting:d,refLine:p,date:y,time:g,amount:s,signature:r.agentProfile.signature,customerName:a,referenceNumber:m||"",agentName:r.agentProfile.name,agentTitle:r.agentProfile.title,contactInfo:T};return Object.entries(S).forEach(([w,E])=>{const P=new RegExp(`\\{${w}\\}`,"g");_=_.replace(P,E)}),_}const os={enabled:!0,calculationType:"complex",simpleSettings:{pifBonus:100,dailyThreshold:100},complexSettings:{baseEnforcementFee:235,basePifBonus:100,largePifThreshold:1500,largePifPercentage:.001875,largePifCap:500,smallPifBonus:30,linkedCaseBonus:10,complianceFeePerCase:75,complianceFeeFixed:122.5,dailyThreshold:100},adjustForWorkingDays:!0};function hh(e,t=1){const a=(e-(75*t+122.5))/1.075;return Math.max(0,a)}function F2(e,t,r){if(!r.simpleSettings)return 0;const{pifBonus:n,dailyThreshold:a}=r.simpleSettings;let s=0;for(const p of e)p.outcome==="PIF"&&(s+=1);const l=s*n,d=t*a,m=l-d;return Math.max(0,m)}function j2(e,t,r){if(!r.complexSettings)return 0;const{basePifBonus:n,largePifThreshold:a,largePifPercentage:s,largePifCap:l,smallPifBonus:d,linkedCaseBonus:m,dailyThreshold:p}=r.complexSettings;let g=0;for(const T of e){if(T.outcome!=="PIF")continue;const S=parseFloat(T.amount||"0"),w=T.numberOfCases||1;let E=0;if(S===0)E=m;else if(S<100)E=d;else{const P=hh(S,w);if(P>a){const D=s*(P-a);E=Math.min(n+D,l)}else E=n}g+=E}const y=t*p,_=g-y;return Math.max(0,_)}function $y(e,t,r,n){try{const a=hh(t,r),s=t,l=r,d=n,p=new Function("T","N","D","days",`return ${e}`)(s,l,a,d);return typeof p=="number"&&isFinite(p)?Math.max(0,p):0}catch(a){return console.error("Error evaluating custom bonus formula:",a),0}}function O2(e,t,r){if(!r.customFormula)return 0;let n=0;for(const a of e){if(a.outcome!=="PIF")continue;const s=parseFloat(a.amount||"0"),l=a.numberOfCases||1,d=$y(r.customFormula,s,l,t);n+=d}return Math.max(0,n)}function Ax(e,t,r=os){if(!r.enabled)return 0;switch(r.calculationType){case"simple":return F2(e,t,r);case"complex":return j2(e,t,r);case"custom":return O2(e,t,r);default:return 0}}function R2(e,t,r=os){const n={totalPifs:0,totalCases:0,grossBonus:0,threshold:0,netBonus:0,pifDetails:[]};if(!r.enabled)return n;const a=r.calculationType==="simple"?r.simpleSettings?.dailyThreshold||100:r.complexSettings?.dailyThreshold||100;n.threshold=t*a;for(const s of e){if(s.outcome!=="PIF")continue;const l=parseFloat(s.amount||"0"),d=s.numberOfCases||1;n.totalPifs++,n.totalCases+=d;let m=0,p;if(r.calculationType==="simple"&&r.simpleSettings)m=r.simpleSettings.pifBonus;else if(r.calculationType==="complex"&&r.complexSettings){const{basePifBonus:g,largePifThreshold:y,largePifPercentage:_,largePifCap:T,smallPifBonus:S,linkedCaseBonus:w}=r.complexSettings;if(l===0)m=w;else if(l<100)m=S;else if(p=hh(l,d),p>y){const E=_*(p-y);m=Math.min(g+E,T)}else m=g}else r.calculationType==="custom"&&r.customFormula&&(p=hh(l,d),m=$y(r.customFormula,l,d,t));n.grossBonus+=m,n.pifDetails.push({amount:l,cases:d,bonusPerCase:m,totalBonus:m,debtAmount:p})}return n.netBonus=Math.max(0,n.grossBonus-n.threshold),n}const Au="navigator_state_v5",Bo=5,Nu={addresses:[],activeIndex:null,activeStartTime:null,completions:[],daySessions:[],arrangements:[],currentListVersion:1,subscription:null,reminderSettings:cl,reminderNotifications:[],lastReminderProcessed:void 0,bonusSettings:os};function L2(e){return e&&typeof e.index=="number"&&typeof e.address=="string"&&typeof e.outcome=="string"&&["PIF","DA","Done","ARR"].includes(e.outcome)&&typeof e.timestamp=="string"&&!isNaN(new Date(e.timestamp).getTime())}function km(e){return e&&typeof e.address=="string"&&e.address.trim().length>0}function M2(e){return e&&Array.isArray(e.addresses)&&Array.isArray(e.completions)&&Array.isArray(e.daySessions)&&Array.isArray(e.arrangements)&&(e.activeIndex===null||typeof e.activeIndex=="number")&&typeof e.currentListVersion=="number"}function Nx(e,t){return(Array.isArray(e)?e:[]).filter(L2).map(n=>({...n,listVersion:typeof n?.listVersion=="number"?n.listVersion:t}))}function qs(e,t,r){const n=`${e}_${t}_${JSON.stringify(r).slice(0,50)}_${Date.now()}`,a=encodeURIComponent(n);return btoa(a).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}function Wy(e,t){const r={...e,end:t.toISOString()},n=Date.parse(e.start),a=t.getTime();if(!Number.isNaN(n)&&!Number.isNaN(a)){const s=a-n;r.durationSeconds=s>=0?Math.floor(s/1e3):void 0}else r.durationSeconds=void 0;return r}function B2(e,t){const r=t.getTime(),n=Date.parse(e.start);let a=Date.parse(`${e.date}T23:59:59.999Z`);return Number.isNaN(a)&&(a=r),!Number.isNaN(n)&&a<n&&(a=n),a>r&&(a=r),Number.isNaN(a)&&(a=Number.isNaN(n)?r:n),Wy(e,new Date(a))}function z2(e,t,r){const n=[],a=[];for(const s of e)if(!s.end&&s.date<t){const l=B2(s,r);n.push(l),a.push(l)}else n.push(s);return{sanitizedSessions:n,closedSessions:a}}function U2(e,t){for(let r=e.length-1;r>=0;r-=1){const n=e[r];if(n.date===t&&!n.end)return r}return-1}function $2(e,t,r){const{sanitizedSessions:n,closedSessions:a}=z2(e,t,r),s=U2(n,t);if(s===-1)return{updatedSessions:n,closedSessions:a};const l=n.slice(),d=Wy(l[s],r);return l[s]=d,{updatedSessions:l,closedSessions:a,endedSession:d}}const Px="navigator_device_id";function W2(){try{const e=localStorage.getItem(Px);if(e)return e;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():"dev_"+Math.random().toString(36).slice(2);return localStorage.setItem(Px,t),t}catch{return"dev_"+Math.random().toString(36).slice(2)}}function H2(e,t){if(t.size===0)return e;try{let r={...e,addresses:[...e.addresses],completions:[...e.completions],arrangements:[...e.arrangements],daySessions:[...e.daySessions]};const n=Array.from(t.values()).sort((l,d)=>new Date(l.timestamp).getTime()-new Date(d.timestamp).getTime());let a=!1,s=!1;for(const l of n)if(l.type!=="reverted")try{switch(l.entity){case"completion":if(s=!0,l.operation==="create"){if(!l.data||typeof l.data.index!="number"||!l.data.outcome){le.warn("Invalid completion data in optimistic update:",l.data);continue}r.completions.some(m=>m.index===l.data.index&&m.outcome===l.data.outcome&&Math.abs(new Date(m.timestamp).getTime()-new Date(l.data.timestamp).getTime())<1e3)||(r.completions=[l.data,...r.completions])}else l.operation==="update"?r.completions=r.completions.map(d=>d.timestamp===l.data.originalTimestamp?{...d,...l.data}:d):l.operation==="delete"&&(r.completions=r.completions.filter(d=>d.timestamp!==l.data.timestamp));break;case"arrangement":l.operation==="create"?r.arrangements=[...r.arrangements,l.data]:l.operation==="update"?r.arrangements=r.arrangements.map(d=>d.id===l.data.id?{...d,...l.data,updatedAt:l.timestamp}:d):l.operation==="delete"&&(r.arrangements=r.arrangements.filter(d=>d.id!==l.data.id));break;case"address":if(a=!0,l.operation==="create")r.addresses=[...r.addresses,l.data];else if(l.operation==="update"&&l.data?.addresses&&(r.addresses=Array.isArray(l.data.addresses)?l.data.addresses:r.addresses,l.data.bumpVersion)){const d=typeof r.currentListVersion=="number"?r.currentListVersion:1;r.currentListVersion=d+1,l.data.preserveCompletions||(r.completions=[]),r.activeIndex=null}break;case"session":l.operation==="create"?l.data&&l.data.date&&l.data.start?r.daySessions=[...r.daySessions,l.data]:le.warn("Invalid session data in optimistic update:",l.data):l.operation==="update"&&(r.daySessions=r.daySessions.map(d=>d.date===l.data.date?{...d,...l.data}:d));break;default:le.warn(`Unknown entity type in optimistic update: ${l.entity}`,l);break}}catch(d){le.error(`Failed to apply optimistic update for ${l.entity}:`,d)}return a&&(!r.addresses||!Array.isArray(r.addresses))?(le.error("Optimistic updates corrupted addresses, reverting to base state"),e):s&&(!r.completions||!Array.isArray(r.completions))?(le.error("Optimistic updates corrupted completions, reverting to base state"),e):r}catch(r){return le.error("Failed to apply optimistic updates, returning base state:",r),e}}function V2(e){const[t,r]=Z.useState(Nu),[n,a]=Z.useState({updates:new Map,pendingOperations:new Set}),[s,l]=Z.useState(!0),d=Z.useMemo(()=>W2(),[]),m=Z.useRef(e);Z.useEffect(()=>{m.current=e},[e]);const p=Z.useMemo(()=>{let W=t;return t.bonusSettings||(le.warn("Missing bonusSettings in baseState, applying default"),W={...t,bonusSettings:os},setTimeout(()=>r(W),0)),H2(W,n.updates)},[t,n.updates]),[g,y]=Z.useState(new Map),[_,T]=Z.useState({});Z.useEffect(()=>{let W=!0;return(async()=>{try{const ae=await Su.queuedGet(Au);if(!W)return;if(ae){const oe=ae._ownerUserId,de=ae._ownerChecksum,ge=localStorage.getItem("navigator_expected_user_id");if(ge&&oe&&oe!==ge){le.error(`🚨 INDEXEDDB CONTAMINATION: Data belongs to ${oe} but expected ${ge}`);const Ze={timestamp:new Date().toISOString(),contaminatedData:ae,expectedUserId:ge,actualUserId:oe,reason:"indexeddb_contamination"};localStorage.setItem(`navigator_emergency_backup_${Date.now()}`,JSON.stringify(Ze)),await Su.queuedSet(Au,null),le.warn("🔒 SECURITY: Cleared contaminated IndexedDB data"),r({...Nu,_schemaVersion:Bo});return}if(T({ownerUserId:oe,ownerChecksum:de}),!M2(ae)){le.warn("Loaded data failed validation, using initial state"),r({...Nu,_schemaVersion:Bo});return}const Oe=typeof ae.currentListVersion=="number"?ae.currentListVersion:1,q={addresses:ae.addresses.filter(km),activeIndex:typeof ae.activeIndex=="number"?ae.activeIndex:null,completions:Nx(ae.completions,Oe),daySessions:Array.isArray(ae.daySessions)?ae.daySessions:[],arrangements:Array.isArray(ae.arrangements)?ae.arrangements:[],currentListVersion:Oe,subscription:ae.subscription||null,reminderSettings:ae.reminderSettings||cl,reminderNotifications:Array.isArray(ae.reminderNotifications)?ae.reminderNotifications:[],lastReminderProcessed:ae.lastReminderProcessed,bonusSettings:ae.bonusSettings||os,_schemaVersion:Bo};le.info("State loaded from IndexedDB:",{hasBonusSettings:!!q.bonusSettings,bonusSettings:q.bonusSettings}),r(q)}else r({...Nu,_schemaVersion:Bo})}catch(ae){le.error("Failed to load state from IndexedDB:",ae),r({...Nu,_schemaVersion:Bo})}finally{W&&l(!1)}})(),()=>{W=!1}},[]),Z.useEffect(()=>{if(s)return;const W=setTimeout(async()=>{try{const ae={...t,_schemaVersion:Bo};if(m.current){ae._ownerUserId=m.current;const oe=JSON.stringify({addressCount:t.addresses.length,completionCount:t.completions.length,listVersion:t.currentListVersion}),de=`${m.current}|${oe}`;ae._ownerChecksum=btoa(de).slice(0,32)}await Su.queuedSet(Au,ae)}catch(ae){le.error("Failed to persist state to IndexedDB:",ae)}},150);return()=>clearTimeout(W)},[t,s]);const S=Z.useCallback((W,ae,oe,de)=>{const ge=de||qs(W,ae,oe),Oe=new Date().toISOString(),q={id:ge,timestamp:Oe,type:"optimistic",operation:W,entity:ae,data:oe};return a(Ze=>{const Je=new Map(Ze.updates);return Je.set(ge,q),{updates:Je,pendingOperations:new Set([...Ze.pendingOperations,ge])}}),ge},[]),w=Z.useCallback((W,ae)=>{a(oe=>{const de=new Map(oe.updates),ge=new Set(oe.pendingOperations),Oe=de.get(W);return Oe&&de.set(W,{...Oe,type:"confirmed",data:ae||Oe.data}),ge.delete(W),{updates:de,pendingOperations:ge}}),setTimeout(()=>{a(oe=>{const de=new Map(oe.updates);return de.delete(W),{...oe,updates:de}})},5e3)},[]),E=Z.useCallback((W,ae)=>{le.debug(`Reverting optimistic update ${W}:`,ae),a(oe=>{const de=new Map(oe.updates),ge=new Set(oe.pendingOperations),Oe=de.get(W);return Oe&&de.set(W,{...Oe,type:"reverted"}),ge.delete(W),{updates:de,pendingOperations:ge}}),setTimeout(()=>{a(oe=>{const de=new Map(oe.updates);return de.delete(W),{...oe,updates:de}})},1e3)},[]),P=Z.useCallback(()=>{a({updates:new Map,pendingOperations:new Set})},[]),D=Z.useCallback((W,ae=!0)=>{le.info(`🔄 IMPORT START: Importing ${W.length} addresses, preserveCompletions=${ae}`);const oe=Date.now();localStorage.setItem("navigator_import_in_progress",oe.toString()),le.info("🛡️ IMPORT PROTECTION ACTIVATED:",new Date(oe).toISOString());const de=qs("update","address",{type:"bulk_import",count:W.length,preserve:ae}),ge=Array.isArray(W)?W.filter(km):[];if(le.info(`🔄 IMPORT VALIDATION: ${ge.length} valid out of ${W.length} total`),ge.length===0){le.warn("No valid addresses to import");return}S("update","address",{addresses:ge,bumpVersion:!0,preserveCompletions:ae},de),r(Oe=>{const q=(typeof Oe.currentListVersion=="number"?Oe.currentListVersion:1)+1;le.info(`🔄 IMPORT BASE STATE UPDATE: addresses=${ge.length}, preserveCompletions=${ae}, oldCompletions=${Oe.completions.length}, newListVersion=${q}`);const Ze={...Oe,addresses:ge,activeIndex:null,currentListVersion:q,completions:ae?Oe.completions:[]};return le.info(`🔄 IMPORT RESULT STATE: addresses=${Ze.addresses.length}, completions=${Ze.completions.length}, listVersion=${Ze.currentListVersion}`),Ze}),w(de),setTimeout(()=>{localStorage.removeItem("navigator_import_in_progress"),le.info("🛡️ IMPORT PROTECTION CLEARED after import completion")},2e3)},[S,w]),A=Z.useCallback(W=>new Promise(ae=>{if(!km(W)){ae(-1);return}const oe=qs("create","address",W);S("create","address",W,oe),r(de=>{const ge=[...de.addresses,W],Oe=ge.length-1;return w(oe),ae(Oe),{...de,addresses:ge}})}),[S,w]),H=Z.useCallback(W=>{localStorage.setItem("navigator_active_protection","true"),r(ae=>{const oe=ae.addresses[W];if(ae.activeIndex!==null&&ae.activeIndex!==W){const ge=ae.addresses[ae.activeIndex];return le.warn(`Cannot start address #${W} - address #${ae.activeIndex} "${ge?.address}" is already active`),Mu("Please complete or cancel the current active address first"),localStorage.removeItem("navigator_active_protection"),ae}if(oe&&ae.completions.some(Oe=>Oe.index===W&&(Oe.listVersion||ae.currentListVersion)===ae.currentListVersion))return le.warn(`Cannot set active - address at index ${W} is already completed`),Mu("This address is already completed"),localStorage.removeItem("navigator_active_protection"),ae;const de=new Date().toISOString();return le.info(`📍 STARTING CASE: Address #${W} "${oe?.address}" at ${de} - SYNC BLOCKED until Complete/Cancel`),{...ae,activeIndex:W,activeStartTime:de}})},[]),J=Z.useCallback(()=>{localStorage.removeItem("navigator_active_protection"),r(W=>(le.info("📍 CANCELING ACTIVE: Clearing active state - SYNC RESUMED"),{...W,activeIndex:null,activeStartTime:null}))},[]),[,B]=Z.useState(new Set),I=Z.useRef(new Set),ee=Z.useRef(new Map);Z.useEffect(()=>{const W=setInterval(()=>{const ae=Date.now()-3e4;let oe=0;for(const[de,ge]of ee.current.entries())ge.timestamp<ae&&(ee.current.delete(de),oe++);oe>0&&le.debug(`🧹 Cleaned up ${oe} old completion entries from memory`)},15e3);return()=>clearInterval(W)},[]);const re=Z.useCallback(async(W,ae,oe,de,ge,Oe)=>{if(!Number.isInteger(W)||W<0){const dt=`Invalid index: ${W}. Index must be a non-negative integer.`;throw le.error(dt),bc("Invalid address index. Please refresh and try again."),new Error(dt)}const q=t;if(W>=q.addresses.length){const dt=`Index ${W} out of bounds. Total addresses: ${q.addresses.length}`;throw le.error(dt),bc("Address not found. The list may have changed. Please refresh."),new Error(dt)}if(I.current.has(W))throw new Error(`Completion already pending for index ${W}`);const Ze=q.addresses[W];if(!Ze||!Ze.address){const dt=`Address at index ${W} is invalid or empty`;throw le.error(dt),bc("Invalid address data. Please refresh and try again."),new Error(dt)}const Je=q.completions.find(dt=>dt.address===Ze.address&&dt.listVersion===q.currentListVersion);if(Je){const dt=new Date(Je.timestamp).getTime(),Kt=Date.now()-dt;if(Kt<3e4)return Mu(`Address "${Ze.address}" was already completed ${Math.round(Kt/1e3)} seconds ago`),Promise.reject();console.log(`🔄 RE-COMPLETING: Address "${Ze.address}" was previously completed ${new Date(Je.timestamp).toLocaleString()}, allowing new completion`)}const Ye=new Date().toISOString();let nt;if(q.activeIndex===W&&q.activeStartTime){const dt=new Date(q.activeStartTime).getTime(),ht=new Date(Ye).getTime();nt=Math.floor((ht-dt)/1e3),le.info(`⏱️ CASE TIME TRACKED: ${Math.floor(nt/60)}m ${nt%60}s on "${Ze.address}"`)}const Be={index:W,address:Ze.address,lat:Ze.lat??null,lng:Ze.lng??null,outcome:ae,amount:oe,timestamp:Ye,listVersion:q.currentListVersion,arrangementId:de,caseReference:ge,timeSpentSeconds:nt,numberOfCases:Oe},bt=qs("create","completion",Be);try{I.current.add(W),B(new Set(I.current));const dt=`${W}_${ae}_${q.currentListVersion}`;return ee.current.set(dt,{timestamp:Date.now(),completion:Be}),S("create","completion",Be,bt),r(ht=>(ht.activeIndex===W&&(localStorage.removeItem("navigator_active_protection"),le.info("📍 COMPLETED ACTIVE ADDRESS: Clearing active state - SYNC RESUMED")),{...ht,completions:[Be,...ht.completions],activeIndex:ht.activeIndex===W?null:ht.activeIndex,activeStartTime:ht.activeIndex===W?null:ht.activeStartTime})),bt}finally{I.current.delete(W),B(new Set(I.current))}},[t,S]),ye=Z.useCallback(W=>{r(ae=>{const oe=ae.completions.slice();let de=-1,ge=0;for(let Oe=0;Oe<oe.length;Oe++){const q=oe[Oe];if(Number(q.index)===Number(W)&&q.listVersion===ae.currentListVersion){const Ze=new Date(q.timestamp).getTime();Ze>ge&&(ge=Ze,de=Oe)}}if(de>=0){const Oe=oe[de],q=qs("delete","completion",Oe);S("delete","completion",Oe,q),oe.splice(de,1),setTimeout(()=>w(q),0)}return{...ae,completions:oe}})},[S,w]),he=Z.useCallback(()=>{const W=new Date,ae=W.toISOString().slice(0,10);r(oe=>{if(oe.daySessions.find(q=>q.date===ae&&!q.end))return le.info("Day already active for today, skipping start"),oe;const ge=oe.daySessions.map(q=>q.date<ae&&!q.end?(le.info("Auto-closing stale session from previous day:",q),{...q,end:new Date(q.date+"T23:59:59.999Z").toISOString(),durationSeconds:Math.floor((new Date(q.date+"T23:59:59.999Z").getTime()-new Date(q.start).getTime())/1e3)}):q),Oe={date:ae,start:W.toISOString()};return le.info("Starting new day session:",Oe),{...oe,daySessions:[...ge,Oe]}})},[]),ce=Z.useCallback(()=>{const W=new Date,ae=W.toISOString().slice(0,10);r(oe=>{const{updatedSessions:de,closedSessions:ge,endedSession:Oe}=$2(oe.daySessions,ae,W);return ge.forEach(q=>le.info("Auto-closing stale day session before ending today",q)),Oe?(le.info("Ending day session:",Oe),{...oe,daySessions:de}):(le.info("No active session to end for today"),ge.length>0?{...oe,daySessions:de}:oe)})},[]),Ee=Z.useCallback(W=>new Promise(ae=>{const oe=new Date().toISOString(),de=`arr_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,ge={...W,id:de,createdAt:oe,updatedAt:oe},Oe=qs("create","arrangement",ge);S("create","arrangement",ge,Oe),r(q=>(setTimeout(()=>{w(Oe),ae(de)},0),{...q,arrangements:[...q.arrangements,ge]}))}),[S,w]),je=Z.useCallback((W,ae)=>new Promise(oe=>{const de=qs("update","arrangement",{id:W,...ae});r(ge=>{const Oe={...ae,id:W,updatedAt:new Date().toISOString()};S("update","arrangement",Oe,de);const q=ge.arrangements.map(Ze=>Ze.id===W?{...Ze,...ae,updatedAt:new Date().toISOString()}:Ze);return setTimeout(()=>{w(de),oe()},0),{...ge,arrangements:q}})}),[S,w]),fe=Z.useCallback(W=>new Promise(ae=>{r(oe=>{const de=oe.arrangements.find(q=>q.id===W);if(!de)return ae(),oe;const ge=qs("delete","arrangement",de);S("delete","arrangement",{id:W},ge);const Oe=oe.arrangements.filter(q=>q.id!==W);return setTimeout(()=>{w(ge),ae()},0),{...oe,arrangements:Oe}})}),[S,w]),ue=Z.useCallback(W=>{r(ae=>({...ae,subscription:W}))},[]),O=Z.useCallback(W=>{r(ae=>({...ae,reminderSettings:W}))},[]),F=Z.useCallback(W=>{r(ae=>({...ae,bonusSettings:W}))},[]),M=Z.useCallback((W,ae,oe)=>{r(de=>({...de,reminderNotifications:I2(de.reminderNotifications||[],W,ae,oe)}))},[]),ie=Z.useCallback(()=>{r(W=>{const ae=P2(W),oe=D2(ae,W.arrangements);return{...W,reminderNotifications:oe,lastReminderProcessed:new Date().toISOString()}})},[]);Z.useEffect(()=>{const W=setInterval(()=>{s||ie()},6e4);return()=>clearInterval(W)},[s,ie]);function Y(W){return W&&typeof W=="object"&&Array.isArray(W.addresses)&&Array.isArray(W.completions)&&"activeIndex"in W&&Array.isArray(W.daySessions)}const R=Z.useCallback(()=>({addresses:t.addresses,completions:t.completions,activeIndex:t.activeIndex,daySessions:t.daySessions,arrangements:t.arrangements,currentListVersion:t.currentListVersion}),[t]),z=Z.useCallback(async(W,ae="replace")=>{if(!Y(W))throw console.error("🚨 RESTORE VALIDATION FAILED:",{hasObj:!!W,type:typeof W,hasAddresses:W&&Array.isArray(W.addresses),hasCompletions:W&&Array.isArray(W.completions),hasActiveIndex:W&&"activeIndex"in W,hasDaySessions:W&&Array.isArray(W.daySessions),objKeys:W?Object.keys(W):null}),new Error("Invalid backup file format");const oe=typeof W.currentListVersion=="number"?W.currentListVersion:1,de=/Mobi|Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),ge="ontouchstart"in window||navigator.maxTouchPoints>0;console.log("📁 RESTORE DATA ANALYSIS:",{addressCount:W.addresses.length,completionCount:W.completions.length,arrangementCount:W.arrangements?.length||0,daySessionCount:W.daySessions?.length||0,activeIndex:W.activeIndex,listVersion:oe,mergeStrategy:ae,isMobile:de,isTouch:ge,userAgent:navigator.userAgent.substring(0,50)});const Oe={addresses:W.addresses,completions:Nx(W.completions,oe),activeIndex:W.activeIndex??null,daySessions:W.daySessions??[],arrangements:W.arrangements??[],currentListVersion:oe};console.log("📁 RESTORED STATE PREPARED:",{addressCount:Oe.addresses.length,completionCount:Oe.completions.length,arrangementCount:Oe.arrangements.length,daySessionCount:Oe.daySessions.length,activeIndex:Oe.activeIndex,listVersion:Oe.currentListVersion}),r(ae==="merge"?q=>({addresses:Oe.currentListVersion>=q.currentListVersion?Oe.addresses:q.addresses,currentListVersion:Math.max(Oe.currentListVersion,q.currentListVersion),completions:[...q.completions,...Oe.completions.filter(Je=>!q.completions.some(Ye=>Ye.timestamp===Je.timestamp&&Ye.index===Je.index&&Ye.outcome===Je.outcome))].sort((Je,Ye)=>new Date(Ye.timestamp).getTime()-new Date(Je.timestamp).getTime()),arrangements:Array.from(new Map([...q.arrangements.map(Je=>[Je.id,Je]),...Oe.arrangements.map(Je=>[Je.id,Je])].sort(([,Je],[,Ye])=>new Date(Ye.updatedAt).getTime()-new Date(Je.updatedAt).getTime())).values()),daySessions:Array.from(new Map([...q.daySessions.map(Je=>[Je.date,Je]),...Oe.daySessions.map(Je=>[Je.date,Je])]).values()),activeIndex:Oe.activeIndex??q.activeIndex}):Oe),P();try{const q={...Oe,_schemaVersion:Bo};if(console.log("💾 PERSISTING RESTORED STATE:",{addressCount:q.addresses.length,completionCount:q.completions.length,arrangementCount:q.arrangements.length,daySessionCount:q.daySessions.length,activeIndex:q.activeIndex,listVersion:q.currentListVersion,schemaVersion:q._schemaVersion}),"storage"in navigator&&"persist"in navigator.storage)try{const Ye=await navigator.storage.persist();console.log("📱 PERSISTENT STORAGE:",Ye?"GRANTED":"DENIED")}catch(Ye){console.warn("📱 PERSISTENT STORAGE REQUEST FAILED:",Ye)}if(await Su.queuedSet(Au,q),console.log("✅ RESTORED STATE PERSISTED TO INDEXEDDB"),"storage"in navigator&&"estimate"in navigator.storage)try{const Ye=await navigator.storage.estimate(),nt=Ye.usage&&Ye.quota?Math.round(Ye.usage/Ye.quota*100):"unknown";console.log("📊 STORAGE QUOTA:",{used:Ye.usage?`${Math.round(Ye.usage/1024/1024)}MB`:"unknown",total:Ye.quota?`${Math.round(Ye.quota/1024/1024)}MB`:"unknown",percentUsed:`${nt}%`})}catch(Ye){console.warn("📊 STORAGE QUOTA CHECK FAILED:",Ye)}const Ze=await Su.queuedGet(Au);console.log("🔍 VERIFICATION READ FROM INDEXEDDB:",{success:!!Ze,addressCount:Ze?.addresses?.length||0,completionCount:Ze?.completions?.length||0,arrangementCount:Ze?.arrangements?.length||0});const Je=Date.now();localStorage.setItem("navigator_restore_in_progress",Je.toString()),console.log("🛡️ RESTORE PROTECTION ACTIVATED:",new Date(Je).toISOString()),localStorage.setItem("navigator_last_restore",Je.toString())}catch(q){throw le.error("Failed to persist restored state:",q),new Error("Restore failed: Could not save data")}},[P]),U=Z.useCallback(W=>{const ae=localStorage.getItem("navigator_last_restore");if(ae){const oe=Date.now()-parseInt(ae);oe<36e5&&console.log("⚠️ STATE CHANGE AFTER RESTORE:",{timeSinceRestore:`${Math.round(oe/1e3)}s`,newStateType:typeof W,isFunction:typeof W=="function",timestamp:new Date().toISOString()})}r(oe=>{const de=typeof W=="function"?W(oe):W,ge=[...de.completions];let Oe=!1;const q=Date.now()-3e4;for(const[Ye,nt]of ee.current.entries())nt.timestamp<q&&ee.current.delete(Ye);for(const[Ye,nt]of ee.current.entries()){const{completion:Be,timestamp:bt}=nt;Date.now()-bt<3e4&&(ge.some(ht=>ht.index===Be.index&&ht.outcome===Be.outcome&&ht.listVersion===Be.listVersion&&Math.abs(new Date(ht.timestamp).getTime()-new Date(Be.timestamp).getTime())<1e3)||(le.info(`🛡️ PROTECTING RECENT COMPLETION: index=${Be.index}, outcome=${Be.outcome}`),ge.unshift(Be),Oe=!0))}let Ze=Oe?{...de,completions:ge.sort((Ye,nt)=>new Date(nt.timestamp).getTime()-new Date(Ye.timestamp).getTime())}:de;if(Ze.activeIndex!==null&&typeof Ze.activeIndex=="number"){const Ye=Ze.addresses[Ze.activeIndex];Ye?Ze.completions.some(Be=>Be.address===Ye.address&&(Be.listVersion||Ze.currentListVersion)===Ze.currentListVersion)&&(le.info(`🔄 CLEARING ACTIVE INDEX: Address "${Ye.address}" was completed on another device`),Xk(`Address "${Ye.address}" was completed on another device`),Ze={...Ze,activeIndex:null,activeStartTime:null}):(le.warn(`🔄 CLEARING INVALID activeIndex: Index ${Ze.activeIndex} is out of bounds (max: ${Ze.addresses.length-1})`),Ze={...Ze,activeIndex:null,activeStartTime:null})}const Je=new Map;return Ze.completions.forEach(Ye=>{const nt=oe.completions.find(Be=>Be.index===Ye.index&&Be.outcome===Ye.outcome&&Math.abs(new Date(Be.timestamp).getTime()-new Date(Ye.timestamp).getTime())<5e3);nt&&nt.timestamp!==Ye.timestamp&&Je.set(`completion_${Ye.timestamp}`,{type:"completion",incoming:Ye,existing:nt,resolution:"prefer_incoming"})}),Ze.arrangements.forEach(Ye=>{const nt=oe.arrangements.find(Be=>Be.id===Ye.id);if(nt&&nt.updatedAt!==Ye.updatedAt){const Be=new Date(Ye.updatedAt).getTime(),bt=new Date(nt.updatedAt).getTime();Je.set(`arrangement_${Ye.id}`,{type:"arrangement",incoming:Ye,existing:nt,resolution:Be>bt?"prefer_incoming":"prefer_existing"})}}),Je.size>0&&(le.debug("Detected state conflicts:",Je.size),y(Je)),Ze}),P()},[P]),te=Z.useCallback((W,ae,oe,de)=>S(ae,W,oe,de),[S]);return{state:p,baseState:t,loading:s,setState:U,setBaseState:r,deviceId:d,enqueueOp:te,ownerMetadata:_,optimisticUpdates:n.updates,pendingOperations:n.pendingOperations,confirmOptimisticUpdate:w,revertOptimisticUpdate:E,clearOptimisticUpdates:P,conflicts:g,resolveConflict:(W,ae)=>{y(oe=>{const de=new Map(oe);return de.delete(W),de})},setAddresses:D,addAddress:A,setActive:H,cancelActive:J,complete:re,undo:ye,startDay:he,endDay:ce,addArrangement:Ee,updateArrangement:je,deleteArrangement:fe,setSubscription:ue,backupState:R,restoreState:z,updateReminderSettings:O,updateReminderNotification:M,processReminders:ie,updateBonusSettings:F}}function sh(e){const t=e??{},r=typeof t.currentListVersion=="number"?t.currentListVersion:1;return{...t,addresses:Array.isArray(t.addresses)?t.addresses:[],completions:Array.isArray(t.completions)?t.completions:[],arrangements:Array.isArray(t.arrangements)?t.arrangements:[],daySessions:Array.isArray(t.daySessions)?t.daySessions:[],activeIndex:typeof t.activeIndex=="number"?t.activeIndex:null,currentListVersion:r}}function Sm(e){const t=e??{};return{addresses:Array.isArray(t.addresses)?t.addresses:[],completions:Array.isArray(t.completions)?t.completions:[],arrangements:Array.isArray(t.arrangements)?t.arrangements:[],activeIndex:typeof t.activeIndex=="number"?t.activeIndex:null,currentListVersion:typeof t.currentListVersion=="number"?t.currentListVersion:1}}function qo(e){const t=a=>{if(!a||typeof a!="object"||Array.isArray(a))return!1;const s=Object.getPrototypeOf(a);return s===Object.prototype||s===null},r=JSON.stringify(e,(a,s)=>{if(!s||typeof s!="object")return s;if(s instanceof Date)return s.toISOString();if(typeof s.toJSON=="function"&&!t(s))return s.toJSON(a);if(t(s)){const l={};return Object.keys(s).sort().forEach(d=>{l[d]=s[d]}),l}return s});let n=0;for(let a=0;a<r.length;a++){const s=r.charCodeAt(a);n=(n<<5)-n+s,n=n&n}return n.toString()}class Ei{static generateDeviceFingerprint(){try{const t=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,navigator.hardwareConcurrency||"unknown"];return`device_${btoa(t.join("|")).replace(/[^a-zA-Z0-9]/g,"").slice(0,16)}_${Date.now()}`}catch{return`device_fallback_${Date.now()}_${Math.random().toString(36).slice(2,8)}`}}static analyzeDataOwnership(t,r,n,a){const s={hasLocalData:this.hasSignificantLocalData(t),hasCloudData:n?this.hasSignificantLocalData(n):!1,localDataAge:this.estimateDataAge(t),userInLocalData:this.findUserSignalsInData(t,r,a),cloudUserMatch:n?this.findUserSignalsInData(n,r):null,hasOwnerSignature:!!a?.ownerUserId,signatureMatches:a?.ownerUserId===r.id};return le.info("User detection signals:",s),s.hasOwnerSignature?s.signatureMatches?{isOwner:!0,confidence:"high",reason:"Owner signature matches current user",action:"sync"}:{isOwner:!1,confidence:"high",reason:"Owner signature belongs to different user",action:"backup_and_clear"}:s.hasCloudData&&s.cloudUserMatch?s.hasLocalData?s.userInLocalData?{isOwner:!0,confidence:"high",reason:"Both local and cloud data belong to user",action:"sync"}:{isOwner:!0,confidence:"medium",reason:"Cloud data belongs to user, local data unclear",action:"preserve_and_ask"}:{isOwner:!0,confidence:"high",reason:"Cloud data exists for user, no local conflict",action:"sync"}:s.hasLocalData&&s.userInLocalData?{isOwner:!0,confidence:"medium",reason:"Local data appears to belong to current user",action:"sync"}:s.hasLocalData&&!s.userInLocalData&&!s.hasCloudData?{isOwner:!1,confidence:"low",reason:"Local data has no user identification",action:"preserve_and_ask"}:{isOwner:!0,confidence:"low",reason:"Unclear ownership - preserving data for safety",action:"preserve_and_ask"}}static hasSignificantLocalData(t){const r=Array.isArray(t.addresses)?t.addresses.length:0,n=Array.isArray(t.completions)?t.completions.length:0,a=Array.isArray(t.arrangements)?t.arrangements.length:0;return r>5||n>0||a>0}static estimateDataAge(t){try{const r=Array.isArray(t.completions)?t.completions:[],n=Array.isArray(t.arrangements)?t.arrangements:[],a=[...r.map(d=>d.timestamp),...n.map(d=>d.updatedAt||d.createdAt)].filter(Boolean);if(a.length===0)return"unknown";const s=Math.max(...a.map(d=>new Date(d).getTime())),l=(Date.now()-s)/(1e3*60*60);return l<24?"recent":(l<168,"old")}catch{return"unknown"}}static findUserSignalsInData(t,r,n){try{if(n?.ownerUserId){const l=n.ownerUserId===r.id;return le.info(`Owner signature check: ${l?"MATCH":"MISMATCH"}`,{stored:n.ownerUserId,current:r.id}),l}le.warn("No owner signature found - using legacy heuristics (less reliable)");const a=Array.isArray(t.arrangements)?t.arrangements:[],s=r.email?.toLowerCase();return!!(s&&a.some(d=>d.customerName?.toLowerCase().includes(s)||d.notes?.toLowerCase().includes(s)))}catch{return!1}}static storeDeviceContext(t){try{const r={userId:t.id,email:t.email||void 0,deviceId:this.generateDeviceFingerprint(),sessionStart:new Date().toISOString()};localStorage.setItem("navigator_device_context",JSON.stringify(r));const n=qo(r);localStorage.setItem("navigator_device_context_checksum",n),le.info("Device context stored:",{userId:r.userId,deviceId:r.deviceId})}catch(r){le.error("Failed to store device context:",r)}}static getDeviceContext(){try{const t=localStorage.getItem("navigator_device_context"),r=localStorage.getItem("navigator_device_context_checksum");if(!t)return null;const n=JSON.parse(t);return r&&qo(n)!==r?(le.warn("Device context checksum mismatch - data may be corrupted"),null):n}catch(t){return le.error("Failed to get device context:",t),null}}static clearDeviceContext(){try{localStorage.removeItem("navigator_device_context"),localStorage.removeItem("navigator_device_context_checksum")}catch(t){le.error("Failed to clear device context:",t)}}}const G2=Object.freeze(Object.defineProperty({__proto__:null,SmartUserDetection:Ei},Symbol.toStringTag,{value:"Module"})),K2=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>oi(async()=>{const{default:n}=await Promise.resolve().then(()=>Fc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Cp extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Z2 extends Cp{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Ix extends Cp{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Dx extends Cp{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Jm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Jm||(Jm={}));var Y2=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function d(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(d,m)}p((n=n.apply(e,t||[])).next())})};class q2{constructor(t,{headers:r={},customFetch:n,region:a=Jm.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=K2(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Y2(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:l}=r;let d={},{region:m}=r;m||(m=this.region);const p=new URL(`${this.url}/${t}`);m&&m!=="any"&&(d["x-region"]=m,p.searchParams.set("forceFunctionRegion",m));let g;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(d["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(d["Content-Type"]="application/json",g=JSON.stringify(l)));const y=yield this.fetch(p.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),a),body:g}).catch(w=>{throw new Z2(w)}),_=y.headers.get("x-relay-error");if(_&&_==="true")throw new Ix(y);if(!y.ok)throw new Dx(y);let T=((n=y.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),S;return T==="application/json"?S=yield y.json():T==="application/octet-stream"?S=yield y.blob():T==="text/event-stream"?S=y:T==="multipart/form-data"?S=yield y.formData():S=yield y.text(),{data:S,error:null,response:y}}catch(a){return{data:null,error:a,response:a instanceof Dx||a instanceof Ix?a.context:void 0}}})}}var Qr={},rc={},nc={},ac={},ic={},sc={},X2=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Nc=X2();const J2=Nc.fetch,Hy=Nc.fetch.bind(Nc),Vy=Nc.Headers,Q2=Nc.Request,eT=Nc.Response,Fc=Object.freeze(Object.defineProperty({__proto__:null,Headers:Vy,Request:Q2,Response:eT,default:Hy,fetch:J2},Symbol.toStringTag,{value:"Module"})),tT=jk(Fc);var Mf={},Fx;function Gy(){if(Fx)return Mf;Fx=1,Object.defineProperty(Mf,"__esModule",{value:!0});class e extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Mf.default=e,Mf}var jx;function Ky(){if(jx)return sc;jx=1;var e=sc&&sc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(sc,"__esModule",{value:!0});const t=e(tT),r=e(Gy());class n{constructor(s){var l,d;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(l=s.shouldThrowOnError)!==null&&l!==void 0?l:!1,this.signal=s.signal,this.isMaybeSingle=(d=s.isMaybeSingle)!==null&&d!==void 0?d:!1,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=t.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,l){return this.headers=new Headers(this.headers),this.headers.set(s,l),this}then(s,l){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const d=this.fetch;let m=d(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async p=>{var g,y,_,T;let S=null,w=null,E=null,P=p.status,D=p.statusText;if(p.ok){if(this.method!=="HEAD"){const B=await p.text();B===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((g=this.headers.get("Accept"))===null||g===void 0)&&g.includes("application/vnd.pgrst.plan+text"))?w=B:w=JSON.parse(B))}const H=(y=this.headers.get("Prefer"))===null||y===void 0?void 0:y.match(/count=(exact|planned|estimated)/),J=(_=p.headers.get("content-range"))===null||_===void 0?void 0:_.split("/");H&&J&&J.length>1&&(E=parseInt(J[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(S={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,E=null,P=406,D="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const H=await p.text();try{S=JSON.parse(H),Array.isArray(S)&&p.status===404&&(w=[],S=null,P=200,D="OK")}catch{p.status===404&&H===""?(P=204,D="No Content"):S={message:H}}if(S&&this.isMaybeSingle&&(!((T=S?.details)===null||T===void 0)&&T.includes("0 rows"))&&(S=null,P=200,D="OK"),S&&this.shouldThrowOnError)throw new r.default(S)}return{error:S,data:w,count:E,status:P,statusText:D}});return this.shouldThrowOnError||(m=m.catch(p=>{var g,y,_;return{error:{message:`${(g=p?.name)!==null&&g!==void 0?g:"FetchError"}: ${p?.message}`,details:`${(y=p?.stack)!==null&&y!==void 0?y:""}`,hint:"",code:`${(_=p?.code)!==null&&_!==void 0?_:""}`},data:null,count:null,status:0,statusText:""}})),m.then(s,l)}returns(){return this}overrideTypes(){return this}}return sc.default=n,sc}var Ox;function Zy(){if(Ox)return ic;Ox=1;var e=ic&&ic.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ic,"__esModule",{value:!0});const t=e(Ky());class r extends t.default{select(a){let s=!1;const l=(a??"*").split("").map(d=>/\s/.test(d)&&!s?"":(d==='"'&&(s=!s),d)).join("");return this.url.searchParams.set("select",l),this.headers.append("Prefer","return=representation"),this}order(a,{ascending:s=!0,nullsFirst:l,foreignTable:d,referencedTable:m=d}={}){const p=m?`${m}.order`:"order",g=this.url.searchParams.get(p);return this.url.searchParams.set(p,`${g?`${g},`:""}${a}.${s?"asc":"desc"}${l===void 0?"":l?".nullsfirst":".nullslast"}`),this}limit(a,{foreignTable:s,referencedTable:l=s}={}){const d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(d,`${a}`),this}range(a,s,{foreignTable:l,referencedTable:d=l}={}){const m=typeof d>"u"?"offset":`${d}.offset`,p=typeof d>"u"?"limit":`${d}.limit`;return this.url.searchParams.set(m,`${a}`),this.url.searchParams.set(p,`${s-a+1}`),this}abortSignal(a){return this.signal=a,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:a=!1,verbose:s=!1,settings:l=!1,buffers:d=!1,wal:m=!1,format:p="text"}={}){var g;const y=[a?"analyze":null,s?"verbose":null,l?"settings":null,d?"buffers":null,m?"wal":null].filter(Boolean).join("|"),_=(g=this.headers.get("Accept"))!==null&&g!==void 0?g:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${p}; for="${_}"; options=${y};`),p==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(a){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${a}`),this}}return ic.default=r,ic}var Rx;function Ap(){if(Rx)return ac;Rx=1;var e=ac&&ac.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(ac,"__esModule",{value:!0});const t=e(Zy());class r extends t.default{eq(a,s){return this.url.searchParams.append(a,`eq.${s}`),this}neq(a,s){return this.url.searchParams.append(a,`neq.${s}`),this}gt(a,s){return this.url.searchParams.append(a,`gt.${s}`),this}gte(a,s){return this.url.searchParams.append(a,`gte.${s}`),this}lt(a,s){return this.url.searchParams.append(a,`lt.${s}`),this}lte(a,s){return this.url.searchParams.append(a,`lte.${s}`),this}like(a,s){return this.url.searchParams.append(a,`like.${s}`),this}likeAllOf(a,s){return this.url.searchParams.append(a,`like(all).{${s.join(",")}}`),this}likeAnyOf(a,s){return this.url.searchParams.append(a,`like(any).{${s.join(",")}}`),this}ilike(a,s){return this.url.searchParams.append(a,`ilike.${s}`),this}ilikeAllOf(a,s){return this.url.searchParams.append(a,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(a,s){return this.url.searchParams.append(a,`ilike(any).{${s.join(",")}}`),this}is(a,s){return this.url.searchParams.append(a,`is.${s}`),this}in(a,s){const l=Array.from(new Set(s)).map(d=>typeof d=="string"&&new RegExp("[,()]").test(d)?`"${d}"`:`${d}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cs.{${s.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(s)}`),this}containedBy(a,s){return typeof s=="string"?this.url.searchParams.append(a,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(a,`cd.{${s.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(s)}`),this}rangeGt(a,s){return this.url.searchParams.append(a,`sr.${s}`),this}rangeGte(a,s){return this.url.searchParams.append(a,`nxl.${s}`),this}rangeLt(a,s){return this.url.searchParams.append(a,`sl.${s}`),this}rangeLte(a,s){return this.url.searchParams.append(a,`nxr.${s}`),this}rangeAdjacent(a,s){return this.url.searchParams.append(a,`adj.${s}`),this}overlaps(a,s){return typeof s=="string"?this.url.searchParams.append(a,`ov.${s}`):this.url.searchParams.append(a,`ov.{${s.join(",")}}`),this}textSearch(a,s,{config:l,type:d}={}){let m="";d==="plain"?m="pl":d==="phrase"?m="ph":d==="websearch"&&(m="w");const p=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${m}fts${p}.${s}`),this}match(a){return Object.entries(a).forEach(([s,l])=>{this.url.searchParams.append(s,`eq.${l}`)}),this}not(a,s,l){return this.url.searchParams.append(a,`not.${s}.${l}`),this}or(a,{foreignTable:s,referencedTable:l=s}={}){const d=l?`${l}.or`:"or";return this.url.searchParams.append(d,`(${a})`),this}filter(a,s,l){return this.url.searchParams.append(a,`${s}.${l}`),this}}return ac.default=r,ac}var Lx;function Yy(){if(Lx)return nc;Lx=1;var e=nc&&nc.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(nc,"__esModule",{value:!0});const t=e(Ap());class r{constructor(a,{headers:s={},schema:l,fetch:d}){this.url=a,this.headers=new Headers(s),this.schema=l,this.fetch=d}select(a,{head:s=!1,count:l}={}){const d=s?"HEAD":"GET";let m=!1;const p=(a??"*").split("").map(g=>/\s/.test(g)&&!m?"":(g==='"'&&(m=!m),g)).join("");return this.url.searchParams.set("select",p),l&&this.headers.append("Prefer",`count=${l}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(a,{count:s,defaultToNull:l=!0}={}){var d;const m="POST";if(s&&this.headers.append("Prefer",`count=${s}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const p=a.reduce((g,y)=>g.concat(Object.keys(y)),[]);if(p.length>0){const g=[...new Set(p)].map(y=>`"${y}"`);this.url.searchParams.set("columns",g.join(","))}}return new t.default({method:m,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}upsert(a,{onConflict:s,ignoreDuplicates:l=!1,count:d,defaultToNull:m=!0}={}){var p;const g="POST";if(this.headers.append("Prefer",`resolution=${l?"ignore":"merge"}-duplicates`),s!==void 0&&this.url.searchParams.set("on_conflict",s),d&&this.headers.append("Prefer",`count=${d}`),m||this.headers.append("Prefer","missing=default"),Array.isArray(a)){const y=a.reduce((_,T)=>_.concat(Object.keys(T)),[]);if(y.length>0){const _=[...new Set(y)].map(T=>`"${T}"`);this.url.searchParams.set("columns",_.join(","))}}return new t.default({method:g,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}update(a,{count:s}={}){var l;const d="PATCH";return s&&this.headers.append("Prefer",`count=${s}`),new t.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:a,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}delete({count:a}={}){var s;const l="DELETE";return a&&this.headers.append("Prefer",`count=${a}`),new t.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}}return nc.default=r,nc}var Mx;function rT(){if(Mx)return rc;Mx=1;var e=rc&&rc.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(rc,"__esModule",{value:!0});const t=e(Yy()),r=e(Ap());class n{constructor(s,{headers:l={},schema:d,fetch:m}={}){this.url=s,this.headers=new Headers(l),this.schemaName=d,this.fetch=m}from(s){const l=new URL(`${this.url}/${s}`);return new t.default(l,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(s){return new n(this.url,{headers:this.headers,schema:s,fetch:this.fetch})}rpc(s,l={},{head:d=!1,get:m=!1,count:p}={}){var g;let y;const _=new URL(`${this.url}/rpc/${s}`);let T;d||m?(y=d?"HEAD":"GET",Object.entries(l).filter(([w,E])=>E!==void 0).map(([w,E])=>[w,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([w,E])=>{_.searchParams.append(w,E)})):(y="POST",T=l);const S=new Headers(this.headers);return p&&S.set("Prefer",`count=${p}`),new r.default({method:y,url:_,headers:S,schema:this.schemaName,body:T,fetch:(g=this.fetch)!==null&&g!==void 0?g:fetch})}}return rc.default=n,rc}var Bx;function nT(){if(Bx)return Qr;Bx=1;var e=Qr&&Qr.__importDefault||function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(Qr,"__esModule",{value:!0}),Qr.PostgrestError=Qr.PostgrestBuilder=Qr.PostgrestTransformBuilder=Qr.PostgrestFilterBuilder=Qr.PostgrestQueryBuilder=Qr.PostgrestClient=void 0;const t=e(rT());Qr.PostgrestClient=t.default;const r=e(Yy());Qr.PostgrestQueryBuilder=r.default;const n=e(Ap());Qr.PostgrestFilterBuilder=n.default;const a=e(Zy());Qr.PostgrestTransformBuilder=a.default;const s=e(Ky());Qr.PostgrestBuilder=s.default;const l=e(Gy());return Qr.PostgrestError=l.default,Qr.default={PostgrestClient:t.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:a.default,PostgrestBuilder:s.default,PostgrestError:l.default},Qr}var aT=nT();const iT=Ph(aT),{PostgrestClient:sT,PostgrestQueryBuilder:w8,PostgrestFilterBuilder:b8,PostgrestTransformBuilder:k8,PostgrestBuilder:S8,PostgrestError:T8}=iT;class oT{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const lT="2.15.1",cT=`realtime-js/${lT}`,uT="1.0.0",Qm=1e4,dT=1e3,fT=100;var Bu;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Bu||(Bu={}));var Vr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Vr||(Vr={}));var ri;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(ri||(ri={}));var ep;(function(e){e.websocket="websocket"})(ep||(ep={}));var Go;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Go||(Go={}));class hT{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let l=this.HEADER_LENGTH+2;const d=n.decode(t.slice(l,l+a));l=l+a;const m=n.decode(t.slice(l,l+s));l=l+s;const p=JSON.parse(n.decode(t.slice(l,t.byteLength)));return{ref:null,topic:d,event:m,payload:p}}}class qy{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var cr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(cr||(cr={}));const zx=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,l)=>(s[l]=mT(l,e,t,a),s),{})},mT=(e,t,r,n)=>{const a=t.find(d=>d.name===e),s=a?.type,l=r[e];return s&&!n.includes(s)?Xy(s,l):tp(l)},Xy=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return xT(t,r)}switch(e){case cr.bool:return pT(t);case cr.float4:case cr.float8:case cr.int2:case cr.int4:case cr.int8:case cr.numeric:case cr.oid:return gT(t);case cr.json:case cr.jsonb:return vT(t);case cr.timestamp:return yT(t);case cr.abstime:case cr.date:case cr.daterange:case cr.int4range:case cr.int8range:case cr.money:case cr.reltime:case cr.text:case cr.time:case cr.timestamptz:case cr.timetz:case cr.tsrange:case cr.tstzrange:return tp(t);default:return tp(t)}},tp=e=>e,pT=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},gT=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},vT=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},xT=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const l=e.slice(1,r);try{s=JSON.parse("["+l+"]")}catch{s=l?l.split(","):[]}return s.map(d=>Xy(t,d))}return e},yT=e=>typeof e=="string"?e.replace(" ","T"):e,Jy=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Tm{constructor(t,r,n={},a=Qm){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Ux;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Ux||(Ux={}));class zu{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:l,onSync:d}=this.caller;this.joinRef=this.channel._joinRef(),this.state=zu.syncState(this.state,a,s,l),this.pendingDiffs.forEach(m=>{this.state=zu.syncDiff(this.state,m,s,l)}),this.pendingDiffs=[],d()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:l,onSync:d}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=zu.syncDiff(this.state,a,s,l),d())}),this.onJoin((a,s,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:l})}),this.onLeave((a,s,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),l=this.transformState(r),d={},m={};return this.map(s,(p,g)=>{l[p]||(m[p]=g)}),this.map(l,(p,g)=>{const y=s[p];if(y){const _=g.map(E=>E.presence_ref),T=y.map(E=>E.presence_ref),S=g.filter(E=>T.indexOf(E.presence_ref)<0),w=y.filter(E=>_.indexOf(E.presence_ref)<0);S.length>0&&(d[p]=S),w.length>0&&(m[p]=w)}else d[p]=g}),this.syncDiff(s,{joins:d,leaves:m},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(d,m)=>{var p;const g=(p=t[d])!==null&&p!==void 0?p:[];if(t[d]=this.cloneDeep(m),g.length>0){const y=t[d].map(T=>T.presence_ref),_=g.filter(T=>y.indexOf(T.presence_ref)<0);t[d].unshift(..._)}n(d,g,m)}),this.map(l,(d,m)=>{let p=t[d];if(!p)return;const g=m.map(y=>y.presence_ref);p=p.filter(y=>g.indexOf(y.presence_ref)<0),t[d]=p,a(d,p,m),p.length===0&&delete t[d]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $x;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})($x||($x={}));var Uu;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Uu||(Uu={}));var as;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(as||(as={}));class Np{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Vr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Tm(this,ri.join,this.params,this.timeout),this.rejoinTimer=new qy(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Vr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Vr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Vr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Vr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Vr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ri.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new zu(this),this.broadcastEndpointURL=Jy(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Vr.closed){const{config:{broadcast:s,presence:l,private:d}}=this.params,m=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(_=>_.filter))!==null&&a!==void 0?a:[],p=!!this.bindings[Uu.PRESENCE]&&this.bindings[Uu.PRESENCE].length>0,g={},y={broadcast:s,presence:Object.assign(Object.assign({},l),{enabled:p}),postgres_changes:m,private:d};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(_=>t?.(as.CHANNEL_ERROR,_)),this._onClose(()=>t?.(as.CLOSED)),this.updateJoinPayload(Object.assign({config:y},g)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:_})=>{var T;if(this.socket.setAuth(),_===void 0){t?.(as.SUBSCRIBED);return}else{const S=this.bindings.postgres_changes,w=(T=S?.length)!==null&&T!==void 0?T:0,E=[];for(let P=0;P<w;P++){const D=S[P],{filter:{event:A,schema:H,table:J,filter:B}}=D,I=_&&_[P];if(I&&I.event===A&&I.schema===H&&I.table===J&&I.filter===B)E.push(Object.assign(Object.assign({},D),{id:I.id}));else{this.unsubscribe(),this.state=Vr.errored,t?.(as.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,t&&t(as.SUBSCRIBED);return}}).receive("error",_=>{this.state=Vr.errored,t?.(as.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(_).join(", ")||"error")))}).receive("timeout",()=>{t?.(as.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Vr.joined&&t===Uu.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:l}=t,m={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:l,private:this.private}]})};try{const p=await this._fetchWithTimeout(this.broadcastEndpointURL,m,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=p.body)===null||a===void 0?void 0:a.cancel()),p.ok?"ok":"error"}catch(p){return p.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var l,d,m;const p=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((m=(d=(l=this.params)===null||l===void 0?void 0:l.config)===null||d===void 0?void 0:d.broadcast)===null||m===void 0)&&m.ack)&&s("ok"),p.receive("ok",()=>s("ok")),p.receive("error",()=>s("error")),p.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Vr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ri.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Tm(this,ri.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Vr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Tm(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>fT){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const l=t.toLocaleLowerCase(),{close:d,error:m,leave:p,join:g}=ri;if(n&&[d,m,p,g].indexOf(l)>=0&&n!==this._joinRef())return;let _=this._onMessage(l,r,n);if(r&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(T=>{var S,w,E;return((S=T.filter)===null||S===void 0?void 0:S.event)==="*"||((E=(w=T.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===l}).map(T=>T.callback(_,n)):(s=this.bindings[l])===null||s===void 0||s.filter(T=>{var S,w,E,P,D,A;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in T){const H=T.id,J=(S=T.filter)===null||S===void 0?void 0:S.event;return H&&((w=r.ids)===null||w===void 0?void 0:w.includes(H))&&(J==="*"||J?.toLocaleLowerCase()===((E=r.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const H=(D=(P=T?.filter)===null||P===void 0?void 0:P.event)===null||D===void 0?void 0:D.toLocaleLowerCase();return H==="*"||H===((A=r?.event)===null||A===void 0?void 0:A.toLocaleLowerCase())}else return T.type.toLocaleLowerCase()===l}).map(T=>{if(typeof _=="object"&&"ids"in _){const S=_.data,{schema:w,table:E,commit_timestamp:P,type:D,errors:A}=S;_=Object.assign(Object.assign({},{schema:w,table:E,commit_timestamp:P,eventType:D,new:{},old:{},errors:A}),this._getPayloadRecords(S))}T.callback(_,n)})}_isClosed(){return this.state===Vr.closed}_isJoined(){return this.state===Vr.joined}_isJoining(){return this.state===Vr.joining}_isLeaving(){return this.state===Vr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Np.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(ri.close,{},t)}_onError(t){this._on(ri.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Vr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=zx(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=zx(t.columns,t.old_record)),r}}const Wx=()=>{},Bf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},_T=[1e3,2e3,5e3,1e4],wT=1e4,bT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class kT{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Qm,this.transport=null,this.heartbeatIntervalMs=Bf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Wx,this.ref=0,this.reconnectTimer=null,this.logger=Wx,this.conn=null,this.sendBuffer=[],this.serializer=new hT,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...l)=>oi(async()=>{const{default:d}=await Promise.resolve().then(()=>Fc);return{default:d}},void 0).then(({default:d})=>d(...l)).catch(d=>{throw new Error(`Failed to load @supabase/node-fetch: ${d.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...l)=>s(...l)},!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${ep.websocket}`,this.httpEndpoint=Jy(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=oT.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:uT}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Bu.connecting:return Go.Connecting;case Bu.open:return Go.Open;case Bu.closing:return Go.Closing;default:return Go.Closed}}isConnected(){return this.connectionState()===Go.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new Np(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,l=()=>{this.encode(t,d=>{var m;(m=this.conn)===null||m===void 0||m.send(d)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(dT,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Bf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:l}=r,d=l?`(${l})`:"",m=s.status||"";this.log("receive",`${m} ${n} ${a} ${d}`.trim(),s),this.channels.filter(p=>p._isMember(n)).forEach(p=>p._trigger(a,s,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(ri.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([bT],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:cT};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(ri.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new qy(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Bf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,l,d,m,p;if(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Qm,this.heartbeatIntervalMs=(a=t?.heartbeatIntervalMs)!==null&&a!==void 0?a:Bf.HEARTBEAT_INTERVAL,this.worker=(s=t?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(l=t?.accessToken)!==null&&l!==void 0?l:null,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t?.reconnectAfterMs)!==null&&d!==void 0?d:(g=>_T[g-1]||wT),this.encode=(m=t?.encode)!==null&&m!==void 0?m:((g,y)=>y(JSON.stringify(g))),this.decode=(p=t?.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}class Pp extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Gr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class ST extends Pp{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class rp extends Pp{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var TT=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function d(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(d,m)}p((n=n.apply(e,t||[])).next())})};const Qy=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>oi(async()=>{const{default:n}=await Promise.resolve().then(()=>Fc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},ET=()=>TT(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield oi(()=>Promise.resolve().then(()=>Fc),void 0)).Response:Response}),np=e=>{if(Array.isArray(e))return e.map(r=>np(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=np(n)}),t},CT=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var ul=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function d(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(d,m)}p((n=n.apply(e,t||[])).next())})};const Em=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),AT=(e,t,r)=>ul(void 0,void 0,void 0,function*(){const n=yield ET();e instanceof n&&!r?.noResolveJson?e.json().then(a=>{const s=e.status||500,l=a?.statusCode||s+"";t(new ST(Em(a),s,l))}).catch(a=>{t(new rp(Em(a),a))}):t(new rp(Em(e),e))}),NT=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"||!n?a:(CT(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t?.headers),a.body=JSON.stringify(n)):a.body=n,t?.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function xd(e,t,r,n,a,s){return ul(this,void 0,void 0,function*(){return new Promise((l,d)=>{e(r,NT(t,n,a,s)).then(m=>{if(!m.ok)throw m;return n?.noResolveJson?m:m.json()}).then(m=>l(m)).catch(m=>AT(m,d,n))})})}function mh(e,t,r,n){return ul(this,void 0,void 0,function*(){return xd(e,"GET",t,r,n)})}function Ni(e,t,r,n,a){return ul(this,void 0,void 0,function*(){return xd(e,"POST",t,n,a,r)})}function ap(e,t,r,n,a){return ul(this,void 0,void 0,function*(){return xd(e,"PUT",t,n,a,r)})}function PT(e,t,r,n){return ul(this,void 0,void 0,function*(){return xd(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function e_(e,t,r,n,a){return ul(this,void 0,void 0,function*(){return xd(e,"DELETE",t,n,a,r)})}var Mn=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function d(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(d,m)}p((n=n.apply(e,t||[])).next())})};const IT={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Hx={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class DT{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Qy(a)}uploadOrUpdate(t,r,n,a){return Mn(this,void 0,void 0,function*(){try{let s;const l=Object.assign(Object.assign({},Hx),a);let d=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(l.upsert)});const m=l.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",l.cacheControl),m&&s.append("metadata",this.encodeMetadata(m)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",l.cacheControl),m&&s.append("metadata",this.encodeMetadata(m))):(s=n,d["cache-control"]=`max-age=${l.cacheControl}`,d["content-type"]=l.contentType,m&&(d["x-metadata"]=this.toBase64(this.encodeMetadata(m)))),a?.headers&&(d=Object.assign(Object.assign({},d),a.headers));const p=this._removeEmptyFolders(r),g=this._getFinalPath(p),y=yield(t=="PUT"?ap:Ni)(this.fetch,`${this.url}/object/${g}`,s,Object.assign({headers:d},l?.duplex?{duplex:l.duplex}:{}));return{data:{path:p,id:y.Id,fullPath:y.Key},error:null}}catch(s){if(Gr(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Mn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Mn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),l=this._getFinalPath(s),d=new URL(this.url+`/object/upload/sign/${l}`);d.searchParams.set("token",r);try{let m;const p=Object.assign({upsert:Hx.upsert},a),g=Object.assign(Object.assign({},this.headers),{"x-upsert":String(p.upsert)});typeof Blob<"u"&&n instanceof Blob?(m=new FormData,m.append("cacheControl",p.cacheControl),m.append("",n)):typeof FormData<"u"&&n instanceof FormData?(m=n,m.append("cacheControl",p.cacheControl)):(m=n,g["cache-control"]=`max-age=${p.cacheControl}`,g["content-type"]=p.contentType);const y=yield ap(this.fetch,d.toString(),m,{headers:g});return{data:{path:s,fullPath:y.Key},error:null}}catch(m){if(Gr(m))return{data:null,error:m};throw m}})}createSignedUploadUrl(t,r){return Mn(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r?.upsert&&(a["x-upsert"]="true");const s=yield Ni(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),l=new URL(this.url+s.url),d=l.searchParams.get("token");if(!d)throw new Pp("No token returned by API");return{data:{signedUrl:l.toString(),path:t,token:d},error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}update(t,r,n){return Mn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Mn(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Mn(this,void 0,void 0,function*(){try{return{data:{path:(yield Ni(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Mn(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Ni(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const l=n?.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${l}`)},{data:s,error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Mn(this,void 0,void 0,function*(){try{const a=yield Ni(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(l=>Object.assign(Object.assign({},l),{signedUrl:l.signedURL?encodeURI(`${this.url}${l.signedURL}${s}`):null})),error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}download(t,r){return Mn(this,void 0,void 0,function*(){const a=typeof r?.transform<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString(r?.transform||{}),l=s?`?${s}`:"";try{const d=this._getFinalPath(t);return{data:yield(yield mh(this.fetch,`${this.url}/${a}/${d}${l}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(d){if(Gr(d))return{data:null,error:d};throw d}})}info(t){return Mn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield mh(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:np(n),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}exists(t){return Mn(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield PT(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Gr(n)&&n instanceof rp){const a=n.originalError;if([400,404].includes(a?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r?.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const d=typeof r?.transform<"u"?"render/image":"object",m=this.transformOptsToQueryString(r?.transform||{});m!==""&&a.push(m);let p=a.join("&");return p!==""&&(p=`?${p}`),{data:{publicUrl:encodeURI(`${this.url}/${d}/public/${n}${p}`)}}}remove(t){return Mn(this,void 0,void 0,function*(){try{return{data:yield e_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}list(t,r,n){return Mn(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},IT),r),{prefix:t||""});return{data:yield Ni(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Gr(a))return{data:null,error:a};throw a}})}listV2(t,r){return Mn(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Ni(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const FT="2.11.0",jT={"X-Client-Info":`storage-js/${FT}`};var oc=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function d(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(d,m)}p((n=n.apply(e,t||[])).next())})};class OT{constructor(t,r={},n,a){const s=new URL(t);a?.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},jT),r),this.fetch=Qy(n)}listBuckets(){return oc(this,void 0,void 0,function*(){try{return{data:yield mh(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Gr(t))return{data:null,error:t};throw t}})}getBucket(t){return oc(this,void 0,void 0,function*(){try{return{data:yield mh(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return oc(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return oc(this,void 0,void 0,function*(){try{return{data:yield ap(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Gr(n))return{data:null,error:n};throw n}})}emptyBucket(t){return oc(this,void 0,void 0,function*(){try{return{data:yield Ni(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}deleteBucket(t){return oc(this,void 0,void 0,function*(){try{return{data:yield e_(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Gr(r))return{data:null,error:r};throw r}})}}class RT extends OT{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new DT(this.url,this.headers,t,this.fetch)}}const LT="2.56.0";let Fu="";typeof Deno<"u"?Fu="deno":typeof document<"u"?Fu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fu="react-native":Fu="node";const MT={"X-Client-Info":`supabase-js-${Fu}/${LT}`},BT={headers:MT},zT={schema:"public"},UT={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},$T={};var WT=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function d(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(d,m)}p((n=n.apply(e,t||[])).next())})};const HT=e=>{let t;return e?t=e:typeof fetch>"u"?t=Hy:t=fetch,(...r)=>t(...r)},VT=()=>typeof Headers>"u"?Vy:Headers,GT=(e,t,r)=>{const n=HT(r),a=VT();return(s,l)=>WT(void 0,void 0,void 0,function*(){var d;const m=(d=yield t())!==null&&d!==void 0?d:e;let p=new a(l?.headers);return p.has("apikey")||p.set("apikey",e),p.has("Authorization")||p.set("Authorization",`Bearer ${m}`),n(s,Object.assign(Object.assign({},l),{headers:p}))})};var KT=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function d(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(d,m)}p((n=n.apply(e,t||[])).next())})};function ZT(e){return e.endsWith("/")?e:e+"/"}function YT(e,t){var r,n;const{db:a,auth:s,realtime:l,global:d}=e,{db:m,auth:p,realtime:g,global:y}=t,_={db:Object.assign(Object.assign({},m),a),auth:Object.assign(Object.assign({},p),s),realtime:Object.assign(Object.assign({},g),l),storage:{},global:Object.assign(Object.assign(Object.assign({},y),d),{headers:Object.assign(Object.assign({},(r=y?.headers)!==null&&r!==void 0?r:{}),(n=d?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>KT(this,void 0,void 0,function*(){return""})};return e.accessToken?_.accessToken=e.accessToken:delete _.accessToken,_}const t_="2.71.1",gc=30*1e3,ip=3,Cm=ip*gc,qT="http://localhost:9999",XT="supabase.auth.token",JT={"X-Client-Info":`gotrue-js/${t_}`},sp="X-Supabase-Api-Version",r_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},QT=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,eE=600*1e3;class Ip extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Et(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class tE extends Ip{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function rE(e){return Et(e)&&e.name==="AuthApiError"}class n_ extends Ip{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class fo extends Ip{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Qs extends fo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function nE(e){return Et(e)&&e.name==="AuthSessionMissingError"}class zf extends fo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Uf extends fo{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class $f extends fo{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function aE(e){return Et(e)&&e.name==="AuthImplicitGrantRedirectError"}class Vx extends fo{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class op extends fo{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Am(e){return Et(e)&&e.name==="AuthRetryableFetchError"}class Gx extends fo{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class lp extends fo{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const ph="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Kx=` 	
\r=`.split(""),iE=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Kx.length;t+=1)e[Kx[t].charCodeAt(0)]=-2;for(let t=0;t<ph.length;t+=1)e[ph[t].charCodeAt(0)]=t;return e})();function Zx(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ph[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(ph[n]),t.queuedBits-=6}}function a_(e,t,r){const n=iE[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Yx(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=l=>{lE(l,n,r)};for(let l=0;l<e.length;l+=1)a_(e.charCodeAt(l),a,s);return t.join("")}function sE(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function oE(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}sE(n,t)}}function lE(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function cE(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)a_(e.charCodeAt(a),r,n);return new Uint8Array(t)}function uE(e){const t=[];return oE(e,r=>t.push(r)),new Uint8Array(t)}function dE(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Zx(a,r,n)),Zx(null,r,n),t.join("")}function fE(e){return Math.round(Date.now()/1e3)+e}function hE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const ti=()=>typeof window<"u"&&typeof document<"u",zo={tested:!1,writable:!1},i_=()=>{if(!ti())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(zo.tested)return zo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),zo.tested=!0,zo.writable=!0}catch{zo.tested=!0,zo.writable=!1}return zo.writable};function mE(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const s_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>oi(async()=>{const{default:n}=await Promise.resolve().then(()=>Fc);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},pE=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",vc=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Uo=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Xs=async(e,t)=>{await e.removeItem(t)};class Dh{constructor(){this.promise=new Dh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Dh.promiseConstructor=Promise;function Nm(e){const t=e.split(".");if(t.length!==3)throw new lp("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!QT.test(t[n]))throw new lp("JWT not in base64url format");return{header:JSON.parse(Yx(t[0])),payload:JSON.parse(Yx(t[1])),signature:cE(t[2]),raw:{header:t[0],payload:t[1]}}}async function gE(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function vE(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const l=await e(s);if(!t(s,null,l)){n(l);return}}catch(l){if(!t(s,l)){a(l);return}}})()})}function xE(e){return("0"+e.toString(16)).substr(-2)}function yE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,xE).join("")}async function _E(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function wE(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await _E(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lc(e,t,r=!1){const n=yE();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await vc(e,`${t}-code-verifier`,a);const s=await wE(n);return[s,n===s?"plain":"s256"]}const bE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function kE(e){const t=e.headers.get(sp);if(!t||!t.match(bE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function SE(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function TE(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const EE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function cc(e){if(!EE.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Pm(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function qx(e){return JSON.parse(JSON.stringify(e))}var CE=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Ho=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),AE=[502,503,504];async function Xx(e){var t;if(!pE(e))throw new op(Ho(e),0);if(AE.includes(e.status))throw new op(Ho(e),e.status);let r;try{r=await e.json()}catch(s){throw new n_(Ho(s),s)}let n;const a=kE(e);if(a&&a.getTime()>=r_["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Gx(Ho(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Qs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,l)=>s&&typeof l=="string",!0))throw new Gx(Ho(r),e.status,r.weak_password.reasons);throw new tE(Ho(r),e.status||500,n)}const NE=(e,t,r,n)=>{const a={method:e,headers:t?.headers||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function jt(e,t,r,n){var a;const s=Object.assign({},n?.headers);s[sp]||(s[sp]=r_["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const l=(a=n?.query)!==null&&a!==void 0?a:{};n?.redirectTo&&(l.redirect_to=n.redirectTo);const d=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",m=await PE(e,t,r+d,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(m):{data:Object.assign({},m),error:null}}async function PE(e,t,r,n,a,s){const l=NE(t,n,a,s);let d;try{d=await e(r,Object.assign({},l))}catch(m){throw console.error(m),new op(Ho(m),0)}if(d.ok||await Xx(d),n?.noResolveJson)return d;try{return await d.json()}catch(m){await Xx(m)}}function ns(e){var t;let r=null;jE(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=fE(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function Jx(e){const t=ns(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function to(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function IE(e){return{data:e,error:null}}function DE(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,l=CE(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),d={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},m=Object.assign({},l);return{data:{properties:d,user:m},error:null}}function FE(e){return e}function jE(e){return e.access_token&&e.refresh_token&&e.expires_in}const Im=["global","local","others"];var OE=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class RE{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=s_(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Im[0]){if(Im.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Im.join(", ")}`);try{return await jt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Et(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await jt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:to})}catch(n){if(Et(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=OE(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n?.newEmail,delete a.newEmail),await jt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:DE,redirectTo:r?.redirectTo})}catch(r){if(Et(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await jt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:to})}catch(r){if(Et(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,l,d,m;try{const p={nextPage:null,lastPage:0,total:0},g=await jt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t?.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:FE});if(g.error)throw g.error;const y=await g.json(),_=(l=g.headers.get("x-total-count"))!==null&&l!==void 0?l:0,T=(m=(d=g.headers.get("link"))===null||d===void 0?void 0:d.split(","))!==null&&m!==void 0?m:[];return T.length>0&&(T.forEach(S=>{const w=parseInt(S.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(S.split(";")[1].split("=")[1]);p[`${E}Page`]=w}),p.total=parseInt(_)),{data:Object.assign(Object.assign({},y),p),error:null}}catch(p){if(Et(p))return{data:{users:[]},error:p};throw p}}async getUserById(t){cc(t);try{return await jt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:to})}catch(r){if(Et(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){cc(t);try{return await jt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:to})}catch(n){if(Et(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){cc(t);try{return await jt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:to})}catch(n){if(Et(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){cc(t.userId);try{const{data:r,error:n}=await jt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Et(r))return{data:null,error:r};throw r}}async _deleteFactor(t){cc(t.userId),cc(t.id);try{return{data:await jt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Et(r))return{data:null,error:r};throw r}}}function Qx(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function LE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const uc={debug:!!(globalThis&&i_()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class o_ extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class ME extends o_{}async function BE(e,t,r){uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),uc.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw uc.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new ME(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(uc.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}LE();const zE={url:qT,storageKey:XT,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:JT,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function e1(e,t,r){return await r()}const dc={};class Qu{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Qu.nextInstanceID,Qu.nextInstanceID+=1,this.instanceID>0&&ti()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},zE),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new RE({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=s_(a.fetch),this.lock=a.lock||e1,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:ti()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=BE:this.lock=e1,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:i_()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Qx(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Qx(this.memoryStorage)),ti()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=dc[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){dc[this.storageKey]=Object.assign(Object.assign({},dc[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=dc[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){dc[this.storageKey]=Object.assign(Object.assign({},dc[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${t_}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=mE(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),ti()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),aE(s)){const m=(t=s.details)===null||t===void 0?void 0:t.code;if(m==="identity_already_exists"||m==="identity_not_found"||m==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:l,redirectType:d}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",d),await this._saveSession(l),setTimeout(async()=>{d==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Et(r)?{error:r}:{error:new n_("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await jt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t?.options)===null||a===void 0?void 0:a.captchaToken}},xform:ns}),{data:l,error:d}=s;if(d||!l)return{data:{user:null,session:null},error:d};const m=l.session,p=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(s){if(Et(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:g,password:y,options:_}=t;let T=null,S=null;this.flowType==="pkce"&&([T,S]=await lc(this.storage,this.storageKey)),s=await jt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:_?.emailRedirectTo,body:{email:g,password:y,data:(r=_?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:_?.captchaToken},code_challenge:T,code_challenge_method:S},xform:ns})}else if("phone"in t){const{phone:g,password:y,options:_}=t;s=await jt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:g,password:y,data:(n=_?.data)!==null&&n!==void 0?n:{},channel:(a=_?.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:_?.captchaToken}},xform:ns})}else throw new Uf("You must provide either an email or phone number and a password");const{data:l,error:d}=s;if(d||!l)return{data:{user:null,session:null},error:d};const m=l.session,p=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(s){if(Et(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:l,options:d}=t;r=await jt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:l,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Jx})}else if("phone"in t){const{phone:s,password:l,options:d}=t;r=await jt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:l,gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Jx})}else throw new Uf("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new zf}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Et(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,l,d,m,p,g,y,_,T;let S,w;if("message"in t)S=t.message,w=t.signature;else{const{chain:E,wallet:P,statement:D,options:A}=t;let H;if(ti())if(typeof P=="object")H=P;else{const B=window;if("solana"in B&&typeof B.solana=="object"&&("signIn"in B.solana&&typeof B.solana.signIn=="function"||"signMessage"in B.solana&&typeof B.solana.signMessage=="function"))H=B.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof P!="object"||!A?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");H=P}const J=new URL((r=A?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in H&&H.signIn){const B=await H.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},A?.signInWithSolana),{version:"1",domain:J.host,uri:J.href}),D?{statement:D}:null));let I;if(Array.isArray(B)&&B[0]&&typeof B[0]=="object")I=B[0];else if(B&&typeof B=="object"&&"signedMessage"in B&&"signature"in B)I=B;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in I&&"signature"in I&&(typeof I.signedMessage=="string"||I.signedMessage instanceof Uint8Array)&&I.signature instanceof Uint8Array)S=typeof I.signedMessage=="string"?I.signedMessage:new TextDecoder().decode(I.signedMessage),w=I.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in H)||typeof H.signMessage!="function"||!("publicKey"in H)||typeof H!="object"||!H.publicKey||!("toBase58"in H.publicKey)||typeof H.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${J.host} wants you to sign in with your Solana account:`,H.publicKey.toBase58(),...D?["",D,""]:[""],"Version: 1",`URI: ${J.href}`,`Issued At: ${(a=(n=A?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=A?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${A.signInWithSolana.notBefore}`]:[],...!((l=A?.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${A.signInWithSolana.expirationTime}`]:[],...!((d=A?.signInWithSolana)===null||d===void 0)&&d.chainId?[`Chain ID: ${A.signInWithSolana.chainId}`]:[],...!((m=A?.signInWithSolana)===null||m===void 0)&&m.nonce?[`Nonce: ${A.signInWithSolana.nonce}`]:[],...!((p=A?.signInWithSolana)===null||p===void 0)&&p.requestId?[`Request ID: ${A.signInWithSolana.requestId}`]:[],...!((y=(g=A?.signInWithSolana)===null||g===void 0?void 0:g.resources)===null||y===void 0)&&y.length?["Resources",...A.signInWithSolana.resources.map(I=>`- ${I}`)]:[]].join(`
`);const B=await H.signMessage(new TextEncoder().encode(S),"utf8");if(!B||!(B instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=B}}try{const{data:E,error:P}=await jt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:S,signature:dE(w)},!((_=t.options)===null||_===void 0)&&_.captchaToken?{gotrue_meta_security:{captcha_token:(T=t.options)===null||T===void 0?void 0:T.captchaToken}}:null),xform:ns});if(P)throw P;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new zf}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:P})}catch(E){if(Et(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(t){const r=await Uo(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:l}=await jt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ns});if(await Xs(this.storage,`${this.storageKey}-code-verifier`),l)throw l;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new zf}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:l})}catch(s){if(Et(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:l}=t,d=await jt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:l,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:ns}),{data:m,error:p}=d;return p?{data:{user:null,session:null},error:p}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new zf}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:m,error:p})}catch(r){if(Et(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,l;try{if("email"in t){const{email:d,options:m}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await lc(this.storage,this.storageKey));const{error:y}=await jt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:d,data:(r=m?.data)!==null&&r!==void 0?r:{},create_user:(n=m?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:p,code_challenge_method:g},redirectTo:m?.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in t){const{phone:d,options:m}=t,{data:p,error:g}=await jt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:d,data:(a=m?.data)!==null&&a!==void 0?a:{},create_user:(s=m?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:m?.captchaToken},channel:(l=m?.channel)!==null&&l!==void 0?l:"sms"}});return{data:{user:null,session:null,messageId:p?.message_id},error:g}}throw new Uf("You must provide either an email or phone number.")}catch(d){if(Et(d))return{data:{user:null,session:null},error:d};throw d}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:d}=await jt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:ns});if(d)throw d;if(!l)throw new Error("An error occurred on token verification.");const m=l.session,p=l.user;return m?.access_token&&(await this._saveSession(m),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",m)),{data:{user:p,session:m},error:null}}catch(a){if(Et(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,l=null;return this.flowType==="pkce"&&([s,l]=await lc(this.storage,this.storageKey)),await jt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t?.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:l}),headers:this.headers,xform:IE})}catch(s){if(Et(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Qs;const{error:a}=await jt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Et(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:l}=await jt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:l}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:l,error:d}=await jt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:l?.message_id},error:d}}throw new Uf("You must provide either an email or phone number and a type")}catch(r){if(Et(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Uo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Cm:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await Uo(this.userStorage,this.storageKey+"-user");l?.user?t.user=l.user:t.user=Pm()}if(this.storage.isServer&&t.user){let l=this.suppressGetSessionWarning;t=new Proxy(t,{get:(m,p,g)=>(!l&&p==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,this.suppressGetSessionWarning=!0),Reflect.get(m,p,g))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await jt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:to}):await this._useSession(async r=>{var n,a,s;const{data:l,error:d}=r;if(d)throw d;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qs}:await jt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:to})})}catch(r){if(Et(r))return nE(r)&&(await this._removeSession(),await Xs(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Qs;const l=a.session;let d=null,m=null;this.flowType==="pkce"&&t.email!=null&&([d,m]=await lc(this.storage,this.storageKey));const{data:p,error:g}=await jt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:d,code_challenge_method:m}),jwt:l.access_token,xform:to});if(g)throw g;return l.user=p.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),{data:{user:l.user},error:null}})}catch(n){if(Et(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Qs;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:l}=Nm(t.access_token);if(l.exp&&(n=l.exp,a=n<=r),a){const{session:d,error:m}=await this._callRefreshToken(t.refresh_token);if(m)return{data:{user:null,session:null},error:m};if(!d)return{data:{user:null,session:null},error:null};s=d}else{const{data:d,error:m}=await this._getUser(t.access_token);if(m)throw m;s={access_token:t.access_token,refresh_token:t.refresh_token,user:d.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Et(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:d}=r;if(d)throw d;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Qs;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Et(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!ti())throw new $f("No browser detected.");if(t.error||t.error_description||t.error_code)throw new $f(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Vx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new $f("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Vx("No code detected.");const{data:D,error:A}=await this._exchangeCodeForSession(t.code);if(A)throw A;const H=new URL(window.location.href);return H.searchParams.delete("code"),window.history.replaceState(window.history.state,"",H.toString()),{data:{session:D.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:l,expires_in:d,expires_at:m,token_type:p}=t;if(!s||!d||!l||!p)throw new $f("No session defined in URL");const g=Math.round(Date.now()/1e3),y=parseInt(d);let _=g+y;m&&(_=parseInt(m));const T=_-g;T*1e3<=gc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${T}s, should have been closer to ${y}s`);const S=_-y;g-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,_,g):g-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,_,g);const{data:w,error:E}=await this._getUser(s);if(E)throw E;const P={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:y,expires_at:_,refresh_token:l,token_type:p,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:P,redirectType:t.type},error:null}}catch(n){if(Et(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Uo(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const l=(n=a.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:d}=await this.admin.signOut(l,t);if(d&&!(rE(d)&&(d.status===404||d.status===401||d.status===403)))return{error:d}}return t!=="others"&&(await this._removeSession(),await Xs(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=hE(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await lc(this.storage,this.storageKey,!0));try{return await jt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Et(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Et(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var l,d,m,p,g;const{data:y,error:_}=s;if(_)throw _;const T=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(d=t.options)===null||d===void 0?void 0:d.scopes,queryParams:(m=t.options)===null||m===void 0?void 0:m.queryParams,skipBrowserRedirect:!0});return await jt(this.fetch,"GET",T,{headers:this.headers,jwt:(g=(p=y.session)===null||p===void 0?void 0:p.access_token)!==null&&g!==void 0?g:void 0})});if(a)throw a;return ti()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:t.provider,url:n?.url},error:null}}catch(n){if(Et(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:l}=r;if(l)throw l;return await jt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Et(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await vE(async a=>(a>0&&await gE(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await jt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ns})),(a,s)=>{const l=200*Math.pow(2,a);return s&&Am(s)&&Date.now()+l-n<gc})}catch(n){if(this._debug(r,"error",n),Et(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ti()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await Uo(this.storage,this.storageKey);if(a&&this.userStorage){let l=await Uo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:a.user},await vc(this.userStorage,this.storageKey+"-user",l)),a.user=(t=l?.user)!==null&&t!==void 0?t:Pm()}else if(a&&!a.user&&!a.user){const l=await Uo(this.storage,this.storageKey+"-user");l&&l?.user?(a.user=l.user,await Xs(this.storage,this.storageKey+"-user"),await vc(this.storage,this.storageKey,a)):a.user=Pm()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Cm;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Cm}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:l}=await this._callRefreshToken(a.refresh_token);l&&(console.error(l),Am(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:d}=await this._getUser(a.access_token);!d&&l?.user?(a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Qs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Dh;const{data:s,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!s.session)throw new Qs;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const d={session:s.session,error:null};return this.refreshingDeferred.resolve(d),d}catch(s){if(this._debug(a,"error",s),Et(s)){const l={session:null,error:s};return Am(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],l=Array.from(this.stateChangeEmitters.values()).map(async d=>{try{await d.callback(t,r)}catch(m){s.push(m)}});if(await Promise.all(l),s.length>0){for(let d=0;d<s.length;d+=1)console.error(s[d]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await vc(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=qx(a);await vc(this.storage,this.storageKey,s)}else{const a=qx(r);await vc(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await Xs(this.storage,this.storageKey),await Xs(this.storage,this.storageKey+"-code-verifier"),await Xs(this.storage,this.storageKey+"-user"),this.userStorage&&await Xs(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ti()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),gc);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/gc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${gc}ms, refresh threshold is ${ip} ticks`),a<=ip&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof o_)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ti()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,l]=await lc(this.storage,this.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(d.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n?.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await jt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Et(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:l}=r;if(l)return{data:null,error:l};const d=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:m,error:p}=await jt(this.fetch,"POST",`${this.url}/factors`,{body:d,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return p?{data:null,error:p}:(t.factorType==="totp"&&(!((a=m?.totp)===null||a===void 0)&&a.qr_code)&&(m.totp.qr_code=`data:image/svg+xml;utf-8,${m.totp.qr_code}`),{data:m,error:null})})}catch(r){if(Et(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:l,error:d}=await jt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:d})})}catch(r){if(Et(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await jt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Et(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=t?.factors||[],a=n.filter(l=>l.factor_type==="totp"&&l.status==="verified"),s=n.filter(l=>l.factor_type==="phone"&&l.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Nm(a.access_token);let d=null;l.aal&&(d=l.aal);let m=d;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(y=>y.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const g=l.amr||[];return{data:{currentLevel:d,nextLevel:m,currentAuthenticationMethods:g},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(d=>d.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(d=>d.kid===t),n&&this.jwks_cached_at+eE>a)return n;const{data:s,error:l}=await jt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(d=>d.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:T,error:S}=await this.getSession();if(S||!T.session)return{data:null,error:S};n=T.session.access_token}const{header:a,payload:s,signature:l,raw:{header:d,payload:m}}=Nm(n);r?.allowExpired||SE(s.exp);const p=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!p){const{error:T}=await this.getUser(n);if(T)throw T;return{data:{claims:s,header:a,signature:l},error:null}}const g=TE(a.alg),y=await crypto.subtle.importKey("jwk",p,g,!0,["verify"]);if(!await crypto.subtle.verify(g,y,l,uE(`${d}.${m}`)))throw new lp("Invalid JWT signature");return{data:{claims:s,header:a,signature:l},error:null}}catch(n){if(Et(n))return{data:null,error:n};throw n}}}Qu.nextInstanceID=0;const UE=Qu;class $E extends UE{constructor(t){super(t)}}var WE=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(l){l(s)})}return new(r||(r=Promise))(function(s,l){function d(g){try{p(n.next(g))}catch(y){l(y)}}function m(g){try{p(n.throw(g))}catch(y){l(y)}}function p(g){g.done?s(g.value):a(g.value).then(d,m)}p((n=n.apply(e,t||[])).next())})};class HE{constructor(t,r,n){var a,s,l;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const d=ZT(t),m=new URL(d);this.realtimeUrl=new URL("realtime/v1",m),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",m),this.storageUrl=new URL("storage/v1",m),this.functionsUrl=new URL("functions/v1",m);const p=`sb-${m.hostname.split(".")[0]}-auth-token`,g={db:zT,realtime:$T,auth:Object.assign(Object.assign({},UT),{storageKey:p}),global:BT},y=YT(n??{},g);this.storageKey=(a=y.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=y.global.headers)!==null&&s!==void 0?s:{},y.accessToken?(this.accessToken=y.accessToken,this.auth=new Proxy({},{get:(_,T)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(T)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((l=y.auth)!==null&&l!==void 0?l:{},this.headers,y.global.fetch),this.fetch=GT(r,this._getAccessToken.bind(this),y.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},y.realtime)),this.rest=new sT(new URL("rest/v1",m).href,{headers:this.headers,schema:y.db.schema,fetch:this.fetch}),this.storage=new RT(this.storageUrl.href,this.headers,this.fetch,n?.storage),y.accessToken||this._listenForAuthEvents()}get functions(){return new q2(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return WE(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:s,flowType:l,lock:d,debug:m},p,g){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $E({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),p),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:l,lock:d,debug:m,fetch:g,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new kT(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n?.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const l_=(e,t,r)=>new HE(e,t,r);function VE(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}VE()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const GE="https://eevfxrgemrtthxbcxtvq.supabase.co",KE="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",Ve=l_(GE,KE,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"navigator-supabase-auth-token",debug:!1},realtime:{params:{eventsPerSecond:5}}}),ZE={navigator_restore_in_progress:3e4,navigator_import_in_progress:6e3,navigator_active_protection:5e3};function ro(e,t){const r=localStorage.getItem(e);if(!r)return!1;const n=parseInt(r,10);if(isNaN(n))return t1(e),!1;const a=ZE[e],s=Date.now()-n;return t!==void 0&&s<t?!0:s>=a?(t1(e),!1):!0}function t1(e){localStorage.removeItem(e)}async function r1(e){if(!Ve)throw new Error("Supabase not configured");const{data:t,error:r}=await Ve.rpc("create_trial_subscription",{target_user_id:e});if(r){if(r.message?.includes("already has a subscription"))return;throw console.error("Failed to create trial subscription:",r),r}if(t&&!t.success){if(t.message?.includes("already has a subscription"))return;throw console.error("Trial subscription creation failed:",t.message),new Error(t.message)}}function n1(){let e=localStorage.getItem("navigator_device_id");return e||(e=`device_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,localStorage.setItem("navigator_device_id",e)),e}function c_(e,t){const r=typeof e.currentListVersion=="number"?e.currentListVersion:1,n=typeof t.currentListVersion=="number"?t.currentListVersion:1,a=P=>typeof P=="number"?P:Math.max(r,n),s=new Map,l=P=>{if(!P||typeof P.index!="number"||typeof P.timestamp!="string"||!P.outcome)return;const D={...P,listVersion:a(P.listVersion)},A=`${D.timestamp}_${D.index}_${D.outcome}`,H=s.get(A);if(!H){s.set(A,D);return}const J=new Date(H.timestamp).getTime();if(new Date(D.timestamp).getTime()>J){s.set(A,{...H,...D});return}s.set(A,{...D,...H})};t.completions?.forEach(l),e.completions?.forEach(l);const d=Array.from(s.values()).sort((P,D)=>new Date(D.timestamp).getTime()-new Date(P.timestamp).getTime()),m=()=>{const P=Array.isArray(e.addresses)?e.addresses:[],D=Array.isArray(t.addresses)?t.addresses:[],A=I=>I.some(ee=>ee.address?.trim()),H=A(D),J=A(P);return n>r?!H&&J?{addresses:P,listVersion:r}:{addresses:D,listVersion:n}:r>n?!J&&H?{addresses:D,listVersion:r}:{addresses:P,listVersion:r}:H&&!J?{addresses:D,listVersion:n}:!H&&J?{addresses:P,listVersion:r}:{addresses:D.length>=P.length?D:P,listVersion:n}},{addresses:p,listVersion:g}=m(),y=new Map,_=P=>{if(!P?.id)return;const D=y.get(P.id);if(!D){y.set(P.id,P);return}const A=new Date(D.updatedAt).getTime();new Date(P.updatedAt).getTime()>A&&y.set(P.id,P)};e.arrangements?.forEach(_),t.arrangements?.forEach(_);const T=new Map,S=P=>{if(!P?.date)return;const D=T.get(P.date);if(!D){T.set(P.date,P);return}const A=!!D.end,H=!!P.end;if(!A&&H){T.set(P.date,P);return}if(A&&H){const J=new Date(D.end??D.start).getTime();new Date(P.end??P.start).getTime()>J&&T.set(P.date,P)}};e.daySessions?.forEach(S),t.daySessions?.forEach(S);const w=Array.from(T.values()),E=Array.from(y.values());return{...t,addresses:p,completions:d,arrangements:E,daySessions:w,currentListVersion:g,activeIndex:t.activeIndex??e.activeIndex??null}}function u_(){const[e,t]=Z.useState(null),[r,n]=Z.useState(!0),[a,s]=Z.useState(!1),[l,d]=Z.useState(typeof navigator<"u"?navigator.onLine:!0),[m,p]=Z.useState(null),[g,y]=Z.useState(null),_=Z.useRef({lastSyncAt:"",deviceId:n1(),version:0,checksum:""}),T=Z.useRef([]),S=Z.useRef(!1),w=Z.useRef(null),E=Z.useRef(""),P=Z.useRef(null),D=Z.useRef(0),A=Z.useCallback(()=>p(null),[]),H=Z.useCallback(async()=>{if(!e||!Ve||!l||S.current||T.current.length===0)return;S.current=!0,s(!0);const fe=T.current.slice(0,10),ue=new Set;try{for(const O of fe)try{const{operation:F}=O,{error:M}=await Ve.from("navigator_operations").insert({user_id:e.id,operation_id:F.id,type:F.type,entity:F.entity,entity_id:F.entityId,data:F.data,device_id:_.current.deviceId,timestamp:F.timestamp,local_timestamp:F.localTimestamp});if(M&&M.code!=="23505")throw M;ue.add(O.operation.id),O.resolve(F)}catch(F){O.operation.retries+=1,O.operation.retries<3||(console.warn(`Operation ${O.operation.id} failed after max retries:`,F),ue.add(O.operation.id),O.reject(F))}T.current=T.current.filter(O=>!ue.has(O.operation.id))}catch(O){console.error("Sync batch error:",O),p(O?.message||"Sync batch failed")}finally{S.current=!1,s(T.current.length>0),T.current.length>0&&(w.current=setTimeout(H,1e3))}},[e,l]),J=Z.useCallback(async fe=>new Promise((ue,O)=>{const F=JSON.stringify(fe.data),M=`${fe.type}_${fe.entity}_${fe.entityId}_${F}`;if(T.current.some(U=>{const te=JSON.stringify(U.operation.data);return`${U.operation.type}_${U.operation.entity}_${U.operation.entityId}_${te}`===M&&U.operation.retries<3})){ue();return}const Y=new Date().toISOString(),z={operation:{...fe,id:`op_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,timestamp:Y,localTimestamp:Y,retries:0},resolve:ue,reject:O};T.current.push(z),T.current.length>1e3&&(console.warn("Sync queue size limit reached, removing oldest entries"),T.current.splice(0,100).forEach(te=>{te.reject(new Error("Queue overflow - operation cancelled"))})),l&&H()}),[l,H]);Z.useEffect(()=>{let fe=!0;if((async()=>{try{if(!navigator.onLine){const ae=localStorage.getItem("navigator_was_authenticated"),oe=localStorage.getItem("navigator_expected_user_id");if(Ve)try{const{data:de}=await Ve.auth.getSession();if(fe&&de.session?.user)t(de.session.user);else if(ae==="true"&&oe){const ge={id:oe,email:localStorage.getItem("navigator_last_user_email")||"offline@local",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString(),role:"authenticated",updated_at:new Date().toISOString()};fe&&(t(ge),localStorage.setItem("navigator_offline_mode","true"))}}catch{if(ae==="true"&&oe&&fe){const ge={id:oe,email:localStorage.getItem("navigator_last_user_email")||"offline@local",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString(),role:"authenticated",updated_at:new Date().toISOString()};t(ge),localStorage.setItem("navigator_offline_mode","true")}}else if(ae==="true"&&oe&&fe){const de={id:oe,email:localStorage.getItem("navigator_last_user_email")||"offline@local",app_metadata:{},user_metadata:{},aud:"authenticated",created_at:new Date().toISOString(),role:"authenticated",updated_at:new Date().toISOString()};t(de),localStorage.setItem("navigator_offline_mode","true")}fe&&n(!1);return}if(!Ve){fe&&(p("Supabase not configured"),n(!1));return}const O=localStorage.getItem("navigator_expected_user_id"),F=localStorage.getItem("navigator_last_session_validation"),M=F?parseInt(F):0;if(Date.now()-M>9e5||!F){const ae=localStorage.getItem(`sb-${window.location.hostname.replace(/\./g,"-")}-auth-token`);if(ae)try{const de=JSON.parse(ae)?.user?.id;if(O&&de&&de!==O){console.error("🚨 SESSION TAMPERING DETECTED: Session user ID does not match expected user ID"),localStorage.removeItem(`sb-${window.location.hostname.replace(/\./g,"-")}-auth-token`),localStorage.removeItem("navigator_expected_user_id"),sessionStorage.clear(),p("Session security error. Please sign in again."),n(!1);return}}catch(oe){console.warn("Could not parse session data for validation:",oe)}localStorage.setItem("navigator_last_session_validation",Date.now().toString())}const Y=new URLSearchParams(window.location.hash.substring(1)),R=Y.get("access_token"),z=Y.get("refresh_token"),U=Y.get("type"),te=Y.get("error"),W=Y.get("error_description");if(te){console.error("Auth callback error:",te,W);const ae=`Email confirmation failed: ${W||te}`;p(ae),alert(ae),window.history.replaceState(null,"",window.location.pathname),fe&&n(!1);return}if(R&&U){try{const{data:ae,error:oe}=await Ve.auth.setSession({access_token:R,refresh_token:z||""});if(oe){console.error("Error setting session from URL:",oe);const de="Failed to confirm email: "+oe.message;p(de),alert(de+`

Please try signing in manually or contact support.`)}else if(ae.session){t(ae.session.user),A();try{await r1(ae.session.user.id)}catch(de){console.warn("Trial subscription creation failed (may already exist):",de)}}else{console.warn("Session data missing after setSession");const de="Email confirmation incomplete. Please try signing in with your email and password.";p(de),alert(de)}}catch(ae){console.error("Exception during session setup:",ae),p("Error confirming email: "+(ae?.message||String(ae)))}window.history.replaceState(null,"",window.location.pathname)}else{const{data:ae,error:oe}=await Ve.auth.getUser();if(oe)throw oe;if(ae.user&&O&&ae.user.id!==O){console.error(`🚨 USER ID MISMATCH: Expected ${O}, got ${ae.user.id}`),p("Security error: Session user mismatch. Signing out for safety."),await Ve.auth.signOut(),localStorage.removeItem("navigator_expected_user_id"),fe&&(t(null),n(!1));return}fe&&t(ae.user??null)}}catch(O){fe&&O?.message!=="Auth session missing!"&&p(O?.message||String(O))}finally{fe&&n(!1)}})(),!Ve)return()=>{fe=!1};const{data:ue}=Ve.auth.onAuthStateChange((O,F)=>{if(fe){const M=localStorage.getItem("navigator_expected_user_id"),ie=F?.user?.id;if(M&&ie&&M!==ie)if(console.error(`🚨 AUTH STATE CHANGE: User ID changed from ${M} to ${ie}`),O==="SIGNED_IN"||O==="USER_UPDATED")console.log("🔒 SECURITY: Legitimate user change, updating expected user ID"),localStorage.setItem("navigator_expected_user_id",ie);else{console.error("🚨 SECURITY: Unexpected user ID change on event:",O);return}t(F?.user??null),(O==="SIGNED_IN"||O==="USER_UPDATED")&&F&&(localStorage.setItem("navigator_was_authenticated","true"),localStorage.setItem("navigator_last_user_email",F.user.email||""),localStorage.removeItem("navigator_offline_mode"),A()),O==="SIGNED_OUT"&&(localStorage.removeItem("navigator_was_authenticated"),localStorage.removeItem("navigator_last_user_email"),localStorage.removeItem("navigator_offline_mode"))}});return()=>{fe=!1,ue.subscription.unsubscribe()}},[A]),Z.useEffect(()=>{if(typeof window>"u")return;const fe=()=>{d(!0),w.current=setTimeout(H,100),setTimeout(async()=>{const O=Object.keys(localStorage).filter(F=>F.startsWith("navigator_offline_state_"));if(O.length>0)for(const F of O)try{const M=JSON.parse(localStorage.getItem(F)||"{}");M.state&&(await he(M.state),localStorage.removeItem(F))}catch(M){console.error(`🔌 OFFLINE PROTECTION: Failed to sync queued state ${F}:`,M)}},2e3)},ue=()=>{d(!1)};return window.addEventListener("online",fe),window.addEventListener("offline",ue),()=>{window.removeEventListener("online",fe),window.removeEventListener("offline",ue)}},[H]);const B=Z.useCallback(async(fe,ue)=>{if(A(),!Ve)throw new Error("Supabase not configured");const{data:O,error:F}=await Ve.auth.signInWithPassword({email:fe,password:ue});if(F)throw p(F.message),F;localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"),localStorage.setItem("navigator_was_authenticated","true"),localStorage.setItem("navigator_last_user_email",O.user.email||""),localStorage.removeItem("navigator_offline_mode");const{SmartUserDetection:M}=await oi(async()=>{const{SmartUserDetection:ie}=await Promise.resolve().then(()=>G2);return{SmartUserDetection:ie}},void 0);return M.storeDeviceContext(O.user),t(O.user),{user:O.user}},[A]),I=Z.useCallback(async(fe,ue)=>{if(A(),!Ve)throw new Error("Supabase not configured");try{localStorage.removeItem("navigator-supabase-auth-token"),localStorage.removeItem("supabase.auth.token"),sessionStorage.clear(),await Ve.auth.signOut(),t(null),await new Promise(Y=>setTimeout(Y,1e3));const{data:ie}=await Ve.auth.getSession();ie.session&&(console.warn("Session still exists after cleanup, forcing removal..."),await Ve.auth.signOut(),await new Promise(Y=>setTimeout(Y,500)))}catch(ie){console.warn("Error during pre-signup signout:",ie)}const O=window.location.origin,{data:F,error:M}=await Ve.auth.signUp({email:fe,password:ue,options:{data:{signup_source:"navigator_web"},emailRedirectTo:O}});if(M)throw p(M.message),M;if(F.user){try{await r1(F.user.id),localStorage.setItem("navigator_trial_created",Date.now().toString()),localStorage.setItem("navigator_trial_user_id",F.user.id)}catch(ie){console.error("Failed to initialize new user:",ie)}if(!F.session)return p("✉️ Check your email! Click the confirmation link to activate your account."),{user:F.user};t(F.user)}return{user:F.user}},[A]),ee=Z.useCallback(async()=>{if(A(),P.current&&(P.current(),P.current=null),!Ve)return;const{error:fe}=await Ve.auth.signOut();if(fe)throw p(fe.message),fe;try{const{clear:ue}=await oi(async()=>{const{clear:F}=await Promise.resolve().then(()=>Zk);return{clear:F}},void 0);await ue(),["navigator_trial_created","navigator_trial_user_id","navigator_last_user_id","navigator_device_context","navigator_device_context_checksum","navigator_supabase_url","navigator_supabase_key","navigator_supabase_skipped","navigator_data_counts","last_backup_time","navigator-web:settings","navigator_expected_user_id","navigator_last_session_validation","navigator_active_protection","navigator_restore_in_progress","navigator_import_in_progress","navigator_was_authenticated","navigator_last_user_email","navigator_offline_mode"].forEach(F=>localStorage.removeItem(F)),sessionStorage.clear()}catch(ue){console.warn("Error clearing local data:",ue)}t(null),y(null),_.current={lastSyncAt:"",deviceId:n1(),version:0,checksum:""},T.current=[],S.current=!1,E.current="",w.current&&(clearTimeout(w.current),w.current=null)},[A]),re=Z.useCallback(async fe=>{if(A(),!Ve)throw new Error("Supabase not configured");const ue=window.location.origin,{error:O}=await Ve.auth.resetPasswordForEmail(fe,{redirectTo:ue});if(O)throw p(O.message),O},[A]),ye=Z.useCallback(async fe=>{if(A(),!Ve)throw new Error("Supabase not configured");if(!e)throw new Error("Not authenticated");const{error:ue}=await Ve.auth.updateUser({password:fe});if(ue)throw p(ue.message),ue},[A,e]),he=Z.useCallback(async fe=>{if(!e||!Ve){p(e?"Supabase not configured":"Not authenticated");return}if(JSON.stringify(fe)!==E.current)try{A(),s(!0);const O=new Date().toISOString(),{data:F,error:M}=await Ve.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle();if(M)throw M;let ie=fe,Y=_.current.version+1;if(F&&F.updated_at>_.current.lastSyncAt){const ae=F.data;ie=await ce(fe,ae),Y=(F.version||0)+1}const R=qo(ie),{error:z}=await Ve.from("navigator_state").upsert({user_id:e.id,data:ie,updated_at:O,version:Y,checksum:R,device_id:_.current.deviceId},{onConflict:"user_id"}).select("updated_at, version, checksum").single();if(z)throw console.error("Cloud sync database error:",z),z.code==="23505"||z.message?.includes("conflict")?(_.current.lastSyncAt="",_.current.version=0,new Error("Sync conflict detected - will retry with fresh data")):z;const{data:U,error:te}=await Ve.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).single();if(te)throw console.error("Sync verification failed:",te),new Error(`Sync verification failed: ${te.message}`);if(!U)throw new Error("Sync verification failed: No data found after upsert");const W=qo(U.data);W!==R&&console.warn("Checksum mismatch (likely harmless serialization difference)",{expectedChecksum:R,actualChecksum:W,expectedCompletions:ie.completions?.length||0,actualCompletions:U.data?.completions?.length||0}),_.current={lastSyncAt:U.updated_at??O,deviceId:_.current.deviceId,version:U.version??Y,checksum:R},E.current=JSON.stringify(ie),y(new Date(U.updated_at??O))}catch(O){if(O?.message!=="Auth session missing!"&&p(O?.message||String(O)),console.error("Sync failed:",O),!l||O?.message?.includes("fetch")){const F=`navigator_offline_state_${Date.now()}`,M={state:fe,timestamp:new Date().toISOString(),reason:"network_failure",error:O?.message||String(O)};try{localStorage.setItem(F,JSON.stringify(M))}catch(ie){console.error("Failed to queue offline state:",ie)}}}finally{s(!1)}},[e,A]),ce=Z.useCallback(async(fe,ue)=>{if(ro("navigator_restore_in_progress")){console.log("🛡️ RESTORE PROTECTION: Preferring local state to prevent data loss");const W=typeof fe.currentListVersion=="number"?fe.currentListVersion:1,ae=typeof ue.currentListVersion=="number"?ue.currentListVersion:1;return{...fe,currentListVersion:Math.max(W,ae)}}if(ro("navigator_import_in_progress")){console.log("🛡️ IMPORT PROTECTION: Preferring local state to prevent import override");const W=typeof fe.currentListVersion=="number"?fe.currentListVersion:1,ae=typeof ue.currentListVersion=="number"?ue.currentListVersion:1;return{...fe,currentListVersion:Math.max(W,ae)}}const O=new Date(Date.now()-360*60*1e3);if(fe.completions.some(W=>W.timestamp&&new Date(W.timestamp)>O)){const W=fe.completions.length,ae=ue.completions.length;if(W>ae)return{...fe,arrangements:ue.arrangements.length>fe.arrangements.length?ue.arrangements:fe.arrangements,daySessions:[...fe.daySessions,...ue.daySessions.filter(oe=>!fe.daySessions.some(de=>de.date===oe.date))]}}const M={...fe},ie=[...fe.completions,...ue.completions],Y=new Map;ie.forEach(W=>{if(!W.address||!W.timestamp)return;const ae=`${W.address}_v${W.listVersion||1}`,oe=Y.get(ae);if(!oe){Y.set(ae,W);return}const de=new Date(oe.timestamp).getTime(),ge=new Date(W.timestamp).getTime();!isNaN(ge)&&(isNaN(de)||ge>de)&&Y.set(ae,W)}),M.completions=Array.from(Y.values()).sort((W,ae)=>new Date(ae.timestamp).getTime()-new Date(W.timestamp).getTime());const R=[...fe.arrangements,...ue.arrangements],z=new Map;R.forEach(W=>{const ae=z.get(W.id);(!ae||new Date(W.updatedAt)>new Date(ae.updatedAt))&&z.set(W.id,W)}),M.arrangements=Array.from(z.values());const U=[...fe.daySessions,...ue.daySessions],te=new Map;if(U.forEach(W=>{const ae=te.get(W.date);(!ae||W.end&&!ae.end)&&te.set(W.date,W)}),M.daySessions=Array.from(te.values()),ue.addresses.length>fe.addresses.length){M.addresses=ue.addresses;const W=typeof fe.currentListVersion=="number"?fe.currentListVersion:1,ae=typeof ue.currentListVersion=="number"?ue.currentListVersion:1;M.currentListVersion=Math.max(W,ae)}else{const W=typeof fe.currentListVersion=="number"?fe.currentListVersion:1;M.currentListVersion=W}return M.activeIndex=fe.activeIndex??ue.activeIndex??null,M},[]),Ee=Z.useCallback(async()=>{if(E.current="",_.current.lastSyncAt="",_.current.version=0,e&&Ve)try{const{data:fe,error:ue}=await Ve.from("navigator_state").select("data, updated_at, version, checksum").eq("user_id",e.id).maybeSingle()}catch(fe){console.warn("Force sync failed:",fe)}},[e]),je=Z.useCallback(fe=>{if(!e||!Ve)return()=>{};A();const ue=Ve,O=ue.channel("navigator_state_"+e.id);D.current+=1,O.on("postgres_changes",{event:"*",schema:"public",table:"navigator_state",filter:`user_id=eq.${e.id}`},async M=>{try{const ie=M?.new??M?.old??null;if(!ie)return;const Y=localStorage.getItem("navigator_expected_user_id");if(Y&&ie.user_id&&ie.user_id!==Y){console.error(`🚨 SUBSCRIPTION DATA CONTAMINATION: Received data for user ${ie.user_id} but expected ${Y}`);return}const R=ie.data;if(R._ownerUserId&&R._ownerUserId!==e.id){console.error(`🚨 DATA OWNERSHIP MISMATCH: Data belongs to ${R._ownerUserId} but current user is ${e.id}`);return}const z=ie.updated_at,U=ie.version||0,te=ie.checksum||"";if(ie.device_id===_.current.deviceId||U<=_.current.version)return;const W=qo(R);if(te&&te!==W){const ge="navigator_checksum_mismatch_count",Oe="navigator_last_checksum_mismatch",q=parseInt(localStorage.getItem(ge)||"0"),Ze=parseInt(localStorage.getItem(Oe)||"0"),Ye=Date.now()-Ze>3e5?1:q+1;localStorage.setItem(ge,Ye.toString()),localStorage.setItem(Oe,Date.now().toString()),console.warn(`⚠️ CHECKSUM MISMATCH (${Ye}) - Data integrity issue detected`,{expected:W.substring(0,16)+"...",actual:te.substring(0,16)+"...",serverVersion:U,updatedAt:z,consecutiveMismatches:Ye}),Ye>=3&&(console.error("❌ PERSISTENT CHECKSUM MISMATCH - Forcing full sync (silent recovery)"),localStorage.removeItem(ge),localStorage.removeItem(Oe),_.current.lastSyncAt="",_.current.version=0,_.current.checksum="");return}if(localStorage.removeItem("navigator_checksum_mismatch_count"),localStorage.removeItem("navigator_last_checksum_mismatch"),localStorage.getItem("navigator_active_protection"))return;_.current.lastSyncAt=z,_.current.version=U,_.current.checksum=te;const oe=localStorage.getItem("navigator_restore_in_progress");if(oe){const ge=parseInt(oe);if(Date.now()-ge<3e4)return;localStorage.removeItem("navigator_restore_in_progress")}const de=localStorage.getItem("navigator_import_in_progress");if(de){const ge=parseInt(de);if(Date.now()-ge<2e3)return;localStorage.removeItem("navigator_import_in_progress")}typeof fe=="function"?fe(ge=>{const Oe=c_(ge,R);return Oe.completions.filter(Ze=>!ge.completions.some(Je=>Je.timestamp===Ze.timestamp&&Je.address===Ze.address)).length>0,E.current=JSON.stringify(Oe),Oe}):E.current=JSON.stringify(R),y(new Date(z))}catch(ie){console.warn("subscribeToData handler error:",ie?.message||ie),p("Sync error: "+(ie?.message||ie))}}),O.subscribe();const F=()=>{D.current>0&&(D.current-=1);try{ue.removeChannel(O)}catch{}};return P.current=F,F},[e,A]);return Z.useMemo(()=>({user:e,isLoading:r,isOnline:l,isSyncing:a,error:m,lastSyncTime:g,clearError:A,signIn:B,signUp:I,signOut:ee,resetPassword:re,updatePassword:ye,syncData:he,subscribeToData:je,queueOperation:J,forceFullSync:Ee}),[e,r,l,a,m,g,A,B,I,ee,re,ye,he,je,J,Ee])}function Dp({isOpen:e,onClose:t,title:r,children:n,size:a="md",showCloseButton:s=!0}){Z.useEffect(()=>{const m=p=>{p.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",m),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",m),document.body.style.overflow=""}},[e,t]);const l=Z.useRef(null);if(Z.useEffect(()=>{if(e&&l.current){const p=l.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')[0];p&&p.focus()}},[e]),!e)return null;const d={sm:"modal-sm",md:"modal-md",lg:"modal-lg"};return u.jsx("div",{className:"modal-overlay",onClick:t,children:u.jsxs("div",{ref:l,className:`modal-content ${d[a]}`,onClick:m=>m.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":r?"modal-title":void 0,children:[r&&u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{id:"modal-title",className:"modal-title",children:r}),s&&u.jsx("button",{className:"modal-close-btn",onClick:t,"aria-label":"Close modal",children:"✕"})]}),u.jsx("div",{className:"modal-body",children:n})]})})}function YE({isOpen:e,onClose:t,title:r,message:n,type:a="info"}){const l={info:{icon:"ℹ️",className:"alert-info"},success:{icon:"✅",className:"alert-success"},warning:{icon:"⚠️",className:"alert-warning"},error:{icon:"❌",className:"alert-error"}}[a];return Z.useEffect(()=>{const d=m=>{m.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",d),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",d),document.body.style.overflow=""}},[e,t]),e?u.jsx("div",{className:"modal-overlay",onClick:t,children:u.jsxs("div",{className:`modal-content modal-sm alert-modal ${l.className}`,onClick:d=>d.stopPropagation(),role:"dialog","aria-modal":"true","aria-labelledby":r?"modal-title":void 0,children:[r&&u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{id:"modal-title",className:"modal-title",children:r}),u.jsx("button",{className:"modal-close-btn",onClick:t,"aria-label":"Close modal",children:"✕"})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:"alert-content",children:[u.jsx("div",{className:"alert-icon",children:l.icon}),u.jsx("div",{className:"alert-message",children:n})]}),u.jsx("div",{className:"modal-actions",children:u.jsx("button",{className:"btn btn-primary",onClick:t,children:"OK"})})]})]})}):null}function qE({isOpen:e,onConfirm:t,onCancel:r,title:n,message:a,confirmText:s="Confirm",cancelText:l="Cancel",type:d="info"}){const p={danger:{icon:"🗑️",confirmClass:"btn-danger"},warning:{icon:"⚠️",confirmClass:"btn-warning"},info:{icon:"ℹ️",confirmClass:"btn-primary"}}[d],g=()=>{t(),r()};return u.jsx(Dp,{isOpen:e,onClose:r,title:n,size:"sm",children:u.jsxs("div",{className:"confirm-modal",children:[u.jsxs("div",{className:"confirm-content",children:[u.jsx("div",{className:"confirm-icon",children:p.icon}),u.jsx("div",{className:"confirm-message",children:a})]}),u.jsxs("div",{className:"modal-actions",children:[u.jsx("button",{className:"btn btn-ghost",onClick:r,children:l}),u.jsx("button",{className:`btn ${p.confirmClass}`,onClick:g,children:s})]})]})})}function XE({isOpen:e,onSubmit:t,onCancel:r,title:n,message:a,placeholder:s,defaultValue:l="",inputType:d="text",submitText:m="Submit",cancelText:p="Cancel"}){const[g,y]=Z.useState(l);Z.useEffect(()=>{e&&y(l)},[e,l]);const _=T=>{T.preventDefault(),g.trim()&&(t(g.trim()),r())};return u.jsx(Dp,{isOpen:e,onClose:r,title:n,size:"sm",children:u.jsx("form",{onSubmit:_,children:u.jsxs("div",{className:"prompt-modal",children:[u.jsx("div",{className:"prompt-message",children:a}),u.jsx("input",{name:"modalInput",type:d,value:g,onChange:T=>y(T.target.value),placeholder:s,className:"input",autoFocus:!0,required:!0}),u.jsxs("div",{className:"modal-actions",children:[u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:r,children:p}),u.jsx("button",{type:"submit",className:"btn btn-primary",children:m})]})]})})})}const Wf={alert:{isOpen:!1,options:{message:""}},confirm:{isOpen:!1,options:{message:""}},prompt:{isOpen:!1,options:{message:""}}};function JE(){const[e,t]=Z.useState(Wf),r=Z.useCallback(m=>new Promise(p=>{t(g=>({...g,alert:{isOpen:!0,options:m,resolve:p}}))}),[]),n=Z.useCallback(m=>new Promise(p=>{t(g=>({...g,confirm:{isOpen:!0,options:m,resolve:p}}))}),[]),a=Z.useCallback(m=>new Promise(p=>{t(g=>({...g,prompt:{isOpen:!0,options:m,resolve:p}}))}),[]),s=Z.useCallback(()=>{t(m=>(m.alert.resolve&&m.alert.resolve(),{...m,alert:{...Wf.alert}}))},[]),l=Z.useCallback((m=!1)=>{t(p=>(p.confirm.resolve&&p.confirm.resolve(m),{...p,confirm:{...Wf.confirm}}))},[]),d=Z.useCallback((m=null)=>{t(p=>(p.prompt.resolve&&p.prompt.resolve(m),{...p,prompt:{...Wf.prompt}}))},[]);return{alertModal:e.alert,confirmModal:e.confirm,promptModal:e.prompt,alert:r,confirm:n,prompt:a,closeAlert:s,closeConfirm:l,closePrompt:d}}const d_=Z.createContext(null);function QE({children:e}){const t=JE();return u.jsxs(d_.Provider,{value:t,children:[e,u.jsx(YE,{isOpen:t.alertModal.isOpen,onClose:t.closeAlert,title:t.alertModal.options.title,message:t.alertModal.options.message,type:t.alertModal.options.type}),u.jsx(qE,{isOpen:t.confirmModal.isOpen,onConfirm:()=>t.closeConfirm(!0),onCancel:()=>t.closeConfirm(!1),title:t.confirmModal.options.title,message:t.confirmModal.options.message,confirmText:t.confirmModal.options.confirmText,cancelText:t.confirmModal.options.cancelText,type:t.confirmModal.options.type}),u.jsx(XE,{isOpen:t.promptModal.isOpen,onSubmit:r=>t.closePrompt(r),onCancel:()=>t.closePrompt(null),title:t.promptModal.options.title,message:t.promptModal.options.message,placeholder:t.promptModal.options.placeholder,defaultValue:t.promptModal.options.defaultValue,inputType:t.promptModal.options.inputType,submitText:t.promptModal.options.submitText,cancelText:t.promptModal.options.cancelText})]})}function eC(){const e=Z.useContext(d_);if(!e)throw new Error("useModalContext must be used within a ModalProvider");return e}function tC({onSignIn:e,onSignUp:t,onResetPassword:r,isLoading:n,error:a,onClearError:s}){const[l,d]=Z.useState("signin"),[m,p]=Z.useState(""),[g,y]=Z.useState(""),[_,T]=Z.useState(""),[S,w]=Z.useState(!1),[E,P]=Z.useState(null),D=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,A=async H=>{if(H.preventDefault(),n)return;if(P(null),!m||m.trim()===""){P("Email is required");return}if(!D.test(m)){P("Please enter a valid email address");return}if(l==="reset"){try{await r(m),w(!0)}catch{}return}if(!g||g.trim()===""){P("Password is required");return}if(g.length<6){P("Password must be at least 6 characters");return}if(g.length>72){P("Password must be less than 72 characters");return}if(["password","123456","qwerty","abc123","password123"].includes(g.toLowerCase())){P("Please choose a stronger password");return}if(l==="signup"){if(!_||_.trim()===""){P("Please confirm your password");return}if(g!==_){P("Passwords do not match");return}}try{l==="signin"?await e(m,g):await t(m,g)}catch{}};return Z.useEffect(()=>{if(a){const H=setTimeout(()=>{s()},5e3);return()=>clearTimeout(H)}},[a,s]),u.jsx("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"1rem"},children:u.jsxs("div",{style:{width:"100%",maxWidth:"420px",background:"white",borderRadius:"16px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",overflow:"hidden"},children:[u.jsxs("div",{style:{padding:"3rem 2.5rem 2rem",textAlign:"center",background:"white"},children:[u.jsx("h1",{style:{margin:"0 0 0.75rem 0",fontSize:"2rem",fontWeight:700,color:"#1a202c",letterSpacing:"-0.025em"},children:"Navigator"}),u.jsx("p",{style:{margin:0,color:"#718096",fontSize:"0.9375rem",fontWeight:400},children:l==="signin"?"Welcome back":l==="signup"?"Create your account":"Reset your password"})]}),u.jsxs("div",{style:{padding:"0 2.5rem 2.5rem"},children:[(a||E)&&u.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",background:"#fee2e2",borderLeft:"4px solid #dc2626",borderRadius:"6px",color:"#991b1b",fontSize:"0.875rem",lineHeight:"1.5"},children:E||a}),l==="reset"&&S&&u.jsx("div",{style:{padding:"1rem",marginBottom:"1.5rem",background:"#d1fae5",borderLeft:"4px solid #059669",borderRadius:"6px",color:"#065f46",fontSize:"0.875rem",lineHeight:"1.5"},children:"Password reset email sent! Check your inbox."}),u.jsx("form",{onSubmit:A,children:u.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1.25rem"},children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"email",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Email address"}),u.jsx("input",{id:"email",name:"email",type:"email",value:m,onChange:H=>p(H.target.value),disabled:n,required:!0,autoComplete:"email",placeholder:"you@example.com",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:H=>H.target.style.borderColor="#667eea",onBlur:H=>H.target.style.borderColor="#d1d5db"})]}),l!=="reset"&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Password"}),u.jsx("input",{id:"password",name:"password",type:"password",value:g,onChange:H=>y(H.target.value),disabled:n,minLength:6,required:!0,autoComplete:l==="signup"?"new-password":"current-password",placeholder:"Enter your password",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:H=>H.target.style.borderColor="#667eea",onBlur:H=>H.target.style.borderColor="#d1d5db"})]}),l==="signup"&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"confirmPassword",style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:500,color:"#374151"},children:"Confirm password"}),u.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:_,onChange:H=>T(H.target.value),disabled:n,minLength:6,required:!0,autoComplete:"new-password",placeholder:"Confirm your password",style:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"1px solid #d1d5db",borderRadius:"8px",outline:"none",transition:"all 0.15s ease",backgroundColor:"white"},onFocus:H=>H.target.style.borderColor="#667eea",onBlur:H=>H.target.style.borderColor="#d1d5db"})]}),u.jsx("button",{type:"submit",disabled:n,style:{width:"100%",marginTop:"0.5rem",padding:"0.875rem 1rem",fontSize:"1rem",fontWeight:600,color:"white",background:n?"#9ca3af":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"8px",cursor:n?"not-allowed":"pointer",transition:"all 0.15s ease",boxShadow:"0 4px 6px rgba(102, 126, 234, 0.25)"},onMouseEnter:H=>!n&&(H.currentTarget.style.transform="translateY(-1px)"),onMouseLeave:H=>H.currentTarget.style.transform="translateY(0)",children:n?l==="signin"?"Signing in...":l==="signup"?"Creating account...":"Sending reset email...":l==="signin"?"Sign In":l==="signup"?"Create Account":"Send Reset Link"})]})}),l==="signin"&&u.jsx("div",{style:{textAlign:"center",marginTop:"1rem"},children:u.jsx("button",{type:"button",onClick:()=>{d("reset"),w(!1),s()},style:{background:"none",border:"none",color:"#667eea",fontSize:"0.875rem",cursor:"pointer",fontWeight:500,textDecoration:"none"},onMouseEnter:H=>H.currentTarget.style.textDecoration="underline",onMouseLeave:H=>H.currentTarget.style.textDecoration="none",children:"Forgot your password?"})}),u.jsx("div",{style:{position:"relative",margin:"1.5rem 0",height:"1px",background:"#e5e7eb"},children:u.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",padding:"0 1rem",background:"white",color:"#9ca3af",fontSize:"0.75rem",fontWeight:500},children:"OR"})}),u.jsx("div",{style:{textAlign:"center",fontSize:"0.875rem",color:"#6b7280"},children:l==="reset"?u.jsxs(u.Fragment,{children:["Remember your password?"," ",u.jsx("button",{type:"button",onClick:()=>{d("signin"),w(!1),s()},style:{background:"none",border:"none",color:"#667eea",fontWeight:600,cursor:"pointer",fontSize:"inherit"},onMouseEnter:H=>H.currentTarget.style.textDecoration="underline",onMouseLeave:H=>H.currentTarget.style.textDecoration="none",children:"Sign in"})]}):u.jsxs(u.Fragment,{children:[l==="signin"?"New to Navigator?":"Already have an account?"," ",u.jsx("button",{type:"button",onClick:()=>{d(l==="signin"?"signup":"signin"),T(""),w(!1),s()},style:{background:"none",border:"none",color:"#667eea",fontWeight:600,cursor:"pointer",fontSize:"inherit"},onMouseEnter:H=>H.currentTarget.style.textDecoration="underline",onMouseLeave:H=>H.currentTarget.style.textDecoration="none",children:l==="signin"?"Create account":"Sign in"})]})})]})]})})}function is({isLoading:e=!1,loadingText:t="Loading...",children:r,disabled:n,...a}){return u.jsxs("button",{...a,disabled:n||e,className:`${a.className||""} ${e?"btn-loading":""}`.trim(),children:[e&&u.jsx("span",{className:"loading-spinner","aria-hidden":"true",children:u.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",className:"spinner-icon",children:u.jsx("circle",{cx:"8",cy:"8",r:"6",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"37.7",strokeDashoffset:"37.7"})})}),u.jsx("span",{className:e?"loading-text":"",children:e?t:r})]})}function rC({size:e="md",text:t,className:r=""}){const a={sm:"16",md:"24",lg:"32"}[e];return u.jsxs("div",{className:`loading-spinner-container ${r}`,children:[u.jsx("svg",{width:a,height:a,viewBox:"0 0 24 24",className:"loading-spinner-icon",children:u.jsx("circle",{cx:"12",cy:"12",r:"9",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeDasharray:"56.5",strokeDashoffset:"56.5"})}),t&&u.jsx("span",{className:"loading-text",children:t})]})}function Fp({state:e,arrangement:t,preSelectedAddressIndex:r,onAddAddress:n,onSave:a,onCancel:s,isLoading:l=!1,onComplete:d,fullscreen:m=!1}){const p=rr.useRef(null),[g,y]=rr.useState(!1),[_,T]=rr.useState((r!=null,"existing")),[S,w]=rr.useState({addressIndex:t?.addressIndex??r??0,manualAddress:"",customerName:t?.customerName??"",phoneNumber:t?.phoneNumber??"",totalAmount:t?.amount??"",scheduledDate:t?.scheduledDate??new Date().toISOString().slice(0,10),scheduledTime:t?.scheduledTime??"",notes:t?.notes??"",status:t?.status??"Scheduled",previousPayments:[],isRecurring:!1,recurrenceType:"weekly",recurrenceInterval:1,totalPayments:4}),[E,P]=rr.useState({}),[D,A]=rr.useState(()=>{try{const z=localStorage.getItem("uaf-collapsed-sections");return z?JSON.parse(z):{previousPayments:!1,recurringPayments:!0}}catch{return{previousPayments:!1,recurringPayments:!0}}}),[H,J]=rr.useState(!1);rr.useEffect(()=>{try{localStorage.setItem("uaf-collapsed-sections",JSON.stringify(D))}catch(z){console.error("Failed to save collapse preferences:",z)}},[D]);const B=z=>{A(U=>({...U,[z]:!U[z]}))},I=S.previousPayments.reduce((z,U)=>z+parseFloat(U.amount||"0"),0),ee=parseFloat(S.totalAmount||"0"),re=ee-I,ye=S.previousPayments.length>0,he=rr.useMemo(()=>[...S.previousPayments].sort((z,U)=>new Date(z.date).getTime()-new Date(U.date).getTime()),[S.previousPayments]),ce=rr.useMemo(()=>{if(!S.isRecurring||S.totalPayments<2)return[];const z=[],U=Ra(S.scheduledDate);for(let te=0;te<S.totalPayments;te++){let W=U;S.recurrenceType==="weekly"?W=bx(U,te*S.recurrenceInterval):S.recurrenceType==="biweekly"?W=bx(U,te*2):S.recurrenceType==="monthly"&&(W=Qk(U,te*S.recurrenceInterval)),z.push(fh(W,"MMM d, yyyy"))}return z},[S.isRecurring,S.scheduledDate,S.recurrenceType,S.recurrenceInterval,S.totalPayments]),Ee=rr.useMemo(()=>{if(!t||!t.recurrenceType||t.recurrenceType==="none")return 0;const z=t.paymentsMade||0,U=t.totalPayments||1;return Math.round(z/U*100)},[t]);rr.useEffect(()=>{if(t){const z=t.addressIndex>=0&&t.addressIndex<e.addresses.length,U=z?e.addresses[t.addressIndex]?.address:null,te=t.address;!z||!(U===te)?(T("manual"),w(ae=>({...ae,addressIndex:0,manualAddress:te,customerName:t.customerName??"",phoneNumber:t.phoneNumber??"",totalAmount:t.amount??"",scheduledDate:t.scheduledDate,scheduledTime:t.scheduledTime??"",notes:t.notes??"",status:t.status}))):(T("existing"),w(ae=>({...ae,addressIndex:t.addressIndex,manualAddress:"",customerName:t.customerName??"",phoneNumber:t.phoneNumber??"",totalAmount:t.amount??"",scheduledDate:t.scheduledDate,scheduledTime:t.scheduledTime??"",notes:t.notes??"",status:t.status}))),t.recurrenceType&&t.recurrenceType!=="none"&&w(ae=>({...ae,isRecurring:!0}))}},[t,e.addresses]);const je=z=>{const U=parseFloat(z||"0");return!z||Number.isNaN(U)||U<=0?(P(te=>({...te,amount:"Please enter a valid total amount"})),!1):(P(te=>({...te,amount:void 0})),!0)},fe=()=>{let z=!0;return je(S.totalAmount)||(z=!1),re<0&&(P(U=>({...U,amount:"Previous payments exceed total amount"})),z=!1),_==="existing"&&e.addresses.length===0&&(P(U=>({...U,address:"No addresses available"})),z=!1),_==="manual"&&!S.manualAddress.trim()&&(P(U=>({...U,address:"Please enter an address"})),z=!1),z},ue=()=>{const z={id:`previous_${Date.now()}`,amount:"",date:new Date().toISOString().slice(0,10),notes:""};w(U=>({...U,previousPayments:[...U.previousPayments,z]}))},O=(z,U)=>{w(te=>({...te,previousPayments:te.previousPayments.map(W=>W.id===z?{...W,...U}:W)}))},F=z=>{w(U=>({...U,previousPayments:U.previousPayments.filter(te=>te.id!==z)}))},M=async z=>{z&&z.preventDefault(),!(g||l)&&fe()&&J(!0)},ie=async()=>{J(!1),y(!0);try{let z=S.addressIndex,U="";if(_==="existing"){const oe=e.addresses[S.addressIndex];if(!oe)throw new Error("Selected address is not valid");if(S.addressIndex<0||S.addressIndex>=e.addresses.length){const de=e.addresses.findIndex(ge=>ge.address.toLowerCase().trim()===oe.address.toLowerCase().trim());if(de>=0)z=de,U=e.addresses[de].address;else throw new Error("Selected address is no longer available")}else U=oe.address}else{const oe=e.addresses.findIndex(de=>de.address.toLowerCase().trim()===S.manualAddress.toLowerCase().trim());if(oe>=0)z=oe,U=e.addresses[oe].address;else{if(!n)throw new Error("Cannot add new addresses");const de={address:S.manualAddress.trim(),lat:null,lng:null};z=await n(de),U=de.address}}const te=re>0?re:ee;let W=te;S.isRecurring&&S.totalPayments>1&&(W=te/S.totalPayments);const ae={addressIndex:z,address:U,customerName:S.customerName,phoneNumber:S.phoneNumber,scheduledDate:S.scheduledDate,scheduledTime:S.scheduledTime,amount:W.toFixed(2),notes:S.notes,status:S.status,recurrenceType:S.isRecurring?S.recurrenceType:"none",recurrenceInterval:S.isRecurring?S.recurrenceInterval:void 0,totalPayments:S.isRecurring?S.totalPayments:1,paymentsMade:t?.paymentsMade??0};await a(ae);for(const oe of S.previousPayments)if(parseFloat(oe.amount)>0)try{d(z,"PIF",oe.amount)}catch(de){console.error("Error recording previous payment:",de)}}catch(z){console.error("Error saving arrangement:",z),alert(`Failed to save arrangement: ${z instanceof Error?z.message:"Please try again."}`)}finally{y(!1)}};rr.useEffect(()=>{if(!m)return;const z=U=>{U.key==="Escape"&&s()};return document.addEventListener("keydown",z),()=>document.removeEventListener("keydown",z)},[m,s]);const Y=u.jsxs("form",{onSubmit:M,className:"uaf-form",children:[u.jsxs("div",{className:"uaf-header",children:[u.jsx("h3",{className:"uaf-title",children:t?"✏️ Edit Payment Arrangement":"➕ Create Payment Arrangement"}),m&&u.jsx("button",{type:"button",className:"uaf-close",onClick:s,"aria-label":"Close",children:"✕"})]}),u.jsxs("div",{className:"uaf-section",children:[u.jsx("h4",{className:"uaf-section-title",children:"📍 Address & Customer"}),!t&&u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Address Source"}),u.jsxs("div",{className:"uaf-radio-group",children:[u.jsxs("label",{className:"uaf-radio-option",children:[u.jsx("input",{type:"radio",checked:_==="existing",onChange:()=>T("existing")}),u.jsx("span",{children:"📋 From List"})]}),u.jsxs("label",{className:"uaf-radio-option",children:[u.jsx("input",{type:"radio",checked:_==="manual",onChange:()=>T("manual")}),u.jsx("span",{children:"✏️ Enter Manually"})]})]})]}),_==="existing"?u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Address *"}),e.addresses.length===0?u.jsx("div",{className:"uaf-warning",children:'⚠️ No addresses in your list. Switch to "Enter Manually" to add a new address.'}):u.jsx("select",{value:S.addressIndex,onChange:z=>w(U=>({...U,addressIndex:parseInt(z.target.value)})),className:"uaf-input",required:!0,children:e.addresses.map((z,U)=>u.jsxs("option",{value:U,children:["#",U+1," - ",z.address]},U))})]}):u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Address *"}),u.jsx("input",{type:"text",value:S.manualAddress,onChange:z=>w(U=>({...U,manualAddress:z.target.value})),className:"uaf-input",placeholder:"Enter full address",required:!0}),u.jsx("div",{className:"uaf-hint",children:"💡 If this address doesn't exist in your list, it will be automatically added."})]}),u.jsxs("div",{className:"uaf-row",children:[u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Customer Name"}),u.jsx("input",{type:"text",value:S.customerName,onChange:z=>w(U=>({...U,customerName:z.target.value})),className:"uaf-input",placeholder:"Customer name"})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Phone Number"}),u.jsx("input",{type:"tel",value:S.phoneNumber,onChange:z=>w(U=>({...U,phoneNumber:z.target.value})),className:"uaf-input",placeholder:"Phone number"})]})]})]}),u.jsxs("div",{className:"uaf-section",children:[u.jsx("h4",{className:"uaf-section-title",children:"💰 Payment Details"}),u.jsxs("div",{className:"uaf-row",children:[u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Total Amount Owed *"}),u.jsxs("div",{className:"uaf-amount-input-wrapper",children:[u.jsx("span",{className:"uaf-amount-symbol",children:"£"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:S.totalAmount,onChange:z=>{w(U=>({...U,totalAmount:z.target.value})),je(z.target.value)},className:`uaf-input uaf-amount-input ${E.amount?"uaf-input-error":""}`,placeholder:"0.00",required:!0})]}),E.amount&&u.jsx("div",{className:"uaf-error",children:E.amount})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Due Date *"}),u.jsx("input",{type:"date",value:S.scheduledDate,onChange:z=>w(U=>({...U,scheduledDate:z.target.value})),className:"uaf-input",required:!0})]})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Time (Optional)"}),u.jsx("input",{type:"time",value:S.scheduledTime,onChange:z=>w(U=>({...U,scheduledTime:z.target.value})),className:"uaf-input"})]})]}),u.jsxs("div",{className:"uaf-section",children:[u.jsxs("div",{className:"uaf-section-header uaf-section-header-collapsible",onClick:()=>B("previousPayments"),children:[u.jsxs("h4",{className:"uaf-section-title",children:[u.jsx("span",{className:"uaf-collapse-icon",children:D.previousPayments?"▶":"▼"}),"💳 Payments Already Made ",ye&&`(${S.previousPayments.length})`]}),u.jsx("button",{type:"button",onClick:z=>{z.stopPropagation(),ue()},className:"uaf-btn uaf-btn-sm uaf-btn-outline",children:"+ Add Payment"})]}),!D.previousPayments&&u.jsxs(u.Fragment,{children:[S.previousPayments.length===0?u.jsx("div",{className:"uaf-empty",children:"No previous payments recorded yet."}):u.jsx("div",{className:"uaf-payments-list",children:he.map(z=>u.jsxs("div",{className:"uaf-payment-item",children:[u.jsxs("div",{className:"uaf-row",children:[u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Amount"}),u.jsx("input",{type:"number",step:"0.01",min:"0",value:z.amount,onChange:U=>O(z.id,{amount:U.target.value}),className:"uaf-input",placeholder:"0.00"})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Date Paid"}),u.jsx("input",{type:"date",value:z.date,onChange:U=>O(z.id,{date:U.target.value}),className:"uaf-input"})]}),u.jsx("div",{className:"uaf-field uaf-field-actions",children:u.jsx("button",{type:"button",onClick:()=>F(z.id),className:"uaf-btn uaf-btn-sm uaf-btn-danger",title:"Remove payment",children:"🗑️"})})]}),u.jsx("div",{className:"uaf-field",children:u.jsx("input",{type:"text",value:z.notes||"",onChange:U=>O(z.id,{notes:U.target.value}),className:"uaf-input",placeholder:"Payment notes (optional)"})})]},z.id))}),ye&&u.jsxs("div",{className:"uaf-payment-summary",children:[u.jsxs("div",{className:"uaf-summary-row",children:[u.jsx("span",{children:"Total Amount Owed:"}),u.jsxs("span",{children:["£",parseFloat(S.totalAmount||"0").toFixed(2)]})]}),u.jsxs("div",{className:"uaf-summary-row",children:[u.jsx("span",{children:"Already Paid:"}),u.jsxs("span",{children:["-£",I.toFixed(2)]})]}),u.jsxs("div",{className:"uaf-summary-row uaf-summary-total",children:[u.jsx("span",{children:"Still Owed:"}),u.jsxs("span",{children:["£",Math.max(0,re).toFixed(2)]})]})]})]})]}),re>0&&u.jsxs("div",{className:"uaf-section",children:[u.jsx("div",{className:"uaf-section-header uaf-section-header-collapsible",onClick:()=>B("recurringPayments"),children:u.jsxs("h4",{className:"uaf-section-title",children:[u.jsx("span",{className:"uaf-collapse-icon",children:D.recurringPayments?"▶":"▼"}),"🔄 Optional: Split Remaining Balance"]})}),!D.recurringPayments&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"uaf-field",children:u.jsxs("label",{className:"uaf-radio-option",children:[u.jsx("input",{type:"checkbox",checked:S.isRecurring,onChange:z=>w(U=>({...U,isRecurring:z.target.checked}))}),u.jsxs("span",{children:["Split £",re.toFixed(2)," into multiple payments"]})]})}),S.isRecurring&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"uaf-row",children:[u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Frequency"}),u.jsxs("select",{value:S.recurrenceType,onChange:z=>w(U=>({...U,recurrenceType:z.target.value})),className:"uaf-input",children:[u.jsx("option",{value:"weekly",children:"Weekly"}),u.jsx("option",{value:"biweekly",children:"Bi-weekly (Every 2 weeks)"}),u.jsx("option",{value:"monthly",children:"Monthly"})]})]}),u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Number of Payments"}),u.jsx("input",{type:"number",min:"2",max:"12",value:S.totalPayments,onChange:z=>w(U=>({...U,totalPayments:parseInt(z.target.value)||2})),className:"uaf-input"})]})]}),u.jsxs("div",{className:"uaf-payment-preview",children:["💡 ",S.totalPayments," payments of £",(re/S.totalPayments).toFixed(2)," each"]}),ce.length>0&&u.jsxs("div",{className:"uaf-timeline",children:[u.jsx("div",{className:"uaf-timeline-title",children:"📅 Payment Schedule:"}),u.jsx("div",{className:"uaf-timeline-dates",children:ce.map((z,U)=>u.jsxs("div",{className:"uaf-timeline-item",children:[u.jsx("span",{className:"uaf-timeline-number",children:U+1}),u.jsx("span",{className:"uaf-timeline-date",children:z}),u.jsxs("span",{className:"uaf-timeline-amount",children:["£",(re/S.totalPayments).toFixed(2)]})]},U))})]}),t&&t.recurrenceType&&t.recurrenceType!=="none"&&u.jsxs("div",{className:"uaf-completion-progress",children:[u.jsxs("div",{className:"uaf-completion-header",children:[u.jsx("span",{children:"Payment Progress"}),u.jsxs("span",{className:"uaf-completion-text",children:[t.paymentsMade||0," of ",t.totalPayments||1," (",Ee,"%)"]})]}),u.jsx("div",{className:"uaf-completion-bar",children:u.jsx("div",{className:"uaf-completion-fill",style:{width:`${Ee}%`}})})]})]})]})]}),u.jsx("div",{className:"uaf-section",children:u.jsxs("div",{className:"uaf-field",children:[u.jsx("label",{className:"uaf-label",children:"Notes"}),u.jsx("textarea",{value:S.notes,onChange:z=>w(U=>({...U,notes:z.target.value})),className:"uaf-input uaf-textarea",rows:3,placeholder:"Payment terms, special instructions, etc..."})]})}),u.jsxs("div",{className:"uaf-actions",children:[u.jsx("button",{type:"button",className:"uaf-btn uaf-btn-ghost",onClick:s,children:"Cancel"}),u.jsxs(is,{type:"submit",className:"uaf-btn uaf-btn-primary",isLoading:l||g,loadingText:t?"Updating...":"Creating...",disabled:_==="existing"&&e.addresses.length===0,children:[t?"💾 Update":"📅 Review & Create"," Arrangement"]})]}),H&&u.jsx("div",{className:"uaf-confirmation-overlay",onClick:()=>J(!1),children:u.jsxs("div",{className:"uaf-confirmation-modal",onClick:z=>z.stopPropagation(),children:[u.jsx("div",{className:"uaf-confirmation-header",children:u.jsx("h3",{children:"✅ Confirm Arrangement Details"})}),u.jsxs("div",{className:"uaf-confirmation-body",children:[u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"📍 Address"}),u.jsx("div",{className:"uaf-confirmation-value",children:_==="existing"?e.addresses[S.addressIndex]?.address:S.manualAddress})]}),S.customerName&&u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"👤 Customer"}),u.jsx("div",{className:"uaf-confirmation-value",children:S.customerName})]}),u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"💰 Total Amount"}),u.jsxs("div",{className:"uaf-confirmation-value uaf-confirmation-amount",children:["£",parseFloat(S.totalAmount||"0").toFixed(2)]})]}),ye&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"💳 Previous Payments"}),u.jsxs("div",{className:"uaf-confirmation-value",children:["£",I.toFixed(2)," (",S.previousPayments.length," payment",S.previousPayments.length>1?"s":"",")"]})]}),u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"📊 Remaining Balance"}),u.jsxs("div",{className:"uaf-confirmation-value uaf-confirmation-highlight",children:["£",re.toFixed(2)]})]})]}),u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"📅 Payment Due"}),u.jsxs("div",{className:"uaf-confirmation-value",children:[fh(Ra(S.scheduledDate),"MMMM d, yyyy"),S.scheduledTime&&` at ${S.scheduledTime}`]})]}),S.isRecurring&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"🔄 Payment Plan"}),u.jsxs("div",{className:"uaf-confirmation-value",children:[S.totalPayments," ",S.recurrenceType," payments of £",(re/S.totalPayments).toFixed(2)]})]}),u.jsxs("div",{className:"uaf-confirmation-timeline",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"📅 Schedule:"}),u.jsxs("div",{className:"uaf-confirmation-dates",children:[ce.slice(0,3).map((z,U)=>u.jsx("span",{children:z},U)),ce.length>3&&u.jsxs("span",{children:["+ ",ce.length-3," more..."]})]})]})]}),S.notes&&u.jsxs("div",{className:"uaf-confirmation-section",children:[u.jsx("div",{className:"uaf-confirmation-label",children:"📝 Notes"}),u.jsx("div",{className:"uaf-confirmation-value",children:S.notes})]})]}),u.jsxs("div",{className:"uaf-confirmation-actions",children:[u.jsx("button",{type:"button",className:"uaf-btn uaf-btn-ghost",onClick:()=>J(!1),children:"← Back to Edit"}),u.jsx(is,{type:"button",className:"uaf-btn uaf-btn-success",isLoading:g,loadingText:"Creating...",onClick:ie,children:"✅ Confirm & Create"})]})]})})]}),R=u.jsx("style",{children:`
        /* Unified Arrangement Form Styles */
        .uaf-container {
          background: var(--card-bg, white);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 12px;
          overflow: hidden;
        }

        .uaf-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          z-index: 4000;
          display: flex;
          align-items: flex-start;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          overflow-y: auto;
          padding-top: 2rem;
        }

        .uaf-modal {
          background: var(--card-bg, white);
          border-radius: 16px;
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
          width: 100%;
          max-width: 700px;
          max-height: 90vh;
          overflow-y: auto;
          margin: 0 auto;
        }

        .uaf-form {
          padding: 1.5rem;
          color: var(--text-primary);
        }

        .uaf-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 2rem;
          padding-bottom: 1rem;
          border-bottom: 1px solid var(--border, #e2e8f0);
        }

        .uaf-title {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          padding: 0.5rem;
          border-radius: 8px;
          cursor: pointer;
          color: var(--text-muted);
          line-height: 1;
        }

        .uaf-close:hover {
          background: var(--gray-100);
        }

        .uaf-section {
          margin-bottom: 1.5rem;
          padding: 0;
          background: transparent;
          border-radius: 0;
          border: none;
          border-bottom: 1px solid var(--border, #e2e8f0);
          padding-bottom: 1.5rem;
        }

        .uaf-section:last-of-type {
          border-bottom: none;
          padding-bottom: 0;
        }

        .uaf-section-title {
          margin: 0 0 1rem 0;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-section-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .uaf-field {
          margin-bottom: 1rem;
        }

        .uaf-field-actions {
          display: flex;
          align-items: flex-end;
        }

        .uaf-label {
          display: block;
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--text-secondary);
          margin-bottom: 0.5rem;
        }

        .uaf-input {
          width: 100%;
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
          padding: 0.75rem;
          font-size: 14px;
          background: var(--input-bg, white);
          color: var(--text-primary);
          transition: border-color 0.15s ease;
        }

        .uaf-input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14,165,233,0.1);
        }

        .uaf-input-error {
          border-color: var(--danger, #dc2626);
        }

        .uaf-textarea {
          resize: vertical;
          min-height: 80px;
        }

        .uaf-error {
          color: var(--danger, #dc2626);
          font-size: 0.8125rem;
          margin-top: 0.25rem;
        }

        .uaf-warning {
          padding: 0.75rem;
          background: var(--warning-light, #fef3c7);
          border: 1px solid var(--warning, #f59e0b);
          border-radius: 6px;
          color: var(--warning-dark, #92400e);
          font-size: 0.875rem;
        }

        .uaf-hint {
          font-size: 0.8125rem;
          color: var(--text-muted);
          margin-top: 0.25rem;
        }

        .uaf-row {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
          align-items: start;
        }

        .uaf-radio-group {
          display: flex;
          gap: 1rem;
          flex-wrap: wrap;
        }

        .uaf-radio-option {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          cursor: pointer;
          padding: 0.5rem 1rem;
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
          background: var(--input-bg, white);
          transition: all 0.15s ease;
        }

        .uaf-radio-option:hover {
          border-color: var(--primary, #0ea5e9);
        }

        .uaf-radio-option input[type="radio"] {
          margin: 0;
        }

        .uaf-radio-option input[type="radio"]:checked + span {
          font-weight: 600;
          color: var(--primary, #0ea5e9);
        }

        .uaf-payment-preview {
          padding: 0.75rem;
          background: var(--blue-50, #eff6ff);
          border: 1px solid var(--blue-200, #bfdbfe);
          border-radius: 6px;
          color: var(--blue-700, #1d4ed8);
          font-size: 0.875rem;
          font-weight: 500;
        }

        .uaf-empty {
          text-align: center;
          padding: 2rem;
          color: var(--text-muted);
          font-style: italic;
        }

        .uaf-payments-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .uaf-payment-item {
          padding: 1rem;
          background: var(--input-bg, white);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-payment-summary {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-summary-row {
          display: flex;
          justify-content: space-between;
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .uaf-summary-total {
          border-top: 1px solid var(--border, #e2e8f0);
          padding-top: 0.5rem;
          margin-top: 0.5rem;
          font-weight: 600;
          font-size: 1rem;
          color: var(--success-dark, #059669);
        }

        .uaf-actions {
          display: flex;
          gap: 0.75rem;
          justify-content: flex-end;
          padding-top: 1rem;
          border-top: 1px solid var(--border, #e2e8f0);
        }

        .uaf-btn {
          border-radius: 6px;
          padding: 0.75rem 1.5rem;
          font-weight: 500;
          border: 1px solid transparent;
          cursor: pointer;
          transition: all 0.15s ease;
          font-size: 14px;
          display: inline-flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
        }

        .uaf-btn-sm {
          padding: 0.5rem 1rem;
          font-size: 0.875rem;
        }

        .uaf-btn-ghost {
          background: var(--card-bg, white);
          border-color: var(--border, #e2e8f0);
          color: var(--text-primary);
        }

        .uaf-btn-ghost:hover {
          background: var(--gray-100, #f3f4f6);
        }

        .uaf-btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
          border-color: var(--primary, #0ea5e9);
        }

        .uaf-btn-primary:hover {
          background: var(--primary-dark, #0284c7);
        }

        .uaf-btn-outline {
          background: transparent;
          border-color: var(--primary, #0ea5e9);
          color: var(--primary, #0ea5e9);
        }

        .uaf-btn-outline:hover {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .uaf-btn-danger {
          background: var(--danger, #dc2626);
          color: white;
          border-color: var(--danger, #dc2626);
        }

        .uaf-btn-danger:hover {
          background: var(--danger-dark, #b91c1c);
        }

        .uaf-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .uaf-btn-success {
          background: var(--success, #10b981);
          color: white;
          border-color: var(--success, #10b981);
        }

        .uaf-btn-success:hover {
          background: var(--success-dark, #059669);
        }

        /* Collapsible Section Styles */
        .uaf-section-header-collapsible {
          cursor: pointer;
          user-select: none;
        }

        .uaf-section-header-collapsible:hover {
          background: var(--gray-50, #f9fafb);
          border-radius: 6px;
          margin: -0.5rem;
          padding: 0.5rem;
        }

        .uaf-collapse-icon {
          display: inline-block;
          margin-right: 0.5rem;
          font-size: 0.75rem;
          transition: transform 0.2s ease;
        }

        /* Amount Input with £ Symbol */
        .uaf-amount-input-wrapper {
          position: relative;
          display: flex;
          align-items: center;
        }

        .uaf-amount-symbol {
          position: absolute;
          left: 0.75rem;
          font-size: 1.1rem;
          font-weight: 600;
          color: var(--success, #10b981);
          z-index: 1;
          pointer-events: none;
        }

        .uaf-amount-input {
          padding-left: 2rem !important;
          font-weight: 600;
          color: var(--success-dark, #059669);
          border-color: var(--success-light, #a7f3d0) !important;
          background: var(--success-lighter, #f0fdf4) !important;
        }

        .uaf-amount-input:focus {
          border-color: var(--success, #10b981) !important;
          box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1) !important;
        }

        /* Timeline Styles */
        .uaf-timeline {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border: 1px solid var(--border, #e2e8f0);
          border-radius: 6px;
        }

        .uaf-timeline-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--text-secondary);
          margin-bottom: 0.75rem;
        }

        .uaf-timeline-dates {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .uaf-timeline-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: 4px;
          border-left: 3px solid var(--primary, #0ea5e9);
        }

        .uaf-timeline-number {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          width: 1.5rem;
          height: 1.5rem;
          background: var(--primary, #0ea5e9);
          color: white;
          border-radius: 50%;
          font-size: 0.75rem;
          font-weight: 600;
          flex-shrink: 0;
        }

        .uaf-timeline-date {
          flex: 1;
          font-size: 0.875rem;
          color: var(--text-primary);
        }

        .uaf-timeline-amount {
          font-weight: 600;
          color: var(--success-dark, #059669);
          font-size: 0.875rem;
        }

        /* Completion Progress Bar */
        .uaf-completion-progress {
          margin-top: 1rem;
          padding: 1rem;
          background: var(--blue-50, #eff6ff);
          border: 1px solid var(--blue-200, #bfdbfe);
          border-radius: 6px;
        }

        .uaf-completion-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--blue-700, #1d4ed8);
        }

        .uaf-completion-text {
          font-size: 0.8125rem;
        }

        .uaf-completion-bar {
          width: 100%;
          height: 0.5rem;
          background: var(--blue-100, #dbeafe);
          border-radius: 1rem;
          overflow: hidden;
        }

        .uaf-completion-fill {
          height: 100%;
          background: linear-gradient(90deg, var(--success, #10b981), var(--primary, #0ea5e9));
          transition: width 0.3s ease;
          border-radius: 1rem;
        }

        /* Confirmation Modal Styles */
        .uaf-confirmation-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.6);
          z-index: 5000;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 1rem;
          backdrop-filter: blur(4px);
          animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        .uaf-confirmation-modal {
          background: var(--card-bg, white);
          border-radius: 16px;
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          width: 100%;
          max-width: 550px;
          max-height: 85vh;
          overflow-y: auto;
          animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .uaf-confirmation-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--border, #e2e8f0);
          background: var(--gray-50, #f9fafb);
        }

        .uaf-confirmation-header h3 {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-primary);
        }

        .uaf-confirmation-body {
          padding: 1.5rem;
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .uaf-confirmation-section {
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .uaf-confirmation-label {
          font-size: 0.8125rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .uaf-confirmation-value {
          font-size: 1rem;
          color: var(--text-primary);
          font-weight: 500;
        }

        .uaf-confirmation-amount {
          font-size: 1.5rem;
          font-weight: 700;
          color: var(--success-dark, #059669);
        }

        .uaf-confirmation-highlight {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--primary, #0ea5e9);
        }

        .uaf-confirmation-timeline {
          padding: 1rem;
          background: var(--gray-50, #f9fafb);
          border-radius: 6px;
          border: 1px solid var(--border, #e2e8f0);
        }

        .uaf-confirmation-dates {
          display: flex;
          flex-wrap: wrap;
          gap: 0.5rem;
          margin-top: 0.5rem;
        }

        .uaf-confirmation-dates span {
          padding: 0.25rem 0.75rem;
          background: var(--primary-light, #e0f2fe);
          color: var(--primary-dark, #0369a1);
          border-radius: 4px;
          font-size: 0.8125rem;
          font-weight: 500;
        }

        .uaf-confirmation-actions {
          display: flex;
          gap: 0.75rem;
          padding: 1.5rem;
          border-top: 1px solid var(--border, #e2e8f0);
          background: var(--gray-50, #f9fafb);
        }

        .uaf-confirmation-actions .uaf-btn {
          flex: 1;
        }

        /* Dark mode styles */
        .dark-mode .uaf-container,
        .dark-mode .uaf-modal {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-section {
          background: transparent;
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-summary {
          background: var(--gray-300);
          border-color: var(--gray-400);
        }

        .dark-mode .uaf-input {
          background: var(--gray-100);
          border-color: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .uaf-radio-option {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-payment-preview {
          background: var(--blue-100);
          border-color: var(--blue-300);
          color: var(--blue-800);
        }

        .dark-mode .uaf-warning {
          background: var(--yellow-100);
          border-color: var(--yellow-400);
          color: var(--yellow-800);
        }

        /* Dark mode for new components */
        .dark-mode .uaf-amount-input {
          background: var(--success-lighter, #ecfdf5) !important;
          color: var(--success-dark, #065f46);
        }

        .dark-mode .uaf-amount-symbol {
          color: var(--success-dark, #065f46);
        }

        .dark-mode .uaf-timeline {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-timeline-item {
          background: var(--gray-100);
        }

        .dark-mode .uaf-completion-progress {
          background: var(--blue-100);
          border-color: var(--blue-300);
        }

        .dark-mode .uaf-confirmation-overlay {
          background: rgba(0, 0, 0, 0.75);
        }

        .dark-mode .uaf-confirmation-modal {
          background: var(--gray-100);
        }

        .dark-mode .uaf-confirmation-header {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-confirmation-header h3 {
          color: var(--gray-800);
        }

        .dark-mode .uaf-confirmation-label {
          color: var(--gray-600);
        }

        .dark-mode .uaf-confirmation-value {
          color: var(--gray-800);
        }

        .dark-mode .uaf-confirmation-timeline {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .uaf-confirmation-actions {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .uaf-modal {
            margin: 0.5rem;
            max-width: none;
          }

          .uaf-row {
            grid-template-columns: 1fr;
          }

          .uaf-radio-group {
            flex-direction: column;
          }

          .uaf-actions {
            flex-direction: column-reverse;
          }

          .uaf-btn {
            width: 100%;
          }
        }
      `});return m?u.jsxs(u.Fragment,{children:[u.jsx("div",{ref:p,className:"uaf-overlay",onClick:z=>{z.target===z.currentTarget&&s()},children:u.jsx("div",{className:"uaf-modal",children:Y})}),R]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"uaf-container",children:Y}),R]})}function f_(e,t){const r=Z.useRef(t);Z.useEffect(function(){t!==r.current&&e.attributionControl!=null&&(r.current!=null&&e.attributionControl.removeAttribution(r.current),t!=null&&e.attributionControl.addAttribution(t)),r.current=t},[e,t])}var h_=Iy();const nC=1;function aC(e){return Object.freeze({__version:nC,map:e})}function m_(e,t){return Object.freeze({...e,...t})}const p_=Z.createContext(null),g_=p_.Provider;function Fh(){const e=Z.useContext(p_);if(e==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}function v_(e){function t(r,n){const{instance:a,context:s}=e(r).current;return Z.useImperativeHandle(n,()=>a),r.children==null?null:rr.createElement(g_,{value:s},r.children)}return Z.forwardRef(t)}function iC(e){function t(r,n){const[a,s]=Z.useState(!1),{instance:l}=e(r,s).current;Z.useImperativeHandle(n,()=>l),Z.useEffect(function(){a&&l.update()},[l,a,r.children]);const d=l._contentNode;return d?h_.createPortal(r.children,d):null}return Z.forwardRef(t)}function sC(e){function t(r,n){const{instance:a}=e(r).current;return Z.useImperativeHandle(n,()=>a),null}return Z.forwardRef(t)}function jp(e,t){const r=Z.useRef();Z.useEffect(function(){return t!=null&&e.instance.on(t),r.current=t,function(){r.current!=null&&e.instance.off(r.current),r.current=null}},[e,t])}function jh(e,t){const r=e.pane??t.pane;return r?{...e,pane:r}:e}function oC(e,t){return function(n,a){const s=Fh(),l=e(jh(n,s),s);return f_(s.map,n.attribution),jp(l.current,n.eventHandlers),t(l.current,s,n,a),l}}var ju={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var lC=ju.exports,a1;function cC(){return a1||(a1=1,(function(e,t){(function(r,n){n(t)})(lC,(function(r){var n="1.9.4";function a(o){var f,v,b,N;for(v=1,b=arguments.length;v<b;v++){N=arguments[v];for(f in N)o[f]=N[f]}return o}var s=Object.create||(function(){function o(){}return function(f){return o.prototype=f,new o}})();function l(o,f){var v=Array.prototype.slice;if(o.bind)return o.bind.apply(o,v.call(arguments,1));var b=v.call(arguments,2);return function(){return o.apply(f,b.length?b.concat(v.call(arguments)):arguments)}}var d=0;function m(o){return"_leaflet_id"in o||(o._leaflet_id=++d),o._leaflet_id}function p(o,f,v){var b,N,G,pe;return pe=function(){b=!1,N&&(G.apply(v,N),N=!1)},G=function(){b?N=arguments:(o.apply(v,arguments),setTimeout(pe,f),b=!0)},G}function g(o,f,v){var b=f[1],N=f[0],G=b-N;return o===b&&v?o:((o-N)%G+G)%G+N}function y(){return!1}function _(o,f){if(f===!1)return o;var v=Math.pow(10,f===void 0?6:f);return Math.round(o*v)/v}function T(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function S(o){return T(o).split(/\s+/)}function w(o,f){Object.prototype.hasOwnProperty.call(o,"options")||(o.options=o.options?s(o.options):{});for(var v in f)o.options[v]=f[v];return o.options}function E(o,f,v){var b=[];for(var N in o)b.push(encodeURIComponent(v?N.toUpperCase():N)+"="+encodeURIComponent(o[N]));return(!f||f.indexOf("?")===-1?"?":"&")+b.join("&")}var P=/\{ *([\w_ -]+) *\}/g;function D(o,f){return o.replace(P,function(v,b){var N=f[b];if(N===void 0)throw new Error("No value provided for variable "+v);return typeof N=="function"&&(N=N(f)),N})}var A=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"};function H(o,f){for(var v=0;v<o.length;v++)if(o[v]===f)return v;return-1}var J="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function B(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}var I=0;function ee(o){var f=+new Date,v=Math.max(0,16-(f-I));return I=f+v,window.setTimeout(o,v)}var re=window.requestAnimationFrame||B("RequestAnimationFrame")||ee,ye=window.cancelAnimationFrame||B("CancelAnimationFrame")||B("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)};function he(o,f,v){if(v&&re===ee)o.call(f);else return re.call(window,l(o,f))}function ce(o){o&&ye.call(window,o)}var Ee={__proto__:null,extend:a,create:s,bind:l,get lastId(){return d},stamp:m,throttle:p,wrapNum:g,falseFn:y,formatNum:_,trim:T,splitWords:S,setOptions:w,getParamString:E,template:D,isArray:A,indexOf:H,emptyImageUrl:J,requestFn:re,cancelFn:ye,requestAnimFrame:he,cancelAnimFrame:ce};function je(){}je.extend=function(o){var f=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},v=f.__super__=this.prototype,b=s(v);b.constructor=f,f.prototype=b;for(var N in this)Object.prototype.hasOwnProperty.call(this,N)&&N!=="prototype"&&N!=="__super__"&&(f[N]=this[N]);return o.statics&&a(f,o.statics),o.includes&&(fe(o.includes),a.apply(null,[b].concat(o.includes))),a(b,o),delete b.statics,delete b.includes,b.options&&(b.options=v.options?s(v.options):{},a(b.options,o.options)),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){v.callInitHooks&&v.callInitHooks.call(this),this._initHooksCalled=!0;for(var G=0,pe=b._initHooks.length;G<pe;G++)b._initHooks[G].call(this)}},f},je.include=function(o){var f=this.prototype.options;return a(this.prototype,o),o.options&&(this.prototype.options=f,this.mergeOptions(o.options)),this},je.mergeOptions=function(o){return a(this.prototype.options,o),this},je.addInitHook=function(o){var f=Array.prototype.slice.call(arguments,1),v=typeof o=="function"?o:function(){this[o].apply(this,f)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(v),this};function fe(o){if(!(typeof L>"u"||!L||!L.Mixin)){o=A(o)?o:[o];for(var f=0;f<o.length;f++)o[f]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ue={on:function(o,f,v){if(typeof o=="object")for(var b in o)this._on(b,o[b],f);else{o=S(o);for(var N=0,G=o.length;N<G;N++)this._on(o[N],f,v)}return this},off:function(o,f,v){if(!arguments.length)delete this._events;else if(typeof o=="object")for(var b in o)this._off(b,o[b],f);else{o=S(o);for(var N=arguments.length===1,G=0,pe=o.length;G<pe;G++)N?this._off(o[G]):this._off(o[G],f,v)}return this},_on:function(o,f,v,b){if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}if(this._listens(o,f,v)===!1){v===this&&(v=void 0);var N={fn:f,ctx:v};b&&(N.once=!0),this._events=this._events||{},this._events[o]=this._events[o]||[],this._events[o].push(N)}},_off:function(o,f,v){var b,N,G;if(this._events&&(b=this._events[o],!!b)){if(arguments.length===1){if(this._firingCount)for(N=0,G=b.length;N<G;N++)b[N].fn=y;delete this._events[o];return}if(typeof f!="function"){console.warn("wrong listener type: "+typeof f);return}var pe=this._listens(o,f,v);if(pe!==!1){var Se=b[pe];this._firingCount&&(Se.fn=y,this._events[o]=b=b.slice()),b.splice(pe,1)}}},fire:function(o,f,v){if(!this.listens(o,v))return this;var b=a({},f,{type:o,target:this,sourceTarget:f&&f.sourceTarget||this});if(this._events){var N=this._events[o];if(N){this._firingCount=this._firingCount+1||1;for(var G=0,pe=N.length;G<pe;G++){var Se=N[G],Ne=Se.fn;Se.once&&this.off(o,Ne,Se.ctx),Ne.call(Se.ctx||this,b)}this._firingCount--}}return v&&this._propagateEvent(b),this},listens:function(o,f,v,b){typeof o!="string"&&console.warn('"string" type argument expected');var N=f;typeof f!="function"&&(b=!!f,N=void 0,v=void 0);var G=this._events&&this._events[o];if(G&&G.length&&this._listens(o,N,v)!==!1)return!0;if(b){for(var pe in this._eventParents)if(this._eventParents[pe].listens(o,f,v,b))return!0}return!1},_listens:function(o,f,v){if(!this._events)return!1;var b=this._events[o]||[];if(!f)return!!b.length;v===this&&(v=void 0);for(var N=0,G=b.length;N<G;N++)if(b[N].fn===f&&b[N].ctx===v)return N;return!1},once:function(o,f,v){if(typeof o=="object")for(var b in o)this._on(b,o[b],f,!0);else{o=S(o);for(var N=0,G=o.length;N<G;N++)this._on(o[N],f,v,!0)}return this},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[m(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[m(o)],this},_propagateEvent:function(o){for(var f in this._eventParents)this._eventParents[f].fire(o.type,a({layer:o.target,propagatedFrom:o.target},o),!0)}};ue.addEventListener=ue.on,ue.removeEventListener=ue.clearAllEventListeners=ue.off,ue.addOneTimeEventListener=ue.once,ue.fireEvent=ue.fire,ue.hasEventListeners=ue.listens;var O=je.extend(ue);function F(o,f,v){this.x=v?Math.round(o):o,this.y=v?Math.round(f):f}var M=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};F.prototype={clone:function(){return new F(this.x,this.y)},add:function(o){return this.clone()._add(ie(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(ie(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new F(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new F(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=M(this.x),this.y=M(this.y),this},distanceTo:function(o){o=ie(o);var f=o.x-this.x,v=o.y-this.y;return Math.sqrt(f*f+v*v)},equals:function(o){return o=ie(o),o.x===this.x&&o.y===this.y},contains:function(o){return o=ie(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+_(this.x)+", "+_(this.y)+")"}};function ie(o,f,v){return o instanceof F?o:A(o)?new F(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new F(o.x,o.y):new F(o,f,v)}function Y(o,f){if(o)for(var v=f?[o,f]:o,b=0,N=v.length;b<N;b++)this.extend(v[b])}Y.prototype={extend:function(o){var f,v;if(!o)return this;if(o instanceof F||typeof o[0]=="number"||"x"in o)f=v=ie(o);else if(o=R(o),f=o.min,v=o.max,!f||!v)return this;return!this.min&&!this.max?(this.min=f.clone(),this.max=v.clone()):(this.min.x=Math.min(f.x,this.min.x),this.max.x=Math.max(v.x,this.max.x),this.min.y=Math.min(f.y,this.min.y),this.max.y=Math.max(v.y,this.max.y)),this},getCenter:function(o){return ie((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return ie(this.min.x,this.max.y)},getTopRight:function(){return ie(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var f,v;return typeof o[0]=="number"||o instanceof F?o=ie(o):o=R(o),o instanceof Y?(f=o.min,v=o.max):f=v=o,f.x>=this.min.x&&v.x<=this.max.x&&f.y>=this.min.y&&v.y<=this.max.y},intersects:function(o){o=R(o);var f=this.min,v=this.max,b=o.min,N=o.max,G=N.x>=f.x&&b.x<=v.x,pe=N.y>=f.y&&b.y<=v.y;return G&&pe},overlaps:function(o){o=R(o);var f=this.min,v=this.max,b=o.min,N=o.max,G=N.x>f.x&&b.x<v.x,pe=N.y>f.y&&b.y<v.y;return G&&pe},isValid:function(){return!!(this.min&&this.max)},pad:function(o){var f=this.min,v=this.max,b=Math.abs(f.x-v.x)*o,N=Math.abs(f.y-v.y)*o;return R(ie(f.x-b,f.y-N),ie(v.x+b,v.y+N))},equals:function(o){return o?(o=R(o),this.min.equals(o.getTopLeft())&&this.max.equals(o.getBottomRight())):!1}};function R(o,f){return!o||o instanceof Y?o:new Y(o,f)}function z(o,f){if(o)for(var v=f?[o,f]:o,b=0,N=v.length;b<N;b++)this.extend(v[b])}z.prototype={extend:function(o){var f=this._southWest,v=this._northEast,b,N;if(o instanceof te)b=o,N=o;else if(o instanceof z){if(b=o._southWest,N=o._northEast,!b||!N)return this}else return o?this.extend(W(o)||U(o)):this;return!f&&!v?(this._southWest=new te(b.lat,b.lng),this._northEast=new te(N.lat,N.lng)):(f.lat=Math.min(b.lat,f.lat),f.lng=Math.min(b.lng,f.lng),v.lat=Math.max(N.lat,v.lat),v.lng=Math.max(N.lng,v.lng)),this},pad:function(o){var f=this._southWest,v=this._northEast,b=Math.abs(f.lat-v.lat)*o,N=Math.abs(f.lng-v.lng)*o;return new z(new te(f.lat-b,f.lng-N),new te(v.lat+b,v.lng+N))},getCenter:function(){return new te((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new te(this.getNorth(),this.getWest())},getSouthEast:function(){return new te(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){typeof o[0]=="number"||o instanceof te||"lat"in o?o=W(o):o=U(o);var f=this._southWest,v=this._northEast,b,N;return o instanceof z?(b=o.getSouthWest(),N=o.getNorthEast()):b=N=o,b.lat>=f.lat&&N.lat<=v.lat&&b.lng>=f.lng&&N.lng<=v.lng},intersects:function(o){o=U(o);var f=this._southWest,v=this._northEast,b=o.getSouthWest(),N=o.getNorthEast(),G=N.lat>=f.lat&&b.lat<=v.lat,pe=N.lng>=f.lng&&b.lng<=v.lng;return G&&pe},overlaps:function(o){o=U(o);var f=this._southWest,v=this._northEast,b=o.getSouthWest(),N=o.getNorthEast(),G=N.lat>f.lat&&b.lat<v.lat,pe=N.lng>f.lng&&b.lng<v.lng;return G&&pe},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,f){return o?(o=U(o),this._southWest.equals(o.getSouthWest(),f)&&this._northEast.equals(o.getNorthEast(),f)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function U(o,f){return o instanceof z?o:new z(o,f)}function te(o,f,v){if(isNaN(o)||isNaN(f))throw new Error("Invalid LatLng object: ("+o+", "+f+")");this.lat=+o,this.lng=+f,v!==void 0&&(this.alt=+v)}te.prototype={equals:function(o,f){if(!o)return!1;o=W(o);var v=Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng));return v<=(f===void 0?1e-9:f)},toString:function(o){return"LatLng("+_(this.lat,o)+", "+_(this.lng,o)+")"},distanceTo:function(o){return oe.distance(this,W(o))},wrap:function(){return oe.wrapLatLng(this)},toBounds:function(o){var f=180*o/40075017,v=f/Math.cos(Math.PI/180*this.lat);return U([this.lat-f,this.lng-v],[this.lat+f,this.lng+v])},clone:function(){return new te(this.lat,this.lng,this.alt)}};function W(o,f,v){return o instanceof te?o:A(o)&&typeof o[0]!="object"?o.length===3?new te(o[0],o[1],o[2]):o.length===2?new te(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new te(o.lat,"lng"in o?o.lng:o.lon,o.alt):f===void 0?null:new te(o,f,v)}var ae={latLngToPoint:function(o,f){var v=this.projection.project(o),b=this.scale(f);return this.transformation._transform(v,b)},pointToLatLng:function(o,f){var v=this.scale(f),b=this.transformation.untransform(o,v);return this.projection.unproject(b)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var f=this.projection.bounds,v=this.scale(o),b=this.transformation.transform(f.min,v),N=this.transformation.transform(f.max,v);return new Y(b,N)},infinite:!1,wrapLatLng:function(o){var f=this.wrapLng?g(o.lng,this.wrapLng,!0):o.lng,v=this.wrapLat?g(o.lat,this.wrapLat,!0):o.lat,b=o.alt;return new te(v,f,b)},wrapLatLngBounds:function(o){var f=o.getCenter(),v=this.wrapLatLng(f),b=f.lat-v.lat,N=f.lng-v.lng;if(b===0&&N===0)return o;var G=o.getSouthWest(),pe=o.getNorthEast(),Se=new te(G.lat-b,G.lng-N),Ne=new te(pe.lat-b,pe.lng-N);return new z(Se,Ne)}},oe=a({},ae,{wrapLng:[-180,180],R:6371e3,distance:function(o,f){var v=Math.PI/180,b=o.lat*v,N=f.lat*v,G=Math.sin((f.lat-o.lat)*v/2),pe=Math.sin((f.lng-o.lng)*v/2),Se=G*G+Math.cos(b)*Math.cos(N)*pe*pe,Ne=2*Math.atan2(Math.sqrt(Se),Math.sqrt(1-Se));return this.R*Ne}}),de=6378137,ge={R:de,MAX_LATITUDE:85.0511287798,project:function(o){var f=Math.PI/180,v=this.MAX_LATITUDE,b=Math.max(Math.min(v,o.lat),-v),N=Math.sin(b*f);return new F(this.R*o.lng*f,this.R*Math.log((1+N)/(1-N))/2)},unproject:function(o){var f=180/Math.PI;return new te((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*f,o.x*f/this.R)},bounds:(function(){var o=de*Math.PI;return new Y([-o,-o],[o,o])})()};function Oe(o,f,v,b){if(A(o)){this._a=o[0],this._b=o[1],this._c=o[2],this._d=o[3];return}this._a=o,this._b=f,this._c=v,this._d=b}Oe.prototype={transform:function(o,f){return this._transform(o.clone(),f)},_transform:function(o,f){return f=f||1,o.x=f*(this._a*o.x+this._b),o.y=f*(this._c*o.y+this._d),o},untransform:function(o,f){return f=f||1,new F((o.x/f-this._b)/this._a,(o.y/f-this._d)/this._c)}};function q(o,f,v,b){return new Oe(o,f,v,b)}var Ze=a({},oe,{code:"EPSG:3857",projection:ge,transformation:(function(){var o=.5/(Math.PI*ge.R);return q(o,.5,-o,.5)})()}),Je=a({},Ze,{code:"EPSG:900913"});function Ye(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function nt(o,f){var v="",b,N,G,pe,Se,Ne;for(b=0,G=o.length;b<G;b++){for(Se=o[b],N=0,pe=Se.length;N<pe;N++)Ne=Se[N],v+=(N?"L":"M")+Ne.x+" "+Ne.y;v+=f?De.svg?"z":"x":""}return v||"M0 0"}var Be=document.documentElement.style,bt="ActiveXObject"in window,dt=bt&&!document.addEventListener,ht="msLaunchUri"in navigator&&!("documentMode"in document),Kt=Le("webkit"),In=Le("android"),zr=Le("android 2")||Le("android 3"),Er=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),fn=In&&Le("Google")&&Er<537&&!("AudioNode"in window),Fr=!!window.opera,sn=!ht&&Le("chrome"),Qt=Le("gecko")&&!Kt&&!Fr&&!bt,Cr=!sn&&Le("safari"),pt=Le("phantom"),At="OTransition"in Be,Ar=navigator.platform.indexOf("Win")===0,Zt=bt&&"transition"in Be,ct="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!zr,li="MozPerspective"in Be,ci=!window.L_DISABLE_3D&&(Zt||ct||li)&&!At&&!pt,Wn=typeof orientation<"u"||Le("mobile"),ui=Wn&&Kt,di=Wn&&ct,va=!window.PointerEvent&&window.MSPointerEvent,hn=!!(window.PointerEvent||va),sr="ontouchstart"in window||!!window.TouchEvent,za=!window.L_NO_TOUCH&&(sr||hn),fi=Wn&&Fr,ms=Wn&&Qt,ps=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,gs=(function(){var o=!1;try{var f=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("testPassiveEventSupport",y,f),window.removeEventListener("testPassiveEventSupport",y,f)}catch{}return o})(),Ri=(function(){return!!document.createElement("canvas").getContext})(),hi=!!(document.createElementNS&&Ye("svg").createSVGRect),Ua=!!hi&&(function(){var o=document.createElement("div");return o.innerHTML="<svg/>",(o.firstChild&&o.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Li=!hi&&(function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var f=o.firstChild;return f.style.behavior="url(#default#VML)",f&&typeof f.adj=="object"}catch{return!1}})(),ea=navigator.platform.indexOf("Mac")===0,Ie=navigator.platform.indexOf("Linux")===0;function Le(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}var De={ie:bt,ielt9:dt,edge:ht,webkit:Kt,android:In,android23:zr,androidStock:fn,opera:Fr,chrome:sn,gecko:Qt,safari:Cr,phantom:pt,opera12:At,win:Ar,ie3d:Zt,webkit3d:ct,gecko3d:li,any3d:ci,mobile:Wn,mobileWebkit:ui,mobileWebkit3d:di,msPointer:va,pointer:hn,touch:za,touchNative:sr,mobileOpera:fi,mobileGecko:ms,retina:ps,passiveEvents:gs,canvas:Ri,svg:hi,vml:Li,inlineSvg:Ua,mac:ea,linux:Ie},j=De.msPointer?"MSPointerDown":"pointerdown",Q=De.msPointer?"MSPointerMove":"pointermove",K=De.msPointer?"MSPointerUp":"pointerup",X=De.msPointer?"MSPointerCancel":"pointercancel",ne={touchstart:j,touchmove:Q,touchend:K,touchcancel:X},se={touchstart:Ue,touchmove:We,touchend:We,touchcancel:We},be={},Ce=!1;function _e(o,f,v){return f==="touchstart"&&et(),se[f]?(v=se[f].bind(this,v),o.addEventListener(ne[f],v,!1),v):(console.warn("wrong event specified:",f),y)}function xe(o,f,v){if(!ne[f]){console.warn("wrong event specified:",f);return}o.removeEventListener(ne[f],v,!1)}function ke(o){be[o.pointerId]=o}function Re(o){be[o.pointerId]&&(be[o.pointerId]=o)}function Ke(o){delete be[o.pointerId]}function et(){Ce||(document.addEventListener(j,ke,!0),document.addEventListener(Q,Re,!0),document.addEventListener(K,Ke,!0),document.addEventListener(X,Ke,!0),Ce=!0)}function We(o,f){if(f.pointerType!==(f.MSPOINTER_TYPE_MOUSE||"mouse")){f.touches=[];for(var v in be)f.touches.push(be[v]);f.changedTouches=[f],o(f)}}function Ue(o,f){f.MSPOINTER_TYPE_TOUCH&&f.pointerType===f.MSPOINTER_TYPE_TOUCH&&gr(f),We(o,f)}function st(o){var f={},v,b;for(b in o)v=o[b],f[b]=v&&v.bind?v.bind(o):v;return o=f,f.type="dblclick",f.detail=2,f.isTrusted=!1,f._simulated=!0,f}var $t=200;function Wt(o,f){o.addEventListener("dblclick",f);var v=0,b;function N(G){if(G.detail!==1){b=G.detail;return}if(!(G.pointerType==="mouse"||G.sourceCapabilities&&!G.sourceCapabilities.firesTouchEvents)){var pe=zi(G);if(!(pe.some(function(Ne){return Ne instanceof HTMLLabelElement&&Ne.attributes.for})&&!pe.some(function(Ne){return Ne instanceof HTMLInputElement||Ne instanceof HTMLSelectElement}))){var Se=Date.now();Se-v<=$t?(b++,b===2&&f(st(G))):b=1,v=Se}}}return o.addEventListener("click",N),{dblclick:f,simDblclick:N}}function ar(o,f){o.removeEventListener("dblclick",f.dblclick),o.removeEventListener("click",f.simDblclick)}var mn=ys(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Yr=ys(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Dn=Yr==="webkitTransition"||Yr==="OTransition"?Yr+"End":"transitionend";function Nr(o){return typeof o=="string"?document.getElementById(o):o}function $a(o,f){var v=o.style[f]||o.currentStyle&&o.currentStyle[f];if((!v||v==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(o,null);v=b?b[f]:null}return v==="auto"?null:v}function ft(o,f,v){var b=document.createElement(o);return b.className=f||"",v&&v.appendChild(b),b}function ur(o){var f=o.parentNode;f&&f.removeChild(o)}function xl(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function vs(o){var f=o.parentNode;f&&f.lastChild!==o&&f.appendChild(o)}function Wa(o){var f=o.parentNode;f&&f.firstChild!==o&&f.insertBefore(o,f.firstChild)}function xs(o,f){if(o.classList!==void 0)return o.classList.contains(f);var v=yl(o);return v.length>0&&new RegExp("(^|\\s)"+f+"(\\s|$)").test(v)}function St(o,f){if(o.classList!==void 0)for(var v=S(f),b=0,N=v.length;b<N;b++)o.classList.add(v[b]);else if(!xs(o,f)){var G=yl(o);Bc(o,(G?G+" ":"")+f)}}function or(o,f){o.classList!==void 0?o.classList.remove(f):Bc(o,T((" "+yl(o)+" ").replace(" "+f+" "," ")))}function Bc(o,f){o.className.baseVal===void 0?o.className=f:o.className.baseVal=f}function yl(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function pn(o,f){"opacity"in o.style?o.style.opacity=f:"filter"in o.style&&Ad(o,f)}function Ad(o,f){var v=!1,b="DXImageTransform.Microsoft.Alpha";try{v=o.filters.item(b)}catch{if(f===1)return}f=Math.round(f*100),v?(v.Enabled=f!==100,v.Opacity=f):o.style.filter+=" progid:"+b+"(opacity="+f+")"}function ys(o){for(var f=document.documentElement.style,v=0;v<o.length;v++)if(o[v]in f)return o[v];return!1}function ta(o,f,v){var b=f||new F(0,0);o.style[mn]=(De.ie3d?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(v?" scale("+v+")":"")}function _r(o,f){o._leaflet_pos=f,De.any3d?ta(o,f):(o.style.left=f.x+"px",o.style.top=f.y+"px")}function Ha(o){return o._leaflet_pos||new F(0,0)}var Rt,_s,_l;if("onselectstart"in document)Rt=function(){_t(window,"selectstart",gr)},_s=function(){er(window,"selectstart",gr)};else{var Mi=ys(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Rt=function(){if(Mi){var o=document.documentElement.style;_l=o[Mi],o[Mi]="none"}},_s=function(){Mi&&(document.documentElement.style[Mi]=_l,_l=void 0)}}function wl(){_t(window,"dragstart",gr)}function bl(){er(window,"dragstart",gr)}var go,vo;function ws(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(ra(),go=o,vo=o.style.outlineStyle,o.style.outlineStyle="none",_t(window,"keydown",ra))}function ra(){go&&(go.style.outlineStyle=vo,go=void 0,vo=void 0,er(window,"keydown",ra))}function Va(o){do o=o.parentNode;while((!o.offsetWidth||!o.offsetHeight)&&o!==document.body);return o}function xa(o){var f=o.getBoundingClientRect();return{x:f.width/o.offsetWidth||1,y:f.height/o.offsetHeight||1,boundingClientRect:f}}var xo={__proto__:null,TRANSFORM:mn,TRANSITION:Yr,TRANSITION_END:Dn,get:Nr,getStyle:$a,create:ft,remove:ur,empty:xl,toFront:vs,toBack:Wa,hasClass:xs,addClass:St,removeClass:or,setClass:Bc,getClass:yl,setOpacity:pn,testProp:ys,setTransform:ta,setPosition:_r,getPosition:Ha,get disableTextSelection(){return Rt},get enableTextSelection(){return _s},disableImageDrag:wl,enableImageDrag:bl,preventOutline:ws,restoreOutline:ra,getSizedParentNode:Va,getScale:xa};function _t(o,f,v,b){if(f&&typeof f=="object")for(var N in f)Uc(o,N,f[N],v);else{f=S(f);for(var G=0,pe=f.length;G<pe;G++)Uc(o,f[G],v,b)}return this}var Ur="_leaflet_events";function er(o,f,v,b){if(arguments.length===1)zc(o),delete o[Ur];else if(f&&typeof f=="object")for(var N in f)kl(o,N,f[N],v);else if(f=S(f),arguments.length===2)zc(o,function(Se){return H(f,Se)!==-1});else for(var G=0,pe=f.length;G<pe;G++)kl(o,f[G],v,b);return this}function zc(o,f){for(var v in o[Ur]){var b=v.split(/\d/)[0];(!f||f(b))&&kl(o,b,null,null,v)}}var Bi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Uc(o,f,v,b){var N=f+m(v)+(b?"_"+m(b):"");if(o[Ur]&&o[Ur][N])return this;var G=function(Se){return v.call(b||o,Se||window.event)},pe=G;!De.touchNative&&De.pointer&&f.indexOf("touch")===0?G=_e(o,f,G):De.touch&&f==="dblclick"?G=Wt(o,G):"addEventListener"in o?f==="touchstart"||f==="touchmove"||f==="wheel"||f==="mousewheel"?o.addEventListener(Bi[f]||f,G,De.passiveEvents?{passive:!1}:!1):f==="mouseenter"||f==="mouseleave"?(G=function(Se){Se=Se||window.event,wo(o,Se)&&pe(Se)},o.addEventListener(Bi[f],G,!1)):o.addEventListener(f,pe,!1):o.attachEvent("on"+f,G),o[Ur]=o[Ur]||{},o[Ur][N]=G}function kl(o,f,v,b,N){N=N||f+m(v)+(b?"_"+m(b):"");var G=o[Ur]&&o[Ur][N];if(!G)return this;!De.touchNative&&De.pointer&&f.indexOf("touch")===0?xe(o,f,G):De.touch&&f==="dblclick"?ar(o,G):"removeEventListener"in o?o.removeEventListener(Bi[f]||f,G,!1):o.detachEvent("on"+f,G),o[Ur][N]=null}function ya(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,this}function Sl(o){return Uc(o,"wheel",ya),this}function yo(o){return _t(o,"mousedown touchstart dblclick contextmenu",ya),o._leaflet_disable_click=!0,this}function gr(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function na(o){return gr(o),ya(o),this}function zi(o){if(o.composedPath)return o.composedPath();for(var f=[],v=o.target;v;)f.push(v),v=v.parentNode;return f}function _o(o,f){if(!f)return new F(o.clientX,o.clientY);var v=xa(f),b=v.boundingClientRect;return new F((o.clientX-b.left)/v.x-f.clientLeft,(o.clientY-b.top)/v.y-f.clientTop)}var qh=De.linux&&De.chrome?window.devicePixelRatio:De.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Nd(o){return De.edge?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/qh:o.deltaY&&o.deltaMode===1?-o.deltaY*20:o.deltaY&&o.deltaMode===2?-o.deltaY*60:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?-o.detail*20:o.detail?o.detail/-32765*60:0}function wo(o,f){var v=f.relatedTarget;if(!v)return!0;try{for(;v&&v!==o;)v=v.parentNode}catch{return!1}return v!==o}var Tl={__proto__:null,on:_t,off:er,stopPropagation:ya,disableScrollPropagation:Sl,disableClickPropagation:yo,preventDefault:gr,stop:na,getPropagationPath:zi,getMousePosition:_o,getWheelDelta:Nd,isExternalTarget:wo,addListener:_t,removeListener:er},El=O.extend({run:function(o,f,v,b){this.stop(),this._el=o,this._inProgress=!0,this._duration=v||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=Ha(o),this._offset=f.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=he(this._animate,this),this._step()},_step:function(o){var f=+new Date-this._startTime,v=this._duration*1e3;f<v?this._runFrame(this._easeOut(f/v),o):(this._runFrame(1),this._complete())},_runFrame:function(o,f){var v=this._startPos.add(this._offset.multiplyBy(o));f&&v._round(),_r(this._el,v),this.fire("step")},_complete:function(){ce(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),Ft=O.extend({options:{crs:Ze,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,f){f=w(this,f),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),f.maxBounds&&this.setMaxBounds(f.maxBounds),f.zoom!==void 0&&(this._zoom=this._limitZoom(f.zoom)),f.center&&f.zoom!==void 0&&this.setView(W(f.center),f.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Yr&&De.any3d&&!De.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),_t(this._proxy,Dn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,f,v){if(f=f===void 0?this._zoom:this._limitZoom(f),o=this._limitCenter(W(o),f,this.options.maxBounds),v=v||{},this._stop(),this._loaded&&!v.reset&&v!==!0){v.animate!==void 0&&(v.zoom=a({animate:v.animate},v.zoom),v.pan=a({animate:v.animate,duration:v.duration},v.pan));var b=this._zoom!==f?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,f,v.zoom):this._tryAnimatedPan(o,v.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(o,f,v.pan&&v.pan.noMoveStart),this},setZoom:function(o,f){return this._loaded?this.setView(this.getCenter(),o,{zoom:f}):(this._zoom=o,this)},zoomIn:function(o,f){return o=o||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+o,f)},zoomOut:function(o,f){return o=o||(De.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-o,f)},setZoomAround:function(o,f,v){var b=this.getZoomScale(f),N=this.getSize().divideBy(2),G=o instanceof F?o:this.latLngToContainerPoint(o),pe=G.subtract(N).multiplyBy(1-1/b),Se=this.containerPointToLatLng(N.add(pe));return this.setView(Se,f,{zoom:v})},_getBoundsCenterZoom:function(o,f){f=f||{},o=o.getBounds?o.getBounds():U(o);var v=ie(f.paddingTopLeft||f.padding||[0,0]),b=ie(f.paddingBottomRight||f.padding||[0,0]),N=this.getBoundsZoom(o,!1,v.add(b));if(N=typeof f.maxZoom=="number"?Math.min(f.maxZoom,N):N,N===1/0)return{center:o.getCenter(),zoom:N};var G=b.subtract(v).divideBy(2),pe=this.project(o.getSouthWest(),N),Se=this.project(o.getNorthEast(),N),Ne=this.unproject(pe.add(Se).divideBy(2).add(G),N);return{center:Ne,zoom:N}},fitBounds:function(o,f){if(o=U(o),!o.isValid())throw new Error("Bounds are not valid.");var v=this._getBoundsCenterZoom(o,f);return this.setView(v.center,v.zoom,f)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,f){return this.setView(o,this._zoom,{pan:f})},panBy:function(o,f){if(o=ie(o).round(),f=f||{},!o.x&&!o.y)return this.fire("moveend");if(f.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new El,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),f.noMoveStart||this.fire("movestart"),f.animate!==!1){St(this._mapPane,"leaflet-pan-anim");var v=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,v,f.duration||.25,f.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,f,v){if(v=v||{},v.animate===!1||!De.any3d)return this.setView(o,f,v);this._stop();var b=this.project(this.getCenter()),N=this.project(o),G=this.getSize(),pe=this._zoom;o=W(o),f=f===void 0?pe:f;var Se=Math.max(G.x,G.y),Ne=Se*this.getZoomScale(pe,f),Me=N.distanceTo(b)||1,tt=1.42,mt=tt*tt;function Tt(Gt){var Rs=Gt?-1:1,u0=Gt?Ne:Se,d0=Ne*Ne-Se*Se+Rs*mt*mt*Me*Me,Ki=2*u0*mt*Me,Zi=d0/Ki,Yi=Math.sqrt(Zi*Zi+1)-Zi,zl=Yi<1e-9?-18:Math.log(Yi);return zl}function $r(Gt){return(Math.exp(Gt)-Math.exp(-Gt))/2}function jr(Gt){return(Math.exp(Gt)+Math.exp(-Gt))/2}function On(Gt){return $r(Gt)/jr(Gt)}var vn=Tt(0);function js(Gt){return Se*(jr(vn)/jr(vn+tt*Gt))}function lu(Gt){return Se*(jr(vn)*On(vn+tt*Gt)-$r(vn))/mt}function wi(Gt){return 1-Math.pow(1-Gt,1.5)}var qd=Date.now(),Gi=(Tt(1)-vn)/tt,ka=v.duration?1e3*v.duration:1e3*Gi*.8;function Os(){var Gt=(Date.now()-qd)/ka,Rs=wi(Gt)*Gi;Gt<=1?(this._flyToFrame=he(Os,this),this._move(this.unproject(b.add(N.subtract(b).multiplyBy(lu(Rs)/Me)),pe),this.getScaleZoom(Se/js(Rs),pe),{flyTo:!0})):this._move(o,f)._moveEnd(!0)}return this._moveStart(!0,v.noMoveStart),Os.call(this),this},flyToBounds:function(o,f){var v=this._getBoundsCenterZoom(o,f);return this.flyTo(v.center,v.zoom,f)},setMaxBounds:function(o){return o=U(o),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),o.isValid()?(this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(o){var f=this.options.minZoom;return this.options.minZoom=o,this._loaded&&f!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var f=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&f!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,f){this._enforcingBounds=!0;var v=this.getCenter(),b=this._limitCenter(v,this._zoom,U(o));return v.equals(b)||this.panTo(b,f),this._enforcingBounds=!1,this},panInside:function(o,f){f=f||{};var v=ie(f.paddingTopLeft||f.padding||[0,0]),b=ie(f.paddingBottomRight||f.padding||[0,0]),N=this.project(this.getCenter()),G=this.project(o),pe=this.getPixelBounds(),Se=R([pe.min.add(v),pe.max.subtract(b)]),Ne=Se.getSize();if(!Se.contains(G)){this._enforcingBounds=!0;var Me=G.subtract(Se.getCenter()),tt=Se.extend(G).getSize().subtract(Ne);N.x+=Me.x<0?-tt.x:tt.x,N.y+=Me.y<0?-tt.y:tt.y,this.panTo(this.unproject(N),f),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=a({animate:!1,pan:!0},o===!0?{animate:!0}:o);var f=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var v=this.getSize(),b=f.divideBy(2).round(),N=v.divideBy(2).round(),G=b.subtract(N);return!G.x&&!G.y?this:(o.animate&&o.pan?this.panBy(G):(o.pan&&this._rawPanBy(G),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:f,newSize:v}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=a({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var f=l(this._handleGeolocationResponse,this),v=l(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(f,v,o):navigator.geolocation.getCurrentPosition(f,v,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){if(this._container._leaflet_id){var f=o.code,v=o.message||(f===1?"permission denied":f===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:f,message:"Geolocation error: "+v+"."})}},_handleGeolocationResponse:function(o){if(this._container._leaflet_id){var f=o.coords.latitude,v=o.coords.longitude,b=new te(f,v),N=b.toBounds(o.coords.accuracy*2),G=this._locateOptions;if(G.setView){var pe=this.getBoundsZoom(N);this.setView(b,G.maxZoom?Math.min(pe,G.maxZoom):pe)}var Se={latlng:b,bounds:N,timestamp:o.timestamp};for(var Ne in o.coords)typeof o.coords[Ne]=="number"&&(Se[Ne]=o.coords[Ne]);this.fire("locationfound",Se)}},addHandler:function(o,f){if(!f)return this;var v=this[o]=new f(this);return this._handlers.push(v),this.options[o]&&v.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ur(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ce(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)ur(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,f){var v="leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),b=ft("div",v,f||this._mapPane);return o&&(this._panes[o]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds(),f=this.unproject(o.getBottomLeft()),v=this.unproject(o.getTopRight());return new z(f,v)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,f,v){o=U(o),v=ie(v||[0,0]);var b=this.getZoom()||0,N=this.getMinZoom(),G=this.getMaxZoom(),pe=o.getNorthWest(),Se=o.getSouthEast(),Ne=this.getSize().subtract(v),Me=R(this.project(Se,b),this.project(pe,b)).getSize(),tt=De.any3d?this.options.zoomSnap:1,mt=Ne.x/Me.x,Tt=Ne.y/Me.y,$r=f?Math.max(mt,Tt):Math.min(mt,Tt);return b=this.getScaleZoom($r,b),tt&&(b=Math.round(b/(tt/100))*(tt/100),b=f?Math.ceil(b/tt)*tt:Math.floor(b/tt)*tt),Math.max(N,Math.min(G,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new F(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,f){var v=this._getTopLeftPoint(o,f);return new Y(v,v.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,f){var v=this.options.crs;return f=f===void 0?this._zoom:f,v.scale(o)/v.scale(f)},getScaleZoom:function(o,f){var v=this.options.crs;f=f===void 0?this._zoom:f;var b=v.zoom(o*v.scale(f));return isNaN(b)?1/0:b},project:function(o,f){return f=f===void 0?this._zoom:f,this.options.crs.latLngToPoint(W(o),f)},unproject:function(o,f){return f=f===void 0?this._zoom:f,this.options.crs.pointToLatLng(ie(o),f)},layerPointToLatLng:function(o){var f=ie(o).add(this.getPixelOrigin());return this.unproject(f)},latLngToLayerPoint:function(o){var f=this.project(W(o))._round();return f._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(W(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(U(o))},distance:function(o,f){return this.options.crs.distance(W(o),W(f))},containerPointToLayerPoint:function(o){return ie(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return ie(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var f=this.containerPointToLayerPoint(ie(o));return this.layerPointToLatLng(f)},latLngToContainerPoint:function(o){return this.layerPointToContainerPoint(this.latLngToLayerPoint(W(o)))},mouseEventToContainerPoint:function(o){return _o(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var f=this._container=Nr(o);if(f){if(f._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");_t(f,"scroll",this._onScroll,this),this._containerId=m(f)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&De.any3d,St(o,"leaflet-container"+(De.touch?" leaflet-touch":"")+(De.retina?" leaflet-retina":"")+(De.ielt9?" leaflet-oldie":"")+(De.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var f=$a(o,"position");f!=="absolute"&&f!=="relative"&&f!=="fixed"&&f!=="sticky"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_r(this._mapPane,new F(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(St(o.markerPane,"leaflet-zoom-hide"),St(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,f,v){_r(this._mapPane,new F(0,0));var b=!this._loaded;this._loaded=!0,f=this._limitZoom(f),this.fire("viewprereset");var N=this._zoom!==f;this._moveStart(N,v)._move(o,f)._moveEnd(N),this.fire("viewreset"),b&&this.fire("load")},_moveStart:function(o,f){return o&&this.fire("zoomstart"),f||this.fire("movestart"),this},_move:function(o,f,v,b){f===void 0&&(f=this._zoom);var N=this._zoom!==f;return this._zoom=f,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),b?v&&v.pinch&&this.fire("zoom",v):((N||v&&v.pinch)&&this.fire("zoom",v),this.fire("move",v)),this},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ce(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){_r(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[m(this._container)]=this;var f=o?er:_t;f(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&f(window,"resize",this._onResize,this),De.any3d&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ce(this._resizeRequest),this._resizeRequest=he(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,f){for(var v=[],b,N=f==="mouseout"||f==="mouseover",G=o.target||o.srcElement,pe=!1;G;){if(b=this._targets[m(G)],b&&(f==="click"||f==="preclick")&&this._draggableMoved(b)){pe=!0;break}if(b&&b.listens(f,!0)&&(N&&!wo(G,o)||(v.push(b),N))||G===this._container)break;G=G.parentNode}return!v.length&&!pe&&!N&&this.listens(f,!0)&&(v=[this]),v},_isClickDisabled:function(o){for(;o&&o!==this._container;){if(o._leaflet_disable_click)return!0;o=o.parentNode}},_handleDOMEvent:function(o){var f=o.target||o.srcElement;if(!(!this._loaded||f._leaflet_disable_events||o.type==="click"&&this._isClickDisabled(f))){var v=o.type;v==="mousedown"&&ws(f),this._fireDOMEvent(o,v)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,f,v){if(o.type==="click"){var b=a({},o);b.type="preclick",this._fireDOMEvent(b,b.type,v)}var N=this._findEventTargets(o,f);if(v){for(var G=[],pe=0;pe<v.length;pe++)v[pe].listens(f,!0)&&G.push(v[pe]);N=G.concat(N)}if(N.length){f==="contextmenu"&&gr(o);var Se=N[0],Ne={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var Me=Se.getLatLng&&(!Se._radius||Se._radius<=10);Ne.containerPoint=Me?this.latLngToContainerPoint(Se.getLatLng()):this.mouseEventToContainerPoint(o),Ne.layerPoint=this.containerPointToLayerPoint(Ne.containerPoint),Ne.latlng=Me?Se.getLatLng():this.layerPointToLatLng(Ne.layerPoint)}for(pe=0;pe<N.length;pe++)if(N[pe].fire(f,Ne,!0),Ne.originalEvent._stopped||N[pe].options.bubblingMouseEvents===!1&&H(this._mouseEvents,f)!==-1)return}},_draggableMoved:function(o){return o=o.dragging&&o.dragging.enabled()?o:this,o.dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,f=this._handlers.length;o<f;o++)this._handlers[o].disable()},whenReady:function(o,f){return this._loaded?o.call(f||this,{target:this}):this.on("load",o,f),this},_getMapPanePos:function(){return Ha(this._mapPane)||new F(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,f){var v=o&&f!==void 0?this._getNewPixelOrigin(o,f):this.getPixelOrigin();return v.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,f){var v=this.getSize()._divideBy(2);return this.project(o,f)._subtract(v)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,f,v){var b=this._getNewPixelOrigin(v,f);return this.project(o,f)._subtract(b)},_latLngBoundsToNewLayerBounds:function(o,f,v){var b=this._getNewPixelOrigin(v,f);return R([this.project(o.getSouthWest(),f)._subtract(b),this.project(o.getNorthWest(),f)._subtract(b),this.project(o.getSouthEast(),f)._subtract(b),this.project(o.getNorthEast(),f)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o){return this.latLngToLayerPoint(o).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,f,v){if(!v)return o;var b=this.project(o,f),N=this.getSize().divideBy(2),G=new Y(b.subtract(N),b.add(N)),pe=this._getBoundsOffset(G,v,f);return Math.abs(pe.x)<=1&&Math.abs(pe.y)<=1?o:this.unproject(b.add(pe),f)},_limitOffset:function(o,f){if(!f)return o;var v=this.getPixelBounds(),b=new Y(v.min.add(o),v.max.add(o));return o.add(this._getBoundsOffset(b,f))},_getBoundsOffset:function(o,f,v){var b=R(this.project(f.getNorthEast(),v),this.project(f.getSouthWest(),v)),N=b.min.subtract(o.min),G=b.max.subtract(o.max),pe=this._rebound(N.x,-G.x),Se=this._rebound(N.y,-G.y);return new F(pe,Se)},_rebound:function(o,f){return o+f>0?Math.round(o-f)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(f))},_limitZoom:function(o){var f=this.getMinZoom(),v=this.getMaxZoom(),b=De.any3d?this.options.zoomSnap:1;return b&&(o=Math.round(o/b)*b),Math.max(f,Math.min(v,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){or(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,f){var v=this._getCenterOffset(o)._trunc();return(f&&f.animate)!==!0&&!this.getSize().contains(v)?!1:(this.panBy(v,f),!0)},_createAnimProxy:function(){var o=this._proxy=ft("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(f){var v=mn,b=this._proxy.style[v];ta(this._proxy,this.project(f.center,f.zoom),this.getZoomScale(f.zoom,1)),b===this._proxy.style[v]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ur(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var o=this.getCenter(),f=this.getZoom();ta(this._proxy,this.project(o,f),this.getZoomScale(f,1))},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,f,v){if(this._animatingZoom)return!0;if(v=v||{},!this._zoomAnimated||v.animate===!1||this._nothingToAnimate()||Math.abs(f-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(f),N=this._getCenterOffset(o)._divideBy(1-1/b);return v.animate!==!0&&!this.getSize().contains(N)?!1:(he(function(){this._moveStart(!0,v.noMoveStart||!1)._animateZoom(o,f,!0)},this),!0)},_animateZoom:function(o,f,v,b){this._mapPane&&(v&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=f,St(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:f,noUpdate:b}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&or(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function mi(o,f){return new Ft(o,f)}var Fn=je.extend({options:{position:"topright"},initialize:function(o){w(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var f=this._map;return f&&f.removeControl(this),this.options.position=o,f&&f.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var f=this._container=this.onAdd(o),v=this.getPosition(),b=o._controlCorners[v];return St(f,"leaflet-control"),v.indexOf("bottom")!==-1?b.insertBefore(f,b.firstChild):b.appendChild(f),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ur(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),pi=function(o){return new Fn(o)};Ft.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){var o=this._controlCorners={},f="leaflet-",v=this._controlContainer=ft("div",f+"control-container",this._container);function b(N,G){var pe=f+N+" "+f+G;o[N+G]=ft("div",pe,v)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)ur(this._controlCorners[o]);ur(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var $c=Fn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,f,v,b){return v<b?-1:b<v?1:0}},initialize:function(o,f,v){w(this,v),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var b in o)this._addLayer(o[b],b);for(b in f)this._addLayer(f[b],b,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return Fn.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,f){return this._addLayer(o,f),this._map?this._update():this},addOverlay:function(o,f){return this._addLayer(o,f,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var f=this._getLayer(m(o));return f&&this._layers.splice(this._layers.indexOf(f),1),this._map?this._update():this},expand:function(){St(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(St(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):or(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return or(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",f=this._container=ft("div",o),v=this.options.collapsed;f.setAttribute("aria-haspopup",!0),yo(f),Sl(f);var b=this._section=ft("section",o+"-list");v&&(this._map.on("click",this.collapse,this),_t(f,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var N=this._layersLink=ft("a",o+"-toggle",f);N.href="#",N.title="Layers",N.setAttribute("role","button"),_t(N,{keydown:function(G){G.keyCode===13&&this._expandSafely()},click:function(G){gr(G),this._expandSafely()}},this),v||this.expand(),this._baseLayersList=ft("div",o+"-base",b),this._separator=ft("div",o+"-separator",b),this._overlaysList=ft("div",o+"-overlays",b),f.appendChild(b)},_getLayer:function(o){for(var f=0;f<this._layers.length;f++)if(this._layers[f]&&m(this._layers[f].layer)===o)return this._layers[f]},_addLayer:function(o,f,v){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:f,overlay:v}),this.options.sortLayers&&this._layers.sort(l(function(b,N){return this.options.sortFunction(b.layer,N.layer,b.name,N.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;xl(this._baseLayersList),xl(this._overlaysList),this._layerControlInputs=[];var o,f,v,b,N=0;for(v=0;v<this._layers.length;v++)b=this._layers[v],this._addItem(b),f=f||b.overlay,o=o||!b.overlay,N+=b.overlay?0:1;return this.options.hideSingleBase&&(o=o&&N>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=f&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var f=this._getLayer(m(o.target)),v=f.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;v&&this._map.fire(v,f)},_createRadioElement:function(o,f){var v='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(f?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=v,b.firstChild},_addItem:function(o){var f=document.createElement("label"),v=this._map.hasLayer(o.layer),b;o.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=v):b=this._createRadioElement("leaflet-base-layers_"+m(this),v),this._layerControlInputs.push(b),b.layerId=m(o.layer),_t(b,"click",this._onInputClick,this);var N=document.createElement("span");N.innerHTML=" "+o.name;var G=document.createElement("span");f.appendChild(G),G.appendChild(b),G.appendChild(N);var pe=o.overlay?this._overlaysList:this._baseLayersList;return pe.appendChild(f),this._checkDisabledLayers(),f},_onInputClick:function(){if(!this._preventClick){var o=this._layerControlInputs,f,v,b=[],N=[];this._handlingClick=!0;for(var G=o.length-1;G>=0;G--)f=o[G],v=this._getLayer(f.layerId).layer,f.checked?b.push(v):f.checked||N.push(v);for(G=0;G<N.length;G++)this._map.hasLayer(N[G])&&this._map.removeLayer(N[G]);for(G=0;G<b.length;G++)this._map.hasLayer(b[G])||this._map.addLayer(b[G]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var o=this._layerControlInputs,f,v,b=this._map.getZoom(),N=o.length-1;N>=0;N--)f=o[N],v=this._getLayer(f.layerId).layer,f.disabled=v.options.minZoom!==void 0&&b<v.options.minZoom||v.options.maxZoom!==void 0&&b>v.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var o=this._section;this._preventClick=!0,_t(o,"click",gr),this.expand();var f=this;setTimeout(function(){er(o,"click",gr),f._preventClick=!1})}}),Cl=function(o,f,v){return new $c(o,f,v)},bs=Fn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(o){var f="leaflet-control-zoom",v=ft("div",f+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,f+"-in",v,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,f+"-out",v,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),v},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,f,v,b,N){var G=ft("a",v,b);return G.innerHTML=o,G.href="#",G.title=f,G.setAttribute("role","button"),G.setAttribute("aria-label",f),yo(G),_t(G,"click",na),_t(G,"click",N,this),_t(G,"click",this._refocusOnMap,this),G},_updateDisabled:function(){var o=this._map,f="leaflet-disabled";or(this._zoomInButton,f),or(this._zoomOutButton,f),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||o._zoom===o.getMinZoom())&&(St(this._zoomOutButton,f),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||o._zoom===o.getMaxZoom())&&(St(this._zoomInButton,f),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ft.mergeOptions({zoomControl:!0}),Ft.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new bs,this.addControl(this.zoomControl))});var Pd=function(o){return new bs(o)},gn=Fn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var f="leaflet-control-scale",v=ft("div",f),b=this.options;return this._addScales(b,f+"-line",v),o.on(b.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),v},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,f,v){o.metric&&(this._mScale=ft("div",f,v)),o.imperial&&(this._iScale=ft("div",f,v))},_update:function(){var o=this._map,f=o.getSize().y/2,v=o.distance(o.containerPointToLatLng([0,f]),o.containerPointToLatLng([this.options.maxWidth,f]));this._updateScales(v)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var f=this._getRoundNum(o),v=f<1e3?f+" m":f/1e3+" km";this._updateScale(this._mScale,v,f/o)},_updateImperial:function(o){var f=o*3.2808399,v,b,N;f>5280?(v=f/5280,b=this._getRoundNum(v),this._updateScale(this._iScale,b+" mi",b/v)):(N=this._getRoundNum(f),this._updateScale(this._iScale,N+" ft",N/f))},_updateScale:function(o,f,v){o.style.width=Math.round(this.options.maxWidth*v)+"px",o.innerHTML=f},_getRoundNum:function(o){var f=Math.pow(10,(Math.floor(o)+"").length-1),v=o/f;return v=v>=10?10:v>=5?5:v>=3?3:v>=2?2:1,f*v}}),ks=function(o){return new gn(o)},Wc='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ui=Fn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(De.inlineSvg?Wc+" ":"")+"Leaflet</a>"},initialize:function(o){w(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=ft("div","leaflet-control-attribution"),yo(this._container);for(var f in o._layers)o._layers[f].getAttribution&&this.addAttribution(o._layers[f].getAttribution());return this._update(),o.on("layeradd",this._addAttribution,this),this._container},onRemove:function(o){o.off("layeradd",this._addAttribution,this)},_addAttribution:function(o){o.layer.getAttribution&&(this.addAttribution(o.layer.getAttribution()),o.layer.once("remove",function(){this.removeAttribution(o.layer.getAttribution())},this))},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var f in this._attributions)this._attributions[f]&&o.push(f);var v=[];this.options.prefix&&v.push(this.options.prefix),o.length&&v.push(o.join(", ")),this._container.innerHTML=v.join(' <span aria-hidden="true">|</span> ')}}});Ft.mergeOptions({attributionControl:!0}),Ft.addInitHook(function(){this.options.attributionControl&&new Ui().addTo(this)});var Xh=function(o){return new Ui(o)};Fn.Layers=$c,Fn.Zoom=bs,Fn.Scale=gn,Fn.Attribution=Ui,pi.layers=Cl,pi.zoom=Pd,pi.scale=ks,pi.attribution=Xh;var Hn=je.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Hn.addTo=function(o,f){return o.addHandler(f,this),this};var Hc={Events:ue},Ss=De.touch?"touchstart mousedown":"mousedown",aa=O.extend({options:{clickTolerance:3},initialize:function(o,f,v,b){w(this,b),this._element=o,this._dragStartTarget=f||o,this._preventOutline=v},enable:function(){this._enabled||(_t(this._dragStartTarget,Ss,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(aa._dragging===this&&this.finishDrag(!0),er(this._dragStartTarget,Ss,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(this._enabled&&(this._moved=!1,!xs(this._element,"leaflet-zoom-anim"))){if(o.touches&&o.touches.length!==1){aa._dragging===this&&this.finishDrag();return}if(!(aa._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches)&&(aa._dragging=this,this._preventOutline&&ws(this._element),wl(),Rt(),!this._moving)){this.fire("down");var f=o.touches?o.touches[0]:o,v=Va(this._element);this._startPoint=new F(f.clientX,f.clientY),this._startPos=Ha(this._element),this._parentScale=xa(v);var b=o.type==="mousedown";_t(document,b?"mousemove":"touchmove",this._onMove,this),_t(document,b?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(o){if(this._enabled){if(o.touches&&o.touches.length>1){this._moved=!0;return}var f=o.touches&&o.touches.length===1?o.touches[0]:o,v=new F(f.clientX,f.clientY)._subtract(this._startPoint);!v.x&&!v.y||Math.abs(v.x)+Math.abs(v.y)<this.options.clickTolerance||(v.x/=this._parentScale.x,v.y/=this._parentScale.y,gr(o),this._moved||(this.fire("dragstart"),this._moved=!0,St(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),St(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(v),this._moving=!0,this._lastEvent=o,this._updatePosition())}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),_r(this._element,this._newPos),this.fire("drag",o)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(o){or(document.body,"leaflet-dragging"),this._lastTarget&&(or(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),er(document,"mousemove touchmove",this._onMove,this),er(document,"mouseup touchend touchcancel",this._onUp,this),bl(),_s();var f=this._moved&&this._moving;this._moving=!1,aa._dragging=!1,f&&this.fire("dragend",{noInertia:o,distance:this._newPos.distanceTo(this._startPos)})}});function Vc(o,f,v){var b,N=[1,4,2,8],G,pe,Se,Ne,Me,tt,mt,Tt;for(G=0,tt=o.length;G<tt;G++)o[G]._code=$i(o[G],f);for(Se=0;Se<4;Se++){for(mt=N[Se],b=[],G=0,tt=o.length,pe=tt-1;G<tt;pe=G++)Ne=o[G],Me=o[pe],Ne._code&mt?Me._code&mt||(Tt=Nl(Me,Ne,mt,f,v),Tt._code=$i(Tt,f),b.push(Tt)):(Me._code&mt&&(Tt=Nl(Me,Ne,mt,f,v),Tt._code=$i(Tt,f),b.push(Tt)),b.push(Ne));o=b}return o}function Id(o,f){var v,b,N,G,pe,Se,Ne,Me,tt;if(!o||o.length===0)throw new Error("latlngs not passed");Vn(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var mt=W([0,0]),Tt=U(o),$r=Tt.getNorthWest().distanceTo(Tt.getSouthWest())*Tt.getNorthEast().distanceTo(Tt.getNorthWest());$r<1700&&(mt=Gc(o));var jr=o.length,On=[];for(v=0;v<jr;v++){var vn=W(o[v]);On.push(f.project(W([vn.lat-mt.lat,vn.lng-mt.lng])))}for(Se=Ne=Me=0,v=0,b=jr-1;v<jr;b=v++)N=On[v],G=On[b],pe=N.y*G.x-G.y*N.x,Ne+=(N.x+G.x)*pe,Me+=(N.y+G.y)*pe,Se+=pe*3;Se===0?tt=On[0]:tt=[Ne/Se,Me/Se];var js=f.unproject(ie(tt));return W([js.lat+mt.lat,js.lng+mt.lng])}function Gc(o){for(var f=0,v=0,b=0,N=0;N<o.length;N++){var G=W(o[N]);f+=G.lat,v+=G.lng,b++}return W([f/b,v/b])}var Jh={__proto__:null,clipPolygon:Vc,polygonCenter:Id,centroid:Gc};function Al(o,f){if(!f||!o.length)return o.slice();var v=f*f;return o=t0(o,v),o=e0(o,v),o}function Dd(o,f,v){return Math.sqrt(Wi(o,f,v,!0))}function Qh(o,f,v){return Wi(o,f,v)}function e0(o,f){var v=o.length,b=typeof Uint8Array<"u"?Uint8Array:Array,N=new b(v);N[0]=N[v-1]=1,Kc(o,N,f,0,v-1);var G,pe=[];for(G=0;G<v;G++)N[G]&&pe.push(o[G]);return pe}function Kc(o,f,v,b,N){var G=0,pe,Se,Ne;for(Se=b+1;Se<=N-1;Se++)Ne=Wi(o[Se],o[b],o[N],!0),Ne>G&&(pe=Se,G=Ne);G>v&&(f[pe]=1,Kc(o,f,v,b,pe),Kc(o,f,v,pe,N))}function t0(o,f){for(var v=[o[0]],b=1,N=0,G=o.length;b<G;b++)r0(o[b],o[N])>f&&(v.push(o[b]),N=b);return N<G-1&&v.push(o[G-1]),v}var Zc;function Fd(o,f,v,b,N){var G=b?Zc:$i(o,v),pe=$i(f,v),Se,Ne,Me;for(Zc=pe;;){if(!(G|pe))return[o,f];if(G&pe)return!1;Se=G||pe,Ne=Nl(o,f,Se,v,N),Me=$i(Ne,v),Se===G?(o=Ne,G=Me):(f=Ne,pe=Me)}}function Nl(o,f,v,b,N){var G=f.x-o.x,pe=f.y-o.y,Se=b.min,Ne=b.max,Me,tt;return v&8?(Me=o.x+G*(Ne.y-o.y)/pe,tt=Ne.y):v&4?(Me=o.x+G*(Se.y-o.y)/pe,tt=Se.y):v&2?(Me=Ne.x,tt=o.y+pe*(Ne.x-o.x)/G):v&1&&(Me=Se.x,tt=o.y+pe*(Se.x-o.x)/G),new F(Me,tt,N)}function $i(o,f){var v=0;return o.x<f.min.x?v|=1:o.x>f.max.x&&(v|=2),o.y<f.min.y?v|=4:o.y>f.max.y&&(v|=8),v}function r0(o,f){var v=f.x-o.x,b=f.y-o.y;return v*v+b*b}function Wi(o,f,v,b){var N=f.x,G=f.y,pe=v.x-N,Se=v.y-G,Ne=pe*pe+Se*Se,Me;return Ne>0&&(Me=((o.x-N)*pe+(o.y-G)*Se)/Ne,Me>1?(N=v.x,G=v.y):Me>0&&(N+=pe*Me,G+=Se*Me)),pe=o.x-N,Se=o.y-G,b?pe*pe+Se*Se:new F(N,G)}function Vn(o){return!A(o[0])||typeof o[0][0]!="object"&&typeof o[0][0]<"u"}function jd(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Vn(o)}function Od(o,f){var v,b,N,G,pe,Se,Ne,Me;if(!o||o.length===0)throw new Error("latlngs not passed");Vn(o)||(console.warn("latlngs are not flat! Only the first ring will be used"),o=o[0]);var tt=W([0,0]),mt=U(o),Tt=mt.getNorthWest().distanceTo(mt.getSouthWest())*mt.getNorthEast().distanceTo(mt.getNorthWest());Tt<1700&&(tt=Gc(o));var $r=o.length,jr=[];for(v=0;v<$r;v++){var On=W(o[v]);jr.push(f.project(W([On.lat-tt.lat,On.lng-tt.lng])))}for(v=0,b=0;v<$r-1;v++)b+=jr[v].distanceTo(jr[v+1])/2;if(b===0)Me=jr[0];else for(v=0,G=0;v<$r-1;v++)if(pe=jr[v],Se=jr[v+1],N=pe.distanceTo(Se),G+=N,G>b){Ne=(G-b)/N,Me=[Se.x-Ne*(Se.x-pe.x),Se.y-Ne*(Se.y-pe.y)];break}var vn=f.unproject(ie(Me));return W([vn.lat+tt.lat,vn.lng+tt.lng])}var Rd={__proto__:null,simplify:Al,pointToSegmentDistance:Dd,closestPointOnSegment:Qh,clipSegment:Fd,_getEdgeIntersection:Nl,_getBitCode:$i,_sqClosestPointOnSegment:Wi,isFlat:Vn,_flat:jd,polylineCenter:Od},Yc={project:function(o){return new F(o.lng,o.lat)},unproject:function(o){return new te(o.y,o.x)},bounds:new Y([-180,-90],[180,90])},qc={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Y([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var f=Math.PI/180,v=this.R,b=o.lat*f,N=this.R_MINOR/v,G=Math.sqrt(1-N*N),pe=G*Math.sin(b),Se=Math.tan(Math.PI/4-b/2)/Math.pow((1-pe)/(1+pe),G/2);return b=-v*Math.log(Math.max(Se,1e-10)),new F(o.lng*f*v,b)},unproject:function(o){for(var f=180/Math.PI,v=this.R,b=this.R_MINOR/v,N=Math.sqrt(1-b*b),G=Math.exp(-o.y/v),pe=Math.PI/2-2*Math.atan(G),Se=0,Ne=.1,Me;Se<15&&Math.abs(Ne)>1e-7;Se++)Me=N*Math.sin(pe),Me=Math.pow((1-Me)/(1+Me),N/2),Ne=Math.PI/2-2*Math.atan(G*Me)-pe,pe+=Ne;return new te(pe*f,o.x*f/v)}},n0={__proto__:null,LonLat:Yc,Mercator:qc,SphericalMercator:ge},a0=a({},oe,{code:"EPSG:3395",projection:qc,transformation:(function(){var o=.5/(Math.PI*qc.R);return q(o,.5,-o,.5)})()}),Ld=a({},oe,{code:"EPSG:4326",projection:Yc,transformation:q(1/180,1,-1/180,.5)}),i0=a({},ae,{projection:Yc,transformation:q(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,f){var v=f.lng-o.lng,b=f.lat-o.lat;return Math.sqrt(v*v+b*b)},infinite:!0});ae.Earth=oe,ae.EPSG3395=a0,ae.EPSG3857=Ze,ae.EPSG900913=Je,ae.EPSG4326=Ld,ae.Simple=i0;var ia=O.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[m(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[m(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var f=o.target;if(f.hasLayer(this)){if(this._map=f,this._zoomAnimated=f._zoomAnimated,this.getEvents){var v=this.getEvents();f.on(v,this),this.once("remove",function(){f.off(v,this)},this)}this.onAdd(f),this.fire("add"),f.fire("layeradd",{layer:this})}}});Ft.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var f=m(o);return this._layers[f]?this:(this._layers[f]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var f=m(o);return this._layers[f]?(this._loaded&&o.onRemove(this),delete this._layers[f],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return m(o)in this._layers},eachLayer:function(o,f){for(var v in this._layers)o.call(f,this._layers[v]);return this},_addLayers:function(o){o=o?A(o)?o:[o]:[];for(var f=0,v=o.length;f<v;f++)this.addLayer(o[f])},_addZoomLimit:function(o){(!isNaN(o.options.maxZoom)||!isNaN(o.options.minZoom))&&(this._zoomBoundLayers[m(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var f=m(o);this._zoomBoundLayers[f]&&(delete this._zoomBoundLayers[f],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,f=-1/0,v=this._getZoomSpan();for(var b in this._zoomBoundLayers){var N=this._zoomBoundLayers[b].options;o=N.minZoom===void 0?o:Math.min(o,N.minZoom),f=N.maxZoom===void 0?f:Math.max(f,N.maxZoom)}this._layersMaxZoom=f===-1/0?void 0:f,this._layersMinZoom=o===1/0?void 0:o,v!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var gi=ia.extend({initialize:function(o,f){w(this,f),this._layers={};var v,b;if(o)for(v=0,b=o.length;v<b;v++)this.addLayer(o[v])},addLayer:function(o){var f=this.getLayerId(o);return this._layers[f]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var f=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[f]&&this._map.removeLayer(this._layers[f]),delete this._layers[f],this},hasLayer:function(o){var f=typeof o=="number"?o:this.getLayerId(o);return f in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var f=Array.prototype.slice.call(arguments,1),v,b;for(v in this._layers)b=this._layers[v],b[o]&&b[o].apply(b,f);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,f){for(var v in this._layers)o.call(f,this._layers[v]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return m(o)}}),bo=function(o,f){return new gi(o,f)},Ga=gi.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),gi.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),gi.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new z;for(var f in this._layers){var v=this._layers[f];o.extend(v.getBounds?v.getBounds():v.getLatLng())}return o}}),Md=function(o,f){return new Ga(o,f)},Hi=je.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(o){w(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,f){var v=this._getIconUrl(o);if(!v){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(v,f&&f.tagName==="IMG"?f:null);return this._setIconStyles(b,o),(this.options.crossOrigin||this.options.crossOrigin==="")&&(b.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),b},_setIconStyles:function(o,f){var v=this.options,b=v[f+"Size"];typeof b=="number"&&(b=[b,b]);var N=ie(b),G=ie(f==="shadow"&&v.shadowAnchor||v.iconAnchor||N&&N.divideBy(2,!0));o.className="leaflet-marker-"+f+" "+(v.className||""),G&&(o.style.marginLeft=-G.x+"px",o.style.marginTop=-G.y+"px"),N&&(o.style.width=N.x+"px",o.style.height=N.y+"px")},_createImg:function(o,f){return f=f||document.createElement("img"),f.src=o,f},_getIconUrl:function(o){return De.retina&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}});function Bd(o){return new Hi(o)}var Ts=Hi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return typeof Ts.imagePath!="string"&&(Ts.imagePath=this._detectIconPath()),(this.options.imagePath||Ts.imagePath)+Hi.prototype._getIconUrl.call(this,o)},_stripUrl:function(o){var f=function(v,b,N){var G=b.exec(v);return G&&G[N]};return o=f(o,/^url\((['"])?(.+)\1\)$/,2),o&&f(o,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var o=ft("div","leaflet-default-icon-path",document.body),f=$a(o,"background-image")||$a(o,"backgroundImage");if(document.body.removeChild(o),f=this._stripUrl(f),f)return f;var v=document.querySelector('link[href$="leaflet.css"]');return v?v.href.substring(0,v.href.length-11-1):""}}),Xc=Hn.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new aa(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),St(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&or(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var f=this._marker,v=f._map,b=this._marker.options.autoPanSpeed,N=this._marker.options.autoPanPadding,G=Ha(f._icon),pe=v.getPixelBounds(),Se=v.getPixelOrigin(),Ne=R(pe.min._subtract(Se).add(N),pe.max._subtract(Se).subtract(N));if(!Ne.contains(G)){var Me=ie((Math.max(Ne.max.x,G.x)-Ne.max.x)/(pe.max.x-Ne.max.x)-(Math.min(Ne.min.x,G.x)-Ne.min.x)/(pe.min.x-Ne.min.x),(Math.max(Ne.max.y,G.y)-Ne.max.y)/(pe.max.y-Ne.max.y)-(Math.min(Ne.min.y,G.y)-Ne.min.y)/(pe.min.y-Ne.min.y)).multiplyBy(b);v.panBy(Me,{animate:!1}),this._draggable._newPos._add(Me),this._draggable._startPos._add(Me),_r(f._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=he(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(ce(this._panRequest),this._panRequest=he(this._adjustPan.bind(this,o)))},_onDrag:function(o){var f=this._marker,v=f._shadow,b=Ha(f._icon),N=f._map.layerPointToLatLng(b);v&&_r(v,b),f._latlng=N,o.latlng=N,o.oldLatLng=this._oldLatLng,f.fire("move",o).fire("drag",o)},_onDragEnd:function(o){ce(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),Ka=ia.extend({options:{icon:new Ts,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,f){w(this,f),this._latlng=W(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var f=this._latlng;return this._latlng=W(o),this.update(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},getIcon:function(){return this.options.icon},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,f="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),v=o.icon.createIcon(this._icon),b=!1;v!==this._icon&&(this._icon&&this._removeIcon(),b=!0,o.title&&(v.title=o.title),v.tagName==="IMG"&&(v.alt=o.alt||"")),St(v,f),o.keyboard&&(v.tabIndex="0",v.setAttribute("role","button")),this._icon=v,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&_t(v,"focus",this._panOnFocus,this);var N=o.icon.createShadow(this._shadow),G=!1;N!==this._shadow&&(this._removeShadow(),G=!0),N&&(St(N,f),N.alt=""),this._shadow=N,o.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),N&&G&&this.getPane(o.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&er(this._icon,"focus",this._panOnFocus,this),ur(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ur(this._shadow),this._shadow=null},_setPos:function(o){this._icon&&_r(this._icon,o),this._shadow&&_r(this._shadow,o),this._zIndex=o.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon&&(this._icon.style.zIndex=this._zIndex+o)},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(f)},_initInteraction:function(){if(this.options.interactive&&(St(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Xc)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Xc(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;this._icon&&pn(this._icon,o),this._shadow&&pn(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var o=this._map;if(o){var f=this.options.icon.options,v=f.iconSize?ie(f.iconSize):ie(0,0),b=f.iconAnchor?ie(f.iconAnchor):ie(0,0);o.panInside(this._latlng,{paddingTopLeft:b,paddingBottomRight:v.subtract(b)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function s0(o,f){return new Ka(o,f)}var vi=ia.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return w(this,o),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&o&&Object.prototype.hasOwnProperty.call(o,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Pl=vi.extend({options:{fill:!0,radius:10},initialize:function(o,f){w(this,f),this._latlng=W(o),this._radius=this.options.radius},setLatLng:function(o){var f=this._latlng;return this._latlng=W(o),this.redraw(),this.fire("move",{oldLatLng:f,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var f=o&&o.radius||this._radius;return vi.prototype.setStyle.call(this,o),this.setRadius(f),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,f=this._radiusY||o,v=this._clickTolerance(),b=[o+v,f+v];this._pxBounds=new Y(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function zd(o,f){return new Pl(o,f)}var Il=Pl.extend({initialize:function(o,f,v){if(typeof f=="number"&&(f=a({},v,{radius:f})),w(this,f),this._latlng=W(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new z(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:vi.prototype.setStyle,_project:function(){var o=this._latlng.lng,f=this._latlng.lat,v=this._map,b=v.options.crs;if(b.distance===oe.distance){var N=Math.PI/180,G=this._mRadius/oe.R/N,pe=v.project([f+G,o]),Se=v.project([f-G,o]),Ne=pe.add(Se).divideBy(2),Me=v.unproject(Ne).lat,tt=Math.acos((Math.cos(G*N)-Math.sin(f*N)*Math.sin(Me*N))/(Math.cos(f*N)*Math.cos(Me*N)))/N;(isNaN(tt)||tt===0)&&(tt=G/Math.cos(Math.PI/180*f)),this._point=Ne.subtract(v.getPixelOrigin()),this._radius=isNaN(tt)?0:Ne.x-v.project([Me,o-tt]).x,this._radiusY=Ne.y-pe.y}else{var mt=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=v.latLngToLayerPoint(this._latlng),this._radius=this._point.x-v.latLngToLayerPoint(mt).x}this._updateBounds()}});function ko(o,f,v){return new Il(o,f,v)}var jn=vi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,f){w(this,f),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var f=1/0,v=null,b=Wi,N,G,pe=0,Se=this._parts.length;pe<Se;pe++)for(var Ne=this._parts[pe],Me=1,tt=Ne.length;Me<tt;Me++){N=Ne[Me-1],G=Ne[Me];var mt=b(o,N,G,!0);mt<f&&(f=mt,v=b(o,N,G))}return v&&(v.distance=Math.sqrt(f)),v},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Od(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(o,f){return f=f||this._defaultShape(),o=W(o),f.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new z,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return Vn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var f=[],v=Vn(o),b=0,N=o.length;b<N;b++)v?(f[b]=W(o[b]),this._bounds.extend(f[b])):f[b]=this._convertLatLngs(o[b]);return f},_project:function(){var o=new Y;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o),this._bounds.isValid()&&o.isValid()&&(this._rawPxBounds=o,this._updateBounds())},_updateBounds:function(){var o=this._clickTolerance(),f=new F(o,o);this._rawPxBounds&&(this._pxBounds=new Y([this._rawPxBounds.min.subtract(f),this._rawPxBounds.max.add(f)]))},_projectLatlngs:function(o,f,v){var b=o[0]instanceof te,N=o.length,G,pe;if(b){for(pe=[],G=0;G<N;G++)pe[G]=this._map.latLngToLayerPoint(o[G]),v.extend(pe[G]);f.push(pe)}else for(G=0;G<N;G++)this._projectLatlngs(o[G],f,v)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}var f=this._parts,v,b,N,G,pe,Se,Ne;for(v=0,N=0,G=this._rings.length;v<G;v++)for(Ne=this._rings[v],b=0,pe=Ne.length;b<pe-1;b++)Se=Fd(Ne[b],Ne[b+1],o,b,!0),Se&&(f[N]=f[N]||[],f[N].push(Se[0]),(Se[1]!==Ne[b+1]||b===pe-2)&&(f[N].push(Se[1]),N++))}},_simplifyPoints:function(){for(var o=this._parts,f=this.options.smoothFactor,v=0,b=o.length;v<b;v++)o[v]=Al(o[v],f)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,f){var v,b,N,G,pe,Se,Ne=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(v=0,G=this._parts.length;v<G;v++)for(Se=this._parts[v],b=0,pe=Se.length,N=pe-1;b<pe;N=b++)if(!(!f&&b===0)&&Dd(o,Se[N],Se[b])<=Ne)return!0;return!1}});function o0(o,f){return new jn(o,f)}jn._flat=jd;var Za=jn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Id(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(o){var f=jn.prototype._convertLatLngs.call(this,o),v=f.length;return v>=2&&f[0]instanceof te&&f[0].equals(f[v-1])&&f.pop(),f},_setLatLngs:function(o){jn.prototype._setLatLngs.call(this,o),Vn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Vn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,f=this.options.weight,v=new F(f,f);if(o=new Y(o.min.subtract(v),o.max.add(v)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(o))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,N=this._rings.length,G;b<N;b++)G=Vc(this._rings[b],o,!0),G.length&&this._parts.push(G)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var f=!1,v,b,N,G,pe,Se,Ne,Me;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(G=0,Ne=this._parts.length;G<Ne;G++)for(v=this._parts[G],pe=0,Me=v.length,Se=Me-1;pe<Me;Se=pe++)b=v[pe],N=v[Se],b.y>o.y!=N.y>o.y&&o.x<(N.x-b.x)*(o.y-b.y)/(N.y-b.y)+b.x&&(f=!f);return f||jn.prototype._containsPoint.call(this,o,!0)}});function l0(o,f){return new Za(o,f)}var _a=Ga.extend({initialize:function(o,f){w(this,f),this._layers={},o&&this.addData(o)},addData:function(o){var f=A(o)?o:o.features,v,b,N;if(f){for(v=0,b=f.length;v<b;v++)N=f[v],(N.geometries||N.geometry||N.features||N.coordinates)&&this.addData(N);return this}var G=this.options;if(G.filter&&!G.filter(o))return this;var pe=Es(o,G);return pe?(pe.feature=Rl(o),pe.defaultOptions=pe.options,this.resetStyle(pe),G.onEachFeature&&G.onEachFeature(o,pe),this.addLayer(pe)):this},resetStyle:function(o){return o===void 0?this.eachLayer(this.resetStyle,this):(o.options=a({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this)},setStyle:function(o){return this.eachLayer(function(f){this._setLayerStyle(f,o)},this)},_setLayerStyle:function(o,f){o.setStyle&&(typeof f=="function"&&(f=f(o.feature)),o.setStyle(f))}});function Es(o,f){var v=o.type==="Feature"?o.geometry:o,b=v?v.coordinates:null,N=[],G=f&&f.pointToLayer,pe=f&&f.coordsToLatLng||Fl,Se,Ne,Me,tt;if(!b&&!v)return null;switch(v.type){case"Point":return Se=pe(b),Dl(G,o,Se,f);case"MultiPoint":for(Me=0,tt=b.length;Me<tt;Me++)Se=pe(b[Me]),N.push(Dl(G,o,Se,f));return new Ga(N);case"LineString":case"MultiLineString":return Ne=So(b,v.type==="LineString"?0:1,pe),new jn(Ne,f);case"Polygon":case"MultiPolygon":return Ne=So(b,v.type==="Polygon"?1:2,pe),new Za(Ne,f);case"GeometryCollection":for(Me=0,tt=v.geometries.length;Me<tt;Me++){var mt=Es({geometry:v.geometries[Me],type:"Feature",properties:o.properties},f);mt&&N.push(mt)}return new Ga(N);case"FeatureCollection":for(Me=0,tt=v.features.length;Me<tt;Me++){var Tt=Es(v.features[Me],f);Tt&&N.push(Tt)}return new Ga(N);default:throw new Error("Invalid GeoJSON object.")}}function Dl(o,f,v,b){return o?o(f,v):new Ka(v,b&&b.markersInheritOptions&&b)}function Fl(o){return new te(o[1],o[0],o[2])}function So(o,f,v){for(var b=[],N=0,G=o.length,pe;N<G;N++)pe=f?So(o[N],f-1,v):(v||Fl)(o[N]),b.push(pe);return b}function jl(o,f){return o=W(o),o.alt!==void 0?[_(o.lng,f),_(o.lat,f),_(o.alt,f)]:[_(o.lng,f),_(o.lat,f)]}function Ol(o,f,v,b){for(var N=[],G=0,pe=o.length;G<pe;G++)N.push(f?Ol(o[G],Vn(o[G])?0:f-1,v,b):jl(o[G],b));return!f&&v&&N.length>0&&N.push(N[0].slice()),N}function Cs(o,f){return o.feature?a({},o.feature,{geometry:f}):Rl(f)}function Rl(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}var Jc={toGeoJSON:function(o){return Cs(this,{type:"Point",coordinates:jl(this.getLatLng(),o)})}};Ka.include(Jc),Il.include(Jc),Pl.include(Jc),jn.include({toGeoJSON:function(o){var f=!Vn(this._latlngs),v=Ol(this._latlngs,f?1:0,!1,o);return Cs(this,{type:(f?"Multi":"")+"LineString",coordinates:v})}}),Za.include({toGeoJSON:function(o){var f=!Vn(this._latlngs),v=f&&!Vn(this._latlngs[0]),b=Ol(this._latlngs,v?2:f?1:0,!0,o);return f||(b=[b]),Cs(this,{type:(v?"Multi":"")+"Polygon",coordinates:b})}}),gi.include({toMultiPoint:function(o){var f=[];return this.eachLayer(function(v){f.push(v.toGeoJSON(o).geometry.coordinates)}),Cs(this,{type:"MultiPoint",coordinates:f})},toGeoJSON:function(o){var f=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(f==="MultiPoint")return this.toMultiPoint(o);var v=f==="GeometryCollection",b=[];return this.eachLayer(function(N){if(N.toGeoJSON){var G=N.toGeoJSON(o);if(v)b.push(G.geometry);else{var pe=Rl(G);pe.type==="FeatureCollection"?b.push.apply(b,pe.features):b.push(pe)}}}),v?Cs(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function Ud(o,f){return new _a(o,f)}var sa=Ud,xi=ia.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,f,v){this._url=o,this._bounds=U(f),w(this,v)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(St(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ur(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&vs(this._image),this},bringToBack:function(){return this._map&&Wa(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o),this},setBounds:function(o){return this._bounds=U(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",f=this._image=o?this._url:ft("img");if(St(f,"leaflet-image-layer"),this._zoomAnimated&&St(f,"leaflet-zoom-animated"),this.options.className&&St(f,this.options.className),f.onselectstart=y,f.onmousemove=y,f.onload=l(this.fire,this,"load"),f.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(f.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o){this._url=f.src;return}f.src=this._url,f.alt=this.options.alt},_animateZoom:function(o){var f=this._map.getZoomScale(o.zoom),v=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;ta(this._image,v,f)},_reset:function(){var o=this._image,f=new Y(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),v=f.getSize();_r(o,f.min),o.style.width=v.x+"px",o.style.height=v.y+"px"},_updateOpacity:function(){pn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)},getCenter:function(){return this._bounds.getCenter()}}),$d=function(o,f,v){return new xi(o,f,v)},Qc=xi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",f=this._image=o?this._url:ft("video");if(St(f,"leaflet-image-layer"),this._zoomAnimated&&St(f,"leaflet-zoom-animated"),this.options.className&&St(f,this.options.className),f.onselectstart=y,f.onmousemove=y,f.onloadeddata=l(this.fire,this,"load"),o){for(var v=f.getElementsByTagName("source"),b=[],N=0;N<v.length;N++)b.push(v[N].src);this._url=v.length>0?b:[f.src];return}A(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(f.style,"objectFit")&&(f.style.objectFit="fill"),f.autoplay=!!this.options.autoplay,f.loop=!!this.options.loop,f.muted=!!this.options.muted,f.playsInline=!!this.options.playsInline;for(var G=0;G<this._url.length;G++){var pe=ft("source");pe.src=this._url[G],f.appendChild(pe)}}});function Wd(o,f,v){return new Qc(o,f,v)}var eu=xi.extend({_initImage:function(){var o=this._image=this._url;St(o,"leaflet-image-layer"),this._zoomAnimated&&St(o,"leaflet-zoom-animated"),this.options.className&&St(o,this.options.className),o.onselectstart=y,o.onmousemove=y}});function tu(o,f,v){return new eu(o,f,v)}var wa=ia.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(o,f){o&&(o instanceof te||A(o))?(this._latlng=W(o),w(this,f)):(w(this,o),this._source=f),this.options.content&&(this._content=this.options.content)},openOn:function(o){return o=arguments.length?o:this._source._map,o.hasLayer(this)||o.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(o){return this._map?this.close():(arguments.length?this._source=o:o=this._source,this._prepareOpen(),this.openOn(o._map)),this},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&pn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&pn(this._container,1),this.bringToFront(),this.options.interactive&&(St(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(o){o._fadeAnimated?(pn(this._container,0),this._removeTimeout=setTimeout(l(ur,void 0,this._container),200)):ur(this._container),this.options.interactive&&(or(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=W(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&vs(this._container),this},bringToBack:function(){return this._map&&Wa(this._container),this},_prepareOpen:function(o){var f=this._source;if(!f._map)return!1;if(f instanceof Ga){f=null;var v=this._source._layers;for(var b in v)if(v[b]._map){f=v[b];break}if(!f)return!1;this._source=f}if(!o)if(f.getCenter)o=f.getCenter();else if(f.getLatLng)o=f.getLatLng();else if(f.getBounds)o=f.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(o),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var o=this._contentNode,f=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof f=="string")o.innerHTML=f;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(f)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),f=ie(this.options.offset),v=this._getAnchor();this._zoomAnimated?_r(this._container,o.add(v)):f=f.add(o).add(v);var b=this._containerBottom=-f.y,N=this._containerLeft=-Math.round(this._containerWidth/2)+f.x;this._container.style.bottom=b+"px",this._container.style.left=N+"px"}},_getAnchor:function(){return[0,0]}});Ft.include({_initOverlay:function(o,f,v,b){var N=f;return N instanceof o||(N=new o(b).setContent(f)),v&&N.setLatLng(v),N}}),ia.include({_initOverlay:function(o,f,v,b){var N=v;return N instanceof o?(w(N,b),N._source=this):(N=f&&!b?f:new o(b,this),N.setContent(v)),N}});var Ll=wa.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o=arguments.length?o:this._source._map,!o.hasLayer(this)&&o._popup&&o._popup.options.autoClose&&o.removeLayer(o._popup),o._popup=this,wa.prototype.openOn.call(this,o)},onAdd:function(o){wa.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof vi||this._source.on("preclick",ya))},onRemove:function(o){wa.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof vi||this._source.off("preclick",ya))},getEvents:function(){var o=wa.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this.close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_initLayout:function(){var o="leaflet-popup",f=this._container=ft("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),v=this._wrapper=ft("div",o+"-content-wrapper",f);if(this._contentNode=ft("div",o+"-content",v),yo(f),Sl(this._contentNode),_t(f,"contextmenu",ya),this._tipContainer=ft("div",o+"-tip-container",f),this._tip=ft("div",o+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=ft("a",o+"-close-button",f);b.setAttribute("role","button"),b.setAttribute("aria-label","Close popup"),b.href="#close",b.innerHTML='<span aria-hidden="true">&#215;</span>',_t(b,"click",function(N){gr(N),this.close()},this)}},_updateLayout:function(){var o=this._contentNode,f=o.style;f.width="",f.whiteSpace="nowrap";var v=o.offsetWidth;v=Math.min(v,this.options.maxWidth),v=Math.max(v,this.options.minWidth),f.width=v+1+"px",f.whiteSpace="",f.height="";var b=o.offsetHeight,N=this.options.maxHeight,G="leaflet-popup-scrolled";N&&b>N?(f.height=N+"px",St(o,G)):or(o,G),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),v=this._getAnchor();_r(this._container,f.add(v))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var o=this._map,f=parseInt($a(this._container,"marginBottom"),10)||0,v=this._container.offsetHeight+f,b=this._containerWidth,N=new F(this._containerLeft,-v-this._containerBottom);N._add(Ha(this._container));var G=o.layerPointToContainerPoint(N),pe=ie(this.options.autoPanPadding),Se=ie(this.options.autoPanPaddingTopLeft||pe),Ne=ie(this.options.autoPanPaddingBottomRight||pe),Me=o.getSize(),tt=0,mt=0;G.x+b+Ne.x>Me.x&&(tt=G.x+b-Me.x+Ne.x),G.x-tt-Se.x<0&&(tt=G.x-Se.x),G.y+v+Ne.y>Me.y&&(mt=G.y+v-Me.y+Ne.y),G.y-mt-Se.y<0&&(mt=G.y-Se.y),(tt||mt)&&(this.options.keepInView&&(this._autopanning=!0),o.fire("autopanstart").panBy([tt,mt]))}},_getAnchor:function(){return ie(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),As=function(o,f){return new Ll(o,f)};Ft.mergeOptions({closePopupOnClick:!0}),Ft.include({openPopup:function(o,f,v){return this._initOverlay(Ll,o,f,v).openOn(this),this},closePopup:function(o){return o=arguments.length?o:this._popup,o&&o.close(),this}}),ia.include({bindPopup:function(o,f){return this._popup=this._initOverlay(Ll,this._popup,o,f),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o){return this._popup&&(this instanceof Ga||(this._popup._source=this),this._popup._prepareOpen(o||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){if(!(!this._popup||!this._map)){na(o);var f=o.layer||o.target;if(this._popup._source===f&&!(f instanceof vi)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(o.latlng);return}this._popup._source=f,this.openPopup(o.latlng)}},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var Ns=wa.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(o){wa.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(o){wa.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var o=wa.prototype.getEvents.call(this);return this.options.permanent||(o.preclick=this.close),o},_initLayout:function(){var o="leaflet-tooltip",f=o+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ft("div",f),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+m(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var f,v,b=this._map,N=this._container,G=b.latLngToContainerPoint(b.getCenter()),pe=b.layerPointToContainerPoint(o),Se=this.options.direction,Ne=N.offsetWidth,Me=N.offsetHeight,tt=ie(this.options.offset),mt=this._getAnchor();Se==="top"?(f=Ne/2,v=Me):Se==="bottom"?(f=Ne/2,v=0):Se==="center"?(f=Ne/2,v=Me/2):Se==="right"?(f=0,v=Me/2):Se==="left"?(f=Ne,v=Me/2):pe.x<G.x?(Se="right",f=0,v=Me/2):(Se="left",f=Ne+(tt.x+mt.x)*2,v=Me/2),o=o.subtract(ie(f,v,!0)).add(tt).add(mt),or(N,"leaflet-tooltip-right"),or(N,"leaflet-tooltip-left"),or(N,"leaflet-tooltip-top"),or(N,"leaflet-tooltip-bottom"),St(N,"leaflet-tooltip-"+Se),_r(N,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&pn(this._container,o)},_animateZoom:function(o){var f=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(f)},_getAnchor:function(){return ie(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),To=function(o,f){return new Ns(o,f)};Ft.include({openTooltip:function(o,f,v){return this._initOverlay(Ns,o,f,v).openOn(this),this},closeTooltip:function(o){return o.close(),this}}),ia.include({bindTooltip:function(o,f){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ns,this._tooltip,o,f),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(!(!o&&this._tooltipHandlersAdded)){var f=o?"off":"on",v={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?v.add=this._openTooltip:(v.mouseover=this._openTooltip,v.mouseout=this.closeTooltip,v.click=this._openTooltip,this._map?this._addFocusListeners():v.add=this._addFocusListeners),this._tooltip.options.sticky&&(v.mousemove=this._moveTooltip),this[f](v),this._tooltipHandlersAdded=!o}},openTooltip:function(o){return this._tooltip&&(this instanceof Ga||(this._tooltip._source=this),this._tooltip._prepareOpen(o)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(o){var f=typeof o.getElement=="function"&&o.getElement();f&&(_t(f,"focus",function(){this._tooltip._source=o,this.openTooltip()},this),_t(f,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(o){var f=typeof o.getElement=="function"&&o.getElement();f&&f.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(o){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var f=this;this._map.once("moveend",function(){f._openOnceFlag=!1,f._openTooltip(o)});return}this._tooltip._source=o.layer||o.target,this.openTooltip(this._tooltip.options.sticky?o.latlng:void 0)}},_moveTooltip:function(o){var f=o.latlng,v,b;this._tooltip.options.sticky&&o.originalEvent&&(v=this._map.mouseEventToContainerPoint(o.originalEvent),b=this._map.containerPointToLayerPoint(v),f=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(f)}});var Ml=Hi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var f=o&&o.tagName==="DIV"?o:document.createElement("div"),v=this.options;if(v.html instanceof Element?(xl(f),f.appendChild(v.html)):f.innerHTML=v.html!==!1?v.html:"",v.bgPos){var b=ie(v.bgPos);f.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(f,"icon"),f},createShadow:function(){return null}});function Hd(o){return new Ml(o)}Hi.Default=Ts;var yi=ia.extend({options:{tileSize:256,opacity:1,updateWhenIdle:De.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){w(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),ur(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(vs(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Wa(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var o=this._clampZoom(this._map.getZoom());o!==this._tileZoom&&(this._tileZoom=o,this._updateLevels()),this._update()}return this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=p(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof F?o:new F(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var f=this.getPane().children,v=-o(-1/0,1/0),b=0,N=f.length,G;b<N;b++)G=f[b].style.zIndex,f[b]!==this._container&&G&&(v=o(v,+G));isFinite(v)&&(this.options.zIndex=v+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!De.ielt9){pn(this._container,this.options.opacity);var o=+new Date,f=!1,v=!1;for(var b in this._tiles){var N=this._tiles[b];if(!(!N.current||!N.loaded)){var G=Math.min(1,(o-N.loaded)/200);pn(N.el,G),G<1?f=!0:(N.active?v=!0:this._onOpaqueTile(N),N.active=!0)}}v&&!this._noPrune&&this._pruneTiles(),f&&(ce(this._fadeFrame),this._fadeFrame=he(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=ft("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,f=this.options.maxZoom;if(o!==void 0){for(var v in this._levels)v=Number(v),this._levels[v].el.children.length||v===o?(this._levels[v].el.style.zIndex=f-Math.abs(o-v),this._onUpdateLevel(v)):(ur(this._levels[v].el),this._removeTilesAtZoom(v),this._onRemoveLevel(v),delete this._levels[v]);var b=this._levels[o],N=this._map;return b||(b=this._levels[o]={},b.el=ft("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=f,b.origin=N.project(N.unproject(N.getPixelOrigin()),o).round(),b.zoom=o,this._setZoomTransform(b,N.getCenter(),N.getZoom()),y(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var o,f,v=this._map.getZoom();if(v>this.options.maxZoom||v<this.options.minZoom){this._removeAllTiles();return}for(o in this._tiles)f=this._tiles[o],f.retain=f.current;for(o in this._tiles)if(f=this._tiles[o],f.current&&!f.active){var b=f.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}},_removeTilesAtZoom:function(o){for(var f in this._tiles)this._tiles[f].coords.z===o&&this._removeTile(f)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)ur(this._levels[o].el),this._onRemoveLevel(Number(o)),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,f,v,b){var N=Math.floor(o/2),G=Math.floor(f/2),pe=v-1,Se=new F(+N,+G);Se.z=+pe;var Ne=this._tileCoordsToKey(Se),Me=this._tiles[Ne];return Me&&Me.active?(Me.retain=!0,!0):(Me&&Me.loaded&&(Me.retain=!0),pe>b?this._retainParent(N,G,pe,b):!1)},_retainChildren:function(o,f,v,b){for(var N=2*o;N<2*o+2;N++)for(var G=2*f;G<2*f+2;G++){var pe=new F(N,G);pe.z=v+1;var Se=this._tileCoordsToKey(pe),Ne=this._tiles[Se];if(Ne&&Ne.active){Ne.retain=!0;continue}else Ne&&Ne.loaded&&(Ne.retain=!0);v+1<b&&this._retainChildren(N,G,v+1,b)}},_resetView:function(o){var f=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),f,f)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var f=this.options;return f.minNativeZoom!==void 0&&o<f.minNativeZoom?f.minNativeZoom:f.maxNativeZoom!==void 0&&f.maxNativeZoom<o?f.maxNativeZoom:o},_setView:function(o,f,v,b){var N=Math.round(f);this.options.maxZoom!==void 0&&N>this.options.maxZoom||this.options.minZoom!==void 0&&N<this.options.minZoom?N=void 0:N=this._clampZoom(N);var G=this.options.updateWhenZooming&&N!==this._tileZoom;(!b||G)&&(this._tileZoom=N,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),N!==void 0&&this._update(o),v||this._pruneTiles(),this._noPrune=!!v),this._setZoomTransforms(o,f)},_setZoomTransforms:function(o,f){for(var v in this._levels)this._setZoomTransform(this._levels[v],o,f)},_setZoomTransform:function(o,f,v){var b=this._map.getZoomScale(v,o.zoom),N=o.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(f,v)).round();De.any3d?ta(o.el,N,b):_r(o.el,N)},_resetGrid:function(){var o=this._map,f=o.options.crs,v=this._tileSize=this.getTileSize(),b=this._tileZoom,N=this._map.getPixelWorldBounds(this._tileZoom);N&&(this._globalTileRange=this._pxBoundsToTileRange(N)),this._wrapX=f.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,f.wrapLng[0]],b).x/v.x),Math.ceil(o.project([0,f.wrapLng[1]],b).x/v.y)],this._wrapY=f.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([f.wrapLat[0],0],b).y/v.x),Math.ceil(o.project([f.wrapLat[1],0],b).y/v.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(o){var f=this._map,v=f._animatingZoom?Math.max(f._animateToZoom,f.getZoom()):f.getZoom(),b=f.getZoomScale(v,this._tileZoom),N=f.project(o,this._tileZoom).floor(),G=f.getSize().divideBy(b*2);return new Y(N.subtract(G),N.add(G))},_update:function(o){var f=this._map;if(f){var v=this._clampZoom(f.getZoom());if(o===void 0&&(o=f.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(o),N=this._pxBoundsToTileRange(b),G=N.getCenter(),pe=[],Se=this.options.keepBuffer,Ne=new Y(N.getBottomLeft().subtract([Se,-Se]),N.getTopRight().add([Se,-Se]));if(!(isFinite(N.min.x)&&isFinite(N.min.y)&&isFinite(N.max.x)&&isFinite(N.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Me in this._tiles){var tt=this._tiles[Me].coords;(tt.z!==this._tileZoom||!Ne.contains(new F(tt.x,tt.y)))&&(this._tiles[Me].current=!1)}if(Math.abs(v-this._tileZoom)>1){this._setView(o,v);return}for(var mt=N.min.y;mt<=N.max.y;mt++)for(var Tt=N.min.x;Tt<=N.max.x;Tt++){var $r=new F(Tt,mt);if($r.z=this._tileZoom,!!this._isValidTile($r)){var jr=this._tiles[this._tileCoordsToKey($r)];jr?jr.current=!0:pe.push($r)}}if(pe.sort(function(vn,js){return vn.distanceTo(G)-js.distanceTo(G)}),pe.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var On=document.createDocumentFragment();for(Tt=0;Tt<pe.length;Tt++)this._addTile(pe[Tt],On);this._level.el.appendChild(On)}}}},_isValidTile:function(o){var f=this._map.options.crs;if(!f.infinite){var v=this._globalTileRange;if(!f.wrapLng&&(o.x<v.min.x||o.x>v.max.x)||!f.wrapLat&&(o.y<v.min.y||o.y>v.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(o);return U(this.options.bounds).overlaps(b)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var f=this._map,v=this.getTileSize(),b=o.scaleBy(v),N=b.add(v),G=f.unproject(b,o.z),pe=f.unproject(N,o.z);return[G,pe]},_tileCoordsToBounds:function(o){var f=this._tileCoordsToNwSe(o),v=new z(f[0],f[1]);return this.options.noWrap||(v=this._map.wrapLatLngBounds(v)),v},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var f=o.split(":"),v=new F(+f[0],+f[1]);return v.z=+f[2],v},_removeTile:function(o){var f=this._tiles[o];f&&(ur(f.el),delete this._tiles[o],this.fire("tileunload",{tile:f.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){St(o,"leaflet-tile");var f=this.getTileSize();o.style.width=f.x+"px",o.style.height=f.y+"px",o.onselectstart=y,o.onmousemove=y,De.ielt9&&this.options.opacity<1&&pn(o,this.options.opacity)},_addTile:function(o,f){var v=this._getTilePos(o),b=this._tileCoordsToKey(o),N=this.createTile(this._wrapCoords(o),l(this._tileReady,this,o));this._initTile(N),this.createTile.length<2&&he(l(this._tileReady,this,o,null,N)),_r(N,v),this._tiles[b]={el:N,coords:o,current:!0},f.appendChild(N),this.fire("tileloadstart",{tile:N,coords:o})},_tileReady:function(o,f,v){f&&this.fire("tileerror",{error:f,tile:v,coords:o});var b=this._tileCoordsToKey(o);v=this._tiles[b],v&&(v.loaded=+new Date,this._map._fadeAnimated?(pn(v.el,0),ce(this._fadeFrame),this._fadeFrame=he(this._updateOpacity,this)):(v.active=!0,this._pruneTiles()),f||(St(v.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:v.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),De.ielt9||!this._map._fadeAnimated?he(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var f=new F(this._wrapX?g(o.x,this._wrapX):o.x,this._wrapY?g(o.y,this._wrapY):o.y);return f.z=o.z,f},_pxBoundsToTileRange:function(o){var f=this.getTileSize();return new Y(o.min.unscaleBy(f).floor(),o.max.unscaleBy(f).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}});function Ps(o){return new yi(o)}var _i=yi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(o,f){this._url=o,f=w(this,f),f.detectRetina&&De.retina&&f.maxZoom>0?(f.tileSize=Math.floor(f.tileSize/2),f.zoomReverse?(f.zoomOffset--,f.minZoom=Math.min(f.maxZoom,f.minZoom+1)):(f.zoomOffset++,f.maxZoom=Math.max(f.minZoom,f.maxZoom-1)),f.minZoom=Math.max(0,f.minZoom)):f.zoomReverse?f.minZoom=Math.min(f.maxZoom,f.minZoom):f.maxZoom=Math.max(f.minZoom,f.maxZoom),typeof f.subdomains=="string"&&(f.subdomains=f.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(o,f){return this._url===o&&f===void 0&&(f=!0),this._url=o,f||this.redraw(),this},createTile:function(o,f){var v=document.createElement("img");return _t(v,"load",l(this._tileOnLoad,this,f,v)),_t(v,"error",l(this._tileOnError,this,f,v)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(v.referrerPolicy=this.options.referrerPolicy),v.alt="",v.src=this.getTileUrl(o),v},getTileUrl:function(o){var f={r:De.retina?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var v=this._globalTileRange.max.y-o.y;this.options.tms&&(f.y=v),f["-y"]=v}return D(this._url,a(f,this.options))},_tileOnLoad:function(o,f){De.ielt9?setTimeout(l(o,this,null,f),0):o(null,f)},_tileOnError:function(o,f,v){var b=this.options.errorTileUrl;b&&f.getAttribute("src")!==b&&(f.src=b),o(v,f)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,f=this.options.maxZoom,v=this.options.zoomReverse,b=this.options.zoomOffset;return v&&(o=f-o),o+b},_getSubdomain:function(o){var f=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[f]},_abortLoading:function(){var o,f;for(o in this._tiles)if(this._tiles[o].coords.z!==this._tileZoom&&(f=this._tiles[o].el,f.onload=y,f.onerror=y,!f.complete)){f.src=J;var v=this._tiles[o].coords;ur(f),delete this._tiles[o],this.fire("tileabort",{tile:f,coords:v})}},_removeTile:function(o){var f=this._tiles[o];if(f)return f.el.setAttribute("src",J),yi.prototype._removeTile.call(this,o)},_tileReady:function(o,f,v){if(!(!this._map||v&&v.getAttribute("src")===J))return yi.prototype._tileReady.call(this,o,f,v)}});function ru(o,f){return new _i(o,f)}var Eo=_i.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,f){this._url=o;var v=a({},this.defaultWmsParams);for(var b in f)b in this.options||(v[b]=f[b]);f=w(this,f);var N=f.detectRetina&&De.retina?2:1,G=this.getTileSize();v.width=G.x*N,v.height=G.y*N,this.wmsParams=v},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var f=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[f]=this._crs.code,_i.prototype.onAdd.call(this,o)},getTileUrl:function(o){var f=this._tileCoordsToNwSe(o),v=this._crs,b=R(v.project(f[0]),v.project(f[1])),N=b.min,G=b.max,pe=(this._wmsVersion>=1.3&&this._crs===Ld?[N.y,N.x,G.y,G.x]:[N.x,N.y,G.x,G.y]).join(","),Se=_i.prototype.getTileUrl.call(this,o);return Se+E(this.wmsParams,Se,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+pe},setParams:function(o,f){return a(this.wmsParams,o),f||this.redraw(),this}});function Vd(o,f){return new Eo(o,f)}_i.WMS=Eo,ru.wms=Vd;var ba=ia.extend({options:{padding:.1},initialize:function(o){w(this,o),m(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),St(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,f){var v=this._map.getZoomScale(f,this._zoom),b=this._map.getSize().multiplyBy(.5+this.options.padding),N=this._map.project(this._center,f),G=b.multiplyBy(-v).add(N).subtract(this._map._getNewPixelOrigin(o,f));De.any3d?ta(this._container,G,v):_r(this._container,G)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,f=this._map.getSize(),v=this._map.containerPointToLayerPoint(f.multiplyBy(-o)).round();this._bounds=new Y(v,v.add(f.multiplyBy(1+o*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),nu=ba.extend({options:{tolerance:0},getEvents:function(){var o=ba.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ba.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");_t(o,"mousemove",this._onMouseMove,this),_t(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),_t(o,"mouseout",this._handleMouseOut,this),o._leaflet_disable_events=!0,this._ctx=o.getContext("2d")},_destroyContainer:function(){ce(this._redrawRequest),delete this._ctx,ur(this._container),er(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var o;this._redrawBounds=null;for(var f in this._layers)o=this._layers[f],o._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ba.prototype._update.call(this);var o=this._bounds,f=this._container,v=o.getSize(),b=De.retina?2:1;_r(f,o.min),f.width=b*v.x,f.height=b*v.y,f.style.width=v.x+"px",f.style.height=v.y+"px",De.retina&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){ba.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[m(o)]=o;var f=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=f),this._drawLast=f,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var f=o._order,v=f.next,b=f.prev;v?v.prev=b:this._drawLast=b,b?b.next=v:this._drawFirst=v,delete o._order,delete this._layers[m(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var f=o.options.dashArray.split(/[, ]+/),v=[],b,N;for(N=0;N<f.length;N++){if(b=Number(f[N]),isNaN(b))return;v.push(b)}o.options._dashArray=v}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||he(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var f=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Y,this._redrawBounds.extend(o._pxBounds.min.subtract([f,f])),this._redrawBounds.extend(o._pxBounds.max.add([f,f]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var f=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,f.x,f.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var o,f=this._redrawBounds;if(this._ctx.save(),f){var v=f.getSize();this._ctx.beginPath(),this._ctx.rect(f.min.x,f.min.y,v.x,v.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)o=b.layer,(!f||o._pxBounds&&o._pxBounds.intersects(f))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,f){if(this._drawing){var v,b,N,G,pe=o._parts,Se=pe.length,Ne=this._ctx;if(Se){for(Ne.beginPath(),v=0;v<Se;v++){for(b=0,N=pe[v].length;b<N;b++)G=pe[v][b],Ne[b?"lineTo":"moveTo"](G.x,G.y);f&&Ne.closePath()}this._fillStroke(Ne,o)}}},_updateCircle:function(o){if(!(!this._drawing||o._empty())){var f=o._point,v=this._ctx,b=Math.max(Math.round(o._radius),1),N=(Math.max(Math.round(o._radiusY),1)||b)/b;N!==1&&(v.save(),v.scale(1,N)),v.beginPath(),v.arc(f.x,f.y/N,b,0,Math.PI*2,!1),N!==1&&v.restore(),this._fillStroke(v,o)}},_fillStroke:function(o,f){var v=f.options;v.fill&&(o.globalAlpha=v.fillOpacity,o.fillStyle=v.fillColor||v.color,o.fill(v.fillRule||"evenodd")),v.stroke&&v.weight!==0&&(o.setLineDash&&o.setLineDash(f.options&&f.options._dashArray||[]),o.globalAlpha=v.opacity,o.lineWidth=v.weight,o.strokeStyle=v.color,o.lineCap=v.lineCap,o.lineJoin=v.lineJoin,o.stroke())},_onClick:function(o){for(var f=this._map.mouseEventToLayerPoint(o),v,b,N=this._drawFirst;N;N=N.next)v=N.layer,v.options.interactive&&v._containsPoint(f)&&(!(o.type==="click"||o.type==="preclick")||!this._map._draggableMoved(v))&&(b=v);this._fireEvent(b?[b]:!1,o)},_onMouseMove:function(o){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var f=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,f)}},_handleMouseOut:function(o){var f=this._hoveredLayer;f&&(or(this._container,"leaflet-interactive"),this._fireEvent([f],o,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(o,f){if(!this._mouseHoverThrottled){for(var v,b,N=this._drawFirst;N;N=N.next)v=N.layer,v.options.interactive&&v._containsPoint(f)&&(b=v);b!==this._hoveredLayer&&(this._handleMouseOut(o),b&&(St(this._container,"leaflet-interactive"),this._fireEvent([b],o,"mouseover"),this._hoveredLayer=b)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,o),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(o,f,v){this._map._fireDOMEvent(f,v||f.type,o)},_bringToFront:function(o){var f=o._order;if(f){var v=f.next,b=f.prev;if(v)v.prev=b;else return;b?b.next=v:v&&(this._drawFirst=v),f.prev=this._drawLast,this._drawLast.next=f,f.next=null,this._drawLast=f,this._requestRedraw(o)}},_bringToBack:function(o){var f=o._order;if(f){var v=f.next,b=f.prev;if(b)b.next=v;else return;v?v.prev=b:b&&(this._drawLast=b),f.prev=null,f.next=this._drawFirst,this._drawFirst.prev=f,this._drawFirst=f,this._requestRedraw(o)}}});function au(o){return De.canvas?new nu(o):null}var Is=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch{}return function(o){return document.createElement("<"+o+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Gd={_initContainer:function(){this._container=ft("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ba.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var f=o._container=Is("shape");St(f,"leaflet-vml-shape "+(this.options.className||"")),f.coordsize="1 1",o._path=Is("path"),f.appendChild(o._path),this._updateStyle(o),this._layers[m(o)]=o},_addPath:function(o){var f=o._container;this._container.appendChild(f),o.options.interactive&&o.addInteractiveTarget(f)},_removePath:function(o){var f=o._container;ur(f),o.removeInteractiveTarget(f),delete this._layers[m(o)]},_updateStyle:function(o){var f=o._stroke,v=o._fill,b=o.options,N=o._container;N.stroked=!!b.stroke,N.filled=!!b.fill,b.stroke?(f||(f=o._stroke=Is("stroke")),N.appendChild(f),f.weight=b.weight+"px",f.color=b.color,f.opacity=b.opacity,b.dashArray?f.dashStyle=A(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):f.dashStyle="",f.endcap=b.lineCap.replace("butt","flat"),f.joinstyle=b.lineJoin):f&&(N.removeChild(f),o._stroke=null),b.fill?(v||(v=o._fill=Is("fill")),N.appendChild(v),v.color=b.fillColor||b.color,v.opacity=b.fillOpacity):v&&(N.removeChild(v),o._fill=null)},_updateCircle:function(o){var f=o._point.round(),v=Math.round(o._radius),b=Math.round(o._radiusY||v);this._setPath(o,o._empty()?"M0 0":"AL "+f.x+","+f.y+" "+v+","+b+" 0,"+65535*360)},_setPath:function(o,f){o._path.v=f},_bringToFront:function(o){vs(o._container)},_bringToBack:function(o){Wa(o._container)}},oa=De.vml?Is:Ye,Vi=ba.extend({_initContainer:function(){this._container=oa("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=oa("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ur(this._container),er(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ba.prototype._update.call(this);var o=this._bounds,f=o.getSize(),v=this._container;(!this._svgSize||!this._svgSize.equals(f))&&(this._svgSize=f,v.setAttribute("width",f.x),v.setAttribute("height",f.y)),_r(v,o.min),v.setAttribute("viewBox",[o.min.x,o.min.y,f.x,f.y].join(" ")),this.fire("update")}},_initPath:function(o){var f=o._path=oa("path");o.options.className&&St(f,o.options.className),o.options.interactive&&St(f,"leaflet-interactive"),this._updateStyle(o),this._layers[m(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){ur(o._path),o.removeInteractiveTarget(o._path),delete this._layers[m(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var f=o._path,v=o.options;f&&(v.stroke?(f.setAttribute("stroke",v.color),f.setAttribute("stroke-opacity",v.opacity),f.setAttribute("stroke-width",v.weight),f.setAttribute("stroke-linecap",v.lineCap),f.setAttribute("stroke-linejoin",v.lineJoin),v.dashArray?f.setAttribute("stroke-dasharray",v.dashArray):f.removeAttribute("stroke-dasharray"),v.dashOffset?f.setAttribute("stroke-dashoffset",v.dashOffset):f.removeAttribute("stroke-dashoffset")):f.setAttribute("stroke","none"),v.fill?(f.setAttribute("fill",v.fillColor||v.color),f.setAttribute("fill-opacity",v.fillOpacity),f.setAttribute("fill-rule",v.fillRule||"evenodd")):f.setAttribute("fill","none"))},_updatePoly:function(o,f){this._setPath(o,nt(o._parts,f))},_updateCircle:function(o){var f=o._point,v=Math.max(Math.round(o._radius),1),b=Math.max(Math.round(o._radiusY),1)||v,N="a"+v+","+b+" 0 1,0 ",G=o._empty()?"M0 0":"M"+(f.x-v)+","+f.y+N+v*2+",0 "+N+-v*2+",0 ";this._setPath(o,G)},_setPath:function(o,f){o._path.setAttribute("d",f)},_bringToFront:function(o){vs(o._path)},_bringToBack:function(o){Wa(o._path)}});De.vml&&Vi.include(Gd);function Bl(o){return De.svg||De.vml?new Vi(o):null}Ft.include({getRenderer:function(o){var f=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return f||(f=this._renderer=this._createRenderer()),this.hasLayer(f)||this.addLayer(f),f},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var f=this._paneRenderers[o];return f===void 0&&(f=this._createRenderer({pane:o}),this._paneRenderers[o]=f),f},_createRenderer:function(o){return this.options.preferCanvas&&au(o)||Bl(o)}});var Kd=Za.extend({initialize:function(o,f){Za.prototype.initialize.call(this,this._boundsToLatLngs(o),f)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=U(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});function c0(o,f){return new Kd(o,f)}Vi.create=oa,Vi.pointsToPath=nt,_a.geometryToLayer=Es,_a.coordsToLatLng=Fl,_a.coordsToLatLngs=So,_a.latLngToCoords=jl,_a.latLngsToCoords=Ol,_a.getFeature=Cs,_a.asFeature=Rl,Ft.mergeOptions({boxZoom:!0});var Ds=Hn.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){_t(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){er(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ur(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Rt(),wl(),this._startPoint=this._map.mouseEventToContainerPoint(o),_t(document,{contextmenu:na,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=ft("div","leaflet-zoom-box",this._container),St(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var f=new Y(this._point,this._startPoint),v=f.getSize();_r(this._box,f.min),this._box.style.width=v.x+"px",this._box.style.height=v.y+"px"},_finish:function(){this._moved&&(ur(this._box),or(this._container,"leaflet-crosshair")),_s(),bl(),er(document,{contextmenu:na,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if(!(o.which!==1&&o.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var f=new z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(f).fire("boxzoomend",{boxZoomBounds:f})}},_onKeyDown:function(o){o.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ft.addInitHook("addHandler","boxZoom",Ds),Ft.mergeOptions({doubleClickZoom:!0});var Zd=Hn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var f=this._map,v=f.getZoom(),b=f.options.zoomDelta,N=o.originalEvent.shiftKey?v-b:v+b;f.options.doubleClickZoom==="center"?f.setZoom(N):f.setZoomAround(o.containerPoint,N)}});Ft.addInitHook("addHandler","doubleClickZoom",Zd),Ft.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var iu=Hn.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new aa(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}St(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){or(this._map._container,"leaflet-grab"),or(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var f=U(this._map.options.maxBounds);this._offsetLimit=R(this._map.latLngToContainerPoint(f.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(f.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var f=this._lastTime=+new Date,v=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(v),this._times.push(f),this._prunePositions(f)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),f=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=f.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,f){return o-(o-f)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var o=this._draggable._newPos.subtract(this._draggable._startPos),f=this._offsetLimit;o.x<f.min.x&&(o.x=this._viscousLimit(o.x,f.min.x)),o.y<f.min.y&&(o.y=this._viscousLimit(o.y,f.min.y)),o.x>f.max.x&&(o.x=this._viscousLimit(o.x,f.max.x)),o.y>f.max.y&&(o.y=this._viscousLimit(o.y,f.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,f=Math.round(o/2),v=this._initialWorldOffset,b=this._draggable._newPos.x,N=(b-f+v)%o+f-v,G=(b+f+v)%o-f-v,pe=Math.abs(N+v)<Math.abs(G+v)?N:G;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=pe},_onDragEnd:function(o){var f=this._map,v=f.options,b=!v.inertia||o.noInertia||this._times.length<2;if(f.fire("dragend",o),b)f.fire("moveend");else{this._prunePositions(+new Date);var N=this._lastPos.subtract(this._positions[0]),G=(this._lastTime-this._times[0])/1e3,pe=v.easeLinearity,Se=N.multiplyBy(pe/G),Ne=Se.distanceTo([0,0]),Me=Math.min(v.inertiaMaxSpeed,Ne),tt=Se.multiplyBy(Me/Ne),mt=Me/(v.inertiaDeceleration*pe),Tt=tt.multiplyBy(-mt/2).round();!Tt.x&&!Tt.y?f.fire("moveend"):(Tt=f._limitOffset(Tt,f.options.maxBounds),he(function(){f.panBy(Tt,{duration:mt,easeLinearity:pe,noMoveStart:!0,animate:!0})}))}}});Ft.addInitHook("addHandler","dragging",iu),Ft.mergeOptions({keyboard:!0,keyboardPanDelta:80});var su=Hn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),_t(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),er(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,f=document.documentElement,v=o.scrollTop||f.scrollTop,b=o.scrollLeft||f.scrollLeft;this._map._container.focus(),window.scrollTo(b,v)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var f=this._panKeys={},v=this.keyCodes,b,N;for(b=0,N=v.left.length;b<N;b++)f[v.left[b]]=[-1*o,0];for(b=0,N=v.right.length;b<N;b++)f[v.right[b]]=[o,0];for(b=0,N=v.down.length;b<N;b++)f[v.down[b]]=[0,o];for(b=0,N=v.up.length;b<N;b++)f[v.up[b]]=[0,-1*o]},_setZoomDelta:function(o){var f=this._zoomKeys={},v=this.keyCodes,b,N;for(b=0,N=v.zoomIn.length;b<N;b++)f[v.zoomIn[b]]=o;for(b=0,N=v.zoomOut.length;b<N;b++)f[v.zoomOut[b]]=-o},_addHooks:function(){_t(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){er(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var f=o.keyCode,v=this._map,b;if(f in this._panKeys){if(!v._panAnim||!v._panAnim._inProgress)if(b=this._panKeys[f],o.shiftKey&&(b=ie(b).multiplyBy(3)),v.options.maxBounds&&(b=v._limitOffset(ie(b),v.options.maxBounds)),v.options.worldCopyJump){var N=v.wrapLatLng(v.unproject(v.project(v.getCenter()).add(b)));v.panTo(N)}else v.panBy(b)}else if(f in this._zoomKeys)v.setZoom(v.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[f]);else if(f===27&&v._popup&&v._popup.options.closeOnEscapeKey)v.closePopup();else return;na(o)}}});Ft.addInitHook("addHandler","keyboard",su),Ft.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var tr=Hn.extend({addHooks:function(){_t(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){er(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var f=Nd(o),v=this._map.options.wheelDebounceTime;this._delta+=f,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var b=Math.max(v-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),b),na(o)},_performZoom:function(){var o=this._map,f=o.getZoom(),v=this._map.options.zoomSnap||0;o._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),N=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,G=v?Math.ceil(N/v)*v:N,pe=o._limitZoom(f+(this._delta>0?G:-G))-f;this._delta=0,this._startTime=null,pe&&(o.options.scrollWheelZoom==="center"?o.setZoom(f+pe):o.setZoomAround(this._lastMousePos,f+pe))}});Ft.addInitHook("addHandler","scrollWheelZoom",tr);var ou=600;Ft.mergeOptions({tapHold:De.touchNative&&De.safari&&De.mobile,tapTolerance:15});var Co=Hn.extend({addHooks:function(){_t(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){er(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(clearTimeout(this._holdTimeout),o.touches.length===1){var f=o.touches[0];this._startPos=this._newPos=new F(f.clientX,f.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(_t(document,"touchend",gr),_t(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",f))},this),ou),_t(document,"touchend touchcancel contextmenu",this._cancel,this),_t(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function o(){er(document,"touchend",gr),er(document,"touchend touchcancel",o)},_cancel:function(){clearTimeout(this._holdTimeout),er(document,"touchend touchcancel contextmenu",this._cancel,this),er(document,"touchmove",this._onMove,this)},_onMove:function(o){var f=o.touches[0];this._newPos=new F(f.clientX,f.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(o,f){var v=new MouseEvent(o,{bubbles:!0,cancelable:!0,view:window,screenX:f.screenX,screenY:f.screenY,clientX:f.clientX,clientY:f.clientY});v._simulated=!0,f.target.dispatchEvent(v)}});Ft.addInitHook("addHandler","tapHold",Co),Ft.mergeOptions({touchZoom:De.touch,bounceAtZoomLimits:!0});var Fs=Hn.extend({addHooks:function(){St(this._map._container,"leaflet-touch-zoom"),_t(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){or(this._map._container,"leaflet-touch-zoom"),er(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var f=this._map;if(!(!o.touches||o.touches.length!==2||f._animatingZoom||this._zooming)){var v=f.mouseEventToContainerPoint(o.touches[0]),b=f.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=f.getSize()._divideBy(2),this._startLatLng=f.containerPointToLatLng(this._centerPoint),f.options.touchZoom!=="center"&&(this._pinchStartLatLng=f.containerPointToLatLng(v.add(b)._divideBy(2))),this._startDist=v.distanceTo(b),this._startZoom=f.getZoom(),this._moved=!1,this._zooming=!0,f._stop(),_t(document,"touchmove",this._onTouchMove,this),_t(document,"touchend touchcancel",this._onTouchEnd,this),gr(o)}},_onTouchMove:function(o){if(!(!o.touches||o.touches.length!==2||!this._zooming)){var f=this._map,v=f.mouseEventToContainerPoint(o.touches[0]),b=f.mouseEventToContainerPoint(o.touches[1]),N=v.distanceTo(b)/this._startDist;if(this._zoom=f.getScaleZoom(N,this._startZoom),!f.options.bounceAtZoomLimits&&(this._zoom<f.getMinZoom()&&N<1||this._zoom>f.getMaxZoom()&&N>1)&&(this._zoom=f._limitZoom(this._zoom)),f.options.touchZoom==="center"){if(this._center=this._startLatLng,N===1)return}else{var G=v._add(b)._divideBy(2)._subtract(this._centerPoint);if(N===1&&G.x===0&&G.y===0)return;this._center=f.unproject(f.project(this._pinchStartLatLng,this._zoom).subtract(G),this._zoom)}this._moved||(f._moveStart(!0,!1),this._moved=!0),ce(this._animRequest);var pe=l(f._move,f,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=he(pe,this,!0),gr(o)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ce(this._animRequest),er(document,"touchmove",this._onTouchMove,this),er(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ft.addInitHook("addHandler","touchZoom",Fs),Ft.BoxZoom=Ds,Ft.DoubleClickZoom=Zd,Ft.Drag=iu,Ft.Keyboard=su,Ft.ScrollWheelZoom=tr,Ft.TapHold=Co,Ft.TouchZoom=Fs,r.Bounds=Y,r.Browser=De,r.CRS=ae,r.Canvas=nu,r.Circle=Il,r.CircleMarker=Pl,r.Class=je,r.Control=Fn,r.DivIcon=Ml,r.DivOverlay=wa,r.DomEvent=Tl,r.DomUtil=xo,r.Draggable=aa,r.Evented=O,r.FeatureGroup=Ga,r.GeoJSON=_a,r.GridLayer=yi,r.Handler=Hn,r.Icon=Hi,r.ImageOverlay=xi,r.LatLng=te,r.LatLngBounds=z,r.Layer=ia,r.LayerGroup=gi,r.LineUtil=Rd,r.Map=Ft,r.Marker=Ka,r.Mixin=Hc,r.Path=vi,r.Point=F,r.PolyUtil=Jh,r.Polygon=Za,r.Polyline=jn,r.Popup=Ll,r.PosAnimation=El,r.Projection=n0,r.Rectangle=Kd,r.Renderer=ba,r.SVG=Vi,r.SVGOverlay=eu,r.TileLayer=_i,r.Tooltip=Ns,r.Transformation=Oe,r.Util=Ee,r.VideoOverlay=Qc,r.bind=l,r.bounds=R,r.canvas=au,r.circle=ko,r.circleMarker=zd,r.control=pi,r.divIcon=Hd,r.extend=a,r.featureGroup=Md,r.geoJSON=Ud,r.geoJson=sa,r.gridLayer=Ps,r.icon=Bd,r.imageOverlay=$d,r.latLng=W,r.latLngBounds=U,r.layerGroup=bo,r.map=mi,r.marker=s0,r.point=ie,r.polygon=l0,r.polyline=o0,r.popup=As,r.rectangle=c0,r.setOptions=w,r.stamp=m,r.svg=Bl,r.svgOverlay=tu,r.tileLayer=ru,r.tooltip=To,r.transformation=q,r.version=n,r.videoOverlay=Wd;var Yd=window.L;r.noConflict=function(){return window.L=Yd,this},window.L=r}))})(ju,ju.exports)),ju.exports}var jc=cC();const ed=Ph(jc);function Oh(e,t,r){return Object.freeze({instance:e,context:t,container:r})}function Rh(e,t){return t==null?function(n,a){const s=Z.useRef();return s.current||(s.current=e(n,a)),s}:function(n,a){const s=Z.useRef();s.current||(s.current=e(n,a));const l=Z.useRef(n),{instance:d}=s.current;return Z.useEffect(function(){l.current!==n&&(t(d,n,l.current),l.current=n)},[d,n,a]),s}}function x_(e,t){Z.useEffect(function(){return(t.layerContainer??t.map).addLayer(e.instance),function(){t.layerContainer?.removeLayer(e.instance),t.map.removeLayer(e.instance)}},[t,e])}function y_(e){return function(r){const n=Fh(),a=e(jh(r,n),n);return f_(n.map,r.attribution),jp(a.current,r.eventHandlers),x_(a.current,n),a}}function uC(e,t){const r=Z.useRef();Z.useEffect(function(){if(t.pathOptions!==r.current){const a=t.pathOptions??{};e.instance.setStyle(a),r.current=a}},[e,t])}function dC(e){return function(r){const n=Fh(),a=e(jh(r,n),n);return jp(a.current,r.eventHandlers),x_(a.current,n),uC(a.current,r),a}}function fC(e,t){const r=Rh(e,t),n=y_(r);return v_(n)}function hC(e,t){const r=Rh(e),n=oC(r,t);return iC(n)}function mC(e,t){const r=Rh(e,t),n=dC(r);return v_(n)}function pC(e,t){const r=Rh(e,t),n=y_(r);return sC(n)}function gC(e,t,r){const{opacity:n,zIndex:a}=t;n!=null&&n!==r.opacity&&e.setOpacity(n),a!=null&&a!==r.zIndex&&e.setZIndex(a)}function __(){return Fh().map}function cp(){return cp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cp.apply(this,arguments)}function vC({bounds:e,boundsOptions:t,center:r,children:n,className:a,id:s,placeholder:l,style:d,whenReady:m,zoom:p,...g},y){const[_]=Z.useState({className:a,id:s,style:d}),[T,S]=Z.useState(null);Z.useImperativeHandle(y,()=>T?.map??null,[T]);const w=Z.useCallback(P=>{if(P!==null&&T===null){const D=new jc.Map(P,g);r!=null&&p!=null?D.setView(r,p):e!=null&&D.fitBounds(e,t),m!=null&&D.whenReady(m),S(aC(D))}},[]);Z.useEffect(()=>()=>{T?.map.remove()},[T]);const E=T?rr.createElement(g_,{value:T},n):l??null;return rr.createElement("div",cp({},_,{ref:w}),E)}const w_=Z.forwardRef(vC),b_=fC(function({position:t,...r},n){const a=new jc.Marker(t,r);return Oh(a,m_(n,{overlayContainer:a}))},function(t,r,n){r.position!==n.position&&t.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&t.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&t.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&t.setOpacity(r.opacity),t.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?t.dragging.enable():t.dragging.disable())}),xC=mC(function({positions:t,...r},n){const a=new jc.Polyline(t,r);return Oh(a,m_(n,{overlayContainer:a}))},function(t,r,n){r.positions!==n.positions&&t.setLatLngs(r.positions)}),up=hC(function(t,r){const n=new jc.Popup(t,r.overlayContainer);return Oh(n,r)},function(t,r,{position:n},a){Z.useEffect(function(){const{instance:l}=t;function d(p){p.popup===l&&(l.update(),a(!0))}function m(p){p.popup===l&&a(!1)}return r.map.on({popupopen:d,popupclose:m}),r.overlayContainer==null?(n!=null&&l.setLatLng(n),l.openOn(r.map)):r.overlayContainer.bindPopup(l),function(){r.map.off({popupopen:d,popupclose:m}),r.overlayContainer?.unbindPopup(),r.map.removeLayer(l)}},[t,r,a,n])}),k_=pC(function({url:t,...r},n){const a=new jc.TileLayer(t,jh(r,n));return Oh(a,n)},function(t,r,n){gC(t,r,n);const{url:a}=r;a!=null&&a!==n.url&&t.setUrl(a)});function i1({startTime:e}){const[t,r]=Z.useState(0);if(Z.useEffect(()=>{if(!e)return;const s=()=>{const d=new Date(e).getTime(),m=Date.now();r(Math.floor((m-d)/1e3))};s();const l=setInterval(s,1e3);return()=>clearInterval(l)},[e]),!e)return null;const n=Math.floor(t/60),a=t%60;return u.jsxs("div",{className:"elapsed-timer",children:[u.jsx("span",{className:"timer-icon",children:"⏱️"}),u.jsxs("span",{className:"timer-value",children:[n,":",a.toString().padStart(2,"0")]})]})}function yC({positions:e,resetTrigger:t}){const r=__(),n=Z.useRef(!1),a=Z.useRef(0);return Z.useEffect(()=>{if(!(e.length===0||!(!n.current||t&&t!==a.current)))if(n.current=!0,t&&(a.current=t),e.length===1)r.setView(e[0],15);else{const l=ed.latLngBounds(e);r.fitBounds(l.pad(.1))}},[r,e,t]),null}function _C(e,t){return ed.divIcon({className:"custom-numbered-marker",html:`<div class="marker-pin ${t?"marker-active":""}">
      <div class="marker-number">${e}</div>
    </div>`,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]})}function wC(e){return typeof e.lat=="number"&&typeof e.lng=="number"&&!Number.isNaN(e.lat)&&!Number.isNaN(e.lng)?`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(`${e.lat},${e.lng}`)}`:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(e?.address??"")}`}const bC=function({state:t,setActive:r,cancelActive:n,onComplete:a,onAddArrangement:s,filterText:l}){const d=Array.isArray(t.addresses)?t.addresses:[],m=Array.isArray(t.completions)?t.completions:[],p=t.activeIndex,[g,y]=Z.useState(()=>{const F=localStorage.getItem("navigator_address_view_mode");return F==="map"||F==="list"?F:"list"}),[_,T]=Z.useState(0);Z.useEffect(()=>{localStorage.setItem("navigator_address_view_mode",g)},[g]);const S=Z.useMemo(()=>{const F=new Set;return d.forEach((M,ie)=>{if(!M.address)return;m.some(R=>R.index===ie&&(R.listVersion||t.currentListVersion)===t.currentListVersion)&&F.add(ie)}),F},[m,d,t.currentListVersion]),w=(l??"").trim().toLowerCase(),E=Z.useMemo(()=>d.map((F,M)=>({a:F,i:M})).filter(({a:F})=>!w||(F.address??"").toLowerCase().includes(w)).filter(({i:F})=>!S.has(F)),[d,w,S]),[P,D]=Z.useState(null),[A,H]=Z.useState(""),[J,B]=Z.useState(""),[I,ee]=Z.useState("1"),[re,ye]=Z.useState(null),[he,ce]=Z.useState(null),Ee=Z.useRef(new Map),[je,fe]=Z.useState(null);Z.useEffect(()=>{p===null&&(D(null),H(""),B(""),ee("1"),ye(null),fe(null),ce(null))},[p]);const ue=Z.useCallback(async(F,M,ie,Y,R,z)=>{const U=Ee.current.get(F);if(U){await U;return}const te=(async()=>{try{ce(F),await a(F,M,ie,Y,R,z),D(null)}catch(W){throw console.error("Completion failed:",W),W}finally{ce(null),Ee.current.delete(F)}})();Ee.current.set(F,te),await te},[a]),O=Z.useMemo(()=>E.filter(({a:F})=>F.lat&&F.lng),[E]);return E.length===0?u.jsxs("div",{className:"empty-state",children:[u.jsx("div",{className:"empty-icon",children:"📍"}),u.jsx("div",{className:"empty-title",children:"No Pending Addresses"}),u.jsx("div",{className:"empty-message",children:"Import an Excel file or add addresses manually to get started"})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"view-toggle-container",children:[u.jsxs("button",{className:`view-toggle-btn ${g==="list"?"active":""}`,onClick:()=>y("list"),children:[u.jsx("span",{children:"📋"}),u.jsx("span",{children:"List"})]}),u.jsxs("button",{className:`view-toggle-btn ${g==="map"?"active":""}`,onClick:()=>y("map"),disabled:O.length===0,children:[u.jsx("span",{children:"🗺️"}),u.jsx("span",{children:"Map"}),O.length===0&&u.jsx("span",{className:"badge-warning",children:"(No coordinates)"})]})]}),g==="map"&&O.length>0&&u.jsxs("div",{className:"map-view-container",children:[u.jsx("button",{className:"map-reset-btn",onClick:()=>T(Date.now()),title:"Reset map view to show all addresses",children:"🎯 Reset View"}),u.jsxs(w_,{center:[51.5074,-.1278],zoom:10,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[u.jsx(k_,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u.jsx(yC,{positions:O.map(({a:F})=>[F.lat,F.lng]),resetTrigger:_}),O.map(({a:F,i:M},ie)=>{const Y=p===M;return u.jsx(b_,{position:[F.lat,F.lng],icon:_C(ie+1,Y),children:u.jsx(up,{children:u.jsxs("div",{className:"map-popup",children:[u.jsxs("div",{className:"popup-header",children:[u.jsxs("span",{className:"popup-number",children:["#",ie+1]}),u.jsx("span",{className:`popup-status ${Y?"status-active":"status-pending"}`,children:Y?"Active":"Pending"})]}),u.jsx("div",{className:"popup-address",children:F.address}),!Y&&u.jsx("button",{className:"popup-btn-start",onClick:()=>r(M),children:"▶️ Start"}),Y&&u.jsxs("div",{className:"popup-active-info",children:[u.jsx(i1,{startTime:t.activeStartTime}),u.jsx("button",{className:"popup-btn-complete",onClick:()=>{y("list")},children:"✅ Complete"})]})]})})},M)})]})]}),g==="list"&&u.jsx("div",{className:"address-list-modern",children:E.map(({a:F,i:M},ie)=>{const Y=p===M,R=wC(F);return u.jsxs("div",{className:`address-card-modern ${Y?"active":""}`,children:[u.jsxs("div",{className:"address-header-modern",children:[u.jsxs("div",{className:"address-content",children:[u.jsx("div",{className:"address-number",children:ie+1}),u.jsxs("div",{className:"address-info",children:[u.jsx("div",{className:"address-title",title:F.address,children:F.address}),u.jsxs("div",{className:"address-meta",children:[u.jsxs("div",{className:"address-meta-item",children:[u.jsx("span",{children:"📍"}),u.jsxs("span",{children:["Index #",M+1]})]}),F.lat&&F.lng&&u.jsxs("div",{className:"address-meta-item",children:[u.jsx("span",{children:"🌍"}),u.jsx("span",{children:"Coordinates ready"})]}),Y&&t.activeStartTime&&u.jsx("div",{className:"address-meta-item",children:u.jsx(i1,{startTime:t.activeStartTime})})]})]})]}),u.jsxs("div",{className:`address-status-badge ${Y?"status-active":"status-pending"}`,children:[Y&&u.jsx("span",{children:"●"}),Y?"Active":"Pending"]})]}),u.jsxs("div",{className:"address-actions-modern",children:[u.jsxs("a",{className:"action-btn-modern btn-navigate",href:R,target:"_blank",rel:"noreferrer",title:"Open in Google Maps",onClick:()=>{},children:[u.jsx("span",{children:"🧭"}),u.jsx("span",{children:"Navigate"})]}),Y?u.jsxs(u.Fragment,{children:[u.jsxs("button",{className:"action-btn-modern btn-complete",onClick:()=>{D(P!==M?M:null),H(""),B(""),ye(null)},children:[u.jsx("span",{children:"✅"}),u.jsx("span",{children:"Complete"})]}),u.jsxs("button",{className:"action-btn-modern",style:{background:"var(--gray-100)",color:"var(--gray-600)"},onClick:()=>{window.confirm("Are you sure you want to cancel? Any tracked time will be lost.")&&n()},children:[u.jsx("span",{children:"❎"}),u.jsx("span",{children:"Cancel"})]})]}):u.jsxs("button",{className:"action-btn-modern btn-set-active",onClick:()=>r(M),children:[u.jsx("span",{children:"▶️"}),u.jsx("span",{children:"Start"})]})]}),Y&&P===M&&u.jsxs("div",{className:"outcome-panel-modern",children:[u.jsx("div",{className:"outcome-header",children:u.jsx("span",{className:"outcome-title",children:"Select Outcome"})}),u.jsxs("div",{className:"outcome-buttons",children:[u.jsxs("button",{className:"outcome-btn outcome-done",disabled:he===M,onClick:()=>ue(M,"Done"),title:"Mark as Done",children:[u.jsx("span",{className:"outcome-icon",children:"✅"}),u.jsx("span",{className:"outcome-label",children:"Done"})]}),u.jsxs("button",{className:"outcome-btn outcome-da",disabled:he===M,onClick:()=>ue(M,"DA"),title:"Mark as DA",children:[u.jsx("span",{className:"outcome-icon",children:"🚫"}),u.jsx("span",{className:"outcome-label",children:"DA"})]}),u.jsxs("button",{className:"outcome-btn outcome-arr",onClick:()=>{D(null),fe(M)},title:"Create arrangement",children:[u.jsx("span",{className:"outcome-icon",children:"📅"}),u.jsx("span",{className:"outcome-label",children:"Arrangement"})]})]}),u.jsx("div",{className:"pif-section",children:u.jsxs("div",{className:"pif-input-group",children:[u.jsx("span",{className:"pif-label",children:"💰 PIF Amount:"}),u.jsx("input",{id:`pif-amount-${M}`,name:`pifAmount-${M}`,type:"number",step:"0.01",min:"0",inputMode:"decimal",className:"pif-input",placeholder:"£0.00",value:A,onChange:z=>H(z.target.value),autoComplete:"off",onKeyDown:z=>{if(z.key==="Enter"){const U=Number(A);if(!Number.isFinite(U)||U<=0){alert("Enter a valid PIF amount (e.g. 50)");return}ye(M)}}}),u.jsxs("button",{className:"outcome-btn outcome-pif",disabled:he===M,onClick:()=>{const z=Number(A);if(!Number.isFinite(z)||z<=0){alert("Enter a valid PIF amount (e.g. 50)");return}ye(M)},children:[u.jsx("span",{className:"outcome-icon",children:"💷"}),u.jsx("span",{className:"outcome-label",children:"Next"})]})]})}),he===M&&u.jsxs("div",{className:"outcome-loading",children:[u.jsx("span",{className:"spinner-small"}),u.jsx("span",{children:"Processing..."})]})]})]},M)})}),je!==null&&s&&d[je]&&u.jsx(Fp,{state:t,preSelectedAddressIndex:je,onSave:async F=>{const M=await s(F);ue(je,"ARR",void 0,M),fe(null)},onCancel:()=>fe(null),onComplete:ue,fullscreen:!0}),re!==null&&u.jsx("div",{className:"case-ref-modal-overlay",onClick:()=>ye(null),children:u.jsxs("div",{className:"case-ref-modal",onClick:F=>F.stopPropagation(),children:[u.jsxs("div",{className:"case-ref-modal-header",children:[u.jsx("h3",{children:"📋 Enter Case Details"}),u.jsx("button",{className:"close-btn",onClick:()=>ye(null),children:"✕"})]}),u.jsxs("div",{className:"case-ref-modal-body",children:[u.jsxs("p",{children:["PIF Amount: ",u.jsxs("strong",{children:["£",Number(A).toFixed(2)]})]}),u.jsxs("div",{className:"case-ref-input-wrapper",children:[u.jsx("label",{htmlFor:"case-ref-input",children:"Case Reference Number"}),u.jsx("input",{id:"case-ref-input",type:"number",inputMode:"numeric",className:"case-ref-input",placeholder:"e.g. 123456",value:J,onChange:F=>B(F.target.value),autoComplete:"off",autoFocus:!0})]}),u.jsxs("div",{className:"case-ref-input-wrapper",style:{marginTop:"1rem"},children:[u.jsx("label",{htmlFor:"num-cases-input",children:"Number of Cases"}),u.jsx("input",{id:"num-cases-input",type:"number",inputMode:"numeric",className:"case-ref-input",placeholder:"e.g. 1",min:"1",value:I,onChange:F=>ee(F.target.value),autoComplete:"off",onKeyDown:F=>{if(F.key==="Enter"){const M=Number(J),ie=Number(I);if(!J||!J.trim()){alert("Please enter a case reference number");return}if(!Number.isFinite(M)||M<=0||!Number.isInteger(M)){alert("Case reference must be a valid whole number");return}if(!Number.isFinite(ie)||ie<=0||!Number.isInteger(ie)){alert("Number of cases must be a valid whole number");return}ue(re,"PIF",Number(A).toFixed(2),void 0,J.trim(),ie),ye(null),B(""),ee("1"),H("")}}}),u.jsx("small",{style:{fontSize:"0.75rem",color:"var(--gray-500)",marginTop:"0.25rem"},children:"If 1 debtor has 3 linked cases, enter 3"})]})]}),u.jsxs("div",{className:"case-ref-modal-footer",children:[u.jsx("button",{className:"modal-btn modal-btn-cancel",onClick:()=>{ye(null),B(""),ee("1")},children:"Cancel"}),u.jsx("button",{className:"modal-btn modal-btn-save",disabled:he===re,onClick:()=>{const F=Number(J),M=Number(I);if(!J||!J.trim()){alert("Please enter a case reference number");return}if(!Number.isFinite(F)||F<=0||!Number.isInteger(F)){alert("Case reference must be a valid whole number");return}if(!Number.isFinite(M)||M<=0||!Number.isInteger(M)){alert("Number of cases must be a valid whole number");return}ue(re,"PIF",Number(A).toFixed(2),void 0,J.trim(),M),ye(null),B(""),ee("1"),H("")},children:he===re?"Saving...":"Save PIF"})]})]})}),u.jsx("style",{children:`
        /* Elapsed Timer Styles */
        .elapsed-timer {
          display: inline-flex;
          align-items: center;
          gap: 0.25rem;
          padding: 0.25rem 0.5rem;
          background: var(--primary);
          color: white;
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.875rem;
          animation: pulse 2s ease-in-out infinite;
        }

        .timer-icon {
          font-size: 1rem;
        }

        .timer-value {
          font-variant-numeric: tabular-nums;
          min-width: 3rem;
          text-align: center;
        }

        @keyframes pulse {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.85;
          }
        }

        /* View Toggle Styles */
        .view-toggle-container {
          display: flex;
          gap: 0.5rem;
          padding: 0.75rem;
          margin-bottom: 1rem;
          background: var(--surface);
          border: 1px solid var(--border);
          border-radius: var(--radius-lg);
        }

        .view-toggle-btn {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem 1rem;
          border: 2px solid var(--border);
          border-radius: var(--radius-md);
          background: var(--surface);
          color: var(--text-secondary);
          font-weight: 600;
          font-size: 0.875rem;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .view-toggle-btn:hover:not(:disabled) {
          background: var(--gray-50);
          border-color: var(--primary);
        }

        .view-toggle-btn.active {
          background: var(--primary);
          border-color: var(--primary);
          color: white;
        }

        .view-toggle-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .badge-warning {
          font-size: 0.65rem;
          color: var(--warning);
          font-weight: normal;
        }

        /* Map View Styles */
        .map-view-container {
          height: 600px;
          max-height: calc(100vh - 300px);
          position: relative;
          border-radius: var(--radius-lg);
          overflow: hidden;
          border: 1px solid var(--border);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          z-index: 1;
        }

        /* Ensure Leaflet map respects container */
        .map-view-container .leaflet-container {
          border-radius: var(--radius-lg);
          z-index: 1;
        }

        /* Map Reset Button */
        .map-reset-btn {
          position: absolute;
          top: 10px;
          right: 10px;
          z-index: 10;
          padding: 0.5rem 1rem;
          background: var(--surface);
          color: var(--text-primary);
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.875rem;
          cursor: pointer;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
          transition: all 0.2s ease;
        }

        .map-reset-btn:hover {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
          transform: translateY(-1px);
          box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3);
        }

        .map-reset-btn:active {
          transform: translateY(0);
        }

        /* Custom Numbered Markers */
        .custom-numbered-marker {
          background: transparent;
          border: none;
        }

        .marker-pin {
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .marker-pin::before {
          content: '';
          position: absolute;
          width: 36px;
          height: 36px;
          background: var(--primary);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          border: 3px solid white;
        }

        .marker-pin.marker-active::before {
          background: var(--success);
          animation: markerPulse 2s ease-in-out infinite;
        }

        @keyframes markerPulse {
          0%, 100% {
            transform: rotate(-45deg) scale(1);
          }
          50% {
            transform: rotate(-45deg) scale(1.1);
          }
        }

        .marker-number {
          position: relative;
          z-index: 1;
          color: white;
          font-weight: bold;
          font-size: 0.875rem;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
          transform: translateY(-2px);
        }

        /* Leaflet Popup Override for Dark Mode */
        .leaflet-popup-content-wrapper {
          background: var(--surface) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--border) !important;
          box-shadow: 0 3px 14px rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-tip {
          background: var(--surface) !important;
          border: 1px solid var(--border) !important;
        }

        .leaflet-popup-close-button {
          color: var(--text-primary) !important;
        }

        .leaflet-popup-close-button:hover {
          color: var(--primary) !important;
        }

        /* Map Popup Styles */
        .map-popup {
          min-width: 200px;
          padding: 0.5rem;
        }

        .popup-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 0.5rem;
          padding-bottom: 0.5rem;
          border-bottom: 1px solid var(--border);
        }

        .popup-number {
          font-weight: bold;
          color: var(--primary);
          font-size: 1rem;
        }

        .popup-status {
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          font-size: 0.75rem;
          font-weight: 600;
        }

        .popup-status.status-active {
          background: var(--success);
          color: white;
        }

        .popup-status.status-pending {
          background: var(--gray-700);
          color: var(--gray-100);
        }

        .popup-address {
          margin-bottom: 0.75rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .popup-btn-start,
        .popup-btn-complete {
          width: 100%;
          padding: 0.5rem 1rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .popup-btn-start {
          background: var(--primary);
          color: white;
        }

        .popup-btn-start:hover {
          background: var(--primary-dark);
        }

        .popup-btn-complete {
          background: var(--success);
          color: white;
          margin-top: 0.5rem;
        }

        .popup-btn-complete:hover {
          background: var(--success-dark);
        }

        .popup-active-info {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .popup-active-info .elapsed-timer {
          justify-content: center;
          margin-bottom: 0.25rem;
        }

        /* Modern Outcome Panel Styles */
        .outcome-panel-modern {
          background: var(--gray-50);
          border: 2px solid var(--primary);
          border-radius: var(--radius-lg);
          padding: 1rem;
          margin-top: 1rem;
          animation: slideDown 0.3s ease-out;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .outcome-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1rem;
        }

        .outcome-title {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-buttons {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .outcome-btn {
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          gap: 0.25rem;
          padding: 0.75rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          cursor: pointer;
          transition: var(--transition-normal);
          position: relative;
          overflow: hidden;
        }

        .outcome-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(255, 255, 255, 0.1);
          transform: translateY(100%);
          transition: transform 0.3s ease;
        }

        .outcome-btn:hover::before {
          transform: translateY(0);
        }

        .outcome-btn:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .outcome-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
        }

        .outcome-icon {
          font-size: 1.25rem;
        }

        .outcome-label {
          font-size: 0.75rem;
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }

        .outcome-done {
          background: var(--success);
          color: white;
        }

        .outcome-da {
          background: var(--danger);
          color: white;
        }

        .outcome-arr {
          background: var(--warning);
          color: white;
        }

        .outcome-pif {
          background: var(--primary);
          color: white;
        }

        .pif-section {
          padding-top: 1rem;
          border-top: 1px solid var(--gray-200);
        }

        .pif-input-group {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .pif-label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .pif-input {
          flex: 1;
          padding: 0.625rem 0.75rem;
          border: 2px solid var(--gray-200);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
          font-weight: 600;
          text-align: right;
          transition: var(--transition-normal);
        }

        .pif-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        .outcome-loading {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem;
          color: var(--gray-600);
          font-size: 0.875rem;
        }

        .spinner-small {
          width: 16px;
          height: 16px;
          border: 2px solid var(--gray-300);
          border-top-color: var(--primary);
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
          .outcome-buttons {
            grid-template-columns: 1fr;
          }

          .pif-input-group {
            flex-direction: column;
            align-items: stretch;
          }

          .outcome-btn {
            flex-direction: row;
            justify-content: center;
            gap: 0.5rem;
          }
        }

        /* Case Reference Modal Styles */
        .case-ref-modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          animation: fadeIn 0.2s ease-out;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
          }
          to {
            opacity: 1;
          }
        }

        .case-ref-modal {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
          width: 90%;
          max-width: 450px;
          animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        .case-ref-modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
        }

        .case-ref-modal-header h3 {
          margin: 0;
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--gray-800);
        }

        .close-btn {
          background: none;
          border: none;
          font-size: 1.5rem;
          color: var(--gray-500);
          cursor: pointer;
          padding: 0.25rem;
          line-height: 1;
          transition: var(--transition-normal);
        }

        .close-btn:hover {
          color: var(--gray-700);
          transform: scale(1.1);
        }

        .case-ref-modal-body {
          padding: 1.5rem;
        }

        .case-ref-modal-body p {
          margin: 0 0 1.5rem 0;
          font-size: 1rem;
          color: var(--gray-600);
        }

        .case-ref-modal-body strong {
          color: var(--primary);
          font-size: 1.125rem;
        }

        .case-ref-input-wrapper {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .case-ref-input-wrapper label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .case-ref-input {
          padding: 0.875rem 1rem;
          border: 2px solid var(--gray-300);
          border-radius: var(--radius-md);
          font-size: 1rem;
          font-weight: 600;
          transition: var(--transition-normal);
        }

        .case-ref-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 4px var(--primary-light);
        }

        .case-ref-modal-footer {
          display: flex;
          gap: 0.75rem;
          padding: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .modal-btn {
          flex: 1;
          padding: 0.875rem 1.5rem;
          border: none;
          border-radius: var(--radius-md);
          font-weight: 600;
          font-size: 0.938rem;
          cursor: pointer;
          transition: var(--transition-normal);
        }

        .modal-btn-cancel {
          background: var(--gray-100);
          color: var(--gray-700);
        }

        .modal-btn-cancel:hover {
          background: var(--gray-200);
        }

        .modal-btn-save {
          background: var(--primary);
          color: white;
        }

        .modal-btn-save:hover:not(:disabled) {
          background: var(--primary-dark);
          transform: translateY(-1px);
          box-shadow: var(--shadow-md);
        }

        .modal-btn-save:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }

        @media (max-width: 768px) {
          .case-ref-modal {
            width: 95%;
            margin: 1rem;
          }

          .case-ref-modal-header,
          .case-ref-modal-body,
          .case-ref-modal-footer {
            padding: 1rem;
          }
        }
      `})]})},kC=Z.memo(bC),SC="Europe/London";function eo(e,t=SC){const r=e.toLocaleDateString("en-GB",{timeZone:t,year:"numeric"}),n=e.toLocaleDateString("en-GB",{timeZone:t,month:"2-digit"}),a=e.toLocaleDateString("en-GB",{timeZone:t,day:"2-digit"});return r+"-"+n+"-"+a}function dp(e){const t=e.split("-");return new Date(Number(t[0]),Number(t[1])-1,Number(t[2]))}function oh(e,t){const r=new Date(e.getTime());return r.setDate(r.getDate()+t),r}function Hf(e){return new Date(e.getFullYear(),e.getMonth(),1)}function Dm(e,t){return e===t}function TC(e,t,r){return e>=t&&e<=r}function s1(e){return(e/3600).toFixed(2)}function EC(e){const t=e;if(typeof t.durationSeconds=="number")return Math.max(0,t.durationSeconds);if(e.start&&e.end)try{const r=new Date(e.start).getTime(),n=new Date(e.end).getTime();if(isFinite(r)&&isFinite(n)&&n>r)return Math.floor((n-r)/1e3)}catch(r){console.warn("Failed to calculate duration:",r)}return 0}function CC(e,t){if(!e||!t)return[];const r=dp(e),n=dp(t);if(!(r<=n))return[e];const a=[];let s=new Date(r.getTime());for(;s<=n;)a.push(eo(s)),s=oh(s,1);return a}function AC({startKey:e,endKey:t,onChange:r}){const n=dp(t||e||eo(new Date)),[a,s]=Z.useState(Hf(n)),[l,d]=Z.useState(!1);function m(P){const D=Hf(P),H=(D.getDay()+6)%7,J=oh(D,-H),B=[];for(let I=0;I<42;I++){const ee=oh(J,I);B.push({key:eo(ee),inMonth:ee.getMonth()===P.getMonth(),date:ee})}return B}const p=m(a),g=a.toLocaleDateString("en-GB",{month:"long"})+" "+String(a.getFullYear()),y=e<=t?e:t,_=e<=t?t:e,T=eo(new Date);function S(){s(new Date(a.getFullYear(),a.getMonth()-1,1))}function w(){s(new Date(a.getFullYear(),a.getMonth()+1,1))}function E(P){if(!l){r(P,P),d(!0);return}let D=e||P,A=P;if(A<D){const H=D;D=A,A=H}r(D,A),d(!1)}return u.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.5rem"},children:[u.jsx("button",{className:"btn btn-ghost",onClick:S,"aria-label":"Previous month",children:"Prev"}),u.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:g}),u.jsx("button",{className:"btn btn-ghost",onClick:w,"aria-label":"Next month",children:"Next"})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4,fontSize:12,color:"var(--text-secondary)",textAlign:"center",marginBottom:4},children:[u.jsx("div",{children:"Mon"}),u.jsx("div",{children:"Tue"}),u.jsx("div",{children:"Wed"}),u.jsx("div",{children:"Thu"}),u.jsx("div",{children:"Fri"}),u.jsx("div",{children:"Sat"}),u.jsx("div",{children:"Sun"})]}),u.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:4},children:p.map(P=>{const D=TC(P.key,y,_),A=Dm(P.key,e),H=Dm(P.key,t),J=Dm(P.key,T),B={padding:"0.5rem 0",borderRadius:8,border:"1px solid var(--border-light)",background:D?"var(--surface-strong)":"var(--surface)",textAlign:"center",cursor:"pointer",opacity:P.inMonth?1:.45,position:"relative",userSelect:"none"},I={position:"absolute",top:6,right:6,width:6,height:6,borderRadius:6,background:J?"currentColor":"transparent",opacity:J?.7:0},ee={position:"absolute",inset:0,borderRadius:8,border:A||H?"2px solid var(--primary, #4f46e5)":"2px solid transparent",pointerEvents:"none"};return u.jsxs("div",{style:B,title:P.key,onClick:()=>E(P.key),children:[u.jsx("div",{style:{fontWeight:A||H?700:500,color:"var(--text-primary)"},children:String(P.date.getDate())}),u.jsx("div",{style:I}),u.jsx("div",{style:ee})]},P.key)})}),u.jsxs("div",{style:{display:"flex",gap:8,marginTop:8,flexWrap:"wrap"},children:[u.jsx("button",{className:"btn btn-ghost",onClick:()=>{const P=eo(new Date);r(P,P),s(Hf(new Date)),d(!1)},children:"Today"}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>{const P=new Date,D=oh(new Date,-6);r(eo(D),eo(P)),s(Hf(P)),d(!1)},children:"Last 7 days"})]})]})}function NC(e,t){const r=e,n=[r.date,r.day,r.at,r.timestamp,r.completedAt,r.created_at];for(const s of n){if(!s)continue;const l=new Date(s);if(!Number.isNaN(l.getTime()))return l.toISOString().slice(0,10)}const a=new Set(t.map(s=>s.date));return a.size===1&&Array.from(a)[0]||null}const PC=function({state:t,onChangeOutcome:r,onAddArrangement:n,onComplete:a}){const{addresses:s,completions:l,daySessions:d,arrangements:m}=t,[p,g]=Z.useState(null),[y,_]=Z.useState(""),[T,S]=Z.useState(null),w=d.length>0?d[d.length-1].date:eo(new Date),[E,P]=Z.useState(w),[D,A]=Z.useState(w),[H,J]=Z.useState(!1),B=Z.useMemo(()=>{const ue=new Map;for(const O of d){const F=O.date;if(!F)continue;const M=ue.get(F)||0;ue.set(F,M+EC(O))}return ue},[d]),I=Z.useMemo(()=>{const ue=new Map;return l.forEach((O,F)=>{const M=NC(O,d);if(!M)return;const ie=ue.get(M);ie?ie.push(F):ue.set(M,[F])}),ue},[l,d]),ee=CC(E,D);let re=0,ye=0,he=0,ce=0;ee.forEach(ue=>{re+=B.get(ue)||0;const O=I.get(ue)||[];ye+=O.length,he+=O.map(F=>l[F]).filter(F=>F.outcome==="PIF").length,ce+=O.map(F=>l[F]).filter(F=>F.outcome==="DA").length});const[Ee,je]=Z.useState({});function fe(ue){je(O=>({...O,[ue]:!O[ue]}))}return u.jsxs("div",{children:[u.jsx("div",{style:{marginBottom:"0.9rem"},children:u.jsx(AC,{startKey:E,endKey:D,onChange:(ue,O)=>{P(ue),A(O)}})}),u.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"12px",padding:"1rem",boxShadow:"var(--shadow-sm)",marginBottom:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:"0.75rem",marginBottom:8,flexWrap:"wrap"},children:[u.jsx("div",{style:{fontWeight:600,color:"var(--text-primary)"},children:"Summary "+(E===D?"("+E+")":"("+E+" -> "+D+")")}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>J(ue=>!ue),children:H?"Hide details":"View details"})]}),u.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap"},children:[u.jsxs("span",{className:"pill",children:["Hours ",s1(re)]}),u.jsxs("span",{className:"pill pill-done",children:["Completed ",ye]}),u.jsxs("span",{className:"pill pill-pif",children:["PIF ",he]}),u.jsxs("span",{className:"pill pill-da",children:["DA ",ce]})]})]}),H&&u.jsx("div",{style:{display:"grid",gap:"0.75rem"},children:ee.map(ue=>{const O=B.get(ue)||0,F=I.get(ue)||[],M=F.map(z=>l[z]).filter(z=>z.outcome==="PIF").length,ie=F.map(z=>l[z]).filter(z=>z.outcome==="DA").length,Y=F.map(z=>l[z]).filter(z=>z.outcome==="ARR").length,R=F.length;return u.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:12,padding:"0.75rem",boxShadow:"var(--shadow-sm)"},children:[u.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap"},children:[u.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",flexWrap:"wrap"},children:[u.jsx("strong",{children:ue}),u.jsxs("span",{className:"pill",children:["Hours ",s1(O)]}),u.jsxs("span",{className:"pill pill-done",children:["Completed ",R]}),u.jsxs("span",{className:"pill pill-pif",children:["PIF ",M]}),u.jsxs("span",{className:"pill pill-da",children:["DA ",ie]}),Y>0&&u.jsxs("span",{className:"pill pill-arr",children:["ARR ",Y]})]}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>fe(ue),children:Ee[ue]?"Hide":"View"})]}),Ee[ue]&&u.jsx("div",{style:{marginTop:"0.75rem"},children:F.length===0?u.jsx("div",{style:{fontSize:14,color:"var(--text-secondary)"},children:"No entries for this day."}):u.jsx("div",{style:{display:"grid",gap:"0.5rem"},children:F.map(z=>{const U=l[z],te=s[U.index],W=te&&te.address||te&&te.name||(typeof U.index=="number"?"Address #"+U.index:"Address"),ae=U.outcome,oe=U.arrangementId?m.find(de=>de.id===U.arrangementId):null;return u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",alignItems:"center",border:"1px dashed var(--border-light)",borderRadius:10,padding:"0.5rem 0.75rem"},children:[u.jsxs("div",{style:{minWidth:0},children:[u.jsx("div",{style:{fontWeight:500,overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-primary)"},children:W}),u.jsxs("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:["Index "+String(U.index),U.outcome==="PIF"&&u.jsx("span",{style:{marginLeft:8,display:"inline-flex",alignItems:"center",gap:4},children:p===z?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:"· £"}),u.jsx("label",{htmlFor:`pif-amount-${z}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"PIF Amount"}),u.jsx("input",{id:`pif-amount-${z}`,name:"pifAmount",type:"number",step:"0.01",min:"0",inputMode:"decimal",style:{width:70,padding:"2px 4px",fontSize:12,border:"1px solid var(--border)",borderRadius:3,background:"var(--surface)"},value:y,onChange:de=>_(de.target.value),onKeyDown:de=>{if(de.key==="Enter"){const ge=parseFloat(y);isFinite(ge)&&ge>=0&&(r(z,"PIF",ge.toFixed(2)),g(null),_(""))}else de.key==="Escape"&&(g(null),_(""))},autoFocus:!0}),u.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--success)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{const de=parseFloat(y);isFinite(de)&&de>=0&&(r(z,"PIF",de.toFixed(2)),g(null),_(""))},children:"✓"}),u.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--danger)",color:"white",border:"none",borderRadius:3,cursor:"pointer"},onClick:()=>{g(null),_("")},children:"✕"})]}):u.jsxs(u.Fragment,{children:[u.jsxs("span",{children:["· £",U.amount||"0.00"]}),u.jsx("button",{style:{fontSize:10,padding:"2px 6px",background:"var(--primary)",color:"white",border:"none",borderRadius:3,cursor:"pointer",marginLeft:4},onClick:()=>{g(z),_(U.amount||"")},title:"Edit PIF amount",children:"✏️"}),U.caseReference&&u.jsxs("span",{style:{marginLeft:8},children:["· Ref: ",U.caseReference]})]})}),oe&&u.jsxs(u.Fragment,{children:[u.jsx("br",{}),u.jsxs("span",{style:{color:"var(--primary)",fontSize:"0.75rem"},children:["📅 From arrangement",oe.customerName&&` (${oe.customerName})`,U.outcome==="Done"&&" • Defaulted",U.outcome==="PIF"&&oe.recurrenceType&&oe.recurrenceType!=="none"&&` • ${oe.recurrenceType==="weekly"?"Weekly":"Monthly"} payment`]})]}),U.timeSpentSeconds!==void 0&&U.timeSpentSeconds>0&&u.jsxs(u.Fragment,{children:[!oe&&u.jsx("br",{}),u.jsxs("span",{style:{color:"var(--gray-600)",fontSize:"0.75rem",marginLeft:oe?8:0},children:[oe&&" • ","⏱️ ",Math.floor(U.timeSpentSeconds/60),"m ",U.timeSpentSeconds%60,"s"]})]})]})]}),u.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[u.jsx("label",{htmlFor:`outcome-${z}`,style:{position:"absolute",width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0,0,0,0)",whiteSpace:"nowrap",border:0},children:"Outcome"}),u.jsxs("select",{id:`outcome-${z}`,name:`outcome-${z}`,value:ae||"",onChange:de=>{const ge=de.target.value;ge==="ARR"&&n?S({completionIndex:z,addressIndex:U.index}):r(z,ge,U.amount)},className:"input",style:{padding:"0.25rem 0.5rem",height:32},children:[u.jsx("option",{value:"",children:"-"}),u.jsx("option",{value:"Done",children:oe?"Done (Defaulted)":"Done"}),u.jsx("option",{value:"PIF",children:oe?"PIF (Arrangement)":"PIF"}),u.jsx("option",{value:"DA",children:"DA"}),u.jsx("option",{value:"ARR",children:"ARR"})]})]})]},z)})})})]},ue)})}),T&&n&&a&&u.jsx(Fp,{state:t,preSelectedAddressIndex:T.addressIndex,onSave:async ue=>{const O=await n(ue);r(T.completionIndex,"ARR",void 0,O),S(null)},onCancel:()=>S(null),onComplete:a,fullscreen:!0})]})},IC=Z.memo(PC),DC=()=>{const[e,t]=Z.useState(!1),r=Z.useRef(null);return{isLoading:e,executeBackup:async s=>{if(e){console.warn("Backup already in progress, ignoring duplicate request");return}t(!0),r.current=setTimeout(()=>{console.error("Backup timeout reached - forcing reset"),t(!1)},6e4);try{await s(),console.log("Backup completed successfully")}catch(l){throw console.error("Backup failed:",l),l}finally{r.current&&(clearTimeout(r.current),r.current=null),t(!1)}},forceReset:()=>{console.warn("Force resetting backup loading state"),r.current&&(clearTimeout(r.current),r.current=null),t(!1)}}},S_=["Reminder: Please arrange payment by end of day to avoid further action.","Friendly reminder: Your arrangement is due. Contact us to confirm.","Action required: Settle outstanding balance today for compliance.","Update: Payment arrangement needed. Reply to reschedule if required."],Vf={backupOnEndOfDay:!1,reminderText:S_[0],darkMode:!1,pushNotifications:!0,autoSyncOnStart:!0,confirmBeforeDelete:!0,keepDataForMonths:6},o1="navigator-web:settings",T_=Z.createContext(void 0),FC=({children:e})=>{const[t,r]=Z.useState(()=>{if(typeof window<"u")try{const _=localStorage.getItem(o1);return _?{...Vf,...JSON.parse(_)}:Vf}catch{return Vf}return Vf});Z.useEffect(()=>{typeof window<"u"&&localStorage.setItem(o1,JSON.stringify(t))},[t]),Z.useEffect(()=>{t.darkMode?(document.documentElement.classList.add("dark-mode"),document.body.style.background="linear-gradient(135deg, #1f2937 0%, #111827 100%)"):(document.documentElement.classList.remove("dark-mode"),document.body.style.background="linear-gradient(135deg, #667eea 0%, #764ba2 100%)")},[t.darkMode]);const n=Z.useCallback(_=>{r(T=>({...T,..._}))},[]),a=Z.useCallback(()=>{r(_=>({..._,backupOnEndOfDay:!_.backupOnEndOfDay}))},[]),s=Z.useCallback(()=>{r(_=>({..._,darkMode:!_.darkMode}))},[]),l=Z.useCallback(()=>{r(_=>({..._,pushNotifications:!_.pushNotifications}))},[]),d=Z.useCallback(()=>{r(_=>({..._,autoSyncOnStart:!_.autoSyncOnStart}))},[]),m=Z.useCallback(()=>{r(_=>({..._,confirmBeforeDelete:!_.confirmBeforeDelete}))},[]),p=Z.useCallback(_=>{r(T=>({...T,reminderText:_}))},[]),g=Z.useCallback(_=>{r(T=>({...T,keepDataForMonths:_}))},[]),y={settings:t,updateSettings:n,toggleBackup:a,toggleDarkMode:s,togglePushNotifications:l,toggleAutoSync:d,toggleConfirmBeforeDelete:m,updateReminderText:p,updateKeepDataForMonths:g,predefinedReminders:S_};return u.jsx(T_.Provider,{value:y,children:e})},Op=()=>{const e=Z.useContext(T_);if(e===void 0)throw new Error("useSettings must be used within a SettingsProvider");return e};function l1(e,t){const[r,n,a]=e.split("-").map(Number),[s,l]=t.split(":").map(Number);try{return new Date(r,(n||1)-1,a||1,s||0,l||0).toISOString()}catch{return""}}function c1(e){if(!e)return"—";try{return new Date(e).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1,timeZone:"Europe/London"})}catch{return"—"}}function Gf(e){if(!e)return"";try{const t=new Date(e),r=String(t.getHours()).padStart(2,"0"),n=String(t.getMinutes()).padStart(2,"0");return`${r}:${n}`}catch{return""}}function u1(e){if(!e)return"";try{const t=new Date(e),r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${a}`}catch{return""}}const jC=function({sessions:t,completions:r,startDay:n,endDay:a,onEditStart:s,onEditEnd:l,onBackup:d}){const{settings:m}=Op(),{isLoading:p,executeBackup:g,forceReset:y}=DC(),_=new Date().toISOString().slice(0,10),T=t.filter(F=>F.date===_),S=T.find(F=>!F.end)||null,w=S||T.slice().sort((F,M)=>{const ie=new Date(F.start||F.date+"T00:00:00.000Z").getTime();return new Date(M.start||M.date+"T00:00:00.000Z").getTime()-ie})[0],E=!!S,P=async()=>{try{m.backupOnEndOfDay&&d&&await g(d),a()}catch(F){console.error("Failed to complete backup during end day:",F),a()}},A=r.filter(F=>(F.timestamp||"").slice(0,10)===_).reduce((F,M)=>((M.outcome==="PIF"||M.outcome==="DA"||M.outcome==="Done"||M.outcome==="ARR")&&(F[M.outcome]+=1),F),{PIF:0,DA:0,Done:0,ARR:0}),[H,J]=Z.useState(!1),[B,I]=Z.useState(_),[ee,re]=Z.useState(()=>{if(w?.start)return Gf(w.start);const F=new Date;return`${String(F.getHours()).padStart(2,"0")}:${String(F.getMinutes()).padStart(2,"0")}`});Z.useEffect(()=>{if(w?.start)I(u1(w.start)||w.date),re(Gf(w.start));else{I(_);const F=new Date;re(`${String(F.getHours()).padStart(2,"0")}:${String(F.getMinutes()).padStart(2,"0")}`)}},[w?.start,w?.date,_]);const ye=Z.useCallback(()=>{const F=l1(B,ee);F&&s(F),J(!1)},[B,ee,s]),[he,ce]=Z.useState(!1),[Ee,je]=Z.useState(_),[fe,ue]=Z.useState(()=>{if(w?.end)return Gf(w.end);const F=new Date;return`${String(F.getHours()).padStart(2,"0")}:${String(F.getMinutes()).padStart(2,"0")}`});Z.useEffect(()=>{if(w?.end)je(u1(w.end)||w.date),ue(Gf(w.end));else{je(_);const F=new Date;ue(`${String(F.getHours()).padStart(2,"0")}:${String(F.getMinutes()).padStart(2,"0")}`)}},[w?.end,w?.date,_]);const O=Z.useCallback(()=>{const F=l1(Ee,fe);F&&l(F),ce(!1)},[Ee,fe,l]);return u.jsxs("div",{className:`day-panel-modern ${E?"day-panel-active":""}`,children:[u.jsxs("div",{className:"day-panel-header",children:[u.jsxs("div",{className:"day-status",children:[u.jsx("div",{className:"day-status-icon",children:E?"🟢":w?"🔴":"⚫"}),u.jsxs("div",{className:"day-status-text",children:[u.jsx("div",{className:"day-status-title",children:E?"Day Running":w?"Day Completed":"No Session Today"}),u.jsx("div",{className:"day-status-subtitle",children:w?.start?u.jsxs(u.Fragment,{children:[c1(w.start),w?.end&&u.jsxs(u.Fragment,{children:[" → ",c1(w.end)]}),E&&!w?.end&&u.jsxs(u.Fragment,{children:[" • ",u.jsx("span",{style:{color:"var(--success)"},children:"Active"})]})]}):"Click 'Start Day' to begin tracking"})]})]}),u.jsxs("div",{className:"day-stats-modern",children:[u.jsxs("div",{className:"stat-pill stat-pill-pif",children:[u.jsx("span",{className:"stat-number",children:A.PIF}),u.jsx("span",{className:"stat-label",children:"PIF"})]}),u.jsxs("div",{className:"stat-pill stat-pill-done",children:[u.jsx("span",{className:"stat-number",children:A.Done}),u.jsx("span",{className:"stat-label",children:"Done"})]}),u.jsxs("div",{className:"stat-pill stat-pill-da",children:[u.jsx("span",{className:"stat-number",children:A.DA}),u.jsx("span",{className:"stat-label",children:"DA"})]}),u.jsxs("div",{className:"stat-pill stat-pill-arr",children:[u.jsx("span",{className:"stat-number",children:A.ARR}),u.jsx("span",{className:"stat-label",children:"ARR"})]})]})]}),u.jsxs("div",{className:"day-panel-actions",children:[u.jsx("div",{className:"primary-actions",children:E?u.jsxs("button",{className:"btn btn-danger btn-modern",onClick:P,disabled:p,children:[u.jsx("span",{className:"btn-icon",children:p?"⏳":"⏹️"}),p?"Ending Day...":"End Day"]}):u.jsxs("button",{className:"btn btn-primary btn-modern",onClick:n,children:[u.jsx("span",{className:"btn-icon",children:"▶️"}),"Start Day"]})}),u.jsxs("div",{className:"edit-actions",children:[H?u.jsxs("div",{className:"day-edit-group",children:[u.jsx("input",{id:"start-date",name:"startDate",type:"date",className:"input input-sm",value:B,onChange:F=>I(F.target.value),autoComplete:"off"}),u.jsx("input",{id:"start-time",name:"startTime",type:"time",className:"input input-sm",value:ee,onChange:F=>re(F.target.value),autoComplete:"off"}),u.jsx("button",{className:"btn btn-primary btn-sm",onClick:ye,children:"💾"}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>J(!1),children:"✕"})]}):u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>J(!0),title:"Edit today's start time",children:"✏️ Edit start"}),he?u.jsxs("div",{className:"day-edit-group",children:[u.jsx("input",{id:"end-date",name:"endDate",type:"date",className:"input input-sm",value:Ee,onChange:F=>je(F.target.value),autoComplete:"off"}),u.jsx("input",{id:"end-time",name:"endTime",type:"time",className:"input input-sm",value:fe,onChange:F=>ue(F.target.value),autoComplete:"off"}),u.jsx("button",{className:"btn btn-primary btn-sm",onClick:O,children:"💾"}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(!1),children:"✕"})]}):u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ce(!0),title:"Edit today's finish time",children:"✏️ Edit finish"})]})]}),u.jsx(Dp,{isOpen:p,onClose:()=>{console.warn("Emergency backup escape triggered by user"),y()},title:"Backing up data",showCloseButton:!0,size:"sm",children:u.jsx("div",{className:"backup-loading-modal",children:u.jsxs("div",{className:"backup-loading-content",children:[u.jsx(rC,{size:"lg"}),u.jsx("h3",{className:"backup-loading-title",children:"Backing up data, please wait..."}),u.jsx("p",{className:"backup-loading-message",children:"This usually takes 5-15 seconds. If stuck for more than 20 seconds, you can close this dialog to continue."}),u.jsx("div",{className:"backup-loading-warning",style:{marginTop:"1rem",fontSize:"0.9rem",color:"var(--warning)",textAlign:"center"},children:"⚠️ If backup appears stuck, click the ✕ button to escape"})]})})})]})},OC=Z.memo(jC),RC=function({state:t,onAddArrangement:r,onUpdateArrangement:n,onDeleteArrangement:a,onAddAddress:s,onComplete:l,autoCreateForAddress:d,onAutoCreateHandled:m}){const[p,g]=Z.useState("thisWeek"),[y,_]=Z.useState(!1),[T,S]=Z.useState(null),[w,E]=Z.useState({saving:!1,updating:!1,deleting:new Set,markingPaid:new Set,markingDefaulted:new Set,sendingReminder:new Set}),[P,D]=Z.useState(new Set),A=fe=>{if(!fe)return"";let ue=fe.replace(/[^\d+]/g,"");return ue.startsWith("0")||ue.startsWith("+44")||ue.startsWith("44")?ue:ue.length===10&&ue.startsWith("7")?"0"+ue:ue},H=async fe=>{if(!fe.phoneNumber){alert("No phone number available for this arrangement.");return}E(ue=>({...ue,sendingReminder:new Set([...ue.sendingReminder,fe.id])}));try{const ue={id:"temp",arrangementId:fe.id,type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},O=Uy(fe,ue,t.reminderSettings),M=`sms:${A(fe.phoneNumber)}?body=${encodeURIComponent(O)}`;window.location.href=M;const ie=new Date().toISOString();await n(fe.id,{lastReminderSent:ie,reminderCount:(fe.reminderCount||0)+1,updatedAt:ie}),D(Y=>new Set([...Y,fe.id])),setTimeout(()=>{D(Y=>{const R=new Set(Y);return R.delete(fe.id),R})},3e3)}catch(ue){console.error("Failed to send reminder:",ue),alert("Failed to update reminder information. Please try again.")}finally{E(ue=>({...ue,sendingReminder:new Set([...ue.sendingReminder].filter(O=>O!==fe.id))}))}};Z.useEffect(()=>{d!=null&&(_(!0),m?.())},[d,m]);const J=Z.useMemo(()=>{const fe=new Date,ue=Ac(fe,{weekStartsOn:1}),O=oS(fe,{weekStartsOn:1});let F=t.arrangements;return p==="thisWeek"?F=t.arrangements.filter(M=>{const ie=Ra(M.scheduledDate);return l2(ie,{start:ue,end:O})&&M.status!=="Completed"&&M.status!=="Cancelled"}):F=t.arrangements.filter(M=>M.status!=="Completed"&&M.status!=="Cancelled"),F.sort((M,ie)=>{const Y=Ra(M.scheduledDate).getTime(),R=Ra(ie.scheduledDate).getTime();if(Y!==R)return Y-R;const z=M.scheduledTime||"00:00",U=ie.scheduledTime||"00:00";return z.localeCompare(U)})},[t.arrangements,p]),B=Z.useMemo(()=>{const fe=new Map;return J.forEach(ue=>{const O=ue.scheduledDate;fe.has(O)||fe.set(O,[]),fe.get(O).push(ue)}),Array.from(fe.entries()).sort((ue,O)=>ue[0].localeCompare(O[0]))},[J]),I=Z.useMemo(()=>{const fe=J.length,ue=new Date().toISOString().slice(0,10),O=J.filter(ie=>ie.scheduledDate===ue).length,F=J.filter(ie=>{const Y=Ra(ie.scheduledDate);return o2(Y)&&ie.status==="Scheduled"}).length,M=J.reduce((ie,Y)=>{if(Y.amount&&Y.status!=="Completed"){const R=parseFloat(Y.amount);return ie+(isNaN(R)?0:R)}return ie},0);return{total:fe,todayCount:O,overdue:F,totalAmountDue:M}},[J]),ee=fe=>{switch(fe){case"Scheduled":return"📅";case"Confirmed":return"✅";case"Completed":return"🎉";case"Cancelled":return"❌";case"Missed":return"⚠️"}},re=fe=>{const ue=Ra(fe),O=new Date,F=Ep(O,1);return kx(ue,O)?"Today":kx(ue,F)?"Tomorrow":fh(ue,"EEEE, d MMM yyyy")},ye=(fe,ue,O=1)=>{const F=new Date(fe);switch(ue){case"weekly":F.setDate(F.getDate()+7*O);break;case"biweekly":F.setDate(F.getDate()+14);break;case"monthly":F.setMonth(F.getMonth()+O);break;default:return fe}return F.toISOString().slice(0,10)},he=async fe=>{const ue=t.arrangements.find(O=>O.id===fe);ue&&(n(fe,{status:"Completed",updatedAt:new Date().toISOString()}),l(ue.addressIndex,"Done",void 0,ue.id))},ce=async(fe,ue)=>{const O=t.arrangements.find(Y=>Y.id===fe);if(!O)return;const F=(O.paymentsMade||0)+1,M=F>=(O.totalPayments||1),ie=O.recurrenceType&&O.recurrenceType!=="none";if(n(fe,{status:"Completed",amount:ue,paymentsMade:F,updatedAt:new Date().toISOString()}),l(O.addressIndex,"PIF",ue,O.id),ie&&!M){const Y=ye(O.scheduledDate,O.recurrenceType,O.recurrenceInterval||1),R=F+1,z={addressIndex:O.addressIndex,address:O.address,customerName:O.customerName,phoneNumber:O.phoneNumber,scheduledDate:Y,scheduledTime:O.scheduledTime,status:"Scheduled",notes:O.notes?`${O.notes} (Payment ${R}/${O.totalPayments})`:`Payment ${R}/${O.totalPayments}`,amount:O.amount,recurrenceType:O.recurrenceType,recurrenceInterval:O.recurrenceInterval,totalPayments:O.totalPayments,paymentsMade:F,parentArrangementId:O.parentArrangementId||O.id};await r(z)}},Ee=async fe=>{E(ue=>({...ue,saving:!0}));try{if(fe.addressIndex<0||fe.addressIndex>=t.addresses.length)throw new Error("Selected address is no longer valid. Please refresh and try again.");if(fe.initialPaymentAmount&&parseFloat(fe.initialPaymentAmount)>0){const O=await r(fe);if(await new Promise(M=>setTimeout(M,100)),!t.arrangements.find(M=>M.id===O))throw new Error("Arrangement was created but not yet available. Please refresh and mark the payment manually.");await ce(O,fe.initialPaymentAmount)}else{await r(fe);try{l(fe.addressIndex,"ARR")}catch(O){console.error("Error recording ARR completion:",O),alert("Arrangement created successfully, but there was an issue recording the completion. You may need to manually mark this address as ARR.")}}_(!1),S(null)}catch(ue){console.error("Error saving arrangement:",ue),alert(`Failed to save arrangement: ${ue instanceof Error?ue.message:"Please try again."}`)}finally{E(ue=>({...ue,saving:!1}))}},je=async(fe,ue)=>{E(O=>({...O,updating:!0}));try{await n(fe,ue),S(null)}catch(O){console.error("Error updating arrangement:",O),alert("Failed to update arrangement. Please try again.")}finally{E(O=>({...O,updating:!1}))}};return u.jsxs("div",{className:"arrangements-wrap",children:[u.jsxs("div",{className:"top-row",children:[u.jsxs("div",{className:"stat-item",children:[u.jsx("div",{className:"stat-label",children:"📋 Due"}),u.jsx("div",{className:"stat-value",children:I.total})]}),u.jsxs("div",{className:"stat-item",children:[u.jsx("div",{className:"stat-label",children:"📅 Today"}),u.jsx("div",{className:"stat-value",style:{color:I.todayCount>0?"var(--warning)":"var(--text-primary)"},children:I.todayCount})]}),I.overdue>0&&u.jsxs("div",{className:"stat-item",children:[u.jsx("div",{className:"stat-label",children:"⚠️ Overdue"}),u.jsx("div",{className:"stat-value",style:{color:"var(--danger)"},children:I.overdue})]}),I.totalAmountDue>0&&u.jsxs("div",{className:"stat-item",children:[u.jsx("div",{className:"stat-label",children:"💰 Total Due"}),u.jsxs("div",{className:"stat-value",style:{color:"var(--success)"},children:["£",I.totalAmountDue.toFixed(2)]})]}),u.jsx("div",{className:"stat-actions",children:u.jsxs("div",{className:"btn-group",children:[u.jsx("button",{className:`btn ${p==="thisWeek"?"btn-primary":"btn-ghost"}`,onClick:()=>g("thisWeek"),children:"📅 This Week"}),u.jsx("button",{className:`btn ${p==="all"?"btn-primary":"btn-ghost"}`,onClick:()=>g("all"),children:"📋 All Pending"}),u.jsx("button",{className:"btn btn-success",onClick:()=>_(!0),children:"➕ Add Arrangement"})]})})]}),(y||T)&&u.jsx(Fp,{state:t,arrangement:T?t.arrangements.find(fe=>fe.id===T):void 0,preSelectedAddressIndex:d,onAddAddress:s,onSave:T?fe=>je(T,fe):Ee,onCancel:()=>{_(!1),S(null)},isLoading:w.saving||w.updating,onComplete:l,fullscreen:!0}),u.jsx("div",{className:"days-list",children:B.length===0?u.jsxs("div",{className:"empty-box",children:[u.jsxs("div",{style:{fontSize:"1.125rem",marginBottom:"0.5rem"},children:["📅 No payment arrangements ",p==="thisWeek"?"due this week":"pending"]}),u.jsx("div",{style:{fontSize:"0.875rem",opacity:.75},children:p==="thisWeek"?"No payment arrangements are scheduled for this week":"No pending payment arrangements found"})]}):B.map(([fe,ue])=>u.jsxs("div",{className:"day-card fade-in-up",children:[u.jsx("div",{className:"day-header",children:u.jsxs("div",{children:[u.jsx("div",{className:"day-title",children:re(fe)}),u.jsxs("div",{className:"muted",children:[ue.length," payment",ue.length===1?"":"s"," due",ue.some(O=>O.amount)&&u.jsxs(u.Fragment,{children:[" • £",ue.reduce((O,F)=>{const M=parseFloat(F.amount||"0");return O+(isNaN(M)?0:M)},0).toFixed(2)," total"]})]})]})}),u.jsx("div",{className:"arrangements-list",children:ue.map(O=>u.jsxs("div",{className:"arrangement-card-modern",children:[u.jsxs("div",{className:"arrangement-card-header",children:[u.jsxs("div",{className:"arrangement-primary-info",children:[u.jsxs("div",{className:"arrangement-address-modern",children:[u.jsxs("span",{className:"address-index",children:["#",O.addressIndex+1]}),u.jsx("span",{className:"address-text",children:O.address})]}),O.customerName&&u.jsxs("div",{className:"arrangement-customer-modern",children:[u.jsx("span",{className:"customer-icon",children:"👤"}),u.jsx("span",{className:"customer-name",children:O.customerName})]})]}),u.jsx("div",{className:"arrangement-status-modern",children:u.jsxs("span",{className:`status-badge-modern status-${O.status.toLowerCase()}`,children:[u.jsx("span",{className:"status-icon",children:ee(O.status)}),u.jsx("span",{className:"status-text",children:O.status})]})})]}),u.jsx("div",{className:"arrangement-card-body",children:u.jsxs("div",{className:"arrangement-details-grid",children:[u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:"📅"}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Date"}),u.jsx("span",{className:"detail-value",children:O.scheduledDate})]})]}),O.scheduledTime&&u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:"🕐"}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Time"}),u.jsx("span",{className:"detail-value",children:O.scheduledTime})]})]}),O.amount&&u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:"💰"}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Amount"}),u.jsxs("span",{className:"detail-value amount-value",children:["£",O.amount]})]})]}),O.phoneNumber&&u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:"📞"}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Phone"}),u.jsx("a",{href:`tel:${O.phoneNumber}`,className:"detail-value phone-link",children:O.phoneNumber})]})]}),O.notes&&u.jsxs("div",{className:"detail-item detail-notes",children:[u.jsx("span",{className:"detail-icon",children:"📝"}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Notes"}),u.jsx("span",{className:"detail-value",children:O.notes})]})]}),O.recurrenceType&&O.recurrenceType!=="none"&&u.jsxs("div",{className:"detail-item",children:[u.jsx("span",{className:"detail-icon",children:"🔄"}),u.jsxs("div",{className:"detail-content",children:[u.jsx("span",{className:"detail-label",children:"Recurrence"}),u.jsxs("span",{className:"detail-value",children:[O.recurrenceType==="weekly"?"Weekly":O.recurrenceType==="biweekly"?"Bi-weekly":O.recurrenceType==="monthly"?"Monthly":O.recurrenceType,O.recurrenceInterval&&O.recurrenceInterval>1&&O.recurrenceType!=="biweekly"&&` (every ${O.recurrenceInterval})`,u.jsxs("div",{className:"recurrence-progress",children:["Payment ",(O.paymentsMade||0)+1," of ",O.totalPayments||1]})]})]})]})]})}),u.jsxs("div",{className:"arrangement-actions",children:[O.status==="Scheduled"&&(!O.recurrenceType||O.recurrenceType==="none"||O.paymentsMade&&O.totalPayments&&O.paymentsMade>=O.totalPayments-1)&&u.jsx(is,{className:"btn btn-sm btn-success",isLoading:w.markingPaid.has(O.id),loadingText:"Processing...",onClick:async()=>{const F=window.prompt(`Payment received:

Expected: £${O.amount||"0.00"}
Enter actual amount received:`,O.amount||"");if(F!==null&&F.trim()){E(M=>({...M,markingPaid:new Set([...M.markingPaid,O.id])}));try{await ce(O.id,F.trim())}finally{E(M=>({...M,markingPaid:new Set([...M.markingPaid].filter(ie=>ie!==O.id))}))}}},children:"✅ Confirm Payment"}),(O.status==="Scheduled"||O.status==="Confirmed")&&u.jsxs(u.Fragment,{children:[O.phoneNumber&&u.jsxs("div",{style:{position:"relative"},children:[u.jsx(is,{className:"btn btn-sm btn-primary",isLoading:w.sendingReminder.has(O.id),loadingText:"Opening...",onClick:()=>H(O),title:`Send SMS reminder to ${O.phoneNumber}`,children:"📱 Send SMS"}),P.has(O.id)&&u.jsx("div",{className:"reminder-confirmation",style:{position:"absolute",top:"-35px",left:"0",padding:"4px 8px",borderRadius:"4px",fontSize:"12px",whiteSpace:"nowrap",zIndex:1e3,boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:"✅ SMS opened!"}),O.reminderCount&&O.reminderCount>0&&u.jsxs("div",{className:"reminder-history",children:[O.reminderCount," SMS reminder",O.reminderCount>1?"s":""," sent",O.lastReminderSent&&u.jsxs("span",{children:[" • Last: ",fh(Ra(O.lastReminderSent),"MMM d, HH:mm")]})]})]}),O.recurrenceType&&O.recurrenceType!=="none"&&(!O.paymentsMade||!O.totalPayments||O.paymentsMade<O.totalPayments-1)&&u.jsx(is,{className:"btn btn-sm btn-success",isLoading:w.markingPaid.has(O.id),loadingText:"Processing...",onClick:async()=>{const F=window.prompt(`Continue with payment plan:

Expected: £${O.amount||"0.00"}
Enter actual amount received:`,O.amount||"");if(F!==null&&F.trim()){E(M=>({...M,markingPaid:new Set([...M.markingPaid,O.id])}));try{await ce(O.id,F.trim())}finally{E(M=>({...M,markingPaid:new Set([...M.markingPaid].filter(ie=>ie!==O.id))}))}}},children:"✅ Continue Plan"}),u.jsx(is,{className:"btn btn-sm btn-warning",isLoading:w.markingDefaulted.has(O.id),loadingText:"Processing...",onClick:async()=>{if(confirm("Mark this arrangement as defaulted? This will complete the case as 'Done (Defaulted Arrangement)'.")){E(F=>({...F,markingDefaulted:new Set([...F.markingDefaulted,O.id])}));try{await he(O.id)}finally{E(F=>({...F,markingDefaulted:new Set([...F.markingDefaulted].filter(M=>M!==O.id))}))}}},children:"❌ Defaulted"})]}),u.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>S(O.id),disabled:w.updating||w.saving,children:"✏️ Edit"}),u.jsx(is,{className:"btn btn-sm btn-danger",isLoading:w.deleting.has(O.id),loadingText:"Deleting...",onClick:async()=>{if(confirm("Are you sure you want to delete this arrangement?")){E(F=>({...F,deleting:new Set([...F.deleting,O.id])}));try{await a(O.id)}finally{E(F=>({...F,deleting:new Set([...F.deleting].filter(M=>M!==O.id))}))}}},children:"🗑️ Delete"})]})]},O.id))})]},fe))}),u.jsx("style",{children:`
        .arrangement-card-modern {
          background: linear-gradient(135deg, white 0%, var(--gray-50) 100%);
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          padding: 1.5rem;
          margin-bottom: 1rem;
          box-shadow: var(--shadow-sm);
          transition: all 0.2s ease;
          position: relative;
          overflow: hidden;
        }

        .arrangement-card-modern:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
          border-color: var(--primary-light);
        }

        .arrangement-card-modern::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 3px;
          background: linear-gradient(90deg, var(--primary) 0%, var(--success) 100%);
        }

        .arrangement-card-header {
          display: flex;
          justify-content: space-between;
          align-items: flex-start;
          margin-bottom: 1.25rem;
          gap: 1rem;
        }

        .arrangement-primary-info {
          flex: 1;
        }

        .arrangement-address-modern {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          margin-bottom: 0.5rem;
        }

        .address-index {
          background: var(--primary);
          color: white;
          font-size: 0.75rem;
          font-weight: 600;
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          min-width: 2rem;
          text-align: center;
        }

        .address-text {
          font-weight: 600;
          font-size: 1.1rem;
          color: var(--text-primary);
          line-height: 1.2;
        }

        .arrangement-customer-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.9rem;
          color: var(--text-secondary);
        }

        .customer-icon {
          font-size: 1rem;
        }

        .customer-name {
          font-weight: 500;
        }

        .arrangement-status-modern {
          flex-shrink: 0;
        }

        .status-badge-modern {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1rem;
          border-radius: var(--radius-full);
          font-size: 0.875rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          transition: all 0.2s ease;
        }

        .status-badge-modern.status-scheduled {
          background: linear-gradient(135deg, var(--blue-50) 0%, var(--blue-25) 100%);
          color: var(--blue-700);
          border: 1px solid var(--blue-200);
        }

        .status-badge-modern.status-confirmed {
          background: linear-gradient(135deg, var(--success-light) 0%, var(--success-lighter) 100%);
          color: var(--success-dark);
          border: 1px solid var(--success-border);
        }

        .status-badge-modern.status-completed {
          background: linear-gradient(135deg, var(--green-50) 0%, var(--green-25) 100%);
          color: var(--green-700);
          border: 1px solid var(--green-200);
        }

        .status-badge-modern.status-cancelled {
          background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-25) 100%);
          color: var(--gray-700);
          border: 1px solid var(--gray-200);
        }

        .status-badge-modern.status-missed {
          background: linear-gradient(135deg, var(--danger-light) 0%, var(--danger-lighter) 100%);
          color: var(--danger-dark);
          border: 1px solid var(--danger-border);
        }

        .status-icon {
          font-size: 0.875rem;
        }

        .arrangement-card-body {
          margin-bottom: 1.25rem;
        }

        .arrangement-details-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .detail-item {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          padding: 0.75rem;
          background: var(--gray-25);
          border-radius: var(--radius-md);
          transition: all 0.2s ease;
        }

        .detail-item:hover {
          background: var(--gray-50);
        }

        .detail-notes {
          grid-column: 1 / -1;
        }

        /* Dark mode styles for arrangements */
        .dark-mode .arrangement-card-modern {
          background: linear-gradient(135deg, var(--gray-100) 0%, var(--gray-200) 100%);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-card-modern:hover {
          border-color: var(--primary);
          background: linear-gradient(135deg, var(--gray-200) 0%, var(--gray-300) 100%);
        }

        .dark-mode .address-text {
          color: var(--gray-800);
        }

        .dark-mode .customer-name {
          color: var(--gray-600);
        }

        .dark-mode .detail-item {
          background: var(--gray-200);
          border-color: var(--gray-300);
        }

        .dark-mode .detail-item:hover {
          background: var(--gray-300);
        }

        .dark-mode .detail-label {
          color: var(--gray-500);
        }

        .dark-mode .detail-value {
          color: var(--gray-800);
        }

        .dark-mode .phone-link {
          color: var(--primary) !important;
        }

        .dark-mode .recurrence-progress {
          color: var(--gray-500);
        }

        .dark-mode .reminder-confirmation {
          background: var(--gray-200) !important;
          color: var(--gray-800) !important;
        }

        .dark-mode .reminder-history {
          color: var(--gray-600) !important;
        }

        /* Basic card and form styles */
        .card {
          background: white;
          border: 1px solid var(--gray-200);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          overflow: hidden;
        }

        .card-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--gray-200);
          background: var(--gray-50);
        }

        .card-body {
          padding: 1.5rem;
        }

        .form-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 1rem;
        }

        .form-group {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
        }

        .form-group-full {
          grid-column: 1 / -1;
        }

        .form-group label {
          font-weight: 600;
          color: var(--gray-700);
          font-size: 0.875rem;
        }

        .btn-row {
          display: flex;
          gap: 0.75rem;
          align-items: center;
          flex-wrap: wrap;
        }

        .btn-row-end {
          justify-content: flex-end;
        }

        .arrangements-wrap {
          max-width: none;
          width: 100%;
        }

        .top-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          margin-bottom: 2rem;
          flex-wrap: wrap;
        }

        .stat-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 0.75rem 1rem;
          background: white;
          border-radius: var(--radius-md);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          min-width: 80px;
        }

        .stat-label {
          font-size: 0.75rem;
          color: var(--gray-600);
          margin-bottom: 0.25rem;
          font-weight: 500;
        }

        .stat-value {
          font-size: 1.25rem;
          font-weight: 700;
          color: var(--gray-800);
        }

        .stat-actions {
          display: flex;
          gap: 1rem;
          align-items: center;
        }

        .days-list {
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
        }

        .day-card {
          background: white;
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--gray-200);
          overflow: hidden;
        }

        .day-header {
          padding: 1.5rem;
          background: var(--gray-50);
          border-bottom: 1px solid var(--gray-200);
        }

        .day-title {
          font-size: 1.125rem;
          font-weight: 700;
          color: var(--gray-800);
          margin-bottom: 0.25rem;
        }

        .muted {
          font-size: 0.875rem;
          color: var(--gray-500);
        }

        .arrangements-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
          padding: 1.5rem;
        }

        .empty-box {
          padding: 3rem;
          text-align: center;
          background: white;
          border-radius: var(--radius-lg);
          border: 2px dashed var(--gray-300);
          color: var(--gray-500);
        }

        .fade-in-up {
          animation: fadeInUp 0.3s ease-out;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        /* Dark mode for basic elements */
        .dark-mode .card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .card-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .form-group label {
          color: var(--gray-700);
        }

        .dark-mode .stat-item {
          background: var(--gray-100);
          border-color: var(--gray-300);
        }

        .dark-mode .stat-label {
          color: var(--gray-500);
        }

        .dark-mode .stat-value {
          color: var(--gray-800);
        }

        .dark-mode .day-card {
          background: var(--gray-100);
          border-color: var(--gray-200);
        }

        .dark-mode .day-header {
          background: var(--gray-200);
          border-bottom-color: var(--gray-300);
        }

        .dark-mode .day-title {
          color: var(--gray-800);
        }

        .dark-mode .muted {
          color: var(--gray-500);
        }

        .dark-mode .empty-box {
          background: var(--gray-100);
          border-color: var(--gray-400);
          color: var(--gray-500);
        }

        /* Dark mode button styles */
        .dark-mode .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        /* Dark mode arrangement actions */
        .dark-mode .arrangement-actions .btn {
          background: var(--gray-200);
          color: var(--gray-700);
          border-color: var(--gray-300);
        }

        .dark-mode .arrangement-actions .btn:hover {
          background: var(--gray-300);
          color: var(--gray-800);
        }

        .dark-mode .arrangement-actions .btn-success {
          background: var(--success);
          color: white;
          border-color: var(--success);
        }

        .dark-mode .arrangement-actions .btn-success:hover {
          background: var(--success-dark);
          border-color: var(--success-dark);
        }

        .dark-mode .arrangement-actions .btn-primary {
          background: var(--primary);
          color: white;
          border-color: var(--primary);
        }

        .dark-mode .arrangement-actions .btn-primary:hover {
          background: var(--primary-hover);
          border-color: var(--primary-hover);
        }

        .dark-mode .arrangement-actions .btn-warning {
          background: var(--warning);
          color: white;
          border-color: var(--warning);
        }

        .dark-mode .arrangement-actions .btn-warning:hover {
          background: var(--warning-dark);
          border-color: var(--warning-dark);
        }

        .dark-mode .arrangement-actions .btn-danger {
          background: var(--danger);
          color: white;
          border-color: var(--danger);
        }

        .dark-mode .arrangement-actions .btn-danger:hover {
          background: var(--danger-dark);
          border-color: var(--danger-dark);
        }

        .dark-mode .arrangement-actions .btn-ghost {
          background: transparent;
          color: var(--gray-600);
          border-color: var(--gray-400);
        }

        .dark-mode .arrangement-actions .btn-ghost:hover {
          background: var(--gray-200);
          color: var(--gray-800);
        }

        .detail-icon {
          font-size: 1.1rem;
          flex-shrink: 0;
          margin-top: 0.125rem;
        }

        .detail-content {
          flex: 1;
          min-width: 0;
        }

        .detail-label {
          display: block;
          font-size: 0.75rem;
          font-weight: 600;
          color: var(--text-secondary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
          margin-bottom: 0.25rem;
        }

        .detail-value {
          display: block;
          font-size: 0.9rem;
          color: var(--text-primary);
          font-weight: 500;
          word-break: break-word;
        }

        .amount-value {
          color: var(--success-dark);
          font-weight: 700;
          font-size: 1rem;
        }

        .phone-link {
          color: var(--primary) !important;
          text-decoration: none;
          transition: color 0.2s ease;
        }

        .phone-link:hover {
          color: var(--primary-dark) !important;
          text-decoration: underline;
        }

        .recurrence-progress {
          font-size: 0.8rem;
          color: var(--text-secondary);
          margin-top: 0.25rem;
          font-weight: 400;
        }

        .arrangement-actions {
          display: flex;
          gap: 0.75rem;
          flex-wrap: wrap;
          align-items: center;
          margin-top: 1.5rem;
          padding-top: 1.5rem;
          border-top: 1px solid var(--gray-200);
        }

        .dark-mode .arrangement-actions {
          border-top-color: var(--gray-300);
        }

        @media (max-width: 768px) {
          .arrangement-card-header {
            flex-direction: column;
            align-items: stretch;
          }

          .arrangement-details-grid {
            grid-template-columns: 1fr;
          }

          .detail-notes {
            grid-column: 1;
          }
        }
      `})]})},LC=Z.memo(RC);async function MC(e){const t=await e.text();return JSON.parse(t)}function BC({onAdd:e,inline:t}){const[r,n]=Z.useState(!1),[a,s]=Z.useState(""),[l,d]=Z.useState(""),[m,p]=Z.useState(""),[g,y]=Z.useState(!1),_=Z.useRef(!1),[T,S]=Z.useState(null),w=()=>{s(""),d(""),p(""),S(null)},E=async D=>{if(D?.preventDefault(),_.current)return;S(null);const A=a.trim();if(!A)return S("Address is required.");let H=null,J=null;if(l.trim()){const B=Number(l);if(Number.isNaN(B))return S("Latitude must be a number.");H=B}if(m.trim()){const B=Number(m);if(Number.isNaN(B))return S("Longitude must be a number.");J=B}_.current=!0,y(!0);try{await e({address:A,lat:H,lng:J}),w(),n(!1)}catch(B){S(B?.message||String(B))}finally{_.current=!1,y(!1)}},P=t?u.jsx("button",{type:"button",className:"btn",onClick:()=>n(!0),children:"+ Add address"}):u.jsx("button",{type:"button",onClick:()=>n(!0),"aria-label":"Add address",style:zC,className:"fab-add-address",children:"+"});return u.jsxs(u.Fragment,{children:[P,r&&h_.createPortal(u.jsx("div",{style:UC,role:"dialog","aria-modal":"true",children:u.jsxs("div",{style:$C,children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("h3",{style:{margin:0},children:"Add Address"}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>{w(),n(!1)},disabled:g,"aria-label":"Close",children:"✕"})]}),u.jsxs("form",{onSubmit:E,style:{marginTop:"0.5rem"},children:[u.jsx("label",{className:"label",htmlFor:"manual-address",children:"Address *"}),u.jsx("textarea",{id:"manual-address",value:a,onChange:D=>s(D.target.value),className:"input",rows:3,placeholder:"e.g. 10 Example St, City, POSTCODE",required:!0}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[u.jsxs("div",{style:{flex:1},children:[u.jsx("label",{className:"label",htmlFor:"manual-lat",children:"Lat (optional)"}),u.jsx("input",{id:"manual-lat",type:"text",inputMode:"decimal",value:l,onChange:D=>d(D.target.value),className:"input",placeholder:"51.5034"})]}),u.jsxs("div",{style:{flex:1},children:[u.jsx("label",{className:"label",htmlFor:"manual-lng",children:"Lng (optional)"}),u.jsx("input",{id:"manual-lng",type:"text",inputMode:"decimal",value:m,onChange:D=>p(D.target.value),className:"input",placeholder:"-0.1276"})]})]}),T&&u.jsx("div",{style:{color:"var(--danger)",fontSize:"0.875rem",marginTop:"0.5rem"},children:T}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.75rem",justifyContent:"flex-end"},children:[u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>{w(),n(!1)},disabled:g,children:"Cancel"}),u.jsx("button",{type:"submit",className:"btn",disabled:g,children:g?"Adding...":"Add"})]})]})]})}),document.body)]})}const zC={position:"fixed",right:16,bottom:"calc(16px + env(safe-area-inset-bottom, 0))",width:56,height:56,borderRadius:"50%",border:"none",background:"var(--primary)",color:"#fff",fontSize:28,lineHeight:"56px",textAlign:"center",boxShadow:"0 6px 18px rgba(0,0,0,0.18)",cursor:"pointer",zIndex:4e3},UC={position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:12,zIndex:4100},$C={width:"100%",maxWidth:520,background:"var(--surface)",borderRadius:14,padding:14,border:"1px solid var(--border-light)",boxShadow:"var(--shadow-lg)"},WC=[{id:"enforcement_pro",name:"Enforcement Pro",price:2500,currency:"GBP",features:["Route optimization for 30+ addresses","Commission tracking & reporting","Payment arrangements with SMS reminders","Daily/weekly earnings reports","Unlimited cloud sync & backup","Priority customer support"],trialDays:14}];function HC(e){const t=new Date(e),r=new Date,n=t.getTime()-r.getTime();return Math.ceil(n/(1e3*60*60*24))}function VC(e){if(!e)return!1;const t=new Date,r=new Date(e.currentPeriodEnd);return(e.status==="active"||e.status==="trial")&&r>t}function GC(e){return e?e.status==="trial":!1}function KC(e){if(!e)return!0;const t=new Date,r=new Date(e.currentPeriodEnd);return e.status==="expired"||e.status==="cancelled"||r<=t}function Rp(e){const[t,r]=Z.useState(null),[n]=Z.useState(WC),[a,s]=Z.useState(!0),[l,d]=Z.useState(null),[m,p]=Z.useState(!1),[g,y]=Z.useState(!1),_=Z.useCallback(()=>d(null),[]);Z.useEffect(()=>{(async()=>{if(!e||!Ve){p(!1);return}try{const{data:ee}=await Ve.rpc("is_owner",{user_uuid:e.id});p(ee||!1)}catch{p(!1)}})()},[e]);const T=VC(t),S=GC(t),w=KC(t),E=t?HC(t.currentPeriodEnd):0,P=m||T&&!w||g,D=Z.useCallback(async()=>{if(!e||!Ve){r(null),s(!1);return}try{s(!0),_();const{data:I,error:ee}=await Ve.from("user_subscriptions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).maybeSingle();if(ee)throw ee;const re=I?{id:I.id,userId:I.user_id,planId:I.plan_id,status:I.status,currentPeriodStart:I.current_period_start,currentPeriodEnd:I.current_period_end,trialStart:I.trial_start||void 0,trialEnd:I.trial_end||void 0,cancelledAt:I.cancelled_at||void 0,createdAt:I.created_at,updatedAt:I.updated_at,lastPaymentAt:I.last_payment_at||void 0,nextPaymentDue:I.next_payment_due||void 0}:null;r(re)}catch(I){le.error("Failed to load subscription:",I),d(I?.message||"Failed to load subscription"),r(null)}finally{s(!1)}},[e,_]),A=Z.useCallback(async()=>{if(!Ve){y(!1);return}try{const I=localStorage.getItem("navigator_trial_created"),ee=localStorage.getItem("navigator_trial_user_id");if(!I||!ee){y(!1);return}const re=parseInt(I);if((Date.now()-re)/(1e3*60*60)>25){console.log("Trial too old, clearing localStorage"),localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"),y(!1);return}const{data:he,error:ce}=await Ve.rpc("check_trial_access",{target_user_id:ee});if(ce){console.warn("Server trial access check failed:",ce),y(!1);return}console.log("Server trial access result:",he),y(he?.hasAccess||!1),he?.hasAccess||(localStorage.removeItem("navigator_trial_created"),localStorage.removeItem("navigator_trial_user_id"))}catch(I){console.warn("Server trial access check error:",I),y(!1)}},[]);Z.useEffect(()=>{e?D():(r(null),s(!1)),A()},[e,D,A]);const H=Z.useCallback(async()=>{if(!e||!Ve)throw new Error("User not authenticated");if(t)throw new Error("User already has a subscription");try{_(),s(!0);const I=n[0],ee=new Date,re=new Date(ee);re.setDate(re.getDate()+I.trialDays);const ye={user_id:e.id,plan_id:I.id,status:"trial",current_period_start:ee.toISOString(),current_period_end:re.toISOString(),trial_start:ee.toISOString(),trial_end:re.toISOString(),created_at:ee.toISOString(),updated_at:ee.toISOString()},{error:he}=await Ve.from("user_subscriptions").insert(ye);if(he)throw he;await D(),le.info("Trial started successfully")}catch(I){throw le.error("Failed to start trial:",I),d(I?.message||"Failed to start trial"),I}finally{s(!1)}},[e,t,n,_,D]),J=Z.useCallback(async I=>{if(!e||!Ve)throw new Error("User not authenticated");if(!n.find(re=>re.id===I))throw new Error("Invalid plan selected");try{_(),s(!0);const re=new Date,ye=new Date(re);ye.setMonth(ye.getMonth()+1);const he=t?{status:"active",plan_id:I,current_period_start:re.toISOString(),current_period_end:ye.toISOString(),last_payment_at:re.toISOString(),next_payment_due:ye.toISOString(),updated_at:re.toISOString()}:{user_id:e.id,plan_id:I,status:"active",current_period_start:re.toISOString(),current_period_end:ye.toISOString(),last_payment_at:re.toISOString(),next_payment_due:ye.toISOString(),created_at:re.toISOString(),updated_at:re.toISOString()};if(t){const{error:ce}=await Ve.from("user_subscriptions").update(he).eq("id",t.id);if(ce)throw ce}else{const{error:ce}=await Ve.from("user_subscriptions").insert(he);if(ce)throw ce}await D(),le.info("Subscription activated successfully")}catch(re){throw le.error("Failed to subscribe:",re),d(re?.message||"Failed to subscribe"),re}finally{s(!1)}},[e,t,n,_,D]),B=Z.useCallback(async()=>{if(!e||!Ve||!t)throw new Error("No active subscription to cancel");try{_(),s(!0);const I=new Date,ee={status:"cancelled",cancelled_at:I.toISOString(),updated_at:I.toISOString()},{error:re}=await Ve.from("user_subscriptions").update(ee).eq("id",t.id);if(re)throw re;await D(),le.info("Subscription cancelled successfully")}catch(I){throw le.error("Failed to cancel subscription:",I),d(I?.message||"Failed to cancel subscription"),I}finally{s(!1)}},[e,t,_,D]);return{subscription:t,availablePlans:n,isLoading:a,error:l,isActive:T,isTrial:S,isExpired:w,daysRemaining:E,hasAccess:P,startTrial:H,subscribe:J,cancelSubscription:B,refreshSubscription:D,clearError:_}}function E_(e){const[t,r]=Z.useState(!1),[n,a]=Z.useState(!1),[s,l]=Z.useState(null),[d,m]=Z.useState(!0),[p,g]=Z.useState(null),y=Z.useCallback(()=>g(null),[]),_=Z.useCallback(async()=>{if(!e||!Ve){r(!1),a(!1),l(null),m(!1);return}try{m(!0),y();const{data:T,error:S}=await Ve.rpc("is_admin",{user_uuid:e.id});if(S){r(!1),a(!1),l(null),m(!1);return}if(r(T||!1),T){const{data:w,error:E}=await Ve.rpc("is_owner",{user_uuid:e.id});E?console.warn("Failed to check owner status:",E):a(w||!1);const{data:P,error:D}=await Ve.from("admin_users").select("*").eq("user_id",e.id).single();D?console.warn("Failed to fetch admin user details:",D):l(P)}else a(!1),l(null)}catch(T){console.log("Admin check failed:",T.message),r(!1),a(!1),l(null)}finally{m(!1)}},[e,y]);return Z.useEffect(()=>{_()},[_]),{isAdmin:t,isOwner:n,adminUser:s,isLoading:d,error:p,refreshAdmin:_,clearError:y}}function ZC(e,t){const r=e/100;return new Intl.NumberFormat("en-GB",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:2}).format(r)}function Kf(e){return new Date(e).toLocaleDateString("en-GB",{year:"numeric",month:"long",day:"numeric"})}function YC({user:e,onClose:t}){const{subscription:r,availablePlans:n,isLoading:a,error:s,isActive:l,isTrial:d,isExpired:m,daysRemaining:p,hasAccess:g,startTrial:y,subscribe:_,cancelSubscription:T,clearError:S}=Rp(e),{isOwner:w}=E_(e),[E,P]=Z.useState(null),D=async()=>{try{P("trial"),await y()}catch{}finally{P(null)}},A=async J=>{try{P(`subscribe-${J}`),await _(J)}catch{}finally{P(null)}},H=async()=>{if(confirm("Are you sure you want to cancel your subscription? You will lose access at the end of your current billing period."))try{P("cancel"),await T()}catch{}finally{P(null)}};return a?u.jsx("div",{className:"subscription-manager",children:u.jsxs("div",{className:"subscription-loading",children:[u.jsx("div",{className:"spinner"}),u.jsx("p",{children:"Loading subscription..."})]})}):w?u.jsxs("div",{className:"subscription-manager",children:[u.jsxs("div",{className:"subscription-header",children:[u.jsx("h2",{children:"Owner Access"}),t&&u.jsx("button",{className:"close-button",onClick:t,"aria-label":"Close",children:"✕"})]}),u.jsx("div",{className:"owner-status",children:u.jsxs("div",{className:"owner-card",children:[u.jsx("div",{className:"owner-badge",children:"🔑 OWNER"}),u.jsx("h3",{children:"Unlimited Access"}),u.jsx("p",{children:"As the owner, you have unrestricted access to all premium features:"}),u.jsx("div",{className:"owner-features",children:u.jsxs("ul",{children:[u.jsx("li",{children:"✓ Route optimization for unlimited addresses"}),u.jsx("li",{children:"✓ Commission tracking & reporting"}),u.jsx("li",{children:"✓ Payment arrangements with SMS reminders"}),u.jsx("li",{children:"✓ Daily/weekly earnings reports"}),u.jsx("li",{children:"✓ Unlimited cloud sync & backup"}),u.jsx("li",{children:"✓ Admin dashboard and user management"}),u.jsx("li",{children:"✓ Priority customer support tools"})]})}),u.jsxs("div",{className:"owner-info",children:[u.jsx("h4",{children:"Business Status"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Plan:"})," Owner Access (No subscription required)"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Status:"})," ",u.jsx("span",{className:"status-active",children:"Active"})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Billing:"})," N/A - Owner account"]})]}),u.jsxs("div",{className:"owner-actions",children:[u.jsx("p",{children:u.jsx("strong",{children:"Need to manage customer subscriptions?"})}),u.jsx("button",{className:"btn-secondary",onClick:t,style:{marginRight:"8px"},children:"Close"}),u.jsx("button",{className:"btn-primary",onClick:()=>{console.log("Redirect to admin dashboard"),t&&t()},children:"Go to Admin Dashboard"})]})]})})]}):u.jsxs("div",{className:"subscription-manager",children:[u.jsxs("div",{className:"subscription-header",children:[u.jsx("h2",{children:"Subscription Management"}),t&&u.jsx("button",{className:"close-button",onClick:t,"aria-label":"Close",children:"✕"})]}),s&&u.jsxs("div",{className:"error-banner",children:[u.jsx("p",{children:s}),u.jsx("button",{onClick:S,children:"Dismiss"})]}),r?u.jsxs("div",{className:"current-subscription",children:[u.jsx("h3",{children:"Current Subscription"}),u.jsxs("div",{className:"subscription-card",children:[u.jsxs("div",{className:"subscription-info",children:[u.jsx("div",{className:"plan-name",children:n.find(J=>J.id===r.planId)?.name||"Unknown Plan"}),u.jsxs("div",{className:"subscription-status",children:[u.jsx("span",{className:`status-badge ${r.status}`,children:r.status.charAt(0).toUpperCase()+r.status.slice(1)}),d&&u.jsx("span",{className:"trial-badge",children:p>0?`${p} days remaining`:"Trial expired"})]})]}),u.jsxs("div",{className:"subscription-details",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Current Period:"})," ",Kf(r.currentPeriodStart)," - ",Kf(r.currentPeriodEnd)]}),r.nextPaymentDue&&l&&!d&&u.jsxs("p",{children:[u.jsx("strong",{children:"Next Payment:"})," ",Kf(r.nextPaymentDue)]}),r.cancelledAt&&u.jsxs("p",{children:[u.jsx("strong",{children:"Cancelled:"})," ",Kf(r.cancelledAt)]})]}),g&&u.jsxs("div",{className:"subscription-features",children:[u.jsx("h4",{children:"Your Features:"}),u.jsx("ul",{children:n.find(J=>J.id===r.planId)?.features.map((J,B)=>u.jsxs("li",{children:["✓ ",J]},B))})]}),u.jsxs("div",{className:"subscription-actions",children:[d&&p>0&&u.jsx("button",{className:"btn-primary",onClick:()=>A(r.planId),disabled:E!==null,children:E===`subscribe-${r.planId}`?"Processing...":"Upgrade to Paid"}),l&&!d&&u.jsx("button",{className:"btn-secondary",onClick:H,disabled:E!==null,children:E==="cancel"?"Processing...":"Cancel Subscription"})]})]})]}):u.jsxs("div",{className:"available-plans",children:[u.jsx("h3",{children:"Choose Your Plan"}),u.jsx("p",{className:"plans-intro",children:"Transform your enforcement work with our unified platform. Replace multiple expensive apps with one powerful solution."}),n.map(J=>u.jsxs("div",{className:"plan-card featured",children:[u.jsxs("div",{className:"plan-header",children:[u.jsx("h4",{children:J.name}),u.jsxs("div",{className:"plan-price",children:[u.jsx("span",{className:"price",children:ZC(J.price,J.currency)}),u.jsx("span",{className:"period",children:"/month"})]})]}),u.jsx("div",{className:"plan-features",children:u.jsx("ul",{children:J.features.map((B,I)=>u.jsxs("li",{children:["✓ ",B]},I))})}),u.jsxs("div",{className:"plan-actions",children:[u.jsx("button",{className:"btn-primary full-width",onClick:D,disabled:E!==null,children:E==="trial"?"Starting Trial...":`Start ${J.trialDays}-Day Free Trial`}),u.jsx("p",{className:"trial-note",children:"No payment required • Cancel anytime • Full access during trial"})]})]},J.id)),u.jsxs("div",{className:"value-proposition",children:[u.jsx("h4",{children:"Why Enforcement Pro?"}),u.jsxs("div",{className:"comparison",children:[u.jsxs("div",{className:"comparison-item",children:[u.jsx("span",{className:"old-cost",children:"Route Planning App: £20-30/month"}),u.jsx("span",{className:"new-cost",children:"✓ Included"})]}),u.jsxs("div",{className:"comparison-item",children:[u.jsx("span",{className:"old-cost",children:"SMS Service: £10-15/month"}),u.jsx("span",{className:"new-cost",children:"✓ Included"})]}),u.jsxs("div",{className:"comparison-item",children:[u.jsx("span",{className:"old-cost",children:"Basic Tracking: £10-20/month"}),u.jsx("span",{className:"new-cost",children:"✓ Included"})]}),u.jsx("div",{className:"total-savings",children:u.jsx("strong",{children:"Total Monthly Savings: £15-40"})})]})]})]}),m&&u.jsxs("div",{className:"access-warning",children:[u.jsx("h4",{children:"⚠️ Subscription Expired"}),u.jsx("p",{children:"Your subscription has expired. Please renew to continue using premium features."}),u.jsx("button",{className:"btn-primary",onClick:()=>n[0]&&A(n[0].id),disabled:E!==null,children:"Renew Subscription"})]})]})}const qC=`
.subscription-manager {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  color: var(--text-color, #000);
}

.subscription-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  border-bottom: 1px solid var(--border-color, #e1e5e9);
  padding-bottom: 16px;
}

.subscription-header h2 {
  color: var(--text-color, #000);
  margin: 0;
}

.close-button {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  color: var(--text-color, #000);
}

.close-button:hover {
  background-color: var(--hover-bg, #f5f5f5);
}

.dark-mode .close-button:hover {
  background-color: var(--dark-hover-bg, #333);
}

.subscription-loading {
  text-align: center;
  padding: 40px;
  color: var(--text-color, #000);
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid var(--border-color, #f3f3f3);
  border-top: 4px solid #007bff;
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 16px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.error-banner {
  background-color: var(--error-bg, #fee);
  border: 1px solid var(--error-border, #fcc);
  border-radius: 4px;
  padding: 12px;
  margin-bottom: 16px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  color: var(--error-text, #721c24);
}

.dark-mode .error-banner {
  background-color: var(--dark-error-bg, #4a1a1a);
  border-color: var(--dark-error-border, #8b2635);
  color: var(--dark-error-text, #ff6b6b);
}

.current-subscription, .available-plans {
  margin-bottom: 24px;
}

.current-subscription h3, .available-plans h3 {
  color: var(--text-color, #000);
  margin-bottom: 16px;
}

.subscription-card, .plan-card {
  border: 1px solid var(--border-color, #e1e5e9);
  border-radius: 8px;
  padding: 20px;
  margin-bottom: 16px;
  background-color: var(--card-bg, #fff);
  color: var(--text-color, #000);
}

.dark-mode .subscription-card,
.dark-mode .plan-card {
  background-color: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.plan-card.featured {
  border-color: #007bff;
  position: relative;
  margin-top: 16px;
}

.plan-card.featured::before {
  content: 'Most Popular';
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  background: #007bff;
  color: white;
  padding: 6px 16px;
  font-size: 12px;
  font-weight: 600;
  border-radius: 16px;
  white-space: nowrap;
}

.status-badge {
  display: inline-block;
  padding: 4px 8px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  text-transform: uppercase;
}

.status-badge.active { background: #d4edda; color: #155724; }
.status-badge.trial { background: #fff3cd; color: #856404; }
.status-badge.expired { background: #f8d7da; color: #721c24; }
.status-badge.cancelled { background: #e2e3e5; color: #6c757d; }

.trial-badge {
  margin-left: 8px;
  padding: 4px 8px;
  background: #e3f2fd;
  color: #1976d2;
  border-radius: 4px;
  font-size: 12px;
}

.dark-mode .trial-badge {
  background: var(--dark-secondary-bg, #2a4a5c);
  color: var(--dark-secondary-text, #87ceeb);
  border: 1px solid var(--dark-border-color, #444);
}

.plan-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 16px;
}

.plan-header h4 {
  color: var(--text-color, #000);
  margin: 0;
}

.plan-price .price {
  font-size: 24px;
  font-weight: bold;
  color: #007bff;
}

.plan-price .period {
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
}

.dark-mode .plan-price .period {
  color: var(--dark-secondary-text, #aaa);
}

.plan-features ul {
  list-style: none;
  padding: 0;
  margin: 16px 0;
}

.plan-features li {
  padding: 4px 0;
  color: #28a745;
}

.subscription-info .plan-name {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-color, #000);
  margin-bottom: 8px;
}

.subscription-details {
  margin: 16px 0;
  color: var(--text-color, #000);
}

.subscription-details p {
  margin: 8px 0;
  color: var(--text-color, #000);
}

.subscription-details strong {
  color: var(--text-color, #000);
}

.subscription-features h4 {
  color: var(--text-color, #000);
  margin: 16px 0 8px 0;
}

.subscription-actions, .plan-actions {
  margin-top: 20px;
}

.btn-primary, .btn-secondary {
  padding: 10px 20px;
  border-radius: 6px;
  border: none;
  font-weight: 500;
  cursor: pointer;
  margin-right: 8px;
  transition: background-color 0.2s;
}

.btn-primary {
  background: #007bff;
  color: white;
}

.btn-primary:hover:not(:disabled) {
  background: #0056b3;
}

.btn-secondary {
  background: #6c757d;
  color: white;
}

.btn-secondary:hover:not(:disabled) {
  background: #545b62;
}

.btn-primary:disabled, .btn-secondary:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.full-width {
  width: 100%;
  margin-right: 0;
}

.trial-note {
  text-align: center;
  color: var(--secondary-text, #6c757d);
  font-size: 14px;
  margin-top: 8px;
}

.dark-mode .trial-note {
  color: var(--dark-secondary-text, #aaa);
}

.comparison {
  background: var(--secondary-bg, #f8f9fa);
  padding: 16px;
  border-radius: 6px;
  margin-top: 12px;
  color: var(--text-color, #000);
}

.dark-mode .comparison {
  background: var(--dark-secondary-bg, #333);
}

.comparison-item {
  display: flex;
  justify-content: space-between;
  padding: 4px 0;
}

.old-cost {
  color: var(--secondary-text, #6c757d);
  text-decoration: line-through;
}

.dark-mode .old-cost {
  color: var(--dark-secondary-text, #aaa);
}

.new-cost {
  color: #28a745;
  font-weight: 500;
}

.total-savings {
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--border-color, #dee2e6);
  text-align: center;
  color: #007bff;
}

.dark-mode .total-savings {
  border-top-color: var(--dark-border-color, #555);
}

.access-warning {
  background: var(--warning-bg, #fff3cd);
  border: 1px solid var(--warning-border, #ffeaa7);
  border-radius: 6px;
  padding: 16px;
  text-align: center;
  color: var(--warning-text, #856404);
}

.dark-mode .access-warning {
  background: var(--dark-warning-bg, #4a3c1a);
  border-color: var(--dark-warning-border, #8b7355);
  color: var(--dark-warning-text, #ffc107);
}

.access-warning h4 {
  color: var(--warning-text, #856404);
  margin: 0 0 8px 0;
}

.dark-mode .access-warning h4 {
  color: var(--dark-warning-text, #ffc107);
}

.value-proposition h4 {
  color: var(--text-color, #000);
  margin: 16px 0 12px 0;
}

.plans-intro {
  color: var(--text-color, #000);
  margin-bottom: 20px;
}

.owner-status {
  margin-bottom: 24px;
}

.owner-card {
  border: 2px solid #28a745;
  border-radius: 12px;
  padding: 24px;
  background: linear-gradient(135deg, #f8fff9 0%, #e8f5e8 100%);
  text-align: center;
}

.owner-badge {
  display: inline-block;
  background: #28a745;
  color: white;
  padding: 8px 16px;
  border-radius: 20px;
  font-size: 14px;
  font-weight: 700;
  margin-bottom: 16px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.owner-features {
  margin: 20px 0;
  text-align: left;
}

.owner-features ul {
  list-style: none;
  padding: 0;
  max-width: 400px;
  margin: 0 auto;
}

.owner-features li {
  padding: 6px 0;
  color: #28a745;
  font-weight: 500;
}

.owner-info {
  background: var(--card-bg, white);
  border-radius: 8px;
  padding: 16px;
  margin: 20px 0;
  border: 1px solid #d4edda;
  color: var(--text-color, #000);
}

.dark-mode .owner-info {
  background: var(--dark-card-bg, #2a2a2a);
  border-color: var(--dark-border-color, #444);
}

.owner-info h4 {
  margin: 0 0 12px 0;
  color: #28a745;
}

.owner-info p {
  margin: 8px 0;
  text-align: left;
  color: var(--text-color, #000);
}

.status-active {
  color: #28a745;
  font-weight: 600;
}

.owner-actions {
  margin-top: 24px;
}

.owner-actions p {
  margin-bottom: 16px;
  font-weight: 500;
  color: var(--text-color, #000);
}

.owner-card h3 {
  color: var(--text-color, #000);
  margin: 0 0 16px 0;
}

.owner-card p {
  color: var(--text-color, #000);
}

.dark-mode .owner-card {
  background: linear-gradient(135deg, #2a4a2a 0%, #1a3a1a 100%);
}
`;if(typeof document<"u"){const e=document.createElement("style");e.textContent=qC,document.head.appendChild(e)}const XC=function({user:t,onClose:r}){const[n,a]=Z.useState(null),[s,l]=Z.useState([]),[d,m]=Z.useState([]),[p,g]=Z.useState([]),[y,_]=Z.useState(!0),[T,S]=Z.useState(null),[w,E]=Z.useState("subscriptions"),[P,D]=Z.useState(""),[A,H]=Z.useState(1),[J,B]=Z.useState(7),[I,ee]=Z.useState(""),[re,ye]=Z.useState(null);Z.useEffect(()=>{he()},[t]);const he=async()=>{if(!(!t||!Ve))try{_(!0),S(null);const{data:O,error:F}=await Ve.rpc("is_admin",{user_uuid:t.id});if(F)throw console.error("Admin check error:",F),F;if(!O)throw new Error("Access denied: Admin privileges required");const{data:M,error:ie}=await Ve.from("admin_users").select("*").eq("user_id",t.id).single();if(ie)throw ie;a(M);const{data:Y,error:R}=await Ve.rpc("get_admin_subscription_overview");if(R)throw console.error("Subscription overview error:",R),R;l(Y||[]);let z=[];try{const{data:ae,error:oe}=await Ve.from("admin_actions").select(`
            id,
            action_type,
            target_user_id,
            performed_at,
            details,
            admin_users!inner(email)
          `).order("performed_at",{ascending:!1}).limit(20);oe?(console.warn("Admin actions table not found or error:",oe),z=[]):z=ae||[]}catch(ae){console.warn("Failed to load admin actions:",ae),z=[]}const U=(z||[]).map(ae=>({...ae,admin_email:ae.admin_users?.email||(Array.isArray(ae.admin_users)?ae.admin_users[0]?.email:null)}));m(U);const{data:te,error:W}=await Ve.from("admin_upcoming_deletions").select("*").order("deletion_scheduled_for",{ascending:!0});W?console.warn("Failed to load upcoming deletions:",W):g(te||[])}catch(O){S(O.message||"Failed to load admin data")}finally{_(!1)}},ce=async()=>{if(!(!P||!Ve))try{ye("grant");const{error:O}=await Ve.rpc("admin_grant_subscription",{target_user_id:P,plan_id:"enforcement_pro",duration_months:A,admin_notes:I||`Granted ${A} month(s) by admin`});if(O)throw O;await he(),D(""),H(1),ee(""),alert("Subscription granted successfully!")}catch(O){alert("Failed to grant subscription: "+O.message)}finally{ye(null)}},Ee=async()=>{if(!(!P||!Ve))try{ye("extend");const{error:O}=await Ve.rpc("admin_extend_trial",{target_user_id:P,additional_days:J,admin_notes:I||`Extended trial by ${J} days`});if(O)throw O;await he(),D(""),B(7),ee(""),alert("Trial extended successfully!")}catch(O){alert("Failed to extend trial: "+O.message)}finally{ye(null)}},je=async(O,F)=>{if(!(!Ve||!confirm(`Cancel scheduled deletion for ${F}?`)))try{ye("cancel-deletion");const{error:ie}=await Ve.from("inactive_account_warnings").update({cancelled:!0,warning_acknowledged:!0}).eq("user_id",O).eq("cancelled",!1);if(ie)throw ie;await he(),alert(`Scheduled deletion cancelled for ${F}`)}catch(ie){alert("Failed to cancel deletion: "+ie.message)}finally{ye(null)}},fe=O=>O?new Date(O).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",ue=O=>{const M={active_trial:{color:"#fff3cd",label:"Active Trial"},active_paid:{color:"#d4edda",label:"Active Paid"},expired:{color:"#f8d7da",label:"Expired"},cancelled:{color:"#e2e3e5",label:"Cancelled"}}[O]||{color:"#f8f9fa",label:O};return u.jsx("span",{style:{backgroundColor:M.color,padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"500"},children:M.label})};return y?u.jsx("div",{className:"admin-dashboard",children:u.jsx("div",{className:"loading",children:"Loading admin dashboard..."})}):T?u.jsx("div",{className:"admin-dashboard",children:u.jsxs("div",{className:"error",children:[u.jsx("h3",{children:"Access Denied"}),u.jsx("p",{children:T}),r&&u.jsx("button",{onClick:r,children:"Close"})]})}):u.jsxs("div",{className:"admin-dashboard",children:[u.jsxs("div",{className:"admin-header-fixed",children:[u.jsxs("div",{className:"admin-header",children:[u.jsx("h2",{children:"Admin Dashboard"}),u.jsxs("div",{className:"admin-info",children:[u.jsxs("span",{children:["Role: ",u.jsx("strong",{children:n?.role})]}),r&&u.jsx("button",{className:"close-button",onClick:r,children:"✕"})]})]}),u.jsxs("div",{className:"admin-tabs",children:[u.jsxs("button",{className:w==="subscriptions"?"active":"",onClick:()=>E("subscriptions"),children:["Subscriptions (",s.length,")"]}),u.jsxs("button",{className:w==="actions"?"active":"",onClick:()=>E("actions"),children:["Actions (",d.length,")"]}),u.jsxs("button",{className:w==="inactive"?"active":"",onClick:()=>E("inactive"),children:["Inactive (",p.length,")"]}),u.jsx("button",{className:w==="settings"?"active":"",onClick:()=>E("settings"),children:"Settings"})]})]}),u.jsxs("div",{className:"admin-content-scrollable",children:[w==="subscriptions"&&u.jsxs("div",{className:"subscriptions-tab",children:[u.jsxs("div",{className:"stats-bar",children:[u.jsxs("div",{className:"stat",children:[u.jsx("strong",{children:s.filter(O=>O.subscription_status==="trial").length}),u.jsx("span",{children:"Active Trials"})]}),u.jsxs("div",{className:"stat",children:[u.jsx("strong",{children:s.filter(O=>O.subscription_status==="active").length}),u.jsx("span",{children:"Paid Subscriptions"})]}),u.jsxs("div",{className:"stat",children:[u.jsx("strong",{children:s.filter(O=>O.subscription_status==="expired").length}),u.jsx("span",{children:"Expired"})]}),u.jsxs("div",{className:"stat",children:[u.jsxs("strong",{children:["£",s.filter(O=>O.subscription_status==="active").length*25]}),u.jsx("span",{children:"Monthly Revenue"})]})]}),u.jsxs("div",{className:"admin-actions-panel",children:[u.jsx("h3",{children:"Admin Actions"}),u.jsxs("div",{className:"admin-form",children:[u.jsxs("div",{className:"form-row",children:[u.jsx("label",{htmlFor:"selected-user-id",children:"Select User"}),u.jsxs("select",{id:"selected-user-id",name:"selectedUserId",value:P,onChange:O=>D(O.target.value),children:[u.jsx("option",{value:"",children:"Select User..."}),s.map(O=>u.jsxs("option",{value:O.user_id,children:[O.user_email," - ",ue(O.subscription_status).props.children]},O.user_id))]})]}),u.jsxs("div",{className:"form-row",children:[u.jsx("div",{className:"action-group",children:u.jsxs("div",{className:"input-group",children:[u.jsx("label",{htmlFor:"grant-months",children:"Grant Subscription (months):"}),u.jsx("input",{id:"grant-months",name:"grantMonths",type:"number",min:"1",max:"12",value:A,onChange:O=>H(parseInt(O.target.value)||1)}),u.jsx("button",{onClick:ce,disabled:!P||re!==null,children:re==="grant"?"Granting...":"Grant"})]})}),u.jsx("div",{className:"action-group",children:u.jsxs("div",{className:"input-group",children:[u.jsx("label",{htmlFor:"extend-days",children:"Extend Trial (days):"}),u.jsx("input",{id:"extend-days",name:"extendDays",type:"number",min:"1",max:"90",value:J,onChange:O=>B(parseInt(O.target.value)||7)}),u.jsx("button",{onClick:Ee,disabled:!P||re!==null,children:re==="extend"?"Extending...":"Extend"})]})})]}),u.jsxs("div",{className:"form-row",children:[u.jsx("label",{htmlFor:"admin-notes",children:"Admin notes (optional)"}),u.jsx("textarea",{id:"admin-notes",name:"adminNotes",placeholder:"Admin notes (optional)",value:I,onChange:O=>ee(O.target.value),rows:2})]})]})]}),u.jsxs("div",{className:"subscriptions-table",children:[u.jsx("h3",{children:"All Subscriptions"}),u.jsxs("table",{children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"User Email"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Plan"}),u.jsx("th",{children:"API Requests"}),u.jsx("th",{children:"Created"}),u.jsx("th",{children:"Period End"})]})}),u.jsx("tbody",{children:s.map(O=>u.jsxs("tr",{children:[u.jsx("td",{children:O.user_email}),u.jsx("td",{children:ue(O.subscription_status)}),u.jsx("td",{children:O.subscription_plan||"No Plan"}),u.jsx("td",{children:O.total_api_requests||0}),u.jsx("td",{children:fe(O.subscription_created_at)}),u.jsx("td",{children:fe(O.current_period_end)})]},O.user_email))})]})]})]}),w==="actions"&&u.jsxs("div",{className:"actions-tab",children:[u.jsx("h3",{children:"Recent Admin Actions"}),u.jsx("div",{className:"actions-list",children:d.map(O=>u.jsxs("div",{className:"action-item",children:[u.jsxs("div",{className:"action-header",children:[u.jsx("strong",{children:O.action_type.replace("_"," ").toUpperCase()}),u.jsx("span",{className:"action-date",children:fe(O.performed_at)})]}),u.jsxs("div",{className:"action-details",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Admin:"})," ",O.admin_email]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Target User:"})," ",O.target_user_id]}),O.details&&u.jsxs("div",{className:"action-notes",children:[u.jsx("strong",{children:"Details:"}),u.jsx("pre",{children:JSON.stringify(O.details,null,2)})]})]})]},O.id))})]}),w==="inactive"&&u.jsxs("div",{className:"inactive-tab",children:[u.jsx("h3",{children:"Upcoming Account Deletions (GDPR Compliance)"}),p.length===0?u.jsx("div",{className:"no-deletions",children:u.jsx("p",{children:"No accounts scheduled for deletion. All users are active! 🎉"})}):u.jsxs("div",{className:"deletions-table",children:[u.jsxs("table",{children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{children:"User Email"}),u.jsx("th",{children:"Last Activity"}),u.jsx("th",{children:"Warning Sent"}),u.jsx("th",{children:"Deletion Date"}),u.jsx("th",{children:"Days Until"}),u.jsx("th",{children:"Status"}),u.jsx("th",{children:"Actions"})]})}),u.jsx("tbody",{children:p.map(O=>u.jsxs("tr",{children:[u.jsx("td",{children:O.user_email}),u.jsx("td",{children:fe(O.last_activity_at)}),u.jsx("td",{children:fe(O.warning_sent_at)}),u.jsx("td",{children:fe(O.deletion_scheduled_for)}),u.jsx("td",{children:u.jsxs("span",{style:{color:O.days_until_deletion<=7?"var(--danger)":"var(--text)",fontWeight:O.days_until_deletion<=7?"700":"400"},children:[O.days_until_deletion," days"]})}),u.jsx("td",{children:O.warning_acknowledged?u.jsx("span",{style:{color:"var(--primary)"},children:"Acknowledged"}):u.jsx("span",{style:{color:"var(--text-muted)"},children:"Pending"})}),u.jsx("td",{children:u.jsx("button",{className:"cancel-btn",onClick:()=>je(O.user_id,O.user_email),disabled:re!==null,style:{background:"var(--danger)",color:"white",border:"none",padding:"0.375rem 0.75rem",borderRadius:"var(--radius)",cursor:"pointer",fontSize:"0.625rem",fontWeight:"600",whiteSpace:"nowrap"},children:"Cancel Deletion"})})]},O.user_id))})]}),u.jsxs("div",{className:"deletion-info",style:{marginTop:"1rem",padding:"1rem",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",fontSize:"0.75rem",color:"var(--text-muted)"},children:[u.jsx("p",{children:u.jsx("strong",{children:"How it works:"})}),u.jsxs("ul",{style:{marginLeft:"1.5rem",marginTop:"0.5rem"},children:[u.jsx("li",{children:"Accounts inactive for 5 months receive a warning email"}),u.jsx("li",{children:"After 6 months of inactivity, account is automatically deleted"}),u.jsx("li",{children:"Users can prevent deletion by simply logging in or creating data"}),u.jsx("li",{children:"Active subscriptions are never deleted automatically"}),u.jsx("li",{children:"Admins can cancel scheduled deletions manually using the button above"})]})]})]})]}),w==="settings"&&u.jsxs("div",{className:"settings-tab",children:[u.jsx("h3",{children:"Admin Settings"}),u.jsxs("div",{className:"settings-info",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Your Role:"})," ",n?.role]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Permissions:"})," ",n?.permissions.join(", ")]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Account Created:"})," ",fe(n?.created_at||"")]})]}),u.jsxs("div",{className:"quick-stats",children:[u.jsx("h4",{children:"Quick Stats"}),u.jsxs("ul",{children:[u.jsxs("li",{children:["Total Users: ",s.length]}),u.jsxs("li",{children:["Active Trials: ",s.filter(O=>O.subscription_status==="trial").length]}),u.jsxs("li",{children:["Paid Customers: ",s.filter(O=>O.subscription_status==="active").length]}),u.jsxs("li",{children:["Monthly Revenue: £",s.filter(O=>O.subscription_status==="active").length*25]}),u.jsxs("li",{children:["Total Actions Performed: ",d.length]})]})]})]})]})]})},JC=Z.memo(XC),QC=`
/* ==== Admin Dashboard Modern Professional Styles ==== */
.admin-dashboard {
  display: flex;
  flex-direction: column;
  height: 100vh;
  background: var(--background);
  overflow: hidden;
  position: relative;
}

.admin-header-fixed {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--background);
  border-bottom: 2px solid var(--border-light);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.admin-content-scrollable {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 1.5rem;
  max-width: 1400px;
  margin: 0 auto;
  width: 100%;
  box-sizing: border-box;
}

.admin-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 1rem 1.5rem;
  background: var(--surface);
}

.admin-header h2 {
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text);
  margin: 0;
  letter-spacing: -0.02em;
}

.admin-info {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  color: var(--text-muted);
  font-size: 0.75rem;
}

.close-button {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-muted);
}

.close-button:hover {
  background: var(--background);
  color: var(--text);
}

.admin-tabs {
  display: flex;
  gap: 0;
  background: var(--background);
  padding: 0 1.5rem;
  border-bottom: 1px solid var(--border-light);
}

.admin-tabs button {
  padding: 0.875rem 1.5rem;
  border: none;
  background: transparent;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  font-weight: 600;
  color: var(--text-muted);
  transition: all 0.2s ease;
  font-size: 0.875rem;
  white-space: nowrap;
}

.admin-tabs button:hover {
  color: var(--text);
  background: var(--surface);
}

.admin-tabs button.active {
  color: var(--primary);
  border-bottom-color: var(--primary);
  background: transparent;
}

.stats-bar {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  margin-bottom: 1.5rem;
}

.stat {
  background: linear-gradient(135deg, var(--surface) 0%, var(--background) 100%);
  padding: 1.25rem;
  border-radius: 12px;
  border: 1px solid var(--border-light);
  text-align: center;
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.stat:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  border-color: var(--primary);
}

.stat strong {
  display: block;
  font-size: 2rem;
  font-weight: 800;
  color: var(--primary);
  margin-bottom: 0.5rem;
  line-height: 1;
}

.stat span {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.08em;
  line-height: 1.4;
}

.admin-actions-panel {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.admin-actions-panel h3 {
  margin: 0 0 1.25rem 0;
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--text);
  border-bottom: 2px solid var(--border-light);
  padding-bottom: 0.75rem;
}

.admin-form .form-row {
  margin-bottom: 1.25rem;
}

.admin-form .form-row:last-child {
  margin-bottom: 0;
}

.admin-form label {
  display: block;
  margin-bottom: 0.5rem;
  font-weight: 600;
  color: var(--text);
  font-size: 0.875rem;
}

.admin-form select,
.admin-form input,
.admin-form textarea {
  width: 100%;
  padding: 0.75rem;
  border: 2px solid var(--border-light);
  border-radius: 8px;
  font-size: 0.875rem;
  transition: all 0.2s ease;
  background: var(--background);
  color: var(--text);
  box-sizing: border-box;
  font-family: inherit;
}

.admin-form select:focus,
.admin-form input:focus,
.admin-form textarea:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(var(--primary-rgb, 74, 144, 226), 0.1);
}

.form-row .action-group {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  align-items: start;
}

.input-group {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  background: var(--background);
  padding: 1rem;
  border-radius: 8px;
  border: 1px solid var(--border-light);
}

.input-group label {
  margin: 0;
  font-size: 0.75rem;
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  min-width: fit-content;
}

.input-group input {
  width: 80px;
  min-width: 60px;
  padding: 0.5rem;
  text-align: center;
  font-weight: 600;
}

.input-group button {
  background: var(--primary);
  color: white;
  border: none;
  padding: 0.625rem 1.5rem;
  border-radius: 8px;
  cursor: pointer;
  font-weight: 700;
  transition: all 0.2s ease;
  font-size: 0.875rem;
  white-space: nowrap;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.input-group button:hover {
  background: var(--primary-hover);
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.input-group button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.subscriptions-table {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.subscriptions-table h3 {
  margin: 0;
  padding: 1rem 1.5rem;
  background: var(--background);
  border-bottom: 2px solid var(--border-light);
  font-size: 1.125rem;
  font-weight: 700;
  color: var(--text);
}

.subscriptions-table table {
  width: 100%;
  border-collapse: collapse;
  display: block;
  max-height: 500px;
  overflow-y: auto;
}

.subscriptions-table thead {
  display: table;
  width: 100%;
  table-layout: fixed;
  position: sticky;
  top: 0;
  z-index: 10;
}

.subscriptions-table tbody {
  display: table;
  width: 100%;
  table-layout: fixed;
}

.subscriptions-table th,
.subscriptions-table td {
  padding: 1rem 1.5rem;
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.subscriptions-table th {
  background: var(--surface);
  font-weight: 700;
  font-size: 0.75rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  white-space: nowrap;
  border-bottom: 2px solid var(--border-light);
}

.subscriptions-table td {
  font-size: 0.875rem;
  color: var(--text);
  background: var(--background);
}

.subscriptions-table tbody tr:hover td {
  background: var(--surface);
}

.actions-tab,
.inactive-tab,
.settings-tab {
  max-width: 1200px;
}

.actions-list {
  max-height: 600px;
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  padding-right: 0.5rem;
}

.action-item {
  border: 1px solid var(--border-light);
  border-radius: 12px;
  margin-bottom: 1rem;
  padding: 1.25rem;
  background: var(--surface);
  transition: all 0.3s ease;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
}

.action-item:hover {
  transform: translateX(4px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border-color: var(--primary);
}

.action-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  gap: 1rem;
  padding-bottom: 0.75rem;
  border-bottom: 1px solid var(--border-light);
}

.action-header strong {
  color: var(--primary);
  font-weight: 700;
  font-size: 0.875rem;
  flex: 1;
  text-transform: capitalize;
}

.action-date {
  color: var(--text-muted);
  font-size: 0.75rem;
  font-weight: 600;
  white-space: nowrap;
  background: var(--background);
  padding: 0.25rem 0.75rem;
  border-radius: 6px;
}

.action-details p {
  margin: 0.5rem 0;
  font-size: 0.875rem;
  color: var(--text);
  line-height: 1.6;
}

.action-notes {
  margin-top: 1rem;
}

.action-notes pre {
  background: var(--background);
  padding: 1rem;
  border-radius: 8px;
  font-size: 0.75rem;
  overflow-x: auto;
  border: 1px solid var(--border-light);
  color: var(--text);
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
}

.settings-info,
.quick-stats,
.deletions-table {
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.settings-info h4,
.quick-stats h4 {
  margin: 0 0 1rem 0;
  color: var(--text);
  font-weight: 700;
  font-size: 1.125rem;
  border-bottom: 2px solid var(--border-light);
  padding-bottom: 0.75rem;
}

.settings-info p {
  margin: 0.75rem 0;
  color: var(--text);
  font-size: 0.875rem;
  line-height: 1.6;
}

.quick-stats ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.quick-stats li {
  padding: 1rem 0;
  border-bottom: 1px solid var(--border-light);
  color: var(--text);
  display: flex;
  justify-content: space-between;
  font-size: 0.875rem;
  font-weight: 500;
  gap: 1rem;
}

.quick-stats li:last-child {
  border-bottom: none;
}

.deletions-table table {
  width: 100%;
  border-collapse: collapse;
  display: block;
  max-height: 400px;
  overflow-y: auto;
  margin-top: 1rem;
}

.deletions-table thead {
  display: table;
  width: 100%;
  table-layout: fixed;
  position: sticky;
  top: 0;
  z-index: 10;
}

.deletions-table tbody {
  display: table;
  width: 100%;
  table-layout: fixed;
}

.deletions-table th,
.deletions-table td {
  padding: 1rem;
  text-align: left;
  border-bottom: 1px solid var(--border-light);
}

.deletions-table th {
  background: var(--surface);
  font-weight: 700;
  font-size: 0.75rem;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.08em;
  border-bottom: 2px solid var(--border-light);
}

.deletions-table td {
  font-size: 0.875rem;
  color: var(--text);
  background: var(--background);
}

.deletions-table tbody tr:hover td {
  background: var(--surface);
}

.no-deletions {
  text-align: center;
  padding: 3rem 1rem;
  color: var(--text-muted);
  font-size: 1rem;
}

.loading,
.error {
  text-align: center;
  padding: 2rem 1rem;
  background: var(--surface);
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  margin: 1rem;
}

.error h3 {
  color: var(--danger);
  margin-bottom: 1rem;
  font-size: 1rem;
}

.loading {
  color: var(--text-muted);
  font-size: 0.875rem;
}

/* CSS Variables handle dark mode automatically through the app's theme system */

/* ==== Responsive Design ==== */
@media (max-width: 768px) {
  .admin-content-scrollable {
    padding: 1rem;
  }

  .admin-header {
    flex-direction: column;
    gap: 0.75rem;
    padding: 1rem;
  }

  .admin-header h2 {
    font-size: 1.25rem;
  }

  .admin-tabs {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    padding: 0 1rem;
  }

  .admin-tabs button {
    padding: 0.75rem 1rem;
    font-size: 0.8125rem;
  }

  .stats-bar {
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
  }

  .stat strong {
    font-size: 1.5rem;
  }

  .stat span {
    font-size: 0.6875rem;
  }

  .form-row .action-group {
    grid-template-columns: 1fr;
    gap: 0.75rem;
  }

  .subscriptions-table table,
  .deletions-table table {
    max-height: 400px;
  }

  .subscriptions-table th,
  .subscriptions-table td,
  .deletions-table th,
  .deletions-table td {
    padding: 0.75rem 1rem;
    font-size: 0.8125rem;
  }

  .action-item {
    padding: 1rem;
  }
}

@media (max-width: 480px) {
  .admin-content-scrollable {
    padding: 0.75rem;
  }

  .admin-header {
    padding: 0.75rem;
  }

  .admin-header h2 {
    font-size: 1.125rem;
  }

  .admin-info span {
    font-size: 0.75rem;
  }

  .admin-tabs {
    flex-wrap: nowrap;
    overflow-x: auto;
    padding: 0 0.75rem;
  }

  .admin-tabs button {
    padding: 0.625rem 0.875rem;
    font-size: 0.75rem;
  }

  .stats-bar {
    grid-template-columns: 1fr;
    gap: 0.5rem;
  }

  .stat {
    padding: 1rem;
  }

  .stat strong {
    font-size: 1.5rem;
  }

  .stat span {
    font-size: 0.6875rem;
  }

  .admin-actions-panel,
  .settings-info,
  .quick-stats,
  .deletions-table {
    padding: 1rem;
  }

  .admin-actions-panel h3,
  .settings-info h4,
  .quick-stats h4 {
    font-size: 1rem;
  }

  .input-group {
    flex-wrap: wrap;
    justify-content: space-between;
  }

  .input-group label {
    flex: 1 1 100%;
    margin-bottom: 0.5rem;
  }

  .input-group input {
    flex: 1;
  }

  .input-group button {
    flex: 1;
    min-width: 120px;
  }

  .subscriptions-table h3,
  .deletions-table h3 {
    font-size: 1rem;
    padding: 0.75rem 1rem;
  }

  .subscriptions-table th,
  .subscriptions-table td,
  .deletions-table th,
  .deletions-table td {
    padding: 0.75rem;
    font-size: 0.75rem;
  }

  .action-item {
    padding: 0.875rem;
  }

  .action-header {
    flex-direction: column;
    align-items: flex-start;
  }

  .action-date {
    align-self: flex-end;
  }

  .quick-stats li {
    font-size: 0.8125rem;
    padding: 0.75rem 0;
  }
}
`;if(typeof document<"u"&&!document.getElementById("admin-dashboard-styles")){const t=document.createElement("style");t.id="admin-dashboard-styles",t.textContent=QC,document.head.appendChild(t)}function eA({featureName:e,onUpgrade:t}){return u.jsxs("div",{className:"feature-locked",children:[u.jsx("div",{className:"lock-icon",children:"🔒"}),u.jsx("h3",{children:e}),u.jsx("p",{children:"This premium feature requires an active subscription."}),u.jsx("button",{className:"upgrade-button",onClick:t,children:"Upgrade to Enforcement Pro"})]})}function C_({user:e,fallback:t,children:r}){const{hasAccess:n,isLoading:a}=Rp(e);return a?u.jsxs("div",{className:"subscription-loading",children:[u.jsx("div",{className:"spinner-small"}),u.jsx("span",{children:"Checking access..."})]}):n?u.jsx(u.Fragment,{children:r}):t?u.jsx(u.Fragment,{children:t}):u.jsx(eA,{featureName:"Premium Feature",onUpgrade:()=>{console.log("Upgrade clicked - implement subscription flow")}})}function tA({state:e,user:t}){const[r,n]=Z.useState(()=>{const p=new Date;return p.setDate(1),p.toISOString().slice(0,10)}),[a,s]=Z.useState(()=>new Date().toISOString().slice(0,10)),l=Z.useMemo(()=>{const g=(e.completions||[]).filter(he=>{const ce=he.timestamp.slice(0,10);return ce>=r&&ce<=a}),y=g.filter(he=>he.outcome==="PIF"),_=y.reduce((he,ce)=>{const Ee=parseFloat(ce.amount||"0");return he+(isNaN(Ee)?0:Ee)},0),T=g.length,S=y.length,w=g.filter(he=>he.outcome==="Done").length,E=g.filter(he=>he.outcome==="DA").length,P=g.filter(he=>he.outcome==="ARR").length,D=e.daySessions||[],A=new Set(g.map(he=>he.timestamp.slice(0,10))),H=new Set(D.filter(he=>he.date>=r&&he.date<=a&&he.end&&A.has(he.date)).map(he=>he.date)).size,J=e.bonusSettings||os,B=Ax(g,H,J),I=R2(g,H,J),ee=g.reduce((he,ce)=>{const Ee=ce.timestamp.slice(0,10);if(he[Ee]||(he[Ee]={date:Ee,pifs:0,total:0,fees:0,completions:[]}),he[Ee].total++,he[Ee].completions.push(ce),ce.outcome==="PIF"){he[Ee].pifs++;const je=parseFloat(ce.amount||"0");isNaN(je)||(he[Ee].fees+=je)}return he},{}),re=Object.values(ee).map(he=>{const ce=he.completions,Ee=Ax(ce,1,J);return{date:he.date,pifs:he.pifs,total:he.total,fees:he.fees,bonus:Ee}});let ye="";if(J.calculationType==="simple"){const he=J.simpleSettings?.pifBonus||100,ce=J.simpleSettings?.dailyThreshold||100;ye=`£${he}/PIF - £${ce}/day`}else J.calculationType==="complex"?ye="TCG Regulations 2014":J.calculationType==="custom"&&(ye="Custom Formula");return{totalPifFees:_,totalAddresses:T,pifCount:S,doneCount:w,daCount:E,arrCount:P,totalBonus:B,workingDays:H,bonusBreakdown:I,formulaDescription:ye,dailyStats:re.sort((he,ce)=>ce.date.localeCompare(he.date))}},[e.completions,e.daySessions,e.bonusSettings,r,a]),d=p=>new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:2}).format(p),m=()=>{const p=new Date(r).toLocaleDateString("en-GB"),g=new Date(a).toLocaleDateString("en-GB");return`${p} - ${g}`};return u.jsx(C_,{user:t,fallback:u.jsx(rA,{}),children:u.jsxs("div",{className:"earnings-calendar",style:{padding:"1rem"},children:[u.jsx("h2",{children:"Earnings Overview"}),u.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"2rem",alignItems:"center",flexWrap:"wrap"},children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"start-date",style:{display:"block",marginBottom:"0.5rem"},children:"From:"}),u.jsx("input",{id:"start-date",type:"date",value:r,onChange:p=>n(p.target.value),className:"input"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"end-date",style:{display:"block",marginBottom:"0.5rem"},children:"To:"}),u.jsx("input",{id:"end-date",type:"date",value:a,onChange:p=>s(p.target.value),className:"input"})]})]}),u.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[u.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--success)"},children:"Total PIF Fees"}),u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:d(l.totalPifFees)}),u.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:[l.pifCount," PIF completions"]})]}),u.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Total Addresses"}),u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:l.totalAddresses}),u.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:m()})]}),u.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--primary)"},children:"Potential Bonus"}),u.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"bold"},children:d(l.totalBonus)}),u.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:l.formulaDescription}),u.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:[l.workingDays," working day",l.workingDays!==1?"s":""]})]}),u.jsxs("div",{className:"summary-card",style:{background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",padding:"1rem",textAlign:"center"},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:"Breakdown"}),u.jsxs("div",{style:{fontSize:"0.875rem"},children:[u.jsxs("div",{children:["PIF: ",l.pifCount]}),u.jsxs("div",{children:["Done: ",l.doneCount]}),u.jsxs("div",{children:["DA: ",l.daCount]}),u.jsxs("div",{children:["ARR: ",l.arrCount]})]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{children:"Daily Breakdown"}),l.dailyStats.length===0?u.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"},children:"No completions found in selected date range"}):u.jsx("div",{style:{overflowX:"auto"},children:u.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)"},children:[u.jsx("thead",{children:u.jsxs("tr",{style:{background:"var(--background)"},children:[u.jsx("th",{style:{padding:"0.75rem",textAlign:"left",borderBottom:"1px solid var(--border-light)"},children:"Date"}),u.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIFs"}),u.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Total Addresses"}),u.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"PIF Fees"}),u.jsx("th",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:"Bonus"})]})}),u.jsx("tbody",{children:l.dailyStats.map(p=>u.jsxs("tr",{children:[u.jsx("td",{style:{padding:"0.75rem",borderBottom:"1px solid var(--border-light)"},children:new Date(p.date).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short"})}),u.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:p.pifs}),u.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)"},children:p.total}),u.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold"},children:d(p.fees)}),u.jsx("td",{style:{padding:"0.75rem",textAlign:"right",borderBottom:"1px solid var(--border-light)",fontWeight:"bold",color:p.bonus>0?"var(--primary)":"var(--text-muted)"},children:d(p.bonus)})]},p.date))})]})})]})]})})}function rA(){return u.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",margin:"1rem"},children:[u.jsx("h2",{children:"Earnings Tracking"}),u.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--text-muted)"},children:"Track your PIF fees and completion statistics with detailed date range analysis."}),u.jsx("div",{style:{marginBottom:"1rem"},children:u.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",fontSize:"0.875rem"},children:"Premium Feature"})}),u.jsx("p",{style:{fontSize:"0.875rem",color:"var(--text-muted)"},children:"Start your free trial to access earnings tracking and reporting."})]})}class nA{currentToken=null;generateToken(){return this.currentToken="session_"+Math.random().toString(36).substr(2,9)+Date.now().toString(36),this.currentToken}getToken(){return this.currentToken}clearToken(){this.currentToken=null}}const td=new nA;async function aA(e,t={}){const r="your-new-google-maps-api-key-here";if(!e.trim()||e.length<3)return[];try{const n=t.sessionToken||td.generateToken(),a={input:e,sessionToken:n,...t.componentRestrictions&&{regionCode:t.componentRestrictions.country.toUpperCase()},...t.types&&t.types.length>0&&{includedPrimaryTypes:t.types}};console.log("Making Places API (New) autocomplete request:",a);const s=await fetch("https://places.googleapis.com/v1/places:autocomplete",{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":r,"X-Goog-FieldMask":"suggestions.placePrediction.place,suggestions.placePrediction.placeId,suggestions.placePrediction.text"},body:JSON.stringify(a)});if(!s.ok){const d=await s.text();throw console.error("Places API error:",s.status,d),new Error(`Places API error: ${s.status} - ${d}`)}const l=await s.json();return console.log("Places API response:",l),l.suggestions?l.suggestions.filter(d=>d.placePrediction).map(d=>({place_id:d.placePrediction.placeId,description:d.placePrediction.text?.text||"",structured_formatting:{main_text:d.placePrediction.structuredFormat?.mainText?.text||"",secondary_text:d.placePrediction.structuredFormat?.secondaryText?.text||""},types:d.placePrediction.types||[]})):[]}catch(n){throw console.error("Places API autocomplete failed:",n),n}}async function iA(e,t){const r="your-new-google-maps-api-key-here";try{console.log("Getting place details for:",e);const n=`https://places.googleapis.com/v1/places/${e}`,a=await fetch(n,{method:"GET",headers:{"X-Goog-Api-Key":r,"X-Goog-FieldMask":"id,displayName,formattedAddress,location,types"}});if(!a.ok){const l=await a.text();throw console.error("Place details API error:",a.status,l),new Error(`Place details API error: ${a.status} - ${l}`)}const s=await a.json();return console.log("Place details response:",s),t&&td.clearToken(),s.id&&s.location?{place_id:s.id,name:s.displayName?.text||"",formatted_address:s.formattedAddress||"",geometry:{location:{lat:s.location.latitude,lng:s.location.longitude}},types:s.types||[]}:null}catch(n){throw console.error("Place details failed:",n),t&&td.clearToken(),n}}function sA(){return td.getToken()}function d1(){td.clearToken()}function A_(e){if(e<60)return`${Math.round(e)}s`;const t=Math.floor(e/60);if(t<60)return`${t}m`;const r=Math.floor(t/60),n=t%60;return n>0?`${r}h ${n}m`:`${r}h`}function N_(e){if(e<1e3)return`${Math.round(e)}m`;const t=e/1e3;return t<10?`${t.toFixed(1)}km`:`${Math.round(t)}km`}function P_(e){return`${Math.round(e*100)}%`}const f1="geocode-cache",Fm=720*60*60*1e3;class oA{cache={};isLoadingCache=!1;cacheLoadPromise=null;apiKey;constructor(t){this.apiKey=t,this.cacheLoadPromise=this.loadCache()}async loadCache(){if(this.isLoadingCache)return this.cacheLoadPromise||Promise.resolve();this.isLoadingCache=!0;try{const t=await Xu(f1);t&&(this.cache={...t,...this.cache},this.cleanExpiredEntries())}catch(t){console.warn("Failed to load geocoding cache:",t)}finally{this.isLoadingCache=!1,this.cacheLoadPromise=null}}async saveCache(){try{await wc(f1,this.cache)}catch(t){console.warn("Failed to save geocoding cache:",t)}}cleanExpiredEntries(){const t=Date.now(),r=[];for(const[n,a]of Object.entries(this.cache))t-a.timestamp>Fm&&r.push(n);for(const n of r)delete this.cache[n];r.length>0&&this.saveCache()}normalizeAddress(t){return t.trim().toLowerCase().replace(/\s+/g," ")}async geocodeAddressInternal(t){if(this.cacheLoadPromise&&await this.cacheLoadPromise,!this.apiKey)return{success:!1,address:t,originalAddress:t,error:"Google Maps API key not configured"};if(!t?.trim())return{success:!1,address:t,originalAddress:t,error:"Empty address provided"};const r=this.normalizeAddress(t),n=this.cache[r];if(n&&Date.now()-n.timestamp<Fm)return n.result;try{console.log(`Geocoding with Google Maps SDK: "${t}"`);const{geocodeAddressSDK:a,isGoogleMapsSDKAvailable:s}=await oi(async()=>{const{geocodeAddressSDK:l,isGoogleMapsSDKAvailable:d}=await import("./googleMapsSDK-CCdvlH9E.js");return{geocodeAddressSDK:l,isGoogleMapsSDKAvailable:d}},[]);if(s()){const l=await a(t);if(l.success)return this.cache[r]={result:l,timestamp:Date.now()},this.saveCache().catch(console.warn),l;this.cache[r]={result:l,timestamp:Date.now()},this.saveCache().catch(console.warn)}}catch(a){console.warn("JavaScript SDK geocoding failed, falling back to Supabase Edge Function:",a)}return{success:!1,address:t,originalAddress:t,error:"Google Maps direct geocoding not available"}}getCacheStats(){const t=Date.now();let r=0,n=0;for(const a of Object.values(this.cache))t-a.timestamp<Fm?r++:n++;return{totalEntries:Object.keys(this.cache).length,validEntries:r,expiredEntries:n}}async clearCache(){this.cache={},await this.saveCache()}}let jm=null;function Lp(){if(!jm){const e="your-new-google-maps-api-key-here";jm=new oA(e)}return jm}async function lA(e,t,r){const n=Lp(),a=[],s=5;for(let d=0;d<e.length;d+=s){const m=e.slice(d,d+s),p=m.map(y=>n.geocodeAddressInternal(y)),g=await Promise.all(p);a.push(...g),r&&r(a.length,e.length,m[m.length-1]),d+s<e.length&&await new Promise(y=>setTimeout(y,200))}const l=a.filter(d=>!d.success).length;if(l>e.length*.5){console.warn(`${l}/${e.length} addresses failed with direct API, trying Supabase Edge Function...`);try{const{geocodeAddresses:d}=await oi(async()=>{const{geocodeAddresses:p}=await Promise.resolve().then(()=>I_);return{geocodeAddresses:p}},void 0),m=await d(e,r);return a.map((p,g)=>p.success?p:m[g])}catch(d){console.warn("Centralized batch geocoding also failed:",d)}}return a}async function cA(e,t,r="GB",n=5){if(!e.trim()||e.length<3)return[];try{console.log(`Searching addresses with Google Places API: "${e}"`);const s=await aA(e,{componentRestrictions:{country:r.toLowerCase()},types:["street_address","route","premise"]});if(s.length>0)return s.slice(0,n).map(l=>({label:l.description,coordinates:[0,0],confidence:.9,placeId:l.place_id}))}catch(s){console.warn("Google Places API search failed, trying Supabase Edge Function:",s)}try{const{searchAddresses:s}=await oi(async()=>{const{searchAddresses:d}=await Promise.resolve().then(()=>I_);return{searchAddresses:d}},void 0),l=await s(e,r,n);if(l.length>0)return l}catch(s){console.warn("Centralized address search also failed:",s)}const a=Lp();if(a.apiKey)try{const s=await a.geocodeAddressInternal(e);if(s.success&&s.lat&&s.lng)return[{label:s.formattedAddress||s.address,coordinates:[s.lng,s.lat],confidence:s.confidence||.7}]}catch(s){console.warn("Direct geocoding fallback also failed:",s)}return[]}async function uA(e){if(!e)return null;try{const r=sA()||void 0,n=await iA(e,r);if(d1(),n?.geometry?.location)return{lat:n.geometry.location.lat,lng:n.geometry.location.lng,formattedAddress:n.formatted_address||n.name||""}}catch(r){d1(),console.error("Failed to resolve place details with new API:",r)}const t=Lp();if(t.apiKey)try{const r=await t.geocodeAddressInternal(e);if(r.success&&r.lat&&r.lng)return{lat:r.lat,lng:r.lng,formattedAddress:r.formattedAddress||r.address}}catch(r){console.warn("Geocoding fallback for place resolution failed:",r)}return null}async function dA(e,t){if(!Ve)throw new Error("Supabase client not available");try{console.log(`Geocoding ${e.length} addresses via centralized service`);const r=[],n=10;for(let a=0;a<e.length;a+=n){const s=e.slice(a,a+n),{data:l,error:d}=await Ve.functions.invoke("geocode",{body:{addresses:s,countryCode:"GB"}});if(d){console.error("Geocoding batch error:",d);const m=s.map(p=>({success:!1,address:p,originalAddress:p,error:d.message||"Geocoding service error"}));r.push(...m)}else if(l?.results)r.push(...l.results);else{console.error("Unexpected geocoding response:",l);const m=s.map(p=>({success:!1,address:p,originalAddress:p,error:"Unexpected service response"}));r.push(...m)}t&&t(r.length,e.length,s[s.length-1])}return console.log(`Geocoding completed: ${r.filter(a=>a.success).length}/${r.length} successful`),r}catch(r){return console.error("Geocoding service failed:",r),e.map(n=>({success:!1,address:n,originalAddress:n,error:r instanceof Error?r.message:"Service unavailable"}))}}async function fA(e,t="GB",r=5,n,a){if(!Ve)return console.error("Supabase client not available for address search"),[];try{if(!e.trim()||e.length<3)return[];const{data:s,error:l}=await Ve.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:t,limit:Math.min(r,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return l?(console.error("Address search error:",l),[]):s?.results||[]}catch(s){return console.error("Address search failed:",s),[]}}function fp(e){const t=e.lat!==null&&e.lat!==void 0&&e.lng!==null&&e.lng!==void 0&&!isNaN(e.lat)&&!isNaN(e.lng);return{success:t,address:e.address,originalAddress:e.address,lat:t&&e.lat!==null?e.lat:void 0,lng:t&&e.lng!==null?e.lng:void 0,confidence:t?1:void 0,error:t?void 0:"No coordinates available"}}function lh(e){return{address:e.address,lat:e.success&&e.lat!==void 0?e.lat:null,lng:e.success&&e.lng!==void 0?e.lng:null}}const I_=Object.freeze(Object.defineProperty({__proto__:null,addressRowToGeocodingResult:fp,formatConfidence:P_,formatDistance:N_,formatDuration:A_,geocodeAddresses:dA,geocodingResultToAddressRow:lh,searchAddresses:fA},Symbol.toStringTag,{value:"Module"}));async function h1(e,t){console.log(`Geocoding ${e.length} addresses via Google Maps (hybrid service)`);try{const r=await lA(e,void 0,t);return console.log(`Google Maps geocoding completed: ${r.filter(n=>n.success).length}/${r.length} successful`),r}catch(r){return console.error("Google Maps geocoding service failed:",r),e.map(n=>({success:!1,address:n,originalAddress:n,error:r instanceof Error?r.message:"Google Maps service unavailable"}))}}async function hA(e,t="GB",r=5,n,a){try{const s=await cA(e);if(s.length>0)return s.slice(0,r)}catch(s){console.warn("Google Maps search failed, falling back to centralized service:",s)}if(!Ve)return console.error("No search services available"),[];try{if(!e.trim()||e.length<3)return[];const{data:s,error:l}=await Ve.functions.invoke("search-addresses",{body:{query:e.trim(),countryCode:t,limit:Math.min(r,10),...n!==void 0&&a!==void 0?{focusLat:n,focusLon:a}:{}}});return l?(console.error("Address search error:",l),[]):s?.results||[]}catch(s){return console.error("Address search failed:",s),[]}}async function mA(e,t){if(!Ve)throw new Error("Supabase client not available");try{const r=e.map((l,d)=>({...l,originalIndex:d})).filter(({lat:l,lng:d})=>l!=null&&d!==null&&d!==void 0&&!isNaN(l)&&!isNaN(d));if(r.length===0)return{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((l,d)=>d),error:"No addresses have valid coordinates for route optimization"};if(r.length===1)return{success:!0,optimizedOrder:[r[0].originalIndex],totalDistance:0,totalDuration:0,unassigned:[]};console.log(`Optimizing route for ${r.length} addresses via OpenRouteService (hybrid service)`);const n={addresses:r.map(l=>({address:l.address,lat:l.lat,lng:l.lng})),startLocation:t};console.log("Route optimization request:",{addressCount:n.addresses.length,hasStartLocation:!!t,firstAddress:n.addresses[0]});let a=null,s=null;try{const l="https://eevfxrgemrtthxbcxtvq.supabase.co",d="sb_publishable_lShYIR6xiiwlo9IfCUM0Mw_9-FeV0a7",m=`${l}/functions/v1/optimize-route`,p=(await Ve.auth.getSession()).data.session?.access_token;console.log("Making direct request to Edge Function:",{url:m,hasAuthToken:!!p,requestBodySize:JSON.stringify(n).length});const g={"Content-Type":"application/json",apikey:d};p&&(g.Authorization=`Bearer ${p}`);const y=await fetch(m,{method:"POST",headers:g,body:JSON.stringify(n)});if(console.log("Edge Function response status:",{status:y.status,statusText:y.statusText,ok:y.ok,headers:Object.fromEntries(y.headers.entries())}),y.ok)a=await y.json();else{const _=await y.text();console.error("Edge Function error response:",{status:y.status,statusText:y.statusText,body:_});try{const T=JSON.parse(_);s=new Error(`Edge Function error (${y.status}): ${T.error||_}`)}catch{s=new Error(`Edge Function error (${y.status}): ${_}`)}}}catch(l){console.error("Failed to make direct request to Edge Function:",l);const d=await Ve.functions.invoke("optimize-route",{body:n});a=d.data,s=d.error}if(s){console.error("Route optimization error details:",{error:s,errorMessage:s.message,errorName:s.name,errorStack:s.stack,data:a});let l=`Route optimization service error: ${s.message||"Unknown error"}`;return s.message?.includes("OpenRouteService API key")?l="Route optimization service not configured. Please contact support.":s.message?.includes("non-2xx status code")?l="Route optimization service is temporarily unavailable. Please try again later.":s.message?.includes("Unauthorized")?l="Authentication required. Please log in again.":s.message?.includes("Subscription required")?l="Route optimization requires an active subscription.":s.message?.includes("OpenRouteService API error")?l=`OpenRouteService API error: ${s.message.split("OpenRouteService API error: ")[1]||s.message}`:s.message?.includes("Maximum 100 addresses")?l="Too many addresses. Maximum 100 addresses allowed per optimization.":s.message?.includes("No addresses have valid coordinates")&&(l="No addresses have valid coordinates for route optimization."),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((d,m)=>m),error:l}}return console.log("Route optimization response received:",{hasData:!!a,dataKeys:a?Object.keys(a):null,success:a?.success}),a?(console.log(`Route optimization completed: ${a.optimizedOrder?.length||0} addresses optimized`),a):(console.error("Route optimization: No data received from Edge Function"),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((l,d)=>d),error:"No response from optimization service"})}catch(r){return console.error("Route optimization failed:",r),{success:!1,optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:e.map((n,a)=>a),error:r instanceof Error?r.message:"Unknown error occurred"}}}async function pA(e,t,r){if(!Ve)return{success:!1,routeSegments:[],error:"Supabase client not available"};try{const n=[];r&&n.push(r);for(const l of t){const d=e[l];d.lat&&d.lng&&n.push([d.lng,d.lat])}if(n.length<2)return{success:!1,routeSegments:[],error:"Need at least 2 waypoints to generate route"};const{data:a,error:s}=await Ve.functions.invoke("get-route-directions",{body:{coordinates:n,profile:"driving-car"}});return s?(console.error("Route directions error:",s),{success:!1,routeSegments:[],error:s.message||"Failed to get route directions"}):{success:!0,routeSegments:a?.segments||[],error:void 0}}catch(n){return console.error("Failed to get route directions:",n),{success:!1,routeSegments:[],error:n instanceof Error?n.message:"Unknown error occurred"}}}function gA({id:e,value:t,onChange:r,onSelect:n,placeholder:a="Start typing an address...",disabled:s=!1,className:l="input"}){const[d,m]=Z.useState([]),[p,g]=Z.useState(!1),[y,_]=Z.useState(!1),[T,S]=Z.useState(-1),w=Z.useRef(null),E=Z.useRef(null),P=Z.useRef(),D=Z.useCallback(async I=>{if(!I.trim()||I.length<3){Z.startTransition(()=>{m([]),_(!1)});return}g(!0);try{const ee=await hA(I);Z.startTransition(()=>{m(ee),_(ee.length>0),S(-1)})}catch(ee){console.error("Address search failed:",ee),Z.startTransition(()=>{m([]),_(!1)})}finally{g(!1)}},[]),A=I=>{const ee=I.target.value;r(ee),P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{D(ee)},300)},H=async I=>{if(I.placeId){g(!0);try{const ee=await uA(I.placeId);ee?(r(I.label),n(I.label,ee.lat,ee.lng)):(r(I.label),n(I.label,0,0))}catch(ee){console.error("Failed to resolve place details:",ee),r(I.label),n(I.label,0,0)}finally{g(!1)}}else{const[ee,re]=I.coordinates;r(I.label),n(I.label,re,ee)}Z.startTransition(()=>{_(!1),S(-1),m([])}),setTimeout(()=>{w.current?.blur()},0)},J=I=>{if(!(!y||d.length===0))switch(I.key){case"ArrowDown":I.preventDefault(),S(ee=>ee<d.length-1?ee+1:ee);break;case"ArrowUp":I.preventDefault(),S(ee=>ee>0?ee-1:-1);break;case"Enter":I.preventDefault(),T>=0&&T<d.length&&H(d[T]);break;case"Escape":Z.startTransition(()=>{_(!1),S(-1)}),setTimeout(()=>{w.current?.blur()},0);break}};Z.useEffect(()=>{const I=ee=>{try{w.current&&!w.current.contains(ee.target)&&E.current&&!E.current.contains(ee.target)&&Z.startTransition(()=>{_(!1),S(-1)})}catch(re){console.debug("Click outside detection error (ignoring):",re)}};return document.addEventListener("mousedown",I),()=>{try{document.removeEventListener("mousedown",I)}catch(ee){console.debug("Event listener cleanup error (ignoring):",ee)}}},[]),Z.useEffect(()=>()=>{P.current&&clearTimeout(P.current)},[]);const B=I=>I>=.8?"var(--success)":I>=.5?"var(--warning)":"var(--danger)";return u.jsxs("div",{style:{position:"relative",width:"100%"},children:[u.jsxs("div",{style:{position:"relative"},children:[u.jsx("input",{id:e,ref:w,name:"address",type:"text",value:t,onChange:A,onKeyDown:J,onFocus:()=>{d.length>0&&_(!0)},placeholder:a,disabled:s,className:l,style:{width:"100%",paddingRight:p?"2.5rem":"1rem"},autoComplete:"off"}),p&&u.jsx("div",{style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",width:"1rem",height:"1rem"},children:u.jsx("div",{className:"spinner",style:{width:"100%",height:"100%"}})})]}),y&&d.length>0&&u.jsx("div",{ref:E,style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",maxHeight:"300px",overflowY:"auto",marginTop:"0.25rem"},children:d.map((I,ee)=>u.jsxs("button",{onClick:()=>{setTimeout(()=>H(I),0)},style:{width:"100%",padding:"0.75rem 1rem",border:"none",background:T===ee?"var(--primary-light)":"transparent",color:T===ee?"var(--primary)":"var(--text-primary)",textAlign:"left",cursor:"pointer",borderBottom:ee<d.length-1?"1px solid var(--border-light)":"none",display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"0.875rem",lineHeight:"1.4"},onMouseEnter:()=>S(ee),children:[u.jsx("span",{style:{flex:1,overflow:"hidden",textOverflow:"ellipsis"},children:I.label}),u.jsxs("span",{style:{fontSize:"0.75rem",color:B(I.confidence),marginLeft:"0.5rem",flexShrink:0},title:`Confidence: ${Math.round(I.confidence*100)}%`,children:[Math.round(I.confidence*100),"%"]})]},`${I.label}-${ee}`))}),y&&d.length===0&&!p&&t.length>=3&&u.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,zIndex:1e3,background:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",boxShadow:"var(--shadow-lg)",padding:"1rem",marginTop:"0.25rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.875rem"},children:/[A-Z]{1,2}[0-9]{1,2}\s?[0-9][A-Z]{2}/i.test(t)?"Address not found. Try removing the house number or use just the postcode.":'No addresses found. Try including the postcode (e.g., "High Street SW1A 1AA").'})]})}function vA(e,t,r,n){let a="marker-pin";return t?a+=" marker-start":r?n!==void 0&&(n<.5?a+=" marker-low-confidence":n<.8&&(a+=" marker-medium-confidence")):a+=" marker-not-geocoded",ed.divIcon({className:"custom-numbered-marker",html:`<div class="${a}">
      <div class="marker-number">${t?"🏠":e}</div>
    </div>`,iconSize:[40,40],iconAnchor:[20,40],popupAnchor:[0,-40]})}function xA({pins:e}){const t=__();return Z.useEffect(()=>{if(e.length!==0)if(e.length===1){const r=e[0];t.setView([r.lat,r.lng],15)}else{const r=new ed.FeatureGroup(e.map(n=>ed.marker([n.lat,n.lng])));t.fitBounds(r.getBounds().pad(.1))}},[t,e.length]),null}function yA({addresses:e,startingPointIndex:t,onStartingPointChange:r,optimizedOrder:n,showRouteLines:a=!1,confidences:s}){const[l,d]=Z.useState([]),[m,p]=Z.useState(!1),_=e.map((D,A)=>({id:`pin-${A}`,address:D.address,lat:D.lat||0,lng:D.lng||0,isStart:A===t,isGeocoded:!!(D.lat&&D.lng),confidence:s?.[A]})).filter(D=>D.isGeocoded),T=Z.useRef("");Z.useEffect(()=>{async function D(){if(!a||!n||n.length<2){d([]),T.current="";return}const A=n.filter(J=>J<0||J>=e.length);if(A.length>0){console.error("Invalid optimizedOrder indices:",A),d([]);return}const H=`${n.join(",")}-${t}`;if(T.current!==H){p(!0);try{const J=t!==void 0&&e[t]?[e[t].lng,e[t].lat]:void 0,B=await pA(e,n,J);B.success?(d(B.routeSegments),T.current=H):(console.error("Route directions failed:",B.error),d([]))}catch(J){console.error("Route directions error:",J),d([])}finally{p(!1)}}}D()},[a,n,e.length,t]);const S=D=>{r(t===D?null:D)},w=(D,A)=>A<=1?"#3388ff":`hsl(${(1-D/(A-1))*120}, 70%, 50%)`,E=[54.5,-2];return u.jsxs("div",{style:{height:"100%",width:"100%"},children:[u.jsxs(w_,{center:E,zoom:6,style:{height:"100%",width:"100%"},scrollWheelZoom:!0,children:[u.jsx(k_,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u.jsx(xA,{pins:_}),_.map((D,A)=>{const H=e.findIndex(J=>J.lat===D.lat&&J.lng===D.lng&&J.address===D.address);return u.jsx(b_,{position:[D.lat,D.lng],icon:vA(A+1,D.isStart,D.isGeocoded,D.confidence),children:u.jsx(up,{children:u.jsxs("div",{style:{minWidth:"200px"},children:[u.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:D.address}),u.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginBottom:"0.5rem"},children:["Lat: ",D.lat.toFixed(6),", Lng: ",D.lng.toFixed(6)]}),D.confidence&&u.jsxs("div",{style:{fontSize:"0.875rem",marginBottom:"0.5rem",color:D.confidence>=.8?"var(--success)":D.confidence>=.5?"var(--warning)":"var(--danger)"},children:["Confidence: ",Math.round(D.confidence*100),"%"]}),u.jsx("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:u.jsx("button",{onClick:()=>S(H),style:{padding:"0.25rem 0.5rem",fontSize:"0.75rem",backgroundColor:D.isStart?"var(--success)":"var(--primary)",color:"white",border:"none",borderRadius:"var(--radius)",cursor:"pointer"},children:D.isStart?"🏁 Starting Point":"📍 Set as Start"})})]})})},D.id)}),a&&l.map((D,A)=>{const H=D.geometry.map(J=>[J[1],J[0]]);return u.jsx(xC,{positions:H,color:w(A,l.length),weight:4,opacity:.8,dashArray:A===0?void 0:"5, 5",children:u.jsx(up,{children:u.jsxs("div",{children:[u.jsxs("div",{style:{fontWeight:"bold",marginBottom:"0.5rem"},children:["Route Segment ",A+1]}),u.jsxs("div",{style:{fontSize:"0.875rem"},children:["Distance: ",(D.distance/1e3).toFixed(1)," km",u.jsx("br",{}),"Duration: ",Math.round(D.duration/60)," min"]})]})})},`route-segment-${A}`)})]}),m&&u.jsx("div",{style:{position:"absolute",top:"10px",right:"10px",background:"var(--surface)",padding:"0.5rem 1rem",borderRadius:"var(--radius)",boxShadow:"var(--shadow)",fontSize:"0.875rem",zIndex:10},children:"🗺️ Loading route directions..."}),u.jsx("style",{children:`
        /* Custom Numbered Markers */
        .custom-numbered-marker {
          background: transparent;
          border: none;
        }

        .marker-pin {
          width: 40px;
          height: 40px;
          display: flex;
          align-items: center;
          justify-content: center;
          position: relative;
        }

        .marker-pin::before {
          content: '';
          position: absolute;
          width: 36px;
          height: 36px;
          background: var(--primary);
          border-radius: 50% 50% 50% 0;
          transform: rotate(-45deg);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
          border: 3px solid white;
        }

        .marker-pin.marker-start::before {
          background: var(--success);
          animation: markerPulse 2s ease-in-out infinite;
        }

        .marker-pin.marker-not-geocoded::before {
          background: var(--gray-400);
        }

        .marker-pin.marker-low-confidence::before {
          background: var(--danger);
        }

        .marker-pin.marker-medium-confidence::before {
          background: var(--warning);
        }

        @keyframes markerPulse {
          0%, 100% {
            transform: rotate(-45deg) scale(1);
          }
          50% {
            transform: rotate(-45deg) scale(1.1);
          }
        }

        .marker-number {
          position: relative;
          z-index: 1;
          color: white;
          font-weight: bold;
          font-size: 0.875rem;
          text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
          transform: translateY(-2px);
        }

        /* Leaflet Popup Override for Dark Mode */
        .leaflet-popup-content-wrapper {
          background: var(--surface) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--border) !important;
          box-shadow: 0 3px 14px rgba(0, 0, 0, 0.4) !important;
        }

        .leaflet-popup-tip {
          background: var(--surface) !important;
          border: 1px solid var(--border) !important;
        }

        .leaflet-popup-close-button {
          color: var(--text-primary) !important;
        }

        .leaflet-popup-close-button:hover {
          color: var(--primary) !important;
        }
      `})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var rd={};rd.version="0.18.5";var ma=1200,rl=1252,_A=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Mp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Lh=function(e){_A.indexOf(e)!=-1&&(rl=Mp[0]=e)};function wA(){Lh(1252)}var La=function(e){ma=e,Lh(e)};function Mh(){La(1200),wA()}function gh(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function bA(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function D_(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var yc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?bA(e.slice(2)):t==254&&r==255?D_(e.slice(2)):t==65279?e.slice(1):e},Ou=function(t){return String.fromCharCode(t)},hp=function(t){return String.fromCharCode(t)},Bt;function kA(e){Bt=e,La=function(t){ma=t,Lh(t)},yc=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?Bt.utils.decode(1200,gh(t.slice(2))):t},Ou=function(r){return ma===1200?String.fromCharCode(r):Bt.utils.decode(ma,[r&255,r>>8])[0]},hp=function(r){return Bt.utils.decode(rl,[r])[0]},ow()}var no="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function nd(e){for(var t="",r=0,n=0,a=0,s=0,l=0,d=0,m=0,p=0;p<e.length;)r=e.charCodeAt(p++),s=r>>2,n=e.charCodeAt(p++),l=(r&3)<<4|n>>4,a=e.charCodeAt(p++),d=(n&15)<<2|a>>6,m=a&63,isNaN(n)?d=m=64:isNaN(a)&&(m=64),t+=no.charAt(s)+no.charAt(l)+no.charAt(d)+no.charAt(m);return t}function pa(e){var t="",r=0,n=0,a=0,s=0,l=0,d=0,m=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<e.length;)s=no.indexOf(e.charAt(p++)),l=no.indexOf(e.charAt(p++)),r=s<<2|l>>4,t+=String.fromCharCode(r),d=no.indexOf(e.charAt(p++)),n=(l&15)<<4|d>>2,d!==64&&(t+=String.fromCharCode(n)),m=no.indexOf(e.charAt(p++)),a=(d&3)<<6|m,m!==64&&(t+=String.fromCharCode(a));return t}var Pt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ds=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function oo(e){return Pt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function m1(e){return Pt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var fa=function(t){return Pt?ds(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function yd(e){if(typeof ArrayBuffer>"u")return fa(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function ho(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function SA(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Bp(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Bp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var nn=Pt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ds(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function TA(e){for(var t=[],r=0,n=e.length+250,a=oo(e.length+255),s=0;s<e.length;++s){var l=e.charCodeAt(s);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var d=e.charCodeAt(++s)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|d>>6&15|(l&3)<<4,a[r++]=128|d&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=oo(65535),n=65530)}return t.push(a.slice(0,r)),nn(t)}var Cn=/\u0000/g,Ru=/[\u0001-\u0006]/g;function kc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ai(e,t){var r=""+e;return r.length>=t?r:br("0",t-r.length)+r}function zp(e,t){var r=""+e;return r.length>=t?r:br(" ",t-r.length)+r}function vh(e,t){var r=""+e;return r.length>=t?r:r+br(" ",t-r.length)}function EA(e,t){var r=""+Math.round(e);return r.length>=t?r:br("0",t-r.length)+r}function CA(e,t){var r=""+e;return r.length>=t?r:br("0",t-r.length)+r}var p1=Math.pow(2,32);function fc(e,t){if(e>p1||e<-p1)return EA(e,t);var r=Math.round(e);return CA(r,t)}function xh(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var g1=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Om=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function AA(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var xt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},v1={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},NA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function yh(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,l=1,d=0,m=1,p=0,g=0,y=Math.floor(a);p<t&&(y=Math.floor(a),d=y*l+s,g=y*p+m,!(a-y<5e-8));)a=1/(a-y),s=l,l=d,m=p,p=g;if(g>t&&(p>t?(g=m,d=s):(g=p,d=l)),!r)return[0,n*d,g];var _=Math.floor(n*d/g);return[_,n*d-_*g,g]}function ao(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,l=[],d={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(d.u)<1e-6&&(d.u=0),t&&t.date1904&&(n+=1462),d.u>.9999&&(d.u=0,++a==86400&&(d.T=a=0,++n,++d.D)),n===60)l=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var m=new Date(1900,0,1);m.setDate(m.getDate()+n-1),l=[m.getFullYear(),m.getMonth()+1,m.getDate()],s=m.getDay(),n<60&&(s=(s+6)%7),r&&(s=OA(m,l))}return d.y=l[0],d.m=l[1],d.d=l[2],d.S=a%60,a=Math.floor(a/60),d.M=a%60,a=Math.floor(a/60),d.H=a,d.q=s,d}var F_=new Date(1899,11,31,0,0,0),PA=F_.getTime(),IA=new Date(1900,2,1,0,0,0);function j_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=IA&&(r+=1440*60*1e3),(r-(PA+(e.getTimezoneOffset()-F_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Up(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function DA(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function FA(e){var t=e<0?12:11,r=Up(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function jA(e){var t=Up(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ad(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=FA(e):t===10?r=e.toFixed(10).substr(0,12):r=jA(e),Up(DA(r.toUpperCase()))}function nl(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ad(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ga(14,j_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function OA(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function RA(e,t,r,n){var a="",s=0,l=0,d=r.y,m,p=0;switch(e){case 98:d=r.y+543;case 121:switch(t.length){case 1:case 2:m=d%100,p=2;break;default:m=d%1e4,p=4;break}break;case 109:switch(t.length){case 1:case 2:m=r.m,p=t.length;break;case 3:return Om[r.m-1][1];case 5:return Om[r.m-1][0];default:return Om[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:m=r.d,p=t.length;break;case 3:return g1[r.q][0];default:return g1[r.q][1]}break;case 104:switch(t.length){case 1:case 2:m=1+(r.H+11)%12,p=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:m=r.H,p=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:m=r.M,p=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ai(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,s=Math.round(l*(r.S+r.u)),s>=60*l&&(s=0),t==="s"?s===0?"0":""+s/l:(a=ai(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":m=r.D*24+r.H;break;case"[m]":case"[mm]":m=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":m=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}p=t.length===3?1:2;break;case 101:m=d,p=1;break}var g=p>0?ai(m,p):"";return g}function io(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var O_=/%/g;function LA(e,t,r){var n=t.replace(O_,""),a=t.length-n.length;return ls(e,n,r*Math.pow(10,2*a))+br("%",a)}function MA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ls(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function R_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+R_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,p,g){return m+p+g.substr(0,(a+s)%a)+"."+g.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var L_=/# (\?+)( ?)\/( ?)(\d+)/;function BA(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),l=a-s*n,d=n;return r+(s===0?"":""+s)+" "+(l===0?br(" ",e[1].length+1+e[4].length):zp(l,e[1].length)+e[2]+"/"+e[3]+ai(d,e[4].length))}function zA(e,t,r){return r+(t===0?"":""+t)+br(" ",e[1].length+2+e[4].length)}var M_=/^#*0*\.([0#]+)/,B_=/\).*[0#]/,z_=/\(###\) ###\\?-####/;function Bn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function x1(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function y1(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function UA(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function $A(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ia(e,t,r){if(e.charCodeAt(0)===40&&!t.match(B_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ia("n",n,r):"("+Ia("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return MA(e,t,r);if(t.indexOf("%")!==-1)return LA(e,t,r);if(t.indexOf("E")!==-1)return R_(t,r);if(t.charCodeAt(0)===36)return"$"+Ia(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,d,m=Math.abs(r),p=r<0?"-":"";if(t.match(/^00+$/))return p+fc(m,t.length);if(t.match(/^[#?]+$/))return a=fc(r,0),a==="0"&&(a=""),a.length>t.length?a:Bn(t.substr(0,t.length-a.length))+a;if(s=t.match(L_))return BA(s,m,p);if(t.match(/^#+0+$/))return p+fc(m,t.length-t.indexOf("0"));if(s=t.match(M_))return a=x1(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Bn(s[1])).replace(/\.$/,"."+Bn(s[1])).replace(/\.(\d*)$/,function(S,w){return"."+w+br("0",Bn(s[1]).length-w.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return p+x1(m,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return p+io(fc(m,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ia(e,t,-r):io(""+(Math.floor(r)+UA(r,s[1].length)))+"."+ai(y1(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ia(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=kc(Ia(e,t.replace(/[\\-]/g,""),r)),l=0,kc(kc(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(t.match(z_))return a=Ia(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),d=yh(m,Math.pow(10,l)-1,!1),a=""+p,g=ls("n",s[1],d[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+s[2]+"/"+s[3],g=vh(d[2],l),g.length<s[4].length&&(g=Bn(s[4].substr(s[4].length-g.length))+g),a+=g,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),d=yh(m,Math.pow(10,l)-1,!0),p+(d[0]||(d[1]?"":"0"))+" "+(d[1]?zp(d[1],l)+s[2]+"/"+s[3]+vh(d[2],l):br(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=fc(r,0),t.length<=a.length?a:Bn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=t.indexOf(".")-l,_=t.length-a.length-y;return Bn(t.substr(0,y)+a+t.substr(t.length-_))}if(s=t.match(/^00,000\.([#0]*0)$/))return l=y1(r,s[1].length),r<0?"-"+Ia(e,t,-r):io($A(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ai(0,3-S.length):"")+S})+"."+ai(l,s[1].length);switch(t){case"###,##0.00":return Ia(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var T=io(fc(m,0));return T!=="0"?p+T:"";case"###,###.00":return Ia(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ia(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function WA(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ls(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function HA(e,t,r){var n=t.replace(O_,""),a=t.length-n.length;return ls(e,n,r*Math.pow(10,2*a))+br("%",a)}function U_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+U_(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+s):r+="E+"+(l-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(d,m,p,g){return m+p+g.substr(0,(a+s)%a)+"."+g.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ci(e,t,r){if(e.charCodeAt(0)===40&&!t.match(B_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ci("n",n,r):"("+Ci("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return WA(e,t,r);if(t.indexOf("%")!==-1)return HA(e,t,r);if(t.indexOf("E")!==-1)return U_(t,r);if(t.charCodeAt(0)===36)return"$"+Ci(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,l,d,m=Math.abs(r),p=r<0?"-":"";if(t.match(/^00+$/))return p+ai(m,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Bn(t.substr(0,t.length-a.length))+a;if(s=t.match(L_))return zA(s,m,p);if(t.match(/^#+0+$/))return p+ai(m,t.length-t.indexOf("0"));if(s=t.match(M_))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Bn(s[1])).replace(/\.$/,"."+Bn(s[1])),a=a.replace(/\.(\d*)$/,function(S,w){return"."+w+br("0",Bn(s[1]).length-w.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return p+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return p+io(""+m);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ci(e,t,-r):io(""+r)+"."+br("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Ci(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=kc(Ci(e,t.replace(/[\\-]/g,""),r)),l=0,kc(kc(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return l<a.length?a.charAt(l++):S==="0"?"0":""}));if(t.match(z_))return a=Ci(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(s[4].length,7),d=yh(m,Math.pow(10,l)-1,!1),a=""+p,g=ls("n",s[1],d[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+s[2]+"/"+s[3],g=vh(d[2],l),g.length<s[4].length&&(g=Bn(s[4].substr(s[4].length-g.length))+g),a+=g,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(s[1].length,s[4].length),7),d=yh(m,Math.pow(10,l)-1,!0),p+(d[0]||(d[1]?"":"0"))+" "+(d[1]?zp(d[1],l)+s[2]+"/"+s[3]+vh(d[2],l):br(" ",2*l+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Bn(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var y=t.indexOf(".")-l,_=t.length-a.length-y;return Bn(t.substr(0,y)+a+t.substr(t.length-_))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ci(e,t,-r):io(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ai(0,3-S.length):"")+S})+"."+ai(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var T=io(""+m);return T!=="0"?p+T:"";default:if(t.match(/\.[0#?]*$/))return Ci(e,t.slice(0,t.lastIndexOf(".")),r)+Bn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ls(e,t,r){return(r|0)===r?Ci(e,t,r):Ia(e,t,r)}function VA(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var $_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function dl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":xh(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match($_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function GA(e,t,r,n){for(var a=[],s="",l=0,d="",m="t",p,g,y,_="H";l<e.length;)switch(d=e.charAt(l)){case"G":if(!xh(e,l))throw new Error("unrecognized character "+d+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(s="";(y=e.charCodeAt(++l))!==34&&l<e.length;)s+=String.fromCharCode(y);a[a.length]={t:"t",v:s},++l;break;case"\\":var T=e.charAt(++l),S=T==="("||T===")"?T:"t";a[a.length]={t:S,v:T},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(p==null&&(p=ao(t,r,e.charAt(l+1)==="2"),p==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},m=d,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||p==null&&(p=ao(t,r),p==null))return"";for(s=d;++l<e.length&&e.charAt(l).toLowerCase()===d;)s+=d;d==="m"&&m.toLowerCase()==="h"&&(d="M"),d==="h"&&(d=_),a[a.length]={t:d,v:s},m=d;break;case"A":case"a":case"上":var w={t:d,v:d};if(p==null&&(p=ao(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(p!=null&&(w.v=p.H>=12?"P":"A"),w.t="T",_="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(p!=null&&(w.v=p.H>=12?"PM":"AM"),w.t="T",l+=5,_="h"):e.substr(l,5).toUpperCase()==="上午/下午"?(p!=null&&(w.v=p.H>=12?"下午":"上午"),w.t="T",l+=5,_="h"):(w.t="t",++l),p==null&&w.t==="T")return"";a[a.length]=w,m=d;break;case"[":for(s=d;e.charAt(l++)!=="]"&&l<e.length;)s+=e.charAt(l);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($_)){if(p==null&&(p=ao(t,r),p==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},m=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",dl(e)||(a[a.length]={t:"t",v:s}));break;case".":if(p!=null){for(s=d;++l<e.length&&(d=e.charAt(l))==="0";)s+=d;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=d;++l<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(l))>-1;)s+=d;a[a.length]={t:"n",v:s};break;case"?":for(s=d;e.charAt(++l)===d;)s+=d;a[a.length]={t:d,v:s},m=d;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":d,v:d},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=d;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)s+=e.charAt(l);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:d,v:d},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d)===-1)throw new Error("unrecognized character "+d+" in "+e);a[a.length]={t:"t",v:d},++l;break}var E=0,P=0,D;for(l=a.length-1,m="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,m="h",E<1&&(E=1);break;case"s":(D=a[l].v.match(/\.0+$/))&&(P=Math.max(P,D[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":m=a[l].t;break;case"m":m==="s"&&(a[l].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&a[l].v.match(/[Hh]/)&&(E=1),E<2&&a[l].v.match(/[Mm]/)&&(E=2),E<3&&a[l].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var A="",H;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=RA(a[l].t.charCodeAt(0),a[l].v,p,P),a[l].t="t";break;case"n":case"?":for(H=l+1;a[H]!=null&&((d=a[H].t)==="?"||d==="D"||(d===" "||d==="t")&&a[H+1]!=null&&(a[H+1].t==="?"||a[H+1].t==="t"&&a[H+1].v==="/")||a[l].t==="("&&(d===" "||d==="n"||d===")")||d==="t"&&(a[H].v==="/"||a[H].v===" "&&a[H+1]!=null&&a[H+1].t=="?"));)a[l].v+=a[H].v,a[H]={v:"",t:";"},++H;A+=a[l].v,l=H-1;break;case"G":a[l].t="t",a[l].v=nl(t,r);break}var J="",B,I;if(A.length>0){A.charCodeAt(0)==40?(B=t<0&&A.charCodeAt(0)===45?-t:t,I=ls("n",A,B)):(B=t<0&&n>1?-t:t,I=ls("n",A,B),B<0&&a[0]&&a[0].t=="t"&&(I=I.substr(1),a[0].v="-"+a[0].v)),H=I.length-1;var ee=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){ee=l;break}var re=a.length;if(ee===a.length&&I.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(H>=a[l].v.length-1?(H-=a[l].v.length,a[l].v=I.substr(H+1,a[l].v.length)):H<0?a[l].v="":(a[l].v=I.substr(0,H+1),H=-1),a[l].t="t",re=l);H>=0&&re<a.length&&(a[re].v=I.substr(0,H+1)+a[re].v)}else if(ee!==a.length&&I.indexOf("E")===-1){for(H=I.indexOf(".")-1,l=ee;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(g=a[l].v.indexOf(".")>-1&&l===ee?a[l].v.indexOf(".")-1:a[l].v.length-1,J=a[l].v.substr(g+1);g>=0;--g)H>=0&&(a[l].v.charAt(g)==="0"||a[l].v.charAt(g)==="#")&&(J=I.charAt(H--)+J);a[l].v=J,a[l].t="t",re=l}for(H>=0&&re<a.length&&(a[re].v=I.substr(0,H+1)+a[re].v),H=I.indexOf(".")+1,l=ee;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==ee)){for(g=a[l].v.indexOf(".")>-1&&l===ee?a[l].v.indexOf(".")+1:0,J=a[l].v.substr(0,g);g<a[l].v.length;++g)H<I.length&&(J+=I.charAt(H++));a[l].v=J,a[l].t="t",re=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(B=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=ls(a[l].t,a[l].v,B),a[l].t="t");var ye="";for(l=0;l!==a.length;++l)a[l]!=null&&(ye+=a[l].v);return ye}var _1=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function w1(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function KA(e,t){var r=VA(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(_1),d=r[1].match(_1);return w1(t,l)?[n,r[0]]:w1(t,d)?[n,r[1]]:[n,r[l!=null&&d!=null?2:1]]}return[n,s]}function ga(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:xt)[e],n==null&&(n=r.table&&r.table[v1[e]]||xt[v1[e]]),n==null&&(n=NA[e]||"General");break}if(xh(n,0))return nl(t,r);t instanceof Date&&(t=j_(t,r.date1904));var a=KA(n,t);if(xh(a[1]))return nl(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return GA(a[1],t,r,a[0])}function Ii(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(xt[r]==null){t<0&&(t=r);continue}if(xt[r]==e){t=r;break}}t<0&&(t=391)}return xt[t]=e,t}function _d(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ii(e[t],t)}function Oc(){xt=AA()}var W_={format:ga,load:Ii,_table:xt,load_table:_d,parse_date_code:ao,is_date:dl,get_table:function(){return W_._table=xt}},ZA={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},H_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function YA(e){var t=typeof e=="number"?xt[e]:e;return t=t.replace(H_,"(\\d+)"),new RegExp("^"+t+"$")}function qA(e,t,r){var n=-1,a=-1,s=-1,l=-1,d=-1,m=-1;(t.match(H_)||[]).forEach(function(y,_){var T=parseInt(r[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":n=T;break;case"d":s=T;break;case"h":l=T;break;case"s":m=T;break;case"m":l>=0?d=T:a=T;break}}),m>=0&&d==-1&&a>=0&&(d=a,a=-1);var p=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var g=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2)+":"+("00"+(m>=0?m:0)).slice(-2);return l==-1&&d==-1&&m==-1?p:n==-1&&a==-1&&s==-1?g:p+"T"+g}var XA=(function(){var e={};e.version="1.2.0";function t(){for(var I=0,ee=new Array(256),re=0;re!=256;++re)I=re,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,ee[re]=I;return typeof Int32Array<"u"?new Int32Array(ee):ee}var r=t();function n(I){var ee=0,re=0,ye=0,he=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ye=0;ye!=256;++ye)he[ye]=I[ye];for(ye=0;ye!=256;++ye)for(re=I[ye],ee=256+ye;ee<4096;ee+=256)re=he[ee]=re>>>8^I[re&255];var ce=[];for(ye=1;ye!=16;++ye)ce[ye-1]=typeof Int32Array<"u"?he.subarray(ye*256,ye*256+256):he.slice(ye*256,ye*256+256);return ce}var a=n(r),s=a[0],l=a[1],d=a[2],m=a[3],p=a[4],g=a[5],y=a[6],_=a[7],T=a[8],S=a[9],w=a[10],E=a[11],P=a[12],D=a[13],A=a[14];function H(I,ee){for(var re=ee^-1,ye=0,he=I.length;ye<he;)re=re>>>8^r[(re^I.charCodeAt(ye++))&255];return~re}function J(I,ee){for(var re=ee^-1,ye=I.length-15,he=0;he<ye;)re=A[I[he++]^re&255]^D[I[he++]^re>>8&255]^P[I[he++]^re>>16&255]^E[I[he++]^re>>>24]^w[I[he++]]^S[I[he++]]^T[I[he++]]^_[I[he++]]^y[I[he++]]^g[I[he++]]^p[I[he++]]^m[I[he++]]^d[I[he++]]^l[I[he++]]^s[I[he++]]^r[I[he++]];for(ye+=15;he<ye;)re=re>>>8^r[(re^I[he++])&255];return~re}function B(I,ee){for(var re=ee^-1,ye=0,he=I.length,ce=0,Ee=0;ye<he;)ce=I.charCodeAt(ye++),ce<128?re=re>>>8^r[(re^ce)&255]:ce<2048?(re=re>>>8^r[(re^(192|ce>>6&31))&255],re=re>>>8^r[(re^(128|ce&63))&255]):ce>=55296&&ce<57344?(ce=(ce&1023)+64,Ee=I.charCodeAt(ye++)&1023,re=re>>>8^r[(re^(240|ce>>8&7))&255],re=re>>>8^r[(re^(128|ce>>2&63))&255],re=re>>>8^r[(re^(128|Ee>>6&15|(ce&3)<<4))&255],re=re>>>8^r[(re^(128|Ee&63))&255]):(re=re>>>8^r[(re^(224|ce>>12&15))&255],re=re>>>8^r[(re^(128|ce>>6&63))&255],re=re>>>8^r[(re^(128|ce&63))&255]);return~re}return e.table=r,e.bstr=H,e.buf=J,e.str=B,e})(),ut=(function(){var t={};t.version="1.2.1";function r(j,Q){for(var K=j.split("/"),X=Q.split("/"),ne=0,se=0,be=Math.min(K.length,X.length);ne<be;++ne){if(se=K[ne].length-X[ne].length)return se;if(K[ne]!=X[ne])return K[ne]<X[ne]?-1:1}return K.length-X.length}function n(j){if(j.charAt(j.length-1)=="/")return j.slice(0,-1).indexOf("/")===-1?j:n(j.slice(0,-1));var Q=j.lastIndexOf("/");return Q===-1?j:j.slice(0,Q+1)}function a(j){if(j.charAt(j.length-1)=="/")return a(j.slice(0,-1));var Q=j.lastIndexOf("/");return Q===-1?j:j.slice(Q+1)}function s(j,Q){typeof Q=="string"&&(Q=new Date(Q));var K=Q.getHours();K=K<<6|Q.getMinutes(),K=K<<5|Q.getSeconds()>>>1,j.write_shift(2,K);var X=Q.getFullYear()-1980;X=X<<4|Q.getMonth()+1,X=X<<5|Q.getDate(),j.write_shift(2,X)}function l(j){var Q=j.read_shift(2)&65535,K=j.read_shift(2)&65535,X=new Date,ne=K&31;K>>>=5;var se=K&15;K>>>=4,X.setMilliseconds(0),X.setFullYear(K+1980),X.setMonth(se-1),X.setDate(ne);var be=Q&31;Q>>>=5;var Ce=Q&63;return Q>>>=6,X.setHours(Q),X.setMinutes(Ce),X.setSeconds(be<<1),X}function d(j){un(j,0);for(var Q={},K=0;j.l<=j.length-4;){var X=j.read_shift(2),ne=j.read_shift(2),se=j.l+ne,be={};switch(X){case 21589:K=j.read_shift(1),K&1&&(be.mtime=j.read_shift(4)),ne>5&&(K&2&&(be.atime=j.read_shift(4)),K&4&&(be.ctime=j.read_shift(4))),be.mtime&&(be.mt=new Date(be.mtime*1e3));break}j.l=se,Q[X]=be}return Q}var m;function p(){return m||(m={})}function g(j,Q){if(j[0]==80&&j[1]==75)return va(j,Q);if((j[0]|32)==109&&(j[1]|32)==105)return hi(j,Q);if(j.length<512)throw new Error("CFB file size "+j.length+" < 512");var K=3,X=512,ne=0,se=0,be=0,Ce=0,_e=0,xe=[],ke=j.slice(0,512);un(ke,0);var Re=y(ke);switch(K=Re[0],K){case 3:X=512;break;case 4:X=4096;break;case 0:if(Re[1]==0)return va(j,Q);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}X!==512&&(ke=j.slice(0,X),un(ke,28));var Ke=j.slice(0,X);_(ke,K);var et=ke.read_shift(4,"i");if(K===3&&et!==0)throw new Error("# Directory Sectors: Expected 0 saw "+et);ke.l+=4,be=ke.read_shift(4,"i"),ke.l+=4,ke.chk("00100000","Mini Stream Cutoff Size: "),Ce=ke.read_shift(4,"i"),ne=ke.read_shift(4,"i"),_e=ke.read_shift(4,"i"),se=ke.read_shift(4,"i");for(var We=-1,Ue=0;Ue<109&&(We=ke.read_shift(4,"i"),!(We<0));++Ue)xe[Ue]=We;var st=T(j,X);E(_e,se,st,X,xe);var $t=D(st,be,xe,X);$t[be].name="!Directory",ne>0&&Ce!==Ee&&($t[Ce].name="!MiniFAT"),$t[xe[0]].name="!FAT",$t.fat_addrs=xe,$t.ssz=X;var Wt={},ar=[],mn=[],Yr=[];A(be,$t,st,ar,ne,Wt,mn,Ce),S(mn,Yr,ar),ar.shift();var Dn={FileIndex:mn,FullPaths:Yr};return Q&&Q.raw&&(Dn.raw={header:Ke,sectors:st}),Dn}function y(j){if(j[j.l]==80&&j[j.l+1]==75)return[0,0];j.chk(je,"Header Signature: "),j.l+=16;var Q=j.read_shift(2,"u");return[j.read_shift(2,"u"),Q]}function _(j,Q){var K=9;switch(j.l+=2,K=j.read_shift(2)){case 9:if(Q!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(Q!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}j.chk("0600","Mini Sector Shift: "),j.chk("000000000000","Reserved: ")}function T(j,Q){for(var K=Math.ceil(j.length/Q)-1,X=[],ne=1;ne<K;++ne)X[ne-1]=j.slice(ne*Q,(ne+1)*Q);return X[K-1]=j.slice(K*Q),X}function S(j,Q,K){for(var X=0,ne=0,se=0,be=0,Ce=0,_e=K.length,xe=[],ke=[];X<_e;++X)xe[X]=ke[X]=X,Q[X]=K[X];for(;Ce<ke.length;++Ce)X=ke[Ce],ne=j[X].L,se=j[X].R,be=j[X].C,xe[X]===X&&(ne!==-1&&xe[ne]!==ne&&(xe[X]=xe[ne]),se!==-1&&xe[se]!==se&&(xe[X]=xe[se])),be!==-1&&(xe[be]=X),ne!==-1&&X!=xe[X]&&(xe[ne]=xe[X],ke.lastIndexOf(ne)<Ce&&ke.push(ne)),se!==-1&&X!=xe[X]&&(xe[se]=xe[X],ke.lastIndexOf(se)<Ce&&ke.push(se));for(X=1;X<_e;++X)xe[X]===X&&(se!==-1&&xe[se]!==se?xe[X]=xe[se]:ne!==-1&&xe[ne]!==ne&&(xe[X]=xe[ne]));for(X=1;X<_e;++X)if(j[X].type!==0){if(Ce=X,Ce!=xe[Ce])do Ce=xe[Ce],Q[X]=Q[Ce]+"/"+Q[X];while(Ce!==0&&xe[Ce]!==-1&&Ce!=xe[Ce]);xe[X]=-1}for(Q[0]+="/",X=1;X<_e;++X)j[X].type!==2&&(Q[X]+="/")}function w(j,Q,K){for(var X=j.start,ne=j.size,se=[],be=X;K&&ne>0&&be>=0;)se.push(Q.slice(be*ce,be*ce+ce)),ne-=ce,be=Ko(K,be*4);return se.length===0?Fe(0):nn(se).slice(0,j.size)}function E(j,Q,K,X,ne){var se=Ee;if(j===Ee){if(Q!==0)throw new Error("DIFAT chain shorter than expected")}else if(j!==-1){var be=K[j],Ce=(X>>>2)-1;if(!be)return;for(var _e=0;_e<Ce&&(se=Ko(be,_e*4))!==Ee;++_e)ne.push(se);E(Ko(be,X-4),Q-1,K,X,ne)}}function P(j,Q,K,X,ne){var se=[],be=[];ne||(ne=[]);var Ce=X-1,_e=0,xe=0;for(_e=Q;_e>=0;){ne[_e]=!0,se[se.length]=_e,be.push(j[_e]);var ke=K[Math.floor(_e*4/X)];if(xe=_e*4&Ce,X<4+xe)throw new Error("FAT boundary crossed: "+_e+" 4 "+X);if(!j[ke])break;_e=Ko(j[ke],xe)}return{nodes:se,data:F1([be])}}function D(j,Q,K,X){var ne=j.length,se=[],be=[],Ce=[],_e=[],xe=X-1,ke=0,Re=0,Ke=0,et=0;for(ke=0;ke<ne;++ke)if(Ce=[],Ke=ke+Q,Ke>=ne&&(Ke-=ne),!be[Ke]){_e=[];var We=[];for(Re=Ke;Re>=0;){We[Re]=!0,be[Re]=!0,Ce[Ce.length]=Re,_e.push(j[Re]);var Ue=K[Math.floor(Re*4/X)];if(et=Re*4&xe,X<4+et)throw new Error("FAT boundary crossed: "+Re+" 4 "+X);if(!j[Ue]||(Re=Ko(j[Ue],et),We[Re]))break}se[Ke]={nodes:Ce,data:F1([_e])}}return se}function A(j,Q,K,X,ne,se,be,Ce){for(var _e=0,xe=X.length?2:0,ke=Q[j].data,Re=0,Ke=0,et;Re<ke.length;Re+=128){var We=ke.slice(Re,Re+128);un(We,64),Ke=We.read_shift(2),et=$h(We,0,Ke-xe),X.push(et);var Ue={name:et,type:We.read_shift(1),color:We.read_shift(1),L:We.read_shift(4,"i"),R:We.read_shift(4,"i"),C:We.read_shift(4,"i"),clsid:We.read_shift(16),state:We.read_shift(4,"i"),start:0,size:0},st=We.read_shift(2)+We.read_shift(2)+We.read_shift(2)+We.read_shift(2);st!==0&&(Ue.ct=H(We,We.l-8));var $t=We.read_shift(2)+We.read_shift(2)+We.read_shift(2)+We.read_shift(2);$t!==0&&(Ue.mt=H(We,We.l-8)),Ue.start=We.read_shift(4,"i"),Ue.size=We.read_shift(4,"i"),Ue.size<0&&Ue.start<0&&(Ue.size=Ue.type=0,Ue.start=Ee,Ue.name=""),Ue.type===5?(_e=Ue.start,ne>0&&_e!==Ee&&(Q[_e].name="!StreamData")):Ue.size>=4096?(Ue.storage="fat",Q[Ue.start]===void 0&&(Q[Ue.start]=P(K,Ue.start,Q.fat_addrs,Q.ssz)),Q[Ue.start].name=Ue.name,Ue.content=Q[Ue.start].data.slice(0,Ue.size)):(Ue.storage="minifat",Ue.size<0?Ue.size=0:_e!==Ee&&Ue.start!==Ee&&Q[_e]&&(Ue.content=w(Ue,Q[_e].data,(Q[Ce]||{}).data))),Ue.content&&un(Ue.content,0),se[et]=Ue,be.push(Ue)}}function H(j,Q){return new Date((rn(j,Q+4)/1e7*Math.pow(2,32)+rn(j,Q)/1e7-11644473600)*1e3)}function J(j,Q){return p(),g(m.readFileSync(j),Q)}function B(j,Q){var K=Q&&Q.type;switch(K||Pt&&Buffer.isBuffer(j)&&(K="buffer"),K||"base64"){case"file":return J(j,Q);case"base64":return g(fa(pa(j)),Q);case"binary":return g(fa(j),Q)}return g(j,Q)}function I(j,Q){var K=Q||{},X=K.root||"Root Entry";if(j.FullPaths||(j.FullPaths=[]),j.FileIndex||(j.FileIndex=[]),j.FullPaths.length!==j.FileIndex.length)throw new Error("inconsistent CFB structure");j.FullPaths.length===0&&(j.FullPaths[0]=X+"/",j.FileIndex[0]={name:X,type:5}),K.CLSID&&(j.FileIndex[0].clsid=K.CLSID),ee(j)}function ee(j){var Q="Sh33tJ5";if(!ut.find(j,"/"+Q)){var K=Fe(4);K[0]=55,K[1]=K[3]=50,K[2]=54,j.FileIndex.push({name:Q,type:2,content:K,size:4,L:69,R:69,C:69}),j.FullPaths.push(j.FullPaths[0]+Q),re(j)}}function re(j,Q){I(j);for(var K=!1,X=!1,ne=j.FullPaths.length-1;ne>=0;--ne){var se=j.FileIndex[ne];switch(se.type){case 0:X?K=!0:(j.FileIndex.pop(),j.FullPaths.pop());break;case 1:case 2:case 5:X=!0,isNaN(se.R*se.L*se.C)&&(K=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!Q)){var be=new Date(1987,1,19),Ce=0,_e=Object.create?Object.create(null):{},xe=[];for(ne=0;ne<j.FullPaths.length;++ne)_e[j.FullPaths[ne]]=!0,j.FileIndex[ne].type!==0&&xe.push([j.FullPaths[ne],j.FileIndex[ne]]);for(ne=0;ne<xe.length;++ne){var ke=n(xe[ne][0]);X=_e[ke],X||(xe.push([ke,{name:a(ke).replace("/",""),type:1,clsid:ue,ct:be,mt:be,content:null}]),_e[ke]=!0)}for(xe.sort(function(et,We){return r(et[0],We[0])}),j.FullPaths=[],j.FileIndex=[],ne=0;ne<xe.length;++ne)j.FullPaths[ne]=xe[ne][0],j.FileIndex[ne]=xe[ne][1];for(ne=0;ne<xe.length;++ne){var Re=j.FileIndex[ne],Ke=j.FullPaths[ne];if(Re.name=a(Ke).replace("/",""),Re.L=Re.R=Re.C=-(Re.color=1),Re.size=Re.content?Re.content.length:0,Re.start=0,Re.clsid=Re.clsid||ue,ne===0)Re.C=xe.length>1?1:-1,Re.size=0,Re.type=5;else if(Ke.slice(-1)=="/"){for(Ce=ne+1;Ce<xe.length&&n(j.FullPaths[Ce])!=Ke;++Ce);for(Re.C=Ce>=xe.length?-1:Ce,Ce=ne+1;Ce<xe.length&&n(j.FullPaths[Ce])!=n(Ke);++Ce);Re.R=Ce>=xe.length?-1:Ce,Re.type=1}else n(j.FullPaths[ne+1]||"")==n(Ke)&&(Re.R=ne+1),Re.type=2}}}function ye(j,Q){var K=Q||{};if(K.fileType=="mad")return Ua(j,K);switch(re(j),K.fileType){case"zip":return sr(j,K)}var X=(function(et){for(var We=0,Ue=0,st=0;st<et.FileIndex.length;++st){var $t=et.FileIndex[st];if($t.content){var Wt=$t.content.length;Wt>0&&(Wt<4096?We+=Wt+63>>6:Ue+=Wt+511>>9)}}for(var ar=et.FullPaths.length+3>>2,mn=We+7>>3,Yr=We+127>>7,Dn=mn+Ue+ar+Yr,Nr=Dn+127>>7,$a=Nr<=109?0:Math.ceil((Nr-109)/127);Dn+Nr+$a+127>>7>Nr;)$a=++Nr<=109?0:Math.ceil((Nr-109)/127);var ft=[1,$a,Nr,Yr,ar,Ue,We,0];return et.FileIndex[0].size=We<<6,ft[7]=(et.FileIndex[0].start=ft[0]+ft[1]+ft[2]+ft[3]+ft[4]+ft[5])+(ft[6]+7>>3),ft})(j),ne=Fe(X[7]<<9),se=0,be=0;{for(se=0;se<8;++se)ne.write_shift(1,fe[se]);for(se=0;se<8;++se)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),se=0;se<3;++se)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,X[2]),ne.write_shift(4,X[0]+X[1]+X[2]+X[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,X[3]?X[0]+X[1]+X[2]-1:Ee),ne.write_shift(4,X[3]),ne.write_shift(-4,X[1]?X[0]-1:Ee),ne.write_shift(4,X[1]),se=0;se<109;++se)ne.write_shift(-4,se<X[2]?X[1]+se:-1)}if(X[1])for(be=0;be<X[1];++be){for(;se<236+be*127;++se)ne.write_shift(-4,se<X[2]?X[1]+se:-1);ne.write_shift(-4,be===X[1]-1?Ee:be+1)}var Ce=function(et){for(be+=et;se<be-1;++se)ne.write_shift(-4,se+1);et&&(++se,ne.write_shift(-4,Ee))};for(be=se=0,be+=X[1];se<be;++se)ne.write_shift(-4,O.DIFSECT);for(be+=X[2];se<be;++se)ne.write_shift(-4,O.FATSECT);Ce(X[3]),Ce(X[4]);for(var _e=0,xe=0,ke=j.FileIndex[0];_e<j.FileIndex.length;++_e)ke=j.FileIndex[_e],ke.content&&(xe=ke.content.length,!(xe<4096)&&(ke.start=be,Ce(xe+511>>9)));for(Ce(X[6]+7>>3);ne.l&511;)ne.write_shift(-4,O.ENDOFCHAIN);for(be=se=0,_e=0;_e<j.FileIndex.length;++_e)ke=j.FileIndex[_e],ke.content&&(xe=ke.content.length,!(!xe||xe>=4096)&&(ke.start=be,Ce(xe+63>>6)));for(;ne.l&511;)ne.write_shift(-4,O.ENDOFCHAIN);for(se=0;se<X[4]<<2;++se){var Re=j.FullPaths[se];if(!Re||Re.length===0){for(_e=0;_e<17;++_e)ne.write_shift(4,0);for(_e=0;_e<3;++_e)ne.write_shift(4,-1);for(_e=0;_e<12;++_e)ne.write_shift(4,0);continue}ke=j.FileIndex[se],se===0&&(ke.start=ke.size?ke.start-1:Ee);var Ke=se===0&&K.root||ke.name;if(xe=2*(Ke.length+1),ne.write_shift(64,Ke,"utf16le"),ne.write_shift(2,xe),ne.write_shift(1,ke.type),ne.write_shift(1,ke.color),ne.write_shift(-4,ke.L),ne.write_shift(-4,ke.R),ne.write_shift(-4,ke.C),ke.clsid)ne.write_shift(16,ke.clsid,"hex");else for(_e=0;_e<4;++_e)ne.write_shift(4,0);ne.write_shift(4,ke.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,ke.start),ne.write_shift(4,ke.size),ne.write_shift(4,0)}for(se=1;se<j.FileIndex.length;++se)if(ke=j.FileIndex[se],ke.size>=4096)if(ne.l=ke.start+1<<9,Pt&&Buffer.isBuffer(ke.content))ke.content.copy(ne,ne.l,0,ke.size),ne.l+=ke.size+511&-512;else{for(_e=0;_e<ke.size;++_e)ne.write_shift(1,ke.content[_e]);for(;_e&511;++_e)ne.write_shift(1,0)}for(se=1;se<j.FileIndex.length;++se)if(ke=j.FileIndex[se],ke.size>0&&ke.size<4096)if(Pt&&Buffer.isBuffer(ke.content))ke.content.copy(ne,ne.l,0,ke.size),ne.l+=ke.size+63&-64;else{for(_e=0;_e<ke.size;++_e)ne.write_shift(1,ke.content[_e]);for(;_e&63;++_e)ne.write_shift(1,0)}if(Pt)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function he(j,Q){var K=j.FullPaths.map(function(_e){return _e.toUpperCase()}),X=K.map(function(_e){var xe=_e.split("/");return xe[xe.length-(_e.slice(-1)=="/"?2:1)]}),ne=!1;Q.charCodeAt(0)===47?(ne=!0,Q=K[0].slice(0,-1)+Q):ne=Q.indexOf("/")!==-1;var se=Q.toUpperCase(),be=ne===!0?K.indexOf(se):X.indexOf(se);if(be!==-1)return j.FileIndex[be];var Ce=!se.match(Ru);for(se=se.replace(Cn,""),Ce&&(se=se.replace(Ru,"!")),be=0;be<K.length;++be)if((Ce?K[be].replace(Ru,"!"):K[be]).replace(Cn,"")==se||(Ce?X[be].replace(Ru,"!"):X[be]).replace(Cn,"")==se)return j.FileIndex[be];return null}var ce=64,Ee=-2,je="d0cf11e0a1b11ae1",fe=[208,207,17,224,161,177,26,225],ue="00000000000000000000000000000000",O={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ee,FREESECT:-1,HEADER_SIGNATURE:je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ue,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function F(j,Q,K){p();var X=ye(j,K);m.writeFileSync(Q,X)}function M(j){for(var Q=new Array(j.length),K=0;K<j.length;++K)Q[K]=String.fromCharCode(j[K]);return Q.join("")}function ie(j,Q){var K=ye(j,Q);switch(Q&&Q.type||"buffer"){case"file":return p(),m.writeFileSync(Q.filename,K),K;case"binary":return typeof K=="string"?K:M(K);case"base64":return nd(typeof K=="string"?K:M(K));case"buffer":if(Pt)return Buffer.isBuffer(K)?K:ds(K);case"array":return typeof K=="string"?fa(K):K}return K}var Y;function R(j){try{var Q=j.InflateRaw,K=new Q;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)Y=j;else throw new Error("zlib does not expose bytesRead")}catch(X){console.error("cannot use native zlib: "+(X.message||X))}}function z(j,Q){if(!Y)return ui(j,Q);var K=Y.InflateRaw,X=new K,ne=X._processChunk(j.slice(j.l),X._finishFlushFlag);return j.l+=X.bytesRead,ne}function U(j){return Y?Y.deflateRawSync(j):pt(j)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function oe(j){var Q=(j<<1|j<<11)&139536|(j<<5|j<<15)&558144;return(Q>>16|Q>>8|Q)&255}for(var de=typeof Uint8Array<"u",ge=de?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)ge[Oe]=oe(Oe);function q(j,Q){var K=ge[j&255];return Q<=8?K>>>8-Q:(K=K<<8|ge[j>>8&255],Q<=16?K>>>16-Q:(K=K<<8|ge[j>>16&255],K>>>24-Q))}function Ze(j,Q){var K=Q&7,X=Q>>>3;return(j[X]|(K<=6?0:j[X+1]<<8))>>>K&3}function Je(j,Q){var K=Q&7,X=Q>>>3;return(j[X]|(K<=5?0:j[X+1]<<8))>>>K&7}function Ye(j,Q){var K=Q&7,X=Q>>>3;return(j[X]|(K<=4?0:j[X+1]<<8))>>>K&15}function nt(j,Q){var K=Q&7,X=Q>>>3;return(j[X]|(K<=3?0:j[X+1]<<8))>>>K&31}function Be(j,Q){var K=Q&7,X=Q>>>3;return(j[X]|(K<=1?0:j[X+1]<<8))>>>K&127}function bt(j,Q,K){var X=Q&7,ne=Q>>>3,se=(1<<K)-1,be=j[ne]>>>X;return K<8-X||(be|=j[ne+1]<<8-X,K<16-X)||(be|=j[ne+2]<<16-X,K<24-X)||(be|=j[ne+3]<<24-X),be&se}function dt(j,Q,K){var X=Q&7,ne=Q>>>3;return X<=5?j[ne]|=(K&7)<<X:(j[ne]|=K<<X&255,j[ne+1]=(K&7)>>8-X),Q+3}function ht(j,Q,K){var X=Q&7,ne=Q>>>3;return K=(K&1)<<X,j[ne]|=K,Q+1}function Kt(j,Q,K){var X=Q&7,ne=Q>>>3;return K<<=X,j[ne]|=K&255,K>>>=8,j[ne+1]=K,Q+8}function In(j,Q,K){var X=Q&7,ne=Q>>>3;return K<<=X,j[ne]|=K&255,K>>>=8,j[ne+1]=K&255,j[ne+2]=K>>>8,Q+16}function zr(j,Q){var K=j.length,X=2*K>Q?2*K:Q+5,ne=0;if(K>=Q)return j;if(Pt){var se=m1(X);if(j.copy)j.copy(se);else for(;ne<j.length;++ne)se[ne]=j[ne];return se}else if(de){var be=new Uint8Array(X);if(be.set)be.set(j);else for(;ne<K;++ne)be[ne]=j[ne];return be}return j.length=X,j}function Er(j){for(var Q=new Array(j),K=0;K<j;++K)Q[K]=0;return Q}function fn(j,Q,K){var X=1,ne=0,se=0,be=0,Ce=0,_e=j.length,xe=de?new Uint16Array(32):Er(32);for(se=0;se<32;++se)xe[se]=0;for(se=_e;se<K;++se)j[se]=0;_e=j.length;var ke=de?new Uint16Array(_e):Er(_e);for(se=0;se<_e;++se)xe[ne=j[se]]++,X<ne&&(X=ne),ke[se]=0;for(xe[0]=0,se=1;se<=X;++se)xe[se+16]=Ce=Ce+xe[se-1]<<1;for(se=0;se<_e;++se)Ce=j[se],Ce!=0&&(ke[se]=xe[Ce+16]++);var Re=0;for(se=0;se<_e;++se)if(Re=j[se],Re!=0)for(Ce=q(ke[se],X)>>X-Re,be=(1<<X+4-Re)-1;be>=0;--be)Q[Ce|be<<Re]=Re&15|se<<4;return X}var Fr=de?new Uint16Array(512):Er(512),sn=de?new Uint16Array(32):Er(32);if(!de){for(var Qt=0;Qt<512;++Qt)Fr[Qt]=0;for(Qt=0;Qt<32;++Qt)sn[Qt]=0}(function(){for(var j=[],Q=0;Q<32;Q++)j.push(5);fn(j,sn,32);var K=[];for(Q=0;Q<=143;Q++)K.push(8);for(;Q<=255;Q++)K.push(9);for(;Q<=279;Q++)K.push(7);for(;Q<=287;Q++)K.push(8);fn(K,Fr,288)})();var Cr=(function(){for(var Q=de?new Uint8Array(32768):[],K=0,X=0;K<ae.length-1;++K)for(;X<ae[K+1];++X)Q[X]=K;for(;X<32768;++X)Q[X]=29;var ne=de?new Uint8Array(259):[];for(K=0,X=0;K<W.length-1;++K)for(;X<W[K+1];++X)ne[X]=K;function se(Ce,_e){for(var xe=0;xe<Ce.length;){var ke=Math.min(65535,Ce.length-xe),Re=xe+ke==Ce.length;for(_e.write_shift(1,+Re),_e.write_shift(2,ke),_e.write_shift(2,~ke&65535);ke-- >0;)_e[_e.l++]=Ce[xe++]}return _e.l}function be(Ce,_e){for(var xe=0,ke=0,Re=de?new Uint16Array(32768):[];ke<Ce.length;){var Ke=Math.min(65535,Ce.length-ke);if(Ke<10){for(xe=dt(_e,xe,+(ke+Ke==Ce.length)),xe&7&&(xe+=8-(xe&7)),_e.l=xe/8|0,_e.write_shift(2,Ke),_e.write_shift(2,~Ke&65535);Ke-- >0;)_e[_e.l++]=Ce[ke++];xe=_e.l*8;continue}xe=dt(_e,xe,+(ke+Ke==Ce.length)+2);for(var et=0;Ke-- >0;){var We=Ce[ke];et=(et<<5^We)&32767;var Ue=-1,st=0;if((Ue=Re[et])&&(Ue|=ke&-32768,Ue>ke&&(Ue-=32768),Ue<ke))for(;Ce[Ue+st]==Ce[ke+st]&&st<250;)++st;if(st>2){We=ne[st],We<=22?xe=Kt(_e,xe,ge[We+1]>>1)-1:(Kt(_e,xe,3),xe+=5,Kt(_e,xe,ge[We-23]>>5),xe+=3);var $t=We<8?0:We-4>>2;$t>0&&(In(_e,xe,st-W[We]),xe+=$t),We=Q[ke-Ue],xe=Kt(_e,xe,ge[We]>>3),xe-=3;var Wt=We<4?0:We-2>>1;Wt>0&&(In(_e,xe,ke-Ue-ae[We]),xe+=Wt);for(var ar=0;ar<st;++ar)Re[et]=ke&32767,et=(et<<5^Ce[ke])&32767,++ke;Ke-=st-1}else We<=143?We=We+48:xe=ht(_e,xe,1),xe=Kt(_e,xe,ge[We]),Re[et]=ke&32767,++ke}xe=Kt(_e,xe,0)-1}return _e.l=(xe+7)/8|0,_e.l}return function(_e,xe){return _e.length<8?se(_e,xe):be(_e,xe)}})();function pt(j){var Q=Fe(50+Math.floor(j.length*1.1)),K=Cr(j,Q);return Q.slice(0,K)}var At=de?new Uint16Array(32768):Er(32768),Ar=de?new Uint16Array(32768):Er(32768),Zt=de?new Uint16Array(128):Er(128),ct=1,li=1;function ci(j,Q){var K=nt(j,Q)+257;Q+=5;var X=nt(j,Q)+1;Q+=5;var ne=Ye(j,Q)+4;Q+=4;for(var se=0,be=de?new Uint8Array(19):Er(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,xe=de?new Uint8Array(8):Er(8),ke=de?new Uint8Array(8):Er(8),Re=be.length,Ke=0;Ke<ne;++Ke)be[te[Ke]]=se=Je(j,Q),_e<se&&(_e=se),xe[se]++,Q+=3;var et=0;for(xe[0]=0,Ke=1;Ke<=_e;++Ke)ke[Ke]=et=et+xe[Ke-1]<<1;for(Ke=0;Ke<Re;++Ke)(et=be[Ke])!=0&&(Ce[Ke]=ke[et]++);var We=0;for(Ke=0;Ke<Re;++Ke)if(We=be[Ke],We!=0){et=ge[Ce[Ke]]>>8-We;for(var Ue=(1<<7-We)-1;Ue>=0;--Ue)Zt[et|Ue<<We]=We&7|Ke<<3}var st=[];for(_e=1;st.length<K+X;)switch(et=Zt[Be(j,Q)],Q+=et&7,et>>>=3){case 16:for(se=3+Ze(j,Q),Q+=2,et=st[st.length-1];se-- >0;)st.push(et);break;case 17:for(se=3+Je(j,Q),Q+=3;se-- >0;)st.push(0);break;case 18:for(se=11+Be(j,Q),Q+=7;se-- >0;)st.push(0);break;default:st.push(et),_e<et&&(_e=et);break}var $t=st.slice(0,K),Wt=st.slice(K);for(Ke=K;Ke<286;++Ke)$t[Ke]=0;for(Ke=X;Ke<30;++Ke)Wt[Ke]=0;return ct=fn($t,At,286),li=fn(Wt,Ar,30),Q}function Wn(j,Q){if(j[0]==3&&!(j[1]&3))return[oo(Q),2];for(var K=0,X=0,ne=m1(Q||1<<18),se=0,be=ne.length>>>0,Ce=0,_e=0;(X&1)==0;){if(X=Je(j,K),K+=3,X>>>1)X>>1==1?(Ce=9,_e=5):(K=ci(j,K),Ce=ct,_e=li);else{K&7&&(K+=8-(K&7));var xe=j[K>>>3]|j[(K>>>3)+1]<<8;if(K+=32,xe>0)for(!Q&&be<se+xe&&(ne=zr(ne,se+xe),be=ne.length);xe-- >0;)ne[se++]=j[K>>>3],K+=8;continue}for(;;){!Q&&be<se+32767&&(ne=zr(ne,se+32767),be=ne.length);var ke=bt(j,K,Ce),Re=X>>>1==1?Fr[ke]:At[ke];if(K+=Re&15,Re>>>=4,(Re>>>8&255)===0)ne[se++]=Re;else{if(Re==256)break;Re-=257;var Ke=Re<8?0:Re-4>>2;Ke>5&&(Ke=0);var et=se+W[Re];Ke>0&&(et+=bt(j,K,Ke),K+=Ke),ke=bt(j,K,_e),Re=X>>>1==1?sn[ke]:Ar[ke],K+=Re&15,Re>>>=4;var We=Re<4?0:Re-2>>1,Ue=ae[Re];for(We>0&&(Ue+=bt(j,K,We),K+=We),!Q&&be<et&&(ne=zr(ne,et+100),be=ne.length);se<et;)ne[se]=ne[se-Ue],++se}}}return Q?[ne,K+7>>>3]:[ne.slice(0,se),K+7>>>3]}function ui(j,Q){var K=j.slice(j.l||0),X=Wn(K,Q);return j.l+=X[1],X[0]}function di(j,Q){if(j)typeof console<"u"&&console.error(Q);else throw new Error(Q)}function va(j,Q){var K=j;un(K,0);var X=[],ne=[],se={FileIndex:X,FullPaths:ne};I(se,{root:Q.root});for(var be=K.length-4;(K[be]!=80||K[be+1]!=75||K[be+2]!=5||K[be+3]!=6)&&be>=0;)--be;K.l=be+4,K.l+=4;var Ce=K.read_shift(2);K.l+=6;var _e=K.read_shift(4);for(K.l=_e,be=0;be<Ce;++be){K.l+=20;var xe=K.read_shift(4),ke=K.read_shift(4),Re=K.read_shift(2),Ke=K.read_shift(2),et=K.read_shift(2);K.l+=8;var We=K.read_shift(4),Ue=d(K.slice(K.l+Re,K.l+Re+Ke));K.l+=Re+Ke+et;var st=K.l;K.l=We+4,hn(K,xe,ke,se,Ue),K.l=st}return se}function hn(j,Q,K,X,ne){j.l+=2;var se=j.read_shift(2),be=j.read_shift(2),Ce=l(j);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var _e=j.read_shift(4),xe=j.read_shift(4),ke=j.read_shift(4),Re=j.read_shift(2),Ke=j.read_shift(2),et="",We=0;We<Re;++We)et+=String.fromCharCode(j[j.l++]);if(Ke){var Ue=d(j.slice(j.l,j.l+Ke));(Ue[21589]||{}).mt&&(Ce=Ue[21589].mt),((ne||{})[21589]||{}).mt&&(Ce=ne[21589].mt)}j.l+=Ke;var st=j.slice(j.l,j.l+xe);switch(be){case 8:st=z(j,ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+be)}var $t=!1;se&8&&(_e=j.read_shift(4),_e==134695760&&(_e=j.read_shift(4),$t=!0),xe=j.read_shift(4),ke=j.read_shift(4)),xe!=Q&&di($t,"Bad compressed size: "+Q+" != "+xe),ke!=K&&di($t,"Bad uncompressed size: "+K+" != "+ke),ea(X,et,st,{unsafe:!0,mt:Ce})}function sr(j,Q){var K=Q||{},X=[],ne=[],se=Fe(1),be=K.compression?8:0,Ce=0,_e=0,xe=0,ke=0,Re=0,Ke=j.FullPaths[0],et=Ke,We=j.FileIndex[0],Ue=[],st=0;for(_e=1;_e<j.FullPaths.length;++_e)if(et=j.FullPaths[_e].slice(Ke.length),We=j.FileIndex[_e],!(!We.size||!We.content||et=="Sh33tJ5")){var $t=ke,Wt=Fe(et.length);for(xe=0;xe<et.length;++xe)Wt.write_shift(1,et.charCodeAt(xe)&127);Wt=Wt.slice(0,Wt.l),Ue[Re]=XA.buf(We.content,0);var ar=We.content;be==8&&(ar=U(ar)),se=Fe(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Ce),se.write_shift(2,be),We.mt?s(se,We.mt):se.write_shift(4,0),se.write_shift(-4,Ue[Re]),se.write_shift(4,ar.length),se.write_shift(4,We.content.length),se.write_shift(2,Wt.length),se.write_shift(2,0),ke+=se.length,X.push(se),ke+=Wt.length,X.push(Wt),ke+=ar.length,X.push(ar),se=Fe(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Ce),se.write_shift(2,be),se.write_shift(4,0),se.write_shift(-4,Ue[Re]),se.write_shift(4,ar.length),se.write_shift(4,We.content.length),se.write_shift(2,Wt.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,$t),st+=se.l,ne.push(se),st+=Wt.length,ne.push(Wt),++Re}return se=Fe(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Re),se.write_shift(2,Re),se.write_shift(4,st),se.write_shift(4,ke),se.write_shift(2,0),nn([nn(X),nn(ne),se])}var za={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function fi(j,Q){if(j.ctype)return j.ctype;var K=j.name||"",X=K.match(/\.([^\.]+)$/);return X&&za[X[1]]||Q&&(X=(K=Q).match(/[\.\\]([^\.\\])+$/),X&&za[X[1]])?za[X[1]]:"application/octet-stream"}function ms(j){for(var Q=nd(j),K=[],X=0;X<Q.length;X+=76)K.push(Q.slice(X,X+76));return K.join(`\r
`)+`\r
`}function ps(j){var Q=j.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var ke=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(ke.length==1?"0"+ke:ke)});Q=Q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Q.charAt(0)==`
`&&(Q="=0D"+Q.slice(1)),Q=Q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],X=Q.split(`\r
`),ne=0;ne<X.length;++ne){var se=X[ne];if(se.length==0){K.push("");continue}for(var be=0;be<se.length;){var Ce=76,_e=se.slice(be,be+Ce);_e.charAt(Ce-1)=="="?Ce--:_e.charAt(Ce-2)=="="?Ce-=2:_e.charAt(Ce-3)=="="&&(Ce-=3),_e=se.slice(be,be+Ce),be+=Ce,be<se.length&&(_e+="="),K.push(_e)}}return K.join(`\r
`)}function gs(j){for(var Q=[],K=0;K<j.length;++K){for(var X=j[K];K<=j.length&&X.charAt(X.length-1)=="=";)X=X.slice(0,X.length-1)+j[++K];Q.push(X)}for(var ne=0;ne<Q.length;++ne)Q[ne]=Q[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return fa(Q.join(`\r
`))}function Ri(j,Q,K){for(var X="",ne="",se="",be,Ce=0;Ce<10;++Ce){var _e=Q[Ce];if(!_e||_e.match(/^\s*$/))break;var xe=_e.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":X=xe[2].trim();break;case"content-type":se=xe[2].trim();break;case"content-transfer-encoding":ne=xe[2].trim();break}}switch(++Ce,ne.toLowerCase()){case"base64":be=fa(pa(Q.slice(Ce).join("")));break;case"quoted-printable":be=gs(Q.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var ke=ea(j,X.slice(K.length),be,{unsafe:!0});se&&(ke.ctype=se)}function hi(j,Q){if(M(j.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=Q&&Q.root||"",X=(Pt&&Buffer.isBuffer(j)?j.toString("binary"):M(j)).split(`\r
`),ne=0,se="";for(ne=0;ne<X.length;++ne)if(se=X[ne],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),K||(K=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),se.slice(0,K.length)!=K););var be=(X[1]||"").match(/boundary="(.*?)"/);if(!be)throw new Error("MAD cannot find boundary");var Ce="--"+(be[1]||""),_e=[],xe=[],ke={FileIndex:_e,FullPaths:xe};I(ke);var Re,Ke=0;for(ne=0;ne<X.length;++ne){var et=X[ne];et!==Ce&&et!==Ce+"--"||(Ke++&&Ri(ke,X.slice(Re,ne),K),Re=ne)}return ke}function Ua(j,Q){var K=Q||{},X=K.boundary||"SheetJS";X="------="+X;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+X.slice(2)+'"',"","",""],se=j.FullPaths[0],be=se,Ce=j.FileIndex[0],_e=1;_e<j.FullPaths.length;++_e)if(be=j.FullPaths[_e].slice(se.length),Ce=j.FileIndex[_e],!(!Ce.size||!Ce.content||be=="Sh33tJ5")){be=be.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(st){return"_x"+st.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(st){return"_u"+st.charCodeAt(0).toString(16)+"_"});for(var xe=Ce.content,ke=Pt&&Buffer.isBuffer(xe)?xe.toString("binary"):M(xe),Re=0,Ke=Math.min(1024,ke.length),et=0,We=0;We<=Ke;++We)(et=ke.charCodeAt(We))>=32&&et<128&&++Re;var Ue=Re>=Ke*4/5;ne.push(X),ne.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+be),ne.push("Content-Transfer-Encoding: "+(Ue?"quoted-printable":"base64")),ne.push("Content-Type: "+fi(Ce,be)),ne.push(""),ne.push(Ue?ps(ke):ms(ke))}return ne.push(X+`--\r
`),ne.join(`\r
`)}function Li(j){var Q={};return I(Q,j),Q}function ea(j,Q,K,X){var ne=X&&X.unsafe;ne||I(j);var se=!ne&&ut.find(j,Q);if(!se){var be=j.FullPaths[0];Q.slice(0,be.length)==be?be=Q:(be.slice(-1)!="/"&&(be+="/"),be=(be+Q).replace("//","/")),se={name:a(Q),type:2},j.FileIndex.push(se),j.FullPaths.push(be),ne||ut.utils.cfb_gc(j)}return se.content=K,se.size=K?K.length:0,X&&(X.CLSID&&(se.clsid=X.CLSID),X.mt&&(se.mt=X.mt),X.ct&&(se.ct=X.ct)),se}function Ie(j,Q){I(j);var K=ut.find(j,Q);if(K){for(var X=0;X<j.FileIndex.length;++X)if(j.FileIndex[X]==K)return j.FileIndex.splice(X,1),j.FullPaths.splice(X,1),!0}return!1}function Le(j,Q,K){I(j);var X=ut.find(j,Q);if(X){for(var ne=0;ne<j.FileIndex.length;++ne)if(j.FileIndex[ne]==X)return j.FileIndex[ne].name=a(K),j.FullPaths[ne]=K,!0}return!1}function De(j){re(j,!0)}return t.find=he,t.read=B,t.parse=g,t.write=ie,t.writeFile=F,t.utils={cfb_new:Li,cfb_add:ea,cfb_del:Ie,cfb_mov:Le,cfb_gc:De,ReadShift:$u,CheckField:lw,prep_blob:un,bconcat:nn,use_zlib:R,_deflateRaw:pt,_inflateRaw:ui,consts:O},t})();let so;function JA(e){so=e}function QA(e){return typeof e=="string"?yd(e):Array.isArray(e)?SA(e):e}function wd(e,t,r){if(typeof so<"u"&&so.writeFileSync)return r?so.writeFileSync(e,t,r):so.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=yd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Pi(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([QA(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(e);return d.open("w"),d.encoding="binary",Array.isArray(t)&&(t=ho(t)),d.write(t),d.close(),t}catch(m){if(!m.message||!m.message.match(/onstruct/))throw m}throw new Error("cannot save file "+e)}function eN(e){if(typeof so<"u")return so.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Tr(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function b1(e,t){for(var r=[],n=Tr(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Bh(e){for(var t=[],r=Tr(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function zh(e){for(var t=[],r=Tr(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function tN(e){for(var t=[],r=Tr(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var _h=new Date(1899,11,30,0,0,0);function Zr(e,t){var r=e.getTime(),n=_h.getTime()+(e.getTimezoneOffset()-_h.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var V_=new Date,rN=_h.getTime()+(V_.getTimezoneOffset()-_h.getTimezoneOffset())*6e4,k1=V_.getTimezoneOffset();function Uh(e){var t=new Date;return t.setTime(e*24*60*60*1e3+rN),t.getTimezoneOffset()!==k1&&t.setTime(t.getTime()+(t.getTimezoneOffset()-k1)*6e4),t}function nN(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var S1=new Date("2017-02-19T19:06:09.000Z"),G_=isNaN(S1.getFullYear())?new Date("2/19/17"):S1,aN=G_.getFullYear()==2017;function mr(e,t){var r=new Date(e);if(aN)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(G_.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function al(e,t){if(Pt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Pi(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Pi(D_(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Pi(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Pi(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ir(e[r]));return t}function br(e,t){for(var r="";r.length<t;)r+=e;return r}function ii(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var iN=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pc(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&iN.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var sN=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),l=[s[0]],d=1;d<s.length;++d)l.push(a),l.push(s[d]);return l}})();function K_(e){return e?e.content&&e.type?al(e.content,!0):e.data?yc(e.data):e.asNodeBuffer&&Pt?yc(e.asNodeBuffer().toString("binary")):e.asBinary?yc(e.asBinary()):e._data&&e._data.getContent?yc(al(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Z_(e){if(!e)return null;if(e.data)return gh(e.data);if(e.asNodeBuffer&&Pt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?gh(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function oN(e){return e&&e.name.slice(-4)===".bin"?Z_(e):K_(e)}function ja(e,t){for(var r=e.FullPaths||Tr(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var l=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function $p(e,t){var r=ja(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Lr(e,t,r){if(!r)return oN($p(e,t));if(!t)return null;try{return Lr(e,t)}catch{return null}}function ha(e,t,r){if(!r)return K_($p(e,t));if(!t)return null;try{return ha(e,t)}catch{return null}}function lN(e,t,r){return Z_($p(e,t))}function T1(e){for(var t=e.FullPaths||Tr(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Nt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Pt?n=ds(r):n=TA(r),ut.utils.cfb_add(e,t,n)}ut.utils.cfb_add(e,t,r)}else e.file(t,r)}function Wp(){return ut.utils.cfb_new()}function Y_(e,t){switch(t.type){case"base64":return ut.read(e,{type:"base64"});case"binary":return ut.read(e,{type:"binary"});case"buffer":case"array":return ut.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Lu(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Dr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,cN=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,E1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,uN=/<[^>]*>/g,Pn=Dr.match(E1)?E1:uN,dN=/<\w*:/,fN=/<(\/?)\w+:/;function wt(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var l=e.match(cN),d=0,m="",p=0,g="",y="",_=1;if(l)for(p=0;p!=l.length;++p){for(y=l[p],s=0;s!=y.length&&y.charCodeAt(s)!==61;++s);for(g=y.slice(0,s).trim();y.charCodeAt(s+1)==32;)++s;for(_=(a=y.charCodeAt(s+1))==34||a==39?1:0,m=y.slice(s+1+_,y.length-_),d=0;d!=g.length&&g.charCodeAt(d)!==58;++d);if(d===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),n[g]=m,n[g.toLowerCase()]=m;else{var T=(d===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(d+1);if(n[T]&&g.slice(d-3,d)=="ext")continue;n[T]=m,n[T.toLowerCase()]=m}}return n}function ji(e){return e.replace(fN,"<$1")}var q_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Hp=Bh(q_),Ut=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(d,m){return q_[d]||String.fromCharCode(parseInt(m,d.indexOf("x")>-1?16:10))||d}).replace(t,function(d,m){return String.fromCharCode(parseInt(m,16))});var l=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,l)+r(a.slice(l+3))}})(),Vp=/[&<>'"]/g,hN=/[\u0000-\u0008\u000b-\u001f]/g;function Jt(e){var t=e+"";return t.replace(Vp,function(r){return Hp[r]}).replace(hN,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function C1(e){return Jt(e).replace(/ /g,"_x0020_")}var X_=/[\u0000-\u001f]/g;function Gp(e){var t=e+"";return t.replace(Vp,function(r){return Hp[r]}).replace(/\n/g,"<br/>").replace(X_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function mN(e){var t=e+"";return t.replace(Vp,function(r){return Hp[r]}).replace(X_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var A1=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function pN(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function fr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Rm(e){for(var t="",r=0,n=0,a=0,s=0,l=0,d=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}l=e.charCodeAt(r++),d=((n&7)<<18|(a&63)<<12|(s&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(d>>>10&1023)),t+=String.fromCharCode(56320+(d&1023))}return t}function N1(e){var t=oo(2*e.length),r,n,a=1,s=0,l=0,d;for(n=0;n<e.length;n+=a)a=1,(d=e.charCodeAt(n))<128?r=d:d<224?(r=(d&31)*64+(e.charCodeAt(n+1)&63),a=2):d<240?(r=(d&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(d&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[s++]=l&255,t[s++]=l>>>8,l=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function P1(e){return ds(e,"binary").toString("utf8")}var Zf="foo bar bazâð£",nr=Pt&&(P1(Zf)==Rm(Zf)&&P1||N1(Zf)==Rm(Zf)&&N1)||Rm,Pi=Pt?function(e){return ds(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},id=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),J_=(function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),gN=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),vN=/<\/?(?:vt:)?variant>/g,xN=/<(?:vt:)([^>]*)>([\s\S]*)</;function I1(e,t){var r=wt(e),n=e.match(gN(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var l=s.replace(vN,"").match(xN);l&&a.push({v:nr(l[2]),t:l[1]})}),a}var Q_=/(^\s|\s$|\n)/;function dn(e,t){return"<"+e+(t.match(Q_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function sd(e){return Tr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Xe(e,t,r){return"<"+e+(r!=null?sd(r):"")+(t!=null?(t.match(Q_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function mp(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function yN(e,t){switch(typeof e){case"string":var r=Xe("vt:lpwstr",Jt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Xe((e|0)==e?"vt:i4":"vt:r8",Jt(String(e)));case"boolean":return Xe("vt:bool",e?"true":"false")}if(e instanceof Date)return Xe("vt:filetime",mp(e));throw new Error("Unable to serialize "+e)}function Kp(e){if(Pt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return nr(ho(Bp(e)));throw new Error("Bad input format: expected Buffer or string")}var od=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Kr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},fl=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],da={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function _N(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function wN(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,l=n?-t:t;isFinite(l)?l==0?a=s=0:(a=Math.floor(Math.log(l)/Math.LN2),s=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var d=0;d<=5;++d,s/=256)e[r+d]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var D1=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},F1=Pt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ds(t)})):D1(e)}:D1,j1=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(ss(e,a)));return n.join("").replace(Cn,"")},$h=Pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Cn,""):j1(e,t,r)}:j1,O1=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},ew=Pt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):O1(e,t,r)}:O1,R1=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(xc(e,a)));return n.join("")},Rc=Pt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):R1(t,r,n)}:R1,tw=function(e,t){var r=rn(e,t);return r>0?Rc(e,t+4,t+4+r-1):""},Zp=tw,rw=function(e,t){var r=rn(e,t);return r>0?Rc(e,t+4,t+4+r-1):""},Yp=rw,nw=function(e,t){var r=2*rn(e,t);return r>0?Rc(e,t+4,t+4+r-1):""},qp=nw,aw=function(t,r){var n=rn(t,r);return n>0?$h(t,r+4,r+4+n):""},Xp=aw,iw=function(e,t){var r=rn(e,t);return r>0?Rc(e,t+4,t+4+r):""},Jp=iw,sw=function(e,t){return _N(e,t)},wh=sw,Qp=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Pt&&(Zp=function(t,r){if(!Buffer.isBuffer(t))return tw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Yp=function(t,r){if(!Buffer.isBuffer(t))return rw(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},qp=function(t,r){if(!Buffer.isBuffer(t))return nw(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Xp=function(t,r){if(!Buffer.isBuffer(t))return aw(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Jp=function(t,r){if(!Buffer.isBuffer(t))return iw(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},wh=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):sw(t,r)},Qp=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function ow(){$h=function(e,t,r){return Bt.utils.decode(1200,e.slice(t,r)).replace(Cn,"")},Rc=function(e,t,r){return Bt.utils.decode(65001,e.slice(t,r))},Zp=function(e,t){var r=rn(e,t);return r>0?Bt.utils.decode(rl,e.slice(t+4,t+4+r-1)):""},Yp=function(e,t){var r=rn(e,t);return r>0?Bt.utils.decode(ma,e.slice(t+4,t+4+r-1)):""},qp=function(e,t){var r=2*rn(e,t);return r>0?Bt.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Xp=function(e,t){var r=rn(e,t);return r>0?Bt.utils.decode(1200,e.slice(t+4,t+4+r)):""},Jp=function(e,t){var r=rn(e,t);return r>0?Bt.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof Bt<"u"&&ow();var xc=function(e,t){return e[t]},ss=function(e,t){return e[t+1]*256+e[t]},bN=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},rn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ko=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},kN=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $u(e,t){var r="",n,a,s=[],l,d,m,p;switch(t){case"dbcs":if(p=this.l,Pt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(m=0;m<e;++m)r+=String.fromCharCode(ss(this,p)),p+=2;e*=2;break;case"utf8":r=Rc(this,this.l,this.l+e);break;case"utf16le":e*=2,r=$h(this,this.l,this.l+e);break;case"wstr":if(typeof Bt<"u")r=Bt.utils.decode(ma,this.slice(this.l,this.l+2*e));else return $u.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Zp(this,this.l),e=4+rn(this,this.l);break;case"lpstr-cp":r=Yp(this,this.l),e=4+rn(this,this.l);break;case"lpwstr":r=qp(this,this.l),e=4+2*rn(this,this.l);break;case"lpp4":e=4+rn(this,this.l),r=Xp(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+rn(this,this.l),r=Jp(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=xc(this,this.l+e++))!==0;)s.push(Ou(l));r=s.join("");break;case"_wstr":for(e=0,r="";(l=ss(this,this.l+e))!==0;)s.push(Ou(l)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",p=this.l,m=0;m<e;++m){if(this.lens&&this.lens.indexOf(p)!==-1)return l=xc(this,p),this.l=p+1,d=$u.call(this,e-m,l?"dbcs-cont":"sbcs-cont"),s.join("")+d;s.push(Ou(ss(this,p))),p+=2}r=s.join(""),e*=2;break;case"cpstr":if(typeof Bt<"u"){r=Bt.utils.decode(ma,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",p=this.l,m=0;m!=e;++m){if(this.lens&&this.lens.indexOf(p)!==-1)return l=xc(this,p),this.l=p+1,d=$u.call(this,e-m,l?"dbcs-cont":"sbcs-cont"),s.join("")+d;s.push(Ou(xc(this,p))),p+=1}r=s.join("");break;default:switch(e){case 1:return n=xc(this,this.l),this.l++,n;case 2:return n=(t==="i"?bN:ss)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Ko:kN)(this,this.l),this.l+=4,n):(a=rn(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=wh(this,this.l):a=wh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=ew(this,this.l,e);break}}return this.l+=e,r}var SN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},TN=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},EN=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function CN(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)EN(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof Bt<"u"&&rl==874)for(a=0;a!=t.length;++a){var s=Bt.utils.encode(rl,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var l=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var d=t.charCodeAt(a);this[this.l++]=d&255,this[this.l++]=d>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,SN(this,t,this.l);break;case 8:if(n=8,r==="f"){wN(this,t,this.l);break}case 16:break;case-4:n=4,TN(this,t,this.l);break}return this.l+=n,this}function lw(e,t){var r=ew(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function un(e,t){e.l=t,e.read_shift=$u,e.chk=lw,e.write_shift=CN}function Nn(e,t){e.l+=t}function Fe(e){var t=oo(e);return un(t,0),t}function fs(e,t,r){if(e){var n,a,s;un(e,e.l||0);for(var l=e.length,d=0,m=0;e.l<l;){d=e.read_shift(1),d&128&&(d=(d&127)+((e.read_shift(1)&127)<<7));var p=hd[d]||hd[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;m=e.l+s;var g=p.f&&p.f(e,s,r);if(e.l=m,t(g,p,d))return}}}function Qn(){var e=[],t=Pt?256:2048,r=function(p){var g=Fe(p);return un(g,0),g},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(p){return n&&p<n.length-n.l?n:(a(),n=r(Math.max(p+1,t)))},l=function(){return a(),nn(e)},d=function(p){a(),n=p,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:d,end:l,_bufs:e}}function ze(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=hd[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var l=e.next(s);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var d=0;d!=4;++d)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Qp(r)&&e.push(r)}}function Wu(e,t,r){var n=ir(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function L1(e,t,r){var n=ir(e);return n.s=Wu(n.s,t.s,r),n.e=Wu(n.e,t.s,r),n}function Hu(e,t){if(e.cRel&&e.c<0)for(e=ir(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ir(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=yt(e);return!e.cRel&&e.cRel!=null&&(r=PN(r)),!e.rRel&&e.rRel!=null&&(r=AN(r)),r}function Lm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+hr(e.s.c)+":"+(e.e.cRel?"":"$")+hr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+kr(e.s.r)+":"+(e.e.rRel?"":"$")+kr(e.e.r):Hu(e.s,t.biff)+":"+Hu(e.e,t.biff)}function eg(e){return parseInt(NN(e),10)-1}function kr(e){return""+(e+1)}function AN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function NN(e){return e.replace(/\$(\d+)$/,"$1")}function tg(e){for(var t=IN(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function hr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function PN(e){return e.replace(/^([A-Z])/,"$$$1")}function IN(e){return e.replace(/^\$([A-Z])/,"$1")}function DN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function yt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function $n(e){var t=e.indexOf(":");return t==-1?{s:yr(e),e:yr(e)}:{s:yr(e.slice(0,t)),e:yr(e.slice(t+1))}}function Ct(e,t){return typeof t>"u"||typeof t=="number"?Ct(e.s,e.e):(typeof e!="string"&&(e=yt(e)),typeof t!="string"&&(t=yt(t)),e==t?e:e+":"+t)}function Ot(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function M1(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ga(e.z,r?Zr(t):t)}catch{}try{return e.w=ga((e.XF||{}).numFmtId||(r?14:0),r?Zr(t):t)}catch{return""+t}}function Fi(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?hs[e.v]||e.v:t==null?M1(e,e.v):M1(e,t))}function mo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function cw(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),l=0,d=0;if(s&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var m=typeof n.origin=="string"?yr(n.origin):n.origin;l=m.r,d=m.c}s["!ref"]||(s["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var g=Ot(s["!ref"]);p.s.c=g.s.c,p.s.r=g.s.r,p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),l==-1&&(p.e.r=l=g.e.r+1)}for(var y=0;y!=t.length;++y)if(t[y]){if(!Array.isArray(t[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=t[y].length;++_)if(!(typeof t[y][_]>"u")){var T={v:t[y][_]},S=l+y,w=d+_;if(p.s.r>S&&(p.s.r=S),p.s.c>w&&(p.s.c=w),p.e.r<S&&(p.e.r=S),p.e.c<w&&(p.e.c=w),t[y][_]&&typeof t[y][_]=="object"&&!Array.isArray(t[y][_])&&!(t[y][_]instanceof Date))T=t[y][_];else if(Array.isArray(T.v)&&(T.f=t[y][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(n.nullError)T.t="e",T.v=0;else if(n.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=n.dateNF||xt[14],n.cellDates?(T.t="d",T.w=ga(T.z,Zr(T.v))):(T.t="n",T.v=Zr(T.v),T.w=ga(T.z,T.v))):T.t="s";if(a)s[S]||(s[S]=[]),s[S][w]&&s[S][w].z&&(T.z=s[S][w].z),s[S][w]=T;else{var E=yt({c:w,r:S});s[E]&&s[E].z&&(T.z=s[E].z),s[E]=T}}}return p.s.c<1e7&&(s["!ref"]=Ct(p)),s}function Lc(e,t){return cw(null,e,t)}function FN(e){return e.read_shift(4,"i")}function si(e,t){return t||(t=Fe(4)),t.write_shift(4,e),t}function An(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function an(e,t){var r=!1;return t==null&&(r=!0,t=Fe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function jN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ON(e,t){return t||(t=Fe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function rg(e,t){var r=e.l,n=e.read_shift(1),a=An(e),s=[],l={t:a,h:a};if((n&1)!==0){for(var d=e.read_shift(4),m=0;m!=d;++m)s.push(jN(e));l.r=s}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function RN(e,t){var r=!1;return t==null&&(r=!0,t=Fe(15+4*e.t.length)),t.write_shift(1,0),an(e.t,t),r?t.slice(0,t.l):t}var LN=rg;function MN(e,t){var r=!1;return t==null&&(r=!0,t=Fe(23+4*e.t.length)),t.write_shift(1,1),an(e.t,t),t.write_shift(4,1),ON({},t),r?t.slice(0,t.l):t}function Ba(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function hl(e,t){return t==null&&(t=Fe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ml(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function pl(e,t){return t==null&&(t=Fe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var BN=An,uw=an;function ng(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function bh(e,t){var r=!1;return t==null&&(r=!0,t=Fe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var zN=An,pp=ng,ag=bh;function ig(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?wh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ko(t,0)>>2;return r?a/100:a}function dw(e,t){t==null&&(t=Fe(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function fw(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function UN(e,t){return t||(t=Fe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var gl=fw,Mc=UN;function En(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function il(e,t){return(t||Fe(8)).write_shift(8,e,"f")}function $N(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),l=e.read_shift(1),d=e.read_shift(1),m=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var p=Xo[a];p&&(t.rgb=cd(p));break;case 2:t.rgb=cd([l,d,m]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function kh(e,t){if(t||(t=Fe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function WN(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function HN(e,t){t||(t=Fe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function hw(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function VN(e){return hw(e,1)}function GN(e){return hw(e,2)}var sg=2,Jn=3,Yf=11,B1=12,Sh=19,qf=64,KN=65,ZN=71,YN=4108,qN=4126,en=80,mw=81,XN=[en,mw],gp={1:{n:"CodePage",t:sg},2:{n:"Category",t:en},3:{n:"PresentationFormat",t:en},4:{n:"ByteCount",t:Jn},5:{n:"LineCount",t:Jn},6:{n:"ParagraphCount",t:Jn},7:{n:"SlideCount",t:Jn},8:{n:"NoteCount",t:Jn},9:{n:"HiddenCount",t:Jn},10:{n:"MultimediaClipCount",t:Jn},11:{n:"ScaleCrop",t:Yf},12:{n:"HeadingPairs",t:YN},13:{n:"TitlesOfParts",t:qN},14:{n:"Manager",t:en},15:{n:"Company",t:en},16:{n:"LinksUpToDate",t:Yf},17:{n:"CharacterCount",t:Jn},19:{n:"SharedDoc",t:Yf},22:{n:"HyperlinksChanged",t:Yf},23:{n:"AppVersion",t:Jn,p:"version"},24:{n:"DigSig",t:KN},26:{n:"ContentType",t:en},27:{n:"ContentStatus",t:en},28:{n:"Language",t:en},29:{n:"Version",t:en},255:{},2147483648:{n:"Locale",t:Sh},2147483651:{n:"Behavior",t:Sh},1919054434:{}},vp={1:{n:"CodePage",t:sg},2:{n:"Title",t:en},3:{n:"Subject",t:en},4:{n:"Author",t:en},5:{n:"Keywords",t:en},6:{n:"Comments",t:en},7:{n:"Template",t:en},8:{n:"LastAuthor",t:en},9:{n:"RevNumber",t:en},10:{n:"EditTime",t:qf},11:{n:"LastPrinted",t:qf},12:{n:"CreatedDate",t:qf},13:{n:"ModifiedDate",t:qf},14:{n:"PageCount",t:Jn},15:{n:"WordCount",t:Jn},16:{n:"CharCount",t:Jn},17:{n:"Thumbnail",t:ZN},18:{n:"Application",t:en},19:{n:"DocSecurity",t:Jn},255:{},2147483648:{n:"Locale",t:Sh},2147483651:{n:"Behavior",t:Sh},1919054434:{}},z1={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},JN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function QN(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var e4=QN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Xo=ir(e4),hs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},pw={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},xp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Xf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function og(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function t4(e){var t=og();if(!e||!e.match)return t;var r={};if((e.match(Pn)||[]).forEach(function(n){var a=wt(n);switch(a[0].replace(dN,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[xp[a.ContentType]]!==void 0&&t[xp[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Kr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function gw(e,t){var r=tN(xp),n=[],a;n[n.length]=Dr,n[n.length]=Xe("Types",null,{xmlns:Kr.CT,"xmlns:xsd":Kr.xsd,"xmlns:xsi":Kr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(m){return Xe("Default",null,{Extension:m[0],ContentType:m[1]})}));var s=function(m){e[m]&&e[m].length>0&&(a=e[m][0],n[n.length]=Xe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Xf[m][t.bookType]||Xf[m].xlsx}))},l=function(m){(e[m]||[]).forEach(function(p){n[n.length]=Xe("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:Xf[m][t.bookType]||Xf[m].xlsx})})},d=function(m){(e[m]||[]).forEach(function(p){n[n.length]=Xe("Override",null,{PartName:(p[0]=="/"?"":"/")+p,ContentType:r[m][0]})})};return s("workbooks"),l("sheets"),l("charts"),d("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(d),d("vba"),d("comments"),d("threadedcomments"),d("drawings"),l("metadata"),d("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Dt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ld(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Vu(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Pn)||[]).forEach(function(a){var s=wt(a);if(s[0]==="<Relationship"){var l={};l.Type=s.Type,l.Target=s.Target,l.Id=s.Id,s.TargetMode&&(l.TargetMode=s.TargetMode);var d=s.TargetMode==="External"?s.Target:Lu(s.Target,t);r[d]=l,n[s.Id]=l}}),r["!id"]=n,r}function Sc(e){var t=[Dr,Xe("Relationships",null,{xmlns:Kr.RELS})];return Tr(e["!id"]).forEach(function(r){t[t.length]=Xe("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Xt(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Dt.HLINK,Dt.XPATH,Dt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var r4="application/vnd.oasis.opendocument.spreadsheet";function n4(e,t){for(var r=Kp(e),n,a;n=od.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=wt(n[0],!1),a.path=="/"&&a.type!==r4)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function a4(e){var t=[Dr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function U1(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function i4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function s4(e){var t=[Dr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(U1(e[r][0],e[r][1])),t.push(i4("",e[r][0]));return t.push(U1("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function vw(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+rd.version+"</meta:generator></office:meta></office:document-meta>"}var Ma=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],o4=(function(){for(var e=new Array(Ma.length),t=0;t<Ma.length;++t){var r=Ma[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function xw(e){var t={};e=nr(e);for(var r=0;r<Ma.length;++r){var n=Ma[r],a=e.match(o4[r]);a!=null&&a.length>0&&(t[n[1]]=Ut(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=mr(t[n[1]]))}return t}function Mm(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Jt(t),n[n.length]=r?Xe(e,t,r):dn(e,t))}function yw(e,t){var r=t||{},n=[Dr,Xe("cp:coreProperties",null,{"xmlns:cp":Kr.CORE_PROPS,"xmlns:dc":Kr.dc,"xmlns:dcterms":Kr.dcterms,"xmlns:dcmitype":Kr.dcmitype,"xmlns:xsi":Kr.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Mm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:mp(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Mm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:mp(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=Ma.length;++s){var l=Ma[s],d=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;d===!0?d="1":d===!1?d="0":typeof d=="number"&&(d=String(d)),d!=null&&Mm(l[0],d,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Jo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],_w=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ww(e,t,r,n){var a=[];if(typeof e=="string")a=I1(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(g){return{v:g}}));var l=typeof t=="string"?I1(t,n).map(function(g){return g.v}):t,d=0,m=0;if(l.length>0)for(var p=0;p!==a.length;p+=2){switch(m=+a[p+1].v,a[p].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=m,r.SheetNames=l.slice(d,d+m);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=m,r.DefinedNames=l.slice(d,d+m);break;case"Charts":case"Diagramme":r.Chartsheets=m,r.ChartNames=l.slice(d,d+m);break}d+=m}}function l4(e,t,r){var n={};return t||(t={}),e=nr(e),Jo.forEach(function(a){var s=(e.match(id(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=Ut(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&ww(n.HeadingPairs,n.TitlesOfParts,t,r),t}function bw(e){var t=[],r=Xe;return e||(e={}),e.Application="SheetJS",t[t.length]=Dr,t[t.length]=Xe("Properties",null,{xmlns:Kr.EXT_PROPS,"xmlns:vt":Kr.vt}),Jo.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Jt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Jt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var c4=/<[^>]+>[^<]*/g;function u4(e,t){var r={},n="",a=e.match(c4);if(a)for(var s=0;s!=a.length;++s){var l=a[s],d=wt(l);switch(d[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ut(d.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var m=l.split(">"),p=m[0].slice(4),g=m[1];switch(p){case"lpstr":case"bstr":case"lpwstr":r[n]=Ut(g);break;case"bool":r[n]=fr(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(g);break;case"filetime":case"date":r[n]=mr(g);break;case"cy":case"error":r[n]=Ut(g);break;default:if(p.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,p,m)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function kw(e){var t=[Dr,Xe("Properties",null,{xmlns:Kr.CUST_PROPS,"xmlns:vt":Kr.vt})];if(!e)return t.join("");var r=1;return Tr(e).forEach(function(a){++r,t[t.length]=Xe("property",yN(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Jt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Bm;function d4(e,t,r){Bm||(Bm=Bh(yp)),t=Bm[t]||t,e[t]=r}function f4(e,t){var r=[];return Tr(yp).map(function(n){for(var a=0;a<Ma.length;++a)if(Ma[a][1]==n)return Ma[a];for(a=0;a<Jo.length;++a)if(Jo[a][1]==n)return Jo[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(dn(yp[n[1]]||n[1],a))}}),Xe("DocumentProperties",r.join(""),{xmlns:da.o})}function h4(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Tr(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var l=0;l<Ma.length;++l)if(s==Ma[l][1])return;for(l=0;l<Jo.length;++l)if(s==Jo[l][1])return;for(l=0;l<r.length;++l)if(s==r[l])return;var d=e[s],m="string";typeof d=="number"?(m="float",d=String(d)):d===!0||d===!1?(m="boolean",d=d?"1":"0"):d=String(d),a.push(Xe(C1(s),d,{"dt:dt":m}))}}),t&&Tr(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var l=t[s],d="string";typeof l=="number"?(d="float",l=String(l)):l===!0||l===!1?(d="boolean",l=l?"1":"0"):l instanceof Date?(d="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Xe(C1(s),l,{"dt:dt":d}))}}),"<"+n+' xmlns="'+da.o+'">'+a.join("")+"</"+n+">"}function lg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function m4(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var l=Fe(8);return l.write_shift(4,n),l.write_shift(4,a),l}function Sw(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function Tw(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Ew(e,t,r){return t===31?Tw(e):Sw(e,t,r)}function _p(e,t,r){return Ew(e,t,r===!1?0:4)}function p4(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ew(e,t,0)}function g4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Cn,""),e.l-a&2&&(e.l+=2)}return r}function v4(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Cn,"");return r}function x4(e){var t=e.l,r=Th(e,mw);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Th(e,Jn);return[r,n]}function y4(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(x4(e));return r}function $1(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),l=e.read_shift(4);n[s]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Cn,"").replace(Ru,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Cw(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function _4(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Th(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==B1&&n!==t&&XN.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===B1?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Sw(e,n,4).replace(Cn,"");case 31:return Tw(e);case 64:return lg(e);case 65:return Cw(e);case 71:return _4(e);case 80:return _p(e,n,!s.raw).replace(Cn,"");case 81:return p4(e,n).replace(Cn,"");case 4108:return y4(e);case 4126:case 4127:return n==4127?g4(e):v4(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function W1(e,t){var r=Fe(4),n=Fe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Fe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=m4(t);break;case 31:case 80:for(n=Fe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return nn([r,n])}function H1(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],l=0,d=0,m=-1,p={};for(l=0;l!=a;++l){var g=e.read_shift(4),y=e.read_shift(4);s[l]=[g,y+r]}s.sort(function(D,A){return D[1]-A[1]});var _={};for(l=0;l!=a;++l){if(e.l!==s[l][1]){var T=!0;if(l>0&&t)switch(t[s[l-1][0]].t){case 2:e.l+2===s[l][1]&&(e.l+=2,T=!1);break;case 80:e.l<=s[l][1]&&(e.l=s[l][1],T=!1);break;case 4108:e.l<=s[l][1]&&(e.l=s[l][1],T=!1);break}if((!t||l==0)&&e.l<=s[l][1]&&(T=!1,e.l=s[l][1]),T)throw new Error("Read Error: Expected address "+s[l][1]+" at "+e.l+" :"+l)}if(t){var S=t[s[l][0]];if(_[S.n]=Th(e,S.t,{raw:!0}),S.p==="version"&&(_[S.n]=String(_[S.n]>>16)+"."+("0000"+String(_[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(_[S.n]){case 0:_[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:La(d=_[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[S.n])}}else if(s[l][0]===1){if(d=_.CodePage=Th(e,sg),La(d),m!==-1){var w=e.l;e.l=s[m][1],p=$1(e,d),e.l=w}}else if(s[l][0]===0){if(d===0){m=l,e.l=s[l+1][1];continue}p=$1(e,d)}else{var E=p[s[l][0]],P;switch(e[e.l]){case 65:e.l+=4,P=Cw(e);break;case 30:e.l+=4,P=_p(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,P=_p(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,P=e.read_shift(4,"i");break;case 19:e.l+=4,P=e.read_shift(4);break;case 5:e.l+=4,P=e.read_shift(8,"f");break;case 11:e.l+=4,P=Ir(e,4);break;case 64:e.l+=4,P=mr(lg(e));break;default:throw new Error("unparsed value: "+e[e.l])}_[E]=P}}return e.l=r+n,_}var Aw=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function w4(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function V1(e,t,r){var n=Fe(8),a=[],s=[],l=8,d=0,m=Fe(8),p=Fe(8);if(m.write_shift(4,2),m.write_shift(4,1200),p.write_shift(4,1),s.push(m),a.push(p),l+=8+m.length,!t){p=Fe(8),p.write_shift(4,0),a.unshift(p);var g=[Fe(4)];for(g[0].write_shift(4,e.length),d=0;d<e.length;++d){var y=e[d][0];for(m=Fe(8+2*(y.length+1)+(y.length%2?0:2)),m.write_shift(4,d+2),m.write_shift(4,y.length+1),m.write_shift(0,y,"dbcs");m.l!=m.length;)m.write_shift(1,0);g.push(m)}m=nn(g),s.unshift(m),l+=8+m.length}for(d=0;d<e.length;++d)if(!(t&&!t[e[d][0]])&&!(Aw.indexOf(e[d][0])>-1||_w.indexOf(e[d][0])>-1)&&e[d][1]!=null){var _=e[d][1],T=0;if(t){T=+t[e[d][0]];var S=r[T];if(S.p=="version"&&typeof _=="string"){var w=_.split(".");_=(+w[0]<<16)+(+w[1]||0)}m=W1(S.t,_)}else{var E=w4(_);E==-1&&(E=31,_=String(_)),m=W1(E,_)}s.push(m),p=Fe(8),p.write_shift(4,t?T:2+d),a.push(p),l+=8+m.length}var P=8*(s.length+1);for(d=0;d<s.length;++d)a[d].write_shift(4,P),P+=s[d].length;return n.write_shift(4,l),n.write_shift(4,s.length),nn([n].concat(a).concat(s))}function G1(e,t,r){var n=e.content;if(!n)return{};un(n,0);var a,s,l,d,m=0;n.chk("feff","Byte Order: "),n.read_shift(2);var p=n.read_shift(4),g=n.read_shift(16);if(g!==ut.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),d=n.read_shift(4),a===1&&d!==n.l)throw new Error("Length mismatch: "+d+" !== "+n.l);a===2&&(l=n.read_shift(16),m=n.read_shift(4));var y=H1(n,t),_={SystemIdentifier:p};for(var T in y)_[T]=y[T];if(_.FMTID=s,a===1)return _;if(m-n.l==2&&(n.l+=2),n.l!==m)throw new Error("Length mismatch 2: "+n.l+" !== "+m);var S;try{S=H1(n,null)}catch{}for(T in S)_[T]=S[T];return _.FMTID=[s,l],_}function K1(e,t,r,n,a,s){var l=Fe(a?68:48),d=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,ut.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var m=V1(e,r,n);if(d.push(m),a){var p=V1(a,null,null);l.write_shift(16,s,"hex"),l.write_shift(4,68+m.length),d.push(p)}return nn(d)}function Js(e,t){return e.read_shift(t),null}function b4(e,t){t||(t=Fe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function k4(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Ir(e,t){return e.read_shift(t)===1}function zn(e,t){return t||(t=Fe(2)),t.write_shift(2,+!!e),t}function Mr(e){return e.read_shift(2,"u")}function Oa(e,t){return t||(t=Fe(2)),t.write_shift(2,e),t}function Nw(e,t){return k4(e,t,Mr)}function S4(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Pw(e,t,r){return r||(r=Fe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function bd(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=ma;if(r&&r.biff>=8&&(ma=1200),!r||r.biff==8){var l=e.read_shift(1);l&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var d=n?e.read_shift(n,a):"";return ma=s,d}function T4(e){var t=ma;ma=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,s=n&8,l=1+(n&1),d=0,m,p={};s&&(d=e.read_shift(2)),a&&(m=e.read_shift(4));var g=l==2?"dbcs-cont":"sbcs-cont",y=r===0?"":e.read_shift(r,g);return s&&(e.l+=4*d),a&&(e.l+=m),p.t=y,s||(p.raw="<t>"+p.t+"</t>",p.r=p.t),ma=t,p}function E4(e){var t=e.t||"",r=Fe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Fe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return nn(a)}function sl(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function kd(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):sl(e,n,r)}function vl(e,t,r){if(r.biff>5)return kd(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Iw(e,t,r){return r||(r=Fe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function C4(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function A4(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Cn,"");return n&&(e.l+=24),a}function N4(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(s>>1,"utf16le").replace(Cn,"");return r+l}function P4(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return A4(e);case"0303000000000000c000000000000046":return N4(e);default:throw new Error("Unsupported Moniker "+r)}}function Jf(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Cn,""):"";return r}function Z1(e,t){t||(t=Fe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function I4(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,l,d,m,p="",g,y;a&16&&(s=Jf(e,r-e.l)),a&128&&(l=Jf(e,r-e.l)),(a&257)===257&&(d=Jf(e,r-e.l)),(a&257)===1&&(m=P4(e,r-e.l)),a&8&&(p=Jf(e,r-e.l)),a&32&&(g=e.read_shift(16)),a&64&&(y=lg(e)),e.l=r;var _=l||d||m||"";_&&p&&(_+="#"+p),_||(_="#"+p),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var T={Target:_};return g&&(T.guid=g),y&&(T.time=y),s&&(T.Tooltip=s),T}function D4(e){var t=Fe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(s==28)n=n.slice(1),Z1(n,t);else if(s&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var d=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(d.length+1)),r=0;r<d.length;++r)t.write_shift(2,d.charCodeAt(r));t.write_shift(2,0),s&8&&Z1(a>-1?n.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var m=0;n.slice(m*3,m*3+3)=="../"||n.slice(m*3,m*3+3)=="..\\";)++m;for(t.write_shift(2,m),t.write_shift(4,n.length-3*m+1),r=0;r<n.length-3*m;++r)t.write_shift(1,n.charCodeAt(r+3*m)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Dw(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Fw(e,t){var r=Dw(e);return r[3]=0,r}function Oi(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ol(e,t,r,n){return n||(n=Fe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function F4(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function j4(e,t,r){return t===0?"":vl(e,t,r)}function O4(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,s,l]}function jw(e){var t=e.read_shift(2),r=ig(e);return[t,r]}function R4(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=bd(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function Wh(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function Ow(e,t){return t||(t=Fe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Rw(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var L4=Rw;function Lw(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function M4(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function B4(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function bn(e){e.l+=2,e.l+=e.read_shift(2)}var z4={0:bn,4:bn,5:bn,6:bn,7:B4,8:bn,9:bn,10:bn,11:bn,12:bn,13:M4,14:bn,15:bn,16:bn,17:bn,18:bn,19:bn,20:bn,21:Lw};function U4(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(z4[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Qf(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function cg(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Fe(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function $4(e,t){return t===0||e.read_shift(2),1200}function W4(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=vl(e,0,r);return e.read_shift(t+n-e.l),a}function H4(e,t){var r=!t||t.biff==8,n=Fe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function V4(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function G4(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var l=bd(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:s,name:l}}function K4(e,t){var r=!t||t.biff>=8?2:1,n=Fe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Z4(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],l=0;l!=a&&e.l<r;++l)s.push(T4(e));return s.Count=n,s.Unique=a,s}function Y4(e,t){var r=Fe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=E4(e[a]);var s=nn([r].concat(n));return s.parts=[r.length].concat(n.map(function(l){return l.length})),s}function q4(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function X4(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function J4(e){var t=F4(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Q4(e){return e.read_shift(2),e.read_shift(4)}function Y1(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function eP(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),d=e.read_shift(2),m=e.read_shift(2),p=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:l,FirstTab:d,Selected:m,TabRatio:p}}function tP(){var e=Fe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function rP(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function nP(e){var t=Fe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function aP(){}function iP(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=bd(e,0,r),n}function sP(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=Fe(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function oP(e){var t=Oi(e);return t.isst=e.read_shift(4),t}function lP(e,t,r,n){var a=Fe(10);return ol(e,t,n,a),a.write_shift(4,r),a}function cP(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Oi(e);r.biff==2&&e.l++;var s=kd(e,n-e.l,r);return a.val=s,a}function uP(e,t,r,n,a){var s=!a||a.biff==8,l=Fe(8+ +s+(1+s)*r.length);return ol(e,t,n,l),l.write_shift(2,r.length),s&&l.write_shift(1,1),l.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),l}function dP(e,t,r){var n=e.read_shift(2),a=vl(e,0,r);return[n,a]}function fP(e,t,r,n){var a=r&&r.biff==5;n||(n=Fe(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var hP=vl;function q1(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),l=e.read_shift(a),d=e.read_shift(2),m=e.read_shift(2);return e.l=n,{s:{r:s,c:d},e:{r:l,c:m}}}function mP(e,t){var r=t.biff==8||!t.biff?4:2,n=Fe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function pP(e){var t=e.read_shift(2),r=e.read_shift(2),n=jw(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function gP(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(jw(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(s.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:s}}function vP(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(s.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:s}}function xP(e,t,r,n){var a={},s=e.read_shift(4),l=e.read_shift(4),d=e.read_shift(4),m=e.read_shift(2);return a.patternType=JN[d>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=d&127,a.icvBottom=d>>7&127,a.icvDiag=d>>14&127,a.dgDiag=d>>21&15,a.icvFore=m&127,a.icvBack=m>>7&127,a.fsxButton=m>>14&1),a}function yP(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=xP(e,t,n.fStyle,r),n}function X1(e,t,r,n){var a=r&&r.biff==5;n||(n=Fe(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function _P(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function wP(e){var t=Fe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function J1(e,t,r){var n=Oi(e);(r.biff==2||t==9)&&++e.l;var a=S4(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function bP(e,t,r,n,a,s){var l=Fe(8);return ol(e,t,n,l),Pw(r,s,l),l}function kP(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Oi(e),a=En(e);return n.val=a,n}function SP(e,t,r,n){var a=Fe(14);return ol(e,t,n,a),il(r,a),a}var Q1=j4;function TP(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var l=sl(e,s),d=[];n>e.l;)d.push(kd(e));return[s,a,l,d]}function ey(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=R4(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var EP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ty(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),l=e.read_shift(1),d=e.read_shift(r&&r.biff==2?1:2),m=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),m=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var p=sl(e,l,r);a&32&&(p=EP[p.charCodeAt(0)]);var g=n-e.l;r&&r.biff==2&&--g;var y=n==e.l||d===0||!(g>0)?[]:UD(e,g,r,d);return{chKey:s,Name:p,itab:m,rgce:y}}function Mw(e,t,r){if(r.biff<8)return CP(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(O4(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function CP(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=bd(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function AP(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=sl(e,n,r),l=sl(e,a,r);return[s,l]}function NP(e,t,r){var n=Rw(e);e.l++;var a=e.read_shift(1);return t-=8,[$D(e,t,r),a,n]}function ry(e,t,r){var n=L4(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,BD(e,t,r)]}function PP(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function IP(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),l=e.read_shift(2),d=vl(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},d,l,s]}}function DP(e,t,r){return IP(e,t,r)}function FP(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Wh(e));return r}function jP(e){var t=Fe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Ow(e[r],t);return t}function OP(e,t,r){if(r&&r.biff<8)return LP(e,t,r);var n=Lw(e),a=U4(e,t-22,n[1]);return{cmo:n,ft:a}}var RP={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function LP(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((RP[n]||Nn)(e,t,r)),{cmo:[a,n,s],ft:l}}function MP(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:l=C4(e,6,r);var d=e.read_shift(2);e.read_shift(2),Mr(e,2);var m=e.read_shift(2);e.l+=m;for(var p=1;p<e.lens.length-1;++p){if(e.l-n!=e.lens[p])throw new Error("TxO: bad continue record");var g=e[e.l],y=sl(e,e.lens[p+1]-e.lens[p]-1);if(a+=y,a.length>=(g?d:2*d))break}if(a.length!==d&&a.length!==d*2)throw new Error("cchText: "+d+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function BP(e,t){var r=Wh(e);e.l+=16;var n=I4(e,t-24);return[r,n]}function zP(e){var t=Fe(24),r=yr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return nn([t,D4(e[1])])}function UP(e,t){e.read_shift(2);var r=Wh(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Cn,""),[r,n]}function $P(e){var t=e[1].Tooltip,r=Fe(10+2*(t.length+1));r.write_shift(2,2048);var n=yr(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function WP(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=z1[r]||r,r=e.read_shift(2),t[1]=z1[r]||r,t}function HP(e){return e||(e=Fe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function VP(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Fw(e));return r}function GP(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Fw(e));return r}function KP(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Bw(e,t,r){if(!r.cellStyles)return Nn(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(n),d=e.read_shift(n),m=e.read_shift(2);n==2&&(e.l+=2);var p={s:a,e:s,w:l,ixfe:d,flags:m};return(r.biff>=5||!r.biff)&&(p.level=m>>8&7),p}function ZP(e,t){var r=Fe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function YP(e,t){var r={};return t<32||(e.l+=16,r.header=En(e),r.footer=En(e),e.l+=2),r}function qP(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function XP(e){for(var t=Fe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var JP=Oi,QP=Nw,e5=kd;function t5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function r5(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Oi(e);++e.l;var a=vl(e,t-7,r);return n.t="str",n.val=a,n}function n5(e){var t=Oi(e);++e.l;var r=En(e);return t.t="n",t.val=r,t}function a5(e,t,r){var n=Fe(15);return Cd(n,e,t),n.write_shift(8,r,"f"),n}function i5(e){var t=Oi(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function s5(e,t,r){var n=Fe(9);return Cd(n,e,t),n.write_shift(2,r),n}function o5(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function l5(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function c5(e,t,r){var n=e.l+t,a=Oi(e),s=e.read_shift(2),l=sl(e,s,r);return e.l=n,a.t="str",a.val=l,a}var u5=[2,3,48,49,131,139,140,245],wp=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Bh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(d,m){var p=[],g=oo(1);switch(m.type){case"base64":g=fa(pa(d));break;case"binary":g=fa(d);break;case"buffer":case"array":g=d;break}un(g,0);var y=g.read_shift(1),_=!!(y&136),T=!1,S=!1;switch(y){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var w=0,E=521;y==2&&(w=g.read_shift(2)),g.l+=3,y!=2&&(w=g.read_shift(4)),w>1048576&&(w=1e6),y!=2&&(E=g.read_shift(2));var P=g.read_shift(2),D=m.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(D=e[g[g.l]]),g.l+=1,g.l+=2),S&&(g.l+=36);for(var A=[],H={},J=Math.min(g.length,y==2?521:E-10-(T?264:0)),B=S?32:11;g.l<J&&g[g.l]!=13;)switch(H={},H.name=Bt.utils.decode(D,g.slice(g.l,g.l+B)).replace(/[\u0000\r\n].*$/g,""),g.l+=B,H.type=String.fromCharCode(g.read_shift(1)),y!=2&&!S&&(H.offset=g.read_shift(4)),H.len=g.read_shift(1),y==2&&(H.offset=g.read_shift(2)),H.dec=g.read_shift(1),H.name.length&&A.push(H),y!=2&&(g.l+=S?13:14),H.type){case"B":(!T||H.len!=8)&&m.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"G":case"P":m.WTF&&console.log("Skipping "+H.name+":"+H.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+H.type)}if(g[g.l]!==13&&(g.l=E-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=E;var I=0,ee=0;for(p[0]=[],ee=0;ee!=A.length;++ee)p[0][ee]=A[ee].name;for(;w-- >0;){if(g[g.l]===42){g.l+=P;continue}for(++g.l,p[++I]=[],ee=0,ee=0;ee!=A.length;++ee){var re=g.slice(g.l,g.l+A[ee].len);g.l+=A[ee].len,un(re,0);var ye=Bt.utils.decode(D,re);switch(A[ee].type){case"C":ye.trim().length&&(p[I][ee]=ye.replace(/\s+$/,""));break;case"D":ye.length===8?p[I][ee]=new Date(+ye.slice(0,4),+ye.slice(4,6)-1,+ye.slice(6,8)):p[I][ee]=ye;break;case"F":p[I][ee]=parseFloat(ye.trim());break;case"+":case"I":p[I][ee]=S?re.read_shift(-4,"i")^2147483648:re.read_shift(4,"i");break;case"L":switch(ye.trim().toUpperCase()){case"Y":case"T":p[I][ee]=!0;break;case"N":case"F":p[I][ee]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ye+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));p[I][ee]="##MEMO##"+(S?parseInt(ye.trim(),10):re.read_shift(4));break;case"N":ye=ye.replace(/\u0000/g,"").trim(),ye&&ye!="."&&(p[I][ee]=+ye||0);break;case"@":p[I][ee]=new Date(re.read_shift(-8,"f")-621356832e5);break;case"T":p[I][ee]=new Date((re.read_shift(4)-2440588)*864e5+re.read_shift(4));break;case"Y":p[I][ee]=re.read_shift(4,"i")/1e4+re.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[I][ee]=-re.read_shift(-8,"f");break;case"B":if(T&&A[ee].len==8){p[I][ee]=re.read_shift(8,"f");break}case"G":case"P":re.l+=A[ee].len;break;case"0":if(A[ee].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[ee].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return m&&m.sheetRows&&(p=p.slice(0,m.sheetRows)),m.DBF=A,p}function n(d,m){var p=m||{};p.dateNF||(p.dateNF="yyyymmdd");var g=Lc(r(d,p),p);return g["!cols"]=p.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete p.DBF,g}function a(d,m){try{return mo(n(d,m),m)}catch(p){if(m&&m.WTF)throw p}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function l(d,m){var p=m||{};if(+p.codepage>=0&&La(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var g=Qn(),y=Ah(d,{header:1,raw:!0,cellDates:!0}),_=y[0],T=y.slice(1),S=d["!cols"]||[],w=0,E=0,P=0,D=1;for(w=0;w<_.length;++w){if(((S[w]||{}).DBF||{}).name){_[w]=S[w].DBF.name,++P;continue}if(_[w]!=null){if(++P,typeof _[w]=="number"&&(_[w]=_[w].toString(10)),typeof _[w]!="string")throw new Error("DBF Invalid column name "+_[w]+" |"+typeof _[w]+"|");if(_.indexOf(_[w])!==w){for(E=0;E<1024;++E)if(_.indexOf(_[w]+"_"+E)==-1){_[w]+="_"+E;break}}}}var A=Ot(d["!ref"]),H=[],J=[],B=[];for(w=0;w<=A.e.c-A.s.c;++w){var I="",ee="",re=0,ye=[];for(E=0;E<T.length;++E)T[E][w]!=null&&ye.push(T[E][w]);if(ye.length==0||_[w]==null){H[w]="?";continue}for(E=0;E<ye.length;++E){switch(typeof ye[E]){case"number":ee="B";break;case"string":ee="C";break;case"boolean":ee="L";break;case"object":ee=ye[E]instanceof Date?"D":"C";break;default:ee="C"}re=Math.max(re,String(ye[E]).length),I=I&&I!=ee?"C":ee}re>250&&(re=250),ee=((S[w]||{}).DBF||{}).type,ee=="C"&&S[w].DBF.len>re&&(re=S[w].DBF.len),I=="B"&&ee=="N"&&(I="N",B[w]=S[w].DBF.dec,re=S[w].DBF.len),J[w]=I=="C"||ee=="N"?re:s[I]||0,D+=J[w],H[w]=I}var he=g.next(32);for(he.write_shift(4,318902576),he.write_shift(4,T.length),he.write_shift(2,296+32*P),he.write_shift(2,D),w=0;w<4;++w)he.write_shift(4,0);for(he.write_shift(4,0|(+t[rl]||3)<<8),w=0,E=0;w<_.length;++w)if(_[w]!=null){var ce=g.next(32),Ee=(_[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);ce.write_shift(1,Ee,"sbcs"),ce.write_shift(1,H[w]=="?"?"C":H[w],"sbcs"),ce.write_shift(4,E),ce.write_shift(1,J[w]||s[H[w]]||0),ce.write_shift(1,B[w]||0),ce.write_shift(1,2),ce.write_shift(4,0),ce.write_shift(1,0),ce.write_shift(4,0),ce.write_shift(4,0),E+=J[w]||s[H[w]]||0}var je=g.next(264);for(je.write_shift(4,13),w=0;w<65;++w)je.write_shift(4,0);for(w=0;w<T.length;++w){var fe=g.next(D);for(fe.write_shift(1,0),E=0;E<_.length;++E)if(_[E]!=null)switch(H[E]){case"L":fe.write_shift(1,T[w][E]==null?63:T[w][E]?84:70);break;case"B":fe.write_shift(8,T[w][E]||0,"f");break;case"N":var ue="0";for(typeof T[w][E]=="number"&&(ue=T[w][E].toFixed(B[E]||0)),P=0;P<J[E]-ue.length;++P)fe.write_shift(1,32);fe.write_shift(1,ue,"sbcs");break;case"D":T[w][E]?(fe.write_shift(4,("0000"+T[w][E].getFullYear()).slice(-4),"sbcs"),fe.write_shift(2,("00"+(T[w][E].getMonth()+1)).slice(-2),"sbcs"),fe.write_shift(2,("00"+T[w][E].getDate()).slice(-2),"sbcs")):fe.write_shift(8,"00000000","sbcs");break;case"C":var O=String(T[w][E]!=null?T[w][E]:"").slice(0,J[E]);for(fe.write_shift(1,O,"sbcs"),P=0;P<J[E]-O.length;++P)fe.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),zw=(function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Tr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,T){var S=e[T];return typeof S=="number"?hp(S):S},n=function(_,T,S){var w=T.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return w==59?_:hp(w)};e["|"]=254;function a(_,T){switch(T.type){case"base64":return s(pa(_),T);case"binary":return s(_,T);case"buffer":return s(Pt&&Buffer.isBuffer(_)?_.toString("binary"):ho(_),T);case"array":return s(al(_),T)}throw new Error("Unrecognized type "+T.type)}function s(_,T){var S=_.split(/[\n\r]+/),w=-1,E=-1,P=0,D=0,A=[],H=[],J=null,B={},I=[],ee=[],re=[],ye=0,he;for(+T.codepage>=0&&La(+T.codepage);P!==S.length;++P){ye=0;var ce=S[P].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Ee=ce.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),je=Ee[0],fe;if(ce.length>0)switch(je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ee[1].charAt(0)=="P"&&H.push(ce.slice(3).replace(/;;/g,";"));break;case"C":var ue=!1,O=!1,F=!1,M=!1,ie=-1,Y=-1;for(D=1;D<Ee.length;++D)switch(Ee[D].charAt(0)){case"A":break;case"X":E=parseInt(Ee[D].slice(1))-1,O=!0;break;case"Y":for(w=parseInt(Ee[D].slice(1))-1,O||(E=0),he=A.length;he<=w;++he)A[he]=[];break;case"K":fe=Ee[D].slice(1),fe.charAt(0)==='"'?fe=fe.slice(1,fe.length-1):fe==="TRUE"?fe=!0:fe==="FALSE"?fe=!1:isNaN(ii(fe))?isNaN(Pc(fe).getDate())||(fe=mr(fe)):(fe=ii(fe),J!==null&&dl(J)&&(fe=Uh(fe))),typeof Bt<"u"&&typeof fe=="string"&&(T||{}).type!="string"&&(T||{}).codepage&&(fe=Bt.utils.decode(T.codepage,fe)),ue=!0;break;case"E":M=!0;var R=Tc(Ee[D].slice(1),{r:w,c:E});A[w][E]=[A[w][E],R];break;case"S":F=!0,A[w][E]=[A[w][E],"S5S"];break;case"G":break;case"R":ie=parseInt(Ee[D].slice(1))-1;break;case"C":Y=parseInt(Ee[D].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ce)}if(ue&&(A[w][E]&&A[w][E].length==2?A[w][E][0]=fe:A[w][E]=fe,J=null),F){if(M)throw new Error("SYLK shared formula cannot have own formula");var z=ie>-1&&A[ie][Y];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");A[w][E][1]=ab(z[1],{r:w-ie,c:E-Y})}break;case"F":var U=0;for(D=1;D<Ee.length;++D)switch(Ee[D].charAt(0)){case"X":E=parseInt(Ee[D].slice(1))-1,++U;break;case"Y":for(w=parseInt(Ee[D].slice(1))-1,he=A.length;he<=w;++he)A[he]=[];break;case"M":ye=parseInt(Ee[D].slice(1))/20;break;case"F":break;case"G":break;case"P":J=H[parseInt(Ee[D].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(re=Ee[D].slice(1).split(" "),he=parseInt(re[0],10);he<=parseInt(re[1],10);++he)ye=parseInt(re[2],10),ee[he-1]=ye===0?{hidden:!0}:{wch:ye},lo(ee[he-1]);break;case"C":E=parseInt(Ee[D].slice(1))-1,ee[E]||(ee[E]={});break;case"R":w=parseInt(Ee[D].slice(1))-1,I[w]||(I[w]={}),ye>0?(I[w].hpt=ye,I[w].hpx=Dc(ye)):ye===0&&(I[w].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ce)}U<1&&(J=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+ce)}}return I.length>0&&(B["!rows"]=I),ee.length>0&&(B["!cols"]=ee),T&&T.sheetRows&&(A=A.slice(0,T.sheetRows)),[A,B]}function l(_,T){var S=a(_,T),w=S[0],E=S[1],P=Lc(w,T);return Tr(E).forEach(function(D){P[D]=E[D]}),P}function d(_,T){return mo(l(_,T),T)}function m(_,T,S,w){var E="C;Y"+(S+1)+";X"+(w+1)+";K";switch(_.t){case"n":E+=_.v||0,_.f&&!_.F&&(E+=";E"+pg(_.f,{r:S,c:w}));break;case"b":E+=_.v?"TRUE":"FALSE";break;case"e":E+=_.w||_.v;break;case"d":E+='"'+(_.w||_.v)+'"';break;case"s":E+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function p(_,T){T.forEach(function(S,w){var E="F;W"+(w+1)+" "+(w+1)+" ";S.hidden?E+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=ud(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=dd(S.wpx)),typeof S.wch=="number"&&(E+=Math.round(S.wch))),E.charAt(E.length-1)!=" "&&_.push(E)})}function g(_,T){T.forEach(function(S,w){var E="F;";S.hidden?E+="M0;":S.hpt?E+="M"+20*S.hpt+";":S.hpx&&(E+="M"+20*fd(S.hpx)+";"),E.length>2&&_.push(E+"R"+(w+1))})}function y(_,T){var S=["ID;PWXL;N;E"],w=[],E=Ot(_["!ref"]),P,D=Array.isArray(_),A=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),_["!cols"]&&p(S,_["!cols"]),_["!rows"]&&g(S,_["!rows"]),S.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var H=E.s.r;H<=E.e.r;++H)for(var J=E.s.c;J<=E.e.c;++J){var B=yt({r:H,c:J});P=D?(_[H]||[])[J]:_[B],!(!P||P.v==null&&(!P.f||P.F))&&w.push(m(P,_,H,J))}return S.join(A)+A+w.join(A)+A+"E"+A}return{to_workbook:d,to_sheet:l,from_sheet:y}})(),Uw=(function(){function e(s,l){switch(l.type){case"base64":return t(pa(s),l);case"binary":return t(s,l);case"buffer":return t(Pt&&Buffer.isBuffer(s)?s.toString("binary"):ho(s),l);case"array":return t(al(s),l)}throw new Error("Unrecognized type "+l.type)}function t(s,l){for(var d=s.split(`
`),m=-1,p=-1,g=0,y=[];g!==d.length;++g){if(d[g].trim()==="BOT"){y[++m]=[],p=0;continue}if(!(m<0)){var _=d[g].trim().split(","),T=_[0],S=_[1];++g;for(var w=d[g]||"";(w.match(/["]/g)||[]).length&1&&g<d.length-1;)w+=`
`+d[++g];switch(w=w.trim(),+T){case-1:if(w==="BOT"){y[++m]=[],p=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?y[m][p]=!0:w==="FALSE"?y[m][p]=!1:isNaN(ii(S))?isNaN(Pc(S).getDate())?y[m][p]=S:y[m][p]=mr(S):y[m][p]=ii(S),++p;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),y[m][p++]=w!==""?w:null;break}if(w==="EOD")break}}return l&&l.sheetRows&&(y=y.slice(0,l.sheetRows)),y}function r(s,l){return Lc(e(s,l),l)}function n(s,l){return mo(r(s,l),l)}var a=(function(){var s=function(m,p,g,y,_){m.push(p),m.push(g+","+y),m.push('"'+_.replace(/"/g,'""')+'"')},l=function(m,p,g,y){m.push(p+","+g),m.push(p==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(m){var p=[],g=Ot(m["!ref"]),y,_=Array.isArray(m);s(p,"TABLE",0,1,"sheetjs"),s(p,"VECTORS",0,g.e.r-g.s.r+1,""),s(p,"TUPLES",0,g.e.c-g.s.c+1,""),s(p,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){l(p,-1,0,"BOT");for(var S=g.s.c;S<=g.e.c;++S){var w=yt({r:T,c:S});if(y=_?(m[T]||[])[S]:m[w],!y){l(p,1,0,"");continue}switch(y.t){case"n":var E=y.w;!E&&y.v!=null&&(E=y.v),E==null?y.f&&!y.F?l(p,1,0,"="+y.f):l(p,1,0,""):l(p,0,E,"V");break;case"b":l(p,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":l(p,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=ga(y.z||xt[14],Zr(mr(y.v)))),l(p,0,y.w,"V");break;default:l(p,1,0,"")}}}l(p,-1,0,"EOD");var P=`\r
`,D=p.join(P);return D}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),$w=(function(){function e(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(y,_){for(var T=y.split(`
`),S=-1,w=-1,E=0,P=[];E!==T.length;++E){var D=T[E].trim().split(":");if(D[0]==="cell"){var A=yr(D[1]);if(P.length<=A.r)for(S=P.length;S<=A.r;++S)P[S]||(P[S]=[]);switch(S=A.r,w=A.c,D[2]){case"t":P[S][w]=e(D[3]);break;case"v":P[S][w]=+D[3];break;case"vtf":var H=D[D.length-1];case"vtc":switch(D[3]){case"nl":P[S][w]=!!+D[4];break;default:P[S][w]=+D[4];break}D[2]=="vtf"&&(P[S][w]=[P[S][w],H])}}}return _&&_.sheetRows&&(P=P.slice(0,_.sheetRows)),P}function n(y,_){return Lc(r(y,_),_)}function a(y,_){return mo(n(y,_),_)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,d=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),m="--SocialCalcSpreadsheetControlSave--";function p(y){if(!y||!y["!ref"])return"";for(var _=[],T=[],S,w="",E=$n(y["!ref"]),P=Array.isArray(y),D=E.s.r;D<=E.e.r;++D)for(var A=E.s.c;A<=E.e.c;++A)if(w=yt({r:D,c:A}),S=P?(y[D]||[])[A]:y[w],!(!S||S.v==null||S.t==="z")){switch(T=["cell",w,"t"],S.t){case"s":case"str":T.push(t(S.v));break;case"n":S.f?(T[2]="vtf",T[3]="n",T[4]=S.v,T[5]=t(S.f)):(T[2]="v",T[3]=S.v);break;case"b":T[2]="vt"+(S.f?"f":"c"),T[3]="nl",T[4]=S.v?"1":"0",T[5]=t(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var H=Zr(mr(S.v));T[2]="vtc",T[3]="nd",T[4]=""+H,T[5]=S.w||ga(S.z||xt[14],H);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(y){return[s,l,d,l,p(y),m].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:g}})(),Ic=(function(){function e(g,y,_,T,S){S.raw?y[_][T]=g:g===""||(g==="TRUE"?y[_][T]=!0:g==="FALSE"?y[_][T]=!1:isNaN(ii(g))?isNaN(Pc(g).getDate())?y[_][T]=g:y[_][T]=mr(g):y[_][T]=ii(g))}function t(g,y){var _=y||{},T=[];if(!g||g.length===0)return T;for(var S=g.split(/[\r\n]/),w=S.length-1;w>=0&&S[w].length===0;)--w;for(var E=10,P=0,D=0;D<=w;++D)P=S[D].indexOf(" "),P==-1?P=S[D].length:P++,E=Math.max(E,P);for(D=0;D<=w;++D){T[D]=[];var A=0;for(e(S[D].slice(0,E).trim(),T,D,A,_),A=1;A<=(S[D].length-E)/10+1;++A)e(S[D].slice(E+(A-1)*10,E+A*10).trim(),T,D,A,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(g){for(var y={},_=!1,T=0,S=0;T<g.length;++T)(S=g.charCodeAt(T))==34?_=!_:!_&&S in r&&(y[S]=(y[S]||0)+1);S=[];for(T in y)Object.prototype.hasOwnProperty.call(y,T)&&S.push([y[T],T]);if(!S.length){y=n;for(T in y)Object.prototype.hasOwnProperty.call(y,T)&&S.push([y[T],T])}return S.sort(function(w,E){return w[0]-E[0]||n[w[1]]-n[E[1]]}),r[S.pop()[1]]||44}function s(g,y){var _=y||{},T="",S=_.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=a(g.slice(0,1024)):_&&_.FS?T=_.FS:T=a(g.slice(0,1024));var E=0,P=0,D=0,A=0,H=0,J=T.charCodeAt(0),B=!1,I=0,ee=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var re=_.dateNF!=null?YA(_.dateNF):null;function ye(){var he=g.slice(A,H),ce={};if(he.charAt(0)=='"'&&he.charAt(he.length-1)=='"'&&(he=he.slice(1,-1).replace(/""/g,'"')),he.length===0)ce.t="z";else if(_.raw)ce.t="s",ce.v=he;else if(he.trim().length===0)ce.t="s",ce.v=he;else if(he.charCodeAt(0)==61)he.charCodeAt(1)==34&&he.charCodeAt(he.length-1)==34?(ce.t="s",ce.v=he.slice(2,-1).replace(/""/g,'"')):TI(he)?(ce.t="n",ce.f=he.slice(1)):(ce.t="s",ce.v=he);else if(he=="TRUE")ce.t="b",ce.v=!0;else if(he=="FALSE")ce.t="b",ce.v=!1;else if(!isNaN(D=ii(he)))ce.t="n",_.cellText!==!1&&(ce.w=he),ce.v=D;else if(!isNaN(Pc(he).getDate())||re&&he.match(re)){ce.z=_.dateNF||xt[14];var Ee=0;re&&he.match(re)&&(he=qA(he,_.dateNF,he.match(re)||[]),Ee=1),_.cellDates?(ce.t="d",ce.v=mr(he,Ee)):(ce.t="n",ce.v=Zr(mr(he,Ee))),_.cellText!==!1&&(ce.w=ga(ce.z,ce.v instanceof Date?Zr(ce.v):ce.v)),_.cellNF||delete ce.z}else ce.t="s",ce.v=he;if(ce.t=="z"||(_.dense?(S[E]||(S[E]=[]),S[E][P]=ce):S[yt({c:P,r:E})]=ce),A=H+1,ee=g.charCodeAt(A),w.e.c<P&&(w.e.c=P),w.e.r<E&&(w.e.r=E),I==J)++P;else if(P=0,++E,_.sheetRows&&_.sheetRows<=E)return!0}e:for(;H<g.length;++H)switch(I=g.charCodeAt(H)){case 34:ee===34&&(B=!B);break;case J:case 10:case 13:if(!B&&ye())break e;break}return H-A>0&&ye(),S["!ref"]=Ct(w),S}function l(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?s(g,y):Lc(t(g,y),y)}function d(g,y){var _="",T=y.type=="string"?[0,0,0,0]:Sg(g,y);switch(y.type){case"base64":_=pa(g);break;case"binary":_=g;break;case"buffer":y.codepage==65001?_=g.toString("utf8"):y.codepage&&typeof Bt<"u"?_=Bt.utils.decode(y.codepage,g):_=Pt&&Buffer.isBuffer(g)?g.toString("binary"):ho(g);break;case"array":_=al(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+y.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=nr(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=nr(_):y.type=="binary"&&typeof Bt<"u"&&y.codepage&&(_=Bt.utils.decode(y.codepage,Bt.utils.encode(28591,_))),_.slice(0,19)=="socialcalc:version:"?$w.to_sheet(y.type=="string"?_:nr(_),y):l(_,y)}function m(g,y){return mo(d(g,y),y)}function p(g){for(var y=[],_=Ot(g["!ref"]),T,S=Array.isArray(g),w=_.s.r;w<=_.e.r;++w){for(var E=[],P=_.s.c;P<=_.e.c;++P){var D=yt({r:w,c:P});if(T=S?(g[w]||[])[P]:g[D],!T||T.v==null){E.push("          ");continue}for(var A=(T.w||(Fi(T),T.w)||"").slice(0,10);A.length<10;)A+=" ";E.push(A+(P===0?" ":""))}y.push(E.join(""))}return y.join(`
`)}return{to_workbook:m,to_sheet:d,from_sheet:p}})();function d5(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=zw.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ic.to_workbook(e,t)}}var Qo=(function(){function e(R,z,U){if(R){un(R,R.l||0);for(var te=U.Enum||ie;R.l<R.length;){var W=R.read_shift(2),ae=te[W]||te[65535],oe=R.read_shift(2),de=R.l+oe,ge=ae.f&&ae.f(R,oe,U);if(R.l=de,z(ge,ae,W))return}}}function t(R,z){switch(z.type){case"base64":return r(fa(pa(R)),z);case"binary":return r(fa(R),z);case"buffer":case"array":return r(R,z)}throw"Unsupported type "+z.type}function r(R,z){if(!R)return R;var U=z||{},te=U.dense?[]:{},W="Sheet1",ae="",oe=0,de={},ge=[],Oe=[],q={s:{r:0,c:0},e:{r:0,c:0}},Ze=U.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)U.Enum=ie,e(R,function(Be,bt,dt){switch(dt){case 0:U.vers=Be,Be>=4096&&(U.qpro=!0);break;case 6:q=Be;break;case 204:Be&&(ae=Be);break;case 222:ae=Be;break;case 15:case 51:U.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:dt==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=U.dateNF||xt[14],U.cellDates&&(Be[1].t="d",Be[1].v=Uh(Be[1].v))),U.qpro&&Be[3]>oe&&(te["!ref"]=Ct(q),de[W]=te,ge.push(W),te=U.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},oe=Be[3],W=ae||"Sheet"+(oe+1),ae="");var ht=U.dense?(te[Be[0].r]||[])[Be[0].c]:te[yt(Be[0])];if(ht){ht.t=Be[1].t,ht.v=Be[1].v,Be[1].z!=null&&(ht.z=Be[1].z),Be[1].f!=null&&(ht.f=Be[1].f);break}U.dense?(te[Be[0].r]||(te[Be[0].r]=[]),te[Be[0].r][Be[0].c]=Be[1]):te[yt(Be[0])]=Be[1];break}},U);else if(R[2]==26||R[2]==14)U.Enum=Y,R[2]==14&&(U.qpro=!0,R.l=0),e(R,function(Be,bt,dt){switch(dt){case 204:W=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>oe&&(te["!ref"]=Ct(q),de[W]=te,ge.push(W),te=U.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},oe=Be[3],W="Sheet"+(oe+1)),Ze>0&&Be[0].r>=Ze)break;U.dense?(te[Be[0].r]||(te[Be[0].r]=[]),te[Be[0].r][Be[0].c]=Be[1]):te[yt(Be[0])]=Be[1],q.e.c<Be[0].c&&(q.e.c=Be[0].c),q.e.r<Be[0].r&&(q.e.r=Be[0].r);break;case 27:Be[14e3]&&(Oe[Be[14e3][0]]=Be[14e3][1]);break;case 1537:Oe[Be[0]]=Be[1],Be[0]==oe&&(W=Be[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(te["!ref"]=Ct(q),de[ae||W]=te,ge.push(ae||W),!Oe.length)return{SheetNames:ge,Sheets:de};for(var Je={},Ye=[],nt=0;nt<Oe.length;++nt)de[ge[nt]]?(Ye.push(Oe[nt]||ge[nt]),Je[Oe[nt]]=de[Oe[nt]]||de[ge[nt]]):(Ye.push(Oe[nt]),Je[Oe[nt]]={"!ref":"A1"});return{SheetNames:Ye,Sheets:Je}}function n(R,z){var U=z||{};if(+U.codepage>=0&&La(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var te=Qn(),W=Ot(R["!ref"]),ae=Array.isArray(R),oe=[];Qe(te,0,s(1030)),Qe(te,6,m(W));for(var de=Math.min(W.e.r,8191),ge=W.s.r;ge<=de;++ge)for(var Oe=kr(ge),q=W.s.c;q<=W.e.c;++q){ge===W.s.r&&(oe[q]=hr(q));var Ze=oe[q]+Oe,Je=ae?(R[ge]||[])[q]:R[Ze];if(!(!Je||Je.t=="z"))if(Je.t=="n")(Je.v|0)==Je.v&&Je.v>=-32768&&Je.v<=32767?Qe(te,13,T(ge,q,Je.v)):Qe(te,14,w(ge,q,Je.v));else{var Ye=Fi(Je);Qe(te,15,y(ge,q,Ye.slice(0,239)))}}return Qe(te,1),te.end()}function a(R,z){var U=z||{};if(+U.codepage>=0&&La(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var te=Qn();Qe(te,0,l(R));for(var W=0,ae=0;W<R.SheetNames.length;++W)(R.Sheets[R.SheetNames[W]]||{})["!ref"]&&Qe(te,27,M(R.SheetNames[W],ae++));var oe=0;for(W=0;W<R.SheetNames.length;++W){var de=R.Sheets[R.SheetNames[W]];if(!(!de||!de["!ref"])){for(var ge=Ot(de["!ref"]),Oe=Array.isArray(de),q=[],Ze=Math.min(ge.e.r,8191),Je=ge.s.r;Je<=Ze;++Je)for(var Ye=kr(Je),nt=ge.s.c;nt<=ge.e.c;++nt){Je===ge.s.r&&(q[nt]=hr(nt));var Be=q[nt]+Ye,bt=Oe?(de[Je]||[])[nt]:de[Be];if(!(!bt||bt.t=="z"))if(bt.t=="n")Qe(te,23,ye(Je,nt,oe,bt.v));else{var dt=Fi(bt);Qe(te,22,I(Je,nt,oe,dt.slice(0,239)))}}++oe}}return Qe(te,1),te.end()}function s(R){var z=Fe(2);return z.write_shift(2,R),z}function l(R){var z=Fe(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var U=0,te=0,W=0,ae=0;ae<R.SheetNames.length;++ae){var oe=R.SheetNames[ae],de=R.Sheets[oe];if(!(!de||!de["!ref"])){++W;var ge=$n(de["!ref"]);U<ge.e.r&&(U=ge.e.r),te<ge.e.c&&(te=ge.e.c)}}return U>8191&&(U=8191),z.write_shift(2,U),z.write_shift(1,W),z.write_shift(1,te),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function d(R,z,U){var te={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&U.qpro?(te.s.c=R.read_shift(1),R.l++,te.s.r=R.read_shift(2),te.e.c=R.read_shift(1),R.l++,te.e.r=R.read_shift(2),te):(te.s.c=R.read_shift(2),te.s.r=R.read_shift(2),z==12&&U.qpro&&(R.l+=2),te.e.c=R.read_shift(2),te.e.r=R.read_shift(2),z==12&&U.qpro&&(R.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function m(R){var z=Fe(8);return z.write_shift(2,R.s.c),z.write_shift(2,R.s.r),z.write_shift(2,R.e.c),z.write_shift(2,R.e.r),z}function p(R,z,U){var te=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(te[0].c=R.read_shift(1),te[3]=R.read_shift(1),te[0].r=R.read_shift(2),R.l+=2):(te[2]=R.read_shift(1),te[0].c=R.read_shift(2),te[0].r=R.read_shift(2)),te}function g(R,z,U){var te=R.l+z,W=p(R,z,U);if(W[1].t="s",U.vers==20768){R.l++;var ae=R.read_shift(1);return W[1].v=R.read_shift(ae,"utf8"),W}return U.qpro&&R.l++,W[1].v=R.read_shift(te-R.l,"cstr"),W}function y(R,z,U){var te=Fe(7+U.length);te.write_shift(1,255),te.write_shift(2,z),te.write_shift(2,R),te.write_shift(1,39);for(var W=0;W<te.length;++W){var ae=U.charCodeAt(W);te.write_shift(1,ae>=128?95:ae)}return te.write_shift(1,0),te}function _(R,z,U){var te=p(R,z,U);return te[1].v=R.read_shift(2,"i"),te}function T(R,z,U){var te=Fe(7);return te.write_shift(1,255),te.write_shift(2,z),te.write_shift(2,R),te.write_shift(2,U,"i"),te}function S(R,z,U){var te=p(R,z,U);return te[1].v=R.read_shift(8,"f"),te}function w(R,z,U){var te=Fe(13);return te.write_shift(1,255),te.write_shift(2,z),te.write_shift(2,R),te.write_shift(8,U,"f"),te}function E(R,z,U){var te=R.l+z,W=p(R,z,U);if(W[1].v=R.read_shift(8,"f"),U.qpro)R.l=te;else{var ae=R.read_shift(2);H(R.slice(R.l,R.l+ae),W),R.l+=ae}return W}function P(R,z,U){var te=z&32768;return z&=-32769,z=(te?R:0)+(z>=8192?z-16384:z),(te?"":"$")+(U?hr(z):kr(z))}var D={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function H(R,z){un(R,0);for(var U=[],te=0,W="",ae="",oe="",de="";R.l<R.length;){var ge=R[R.l++];switch(ge){case 0:U.push(R.read_shift(8,"f"));break;case 1:ae=P(z[0].c,R.read_shift(2),!0),W=P(z[0].r,R.read_shift(2),!1),U.push(ae+W);break;case 2:{var Oe=P(z[0].c,R.read_shift(2),!0),q=P(z[0].r,R.read_shift(2),!1);ae=P(z[0].c,R.read_shift(2),!0),W=P(z[0].r,R.read_shift(2),!1),U.push(Oe+q+":"+ae+W)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(R.read_shift(2));break;case 6:{for(var Ze="";ge=R[R.l++];)Ze+=String.fromCharCode(ge);U.push('"'+Ze.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:de=U.pop(),oe=U.pop(),U.push(["AND","OR"][ge-20]+"("+oe+","+de+")");break;default:if(ge<32&&A[ge])de=U.pop(),oe=U.pop(),U.push(oe+A[ge]+de);else if(D[ge]){if(te=D[ge][1],te==69&&(te=R[R.l++]),te>U.length){console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+U.join("|")+"|");return}var Je=U.slice(-te);U.length-=te,U.push(D[ge][0]+"("+Je.join(",")+")")}else return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16))}}U.length==1?z[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function J(R){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=R.read_shift(2),z[3]=R[R.l++],z[0].c=R[R.l++],z}function B(R,z){var U=J(R);return U[1].t="s",U[1].v=R.read_shift(z-4,"cstr"),U}function I(R,z,U,te){var W=Fe(6+te.length);W.write_shift(2,R),W.write_shift(1,U),W.write_shift(1,z),W.write_shift(1,39);for(var ae=0;ae<te.length;++ae){var oe=te.charCodeAt(ae);W.write_shift(1,oe>=128?95:oe)}return W.write_shift(1,0),W}function ee(R,z){var U=J(R);U[1].v=R.read_shift(2);var te=U[1].v>>1;if(U[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return U[1].v=te,U}function re(R,z){var U=J(R),te=R.read_shift(4),W=R.read_shift(4),ae=R.read_shift(2);if(ae==65535)return te===0&&W===3221225472?(U[1].t="e",U[1].v=15):te===0&&W===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var oe=ae&32768;return ae=(ae&32767)-16446,U[1].v=(1-oe*2)*(W*Math.pow(2,ae+32)+te*Math.pow(2,ae)),U}function ye(R,z,U,te){var W=Fe(14);if(W.write_shift(2,R),W.write_shift(1,U),W.write_shift(1,z),te==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var ae=0,oe=0,de=0,ge=0;return te<0&&(ae=1,te=-te),oe=Math.log2(te)|0,te/=Math.pow(2,oe-31),ge=te>>>0,(ge&2147483648)==0&&(te/=2,++oe,ge=te>>>0),te-=ge,ge|=2147483648,ge>>>=0,te*=Math.pow(2,32),de=te>>>0,W.write_shift(4,de),W.write_shift(4,ge),oe+=16383+(ae?32768:0),W.write_shift(2,oe),W}function he(R,z){var U=re(R);return R.l+=z-14,U}function ce(R,z){var U=J(R),te=R.read_shift(4);return U[1].v=te>>6,U}function Ee(R,z){var U=J(R),te=R.read_shift(8,"f");return U[1].v=te,U}function je(R,z){var U=Ee(R);return R.l+=z-10,U}function fe(R,z){return R[R.l+z-1]==0?R.read_shift(z,"cstr"):""}function ue(R,z){var U=R[R.l++];U>z-1&&(U=z-1);for(var te="";te.length<U;)te+=String.fromCharCode(R[R.l++]);return te}function O(R,z,U){if(!(!U.qpro||z<21)){var te=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var W=R.read_shift(z-21,"cstr");return[te,W]}}function F(R,z){for(var U={},te=R.l+z;R.l<te;){var W=R.read_shift(2);if(W==14e3){for(U[W]=[0,""],U[W][0]=R.read_shift(2);R[R.l];)U[W][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return U}function M(R,z){var U=Fe(5+R.length);U.write_shift(2,14e3),U.write_shift(2,z);for(var te=0;te<R.length;++te){var W=R.charCodeAt(te);U[U.l++]=W>127?95:W}return U[U.l++]=0,U}var ie={0:{n:"BOF",f:Mr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:d},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:fe},222:{n:"SHEETNAMELP",f:ue},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:re},24:{n:"NUMBER18",f:ee},25:{n:"FORMULA19",f:he},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:F},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:ce},38:{n:"??"},39:{n:"NUMBER27",f:Ee},40:{n:"FORMULA28",f:je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:fe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:O},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function f5(e){var t={},r=e.match(Pn),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=wt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Mp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var h5=(function(){var e=id("t"),t=id("rPr");function r(s){var l=s.match(e);if(!l)return{t:"s",v:""};var d={t:"s",v:Ut(l[1])},m=s.match(t);return m&&(d.s=f5(m[1])),d}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(d){return d.v})}})(),m5=(function(){var t=/(\r\n|\n)/g;function r(a,s,l){var d=[];a.u&&d.push("text-decoration: underline;"),a.uval&&d.push("text-underline-style:"+a.uval+";"),a.sz&&d.push("font-size:"+a.sz+"pt;"),a.outline&&d.push("text-effect: outline;"),a.shadow&&d.push("text-shadow: auto;"),s.push('<span style="'+d.join("")+'">'),a.b&&(s.push("<b>"),l.push("</b>")),a.i&&(s.push("<i>"),l.push("</i>")),a.strike&&(s.push("<s>"),l.push("</s>"));var m=a.valign||"";return m=="superscript"||m=="super"?m="sup":m=="subscript"&&(m="sub"),m!=""&&(s.push("<"+m+">"),l.push("</"+m+">")),l.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),p5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,g5=/<(?:\w+:)?r>/,v5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ug(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ut(nr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=nr(e),r&&(n.h=Gp(n.t))):e.match(g5)&&(n.r=nr(e),n.t=Ut(nr((e.replace(v5,"").match(p5)||[]).join("").replace(Pn,""))),r&&(n.h=m5(h5(n.r)))),n):{t:""}}var x5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,y5=/<(?:\w+:)?(?:si|sstItem)>/g,_5=/<\/(?:\w+:)?(?:si|sstItem)>/;function w5(e,t){var r=[],n="";if(!e)return r;var a=e.match(x5);if(a){n=a[2].replace(y5,"").split(_5);for(var s=0;s!=n.length;++s){var l=ug(n[s].trim(),t);l!=null&&(r[r.length]=l)}a=wt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var b5=/^\s|\s$|[\t\n\r]/;function Ww(e,t){if(!t.bookSST)return"";var r=[Dr];r[r.length]=Xe("sst",null,{xmlns:fl[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(b5)&&(s+=' xml:space="preserve"'),s+=">"+Jt(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function k5(e){return[e.read_shift(4),e.read_shift(4)]}function S5(e,t){var r=[],n=!1;return fs(e,function(s,l,d){switch(d){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}),r}function T5(e,t){return t||(t=Fe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var E5=RN;function C5(e){var t=Qn();ze(t,159,T5(e));for(var r=0;r<e.length;++r)ze(t,19,E5(e[r]));return ze(t,160),t.end()}function Hw(e){if(typeof Bt<"u")return Bt.utils.encode(rl,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function cs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function A5(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=cs(e,4),t.U=cs(e,4),t.W=cs(e,4),t}function N5(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function P5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(N5(e));return t}function I5(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function D5(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=cs(e,4),t.U=cs(e,4),t.W=cs(e,4),t}function F5(e){var t=D5(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Vw(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function Gw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function j5(e){var t=cs(e);switch(t.Minor){case 2:return[t.Minor,O5(e)];case 3:return[t.Minor,R5()];case 4:return[t.Minor,L5(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function O5(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=Vw(e,r),a=Gw(e,e.length-e.l);return{t:"Std",h:n,v:a}}function R5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function L5(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Pn,function(s){var l=wt(s);switch(ji(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(d){n[d]=l[d]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function M5(e,t){var r={},n=r.EncryptionVersionInfo=cs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=Vw(e,a),t-=a,r.EncryptionVerifier=Gw(e,t),r}function B5(e){var t={},r=t.EncryptionVersionInfo=cs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function dg(e){var t=0,r,n=Hw(e),a=n.length+1,s,l,d,m,p;for(r=oo(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)l=r[s],d=(t&16384)===0?0:1,m=t<<1&32767,p=d|m,t=p^l;return t^52811}var Kw=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,d){return n(l^d)},s=function(l){for(var d=t[l.length-1],m=104,p=l.length-1;p>=0;--p)for(var g=l[p],y=0;y!=7;++y)g&64&&(d^=r[m]),g*=2,--m;return d};return function(l){for(var d=Hw(l),m=s(d),p=d.length,g=oo(16),y=0;y!=16;++y)g[y]=0;var _,T,S;for((p&1)===1&&(_=m>>8,g[p]=a(e[0],_),--p,_=m&255,T=d[d.length-1],g[p]=a(T,_));p>0;)--p,_=m>>8,g[p]=a(d[p],_),--p,_=m&255,g[p]=a(d[p],_);for(p=15,S=15-d.length;S>0;)_=m>>8,g[p]=a(e[S],_),--p,--S,_=m&255,g[p]=a(d[p],_),--p,--S;return g}})(),z5=function(e,t,r,n,a){a||(a=t),n||(n=Kw(e));var s,l;for(s=0;s!=t.length;++s)l=t[s],l^=n[r],l=(l>>5|l<<3)&255,a[s]=l,++r;return[a,r,n]},U5=function(e){var t=0,r=Kw(e);return function(n){var a=z5("",n,t,r);return t=a[1],a[0]}};function $5(e,t,r,n){var a={key:Mr(e),verificationBytes:Mr(e)};return r.password&&(a.verifier=dg(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=U5(r.password)),a}function W5(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=B5(e):n.Data=M5(e,t),n}function H5(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?W5(e,t-2,n):$5(e,r.biff>=8?t:t-2,r,n),n}var Zw=(function(){function e(a,s){switch(s.type){case"base64":return t(pa(a),s);case"binary":return t(a,s);case"buffer":return t(Pt&&Buffer.isBuffer(a)?a.toString("binary"):ho(a),s);case"array":return t(al(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var l=s||{},d=l.dense?[]:{},m=a.match(/\\trowd.*?\\row\b/g);if(!m.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:m.length-1}};return m.forEach(function(g,y){Array.isArray(d)&&(d[y]=[]);for(var _=/\\\w+\b/g,T=0,S,w=-1;S=_.exec(g);){switch(S[0]){case"\\cell":var E=g.slice(T,_.lastIndex-S[0].length);if(E[0]==" "&&(E=E.slice(1)),++w,E.length){var P={v:E,t:"s"};Array.isArray(d)?d[y][w]=P:d[yt({r:y,c:w})]=P}break}T=_.lastIndex}w>p.e.c&&(p.e.c=w)}),d["!ref"]=Ct(p),d}function r(a,s){return mo(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],l=Ot(a["!ref"]),d,m=Array.isArray(a),p=l.s.r;p<=l.e.r;++p){s.push("\\trowd\\trautofit1");for(var g=l.s.c;g<=l.e.c;++g)s.push("\\cellx"+(g+1));for(s.push("\\pard\\intbl"),g=l.s.c;g<=l.e.c;++g){var y=yt({r:p,c:g});d=m?(a[p]||[])[g]:a[y],!(!d||d.v==null&&(!d.f||d.F))&&(s.push(" "+(d.w||(Fi(d),d.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function V5(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function cd(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function G5(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),l=a-s;if(l===0)return[0,0,t];var d=0,m=0,p=a+s;switch(m=l/(p>1?2-p:p),a){case t:d=((r-n)/l+6)%6;break;case r:d=(n-t)/l+2;break;case n:d=(t-r)/l+4;break}return[d/6,m,p/2]}function K5(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,l=[s,s,s],d=6*t,m;if(r!==0)switch(d|0){case 0:case 6:m=a*d,l[0]+=a,l[1]+=m;break;case 1:m=a*(2-d),l[0]+=m,l[1]+=a;break;case 2:m=a*(d-2),l[1]+=a,l[2]+=m;break;case 3:m=a*(4-d),l[1]+=m,l[2]+=a;break;case 4:m=a*(d-4),l[2]+=a,l[0]+=m;break;case 5:m=a*(6-d),l[2]+=m,l[0]+=a;break}for(var p=0;p!=3;++p)l[p]=Math.round(l[p]*255);return l}function Eh(e,t){if(t===0)return e;var r=G5(V5(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),cd(K5(r))}var Yw=6,Z5=15,Y5=1,Tn=Yw;function ud(e){return Math.floor((e+Math.round(128/Tn)/256)*Tn)}function dd(e){return Math.floor((e-5)/Tn*100+.5)/100}function Ch(e){return Math.round((e*Tn+5)/Tn*256)/256}function zm(e){return Ch(dd(ud(e)))}function fg(e){var t=Math.abs(e-zm(e)),r=Tn;if(t>.005)for(Tn=Y5;Tn<Z5;++Tn)Math.abs(e-zm(e))<=t&&(t=Math.abs(e-zm(e)),r=Tn);Tn=r}function lo(e){e.width?(e.wpx=ud(e.width),e.wch=dd(e.wpx),e.MDW=Tn):e.wpx?(e.wch=dd(e.wpx),e.width=Ch(e.wch),e.MDW=Tn):typeof e.wch=="number"&&(e.width=Ch(e.wch),e.wpx=ud(e.width),e.MDW=Tn),e.customWidth&&delete e.customWidth}var q5=96,qw=q5;function fd(e){return e*96/qw}function Dc(e){return e*qw/96}var X5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function J5(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Pn)||[]).forEach(function(l){var d=wt(l);switch(ji(d[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},d.diagonalUp&&(a.diagonalUp=fr(d.diagonalUp)),d.diagonalDown&&(a.diagonalDown=fr(d.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+d[0]+" in borders")}})}function Q5(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Pn)||[]).forEach(function(l){var d=wt(l);switch(ji(d[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":d.patternType&&(a.patternType=d.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),d.indexed&&(a.bgColor.indexed=parseInt(d.indexed,10)),d.theme&&(a.bgColor.theme=parseInt(d.theme,10)),d.tint&&(a.bgColor.tint=parseFloat(d.tint)),d.rgb&&(a.bgColor.rgb=d.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),d.theme&&(a.fgColor.theme=parseInt(d.theme,10)),d.tint&&(a.fgColor.tint=parseFloat(d.tint)),d.rgb!=null&&(a.fgColor.rgb=d.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+d[0]+" in fills")}})}function e3(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Pn)||[]).forEach(function(l){var d=wt(l);switch(ji(d[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":d.val&&(a.name=nr(d.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=d.val?fr(d.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=d.val?fr(d.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(d.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=d.val?fr(d.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=d.val?fr(d.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=d.val?fr(d.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=d.val?fr(d.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=d.val?fr(d.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":d.val&&(a.sz=+d.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":d.val&&(a.vertAlign=d.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":d.val&&(a.family=parseInt(d.val,10));break;case"<family/>":case"</family>":break;case"<scheme":d.val&&(a.scheme=d.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(d.val=="1")break;d.codepage=Mp[parseInt(d.val,10)];break;case"<color":if(a.color||(a.color={}),d.auto&&(a.color.auto=fr(d.auto)),d.rgb)a.color.rgb=d.rgb.slice(-6);else if(d.indexed){a.color.index=parseInt(d.indexed,10);var m=Xo[a.color.index];a.color.index==81&&(m=Xo[1]),m||(m=Xo[1]),a.color.rgb=m[0].toString(16)+m[1].toString(16)+m[2].toString(16)}else d.theme&&(a.color.theme=parseInt(d.theme,10),d.tint&&(a.color.tint=parseFloat(d.tint)),d.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Eh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+d[0]+" in fonts")}})}function t3(e,t,r){t.NumberFmt=[];for(var n=Tr(xt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=xt[n[a]];var s=e[0].match(Pn);if(s)for(a=0;a<s.length;++a){var l=wt(s[a]);switch(ji(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var d=Ut(nr(l.formatCode)),m=parseInt(l.numFmtId,10);if(t.NumberFmt[m]=d,m>0){if(m>392){for(m=392;m>60&&t.NumberFmt[m]!=null;--m);t.NumberFmt[m]=d}Ii(d,m)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function r3(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Xe("numFmt",null,{numFmtId:n,formatCode:Jt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Xe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var eh=["numFmtId","fillId","fontId","borderId","xfId"],th=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function n3(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Pn)||[]).forEach(function(s){var l=wt(s),d=0;switch(ji(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],d=0;d<eh.length;++d)n[eh[d]]&&(n[eh[d]]=parseInt(n[eh[d]],10));for(d=0;d<th.length;++d)n[th[d]]&&(n[th[d]]=fr(n[th[d]]));if(t.NumberFmt&&n.numFmtId>392){for(d=392;d>60;--d)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[d]){n.numFmtId=d;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var m={};l.vertical&&(m.vertical=l.vertical),l.horizontal&&(m.horizontal=l.horizontal),l.textRotation!=null&&(m.textRotation=l.textRotation),l.indent&&(m.indent=l.indent),l.wrapText&&(m.wrapText=fr(l.wrapText)),n.alignment=m;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function a3(e){var t=[];return t[t.length]=Xe("cellXfs",null),e.forEach(function(r){t[t.length]=Xe("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Xe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var i3=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(d,m,p){var g={};if(!d)return g;d=d.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var y;return(y=d.match(t))&&t3(y,g,p),(y=d.match(a))&&e3(y,g,m,p),(y=d.match(n))&&Q5(y,g,m,p),(y=d.match(s))&&J5(y,g,m,p),(y=d.match(r))&&n3(y,g,p),g}})();function Xw(e,t){var r=[Dr,Xe("styleSheet",null,{xmlns:fl[0],"xmlns:vt":Kr.vt})],n;return e.SSF&&(n=r3(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=a3(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function s3(e,t){var r=e.read_shift(2),n=An(e);return[r,n]}function o3(e,t,r){r||(r=Fe(6+4*t.length)),r.write_shift(2,e),an(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function l3(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=WN(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var d=e.read_shift(1);d>0&&(n.family=d);var m=e.read_shift(1);switch(m>0&&(n.charset=m),e.l++,n.color=$N(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=An(e),n}function c3(e,t){t||(t=Fe(153)),t.write_shift(2,e.sz*20),HN(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),kh(e.color,t);var n=0;return n=2,t.write_shift(1,n),an(e.name,t),t.length>t.l?t.slice(0,t.l):t}var u3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Um,d3=Nn;function ny(e,t){t||(t=Fe(84)),Um||(Um=Bh(u3));var r=Um[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(kh({auto:1},t),kh({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function f3(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function Jw(e,t,r){r||(r=Fe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Pu(e,t){return t||(t=Fe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var h3=Nn;function m3(e,t){return t||(t=Fe(51)),t.write_shift(1,0),Pu(null,t),Pu(null,t),Pu(null,t),Pu(null,t),Pu(null,t),t.length>t.l?t.slice(0,t.l):t}function p3(e,t){return t||(t=Fe(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),bh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function g3(e,t,r){var n=Fe(2052);return n.write_shift(4,e),bh(t,n),bh(r,n),n.length>n.l?n.slice(0,n.l):n}function v3(e,t,r){var n={};n.NumberFmt=[];for(var a in xt)n.NumberFmt[a]=xt[a];n.CellXf=[],n.Fonts=[];var s=[],l=!1;return fs(e,function(m,p,g){switch(g){case 44:n.NumberFmt[m[0]]=m[1],Ii(m[1],m[0]);break;case 43:n.Fonts.push(m),m.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(m.color.rgb=Eh(t.themeElements.clrScheme[m.color.theme].rgb,m.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(m);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:s.push(g),l=!0;break;case 38:s.pop(),l=!1;break;default:if(p.T>0)s.push(g);else if(p.T<0)s.pop();else if(!l||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),n}function x3(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(ze(e,615,si(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&ze(e,44,o3(a,t[a]))}),ze(e,616))}}function y3(e){var t=1;ze(e,611,si(t)),ze(e,43,c3({sz:12,color:{theme:1},name:"Calibri",family:2})),ze(e,612)}function _3(e){var t=2;ze(e,603,si(t)),ze(e,45,ny({patternType:"none"})),ze(e,45,ny({patternType:"gray125"})),ze(e,604)}function w3(e){var t=1;ze(e,613,si(t)),ze(e,46,m3()),ze(e,614)}function b3(e){var t=1;ze(e,626,si(t)),ze(e,47,Jw({numFmtId:0},65535)),ze(e,627)}function k3(e,t){ze(e,617,si(t.length)),t.forEach(function(r){ze(e,47,Jw(r,0))}),ze(e,618)}function S3(e){var t=1;ze(e,619,si(t)),ze(e,48,p3({xfId:0,name:"Normal"})),ze(e,620)}function T3(e){var t=0;ze(e,505,si(t)),ze(e,506)}function E3(e){var t=0;ze(e,508,g3(t,"TableStyleMedium9","PivotStyleMedium4")),ze(e,509)}function C3(e,t){var r=Qn();return ze(r,278),x3(r,e.SSF),y3(r),_3(r),w3(r),b3(r),k3(r,t.cellXfs),S3(r),T3(r),E3(r),ze(r,279),r.end()}var A3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function N3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Pn)||[]).forEach(function(a){var s=wt(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[A3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function P3(){}function I3(){}var D3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,F3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,j3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function O3(e,t,r){t.themeElements={};var n;[["clrScheme",D3,N3],["fontScheme",F3,P3],["fmtScheme",j3,I3]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var R3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Qw(e,t){(!e||e.length===0)&&(e=hg());var r,n={};if(!(r=e.match(R3)))throw new Error("themeElements not found in theme");return O3(r[0],n,t),n.raw=e,n}function hg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Dr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function L3(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var l;try{l=Y_(s,{type:"array"})}catch{return}var d=ha(l,"theme/theme/theme1.xml",!0);if(d)return Qw(d,r)}}function M3(e){return e.read_shift(4)}function B3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=z3(e,4);break;case 2:t.xclrValue=Dw(e);break;case 3:t.xclrValue=M3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function z3(e,t){return Nn(e,t)}function U3(e,t){return Nn(e,t)}function $3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=B3(e);break;case 6:n[1]=U3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function W3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push($3(e,r-e.l));return{ixfe:n,ext:s}}function H3(e,t){t.forEach(function(r){r[0]})}function V3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:An(e)}}function G3(e){var t=Fe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),an(e.name,t),t.slice(0,t.l)}function K3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Z3(e){var t=Fe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Y3(e,t){var r=Fe(8+2*t.length);return r.write_shift(4,e),an(t,r),r.slice(0,r.l)}function q3(e){return e.l+=4,e.read_shift(4)!=0}function X3(e,t){var r=Fe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function J3(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],l=!1,d=2;return fs(e,function(m,p,g){switch(g){case 335:n.Types.push({name:m.name});break;case 51:m.forEach(function(y){d==1?n.Cell.push({type:n.Types[y[0]-1].name,index:y[1]}):d==0&&n.Value.push({type:n.Types[y[0]-1].name,index:y[1]})});break;case 337:d=m?1:0;break;case 338:d=2;break;case 35:s.push(g),l=!0;break;case 36:s.pop(),l=!1;break;default:if(!p.T){if(!l||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function Q3(){var e=Qn();return ze(e,332),ze(e,334,si(1)),ze(e,335,G3({name:"XLDAPR",version:12e4,flags:3496657072})),ze(e,336),ze(e,339,Y3(1,"XLDAPR")),ze(e,52),ze(e,35,si(514)),ze(e,4096,si(0)),ze(e,4097,Oa(1)),ze(e,36),ze(e,53),ze(e,340),ze(e,337,X3(1)),ze(e,51,Z3([[1,0]])),ze(e,338),ze(e,333),e.end()}function eI(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,l;return e.replace(Pn,function(d){var m=wt(d);switch(ji(m[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:m.name});break;case"</metadataType>":break;case"<futureMetadata":for(var p=0;p<n.Types.length;++p)n.Types[p].name==m.name&&(l=n.Types[p]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[m.t-1].name,index:+m.v}):s==0&&n.Value.push({type:n.Types[m.t-1].name,index:+m.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+m.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+m[0]+" in metadata")}return d}),n}function eb(){var e=[Dr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function tI(e){var t=[];if(!e)return t;var r=1;return(e.match(Pn)||[]).forEach(function(n){var a=wt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function rI(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=yt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function nI(e,t,r){var n=[];return fs(e,function(s,l,d){switch(d){case 63:n.push(s);break;default:if(!l.T)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function aI(e,t,r,n){if(!e)return e;var a=n||{},s=!1;fs(e,function(d,m,p){switch(p){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!m.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}},a)}function iI(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var _c=1024;function tb(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Xe("xml",null,{"xmlns:v":da.v,"xmlns:o":da.o,"xmlns:x":da.x,"xmlns:mv":da.mv}).replace(/\/>/,">"),Xe("o:shapelayout",Xe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Xe("v:shapetype",[Xe("v:stroke",null,{joinstyle:"miter"}),Xe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];_c<e*1e3;)_c+=1e3;return t.forEach(function(s){var l=yr(s[0]),d={color2:"#BEFF82",type:"gradient"};d.type=="gradient"&&(d.angle="-180");var m=d.type=="gradient"?Xe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,p=Xe("v:fill",m,d),g={on:"t",obscured:"t"};++_c,a=a.concat(["<v:shape"+sd({id:"_x0000_s"+_c,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",p,Xe("v:shadow",null,g),Xe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",dn("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),dn("x:AutoFill","False"),dn("x:Row",String(l.r)),dn("x:Column",String(l.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function ay(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(l){var d=yr(l.ref);if(a?(e[d.r]||(e[d.r]=[]),s=e[d.r][d.c]):s=e[l.ref],!s){s={t:"z"},a?e[d.r][d.c]=s:e[l.ref]=s;var m=Ot(e["!ref"]||"BDWGO1000001:A1");m.s.r>d.r&&(m.s.r=d.r),m.e.r<d.r&&(m.e.r=d.r),m.s.c>d.c&&(m.s.c=d.c),m.e.c<d.c&&(m.e.c=d.c);var p=Ct(m);p!==e["!ref"]&&(e["!ref"]=p)}s.c||(s.c=[]);var g={a:l.author,t:l.t,r:l.r,T:r};l.h&&(g.h=l.h);for(var y=s.c.length-1;y>=0;--y){if(!r&&s.c[y].T)return;r&&!s.c[y].T&&s.c.splice(y,1)}if(r&&n){for(y=0;y<n.length;++y)if(g.a==n[y].id){g.a=n[y].name||g.a;break}}s.c.push(g)})}function sI(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var d=l.match(/<(?:\w+:)?author[^>]*>(.*)/);d&&r.push(d[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var d=l.match(/<(?:\w+:)?comment[^>]*>/);if(d){var m=wt(d[0]),p={author:m.authorId&&r[m.authorId]||"sheetjsghost",ref:m.ref,guid:m.guid},g=yr(m.ref);if(!(t.sheetRows&&t.sheetRows<=g.r)){var y=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!y&&!!y[1]&&ug(y[1])||{r:"",t:"",h:""};p.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),p.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(p.h=_.h),n.push(p)}}}}),n}function rb(e){var t=[Dr,Xe("comments",null,{xmlns:fl[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=Jt(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(m){m.a&&(a=r.indexOf(Jt(m.a))),s.push(m.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(dn("t",Jt(s[0]||"")));else{for(var l=`Comment:
    `+s[0]+`
`,d=1;d<s.length;++d)l+=`Reply:
    `+s[d]+`
`;t.push(dn("t",Jt(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function oI(e,t){var r=[],n=!1,a={},s=0;return e.replace(Pn,function(d,m){var p=wt(d);switch(ji(p[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:p.personId,guid:p.id,ref:p.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=m+d.length;break;case"</text>":a.t=e.slice(s,m).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+p[0]+" in threaded comments")}return d}),r}function lI(e,t,r){var n=[Dr,Xe("ThreadedComments",null,{xmlns:Kr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(l,d){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var m={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};d==0?s=m.id:m.parentId=s,l.ID=m.id,l.a&&(m.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Xe("threadedComment",dn("text",l.t||""),m))})}),n.push("</ThreadedComments>"),n.join("")}function cI(e,t){var r=[],n=!1;return e.replace(Pn,function(s){var l=wt(s);switch(ji(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return s}),r}function uI(e){var t=[Dr,Xe("personList",null,{xmlns:Kr.TCMNT,"xmlns:x":fl[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Xe("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function dI(e){var t={};t.iauthor=e.read_shift(4);var r=gl(e);return t.rfx=r.s,t.ref=yt(r.s),e.l+=16,t}function fI(e,t){return t==null&&(t=Fe(36)),t.write_shift(4,e[1].iauthor),Mc(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var hI=An;function mI(e){return an(e.slice(0,54))}function pI(e,t){var r=[],n=[],a={},s=!1;return fs(e,function(d,m,p){switch(p){case 632:n.push(d);break;case 635:a=d;break;case 637:a.t=d.t,a.h=d.h,a.r=d.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!m.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}function gI(e){var t=Qn(),r=[];return ze(t,628),ze(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),ze(t,632,mI(a.a)))})}),ze(t,631),ze(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:yr(n[0]),e:yr(n[0])};ze(t,635,fI([s,a])),a.t&&a.t.length>0&&ze(t,637,MN(a)),ze(t,636),delete a.iauthor})}),ze(t,634),ze(t,629),t.end()}var vI="application/vnd.ms-office.vbaProject";function xI(e){var t=ut.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ut.utils.cfb_add(t,a,e.FileIndex[n].content)}}),ut.write(t)}function yI(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&ut.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var nb=["xlsb","xlsm","xlam","biff8","xla"];function _I(){return{"!type":"dialog"}}function wI(){return{"!type":"dialog"}}function bI(){return{"!type":"macro"}}function kI(){return{"!type":"macro"}}var Tc=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,l){var d=!1,m=!1;s.length==0?m=!0:s.charAt(0)=="["&&(m=!0,s=s.slice(1,-1)),l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1));var p=s.length>0?parseInt(s,10)|0:0,g=l.length>0?parseInt(l,10)|0:0;return d?g+=t.c:--g,m?p+=t.r:--p,a+(d?"":"$")+hr(g)+(m?"":"$")+kr(p)}return function(a,s){return t=s,a.replace(e,r)}})(),mg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,pg=(function(){return function(t,r){return t.replace(mg,function(n,a,s,l,d,m){var p=tg(l)-(s?0:r.c),g=eg(m)-(d?0:r.r),y=g==0?"":d?g+1:"["+g+"]",_=p==0?"":s?p+1:"["+p+"]";return a+"R"+y+"C"+_})}})();function ab(e,t){return e.replace(mg,function(r,n,a,s,l,d){return n+(a=="$"?a+s:hr(tg(s)+t.c))+(l=="$"?l+d:kr(eg(d)+t.r))})}function SI(e,t,r){var n=$n(t),a=n.s,s=yr(r),l={r:s.r-a.r,c:s.c-a.c};return ab(e,l)}function TI(e){return e.length!=1}function iy(e){return e.replace(/_xlfn\./g,"")}function Rr(e){e.l+=1}function co(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ib(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return sb(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),l=co(e),d=co(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:d[0],cRel:d[1],rRel:d[2]}}}function sb(e){var t=co(e),r=co(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function EI(e,t,r){if(r.biff<8)return sb(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=co(e),l=co(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function ob(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return CI(e);var n=e.read_shift(r&&r.biff==12?4:2),a=co(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function CI(e){var t=co(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function AI(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function NI(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return PI(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),l=(s&16384)>>14,d=(s&32768)>>15;if(s&=16383,d==1)for(;a>524287;)a-=1048576;if(l==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:l,rRel:d}}function PI(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function II(e,t,r){var n=(e[e.l++]&96)>>5,a=ib(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function DI(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var l=ib(e,s,r);return[n,a,l]}function FI(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function jI(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function OI(e,t,r){var n=(e[e.l++]&96)>>5,a=EI(e,t-1,r);return[n,a]}function RI(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function sy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function LI(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function MI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function BI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function zI(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function UI(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function lb(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function $I(e){return e.read_shift(2),lb(e)}function WI(e){return e.read_shift(2),lb(e)}function HI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=ob(e,0,r);return[n,a]}function VI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=NI(e,0,r);return[n,a]}function GI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=ob(e,0,r);return[n,a,s]}function KI(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[qD[a],db[a],n]}function ZI(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:YI(e);return[a,(s[0]===0?db:YD)[s[1]]]}function YI(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function qI(e,t,r){e.l+=r&&r.biff==2?3:4}function XI(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function JI(e){return e.l++,hs[e.read_shift(1)]}function QI(e){return e.l++,e.read_shift(2)}function eD(e){return e.l++,e.read_shift(1)!==0}function tD(e){return e.l++,En(e)}function rD(e,t,r){return e.l++,bd(e,t-1,r)}function nD(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ir(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=hs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=En(e);break;case 2:r[1]=vl(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function aD(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?gl:Wh)(e));return a}function iD(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,l=[];s!=n&&(l[s]=[]);++s)for(var d=0;d!=a;++d)l[s][d]=nD(e,r.biff);return l}function sD(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function oD(e,t,r){if(r.biff==5)return lD(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function lD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function cD(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function uD(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function dD(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function fD(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var hD=Nn,mD=Nn,pD=Nn;function Sd(e,t,r){return e.l+=2,[AI(e)]}function gg(e){return e.l+=6,[]}var gD=Sd,vD=gg,xD=gg,yD=Sd;function cb(e){return e.l+=2,[Mr(e),e.read_shift(2)&1]}var _D=Sd,wD=cb,bD=gg,kD=Sd,SD=Sd,TD=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function ED(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),l=TD[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:s}}function CD(e){return e.l+=2,[e.read_shift(4)]}function AD(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function ND(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function PD(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function ID(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function DD(e){return e.l+=4,[0,0]}var oy={1:{n:"PtgExp",f:XI},2:{n:"PtgTbl",f:pD},3:{n:"PtgAdd",f:Rr},4:{n:"PtgSub",f:Rr},5:{n:"PtgMul",f:Rr},6:{n:"PtgDiv",f:Rr},7:{n:"PtgPower",f:Rr},8:{n:"PtgConcat",f:Rr},9:{n:"PtgLt",f:Rr},10:{n:"PtgLe",f:Rr},11:{n:"PtgEq",f:Rr},12:{n:"PtgGe",f:Rr},13:{n:"PtgGt",f:Rr},14:{n:"PtgNe",f:Rr},15:{n:"PtgIsect",f:Rr},16:{n:"PtgUnion",f:Rr},17:{n:"PtgRange",f:Rr},18:{n:"PtgUplus",f:Rr},19:{n:"PtgUminus",f:Rr},20:{n:"PtgPercent",f:Rr},21:{n:"PtgParen",f:Rr},22:{n:"PtgMissArg",f:Rr},23:{n:"PtgStr",f:rD},26:{n:"PtgSheet",f:AD},27:{n:"PtgEndSheet",f:ND},28:{n:"PtgErr",f:JI},29:{n:"PtgBool",f:eD},30:{n:"PtgInt",f:QI},31:{n:"PtgNum",f:tD},32:{n:"PtgArray",f:RI},33:{n:"PtgFunc",f:KI},34:{n:"PtgFuncVar",f:ZI},35:{n:"PtgName",f:sD},36:{n:"PtgRef",f:HI},37:{n:"PtgArea",f:II},38:{n:"PtgMemArea",f:cD},39:{n:"PtgMemErr",f:hD},40:{n:"PtgMemNoMem",f:mD},41:{n:"PtgMemFunc",f:uD},42:{n:"PtgRefErr",f:dD},43:{n:"PtgAreaErr",f:FI},44:{n:"PtgRefN",f:VI},45:{n:"PtgAreaN",f:OI},46:{n:"PtgMemAreaN",f:PD},47:{n:"PtgMemNoMemN",f:ID},57:{n:"PtgNameX",f:oD},58:{n:"PtgRef3d",f:GI},59:{n:"PtgArea3d",f:DI},60:{n:"PtgRefErr3d",f:fD},61:{n:"PtgAreaErr3d",f:jI},255:{}},FD={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},jD={1:{n:"PtgElfLel",f:cb},2:{n:"PtgElfRw",f:kD},3:{n:"PtgElfCol",f:gD},6:{n:"PtgElfRwV",f:SD},7:{n:"PtgElfColV",f:yD},10:{n:"PtgElfRadical",f:_D},11:{n:"PtgElfRadicalS",f:bD},13:{n:"PtgElfColS",f:vD},15:{n:"PtgElfColSV",f:xD},16:{n:"PtgElfRadicalLel",f:wD},25:{n:"PtgList",f:ED},29:{n:"PtgSxName",f:CD},255:{}},OD={0:{n:"PtgAttrNoop",f:DD},1:{n:"PtgAttrSemi",f:UI},2:{n:"PtgAttrIf",f:BI},4:{n:"PtgAttrChoose",f:LI},8:{n:"PtgAttrGoto",f:MI},16:{n:"PtgAttrSum",f:qI},32:{n:"PtgAttrBaxcel",f:sy},33:{n:"PtgAttrBaxcel",f:sy},64:{n:"PtgAttrSpace",f:$I},65:{n:"PtgAttrSpaceSemi",f:WI},128:{n:"PtgAttrIfError",f:zI},255:{}};function Td(e,t,r,n){if(n.biff<8)return Nn(e,t);for(var a=e.l+t,s=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=iD(e,0,n),s.push(r[l][1]);break;case"PtgMemArea":r[l][2]=aD(e,r[l][1],n),s.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),s.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&s.push(Nn(e,t)),s}function Ed(e,t,r){for(var n=e.l+t,a,s,l=[];n!=e.l;)t=n-e.l,s=e[e.l],a=oy[s]||oy[FD[s]],(s===24||s===25)&&(a=(s===24?jD:OD)[e[e.l+1]]),!a||!a.f?Nn(e,t):l.push([a.n,a.f(e,t,r)]);return l}function RD(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var l=n[s];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var LD={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function MD(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ub(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ly(e,t,r){var n=ub(e,t,r);return n=="#REF"?n:MD(n,r)}function Sn(e,t,r,n,a){var s=a&&a.biff||8,l={s:{c:0,r:0}},d=[],m,p,g,y=0,_=0,T,S="";if(!e[0]||!e[0][0])return"";for(var w=-1,E="",P=0,D=e[0].length;P<D;++P){var A=e[0][P];switch(A[0]){case"PtgUminus":d.push("-"+d.pop());break;case"PtgUplus":d.push("+"+d.pop());break;case"PtgPercent":d.push(d.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(m=d.pop(),p=d.pop(),w>=0){switch(e[0][w][1][0]){case 0:E=br(" ",e[0][w][1][1]);break;case 1:E=br("\r",e[0][w][1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}p=p+E,w=-1}d.push(p+LD[A[0]]+m);break;case"PtgIsect":m=d.pop(),p=d.pop(),d.push(p+" "+m);break;case"PtgUnion":m=d.pop(),p=d.pop(),d.push(p+","+m);break;case"PtgRange":m=d.pop(),p=d.pop(),d.push(p+":"+m);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Wu(A[1][1],l,a),d.push(Hu(g,s));break;case"PtgRefN":g=r?Wu(A[1][1],r,a):A[1][1],d.push(Hu(g,s));break;case"PtgRef3d":y=A[1][1],g=Wu(A[1][2],l,a),S=ly(n,y,a),d.push(S+"!"+Hu(g,s));break;case"PtgFunc":case"PtgFuncVar":var H=A[1][0],J=A[1][1];H||(H=0),H&=127;var B=H==0?[]:d.slice(-H);d.length-=H,J==="User"&&(J=B.shift()),d.push(J+"("+B.join(",")+")");break;case"PtgBool":d.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":d.push(A[1]);break;case"PtgNum":d.push(String(A[1]));break;case"PtgStr":d.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":d.push(A[1]);break;case"PtgAreaN":T=L1(A[1][1],r?{s:r}:l,a),d.push(Lm(T,a));break;case"PtgArea":T=L1(A[1][1],l,a),d.push(Lm(T,a));break;case"PtgArea3d":y=A[1][1],T=A[1][2],S=ly(n,y,a),d.push(S+"!"+Lm(T,a));break;case"PtgAttrSum":d.push("SUM("+d.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=A[1][2];var I=(n.names||[])[_-1]||(n[0]||[])[_],ee=I?I.Name:"SH33TJSNAME"+String(_);ee&&ee.slice(0,6)=="_xlfn."&&!a.xlfn&&(ee=ee.slice(6)),d.push(ee);break;case"PtgNameX":var re=A[1][1];_=A[1][2];var ye;if(a.biff<=5)re<0&&(re=-re),n[re]&&(ye=n[re][_]);else{var he="";if(((n[re]||[])[0]||[])[0]==14849||(((n[re]||[])[0]||[])[0]==1025?n[re][_]&&n[re][_].itab>0&&(he=n.SheetNames[n[re][_].itab-1]+"!"):he=n.SheetNames[_-1]+"!"),n[re]&&n[re][_])he+=n[re][_].Name;else if(n[0]&&n[0][_])he+=n[0][_].Name;else{var ce=(ub(n,re,a)||"").split(";;");ce[_-1]?he=ce[_-1]:he+="SH33TJSERRX"}d.push(he);break}ye||(ye={Name:"SH33TJSERRY"}),d.push(ye.Name);break;case"PtgParen":var Ee="(",je=")";if(w>=0){switch(E="",e[0][w][1][0]){case 2:Ee=br(" ",e[0][w][1][1])+Ee;break;case 3:Ee=br("\r",e[0][w][1][1])+Ee;break;case 4:je=br(" ",e[0][w][1][1])+je;break;case 5:je=br("\r",e[0][w][1][1])+je;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}d.push(Ee+d.pop()+je);break;case"PtgRefErr":d.push("#REF!");break;case"PtgRefErr3d":d.push("#REF!");break;case"PtgExp":g={c:A[1][1],r:A[1][0]};var fe={c:r.c,r:r.r};if(n.sharedf[yt(g)]){var ue=n.sharedf[yt(g)];d.push(Sn(ue,l,fe,n,a))}else{var O=!1;for(m=0;m!=n.arrayf.length;++m)if(p=n.arrayf[m],!(g.c<p[0].s.c||g.c>p[0].e.c)&&!(g.r<p[0].s.r||g.r>p[0].e.r)){d.push(Sn(p[1],l,fe,n,a)),O=!0;break}O||d.push(A[1])}break;case"PtgArray":d.push("{"+RD(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=P;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":d.push("");break;case"PtgAreaErr":d.push("#REF!");break;case"PtgAreaErr3d":d.push("#REF!");break;case"PtgList":d.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var F=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&w>=0&&F.indexOf(e[0][P][0])==-1){A=e[0][w];var M=!0;switch(A[1][0]){case 4:M=!1;case 0:E=br(" ",A[1][1]);break;case 5:M=!1;case 1:E=br("\r",A[1][1]);break;default:if(E="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}d.push((M?E:"")+d.pop()+(M?"":E)),w=-1}}if(d.length>1&&a.WTF)throw new Error("bad formula stack");return d[0]}function BD(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,l=e.read_shift(a);if(l==65535)return[[],Nn(e,t-2)];var d=Ed(e,l,r);return t!==l+a&&(s=Td(e,t-l-a,d,r)),e.l=n,[d,s]}function zD(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,l=e.read_shift(a);if(l==65535)return[[],Nn(e,t-2)];var d=Ed(e,l,r);return t!==l+a&&(s=Td(e,t-l-a,d,r)),e.l=n,[d,s]}function UD(e,t,r,n){var a=e.l+t,s=Ed(e,n,r),l;return a!==e.l&&(l=Td(e,a-e.l,s,r)),[s,l]}function $D(e,t,r){var n=e.l+t,a,s=e.read_shift(2),l=Ed(e,s,r);return s==65535?[[],Nn(e,t-2)]:(t!==s+2&&(a=Td(e,n-s-2,l,r)),[l,a])}function WD(e){var t;if(ss(e,e.l+6)!==65535)return[En(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function HD(e){if(e==null){var t=Fe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return il(e);return il(0)}function $m(e,t,r){var n=e.l+t,a=Oi(e);r.biff==2&&++e.l;var s=WD(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var d=zD(e,n-e.l,r);return{cell:a,val:s[0],formula:d,shared:l>>3&1,tt:s[1]}}function VD(e,t,r,n,a){var s=ol(t,r,a),l=HD(e.v),d=Fe(6),m=33;d.write_shift(2,m),d.write_shift(4,0);for(var p=Fe(e.bf.length),g=0;g<e.bf.length;++g)p[g]=e.bf[g];var y=nn([s,l,d,p]);return y}function Hh(e,t,r){var n=e.read_shift(4),a=Ed(e,n,r),s=e.read_shift(4),l=s>0?Td(e,s,a,r):null;return[a,l]}var GD=Hh,Vh=Hh,KD=Hh,ZD=Hh,YD={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},db={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qD={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function XD(e){var t="of:="+e.replace(mg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Wm(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function JD(e){return e.replace(/\./,"!")}var Gu={},Ec={},Ku=typeof Map<"u";function vg(e,t,r){var n=0,a=e.length;if(r){if(Ku?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Ku?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Ku?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Gh(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Tn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=dd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Ch(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function el(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function po(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Ii(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function fb(e,t,r,n,a,s){try{n.cellNF&&(e.z=xt[t])}catch(d){if(n.WTF)throw d}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=mr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(xt[t]==null&&Ii(ZA[t]||"General",t),e.t==="e")e.w=e.w||hs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ad(e.v);else if(e.t==="d"){var l=Zr(e.v);(l|0)===l?e.w=l.toString(10):e.w=ad(l)}else{if(e.v===void 0)return"";e.w=nl(e.v,Ec)}else e.t==="d"?e.w=ga(t,Zr(e.v),Ec):e.w=ga(t,e.v,Ec)}catch(d){if(n.WTF)throw d}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Eh(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Eh(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(d){if(n.WTF&&s.Fills)throw d}}}function QD(e,t,r){if(e&&e["!ref"]){var n=Ot(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function eF(e,t){var r=Ot(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ct(r))}var tF=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,rF=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,nF=/<(?:\w:)?hyperlink [^>]*>/mg,aF=/"(\w*:\w*)"/,iF=/<(?:\w:)?col\b[^>]*[\/]?>/g,sF=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,oF=/<(?:\w:)?pageMargins[^>]*\/>/g,hb=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,lF=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,cF=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function uF(e,t,r,n,a,s,l){if(!e)return e;n||(n={"!id":{}});var d=t.dense?[]:{},m={s:{r:2e6,c:2e6},e:{r:0,c:0}},p="",g="",y=e.match(rF);y?(p=e.slice(0,y.index),g=e.slice(y.index+y[0].length)):p=g=e;var _=p.match(hb);_?xg(_[0],d,a,r):(_=p.match(lF))&&fF(_[0],_[1]||"",d,a,r);var T=(p.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var S=p.slice(T,T+50).match(aF);S&&eF(d,S[1])}var w=p.match(cF);w&&w[1]&&TF(w[1],a);var E=[];if(t.cellStyles){var P=p.match(iF);P&&_F(E,P)}y&&AF(y[1],d,t,m,s,l);var D=g.match(sF);D&&(d["!autofilter"]=bF(D[0]));var A=[],H=g.match(tF);if(H)for(T=0;T!=H.length;++T)A[T]=Ot(H[T].slice(H[T].indexOf('"')+1));var J=g.match(nF);J&&vF(d,J,n);var B=g.match(oF);if(B&&(d["!margins"]=xF(wt(B[0]))),!d["!ref"]&&m.e.c>=m.s.c&&m.e.r>=m.s.r&&(d["!ref"]=Ct(m)),t.sheetRows>0&&d["!ref"]){var I=Ot(d["!ref"]);t.sheetRows<=+I.e.r&&(I.e.r=t.sheetRows-1,I.e.r>m.e.r&&(I.e.r=m.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>m.e.c&&(I.e.c=m.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),d["!fullref"]=d["!ref"],d["!ref"]=Ct(I))}return E.length>0&&(d["!cols"]=E),A.length>0&&(d["!merges"]=A),d}function dF(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ct(e[r])+'"/>';return t+"</mergeCells>"}function xg(e,t,r,n){var a=wt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ut(nr(a.codeName)))}function fF(e,t,r,n,a){xg(e.slice(0,e.indexOf(">")),r,n,a)}function hF(e,t,r,n,a){var s=!1,l={},d=null;if(n.bookType!=="xlsx"&&t.vbaraw){var m=t.SheetNames[r];try{t.Workbook&&(m=t.Workbook.Sheets[r].CodeName||m)}catch{}s=!0,l.codeName=Pi(Jt(m))}if(e&&e["!outline"]){var p={summaryBelow:1,summaryRight:1};e["!outline"].above&&(p.summaryBelow=0),e["!outline"].left&&(p.summaryRight=0),d=(d||"")+Xe("outlinePr",null,p)}!s&&!d||(a[a.length]=Xe("sheetPr",d,l))}var mF=["objects","scenarios","selectLockedCells","selectUnlockedCells"],pF=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function gF(e){var t={sheet:1};return mF.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),pF.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=dg(e.password).toString(16).toUpperCase()),Xe("sheetProtection",null,t)}function vF(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=wt(nr(t[a]),!0);if(!s.ref)return;var l=((r||{})["!id"]||[])[s.id];l?(s.Target=l.Target,s.location&&(s.Target+="#"+Ut(s.location))):(s.Target="#"+Ut(s.location),l={Target:s.Target,TargetMode:"Internal"}),s.Rel=l,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var d=Ot(s.ref),m=d.s.r;m<=d.e.r;++m)for(var p=d.s.c;p<=d.e.c;++p){var g=yt({c:p,r:m});n?(e[m]||(e[m]=[]),e[m][p]||(e[m][p]={t:"z",v:void 0}),e[m][p].l=s):(e[g]||(e[g]={t:"z",v:void 0}),e[g].l=s)}}}function xF(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function yF(e){return el(e),Xe("pageMargins",null,e)}function _F(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=wt(t[n],!0);a.hidden&&(a.hidden=fr(a.hidden));var s=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,fg(a.width)),lo(a);s<=l;)e[s++]=ir(a)}}function wF(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Xe("col",null,Gh(a,n)));return r[r.length]="</cols>",r.join("")}function bF(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function kF(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ct(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,l=$n(a);l.s.r==l.e.r&&(l.e.r=$n(t["!ref"]).e.r,a=Ct(l));for(var d=0;d<s.length;++d){var m=s[d];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==n){m.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return d==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Xe("autoFilter",null,{ref:a})}var SF=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function TF(e,t){t.Views||(t.Views=[{}]),(e.match(SF)||[]).forEach(function(r,n){var a=wt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),fr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function EF(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Xe("sheetViews",Xe("sheetView",null,a),{})}function CF(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=hs[e.v];break;case"d":n&&n.cellDates?a=mr(e.v,-1).toISOString():(e=ir(e),e.t="n",a=""+(e.v=Zr(mr(e.v)))),typeof e.z>"u"&&(e.z=xt[14]);break;default:a=e.v;break}var d=dn("v",Jt(a)),m={r:t},p=po(n.cellXfs,e,n);switch(p!==0&&(m.s=p),e.t){case"n":break;case"d":m.t="d";break;case"b":m.t="b";break;case"e":m.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){d=dn("v",""+vg(n.Strings,e.v,n.revStrings)),m.t="s";break}m.t="str";break}if(e.t!=s&&(e.t=s,e.v=l),typeof e.f=="string"&&e.f){var g=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;d=Xe("f",Jt(e.f),g)+(e.v!=null?d:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(m.cm=1),Xe("c",d,m)}var AF=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=id("v"),l=id("f");return function(m,p,g,y,_,T){for(var S=0,w="",E=[],P=[],D=0,A=0,H=0,J="",B,I,ee=0,re=0,ye,he,ce=0,Ee=0,je=Array.isArray(T.CellXf),fe,ue=[],O=[],F=Array.isArray(p),M=[],ie={},Y=!1,R=!!g.sheetStubs,z=m.split(t),U=0,te=z.length;U!=te;++U){w=z[U].trim();var W=w.length;if(W!==0){var ae=0;e:for(S=0;S<W;++S)switch(w[S]){case">":if(w[S-1]!="/"){++S;break e}if(g&&g.cellStyles){if(I=wt(w.slice(ae,S),!0),ee=I.r!=null?parseInt(I.r,10):ee+1,re=-1,g.sheetRows&&g.sheetRows<ee)continue;ie={},Y=!1,I.ht&&(Y=!0,ie.hpt=parseFloat(I.ht),ie.hpx=Dc(ie.hpt)),I.hidden=="1"&&(Y=!0,ie.hidden=!0),I.outlineLevel!=null&&(Y=!0,ie.level=+I.outlineLevel),Y&&(M[ee-1]=ie)}break;case"<":ae=S;break}if(ae>=S)break;if(I=wt(w.slice(ae,S),!0),ee=I.r!=null?parseInt(I.r,10):ee+1,re=-1,!(g.sheetRows&&g.sheetRows<ee)){y.s.r>ee-1&&(y.s.r=ee-1),y.e.r<ee-1&&(y.e.r=ee-1),g&&g.cellStyles&&(ie={},Y=!1,I.ht&&(Y=!0,ie.hpt=parseFloat(I.ht),ie.hpx=Dc(ie.hpt)),I.hidden=="1"&&(Y=!0,ie.hidden=!0),I.outlineLevel!=null&&(Y=!0,ie.level=+I.outlineLevel),Y&&(M[ee-1]=ie)),E=w.slice(S).split(e);for(var oe=0;oe!=E.length&&E[oe].trim().charAt(0)=="<";++oe);for(E=E.slice(oe),S=0;S!=E.length;++S)if(w=E[S].trim(),w.length!==0){if(P=w.match(r),D=S,A=0,H=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,P!=null&&P.length===2){for(D=0,J=P[1],A=0;A!=J.length&&!((H=J.charCodeAt(A)-64)<1||H>26);++A)D=26*D+H;--D,re=D}else++re;for(A=0;A!=w.length&&w.charCodeAt(A)!==62;++A);if(++A,I=wt(w.slice(0,A),!0),I.r||(I.r=yt({r:ee-1,c:re})),J=w.slice(A),B={t:""},(P=J.match(s))!=null&&P[1]!==""&&(B.v=Ut(P[1])),g.cellFormula){if((P=J.match(l))!=null&&P[1]!==""){if(B.f=Ut(nr(P[1])).replace(/\r\n/g,`
`),g.xlfn||(B.f=iy(B.f)),P[0].indexOf('t="array"')>-1)B.F=(J.match(a)||[])[1],B.F.indexOf(":")>-1&&ue.push([Ot(B.F),B.F]);else if(P[0].indexOf('t="shared"')>-1){he=wt(P[0]);var de=Ut(nr(P[1]));g.xlfn||(de=iy(de)),O[parseInt(he.si,10)]=[he,de,I.r]}}else(P=J.match(/<f[^>]*\/>/))&&(he=wt(P[0]),O[he.si]&&(B.f=SI(O[he.si][1],O[he.si][2],I.r)));var ge=yr(I.r);for(A=0;A<ue.length;++A)ge.r>=ue[A][0].s.r&&ge.r<=ue[A][0].e.r&&ge.c>=ue[A][0].s.c&&ge.c<=ue[A][0].e.c&&(B.F=ue[A][1])}if(I.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(R)B.t="z";else continue;else B.t=I.t||"n";switch(y.s.c>re&&(y.s.c=re),y.e.c<re&&(y.e.c=re),B.t){case"n":if(B.v==""||B.v==null){if(!R)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!R)continue;B.t="z"}else ye=Gu[parseInt(B.v,10)],B.v=ye.t,B.r=ye.r,g.cellHTML&&(B.h=ye.h);break;case"str":B.t="s",B.v=B.v!=null?nr(B.v):"",g.cellHTML&&(B.h=Gp(B.v));break;case"inlineStr":P=J.match(n),B.t="s",P!=null&&(ye=ug(P[1]))?(B.v=ye.t,g.cellHTML&&(B.h=ye.h)):B.v="";break;case"b":B.v=fr(B.v);break;case"d":g.cellDates?B.v=mr(B.v,1):(B.v=Zr(mr(B.v,1)),B.t="n");break;case"e":(!g||g.cellText!==!1)&&(B.w=B.v),B.v=pw[B.v];break}if(ce=Ee=0,fe=null,je&&I.s!==void 0&&(fe=T.CellXf[I.s],fe!=null&&(fe.numFmtId!=null&&(ce=fe.numFmtId),g.cellStyles&&fe.fillId!=null&&(Ee=fe.fillId))),fb(B,ce,Ee,g,_,T),g.cellDates&&je&&B.t=="n"&&dl(xt[ce])&&(B.t="d",B.v=Uh(B.v)),I.cm&&g.xlmeta){var Oe=(g.xlmeta.Cell||[])[+I.cm-1];Oe&&Oe.type=="XLDAPR"&&(B.D=!0)}if(F){var q=yr(I.r);p[q.r]||(p[q.r]=[]),p[q.r][q.c]=B}else p[I.r]=B}}}}M.length>0&&(p["!rows"]=M)}})();function NF(e,t,r,n){var a=[],s=[],l=Ot(e["!ref"]),d="",m,p="",g=[],y=0,_=0,T=e["!rows"],S=Array.isArray(e),w={r:p},E,P=-1;for(_=l.s.c;_<=l.e.c;++_)g[_]=hr(_);for(y=l.s.r;y<=l.e.r;++y){for(s=[],p=kr(y),_=l.s.c;_<=l.e.c;++_){m=g[_]+p;var D=S?(e[y]||[])[_]:e[m];D!==void 0&&(d=CF(D,m,e,t))!=null&&s.push(d)}(s.length>0||T&&T[y])&&(w={r:p},T&&T[y]&&(E=T[y],E.hidden&&(w.hidden=1),P=-1,E.hpx?P=fd(E.hpx):E.hpt&&(P=E.hpt),P>-1&&(w.ht=P,w.customHeight=1),E.level&&(w.outlineLevel=E.level)),a[a.length]=Xe("row",s.join(""),w))}if(T)for(;y<T.length;++y)T&&T[y]&&(w={r:y+1},E=T[y],E.hidden&&(w.hidden=1),P=-1,E.hpx?P=fd(E.hpx):E.hpt&&(P=E.hpt),P>-1&&(w.ht=P,w.customHeight=1),E.level&&(w.outlineLevel=E.level),a[a.length]=Xe("row","",w));return a.join("")}function mb(e,t,r,n){var a=[Dr,Xe("worksheet",null,{xmlns:fl[0],"xmlns:r":Kr.r})],s=r.SheetNames[e],l=0,d="",m=r.Sheets[s];m==null&&(m={});var p=m["!ref"]||"A1",g=Ot(p);if(g.e.c>16383||g.e.r>1048575){if(t.WTF)throw new Error("Range "+p+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),p=Ct(g)}n||(n={}),m["!comments"]=[];var y=[];hF(m,r,e,t,a),a[a.length]=Xe("dimension",null,{ref:p}),a[a.length]=EF(m,t,e,r),t.sheetFormat&&(a[a.length]=Xe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),m["!cols"]!=null&&m["!cols"].length>0&&(a[a.length]=wF(m,m["!cols"])),a[l=a.length]="<sheetData/>",m["!links"]=[],m["!ref"]!=null&&(d=NF(m,t),d.length>0&&(a[a.length]=d)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),m["!protect"]&&(a[a.length]=gF(m["!protect"])),m["!autofilter"]!=null&&(a[a.length]=kF(m["!autofilter"],m,r,e)),m["!merges"]!=null&&m["!merges"].length>0&&(a[a.length]=dF(m["!merges"]));var _=-1,T,S=-1;return m["!links"].length>0&&(a[a.length]="<hyperlinks>",m["!links"].forEach(function(w){w[1].Target&&(T={ref:w[0]},w[1].Target.charAt(0)!="#"&&(S=Xt(n,-1,Jt(w[1].Target).replace(/#.*$/,""),Dt.HLINK),T["r:id"]="rId"+S),(_=w[1].Target.indexOf("#"))>-1&&(T.location=Jt(w[1].Target.slice(_+1))),w[1].Tooltip&&(T.tooltip=Jt(w[1].Tooltip)),a[a.length]=Xe("hyperlink",null,T))}),a[a.length]="</hyperlinks>"),delete m["!links"],m["!margins"]!=null&&(a[a.length]=yF(m["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=dn("ignoredErrors",Xe("ignoredError",null,{numberStoredAsText:1,sqref:p}))),y.length>0&&(S=Xt(n,-1,"../drawings/drawing"+(e+1)+".xml",Dt.DRAW),a[a.length]=Xe("drawing",null,{"r:id":"rId"+S}),m["!drawing"]=y),m["!comments"].length>0&&(S=Xt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Dt.VML),a[a.length]=Xe("legacyDrawing",null,{"r:id":"rId"+S}),m["!legacy"]=S),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function PF(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function IF(e,t,r){var n=Fe(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=fd(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var d=0,m=n.l;n.l+=4;for(var p={r:e,c:0},g=0;g<16;++g)if(!(t.s.c>g+1<<10||t.e.c<g<<10)){for(var y=-1,_=-1,T=g<<10;T<g+1<<10;++T){p.c=T;var S=Array.isArray(r)?(r[p.r]||[])[p.c]:r[yt(p)];S&&(y<0&&(y=T),_=T)}y<0||(++d,n.write_shift(4,y),n.write_shift(4,_))}var w=n.l;return n.l=m,n.write_shift(4,d),n.l=w,n.length>n.l?n.slice(0,n.l):n}function DF(e,t,r,n){var a=IF(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&ze(e,0,a)}var FF=gl,jF=Mc;function OF(){}function RF(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=BN(e),r}function LF(e,t,r){r==null&&(r=Fe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return kh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),uw(e,r),r.slice(0,r.l)}function MF(e){var t=Ba(e);return[t]}function BF(e,t,r){return r==null&&(r=Fe(8)),hl(t,r)}function zF(e){var t=ml(e);return[t]}function UF(e,t,r){return r==null&&(r=Fe(4)),pl(t,r)}function $F(e){var t=Ba(e),r=e.read_shift(1);return[t,r,"b"]}function WF(e,t,r){return r==null&&(r=Fe(9)),hl(t,r),r.write_shift(1,e.v?1:0),r}function HF(e){var t=ml(e),r=e.read_shift(1);return[t,r,"b"]}function VF(e,t,r){return r==null&&(r=Fe(5)),pl(t,r),r.write_shift(1,e.v?1:0),r}function GF(e){var t=Ba(e),r=e.read_shift(1);return[t,r,"e"]}function KF(e,t,r){return r==null&&(r=Fe(9)),hl(t,r),r.write_shift(1,e.v),r}function ZF(e){var t=ml(e),r=e.read_shift(1);return[t,r,"e"]}function YF(e,t,r){return r==null&&(r=Fe(8)),pl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function qF(e){var t=Ba(e),r=e.read_shift(4);return[t,r,"s"]}function XF(e,t,r){return r==null&&(r=Fe(12)),hl(t,r),r.write_shift(4,t.v),r}function JF(e){var t=ml(e),r=e.read_shift(4);return[t,r,"s"]}function QF(e,t,r){return r==null&&(r=Fe(8)),pl(t,r),r.write_shift(4,t.v),r}function ej(e){var t=Ba(e),r=En(e);return[t,r,"n"]}function tj(e,t,r){return r==null&&(r=Fe(16)),hl(t,r),il(e.v,r),r}function pb(e){var t=ml(e),r=En(e);return[t,r,"n"]}function rj(e,t,r){return r==null&&(r=Fe(12)),pl(t,r),il(e.v,r),r}function nj(e){var t=Ba(e),r=ig(e);return[t,r,"n"]}function aj(e,t,r){return r==null&&(r=Fe(12)),hl(t,r),dw(e.v,r),r}function ij(e){var t=ml(e),r=ig(e);return[t,r,"n"]}function sj(e,t,r){return r==null&&(r=Fe(8)),pl(t,r),dw(e.v,r),r}function oj(e){var t=Ba(e),r=rg(e);return[t,r,"is"]}function lj(e){var t=Ba(e),r=An(e);return[t,r,"str"]}function cj(e,t,r){return r==null&&(r=Fe(12+4*e.v.length)),hl(t,r),an(e.v,r),r.length>r.l?r.slice(0,r.l):r}function uj(e){var t=ml(e),r=An(e);return[t,r,"str"]}function dj(e,t,r){return r==null&&(r=Fe(8+4*e.v.length)),pl(t,r),an(e.v,r),r.length>r.l?r.slice(0,r.l):r}function fj(e,t,r){var n=e.l+t,a=Ba(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"b"];if(r.cellFormula){e.l+=2;var d=Vh(e,n-e.l,r);l[3]=Sn(d,null,a,r.supbooks,r)}else e.l=n;return l}function hj(e,t,r){var n=e.l+t,a=Ba(e);a.r=r["!row"];var s=e.read_shift(1),l=[a,s,"e"];if(r.cellFormula){e.l+=2;var d=Vh(e,n-e.l,r);l[3]=Sn(d,null,a,r.supbooks,r)}else e.l=n;return l}function mj(e,t,r){var n=e.l+t,a=Ba(e);a.r=r["!row"];var s=En(e),l=[a,s,"n"];if(r.cellFormula){e.l+=2;var d=Vh(e,n-e.l,r);l[3]=Sn(d,null,a,r.supbooks,r)}else e.l=n;return l}function pj(e,t,r){var n=e.l+t,a=Ba(e);a.r=r["!row"];var s=An(e),l=[a,s,"str"];if(r.cellFormula){e.l+=2;var d=Vh(e,n-e.l,r);l[3]=Sn(d,null,a,r.supbooks,r)}else e.l=n;return l}var gj=gl,vj=Mc;function xj(e,t){return t==null&&(t=Fe(4)),t.write_shift(4,e),t}function yj(e,t){var r=e.l+t,n=gl(e),a=ng(e),s=An(e),l=An(e),d=An(e);e.l=r;var m={rfx:n,relId:a,loc:s,display:d};return l&&(m.Tooltip=l),m}function _j(e,t){var r=Fe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Mc({s:yr(e[0]),e:yr(e[0])},r),ag("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return an(a||"",r),an(e[1].Tooltip||"",r),an("",r),r.slice(0,r.l)}function wj(){}function bj(e,t,r){var n=e.l+t,a=fw(e),s=e.read_shift(1),l=[a];if(l[2]=s,r.cellFormula){var d=GD(e,n-e.l,r);l[1]=d}else e.l=n;return l}function kj(e,t,r){var n=e.l+t,a=gl(e),s=[a];if(r.cellFormula){var l=ZD(e,n-e.l,r);s[1]=l,e.l=n}else e.l=n;return s}function Sj(e,t,r){r==null&&(r=Fe(18));var n=Gh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var gb=["left","right","top","bottom","header","footer"];function Tj(e){var t={};return gb.forEach(function(r){t[r]=En(e)}),t}function Ej(e,t){return t==null&&(t=Fe(48)),el(e),gb.forEach(function(r){il(e[r],t)}),t}function Cj(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Aj(e,t,r){r==null&&(r=Fe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Nj(e){var t=Fe(24);return t.write_shift(4,4),t.write_shift(4,1),Mc(e,t),t}function Pj(e,t){return t==null&&(t=Fe(66)),t.write_shift(2,e.password?dg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Ij(){}function Dj(){}function Fj(e,t,r,n,a,s,l){if(!e)return e;var d=t||{};n||(n={"!id":{}});var m=d.dense?[]:{},p,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,_=!1,T,S,w,E,P,D,A,H,J,B=[];d.biff=12,d["!row"]=0;var I=0,ee=!1,re=[],ye={},he=d.supbooks||a.supbooks||[[]];if(he.sharedf=ye,he.arrayf=re,he.SheetNames=a.SheetNames||a.Sheets.map(function(F){return F.name}),!d.supbooks&&(d.supbooks=he,a.Names))for(var ce=0;ce<a.Names.length;++ce)he[0][ce+1]=a.Names[ce];var Ee=[],je=[],fe=!1;hd[16]={n:"BrtShortReal",f:pb};var ue;if(fs(e,function(M,ie,Y){if(!_)switch(Y){case 148:p=M;break;case 0:T=M,d.sheetRows&&d.sheetRows<=T.r&&(_=!0),H=kr(E=T.r),d["!row"]=T.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=Dc(M.hpt)),je[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:M[2]},M[2]){case"n":S.v=M[1];break;case"s":A=Gu[M[1]],S.v=A.t,S.r=A.r;break;case"b":S.v=!!M[1];break;case"e":S.v=M[1],d.cellText!==!1&&(S.w=hs[S.v]);break;case"str":S.t="s",S.v=M[1];break;case"is":S.t="s",S.v=M[1].t;break}if((w=l.CellXf[M[0].iStyleRef])&&fb(S,w.numFmtId,null,d,s,l),P=M[0].c==-1?P+1:M[0].c,d.dense?(m[E]||(m[E]=[]),m[E][P]=S):m[hr(P)+H]=S,d.cellFormula){for(ee=!1,I=0;I<re.length;++I){var R=re[I];T.r>=R[0].s.r&&T.r<=R[0].e.r&&P>=R[0].s.c&&P<=R[0].e.c&&(S.F=Ct(R[0]),ee=!0)}!ee&&M.length>3&&(S.f=M[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>P&&(g.s.c=P),g.e.r<T.r&&(g.e.r=T.r),g.e.c<P&&(g.e.c=P),d.cellDates&&w&&S.t=="n"&&dl(xt[w.numFmtId])){var z=ao(S.v);z&&(S.t="d",S.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}ue&&(ue.type=="XLDAPR"&&(S.D=!0),ue=void 0);break;case 1:case 12:if(!d.sheetStubs||y)break;S={t:"z",v:void 0},P=M[0].c==-1?P+1:M[0].c,d.dense?(m[E]||(m[E]=[]),m[E][P]=S):m[hr(P)+H]=S,g.s.r>T.r&&(g.s.r=T.r),g.s.c>P&&(g.s.c=P),g.e.r<T.r&&(g.e.r=T.r),g.e.c<P&&(g.e.c=P),ue&&(ue.type=="XLDAPR"&&(S.D=!0),ue=void 0);break;case 176:B.push(M);break;case 49:ue=((d.xlmeta||{}).Cell||[])[M-1];break;case 494:var U=n["!id"][M.relId];for(U?(M.Target=U.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=U):M.relId==""&&(M.Target="#"+M.loc),E=M.rfx.s.r;E<=M.rfx.e.r;++E)for(P=M.rfx.s.c;P<=M.rfx.e.c;++P)d.dense?(m[E]||(m[E]=[]),m[E][P]||(m[E][P]={t:"z",v:void 0}),m[E][P].l=M):(D=yt({c:P,r:E}),m[D]||(m[D]={t:"z",v:void 0}),m[D].l=M);break;case 426:if(!d.cellFormula)break;re.push(M),J=d.dense?m[E][P]:m[hr(P)+H],J.f=Sn(M[1],g,{r:T.r,c:P},he,d),J.F=Ct(M[0]);break;case 427:if(!d.cellFormula)break;ye[yt(M[0].s)]=M[1],J=d.dense?m[E][P]:m[hr(P)+H],J.f=Sn(M[1],g,{r:T.r,c:P},he,d);break;case 60:if(!d.cellStyles)break;for(;M.e>=M.s;)Ee[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},fe||(fe=!0,fg(M.w/256)),lo(Ee[M.e+1]);break;case 161:m["!autofilter"]={ref:Ct(M)};break;case 476:m["!margins"]=M;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),M.name&&(a.Sheets[r].CodeName=M.name),(M.above||M.left)&&(m["!outline"]={above:M.above,left:M.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),M.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:y=!0;break;case 36:y=!1;break;case 37:y=!0;break;case 38:y=!1;break;default:if(!ie.T){if(!y||d.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},d),delete d.supbooks,delete d["!row"],!m["!ref"]&&(g.s.r<2e6||p&&(p.e.r>0||p.e.c>0||p.s.r>0||p.s.c>0))&&(m["!ref"]=Ct(p||g)),d.sheetRows&&m["!ref"]){var O=Ot(m["!ref"]);d.sheetRows<=+O.e.r&&(O.e.r=d.sheetRows-1,O.e.r>g.e.r&&(O.e.r=g.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>g.e.c&&(O.e.c=g.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),m["!fullref"]=m["!ref"],m["!ref"]=Ct(O))}return B.length>0&&(m["!merges"]=B),Ee.length>0&&(m["!cols"]=Ee),je.length>0&&(m["!rows"]=je),m}function jj(e,t,r,n,a,s,l){if(t.v===void 0)return!1;var d="";switch(t.t){case"b":d=t.v?"1":"0";break;case"d":t=ir(t),t.z=t.z||xt[14],t.v=Zr(mr(t.v)),t.t="n";break;case"n":case"e":d=""+t.v;break;default:d=t.v;break}var m={r,c:n};switch(m.s=po(a.cellXfs,t,a),t.l&&s["!links"].push([yt(m),t.l]),t.c&&s["!comments"].push([yt(m),t.c]),t.t){case"s":case"str":return a.bookSST?(d=vg(a.Strings,t.v,a.revStrings),m.t="s",m.v=d,l?ze(e,18,QF(t,m)):ze(e,7,XF(t,m))):(m.t="str",l?ze(e,17,dj(t,m)):ze(e,6,cj(t,m))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?ze(e,13,sj(t,m)):ze(e,2,aj(t,m)):l?ze(e,16,rj(t,m)):ze(e,5,tj(t,m)),!0;case"b":return m.t="b",l?ze(e,15,VF(t,m)):ze(e,4,WF(t,m)),!0;case"e":return m.t="e",l?ze(e,14,YF(t,m)):ze(e,3,KF(t,m)),!0}return l?ze(e,12,UF(t,m)):ze(e,1,BF(t,m)),!0}function Oj(e,t,r,n){var a=Ot(t["!ref"]||"A1"),s,l="",d=[];ze(e,145);var m=Array.isArray(t),p=a.e.r;t["!rows"]&&(p=Math.max(a.e.r,t["!rows"].length-1));for(var g=a.s.r;g<=p;++g){l=kr(g),DF(e,t,a,g);var y=!1;if(g<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){g===a.s.r&&(d[_]=hr(_)),s=d[_]+l;var T=m?(t[g]||[])[_]:t[s];if(!T){y=!1;continue}y=jj(e,T,g,_,n,t,y)}}ze(e,146)}function Rj(e,t){!t||!t["!merges"]||(ze(e,177,xj(t["!merges"].length)),t["!merges"].forEach(function(r){ze(e,176,vj(r))}),ze(e,178))}function Lj(e,t){!t||!t["!cols"]||(ze(e,390),t["!cols"].forEach(function(r,n){r&&ze(e,60,Sj(n,r))}),ze(e,391))}function Mj(e,t){!t||!t["!ref"]||(ze(e,648),ze(e,649,Nj(Ot(t["!ref"]))),ze(e,650))}function Bj(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Xt(r,-1,n[1].Target.replace(/#.*$/,""),Dt.HLINK);ze(e,494,_j(n,a))}}),delete t["!links"]}function zj(e,t,r,n){if(t["!comments"].length>0){var a=Xt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Dt.VML);ze(e,551,ag("rId"+a)),t["!legacy"]=a}}function Uj(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Ct(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,d=$n(s);d.s.r==d.e.r&&(d.e.r=$n(t["!ref"]).e.r,s=Ct(d));for(var m=0;m<l.length;++m){var p=l[m];if(p.Name=="_xlnm._FilterDatabase"&&p.Sheet==n){p.Ref="'"+r.SheetNames[n]+"'!"+s;break}}m==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ze(e,161,Mc(Ot(s))),ze(e,162)}}function $j(e,t,r){ze(e,133),ze(e,137,Aj(t,r)),ze(e,138),ze(e,134)}function Wj(e,t){t["!protect"]&&ze(e,535,Pj(t["!protect"]))}function Hj(e,t,r,n){var a=Qn(),s=r.SheetNames[e],l=r.Sheets[s]||{},d=s;try{r&&r.Workbook&&(d=r.Workbook.Sheets[e].CodeName||d)}catch{}var m=Ot(l["!ref"]||"A1");if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],ze(a,129),(r.vbaraw||l["!outline"])&&ze(a,147,LF(d,l["!outline"])),ze(a,148,jF(m)),$j(a,l,r.Workbook),Lj(a,l),Oj(a,l,e,t),Wj(a,l),Uj(a,l,r,e),Rj(a,l),Bj(a,l,n),l["!margins"]&&ze(a,476,Ej(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Mj(a,l),zj(a,l,e,n),ze(a,130),a.end()}function Vj(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var l=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var a=Ut((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function Gj(e,t,r,n,a,s){var l=s||{"!type":"chart"};if(!e)return s;var d=0,m=0,p="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(y){var _=Vj(y);g.s.r=g.s.c=0,g.e.c=d,p=hr(d),_[0].forEach(function(T,S){l[p+kr(S)]={t:"n",v:T,z:_[1]},m=S}),g.e.r<m&&(g.e.r=m),++d}),d>0&&(l["!ref"]=Ct(g)),l}function Kj(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l,d=e.match(hb);return d&&xg(d[0],s,a,r),(l=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=l[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Zj(e,t){e.l+=10;var r=An(e);return{name:r}}function Yj(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},l=!1;return fs(e,function(m,p,g){switch(g){case 550:s["!rel"]=m;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),m.name&&(a.Sheets[r].CodeName=m.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(p.T>0)){if(!(p.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var yg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],qj=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Xj=[],Jj=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function uy(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=fr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function dy(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=fr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function vb(e){dy(e.WBProps,yg),dy(e.CalcPr,Jj),uy(e.WBView,qj),uy(e.Sheets,Xj),Ec.date1904=fr(e.WBProps.date1904)}function Qj(e){return!e.Workbook||!e.Workbook.WBProps?"false":fr(e.Workbook.WBProps.date1904)?"true":"false"}var eO="][*?/\\".split("");function xb(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return eO.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function tO(e,t,r){e.forEach(function(n,a){xb(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[a]&&t[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function yb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];tO(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)QD(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var rO=/<\w+:workbook/;function nO(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},l=0;if(e.replace(Pn,function(m,p){var g=wt(m);switch(ji(g[0])){case"<?xml":break;case"<workbook":m.match(rO)&&(a="xmlns"+m.match(/<(\w+):/)[1]),r.xmlns=g[a];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":yg.forEach(function(y){if(g[y[0]]!=null)switch(y[2]){case"bool":r.WBProps[y[0]]=fr(g[y[0]]);break;case"int":r.WBProps[y[0]]=parseInt(g[y[0]],10);break;default:r.WBProps[y[0]]=g[y[0]]}}),g.codeName&&(r.WBProps.CodeName=nr(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Ut(nr(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=nr(g.name),g.comment&&(s.Comment=g.comment),g.localSheetId&&(s.Sheet=+g.localSheetId),fr(g.hidden||"0")&&(s.Hidden=!0),l=p+m.length;break;case"</definedName>":s.Ref=Ut(nr(e.slice(l,p))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return m}),fl.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return vb(r),r}function _b(e){var t=[Dr];t[t.length]=Xe("workbook",null,{xmlns:fl[0],"xmlns:r":Kr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(yg.forEach(function(d){e.Workbook.WBProps[d[0]]!=null&&e.Workbook.WBProps[d[0]]!=d[1]&&(n[d[0]]=e.Workbook.WBProps[d[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Xe("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var l={name:Jt(e.SheetNames[s].slice(0,31))};if(l.sheetId=""+(s+1),l["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Xe("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(d){var m={name:d.Name};d.Comment&&(m.comment=d.Comment),d.Sheet!=null&&(m.localSheetId=""+d.Sheet),d.Hidden&&(m.hidden="1"),d.Ref&&(t[t.length]=Xe("definedName",Jt(d.Ref),m))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function aO(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pp(e),r.name=An(e),r}function iO(e,t){return t||(t=Fe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),ag(e.strRelID,t),an(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function sO(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?An(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function oO(e,t){t||(t=Fe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),uw(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function lO(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function cO(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=zN(e),l=KD(e,0,r),d=ng(e);e.l=n;var m={Name:s,Ptg:l};return a<268435455&&(m.Sheet=a),d&&(m.Comment=d),m}function uO(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],l=[[]];return l.SheetNames=[],l.XTI=[],hd[16]={n:"BrtFRTArchID$",f:lO},fs(e,function(m,p,g){switch(g){case 156:l.SheetNames.push(m.name),r.Sheets.push(m);break;case 153:r.WBProps=m;break;case 39:m.Sheet!=null&&(t.SID=m.Sheet),m.Ref=Sn(m.Ptg,null,null,l,t),delete t.SID,delete m.Ptg,s.push(m);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([g,m]):l[0]=[g,m],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(m),l.XTI=l.XTI.concat(m);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(g),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(g),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!p.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},t),vb(r),r.Names=s,r.supbooks=l,r}function dO(e,t){ze(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ze(e,156,iO(a))}ze(e,144)}function fO(e,t){t||(t=Fe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return an("SheetJS",t),an(rd.version,t),an(rd.version,t),an("7262",t),t.length>t.l?t.slice(0,t.l):t}function hO(e,t){t||(t=Fe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function mO(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(ze(e,135),ze(e,158,hO(a)),ze(e,136))}}function pO(e,t){var r=Qn();return ze(r,131),ze(r,128,fO()),ze(r,153,oO(e.Workbook&&e.Workbook.WBProps||null)),mO(r,e),dO(r,e),ze(r,132),r.end()}function gO(e,t,r){return t.slice(-4)===".bin"?uO(e,r):nO(e,r)}function vO(e,t,r,n,a,s,l,d){return t.slice(-4)===".bin"?Fj(e,n,r,a,s,l,d):uF(e,n,r,a,s,l,d)}function xO(e,t,r,n,a,s,l,d){return t.slice(-4)===".bin"?Yj(e,n,r,a,s):Kj(e,n,r,a,s)}function yO(e,t,r,n,a,s,l,d){return t.slice(-4)===".bin"?bI():kI()}function _O(e,t,r,n,a,s,l,d){return t.slice(-4)===".bin"?_I():wI()}function wO(e,t,r,n){return t.slice(-4)===".bin"?v3(e,r,n):i3(e,r,n)}function bO(e,t,r){return Qw(e,r)}function kO(e,t,r){return t.slice(-4)===".bin"?S5(e,r):w5(e,r)}function SO(e,t,r){return t.slice(-4)===".bin"?pI(e,r):sI(e,r)}function TO(e,t,r){return t.slice(-4)===".bin"?nI(e):tI(e)}function EO(e,t,r,n){return r.slice(-4)===".bin"?aI(e,t,r,n):void 0}function CO(e,t,r){return t.slice(-4)===".bin"?J3(e,t,r):eI(e,t,r)}function AO(e,t,r){return(t.slice(-4)===".bin"?pO:_b)(e)}function NO(e,t,r,n,a){return(t.slice(-4)===".bin"?Hj:mb)(e,r,n,a)}function PO(e,t,r){return(t.slice(-4)===".bin"?C3:Xw)(e,r)}function IO(e,t,r){return(t.slice(-4)===".bin"?C5:Ww)(e,r)}function DO(e,t,r){return(t.slice(-4)===".bin"?gI:rb)(e)}function FO(e){return(e.slice(-4)===".bin"?Q3:eb)()}var wb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,bb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ei(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(wb),s,l,d,m;if(a)for(m=0;m!=a.length;++m)s=a[m].match(bb),(l=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?d="xmlns"+s[1].slice(6):d=s[1].slice(l+1),n[d]=s[2].slice(1,s[2].length-1));return n}function jO(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(wb),a,s,l,d;if(n)for(d=0;d!=n.length;++d)a=n[d].match(bb),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(s+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Zu;function OO(e,t){var r=Zu[e]||Ut(e);return r==="General"?nl(t):ga(r,t)}function RO(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=fr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=mr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ut(t)]=a}function LO(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||hs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ad(e.v):e.w=nl(e.v):e.w=OO(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Zu[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&dl(n)){var a=ao(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function MO(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=X5[n.Pattern]||n.Pattern)}e[t.ID]=t}function BO(e,t,r,n,a,s,l,d,m,p){var g="General",y=n.StyleID,_={};p=p||{};var T=[],S=0;for(y===void 0&&d&&(y=d.StyleID),y===void 0&&l&&(y=l.StyleID);s[y]!==void 0&&(s[y].nf&&(g=s[y].nf),s[y].Interior&&T.push(s[y].Interior),!!s[y].Parent);)y=s[y].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=fr(e);break;case"String":n.t="s",n.r=A1(Ut(e)),n.v=e.indexOf("<")>-1?Ut(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(mr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Ut(e):n.v<60&&(n.v=n.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=pw[e],p.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=A1(t||e));break}if(LO(n,g,p),p.cellFormula!==!1)if(n.Formula){var w=Ut(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=Tc(w,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Tc("RC:RC",a):n.ArrayRange&&(n.F=Tc(n.ArrayRange,a),m.push([Ot(n.F),n.F]))}else for(S=0;S<m.length;++S)a.r>=m[S][0].s.r&&a.r<=m[S][0].e.r&&a.c>=m[S][0].s.c&&a.c<=m[S][0].e.c&&(n.F=m[S][1]);p.cellStyles&&(T.forEach(function(E){!_.patternType&&E.patternType&&(_.patternType=E.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function zO(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Hm(e,t){var r=t||{};Oc();var n=yc(Kp(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof Bt<"u"?n=Bt.utils.decode(65001,gh(n)):n=nr(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=ir(r);return l.type="string",Ic.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(bt){a.indexOf("<"+bt)>=0&&(s=!0)}),s)return bR(n,r);Zu={"General Number":"General","General Date":xt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xt[15],"Short Date":xt[14],"Long Time":xt[19],"Medium Time":xt[18],"Short Time":xt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xt[2],Standard:xt[4],Percent:xt[10],Scientific:xt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var d,m=[],p,g={},y=[],_=r.dense?[]:{},T="",S={},w={},E=ei('<Data ss:Type="String">'),P=0,D=0,A=0,H={s:{r:2e6,c:2e6},e:{r:0,c:0}},J={},B={},I="",ee=0,re=[],ye={},he={},ce=0,Ee=[],je=[],fe={},ue=[],O,F=!1,M=[],ie=[],Y={},R=0,z=0,U={Sheets:[],WBProps:{date1904:!1}},te={};od.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";d=od.exec(n);)switch(d[3]=(W=d[3]).toLowerCase()){case"data":if(W=="data"){if(d[1]==="/"){if((p=m.pop())[0]!==d[3])throw new Error("Bad state: "+p.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break}if(m[m.length-1][1])break;d[1]==="/"?BO(n.slice(P,d.index),I,E,m[m.length-1][0]=="comment"?fe:S,{c:D,r:A},J,ue[D],w,M,r):(I="",E=ei(d[0]),P=d.index+d[0].length);break;case"cell":if(d[1]==="/")if(je.length>0&&(S.c=je),(!r.sheetRows||r.sheetRows>A)&&S.v!==void 0&&(r.dense?(_[A]||(_[A]=[]),_[A][D]=S):_[hr(D)+kr(A)]=S),S.HRef&&(S.l={Target:Ut(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(R=D+(parseInt(S.MergeAcross,10)|0),z=A+(parseInt(S.MergeDown,10)|0),re.push({s:{c:D,r:A},e:{c:R,r:z}})),!r.sheetStubs)S.MergeAcross?D=R+1:++D;else if(S.MergeAcross||S.MergeDown){for(var ae=D;ae<=R;++ae)for(var oe=A;oe<=z;++oe)(ae>D||oe>A)&&(r.dense?(_[oe]||(_[oe]=[]),_[oe][ae]={t:"z"}):_[hr(ae)+kr(oe)]={t:"z"});D=R+1}else++D;else S=jO(d[0]),S.Index&&(D=+S.Index-1),D<H.s.c&&(H.s.c=D),D>H.e.c&&(H.e.c=D),d[0].slice(-2)==="/>"&&++D,je=[];break;case"row":d[1]==="/"||d[0].slice(-2)==="/>"?(A<H.s.r&&(H.s.r=A),A>H.e.r&&(H.e.r=A),d[0].slice(-2)==="/>"&&(w=ei(d[0]),w.Index&&(A=+w.Index-1)),D=0,++A):(w=ei(d[0]),w.Index&&(A=+w.Index-1),Y={},(w.AutoFitHeight=="0"||w.Height)&&(Y.hpx=parseInt(w.Height,10),Y.hpt=fd(Y.hpx),ie[A]=Y),w.Hidden=="1"&&(Y.hidden=!0,ie[A]=Y));break;case"worksheet":if(d[1]==="/"){if((p=m.pop())[0]!==d[3])throw new Error("Bad state: "+p.join("|"));y.push(T),H.s.r<=H.e.r&&H.s.c<=H.e.c&&(_["!ref"]=Ct(H),r.sheetRows&&r.sheetRows<=H.e.r&&(_["!fullref"]=_["!ref"],H.e.r=r.sheetRows-1,_["!ref"]=Ct(H))),re.length&&(_["!merges"]=re),ue.length>0&&(_["!cols"]=ue),ie.length>0&&(_["!rows"]=ie),g[T]=_}else H={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=D=0,m.push([d[3],!1]),p=ei(d[0]),T=Ut(p.Name),_=r.dense?[]:{},re=[],M=[],ie=[],te={name:T,Hidden:0},U.Sheets.push(te);break;case"table":if(d[1]==="/"){if((p=m.pop())[0]!==d[3])throw new Error("Bad state: "+p.join("|"))}else{if(d[0].slice(-2)=="/>")break;m.push([d[3],!1]),ue=[],F=!1}break;case"style":d[1]==="/"?MO(J,B,r):B=ei(d[0]);break;case"numberformat":B.nf=Ut(ei(d[0]).Format||"General"),Zu[B.nf]&&(B.nf=Zu[B.nf]);for(var de=0;de!=392&&xt[de]!=B.nf;++de);if(de==392){for(de=57;de!=392;++de)if(xt[de]==null){Ii(B.nf,de);break}}break;case"column":if(m[m.length-1][0]!=="table")break;if(O=ei(d[0]),O.Hidden&&(O.hidden=!0,delete O.Hidden),O.Width&&(O.wpx=parseInt(O.Width,10)),!F&&O.wpx>10){F=!0,Tn=Yw;for(var ge=0;ge<ue.length;++ge)ue[ge]&&lo(ue[ge])}F&&lo(O),ue[O.Index-1||ue.length]=O;for(var Oe=0;Oe<+O.Span;++Oe)ue[ue.length]=ir(O);break;case"namedrange":if(d[1]==="/")break;U.Names||(U.Names=[]);var q=wt(d[0]),Ze={Name:q.Name,Ref:Tc(q.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Ze.Sheet=U.Sheets.length-1),U.Names.push(Ze);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(d[0].slice(-2)==="/>")break;d[1]==="/"?I+=n.slice(ee,d.index):ee=d.index+d[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=ei(d[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(d[0].slice(-2)==="/>")break;d[1]==="/"?d4(ye,W,n.slice(ce,d.index)):ce=d.index+d[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(d[1]==="/"){if((p=m.pop())[0]!==d[3])throw new Error("Bad state: "+p.join("|"))}else m.push([d[3],!1]);break;case"comment":if(d[1]==="/"){if((p=m.pop())[0]!==d[3])throw new Error("Bad state: "+p.join("|"));zO(fe),je.push(fe)}else m.push([d[3],!1]),p=ei(d[0]),fe={a:p.Author};break;case"autofilter":if(d[1]==="/"){if((p=m.pop())[0]!==d[3])throw new Error("Bad state: "+p.join("|"))}else if(d[0].charAt(d[0].length-2)!=="/"){var Je=ei(d[0]);_["!autofilter"]={ref:Tc(Je.Range).replace(/\$/g,"")},m.push([d[3],!0])}break;case"name":break;case"datavalidation":if(d[1]==="/"){if((p=m.pop())[0]!==d[3])throw new Error("Bad state: "+p.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(d[1]==="/"){if((p=m.pop())[0]!==d[3])throw new Error("Bad state: "+p.join("|"))}else d[0].charAt(d[0].length-2)!=="/"&&m.push([d[3],!0]);break;case"null":break;default:if(m.length==0&&d[3]=="document"||m.length==0&&d[3]=="uof")return gy(n,r);var Ye=!0;switch(m[m.length-1][0]){case"officedocumentsettings":switch(d[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ye=!1}break;case"componentoptions":switch(d[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ye=!1}break;case"excelworkbook":switch(d[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ye=!1}break;case"workbookoptions":switch(d[3]){case"owcversion":break;case"height":break;case"width":break;default:Ye=!1}break;case"worksheetoptions":switch(d[3]){case"visible":if(d[0].slice(-2)!=="/>")if(d[1]==="/")switch(n.slice(ce,d.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else ce=d.index+d[0].length;break;case"header":_["!margins"]||el(_["!margins"]={},"xlml"),isNaN(+wt(d[0]).Margin)||(_["!margins"].header=+wt(d[0]).Margin);break;case"footer":_["!margins"]||el(_["!margins"]={},"xlml"),isNaN(+wt(d[0]).Margin)||(_["!margins"].footer=+wt(d[0]).Margin);break;case"pagemargins":var nt=wt(d[0]);_["!margins"]||el(_["!margins"]={},"xlml"),isNaN(+nt.Top)||(_["!margins"].top=+nt.Top),isNaN(+nt.Left)||(_["!margins"].left=+nt.Left),isNaN(+nt.Right)||(_["!margins"].right=+nt.Right),isNaN(+nt.Bottom)||(_["!margins"].bottom=+nt.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ye=!1}break;case"pivottable":case"pivotcache":switch(d[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ye=!1}break;case"pagebreaks":switch(d[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ye=!1}break;case"autofilter":switch(d[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ye=!1}break;case"querytable":switch(d[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ye=!1}break;case"datavalidation":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ye=!1}break;case"sorting":case"conditionalformatting":switch(d[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ye=!1}break;case"mapinfo":case"schema":case"data":switch(d[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ye=!1}break;case"smarttags":break;default:Ye=!1;break}if(Ye||d[3].match(/!\[CDATA/))break;if(!m[m.length-1][1])throw"Unrecognized tag: "+d[3]+"|"+m.join("|");if(m[m.length-1][0]==="customdocumentproperties"){if(d[0].slice(-2)==="/>")break;d[1]==="/"?RO(he,W,Ee,n.slice(ce,d.index)):(Ee=d,ce=d.index+d[0].length);break}if(r.WTF)throw"Unrecognized tag: "+d[3]+"|"+m.join("|")}var Be={};return!r.bookSheets&&!r.bookProps&&(Be.Sheets=g),Be.SheetNames=y,Be.Workbook=U,Be.SSF=ir(xt),Be.Props=ye,Be.Custprops=he,Be}function bp(e,t){switch(bg(t=t||{}),t.type||"base64"){case"base64":return Hm(pa(e),t);case"binary":case"buffer":case"file":return Hm(e,t);case"array":return Hm(ho(e),t)}}function UO(e,t){var r=[];return e.Props&&r.push(f4(e.Props,t)),e.Custprops&&r.push(h4(e.Props,e.Custprops)),r.join("")}function $O(){return""}function WO(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Xe("NumberFormat",null,{"ss:Format":Jt(xt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Xe("Style",s.join(""),l))}),Xe("Styles",r.join(""))}function kb(e){return Xe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+pg(e.Ref,{r:0,c:0})})}function HO(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(kb(a)))}return Xe("Names",r.join(""))}function VO(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],l=0;l<a.length;++l){var d=a[l];d.Sheet==r&&(d.Name.match(/^_xlfn\./)||s.push(kb(d)))}return s.join("")}function GO(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Xe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Xe("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Xe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Xe("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(dn("ProtectContents","True")),e["!protect"].objects&&a.push(dn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(dn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(dn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(dn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Xe("WorksheetOptions",a.join(""),{xmlns:da.x})}function KO(e){return e.map(function(t){var r=pN(t.t||""),n=Xe("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Xe("Comment",n,{"ss:Author":t.a})}).join("")}function ZO(e,t,r,n,a,s,l){if(!e||e.v==null&&e.f==null)return"";var d={};if(e.f&&(d["ss:Formula"]="="+Jt(pg(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var m=yr(e.F.slice(t.length+1));d["ss:ArrayRange"]="RC:R"+(m.r==l.r?"":"["+(m.r-l.r)+"]")+"C"+(m.c==l.c?"":"["+(m.c-l.c)+"]")}if(e.l&&e.l.Target&&(d["ss:HRef"]=Jt(e.l.Target),e.l.Tooltip&&(d["x:HRefScreenTip"]=Jt(e.l.Tooltip))),r["!merges"])for(var p=r["!merges"],g=0;g!=p.length;++g)p[g].s.c!=l.c||p[g].s.r!=l.r||(p[g].e.c>p[g].s.c&&(d["ss:MergeAcross"]=p[g].e.c-p[g].s.c),p[g].e.r>p[g].s.r&&(d["ss:MergeDown"]=p[g].e.r-p[g].s.r));var y="",_="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":y="Number",_=String(e.v);break;case"b":y="Boolean",_=e.v?"1":"0";break;case"e":y="Error",_=hs[e.v];break;case"d":y="DateTime",_=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||xt[14]);break;case"s":y="String",_=mN(e.v||"");break}var T=po(n.cellXfs,e,n);d["ss:StyleID"]="s"+(21+T),d["ss:Index"]=l.c+1;var S=e.v!=null?_:"",w=e.t=="z"?"":'<Data ss:Type="'+y+'">'+S+"</Data>";return(e.c||[]).length>0&&(w+=KO(e.c)),Xe("Cell",w,d)}function YO(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Dc(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function qO(e,t,r,n){if(!e["!ref"])return"";var a=Ot(e["!ref"]),s=e["!merges"]||[],l=0,d=[];e["!cols"]&&e["!cols"].forEach(function(E,P){lo(E);var D=!!E.width,A=Gh(P,E),H={"ss:Index":P+1};D&&(H["ss:Width"]=ud(A.width)),E.hidden&&(H["ss:Hidden"]="1"),d.push(Xe("Column",null,H))});for(var m=Array.isArray(e),p=a.s.r;p<=a.e.r;++p){for(var g=[YO(p,(e["!rows"]||[])[p])],y=a.s.c;y<=a.e.c;++y){var _=!1;for(l=0;l!=s.length;++l)if(!(s[l].s.c>y)&&!(s[l].s.r>p)&&!(s[l].e.c<y)&&!(s[l].e.r<p)){(s[l].s.c!=y||s[l].s.r!=p)&&(_=!0);break}if(!_){var T={r:p,c:y},S=yt(T),w=m?(e[p]||[])[y]:e[S];g.push(ZO(w,S,e,t,r,n,T))}}g.push("</Row>"),g.length>2&&d.push(g.join(""))}return d.join("")}function XO(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],l=s?VO(s,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=s?qO(s,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(GO(s,t,e,r)),n.join("")}function JO(e,t){t||(t={}),e.SSF||(e.SSF=ir(xt)),e.SSF&&(Oc(),_d(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],po(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(UO(e,t)),r.push($O()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Xe("Worksheet",XO(n,t,e),{"ss:Name":Jt(e.SheetNames[n])}));return r[2]=WO(e,t),r[3]=HO(e),Dr+Xe("Workbook",r.join(""),{xmlns:da.ss,"xmlns:o":da.o,"xmlns:x":da.x,"xmlns:ss":da.ss,"xmlns:dt":da.dt,"xmlns:html":da.html})}function QO(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=VN(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=GN(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var eR=[60,1084,2066,2165,2175];function tR(e,t,r,n,a){var s=n,l=[],d=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&d.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(d)}l.push(d),r.l+=s;for(var m=ss(r,r.l),p=kp[m],g=0;p!=null&&eR.indexOf(m)>-1;)s=ss(r,r.l+2),g=r.l+4,m==2066?g+=4:(m==2165||m==2175)&&(g+=12),d=r.slice(g,r.l+4+s),l.push(d),r.l+=4+s,p=kp[m=ss(r,r.l)];var y=nn(l);un(y,0);var _=0;y.lens=[];for(var T=0;T<l.length;++T)y.lens.push(_),_+=l[T].length;if(y.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+y.length+" < "+n;return t.f(y,y.length,a)}function Ti(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=xt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||hs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ad(e.v):e.w=nl(e.v):e.w=ga(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&dl(xt[n]||String(n))){var a=ao(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function rh(e,t,r){return{v:e,ixfe:t,t:r}}function rR(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},l={},d=null,m=[],p="",g={},y,_="",T,S,w,E,P={},D=[],A,H,J=[],B=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ee={},re=function(pt){return pt<8?Xo[pt]:pt<64&&B[pt-8]||Xo[pt]},ye=function(pt,At,Ar){var Zt=At.XF.data;if(!(!Zt||!Zt.patternType||!Ar||!Ar.cellStyles)){At.s={},At.s.patternType=Zt.patternType;var ct;(ct=cd(re(Zt.icvFore)))&&(At.s.fgColor={rgb:ct}),(ct=cd(re(Zt.icvBack)))&&(At.s.bgColor={rgb:ct})}},he=function(pt,At,Ar){if(!(Y>1)&&!(Ar.sheetRows&&pt.r>=Ar.sheetRows)){if(Ar.cellStyles&&At.XF&&At.XF.data&&ye(pt,At,Ar),delete At.ixfe,delete At.XF,y=pt,_=yt(pt),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),pt.r<l.s.r&&(l.s.r=pt.r),pt.c<l.s.c&&(l.s.c=pt.c),pt.r+1>l.e.r&&(l.e.r=pt.r+1),pt.c+1>l.e.c&&(l.e.c=pt.c+1),Ar.cellFormula&&At.f){for(var Zt=0;Zt<D.length;++Zt)if(!(D[Zt][0].s.c>pt.c||D[Zt][0].s.r>pt.r)&&!(D[Zt][0].e.c<pt.c||D[Zt][0].e.r<pt.r)){At.F=Ct(D[Zt][0]),(D[Zt][0].s.c!=pt.c||D[Zt][0].s.r!=pt.r)&&delete At.f,At.f&&(At.f=""+Sn(D[Zt][1],l,pt,M,ce));break}}Ar.dense?(a[pt.r]||(a[pt.r]=[]),a[pt.r][pt.c]=At):a[_]=At}},ce={enc:!1,sbcch:0,snames:[],sharedf:P,arrayf:D,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(ce.password=t.password);var Ee,je=[],fe=[],ue=[],O=[],F=!1,M=[];M.SheetNames=ce.snames,M.sharedf=ce.sharedf,M.arrayf=ce.arrayf,M.names=[],M.XTI=[];var ie=0,Y=0,R=0,z=[],U=[],te;ce.codepage=1200,La(1200);for(var W=!1;e.l<e.length-1;){var ae=e.l,oe=e.read_shift(2);if(oe===0&&ie===10)break;var de=e.l===e.length?0:e.read_shift(2),ge=kp[oe];if(ge&&ge.f){if(t.bookSheets&&ie===133&&oe!==133)break;if(ie=oe,ge.r===2||ge.r==12){var Oe=e.read_shift(2);if(de-=2,!ce.enc&&Oe!==oe&&((Oe&255)<<8|Oe>>8)!==oe)throw new Error("rt mismatch: "+Oe+"!="+oe);ge.r==12&&(e.l+=10,de-=10)}var q={};if(oe===10?q=ge.f(e,de,ce):q=tR(oe,ge,e,de,ce),Y==0&&[9,521,1033,2057].indexOf(ie)===-1)continue;switch(oe){case 34:r.opts.Date1904=I.WBProps.date1904=q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(ce.enc||(e.l=0),ce.enc=q,!t.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:ce.lastuser=q;break;case 66:var Ze=Number(q);switch(Ze){case 21010:Ze=1200;break;case 32768:Ze=1e4;break;case 32769:Ze=1252;break}La(ce.codepage=Ze),W=!0;break;case 317:ce.rrtabid=q;break;case 25:ce.winlocked=q;break;case 439:r.opts.RefreshAll=q;break;case 12:r.opts.CalcCount=q;break;case 16:r.opts.CalcDelta=q;break;case 17:r.opts.CalcIter=q;break;case 13:r.opts.CalcMode=q;break;case 14:r.opts.CalcPrecision=q;break;case 95:r.opts.CalcSaveRecalc=q;break;case 15:ce.CalcRefMode=q;break;case 2211:r.opts.FullCalc=q;break;case 129:q.fDialog&&(a["!type"]="dialog"),q.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),q.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:J.push(q);break;case 430:M.push([q]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(q);break;case 24:case 536:te={Name:q.Name,Ref:Sn(q.rgce,l,null,M,ce)},q.itab>0&&(te.Sheet=q.itab-1),M.names.push(te),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(U[q.itab-1]={ref:Ct(q.rgce[0][0][1][2])});break;case 22:ce.ExternCount=q;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(q),M.XTI=M.XTI.concat(q);break;case 2196:if(ce.biff<8)break;te!=null&&(te.Comment=q[1]);break;case 18:a["!protect"]=q;break;case 19:q!==0&&ce.WTF&&console.error("Password verifier: "+q);break;case 133:s[q.pos]=q,ce.snames.push(q.name);break;case 10:{if(--Y)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Ct(l),t.sheetRows&&t.sheetRows<=l.e.r){var Je=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ct(l),l.e.r=Je}l.e.r++,l.e.c++}je.length>0&&(a["!merges"]=je),fe.length>0&&(a["!objects"]=fe),ue.length>0&&(a["!cols"]=ue),O.length>0&&(a["!rows"]=O),I.Sheets.push(ee)}p===""?g=a:n[p]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(ce.biff===8&&(ce.biff={9:2,521:3,1033:4}[oe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),ce.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(ce.biff=5,W=!0,La(ce.codepage=28591)),ce.biff==8&&q.BIFFVer==0&&q.dt==16&&(ce.biff=2),Y++)break;if(a=t.dense?[]:{},ce.biff<8&&!W&&(W=!0,La(ce.codepage=t.codepage||1252)),ce.biff<5||q.BIFFVer==0&&q.dt==4096){p===""&&(p="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var Ye={pos:e.l-de,name:p};s[Ye.pos]=Ye,ce.snames.push(p)}else p=(s[ae]||{name:""}).name;q.dt==32&&(a["!type"]="chart"),q.dt==64&&(a["!type"]="macro"),je=[],fe=[],ce.arrayf=D=[],ue=[],O=[],F=!1,ee={Hidden:(s[ae]||{hs:0}).hs,name:p}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[q.r]||[])[q.c]:a[yt({c:q.c,r:q.r})])&&++q.c,A={ixfe:q.ixfe,XF:J[q.ixfe]||{},v:q.val,t:"n"},R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he({c:q.c,r:q.r},A,t);break;case 5:case 517:A={ixfe:q.ixfe,XF:J[q.ixfe],v:q.val,t:q.t},R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he({c:q.c,r:q.r},A,t);break;case 638:A={ixfe:q.ixfe,XF:J[q.ixfe],v:q.rknum,t:"n"},R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he({c:q.c,r:q.r},A,t);break;case 189:for(var nt=q.c;nt<=q.C;++nt){var Be=q.rkrec[nt-q.c][0];A={ixfe:Be,XF:J[Be],v:q.rkrec[nt-q.c][1],t:"n"},R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he({c:nt,r:q.r},A,t)}break;case 6:case 518:case 1030:{if(q.val=="String"){d=q;break}if(A=rh(q.val,q.cell.ixfe,q.tt),A.XF=J[A.ixfe],t.cellFormula){var bt=q.formula;if(bt&&bt[0]&&bt[0][0]&&bt[0][0][0]=="PtgExp"){var dt=bt[0][0][1][0],ht=bt[0][0][1][1],Kt=yt({r:dt,c:ht});P[Kt]?A.f=""+Sn(q.formula,l,q.cell,M,ce):A.F=((t.dense?(a[dt]||[])[ht]:a[Kt])||{}).F}else A.f=""+Sn(q.formula,l,q.cell,M,ce)}R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he(q.cell,A,t),d=q}break;case 7:case 519:if(d)d.val=q,A=rh(q,d.cell.ixfe,"s"),A.XF=J[A.ixfe],t.cellFormula&&(A.f=""+Sn(d.formula,l,d.cell,M,ce)),R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he(d.cell,A,t),d=null;else throw new Error("String record expects Formula");break;case 33:case 545:{D.push(q);var In=yt(q[0].s);if(T=t.dense?(a[q[0].s.r]||[])[q[0].s.c]:a[In],t.cellFormula&&T){if(!d||!In||!T)break;T.f=""+Sn(q[1],l,q[0],M,ce),T.F=Ct(q[0])}}break;case 1212:{if(!t.cellFormula)break;if(_){if(!d)break;P[yt(d.cell)]=q[0],T=t.dense?(a[d.cell.r]||[])[d.cell.c]:a[yt(d.cell)],(T||{}).f=""+Sn(q[0],l,y,M,ce)}}break;case 253:A=rh(m[q.isst].t,q.ixfe,"s"),m[q.isst].h&&(A.h=m[q.isst].h),A.XF=J[A.ixfe],R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he({c:q.c,r:q.r},A,t);break;case 513:t.sheetStubs&&(A={ixfe:q.ixfe,XF:J[q.ixfe],t:"z"},R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he({c:q.c,r:q.r},A,t));break;case 190:if(t.sheetStubs)for(var zr=q.c;zr<=q.C;++zr){var Er=q.ixfe[zr-q.c];A={ixfe:Er,XF:J[Er],t:"z"},R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he({c:zr,r:q.r},A,t)}break;case 214:case 516:case 4:A=rh(q.val,q.ixfe,"s"),A.XF=J[A.ixfe],R>0&&(A.z=z[A.ixfe>>8&63]),Ti(A,t,r.opts.Date1904),he({c:q.c,r:q.r},A,t);break;case 0:case 512:Y===1&&(l=q);break;case 252:m=q;break;case 1054:if(ce.biff==4){z[R++]=q[1];for(var fn=0;fn<R+163&&xt[fn]!=q[1];++fn);fn>=163&&Ii(q[1],R+163)}else Ii(q[1],q[0]);break;case 30:{z[R++]=q;for(var Fr=0;Fr<R+163&&xt[Fr]!=q;++Fr);Fr>=163&&Ii(q,R+163)}break;case 229:je=je.concat(q);break;case 93:fe[q.cmo[0]]=ce.lastobj=q;break;case 438:ce.lastobj.TxO=q;break;case 127:ce.lastobj.ImData=q;break;case 440:for(E=q[0].s.r;E<=q[0].e.r;++E)for(w=q[0].s.c;w<=q[0].e.c;++w)T=t.dense?(a[E]||[])[w]:a[yt({c:w,r:E})],T&&(T.l=q[1]);break;case 2048:for(E=q[0].s.r;E<=q[0].e.r;++E)for(w=q[0].s.c;w<=q[0].e.c;++w)T=t.dense?(a[E]||[])[w]:a[yt({c:w,r:E})],T&&T.l&&(T.l.Tooltip=q[1]);break;case 28:{if(ce.biff<=5&&ce.biff>=2)break;T=t.dense?(a[q[0].r]||[])[q[0].c]:a[yt(q[0])];var sn=fe[q[2]];T||(t.dense?(a[q[0].r]||(a[q[0].r]=[]),T=a[q[0].r][q[0].c]={t:"z"}):T=a[yt(q[0])]={t:"z"},l.e.r=Math.max(l.e.r,q[0].r),l.s.r=Math.min(l.s.r,q[0].r),l.e.c=Math.max(l.e.c,q[0].c),l.s.c=Math.min(l.s.c,q[0].c)),T.c||(T.c=[]),S={a:q[1],t:sn.TxO.t},T.c.push(S)}break;case 2173:H3(J[q.ixfe],q.ext);break;case 125:{if(!ce.cellStyles)break;for(;q.e>=q.s;)ue[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},F||(F=!0,fg(q.w/256)),lo(ue[q.e+1])}break;case 520:{var Qt={};q.level!=null&&(O[q.r]=Qt,Qt.level=q.level),q.hidden&&(O[q.r]=Qt,Qt.hidden=!0),q.hpt&&(O[q.r]=Qt,Qt.hpt=q.hpt,Qt.hpx=Dc(q.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||el(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[oe]]=q;break;case 161:a["!margins"]||el(a["!margins"]={}),a["!margins"].header=q.header,a["!margins"].footer=q.footer;break;case 574:q.RTL&&(I.Views[0].RTL=!0);break;case 146:B=q;break;case 2198:Ee=q;break;case 140:H=q;break;case 442:p?ee.CodeName=q||ee.name:I.WBProps.CodeName=q||"ThisWorkbook";break}}else ge||console.error("Missing Info for XLS Record 0x"+oe.toString(16)),e.l+=de}return r.SheetNames=Tr(s).sort(function(Cr,pt){return Number(Cr)-Number(pt)}).map(function(Cr){return s[Cr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&U.forEach(function(Cr,pt){r.Sheets[r.SheetNames[pt]]["!autofilter"]=Cr}),r.Strings=m,r.SSF=ir(xt),ce.enc&&(r.Encryption=ce.enc),Ee&&(r.Themes=Ee),r.Metadata={},H!==void 0&&(r.Metadata.Country=H),M.names.length>0&&(I.Names=M.names),r.Workbook=I,r}var Yu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function nR(e,t,r){var n=ut.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=G1(n,gp,Yu.DSI);for(var s in a)t[s]=a[s]}catch(p){if(r.WTF)throw p}var l=ut.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var d=G1(l,vp,Yu.SI);for(var m in d)t[m]==null&&(t[m]=d[m])}catch(p){if(r.WTF)throw p}t.HeadingPairs&&t.TitlesOfParts&&(ww(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function aR(e,t){var r=[],n=[],a=[],s=0,l,d=b1(gp,"n"),m=b1(vp,"n");if(e.Props)for(l=Tr(e.Props),s=0;s<l.length;++s)(Object.prototype.hasOwnProperty.call(d,l[s])?r:Object.prototype.hasOwnProperty.call(m,l[s])?n:a).push([l[s],e.Props[l[s]]]);if(e.Custprops)for(l=Tr(e.Custprops),s=0;s<l.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},l[s])||(Object.prototype.hasOwnProperty.call(d,l[s])?r:Object.prototype.hasOwnProperty.call(m,l[s])?n:a).push([l[s],e.Custprops[l[s]]]);var p=[];for(s=0;s<a.length;++s)Aw.indexOf(a[s][0])>-1||_w.indexOf(a[s][0])>-1||a[s][1]!=null&&p.push(a[s]);n.length&&ut.utils.cfb_add(t,"/SummaryInformation",K1(n,Yu.SI,m,vp)),(r.length||p.length)&&ut.utils.cfb_add(t,"/DocumentSummaryInformation",K1(r,Yu.DSI,d,gp,p.length?p:null,Yu.UDI))}function _g(e,t){t||(t={}),bg(t),Mh(),t.codepage&&Lh(t.codepage);var r,n;if(e.FullPaths){if(ut.find(e,"/encryption"))throw new Error("File is password-protected");r=ut.find(e,"!CompObj"),n=ut.find(e,"/Workbook")||ut.find(e,"/Book")}else{switch(t.type){case"base64":e=fa(pa(e));break;case"binary":e=fa(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}un(e,0),n={content:e}}var a,s;if(r&&QO(r),t.bookProps&&!t.bookSheets)a={};else{var l=Pt?"buffer":"array";if(n&&n.content)a=rR(n.content,t);else if((s=ut.find(e,"PerfectOffice_MAIN"))&&s.content)a=Qo.to_workbook(s.content,(t.type=l,t));else if((s=ut.find(e,"NativeContent_MAIN"))&&s.content)a=Qo.to_workbook(s.content,(t.type=l,t));else throw(s=ut.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ut.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=xI(e))}var d={};return e.FullPaths&&nR(e,d,t),a.Props=a.Custprops=d,t.bookFiles&&(a.cfb=e),a}function iR(e,t){var r=t||{},n=ut.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ut.utils.cfb_add(n,a,Sb(e,r)),r.biff==8&&(e.Props||e.Custprops)&&aR(e,n),r.biff==8&&e.vbaraw&&yI(n,ut.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var hd={0:{f:PF},1:{f:MF},2:{f:nj},3:{f:GF},4:{f:$F},5:{f:ej},6:{f:lj},7:{f:qF},8:{f:pj},9:{f:mj},10:{f:fj},11:{f:hj},12:{f:zF},13:{f:ij},14:{f:ZF},15:{f:HF},16:{f:pb},17:{f:uj},18:{f:JF},19:{f:rg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:cO},40:{},42:{},43:{f:l3},44:{f:s3},45:{f:d3},46:{f:h3},47:{f:f3},48:{},49:{f:FN},50:{},51:{f:K3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Bw},62:{f:oj},63:{f:rI},64:{f:Ij},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Nn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Cj},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:RF},148:{f:FF,p:16},151:{f:wj},152:{},153:{f:sO},154:{},155:{},156:{f:aO},157:{},158:{},159:{T:1,f:k5},160:{T:-1},161:{T:1,f:gl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gj},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:V3},336:{T:-1},337:{f:q3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Mw},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bj},427:{f:kj},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Tj},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:OF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:yj},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:hI},633:{T:1},634:{T:-1},635:{T:1,f:dI},636:{T:-1},637:{f:LN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Zj},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Dj},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},kp={6:{f:$m},10:{f:Js},12:{f:Mr},13:{f:Mr},14:{f:Ir},15:{f:Ir},16:{f:En},17:{f:Ir},18:{f:Ir},19:{f:Mr},20:{f:Q1},21:{f:Q1},23:{f:Mw},24:{f:ty},25:{f:Ir},26:{},27:{},28:{f:DP},29:{},34:{f:Ir},35:{f:ey},38:{f:En},39:{f:En},40:{f:En},41:{f:En},42:{f:Ir},43:{f:Ir},47:{f:H5},49:{f:iP},51:{f:Mr},60:{},61:{f:eP},64:{f:Ir},65:{f:aP},66:{f:Mr},77:{},80:{},81:{},82:{},85:{f:Mr},89:{},90:{},91:{},92:{f:W4},93:{f:OP},94:{},95:{f:Ir},96:{},97:{},99:{f:Ir},125:{f:Bw},128:{f:_P},129:{f:V4},130:{f:Mr},131:{f:Ir},132:{f:Ir},133:{f:G4},134:{},140:{f:WP},141:{f:Mr},144:{},146:{f:GP},151:{},152:{},153:{},154:{},155:{},156:{f:Mr},157:{},158:{},160:{f:QP},161:{f:YP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:gP},190:{f:vP},193:{f:Js},197:{},198:{},199:{},200:{},201:{},202:{f:Ir},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mr},220:{},221:{f:Ir},222:{},224:{f:yP},225:{f:$4},226:{f:Js},227:{},229:{f:FP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Z4},253:{f:oP},255:{f:q4},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Nw},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ir},353:{f:Js},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:TP},431:{f:Ir},432:{},433:{},434:{},437:{},438:{f:MP},439:{f:Ir},440:{f:BP},441:{},442:{f:kd},443:{},444:{f:Mr},445:{},446:{},448:{f:Js},449:{f:Q4,r:2},450:{f:Js},512:{f:q1},513:{f:JP},515:{f:kP},516:{f:cP},517:{f:J1},519:{f:e5},520:{f:X4},523:{},545:{f:ry},549:{f:Y1},566:{},574:{f:rP},638:{f:pP},659:{},1048:{},1054:{f:dP},1084:{},1212:{f:NP},2048:{f:UP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Qf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Js},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:KP,r:12},2173:{f:W3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ir,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:AP,r:12},2197:{},2198:{f:L3,r:12},2199:{},2200:{},2201:{},2202:{f:PP,r:12},2203:{f:Js},2204:{},2205:{},2206:{},2207:{},2211:{f:J4},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:qP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:VP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:q1},1:{},2:{f:i5},3:{f:n5},4:{f:r5},5:{f:J1},7:{f:o5},8:{},9:{f:Qf},11:{},22:{f:Mr},30:{f:hP},31:{},32:{},33:{f:ry},36:{},37:{f:Y1},50:{f:l5},62:{},52:{},67:{},68:{f:Mr},69:{},86:{},126:{},127:{f:t5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:c5},223:{},234:{},354:{},421:{},518:{f:$m},521:{f:Qf},536:{f:ty},547:{f:ey},561:{},579:{},1030:{f:$m},1033:{f:Qf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Qe(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,s),s>0&&Qp(r)&&e.push(r)}}function sR(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Qe(e,t,r,a);var s=t;if(!isNaN(s)){for(var l=r.parts||[],d=0,m=0,p=0;p+(l[d]||8224)<=8224;)p+=l[d]||8224,d++;var g=e.next(4);for(g.write_shift(2,s),g.write_shift(2,p),e.push(r.slice(m,m+p)),m+=p;m<a;){for(g=e.next(4),g.write_shift(2,60),p=0;p+(l[d]||8224)<=8224;)p+=l[d]||8224,d++;g.write_shift(2,p),e.push(r.slice(m,m+p)),m+=p}}}function Cd(e,t,r){return e||(e=Fe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function oR(e,t,r,n){var a=Fe(9);return Cd(a,e,t),Pw(r,n||"b",a),a}function lR(e,t,r){var n=Fe(8+2*r.length);return Cd(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function cR(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Zr(mr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Qe(e,2,s5(r,n,a)):Qe(e,3,a5(r,n,a));return;case"b":case"e":Qe(e,5,oR(r,n,t.v,t.t));return;case"s":case"str":Qe(e,4,lR(r,n,(t.v||"").slice(0,255)));return}Qe(e,1,Cd(null,r,n))}function uR(e,t,r,n){var a=Array.isArray(t),s=Ot(t["!ref"]||"A1"),l,d="",m=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),l=Ct(s)}for(var p=s.s.r;p<=s.e.r;++p){d=kr(p);for(var g=s.s.c;g<=s.e.c;++g){p===s.s.r&&(m[g]=hr(g)),l=m[g]+d;var y=a?(t[p]||[])[g]:t[l];y&&cR(e,y,p,g)}}}function dR(e,t){for(var r=t||{},n=Qn(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Qe(n,r.biff==4?1033:r.biff==3?521:9,cg(e,16,r)),uR(n,e.Sheets[e.SheetNames[a]],a,r),Qe(n,10),n.end()}function fR(e,t,r){Qe(e,49,sP({sz:12,name:"Arial"},r))}function hR(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Qe(e,1054,fP(a,t[a],r))})}function mR(e,t){var r=Fe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Qe(e,2151,r),r=Fe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Ow(Ot(t["!ref"]||"A1"),r),r.write_shift(4,4),Qe(e,2152,r)}function pR(e,t){for(var r=0;r<16;++r)Qe(e,224,X1({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Qe(e,224,X1(n,0,t))})}function gR(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Qe(e,440,zP(n)),n[1].Tooltip&&Qe(e,2048,$P(n))}delete t["!links"]}function vR(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Qe(e,125,ZP(Gh(a,n),a))})}}function xR(e,t,r,n,a){var s=16+po(a.cellXfs,t,a);if(t.v==null&&!t.bf){Qe(e,513,ol(r,n,s));return}if(t.bf)Qe(e,6,VD(t,r,n,a,s));else switch(t.t){case"d":case"n":var l=t.t=="d"?Zr(mr(t.v)):t.v;Qe(e,515,SP(r,n,l,s));break;case"b":case"e":Qe(e,517,bP(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var d=vg(a.Strings,t.v,a.revStrings);Qe(e,253,lP(r,n,d,s))}else Qe(e,516,uP(r,n,(t.v||"").slice(0,255),s,a));break;default:Qe(e,513,ol(r,n,s))}}function yR(e,t,r){var n=Qn(),a=r.SheetNames[e],s=r.Sheets[a]||{},l=(r||{}).Workbook||{},d=(l.Sheets||[])[e]||{},m=Array.isArray(s),p=t.biff==8,g,y="",_=[],T=Ot(s["!ref"]||"A1"),S=p?65536:16384;if(T.e.c>255||T.e.r>=S){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,S-1)}Qe(n,2057,cg(r,16,t)),Qe(n,13,Oa(1)),Qe(n,12,Oa(100)),Qe(n,15,zn(!0)),Qe(n,17,zn(!1)),Qe(n,16,il(.001)),Qe(n,95,zn(!0)),Qe(n,42,zn(!1)),Qe(n,43,zn(!1)),Qe(n,130,Oa(1)),Qe(n,128,wP()),Qe(n,131,zn(!1)),Qe(n,132,zn(!1)),p&&vR(n,s["!cols"]),Qe(n,512,mP(T,t)),p&&(s["!links"]=[]);for(var w=T.s.r;w<=T.e.r;++w){y=kr(w);for(var E=T.s.c;E<=T.e.c;++E){w===T.s.r&&(_[E]=hr(E)),g=_[E]+y;var P=m?(s[w]||[])[E]:s[g];P&&(xR(n,P,w,E,t),p&&P.l&&s["!links"].push([g,P.l]))}}var D=d.CodeName||d.name||a;return p&&Qe(n,574,nP((l.Views||[])[0])),p&&(s["!merges"]||[]).length&&Qe(n,229,jP(s["!merges"])),p&&gR(n,s),Qe(n,442,Iw(D)),p&&mR(n,s),Qe(n,10),n.end()}function _R(e,t,r){var n=Qn(),a=(e||{}).Workbook||{},s=a.Sheets||[],l=a.WBProps||{},d=r.biff==8,m=r.biff==5;if(Qe(n,2057,cg(e,5,r)),r.bookType=="xla"&&Qe(n,135),Qe(n,225,d?Oa(1200):null),Qe(n,193,b4(2)),m&&Qe(n,191),m&&Qe(n,192),Qe(n,226),Qe(n,92,H4("SheetJS",r)),Qe(n,66,Oa(d?1200:1252)),d&&Qe(n,353,Oa(0)),d&&Qe(n,448),Qe(n,317,XP(e.SheetNames.length)),d&&e.vbaraw&&Qe(n,211),d&&e.vbaraw){var p=l.CodeName||"ThisWorkbook";Qe(n,442,Iw(p))}Qe(n,156,Oa(17)),Qe(n,25,zn(!1)),Qe(n,18,zn(!1)),Qe(n,19,Oa(0)),d&&Qe(n,431,zn(!1)),d&&Qe(n,444,Oa(0)),Qe(n,61,tP()),Qe(n,64,zn(!1)),Qe(n,141,Oa(0)),Qe(n,34,zn(Qj(e)=="true")),Qe(n,14,zn(!0)),d&&Qe(n,439,zn(!1)),Qe(n,218,Oa(0)),fR(n,e,r),hR(n,e.SSF,r),pR(n,r),d&&Qe(n,352,zn(!1));var g=n.end(),y=Qn();d&&Qe(y,140,HP()),d&&r.Strings&&sR(y,252,Y4(r.Strings)),Qe(y,10);var _=y.end(),T=Qn(),S=0,w=0;for(w=0;w<e.SheetNames.length;++w)S+=(d?12:11)+(d?2:1)*e.SheetNames[w].length;var E=g.length+S+_.length;for(w=0;w<e.SheetNames.length;++w){var P=s[w]||{};Qe(T,133,K4({pos:E,hs:P.Hidden||0,dt:0,name:e.SheetNames[w]},r)),E+=t[w].length}var D=T.end();if(S!=D.length)throw new Error("BS8 "+S+" != "+D.length);var A=[];return g.length&&A.push(g),D.length&&A.push(D),_.length&&A.push(_),nn(A)}function wR(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ir(xt)),e&&e.SSF&&(Oc(),_d(e.SSF),r.revssf=zh(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kg(r),r.cellXfs=[],po(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=yR(a,r,e);return n.unshift(_R(e,n,r)),nn(n)}function Sb(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=$n(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return wR(e,t);case 4:case 3:case 2:return dR(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function fy(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),l=a.index,d=s&&s.index||e.length,m=sN(e.slice(l,d),/(:?<tr[^>]*>)/i,"<tr>"),p=-1,g=0,y=0,_=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(l=0;l<m.length;++l){var w=m[l].trim(),E=w.slice(0,3).toLowerCase();if(E=="<tr"){if(++p,r.sheetRows&&r.sheetRows<=p){--p;break}g=0;continue}if(!(E!="<td"&&E!="<th")){var P=w.split(/<\/t[dh]>/i);for(d=0;d<P.length;++d){var D=P[d].trim();if(D.match(/<t[dh]/i)){for(var A=D,H=0;A.charAt(0)=="<"&&(H=A.indexOf(">"))>-1;)A=A.slice(H+1);for(var J=0;J<S.length;++J){var B=S[J];B.s.c==g&&B.s.r<p&&p<=B.e.r&&(g=B.e.c+1,J=-1)}var I=wt(D.slice(0,D.indexOf(">")));_=I.colspan?+I.colspan:1,((y=+I.rowspan)>1||_>1)&&S.push({s:{r:p,c:g},e:{r:p+(y||1)-1,c:g+_-1}});var ee=I.t||I["data-t"]||"";if(!A.length){g+=_;continue}if(A=J_(A),T.s.r>p&&(T.s.r=p),T.e.r<p&&(T.e.r=p),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!A.length){g+=_;continue}var re={t:"s",v:A};r.raw||!A.trim().length||ee=="s"||(A==="TRUE"?re={t:"b",v:!0}:A==="FALSE"?re={t:"b",v:!1}:isNaN(ii(A))?isNaN(Pc(A).getDate())||(re={t:"d",v:mr(A)},r.cellDates||(re={t:"n",v:Zr(re.v)}),re.z=r.dateNF||xt[14]):re={t:"n",v:ii(A)}),r.dense?(n[p]||(n[p]=[]),n[p][g]=re):n[yt({r:p,c:g})]=re,g+=_}}}}return n["!ref"]=Ct(T),S.length&&(n["!merges"]=S),n}function Tb(e,t,r,n){for(var a=e["!merges"]||[],s=[],l=t.s.c;l<=t.e.c;++l){for(var d=0,m=0,p=0;p<a.length;++p)if(!(a[p].s.r>r||a[p].s.c>l)&&!(a[p].e.r<r||a[p].e.c<l)){if(a[p].s.r<r||a[p].s.c<l){d=-1;break}d=a[p].e.r-a[p].s.r+1,m=a[p].e.c-a[p].s.c+1;break}if(!(d<0)){var g=yt({r,c:l}),y=n.dense?(e[r]||[])[l]:e[g],_=y&&y.v!=null&&(y.h||Gp(y.w||(Fi(y),y.w)||""))||"",T={};d>1&&(T.rowspan=d),m>1&&(T.colspan=m),n.editable?_='<span contenteditable="true">'+_+"</span>":y&&(T["data-t"]=y&&y.t||"z",y.v!=null&&(T["data-v"]=y.v),y.z!=null&&(T["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),T.id=(n.id||"sjs")+"-"+g,s.push(Xe("td",_,T))}}var S="<tr>";return S+s.join("")+"</tr>"}var Eb='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Cb="</body></html>";function bR(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return mo(fy(r[0],t),t);var n=Ag();return r.forEach(function(a,s){Ng(n,fy(a,t),"Sheet"+(s+1))}),n}function Ab(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Nb(e,t){var r=t||{},n=r.header!=null?r.header:Eb,a=r.footer!=null?r.footer:Cb,s=[n],l=$n(e["!ref"]);r.dense=Array.isArray(e),s.push(Ab(e,l,r));for(var d=l.s.r;d<=l.e.r;++d)s.push(Tb(e,l,d,r));return s.push("</table>"+a),s.join("")}function Pb(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?yr(n.origin):n.origin;a=l.r,s=l.c}var d=t.getElementsByTagName("tr"),m=Math.min(n.sheetRows||1e7,d.length),p={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var g=$n(e["!ref"]);p.s.r=Math.min(p.s.r,g.s.r),p.s.c=Math.min(p.s.c,g.s.c),p.e.r=Math.max(p.e.r,g.e.r),p.e.c=Math.max(p.e.c,g.e.c),a==-1&&(p.e.r=a=g.e.r+1)}var y=[],_=0,T=e["!rows"]||(e["!rows"]=[]),S=0,w=0,E=0,P=0,D=0,A=0;for(e["!cols"]||(e["!cols"]=[]);S<d.length&&w<m;++S){var H=d[S];if(hy(H)){if(n.display)continue;T[w]={hidden:!0}}var J=H.children;for(E=P=0;E<J.length;++E){var B=J[E];if(!(n.display&&hy(B))){var I=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):J_(B.innerHTML),ee=B.getAttribute("data-z")||B.getAttribute("z");for(_=0;_<y.length;++_){var re=y[_];re.s.c==P+s&&re.s.r<w+a&&w+a<=re.e.r&&(P=re.e.c+1-s,_=-1)}A=+B.getAttribute("colspan")||1,((D=+B.getAttribute("rowspan")||1)>1||A>1)&&y.push({s:{r:w+a,c:P+s},e:{r:w+a+(D||1)-1,c:P+s+(A||1)-1}});var ye={t:"s",v:I},he=B.getAttribute("data-t")||B.getAttribute("t")||"";I!=null&&(I.length==0?ye.t=he||"z":n.raw||I.trim().length==0||he=="s"||(I==="TRUE"?ye={t:"b",v:!0}:I==="FALSE"?ye={t:"b",v:!1}:isNaN(ii(I))?isNaN(Pc(I).getDate())||(ye={t:"d",v:mr(I)},n.cellDates||(ye={t:"n",v:Zr(ye.v)}),ye.z=n.dateNF||xt[14]):ye={t:"n",v:ii(I)})),ye.z===void 0&&ee!=null&&(ye.z=ee);var ce="",Ee=B.getElementsByTagName("A");if(Ee&&Ee.length)for(var je=0;je<Ee.length&&!(Ee[je].hasAttribute("href")&&(ce=Ee[je].getAttribute("href"),ce.charAt(0)!="#"));++je);ce&&ce.charAt(0)!="#"&&(ye.l={Target:ce}),n.dense?(e[w+a]||(e[w+a]=[]),e[w+a][P+s]=ye):e[yt({c:P+s,r:w+a})]=ye,p.e.c<P+s&&(p.e.c=P+s),P+=A}}++w}return y.length&&(e["!merges"]=(e["!merges"]||[]).concat(y)),p.e.r=Math.max(p.e.r,w-1+a),e["!ref"]=Ct(p),w>=m&&(e["!fullref"]=Ct((p.e.r=d.length-S+w-1+a,p))),e}function Ib(e,t){var r=t||{},n=r.dense?[]:{};return Pb(n,e,t)}function kR(e,t){return mo(Ib(e,t),t)}function hy(e){var t="",r=SR(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function SR(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function TR(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ut(t.replace(/<[^>]*>/g,""));return[r]}var my={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Db(e,t){var r=t||{},n=Kp(e),a=[],s,l,d={name:""},m="",p=0,g,y,_={},T=[],S=r.dense?[]:{},w,E,P={value:""},D="",A=0,H=[],J=-1,B=-1,I={s:{r:1e6,c:1e7},e:{r:0,c:0}},ee=0,re={},ye=[],he={},ce=0,Ee=0,je=[],fe=1,ue=1,O=[],F={Names:[]},M={},ie=["",""],Y=[],R={},z="",U=0,te=!1,W=!1,ae=0;for(od.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=od.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"工作表":w[1]==="/"?(I.e.c>=I.s.c&&I.e.r>=I.s.r?S["!ref"]=Ct(I):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=I.e.r&&(S["!fullref"]=S["!ref"],I.e.r=r.sheetRows-1,S["!ref"]=Ct(I)),ye.length&&(S["!merges"]=ye),je.length&&(S["!rows"]=je),g.name=g.名称||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),_[g.name]=S,W=!1):w[0].charAt(w[0].length-2)!=="/"&&(g=wt(w[0],!1),J=B=-1,I.s.r=I.s.c=1e7,I.e.r=I.e.c=0,S=r.dense?[]:{},ye=[],je=[],W=!0);break;case"table-row-group":w[1]==="/"?--ee:++ee;break;case"table-row":case"行":if(w[1]==="/"){J+=fe,fe=1;break}if(y=wt(w[0],!1),y.行号?J=y.行号-1:J==-1&&(J=0),fe=+y["number-rows-repeated"]||1,fe<10)for(ae=0;ae<fe;++ae)ee>0&&(je[J+ae]={level:ee});B=-1;break;case"covered-table-cell":w[1]!=="/"&&++B,r.sheetStubs&&(r.dense?(S[J]||(S[J]=[]),S[J][B]={t:"z"}):S[yt({r:J,c:B})]={t:"z"}),D="",H=[];break;case"table-cell":case"数据":if(w[0].charAt(w[0].length-2)==="/")++B,P=wt(w[0],!1),ue=parseInt(P["number-columns-repeated"]||"1",10),E={t:"z",v:null},P.formula&&r.cellFormula!=!1&&(E.f=cy(Ut(P.formula))),(P.数据类型||P["value-type"])=="string"&&(E.t="s",E.v=Ut(P["string-value"]||""),r.dense?(S[J]||(S[J]=[]),S[J][B]=E):S[yt({r:J,c:B})]=E),B+=ue-1;else if(w[1]!=="/"){++B,D="",A=0,H=[],ue=1;var oe=fe?J+fe-1:J;if(B>I.e.c&&(I.e.c=B),B<I.s.c&&(I.s.c=B),J<I.s.r&&(I.s.r=J),oe>I.e.r&&(I.e.r=oe),P=wt(w[0],!1),Y=[],R={},E={t:P.数据类型||P["value-type"],v:null},r.cellFormula)if(P.formula&&(P.formula=Ut(P.formula)),P["number-matrix-columns-spanned"]&&P["number-matrix-rows-spanned"]&&(ce=parseInt(P["number-matrix-rows-spanned"],10)||0,Ee=parseInt(P["number-matrix-columns-spanned"],10)||0,he={s:{r:J,c:B},e:{r:J+ce-1,c:B+Ee-1}},E.F=Ct(he),O.push([he,E.F])),P.formula)E.f=cy(P.formula);else for(ae=0;ae<O.length;++ae)J>=O[ae][0].s.r&&J<=O[ae][0].e.r&&B>=O[ae][0].s.c&&B<=O[ae][0].e.c&&(E.F=O[ae][1]);switch((P["number-columns-spanned"]||P["number-rows-spanned"])&&(ce=parseInt(P["number-rows-spanned"],10)||0,Ee=parseInt(P["number-columns-spanned"],10)||0,he={s:{r:J,c:B},e:{r:J+ce-1,c:B+Ee-1}},ye.push(he)),P["number-columns-repeated"]&&(ue=parseInt(P["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=fr(P["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(P.value);break;case"percentage":E.t="n",E.v=parseFloat(P.value);break;case"currency":E.t="n",E.v=parseFloat(P.value);break;case"date":E.t="d",E.v=mr(P["date-value"]),r.cellDates||(E.t="n",E.v=Zr(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=nN(P["time-value"])/86400,r.cellDates&&(E.t="d",E.v=Uh(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(P.数据数值);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",P["string-value"]!=null&&(D=Ut(P["string-value"]),H=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(te=!1,E.t==="s"&&(E.v=D||"",H.length&&(E.R=H),te=A==0),M.Target&&(E.l=M),Y.length>0&&(E.c=Y,Y=[]),D&&r.cellText!==!1&&(E.w=D),te&&(E.t="z",delete E.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=J))for(var de=0;de<fe;++de){if(ue=parseInt(P["number-columns-repeated"]||"1",10),r.dense)for(S[J+de]||(S[J+de]=[]),S[J+de][B]=de==0?E:ir(E);--ue>0;)S[J+de][B+ue]=ir(E);else for(S[yt({r:J+de,c:B})]=E;--ue>0;)S[yt({r:J+de,c:B+ue})]=ir(E);I.e.c<=B&&(I.e.c=B)}ue=parseInt(P["number-columns-repeated"]||"1",10),B+=ue-1,ue=0,E={},D="",H=[]}M={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s;R.t=D,H.length&&(R.R=H),R.a=z,Y.push(R)}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);z="",U=0,D="",A=0,H=[];break;case"creator":w[1]==="/"?z=n.slice(U,w.index):U=w.index+w[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&a.push([w[3],!1]);D="",A=0,H=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(re[d.name]=m,(s=a.pop())[0]!==w[3])throw"Bad state: "+s}else w[0].charAt(w[0].length-2)!=="/"&&(m="",d=wt(w[0],!1),a.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=wt(w[0],!1),m+=my[w[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=wt(w[0],!1),m+=my[w[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":m+=n.slice(p,w.index);break}else p=w.index+w[0].length;break;case"named-range":l=wt(w[0],!1),ie=Wm(l["cell-range-address"]);var ge={Name:l.name,Ref:ie[0]+"!"+ie[1]};W&&(ge.Sheet=T.length),F.Names.push(ge);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(w[1]==="/"&&(!P||!P["string-value"])){var Oe=TR(n.slice(A,w.index));D=(D.length>0?D+`
`:"")+Oe[0]}else wt(w[0],!1),A=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{ie=Wm(wt(w[0])["target-range-address"]),_[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(M=wt(w[0],!1),!M.href)break;M.Target=Ut(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(ie=Wm(M.Target.slice(1)),M.Target="#"+ie[0]+"!"+ie[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(w)}}var q={Sheets:_,SheetNames:T,Workbook:F};return r.bookSheets&&delete q.Sheets,q}function py(e,t){t=t||{},ja(e,"META-INF/manifest.xml")&&n4(Lr(e,"META-INF/manifest.xml"),t);var r=ha(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Db(nr(r),t);return ja(e,"meta.xml")&&(n.Props=xw(Lr(e,"meta.xml"))),n}function gy(e,t){return Db(e,t)}var ER=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+sd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Dr+t}})(),vy=(function(){var e=function(s){return Jt(s).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,l,d){var m=[];m.push('      <table:table table:name="'+Jt(l.SheetNames[d])+`" table:style-name="ta1">
`);var p=0,g=0,y=$n(s["!ref"]||"A1"),_=s["!merges"]||[],T=0,S=Array.isArray(s);if(s["!cols"])for(g=0;g<=y.e.c;++g)m.push("        <table:table-column"+(s["!cols"][g]?' table:style-name="co'+s["!cols"][g].ods+'"':"")+`></table:table-column>
`);var w="",E=s["!rows"]||[];for(p=0;p<y.s.r;++p)w=E[p]?' table:style-name="ro'+E[p].ods+'"':"",m.push("        <table:table-row"+w+`></table:table-row>
`);for(;p<=y.e.r;++p){for(w=E[p]?' table:style-name="ro'+E[p].ods+'"':"",m.push("        <table:table-row"+w+`>
`),g=0;g<y.s.c;++g)m.push(t);for(;g<=y.e.c;++g){var P=!1,D={},A="";for(T=0;T!=_.length;++T)if(!(_[T].s.c>g)&&!(_[T].s.r>p)&&!(_[T].e.c<g)&&!(_[T].e.r<p)){(_[T].s.c!=g||_[T].s.r!=p)&&(P=!0),D["table:number-columns-spanned"]=_[T].e.c-_[T].s.c+1,D["table:number-rows-spanned"]=_[T].e.r-_[T].s.r+1;break}if(P){m.push(r);continue}var H=yt({r:p,c:g}),J=S?(s[p]||[])[g]:s[H];if(J&&J.f&&(D["table:formula"]=Jt(XD(J.f)),J.F&&J.F.slice(0,H.length)==H)){var B=$n(J.F);D["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,D["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!J){m.push(t);continue}switch(J.t){case"b":A=J.v?"TRUE":"FALSE",D["office:value-type"]="boolean",D["office:boolean-value"]=J.v?"true":"false";break;case"n":A=J.w||String(J.v||0),D["office:value-type"]="float",D["office:value"]=J.v||0;break;case"s":case"str":A=J.v==null?"":J.v,D["office:value-type"]="string";break;case"d":A=J.w||mr(J.v).toISOString(),D["office:value-type"]="date",D["office:date-value"]=mr(J.v).toISOString(),D["table:style-name"]="ce1";break;default:m.push(t);continue}var I=e(A);if(J.l&&J.l.Target){var ee=J.l.Target;ee=ee.charAt(0)=="#"?"#"+JD(ee.slice(1)):ee,ee.charAt(0)!="#"&&!ee.match(/^\w+:/)&&(ee="../"+ee),I=Xe("text:a",I,{"xlink:href":ee.replace(/&/g,"&amp;")})}m.push("          "+Xe("table:table-cell",Xe("text:p",I,{}),D)+`
`)}m.push(`        </table:table-row>
`)}return m.push(`      </table:table>
`),m.join("")},a=function(s,l){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var d=0;l.SheetNames.map(function(p){return l.Sheets[p]}).forEach(function(p){if(p&&p["!cols"]){for(var g=0;g<p["!cols"].length;++g)if(p["!cols"][g]){var y=p["!cols"][g];if(y.width==null&&y.wpx==null&&y.wch==null)continue;lo(y),y.ods=d;var _=p["!cols"][g].wpx+"px";s.push('  <style:style style:name="co'+d+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),s.push(`  </style:style>
`),++d}}});var m=0;l.SheetNames.map(function(p){return l.Sheets[p]}).forEach(function(p){if(p&&p["!rows"]){for(var g=0;g<p["!rows"].length;++g)if(p["!rows"][g]){p["!rows"][g].ods=m;var y=p["!rows"][g].hpx+"px";s.push('  <style:style style:name="ro'+m+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),s.push(`  </style:style>
`),++m}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(l,d){var m=[Dr],p=sd({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=sd({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});d.bookType=="fods"?(m.push("<office:document"+p+g+`>
`),m.push(vw().replace(/office:document-meta/g,"office:meta"))):m.push("<office:document-content"+p+`>
`),a(m,l),m.push(`  <office:body>
`),m.push(`    <office:spreadsheet>
`);for(var y=0;y!=l.SheetNames.length;++y)m.push(n(l.Sheets[l.SheetNames[y]],l,y));return m.push(`    </office:spreadsheet>
`),m.push(`  </office:body>
`),d.bookType=="fods"?m.push("</office:document>"):m.push("</office:document-content>"),m.join("")}})();function Fb(e,t){if(t.bookType=="fods")return vy(e,t);var r=Wp(),n="",a=[],s=[];return n="mimetype",Nt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Nt(r,n,vy(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Nt(r,n,ER(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Nt(r,n,Dr+vw()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Nt(r,n,s4(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Nt(r,n,a4(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ll(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Sp(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):nr(ho(e))}function CR(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):fa(Pi(e))}function AR(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function uo(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function xy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function NR(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function PR(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function md(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Yt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Sr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Vt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=md(e,r),s=a&7;a=Math.floor(a/8);var l=0,d;if(a==0)break;switch(s){case 0:{for(var m=r[0];e[r[0]++]>=128;);d=e.slice(m,r[0])}break;case 5:l=4,d=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,d=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=md(e,r),d=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var p={data:d,type:s};t[a]==null?t[a]=[p]:t[a].push(p)}return t}function cn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Yt(n*8+a.type)),a.type==2&&t.push(Yt(a.data.length)),t.push(a.data))})}),uo(t)}function wg(e,t){return e?.map(function(r){return t(r.data)})||[]}function Da(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=md(e,n),s=Vt(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:Sr(s[1][0].data),messages:[]};s[2].forEach(function(d){var m=Vt(d.data),p=Sr(m[3][0].data);l.messages.push({meta:m,data:e.slice(n[0],n[0]+p)}),n[0]+=p}),(t=s[3])!=null&&t[0]&&(l.merge=Sr(s[3][0].data)>>>0>0),r.push(l)}return r}function hc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Yt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Yt(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:Yt(l.data.length)}],n[2].push({data:cn(l.meta),type:2})});var s=cn(n);t.push(Yt(s.length)),t.push(s),a.forEach(function(l){return t.push(l)})}),uo(t)}function IR(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=md(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var d=l-59;l=t[r[0]],d>1&&(l|=t[r[0]+1]<<8),d>2&&(l|=t[r[0]+2]<<16),d>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=d}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var m=0,p=0;if(s==1?(p=(t[r[0]]>>2&7)+4,m=(t[r[0]++]&224)<<3,m|=t[r[0]++]):(p=(t[r[0]++]>>2)+1,s==2?(m=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(m=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[uo(a)],m==0)throw new Error("Invalid offset 0");if(m>a[0].length)throw new Error("Invalid offset beyond length");if(p>=m)for(a.push(a[0].slice(-m)),p-=m;p>=a[a.length-1].length;)a.push(a[a.length-1]),p-=a[a.length-1].length;a.push(a[0].slice(-m,-m+p))}}var g=uo(a);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function Fa(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(IR(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return uo(t)}function mc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Yt(n),l=s.length;t.push(s),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return uo(t)}function DR(e,t,r,n){var a=ll(e),s=a.getUint32(4,!0),l=(n>1?12:8)+xy(s&(n>1?3470:398))*4,d=-1,m=-1,p=NaN,g=new Date(2001,0,1);s&512&&(d=a.getUint32(l,!0),l+=4),l+=xy(s&(n>1?12288:4096))*4,s&16&&(m=a.getUint32(l,!0),l+=4),s&32&&(p=a.getFloat64(l,!0),l+=8),s&64&&(g.setTime(g.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var y;switch(e[2]){case 0:break;case 2:y={t:"n",v:p};break;case 3:y={t:"s",v:t[m]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:p>0};break;case 7:y={t:"n",v:p/86400};break;case 8:y={t:"e",v:0};break;case 9:if(d>-1)y={t:"s",v:r[d]};else if(m>-1)y={t:"s",v:t[m]};else if(!isNaN(p))y={t:"n",v:p};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return y}function FR(e,t,r){var n=ll(e),a=n.getUint32(8,!0),s=12,l=-1,d=-1,m=NaN,p=NaN,g=new Date(2001,0,1);a&1&&(m=NR(e,s),s+=16),a&2&&(p=n.getFloat64(s,!0),s+=8),a&4&&(g.setTime(g.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(d=n.getUint32(s,!0),s+=4),a&16&&(l=n.getUint32(s,!0),s+=4);var y;switch(e[1]){case 0:break;case 2:y={t:"n",v:m};break;case 3:y={t:"s",v:t[d]};break;case 5:y={t:"d",v:g};break;case 6:y={t:"b",v:p>0};break;case 7:y={t:"n",v:p/86400};break;case 8:y={t:"e",v:0};break;case 9:if(l>-1)y={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:y={t:"n",v:m};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return y}function Vm(e,t){var r=new Uint8Array(32),n=ll(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,PR(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Gm(e,t){var r=new Uint8Array(32),n=ll(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function jR(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return DR(e,t,r,e[0]);case 5:return FR(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function kn(e){var t=Vt(e);return md(t[1][0].data)}function yy(e,t){var r=Vt(t.data),n=Sr(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(l){var d=Vt(l.data),m=Sr(d[1][0].data)>>>0;switch(n){case 1:s[m]=Sp(d[3][0].data);break;case 8:{var p=e[kn(d[9][0].data)][0],g=Vt(p.data),y=e[kn(g[1][0].data)][0],_=Sr(y.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var T=Vt(y.data);s[m]=T[3].map(function(S){return Sp(S.data)}).join("")}break}}),s}function OR(e,t){var r,n,a,s,l,d,m,p,g,y,_,T,S,w,E=Vt(e),P=Sr(E[1][0].data)>>>0,D=Sr(E[2][0].data)>>>0,A=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&Sr(E[8][0].data)>0||!1,H,J;if((s=(a=E[7])==null?void 0:a[0])!=null&&s.data&&t!=0)H=(d=(l=E[7])==null?void 0:l[0])==null?void 0:d.data,J=(p=(m=E[6])==null?void 0:m[0])==null?void 0:p.data;else if((y=(g=E[4])==null?void 0:g[0])!=null&&y.data&&t!=1)H=(T=(_=E[4])==null?void 0:_[0])==null?void 0:T.data,J=(w=(S=E[3])==null?void 0:S[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var B=A?4:1,I=ll(H),ee=[],re=0;re<H.length/2;++re){var ye=I.getUint16(re*2,!0);ye<65535&&ee.push([re,ye])}if(ee.length!=D)throw"Expected ".concat(D," cells, found ").concat(ee.length);var he=[];for(re=0;re<ee.length-1;++re)he[ee[re][0]]=J.subarray(ee[re][1]*B,ee[re+1][1]*B);return ee.length>=1&&(he[ee[ee.length-1][0]]=J.subarray(ee[ee.length-1][1]*B)),{R:P,cells:he}}function RR(e,t){var r,n=Vt(t.data),a=(r=n?.[7])!=null&&r[0]?Sr(n[7][0].data)>>>0>0?1:0:-1,s=wg(n[5],function(l){return OR(l,a)});return{nrows:Sr(n[4][0].data)>>>0,data:s.reduce(function(l,d){return l[d.R]||(l[d.R]=[]),d.cells.forEach(function(m,p){if(l[d.R][p])throw new Error("Duplicate cell r=".concat(d.R," c=").concat(p));l[d.R][p]=m}),l},[])}}function LR(e,t,r){var n,a=Vt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Sr(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Sr(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ct(s);var l=Vt(a[4][0].data),d=yy(e,e[kn(l[4][0].data)][0]),m=(n=l[17])!=null&&n[0]?yy(e,e[kn(l[17][0].data)][0]):[],p=Vt(l[3][0].data),g=0;p[1].forEach(function(y){var _=Vt(y.data),T=e[kn(_[2][0].data)][0],S=Sr(T.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var w=RR(e,T);w.data.forEach(function(E,P){E.forEach(function(D,A){var H=yt({r:g+P,c:A}),J=jR(D,d,m);J&&(r[H]=J)})}),g+=w.nrows})}function MR(e,t){var r=Vt(t.data),n={"!ref":"A1"},a=e[kn(r[2][0].data)],s=Sr(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return LR(e,a[0],n),n}function BR(e,t){var r,n=Vt(t.data),a={name:(r=n[1])!=null&&r[0]?Sp(n[1][0].data):"",sheets:[]},s=wg(n[2],kn);return s.forEach(function(l){e[l].forEach(function(d){var m=Sr(d.meta[1][0].data);m==6e3&&a.sheets.push(MR(e,d))})}),a}function zR(e,t){var r=Ag(),n=Vt(t.data),a=wg(n[1],kn);if(a.forEach(function(s){e[s].forEach(function(l){var d=Sr(l.meta[1][0].data);if(d==2){var m=BR(e,l);m.sheets.forEach(function(p,g){Ng(r,p,g==0?m.name:m.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Km(e){var t,r,n,a,s={},l=[];if(e.FullPaths.forEach(function(m){if(m.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(m){if(m.name.match(/\.iwa$/)){var p;try{p=Fa(m.content)}catch(y){return console.log("?? "+m.content.length+" "+(y.message||y))}var g;try{g=Da(p)}catch(y){return console.log("## "+(y.message||y))}g.forEach(function(y){s[y.id]=y.messages,l.push(y.id)})}}),!l.length)throw new Error("File has no messages");var d=((a=(n=(r=(t=s?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Sr(s[1][0].meta[1][0].data)==1&&s[1][0];if(d||l.forEach(function(m){s[m].forEach(function(p){var g=Sr(p.meta[1][0].data)>>>0;if(g==1)if(!d)d=p;else throw new Error("Document has multiple roots")})}),!d)throw new Error("Cannot find Document root");return zR(s,d)}function UR(e,t,r){var n,a,s,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var d=((l=(s=e[8])==null?void 0:s[0])==null?void 0:l.data)&&Sr(e[8][0].data)>0||!1;if(d)throw"Math only works with normal offsets";for(var m=0,p=ll(e[7][0].data),g=0,y=[],_=ll(e[4][0].data),T=0,S=[],w=0;w<t.length;++w){if(t[w]==null){p.setUint16(w*2,65535,!0),_.setUint16(w*2,65535);continue}p.setUint16(w*2,g,!0),_.setUint16(w*2,T,!0);var E,P;switch(typeof t[w]){case"string":E=Vm({t:"s",v:t[w]},r),P=Gm({t:"s",v:t[w]},r);break;case"number":E=Vm({t:"n",v:t[w]},r),P=Gm({t:"n",v:t[w]},r);break;case"boolean":E=Vm({t:"b",v:t[w]},r),P=Gm({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}y.push(E),g+=E.length,S.push(P),T+=P.length,++m}for(e[2][0].data=Yt(m);w<e[7][0].data.length/2;++w)p.setUint16(w*2,65535,!0),_.setUint16(w*2,65535,!0);return e[6][0].data=uo(y),e[3][0].data=uo(S),m}function $R(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=$n(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ct(n)));var s=Ah(r,{range:n,header:1}),l=["~Sh33tJ5~"];s.forEach(function(z){return z.forEach(function(U){typeof U=="string"&&l.push(U)})});var d={},m=[],p=ut.read(t.numbers,{type:"base64"});p.FileIndex.map(function(z,U){return[z,p.FullPaths[U]]}).forEach(function(z){var U=z[0],te=z[1];if(U.type==2&&U.name.match(/\.iwa/)){var W=U.content,ae=Fa(W),oe=Da(ae);oe.forEach(function(de){m.push(de.id),d[de.id]={deps:[],location:te,type:Sr(de.messages[0].meta[1][0].data)}})}}),m.sort(function(z,U){return z-U});var g=m.filter(function(z){return z>1}).map(function(z){return[z,Yt(z)]});p.FileIndex.map(function(z,U){return[z,p.FullPaths[U]]}).forEach(function(z){var U=z[0];if(z[1],!!U.name.match(/\.iwa/)){var te=Da(Fa(U.content));te.forEach(function(W){W.messages.forEach(function(ae){g.forEach(function(oe){W.messages.some(function(de){return Sr(de.meta[1][0].data)!=11006&&AR(de.data,oe[1])})&&d[oe[0]].deps.push(W.id)})})})}});for(var y=ut.find(p,d[1].location),_=Da(Fa(y.content)),T,S=0;S<_.length;++S){var w=_[S];w.id==1&&(T=w)}var E=kn(Vt(T.messages[0].data)[1][0].data);for(y=ut.find(p,d[E].location),_=Da(Fa(y.content)),S=0;S<_.length;++S)w=_[S],w.id==E&&(T=w);for(E=kn(Vt(T.messages[0].data)[2][0].data),y=ut.find(p,d[E].location),_=Da(Fa(y.content)),S=0;S<_.length;++S)w=_[S],w.id==E&&(T=w);for(E=kn(Vt(T.messages[0].data)[2][0].data),y=ut.find(p,d[E].location),_=Da(Fa(y.content)),S=0;S<_.length;++S)w=_[S],w.id==E&&(T=w);var P=Vt(T.messages[0].data);{P[6][0].data=Yt(n.e.r+1),P[7][0].data=Yt(n.e.c+1);var D=kn(P[46][0].data),A=ut.find(p,d[D].location),H=Da(Fa(A.content));{for(var J=0;J<H.length&&H[J].id!=D;++J);if(H[J].id!=D)throw"Bad ColumnRowUIDMapArchive";var B=Vt(H[J].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var I=0;I<=n.e.c;++I){var ee=[];ee[1]=ee[2]=[{type:0,data:Yt(I+420690)}],B[1].push({type:2,data:cn(ee)}),B[2].push({type:0,data:Yt(I)}),B[3].push({type:0,data:Yt(I)})}B[4]=[],B[5]=[],B[6]=[];for(var re=0;re<=n.e.r;++re)ee=[],ee[1]=ee[2]=[{type:0,data:Yt(re+726270)}],B[4].push({type:2,data:cn(ee)}),B[5].push({type:0,data:Yt(re)}),B[6].push({type:0,data:Yt(re)});H[J].messages[0].data=cn(B)}A.content=mc(hc(H)),A.size=A.content.length,delete P[46];var ye=Vt(P[4][0].data);{ye[7][0].data=Yt(n.e.r+1);var he=Vt(ye[1][0].data),ce=kn(he[2][0].data);A=ut.find(p,d[ce].location),H=Da(Fa(A.content));{if(H[0].id!=ce)throw"Bad HeaderStorageBucket";var Ee=Vt(H[0].messages[0].data);for(re=0;re<s.length;++re){var je=Vt(Ee[2][0].data);je[1][0].data=Yt(re),je[4][0].data=Yt(s[re].length),Ee[2][re]={type:Ee[2][0].type,data:cn(je)}}H[0].messages[0].data=cn(Ee)}A.content=mc(hc(H)),A.size=A.content.length;var fe=kn(ye[2][0].data);A=ut.find(p,d[fe].location),H=Da(Fa(A.content));{if(H[0].id!=fe)throw"Bad HeaderStorageBucket";for(Ee=Vt(H[0].messages[0].data),I=0;I<=n.e.c;++I)je=Vt(Ee[2][0].data),je[1][0].data=Yt(I),je[4][0].data=Yt(n.e.r+1),Ee[2][I]={type:Ee[2][0].type,data:cn(je)};H[0].messages[0].data=cn(Ee)}A.content=mc(hc(H)),A.size=A.content.length;var ue=kn(ye[4][0].data);(function(){for(var z=ut.find(p,d[ue].location),U=Da(Fa(z.content)),te,W=0;W<U.length;++W){var ae=U[W];ae.id==ue&&(te=ae)}var oe=Vt(te.messages[0].data);{oe[3]=[];var de=[];l.forEach(function(q,Ze){de[1]=[{type:0,data:Yt(Ze)}],de[2]=[{type:0,data:Yt(1)}],de[3]=[{type:2,data:CR(q)}],oe[3].push({type:2,data:cn(de)})})}te.messages[0].data=cn(oe);var ge=hc(U),Oe=mc(ge);z.content=Oe,z.size=z.content.length})();var O=Vt(ye[3][0].data);{var F=O[1][0];delete O[2];var M=Vt(F.data);{var ie=kn(M[2][0].data);(function(){for(var z=ut.find(p,d[ie].location),U=Da(Fa(z.content)),te,W=0;W<U.length;++W){var ae=U[W];ae.id==ie&&(te=ae)}var oe=Vt(te.messages[0].data);{delete oe[6],delete O[7];var de=new Uint8Array(oe[5][0].data);oe[5]=[];for(var ge=0,Oe=0;Oe<=n.e.r;++Oe){var q=Vt(de);ge+=UR(q,s[Oe],l),q[1][0].data=Yt(Oe),oe[5].push({data:cn(q),type:2})}oe[1]=[{type:0,data:Yt(n.e.c+1)}],oe[2]=[{type:0,data:Yt(n.e.r+1)}],oe[3]=[{type:0,data:Yt(ge)}],oe[4]=[{type:0,data:Yt(n.e.r+1)}]}te.messages[0].data=cn(oe);var Ze=hc(U),Je=mc(Ze);z.content=Je,z.size=z.content.length})()}F.data=cn(M)}ye[3][0].data=cn(O)}P[4][0].data=cn(ye)}T.messages[0].data=cn(P);var Y=hc(_),R=mc(Y);return y.content=R,y.size=y.content.length,p}function jb(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function bg(e){jb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function kg(e){jb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function WR(e){return Dt.WS.indexOf(e)>-1?"sheet":e==Dt.CS?"chart":e==Dt.DS?"dialog":e==Dt.MS?"macro":e&&e.length?e:"sheet"}function HR(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,WR(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function VR(e,t,r,n,a,s,l,d,m,p,g,y){try{s[n]=Vu(ha(e,r,!0),t);var _=Lr(e,t),T;switch(d){case"sheet":T=vO(_,t,a,m,s[n],p,g,y);break;case"chart":if(T=xO(_,t,a,m,s[n],p,g,y),!T||!T["!drawel"])break;var S=Lu(T["!drawel"].Target,t),w=ld(S),E=iI(ha(e,S,!0),Vu(ha(e,w,!0),S)),P=Lu(E,S),D=ld(P);T=Gj(ha(e,P,!0),P,m,Vu(ha(e,D,!0),P),p,T);break;case"macro":T=yO(_,t,a,m,s[n],p,g,y);break;case"dialog":T=_O(_,t,a,m,s[n],p,g,y);break;default:throw new Error("Unrecognized sheet type "+d)}l[n]=T;var A=[];s&&s[n]&&Tr(s[n]).forEach(function(H){var J="";if(s[n][H].Type==Dt.CMNT){J=Lu(s[n][H].Target,t);var B=SO(Lr(e,J,!0),J,m);if(!B||!B.length)return;ay(T,B,!1)}s[n][H].Type==Dt.TCMNT&&(J=Lu(s[n][H].Target,t),A=A.concat(oI(Lr(e,J,!0),m)))}),A&&A.length&&ay(T,A,!0,m.people||[])}catch(H){if(m.WTF)throw H}}function Pa(e){return e.charAt(0)=="/"?e.slice(1):e}function Ob(e,t){if(Oc(),t=t||{},bg(t),ja(e,"META-INF/manifest.xml")||ja(e,"objectdata.xml"))return py(e,t);if(ja(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Km<"u"){if(e.FileIndex)return Km(e);var r=ut.utils.cfb_new();return T1(e).forEach(function(je){Nt(r,je,lN(e,je))}),Km(r)}throw new Error("Unsupported NUMBERS file")}if(!ja(e,"[Content_Types].xml"))throw ja(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ja(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=T1(e),a=t4(ha(e,"[Content_Types].xml")),s=!1,l,d;if(a.workbooks.length===0&&(d="xl/workbook.xml",Lr(e,d,!0)&&a.workbooks.push(d)),a.workbooks.length===0){if(d="xl/workbook.bin",!Lr(e,d,!0))throw new Error("Could not find workbook");a.workbooks.push(d),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var m={},p={};if(!t.bookSheets&&!t.bookProps){if(Gu=[],a.sst)try{Gu=kO(Lr(e,Pa(a.sst)),a.sst,t)}catch(je){if(t.WTF)throw je}t.cellStyles&&a.themes.length&&(m=bO(ha(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(p=wO(Lr(e,Pa(a.style)),a.style,m,t))}a.links.map(function(je){try{var fe=Vu(ha(e,ld(Pa(je))),je);return EO(Lr(e,Pa(je)),fe,je,t)}catch{}});var g=gO(Lr(e,Pa(a.workbooks[0])),a.workbooks[0],t),y={},_="";a.coreprops.length&&(_=Lr(e,Pa(a.coreprops[0]),!0),_&&(y=xw(_)),a.extprops.length!==0&&(_=Lr(e,Pa(a.extprops[0]),!0),_&&l4(_,y,t)));var T={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(_=ha(e,Pa(a.custprops[0]),!0),_&&(T=u4(_,t)));var S={};if((t.bookSheets||t.bookProps)&&(g.Sheets?l=g.Sheets.map(function(fe){return fe.name}):y.Worksheets&&y.SheetNames.length>0&&(l=y.SheetNames),t.bookProps&&(S.Props=y,S.Custprops=T),t.bookSheets&&typeof l<"u"&&(S.SheetNames=l),t.bookSheets?S.SheetNames:t.bookProps))return S;l={};var w={};t.bookDeps&&a.calcchain&&(w=TO(Lr(e,Pa(a.calcchain)),a.calcchain));var E=0,P={},D,A;{var H=g.Sheets;y.Worksheets=H.length,y.SheetNames=[];for(var J=0;J!=H.length;++J)y.SheetNames[J]=H[J].name}var B=s?"bin":"xml",I=a.workbooks[0].lastIndexOf("/"),ee=(a.workbooks[0].slice(0,I+1)+"_rels/"+a.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");ja(e,ee)||(ee="xl/_rels/workbook."+B+".rels");var re=Vu(ha(e,ee,!0),ee.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=CO(Lr(e,Pa(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=cI(Lr(e,Pa(a.people[0])),t)),re&&(re=HR(re,g.Sheets));var ye=Lr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=y.Worksheets;++E){var he="sheet";if(re&&re[E]?(D="xl/"+re[E][1].replace(/[\/]?xl\//,""),ja(e,D)||(D=re[E][1]),ja(e,D)||(D=ee.replace(/_rels\/.*$/,"")+re[E][1]),he=re[E][2]):(D="xl/worksheets/sheet"+(E+1-ye)+"."+B,D=D.replace(/sheet0\./,"sheet.")),A=D.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(y.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var ce=!1,Ee=0;Ee!=t.sheets.length;++Ee)typeof t.sheets[Ee]=="number"&&t.sheets[Ee]==E&&(ce=1),typeof t.sheets[Ee]=="string"&&t.sheets[Ee].toLowerCase()==y.SheetNames[E].toLowerCase()&&(ce=1);if(!ce)continue e}}VR(e,D,A,y.SheetNames[E],E,P,l,he,t,g,m,p)}return S={Directory:a,Workbook:g,Props:y,Custprops:T,Deps:w,Sheets:l,SheetNames:y.SheetNames,Strings:Gu,Styles:p,Themes:m,SSF:ir(xt)},t&&t.bookFiles&&(e.files?(S.keys=n,S.files=e.files):(S.keys=[],S.files={},e.FullPaths.forEach(function(je,fe){je=je.replace(/^Root Entry[\/]/,""),S.keys.push(je),S.files[je]=e.FileIndex[fe]}))),t&&t.bookVBA&&(a.vba.length>0?S.vbaraw=Lr(e,Pa(a.vba[0]),!0):a.defaults&&a.defaults.bin===vI&&(S.vbaraw=Lr(e,"xl/vbaProject.bin",!0))),S}function GR(e,t){var r=t||{},n="Workbook",a=ut.find(e,n);try{if(n="/!DataSpaces/Version",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(A5(a.content),n="/!DataSpaces/DataSpaceMap",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=P5(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=I5(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);F5(a.content)}catch{}if(n="/EncryptionInfo",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var d=j5(a.content);if(n="/EncryptedPackage",a=ut.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(d[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(d[1],a.content,r.password||"",r);if(d[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(d[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function KR(e,t){return t.bookType=="ods"?Fb(e,t):t.bookType=="numbers"?$R(e,t):t.bookType=="xlsb"?ZR(e,t):Rb(e,t)}function ZR(e,t){_c=1024,e&&!e.SSF&&(e.SSF=ir(xt)),e&&e.SSF&&(Oc(),_d(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ku?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=nb.indexOf(t.bookType)>-1,a=og();kg(t=t||{});var s=Wp(),l="",d=0;if(t.cellXfs=[],po(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Nt(s,l,yw(e.Props,t)),a.coreprops.push(l),Xt(t.rels,2,l,Dt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],p=0;p<e.SheetNames.length;++p)(e.Workbook.Sheets[p]||{}).Hidden!=2&&m.push(e.SheetNames[p]);e.Props.SheetNames=m}for(e.Props.Worksheets=e.Props.SheetNames.length,Nt(s,l,bw(e.Props)),a.extprops.push(l),Xt(t.rels,3,l,Dt.EXT_PROPS),e.Custprops!==e.Props&&Tr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Nt(s,l,kw(e.Custprops)),a.custprops.push(l),Xt(t.rels,4,l,Dt.CUST_PROPS)),d=1;d<=e.SheetNames.length;++d){var g={"!id":{}},y=e.Sheets[e.SheetNames[d-1]],_=(y||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+d+"."+r,Nt(s,l,NO(d-1,l,t,e,g)),a.sheets.push(l),Xt(t.wbrels,-1,"worksheets/sheet"+d+"."+r,Dt.WS[0])}if(y){var T=y["!comments"],S=!1,w="";T&&T.length>0&&(w="xl/comments"+d+"."+r,Nt(s,w,DO(T,w)),a.comments.push(w),Xt(g,-1,"../comments"+d+"."+r,Dt.CMNT),S=!0),y["!legacy"]&&S&&Nt(s,"xl/drawings/vmlDrawing"+d+".vml",tb(d,y["!comments"])),delete y["!comments"],delete y["!legacy"]}g["!id"].rId1&&Nt(s,ld(l),Sc(g))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Nt(s,l,IO(t.Strings,l,t)),a.strs.push(l),Xt(t.wbrels,-1,"sharedStrings."+r,Dt.SST)),l="xl/workbook."+r,Nt(s,l,AO(e,l)),a.workbooks.push(l),Xt(t.rels,1,l,Dt.WB),l="xl/theme/theme1.xml",Nt(s,l,hg(e.Themes,t)),a.themes.push(l),Xt(t.wbrels,-1,"theme/theme1.xml",Dt.THEME),l="xl/styles."+r,Nt(s,l,PO(e,l,t)),a.styles.push(l),Xt(t.wbrels,-1,"styles."+r,Dt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Nt(s,l,e.vbaraw),a.vba.push(l),Xt(t.wbrels,-1,"vbaProject.bin",Dt.VBA)),l="xl/metadata."+r,Nt(s,l,FO(l)),a.metadata.push(l),Xt(t.wbrels,-1,"metadata."+r,Dt.XLMETA),Nt(s,"[Content_Types].xml",gw(a,t)),Nt(s,"_rels/.rels",Sc(t.rels)),Nt(s,"xl/_rels/workbook."+r+".rels",Sc(t.wbrels)),delete t.revssf,delete t.ssf,s}function Rb(e,t){_c=1024,e&&!e.SSF&&(e.SSF=ir(xt)),e&&e.SSF&&(Oc(),_d(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ku?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=nb.indexOf(t.bookType)>-1,a=og();kg(t=t||{});var s=Wp(),l="",d=0;if(t.cellXfs=[],po(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",Nt(s,l,yw(e.Props,t)),a.coreprops.push(l),Xt(t.rels,2,l,Dt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var m=[],p=0;p<e.SheetNames.length;++p)(e.Workbook.Sheets[p]||{}).Hidden!=2&&m.push(e.SheetNames[p]);e.Props.SheetNames=m}e.Props.Worksheets=e.Props.SheetNames.length,Nt(s,l,bw(e.Props)),a.extprops.push(l),Xt(t.rels,3,l,Dt.EXT_PROPS),e.Custprops!==e.Props&&Tr(e.Custprops||{}).length>0&&(l="docProps/custom.xml",Nt(s,l,kw(e.Custprops)),a.custprops.push(l),Xt(t.rels,4,l,Dt.CUST_PROPS));var g=["SheetJ5"];for(t.tcid=0,d=1;d<=e.SheetNames.length;++d){var y={"!id":{}},_=e.Sheets[e.SheetNames[d-1]],T=(_||{})["!type"]||"sheet";switch(T){case"chart":default:l="xl/worksheets/sheet"+d+"."+r,Nt(s,l,mb(d-1,t,e,y)),a.sheets.push(l),Xt(t.wbrels,-1,"worksheets/sheet"+d+"."+r,Dt.WS[0])}if(_){var S=_["!comments"],w=!1,E="";if(S&&S.length>0){var P=!1;S.forEach(function(D){D[1].forEach(function(A){A.T==!0&&(P=!0)})}),P&&(E="xl/threadedComments/threadedComment"+d+"."+r,Nt(s,E,lI(S,g,t)),a.threadedcomments.push(E),Xt(y,-1,"../threadedComments/threadedComment"+d+"."+r,Dt.TCMNT)),E="xl/comments"+d+"."+r,Nt(s,E,rb(S)),a.comments.push(E),Xt(y,-1,"../comments"+d+"."+r,Dt.CMNT),w=!0}_["!legacy"]&&w&&Nt(s,"xl/drawings/vmlDrawing"+d+".vml",tb(d,_["!comments"])),delete _["!comments"],delete _["!legacy"]}y["!id"].rId1&&Nt(s,ld(l),Sc(y))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,Nt(s,l,Ww(t.Strings,t)),a.strs.push(l),Xt(t.wbrels,-1,"sharedStrings."+r,Dt.SST)),l="xl/workbook."+r,Nt(s,l,_b(e)),a.workbooks.push(l),Xt(t.rels,1,l,Dt.WB),l="xl/theme/theme1.xml",Nt(s,l,hg(e.Themes,t)),a.themes.push(l),Xt(t.wbrels,-1,"theme/theme1.xml",Dt.THEME),l="xl/styles."+r,Nt(s,l,Xw(e,t)),a.styles.push(l),Xt(t.wbrels,-1,"styles."+r,Dt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",Nt(s,l,e.vbaraw),a.vba.push(l),Xt(t.wbrels,-1,"vbaProject.bin",Dt.VBA)),l="xl/metadata."+r,Nt(s,l,eb()),a.metadata.push(l),Xt(t.wbrels,-1,"metadata."+r,Dt.XLMETA),g.length>1&&(l="xl/persons/person.xml",Nt(s,l,uI(g)),a.people.push(l),Xt(t.wbrels,-1,"persons/person.xml",Dt.PEOPLE)),Nt(s,"[Content_Types].xml",gw(a,t)),Nt(s,"_rels/.rels",Sc(t.rels)),Nt(s,"xl/_rels/workbook."+r+".rels",Sc(t.wbrels)),delete t.revssf,delete t.ssf,s}function Sg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=pa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function YR(e,t){return ut.find(e,"EncryptedPackage")?GR(e,t):_g(e,t)}function qR(e,t){var r,n=e,a=t||{};return a.type||(a.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),r=Y_(n,a),Ob(r,a)}function Lb(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return bp(e.slice(r),t);default:break e}return Ic.to_workbook(e,t)}function XR(e,t){var r="",n=Sg(e,t);switch(t.type){case"base64":r=pa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=al(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=nr(r)),t.type="binary",Lb(r,t)}function JR(e,t){var r=e;return t.type=="base64"&&(r=pa(r)),r=Bt.utils.decode(1200,r.slice(2),"str"),t.type="binary",Lb(r,t)}function QR(e){return e.match(/[^\x00-\x7F]/)?Pi(e):e}function Zm(e,t,r,n){return n?(r.type="string",Ic.to_workbook(e,r)):Ic.to_workbook(t,r)}function pd(e,t){Mh();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return pd(new Uint8Array(e),(r=ir(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Ec={},r.dateNF&&(Ec.dateNF=r.dateNF),r.type||(r.type=Pt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Pt?"buffer":"binary",n=eN(e),typeof Uint8Array<"u"&&!Pt&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=QR(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),d=new Uint8Array(l);if(d.foo="bar",!d.foo)return r=ir(r),r.type="array",pd(Bp(n),r)}switch((a=Sg(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return YR(ut.read(n,r),r);break;case 9:if(a[1]<=8)return _g(n,r);break;case 60:return bp(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return d5(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return Uw.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?qR(n,r):Zm(e,n,r,s);case 239:return a[3]===60?bp(n,r):Zm(e,n,r,s);case 255:if(a[1]===254)return JR(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Qo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Qo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return wp.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return Zw.to_workbook(n,r);break;case 10:case 13:case 32:return XR(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return u5.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?wp.to_workbook(n,r):Zm(e,n,r,s)}function _y(e,t){var r=t||{};return r.type="file",pd(e,r)}function Mb(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return wd(t.file,ut.write(e,{type:Pt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return ut.write(e,t)}function eL(e,t){var r=ir(t||{}),n=KR(e,r);return Bb(n,r)}function tL(e,t){var r=ir(t||{}),n=Rb(e,r);return Bb(n,r)}function Bb(e,t){var r={},n=Pt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?ut.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(yd(a))}return t.password&&typeof encrypt_agile<"u"?Mb(encrypt_agile(a,t.password),t):t.type==="file"?wd(t.file,a):t.type=="string"?nr(a):a}function rL(e,t){var r=t||{},n=iR(e,r);return Mb(n,r)}function Ai(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return nd(Pi(n));case"binary":return Pi(n);case"string":return e;case"file":return wd(t.file,n,"utf8");case"buffer":return Pt?ds(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ai(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nL(e,t){switch(t.type){case"base64":return nd(e);case"binary":return e;case"string":return e;case"file":return wd(t.file,e,"binary");case"buffer":return Pt?ds(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function nh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?nd(r):t.type=="string"?nr(r):r;case"file":return wd(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Tg(e,t){Mh(),yb(e);var r=ir(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Tg(e,r);return r.type="array",yd(n)}return tL(e,r)}function Kh(e,t){Mh(),yb(e);var r=ir(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Kh(e,r);return r.type="array",yd(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ai(JO(e,r),r);case"slk":case"sylk":return Ai(zw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Ai(Nb(e.Sheets[e.SheetNames[a]],r),r);case"txt":return nL($b(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Ai(Cg(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Ai(Uw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return nh(wp.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Ai(Ic.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Ai(Zw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Ai($w.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Ai(Fb(e,r),r);case"wk1":return nh(Qo.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return nh(Qo.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),nh(Sb(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),rL(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return eL(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Eg(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function wy(e,t,r){var n=r||{};return n.type="file",n.file=t,Eg(n),Kh(e,n)}function aL(e,t,r){var n=r||{};return n.type="file",n.file=t,Eg(n),Tg(e,n)}function iL(e,t,r,n){var a=r||{};a.type="file",a.file=e,Eg(a),a.type="buffer";var s=n;return s instanceof Function||(s=r),so.writeFile(e,Kh(t,a),s)}function zb(e,t,r,n,a,s,l,d){var m=kr(r),p=d.defval,g=d.raw||!Object.prototype.hasOwnProperty.call(d,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||e[r])for(var T=t.s.c;T<=t.e.c;++T){var S=l?e[r][T]:e[n[T]+m];if(S===void 0||S.t===void 0){if(p===void 0)continue;s[T]!=null&&(_[s[T]]=p);continue}var w=S.v;switch(S.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(s[T]!=null){if(w==null)if(S.t=="e"&&w===null)_[s[T]]=null;else if(p!==void 0)_[s[T]]=p;else if(g&&w===null)_[s[T]]=null;else continue;else _[s[T]]=g&&(S.t!=="n"||S.t==="n"&&d.rawNumbers!==!1)?w:Fi(S,w,d);w!=null&&(y=!1)}}return{row:_,isempty:y}}function Ah(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],l=0,d="",m={s:{r:0,c:0},e:{r:0,c:0}},p=t||{},g=p.range!=null?p.range:e["!ref"];switch(p.header===1?n=1:p.header==="A"?n=2:Array.isArray(p.header)?n=3:p.header==null&&(n=0),typeof g){case"string":m=Ot(g);break;case"number":m=Ot(e["!ref"]),m.s.r=g;break;default:m=g}n>0&&(a=0);var y=kr(m.s.r),_=[],T=[],S=0,w=0,E=Array.isArray(e),P=m.s.r,D=0,A={};E&&!e[P]&&(e[P]=[]);var H=p.skipHidden&&e["!cols"]||[],J=p.skipHidden&&e["!rows"]||[];for(D=m.s.c;D<=m.e.c;++D)if(!(H[D]||{}).hidden)switch(_[D]=hr(D),r=E?e[P][D]:e[_[D]+y],n){case 1:s[D]=D-m.s.c;break;case 2:s[D]=_[D];break;case 3:s[D]=p.header[D-m.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),d=l=Fi(r,null,p),w=A[l]||0,!w)A[l]=1;else{do d=l+"_"+w++;while(A[d]);A[l]=w,A[d]=1}s[D]=d}for(P=m.s.r+a;P<=m.e.r;++P)if(!(J[P]||{}).hidden){var B=zb(e,m,P,_,n,s,E,p);(B.isempty===!1||(n===1?p.blankrows!==!1:p.blankrows))&&(T[S++]=B.row)}return T.length=S,T}var by=/"/g;function Ub(e,t,r,n,a,s,l,d){for(var m=!0,p=[],g="",y=kr(r),_=t.s.c;_<=t.e.c;++_)if(n[_]){var T=d.dense?(e[r]||[])[_]:e[n[_]+y];if(T==null)g="";else if(T.v!=null){m=!1,g=""+(d.rawNumbers&&T.t=="n"?T.v:Fi(T,null,d));for(var S=0,w=0;S!==g.length;++S)if((w=g.charCodeAt(S))===a||w===s||w===34||d.forceQuotes){g='"'+g.replace(by,'""')+'"';break}g=="ID"&&(g='"ID"')}else T.f!=null&&!T.F?(m=!1,g="="+T.f,g.indexOf(",")>=0&&(g='"'+g.replace(by,'""')+'"')):g="";p.push(g)}return d.blankrows===!1&&m?null:p.join(l)}function Cg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Ot(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),d=n.RS!==void 0?n.RS:`
`,m=d.charCodeAt(0),p=new RegExp((s=="|"?"\\|":s)+"+$"),g="",y=[];n.dense=Array.isArray(e);for(var _=n.skipHidden&&e["!cols"]||[],T=n.skipHidden&&e["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(y[S]=hr(S));for(var w=0,E=a.s.r;E<=a.e.r;++E)(T[E]||{}).hidden||(g=Ub(e,a,E,y,l,m,s,n),g!=null&&(n.strip&&(g=g.replace(p,"")),(g||n.blankrows!==!1)&&r.push((w++?d:"")+g)));return delete n.dense,r.join("")}function $b(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Cg(e,t);if(typeof Bt>"u"||t.type=="string")return r;var n=Bt.utils.encode(1200,r,"str");return"ÿþ"+n}function sL(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Ot(e["!ref"]),s="",l=[],d,m=[],p=Array.isArray(e);for(d=a.s.c;d<=a.e.c;++d)l[d]=hr(d);for(var g=a.s.r;g<=a.e.r;++g)for(s=kr(g),d=a.s.c;d<=a.e.c;++d)if(t=l[d]+s,r=p?(e[g]||[])[d]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}m[m.length]=t+"="+n}return m}function Wb(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},l=0,d=0;if(s&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var m=typeof n.origin=="string"?yr(n.origin):n.origin;l=m.r,d=m.c}var p,g={s:{c:0,r:0},e:{c:d,r:l+t.length-1+a}};if(s["!ref"]){var y=Ot(s["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),l==-1&&(l=y.e.r+1,g.e.r=l+t.length-1+a)}else l==-1&&(l=0,g.e.r=t.length-1+a);var _=n.header||[],T=0;t.forEach(function(w,E){Tr(w).forEach(function(P){(T=_.indexOf(P))==-1&&(_[T=_.length]=P);var D=w[P],A="z",H="",J=yt({c:d+T,r:l+E+a});p=gd(s,J),D&&typeof D=="object"&&!(D instanceof Date)?s[J]=D:(typeof D=="number"?A="n":typeof D=="boolean"?A="b":typeof D=="string"?A="s":D instanceof Date?(A="d",n.cellDates||(A="n",D=Zr(D)),H=n.dateNF||xt[14]):D===null&&n.nullError&&(A="e",D=0),p?(p.t=A,p.v=D,delete p.w,delete p.R,H&&(p.z=H)):s[J]=p={t:A,v:D},H&&(p.z=H))})}),g.e.c=Math.max(g.e.c,d+_.length-1);var S=kr(l);if(a)for(T=0;T<_.length;++T)s[hr(T+d)+S]={t:"s",v:_[T]};return s["!ref"]=Ct(g),s}function oL(e,t){return Wb(null,e,t)}function gd(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=yr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?gd(e,yt(t)):gd(e,yt({r:t,c:r||0}))}function lL(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Ag(){return{SheetNames:[],Sheets:{}}}function Ng(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var l=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(xb(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function cL(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=lL(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function uL(e,t){return e.z=t,e}function Hb(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function dL(e,t,r){return Hb(e,"#"+t,r)}function fL(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function hL(e,t,r,n){for(var a=typeof t!="string"?t:Ot(t),s=typeof t=="string"?t:Ct(t),l=a.s.r;l<=a.e.r;++l)for(var d=a.s.c;d<=a.e.c;++d){var m=gd(e,l,d);m.t="n",m.F=s,delete m.v,l==a.s.r&&d==a.s.c&&(m.f=r,n&&(m.D=!0))}return e}var Vb={encode_col:hr,encode_row:kr,encode_cell:yt,encode_range:Ct,decode_col:tg,decode_row:eg,split_cell:DN,decode_cell:yr,decode_range:$n,format_cell:Fi,sheet_add_aoa:cw,sheet_add_json:Wb,sheet_add_dom:Pb,aoa_to_sheet:Lc,json_to_sheet:oL,table_to_sheet:Ib,table_to_book:kR,sheet_to_csv:Cg,sheet_to_txt:$b,sheet_to_json:Ah,sheet_to_html:Nb,sheet_to_formulae:sL,sheet_to_row_object_array:Ah,sheet_get_cell:gd,book_new:Ag,book_append_sheet:Ng,book_set_sheet_visibility:cL,cell_set_number_format:uL,cell_set_hyperlink:Hb,cell_set_internal_link:dL,cell_add_comment:fL,sheet_set_array_formula:hL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Zh;function mL(e){Zh=e}function pL(e,t){var r=Zh(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=Ot(e["!ref"]),s=n.FS!==void 0?n.FS:",",l=s.charCodeAt(0),d=n.RS!==void 0?n.RS:`
`,m=d.charCodeAt(0),p=new RegExp((s=="|"?"\\|":s)+"+$"),g="",y=[];n.dense=Array.isArray(e);for(var _=n.skipHidden&&e["!cols"]||[],T=n.skipHidden&&e["!rows"]||[],S=a.s.c;S<=a.e.c;++S)(_[S]||{}).hidden||(y[S]=hr(S));var w=a.s.r,E=!1,P=0;return r._read=function(){if(!E)return E=!0,r.push("\uFEFF");for(;w<=a.e.r;)if(++w,!(T[w-1]||{}).hidden&&(g=Ub(e,a,w-1,y,l,m,s,n),g!=null&&(n.strip&&(g=g.replace(p,"")),g||n.blankrows!==!1)))return r.push((P++?d:"")+g);return r.push(null)},r}function gL(e,t){var r=Zh(),n=t||{},a=n.header!=null?n.header:Eb,s=n.footer!=null?n.footer:Cb;r.push(a);var l=$n(e["!ref"]);n.dense=Array.isArray(e),r.push(Ab(e,l,n));var d=l.s.r,m=!1;return r._read=function(){if(d>l.e.r)return m||(m=!0,r.push("</table>"+s)),r.push(null);for(;d<=l.e.r;){r.push(Tb(e,l,d,n)),++d;break}},r}function vL(e,t){var r=Zh({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,s=1,l=[],d=0,m="",p={s:{r:0,c:0},e:{r:0,c:0}},g=t||{},y=g.range!=null?g.range:e["!ref"];switch(g.header===1?a=1:g.header==="A"?a=2:Array.isArray(g.header)&&(a=3),typeof y){case"string":p=Ot(y);break;case"number":p=Ot(e["!ref"]),p.s.r=y;break;default:p=y}a>0&&(s=0);var _=kr(p.s.r),T=[],S=0,w=Array.isArray(e),E=p.s.r,P=0,D={};w&&!e[E]&&(e[E]=[]);var A=g.skipHidden&&e["!cols"]||[],H=g.skipHidden&&e["!rows"]||[];for(P=p.s.c;P<=p.e.c;++P)if(!(A[P]||{}).hidden)switch(T[P]=hr(P),n=w?e[E][P]:e[T[P]+_],a){case 1:l[P]=P-p.s.c;break;case 2:l[P]=T[P];break;case 3:l[P]=g.header[P-p.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),m=d=Fi(n,null,g),S=D[d]||0,!S)D[d]=1;else{do m=d+"_"+S++;while(D[m]);D[d]=S,D[m]=1}l[P]=m}return E=p.s.r+s,r._read=function(){for(;E<=p.e.r;)if(!(H[E-1]||{}).hidden){var J=zb(e,p,E,T,a,l,w,g);if(++E,J.isempty===!1||(a===1?g.blankrows!==!1:g.blankrows)){r.push(J.row);return}}return r.push(null)},r}var xL={to_json:vL,to_html:gL,to_csv:pL,set_readable:mL};const yL=rd.version,_L=Object.freeze(Object.defineProperty({__proto__:null,CFB:ut,SSF:W_,parse_xlscfb:_g,parse_zip:Ob,read:pd,readFile:_y,readFileSync:_y,set_cptable:kA,set_fs:JA,stream:xL,utils:Vb,version:yL,write:Kh,writeFile:wy,writeFileAsync:iL,writeFileSync:wy,writeFileXLSX:aL,writeXLSX:Tg},Symbol.toStringTag,{value:"Module"}));function wL({onImported:e}){const[t,r]=Z.useState(!1),[n,a]=Z.useState(!1),s=Z.useRef(null),l=Z.useRef(!1),d=async y=>{if(!(!y||l.current)){l.current=!0,r(!0);try{const _=await y.arrayBuffer(),T=pd(_,{type:"array"}),S=T.Sheets[T.SheetNames[0]],w=Vb.sheet_to_json(S,{header:1});if(!w.length){alert("📄 File appears to be empty. Please check your Excel file.");return}const E=(w[0]||[]).map(re=>String(re??"").trim().toLowerCase());let P=E.findIndex(re=>re.includes("address"));P===-1&&(P=0);const D=E.findIndex(re=>re==="lat"||re.includes("latitude")),A=E.findIndex(re=>re==="lng"||re==="lon"||re.includes("longitude")),H=D===-1?void 0:D,J=A===-1?void 0:A,B=[];for(let re=1;re<w.length;re++){const ye=w[re]||[],he=String(ye[P]??"").trim();if(!he)continue;const ce=H!==void 0&&ye[H]!=null&&ye[H]!==""?ky(ye[H]):void 0,Ee=J!==void 0&&ye[J]!=null&&ye[J]!==""?ky(ye[J]):void 0;B.push({address:he,lat:ce,lng:Ee})}if(B.length===0){alert("🚫 No valid addresses found in the file. Please check the format.");return}e(B);const I=B.some(re=>re.lat!=null&&re.lng!=null),ee=`✅ Successfully imported ${B.length} address${B.length===1?"":"es"}${I?" with GPS coordinates":""}!`;console.log(ee)}catch(_){console.error(_),alert("❌ Failed to read Excel file. Please ensure it's a valid .xlsx or .xls file.")}finally{l.current=!1,r(!1),s.current&&(s.current.value="")}}},m=async y=>{if(l.current)return;const _=y.target.files?.[0];_&&await d(_)},p=y=>{y.preventDefault(),y.stopPropagation(),y.type==="dragenter"||y.type==="dragover"?a(!0):y.type==="dragleave"&&a(!1)},g=async y=>{if(y.preventDefault(),y.stopPropagation(),l.current)return;a(!1);const T=Array.from(y.dataTransfer.files).find(S=>S.name.endsWith(".xlsx")||S.name.endsWith(".xls")||S.type.includes("spreadsheet"));T?await d(T):alert("📋 Please drop an Excel file (.xlsx or .xls)")};return u.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:"0.75rem",flex:1},children:[u.jsx("input",{ref:s,type:"file",accept:".xlsx,.xls",onChange:m,className:"file-input",id:"excel-input",disabled:t,style:{display:"none"}}),u.jsx(is,{className:"btn btn-primary",onClick:()=>s.current?.click(),isLoading:t,loadingText:"Processing...",disabled:t,style:{whiteSpace:"nowrap"},children:"📊 Import Excel"}),u.jsx("div",{onDragEnter:p,onDragLeave:p,onDragOver:p,onDrop:g,className:"btn btn-ghost",style:{border:`2px dashed ${n?"var(--primary)":"var(--border-light)"}`,background:n?"var(--primary-light)":"transparent",color:n?"var(--primary-dark)":"var(--text-muted)",fontSize:"0.875rem",textAlign:"center",cursor:"pointer",transition:"all var(--transition-fast)",userSelect:"none",minWidth:"140px",flex:1,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>s.current?.click(),children:n?u.jsx("span",{children:"📥 Drop Excel file here"}):u.jsx("span",{children:"🖱️ Or drag & drop Excel"})})]})}function ky(e){const t=Number(e);return Number.isFinite(t)?t:void 0}const bL=function({user:t,onAddressesReady:r}){const[n,a]=Z.useState([]),[s,l]=Z.useState(""),[d,m]=Z.useState(!1),[p,g]=Z.useState(!1),[y,_]=Z.useState(null),[T,S]=Z.useState(!0),[w,E]=Z.useState(!1),[P,D]=Z.useState(null),[A,H]=Z.useState(null),J=Z.useCallback(F=>{const M=F.map(fp);a(M),H(null),_(null)},[]),B=()=>{if(!s.trim())return;const F={success:!1,address:s.trim(),originalAddress:s.trim(),error:"Not geocoded yet"};Z.startTransition(()=>{a(M=>[...M,F]),l(""),H(null)})},I=(F,M,ie)=>{const Y={success:!0,address:F,originalAddress:F,lat:M,lng:ie,confidence:1,formattedAddress:F};Z.startTransition(()=>{a(R=>[...R,Y]),l(""),H(null)})},ee=F=>{Z.startTransition(()=>{a(M=>M.filter((ie,Y)=>Y!==F)),H(null),y===F?_(null):y!==null&&y>F&&_(y-1)})},re=(F,M)=>{Z.startTransition(()=>{a(ie=>ie.map((Y,R)=>R===F?{...Y,address:M,success:!1,error:"Modified - needs geocoding"}:Y)),H(null)})},ye=async F=>{const M=n[F];if(!M.success)try{const ie=await h1([M.address]),Y=[...n];Y[F]=ie[0],a(Y),H(null)}catch(ie){console.error("Single geocoding failed:",ie),alert("Geocoding failed. Please check your connection and subscription.")}},he=(F,M,ie)=>{const Y=[...n];Y[F]={...Y[F],lat:M,lng:ie,success:M!==void 0&&ie!==void 0,formattedAddress:Y[F].formattedAddress||Y[F].address,error:M!==void 0&&ie!==void 0?void 0:"Manual coordinates incomplete"},a(Y),H(null)},ce=async()=>{const F=n.map((M,ie)=>({addr:M,index:ie})).filter(({addr:M})=>!M.success);if(F.length===0){alert("All addresses are already geocoded!");return}g(!0),D({completed:0,total:F.length,current:""});try{const M=F.map(({addr:R})=>R.address),ie=await h1(M,(R,z,U)=>{D({completed:R,total:z,current:U})}),Y=[...n];F.forEach(({index:R},z)=>{Y[R]=ie[z]}),a(Y),H(null)}catch(M){console.error("Batch geocoding failed:",M),alert("Geocoding failed. Please check your connection and subscription.")}finally{g(!1),D(null)}},Ee=async()=>{const F=n.filter(M=>M.success&&M.lat&&M.lng);if(F.length===0){alert("No addresses with valid coordinates available for optimization");return}if(F.length<n.length){const M=n.length-F.length;if(!confirm(`${M} addresses don't have coordinates and will be excluded from optimization. Continue?`))return}m(!0),H(null);try{const M=n.map(lh);let ie;if(y!==null&&y>=0){const R=n[y];R.success&&R.lat&&R.lng&&(ie=[R.lng,R.lat])}const Y=await mA(M,ie);if(H({optimizedOrder:Y.optimizedOrder,totalDistance:Y.totalDistance,totalDuration:Y.totalDuration,unassigned:Y.unassigned,error:Y.error}),Y.success&&Y.optimizedOrder.length>0){const R=Y.optimizedOrder.map(z=>n[z]);if(a(R),H({optimizedOrder:R.map((z,U)=>U),totalDistance:Y.totalDistance,totalDuration:Y.totalDuration,unassigned:Y.unassigned,error:Y.error}),y!==null){const z=Y.optimizedOrder.indexOf(y);_(z>=0?z:null)}}}catch(M){console.error("Route optimization failed:",M),H({optimizedOrder:[],totalDistance:0,totalDuration:0,unassigned:[],error:M instanceof Error?M.message:"Optimization failed"})}finally{m(!1)}},je=()=>{const F=n.map(lh);r(F),alert(`Exported ${F.length} addresses to your main address list!`)},fe=()=>{confirm("Are you sure you want to clear all addresses?")&&(a([]),H(null),_(null))},ue=F=>{const M=F.map(fp);a(M),H(null)},O={total:n.length,geocoded:n.filter(F=>F.success).length,needsGeocoding:n.filter(F=>!F.success).length,highConfidence:n.filter(F=>F.success&&(F.confidence||0)>=.8).length,lowConfidence:n.filter(F=>F.success&&(F.confidence||0)<.5).length};return u.jsx(C_,{user:t,fallback:u.jsx(kL,{}),children:u.jsxs("div",{className:"route-planning",style:{maxWidth:"100%",padding:"0"},children:[!1,n.length===0&&u.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)",overflow:"hidden"},children:[u.jsxs("button",{onClick:()=>E(!w),style:{width:"100%",padding:"1rem 1.5rem",background:"transparent",border:"none",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",color:"var(--text-primary)",fontSize:"1rem",fontWeight:"600"},children:[u.jsx("span",{children:"📁 Import Excel File"}),u.jsx("span",{style:{fontSize:"1.25rem"},children:w?"▼":"▶"})]}),w&&u.jsx("div",{style:{padding:"0 1.5rem 1.5rem 1.5rem"},children:u.jsx(wL,{onImported:J})})]}),n.length>0&&u.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[u.jsx("h3",{style:{margin:0,fontSize:"1.125rem",color:"var(--text-primary)"},children:"🗺️ Map View"}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>S(!T),children:T?"Hide":"Show"})]}),T&&u.jsx("div",{style:{height:"400px",borderRadius:"var(--radius-md)",overflow:"hidden",border:"1px solid var(--border)"},children:u.jsx(yA,{addresses:n.map(lh),onAddressesUpdate:ue,startingPointIndex:y??void 0,onStartingPointChange:_,optimizedOrder:A?.optimizedOrder,showRouteLines:!!A&&!A.error,confidences:n.map(F=>F.confidence)})})]}),u.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsx(gA,{id:"manual-address-input",value:s,onChange:l,onSelect:I,placeholder:"Type an address to add...",disabled:!1}),u.jsx("button",{className:"btn btn-primary",onClick:B,disabled:!s.trim(),style:{width:"100%",marginTop:"0.5rem",padding:"0.75rem",fontSize:"0.9375rem",fontWeight:"600"},children:"+ Add Address"})]}),A&&u.jsx("div",{style:{marginBottom:"1rem",padding:"1rem",background:"var(--surface)",border:A.error?"2px solid var(--danger)":"2px solid var(--success)",borderRadius:"var(--radius-md)",color:A.error?"var(--danger)":"var(--success)"},children:A.error?u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.25rem",fontSize:"0.9375rem"},children:"❌ Optimization Failed"}),u.jsx("div",{style:{fontSize:"0.8125rem"},children:A.error})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{fontWeight:"bold",marginBottom:"0.5rem",fontSize:"0.9375rem"},children:"✓ Route Optimized"}),u.jsxs("div",{style:{fontSize:"0.8125rem",lineHeight:"1.5"},children:[u.jsxs("div",{children:["📍 ",A.optimizedOrder.length," stops"]}),u.jsxs("div",{children:["🚗 ",A_(A.totalDuration)]}),u.jsxs("div",{children:["📏 ",N_(A.totalDistance)]})]})]})}),n.length>0&&O.geocoded>=2&&u.jsx("button",{className:"btn btn-primary",onClick:Ee,disabled:d,style:{width:"100%",padding:"0.875rem",fontSize:"1rem",fontWeight:"600"},children:d?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"spinner",style:{display:"inline-block",width:"1rem",height:"1rem",marginRight:"0.5rem"}}),"Optimizing..."]}):`🗺️ Optimize ${O.geocoded} Address${O.geocoded>1?"es":""}`})]}),n.length>0&&u.jsxs("div",{style:{background:"var(--surface)",borderRadius:"var(--radius-lg)",padding:"1.5rem",marginBottom:"1rem",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",gap:"0.5rem",flexWrap:"wrap"},children:[u.jsx("h3",{style:{margin:0,fontSize:"1.125rem",color:"var(--text-primary)"},children:A&&!A.error&&A.optimizedOrder.length>0?"📍 Optimized Route":`Addresses (${n.length})`}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[O.needsGeocoding>0&&u.jsx("button",{className:"btn btn-primary btn-sm",onClick:ce,disabled:p,style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem",whiteSpace:"nowrap"},children:p?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"spinner",style:{display:"inline-block",width:"0.875rem",height:"0.875rem",marginRight:"0.25rem"}}),"Geocoding..."]}):`🌍 Geocode ${O.needsGeocoding}`}),y!==null&&u.jsxs("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.25rem 0.75rem",borderRadius:"var(--radius-md)",fontSize:"0.75rem",fontWeight:"600"},children:["🏠 Start: #",y+1]})]})]}),u.jsxs("div",{style:{display:"flex",justifyContent:"space-around",gap:"0.5rem",padding:"0.75rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)",fontSize:"0.75rem"},children:[u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--primary)"},children:O.total}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Total"})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--success)"},children:O.geocoded}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Ready"})]}),u.jsxs("div",{style:{textAlign:"center"},children:[u.jsx("div",{style:{fontWeight:"bold",fontSize:"1rem",color:"var(--warning)"},children:O.needsGeocoding}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.6875rem"},children:"Pending"})]})]})]}),P&&u.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--primary-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--primary)"},children:[u.jsxs("div",{style:{marginBottom:"0.5rem",fontWeight:"600",color:"var(--primary)",fontSize:"0.875rem"},children:["Geocoding ",P.completed," of ",P.total]}),u.jsx("div",{style:{background:"var(--gray-200)",borderRadius:"999px",height:"0.375rem",overflow:"hidden"},children:u.jsx("div",{style:{background:"var(--primary)",height:"100%",width:`${P.completed/P.total*100}%`,transition:"width 0.3s ease",borderRadius:"999px"}})})]}),u.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",margin:"0 -1.5rem",padding:"0 1.5rem"},children:[...n].sort((F,M)=>!F.success&&M.success?-1:F.success&&!M.success?1:0).map(F=>{const M=n.indexOf(F);return u.jsxs("div",{style:{padding:"1rem",borderBottom:M<n.length-1?"1px solid var(--border-light)":"none",display:"flex",alignItems:"flex-start",gap:"0.75rem",background:M===y?"var(--primary-light)":"transparent",borderRadius:"var(--radius-md)",marginBottom:M<n.length-1?"0.5rem":"0"},children:[u.jsx("div",{style:{minWidth:"2rem",height:"2rem",borderRadius:"50%",background:M===y?"var(--primary)":F.success?"var(--success)":"var(--warning)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.875rem",fontWeight:"bold",flexShrink:0,cursor:"pointer",border:M===y?"2px solid white":"none"},onClick:()=>{_(M===y?null:M)},title:M===y?"Starting Point (click to clear)":"Click to set as starting point",children:M===y?"🏠":M+1}),u.jsxs("div",{style:{flex:1,minWidth:0},children:[u.jsx("input",{name:`address-${M}`,type:"text",value:F.address,onChange:ie=>re(M,ie.target.value),className:"input",style:{width:"100%",marginBottom:"0.5rem",fontSize:"0.9375rem",padding:"0.5rem",border:"1px solid var(--border)"}}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",lineHeight:"1.4"},children:F.success?u.jsxs(u.Fragment,{children:[u.jsx("span",{style:{color:"var(--success)"},children:"✓"})," ",F.formattedAddress||F.address,F.confidence&&u.jsx("span",{style:{display:"inline-block",marginLeft:"0.5rem",padding:"0.125rem 0.5rem",borderRadius:"999px",background:F.confidence>=.8?"var(--success-light)":F.confidence>=.5?"var(--warning-light)":"var(--danger-light)",color:F.confidence>=.8?"var(--success-dark)":F.confidence>=.5?"var(--warning-dark)":"var(--danger-dark)",fontSize:"0.75rem",fontWeight:"600"},children:P_(F.confidence)})]}):u.jsxs("span",{style:{color:"var(--warning)"},children:["⚠️ ",F.error]})}),!F.success&&u.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem",alignItems:"center"},children:[u.jsx("input",{type:"number",step:"any",placeholder:"Latitude",value:F.lat??"",onChange:ie=>{const Y=ie.target.value?parseFloat(ie.target.value):void 0;he(M,Y,F.lng)},className:"input",style:{flex:1,fontSize:"0.75rem",padding:"0.375rem 0.5rem",border:"1px solid var(--border)"}}),u.jsx("input",{type:"number",step:"any",placeholder:"Longitude",value:F.lng??"",onChange:ie=>{const Y=ie.target.value?parseFloat(ie.target.value):void 0;he(M,F.lat,Y)},className:"input",style:{flex:1,fontSize:"0.75rem",padding:"0.375rem 0.5rem",border:"1px solid var(--border)"}})]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.25rem",flexShrink:0},children:[!F.success&&u.jsx("button",{className:"btn btn-primary btn-sm",onClick:()=>ye(M),title:"Geocode this address",style:{padding:"0.5rem 0.75rem",fontSize:"0.875rem",minWidth:"auto"},children:"🌍"}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>ee(M),title:"Remove",style:{padding:"0.5rem",minWidth:"auto",fontSize:"1.125rem"},children:"✕"})]})]},M)})})]}),n.length>0&&u.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginBottom:"1rem"},children:[u.jsx("button",{className:"btn btn-success",onClick:je,style:{flex:1,padding:"0.875rem",fontSize:"1rem",fontWeight:"600"},children:"📤 Export to Main List"}),u.jsx("button",{className:"btn btn-ghost",onClick:fe,style:{padding:"0.875rem",fontSize:"1rem"},children:"🗑️"})]}),n.length===0&&u.jsxs("div",{style:{textAlign:"center",padding:"3rem 1.5rem",background:"var(--surface)",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-sm)",border:"1px solid var(--border-light)"},children:[u.jsx("div",{style:{fontSize:"4rem",marginBottom:"1rem"},children:"🗺️"}),u.jsx("h3",{style:{margin:"0 0 0.5rem 0",color:"var(--text-primary)"},children:"Start Planning Your Route"}),u.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1.5rem",fontSize:"0.9375rem"},children:"Import addresses from Excel or add them manually"})]})]})})};function kL(){return u.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"var(--gray-100)",border:"1px solid var(--gray-200)",borderRadius:"var(--radius-md)",boxShadow:"var(--shadow-sm)",color:"var(--gray-800)"},children:[u.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:"🗺️"}),u.jsx("h2",{children:"Route Planning"}),u.jsx("p",{style:{marginBottom:"1.5rem",color:"var(--gray-500)"},children:"Plan your daily routes with intelligent address geocoding and route optimization."}),u.jsx("div",{style:{marginBottom:"1.5rem"},children:u.jsx("span",{style:{background:"var(--primary-light)",color:"var(--primary)",padding:"0.5rem 1rem",borderRadius:"var(--radius-md)",fontSize:"0.875rem"},children:"Premium Feature"})}),u.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--gray-500)",textAlign:"left",maxWidth:"400px",margin:"0 auto"},children:[u.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Import addresses from Excel"}),u.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Google-style address autocomplete"}),u.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Automatic geocoding with confidence scores"}),u.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Intelligent route optimization"}),u.jsx("div",{style:{marginBottom:"0.5rem"},children:"✅ Manual address correction"}),u.jsx("div",{children:"✅ Export to main address list"})]})]})}const SL=Z.memo(bL);function TL({onSetupComplete:e,onSkip:t,isOpen:r}){const[n,a]=rr.useState(""),[s,l]=rr.useState(""),[d,m]=rr.useState(!1),[p,g]=rr.useState("idle"),[y,_]=rr.useState("");if(!r)return null;const T=async()=>{if(!n||!s){_("Please enter both URL and key");return}m(!0),g("idle"),_("");try{if(!new URL(n).hostname.includes("supabase"))throw new Error("URL should be a Supabase project URL (e.g., https://your-project.supabase.co)");const E=l_(n,s),{data:P,error:D}=await E.auth.getSession();if(D&&D.message!=="Auth session missing!")throw D;g("success"),le.info("Supabase connection test successful")}catch(w){g("error"),_(w.message||"Connection failed"),le.error("Supabase connection test failed:",w)}finally{m(!1)}},S=()=>{p==="success"&&e(n,s)};return u.jsxs("div",{className:"modal-overlay",children:[u.jsxs("div",{className:"modal-content",style:{maxWidth:"600px"},children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{children:"📁 Optional: Connect Your Own Cloud Storage"}),u.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem"},children:"Set up your own Supabase project for cloud backup and sync (completely optional)"})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--blue-50)",borderRadius:"var(--radius-md)",border:"1px solid var(--blue-200)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem",color:"var(--blue-700)"},children:"📋 Quick Setup Instructions"}),u.jsxs("ol",{style:{margin:0,paddingLeft:"1.2rem",color:"var(--blue-600)",fontSize:"0.9rem"},children:[u.jsxs("li",{children:["Go to ",u.jsx("a",{href:"https://supabase.com",target:"_blank",rel:"noopener",children:"supabase.com"})," and create a free account"]}),u.jsx("li",{children:"Create a new project (choose any name/region)"}),u.jsx("li",{children:"Go to Settings → API in your project dashboard"}),u.jsx("li",{children:"Copy your Project URL and anon/public key below"})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"supabase-url",children:"Project URL *"}),u.jsx("input",{id:"supabase-url",type:"url",value:n,onChange:w=>a(w.target.value),placeholder:"https://your-project-id.supabase.co",style:{fontFamily:"monospace"}})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"supabase-key",children:"Anonymous/Public Key *"}),u.jsx("textarea",{id:"supabase-key",value:s,onChange:w=>l(w.target.value),placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",rows:3,style:{fontFamily:"monospace",fontSize:"0.85rem"}})]}),p==="success"&&u.jsx("div",{style:{padding:"0.75rem",background:"var(--green-50)",border:"1px solid var(--green-200)",borderRadius:"var(--radius-md)",color:"var(--green-700)"},children:"✅ Connection successful! Your Supabase project is ready."}),p==="error"&&u.jsxs("div",{style:{padding:"0.75rem",background:"var(--red-50)",border:"1px solid var(--red-200)",borderRadius:"var(--radius-md)",color:"var(--red-700)"},children:["❌ ",y]}),u.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"var(--gray-50)",borderRadius:"var(--radius-md)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem"},children:"🔒 Privacy & Security"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--gray-600)"},children:[u.jsx("li",{children:"Your credentials are stored locally in your browser only"}),u.jsx("li",{children:"All data goes directly to YOUR Supabase project"}),u.jsx("li",{children:"We never see or access your data"}),u.jsx("li",{children:"You can disconnect at any time"})]})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Skip (Use Offline Only)"}),u.jsx("button",{className:"btn btn-primary",onClick:T,disabled:!n||!s||d,children:d?"🔄 Testing...":"🧪 Test Connection"}),u.jsx("button",{className:"btn btn-success",onClick:S,disabled:p!=="success",children:"✅ Save & Connect"})]})]}),u.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: white;
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
          flex-wrap: wrap;
        }

        .form-group {
          margin-bottom: 1rem;
        }

        .form-group label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: var(--text-primary);
        }

        .form-group input,
        .form-group textarea {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid var(--border);
          border-radius: var(--radius-md);
          font-size: 0.9rem;
        }

        .form-group input:focus,
        .form-group textarea:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 3px var(--primary-light);
        }

        @media (max-width: 640px) {
          .modal-footer {
            flex-direction: column;
          }

          .modal-footer button {
            width: 100%;
          }
        }
      `})]})}class ni{static BACKUP_KEY="navigator_local_backups";static MAX_BACKUPS=10;static downloadBackup(t,r){try{const n=new Date().toISOString().replace(/[:.]/g,"-"),a=r||`navigator-backup-${n}.json`,s=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),l=URL.createObjectURL(s),d=document.createElement("a");d.href=l,d.download=a,document.body.appendChild(d),d.click();try{d.parentNode===document.body&&document.body.removeChild(d)}catch(m){le.warn("Non-critical DOM cleanup error during backup download:",m)}URL.revokeObjectURL(l),le.info(`Backup downloaded: ${a} (${s.size} bytes)`)}catch(n){throw le.error("Failed to download backup:",n),n}}static storeLocalBackup(t){try{const r=this.getLocalBackups(),a={timestamp:new Date().toISOString(),data:t,size:JSON.stringify(t).length,version:t._schemaVersion||1};r.unshift(a);const s=r.slice(0,this.MAX_BACKUPS);localStorage.setItem(this.BACKUP_KEY,JSON.stringify(s)),le.info(`Local backup stored (${s.length}/${this.MAX_BACKUPS})`)}catch(r){le.error("Failed to store local backup:",r)}}static getLocalBackups(){try{const t=localStorage.getItem(this.BACKUP_KEY);return t?JSON.parse(t):[]}catch(t){return le.error("Failed to get local backups:",t),[]}}static restoreFromLocalBackup(t){const r=this.getLocalBackups();if(t<0||t>=r.length)throw new Error("Invalid backup index");return r[t].data}static async getStorageUsage(){if("storage"in navigator&&"estimate"in navigator.storage)try{const t=await navigator.storage.estimate(),r=t.usage||0,n=t.quota||0,a=n>0?r/n*100:0;return{used:r,quota:n,percentage:a}}catch(t){le.warn("Failed to get storage estimate:",t)}return{used:0,quota:0,percentage:0}}static async isStorageLow(){const{percentage:t}=await this.getStorageUsage();return t>80}static createComprehensiveBackup(t){return{version:"1.0",created:new Date().toISOString(),platform:navigator.platform,userAgent:navigator.userAgent.substring(0,100),app:{name:"Navigator Web",version:"1.0.0"},data:t,checksum:qo(t)}}static verifyBackup(t){try{return!t.data||!t.checksum?!1:qo(t.data)===t.checksum}catch(r){return le.error("Backup verification failed:",r),!1}}static async performCriticalBackup(t,r){try{if(le.info(`Performing critical backup: ${r}`),this.storeLocalBackup(t),this.shouldDownloadBackup(r)){const s=this.createComprehensiveBackup(t);this.downloadBackup(s,`navigator-critical-${r}-${Date.now()}.json`),le.info(`Backup file downloaded for critical event: ${r}`)}await this.isStorageLow()&&le.warn("Browser storage is running low!")}catch(n){throw le.error("Critical backup failed:",n),n}}static shouldDownloadBackup(t){return["manual","import","day-end","restore","data-loss-risk"].includes(t)}static cleanupOldBackups(){try{const t=this.getLocalBackups(),r=new Date;r.setDate(r.getDate()-30);const n=t.filter(a=>new Date(a.timestamp)>r);n.length!==t.length&&(localStorage.setItem(this.BACKUP_KEY,JSON.stringify(n)),le.info(`Cleaned up ${t.length-n.length} old backups`))}catch(t){le.error("Failed to cleanup old backups:",t)}}static getBackupStats(){const t=this.getLocalBackups(),r=t.reduce((s,l)=>s+(l.size||0),0),n=t.length>0?t[t.length-1].timestamp:null,a=t.length>0?t[0].timestamp:null;return{count:t.length,totalSize:r,oldestDate:n,newestDate:a}}}function EL({currentData:e,onRestore:t,isOpen:r,onClose:n}){const[a,s]=rr.useState([]),[l,d]=rr.useState({used:0,quota:0,percentage:0}),[m,p]=rr.useState(!1);rr.useEffect(()=>{r&&(g(),y())},[r]);const g=()=>{try{const D=ni.getLocalBackups();s(D)}catch(D){le.error("Failed to load backups:",D)}},y=async()=>{try{const D=await ni.getStorageUsage();d(D)}catch(D){le.error("Failed to load storage usage:",D)}},_=async()=>{p(!0);try{await ni.performCriticalBackup(e,"manual"),g(),le.info("Manual backup created successfully")}catch(D){le.error("Failed to create manual backup:",D)}finally{p(!1)}},T=D=>{try{const A=ni.restoreFromLocalBackup(D);t(A),n()}catch(A){le.error("Failed to restore from backup:",A)}},S=(D,A)=>{try{const H=new Date(D.timestamp).toISOString().replace(/[:.]/g,"-");ni.downloadBackup(D.data,`navigator-backup-${H}.json`)}catch(H){le.error("Failed to download backup:",H)}},w=D=>{if(D===0)return"0 B";const A=1024,H=["B","KB","MB","GB"],J=Math.floor(Math.log(D)/Math.log(A));return parseFloat((D/Math.pow(A,J)).toFixed(1))+" "+H[J]},E=D=>new Date(D).toLocaleString(),P=D=>D>80?"var(--danger)":D>60?"var(--warning)":"var(--success)";return r?u.jsxs("div",{className:"modal-overlay",children:[u.jsxs("div",{className:"modal-content",style:{maxWidth:"800px"},children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{children:"💾 Backup Manager"}),u.jsx("p",{style:{margin:"0.5rem 0 0",opacity:.8,fontSize:"0.9rem",color:"var(--text-primary)"},children:"Local backups are automatically created and downloaded to prevent data loss"})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"var(--radius-md)"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:"📊 Storage Usage"}),u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"0.5rem"},children:[u.jsx("div",{style:{flex:1,height:"8px",background:"var(--gray-200)",borderRadius:"4px",overflow:"hidden"},children:u.jsx("div",{style:{height:"100%",background:P(l.percentage),width:`${Math.min(l.percentage,100)}%`,transition:"width 0.3s ease"}})}),u.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--text-muted)",minWidth:"60px"},children:[l.percentage.toFixed(1),"%"]})]}),u.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:[w(l.used)," of ",w(l.quota)," used",l.percentage>80&&u.jsx("span",{style:{color:"var(--danger)",fontWeight:500,marginLeft:"0.5rem"},children:"⚠️ Storage running low!"})]})]}),u.jsxs("div",{style:{marginBottom:"1.5rem",padding:"1rem",background:"var(--info-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--info)"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.95rem",color:"var(--info-dark)"},children:"📁 Create Manual Backup"}),u.jsx("p",{style:{margin:"0 0 1rem",fontSize:"0.85rem",color:"var(--info-dark)"},children:"Create an immediate backup and download it to your computer for safekeeping."}),u.jsx("button",{className:"btn btn-primary",onClick:_,disabled:m,children:m?"📦 Creating...":"📦 Create & Download Backup"})]}),u.jsxs("div",{children:[u.jsxs("h4",{style:{margin:"0 0 1rem",fontSize:"0.95rem",color:"var(--text-primary)"},children:["📚 Local Backups (",a.length,")"]}),a.length===0?u.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"No local backups found. Create your first backup above!"}):u.jsx("div",{style:{maxHeight:"300px",overflow:"auto"},children:a.map((D,A)=>u.jsx("div",{style:{padding:"1rem",border:"1px solid var(--border-light)",borderRadius:"var(--radius-md)",marginBottom:"0.5rem",background:"var(--surface)"},children:u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[u.jsxs("div",{children:[u.jsx("div",{style:{fontWeight:500,fontSize:"0.9rem",color:"var(--text-primary)"},children:E(D.timestamp)}),u.jsxs("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:["Size: ",w(D.size||0)," • Version: ",D.version||1]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>S(D),title:"Download backup file",children:"📥"}),u.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>T(A),title:"Restore from this backup",children:"🔄 Restore"})]})]})},A))})]}),u.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"var(--success-light)",borderRadius:"var(--radius-md)",border:"1px solid var(--success)"},children:[u.jsx("h4",{style:{margin:"0 0 0.5rem",fontSize:"0.9rem",color:"var(--success-dark)"},children:"✅ Data Protection Features"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.2rem",fontSize:"0.85rem",color:"var(--success-dark)"},children:[u.jsx("li",{children:"Automatic backups every 5 minutes when data changes"}),u.jsx("li",{children:"Critical backups downloaded after completions"}),u.jsx("li",{children:"Local browser storage with 10 backup rotation"}),u.jsx("li",{children:"Storage monitoring and cleanup"}),u.jsx("li",{children:"Data integrity verification"})]})]})]}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{className:"btn btn-secondary",onClick:n,children:"Close"})})]}),u.jsx("style",{children:`
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.7);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 2000;
          padding: 1rem;
        }

        .modal-content {
          background: var(--surface);
          border-radius: var(--radius-lg);
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: var(--shadow-2xl);
          border: 1px solid var(--border-light);
          width: 100%;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 1rem;
          border-bottom: 1px solid var(--border-light);
        }

        .modal-header h2 {
          margin: 0 0 0.5rem;
          color: var(--text-primary);
          font-size: 1.25rem;
          font-weight: 600;
        }

        .modal-body {
          padding: 1.5rem;
        }

        .modal-footer {
          padding: 1rem 1.5rem;
          border-top: 1px solid var(--border-light);
          display: flex;
          gap: 1rem;
          justify-content: flex-end;
        }

        .btn-sm {
          padding: 0.375rem 0.75rem;
          font-size: 0.8rem;
        }
      `})]}):null}function CL({settings:e,onUpdateSettings:t,onClose:r}){const[n,a]=Z.useState(e),[s,l]=Z.useState("templates"),[d,m]=Z.useState(null),[p,g]=Z.useState(""),[y,_]=Z.useState(!1),[T,S]=Z.useState(!1),w=async()=>{S(!0);try{if(!n.agentProfile.name.trim()){alert("Agent name is required");return}if(!n.agentProfile.signature.trim()){alert("Agent signature is required");return}if(n.messageTemplates.length===0){a(B=>({...B,messageTemplates:zy,activeTemplateId:"professional_standard"}));return}await t(n),r()}catch(B){console.error("Failed to save settings:",B),alert("Failed to save settings. Please try again.")}finally{S(!1)}},E=B=>{a(I=>({...I,agentProfile:{...I.agentProfile,...B}}))},P=(B,I)=>{a(ee=>({...ee,messageTemplates:ee.messageTemplates.map(re=>re.id===B?{...re,...I}:re)}))},D=()=>{const B={id:`custom_${Date.now()}`,name:"New Custom Template",template:"{greeting}Payment Reminder\\n\\n{refLine}Your payment is due {date}{time}.\\n\\nAmount: £{amount}\\n\\n[Your custom message here]\\n\\n{signature}{contactInfo}",variables:["greeting","refLine","date","time","amount","signature","contactInfo","customerName","referenceNumber","agentName","agentTitle"]};a(I=>({...I,messageTemplates:[...I.messageTemplates,B]})),m(B.id)},A=B=>{if(n.messageTemplates.length<=1){alert("You must have at least one message template");return}a(I=>{const ee=I.messageTemplates.filter(ye=>ye.id!==B),re=I.activeTemplateId===B?ee[0]?.id||"professional_standard":I.activeTemplateId;return{...I,messageTemplates:ee,activeTemplateId:re}})},H=()=>{try{const B={id:"preview",addressIndex:0,address:"123 Sample Street, London",customerName:"123456789 Smith",phoneNumber:"07123456789",scheduledDate:new Date(Date.now()+864e5).toISOString().slice(0,10),scheduledTime:"14:00",status:"Scheduled",amount:"125.00",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},I={id:"preview",arrangementId:"preview",type:"payment_due",scheduledDate:new Date().toISOString(),status:"pending",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},ee=Uy(B,I,n);g(ee),_(!0)}catch(B){console.error("Preview failed:",B),alert("Failed to generate preview. Please check your template.")}},J=(B,I)=>{a(ee=>({...ee,customizableSchedule:{...ee.customizableSchedule,[B]:I}}))};return u.jsxs("div",{className:"modal-backdrop",onClick:B=>B.target===B.currentTarget&&r(),children:[u.jsxs("div",{className:"modal-content",style:{maxWidth:"800px",width:"90vw",maxHeight:"90vh",overflow:"auto"},children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{style:{margin:0},children:"⚙️ Reminder Settings"}),u.jsx("button",{className:"btn btn-ghost",onClick:r,children:"✕"})]}),u.jsxs("div",{className:"modal-body",children:[u.jsxs("div",{className:"btn-group",style:{marginBottom:"1.5rem"},children:[u.jsx("button",{className:`btn ${s==="profile"?"btn-primary":"btn-ghost"}`,onClick:()=>l("profile"),children:"👤 Agent Profile"}),u.jsx("button",{className:`btn ${s==="templates"?"btn-primary":"btn-ghost"}`,onClick:()=>l("templates"),children:"📝 Message Templates"}),u.jsx("button",{className:`btn ${s==="schedule"?"btn-primary":"btn-ghost"}`,onClick:()=>l("schedule"),children:"📅 Schedule Settings"})]}),s==="profile"&&u.jsxs("div",{className:"settings-tab",children:[u.jsx("h3",{children:"Agent Profile Information"}),u.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"This information will be used in your reminder messages and signature."}),u.jsxs("div",{className:"form-grid",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"agent-name",children:"👤 Agent Name *"}),u.jsx("input",{id:"agent-name",name:"agentName",type:"text",value:n.agentProfile.name,onChange:B=>E({name:B.target.value}),className:"input",placeholder:"Enter your full name",required:!0})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"agent-title",children:"🏷️ Job Title *"}),u.jsxs("select",{id:"agent-title",name:"agentTitle",value:n.agentProfile.title,onChange:B=>E({title:B.target.value}),className:"input",children:[u.jsx("option",{value:"Enforcement Agent",children:"Enforcement Agent"}),u.jsx("option",{value:"Bailiff",children:"Bailiff"}),u.jsx("option",{value:"Recovery Officer",children:"Recovery Officer"}),u.jsx("option",{value:"Collection Agent",children:"Collection Agent"}),u.jsx("option",{value:"Senior Enforcement Agent",children:"Senior Enforcement Agent"}),u.jsx("option",{value:"Lead Bailiff",children:"Lead Bailiff"})]})]}),u.jsxs("div",{className:"form-group form-group-full",children:[u.jsx("label",{htmlFor:"agent-signature",children:"✍️ Message Signature *"}),u.jsx("input",{id:"agent-signature",name:"agentSignature",type:"text",value:n.agentProfile.signature,onChange:B=>E({signature:B.target.value}),className:"input",placeholder:"e.g., Enforcement Agent J. Smith",required:!0}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"This will appear at the end of your reminder messages"})]}),u.jsxs("div",{className:"form-group form-group-full",children:[u.jsx("label",{htmlFor:"agent-contact-info",children:"📞 Contact Information (Optional)"}),u.jsx("input",{id:"agent-contact-info",name:"agentContactInfo",type:"text",value:n.agentProfile.contactInfo||"",onChange:B=>E({contactInfo:B.target.value}),className:"input",placeholder:"e.g., Tel: 01234 567890"}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:"Additional contact information to include in messages"})]})]})]}),s==="templates"&&u.jsxs("div",{className:"settings-tab",children:[u.jsxs("div",{style:{marginBottom:"1.5rem"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[u.jsx("h3",{children:"Message Templates"}),u.jsxs("div",{children:[u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:H,children:"👁️ Preview"}),u.jsx("button",{className:"btn btn-success btn-sm",onClick:D,children:"➕ Add Template"})]})]}),u.jsxs("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",margin:0},children:["Create and customize SMS reminder messages. Use variables to automatically insert customer and payment details.",u.jsx("br",{}),u.jsx("strong",{children:"💡 Click the ✏️ Edit button next to any template to see the enhanced editor with variable reference panel."})]})]}),u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:"active-template",children:"Active Template"}),u.jsx("select",{id:"active-template",name:"activeTemplate",value:n.activeTemplateId,onChange:B=>a(I=>({...I,activeTemplateId:B.target.value})),className:"input",children:n.messageTemplates.map(B=>u.jsx("option",{value:B.id,children:B.name},B.id))})]}),u.jsx("div",{className:"templates-list",children:n.messageTemplates.map(B=>u.jsxs("div",{className:"template-item",children:[u.jsxs("div",{className:"template-header",children:[u.jsxs("div",{children:[u.jsx("strong",{children:B.name}),B.id===n.activeTemplateId&&u.jsx("span",{className:"pill",style:{backgroundColor:"var(--success)15",color:"var(--success)",marginLeft:"0.5rem"},children:"Active"})]}),u.jsxs("div",{children:[u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>m(d===B.id?null:B.id),children:d===B.id?"👁️":"✏️"}),B.id.startsWith("custom_")&&u.jsx("button",{className:"btn btn-danger btn-sm",onClick:()=>A(B.id),children:"🗑️"})]})]}),d===B.id&&u.jsxs("div",{className:"template-editor",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:`template-name-${B.id}`,children:"Template Name"}),u.jsx("input",{id:`template-name-${B.id}`,name:`templateName-${B.id}`,type:"text",value:B.name,onChange:I=>P(B.id,{name:I.target.value}),className:"input"})]}),u.jsxs("div",{className:"template-editor-layout",children:[u.jsxs("div",{className:"form-group",children:[u.jsx("label",{htmlFor:`template-content-${B.id}`,children:"Message Template"}),u.jsx("textarea",{id:`template-content-${B.id}`,name:`templateContent-${B.id}`,value:B.template,onChange:I=>P(B.id,{template:I.target.value}),className:"input",rows:12,style:{fontFamily:"monospace",fontSize:"0.875rem"}}),u.jsxs("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.25rem"},children:["Use variables like ","{greeting}"," and ","{amount}"," - see reference panel →"]})]}),u.jsxs("div",{className:"variable-reference-panel",children:[u.jsx("h4",{style:{margin:"0 0 0.75rem",fontSize:"0.875rem",color:"var(--text-primary)"},children:"📋 Available Variables"}),u.jsxs("div",{className:"variable-group",children:[u.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Customer Info"}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{greeting}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Smart greeting: "Mr/Mrs Smith, "'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{refLine}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Reference line: "Reference: 123456789\\\\n\\\\n"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{customerName}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full name: "123456789 Smith"'})]})]}),u.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[u.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Payment Details"}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{amount}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Payment amount: "125.00"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{date}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Due date: "15/01/2025"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{time}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Time (if set): " at 14:00"'})]})]}),u.jsxs("div",{className:"variable-group",style:{marginTop:"1rem"},children:[u.jsx("h5",{style:{margin:"0 0 0.5rem",fontSize:"0.8125rem",color:"var(--primary)"},children:"Agent Info"}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{signature}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Full signature: "Enforcement Agent J. Smith"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentName}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Name only: "J. Smith"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{agentTitle}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Job title: "Enforcement Agent"'})]}),u.jsxs("div",{className:"variable-item",style:{marginBottom:"0.5rem"},children:[u.jsx("code",{style:{color:"var(--primary)",fontWeight:600},children:"{contactInfo}"}),u.jsx("div",{style:{color:"var(--text-muted)",fontSize:"0.75rem"},children:'Contact: "Tel: 01234 567890"'})]})]}),u.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",backgroundColor:"var(--blue-50)",borderRadius:"var(--radius-sm)",border:"1px solid var(--blue-200)"},children:[u.jsx("div",{style:{fontSize:"0.75rem",color:"var(--blue-700)",fontWeight:600,marginBottom:"0.25rem"},children:"💡 Tips:"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1rem",fontSize:"0.75rem",color:"var(--blue-600)"},children:[u.jsx("li",{children:"Use \\\\n for line breaks"}),u.jsx("li",{children:"Variables are case-sensitive"}),u.jsx("li",{children:"Preview to test your template"}),u.jsx("li",{children:"Empty variables won't show"})]})]})]})]})]})]},B.id))})]}),s==="schedule"&&u.jsxs("div",{className:"settings-tab",children:[u.jsx("h3",{children:"Reminder Schedule"}),u.jsx("p",{style:{color:"var(--text-muted)",marginBottom:"1rem"},children:"Choose when reminder notifications should be sent before payment due dates."}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"globalEnabled",type:"checkbox",checked:n.globalEnabled,onChange:B=>a(I=>({...I,globalEnabled:B.target.checked}))}),"Enable automatic reminders"]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"smsEnabled",type:"checkbox",checked:n.smsEnabled,onChange:B=>a(I=>({...I,smsEnabled:B.target.checked})),disabled:!n.globalEnabled}),"Enable SMS reminders"]})}),u.jsx("hr",{style:{margin:"1.5rem 0"}}),u.jsx("h4",{children:"Reminder Timing"}),u.jsxs("div",{className:"schedule-options",children:[u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"threeDayReminder",type:"checkbox",checked:n.customizableSchedule.threeDayReminder,onChange:B=>J("threeDayReminder",B.target.checked),disabled:!n.globalEnabled}),"Send reminder 3 days before payment due"]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"oneDayReminder",type:"checkbox",checked:n.customizableSchedule.oneDayReminder,onChange:B=>J("oneDayReminder",B.target.checked),disabled:!n.globalEnabled}),"Send reminder 1 day before payment due"]})}),u.jsx("div",{className:"form-group",children:u.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[u.jsx("input",{name:"dayOfReminder",type:"checkbox",checked:n.customizableSchedule.dayOfReminder,onChange:B=>J("dayOfReminder",B.target.checked),disabled:!n.globalEnabled}),"Send reminder on payment due date"]})})]}),u.jsxs("div",{className:"custom-days-section",children:[u.jsx("h4",{children:"Custom Reminder Days"}),u.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginBottom:"1rem"},children:"Add additional reminder days (e.g., 7 for weekly, 14 for bi-weekly)"}),u.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginBottom:"1rem"},children:n.customizableSchedule.customDays.map((B,I)=>u.jsxs("span",{className:"pill",style:{backgroundColor:"var(--primary)15",color:"var(--primary)",display:"flex",alignItems:"center",gap:"0.25rem"},children:[B," days before",u.jsx("button",{onClick:()=>{const ee=[...n.customizableSchedule.customDays];ee.splice(I,1),J("customDays",ee)},style:{background:"none",border:"none",color:"inherit",cursor:"pointer",padding:"0 0.25rem"},children:"✕"})]},I))}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[u.jsx("input",{name:"customDayInput",type:"number",min:"1",max:"365",placeholder:"Days before",className:"input",style:{width:"120px"},onKeyPress:B=>{if(B.key==="Enter"){const I=B.target,ee=parseInt(I.value);ee&&ee>0&&!n.customizableSchedule.customDays.includes(ee)&&(J("customDays",[...n.customizableSchedule.customDays,ee]),I.value="")}}}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:B=>{const I=B.target.parentElement?.querySelector("input"),ee=parseInt(I.value);ee&&ee>0&&!n.customizableSchedule.customDays.includes(ee)&&(J("customDays",[...n.customizableSchedule.customDays,ee]),I.value="")},children:"➕ Add"})]})]})]})]}),u.jsxs("div",{className:"modal-footer",children:[u.jsx("button",{className:"btn btn-ghost",onClick:r,children:"Cancel"}),u.jsx(is,{className:"btn btn-primary",onClick:w,isLoading:T,loadingText:"Saving...",children:"💾 Save Settings"})]})]}),y&&u.jsx("div",{className:"modal-backdrop",onClick:()=>_(!1),children:u.jsxs("div",{className:"modal-content",onClick:B=>B.stopPropagation(),children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h3",{style:{margin:0},children:"📱 Message Preview"}),u.jsx("button",{className:"btn btn-ghost",onClick:()=>_(!1),children:"✕"})]}),u.jsxs("div",{className:"modal-body",children:[u.jsx("div",{style:{padding:"1rem",backgroundColor:"var(--surface)",border:"1px solid var(--border-light)",borderRadius:"var(--radius)",fontFamily:"monospace",fontSize:"0.875rem",whiteSpace:"pre-wrap",lineHeight:1.5},children:p}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"This is how your message will appear when sent to customers."})]}),u.jsx("div",{className:"modal-footer",children:u.jsx("button",{className:"btn btn-primary",onClick:()=>_(!1),children:"Close Preview"})})]})}),u.jsx("style",{children:`
        /* Modal Backdrop */
        .modal-backdrop {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 1000;
          padding: 1rem;
        }

        /* Modal Content */
        .modal-content {
          background: white;
          border-radius: var(--radius-lg, 12px);
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
          max-width: 900px;
          width: 95vw;
          max-height: 95vh;
          overflow: hidden;
          display: flex;
          flex-direction: column;
        }

        @media (max-width: 480px) {
          .modal-content {
            width: 98vw;
            max-height: 98vh;
            border-radius: var(--radius-md, 8px);
            margin: 0 0.5rem;
          }
        }

        /* Modal Header */
        .modal-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1.5rem 2rem;
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-header {
            padding: 1rem 1.5rem;
          }

          .modal-header h2 {
            font-size: 1.25rem;
          }
        }

        .modal-header h2 {
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--gray-900, #111827);
          margin: 0;
        }

        .modal-header .btn {
          padding: 0.5rem;
          min-width: auto;
          width: 2rem;
          height: 2rem;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 50%;
          font-size: 1rem;
        }

        /* Modal Body */
        .modal-body {
          padding: 2rem;
          overflow-y: auto;
          flex: 1;
        }

        /* Modal Footer */
        .modal-footer {
          padding: 1.5rem 2rem;
          border-top: 1px solid var(--gray-200, #e5e7eb);
          display: flex;
          justify-content: flex-end;
          gap: 1rem;
          flex-shrink: 0;
        }

        @media (max-width: 480px) {
          .modal-body {
            padding: 1.5rem;
          }

          .modal-footer {
            padding: 1rem 1.5rem;
            flex-direction: column-reverse;
            gap: 0.75rem;
          }

          .modal-footer .btn {
            width: 100%;
            justify-content: center;
          }
        }

        /* Template Editor Layout */
        .template-editor-layout {
          display: grid;
          grid-template-columns: 1fr 320px;
          gap: 1.5rem;
          min-height: 500px;
        }

        @media (max-width: 1024px) {
          .template-editor-layout {
            grid-template-columns: 1fr;
            gap: 1rem;
          }

          .variable-reference-panel {
            order: -1;
            max-height: 300px !important;
          }
        }

        /* Variable Reference Panel */
        .variable-reference-panel {
          background: var(--gray-50, #f8f9fa);
          border: 1px solid var(--gray-200, #e9ecef);
          border-radius: var(--radius-md, 8px);
          padding: 1.25rem;
          font-size: 0.875rem;
          max-height: 500px;
          overflow-y: auto;
          position: sticky;
          top: 0;
        }

        .variable-group {
          margin-bottom: 1.5rem;
        }

        .variable-group:last-child {
          margin-bottom: 0;
        }

        .variable-group h5 {
          margin: 0 0 0.75rem;
          font-size: 0.875rem;
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.025em;
        }

        .variable-item {
          margin-bottom: 0.75rem;
          padding: 0.5rem;
          background: white;
          border-radius: var(--radius-sm, 6px);
          border: 1px solid var(--gray-100, #f3f4f6);
        }

        .variable-item:last-child {
          margin-bottom: 0;
        }

        .variable-item code {
          color: var(--primary, #0ea5e9);
          font-weight: 600;
          background: var(--primary-light, #e0f2fe);
          padding: 0.25rem 0.5rem;
          border-radius: 0.25rem;
          font-size: 0.8125rem;
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .variable-item div {
          color: var(--text-muted, #6b7280);
          font-size: 0.8125rem;
          margin-top: 0.375rem;
          line-height: 1.4;
        }

        /* Form Improvements */
        .form-group {
          margin-bottom: 1.5rem;
        }

        .form-group label {
          display: block;
          font-weight: 500;
          color: var(--gray-700, #374151);
          margin-bottom: 0.5rem;
          font-size: 0.875rem;
        }

        .form-group .input {
          width: 100%;
          padding: 0.75rem 1rem;
          border: 1px solid var(--gray-300, #d1d5db);
          border-radius: var(--radius-md, 8px);
          font-size: 0.875rem;
          transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }

        .form-group .input:focus {
          outline: none;
          border-color: var(--primary, #0ea5e9);
          box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }

        .form-group textarea.input {
          font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
          line-height: 1.5;
        }

        /* Button Group */
        .btn-group {
          display: flex;
          gap: 0.5rem;
          margin-bottom: 2rem;
        }

        .btn-group .btn {
          flex: 1;
          text-align: center;
          font-size: 0.875rem;
          padding: 0.75rem 0.5rem;
        }

        /* Mobile-specific tab optimizations */
        @media (max-width: 480px) {
          .btn-group {
            gap: 0.25rem;
            margin-bottom: 1.5rem;
          }

          .btn-group .btn {
            font-size: 0.75rem;
            padding: 0.625rem 0.375rem;
            line-height: 1.2;
          }
        }

        @media (max-width: 360px) {
          .btn-group {
            flex-direction: column;
            gap: 0.5rem;
          }

          .btn-group .btn {
            flex: none;
            font-size: 0.875rem;
            padding: 0.75rem 1rem;
          }
        }

        /* Templates List */
        .templates-list {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .template-item {
          border: 1px solid var(--gray-200, #e5e7eb);
          border-radius: var(--radius-lg, 12px);
          overflow: hidden;
        }

        .template-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1rem 1.5rem;
          background: var(--gray-50, #f9fafb);
          border-bottom: 1px solid var(--gray-200, #e5e7eb);
        }

        .template-editor {
          padding: 1.5rem;
          background: white;
        }

        /* Dark Mode Support */
        .dark-mode .modal-content {
          background: var(--gray-800, #1f2937);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-header {
          border-bottom-color: var(--gray-700, #374151);
        }

        .dark-mode .modal-header h2 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .modal-footer {
          border-top-color: var(--gray-700, #374151);
        }

        /* Form Elements Dark Mode */
        .dark-mode .form-group label {
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .form-group .input {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .form-group .input:focus {
          border-color: var(--primary, #0ea5e9);
          background: var(--gray-700, #374151);
        }

        .dark-mode .form-group .input::placeholder {
          color: var(--gray-400, #9ca3af);
        }

        /* Variable Reference Panel Dark Mode */
        .dark-mode .variable-reference-panel {
          background: var(--gray-700, #374151);
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .variable-group h5 {
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item {
          background: var(--gray-800, #1f2937);
          border-color: var(--gray-600, #4b5563);
        }

        .dark-mode .variable-item code {
          background: var(--primary-dark, #0c4a6e);
          color: var(--primary-light, #38bdf8);
        }

        .dark-mode .variable-item div {
          color: var(--gray-300, #d1d5db);
        }

        /* Template Items Dark Mode */
        .dark-mode .template-item {
          border-color: var(--gray-600, #4b5563);
          background: var(--gray-800, #1f2937);
        }

        .dark-mode .template-header {
          background: var(--gray-700, #374151);
          border-bottom-color: var(--gray-600, #4b5563);
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .template-editor {
          background: var(--gray-800, #1f2937);
        }

        /* Button Group Dark Mode */
        .dark-mode .btn-group .btn {
          border-color: var(--gray-600, #4b5563);
          color: var(--gray-200, #e5e7eb);
        }

        .dark-mode .btn-group .btn.btn-primary {
          background: var(--primary, #0ea5e9);
          color: white;
        }

        .dark-mode .btn-group .btn.btn-ghost {
          background: var(--gray-700, #374151);
        }

        .dark-mode .btn-group .btn.btn-ghost:hover {
          background: var(--gray-600, #4b5563);
        }

        /* Additional Text Elements */
        .dark-mode .settings-tab h3 {
          color: var(--gray-100, #f3f4f6);
        }

        .dark-mode .settings-tab p {
          color: var(--gray-300, #d1d5db);
        }

        .dark-mode .setting-description {
          color: var(--gray-400, #9ca3af);
        }

        /* Tips Box Dark Mode */
        .dark-mode .variable-reference-panel div[style*="background: var(--blue-50)"] {
          background: var(--gray-600, #4b5563) !important;
          border-color: var(--gray-500, #6b7280) !important;
        }

        .dark-mode .variable-reference-panel div[style*="color: var(--blue-700)"] {
          color: var(--blue-300, #93c5fd) !important;
        }

        .dark-mode .variable-reference-panel ul {
          color: var(--gray-300, #d1d5db) !important;
        }

        /* Template List Dark Mode */
        .dark-mode .template-item strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .pill {
          background: var(--success-dark, #166534) !important;
          color: var(--success-light, #86efac) !important;
        }

        .dark-mode .template-header strong {
          color: var(--gray-100, #f3f4f6) !important;
        }

        .dark-mode .template-header {
          color: var(--gray-100, #f3f4f6) !important;
        }
      `})]})}function AL({settings:e,onUpdateSettings:t,onClose:r}){const[n,a]=Z.useState(e||os);Z.useEffect(()=>{a(e||os)},[e]);const s=()=>{t(n),r()},l=()=>{a(os)};return u.jsxs("div",{className:"modal-overlay",onClick:r,children:[u.jsxs("div",{className:"modal-content bonus-settings-modal",onClick:d=>d.stopPropagation(),style:{maxWidth:"700px",maxHeight:"90vh",overflow:"auto"},children:[u.jsxs("div",{className:"modal-header",children:[u.jsx("h2",{style:{margin:0},children:"⚙️ Bonus Calculation Settings"}),u.jsx("button",{className:"close-btn",onClick:r,children:"✕"})]}),u.jsxs("div",{className:"modal-body",style:{padding:"1.5rem"},children:[u.jsx("div",{className:"setting-group",children:u.jsxs("label",{className:"setting-row",children:[u.jsx("input",{type:"checkbox",checked:n.enabled,onChange:d=>a({...n,enabled:d.target.checked})}),u.jsx("span",{className:"setting-label",children:"Enable Bonus Tracking"})]})}),n.enabled&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"setting-group",children:[u.jsx("label",{className:"setting-label-main",children:"Calculation Method"}),u.jsxs("div",{className:"calc-type-grid",children:[u.jsxs("button",{className:`calc-type-btn ${n.calculationType==="simple"?"active":""}`,onClick:()=>a({...n,calculationType:"simple"}),children:[u.jsx("div",{className:"calc-type-icon",children:"📊"}),u.jsx("div",{className:"calc-type-name",children:"Simple"}),u.jsx("div",{className:"calc-type-desc",children:"£X per PIF - £Y per day"})]}),u.jsxs("button",{className:`calc-type-btn ${n.calculationType==="complex"?"active":""}`,onClick:()=>a({...n,calculationType:"complex"}),children:[u.jsx("div",{className:"calc-type-icon",children:"🧮"}),u.jsx("div",{className:"calc-type-name",children:"Complex"}),u.jsx("div",{className:"calc-type-desc",children:"TCG Regulations 2014"})]}),u.jsxs("button",{className:`calc-type-btn ${n.calculationType==="custom"?"active":""}`,onClick:()=>a({...n,calculationType:"custom"}),children:[u.jsx("div",{className:"calc-type-icon",children:"⚡"}),u.jsx("div",{className:"calc-type-name",children:"Custom"}),u.jsx("div",{className:"calc-type-desc",children:"JavaScript formula"})]})]})]}),n.calculationType==="simple"&&u.jsxs("div",{className:"setting-group",children:[u.jsx("h3",{style:{marginBottom:"1rem"},children:"Simple Calculation"}),u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"Bonus per PIF (£)"}),u.jsx("input",{type:"number",className:"input",min:"0",step:"1",value:n.simpleSettings?.pifBonus||100,onChange:d=>a({...n,simpleSettings:{...n.simpleSettings,pifBonus:parseFloat(d.target.value)||0}})})]}),u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"Daily Threshold (£)"}),u.jsx("input",{type:"number",className:"input",min:"0",step:"1",value:n.simpleSettings?.dailyThreshold||100,onChange:d=>a({...n,simpleSettings:{...n.simpleSettings,dailyThreshold:parseFloat(d.target.value)||0}})})]}),u.jsxs("div",{className:"formula-preview",children:[u.jsx("strong",{children:"Formula:"})," (PIFs × £",n.simpleSettings?.pifBonus||100,") - (Days × £",n.simpleSettings?.dailyThreshold||100,")"]})]}),n.calculationType==="complex"&&u.jsxs("div",{className:"setting-group",children:[u.jsx("h3",{style:{marginBottom:"1rem"},children:"Complex Calculation (TCG Regulations 2014)"}),u.jsxs("div",{className:"settings-grid",children:[u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"Standard PIF Bonus (£)"}),u.jsx("input",{type:"number",className:"input",min:"0",step:"1",value:n.complexSettings?.basePifBonus||100,onChange:d=>a({...n,complexSettings:{...n.complexSettings,basePifBonus:parseFloat(d.target.value)||0}})})]}),u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"Small PIF Bonus (£)"}),u.jsx("input",{type:"number",className:"input",min:"0",step:"1",value:n.complexSettings?.smallPifBonus||30,onChange:d=>a({...n,complexSettings:{...n.complexSettings,smallPifBonus:parseFloat(d.target.value)||0}})}),u.jsx("small",{children:"For debts < £100"})]}),u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"Large Debt Threshold (£)"}),u.jsx("input",{type:"number",className:"input",min:"0",step:"100",value:n.complexSettings?.largePifThreshold||1500,onChange:d=>a({...n,complexSettings:{...n.complexSettings,largePifThreshold:parseFloat(d.target.value)||0}})})]}),u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"Large PIF Max (£)"}),u.jsx("input",{type:"number",className:"input",min:"0",step:"50",value:n.complexSettings?.largePifCap||500,onChange:d=>a({...n,complexSettings:{...n.complexSettings,largePifCap:parseFloat(d.target.value)||0}})}),u.jsx("small",{children:"Maximum bonus per large PIF"})]}),u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"Linked Case Bonus (£)"}),u.jsx("input",{type:"number",className:"input",min:"0",step:"5",value:n.complexSettings?.linkedCaseBonus||10,onChange:d=>a({...n,complexSettings:{...n.complexSettings,linkedCaseBonus:parseFloat(d.target.value)||0}})}),u.jsx("small",{children:"For cases with £0 enforcement fee"})]}),u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"Daily Threshold (£)"}),u.jsx("input",{type:"number",className:"input",min:"0",step:"10",value:n.complexSettings?.dailyThreshold||100,onChange:d=>a({...n,complexSettings:{...n.complexSettings,dailyThreshold:parseFloat(d.target.value)||0}})})]})]}),u.jsxs("div",{className:"formula-preview",children:[u.jsx("strong",{children:"Formula:"}),u.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[u.jsxs("li",{children:["Standard PIF (£100-£1500): £",n.complexSettings?.basePifBonus||100]}),u.jsxs("li",{children:["Large PIF (>£1500): £",n.complexSettings?.basePifBonus||100," + 2.5% of 7.5% over £1500 (max £",n.complexSettings?.largePifCap||500,")"]}),u.jsxs("li",{children:["Small PIF (<£100): £",n.complexSettings?.smallPifBonus||30]}),u.jsxs("li",{children:["Linked cases (£0): £",n.complexSettings?.linkedCaseBonus||10]}),u.jsxs("li",{children:["Daily threshold: £",n.complexSettings?.dailyThreshold||100]})]})]})]}),n.calculationType==="custom"&&u.jsxs("div",{className:"setting-group",children:[u.jsx("h3",{style:{marginBottom:"1rem"},children:"Custom Formula"}),u.jsxs("label",{className:"setting-row-input",children:[u.jsx("span",{className:"setting-label",children:"JavaScript Expression"}),u.jsx("textarea",{className:"input",rows:5,placeholder:"(T - (75 * N + 122.5)) / 1.075",value:n.customFormula||"",onChange:d=>a({...n,customFormula:d.target.value}),style:{fontFamily:"monospace",fontSize:"0.875rem"}})]}),u.jsxs("div",{className:"formula-preview",children:[u.jsx("strong",{children:"Available variables:"}),u.jsxs("ul",{style:{marginTop:"0.5rem",paddingLeft:"1.5rem"},children:[u.jsxs("li",{children:[u.jsx("code",{children:"T"})," - Total amount collected (£)"]}),u.jsxs("li",{children:[u.jsx("code",{children:"N"})," - Number of cases"]}),u.jsxs("li",{children:[u.jsx("code",{children:"D"})," - Calculated debt amount (£)"]}),u.jsxs("li",{children:[u.jsx("code",{children:"days"})," - Working days"]})]}),u.jsxs("div",{style:{marginTop:"0.5rem",fontSize:"0.875rem",color:"var(--text-muted)"},children:["Example: ",u.jsx("code",{children:"(T - (75 * N + 122.5)) / 1.075 * 0.1"})]})]})]}),u.jsxs("div",{className:"setting-group",children:[u.jsx("h3",{style:{marginBottom:"1rem"},children:"Additional Options"}),u.jsxs("label",{className:"setting-row",children:[u.jsx("input",{type:"checkbox",checked:n.adjustForWorkingDays,onChange:d=>a({...n,adjustForWorkingDays:d.target.checked})}),u.jsxs("span",{className:"setting-label",children:["Adjust for Working Days",u.jsx("small",{style:{display:"block",marginTop:"0.25rem"},children:"Calculate threshold based on actual days worked"})]})]})]})]})]}),u.jsxs("div",{className:"modal-footer",style:{display:"flex",gap:"0.75rem",padding:"1.5rem"},children:[u.jsx("button",{className:"btn btn-ghost",onClick:l,children:"Reset to Default"}),u.jsx("div",{style:{flex:1}}),u.jsx("button",{className:"btn btn-ghost",onClick:r,children:"Cancel"}),u.jsx("button",{className:"btn btn-primary",onClick:s,children:"Save Settings"})]})]}),u.jsx("style",{children:`
        .bonus-settings-modal .setting-group {
          margin-bottom: 2rem;
          padding-bottom: 2rem;
          border-bottom: 1px solid var(--border);
        }

        .bonus-settings-modal .setting-group:last-child {
          border-bottom: none;
          margin-bottom: 0;
          padding-bottom: 0;
        }

        .setting-label-main {
          display: block;
          font-weight: 600;
          margin-bottom: 1rem;
          color: var(--text-primary);
        }

        .setting-row {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          padding: 0.75rem;
          border-radius: var(--radius-md);
          cursor: pointer;
          transition: background 0.2s;
        }

        .setting-row:hover {
          background: var(--gray-50);
        }

        .setting-row input[type="checkbox"] {
          margin-top: 0.25rem;
        }

        .setting-label {
          flex: 1;
          font-weight: 500;
        }

        .setting-label small {
          display: block;
          margin-top: 0.25rem;
          font-size: 0.75rem;
          color: var(--text-muted);
          font-weight: normal;
        }

        .setting-row-input {
          display: flex;
          flex-direction: column;
          gap: 0.5rem;
          margin-bottom: 1rem;
        }

        .setting-row-input .setting-label {
          font-weight: 600;
          color: var(--text-primary);
        }

        .setting-row-input small {
          font-size: 0.75rem;
          color: var(--text-muted);
        }

        .calc-type-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
          gap: 1rem;
        }

        .calc-type-btn {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 1.5rem 1rem;
          border: 2px solid var(--border);
          border-radius: var(--radius-lg);
          background: var(--surface);
          cursor: pointer;
          transition: all 0.2s;
        }

        .calc-type-btn:hover {
          border-color: var(--primary);
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .calc-type-btn.active {
          border-color: var(--primary);
          background: var(--primary-light);
        }

        .calc-type-icon {
          font-size: 2rem;
          margin-bottom: 0.5rem;
        }

        .calc-type-name {
          font-weight: 600;
          margin-bottom: 0.25rem;
          color: var(--text-primary);
        }

        .calc-type-desc {
          font-size: 0.75rem;
          color: var(--text-muted);
          text-align: center;
        }

        .settings-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 1rem;
        }

        .formula-preview {
          margin-top: 1.5rem;
          padding: 1rem;
          background: var(--gray-50);
          border-left: 4px solid var(--primary);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
        }

        .formula-preview strong {
          color: var(--primary);
        }

        .formula-preview code {
          background: var(--gray-100);
          padding: 0.125rem 0.375rem;
          border-radius: var(--radius-sm);
          font-family: monospace;
          font-size: 0.875em;
        }

        .formula-preview ul {
          font-size: 0.875rem;
        }

        .formula-preview li {
          margin-bottom: 0.25rem;
        }
      `})]})}function NL(e,t){const r={exportedAt:new Date().toISOString(),exportedBy:t||"unknown",version:"1.0",dataController:"User (you are responsible for this data)",dataProcessor:"Navigator Web",addresses:e.addresses||[],completions:e.completions||[],arrangements:e.arrangements||[],daySessions:e.daySessions||[],currentListVersion:e.currentListVersion||1,subscription:e.subscription||null,privacyNotice:{message:"This export contains all your data stored in Navigator Web.",gdprRights:"You have the right to access, rectify, erase, restrict, port, and object to processing of this data.",dataController:"You are the data controller for customer/debtor information",contact:"For questions: See PRIVACY.md"}},n=JSON.stringify(r,null,2),a=new Blob([n],{type:"application/json"}),s=URL.createObjectURL(a),l=document.createElement("a");l.href=s,l.download=`navigator-data-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}async function Sy(){if("storage"in navigator&&"estimate"in navigator.storage){const e=await navigator.storage.estimate(),t=e.usage||0,r=e.quota||0,n=r>0?Math.round(t/r*100):0;return{used:t,quota:r,percentage:n,usedMB:(t/1024/1024).toFixed(2),quotaMB:(r/1024/1024).toFixed(2)}}return{used:0,quota:0,percentage:0,usedMB:"0.00",quotaMB:"0.00"}}async function PL(){try{const e=Object.keys(localStorage).filter(t=>t.startsWith("geocoding_cache_"));if(e.forEach(t=>localStorage.removeItem(t)),"caches"in window){const r=(await caches.keys()).filter(n=>n.includes("map")||n.includes("tile"));await Promise.all(r.map(n=>caches.delete(n)))}console.log(`Cleared ${e.length} geocoding cache entries`),alert(`Cache cleared successfully!

Removed:
- ${e.length} geocoding entries
- Map tile caches`)}catch(e){console.error("Failed to clear caches:",e),alert("Failed to clear some caches. See console for details.")}}const IL="1.0.0",DL={version:IL},Iu=({checked:e,onChange:t,id:r})=>u.jsxs("div",{className:"modern-toggle-switch",onClick:t,children:[u.jsx("input",{type:"checkbox",id:r,checked:e,onChange:t,className:"modern-toggle-input"}),u.jsx("div",{className:`modern-toggle-slider ${e?"checked":""}`,children:u.jsx("div",{className:"modern-toggle-thumb"})})]}),pc=({title:e,icon:t,sectionKey:r,children:n,isExpanded:a,onToggle:s})=>u.jsxs("div",{className:"modern-settings-section-container",children:[u.jsxs("button",{type:"button",className:"modern-section-header",onClick:()=>s(r),children:[u.jsxs("div",{className:"modern-section-title-area",children:[u.jsx("span",{className:"modern-section-icon",children:t}),u.jsx("span",{className:"modern-section-title",children:e})]}),u.jsx("span",{className:`modern-section-chevron ${a?"expanded":""}`,children:"›"})]}),u.jsx("div",{className:`modern-section-content ${a?"expanded":""}`,children:u.jsx("div",{className:"modern-section-inner",children:n})})]}),FL=({trigger:e,reminderSettings:t,onUpdateReminderSettings:r,bonusSettings:n,onUpdateBonusSettings:a,onChangePassword:s,onChangeEmail:l,onDeleteAccount:d,onResolveDataOwnership:m,hasOwnershipIssue:p,appState:g,userEmail:y,onImportExcel:_,onRestoreBackup:T,onManualSync:S,isSyncing:w,onShowBackupManager:E,onShowCloudBackups:P,onShowSubscription:D,onShowSupabaseSetup:A,onSignOut:H,hasSupabase:J})=>{const[B,I]=Z.useState(!1),[ee,re]=Z.useState(!1),[ye,he]=Z.useState(!1),[ce,Ee]=Z.useState(null),[je,fe]=Z.useState("general"),ue=Z.useRef(null),O=Z.useRef(null),F=Z.useRef(null),M=Z.useRef(null),{settings:ie,toggleBackup:Y,toggleDarkMode:R,togglePushNotifications:z,toggleAutoSync:U,toggleConfirmBeforeDelete:te,updateKeepDataForMonths:W}=Op();Z.useEffect(()=>{B&&!ce&&Sy().then(Ee)},[B,ce]),Z.useEffect(()=>{const de=ge=>{ue.current&&!ue.current.contains(ge.target)&&I(!1)};return B&&document.addEventListener("mousedown",de),()=>{document.removeEventListener("mousedown",de)}},[B]),Z.useEffect(()=>{const de=ge=>{ge.key==="Escape"&&(I(!1),fe(null))};return B&&document.addEventListener("keydown",de),()=>{document.removeEventListener("keydown",de)}},[B]);const ae=de=>{fe(ge=>ge===de?null:de)},oe=de=>{const ge=de.target.files?.[0];ge&&_&&(_(ge),I(!1))};return u.jsxs("div",{className:"modern-settings-dropdown",ref:ue,children:[u.jsx("button",{type:"button",className:"modern-settings-trigger",onClick:()=>I(!B),"aria-expanded":B,"aria-haspopup":"true",children:e||u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"modern-trigger-icon",children:"⚙️"}),u.jsx("span",{className:"modern-trigger-text",children:"Settings"})]})}),B&&u.jsxs("div",{className:"modern-settings-panel",children:[u.jsxs("div",{className:"modern-panel-header",children:[u.jsxs("div",{className:"modern-header-content",children:[u.jsx("h2",{className:"modern-panel-title",children:"Settings"}),u.jsx("p",{className:"modern-panel-subtitle",children:"Manage your app preferences"})]}),u.jsx("button",{type:"button",className:"modern-close-button",onClick:()=>I(!1),"aria-label":"Close settings",children:"✕"})]}),u.jsxs("div",{className:"modern-panel-body",ref:O,children:[u.jsxs(pc,{title:"General",icon:"📱",sectionKey:"general",isExpanded:je==="general",onToggle:ae,children:[u.jsxs("div",{className:"modern-setting-row",children:[u.jsxs("div",{className:"modern-setting-info",children:[u.jsx("div",{className:"modern-setting-label",children:"Dark Mode"}),u.jsx("div",{className:"modern-setting-desc",children:"Switch between light and dark theme"})]}),u.jsx(Iu,{id:"dark-mode",checked:ie.darkMode,onChange:R})]}),u.jsxs("div",{className:"modern-setting-row",children:[u.jsxs("div",{className:"modern-setting-info",children:[u.jsx("div",{className:"modern-setting-label",children:"Push Notifications"}),u.jsx("div",{className:"modern-setting-desc",children:"Receive arrangement reminders"})]}),u.jsx(Iu,{id:"push-notifs",checked:ie.pushNotifications,onChange:z})]}),u.jsxs("div",{className:"modern-setting-row",children:[u.jsxs("div",{className:"modern-setting-info",children:[u.jsx("div",{className:"modern-setting-label",children:"Auto-sync on startup"}),u.jsx("div",{className:"modern-setting-desc",children:"Automatically sync when app opens"})]}),u.jsx(Iu,{id:"auto-sync",checked:ie.autoSyncOnStart,onChange:U})]})]}),u.jsxs(pc,{title:"Data & Backup",icon:"💾",sectionKey:"data",isExpanded:je==="data",onToggle:ae,children:[u.jsxs("div",{className:"modern-subsection",children:[u.jsx("div",{className:"modern-subsection-title",children:"Import & Export"}),u.jsx("input",{type:"file",ref:F,accept:".xlsx,.xls,.csv",onChange:oe,style:{display:"none"}}),u.jsxs("button",{className:"modern-action-button",onClick:()=>F.current?.click(),children:[u.jsx("span",{className:"modern-button-icon",children:"📊"}),u.jsx("span",{className:"modern-button-text",children:"Import Excel/CSV"})]}),g&&u.jsxs("button",{onClick:()=>{NL(g,y),I(!1)},className:"modern-action-button primary",children:[u.jsx("span",{className:"modern-button-icon",children:"💾"}),u.jsx("span",{className:"modern-button-text",children:"Backup All Data"})]})]}),u.jsxs("div",{className:"modern-subsection",children:[u.jsx("div",{className:"modern-subsection-title",children:"Backup Management"}),u.jsx("input",{type:"file",ref:M,accept:"application/json",onChange:de=>{T&&(T(de),I(!1))},style:{display:"none"}}),u.jsxs("button",{className:"modern-action-button",onClick:()=>M.current?.click(),children:[u.jsx("span",{className:"modern-button-icon",children:"📂"}),u.jsx("span",{className:"modern-button-text",children:"Restore from Backup"})]}),E&&u.jsxs("button",{className:"modern-action-button",onClick:()=>{E(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"💾"}),u.jsx("span",{className:"modern-button-text",children:"Local Backup Manager"})]}),J&&P&&u.jsxs("button",{className:"modern-action-button",onClick:()=>{P(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"☁️"}),u.jsx("span",{className:"modern-button-text",children:"Cloud Backups (Last 7 Days)"})]}),!J&&A&&u.jsxs("button",{className:"modern-action-button",onClick:()=>{A(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"🔗"}),u.jsx("span",{className:"modern-button-text",children:"Connect Cloud Storage"})]}),u.jsxs("div",{className:"modern-setting-row",children:[u.jsxs("div",{className:"modern-setting-info",children:[u.jsx("div",{className:"modern-setting-label",children:"Auto-backup on end of day"}),u.jsx("div",{className:"modern-setting-desc",children:"Automatic backup when finishing your day"})]}),u.jsx(Iu,{id:"backup-toggle",checked:ie.backupOnEndOfDay,onChange:Y})]})]}),S&&u.jsxs("div",{className:"modern-subsection",children:[u.jsx("div",{className:"modern-subsection-title",children:"Cloud Sync"}),u.jsxs("button",{className:"modern-action-button",onClick:()=>{S(),I(!1)},disabled:w,children:[u.jsx("span",{className:"modern-button-icon",children:w?"⟳":"🔄"}),u.jsx("span",{className:"modern-button-text",children:w?"Syncing...":"Sync Now"})]})]})]}),u.jsx(pc,{title:"Reminders & SMS",icon:"🔔",sectionKey:"reminders",isExpanded:je==="reminders",onToggle:ae,children:u.jsxs("button",{className:"modern-feature-button",onClick:()=>{re(!0),I(!1)},children:[u.jsxs("div",{className:"modern-feature-content",children:[u.jsx("div",{className:"modern-feature-title",children:"Reminder Settings"}),u.jsx("div",{className:"modern-feature-desc",children:"Configure message templates, scheduling, and reminder preferences"})]}),u.jsx("span",{className:"modern-feature-arrow",children:"→"})]})}),u.jsx(pc,{title:"Earnings & Bonus",icon:"💰",sectionKey:"earnings",isExpanded:je==="earnings",onToggle:ae,children:u.jsxs("button",{className:"modern-feature-button",onClick:()=>{he(!0),I(!1)},children:[u.jsxs("div",{className:"modern-feature-content",children:[u.jsx("div",{className:"modern-feature-title",children:"Bonus Calculation Settings"}),u.jsx("div",{className:"modern-feature-desc",children:"Configure your bonus calculation formula, thresholds, and case counting"})]}),u.jsx("span",{className:"modern-feature-arrow",children:"→"})]})}),u.jsxs(pc,{title:"Privacy & Safety",icon:"🔒",sectionKey:"privacy",isExpanded:je==="privacy",onToggle:ae,children:[u.jsxs("div",{className:"modern-setting-row",children:[u.jsxs("div",{className:"modern-setting-info",children:[u.jsx("div",{className:"modern-setting-label",children:"Confirm before deleting"}),u.jsx("div",{className:"modern-setting-desc",children:"Ask for confirmation on deletions"})]}),u.jsx(Iu,{id:"confirm-delete",checked:ie.confirmBeforeDelete,onChange:te})]}),u.jsxs("div",{className:"modern-setting-column",children:[u.jsx("label",{htmlFor:"data-retention",className:"modern-setting-label",children:"Data Retention Period"}),u.jsxs("select",{id:"data-retention",className:"modern-select",value:ie.keepDataForMonths,onChange:de=>W(Number(de.target.value)),children:[u.jsx("option",{value:3,children:"3 months"}),u.jsx("option",{value:6,children:"6 months"}),u.jsx("option",{value:12,children:"1 year"}),u.jsx("option",{value:0,children:"Forever"})]}),u.jsx("p",{className:"modern-setting-desc",children:"Automatically removes old data once per day"})]}),ce&&u.jsxs("div",{className:"modern-storage-card",children:[u.jsxs("div",{className:"modern-storage-header",children:[u.jsx("span",{className:"modern-storage-label",children:"Storage Usage"}),u.jsxs("span",{className:"modern-storage-value",children:[ce.usedMB," / ",ce.quotaMB," MB"]})]}),u.jsx("div",{className:"modern-storage-bar",children:u.jsx("div",{className:`modern-storage-fill ${ce.percentage>80?"warning":""}`,style:{width:`${ce.percentage}%`}})}),u.jsxs("div",{className:"modern-storage-percent",children:[ce.percentage,"% used"]})]}),u.jsxs("button",{onClick:async()=>{await PL(),Ee(null),setTimeout(()=>Sy().then(Ee),500)},className:"modern-action-button",children:[u.jsx("span",{className:"modern-button-icon",children:"🗑️"}),u.jsx("span",{className:"modern-button-text",children:"Clear Cache & Temporary Data"})]}),u.jsxs("div",{className:"modern-link-group",children:[u.jsxs("a",{href:"/PRIVACY.md",target:"_blank",rel:"noopener noreferrer",className:"modern-link-button",children:[u.jsx("span",{className:"modern-button-icon",children:"🔒"}),u.jsx("span",{className:"modern-button-text",children:"Privacy Policy"})]}),u.jsxs("a",{href:"/TERMS_OF_USE.md",target:"_blank",rel:"noopener noreferrer",className:"modern-link-button",children:[u.jsx("span",{className:"modern-button-icon",children:"📄"}),u.jsx("span",{className:"modern-button-text",children:"Terms of Use"})]})]})]}),u.jsxs(pc,{title:"Account",icon:"👤",sectionKey:"account",isExpanded:je==="account",onToggle:ae,children:[u.jsxs("div",{className:"modern-subsection",children:[u.jsx("div",{className:"modern-subsection-title",children:"Account Settings"}),D&&u.jsxs("button",{className:"modern-action-button accent",onClick:()=>{D(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"⭐"}),u.jsx("span",{className:"modern-button-text",children:"Subscription"})]}),s&&u.jsxs("button",{className:"modern-action-button",onClick:()=>{s(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"🔑"}),u.jsx("span",{className:"modern-button-text",children:"Change Password"})]}),l&&u.jsxs("button",{className:"modern-action-button",onClick:()=>{l(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"📧"}),u.jsx("span",{className:"modern-button-text",children:"Change Email"})]}),H&&u.jsxs("button",{className:"modern-action-button",onClick:()=>{H(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"🚪"}),u.jsx("span",{className:"modern-button-text",children:"Sign Out"})]}),m&&p&&u.jsxs("button",{className:"modern-action-button",style:{background:"rgba(245, 158, 11, 0.1)",borderColor:"rgba(245, 158, 11, 0.3)",color:"#b45309"},onClick:()=>{m(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"⚠️"}),u.jsx("span",{className:"modern-button-text",children:"Resolve Data Ownership"})]})]}),d&&u.jsxs("div",{className:"modern-subsection modern-danger-zone",children:[u.jsxs("div",{className:"modern-danger-zone-header",children:[u.jsx("span",{className:"modern-danger-icon",children:"⚠️"}),u.jsxs("div",{children:[u.jsx("div",{className:"modern-subsection-title danger",children:"Danger Zone"}),u.jsx("div",{className:"modern-danger-desc",children:"Irreversible actions"})]})]}),u.jsxs("button",{className:"modern-action-button danger-full",onClick:()=>{d(),I(!1)},children:[u.jsx("span",{className:"modern-button-icon",children:"🗑️"}),u.jsx("span",{className:"modern-button-text",children:"Delete Account Permanently"})]})]})]})]}),u.jsx("div",{className:"modern-panel-footer",children:u.jsxs("div",{className:"modern-footer-text",children:["Settings sync across devices • Version ",DL.version]})})]}),ee&&u.jsx(CL,{settings:t||cl,onUpdateSettings:de=>{r&&r(de),re(!1)},onClose:()=>re(!1)}),ye&&n&&a&&u.jsx(AL,{settings:n,onUpdateSettings:de=>{a(de),he(!1)},onClose:()=>he(!1)}),u.jsx("style",{children:`
        /* Modern Settings Dropdown - Complete Redesign */
        .modern-settings-dropdown {
          position: relative;
          display: inline-block;
        }

        /* Trigger Button */
        .modern-settings-trigger {
          display: flex;
          align-items: center;
          gap: 0.625rem;
          padding: 0.75rem 1.25rem;
          background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
          border: 1.5px solid rgba(99, 102, 241, 0.12);
          border-radius: 12px;
          color: #1f2937;
          font-size: 0.9375rem;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        .modern-settings-trigger:hover {
          background: linear-gradient(135deg, #ffffff 0%, #f0f1ff 100%);
          border-color: rgba(99, 102, 241, 0.3);
          box-shadow: 0 4px 16px rgba(99, 102, 241, 0.15);
          transform: translateY(-1px);
        }

        .modern-trigger-icon {
          font-size: 1.25rem;
        }

        /* Main Panel */
        .modern-settings-panel {
          position: absolute;
          top: calc(100% + 12px);
          right: 0;
          z-index: 999999;
          width: 440px;
          max-height: 85vh;
          background: linear-gradient(135deg, #ffffff 0%, #fafbff 100%);
          border: 1px solid rgba(99, 102, 241, 0.08);
          border-radius: 20px;
          box-shadow:
            0 24px 64px rgba(0, 0, 0, 0.12),
            0 12px 32px rgba(99, 102, 241, 0.08),
            0 0 0 1px rgba(99, 102, 241, 0.05);
          overflow: hidden;
          display: flex;
          flex-direction: column;
          animation: modernSlideIn 0.35s cubic-bezier(0.4, 0, 0.2, 1);
          backdrop-filter: blur(8px);
        }

        @keyframes modernSlideIn {
          from {
            opacity: 0;
            transform: translateY(-16px) scale(0.95);
          }
          to {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
        }

        /* Panel Header */
        .modern-panel-header {
          display: flex;
          align-items: flex-start;
          justify-content: space-between;
          padding: 1.75rem 1.75rem 1.25rem;
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.03) 100%);
          border-bottom: 1px solid rgba(99, 102, 241, 0.08);
        }

        .modern-header-content {
          flex: 1;
        }

        .modern-panel-title {
          font-size: 1.5rem;
          font-weight: 700;
          color: #111827;
          margin: 0 0 0.375rem 0;
          letter-spacing: -0.03em;
        }

        .modern-panel-subtitle {
          font-size: 0.875rem;
          color: #6b7280;
          margin: 0;
        }

        .modern-close-button {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 32px;
          height: 32px;
          background: white;
          border: 1px solid rgba(0, 0, 0, 0.08);
          border-radius: 8px;
          color: #6b7280;
          font-size: 1.125rem;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modern-close-button:hover {
          background: #f9fafb;
          border-color: #ef4444;
          color: #ef4444;
          transform: scale(1.05);
        }

        /* Panel Body */
        .modern-panel-body {
          flex: 1;
          overflow-y: auto;
          padding: 0.5rem 0.75rem 1rem;
        }

        .modern-panel-body::-webkit-scrollbar {
          width: 6px;
        }

        .modern-panel-body::-webkit-scrollbar-track {
          background: transparent;
        }

        .modern-panel-body::-webkit-scrollbar-thumb {
          background: rgba(99, 102, 241, 0.2);
          border-radius: 3px;
        }

        .modern-panel-body::-webkit-scrollbar-thumb:hover {
          background: rgba(99, 102, 241, 0.3);
        }

        /* Collapsible Sections */
        .modern-settings-section-container {
          margin: 0.5rem 0.5rem;
          background: white;
          border: 1.5px solid rgba(99, 102, 241, 0.08);
          border-radius: 14px;
          overflow: hidden;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-settings-section-container:hover {
          border-color: rgba(99, 102, 241, 0.15);
          box-shadow: 0 4px 12px rgba(99, 102, 241, 0.06);
        }

        .modern-section-header {
          width: 100%;
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 1rem 1.25rem;
          background: transparent;
          border: none;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modern-section-header:hover {
          background: rgba(99, 102, 241, 0.03);
        }

        .modern-section-title-area {
          display: flex;
          align-items: center;
          gap: 0.875rem;
        }

        .modern-section-icon {
          font-size: 1.375rem;
        }

        .modern-section-title {
          font-size: 1rem;
          font-weight: 600;
          color: #111827;
          letter-spacing: -0.01em;
        }

        .modern-section-chevron {
          font-size: 1.5rem;
          color: #9ca3af;
          transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-section-chevron.expanded {
          transform: rotate(90deg);
          color: #6366f1;
        }

        .modern-section-content {
          max-height: 0;
          overflow: hidden;
          transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-section-content.expanded {
          max-height: 2000px;
        }

        .modern-section-inner {
          padding: 0 1.25rem 1.25rem;
        }

        /* Subsections */
        .modern-subsection {
          margin-bottom: 1.5rem;
        }

        .modern-subsection:last-child {
          margin-bottom: 0;
        }

        .modern-subsection-title {
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.075em;
          color: #6366f1;
          margin-bottom: 0.75rem;
        }

        .modern-subsection-title.danger {
          color: #dc2626;
        }

        /* Danger Zone Styles */
        .modern-danger-zone {
          margin-top: 1.5rem;
          padding: 1.25rem;
          background: linear-gradient(135deg, rgba(239, 68, 68, 0.05) 0%, rgba(220, 38, 38, 0.08) 100%);
          border: 2px solid rgba(239, 68, 68, 0.25);
          border-radius: 12px;
        }

        .modern-danger-zone-header {
          display: flex;
          align-items: flex-start;
          gap: 0.75rem;
          margin-bottom: 1rem;
        }

        .modern-danger-icon {
          font-size: 1.75rem;
          flex-shrink: 0;
        }

        .modern-danger-desc {
          font-size: 0.8125rem;
          color: #dc2626;
          margin-top: 0.25rem;
          font-weight: 500;
        }

        /* Setting Rows */
        .modern-setting-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 1rem;
          padding: 0.875rem 0;
          border-bottom: 1px solid rgba(0, 0, 0, 0.04);
        }

        .modern-setting-row:last-child {
          border-bottom: none;
        }

        .modern-setting-column {
          padding: 0.875rem 0;
          border-bottom: 1px solid rgba(0, 0, 0, 0.04);
        }

        .modern-setting-column:last-child {
          border-bottom: none;
        }

        .modern-setting-info {
          flex: 1;
        }

        .modern-setting-label {
          font-size: 0.9375rem;
          font-weight: 600;
          color: #374151;
          margin-bottom: 0.25rem;
          display: block;
        }

        .modern-setting-desc {
          font-size: 0.8125rem;
          color: #9ca3af;
          line-height: 1.4;
          margin-top: 0.25rem;
        }

        /* Toggle Switch */
        .modern-toggle-switch {
          position: relative;
          width: 52px;
          height: 28px;
          cursor: pointer;
          flex-shrink: 0;
        }

        .modern-toggle-input {
          opacity: 0;
          width: 0;
          height: 0;
        }

        .modern-toggle-slider {
          position: absolute;
          inset: 0;
          background: #e5e7eb;
          border-radius: 28px;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-toggle-slider.checked {
          background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        }

        .modern-toggle-thumb {
          position: absolute;
          height: 24px;
          width: 24px;
          left: 2px;
          bottom: 2px;
          background: white;
          border-radius: 50%;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .modern-toggle-slider.checked .modern-toggle-thumb {
          transform: translateX(24px);
          box-shadow: 0 3px 12px rgba(99, 102, 241, 0.4);
        }

        /* Select Dropdown */
        .modern-select {
          width: 100%;
          padding: 0.75rem 1rem;
          margin-top: 0.5rem;
          background: white;
          border: 1.5px solid rgba(0, 0, 0, 0.1);
          border-radius: 10px;
          font-size: 0.9375rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modern-select:hover {
          border-color: rgba(99, 102, 241, 0.3);
        }

        .modern-select:focus {
          outline: none;
          border-color: #6366f1;
          box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* Action Buttons */
        .modern-action-button {
          width: 100%;
          display: flex;
          align-items: center;
          gap: 0.875rem;
          padding: 0.875rem 1rem;
          margin-bottom: 0.625rem;
          background: white;
          border: 1.5px solid rgba(0, 0, 0, 0.08);
          border-radius: 10px;
          font-size: 0.9375rem;
          font-weight: 500;
          color: #374151;
          cursor: pointer;
          transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-action-button:last-child {
          margin-bottom: 0;
        }

        .modern-action-button:hover {
          background: #f9fafb;
          border-color: rgba(99, 102, 241, 0.3);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        }

        .modern-action-button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
          transform: none;
        }

        .modern-action-button.primary {
          background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
          border-color: transparent;
          color: white;
          font-weight: 600;
        }

        .modern-action-button.primary:hover {
          box-shadow: 0 8px 24px rgba(99, 102, 241, 0.35);
          transform: translateY(-1px);
        }

        .modern-action-button.accent {
          background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(251, 191, 36, 0.1) 100%);
          border-color: rgba(245, 158, 11, 0.3);
          color: #b45309;
        }

        .modern-action-button.accent:hover {
          background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(251, 191, 36, 0.15) 100%);
          border-color: rgba(245, 158, 11, 0.5);
        }

        .modern-action-button.danger {
          background: rgba(239, 68, 68, 0.06);
          border-color: rgba(239, 68, 68, 0.2);
          color: #dc2626;
        }

        .modern-action-button.danger:hover {
          background: rgba(239, 68, 68, 0.12);
          border-color: rgba(239, 68, 68, 0.4);
        }

        .modern-action-button.danger-full {
          background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
          border: 2px solid #991b1b;
          color: white;
          font-weight: 600;
          box-shadow: 0 4px 12px rgba(220, 38, 38, 0.25);
        }

        .modern-action-button.danger-full:hover {
          background: linear-gradient(135deg, #b91c1c 0%, #991b1b 100%);
          border-color: #7f1d1d;
          box-shadow: 0 6px 20px rgba(220, 38, 38, 0.4);
          transform: translateY(-1px);
        }

        .modern-action-button.small {
          padding: 0.75rem 0.875rem;
          font-size: 0.875rem;
        }

        .modern-button-icon {
          font-size: 1.125rem;
          flex-shrink: 0;
        }

        .modern-button-text {
          flex: 1;
          text-align: left;
        }

        /* Button Groups */
        .modern-button-group {
          display: flex;
          gap: 0.625rem;
        }

        .modern-button-group .modern-action-button {
          flex: 1;
        }

        /* Link Buttons */
        .modern-link-group {
          display: flex;
          gap: 0.625rem;
          margin-top: 0.625rem;
        }

        .modern-link-button {
          flex: 1;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          padding: 0.75rem 0.875rem;
          background: white;
          border: 1.5px solid rgba(0, 0, 0, 0.08);
          border-radius: 10px;
          font-size: 0.875rem;
          font-weight: 500;
          color: #374151;
          text-decoration: none;
          cursor: pointer;
          transition: all 0.2s;
        }

        .modern-link-button:hover {
          background: #f9fafb;
          border-color: rgba(99, 102, 241, 0.3);
          transform: translateY(-1px);
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
        }

        /* Storage Card */
        .modern-storage-card {
          padding: 1rem;
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.03) 100%);
          border: 1.5px solid rgba(99, 102, 241, 0.15);
          border-radius: 12px;
          margin: 0.875rem 0;
        }

        .modern-storage-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 0.625rem;
        }

        .modern-storage-label {
          font-size: 0.75rem;
          font-weight: 600;
          text-transform: uppercase;
          letter-spacing: 0.05em;
          color: #6366f1;
        }

        .modern-storage-value {
          font-size: 0.875rem;
          font-weight: 600;
          color: #111827;
        }

        .modern-storage-bar {
          height: 8px;
          background: rgba(0, 0, 0, 0.06);
          border-radius: 8px;
          overflow: hidden;
          margin-bottom: 0.5rem;
        }

        .modern-storage-fill {
          height: 100%;
          background: linear-gradient(90deg, #6366f1 0%, #8b5cf6 100%);
          border-radius: 8px;
          transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-storage-fill.warning {
          background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
        }

        .modern-storage-percent {
          font-size: 0.8125rem;
          color: #6b7280;
          text-align: right;
        }

        /* Feature Button (for SMS Settings) */
        .modern-feature-button {
          width: 100%;
          display: flex;
          align-items: center;
          gap: 1rem;
          padding: 1.125rem 1.25rem;
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(139, 92, 246, 0.03) 100%);
          border: 1.5px solid rgba(99, 102, 241, 0.15);
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .modern-feature-button:hover {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.08) 100%);
          border-color: rgba(99, 102, 241, 0.3);
          box-shadow: 0 4px 16px rgba(99, 102, 241, 0.12);
        }

        .modern-feature-content {
          flex: 1;
        }

        .modern-feature-title {
          font-size: 1rem;
          font-weight: 600;
          color: #111827;
          margin-bottom: 0.25rem;
        }

        .modern-feature-desc {
          font-size: 0.8125rem;
          color: #6b7280;
          line-height: 1.4;
        }

        .modern-feature-arrow {
          font-size: 1.25rem;
          color: #9ca3af;
          transition: transform 0.2s;
        }

        .modern-feature-button:hover .modern-feature-arrow {
          transform: translateX(4px);
          color: #6366f1;
        }

        /* Panel Footer */
        .modern-panel-footer {
          padding: 1rem 1.75rem;
          background: rgba(99, 102, 241, 0.02);
          border-top: 1px solid rgba(99, 102, 241, 0.08);
        }

        .modern-footer-text {
          font-size: 0.75rem;
          color: #9ca3af;
          text-align: center;
          line-height: 1.5;
        }

        /* Dark Mode Support */
        .dark-mode .modern-settings-trigger {
          background: linear-gradient(135deg, rgba(31, 41, 55, 0.95) 0%, rgba(17, 24, 39, 1) 100%);
          border-color: rgba(139, 92, 246, 0.2);
          color: #e5e7eb;
        }

        .dark-mode .modern-settings-trigger:hover {
          background: linear-gradient(135deg, rgba(31, 41, 55, 1) 0%, rgba(17, 24, 39, 1) 100%);
          border-color: rgba(139, 92, 246, 0.4);
        }

        .dark-mode .modern-settings-panel {
          background: linear-gradient(135deg, rgba(17, 24, 39, 0.98) 0%, rgba(31, 41, 55, 0.98) 100%);
          border-color: rgba(139, 92, 246, 0.15);
        }

        .dark-mode .modern-panel-header {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.08) 0%, rgba(139, 92, 246, 0.05) 100%);
          border-bottom-color: rgba(139, 92, 246, 0.15);
        }

        .dark-mode .modern-panel-title,
        .dark-mode .modern-section-title,
        .dark-mode .modern-setting-label,
        .dark-mode .modern-feature-title,
        .dark-mode .modern-storage-value {
          color: #f9fafb;
        }

        .dark-mode .modern-panel-subtitle,
        .dark-mode .modern-setting-desc,
        .dark-mode .modern-feature-desc,
        .dark-mode .modern-footer-text {
          color: #9ca3af;
        }

        .dark-mode .modern-settings-section-container {
          background: rgba(17, 24, 39, 0.6);
          border-color: rgba(139, 92, 246, 0.15);
        }

        .dark-mode .modern-section-header:hover {
          background: rgba(99, 102, 241, 0.05);
        }

        .dark-mode .modern-setting-row,
        .dark-mode .modern-setting-column {
          border-bottom-color: rgba(255, 255, 255, 0.06);
        }

        .dark-mode .modern-action-button,
        .dark-mode .modern-link-button {
          background: rgba(17, 24, 39, 0.8);
          border-color: rgba(255, 255, 255, 0.1);
          color: #e5e7eb;
        }

        .dark-mode .modern-action-button:hover,
        .dark-mode .modern-link-button:hover {
          background: rgba(17, 24, 39, 0.95);
          border-color: rgba(139, 92, 246, 0.4);
        }

        .dark-mode .modern-select {
          background: rgba(17, 24, 39, 0.8);
          border-color: rgba(255, 255, 255, 0.1);
          color: #e5e7eb;
        }

        .dark-mode .modern-storage-card {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.08) 100%);
          border-color: rgba(99, 102, 241, 0.25);
        }

        .dark-mode .modern-storage-bar {
          background: rgba(0, 0, 0, 0.3);
        }

        .dark-mode .modern-feature-button {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.08) 100%);
          border-color: rgba(99, 102, 241, 0.25);
        }

        .dark-mode .modern-feature-button:hover {
          background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(139, 92, 246, 0.12) 100%);
          border-color: rgba(99, 102, 241, 0.4);
        }

        .dark-mode .modern-close-button {
          background: rgba(17, 24, 39, 0.8);
          border-color: rgba(255, 255, 255, 0.1);
          color: #9ca3af;
        }

        .dark-mode .modern-close-button:hover {
          background: rgba(239, 68, 68, 0.1);
          border-color: #ef4444;
          color: #ef4444;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
          .modern-settings-dropdown {
            position: static;
          }

          .modern-settings-panel {
            position: fixed;
            top: 50%;
            left: 50%;
            right: auto;
            bottom: auto;
            transform: translate(-50%, -50%);
            width: calc(100vw - 2rem);
            max-width: 420px;
            max-height: 85vh;
            z-index: 999999;
          }

          @keyframes modernSlideIn {
            from {
              opacity: 0;
              transform: translate(-50%, -50%) scale(0.92);
            }
            to {
              opacity: 1;
              transform: translate(-50%, -50%) scale(1);
            }
          }

          .modern-panel-header {
            padding: 1.5rem 1.25rem 1rem;
          }

          .modern-panel-title {
            font-size: 1.375rem;
          }

          .modern-section-inner {
            padding: 0 1rem 1rem;
          }

          .modern-settings-trigger {
            padding: 0.625rem 1rem;
            font-size: 0.875rem;
          }

          .modern-trigger-icon {
            font-size: 1.125rem;
          }
        }

        /* Mobile Overlay */
        @media (max-width: 768px) {
          .modern-settings-panel::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: -1;
            animation: fadeIn 0.3s ease-out;
          }

          @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
          }
        }
      `})]})},jL=(e,t)=>e.isSyncing===t.isSyncing&&e.hasSupabase===t.hasSupabase&&e.userEmail===t.userEmail&&e.reminderSettings===t.reminderSettings&&e.bonusSettings===t.bonusSettings,OL=rr.memo(FL,jL),RL=()=>{const[e,t]=rr.useState([]);return rr.useEffect(()=>Ju.subscribe(t),[]),e.length===0?null:u.jsxs("div",{className:"toast-container",children:[e.map(r=>u.jsx("div",{className:`toast toast-${r.type}`,onClick:()=>Ju.remove(r.id),children:u.jsxs("div",{className:"toast-content",children:[u.jsxs("span",{className:"toast-icon",children:[r.type==="success"&&"✅",r.type==="error"&&"❌",r.type==="warning"&&"⚠️",r.type==="info"&&"ℹ️"]}),u.jsx("span",{className:"toast-message",children:r.message})]})},r.id)),u.jsx("style",{children:`
        .toast-container {
          position: fixed;
          top: 20px;
          right: 20px;
          z-index: 9999;
          display: flex;
          flex-direction: column;
          gap: 8px;
          pointer-events: none;
        }

        .toast {
          pointer-events: auto;
          background: var(--card-bg, white);
          color: var(--text-primary, #374151);
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          border-left: 4px solid;
          min-width: 300px;
          max-width: 400px;
          padding: 12px 16px;
          cursor: pointer;
          transition: all 0.3s ease;
          animation: slideIn 0.3s ease-out;
        }

        .toast:hover {
          transform: translateY(-2px);
          box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }

        .toast-success {
          border-left-color: #22c55e;
          background: #f0fdf4;
        }

        .toast-error {
          border-left-color: #ef4444;
          background: #fef2f2;
        }

        .toast-warning {
          border-left-color: #f59e0b;
          background: #fffbeb;
        }

        .toast-info {
          border-left-color: #3b82f6;
          background: #eff6ff;
        }

        .toast-content {
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .toast-icon {
          font-size: 16px;
        }

        .toast-message {
          color: inherit;
          font-weight: 500;
          flex: 1;
          line-height: 1.4;
        }

        @keyframes slideIn {
          from {
            opacity: 0;
            transform: translateX(100%);
          }
          to {
            opacity: 1;
            transform: translateX(0);
          }
        }

        @media (max-width: 768px) {
          .toast-container {
            top: 10px;
            right: 10px;
            left: 10px;
          }

          .toast {
            min-width: auto;
            max-width: none;
          }
        }
      `})]})},Ym="navigator_privacy_consent",Ty="v1.0_2025-01-06",LL=({onAccept:e})=>{const[t,r]=Z.useState(!1),[n,a]=Z.useState(!1);Z.useEffect(()=>{const d=localStorage.getItem(Ym);(!d||d!==Ty)&&r(!0)},[]);const s=()=>{localStorage.setItem(Ym,Ty),r(!1),e&&e()},l=()=>{window.confirm(`You can still use Navigator Web in offline mode (no cloud sync).

To use cloud sync and multi-device features, you must accept our privacy policy.

Click OK to use offline mode, or Cancel to review the privacy policy.`)&&(localStorage.setItem(Ym,"offline_mode"),r(!1))};return t?u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1e5,backdropFilter:"blur(4px)"}}),u.jsx("div",{style:{position:"fixed",bottom:0,left:0,right:0,background:"white",borderTop:"3px solid var(--primary, #667eea)",boxShadow:"0 -4px 20px rgba(0, 0, 0, 0.15)",zIndex:100001,padding:"1.5rem",maxHeight:n?"80vh":"auto",overflowY:"auto"},children:u.jsx("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:n?u.jsxs("div",{children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem"},children:[u.jsx("h3",{style:{margin:0,fontSize:"1.25rem",fontWeight:600,color:"#1a202c"},children:"Privacy & Cookie Policy"}),u.jsx("button",{onClick:()=>a(!1),style:{padding:"0.5rem",background:"transparent",border:"none",fontSize:"1.5rem",color:"#718096",cursor:"pointer",lineHeight:1},children:"✕"})]}),u.jsxs("div",{style:{background:"#f7fafc",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #e2e8f0"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#2d3748"},children:"What We Collect"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#4a5568",lineHeight:"1.6"},children:[u.jsx("li",{children:"Your email address (for authentication)"}),u.jsx("li",{children:"Work data you enter (addresses, completions, arrangements)"}),u.jsx("li",{children:"Device identifiers (for multi-device sync)"}),u.jsx("li",{children:"Technical data (login times, browser info)"})]})]}),u.jsxs("div",{style:{background:"#f7fafc",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #e2e8f0"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#2d3748"},children:"How We Use It"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#4a5568",lineHeight:"1.6"},children:[u.jsx("li",{children:"Authenticate your account"}),u.jsx("li",{children:"Sync data across your devices"}),u.jsx("li",{children:"Provide route planning and geocoding"}),u.jsx("li",{children:"Enable backup and restore"})]}),u.jsx("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.875rem",color:"#718096",fontStyle:"italic"},children:"We do NOT analyze, share, or sell your data."})]}),u.jsxs("div",{style:{background:"#fff5f5",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #feb2b2"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#c53030"},children:"⚠️ Your GDPR Responsibilities"}),u.jsxs("p",{style:{margin:0,fontSize:"0.875rem",color:"#742a2a",lineHeight:"1.6"},children:[u.jsx("strong",{children:"YOU are the Data Controller"})," for customer/debtor data you process. You must have lawful authority and comply with GDPR/UK DPA 2018. We are only the Data Processor providing infrastructure."]})]}),u.jsxs("div",{style:{background:"#f0fff4",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem",border:"1px solid #9ae6b4"},children:[u.jsx("h4",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",color:"#22543d"},children:"✅ Your Rights"}),u.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.875rem",color:"#276749",lineHeight:"1.6"},children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Access:"})," Export all data (Settings → Export Data)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Delete:"})," Remove account permanently (Settings → Delete Account)"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Rectify:"})," Edit any data directly in the app"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Portability:"})," Download in JSON/CSV format"]})]})]}),u.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"1px solid #e2e8f0"},children:[u.jsx("button",{onClick:l,style:{flex:1,padding:"0.75rem 1.5rem",background:"#e2e8f0",border:"none",borderRadius:"6px",color:"#2d3748",fontSize:"0.9375rem",fontWeight:500,cursor:"pointer"},children:"Decline (Offline Mode)"}),u.jsx("button",{onClick:s,style:{flex:1,padding:"0.75rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",color:"white",fontSize:"0.9375rem",fontWeight:600,cursor:"pointer",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)"},children:"Accept & Continue"})]}),u.jsxs("p",{style:{margin:"1rem 0 0 0",fontSize:"0.75rem",color:"#718096",textAlign:"center"},children:["Read full"," ",u.jsx("a",{href:"/PRIVACY.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Privacy Policy"})," ","and"," ",u.jsx("a",{href:"/TERMS_OF_USE.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Terms of Use"})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"1.5rem",flexWrap:"wrap"},children:[u.jsxs("div",{style:{flex:1,minWidth:"300px"},children:[u.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1.125rem",fontWeight:600,color:"#1a202c"},children:"🔒 Privacy & Data Protection"}),u.jsxs("p",{style:{margin:0,fontSize:"0.875rem",lineHeight:"1.5",color:"#4a5568"},children:["We use cookies and cloud storage to sync your work data across devices. We are a ",u.jsx("strong",{children:"data processor"})," - you remain the ",u.jsx("strong",{children:"data controller"})," for any customer data you process."]})]}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center",flexWrap:"wrap"},children:[u.jsx("button",{onClick:()=>a(!0),style:{padding:"0.625rem 1.25rem",background:"transparent",border:"1px solid #cbd5e0",borderRadius:"6px",color:"#4a5568",fontSize:"0.875rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:d=>{d.currentTarget.style.background="#f7fafc",d.currentTarget.style.borderColor="#a0aec0"},onMouseLeave:d=>{d.currentTarget.style.background="transparent",d.currentTarget.style.borderColor="#cbd5e0"},children:"Learn More"}),u.jsx("button",{onClick:l,style:{padding:"0.625rem 1.25rem",background:"#e2e8f0",border:"none",borderRadius:"6px",color:"#2d3748",fontSize:"0.875rem",fontWeight:500,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:d=>{d.currentTarget.style.background="#cbd5e0"},onMouseLeave:d=>{d.currentTarget.style.background="#e2e8f0"},children:"Decline"}),u.jsx("button",{onClick:s,style:{padding:"0.625rem 1.5rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",color:"white",fontSize:"0.875rem",fontWeight:600,cursor:"pointer",transition:"all 0.2s",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)"},onMouseEnter:d=>{d.currentTarget.style.transform="translateY(-1px)",d.currentTarget.style.boxShadow="0 4px 8px rgba(102, 126, 234, 0.4)"},onMouseLeave:d=>{d.currentTarget.style.transform="translateY(0)",d.currentTarget.style.boxShadow="0 2px 4px rgba(102, 126, 234, 0.3)"},children:"Accept & Continue"})]})]}),u.jsxs("div",{style:{marginTop:"1rem",paddingTop:"1rem",borderTop:"1px solid #e2e8f0",fontSize:"0.75rem",color:"#718096"},children:['By clicking "Accept", you agree to our'," ",u.jsx("a",{href:"/PRIVACY.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Privacy Policy"})," ","and"," ",u.jsx("a",{href:"/TERMS_OF_USE.md",target:"_blank",style:{color:"#667eea",textDecoration:"underline"},children:"Terms of Use"}),". This app is for professional enforcement use only."]})]})})}),u.jsx("style",{children:`
        @media (max-width: 768px) {
          .privacy-consent-banner {
            padding: 1rem !important;
          }
        }
      `})]}):null};class ML{deferredPrompt=null;serviceWorkerRegistration=null;constructor(){this.init()}async init(){await this.requestPersistentStorage(),this.setupInstallPrompt(),this.setupServiceWorkerUpdates(),this.setupServiceWorkerMessages()}async requestPersistentStorage(){if(!navigator.storage||!navigator.storage.persist)return le.warn("Persistent storage not supported"),!1;try{return await navigator.storage.persisted()?(le.info("✅ Storage is already persistent"),!0):await navigator.storage.persist()?(le.info("✅ Persistent storage granted"),localStorage.setItem("navigator_persistent_storage","true"),!0):(le.warn("⚠️ Persistent storage denied - data may be evicted under storage pressure"),!1)}catch(t){return le.error("Failed to request persistent storage:",t),!1}}async getStorageQuota(){if(!navigator.storage||!navigator.storage.estimate)return null;try{const t=await navigator.storage.estimate(),r=t.usage||0,n=t.quota||0,a=n>0?Math.round(r/n*100):0;return{usage:r,quota:n,percentage:a}}catch(t){return le.error("Failed to get storage quota:",t),null}}setupInstallPrompt(){window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),this.deferredPrompt=t,le.info("📲 PWA install prompt available"),window.dispatchEvent(new CustomEvent("pwa-installable")),localStorage.setItem("navigator_pwa_installable","true")}),window.addEventListener("appinstalled",()=>{le.info("✅ PWA installed successfully"),this.deferredPrompt=null,localStorage.setItem("navigator_pwa_installed","true"),localStorage.removeItem("navigator_pwa_installable"),window.dispatchEvent(new CustomEvent("pwa-installed"))})}async showInstallPrompt(){if(!this.deferredPrompt)return le.warn("Install prompt not available"),"unavailable";try{await this.deferredPrompt.prompt();const t=await this.deferredPrompt.userChoice;return le.info("User install choice:",t.outcome),this.deferredPrompt=null,t.outcome}catch(t){return le.error("Install prompt failed:",t),"dismissed"}}isInstallable(){return this.deferredPrompt!==null}isInstalled(){return!!(window.matchMedia("(display-mode: standalone)").matches||localStorage.getItem("navigator_pwa_installed")==="true"||navigator.standalone===!0)}async setupServiceWorkerUpdates(){if("serviceWorker"in navigator)try{const t=await navigator.serviceWorker.ready;this.serviceWorkerRegistration=t,setInterval(()=>{t.update()},3600*1e3),t.addEventListener("updatefound",()=>{const r=t.installing;r&&r.addEventListener("statechange",()=>{r.state==="installed"&&navigator.serviceWorker.controller&&(le.info("🔄 New service worker available"),window.dispatchEvent(new CustomEvent("pwa-update-available")))})}),le.info("✅ Service worker updates configured")}catch(t){le.error("Failed to setup service worker updates:",t)}}async updateServiceWorker(){if(!this.serviceWorkerRegistration)return;const t=this.serviceWorkerRegistration.waiting;t&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())}setupServiceWorkerMessages(){"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",t=>{le.info("[PWA] Message from service worker:",t.data),t.data.type==="BACKGROUND_SYNC_START"?window.dispatchEvent(new CustomEvent("background-sync-start",{detail:t.data})):t.data.type==="BACKGROUND_SYNC_COMPLETE"&&window.dispatchEvent(new CustomEvent("background-sync-complete",{detail:t.data}))})}async registerBackgroundSync(t="sync-data"){if(!this.serviceWorkerRegistration)return le.warn("Service worker not registered"),!1;if(!("sync"in this.serviceWorkerRegistration))return le.warn("Background sync not supported"),!1;try{return await this.serviceWorkerRegistration.sync.register(t),le.info("✅ Background sync registered:",t),!0}catch(r){return le.error("Background sync registration failed:",r),!1}}async preCacheUrls(t){return!this.serviceWorkerRegistration||!this.serviceWorkerRegistration.active?{success:!1,error:"Service worker not active"}:new Promise(r=>{const n=new MessageChannel;n.port1.onmessage=a=>{r(a.data)},this.serviceWorkerRegistration.active.postMessage({type:"CACHE_URLS",urls:t},[n.port2])})}async clearCaches(t){return!this.serviceWorkerRegistration||!this.serviceWorkerRegistration.active?!1:new Promise(r=>{const n=new MessageChannel;n.port1.onmessage=a=>{r(a.data.success)},this.serviceWorkerRegistration.active.postMessage({type:"CLEAR_CACHE",cacheName:t},[n.port2])})}async checkConnectivity(){if(!navigator.onLine)return!1;try{const t=window.location.pathname.startsWith("/navigator-web/")?"/navigator-web/manifest.webmanifest":"/manifest.webmanifest";return(await fetch(t,{method:"HEAD",cache:"no-cache"})).ok}catch{return navigator.onLine}}}const qu=new ML,BL=({isOnline:e,isSyncing:t,lastSyncTime:r,onForceSync:n})=>{const[a,s]=Z.useState(!1),[l,d]=Z.useState("connected");Z.useEffect(()=>{const _=async()=>{if(!e){d("disconnected");return}d("checking");const S=await qu.checkConnectivity();d(S?"connected":"disconnected")};_();const T=setInterval(_,3e4);return()=>clearInterval(T)},[e]);const m=()=>!e||l==="disconnected"?"#ef4444":t?"#f59e0b":"#10b981",p=()=>!e||l==="disconnected"?"Offline":t?"Syncing":l==="checking"?"Checking":"Online",g=()=>!e||l==="disconnected"?"📡":t?"⟳":l==="checking"?"⏳":"✓",y=()=>{if(!r)return"Never synced";const T=Date.now()-r.getTime(),S=Math.floor(T/6e4),w=Math.floor(T/36e5),E=Math.floor(T/864e5);return E>0?`${E}d ago`:w>0?`${w}h ago`:S>0?`${S}m ago`:"Just now"};return u.jsxs("div",{style:{position:"relative"},children:[u.jsxs("button",{type:"button",onClick:()=>s(!a),style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.875rem",background:!e||l==="disconnected"?"linear-gradient(135deg, rgba(239, 68, 68, 0.1), rgba(220, 38, 38, 0.15))":"linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(5, 150, 105, 0.15))",border:`1.5px solid ${m()}`,borderRadius:"10px",color:m(),fontSize:"0.875rem",fontWeight:600,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:_=>{_.currentTarget.style.transform="scale(1.05)"},onMouseLeave:_=>{_.currentTarget.style.transform="scale(1)"},children:[u.jsx("span",{style:{fontSize:"1rem"},children:g()}),u.jsx("span",{children:p()}),t&&u.jsx("div",{style:{width:"8px",height:"8px",background:m(),borderRadius:"50%",animation:"pulse 1.5s infinite"}})]}),a&&u.jsxs("div",{style:{position:"absolute",top:"calc(100% + 8px)",right:0,zIndex:9999,width:"280px",background:"white",border:"1px solid rgba(0, 0, 0, 0.1)",borderRadius:"12px",boxShadow:"0 12px 32px rgba(0, 0, 0, 0.15)",padding:"1rem",animation:"slideDown 0.2s ease-out"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid rgba(0, 0, 0, 0.08)"},children:[u.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600},children:"Connection Status"}),u.jsx("button",{type:"button",onClick:()=>s(!1),style:{background:"none",border:"none",fontSize:"1.25rem",cursor:"pointer",color:"#9ca3af",padding:0,lineHeight:1},children:"✕"})]}),u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",marginBottom:"0.75rem"},children:[u.jsx("div",{style:{width:"12px",height:"12px",background:m(),borderRadius:"50%",flexShrink:0}}),u.jsxs("div",{style:{flex:1},children:[u.jsx("div",{style:{fontSize:"0.9375rem",fontWeight:500,color:"#111827"},children:p()}),u.jsx("div",{style:{fontSize:"0.8125rem",color:"#6b7280",marginTop:"0.125rem"},children:!e||l==="disconnected"?"Working in offline mode":t?"Syncing your data...":"All changes synced"})]})]}),u.jsxs("div",{style:{fontSize:"0.8125rem",color:"#6b7280",padding:"0.5rem",background:"rgba(0, 0, 0, 0.02)",borderRadius:"6px"},children:["Last sync: ",u.jsx("strong",{style:{color:"#111827"},children:y()})]})]}),n&&e&&l==="connected"&&!t&&u.jsx("button",{type:"button",onClick:()=>{n(),s(!1)},style:{width:"100%",padding:"0.75rem",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",border:"none",borderRadius:"8px",fontSize:"0.875rem",fontWeight:600,cursor:"pointer",marginBottom:"0.75rem",transition:"transform 0.2s, box-shadow 0.2s"},onMouseEnter:_=>{_.currentTarget.style.transform="translateY(-2px)",_.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},onMouseLeave:_=>{_.currentTarget.style.transform="translateY(0)",_.currentTarget.style.boxShadow="none"},children:"🔄 Force Sync Now"}),(!e||l==="disconnected")&&u.jsxs("div",{style:{padding:"0.75rem",background:"rgba(239, 68, 68, 0.05)",border:"1px solid rgba(239, 68, 68, 0.1)",borderRadius:"8px",fontSize:"0.8125rem",color:"#6b7280"},children:[u.jsx("div",{style:{fontWeight:600,color:"#ef4444",marginBottom:"0.25rem"},children:"📡 Offline Mode"}),u.jsxs("div",{children:["• All changes saved locally",u.jsx("br",{}),"• Will sync when connection returns",u.jsx("br",{}),"• Background sync enabled"]})]})]}),u.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-8px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
      `})]})},zL=()=>{const[e,t]=Z.useState(!1),[r,n]=Z.useState(!1);Z.useEffect(()=>{if(qu.isInstalled())return;const l=localStorage.getItem("navigator_pwa_prompt_dismissed");if(l){const p=parseInt(l);if((Date.now()-p)/(1e3*60*60*24)<7)return}const d=()=>{t(!0)},m=()=>{t(!1)};return window.addEventListener("pwa-installable",d),window.addEventListener("pwa-installed",m),qu.isInstallable()&&t(!0),()=>{window.removeEventListener("pwa-installable",d),window.removeEventListener("pwa-installed",m)}},[]);const a=async()=>{n(!0);const l=await qu.showInstallPrompt();l==="accepted"?t(!1):l==="dismissed"&&(localStorage.setItem("navigator_pwa_prompt_dismissed",Date.now().toString()),t(!1)),n(!1)},s=()=>{localStorage.setItem("navigator_pwa_prompt_dismissed",Date.now().toString()),t(!1)};return e?u.jsxs("div",{style:{position:"fixed",bottom:"1rem",left:"1rem",right:"1rem",zIndex:1e4,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",padding:"1.25rem",borderRadius:"16px",boxShadow:"0 12px 40px rgba(102, 126, 234, 0.4)",animation:"slideUp 0.4s ease-out",maxWidth:"500px",margin:"0 auto"},children:[u.jsxs("div",{style:{display:"flex",alignItems:"start",gap:"1rem"},children:[u.jsx("div",{style:{fontSize:"2.5rem",flexShrink:0},children:"📱"}),u.jsxs("div",{style:{flex:1},children:[u.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.125rem",fontWeight:700},children:"Install Navigator App"}),u.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.875rem",opacity:.95,lineHeight:1.5},children:"Get faster access, work offline, and receive reminders. Install now for the best experience!"}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[u.jsx("button",{onClick:a,disabled:r,style:{flex:1,padding:"0.75rem 1.5rem",background:"white",color:"#667eea",border:"none",borderRadius:"10px",fontSize:"1rem",fontWeight:600,cursor:r?"wait":"pointer",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",transition:"transform 0.2s"},onMouseEnter:l=>{r||(l.target.style.transform="translateY(-2px)")},onMouseLeave:l=>{l.target.style.transform="translateY(0)"},children:r?"Installing...":"Install"}),u.jsx("button",{onClick:s,style:{padding:"0.75rem 1rem",background:"rgba(255, 255, 255, 0.2)",color:"white",border:"none",borderRadius:"10px",fontSize:"0.9375rem",fontWeight:500,cursor:"pointer"},children:"Not now"})]})]})]}),u.jsx("style",{children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(100px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        @media (max-width: 640px) {
          div[style*="position: fixed"][style*="bottom: 1rem"] {
            left: 0.5rem !important;
            right: 0.5rem !important;
          }
        }
      `})]}):null},ch="navigator_last_cleanup",Gb=1440*60*1e3;async function UL(e,t){const r=localStorage.getItem(ch),n=Date.now();if(r){const p=parseInt(r,10);if(!isNaN(p)&&n-p<Gb)return null}if(t===0)return localStorage.setItem(ch,n.toString()),{deletedCompletions:0,deletedArrangements:0,deletedSessions:0};const a=new Date;a.setMonth(a.getMonth()-t);const s={deletedCompletions:0,deletedArrangements:0,deletedSessions:0},l=e.completions.filter(p=>p.timestamp?new Date(p.timestamp)<a:!1);s.deletedCompletions=l.length;const d=e.arrangements.filter(p=>p.createdAt?new Date(p.createdAt)<a:!1);s.deletedArrangements=d.length;const m=e.daySessions.filter(p=>p.date?new Date(p.date)<a:!1);return s.deletedSessions=m.length,localStorage.setItem(ch,n.toString()),s}function $L(e,t){if(t===0)return e;const r=new Date;r.setMonth(r.getMonth()-t);const n=e.completions.filter(l=>l.timestamp?new Date(l.timestamp)>=r:!0),a=e.arrangements.filter(l=>l.createdAt?new Date(l.createdAt)>=r:!0),s=e.daySessions.filter(l=>l.date?new Date(l.date)>=r:!0);return{...e,completions:n,arrangements:a,daySessions:s}}function WL(){const e=localStorage.getItem(ch);if(!e)return!0;const t=parseInt(e,10);return isNaN(t)?!0:Date.now()-t>=Gb}async function qm(e,t,r){if(!(!e.user||!r)){if(ro("navigator_restore_in_progress")){le.info("🛡️ RESTORE PROTECTION: Skipping session reconciliation to prevent data loss");return}try{le.info("Post-restore: Reconciling session state with cloud...");const{data:n,error:a}=await r.from("navigator_state").select("data").eq("user_id",e.user.id).maybeSingle();if(a||!n?.data){le.warn("No cloud state found for session reconciliation");return}const l=sh(n.data).daySessions||[];t(d=>({...d,daySessions:l})),le.info("Session state reconciled with cloud successfully")}catch(n){le.error("Failed to reconcile session state:",n)}}}class Ey extends Z.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,msg:String(t)}}render(){return this.state.hasError?u.jsxs("div",{className:"container",style:{paddingTop:"4rem"},children:[u.jsx("h2",{children:"Something went wrong"}),u.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:this.state.msg})]}):this.props.children}}async function Vo(e,t="manual",r=0){if(!Ve)throw le.error("Supabase not configured for backup"),new Error("Supabase not configured");const n=await Ve.auth.getUser(),a=n&&n.data&&n.data.user?n.data.user.id:void 0;if(!a)throw le.error("User not authenticated for backup"),new Error("User not authenticated");const s="Europe/London",l=new Date,d=l.toLocaleDateString("en-GB",{timeZone:s,year:"numeric"}),m=l.toLocaleDateString("en-GB",{timeZone:s,month:"2-digit"}),p=l.toLocaleDateString("en-GB",{timeZone:s,day:"2-digit"}),g=`${d}-${m}-${p}`,y=l.toLocaleTimeString("en-GB",{timeZone:s,hour12:!1}).replace(/:/g,""),_="navigator-backups",T=`backup_${g}_${y}_${t}_retry${r}.json`,S=`${a}/${g}/${T}`;try{const w=new Blob([JSON.stringify(e,null,2)],{type:"application/json"});le.info(`Uploading backup to ${S}, size: ${w.size} bytes`);const E=await Ve.storage.from(_).upload(S,w,{upsert:!0,contentType:"application/json",cacheControl:"3600"});if(E.error)throw le.error("Backup upload failed:",E.error),new Error(E.error.message);const P=`${a}/latest.json`,D=await Ve.storage.from(_).upload(P,w,{upsert:!0,contentType:"application/json",cacheControl:"1800"});D.error&&le.warn("Latest backup upload failed (non-critical):",D.error),le.info("Backup upload successful:",S);try{await Ve.from("backups").insert({user_id:a,day_key:g,object_path:S,size_bytes:w.size}),le.info("Backup database record created")}catch(A){le.warn("Backups table insert failed (non-critical):",A instanceof Error?A.message:A)}return{objectPath:S,size:w.size}}catch(w){if(le.error(`Backup attempt ${r+1} failed:`,w),r<2){const E=Math.pow(2,r)*1e3;return le.info(`Retrying backup in ${E}ms...`),await new Promise(P=>setTimeout(P,E)),Vo(e,t,r+1)}throw new Error(`Backup failed after ${r+1} attempts: ${w.message}`)}}function ah({title:e,value:t,change:r,changeType:n,icon:a,iconType:s}){return u.jsxs("div",{className:"stat-card-modern",children:[u.jsxs("div",{className:"stat-header",children:[u.jsx("div",{className:"stat-title",children:e}),u.jsx("div",{className:`stat-icon ${s}`,children:a})]}),u.jsx("div",{className:"stat-value",children:t}),r&&u.jsxs("div",{className:`stat-change ${n||"neutral"}`,children:[n==="positive"&&u.jsx("span",{children:"↑"}),n==="negative"&&u.jsx("span",{children:"↓"}),u.jsx("span",{children:r})]})]})}function HL(){const e=u_(),[t,r]=Z.useState(!1),[n,a]=Z.useState(!1);return Z.useEffect(()=>{if(e.isLoading){const s=setTimeout(()=>r(!0),500),l=setTimeout(()=>{navigator.onLine||(le.warn("🔌 OFFLINE: Force skipping loading screen to allow local data access"),a(!0))},3e3),d=setTimeout(()=>{le.warn("⏱️ TIMEOUT: Force skipping loading screen after 10 seconds"),a(!0)},1e4);return()=>{clearTimeout(s),clearTimeout(l),clearTimeout(d)}}else r(!1),a(!1)},[e.isLoading]),e.isLoading&&t&&!n?u.jsx("div",{className:"app-wrapper",children:u.jsx("div",{className:"main-area",children:u.jsx("div",{className:"content-area",children:u.jsxs("div",{className:"loading",children:[u.jsx("div",{className:"spinner"}),u.jsx("div",{children:"Restoring session..."}),!e.isOnline&&u.jsx("div",{style:{marginTop:"1rem",color:"var(--warning)",fontSize:"0.875rem"},children:"📡 You appear to be offline. Loading local data..."})]})})})}):e.user?u.jsx(Ey,{children:u.jsx(QE,{children:u.jsx(VL,{})})}):u.jsx(Ey,{children:u.jsx(tC,{onSignIn:async(s,l)=>{await e.signIn(s,l)},onSignUp:async(s,l)=>{await e.signUp(s,l)},onResetPassword:async s=>{await e.resetPassword(s)},isLoading:e.isLoading,error:e.error,onClearError:e.clearError})})}function VL(){const e=u_(),{state:t,loading:r,setAddresses:n,addAddress:a,setActive:s,cancelActive:l,complete:d,undo:m,startDay:p,endDay:g,backupState:y,restoreState:_,addArrangement:T,updateArrangement:S,deleteArrangement:w,setState:E,setBaseState:P,deviceId:D,enqueueOp:A,updateReminderSettings:H,updateBonusSettings:J,ownerMetadata:B}=V2(e.user?.id),{confirm:I,alert:ee}=eC(),{settings:re}=Op(),{hasAccess:ye}=Rp(e.user),{isAdmin:he,isOwner:ce}=E_(e.user),[Ee,je]=Z.useState(!1),[fe,ue]=Z.useState(!1),[O,F]=Z.useState(!1),[M,ie]=Z.useState(!1),[Y,R]=Z.useState(!1),[z,U]=Z.useState(!1),[te,W]=Z.useState(!1),[ae,oe]=Z.useState(!1),[de,ge]=Z.useState(!1),Oe=()=>{const Ie=window.location.hash.slice(1);return["list","completed","arrangements","earnings","planning"].includes(Ie)?Ie:"list"},[q,Ze]=Z.useState(Oe),[Je,Ye]=Z.useState(""),[nt,Be]=Z.useState(null),[bt,dt]=Z.useState(!1),ht=Z.useRef(null);Z.useEffect(()=>{const Ie=()=>{const Le=Oe();Ze(Le)};return window.addEventListener("popstate",Ie),()=>window.removeEventListener("popstate",Ie)},[]),Z.useEffect(()=>{bt&&localStorage.getItem("navigator_ownership_uncertain")==="true"&&ge(!0)},[bt]),Z.useEffect(()=>{(async()=>{try{await qu.requestPersistentStorage(),le.info("PWA initialized successfully")}catch(Le){le.error("PWA initialization failed:",Le)}})()},[]),Z.useEffect(()=>{(async()=>{if(!WL())return;const Le=await UL(t,re.keepDataForMonths);if(Le&&(Le.deletedCompletions>0||Le.deletedArrangements>0)){const De=$L(t,re.keepDataForMonths);E(De),console.log(`Data cleanup completed: ${Le.deletedCompletions} completions, ${Le.deletedArrangements} arrangements, ${Le.deletedSessions} sessions removed`)}})()},[]);const Kt=Z.useCallback(Ie=>{Ie!==q&&(Ze(Ie),window.history.pushState({tab:Ie},"",`#${Ie}`))},[q]),[In,zr]=Z.useState(!1),[Er,fn]=Z.useState([]),[Fr,sn]=Z.useState(!1),[Qt,Cr]=Z.useState(null),pt=Array.isArray(t.addresses)?t.addresses:[],At=Array.isArray(t.completions)?t.completions:[],Ar=Array.isArray(t.arrangements)?t.arrangements:[],Zt=Array.isArray(t.daySessions)?t.daySessions:[],ct=Z.useMemo(()=>({...t,addresses:pt,completions:At,arrangements:Ar,daySessions:Zt}),[t,pt,At,Ar,Zt]),li=Z.useRef(ct);Z.useEffect(()=>{li.current=ct},[ct]);const ci=Z.useRef(B);Z.useEffect(()=>{ci.current=B},[B]);function Wn(Ie,Le="Europe/London"){const De=Ie.toLocaleDateString("en-GB",{timeZone:Le,year:"numeric"}),j=Ie.toLocaleDateString("en-GB",{timeZone:Le,month:"2-digit"}),Q=Ie.toLocaleDateString("en-GB",{timeZone:Le,day:"2-digit"});return`${De}-${j}-${Q}`}const ui=Z.useCallback(async()=>{if(!Ve){Cr("Supabase not configured");return}sn(!0),Cr(null);try{const Le=(await Ve.auth.getUser())?.data?.user?.id;if(!Le)throw new Error("Not authenticated");const De=new Date,j=new Date;j.setDate(j.getDate()-6);const Q=Wn(j),K=Wn(De),X=await Ve.from("backups").select("object_path,size_bytes,created_at,day_key").eq("user_id",Le).gte("day_key",Q).lte("day_key",K).order("day_key",{ascending:!1}).order("created_at",{ascending:!1});if(X.error)throw X.error;const ne=X.data??[];fn(ne)}catch(Ie){Cr(Ie?.message||String(Ie))}finally{sn(!1)}},[]),di=Z.useCallback(async Ie=>{if(!Ve){await ee({title:"Configuration Error",message:"Supabase is not configured.",type:"error"});return}const Le=Ie.split("/").pop()||Ie;if(await I({title:"Restore from Cloud",message:`Restore "${Le}" from cloud?

This will overwrite your current data.`,confirmText:"Restore",cancelText:"Cancel",type:"warning"})){sn(!0),Cr(null);try{const Q=await Ve.storage.from("navigator-backups").download(Ie);if(Q.error)throw Q.error;const X=await Q.data.text(),ne=JSON.parse(X),se=Sm(ne),be=ct.daySessions,Ce={...se,daySessions:be};_(Ce),setTimeout(async()=>{await e.syncData(Ce),ht.current=JSON.stringify(Ce)},31e3),await qm(e,E,Ve),dt(!0),await ee({title:"Success",message:"Successfully restored from cloud",type:"success"}),zr(!1)}catch(j){Cr(j?.message||String(j))}finally{sn(!1)}}},[e,_,ee,I]),va=Z.useRef(null),hn=Z.useRef(!1);Z.useEffect(()=>{if(e.user?.id){const Ie=localStorage.getItem("navigator_expected_user_id");!Ie||Ie!==e.user.id?(le.info(`🔒 SECURITY: Setting expected user ID: ${e.user.id}`),localStorage.setItem("navigator_expected_user_id",e.user.id),va.current=e.user.id):va.current=Ie}},[e.user?.id]),Z.useEffect(()=>{const Ie=e.user;if(!Ie||r)return;if(!e.isOnline){le.info("🔌 OFFLINE: Skipping bootstrap sync, using local data only"),localStorage.getItem("navigator_offline_mode")==="true"&&le.info("🔌 ONLINE RESTORED: Clearing offline mode, will re-authenticate"),dt(!0);return}if(localStorage.removeItem("navigator_offline_mode"),!Ve){dt(!0);return}if(hn.current){le.warn("🔒 SECURITY: Bootstrap sync already in progress, skipping");return}let Le=!1,De;const j=()=>li.current,Q=()=>ci.current;return(async()=>{try{hn.current=!0;const K=Ie.id,X=localStorage.getItem("navigator_expected_user_id");if(X&&X!==K){le.error(`🚨 SESSION POISONING DETECTED: Expected ${X}, got ${K}`);const _e={timestamp:new Date().toISOString(),expectedUserId:X,actualUserId:K,localState:j(),reason:"session_poisoning_detected"};localStorage.setItem(`navigator_emergency_backup_${Date.now()}`,JSON.stringify(_e)),await ee({title:"⚠️ Security Alert: Session Mismatch",message:"Detected session for different user. Your data has been backed up. Please sign out and sign in again.",type:"error"}),await e.signOut();return}const ne=localStorage.getItem("navigator_active_protection"),se=j().activeIndex;if(ne&&se!==null){le.info(`🛡️ ACTIVE PROTECTION: Skipping bootstrap sync - user has active address #${se}`),dt(!0);return}const Ce=(await Ve.from("navigator_state").select("data, updated_at, version").eq("user_id",K).maybeSingle()).data;if(Ce&&Ce.data&&Ce.data._ownerUserId&&Ce.data._ownerUserId!==K){le.error(`🚨 DATA CONTAMINATION: Cloud state has wrong owner! Expected ${K}, found ${Ce.data._ownerUserId}`),await ee({title:"⚠️ Data Security Error",message:"Cloud data ownership mismatch detected. Using local data only.",type:"error"}),dt(!0);return}if(Ce&&Ce.data){const _e=sh(Ce.data);if(!Le){const xe=j(),ke=Array.isArray(xe.addresses)?xe.addresses:[],Re=Array.isArray(xe.completions)?xe.completions:[],Ke=Array.isArray(xe.arrangements)?xe.arrangements:[],et=Array.isArray(xe.daySessions)?xe.daySessions:[];if(ke.length>0||Re.length>0||Ke.length>0||et.length>0){const Ue=Re.length,st=_e.completions?.length||0,$t=Ce.updated_at?new Date(Ce.updated_at):new Date(0),Wt=new Date(Date.now()-7200*1e3),ar=Re.some(mn=>mn.timestamp&&new Date(mn.timestamp)>Wt);if(le.sync("🔍 SESSION RESTORATION ANALYSIS:",{localCompletions:Ue,cloudCompletions:st,cloudLastUpdated:$t.toISOString(),hasRecentLocalActivity:ar,willMerge:Ue>0||ar}),Ue>st||ar){le.sync("🛡️ DATA PROTECTION: Local data appears newer, merging states to prevent loss");const mn=j(),Yr=c_(mn,_e);E(Yr),ht.current=JSON.stringify(Yr),setTimeout(async()=>{if(Le){le.sync("🛑 Bootstrap sync cancelled before queued merge sync ran");return}try{await e.syncData(Yr),le.sync("✅ Synced merged state back to cloud")}catch(Dn){le.error("Failed to sync merged state:",Dn)}},1e3)}else le.sync("☁️ Using cloud state (appears more complete)"),E(_e),ht.current=JSON.stringify(_e)}else le.sync("☁️ No local data, using cloud state"),E(_e),ht.current=JSON.stringify(_e);dt(!0),le.sync("Session restored, version:",Ce?.version)}}else{const _e=j(),xe=Array.isArray(_e.addresses)?_e.addresses:[],ke=Array.isArray(_e.completions)?_e.completions:[],Re=Array.isArray(_e.arrangements)?_e.arrangements:[],Ke=Array.isArray(_e.daySessions)?_e.daySessions:[];if(xe.length>0||ke.length>0||Re.length>0||Ke.length>0){le.info("Analyzing data ownership for current user...");try{let We=null;try{const{data:st}=await Ve.from("navigator_state").select("data").eq("user_id",Ie.id).maybeSingle();We=st?.data}catch(st){le.warn("Could not fetch cloud data for analysis:",st)}const Ue=Ei.analyzeDataOwnership(j(),Ie,We,Q());switch(le.info("Data ownership analysis:",Ue),Ue.action){case"sync":{le.sync("Syncing local data to cloud (ownership confirmed)");const st=j();await e.syncData(st),Ei.storeDeviceContext(Ie),Le||(ht.current=JSON.stringify(st),dt(!0));break}case"backup_and_clear":{le.warn("Creating safety backup before clearing (different user detected)");try{const st=`navigator_safety_backup_${Date.now()}_user_switch`,Wt={...j(),_backup_timestamp:new Date().toISOString(),_backup_reason:"user_switch",_ownership_analysis:Ue};localStorage.setItem(st,JSON.stringify(Wt)),le.info(`Safety backup created: ${st}`),E({addresses:[],completions:[],arrangements:[],daySessions:[],activeIndex:null,currentListVersion:1}),Ei.storeDeviceContext(Ie),Le||dt(!0)}catch(st){le.error("Backup failed - preserving data for safety:",st),Ei.storeDeviceContext(Ie),Le||dt(!0)}break}case"preserve_and_ask":default:le.info("Preserving local data (uncertain ownership) - user must decide before syncing"),localStorage.setItem("navigator_ownership_uncertain","true"),Ei.storeDeviceContext(Ie),Le||dt(!0);break}}catch(We){le.error("User detection analysis failed - preserving data for safety:",We);const Ue=j();await e.syncData(Ue),Ei.storeDeviceContext(Ie),Le||(ht.current=JSON.stringify(Ue),dt(!0))}}else Ei.storeDeviceContext(Ie),Le||dt(!0)}if(Le){le.sync("🛑 Bootstrap sync cancelled before subscribing to cloud updates");return}De=e.subscribeToData(_e=>{if(_e){if(ro("navigator_restore_in_progress")){le.sync("🛡️ RESTORE PROTECTION: App.tsx subscription skipping cloud state update to prevent data loss");return}if(ro("navigator_import_in_progress")){le.sync("🛡️ IMPORT PROTECTION: App.tsx subscription skipping cloud state update to prevent import override");return}if(typeof _e=="function")le.sync("Received cloud update (React updater)"),E(xe=>{const ke=_e(xe),Re=sh(ke),Ke=JSON.stringify(Re);return ht.current=Ke,Re}),dt(!0);else{const xe=JSON.stringify(_e);if(xe===ht.current)return;const ke=sh(_e);le.sync("Received cloud update (direct state)"),E(ke),ht.current=xe,dt(!0)}}})}catch(K){le.error("Bootstrap sync failed:",K),Le||dt(!0)}finally{hn.current=!1}})(),()=>{Le=!0,hn.current=!1,De&&De()}},[e.user,e.isOnline,r,ee]),Z.useEffect(()=>{if(!e.user||r||!bt)return;const Ie=JSON.stringify(ct),Le=ht.current;if(ht.current=Ie,Ie===Le)return;const De=setTimeout(async()=>{try{if(ro("navigator_restore_in_progress")){le.sync("🛡️ RESTORE PROTECTION: Debounced sync skipping to prevent data loss");return}if(ro("navigator_import_in_progress",300)){le.sync("🛡️ IMPORT PROTECTION: Waiting 300ms for import state to settle before sync");return}le.sync("Syncing changes to cloud..."),await e.syncData(ct),le.sync("Sync completed successfully")}catch(j){le.error("Sync failed:",j),ht.current=Le;const Q=5e3;le.sync(`🔄 Scheduling sync retry in ${Q/1e3}s...`),setTimeout(async()=>{try{le.sync("🔄 Attempting sync retry..."),await e.syncData(ct),le.sync("✅ Sync retry successful"),ht.current=JSON.stringify(ct)}catch(K){le.error("Sync retry also failed:",K)}},Q)}},500);return()=>clearTimeout(De)},[ct,e,bt,r]),Z.useEffect(()=>{if(!e.user||r||!bt)return;let Ie=JSON.stringify(ct);const Le=async()=>{const K=JSON.stringify(ct);if(K!==Ie&&(ct.completions.length>0||ct.addresses.length>0))try{le.info("Performing periodic safety backup..."),await Vo(ct,"manual"),Ie=K,le.info("Periodic backup successful")}catch(X){le.error("Periodic backup failed:",X)}},De=setInterval(Le,10800*1e3),j=localStorage.getItem("last_backup_time"),Q=Date.now();return(!j||Q-parseInt(j)>3600*1e3)&&setTimeout(async()=>{await Le(),localStorage.setItem("last_backup_time",Q.toString())},5e3),()=>clearInterval(De)},[ct,e.user,bt,r]),Z.useEffect(()=>{if(!e.user||r||!bt)return;const Ie=()=>{const De=ct.completions.length,j=ct.addresses.length,Q=localStorage.getItem("navigator_data_counts");if(Q){const{completions:K,addresses:X}=JSON.parse(Q);if(e.isSyncing){le.info("Skipping data integrity check - cloud sync in progress");return}const ne=120*1e3,be=(e.lastSyncTime?Date.now()-e.lastSyncTime.getTime():1/0)<ne,Ce=be?50:10,_e=be?200:50;De<K-Ce&&(le.error(`POTENTIAL DATA LOSS DETECTED: Completions dropped from ${K} to ${De}`),be?le.warn(`Large completion count change during recent sync (${K} → ${De}) - monitoring`):ee({title:"⚠️ POTENTIAL DATA LOSS",message:`Completions count dropped significantly (${K} → ${De}). Check cloud backups immediately!`,type:"error"})),j<X-_e&&(le.error(`POTENTIAL DATA LOSS DETECTED: Addresses dropped from ${X} to ${j}`),be?le.warn(`Large address count change during recent sync (${X} → ${j}) - monitoring`):ee({title:"⚠️ POTENTIAL DATA LOSS",message:`Address count dropped significantly (${X} → ${j}). Check cloud backups immediately!`,type:"error"}))}localStorage.setItem("navigator_data_counts",JSON.stringify({completions:De,addresses:j,timestamp:new Date().toISOString()}))},Le=setInterval(Ie,30*1e3);return setTimeout(Ie,3e3),()=>clearInterval(Le)},[ct,e.user,e.isSyncing,e.lastSyncTime,bt,r]);const sr=Z.useMemo(()=>{const Ie=t.currentListVersion,Le=new Set(At.filter(xe=>xe.listVersion===Ie).map(xe=>xe.index)),De=pt.length,j=De-Le.size,Q=At.filter(xe=>xe.listVersion===Ie&&xe.outcome==="PIF").length,K=At.filter(xe=>xe.listVersion===Ie&&xe.outcome==="Done").length,X=At.filter(xe=>xe.listVersion===Ie&&xe.outcome==="DA").length,ne=At.filter(xe=>xe.listVersion===Ie&&xe.outcome==="ARR").length,se=Le.size,be=Ar.filter(xe=>xe.status!=="Completed"&&xe.status!=="Cancelled").length,Ce=new Date().toISOString().slice(0,10),_e=At.filter(xe=>xe.outcome==="PIF"&&(xe.timestamp||"").slice(0,10)===Ce).reduce((xe,ke)=>xe+parseFloat(ke.amount||"0"),0);return{total:De,pending:j,completed:se,pifCount:Q,doneCount:K,daCount:X,arrCount:ne,pendingArrangements:be,todaysPIF:_e}},[pt,At,Ar,t.currentListVersion]),za=Z.useCallback(Ie=>{le.info(`Importing ${Ie.length} addresses...`),n(Ie,!0)},[n]),fi=Z.useCallback(async(Ie,Le,De,j,Q,K)=>{try{await d(Ie,Le,De,j,Q,K);try{const X=y();Ve&&(await Vo(X,"manual"),le.info("Cloud backup after completion successful")),ni.storeLocalBackup(X),le.info("Local storage backup after completion successful")}catch(X){le.error("Backup failed after completion:",X)}}catch(X){le.error("Failed to complete address:",X)}},[d,y]),ms=Z.useCallback(Ie=>{const Le=typeof Ie=="string"?new Date(Ie):Ie;if(Number.isNaN(Le.getTime())){le.error("Invalid start date:",Ie);return}const De=Le.toISOString(),j=De.slice(0,10);P(Q=>{const K=Q.daySessions.slice();let X=K.findIndex(_e=>_e.date===j),ne;if(X>=0?ne={...K[X],start:De}:ne={date:j,start:De},ne.end)try{const _e=new Date(De).getTime(),xe=new Date(ne.end).getTime();xe>=_e?ne.durationSeconds=Math.floor((xe-_e)/1e3):(delete ne.end,delete ne.durationSeconds)}catch(_e){le.error("Error calculating duration:",_e)}const se=new Date().toISOString();ne.updatedAt=se,ne.updatedBy=D;const be=`edit_start_${j}_${Date.now()}`,Ce={...ne,id:j,updatedAt:se,updatedBy:D};return A("session",X>=0?"update":"create",Ce,be),X>=0?K[X]=ne:K.push(ne),{...Q,daySessions:K}})},[P,D,A]),ps=Z.useCallback(Ie=>{const Le=typeof Ie=="string"?new Date(Ie):Ie;if(Number.isNaN(Le.getTime())){le.error("Invalid end date:",Ie);return}const De=Le.toISOString(),j=De.slice(0,10);P(Q=>{const K=Q.daySessions.slice();let X=K.findIndex(_e=>_e.date===j),ne;if(X>=0?ne={...K[X]}:ne={date:j,start:De},ne.end=De,ne.start)try{const _e=new Date(ne.start).getTime(),xe=new Date(De).getTime();xe>=_e?ne.durationSeconds=Math.floor((xe-_e)/1e3):(ne.start=De,ne.durationSeconds=0)}catch(_e){le.error("Error calculating duration:",_e),ne.durationSeconds=0}const se=new Date().toISOString();ne.updatedAt=se,ne.updatedBy=D;const be=`edit_end_${j}_${Date.now()}`,Ce={...ne,id:j,updatedAt:se,updatedBy:D};return A("session",X>=0?"update":"create",Ce,be),X>=0?K[X]=ne:K.push(ne),{...Q,daySessions:K}})},[P,D,A]),gs=async Ie=>{const Le=Ie.target.files?.[0];if(Le)try{const De=await MC(Le),j=Sm(De),Q=ct.daySessions,K={...j,daySessions:Q};_(K),setTimeout(async()=>{await e.syncData(K),ht.current=JSON.stringify(K)},31e3),await qm(e,E,Ve),dt(!0),await ee({title:"Success",message:"Restore completed successfully!",type:"success"})}catch(De){le.error("Restore failed:",De),await ee({title:"Error",message:"Restore failed: "+(De?.message||De),type:"error"})}finally{Ie.target.value=""}},Ri=Z.useCallback(async(Ie,Le,De,j)=>{E(Q=>{if(!Number.isInteger(Ie)||Ie<0||Ie>=Q.completions.length)return Q;const K=Q.completions.slice(),X={...K[Ie],outcome:Le,amount:De};return j!==void 0&&(X.arrangementId=j),K[Ie]=X,{...Q,completions:K}});try{await new Promise(K=>setTimeout(K,100));const Q=y();Ve&&(await Vo(Q,"manual"),le.info("Cloud backup after outcome change successful")),ni.storeLocalBackup(Q),le.info("Local storage backup after outcome change successful")}catch(Q){le.error("Backup failed after outcome change:",Q)}},[E,y]),hi=Z.useCallback(async()=>{try{le.sync("Manual sync initiated...");const Ie=JSON.stringify(ct);if(ro("navigator_restore_in_progress")){le.sync("🛡️ RESTORE PROTECTION: Manual sync blocked to prevent data loss"),await ee({title:"Restore in Progress",message:"Please wait 30 seconds before manual sync to prevent data loss"});return}ht.current=Ie,await e.syncData(ct),le.sync("Manual sync completed successfully");try{await Vo(ct,"manual"),le.info("Safety backup after manual sync completed")}catch(Le){le.warn("Safety backup after sync failed:",Le)}}catch(Ie){le.error("Manual sync failed:",Ie),ht.current=""}},[e,ct]),Ua=(Ie,Le)=>{localStorage.setItem("navigator_supabase_url",Ie),localStorage.setItem("navigator_supabase_key",Le),window.location.reload()},Li=()=>{localStorage.setItem("navigator_supabase_skipped","true"),ie(!1)};Z.useEffect(()=>{if(!e.user||r)return;const Ie=!!Ve,Le=localStorage.getItem("navigator_supabase_skipped");!Ie&&!Le&&ie(!0)},[e.user,r]),Z.useEffect(()=>{if(!bt)return;let Ie=JSON.stringify(ct);const Le=async()=>{const K=JSON.stringify(ct);if(K!==Ie&&(ct.completions.length>0||ct.addresses.length>0))try{le.info("Performing periodic safety backup..."),e.user&&Ve&&await Vo(ct,"periodic"),ni.storeLocalBackup(ct),Ie=K,le.info("Periodic backup successful")}catch(X){le.error("Periodic backup failed:",X)}},De=setInterval(Le,10800*1e3),j=setInterval(()=>{ni.cleanupOldBackups()},10080*60*1e3),Q=ni.getBackupStats();return(Q.count===0||ct.completions.length>0&&Q.count<3)&&setTimeout(async()=>{await Le()},5e3),()=>{clearInterval(De),clearInterval(j)}},[ct,e.user,bt]);const ea=()=>{const Ie=e.user?.email||"",Le=Ie.split("@")[0].split(".");return Le.length>=2?(Le[0][0]+Le[1][0]).toUpperCase():Ie.slice(0,2).toUpperCase()};return r?u.jsx("div",{className:"app-wrapper",children:u.jsx("div",{className:"main-area",children:u.jsx("div",{className:"content-area",children:u.jsxs("div",{className:"loading",children:[u.jsx("div",{className:"spinner"}),"Preparing your workspace..."]})})})}):u.jsxs("div",{className:"app-wrapper",children:[u.jsx(TL,{isOpen:M,onSetupComplete:Ua,onSkip:Li}),u.jsx(EL,{isOpen:Y,onClose:()=>R(!1),currentData:ct,onRestore:Ie=>{const Le=Sm(Ie),De=ct.daySessions,j={...Le,daySessions:De};_(j),e.user&&Ve&&(setTimeout(async()=>{await e.syncData(j)},31e3),qm(e,E,Ve))}}),fe&&he&&u.jsx(JC,{user:e.user,onClose:()=>ue(!1)}),Ee&&u.jsx(YC,{user:e.user,onClose:()=>je(!1)}),u.jsxs("main",{className:"main-area",children:[!e.isOnline&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #FFA500, #FF8C00)",color:"white",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 2px 8px rgba(255, 140, 0, 0.3)",zIndex:100},children:[u.jsx("span",{children:"📡"}),u.jsx("span",{children:"Working Offline - Changes will sync when connection returns"})]}),localStorage.getItem("navigator_offline_mode")==="true"&&u.jsxs("div",{style:{background:"linear-gradient(135deg, #9C27B0, #7B1FA2)",color:"white",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 2px 8px rgba(156, 39, 176, 0.3)",zIndex:100},children:[u.jsx("span",{children:"⚡"}),u.jsx("span",{children:"Offline Mode - Sign in when online to sync data"})]}),u.jsxs("header",{className:"app-header-modern",children:[u.jsxs("div",{className:"header-left",children:[u.jsxs("div",{className:"logo-section",children:[u.jsx("div",{className:"logo-icon",children:"📍"}),u.jsxs("div",{className:"logo-text",children:[u.jsx("div",{className:"logo-title",children:"Navigator"}),u.jsx("div",{className:"logo-subtitle",children:"Enforcement Pro"})]})]}),q==="list"&&u.jsxs("div",{className:"search-container-modern",children:[u.jsx("span",{className:"search-icon",children:"🔍"}),u.jsx("input",{id:"search-addresses",name:"searchAddresses",type:"search",className:"search-input-modern",placeholder:"Search addresses...",value:Je,onChange:Ie=>Ye(Ie.target.value)})]})]}),u.jsxs("div",{className:"header-center",children:[u.jsx(BL,{isOnline:e.isOnline,isSyncing:e.isSyncing,lastSyncTime:e.lastSyncTime,onForceSync:e.forceFullSync}),u.jsx(OL,{reminderSettings:t.reminderSettings,onUpdateReminderSettings:H,bonusSettings:t.bonusSettings,onUpdateBonusSettings:J,onChangePassword:()=>U(!0),onChangeEmail:()=>W(!0),onDeleteAccount:()=>oe(!0),onResolveDataOwnership:()=>{ge(!0)},hasOwnershipIssue:localStorage.getItem("navigator_ownership_uncertain")==="true",appState:t,userEmail:e.user?.email,onImportExcel:async Ie=>{try{const Le=await oi(()=>Promise.resolve().then(()=>_L),void 0),De=await Ie.arrayBuffer(),j=Le.read(De,{type:"array"}),Q=j.Sheets[j.SheetNames[0]],K=Le.utils.sheet_to_json(Q,{header:1});if(!K.length){ee({message:"📄 File appears to be empty. Please check your Excel file."});return}const X=(K[0]||[]).map(ke=>String(ke??"").trim().toLowerCase());let ne=X.findIndex(ke=>ke.includes("address"));ne===-1&&(ne=0);const se=X.findIndex(ke=>ke==="lat"||ke.includes("latitude")),be=X.findIndex(ke=>ke==="lng"||ke==="lon"||ke.includes("longitude")),Ce=se===-1?void 0:se,_e=be===-1?void 0:be,xe=[];for(let ke=1;ke<K.length;ke++){const Re=K[ke]||[],Ke=String(Re[ne]??"").trim();if(!Ke)continue;const et=Ce!==void 0&&Re[Ce]!=null&&Re[Ce]!==""?Number(Re[Ce]):void 0,We=_e!==void 0&&Re[_e]!=null&&Re[_e]!==""?Number(Re[_e]):void 0;xe.push({address:Ke,lat:et,lng:We})}if(xe.length===0){ee({message:"🚫 No valid addresses found in the file. Please check the format."});return}za(xe),console.log(`✅ Successfully imported ${xe.length} addresses!`)}catch(Le){console.error(Le),ee({message:"❌ Failed to read Excel file. Please ensure it's a valid .xlsx or .xls file."})}},onRestoreBackup:gs,onManualSync:hi,isSyncing:e.isSyncing,onShowBackupManager:()=>R(!0),onShowCloudBackups:async()=>{zr(!0),await ui()},onShowSubscription:()=>je(!0),onShowSupabaseSetup:()=>ie(!0),onSignOut:e.signOut,hasSupabase:!!Ve})]}),u.jsx("button",{className:"menu-toggle",onClick:()=>F(!O),children:"☰"})]}),u.jsxs("div",{className:"content-area",children:[q==="list"&&u.jsxs(u.Fragment,{children:[u.jsx(OC,{sessions:Zt,completions:At,startDay:p,endDay:g,onEditStart:ms,onEditEnd:ps,onBackup:async()=>{const Ie=y(),Le=De=>new Promise((j,Q)=>setTimeout(()=>Q(new Error("Backup timeout")),De));try{Ve&&(await Promise.race([Vo(Ie,"finish"),Le(3e4)]),le.info("Cloud backup at day end successful")),await Promise.race([ni.performCriticalBackup(Ie,"day-end"),Le(15e3)]),le.info("Local backup at day end successful")}catch(De){throw le.error("Backup failed or timed out:",De),De}}}),u.jsxs("div",{className:"stats-grid",children:[u.jsx(ah,{title:"Pending Addresses",value:sr.pending,change:`${sr.completed} completed today`,changeType:"positive",icon:"📍",iconType:"info"}),u.jsx(ah,{title:"Today's Earnings",value:`£${sr.todaysPIF.toFixed(0)}`,change:`${sr.pifCount} PIF today`,changeType:"positive",icon:"💰",iconType:"success"}),u.jsx(ah,{title:"Arrangements Due",value:sr.pendingArrangements,change:"Check arrangements tab",changeType:"neutral",icon:"📅",iconType:"warning"}),u.jsx(ah,{title:"Completion Rate",value:`${Math.round(sr.completed/Math.max(sr.total,1)*100)}%`,change:"Good performance",changeType:"positive",icon:"📊",iconType:"success"})]}),u.jsx(kC,{state:ct,setActive:s,cancelActive:l,onComplete:fi,onAddArrangement:T,filterText:Je}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem",margin:"1.25rem 0 3rem",flexWrap:"wrap",alignItems:"center"},children:[u.jsx("button",{className:"btn btn-ghost",onClick:()=>m(-1),title:"Undo last completion",children:"↶ Undo Last"}),u.jsxs("span",{className:"pill pill-pif",children:["PIF ",sr.pifCount]}),u.jsxs("span",{className:"pill pill-done",children:["Done ",sr.doneCount]}),u.jsxs("span",{className:"pill pill-da",children:["DA ",sr.daCount]}),u.jsxs("span",{className:"pill pill-active",children:["ARR ",sr.arrCount]})]})]}),q==="completed"&&u.jsx(IC,{state:ct,onChangeOutcome:Ri,onAddArrangement:T,onComplete:fi}),q==="arrangements"&&u.jsx(LC,{state:ct,onAddArrangement:T,onUpdateArrangement:S,onDeleteArrangement:w,onAddAddress:async Ie=>a(Ie),onComplete:fi,autoCreateForAddress:nt,onAutoCreateHandled:()=>Be(null)}),q==="earnings"&&u.jsx(tA,{state:ct,user:e.user}),q==="planning"&&u.jsx(SL,{user:e.user,onAddressesReady:Ie=>{n(Ie,!1)}})]}),u.jsx(BC,{onAdd:a})]}),u.jsxs("aside",{className:`sidebar-right ${O?"open":""}`,children:[u.jsx("div",{className:"sidebar-header",children:u.jsxs("div",{className:"user-profile-section",children:[u.jsx("div",{className:"user-avatar",children:ea()}),u.jsxs("div",{className:"user-info",children:[u.jsx("div",{className:"user-name",children:e.user?.email?.split("@")[0]}),u.jsx("div",{className:"user-plan",children:ce?"Owner Access":ye?"Premium Plan":"Free Trial"})]})]})}),u.jsxs("nav",{className:"nav-menu",children:[u.jsxs("div",{className:"nav-section",children:[u.jsx("div",{className:"nav-section-title",children:"Main"}),u.jsxs("div",{className:`nav-item ${q==="list"?"active":""}`,onClick:()=>{Kt("list"),F(!1)},children:[u.jsx("span",{className:"nav-icon",children:"📋"}),u.jsx("span",{children:"Address List"}),u.jsx("span",{className:"nav-badge",children:sr.pending})]}),u.jsxs("div",{className:`nav-item ${q==="completed"?"active":""}`,onClick:()=>{Kt("completed"),F(!1)},children:[u.jsx("span",{className:"nav-icon",children:"✅"}),u.jsx("span",{children:"Completed"}),u.jsx("span",{className:"nav-badge",children:sr.completed})]}),u.jsxs("div",{className:`nav-item ${q==="arrangements"?"active":""}`,onClick:()=>{Kt("arrangements"),F(!1)},children:[u.jsx("span",{className:"nav-icon",children:"📅"}),u.jsx("span",{children:"Arrangements"}),u.jsx("span",{className:"nav-badge",children:sr.pendingArrangements})]})]}),u.jsxs("div",{className:"nav-section",children:[u.jsx("div",{className:"nav-section-title",children:"Analytics"}),u.jsxs("div",{className:`nav-item ${q==="earnings"?"active":""}`,onClick:()=>{Kt("earnings"),F(!1)},children:[u.jsx("span",{className:"nav-icon",children:"💰"}),u.jsx("span",{children:"Earnings"})]}),u.jsxs("div",{className:`nav-item ${q==="planning"?"active":""}`,onClick:()=>{Kt("planning"),F(!1)},children:[u.jsx("span",{className:"nav-icon",children:"🗺️"}),u.jsx("span",{children:"Route Planning"})]})]}),he&&u.jsxs("div",{className:"nav-section",children:[u.jsx("div",{className:"nav-section-title",children:"Admin"}),u.jsxs("div",{className:"nav-item",onClick:()=>{ue(!0),F(!1)},children:[u.jsx("span",{className:"nav-icon",children:"👑"}),u.jsx("span",{children:"Admin Panel"})]})]})]})]}),u.jsx("div",{className:`sidebar-overlay ${O?"active":""}`,onClick:()=>F(!1)}),In&&u.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:2e3,minWidth:320,maxWidth:500,maxHeight:"70vh",background:"white",borderRadius:"var(--radius-lg)",boxShadow:"var(--shadow-2xl)",overflow:"hidden",display:"flex",flexDirection:"column"},children:[u.jsxs("div",{style:{padding:"1.5rem",borderBottom:"1px solid var(--gray-200)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[u.jsx("h3",{style:{margin:0},children:"Cloud Backups (Last 7 Days)"}),u.jsx("button",{className:"btn btn-ghost",style:{padding:"0.5rem"},onClick:()=>zr(!1),children:"✕"})]}),u.jsxs("div",{style:{flex:1,overflow:"auto",padding:"1rem"},children:[Fr&&u.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[u.jsx("div",{className:"spinner"}),u.jsx("p",{children:"Loading backups..."})]}),!Fr&&Qt&&u.jsx("div",{style:{padding:"1rem",color:"var(--danger)"},children:Qt}),!Fr&&!Qt&&Er.length===0&&u.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"var(--gray-500)"},children:"No backups found"}),!Fr&&!Qt&&Er.map(Ie=>{const Le=Ie.object_path.split("/"),De=Le[Le.length-1]||Ie.object_path,j=Ie.day_key||"",Q=Ie.size_bytes?Math.round(Ie.size_bytes/1024)+" KB":"";return u.jsxs("button",{className:"btn btn-ghost",style:{width:"100%",justifyContent:"space-between",marginBottom:"0.5rem",padding:"1rem"},onClick:()=>di(Ie.object_path),children:[u.jsx("span",{style:{fontWeight:500},children:De}),u.jsxs("span",{style:{fontSize:"0.875rem",color:"var(--gray-500)"},children:[j," · ",Q]})]},Ie.object_path)})]})]}),In&&u.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",zIndex:1999},onClick:()=>zr(!1)}),e.error&&e.error!=="Auth session missing!"&&!e.isLoading&&u.jsxs("div",{style:{position:"fixed",bottom:"1rem",left:"50%",transform:"translateX(-50%)",background:"var(--danger-light)",border:"1px solid var(--danger)",borderRadius:"var(--radius-lg)",padding:"0.75rem 1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",boxShadow:"var(--shadow-lg)",zIndex:1e3},children:[u.jsxs("span",{style:{color:"var(--danger)"},children:["⚠️ ",e.error]}),u.jsx("button",{className:"btn btn-ghost btn-sm",onClick:e.clearError,children:"Dismiss"})]}),z&&u.jsx("div",{className:"modal-overlay",onClick:()=>U(!1),children:u.jsxs("div",{className:"modal-content",onClick:Ie=>Ie.stopPropagation(),style:{maxWidth:"450px"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"1px solid var(--gray-200)"},children:[u.jsxs("div",{children:[u.jsx("h2",{style:{margin:0,fontSize:"1.5rem",color:"var(--text-primary)"},children:"Change Password"}),u.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.875rem",color:"var(--text-secondary)"},children:"Update your account password"})]}),u.jsx("button",{onClick:()=>U(!1),style:{background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"var(--text-secondary)",padding:"0.25rem",lineHeight:1},children:"✕"})]}),u.jsxs("form",{onSubmit:async Ie=>{Ie.preventDefault();const Le=Ie.target,De=Le.elements.namedItem("newPassword").value,j=Le.elements.namedItem("confirmPassword").value;if(De!==j){await ee({title:"Password Mismatch",message:"The passwords you entered do not match. Please try again.",type:"error"});return}if(De.length<6){await ee({title:"Password Too Short",message:"Password must be at least 6 characters long.",type:"error"});return}try{await e.updatePassword(De),U(!1),await ee({title:"Password Updated",message:"Your password has been updated successfully!",type:"success"})}catch(Q){await ee({title:"Update Failed",message:Q.message||"Failed to update password. Please try again.",type:"error"})}},children:[u.jsxs("div",{style:{marginBottom:"1.25rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500,fontSize:"0.9375rem",color:"var(--text-primary)"},children:"New Password"}),u.jsx("input",{type:"password",name:"newPassword",className:"input",required:!0,minLength:6,placeholder:"Enter new password",style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1.5px solid var(--gray-300)",fontSize:"1rem"}}),u.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8125rem",color:"var(--text-secondary)"},children:"Must be at least 6 characters"})]}),u.jsxs("div",{style:{marginBottom:"1.5rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:500,fontSize:"0.9375rem",color:"var(--text-primary)"},children:"Confirm Password"}),u.jsx("input",{type:"password",name:"confirmPassword",className:"input",required:!0,minLength:6,placeholder:"Re-enter new password",style:{width:"100%",padding:"0.75rem",borderRadius:"8px",border:"1.5px solid var(--gray-300)",fontSize:"1rem"}})]}),u.jsxs("div",{style:{display:"flex",gap:"0.75rem",marginTop:"1.5rem",paddingTop:"1rem",borderTop:"1px solid var(--gray-200)"},children:[u.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:1,padding:"0.875rem",fontSize:"1rem",fontWeight:600},children:"Update Password"}),u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>U(!1),style:{padding:"0.875rem 1.5rem",fontSize:"1rem"},children:"Cancel"})]})]})]})}),te&&u.jsx("div",{className:"modal-overlay",onClick:()=>W(!1),children:u.jsxs("div",{className:"modal-content",onClick:Ie=>Ie.stopPropagation(),style:{maxWidth:"400px"},children:[u.jsx("h2",{style:{marginBottom:"1rem"},children:"Change Email"}),u.jsx("p",{style:{marginBottom:"1rem",color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Note: You'll need to confirm your new email address."}),u.jsxs("form",{onSubmit:async Ie=>{Ie.preventDefault();const De=Ie.target.elements.namedItem("newEmail").value;try{if(!Ve)throw new Error("Supabase not configured");const{error:j}=await Ve.auth.updateUser({email:De});if(j)throw j;window.alert("Confirmation email sent! Please check your inbox."),W(!1)}catch(j){window.alert("Error: "+j.message)}},children:[u.jsxs("div",{style:{marginBottom:"1rem"},children:[u.jsx("label",{style:{display:"block",marginBottom:"0.5rem"},children:"New Email"}),u.jsx("input",{type:"email",name:"newEmail",className:"input",required:!0})]}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{type:"submit",className:"btn btn-primary",style:{flex:1},children:"Update Email"}),u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>W(!1),children:"Cancel"})]})]})]})}),ae&&u.jsx("div",{className:"modal-overlay",onClick:()=>oe(!1),children:u.jsxs("div",{className:"modal-content",onClick:Ie=>Ie.stopPropagation(),style:{maxWidth:"400px"},children:[u.jsx("h2",{style:{marginBottom:"1rem",color:"var(--danger)"},children:"Delete Account"}),u.jsx("p",{style:{marginBottom:"1rem"},children:"⚠️ This action cannot be undone. All your data will be permanently deleted."}),u.jsxs("p",{style:{marginBottom:"1rem",fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Type ",u.jsx("strong",{children:"DELETE"})," to confirm:"]}),u.jsxs("form",{onSubmit:async Ie=>{if(Ie.preventDefault(),Ie.target.elements.namedItem("confirmation").value!=="DELETE"){window.alert("Please type DELETE to confirm");return}try{if(!Ve)throw new Error("Supabase not configured");const{error:j}=await Ve.rpc("delete_user_account");if(j)throw j;await e.signOut(),window.alert("Account deleted successfully"),oe(!1)}catch(j){window.alert("Error: "+j.message)}},children:[u.jsx("div",{style:{marginBottom:"1rem"},children:u.jsx("input",{type:"text",name:"confirmation",className:"input",required:!0,placeholder:"Type DELETE"})}),u.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[u.jsx("button",{type:"submit",className:"btn",style:{flex:1,background:"var(--danger)",color:"white"},children:"Delete Account"}),u.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>oe(!1),children:"Cancel"})]})]})]})}),u.jsx(RL,{}),de&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"ownership-modal-backdrop",onClick:()=>ge(!1)}),u.jsxs("div",{className:"ownership-modal-container",children:[u.jsxs("div",{className:"ownership-modal-header",children:[u.jsx("div",{className:"ownership-warning-badge",children:u.jsx("span",{className:"ownership-warning-icon",children:"⚠️"})}),u.jsx("h2",{className:"ownership-modal-title",children:"Data Ownership Unclear"}),u.jsx("p",{className:"ownership-modal-subtitle",children:"We found local data that may not belong to your current account"})]}),u.jsxs("div",{className:"ownership-modal-body",children:[u.jsxs("div",{className:"ownership-account-card",children:[u.jsx("div",{className:"ownership-account-icon",children:"👤"}),u.jsxs("div",{className:"ownership-account-info",children:[u.jsx("div",{className:"ownership-account-label",children:"Currently logged in as"}),u.jsx("div",{className:"ownership-account-email",children:e.user?.email||"Unknown"})]})]}),u.jsxs("div",{className:"ownership-data-summary",children:[u.jsxs("div",{className:"ownership-summary-header",children:[u.jsx("span",{className:"ownership-summary-icon",children:"📊"}),u.jsx("span",{className:"ownership-summary-title",children:"Local data found on this device"})]}),u.jsxs("div",{className:"ownership-stats-grid",children:[u.jsxs("div",{className:"ownership-stat-card",children:[u.jsx("div",{className:"ownership-stat-icon",children:"📍"}),u.jsx("div",{className:"ownership-stat-number",children:ct.addresses.length}),u.jsx("div",{className:"ownership-stat-label",children:"Addresses"})]}),u.jsxs("div",{className:"ownership-stat-card",children:[u.jsx("div",{className:"ownership-stat-icon",children:"✅"}),u.jsx("div",{className:"ownership-stat-number",children:ct.completions.length}),u.jsx("div",{className:"ownership-stat-label",children:"Completions"})]}),u.jsxs("div",{className:"ownership-stat-card",children:[u.jsx("div",{className:"ownership-stat-icon",children:"📅"}),u.jsx("div",{className:"ownership-stat-number",children:ct.arrangements.length}),u.jsx("div",{className:"ownership-stat-label",children:"Arrangements"})]})]})]}),u.jsxs("div",{className:"ownership-info-section",children:[u.jsx("div",{className:"ownership-info-title",children:"This can happen when:"}),u.jsxs("ul",{className:"ownership-info-list",children:[u.jsx("li",{children:"You're using a shared device"}),u.jsx("li",{children:"Another user previously used this browser"}),u.jsx("li",{children:"You're signing in from a different account"})]})]}),u.jsx("div",{className:"ownership-question",children:"What would you like to do with this local data?"})]}),u.jsxs("div",{className:"ownership-modal-actions",children:[u.jsxs("button",{className:"ownership-btn ownership-btn-keep",onClick:async()=>{localStorage.removeItem("navigator_ownership_uncertain"),ge(!1);try{await e.syncData(ct),Ei.storeDeviceContext(e.user),ht.current=JSON.stringify(ct),await ee({title:"Success",message:"Your data has been synced to the cloud.",type:"success"})}catch(Ie){le.error("Failed to sync data:",Ie),await ee({title:"Sync Failed",message:"Failed to sync data to cloud. Please try again.",type:"error"})}},children:[u.jsx("span",{className:"ownership-btn-icon",children:"✓"}),u.jsxs("span",{className:"ownership-btn-text",children:[u.jsx("span",{className:"ownership-btn-title",children:"Keep & Sync to My Account"}),u.jsx("span",{className:"ownership-btn-desc",children:"This data belongs to me"})]})]}),u.jsxs("button",{className:"ownership-btn ownership-btn-discard",onClick:async()=>{if(await I({title:"Discard Local Data?",message:"This will permanently delete the local data and load your cloud data instead. This action cannot be undone.",confirmText:"Discard Local Data",cancelText:"Cancel",type:"warning"})){localStorage.removeItem("navigator_ownership_uncertain");try{const Le=`navigator_safety_backup_${Date.now()}_user_choice_discard`;localStorage.setItem(Le,JSON.stringify({...ct,_backup_timestamp:new Date().toISOString(),_backup_reason:"user_chose_discard"})),le.info(`Safety backup created: ${Le}`)}catch(Le){le.warn("Failed to create safety backup:",Le)}E({addresses:[],completions:[],arrangements:[],daySessions:[],activeIndex:null,currentListVersion:1}),Ei.storeDeviceContext(e.user),ge(!1),await ee({title:"Data Cleared",message:"Local data has been cleared. Your cloud data will now load.",type:"success"})}},children:[u.jsx("span",{className:"ownership-btn-icon",children:"🗑️"}),u.jsxs("span",{className:"ownership-btn-text",children:[u.jsx("span",{className:"ownership-btn-title",children:"Discard Local Data"}),u.jsx("span",{className:"ownership-btn-desc",children:"Clear it and use cloud data"})]})]}),u.jsxs("button",{className:"ownership-btn ownership-btn-later",onClick:()=>{ge(!1),ee({title:"Decision Deferred",message:"You can access this prompt again from Settings > Account > Resolve Data Ownership",type:"info"})},children:[u.jsx("span",{className:"ownership-btn-icon",children:"⏱️"}),u.jsxs("span",{className:"ownership-btn-text",children:[u.jsx("span",{className:"ownership-btn-title",children:"Decide Later"}),u.jsx("span",{className:"ownership-btn-desc",children:"Access from Settings later"})]})]})]})]})]}),u.jsx(zL,{}),u.jsx(LL,{})]})}const Cy={enabled:!1,ttlMs:300*1e3,maxChanges:1e3,syncWindowMs:10*1e3},$o="navigator_change_",Ay="navigator_change_tracker_config";function GL(){let e=localStorage.getItem("navigator_device_id");return e||(e=`device_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,localStorage.setItem("navigator_device_id",e)),e}function KL(){return`change_${Date.now()}_${Math.random().toString(36).slice(2,15)}`}async function Ny(e){const t=JSON.stringify(e),n=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",n);return Array.from(new Uint8Array(a)).map(l=>l.toString(16).padStart(2,"0")).join("")}class ZL{config;deviceId;cleanupInterval=null;constructor(){this.config=Cy,this.deviceId=GL(),this.loadConfig()}async loadConfig(){try{const t=await Xu(Ay);t&&(this.config={...Cy,...t})}catch(t){console.warn("Failed to load change tracker config:",t)}}async updateConfig(t){this.config={...this.config,...t};try{await wc(Ay,this.config),console.log("✅ Change tracker config updated:",this.config)}catch(r){console.error("Failed to save change tracker config:",r)}}isEnabled(){return this.config.enabled}async enable(){await this.updateConfig({enabled:!0}),this.startCleanupInterval(),console.log("✅ Change tracking ENABLED")}async disable(){await this.updateConfig({enabled:!1}),this.stopCleanupInterval(),console.log("❌ Change tracking DISABLED")}async trackChange(t,r,n){if(!this.config.enabled)return"";const a=Date.now(),s=KL(),l=await Ny(r),d={id:s,type:t,timestamp:a,deviceId:this.deviceId,entityId:n?.entityId,entityIndex:n?.entityIndex,stateSnapshot:l,synced:!1,expiresAt:a+this.config.ttlMs,metadata:n?.metadata};try{const m=`${$o}${s}`;return await wc(m,d),await this.enforceMaxChanges(),s}catch(m){return console.error("Failed to track change:",m),""}}async markSynced(t){if(!(!this.config.enabled||!t))try{const r=`${$o}${t}`,n=await Xu(r);n&&(n.synced=!0,n.syncedAt=Date.now(),await wc(r,n))}catch(r){console.error("Failed to mark change as synced:",r)}}async isEcho(t,r){if(!this.config.enabled)return!1;try{const n=await Ny(t),s=Date.now()-this.config.syncWindowMs,d=(await Du()).filter(([m])=>m.startsWith($o)).map(([,m])=>m).filter(m=>!!(!m.synced||m.syncedAt&&m.syncedAt>s));for(const m of d){let p=m.stateSnapshot===n;if(p&&r&&(r.type&&m.type!==r.type&&(p=!1),r.entityId&&m.entityId!==r.entityId&&(p=!1),r.entityIndex!==void 0&&m.entityIndex!==r.entityIndex&&(p=!1)),p)return!0}return!1}catch(n){return console.error("Failed to check for echo:",n),!1}}async getAllChanges(){try{return(await Du()).filter(([r])=>r.startsWith($o)).map(([,r])=>r).sort((r,n)=>n.timestamp-r.timestamp)}catch(t){return console.error("Failed to get all changes:",t),[]}}async getChangesForEntity(t,r,n){return(await this.getAllChanges()).filter(s=>!!(r&&s.entityId===r||n!==void 0&&s.entityIndex===n))}async cleanup(){if(!this.config.enabled)return 0;try{const t=Date.now(),r=await Du();let n=0;for(const[a,s]of r){if(!a.startsWith($o))continue;(s.expiresAt<t||s.synced&&s.syncedAt&&t-s.syncedAt>this.config.ttlMs)&&(await ih(a),n++)}return n}catch(t){return console.error("Failed to cleanup changes:",t),0}}async enforceMaxChanges(){try{const t=await this.getAllChanges();if(t.length>this.config.maxChanges){const r=t.sort((n,a)=>n.timestamp-a.timestamp).slice(0,t.length-this.config.maxChanges);for(const n of r)await ih(`${$o}${n.id}`)}}catch(t){console.error("Failed to enforce max changes:",t)}}async clearAll(){try{const t=await Du();for(const[r]of t)r.startsWith($o)&&await ih(r);console.log("🧹 All change tracking cleared")}catch(t){console.error("Failed to clear all changes:",t)}}startCleanupInterval(){this.cleanupInterval||(this.cleanupInterval=setInterval(()=>{this.cleanup().catch(t=>{console.error("Cleanup interval failed:",t)})},60*1e3))}stopCleanupInterval(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}getConfig(){return{...this.config}}async getStats(){const t=await this.getAllChanges(),r=Date.now();return{enabled:this.config.enabled,totalChanges:t.length,syncedChanges:t.filter(n=>n.synced).length,unsyncedChanges:t.filter(n=>!n.synced).length,oldestChangeAge:t.length>0?r-Math.min(...t.map(n=>n.timestamp)):null,newestChangeAge:t.length>0?r-Math.max(...t.map(n=>n.timestamp)):null}}}const Mt=new ZL,YL={enabled:!1,maxPendingUpdates:100,updateTimeoutMs:30*1e3,autoRetry:!0,maxRetries:3};function qL(){return`update_${Date.now()}_${Math.random().toString(36).slice(2,15)}`}function Py(e){return JSON.parse(JSON.stringify(e))}function XL(e,t){return JSON.stringify(e.addresses)===JSON.stringify(t.addresses)&&JSON.stringify(e.completions)===JSON.stringify(t.completions)&&JSON.stringify(e.arrangements)===JSON.stringify(t.arrangements)&&e.activeIndex===t.activeIndex&&e.currentListVersion===t.currentListVersion}class JL{config;pendingUpdates;updateCallbacks;timeouts;constructor(){this.config=YL,this.pendingUpdates=new Map,this.updateCallbacks=new Map,this.timeouts=new Map}updateConfig(t){this.config={...this.config,...t},le.info("Optimistic UI config updated:",this.config)}isEnabled(){return this.config.enabled&&Mt.isEnabled()}async enable(){Mt.isEnabled()||await Mt.enable(),this.config.enabled=!0,le.info("✅ Optimistic UI ENABLED")}disable(){this.pendingUpdates.clear(),this.updateCallbacks.clear();for(const t of this.timeouts.values())clearTimeout(t);this.timeouts.clear(),this.config.enabled=!1,le.info("❌ Optimistic UI DISABLED")}async applyUpdate(t,r,n,a){if(!this.isEnabled())return"";if(this.pendingUpdates.size>=this.config.maxPendingUpdates)return le.warn("Too many pending optimistic updates, rejecting new update"),"";const s=qL(),l=await Mt.trackChange(t,n,{entityId:a?.entityId,entityIndex:a?.entityIndex,metadata:a?.metadata}),d={id:s,changeId:l,type:t,timestamp:Date.now(),status:"pending",previousState:Py(r),expectedState:Py(n),retryCount:0,maxRetries:this.config.maxRetries};this.pendingUpdates.set(s,d),a?.onConfirmed&&this.updateCallbacks.set(`${s}_confirmed`,a.onConfirmed),a?.onFailed&&this.updateCallbacks.set(`${s}_failed`,a.onFailed),a?.onConflict&&this.updateCallbacks.set(`${s}_conflict`,a.onConflict);const m=setTimeout(()=>{this.handleUpdateTimeout(s)},this.config.updateTimeoutMs);return this.timeouts.set(s,m),s}async confirmUpdate(t,r){const n=this.pendingUpdates.get(t);if(!n){le.warn(`Cannot confirm unknown update: ${t}`);return}const a=this.timeouts.get(t);if(a&&(clearTimeout(a),this.timeouts.delete(t)),r&&!XL(n.expectedState,r)){le.warn("⚠️ Conflict detected: actual state differs from expected",{updateId:t,type:n.type}),n.status="conflicted",n.actualState=r;const l=this.updateCallbacks.get(`${t}_conflict`);l&&l(n),this.pendingUpdates.delete(t);return}n.status="confirmed",await Mt.markSynced(n.changeId);const s=this.updateCallbacks.get(`${t}_confirmed`);s&&s(n),this.pendingUpdates.delete(t),this.updateCallbacks.delete(`${t}_confirmed`),this.updateCallbacks.delete(`${t}_failed`),this.updateCallbacks.delete(`${t}_conflict`)}async failUpdate(t,r){const n=this.pendingUpdates.get(t);if(!n){le.warn(`Cannot fail unknown update: ${t}`);return}const a=this.timeouts.get(t);if(a&&(clearTimeout(a),this.timeouts.delete(t)),n.error=r,n.retryCount++,this.config.autoRetry&&n.retryCount<n.maxRetries){le.warn(`⚠️ Optimistic update failed, retrying (${n.retryCount}/${n.maxRetries}):`,{updateId:t,error:r});const l=setTimeout(()=>{this.handleUpdateTimeout(t)},this.config.updateTimeoutMs);this.timeouts.set(t,l);return}n.status="failed",le.error("❌ Optimistic update failed permanently:",{updateId:t,type:n.type,error:r,retries:n.retryCount});const s=this.updateCallbacks.get(`${t}_failed`);s&&s(n),this.pendingUpdates.delete(t),this.updateCallbacks.delete(`${t}_confirmed`),this.updateCallbacks.delete(`${t}_failed`),this.updateCallbacks.delete(`${t}_conflict`)}async handleUpdateTimeout(t){const r=this.pendingUpdates.get(t);r&&(le.warn("⏱️ Optimistic update timed out:",{updateId:t,type:r.type,age:`${Date.now()-r.timestamp}ms`}),await this.failUpdate(t,"Update timed out"))}getRollbackState(t){const r=this.pendingUpdates.get(t);return r?r.previousState:null}rollback(t){const r=this.getRollbackState(t);return r&&(this.pendingUpdates.delete(t),le.info("↩️ Rolled back optimistic update:",t)),r}rollbackAll(){const t=[];for(const[r,n]of this.pendingUpdates.entries()){t.push(n.previousState);const a=this.timeouts.get(r);a&&(clearTimeout(a),this.timeouts.delete(r))}return this.pendingUpdates.clear(),this.updateCallbacks.clear(),t.length>0&&le.warn(`↩️ Rolled back ${t.length} pending optimistic update(s)`),t}getPendingUpdates(){return Array.from(this.pendingUpdates.values())}getStats(){const t=this.getPendingUpdates(),r=Date.now(),n=t.reduce((s,l)=>(s[l.type]=(s[l.type]||0)+1,s),{}),a=t.map(s=>r-s.timestamp);return{enabled:this.isEnabled(),totalPending:t.length,pendingByType:n,oldestPendingAge:a.length>0?Math.max(...a):null,avgPendingAge:a.length>0?a.reduce((s,l)=>s+l,0)/a.length:null}}clearAll(){for(const t of this.timeouts.values())clearTimeout(t);this.pendingUpdates.clear(),this.updateCallbacks.clear(),this.timeouts.clear(),le.warn("🧹 All optimistic updates cleared")}}const Lt=new JL;function QL(){return localStorage.getItem("navigator_device_id")||""}function e8(e){if(!e)return null;const t=QL();return e===t?{isEcho:!0,reason:"Same device ID - this update originated from this device",confidence:1,shouldApply:!1}:null}function t8(e){if(!e)return null;const t=typeof e=="string"?new Date(e).getTime():e,n=Date.now()-t;return n>=0&&n<100?{isEcho:!0,reason:`Very recent update (${n}ms old) - likely an echo`,confidence:.8,shouldApply:!1}:null}async function Zo(e,t){if(!Mt.isEnabled())return{isEcho:!1,reason:"Change tracker disabled - applying all updates",confidence:1,shouldApply:!0};if(t?.deviceId){const n=e8(t.deviceId);if(n)return n}if(t?.timestamp){const n=t8(t.timestamp);if(n&&n.confidence>.7)return n}return await Mt.isEcho(e,{entityId:t?.entityId,entityIndex:t?.entityIndex})?{isEcho:!0,reason:"Change tracker detected this as a local change",confidence:1,shouldApply:!1}:{isEcho:!1,reason:"No echo indicators found - genuine cloud update",confidence:1,shouldApply:!0}}let Kb={enabled:!1,totalFiltered:0,deviceIdFiltered:0,timestampFiltered:0,trackerFiltered:0,lastFilterTime:null};function Zb(){return{...Kb,enabled:Mt.isEnabled()}}function Yb(){Kb={enabled:Mt.isEnabled(),totalFiltered:0,deviceIdFiltered:0,timestampFiltered:0,trackerFiltered:0,lastFilterTime:null}}const Nh={enabled:!1,changeTracker:{ttlMs:300*1e3,maxChanges:1e3,syncWindowMs:10*1e3},optimisticUI:{maxPendingUpdates:100,updateTimeoutMs:30*1e3,autoRetry:!0,maxRetries:3},echoFilter:{deviceIdCheck:!0,timestampCheck:!0,timestampThresholdMs:100,trackerCheck:!0}},qb="navigator_optimistic_ui_config";function r8(){try{const e=localStorage.getItem(qb);if(e){const t=JSON.parse(e);return{...Nh,...t}}}catch(e){le.warn("Failed to load optimistic UI config:",e)}return Nh}function Yh(e){try{localStorage.setItem(qb,JSON.stringify(e)),le.info("✅ Optimistic UI config saved")}catch(t){le.error("Failed to save optimistic UI config:",t)}}let tn=r8();async function n8(e){const t={...tn,...e};e.changeTracker&&(t.changeTracker={...tn.changeTracker,...e.changeTracker}),e.optimisticUI&&(t.optimisticUI={...tn.optimisticUI,...e.optimisticUI}),e.echoFilter&&(t.echoFilter={...tn.echoFilter,...e.echoFilter}),tn=t,Yh(tn),await Pg(tn),le.info("✅ Optimistic UI configuration updated:",tn)}async function Pg(e){await Mt.updateConfig({enabled:e.enabled,ttlMs:e.changeTracker.ttlMs,maxChanges:e.changeTracker.maxChanges,syncWindowMs:e.changeTracker.syncWindowMs}),Lt.updateConfig({enabled:e.enabled,maxPendingUpdates:e.optimisticUI.maxPendingUpdates,updateTimeoutMs:e.optimisticUI.updateTimeoutMs,autoRetry:e.optimisticUI.autoRetry,maxRetries:e.optimisticUI.maxRetries})}async function Ig(){le.info("⚙️ Enabling optimistic UI system..."),tn.enabled=!0,Yh(tn),await Mt.enable(),await Lt.enable(),le.info("✅ Optimistic UI system ENABLED")}async function a8(){le.info("⚙️ Disabling optimistic UI system..."),tn.enabled=!1,Yh(tn),Lt.disable(),await Mt.disable(),le.info("❌ Optimistic UI system DISABLED")}function Xb(){return tn.enabled&&Mt.isEnabled()&&Lt.isEnabled()}async function i8(){le.info("⚙️ Resetting optimistic UI configuration to defaults..."),tn={...Nh},Yh(tn),await Pg(tn),le.info("✅ Optimistic UI configuration reset to defaults")}async function Jb(){const e=await Mt.getStats(),t=Lt.getStats();return{enabled:Xb(),config:tn,changeTracker:e,optimisticUI:t}}const s8={conservative:{enabled:!0,changeTracker:{ttlMs:600*1e3,maxChanges:500,syncWindowMs:15*1e3},optimisticUI:{maxPendingUpdates:50,updateTimeoutMs:60*1e3,autoRetry:!0,maxRetries:5},echoFilter:{deviceIdCheck:!0,timestampCheck:!0,timestampThresholdMs:200,trackerCheck:!0}},aggressive:{enabled:!0,changeTracker:{ttlMs:120*1e3,maxChanges:1e3,syncWindowMs:5*1e3},optimisticUI:{maxPendingUpdates:200,updateTimeoutMs:15*1e3,autoRetry:!0,maxRetries:2},echoFilter:{deviceIdCheck:!0,timestampCheck:!0,timestampThresholdMs:50,trackerCheck:!0}},balanced:Nh};async function o8(e){le.info(`⚙️ Applying ${e} preset...`);const t=s8[e];await n8(t),le.info(`✅ ${e} preset applied`)}(async()=>{try{await Pg(tn)}catch(e){le.error("Failed to initialize optimistic UI system:",e)}})();function Un(e){return{...{addresses:[{address:"123 Test St",lat:null,lng:null},{address:"456 Mock Ave",lat:null,lng:null}],activeIndex:null,activeStartTime:null,completions:[],daySessions:[],arrangements:[],currentListVersion:1,subscription:null},...e}}function uh(e){return{index:0,address:"123 Test St",lat:null,lng:null,outcome:"PIF",timestamp:new Date().toISOString(),listVersion:1,...e}}function tl(e){return new Promise(t=>setTimeout(t,e))}async function Cc(){try{Lt.clearAll(),await Mt.clearAll(),Lt.updateConfig({enabled:!0,maxPendingUpdates:100,updateTimeoutMs:30*1e3,autoRetry:!0,maxRetries:3}),await tl(50)}catch(e){le.error("Error during test cleanup:",e)}}const l8={name:"Change Tracking",scenarios:[{name:"Track and retrieve change",description:"Test that changes are properly tracked and can be retrieved",run:async()=>{const e=Date.now();try{Mt.isEnabled()||await Mt.enable();const t=Un(),r=await Mt.trackChange("complete",t,{entityIndex:0});if(!r)return{passed:!1,message:"Failed to track change - no change ID returned",duration:Date.now()-e};const a=(await Mt.getAllChanges()).find(s=>s.id===r);return a?{passed:!0,message:"Change tracked and retrieved successfully",details:{changeId:r,tracked:a},duration:Date.now()-e}:{passed:!1,message:"Change not found after tracking",duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}},{name:"Echo detection via checksum",description:"Test that identical state checksums are detected as echoes",run:async()=>{const e=Date.now();try{Mt.isEnabled()||await Mt.enable();const t=Un();await Mt.trackChange("complete",t,{entityIndex:0}),await tl(100);const r=await Mt.isEcho(t,{entityIndex:0});return{passed:r,message:r?"Echo correctly detected via checksum":"Echo NOT detected (expected to be detected)",duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}},{name:"Change cleanup",description:"Test that old changes are cleaned up",run:async()=>{const e=Date.now();try{Mt.isEnabled()||await Mt.enable();const t=Un();await Mt.trackChange("complete",t);const r=await Mt.cleanup();return{passed:!0,message:`Cleanup completed, removed ${r} old changes`,details:{removedCount:r},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}}]},c8={name:"Optimistic UI",scenarios:[{name:"Apply and confirm update",description:"Test optimistic update lifecycle: apply → confirm",run:async()=>{const e=Date.now();try{Lt.isEnabled()||await Lt.enable();const t=Un(),r=Un({completions:[uh()]}),n=await Lt.applyUpdate("complete",t,r,{entityIndex:0});if(!n)return{passed:!1,message:"No update ID returned",duration:Date.now()-e};if(!Lt.getPendingUpdates().find(m=>m.id===n))return{passed:!1,message:"Update not in pending list",duration:Date.now()-e};await Lt.confirmUpdate(n,r),await tl(100);const d=Lt.getPendingUpdates().find(m=>m.id===n);return{passed:!d,message:d?"Update still pending after confirmation":"Update confirmed and cleaned up successfully",details:{updateId:n},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}},{name:"Fail and rollback update",description:"Test optimistic update failure and rollback",run:async()=>{const e=Date.now();try{Lt.isEnabled()||await Lt.enable(),Lt.updateConfig({autoRetry:!1});const t=Un(),r=Un({completions:[uh()]}),n=await Lt.applyUpdate("complete",t,r,{entityIndex:0});if(!n)return{passed:!1,message:"No update ID returned",duration:Date.now()-e};const a=Lt.getRollbackState(n);if(!a)return{passed:!1,message:"No rollback state available before failUpdate",duration:Date.now()-e};await Lt.failUpdate(n,"Test failure");const s=Lt.getPendingUpdates().find(l=>l.id===n);return{passed:!!a&&!s,message:a&&!s?"Rollback state retrieved and update failed correctly":"Rollback or cleanup did not work as expected",details:{updateId:n,hadRollbackState:!!a,stillPending:!!s},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}},{name:"Update timeout handling",description:"Test that updates timeout correctly",run:async()=>{const e=Date.now();try{Lt.clearAll(),await tl(50),Lt.updateConfig({enabled:!0,updateTimeoutMs:500,maxRetries:0,autoRetry:!0});const t=Un(),r=Un({completions:[uh()]}),n=await Lt.applyUpdate("complete",t,r);if(!n)return{passed:!1,message:"No update ID returned",duration:Date.now()-e};const a=Lt.getPendingUpdates().find(l=>l.id===n);if(!a)return{passed:!1,message:"Update was not added to pending list",duration:Date.now()-e};await tl(1200);const s=Lt.getPendingUpdates().find(l=>l.id===n);return{passed:!s,message:s?"Update did not timeout and fail as expected":"Update timed out and failed correctly",details:{updateId:n,wasInitiallyPending:!!a,isFinallyPending:!!s},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}}]},u8={name:"Echo Filter",scenarios:[{name:"Device ID echo detection",description:"Test echo detection via device ID matching",run:async()=>{const e=Date.now();try{const t=localStorage.getItem("navigator_device_id");if(!t)return{passed:!1,message:"No device ID found",duration:Date.now()-e};const r=Un(),n=await Zo(r,{deviceId:t}),a=await Zo(r,{deviceId:"different_device"});return{passed:n.isEcho&&!a.isEcho,message:n.isEcho&&!a.isEcho?"Device ID echo detection working correctly":"Device ID echo detection not working",details:{result1:n,result2:a},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}},{name:"Timestamp echo detection",description:"Test echo detection via timestamp heuristic",run:async()=>{const e=Date.now();try{const t=Un(),r=Date.now()-50,n=await Zo(t,{timestamp:r}),a=Date.now()-5e3,s=await Zo(t,{timestamp:a});return{passed:n.isEcho&&!s.isEcho,message:n.isEcho&&!s.isEcho?"Timestamp echo detection working correctly":"Timestamp echo detection not working",details:{result1:n,result2:s},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}},{name:"Echo filter statistics",description:"Test echo filter statistics tracking",run:async()=>{const e=Date.now();try{Yb();const t=Un(),r=localStorage.getItem("navigator_device_id")||"test_device";if(!(await Zo(t,{deviceId:r})).isEcho)return{passed:!1,message:"Failed to generate echo for stats test",duration:Date.now()-e};const a=Zb();return{passed:a.totalFiltered>0,message:a.totalFiltered>0?"Echo filter statistics working":"Statistics not updating",details:{stats:a},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}}]},d8={name:"Integration",scenarios:[{name:"Full lifecycle test",description:"Test complete flow: track → optimistic → filter → confirm",run:async()=>{const e=Date.now();try{(!Mt.isEnabled()||!Lt.isEnabled())&&await Ig();const t=Un(),r=Un({completions:[uh()]}),n=await Lt.applyUpdate("complete",t,r,{entityIndex:0});if(!n)return{passed:!1,message:"Failed to apply optimistic update",duration:Date.now()-e};const s=(await Mt.getAllChanges()).find(m=>m.entityIndex===0&&m.type==="complete");if(!s)return{passed:!1,message:"Change was not tracked",duration:Date.now()-e};const l=localStorage.getItem("navigator_device_id")||"test",d=await Zo(r,{deviceId:l});return d.isEcho?(await Lt.confirmUpdate(n,r),await tl(100),{passed:!0,message:"Full lifecycle completed successfully",details:{updateId:n,tracked:s,echoResult:d},duration:Date.now()-e}):{passed:!1,message:"Echo was not detected",details:{echoResult:d},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}},{name:"System statistics",description:"Verify system statistics are available",run:async()=>{const e=Date.now();try{const t=await Jb(),r=!!(t&&t.config&&t.changeTracker&&t.optimisticUI);return{passed:r,message:r?"System statistics available":"Missing statistics",details:{stats:t},duration:Date.now()-e}}catch(t){return{passed:!1,message:`Error: ${t.message}`,duration:Date.now()-e}}}}]};async function f8(e){le.info(`🧪 Running test suite: ${e.name}`);const t=[];for(const a of e.scenarios){le.info(`  Running: ${a.name}`);const s=await a.run();t.push(s);const l=s.passed?"✅":"❌";le.info(`  ${l} ${s.message}`),await Cc()}const r=t.filter(a=>a.passed).length,n=t.filter(a=>!a.passed).length;return{suite:e.name,passed:r,failed:n,results:t}}async function h8(){le.info("🧪 Starting Optimistic UI Test Suite"),le.info("═══════════════════════════════════════"),le.info("🧹 Cleaning up test environment..."),await Cc();const e=[l8,c8,u8,d8],t=[];for(const a of e){const s=await f8(a);t.push(s),le.info("")}await Cc(),le.info("═══════════════════════════════════════"),le.info("📊 Test Summary:"),le.info("");let r=0,n=0;for(const a of t)r+=a.passed,n+=a.failed,le.info(`  ${a.suite}: ${a.passed}/${a.passed+a.failed} passed`);le.info(""),le.info(`Total: ${r} passed, ${n} failed`),n===0?le.info("✅ All tests passed!"):le.warn(`❌ ${n} test(s) failed`),le.info("═══════════════════════════════════════")}async function m8(){le.info("🧪 Running smoke test...");try{if(await Cc(),await Ig(),!Mt.isEnabled()||!Lt.isEnabled())return le.error("❌ Failed to enable system"),!1;le.info("✅ System enabled");const e=Un();if(!await Mt.trackChange("complete",e))return le.error("❌ Failed to track change"),!1;le.info("✅ Change tracking works");const r=await Lt.applyUpdate("complete",e,e);if(!r)return le.error("❌ Failed to apply optimistic update"),!1;le.info("✅ Optimistic updates work");const n=localStorage.getItem("navigator_device_id")||"test";return await Zo(e,{deviceId:n})?(le.info("✅ Echo filtering works"),await Lt.confirmUpdate(r),await tl(100),await Cc(),le.info("🎉 Smoke test passed!"),!0):(le.error("❌ Echo filtering failed"),!1)}catch(e){return le.error("❌ Smoke test failed:",e.message),await Cc(),!1}}function p8(){return{optimisticUI:Lt.getStats(),changeTracker:Mt.getStats()}}async function g8(){if(Lt.isEnabled())try{Lt.clearAll(),await Mt.clearAll(),le.warn("🧹 Cleared all optimistic UI state")}catch(e){throw le.error("Error clearing optimistic UI state:",e),e}}function v8(){console.log(`
╔═══════════════════════════════════════════════════════════════╗
║          Navigator Web - Optimistic UI Dev Tools              ║
╚═══════════════════════════════════════════════════════════════╝

🧪 TESTING:
  NavDev.runSmokeTest()    - Quick test (30 seconds)
  NavDev.runAllTests()     - Full test suite (2-3 minutes)

⚙️  ENABLE/DISABLE:
  NavDev.enable()          - Enable Optimistic UI
  NavDev.disable()         - Disable Optimistic UI
  NavDev.isEnabled()       - Check if enabled

📊 STATISTICS:
  NavDev.getStats()        - Get system stats
  NavDev.getOptimisticStats() - Get optimistic UI stats
  NavDev.getEchoStats()    - Get echo filter stats

🎛️  CONFIGURATION:
  NavDev.applyPreset('conservative')  - Apply preset
  NavDev.applyPreset('aggressive')
  NavDev.applyPreset('balanced')
  NavDev.resetToDefaults() - Reset to defaults

🔧 DIRECT ACCESS:
  NavDev.changeTracker     - Change tracker service
  NavDev.optimisticUI      - Optimistic UI manager

🧹 UTILITIES:
  NavDev.clearAll()        - Clear all optimistic state
  NavDev.resetEchoStats()  - Reset echo filter stats

📖 DOCUMENTATION:
  See OPTIMISTIC_UI_GUIDE.md for complete guide

Example usage:
  await NavDev.runSmokeTest();
  await NavDev.enable();
  await NavDev.getStats();
`)}const x8={runSmokeTest:m8,runAllTests:h8,enable:Ig,disable:a8,isEnabled:Xb,getStats:Jb,getOptimisticStats:p8,getEchoStats:Zb,applyPreset:o8,resetToDefaults:i8,changeTracker:Mt,optimisticUI:Lt,clearAll:g8,resetEchoStats:Yb,help:v8};function y8(){typeof window<"u"&&(window.NavDev=x8,console.log('✅ Navigator Dev Tools installed - Type "NavDev.help()" for commands'))}y8();const _8="https://eevfxrgemrtthxbcxtvq.supabase.co";try{const e=new URL(_8).origin;["preconnect","dns-prefetch"].forEach(t=>{const r=document.createElement("link");r.rel=t,r.href=e,t==="preconnect"&&(r.crossOrigin=""),document.head.appendChild(r)})}catch{}Wk.createRoot(document.getElementById("root")).render(u.jsx(FC,{children:u.jsx(HL,{})}));
